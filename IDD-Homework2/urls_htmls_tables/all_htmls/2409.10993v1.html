<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Chapter 5 Multi-modal Generative Models in Recommendation System</title>
<!--Generated on Tue Sep 17 08:50:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.10993v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Multi-modal Generative Models in Recommendation System</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Introduction to Multimodal Recommendation Systems</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1.SS1" title="In 5.1 Introduction to Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Why do we need multimodal recommendation systems?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1.SS2" title="In 5.1 Introduction to Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Key challenges in designing multimodal recommendation systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1.SS3" title="In 5.1 Introduction to Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Multimodal recommendation systems covered in this chapter</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Contrastive Multimodal Recommendation Systems</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2.SS1" title="In 5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Contrastive Language-Image Pre-training (CLIP)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2.SS2" title="In 5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Other Contrastive Pre-training Approaches</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Generative Multimodal Recommendation Systems</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>Generative Adversarial Networks for Multimodal Recommendation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1.SSS0.Px1" title="In 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Unimodal GANs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1.SSS0.Px2" title="In 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal GANs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1.SSS0.Px3" title="In 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal GANs for collaborative filtering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1.SSS0.Px4" title="In 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal GANs for fashion recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Variational AutoEncoders for Multimodal Recommendation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2.SSS0.Px1" title="In 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Unimodal VAEs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2.SSS0.Px2" title="In 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal VAEs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2.SSS0.Px3" title="In 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal VAEs for collaborative filtering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2.SSS0.Px4" title="In 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal VAEs for content-based retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2.SSS0.Px5" title="In 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Graph VAE for Multimodal Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.3 </span>Diffusion Models for Multimodal Recommendation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1" title="In 5.3.3 Diffusion Models for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Unimodal diffusion models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px2" title="In 5.3.3 Diffusion Models for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal diffusion models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.4 </span>Interactive Multimodal Recommendation Models</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4.SSS0.Px1" title="In 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal Large Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4.SSS0.Px2" title="In 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Controller LLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4.SSS0.Px3" title="In 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Multimodal instruction tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4.SSS0.Px4" title="In 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Any-to-text MLLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS4.SSS0.Px5" title="In 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Any-to-any MLLMs</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4" title=""><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Applications of Multimodal Recommendation Systems</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4.SS0.SSS0.Px1" title="In 5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">E-commerce</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4.SS0.SSS0.Px2" title="In 5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">In-context product visualization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4.SS0.SSS0.Px3" title="In 5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Marketing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4.SS0.SSS0.Px4" title="In 5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Streaming services</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4.SS0.SSS0.Px5" title="In 5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_title">Travel and service recommendations</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\addbibresource</span>
<p class="ltx_p" id="p1.2">sample-now.bib


</p>
</div>
<section class="ltx_chapter" id="Ch5">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter 5 </span>Multi-modal Generative Models in Recommendation System</h2>
<div class="ltx_para ltx_noindent" id="Ch5.p1">
<p class="ltx_p" id="Ch5.p1.1"><span class="ltx_text" id="Ch5.p1.1.1" style="font-size:90%;">This is a preprint of Chapter 5 in the upcoming book <span class="ltx_text ltx_font_italic" id="Ch5.p1.1.1.1">Recommendation with Generative Models</span>
by Yashar Deldjoo, Zhankui He, Julian McAuley, Anton Korikov, Scott Sanner, Arnau Ramisa, Rene Vidal, Mahesh Sathiamoorthy, Atoosa Kasrizadeh, Silvia Milano, and Francesco Ricci.</span></p>
</div>
<div class="ltx_para ltx_noindent" id="Ch5.p2">
<p class="ltx_p" id="Ch5.p2.1"><span class="ltx_text ltx_font_bold" id="Ch5.p2.1.1" style="font-size:90%;">Chapter Authors<span class="ltx_note ltx_role_footnote" id="Ch5.footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="Ch5.footnote1.1.1.1" style="font-size:111%;">1</span></span><span class="ltx_text ltx_font_medium" id="Ch5.footnote1.5" style="font-size:111%;">This work does not relate to the authors positions at Amazon.</span></span></span></span>:<span class="ltx_text ltx_font_medium" id="Ch5.p2.1.1.1"> Arnau Ramisa, Rene Vidal</span></span></p>
</div>
</section>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">The recommendation systems discussed so far typically limit user inputs to text strings or behavior signals such as clicks and purchases,
and system outputs to a list of products sorted by relevance. With the advent of generative AI, users have come to expect richer levels of interactions. In visual search, for example, a user may provide a picture of their desired product along with a natural language modification of the content of the picture (e.g., a dress like the one shown in the picture but in red color).
Moreover, users may want to better understand the recommendations they receive by visualizing how the product fits their use case, e.g., with a representation of how a garment might look on them, or how a furniture item might look in their room. Such advanced levels of interaction require recommendation systems that are able to discover both shared and complementary information about the product across modalities,
and visualize the product in a realistic and informative way. However, existing systems often treat multiple modalities independently: text search is usually done by comparing the user query to product titles and descriptions, while visual search is typically done by comparing an image provided by the customer to product images. We argue that future recommendation systems will benefit from a multi-modal understanding of the products that leverages the rich information retailers have about both customers and products to come up with the best recommendations.</p>
<p class="ltx_p" id="id2.id2">In this chapter we discuss recommendation systems that use multiple data modalities simultaneously. As we shall see, a key challenge in developing multimodal generative models is to ensure that the features extracted from each modality are adequately <em class="ltx_emph ltx_font_italic" id="id2.id2.1">aligned</em> across modalities, i.e., mapped to nearby points in the embedding space. Since the problem of jointly learning a generative model for each modality and their alignment is extremely difficult <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2020generative</span>]</cite>, a common approach is to use contrastive learning methods to approximately align the modalities before learning a multimodal generative model. Therefore, in this chapter we will review both contrastive and generative approaches to multimodal recommendation. More specifically, in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1" title="5.1 Introduction to Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.1</span></a> we will provide a brief introduction to multimodal recommendation systems, in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2" title="5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> we will review contrastive approaches to multimodal recommendation, and in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3" title="5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3</span></a> we will discuss generative approaches. Finally, in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S4" title="5.4 Applications of Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.4</span></a> we will overview various applications of multimodal recommendation systems. Throughout the chapter, we will center the discussion around vision and language models due to the larger volume of work for these two modalities, but we note there is a growing literature of generative recommendation systems that combine other modalities such as audio and text <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">vyas2023audiobox</span>]</cite>, video and audio <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ruan2023mm</span>]</cite>, or even more than two modalities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023next</span>]</cite>.</p>
</div>
<section class="ltx_section" id="Ch5.S1">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.1 </span>Introduction to Multimodal Recommendation Systems</h3>
<section class="ltx_subsection" id="Ch5.S1.SS1">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1.1 </span>Why do we need multimodal recommendation systems?</h4>
<div class="ltx_para" id="Ch5.S1.SS1.p1">
<p class="ltx_p" id="Ch5.S1.SS1.p1.1">Retailers have a lot of information about their customers and the items they sell, including purchase history, customer interactions, product descriptions, product images and videos, and customer reviews. However, existing recommendation systems typically process each data source independently and then combine the recommendation results. For example, text search is typically done by comparing a short user query to product title, descriptions and reviews, while visual search is typically done by comparing an image provided by the customer to product images. Both search approaches produce a list of products sorted by relevance, and current “multimodal” systems simply fuse unimodal relevance scores to produce a single list of products from both modalities. In practice, there are many use cases in which such a “late fusion” approach may be insufficient for satisfying the needs of the user.</p>
</div>
<div class="ltx_para" id="Ch5.S1.SS1.p2">
<p class="ltx_p" id="Ch5.S1.SS1.p2.1">One such use case, known as the <em class="ltx_emph ltx_font_italic" id="Ch5.S1.SS1.p2.1.1">cold start problem</em>, occurs when new users start using the system, or new products are added to the catalog, hence user behavioral data cannot be leveraged to recommend new products to existing users or existing products to new users.
To alleviate this problem, it is useful to gather diverse information about the items so that preference information can be transferred from existing products or users to new ones. To this end, models that combine information from multiple modalities offer a unique advantage. For example, if a store receives a new product (e.g., a dress), but no purchases have been made yet, we can use the visual similarities between the new dress and existing ones in the store to determine which customers could be interested in it.</p>
</div>
<div class="ltx_para" id="Ch5.S1.SS1.p3">
<p class="ltx_p" id="Ch5.S1.SS1.p3.1">Another use case occurs when different modalities are necessary to understand the user request. For example, to answer the request “best metal and glass black coffee table under $300 for my living room”, the system would need not only the text query but also an image of the customer’s living room in order to find a table that best matches the room. Moreover, answering this customer’s question requires reasoning about the appearance and shape of the item in context with the shape and appearance of many other objects, as well as limiting the search by price, which cannot be achieved by searching with either the text or image independently.
Other examples of multimodal requests include an image or audio of the desired item together with modification instructions in text (e.g., a dress like the one in the picture but in red, a song like the sound clip provided but in acoustic), or a complementary related product (e.g., a kickstand for the bicycle in the picture, or other movies from the actress talking in the video clip).</p>
</div>
<div class="ltx_para" id="Ch5.S1.SS1.p4">
<p class="ltx_p" id="Ch5.S1.SS1.p4.1">A third use case where multimodal understanding becomes crucial is when considering more complex recommendation systems, like those featuring virtual try-on capabilities, or intelligent conversational shopping assistants <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">rufus</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">shopwithai</span>]</cite>. To be effective, AI shopping assistants will need to be able to understand the context of previous interactions in the conversation history.
Let’s consider the example of a customer looking for a complete outfit he is planning to wear during the summer in Cairo, to attend the wedding of a friend with traditional tastes. An AI shopping assistant interacting with the customer will have to resort to visual cues to recommend products compatible as an outfit, as well as other customer preferences expressed earlier, the climate in Cairo during the summer, and cultural or dress code norms.</p>
</div>
</section>
<section class="ltx_subsection" id="Ch5.S1.SS2">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1.2 </span>Key challenges in designing multimodal recommendation systems</h4>
<div class="ltx_para" id="Ch5.S1.SS2.p1">
<p class="ltx_p" id="Ch5.S1.SS2.p1.1">The development of multimodal recommendation systems faces several challenges.</p>
<ul class="ltx_itemize" id="Ch5.S1.I1">
<li class="ltx_item" id="Ch5.S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ch5.S1.I1.i1.p1">
<p class="ltx_p" id="Ch5.S1.I1.i1.p1.1">First, combining different data modalities to improve recommendation results is not simple. Existing systems learn joint representations that capture information that is shared across modalities (e.g., the text query refers to a visual attribute of the product that is visible in the image), but they ignore complementary aspects that could benefit recommendations <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">guo2019deep</span>]</cite>; e.g., the text mentions inside pockets not visible in the picture, or the image contains texture patterns that are hard to describe precisely in text. Therefore, when learning multimodal representations it is important to ensure adequate alignment of the aspects that need to be aligned, while leaving some flexibility to capture complementary information across modalities as well.
In general we will want the modalities to compensate for one another and result in a more complete joint representation.</p>
</div>
</li>
<li class="ltx_item" id="Ch5.S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ch5.S1.I1.i2.p1">
<p class="ltx_p" id="Ch5.S1.I1.i2.p1.1">Second, collecting aligned data from multiple modalities to train multimodal recommender systems is significantly more difficult than collecting data for individual data modalities. For example, in the unimodal case one can define positive pairs for contrastive learning via data augmentation, but in the multimodal case such positive pairs often need to be annotated (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2" title="5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a>). In practice, existing annotations may be incomplete for some modalities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">rahate2022multimodal</span>]</cite>. For example, visual search with text modification would require examples of an input image, the textual modification, and the modified image, but typically only two of the three are available, e.g., image-caption pairs.</p>
</div>
</li>
<li class="ltx_item" id="Ch5.S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ch5.S1.I1.i3.p1">
<p class="ltx_p" id="Ch5.S1.I1.i3.p1.1">Third, learning a latent space that can be used for generative tasks is often harder than for discriminative tasks, as it typically requires larger datasets and computational resources to be able to adequately learn the data distribution by using more complex losses <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2020generative</span>]</cite>. This challenge is further exacerbated in the case of multimodal data because we need to not only learn a latent representation for each modality but also ensure that these latent representations are adequately aligned.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="Ch5.S1.SS2.p2">
<p class="ltx_p" id="Ch5.S1.SS2.p2.1">Despite these challenges, multimodal generative models are a promising technology for improving recommendation systems. Indeed, recent literature shows tremendous advances on the necessary components to achieve effective multimodal generative models for recommender systems, including
1) the use of LLMs and diffusion models to generate synthetic data for labeling purposes <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">brooks2023instructpix2pix</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">rosenbaum2022clasp</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">nguyen2024dataset</span>]</cite>,
2) high quality unimodal encoders and decoders <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2022masked</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">kirillov2023segment</span>]</cite>,
3) better techniques for aligning the latent spaces from multiple modalities into a shared one <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">radford2021learning</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2022blip</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">girdhar2023imagebind</span>]</cite>,
4) efficient re-parametrizations and training algorithms <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jang2016categorical</span>]</cite>, and
5) techniques to inject structure to the learned latent space to make the problem tractable <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">croitoru2023diffusion</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2023diffusion</span>]</cite>.
Once trained, generative recommender systems are more versatile, and can produce better recommendations in more general, open ended tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="Ch5.S1.SS3">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1.3 </span>Multimodal recommendation systems covered in this chapter</h4>
<div class="ltx_para" id="Ch5.S1.SS3.p1">
<p class="ltx_p" id="Ch5.S1.SS3.p1.1">In the remainder of this chapter, we will review both contrastive and generative approaches to multimodal recommendation. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S2" title="5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> we will review contrastive approaches, such as CLIP, which learns to map each modality to a common latent space in which the modalities are approximately aligned. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3" title="5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3</span></a> we will discuss generative approaches, such as ContrastVAE, which learns a probabilistic embedding from each modality to a common latent space where modalities are approximately aligned, and DALL-E 2, Stable Diffusion, LLAVA and multimodal LLMs, which learn to generate image recommendations given an input text prompt.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Ch5.S2">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.2 </span>Contrastive Multimodal Recommendation Systems</h3>
<div class="ltx_para" id="Ch5.S2.p1">
<p class="ltx_p" id="Ch5.S2.p1.1">As discussed in Chapter 4.3.1, many recommendation approaches like <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">du2022amazon</span>]</cite> rely on learning an embedding of the data such that similar items are close to each other in the embedded space. In the case of multimodal data, a natural approach to learning a <em class="ltx_emph ltx_font_italic" id="Ch5.S2.p1.1.1">multimodal embedding</em> would be to learn one embedding per modality, as done by <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2020momentum</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">10.5555/3495724.3497510</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2020simple</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">Caron_2021_ICCV</span>]</cite> for images, or <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">saeed2021contrastive</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">won2020data</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2022towards</span>]</cite> for audio, and then concatenate such <em class="ltx_emph ltx_font_italic" id="Ch5.S2.p1.1.2">unimodal embeddings</em>. Such an approach is adequate when different modalities capture complementary aspects of an item. However, as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S1.SS2" title="5.1.2 Key challenges in designing multimodal recommendation systems ‣ 5.1 Introduction to Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.1.2</span></a>, when different modalities capture related aspects of an item, unimodal embeddings need to be adequately aligned to ensure that similar items are close to each other in the multimodal embedded space. For example, to ensure that the embedding of a textual description of a product is close to the embedding of an image of the same product we need to learn both embeddings with that constraint in mind, which often requires large amounts of aligned training data (e.g., text-image pairs).
One way to address this challenge is to first learn an alignment between data modalities and then learn a generative model on <em class="ltx_emph ltx_font_italic" id="Ch5.S2.p1.1.3">aligned</em> representations. Hence, in this section we will focus on the problem of learning aligned representations across multiple modalities.</p>
</div>
<div class="ltx_para" id="Ch5.S2.p2">
<p class="ltx_p" id="Ch5.S2.p2.1">A popular approach to learning aligned representations is contrastive learning <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">gutmann2010noise</span>]</cite> which, for a pair of data points from different modalities, minimizes a loss that encourages their embeddings to be close when the points are similar (positive pairs), and far when the points are very different (negative pairs). In the single modality setting, positive pairs are generated by simply altering one sample (e.g., slightly shifting the image, flipping the image, transforming it to grayscale). In the multimodal setting, however, it is hard to generate a corresponding positive pair in the other modality via simple augmentation strategies. Instead, positive pairs are typically obtained by labeling similar pairs in a coarse-grained or fine-grained manner. Coarse-grained labels (e.g., a pair of an image and a caption) are easier to obtain, but they may not be sufficiently discriminative. Fine-grained labels (e.g., a bounding box for each object in the image and the corresponding word in the caption) are harder to obtain, but they provide more detailed correspondences between image regions and words in the caption.</p>
</div>
<section class="ltx_subsection" id="Ch5.S2.SS1">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2.1 </span>Contrastive Language-Image Pre-training (CLIP)</h4>
<div class="ltx_para" id="Ch5.S2.SS1.p1">
<p class="ltx_p" id="Ch5.S2.SS1.p1.1">Contrastive Language-Image Pre-training (CLIP) <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">radford2021learning</span>]</cite> is one of the most popular contrastive learning approaches to multi-modal pre-training. The main idea behind CLIP is that coarse labels in natural language have a sufficient degree of supervision to enable the learning of general concepts, while being much easier to scale using internet data. Indeed, the authors of CLIP found that trying to predict the exact words, as previous works had done, led to very hard training objectives that converged very slowly, due to the variety of ways in which the same information can be conveyed.
Therefore, they proposed to use coarse labels, i.e., to pair an entire image with a caption.</p>
</div>
<div class="ltx_para" id="Ch5.S2.SS1.p2">
<p class="ltx_p" id="Ch5.S2.SS1.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F1" title="Figure 5.1 ‣ 5.2.1 Contrastive Language-Image Pre-training (CLIP) ‣ 5.2 Contrastive Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.1</span></a> shows CLIP’s model architecture, which consists of two towers, an image encoder and a text encoder, that project an input image-text pair to a shared embedding space. Semantically equivalent image-text pairs should be projected to the same point in the embedding space, and unrelated image-text pairs should be projected to far apart points. This is achieved by computing the cosine similarity for all possible image-text pairs in a training minibatch, and applying a symmetric cross-entropy loss over the rows and columns of the similarity matrix.</p>
</div>
<figure class="ltx_figure" id="Ch5.F1">
<p class="ltx_p ltx_align_center" id="Ch5.F1.1"><span class="ltx_text" id="Ch5.F1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="262" id="Ch5.F1.1.1.g1" src="extracted/5860126/fig/CLIP-contrastive_learning.png" width="419"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5.1: </span>Contrastive pre-training used to train models such as CLIP. For each minibatch, the positive (diagonal) and negative (off-diagonal) pairs are used to compute the loss.</figcaption>
</figure>
<div class="ltx_para" id="Ch5.S2.SS1.p3">
<p class="ltx_p" id="Ch5.S2.SS1.p3.1">To be effective, CLIP was trained on a large dataset of 400 million image and text pairs, obtained from downloading images and their associated <span class="ltx_text ltx_font_italic" id="Ch5.S2.SS1.p3.1.1">alt-text</span> (text to be displayed in place of an image that fails to load) from the Internet. The dataset was curated to guarantee coverage of concepts by balancing the word occurrences, and filtering with methods like making sure each text included at least one word from a pre-defined list obtained from Wikipedia data to remove noisy or irrelevant image-text pairs.
While aligning crawled Internet images and their alt-text is bound to find many irrelevant or misleading examples, dataset curation techniques to improve the quality of training samples <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">cao2023less</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">fan2023improving</span>]</cite>, or to reduce harmful or undesired examples <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bansal2023cleanclip</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yu2023devil</span>]</cite> have proven useful to improve results. Furthermore, scaling up the datasets to billion-scale <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">schuhmann2022laion</span>]</cite> has shown that noisy examples not previously removed can be cancelled by overwhelming numbers of positive ones, resulting in better overall performance <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">jia2021scaling</span></cite>.</p>
</div>
<div class="ltx_para" id="Ch5.S2.SS1.p4">
<p class="ltx_p" id="Ch5.S2.SS1.p4.1">The simple idea behind CLIP demonstrated to scale very well and achieved state-of-the-art in many zero-shot benchmarks. For example, it obtained impressive zero-shot classification and retrieval results <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">novack2023chils</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">baldrati2023zero</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">hendriksen2022extending</span>]</cite>, and has been successfully fine-tuned to a multitude of tasks, such as object detection <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Gu2021OpenvocabularyOD</span>]</cite>, semantic segmentation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2023zegclip</span>]</cite> or action recognition <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2024froster</span>]</cite>. The same contrastive alignment objective has also been used between other modalities, including audio and images  <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">cheng2020look</span>]</cite>, tables and images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">hager2023best</span>]</cite>, tables and medical images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2023multimodal</span>]</cite>, and with multiple modalities at the same time <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">girdhar2023imagebind</span>]</cite>.
The datasets used for pre-training these models are typically composed of data scrapped from the Internet (e.g., pairs of images and alt-text), generated as a byproduct of another process (e.g., e-commerce purchases <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Chen2023BeyondSL</span>]</cite>, robot sensor logs <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2021cross</span>]</cite>), or automatically generated by an existing ML model (e.g. speech in audio or video <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2021contrastive</span>]</cite>, human poses in images computed with OpenPose <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">cao19openpose</span>]</cite>).</p>
</div>
<div class="ltx_para" id="Ch5.S2.SS1.p5">
<p class="ltx_p" id="Ch5.S2.SS1.p5.1">The generalization ability of CLIP and similar Vision-Language Models (VLM) greatly benefited from scaling the training in model size, batch size, and dataset size <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">pham2023combined</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">cherti2023reproducible</span>]</cite>.
Researchers have also studied how preferring adaptation of the text branch over the language branch affected results <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhai2022lit</span>]</cite>. Furthermore, many approaches have been proposed to improve the semantic accuracy of the resulting models <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2023multimodal</span>]</cite>, such as loss functions to improve the image and text encoders <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2022masked</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">shen2022k</span>]</cite>, or to encourage desirable properties such as multilanguage understanding, interpretability and fairness in the embedding space <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2023stair</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">carlsson2022cross</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">dehdashtianfairerclip</span>]</cite>.
Other interesting improvements include training better encoders with additional loses like image masking <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2022masked</span>]</cite> and Triple Contrastive Learning <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2022vision</span>]</cite>, or enhancing the text with Wikipedia definitions of entities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">shen2022k</span>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="Ch5.S2.SS2">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2.2 </span>Other Contrastive Pre-training Approaches</h4>
<div class="ltx_para" id="Ch5.S2.SS2.p1">
<p class="ltx_p" id="Ch5.S2.SS2.p1.1">Other approaches have looked into novel architecture designs and novel losses to further improve results. Align BEfore Fuse (ALBEF) <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2021align</span>]</cite>, for example, uses a multimodal encoder to combine the text and image embeddings generated from the unimodal encoders, and propose two additional objectives to pre-train a model in addition to the Image-text contrastive (ITC) learning: masked language modeling (MLM) to predict masked words on the unimodal text encoder, and image-text matching (ITM) to classify if a pair of image and text match or not.
The authors also introduce <span class="ltx_text ltx_font_italic" id="Ch5.S2.SS2.p1.1.1">momentum distillation</span>, where a moving average version of the model weights provides pseudo-labels in order to compensate for the potentially incomplete, or wrong, text descriptions in the noisy web training data. Using their proposed architecture and training objectives, ALBEF obtains better results than CLIP in several zero-shot and fine-tuned multimodal benchmarks, despite using orders of magnitude less images for pre-training. In a subsequent work, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">li2022blip</span></cite> replace the multimodal encoder by cross-attention layers to the text tower to model vision-language interactions, and replace the MLM loss by a Language Modelling (LM) loss that trains the model to maximize the likelihood of a generated caption given an image.</p>
</div>
<div class="ltx_para" id="Ch5.S2.SS2.p2">
<p class="ltx_p" id="Ch5.S2.SS2.p2.1">Finally, other works explore how to bring more modalities into alignment. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">girdhar2023imagebind</span></cite> propose ImageBind, an approach to learn an aligned embedding across six different modalities, including text, audio, image, depth, thermal and Inertial Measurement Unit (IMU) data. Instead of requiring paired data for all modalities, they only rely on readily available paired data between image and other modalities (e.g., web scale text-image data, audio for a video clip or depth in RGBD images). All modality encoders use transformer networks and the joint model is learned using the InfoNCE loss.</p>
</div>
<div class="ltx_para" id="Ch5.S2.SS2.p3">
<p class="ltx_p" id="Ch5.S2.SS2.p3.1">These contrastive multimodal models can then be used in multimodal recommendation systems such as <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sevegnani2022contrastive</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">alpay2023multimodal</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023next</span>]</cite>. They are also used to initialize the weights of generative multimodal systems, that will make the generative training much more tractable.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Ch5.S3">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.3 </span>Generative Multimodal Recommendation Systems</h3>
<div class="ltx_para" id="Ch5.S3.p1">
<p class="ltx_p" id="Ch5.S3.p1.1">Despite their advantages, purely contrastive recommendation systems often suffer from data sparsity and data uncertainty <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2022contrastvae</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2023contrastive</span>]</cite>. For example, users may provide reviews for very few items and some of them may have errors. Generative models address these issues by imposing structure on the data generation process, e.g., by using latent variable models, and by adequately modeling uncertainty. Moreover, generative models allow for more complex recommendations, e.g., those involving image generation.</p>
</div>
<div class="ltx_para" id="Ch5.S3.p2">
<p class="ltx_p" id="Ch5.S3.p2.2">In this section, we will survey generative recommendation systems that utilize multiple modalities in order to better understand the user, or provide the recommendations. Depending on how the generative models are designed and learned, we will distinguish between three types of models: Generative Adversarial Networks (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS1" title="5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3.1</span></a>), Variational AutoEncoders (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS2" title="5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3.2</span></a>), and Diffusion Models (see Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3" title="5.3.3 Diffusion Models for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3.3</span></a>). All these three types of models posit the existence of a latent variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.p2.1.m1.1"><semantics id="Ch5.S3.p2.1.m1.1a"><mi id="Ch5.S3.p2.1.m1.1.1" xref="Ch5.S3.p2.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.p2.1.m1.1b"><ci id="Ch5.S3.p2.1.m1.1.1.cmml" xref="Ch5.S3.p2.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.p2.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.p2.1.m1.1d">italic_Z</annotation></semantics></math> (continuous or discrete) such that the distribution of the data <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.p2.2.m2.1"><semantics id="Ch5.S3.p2.2.m2.1a"><mi id="Ch5.S3.p2.2.m2.1.1" xref="Ch5.S3.p2.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.p2.2.m2.1b"><ci id="Ch5.S3.p2.2.m2.1.1.cmml" xref="Ch5.S3.p2.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.p2.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.p2.2.m2.1d">italic_X</annotation></semantics></math> (e.g., image and text) can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="Ch5.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(X)=\int p(X\mid Z)p(Z)dZ." class="ltx_Math" display="block" id="Ch5.E1.m1.3"><semantics id="Ch5.E1.m1.3a"><mrow id="Ch5.E1.m1.3.3.1" xref="Ch5.E1.m1.3.3.1.1.cmml"><mrow id="Ch5.E1.m1.3.3.1.1" xref="Ch5.E1.m1.3.3.1.1.cmml"><mrow id="Ch5.E1.m1.3.3.1.1.3" xref="Ch5.E1.m1.3.3.1.1.3.cmml"><mi id="Ch5.E1.m1.3.3.1.1.3.2" xref="Ch5.E1.m1.3.3.1.1.3.2.cmml">p</mi><mo id="Ch5.E1.m1.3.3.1.1.3.1" xref="Ch5.E1.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="Ch5.E1.m1.3.3.1.1.3.3.2" xref="Ch5.E1.m1.3.3.1.1.3.cmml"><mo id="Ch5.E1.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="Ch5.E1.m1.1.1" xref="Ch5.E1.m1.1.1.cmml">X</mi><mo id="Ch5.E1.m1.3.3.1.1.3.3.2.2" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="Ch5.E1.m1.3.3.1.1.2" rspace="0.111em" xref="Ch5.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="Ch5.E1.m1.3.3.1.1.1" xref="Ch5.E1.m1.3.3.1.1.1.cmml"><mo id="Ch5.E1.m1.3.3.1.1.1.2" xref="Ch5.E1.m1.3.3.1.1.1.2.cmml">∫</mo><mrow id="Ch5.E1.m1.3.3.1.1.1.1" xref="Ch5.E1.m1.3.3.1.1.1.1.cmml"><mi id="Ch5.E1.m1.3.3.1.1.1.1.3" xref="Ch5.E1.m1.3.3.1.1.1.1.3.cmml">p</mi><mo id="Ch5.E1.m1.3.3.1.1.1.1.2" xref="Ch5.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.E1.m1.3.3.1.1.1.1.1.1" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="Ch5.E1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.E1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Ch5.E1.m1.3.3.1.1.1.1.2a" xref="Ch5.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="Ch5.E1.m1.3.3.1.1.1.1.4" xref="Ch5.E1.m1.3.3.1.1.1.1.4.cmml">p</mi><mo id="Ch5.E1.m1.3.3.1.1.1.1.2b" xref="Ch5.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.E1.m1.3.3.1.1.1.1.5.2" xref="Ch5.E1.m1.3.3.1.1.1.1.cmml"><mo id="Ch5.E1.m1.3.3.1.1.1.1.5.2.1" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.1.1.cmml">(</mo><mi id="Ch5.E1.m1.2.2" xref="Ch5.E1.m1.2.2.cmml">Z</mi><mo id="Ch5.E1.m1.3.3.1.1.1.1.5.2.2" stretchy="false" xref="Ch5.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="Ch5.E1.m1.3.3.1.1.1.1.2c" lspace="0em" xref="Ch5.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.E1.m1.3.3.1.1.1.1.6" xref="Ch5.E1.m1.3.3.1.1.1.1.6.cmml"><mo id="Ch5.E1.m1.3.3.1.1.1.1.6.1" rspace="0em" xref="Ch5.E1.m1.3.3.1.1.1.1.6.1.cmml">𝑑</mo><mi id="Ch5.E1.m1.3.3.1.1.1.1.6.2" xref="Ch5.E1.m1.3.3.1.1.1.1.6.2.cmml">Z</mi></mrow></mrow></mrow></mrow><mo id="Ch5.E1.m1.3.3.1.2" lspace="0em" xref="Ch5.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Ch5.E1.m1.3b"><apply id="Ch5.E1.m1.3.3.1.1.cmml" xref="Ch5.E1.m1.3.3.1"><eq id="Ch5.E1.m1.3.3.1.1.2.cmml" xref="Ch5.E1.m1.3.3.1.1.2"></eq><apply id="Ch5.E1.m1.3.3.1.1.3.cmml" xref="Ch5.E1.m1.3.3.1.1.3"><times id="Ch5.E1.m1.3.3.1.1.3.1.cmml" xref="Ch5.E1.m1.3.3.1.1.3.1"></times><ci id="Ch5.E1.m1.3.3.1.1.3.2.cmml" xref="Ch5.E1.m1.3.3.1.1.3.2">𝑝</ci><ci id="Ch5.E1.m1.1.1.cmml" xref="Ch5.E1.m1.1.1">𝑋</ci></apply><apply id="Ch5.E1.m1.3.3.1.1.1.cmml" xref="Ch5.E1.m1.3.3.1.1.1"><int id="Ch5.E1.m1.3.3.1.1.1.2.cmml" xref="Ch5.E1.m1.3.3.1.1.1.2"></int><apply id="Ch5.E1.m1.3.3.1.1.1.1.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1"><times id="Ch5.E1.m1.3.3.1.1.1.1.2.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.2"></times><ci id="Ch5.E1.m1.3.3.1.1.1.1.3.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.3">𝑝</ci><apply id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.1.1.1.3">𝑍</ci></apply><ci id="Ch5.E1.m1.3.3.1.1.1.1.4.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.4">𝑝</ci><ci id="Ch5.E1.m1.2.2.cmml" xref="Ch5.E1.m1.2.2">𝑍</ci><apply id="Ch5.E1.m1.3.3.1.1.1.1.6.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.6"><csymbol cd="latexml" id="Ch5.E1.m1.3.3.1.1.1.1.6.1.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.6.1">differential-d</csymbol><ci id="Ch5.E1.m1.3.3.1.1.1.1.6.2.cmml" xref="Ch5.E1.m1.3.3.1.1.1.1.6.2">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.E1.m1.3c">p(X)=\int p(X\mid Z)p(Z)dZ.</annotation><annotation encoding="application/x-llamapun" id="Ch5.E1.m1.3d">italic_p ( italic_X ) = ∫ italic_p ( italic_X ∣ italic_Z ) italic_p ( italic_Z ) italic_d italic_Z .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Ch5.S3.p2.4">The main differences among these models are how the prior <math alttext="p(Z)" class="ltx_Math" display="inline" id="Ch5.S3.p2.3.m1.1"><semantics id="Ch5.S3.p2.3.m1.1a"><mrow id="Ch5.S3.p2.3.m1.1.2" xref="Ch5.S3.p2.3.m1.1.2.cmml"><mi id="Ch5.S3.p2.3.m1.1.2.2" xref="Ch5.S3.p2.3.m1.1.2.2.cmml">p</mi><mo id="Ch5.S3.p2.3.m1.1.2.1" xref="Ch5.S3.p2.3.m1.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.p2.3.m1.1.2.3.2" xref="Ch5.S3.p2.3.m1.1.2.cmml"><mo id="Ch5.S3.p2.3.m1.1.2.3.2.1" stretchy="false" xref="Ch5.S3.p2.3.m1.1.2.cmml">(</mo><mi id="Ch5.S3.p2.3.m1.1.1" xref="Ch5.S3.p2.3.m1.1.1.cmml">Z</mi><mo id="Ch5.S3.p2.3.m1.1.2.3.2.2" stretchy="false" xref="Ch5.S3.p2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.p2.3.m1.1b"><apply id="Ch5.S3.p2.3.m1.1.2.cmml" xref="Ch5.S3.p2.3.m1.1.2"><times id="Ch5.S3.p2.3.m1.1.2.1.cmml" xref="Ch5.S3.p2.3.m1.1.2.1"></times><ci id="Ch5.S3.p2.3.m1.1.2.2.cmml" xref="Ch5.S3.p2.3.m1.1.2.2">𝑝</ci><ci id="Ch5.S3.p2.3.m1.1.1.cmml" xref="Ch5.S3.p2.3.m1.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.p2.3.m1.1c">p(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.p2.3.m1.1d">italic_p ( italic_Z )</annotation></semantics></math> and posterior <math alttext="p(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.p2.4.m2.1"><semantics id="Ch5.S3.p2.4.m2.1a"><mrow id="Ch5.S3.p2.4.m2.1.1" xref="Ch5.S3.p2.4.m2.1.1.cmml"><mi id="Ch5.S3.p2.4.m2.1.1.3" xref="Ch5.S3.p2.4.m2.1.1.3.cmml">p</mi><mo id="Ch5.S3.p2.4.m2.1.1.2" xref="Ch5.S3.p2.4.m2.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.p2.4.m2.1.1.1.1" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.cmml"><mo id="Ch5.S3.p2.4.m2.1.1.1.1.2" stretchy="false" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.p2.4.m2.1.1.1.1.1" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.cmml"><mi id="Ch5.S3.p2.4.m2.1.1.1.1.1.2" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.p2.4.m2.1.1.1.1.1.1" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.p2.4.m2.1.1.1.1.1.3" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.p2.4.m2.1.1.1.1.3" stretchy="false" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.p2.4.m2.1b"><apply id="Ch5.S3.p2.4.m2.1.1.cmml" xref="Ch5.S3.p2.4.m2.1.1"><times id="Ch5.S3.p2.4.m2.1.1.2.cmml" xref="Ch5.S3.p2.4.m2.1.1.2"></times><ci id="Ch5.S3.p2.4.m2.1.1.3.cmml" xref="Ch5.S3.p2.4.m2.1.1.3">𝑝</ci><apply id="Ch5.S3.p2.4.m2.1.1.1.1.1.cmml" xref="Ch5.S3.p2.4.m2.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.p2.4.m2.1.1.1.1.1.1.cmml" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.p2.4.m2.1.1.1.1.1.2.cmml" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.p2.4.m2.1.1.1.1.1.3.cmml" xref="Ch5.S3.p2.4.m2.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.p2.4.m2.1c">p(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.p2.4.m2.1d">italic_p ( italic_X ∣ italic_Z )</annotation></semantics></math> are defined and parametrized with deep networks, and what losses are used to learn the network weights from data. The following subsections describe each one of these models in more detail, how network architectures are modified to accomodate multimodal data, and how these models are used for building recommendation systems.</p>
</div>
<section class="ltx_subsection" id="Ch5.S3.SS1">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3.1 </span>Generative Adversarial Networks for Multimodal Recommendation</h4>
<div class="ltx_para" id="Ch5.S3.SS1.p1">
<p class="ltx_p" id="Ch5.S3.SS1.p1.1">Proposed by <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">goodfellow2014generative</span></cite>, Generative Adversarial Networks (GANs) are an innovative approach to learning a distribution from multimodal data. GANs have been used in various recommender systems, including collaborative filtering <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2023multi</span>]</cite> and content-based retrieval <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">tautkute2021want</span>]</cite>. In this subsection, we will briefly summarize the basic formulation of GANs for unimodal data, show how it can be extended to multimodal data, and discuss adaptations of GANs for collaborative filtering and content-based retrieval.</p>
</div>
<figure class="ltx_figure" id="Ch5.F2">
<p class="ltx_p ltx_align_center" id="Ch5.F2.1"><span class="ltx_text" id="Ch5.F2.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="251" id="Ch5.F2.1.1.g1" src="extracted/5860126/fig/ch5_gans.png" width="479"/></span></p>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5.2: </span>Generative Adversarial Networks (GANs) are composed of a generator <math alttext="G" class="ltx_Math" display="inline" id="Ch5.F2.5.m1.1"><semantics id="Ch5.F2.5.m1.1b"><mi id="Ch5.F2.5.m1.1.1" xref="Ch5.F2.5.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Ch5.F2.5.m1.1c"><ci id="Ch5.F2.5.m1.1.1.cmml" xref="Ch5.F2.5.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F2.5.m1.1d">G</annotation><annotation encoding="application/x-llamapun" id="Ch5.F2.5.m1.1e">italic_G</annotation></semantics></math> that generates a data point (e.g. an image) from a latent variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.F2.6.m2.1"><semantics id="Ch5.F2.6.m2.1b"><mi id="Ch5.F2.6.m2.1.1" xref="Ch5.F2.6.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.F2.6.m2.1c"><ci id="Ch5.F2.6.m2.1.1.cmml" xref="Ch5.F2.6.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F2.6.m2.1d">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.F2.6.m2.1e">italic_Z</annotation></semantics></math>, and a discriminator <math alttext="D" class="ltx_Math" display="inline" id="Ch5.F2.7.m3.1"><semantics id="Ch5.F2.7.m3.1b"><mi id="Ch5.F2.7.m3.1.1" xref="Ch5.F2.7.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.F2.7.m3.1c"><ci id="Ch5.F2.7.m3.1.1.cmml" xref="Ch5.F2.7.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F2.7.m3.1d">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.F2.7.m3.1e">italic_D</annotation></semantics></math> which tries to determine if a data point is fake (synthesized by the generator) or real. Left: Standard GAN architecture for unconditional generation. Center: Conditional GAN architecture. Right: Multimodal GAN architecture.</figcaption>
</figure>
<section class="ltx_paragraph" id="Ch5.S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Unimodal GANs</h5>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px1.p1.16">As discussed in Section 3.5.5, GANs are a class of latent variable models in which a generator maps a latent variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.1.m1.1d">italic_Z</annotation></semantics></math> to a sample data point <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.2.m2.1d">italic_X</annotation></semantics></math>, while a discriminator <math alttext="D" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.3.m3.1d">italic_D</annotation></semantics></math> decides whether its input is real or generated (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F2" title="Figure 5.2 ‣ 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> left). More specifically, GANs learn a probability distribution as in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.E1" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.1</span></a>), where <math alttext="p(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.2.2">𝑝</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1c">p(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.4.m4.1d">italic_p ( italic_Z )</annotation></semantics></math> denotes the prior which is typically assumed to be a standard Gaussian (continuous) or categorical (discrete) and <math alttext="p(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1"><times id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1c">p(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.5.m5.1d">italic_p ( italic_X ∣ italic_Z )</annotation></semantics></math> denotes the posterior. What is unique in GANs is that the posterior <math alttext="p(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1"><times id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1c">p(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.6.m6.1d">italic_p ( italic_X ∣ italic_Z )</annotation></semantics></math> is not modeled explicitly (e.g., as a Gaussian). Instead, the posterior is represented by a generator <math alttext="G:\mathcal{Z}\to\mathcal{X}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.1" lspace="0.278em" rspace="0.278em" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml">:</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml">𝒵</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml">𝒳</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.1">:</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.2">𝐺</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.1">→</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2">𝒵</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1c">G:\mathcal{Z}\to\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.7.m7.1d">italic_G : caligraphic_Z → caligraphic_X</annotation></semantics></math> that produces samples <math alttext="G(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.2.2">𝐺</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1c">G(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.8.m8.1d">italic_G ( italic_Z )</annotation></semantics></math> from <math alttext="p(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1"><times id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1c">p(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.9.m9.1d">italic_p ( italic_X ∣ italic_Z )</annotation></semantics></math> without having to represent <math alttext="p(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1"><times id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1c">p(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.10.m10.1d">italic_p ( italic_X ∣ italic_Z )</annotation></semantics></math>. Then, a second component of a GAN is the discriminator <math alttext="D:\mathcal{X}\to\{0,1\}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.1" lspace="0.278em" rspace="0.278em" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.1.cmml">:</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.2.cmml">𝒳</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.1.cmml">→</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.1.cmml">{</mo><mn id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml">0</mn><mo id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.1.cmml">,</mo><mn id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.2.cmml">1</mn><mo id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.2.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.1">:</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.2">𝐷</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.1">→</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.2">𝒳</ci><set id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.3.3.3.2"><cn id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.1.1">0</cn><cn id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.2.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2.2">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2c">D:\mathcal{X}\to\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.11.m11.2d">italic_D : caligraphic_X → { 0 , 1 }</annotation></semantics></math>, which is designed to discriminate real from generated images, i.e., <math alttext="D(X)=1" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.cmml"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.1.cmml">=</mo><mn id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2"><eq id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.1"></eq><apply id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.2.2">𝐷</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.1">𝑋</ci></apply><cn id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1c">D(X)=1</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.12.m12.1d">italic_D ( italic_X ) = 1</annotation></semantics></math> if <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.13.m13.1d">italic_X</annotation></semantics></math> is real and <math alttext="D(X)=0" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.cmml"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.1.cmml">=</mo><mn id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2"><eq id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.1"></eq><apply id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.2.2">𝐷</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.1">𝑋</ci></apply><cn id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1c">D(X)=0</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.14.m14.1d">italic_D ( italic_X ) = 0</annotation></semantics></math> if <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.15.m15.1d">italic_X</annotation></semantics></math> is generated. The generator and discriminator are then jointly learned from samples of <math alttext="p(X)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.2.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.2.2">𝑝</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1c">p(X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.16.m16.1d">italic_p ( italic_X )</annotation></semantics></math> by optimizing a min-max objective</p>
<table class="ltx_equation ltx_eqn_table" id="Ch5.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{G}\max_{D}\mathbb{E}_{X\sim p(X)}[\log D(X)]+\mathbb{E}_{Z\sim p(Z)}[%
\log(1-D(G(Z))]" class="ltx_math_unparsed" display="block" id="Ch5.E2.m1.4"><semantics id="Ch5.E2.m1.4a"><mrow id="Ch5.E2.m1.4b"><munder id="Ch5.E2.m1.4.5"><mi id="Ch5.E2.m1.4.5.2">min</mi><mi id="Ch5.E2.m1.4.5.3">G</mi></munder><munder id="Ch5.E2.m1.4.6"><mi id="Ch5.E2.m1.4.6.2">max</mi><mi id="Ch5.E2.m1.4.6.3">D</mi></munder><msub id="Ch5.E2.m1.4.7"><mi id="Ch5.E2.m1.4.7.2">𝔼</mi><mrow id="Ch5.E2.m1.1.1.1"><mi id="Ch5.E2.m1.1.1.1.3">X</mi><mo id="Ch5.E2.m1.1.1.1.2">∼</mo><mrow id="Ch5.E2.m1.1.1.1.4"><mi id="Ch5.E2.m1.1.1.1.4.2">p</mi><mo id="Ch5.E2.m1.1.1.1.4.1">⁢</mo><mrow id="Ch5.E2.m1.1.1.1.4.3.2"><mo id="Ch5.E2.m1.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="Ch5.E2.m1.1.1.1.1">X</mi><mo id="Ch5.E2.m1.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow id="Ch5.E2.m1.4.8"><mo id="Ch5.E2.m1.4.8.1" stretchy="false">[</mo><mi id="Ch5.E2.m1.4.8.2">log</mi><mi id="Ch5.E2.m1.4.8.3">D</mi><mrow id="Ch5.E2.m1.4.8.4"><mo id="Ch5.E2.m1.4.8.4.1" stretchy="false">(</mo><mi id="Ch5.E2.m1.3.3">X</mi><mo id="Ch5.E2.m1.4.8.4.2" stretchy="false">)</mo></mrow><mo id="Ch5.E2.m1.4.8.5" stretchy="false">]</mo></mrow><mo id="Ch5.E2.m1.4.9">+</mo><msub id="Ch5.E2.m1.4.10"><mi id="Ch5.E2.m1.4.10.2">𝔼</mi><mrow id="Ch5.E2.m1.2.2.1"><mi id="Ch5.E2.m1.2.2.1.3">Z</mi><mo id="Ch5.E2.m1.2.2.1.2">∼</mo><mrow id="Ch5.E2.m1.2.2.1.4"><mi id="Ch5.E2.m1.2.2.1.4.2">p</mi><mo id="Ch5.E2.m1.2.2.1.4.1">⁢</mo><mrow id="Ch5.E2.m1.2.2.1.4.3.2"><mo id="Ch5.E2.m1.2.2.1.4.3.2.1" stretchy="false">(</mo><mi id="Ch5.E2.m1.2.2.1.1">Z</mi><mo id="Ch5.E2.m1.2.2.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow id="Ch5.E2.m1.4.11"><mo id="Ch5.E2.m1.4.11.1" stretchy="false">[</mo><mi id="Ch5.E2.m1.4.11.2">log</mi><mrow id="Ch5.E2.m1.4.11.3"><mo id="Ch5.E2.m1.4.11.3.1" stretchy="false">(</mo><mn id="Ch5.E2.m1.4.11.3.2">1</mn><mo id="Ch5.E2.m1.4.11.3.3">−</mo><mi id="Ch5.E2.m1.4.11.3.4">D</mi><mrow id="Ch5.E2.m1.4.11.3.5"><mo id="Ch5.E2.m1.4.11.3.5.1" stretchy="false">(</mo><mi id="Ch5.E2.m1.4.11.3.5.2">G</mi><mrow id="Ch5.E2.m1.4.11.3.5.3"><mo id="Ch5.E2.m1.4.11.3.5.3.1" stretchy="false">(</mo><mi id="Ch5.E2.m1.4.4">Z</mi><mo id="Ch5.E2.m1.4.11.3.5.3.2" stretchy="false">)</mo></mrow><mo id="Ch5.E2.m1.4.11.3.5.4" stretchy="false">)</mo></mrow><mo id="Ch5.E2.m1.4.11.3.6" stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Ch5.E2.m1.4c">\min_{G}\max_{D}\mathbb{E}_{X\sim p(X)}[\log D(X)]+\mathbb{E}_{Z\sim p(Z)}[%
\log(1-D(G(Z))]</annotation><annotation encoding="application/x-llamapun" id="Ch5.E2.m1.4d">roman_min start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_X ∼ italic_p ( italic_X ) end_POSTSUBSCRIPT [ roman_log italic_D ( italic_X ) ] + blackboard_E start_POSTSUBSCRIPT italic_Z ∼ italic_p ( italic_Z ) end_POSTSUBSCRIPT [ roman_log ( 1 - italic_D ( italic_G ( italic_Z ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px1.p1.22">in which the generator <math alttext="G" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.17.m1.1d">italic_G</annotation></semantics></math> tries to generate samples that fool the discriminator <math alttext="D" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.18.m2.1d">italic_D</annotation></semantics></math>, while <math alttext="D" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.19.m3.1d">italic_D</annotation></semantics></math> tries to discriminate between real samples <math alttext="X\sim P(X)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.1.cmml">∼</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.2.cmml">P</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.1">similar-to</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.2">𝑋</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3"><times id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.2.3.2">𝑃</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1.1">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1c">X\sim P(X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.20.m4.1d">italic_X ∼ italic_P ( italic_X )</annotation></semantics></math> and generated samples <math alttext="G(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2"><times id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.2.2">𝐺</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1c">G(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.21.m5.1d">italic_G ( italic_Z )</annotation></semantics></math>, <math alttext="Z\sim P(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.2.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.1.cmml">∼</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.2.cmml">P</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.1">similar-to</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.2">𝑍</ci><apply id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3"><times id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.1"></times><ci id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.2.3.2">𝑃</ci><ci id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1c">Z\sim P(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p1.22.m6.1d">italic_Z ∼ italic_P ( italic_Z )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px1.p2.11">One advantage of GANs is that sampling is straightforward: all we need to do is to sample <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.1.m1.1d">italic_Z</annotation></semantics></math> (e.g., categorical or standard Gaussian) and pass it through the generator to produce <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.2.m2.1d">italic_X</annotation></semantics></math>. Another advantage is that, in the ideal case in which <math alttext="G" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1c">G</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.3.m3.1d">italic_G</annotation></semantics></math> and <math alttext="D" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.4.m4.1d">italic_D</annotation></semantics></math> have infinite capacity, one can show that the optimal discriminator <math alttext="D^{*}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1a"><msup id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.2">𝐷</ci><times id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1c">D^{*}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.5.m5.1d">italic_D start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> can’t tell true from generated (i.e., <math alttext="D^{*}(X)=1/2" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.cmml"><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.cmml"><msup id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.3.cmml">∗</mo></msup><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.1.cmml">=</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.cmml"><mn id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.2.cmml">1</mn><mo id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.1.cmml">/</mo><mn id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2"><eq id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.1"></eq><apply id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2"><times id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.1"></times><apply id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.2">𝐷</ci><times id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.2.2.3"></times></apply><ci id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.1">𝑋</ci></apply><apply id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3"><divide id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.1"></divide><cn id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.2.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.2">1</cn><cn id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1c">D^{*}(X)=1/2</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.6.m6.1d">italic_D start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_X ) = 1 / 2</annotation></semantics></math>) and the optimal generator <math alttext="G^{*}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1a"><msup id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.2">𝐺</ci><times id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1c">G^{*}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.7.m7.1d">italic_G start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is such that the distribution of the generated data <math alttext="G^{*}(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1a"><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.cmml"><msup id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.3" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.3.cmml">∗</mo></msup><mo id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.cmml"><mo id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1b"><apply id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2"><times id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.1"></times><apply id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.2">𝐺</ci><times id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.2.2.3"></times></apply><ci id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1c">G^{*}(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.8.m8.1d">italic_G start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_Z )</annotation></semantics></math> matches the distribution of the true data <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.9.m9.1d">italic_X</annotation></semantics></math>.
In practice, <math alttext="D" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1c">D</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.10.m10.1d">italic_D</annotation></semantics></math> and <math alttext="G" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1"><semantics id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1a"><mi id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1.1" xref="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1b"><ci id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1c">G</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px1.p2.11.m11.1d">italic_G</annotation></semantics></math> are parametrized with neural networks, and the expectation in the min-max objective is computed as the average over samples. As a consequence, while there is no guarantee that GANs learn the true distribution of the data, in the case of images it has been empirically shown that GANs produce high quality generations.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px1.p3">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px1.p3.1">Despite these advantages, GANs also suffer from some limitations. One of them is the issue of mode collapse, which happens when the generator produces samples that are not representative of the full data distribution, such as generating only the most likely outputs, or a specific output that fools the discriminator <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang19vanishing</span>]</cite>. GANs also suffer from training instabilities due to the nature of the min-max objective optimized by the generator and discriminator networks. For example, <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">arjovsky17waserstein</span>]</cite> show that a small change in one network leads to major adjustments in the other, which can result in destabilizing the learning process and failing to converge. Moreover, gradient vanishing problems happen when one network dominates the other, e.g., when the discriminator becomes very accurate and produces a loss with little gradient information for the generator <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Su2018GANQPAN</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">Chakraborty_2024</span>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Multimodal GANs</h5>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p1.2">The vanilla GAN formulation discussed so far assumes that <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p1.1.m1.1d">italic_X</annotation></semantics></math> is generic, i.e., <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p1.2.m2.1d">italic_X</annotation></semantics></math> can be unimodal or multimodal. In principle, we could use such a vanilla formulation to learn generative models for multimodal data. However, doing so may require collecting, annotating and aligning very large datasets and using them to train a very complex multimodal generator. In practice, it may be preferable to design specialized models that leverage existing unimodal generators, such as models that can generate one modality conditioned on another, or models that can ensure adequate alignment across modalities.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p2.2">Conditional GANs (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F2" title="Figure 5.2 ‣ 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> center) generate data for data modality <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.1.m1.1d">italic_X</annotation></semantics></math> conditioned on another modality <math alttext="Y" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.2.m2.1d">italic_Y</annotation></semantics></math>, such as the product type, a textual description of a product, an image mask, etc. In this case, the goal is to learn a conditional model of the form</p>
<table class="ltx_equation ltx_eqn_table" id="Ch5.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(X\mid Y)=\int p(X\mid Z,Y)p(Z)dZ." class="ltx_Math" display="block" id="Ch5.E3.m1.4"><semantics id="Ch5.E3.m1.4a"><mrow id="Ch5.E3.m1.4.4.1" xref="Ch5.E3.m1.4.4.1.1.cmml"><mrow id="Ch5.E3.m1.4.4.1.1" xref="Ch5.E3.m1.4.4.1.1.cmml"><mrow id="Ch5.E3.m1.4.4.1.1.1" xref="Ch5.E3.m1.4.4.1.1.1.cmml"><mi id="Ch5.E3.m1.4.4.1.1.1.3" xref="Ch5.E3.m1.4.4.1.1.1.3.cmml">p</mi><mo id="Ch5.E3.m1.4.4.1.1.1.2" xref="Ch5.E3.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.E3.m1.4.4.1.1.1.1.1" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.cmml"><mo id="Ch5.E3.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.E3.m1.4.4.1.1.1.1.1.1" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.cmml"><mi id="Ch5.E3.m1.4.4.1.1.1.1.1.1.2" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.E3.m1.4.4.1.1.1.1.1.1.1" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.E3.m1.4.4.1.1.1.1.1.1.3" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.3.cmml">Y</mi></mrow><mo id="Ch5.E3.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.E3.m1.4.4.1.1.3" rspace="0.111em" xref="Ch5.E3.m1.4.4.1.1.3.cmml">=</mo><mrow id="Ch5.E3.m1.4.4.1.1.2" xref="Ch5.E3.m1.4.4.1.1.2.cmml"><mo id="Ch5.E3.m1.4.4.1.1.2.2" xref="Ch5.E3.m1.4.4.1.1.2.2.cmml">∫</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1" xref="Ch5.E3.m1.4.4.1.1.2.1.cmml"><mi id="Ch5.E3.m1.4.4.1.1.2.1.3" xref="Ch5.E3.m1.4.4.1.1.2.1.3.cmml">p</mi><mo id="Ch5.E3.m1.4.4.1.1.2.1.2" xref="Ch5.E3.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1.1.1" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="Ch5.E3.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.2" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.2.cmml">X</mi><mo id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.1" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.1.cmml">∣</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.2" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.1.cmml"><mi id="Ch5.E3.m1.1.1" xref="Ch5.E3.m1.1.1.cmml">Z</mi><mo id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.2.1" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.1.cmml">,</mo><mi id="Ch5.E3.m1.2.2" xref="Ch5.E3.m1.2.2.cmml">Y</mi></mrow></mrow><mo id="Ch5.E3.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="Ch5.E3.m1.4.4.1.1.2.1.2a" xref="Ch5.E3.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mi id="Ch5.E3.m1.4.4.1.1.2.1.4" xref="Ch5.E3.m1.4.4.1.1.2.1.4.cmml">p</mi><mo id="Ch5.E3.m1.4.4.1.1.2.1.2b" xref="Ch5.E3.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1.5.2" xref="Ch5.E3.m1.4.4.1.1.2.1.cmml"><mo id="Ch5.E3.m1.4.4.1.1.2.1.5.2.1" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.2.1.cmml">(</mo><mi id="Ch5.E3.m1.3.3" xref="Ch5.E3.m1.3.3.cmml">Z</mi><mo id="Ch5.E3.m1.4.4.1.1.2.1.5.2.2" stretchy="false" xref="Ch5.E3.m1.4.4.1.1.2.1.cmml">)</mo></mrow><mo id="Ch5.E3.m1.4.4.1.1.2.1.2c" lspace="0em" xref="Ch5.E3.m1.4.4.1.1.2.1.2.cmml">⁢</mo><mrow id="Ch5.E3.m1.4.4.1.1.2.1.6" xref="Ch5.E3.m1.4.4.1.1.2.1.6.cmml"><mo id="Ch5.E3.m1.4.4.1.1.2.1.6.1" rspace="0em" xref="Ch5.E3.m1.4.4.1.1.2.1.6.1.cmml">𝑑</mo><mi id="Ch5.E3.m1.4.4.1.1.2.1.6.2" xref="Ch5.E3.m1.4.4.1.1.2.1.6.2.cmml">Z</mi></mrow></mrow></mrow></mrow><mo id="Ch5.E3.m1.4.4.1.2" lspace="0em" xref="Ch5.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Ch5.E3.m1.4b"><apply id="Ch5.E3.m1.4.4.1.1.cmml" xref="Ch5.E3.m1.4.4.1"><eq id="Ch5.E3.m1.4.4.1.1.3.cmml" xref="Ch5.E3.m1.4.4.1.1.3"></eq><apply id="Ch5.E3.m1.4.4.1.1.1.cmml" xref="Ch5.E3.m1.4.4.1.1.1"><times id="Ch5.E3.m1.4.4.1.1.1.2.cmml" xref="Ch5.E3.m1.4.4.1.1.1.2"></times><ci id="Ch5.E3.m1.4.4.1.1.1.3.cmml" xref="Ch5.E3.m1.4.4.1.1.1.3">𝑝</ci><apply id="Ch5.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="Ch5.E3.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.E3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="Ch5.E3.m1.4.4.1.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="Ch5.E3.m1.4.4.1.1.2.cmml" xref="Ch5.E3.m1.4.4.1.1.2"><int id="Ch5.E3.m1.4.4.1.1.2.2.cmml" xref="Ch5.E3.m1.4.4.1.1.2.2"></int><apply id="Ch5.E3.m1.4.4.1.1.2.1.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1"><times id="Ch5.E3.m1.4.4.1.1.2.1.2.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.2"></times><ci id="Ch5.E3.m1.4.4.1.1.2.1.3.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.3">𝑝</ci><apply id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1"><csymbol cd="latexml" id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.2">𝑋</ci><list id="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.1.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.1.1.1.3.2"><ci id="Ch5.E3.m1.1.1.cmml" xref="Ch5.E3.m1.1.1">𝑍</ci><ci id="Ch5.E3.m1.2.2.cmml" xref="Ch5.E3.m1.2.2">𝑌</ci></list></apply><ci id="Ch5.E3.m1.4.4.1.1.2.1.4.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.4">𝑝</ci><ci id="Ch5.E3.m1.3.3.cmml" xref="Ch5.E3.m1.3.3">𝑍</ci><apply id="Ch5.E3.m1.4.4.1.1.2.1.6.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.6"><csymbol cd="latexml" id="Ch5.E3.m1.4.4.1.1.2.1.6.1.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.6.1">differential-d</csymbol><ci id="Ch5.E3.m1.4.4.1.1.2.1.6.2.cmml" xref="Ch5.E3.m1.4.4.1.1.2.1.6.2">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.E3.m1.4c">p(X\mid Y)=\int p(X\mid Z,Y)p(Z)dZ.</annotation><annotation encoding="application/x-llamapun" id="Ch5.E3.m1.4d">italic_p ( italic_X ∣ italic_Y ) = ∫ italic_p ( italic_X ∣ italic_Z , italic_Y ) italic_p ( italic_Z ) italic_d italic_Z .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p2.8">To model <math alttext="p(X\mid Z,Y)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.3" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.1.cmml">∣</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.2.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.2.2.cmml">Y</mi></mrow></mrow><mo id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3b"><apply id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3"><times id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.2"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.2">𝑋</ci><list id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3.3.1.1.1.3.2"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.1.1">𝑍</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.2.2">𝑌</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3c">p(X\mid Z,Y)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.3.m1.3d">italic_p ( italic_X ∣ italic_Z , italic_Y )</annotation></semantics></math>, the generator must take both <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.4.m2.1d">italic_Z</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.5.m3.1d">italic_Y</annotation></semantics></math> as inputs to generate samples <math alttext="G(Z,Y)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.2.cmml">G</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.1.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.1.cmml">,</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.2.cmml">Y</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.2.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2b"><apply id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3"><times id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.1"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.2">𝐺</ci><interval closure="open" id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.3.3.2"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.1.1">𝑍</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2c">G(Z,Y)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.6.m4.2d">italic_G ( italic_Z , italic_Y )</annotation></semantics></math>. Likewise, the discriminator <math alttext="D(X,Y)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.2.cmml">D</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.1.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.1.1.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.1.cmml">,</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.2.cmml">Y</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.2.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2b"><apply id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3"><times id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.1"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.2">𝐷</ci><interval closure="open" id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.3.3.2"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.1.1">𝑋</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2c">D(X,Y)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.7.m5.2d">italic_D ( italic_X , italic_Y )</annotation></semantics></math> must also depend on the conditioning variable <math alttext="Y" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1c">Y</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p2.8.m6.1d">italic_Y</annotation></semantics></math>. Different modalities can be used for the condition; examples are class-conditioning <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">MirzaO14conditional</span>]</cite>, conditioning on an input image <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">isola17pix2pix</span>]</cite>, or using a latent code vector <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen16infogan</span>]</cite>. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2022multimodal</span></cite> proposed an approach to allow conditioning on multiple input modalities (e.g., text, sketch, segmentation mask) to generate new images. This allowed very fine-grained control of the generated image layout and content. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">ziegler2022multi</span></cite> also use conditioning on multi-modal clinical tabular data for the generation of realistic 3D medical images.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p3.4">Alternatively, we may want to generate multiple data modalities. For the sake of simplicity, assume that the data is composed of two modalities <math alttext="X=(X^{1},X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.4" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.4.cmml">X</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.3.cmml">=</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.3.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.3.cmml">(</mo><msup id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.4" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.3.cmml">,</mo><msup id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.5" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2"><eq id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.3"></eq><ci id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.4.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.4">𝑋</ci><interval closure="open" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2c">X=(X^{1},X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.1.m1.2d">italic_X = ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. We can design a multimodal generator that leverages unimodal generators by assuming that <math alttext="X^{1}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1a"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1c">X^{1}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.2.m2.1d">italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="X^{2}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1a"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1c">X^{2}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.3.m3.1d">italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> are conditionally independent given <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.4.m4.1d">italic_Z</annotation></semantics></math>. Under these assumptions, the model in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.E1" title="In 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.1</span></a>) factorizes as the product of two unimodal models because</p>
<table class="ltx_equation ltx_eqn_table" id="Ch5.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(X^{1},X^{2})=\int p(X^{1},X^{2}\mid Z)p(Z)dZ=\int p(X^{1}\mid Z)p(X^{2}\mid Z%
)p(Z)dZ." class="ltx_Math" display="block" id="Ch5.E4.m1.3"><semantics id="Ch5.E4.m1.3a"><mrow id="Ch5.E4.m1.3.3.1" xref="Ch5.E4.m1.3.3.1.1.cmml"><mrow id="Ch5.E4.m1.3.3.1.1" xref="Ch5.E4.m1.3.3.1.1.cmml"><mrow id="Ch5.E4.m1.3.3.1.1.2" xref="Ch5.E4.m1.3.3.1.1.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.2.4" xref="Ch5.E4.m1.3.3.1.1.2.4.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.2.3" xref="Ch5.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.2.2.2" xref="Ch5.E4.m1.3.3.1.1.2.2.3.cmml"><mo id="Ch5.E4.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.2.2.3.cmml">(</mo><msup id="Ch5.E4.m1.3.3.1.1.1.1.1.1" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1.cmml"><mi id="Ch5.E4.m1.3.3.1.1.1.1.1.1.2" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.1.1.1.1.3" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.2.2.2.4" xref="Ch5.E4.m1.3.3.1.1.2.2.3.cmml">,</mo><msup id="Ch5.E4.m1.3.3.1.1.2.2.2.2" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.2.2.2.2.2" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.2.2.2.2.3" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.2.2.2.5" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Ch5.E4.m1.3.3.1.1.8" rspace="0.111em" xref="Ch5.E4.m1.3.3.1.1.8.cmml">=</mo><mrow id="Ch5.E4.m1.3.3.1.1.4" xref="Ch5.E4.m1.3.3.1.1.4.cmml"><mo id="Ch5.E4.m1.3.3.1.1.4.3" xref="Ch5.E4.m1.3.3.1.1.4.3.cmml">∫</mo><mrow id="Ch5.E4.m1.3.3.1.1.4.2" xref="Ch5.E4.m1.3.3.1.1.4.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.4.2.4" xref="Ch5.E4.m1.3.3.1.1.4.2.4.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.4.2.3" xref="Ch5.E4.m1.3.3.1.1.4.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.4.2.2.2" xref="Ch5.E4.m1.3.3.1.1.4.2.2.3.cmml"><mo id="Ch5.E4.m1.3.3.1.1.4.2.2.2.3" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.4.2.2.3.cmml">(</mo><msup id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.cmml"><mi id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.2" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.3" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.4.2.2.2.4" xref="Ch5.E4.m1.3.3.1.1.4.2.2.3.cmml">,</mo><mrow id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.cmml"><msup id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.2" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.3" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.1" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.1.cmml">∣</mo><mi id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.3" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.3.cmml">Z</mi></mrow><mo id="Ch5.E4.m1.3.3.1.1.4.2.2.2.5" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.4.2.2.3.cmml">)</mo></mrow><mo id="Ch5.E4.m1.3.3.1.1.4.2.3a" xref="Ch5.E4.m1.3.3.1.1.4.2.3.cmml">⁢</mo><mi id="Ch5.E4.m1.3.3.1.1.4.2.5" xref="Ch5.E4.m1.3.3.1.1.4.2.5.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.4.2.3b" xref="Ch5.E4.m1.3.3.1.1.4.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.4.2.6.2" xref="Ch5.E4.m1.3.3.1.1.4.2.cmml"><mo id="Ch5.E4.m1.3.3.1.1.4.2.6.2.1" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.4.2.cmml">(</mo><mi id="Ch5.E4.m1.1.1" xref="Ch5.E4.m1.1.1.cmml">Z</mi><mo id="Ch5.E4.m1.3.3.1.1.4.2.6.2.2" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.4.2.cmml">)</mo></mrow><mo id="Ch5.E4.m1.3.3.1.1.4.2.3c" lspace="0em" xref="Ch5.E4.m1.3.3.1.1.4.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.4.2.7" xref="Ch5.E4.m1.3.3.1.1.4.2.7.cmml"><mo id="Ch5.E4.m1.3.3.1.1.4.2.7.1" rspace="0em" xref="Ch5.E4.m1.3.3.1.1.4.2.7.1.cmml">𝑑</mo><mi id="Ch5.E4.m1.3.3.1.1.4.2.7.2" xref="Ch5.E4.m1.3.3.1.1.4.2.7.2.cmml">Z</mi></mrow></mrow></mrow><mo id="Ch5.E4.m1.3.3.1.1.9" rspace="0.111em" xref="Ch5.E4.m1.3.3.1.1.9.cmml">=</mo><mrow id="Ch5.E4.m1.3.3.1.1.6" xref="Ch5.E4.m1.3.3.1.1.6.cmml"><mo id="Ch5.E4.m1.3.3.1.1.6.3" xref="Ch5.E4.m1.3.3.1.1.6.3.cmml">∫</mo><mrow id="Ch5.E4.m1.3.3.1.1.6.2" xref="Ch5.E4.m1.3.3.1.1.6.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.6.2.4" xref="Ch5.E4.m1.3.3.1.1.6.2.4.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.6.2.3" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.5.1.1.1" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.cmml"><mo id="Ch5.E4.m1.3.3.1.1.5.1.1.1.2" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.cmml">(</mo><mrow id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.cmml"><msup id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.2" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.3" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.3.cmml">1</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.1" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.3" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.E4.m1.3.3.1.1.5.1.1.1.3" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.cmml">)</mo></mrow><mo id="Ch5.E4.m1.3.3.1.1.6.2.3a" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mi id="Ch5.E4.m1.3.3.1.1.6.2.5" xref="Ch5.E4.m1.3.3.1.1.6.2.5.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.6.2.3b" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.6.2.2.1" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.cmml"><mo id="Ch5.E4.m1.3.3.1.1.6.2.2.1.2" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.cmml">(</mo><mrow id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.cmml"><msup id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.cmml"><mi id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.2" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.2.cmml">X</mi><mn id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.3" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.3.cmml">2</mn></msup><mo id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.1" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.1.cmml">∣</mo><mi id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.3" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.E4.m1.3.3.1.1.6.2.2.1.3" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.cmml">)</mo></mrow><mo id="Ch5.E4.m1.3.3.1.1.6.2.3c" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mi id="Ch5.E4.m1.3.3.1.1.6.2.6" xref="Ch5.E4.m1.3.3.1.1.6.2.6.cmml">p</mi><mo id="Ch5.E4.m1.3.3.1.1.6.2.3d" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.6.2.7.2" xref="Ch5.E4.m1.3.3.1.1.6.2.cmml"><mo id="Ch5.E4.m1.3.3.1.1.6.2.7.2.1" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.6.2.cmml">(</mo><mi id="Ch5.E4.m1.2.2" xref="Ch5.E4.m1.2.2.cmml">Z</mi><mo id="Ch5.E4.m1.3.3.1.1.6.2.7.2.2" stretchy="false" xref="Ch5.E4.m1.3.3.1.1.6.2.cmml">)</mo></mrow><mo id="Ch5.E4.m1.3.3.1.1.6.2.3e" lspace="0em" xref="Ch5.E4.m1.3.3.1.1.6.2.3.cmml">⁢</mo><mrow id="Ch5.E4.m1.3.3.1.1.6.2.8" xref="Ch5.E4.m1.3.3.1.1.6.2.8.cmml"><mo id="Ch5.E4.m1.3.3.1.1.6.2.8.1" rspace="0em" xref="Ch5.E4.m1.3.3.1.1.6.2.8.1.cmml">𝑑</mo><mi id="Ch5.E4.m1.3.3.1.1.6.2.8.2" xref="Ch5.E4.m1.3.3.1.1.6.2.8.2.cmml">Z</mi></mrow></mrow></mrow></mrow><mo id="Ch5.E4.m1.3.3.1.2" lspace="0em" xref="Ch5.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Ch5.E4.m1.3b"><apply id="Ch5.E4.m1.3.3.1.1.cmml" xref="Ch5.E4.m1.3.3.1"><and id="Ch5.E4.m1.3.3.1.1a.cmml" xref="Ch5.E4.m1.3.3.1"></and><apply id="Ch5.E4.m1.3.3.1.1b.cmml" xref="Ch5.E4.m1.3.3.1"><eq id="Ch5.E4.m1.3.3.1.1.8.cmml" xref="Ch5.E4.m1.3.3.1.1.8"></eq><apply id="Ch5.E4.m1.3.3.1.1.2.cmml" xref="Ch5.E4.m1.3.3.1.1.2"><times id="Ch5.E4.m1.3.3.1.1.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.2.3"></times><ci id="Ch5.E4.m1.3.3.1.1.2.4.cmml" xref="Ch5.E4.m1.3.3.1.1.2.4">𝑝</ci><interval closure="open" id="Ch5.E4.m1.3.3.1.1.2.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.2.2.2"><apply id="Ch5.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.2.2.2.2.1.cmml" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.2.2.2.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.2.2.2.2.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.2.2.2.2.3">2</cn></apply></interval></apply><apply id="Ch5.E4.m1.3.3.1.1.4.cmml" xref="Ch5.E4.m1.3.3.1.1.4"><int id="Ch5.E4.m1.3.3.1.1.4.3.cmml" xref="Ch5.E4.m1.3.3.1.1.4.3"></int><apply id="Ch5.E4.m1.3.3.1.1.4.2.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2"><times id="Ch5.E4.m1.3.3.1.1.4.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.3"></times><ci id="Ch5.E4.m1.3.3.1.1.4.2.4.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.4">𝑝</ci><interval closure="open" id="Ch5.E4.m1.3.3.1.1.4.2.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2"><apply id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.2.cmml" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.3.1.1.1.1.3">1</cn></apply><apply id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2"><csymbol cd="latexml" id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.1.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.1">conditional</csymbol><apply id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.1.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.2.3">2</cn></apply><ci id="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.2.2.2.3">𝑍</ci></apply></interval><ci id="Ch5.E4.m1.3.3.1.1.4.2.5.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.5">𝑝</ci><ci id="Ch5.E4.m1.1.1.cmml" xref="Ch5.E4.m1.1.1">𝑍</ci><apply id="Ch5.E4.m1.3.3.1.1.4.2.7.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.7"><csymbol cd="latexml" id="Ch5.E4.m1.3.3.1.1.4.2.7.1.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.7.1">differential-d</csymbol><ci id="Ch5.E4.m1.3.3.1.1.4.2.7.2.cmml" xref="Ch5.E4.m1.3.3.1.1.4.2.7.2">𝑍</ci></apply></apply></apply></apply><apply id="Ch5.E4.m1.3.3.1.1c.cmml" xref="Ch5.E4.m1.3.3.1"><eq id="Ch5.E4.m1.3.3.1.1.9.cmml" xref="Ch5.E4.m1.3.3.1.1.9"></eq><share href="https://arxiv.org/html/2409.10993v1#Ch5.E4.m1.3.3.1.1.4.cmml" id="Ch5.E4.m1.3.3.1.1d.cmml" xref="Ch5.E4.m1.3.3.1"></share><apply id="Ch5.E4.m1.3.3.1.1.6.cmml" xref="Ch5.E4.m1.3.3.1.1.6"><int id="Ch5.E4.m1.3.3.1.1.6.3.cmml" xref="Ch5.E4.m1.3.3.1.1.6.3"></int><apply id="Ch5.E4.m1.3.3.1.1.6.2.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2"><times id="Ch5.E4.m1.3.3.1.1.6.2.3.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.3"></times><ci id="Ch5.E4.m1.3.3.1.1.6.2.4.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.4">𝑝</ci><apply id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1"><csymbol cd="latexml" id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.1">conditional</csymbol><apply id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.1.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.2.3">1</cn></apply><ci id="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.3.cmml" xref="Ch5.E4.m1.3.3.1.1.5.1.1.1.1.3">𝑍</ci></apply><ci id="Ch5.E4.m1.3.3.1.1.6.2.5.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.5">𝑝</ci><apply id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1"><csymbol cd="latexml" id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.1.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.1">conditional</csymbol><apply id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2"><csymbol cd="ambiguous" id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.1.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2">superscript</csymbol><ci id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.2.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.2">𝑋</ci><cn id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.3.cmml" type="integer" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.2.3">2</cn></apply><ci id="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.3.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.2.1.1.3">𝑍</ci></apply><ci id="Ch5.E4.m1.3.3.1.1.6.2.6.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.6">𝑝</ci><ci id="Ch5.E4.m1.2.2.cmml" xref="Ch5.E4.m1.2.2">𝑍</ci><apply id="Ch5.E4.m1.3.3.1.1.6.2.8.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.8"><csymbol cd="latexml" id="Ch5.E4.m1.3.3.1.1.6.2.8.1.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.8.1">differential-d</csymbol><ci id="Ch5.E4.m1.3.3.1.1.6.2.8.2.cmml" xref="Ch5.E4.m1.3.3.1.1.6.2.8.2">𝑍</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.E4.m1.3c">p(X^{1},X^{2})=\int p(X^{1},X^{2}\mid Z)p(Z)dZ=\int p(X^{1}\mid Z)p(X^{2}\mid Z%
)p(Z)dZ.</annotation><annotation encoding="application/x-llamapun" id="Ch5.E4.m1.3d">italic_p ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = ∫ italic_p ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z ) italic_p ( italic_Z ) italic_d italic_Z = ∫ italic_p ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∣ italic_Z ) italic_p ( italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z ) italic_p ( italic_Z ) italic_d italic_Z .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5.4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p3.11">Therefore, we can use one generator per modality, <math alttext="X^{1}=G^{1}(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.1.cmml">=</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.2.cmml">G</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2"><eq id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.1"></eq><apply id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.2.3">1</cn></apply><apply id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3"><times id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.1"></times><apply id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.2">𝐺</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.2.3.2.3">1</cn></apply><ci id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1c">X^{1}=G^{1}(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.5.m1.1d">italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT = italic_G start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ( italic_Z )</annotation></semantics></math> and <math alttext="X^{2}=G^{2}(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.1.cmml">=</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.2.cmml">G</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.3.2.1" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.cmml">(</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.1.cmml">Z</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.3.2.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2"><eq id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.1"></eq><apply id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.3">2</cn></apply><apply id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3"><times id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.1"></times><apply id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.2">𝐺</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.3">2</cn></apply><ci id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1c">X^{2}=G^{2}(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.6.m2.1d">italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_G start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_Z )</annotation></semantics></math>, to represent <math alttext="p(X^{1}\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1"><times id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.2.3">1</cn></apply><ci id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1c">p(X^{1}\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.7.m3.1d">italic_p ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∣ italic_Z )</annotation></semantics></math> and <math alttext="p(X^{2}\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1a"><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.cmml"><msup id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1"><times id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.2"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.3">𝑝</ci><apply id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.2.3">2</cn></apply><ci id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1c">p(X^{2}\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.8.m4.1d">italic_p ( italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z )</annotation></semantics></math>, respectively. Note, however, that the latent representation <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1a"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1b"><ci id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.9.m5.1d">italic_Z</annotation></semantics></math> must be shared to ensure alignment across modalities. Alternatively, we may want the generators <math alttext="G_{1}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1a"><msub id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.2.cmml">G</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1">subscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.2">𝐺</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1c">G_{1}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.10.m6.1d">italic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G_{2}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1a"><msub id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.2.cmml">G</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1">subscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.2">𝐺</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1c">G_{2}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p3.11.m7.1d">italic_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to have a shared backbone that then splits into separate branches for each modality (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F2" title="Figure 5.2 ‣ 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> top right). For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2024consistent</span></cite> use a StyleGAN backbone with three modality specific branches.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px2.p4">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px2.p4.3">Regarding the design of multimodal discriminators, we note that the discriminator should take generated data for both modalities and compare it with the true data for both modalities. To leverage pre-trained discriminators for each specific modality, say <math alttext="D_{1}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1a"><msub id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml">D</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1">subscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.2">𝐷</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1c">D_{1}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p4.1.m1.1d">italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="D_{2}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1a"><msub id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.2.cmml">D</mi><mn id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1">subscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.2">𝐷</ci><cn id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.3.cmml" type="integer" xref="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1c">D_{2}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p4.2.m2.1d">italic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, we could simply fuse the predictions of unimodal discriminators. Alternatively, we could fuse intermediate features from unimodal discriminators and have a simple discriminator <math alttext="D_{consistent}" class="ltx_Math" display="inline" id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1"><semantics id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1a"><msub id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.2" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.2.cmml">D</mi><mrow id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.cmml"><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.2" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.2.cmml">c</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.3" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.3.cmml">o</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1a" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.4" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.4.cmml">n</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1b" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.5" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.5.cmml">s</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1c" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.6" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.6.cmml">i</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1d" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.7" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.7.cmml">s</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1e" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.8" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.8.cmml">t</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1f" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.9" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.9.cmml">e</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1g" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.10" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.10.cmml">n</mi><mo id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1h" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.11" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.11.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1b"><apply id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1">subscript</csymbol><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.2">𝐷</ci><apply id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3"><times id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.1"></times><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.2.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.2">𝑐</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.3.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.3">𝑜</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.4.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.4">𝑛</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.5.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.5">𝑠</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.6.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.6">𝑖</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.7.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.7">𝑠</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.8.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.8">𝑡</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.9.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.9">𝑒</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.10.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.10">𝑛</ci><ci id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.11.cmml" xref="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1.1.3.11">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1c">D_{consistent}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS1.SSS0.Px2.p4.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_c italic_o italic_n italic_s italic_i italic_s italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT</annotation></semantics></math> predict whether the data is real or fake from the fused representation of both modalities (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F2" title="Figure 5.2 ‣ 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.2</span></a> bottom right).
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2024consistent</span></cite> also use two types of discriminators: <em class="ltx_emph ltx_font_italic" id="Ch5.S3.SS1.SSS0.Px2.p4.3.1">fidelity discriminators</em> are unimodal discriminators that assess the quality of an individual data modality, while <em class="ltx_emph ltx_font_italic" id="Ch5.S3.SS1.SSS0.Px2.p4.3.2">consistency discriminators</em> judge whether two modalities are consistent with each other.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Multimodal GANs for collaborative filtering</h5>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px3.p1.1">As discussed before, a natural approach to building multimodal recommendation systems is to incorporate multiple modalities when learning a latent representation of items and/or users. However, existing multimodal representation learning methods lack robustness to scarce labels for user-item interactions. Self-supervised learning methods address this problem by exploiting supervisory signals in unlabeled data, e.g., by using data augmentation. However, a key challenge is generating augmentations that are consistent across multiple modalities. Recent work <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2023multi</span>]</cite> proposes an adversarial multi-modal self-supervised learning paradigm in which a generator proposes collaborative relations which are then vetted by a discriminator. In addition, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2023multi</span></cite> propose a cross-modal contrastive learning framework for preserving inter-modal semantic commonality and user preference diversity. On the other hand, GANs have been used to model and improve user-item interaction data. For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">gao2021recommender</span></cite> review several works that use GANs to mitigate noise and perform informative sample selection in user preferences data, and to synthesize new samples through data augmentation.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Multimodal GANs for fashion recommendation</h5>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px4.p1.1">Due to its visual nature, GANs have found an application area in fashion-related tasks such as compatible outfit generation, virtual try-on, or product search.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px4.p2">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px4.p2.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2021clothing</span></cite> tackle clothing compatibility learning. Given an image of a clothing product, and a target product category name, the proposed method generates an image of a compatible item with a GAN.
A compatibility matrix representing a style space is used to condition the GAN and
make sure the generated item is compatible with the input one.
The style space is learnt using triplets of anchor with compatible and incompatible clothing items, and additional losses for feature matching, reconstruction, and a discriminator loss.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2023bc</span></cite> propose a method to generate multiple options for compatible clothing simultaneously, with attention to diversity.
They use a style embedding discriminator to provide supervision to the generator through a binary real/fake classification loss, and a compatibility discriminator that uses a contrastive loss. They also include a diversity loss to ensure variety in the generated items.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px4.p3">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px4.p3.1">For virtual try-on, an input garment image, and a target image with a person onto which the garment has to be placed are used. Generators often use several modalities derived from the target image, such as the person mask and a pose image, to condition the generation.
For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2019swapgan</span></cite> take conditional and reference images and transfer the clothing from the person in the conditional image to the one in the reference image. For that, they use a pose map, segmentation map, mask map and head map, derived from the input images. They combine three generators and a discriminator to have a single system for clothing transfer.
Similarly, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">pandey2020poly</span></cite> use segmentation masks, pose estimation and clothing parsing (i.e., detecting all clothing in a picture) to transfer a reference garment in a white background image to a person in a model image. Their proposed system combines multiple tasks previously done by different networks into a single architecture.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS1.SSS0.Px4.p4">
<p class="ltx_p" id="Ch5.S3.SS1.SSS0.Px4.p4.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">tautkute2021want</span></cite> use GANs for query expansion (i.e., augmenting or reformulating the user query to improve retrieval results) on a multimodal fashion product retrieval scenario. Instead of combining or fusing the text and image representations, as is commonly done in multimodal search, they generate an image of the desired product, and then use it for visual search. The authors trained their image generation network using both a discriminator and a triplet loss to make sure the generated image is not too close to the original query image.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Ch5.S3.SS2">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3.2 </span>Variational AutoEncoders for Multimodal Recommendation</h4>
<div class="ltx_para" id="Ch5.S3.SS2.p1">
<p class="ltx_p" id="Ch5.S3.SS2.p1.1">Proposed by <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">Kingma2014</span></cite>, Variational AutoEncoders (VAEs) have been used as a key component of various recommendation systems, including collaborative filtering with implicit feedback <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liang2018variational</span>]</cite>, collaborative filtering with side information <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">karamanolakis2018item</span>]</cite>, and content-based retrieval <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yi2021cross</span>]</cite>. In this subsection, we briefly summarize the formulation of VAEs for unimodal data, and show how it can be extended to multimodal data, including adaptations of VAEs for collaborative filtering and content-based retrieval.</p>
</div>
<figure class="ltx_figure" id="Ch5.F3">
<p class="ltx_p ltx_align_center" id="Ch5.F3.1"><span class="ltx_text" id="Ch5.F3.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="Ch5.F3.1.1.g1" src="extracted/5860126/fig/ch5_vae-gaussian-nobox.png" width="538"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5.3: </span>A Variational AutoEncoder (VAE) is composed of a probabilistic encoder that maps an input data point to a latent distribution from which a latent vector is sampled, and decoded with a probabilistic decoder with the objective of reconstructing the original input. Top: Standard VAE architecture for unconditional generation. Bottom left: Multimodal VAE architecture with a shared encoder and two unimodal decoders. Bottom right: Contrastive VAE architecture with two unimodal encoders and decoders and a contrastive loss for aligning the latent spaces.</figcaption>
</figure>
<section class="ltx_paragraph" id="Ch5.S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Unimodal VAEs</h5>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px1.p1.18">As discussed in Section 3.5.1, VAEs are a class of latent variable models in which a <em class="ltx_emph ltx_font_italic" id="Ch5.S3.SS2.SSS0.Px1.p1.18.1">probabilistic encoder</em> maps the input data <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_X</annotation></semantics></math> to a latent variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_Z</annotation></semantics></math>, and a <em class="ltx_emph ltx_font_italic" id="Ch5.S3.SS2.SSS0.Px1.p1.18.2">probabilistic decoder</em> maps <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_Z</annotation></semantics></math> back to <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.4.m4.1d">italic_X</annotation></semantics></math> (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F3" title="Figure 5.3 ‣ 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3</span></a> top). More specifically, VAEs learn a probability distribution <math alttext="p(X)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.2.cmml">p</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2"><times id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.1"></times><ci id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.2.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1c">p(X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.5.m5.1d">italic_p ( italic_X )</annotation></semantics></math> for data <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.6.m6.1d">italic_X</annotation></semantics></math> (e.g., image or text) by positing the existence of a latent variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.7.m7.1d">italic_Z</annotation></semantics></math> (continuous or discrete) such that <math alttext="p(X)=\int p_{\theta}(X\mid Z)p(Z)dZ" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.cmml"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.2.cmml">p</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.1.1.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.2" rspace="0.111em" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.2.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.2.cmml">∫</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2a" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2.cmml">⁢</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.4" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.4.cmml">p</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2b" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.5.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.5.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.2.2.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.5.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2c" lspace="0em" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.1" rspace="0em" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.1.cmml">𝑑</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.2.cmml">Z</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3"><eq id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.2"></eq><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3"><times id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.1"></times><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.1.1">𝑋</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1"><int id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.2"></int><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.3.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.1.3">𝑍</ci></apply><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.4.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.4">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.2.2">𝑍</ci><apply id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.1">differential-d</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3.3.1.1.6.2">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3c">p(X)=\int p_{\theta}(X\mid Z)p(Z)dZ</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.8.m8.3d">italic_p ( italic_X ) = ∫ italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z ) italic_p ( italic_Z ) italic_d italic_Z</annotation></semantics></math>. The prior <math alttext="p(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.2.cmml">p</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2"><times id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.1"></times><ci id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.2.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1c">p(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.9.m9.1d">italic_p ( italic_Z )</annotation></semantics></math> is typically assumed to be a standard Gaussian (continuous) or uniform (discrete). The posterior <math alttext="p_{\theta}(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.3.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1c">p_{\theta}(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.10.m10.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z )</annotation></semantics></math> is typically assumed to be Gaussian or categorical and is implemented by a neural network (encoder) that maps <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.11.m11.1d">italic_Z</annotation></semantics></math> to the parameters of <math alttext="p_{\theta}(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.3.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1c">p_{\theta}(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.12.m12.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z )</annotation></semantics></math>, e.g., its mean <math alttext="\mu_{\theta}(Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.2.cmml">μ</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2"><times id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.1"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.2">𝜇</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.2.2.3">𝜃</ci></apply><ci id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1c">\mu_{\theta}(Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.13.m13.1d">italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_Z )</annotation></semantics></math>. The posterior <math alttext="p_{\theta}(Z\mid X)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.2.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.3.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1c">p_{\theta}(Z\mid X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.14.m14.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X )</annotation></semantics></math> is typically intractable and thus approximated by a simpler distribution <math alttext="q_{\psi}(Z\mid X)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.2.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.3.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1c">q_{\psi}(Z\mid X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.15.m15.1d">italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X )</annotation></semantics></math> (e.g., Gaussian or categorical) implemented by another neural network (encoder), which maps <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.16.m16.1d">italic_X</annotation></semantics></math> to, e.g., the mean <math alttext="\mu_{\psi}(X)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.cmml"><msub id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.2.cmml">μ</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.1.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2"><times id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.1"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.2">𝜇</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.2.2.3">𝜓</ci></apply><ci id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1c">\mu_{\psi}(X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.17.m17.1d">italic_μ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math>. The weights of the encoder-decoder pair are learned by maximizing a lower bound for the log likelihood <math alttext="\log(p(X))" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.2.2.cmml">log</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1a" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml">⁡</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.2.cmml">p</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.1.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.3.2.1" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.cmml">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.1.1.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.3.2.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1"><log id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.2.2"></log><apply id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.1"></times><ci id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3.3.1.1.1.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.1.1">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3c">\log(p(X))</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.18.m18.3d">roman_log ( italic_p ( italic_X ) )</annotation></semantics></math>, known as the Evidence Lower Bound (ELBO),</p>
<table class="ltx_equation ltx_eqn_table" id="Ch5.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathbb{E}_{Z\sim q_{\psi}(Z\mid X))}\Big{[}\log p_{\theta}(X\mid Z%
)-KL(q_{\psi}(Z\mid X)\mid\mid p_{\theta}(Z\mid X))\Big{]}" class="ltx_math_unparsed" display="block" id="Ch5.E5.m1.1"><semantics id="Ch5.E5.m1.1a"><mrow id="Ch5.E5.m1.1b"><mi class="ltx_font_mathcaligraphic" id="Ch5.E5.m1.1.1">ℒ</mi><mo id="Ch5.E5.m1.1.2">=</mo><msub id="Ch5.E5.m1.1.3"><mi id="Ch5.E5.m1.1.3.2">𝔼</mi><mrow id="Ch5.E5.m1.1.3.3"><mi id="Ch5.E5.m1.1.3.3.1">Z</mi><mo id="Ch5.E5.m1.1.3.3.2">∼</mo><msub id="Ch5.E5.m1.1.3.3.3"><mi id="Ch5.E5.m1.1.3.3.3.2">q</mi><mi id="Ch5.E5.m1.1.3.3.3.3">ψ</mi></msub><mrow id="Ch5.E5.m1.1.3.3.4"><mo id="Ch5.E5.m1.1.3.3.4.1" stretchy="false">(</mo><mi id="Ch5.E5.m1.1.3.3.4.2">Z</mi><mo id="Ch5.E5.m1.1.3.3.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="Ch5.E5.m1.1.3.3.4.4">X</mi><mo id="Ch5.E5.m1.1.3.3.4.5" stretchy="false">)</mo></mrow><mo id="Ch5.E5.m1.1.3.3.5" stretchy="false">)</mo></mrow></msub><mrow id="Ch5.E5.m1.1.4"><mo id="Ch5.E5.m1.1.4.1" maxsize="160%" minsize="160%">[</mo><mi id="Ch5.E5.m1.1.4.2">log</mi><msub id="Ch5.E5.m1.1.4.3"><mi id="Ch5.E5.m1.1.4.3.2">p</mi><mi id="Ch5.E5.m1.1.4.3.3">θ</mi></msub><mrow id="Ch5.E5.m1.1.4.4"><mo id="Ch5.E5.m1.1.4.4.1" stretchy="false">(</mo><mi id="Ch5.E5.m1.1.4.4.2">X</mi><mo id="Ch5.E5.m1.1.4.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="Ch5.E5.m1.1.4.4.4">Z</mi><mo id="Ch5.E5.m1.1.4.4.5" stretchy="false">)</mo></mrow><mo id="Ch5.E5.m1.1.4.5">−</mo><mi id="Ch5.E5.m1.1.4.6">K</mi><mi id="Ch5.E5.m1.1.4.7">L</mi><mrow id="Ch5.E5.m1.1.4.8"><mo id="Ch5.E5.m1.1.4.8.1" stretchy="false">(</mo><msub id="Ch5.E5.m1.1.4.8.2"><mi id="Ch5.E5.m1.1.4.8.2.2">q</mi><mi id="Ch5.E5.m1.1.4.8.2.3">ψ</mi></msub><mrow id="Ch5.E5.m1.1.4.8.3"><mo id="Ch5.E5.m1.1.4.8.3.1" stretchy="false">(</mo><mi id="Ch5.E5.m1.1.4.8.3.2">Z</mi><mo id="Ch5.E5.m1.1.4.8.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="Ch5.E5.m1.1.4.8.3.4">X</mi><mo id="Ch5.E5.m1.1.4.8.3.5" stretchy="false">)</mo></mrow><mo id="Ch5.E5.m1.1.4.8.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="Ch5.E5.m1.1.4.8.5" lspace="0.0835em" rspace="0.167em">∣</mo><msub id="Ch5.E5.m1.1.4.8.6"><mi id="Ch5.E5.m1.1.4.8.6.2">p</mi><mi id="Ch5.E5.m1.1.4.8.6.3">θ</mi></msub><mrow id="Ch5.E5.m1.1.4.8.7"><mo id="Ch5.E5.m1.1.4.8.7.1" stretchy="false">(</mo><mi id="Ch5.E5.m1.1.4.8.7.2">Z</mi><mo id="Ch5.E5.m1.1.4.8.7.3" lspace="0em" rspace="0.167em">∣</mo><mi id="Ch5.E5.m1.1.4.8.7.4">X</mi><mo id="Ch5.E5.m1.1.4.8.7.5" stretchy="false">)</mo></mrow><mo id="Ch5.E5.m1.1.4.8.8" stretchy="false">)</mo></mrow><mo id="Ch5.E5.m1.1.4.9" maxsize="160%" minsize="160%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="Ch5.E5.m1.1c">\mathcal{L}=\mathbb{E}_{Z\sim q_{\psi}(Z\mid X))}\Big{[}\log p_{\theta}(X\mid Z%
)-KL(q_{\psi}(Z\mid X)\mid\mid p_{\theta}(Z\mid X))\Big{]}</annotation><annotation encoding="application/x-llamapun" id="Ch5.E5.m1.1d">caligraphic_L = blackboard_E start_POSTSUBSCRIPT italic_Z ∼ italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X ) ) end_POSTSUBSCRIPT [ roman_log italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z ) - italic_K italic_L ( italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X ) ∣ ∣ italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px1.p1.21">which is the sum of a reconstruction term <math alttext="\log p_{\theta}(X\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.cmml"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.1.cmml">log</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3a" lspace="0.167em" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.cmml">⁡</mo><msub id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1b"><apply id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1"><times id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3"><log id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.1"></log><apply id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1.1.1.1.1.3">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1c">\log p_{\theta}(X\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.19.m1.1d">roman_log italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z )</annotation></semantics></math> and a regularization term <math alttext="KL(q_{\psi}(Z\mid X)\mid\mid p(Z))" class="ltx_math_unparsed" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1a"><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1b"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.2">K</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.3">L</mi><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.1" stretchy="false">(</mo><msub id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.2"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.2.2">q</mi><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.2.3">ψ</mi></msub><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3.1" stretchy="false">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3.2">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3.4">X</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.3.5" stretchy="false">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.5" lspace="0.0835em" rspace="0.167em">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.6">p</mi><mrow id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.7"><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.7.1" stretchy="false">(</mo><mi id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.1">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.7.2" stretchy="false">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1.4.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1c">KL(q_{\psi}(Z\mid X)\mid\mid p(Z))</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.20.m2.1d">italic_K italic_L ( italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X ) ∣ ∣ italic_p ( italic_Z ) )</annotation></semantics></math>. The variable <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1"><semantics id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1a"><mi id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1.1" xref="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1b"><ci id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px1.p1.21.m3.1d">italic_Z</annotation></semantics></math> is then used for downstream recommendation tasks.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Multimodal VAEs</h5>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px2.p1.7">In the case of multimodal data, say <math alttext="X=(X^{1},X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.4.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.3.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">(</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">,</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2b"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2"><eq id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.3"></eq><ci id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.4">𝑋</ci><interval closure="open" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2c">X=(X^{1},X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.1.m1.2d">italic_X = ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> consists of both image and text, we can still use the VAE model described so far. However, as we argued in the case of GANs, doing so may require designing a very complex decoder. A better approach is to design multimodal VAEs that leverage unimodal VAEs. For example, as we did in (<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.E4" title="In Multimodal GANs ‣ 5.3.1 Generative Adversarial Networks for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.4</span></a>), we can assume that <math alttext="X^{1}" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1a"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1c">X^{1}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="X^{2}" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1a"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1c">X^{2}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> are conditionally independent given <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.4.m4.1d">italic_Z</annotation></semantics></math>, i.e., <math alttext="p_{\theta}(X^{1},X^{2}\mid Z)=p_{\theta_{1}}(X^{1}\mid Z)p_{\theta_{2}}(X^{2}%
\mid Z)" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.cmml"><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">(</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">,</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.5" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.5" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.5.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.2.cmml">p</mi><msub id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.2.cmml">θ</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.3.cmml">1</mn></msub></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3a" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3.cmml">⁢</mo><msub id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.2.cmml">p</mi><msub id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.2.cmml">θ</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.3.cmml">2</mn></msub></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3b" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4b"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4"><eq id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.5.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.5"></eq><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2"><times id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.3"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.2.3">2</cn></apply><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.3">𝑍</ci></apply></interval></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4"><times id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.3"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.2">𝑝</ci><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.2">𝜃</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.4.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.2.3">1</cn></apply><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.1.1.1.3">𝑍</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.2">𝑝</ci><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.2">𝜃</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.5.3.3">2</cn></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.2.3">2</cn></apply><ci id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4.4.4.2.1.1.3">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4c">p_{\theta}(X^{1},X^{2}\mid Z)=p_{\theta_{1}}(X^{1}\mid Z)p_{\theta_{2}}(X^{2}%
\mid Z)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.5.m5.4d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z ) = italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∣ italic_Z ) italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z )</annotation></semantics></math>, so that we can use one decoder per modality. However, since the latent space <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1a"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1b"><ci id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.6.m6.1d">italic_Z</annotation></semantics></math> is shared, this requires the design of a shared encoder <math alttext="q_{\psi}(Z\mid X^{1},X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.4" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.4.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.3.cmml">∣</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.3.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.3.cmml">,</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.3.cmml">2</mn></msup></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1b"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1"><times id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.3.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.3">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.4">𝑍</ci><list id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2"><apply id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1c">q_{\psi}(Z\mid X^{1},X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p1.7.m7.1d">italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F3" title="Figure 5.3 ‣ 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.3</span></a> (bottom left) shows the design of such a multimodal VAE with a single probabilistic encoder and two modality specific decoders.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px2.p2.4">To leverage modality specific encoders and decoders pretrained on large datasets, two families of approaches have been proposed. The first family approximates <math alttext="q_{\psi}(Z\mid X^{1},X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.4.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml">∣</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.3.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msup></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1"><times id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.4">𝑍</ci><list id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1c">q_{\psi}(Z\mid X^{1},X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> with a product of experts <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2018multimodal</span>]</cite>, a mixture of experts <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">shi2019variational</span>]</cite>
or a mixture of products of experts <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sutter2020multimodal</span>]</cite>, allowing one to fuse multiple unimodal encoders into a multimodal one. The second family, partitions
the latent space per modality, i.e., <math alttext="Z=(Z^{1},Z^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2"><semantics id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.4.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.3.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.3.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.3.cmml">(</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.3.cmml">,</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.5" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2b"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2"><eq id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.3"></eq><ci id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.4">𝑍</ci><interval closure="open" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2c">Z=(Z^{1},Z^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p2.2.m2.2d">italic_Z = ( italic_Z start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_Z start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, and assume that <math alttext="q_{\psi}(Z\mid X)=q_{\psi}(Z^{1}\mid X^{1})q_{\psi}(Z^{2}\mid X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3"><semantics id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.cmml"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.2.cmml">Z</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.4.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.1.cmml">∣</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.3.cmml">1</mn></msup></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3a" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3.cmml">⁢</mo><msub id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.2.cmml">q</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.3.cmml">ψ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3b" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.1.cmml">∣</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.3.cmml">2</mn></msup></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3b"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3"><eq id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.4"></eq><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1"><times id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.3.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.3">𝑋</ci></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3"><times id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.3"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.4.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.2.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.2">𝑞</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.5.3">𝜓</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.2.3">2</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3.3.3.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3c">q_{\psi}(Z\mid X)=q_{\psi}(Z^{1}\mid X^{1})q_{\psi}(Z^{2}\mid X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p2.3.m3.3d">italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z ∣ italic_X ) = italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∣ italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) italic_q start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_Z start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="p_{\theta}(X\mid Z)=p_{\theta}(X^{1}\mid Z^{1})p_{\theta}(X^{2}\mid Z^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3"><semantics id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3a"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.cmml"><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.4.cmml">=</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.cmml"><msub id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.3.cmml">1</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.1.cmml">∣</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.3.cmml">1</mn></msup></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3a" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3.cmml">⁢</mo><msub id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.2.cmml">p</mi><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.3.cmml">θ</mi></msub><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3b" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.cmml"><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.2" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.cmml">(</mo><mrow id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.cmml"><msup id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.2.cmml">X</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.1" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.1.cmml">∣</mo><msup id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.cmml"><mi id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.2" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.2.cmml">Z</mi><mn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.3" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.3.cmml">2</mn></msup></mrow><mo id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.3" stretchy="false" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3b"><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3"><eq id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.4"></eq><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1"><times id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.2"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.3.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.1.1.1.3">𝑍</ci></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3"><times id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.3"></times><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.4.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.2.3">1</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5">subscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.2">𝑝</ci><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.5.3">𝜃</ci></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1"><csymbol cd="latexml" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.2">𝑋</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.2.3">2</cn></apply><apply id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.1.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3">superscript</csymbol><ci id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.2.cmml" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.2">𝑍</ci><cn id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3.3.3.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3c">p_{\theta}(X\mid Z)=p_{\theta}(X^{1}\mid Z^{1})p_{\theta}(X^{2}\mid Z^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS2.SSS0.Px2.p2.4.m4.3d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X ∣ italic_Z ) = italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∣ italic_Z start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∣ italic_Z start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. However, doing so reduces the entire model to two independent VAEs, one per modality, which defeats the purpose of having a multimodal model. ContrastVAE <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2022contrastvae</span>]</cite> addresses this issue by adding a contrastive loss to the ELBO objective, the InfoNCE loss <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">oord2018representation</span>]</cite>, which aligns the latent spaces of the two modalities. Experiments in  <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2022contrastvae</span></cite> show that ContrastVAE improves upon purely contrastive models by adequately modeling data uncertainty and data sparsity, and being robust to perturbations in the latent space.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Multimodal VAEs for collaborative filtering</h5>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px3.p1.1">Traditional VAEs for recommendation systems are unimodal in nature as they aim to model user ratings. For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liang2018variational</span></cite> extends VAEs to collaborative filtering for implicit feedback by using a multinomial likelihood conditional likelihood.
However, such models often use the standard Gaussian as a prior, which has been shown to give poor latent representations [16]. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">karamanolakis2018item</span></cite> extend VAEs to collaborative filtering with side information. Their key contribution is to replace the standard Gaussian prior in the latent space of the VAE (which is user-agnostic) by a prior that incorporates multimodal user preferences (e.g., user reviews and ratings). The resulting VAE achieves around 30% relative improvement in ranking metric with respect to standard VAEs for collaborative filtering.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Multimodal VAEs for content-based retrieval</h5>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px4.p1.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">yi2021cross</span></cite> proposes a multimodal VAE for content-based retrieval. The proposed approach takes three modalities (music, video, and text), maps each modality to a separate latent space using modality-specific encoders, and then aligns these latent spaces via cross-modal generation. More specifically, the video and text modalities are first fused via a product-of-experts model and the fused representation is passed through a cross-modal decoder that generates music. Conversely, the encoding of music is passed through another crossmodal decoder that generates the visual representation. The resulting representation is trained in 150000 video clips of 3000 different music backgrounds and used to build a music recommendation system.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS2.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Graph VAE for Multimodal Recommendation</h5>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px5.p1.1">In many applications, multimodal data are better represented by a graph. For example, the graph nodes can be items with hand-crafted or learned features from all modalities, while the graph edges can represent item-item similarities. If we want to learn a VAE for the graph and its features, the encoder needs to be able to process a graph as an input and the decoder needs to generate a graph as an output. Graph neural networks (GNNs) are specialized architectures for processing graphs and can be used as both encoders and decoders. The latent space can be a Gaussian vector, as before, or a graph with one Gaussian vector per node. The resulting model is known as a Graph VAE
or GVAE for short <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">kipf2016variational</span>]</cite>, and has been used in various recommendation systems.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px5.p2">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px5.p2.1">One example is the work if
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2024disentangled</span></cite>, which proposes a Disentangled Graph Variational AutoEncoder (DGVAE) for interpretable multimodal recommendation. DGVAE harnesses contrastive pretraining approaches to map multimodal data to a common space in which user-to-item and user-to-word similarities are used to build an item-to-item graph, which is processed by a GNN. Mutual information maximization is used to regularize the learning objective. Experiments show significant improvements in retrieval performance, especially in terms of the interpretability of the recommendations.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS2.SSS0.Px5.p3">
<p class="ltx_p" id="Ch5.S3.SS2.SSS0.Px5.p3.1">Another example is the work of
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">chattopadhyay2023learning</span></cite>, which uses a conditional GVAE to generate decoration recommendations for a room given its type (e.g., bedroom) and its layout (e.g., room elements such as floor and walls). A graph is used to represent both room and furniture layouts, e.g., the nodes capture attributes such as the location, orientation and shape of room and furniture elements, while the edges capture geometric relationships such as relative orientation. Their GVAE then generates a furniture graph, e.g., a collection of furniture items such as bed and night stand that is consistent with the room type and layout, which is then rendered to obtain images of the decorated room. Experiments on the 3D-FRONT dataset show that their method produces scenes that are diverse and adapted to the room layout.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Ch5.S3.SS3">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3.3 </span>Diffusion Models for Multimodal Recommendation</h4>
<div class="ltx_para" id="Ch5.S3.SS3.p1">
<p class="ltx_p" id="Ch5.S3.SS3.p1.1">Diffusion models <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sohl2015deep</span>]</cite> have recently emerged as the state-of-the-art approaches for generation of images and other data modalities. They take inspiration from stochastic differential equations <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Feller1949</span>]</cite>, dynamical systems <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">anderson1982reverse</span>]</cite> and non-equilibrium thermodynamics <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sohl2015deep</span>]</cite> to learn highly complex data distributions.
Several works have used multimodal diffusion models for recommendation. For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zihao23diffurec</span></cite> use diffusion models for sequential recommendation, and <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">seyfioglu2024diffuse</span></cite> propose a fast diffusion model for virtual try-on that takes a picture with a human model and a white background catalog picture of a garment as input, and places the garment on the model. In this subsection we will discuss the basic diffusion model architecture, its extensions to multimodal data, and applications in content generation.</p>
</div>
<figure class="ltx_figure" id="Ch5.F4">
<p class="ltx_p ltx_align_center" id="Ch5.F4.1"><span class="ltx_text" id="Ch5.F4.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="380" id="Ch5.F4.1.1.g1" src="extracted/5860126/fig/ch5_diffusion.png" width="538"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5.4: </span>A diffusion models consists of a forward process, which iteratively corrupts an input data sample until it becomes Gaussian noise, and a reverse process, which reconstruct the original data from white noise. Top: Latent diffusion model architecture for unconditional generation. The standard diffusion model architecture is obtained by removing the encoder <math alttext="p" class="ltx_Math" display="inline" id="Ch5.F4.5.m1.1"><semantics id="Ch5.F4.5.m1.1b"><mi id="Ch5.F4.5.m1.1.1" xref="Ch5.F4.5.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Ch5.F4.5.m1.1c"><ci id="Ch5.F4.5.m1.1.1.cmml" xref="Ch5.F4.5.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F4.5.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="Ch5.F4.5.m1.1e">italic_p</annotation></semantics></math> and the decoder <math alttext="q" class="ltx_Math" display="inline" id="Ch5.F4.6.m2.1"><semantics id="Ch5.F4.6.m2.1b"><mi id="Ch5.F4.6.m2.1.1" xref="Ch5.F4.6.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Ch5.F4.6.m2.1c"><ci id="Ch5.F4.6.m2.1.1.cmml" xref="Ch5.F4.6.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F4.6.m2.1d">q</annotation><annotation encoding="application/x-llamapun" id="Ch5.F4.6.m2.1e">italic_q</annotation></semantics></math>. Bottom: Conditional multimodal diffusion model with a shared encoder and two unimodal decoders. An unconditional multimodal model is obtained by simply removing the condition on <math alttext="Y" class="ltx_Math" display="inline" id="Ch5.F4.7.m3.1"><semantics id="Ch5.F4.7.m3.1b"><mi id="Ch5.F4.7.m3.1.1" xref="Ch5.F4.7.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="Ch5.F4.7.m3.1c"><ci id="Ch5.F4.7.m3.1.1.cmml" xref="Ch5.F4.7.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.F4.7.m3.1d">Y</annotation><annotation encoding="application/x-llamapun" id="Ch5.F4.7.m3.1e">italic_Y</annotation></semantics></math>.</figcaption>
</figure>
<section class="ltx_paragraph" id="Ch5.S3.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Unimodal diffusion models</h5>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px1.p1.12">The main idea behind a diffusion model is to generate a new image by sampling a random Gaussian vector and transforming it via multiple denoising steps. This is done by defining a forward diffusion process<span class="ltx_note ltx_role_footnote" id="Ch5.footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The forward process is also called corruption or noising process, while the reverse process is also called restoration or denoising process.</span></span></span> <math alttext="X\to Z_{1}\to Z_{2}\to\cdots\to Z_{T}" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">→</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.5" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.5.cmml">→</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.3.cmml">2</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.7" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.7.cmml">→</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.8" mathvariant="normal" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.8.cmml">⋯</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.9" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.9.cmml">→</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"><and id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1a.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"></and><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1b.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">→</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝑋</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.3">1</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1c.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.5.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.5">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.4.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1d.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"></share><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.3">2</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1e.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.7.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.7">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.6.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1f.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"></share><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.8.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.8">⋯</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1g.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.9.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.9">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.8.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1h.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1"></share><apply id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1.1.10.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1c">X\to Z_{1}\to Z_{2}\to\cdots\to Z_{T}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_X → italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT → italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT → ⋯ → italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> that iteratively maps a data sample <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_X</annotation></semantics></math> to Gaussian noise <math alttext="Z_{T}" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1a"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1c">Z_{T}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.3.m3.1d">italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, and a reverse diffusion process <math alttext="Z_{T}\to Z_{T-1}\to\cdots\to Z_{1}\to X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.3.cmml">T</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">→</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.2.cmml">Z</mi><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.2.cmml">T</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.1.cmml">−</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.5" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.5.cmml">→</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.6" mathvariant="normal" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.6.cmml">⋯</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.7" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.7.cmml">→</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.9" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.9.cmml">→</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.10" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.10.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"><and id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1a.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"></and><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1b.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">→</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.3">𝑇</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.2">𝑍</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3"><minus id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.1"></minus><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.2">𝑇</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.3.3">1</cn></apply></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1c.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.5.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.5">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.4.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1d.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"></share><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.6.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.6">⋯</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1e.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.7.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.7">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.6.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1f.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"></share><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.3">1</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1g.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.9.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.9">→</ci><share href="https://arxiv.org/html/2409.10993v1#Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.8.cmml" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1h.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1"></share><ci id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.10.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1.1.10">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1c">Z_{T}\to Z_{T-1}\to\cdots\to Z_{1}\to X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.4.m4.1d">italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT → italic_Z start_POSTSUBSCRIPT italic_T - 1 end_POSTSUBSCRIPT → ⋯ → italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT → italic_X</annotation></semantics></math> that recovers the original data from noise. More specifically, diffusion models are VAEs with a sequential latent space <math alttext="Z=(Z_{1},\dots,Z_{T})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.4.cmml">Z</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.3.cmml">=</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml">(</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml">,</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.1.1" mathvariant="normal" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml">…</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.5" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.3.cmml">T</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.6" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3"><eq id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.3"></eq><ci id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.4">𝑍</ci><vector id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.1.1">…</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3.3.2.2.2.3">𝑇</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3c">Z=(Z_{1},\dots,Z_{T})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.5.m5.3d">italic_Z = ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math>. The VAE encoder <math alttext="q(Z\mid X)=q(Z_{1}\mid X)\prod_{t=2}^{T}q(Z_{t}\mid Z_{t-1})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.cmml"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.2.cmml">Z</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.4.cmml">=</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.4.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3a" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.cmml"><msubsup id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.2.cmml">∏</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.1.cmml">=</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.3.cmml">2</mn></mrow><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.3.cmml">T</mi></msubsup><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.3.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.3.cmml">t</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.2.cmml">Z</mi><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3"><eq id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.4"></eq><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.3">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.3">𝑋</ci></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3"><times id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.3"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.4">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.2.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.2.2.2.1.1.1.3">𝑋</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2">superscript</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2">subscript</csymbol><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.2">product</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3"><eq id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.1"></eq><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.2.3">𝑇</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.3">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.2">𝑍</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3"><minus id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.1"></minus><ci id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3.3.3.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3c">q(Z\mid X)=q(Z_{1}\mid X)\prod_{t=2}^{T}q(Z_{t}\mid Z_{t-1})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.6.m6.3d">italic_q ( italic_Z ∣ italic_X ) = italic_q ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∣ italic_X ) ∏ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_q ( italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_Z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> assumes that <math alttext="Z\mid X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml">Z</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1c">Z\mid X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.7.m7.1d">italic_Z ∣ italic_X</annotation></semantics></math> is Markovian with Gaussian transition probabilities <math alttext="q(Z_{t}\mid Z_{t-1})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.2.cmml">Z</mi><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.3">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.2">𝑍</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3"><minus id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.1"></minus><ci id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1c">q(Z_{t}\mid Z_{t-1})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.8.m8.1d">italic_q ( italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_Z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. The VAE decoder <math alttext="p(X\mid Z)=p(Z_{T})p(X\mid Z_{1})\prod_{t=2}^{T}p(Z_{t-1}\mid Z_{t})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.cmml"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.5" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.5.cmml">=</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.5" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.5.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.cmml">(</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.3.cmml">T</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4a" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4.cmml">⁢</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.6" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.6.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4b" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.cmml">)</mo></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4c" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.cmml"><msubsup id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.2.cmml">∏</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.1.cmml">=</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.3.cmml">2</mn></mrow><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.3.cmml">T</mi></msubsup><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.3.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.2.cmml">Z</mi><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4"><eq id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.5.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.5"></eq><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.3">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.2">𝑋</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.3">𝑍</ci></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4"><times id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.4"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.5.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.5">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.2.2.2.1.1.1.3">𝑇</ci></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.6.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.6">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.2">𝑋</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.3.3.3.2.1.1.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2">superscript</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2">subscript</csymbol><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.2">product</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3"><eq id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.1"></eq><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.2.3.3">2</cn></apply></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.2.3">𝑇</ci></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.3">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.2">𝑍</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3"><minus id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.1"></minus><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4.4.4.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4c">p(X\mid Z)=p(Z_{T})p(X\mid Z_{1})\prod_{t=2}^{T}p(Z_{t-1}\mid Z_{t})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.9.m9.4d">italic_p ( italic_X ∣ italic_Z ) = italic_p ( italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) italic_p ( italic_X ∣ italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ∏ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_p ( italic_Z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ∣ italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> assumes that <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.10.m10.1d">italic_Z</annotation></semantics></math> is Markovian with Gaussian transition probabilities <math alttext="p(Z_{t-1}\mid Z_{t})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.cmml">Z</mi><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.3">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2">𝑍</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3"><minus id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.1"></minus><ci id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.2">𝑡</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1c">p(Z_{t-1}\mid Z_{t})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.11.m11.1d">italic_p ( italic_Z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ∣ italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="p(Z_{T})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">(</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml">T</mi></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.3">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1c">p(Z_{T})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p1.12.m12.1d">italic_p ( italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math> a standard Gaussian. The transition probabilities are parametrized with deep networks whose parameters are learned by maximizing the ELBO objective in (<a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.E5" title="In Unimodal VAEs ‣ 5.3.2 Variational AutoEncoders for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.5</span></a>). Once trained, the model can generate high-quality original data examples by sampling from the noise distribution and simulating the reverse diffusion process.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px1.p2.6">The original diffusion model for images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sohl2015deep</span>]</cite> operates directly in the image space. That is, <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.1.m1.1d">italic_X</annotation></semantics></math> is an image and <math alttext="Z_{1},\dots,Z_{T}" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.3.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.3.cmml">,</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.1.1" mathvariant="normal" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml">…</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.4" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.3.cmml">,</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3b"><list id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2"><apply id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.2.2.1.1.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.1.1">…</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3c">Z_{1},\dots,Z_{T}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.2.m2.3d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> are noisy images of the same dimensions as <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.3.m3.1d">italic_X</annotation></semantics></math>. Therefore, the encoder does not need to be trained because <math alttext="q(Z_{1}\mid X)" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.3.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.3">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.2.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1c">q(Z_{1}\mid X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.4.m4.1d">italic_q ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∣ italic_X )</annotation></semantics></math> simply adds noise to the image <math alttext="X" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.5.m5.1d">italic_X</annotation></semantics></math>. This makes the model simpler, since only the decoder needs to be learned. However, generating high-quality samples requires dividing both the forward and backward processes into small steps, which can be computationally costly when <math alttext="T" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p2.6.m6.1d">italic_T</annotation></semantics></math> is large.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px1.p3">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px1.p3.7">To address this issue, stable diffusion <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">rombach2022high</span>]</cite> uses latent variables <math alttext="Z_{1},\dots,Z_{T}" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml">,</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.1.1" mathvariant="normal" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml">…</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.4" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml">,</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.2.cmml">Z</mi><mi id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3b"><list id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2"><apply id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.2.2.1.1.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.1.1">…</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.2">𝑍</ci><ci id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3c">Z_{1},\dots,Z_{T}</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.1.m1.3d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> of smaller dimensions, which makes inference faster, but adds the cost of learning an encoder <math alttext="q(Z_{1}\mid X)" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.3.cmml">q</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml"><msub id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.3">𝑞</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.2.3">1</cn></apply><ci id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1c">q(Z_{1}\mid X)</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.2.m2.1d">italic_q ( italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∣ italic_X )</annotation></semantics></math> and decoder <math alttext="p(X\mid Z_{1})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1a"><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.3.cmml">p</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml"><mo id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.2" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2.cmml">X</mi><mo id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.cmml"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.2" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.2.cmml">Z</mi><mn id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.3" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1b"><apply id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1"><times id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.2"></times><ci id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.3">𝑝</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1"><csymbol cd="latexml" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2">𝑋</ci><apply id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.2.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.2">𝑍</ci><cn id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1c">p(X\mid Z_{1})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.3.m3.1d">italic_p ( italic_X ∣ italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. In practice, pre-trained models are often used for <math alttext="p" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1c">p</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.4.m4.1d">italic_p</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.5.m5.1d">italic_q</annotation></semantics></math> to avoid the training cost. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F4" title="Figure 5.4 ‣ 5.3.3 Diffusion Models for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.4</span></a> (top) shows the architecture of a diffusion model for image generation. The standard diffusion model operated of <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">sohl2015deep</span></cite> operated in pixel space, and thus did not have the <math alttext="p" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1c">p</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.6.m6.1d">italic_p</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1"><semantics id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1a"><mi id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1.1" xref="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1b"><ci id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1c">q</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px1.p3.7.m7.1d">italic_q</annotation></semantics></math> decoder and encoder models.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px1.p4">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px1.p4.1">Even with the addition of latent variables, at inference time diffusion models still require
many evaluation steps <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2023diffusion</span>]</cite>. Recent research has focused on reducing the time spent in the inference process by reducing the number of steps required <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">song2020score</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">karras2022elucidating</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">dockhorn2021score</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">song2020denoising</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lu2022dpm</span>]</cite>, or training a better sampler to directly select the best possible steps <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">watson2021learning</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">salimans2022progressive</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">meng2023distillation</span>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Multimodal diffusion models</h5>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px2.p1.3">In the case of multimodal data, we could also build a multimodal diffusion model as above, say with <math alttext="X=(X^{1},X^{2})" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2"><semantics id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2a"><mrow id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.4" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.4.cmml">X</mi><mo id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.3" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.3.cmml"><mo id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">(</mo><msup id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml">X</mi><mn id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.4" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">,</mo><msup id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.2" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml">X</mi><mn id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msup><mo id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2b"><apply id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2"><eq id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.3"></eq><ci id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.4.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.4">𝑋</ci><interval closure="open" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.3.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2"><apply id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">𝑋</ci><cn id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2">superscript</csymbol><ci id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.2">𝑋</ci><cn id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2c">X=(X^{1},X^{2})</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px2.p1.1.m1.2d">italic_X = ( italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> being images and text. However, two challenges emerge. First, the same challenges of building multimodal encoders and decoders as in VAEs. Second, even if we can build models with separate encoders and decoders per modality, the issue is that diffusion models are not as suitable for text generation as they are for image generation. Specifically, while diffusion models for text generation have been developed, e.g., by using a discrete latent space <math alttext="Z" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px2.p1.2.m2.1d">italic_Z</annotation></semantics></math> with categorical transition probabilities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">austin2021structured</span>]</cite>, text encoders based on transformers or other sequence-to-sequence models are preferred in practice. As a consequence, multimodal models for both text and images, such as text-to-image generation models, combine text encoders with diffusion models for images. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F4" title="Figure 5.4 ‣ 5.3.3 Diffusion Models for Multimodal Recommendation ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.4</span></a> (bottom) shows one possible architecture for such a model. As with the other generative approaches, an additional input <math alttext="Y" class="ltx_Math" display="inline" id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="Ch5.S3.SS3.SSS0.Px2.p1.3.m3.1d">italic_Y</annotation></semantics></math> (e.g., a text description) can be used to condition the generation.<span class="ltx_note ltx_role_footnote" id="Ch5.footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Note that, unlike the case of VAEs where the conditioning affects both the encoder <math alttext="q(Z\mid X,Y)" class="ltx_Math" display="inline" id="Ch5.footnote3.m1.3"><semantics id="Ch5.footnote3.m1.3b"><mrow id="Ch5.footnote3.m1.3.3" xref="Ch5.footnote3.m1.3.3.cmml"><mi id="Ch5.footnote3.m1.3.3.3" xref="Ch5.footnote3.m1.3.3.3.cmml">q</mi><mo id="Ch5.footnote3.m1.3.3.2" xref="Ch5.footnote3.m1.3.3.2.cmml">⁢</mo><mrow id="Ch5.footnote3.m1.3.3.1.1" xref="Ch5.footnote3.m1.3.3.1.1.1.cmml"><mo id="Ch5.footnote3.m1.3.3.1.1.2" stretchy="false" xref="Ch5.footnote3.m1.3.3.1.1.1.cmml">(</mo><mrow id="Ch5.footnote3.m1.3.3.1.1.1" xref="Ch5.footnote3.m1.3.3.1.1.1.cmml"><mi id="Ch5.footnote3.m1.3.3.1.1.1.2" xref="Ch5.footnote3.m1.3.3.1.1.1.2.cmml">Z</mi><mo id="Ch5.footnote3.m1.3.3.1.1.1.1" xref="Ch5.footnote3.m1.3.3.1.1.1.1.cmml">∣</mo><mrow id="Ch5.footnote3.m1.3.3.1.1.1.3.2" xref="Ch5.footnote3.m1.3.3.1.1.1.3.1.cmml"><mi id="Ch5.footnote3.m1.1.1" xref="Ch5.footnote3.m1.1.1.cmml">X</mi><mo id="Ch5.footnote3.m1.3.3.1.1.1.3.2.1" xref="Ch5.footnote3.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="Ch5.footnote3.m1.2.2" xref="Ch5.footnote3.m1.2.2.cmml">Y</mi></mrow></mrow><mo id="Ch5.footnote3.m1.3.3.1.1.3" stretchy="false" xref="Ch5.footnote3.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.footnote3.m1.3c"><apply id="Ch5.footnote3.m1.3.3.cmml" xref="Ch5.footnote3.m1.3.3"><times id="Ch5.footnote3.m1.3.3.2.cmml" xref="Ch5.footnote3.m1.3.3.2"></times><ci id="Ch5.footnote3.m1.3.3.3.cmml" xref="Ch5.footnote3.m1.3.3.3">𝑞</ci><apply id="Ch5.footnote3.m1.3.3.1.1.1.cmml" xref="Ch5.footnote3.m1.3.3.1.1"><csymbol cd="latexml" id="Ch5.footnote3.m1.3.3.1.1.1.1.cmml" xref="Ch5.footnote3.m1.3.3.1.1.1.1">conditional</csymbol><ci id="Ch5.footnote3.m1.3.3.1.1.1.2.cmml" xref="Ch5.footnote3.m1.3.3.1.1.1.2">𝑍</ci><list id="Ch5.footnote3.m1.3.3.1.1.1.3.1.cmml" xref="Ch5.footnote3.m1.3.3.1.1.1.3.2"><ci id="Ch5.footnote3.m1.1.1.cmml" xref="Ch5.footnote3.m1.1.1">𝑋</ci><ci id="Ch5.footnote3.m1.2.2.cmml" xref="Ch5.footnote3.m1.2.2">𝑌</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.footnote3.m1.3d">q(Z\mid X,Y)</annotation><annotation encoding="application/x-llamapun" id="Ch5.footnote3.m1.3e">italic_q ( italic_Z ∣ italic_X , italic_Y )</annotation></semantics></math> and the decoder <math alttext="p(X\mid Z,Y)" class="ltx_Math" display="inline" id="Ch5.footnote3.m2.3"><semantics id="Ch5.footnote3.m2.3b"><mrow id="Ch5.footnote3.m2.3.3" xref="Ch5.footnote3.m2.3.3.cmml"><mi id="Ch5.footnote3.m2.3.3.3" xref="Ch5.footnote3.m2.3.3.3.cmml">p</mi><mo id="Ch5.footnote3.m2.3.3.2" xref="Ch5.footnote3.m2.3.3.2.cmml">⁢</mo><mrow id="Ch5.footnote3.m2.3.3.1.1" xref="Ch5.footnote3.m2.3.3.1.1.1.cmml"><mo id="Ch5.footnote3.m2.3.3.1.1.2" stretchy="false" xref="Ch5.footnote3.m2.3.3.1.1.1.cmml">(</mo><mrow id="Ch5.footnote3.m2.3.3.1.1.1" xref="Ch5.footnote3.m2.3.3.1.1.1.cmml"><mi id="Ch5.footnote3.m2.3.3.1.1.1.2" xref="Ch5.footnote3.m2.3.3.1.1.1.2.cmml">X</mi><mo id="Ch5.footnote3.m2.3.3.1.1.1.1" xref="Ch5.footnote3.m2.3.3.1.1.1.1.cmml">∣</mo><mrow id="Ch5.footnote3.m2.3.3.1.1.1.3.2" xref="Ch5.footnote3.m2.3.3.1.1.1.3.1.cmml"><mi id="Ch5.footnote3.m2.1.1" xref="Ch5.footnote3.m2.1.1.cmml">Z</mi><mo id="Ch5.footnote3.m2.3.3.1.1.1.3.2.1" xref="Ch5.footnote3.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="Ch5.footnote3.m2.2.2" xref="Ch5.footnote3.m2.2.2.cmml">Y</mi></mrow></mrow><mo id="Ch5.footnote3.m2.3.3.1.1.3" stretchy="false" xref="Ch5.footnote3.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.footnote3.m2.3c"><apply id="Ch5.footnote3.m2.3.3.cmml" xref="Ch5.footnote3.m2.3.3"><times id="Ch5.footnote3.m2.3.3.2.cmml" xref="Ch5.footnote3.m2.3.3.2"></times><ci id="Ch5.footnote3.m2.3.3.3.cmml" xref="Ch5.footnote3.m2.3.3.3">𝑝</ci><apply id="Ch5.footnote3.m2.3.3.1.1.1.cmml" xref="Ch5.footnote3.m2.3.3.1.1"><csymbol cd="latexml" id="Ch5.footnote3.m2.3.3.1.1.1.1.cmml" xref="Ch5.footnote3.m2.3.3.1.1.1.1">conditional</csymbol><ci id="Ch5.footnote3.m2.3.3.1.1.1.2.cmml" xref="Ch5.footnote3.m2.3.3.1.1.1.2">𝑋</ci><list id="Ch5.footnote3.m2.3.3.1.1.1.3.1.cmml" xref="Ch5.footnote3.m2.3.3.1.1.1.3.2"><ci id="Ch5.footnote3.m2.1.1.cmml" xref="Ch5.footnote3.m2.1.1">𝑍</ci><ci id="Ch5.footnote3.m2.2.2.cmml" xref="Ch5.footnote3.m2.2.2">𝑌</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.footnote3.m2.3d">p(X\mid Z,Y)</annotation><annotation encoding="application/x-llamapun" id="Ch5.footnote3.m2.3e">italic_p ( italic_X ∣ italic_Z , italic_Y )</annotation></semantics></math>, in the case of diffusion models the conditioning does not affect <math alttext="q(Z_{t}\mid Z_{t-1})" class="ltx_Math" display="inline" id="Ch5.footnote3.m3.1"><semantics id="Ch5.footnote3.m3.1b"><mrow id="Ch5.footnote3.m3.1.1" xref="Ch5.footnote3.m3.1.1.cmml"><mi id="Ch5.footnote3.m3.1.1.3" xref="Ch5.footnote3.m3.1.1.3.cmml">q</mi><mo id="Ch5.footnote3.m3.1.1.2" xref="Ch5.footnote3.m3.1.1.2.cmml">⁢</mo><mrow id="Ch5.footnote3.m3.1.1.1.1" xref="Ch5.footnote3.m3.1.1.1.1.1.cmml"><mo id="Ch5.footnote3.m3.1.1.1.1.2" stretchy="false" xref="Ch5.footnote3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Ch5.footnote3.m3.1.1.1.1.1" xref="Ch5.footnote3.m3.1.1.1.1.1.cmml"><msub id="Ch5.footnote3.m3.1.1.1.1.1.2" xref="Ch5.footnote3.m3.1.1.1.1.1.2.cmml"><mi id="Ch5.footnote3.m3.1.1.1.1.1.2.2" xref="Ch5.footnote3.m3.1.1.1.1.1.2.2.cmml">Z</mi><mi id="Ch5.footnote3.m3.1.1.1.1.1.2.3" xref="Ch5.footnote3.m3.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="Ch5.footnote3.m3.1.1.1.1.1.1" xref="Ch5.footnote3.m3.1.1.1.1.1.1.cmml">∣</mo><msub id="Ch5.footnote3.m3.1.1.1.1.1.3" xref="Ch5.footnote3.m3.1.1.1.1.1.3.cmml"><mi id="Ch5.footnote3.m3.1.1.1.1.1.3.2" xref="Ch5.footnote3.m3.1.1.1.1.1.3.2.cmml">Z</mi><mrow id="Ch5.footnote3.m3.1.1.1.1.1.3.3" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.cmml"><mi id="Ch5.footnote3.m3.1.1.1.1.1.3.3.2" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Ch5.footnote3.m3.1.1.1.1.1.3.3.1" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Ch5.footnote3.m3.1.1.1.1.1.3.3.3" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="Ch5.footnote3.m3.1.1.1.1.3" stretchy="false" xref="Ch5.footnote3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ch5.footnote3.m3.1c"><apply id="Ch5.footnote3.m3.1.1.cmml" xref="Ch5.footnote3.m3.1.1"><times id="Ch5.footnote3.m3.1.1.2.cmml" xref="Ch5.footnote3.m3.1.1.2"></times><ci id="Ch5.footnote3.m3.1.1.3.cmml" xref="Ch5.footnote3.m3.1.1.3">𝑞</ci><apply id="Ch5.footnote3.m3.1.1.1.1.1.cmml" xref="Ch5.footnote3.m3.1.1.1.1"><csymbol cd="latexml" id="Ch5.footnote3.m3.1.1.1.1.1.1.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="Ch5.footnote3.m3.1.1.1.1.1.2.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ch5.footnote3.m3.1.1.1.1.1.2.1.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="Ch5.footnote3.m3.1.1.1.1.1.2.2.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.2.2">𝑍</ci><ci id="Ch5.footnote3.m3.1.1.1.1.1.2.3.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Ch5.footnote3.m3.1.1.1.1.1.3.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Ch5.footnote3.m3.1.1.1.1.1.3.1.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="Ch5.footnote3.m3.1.1.1.1.1.3.2.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3.2">𝑍</ci><apply id="Ch5.footnote3.m3.1.1.1.1.1.3.3.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3"><minus id="Ch5.footnote3.m3.1.1.1.1.1.3.3.1.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.1"></minus><ci id="Ch5.footnote3.m3.1.1.1.1.1.3.3.2.cmml" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Ch5.footnote3.m3.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Ch5.footnote3.m3.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ch5.footnote3.m3.1d">q(Z_{t}\mid Z_{t-1})</annotation><annotation encoding="application/x-llamapun" id="Ch5.footnote3.m3.1e">italic_q ( italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_Z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> because it a simple noising process.</span></span></span></p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px2.p2.1">Recently, many conditional diffusion models for image generation have been proposed using text and other modalities as the conditioning variables. For example,
<span class="ltx_text ltx_font_italic" id="Ch5.S3.SS3.SSS0.Px2.p2.1.1">DALL-E</span> <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ramesh2022hierarchical</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">betker2023improving</span>]</cite> uses the CLIP <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">radford2021learning</span>]</cite> embedding space as a starting point to generate novel images. To this objective, the authors train a decoder to invert the CLIP representation back to images. Working on a space that jointly represents text and images allows one to apply language-guided image manipulations. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">betker2023improving</span></cite> improve the quality of the generated images by performing an automated cleaning and improvement of the training image captions with a dedicated captioning model.
<span class="ltx_text ltx_font_italic" id="Ch5.S3.SS3.SSS0.Px2.p2.1.2">Stable Diffusion</span> <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">rombach2022high</span>]</cite> is able to generate images from an input text. Since directly training in the pixel space is very computationally demanding, the generative part of Stable Diffusion is trained on a lower-dimension feature space, and relies on a UNet <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ronneberger2015u</span>]</cite> autoencoder separately pre-trained on a perceptual loss and a patch-based adversarial objective. To condition the generation based on other modality inputs, such as texts or semantic maps, they train a cross-attention layer to project the new modality inputs to the intermediate layers of the UNet.
<span class="ltx_text ltx_font_italic" id="Ch5.S3.SS3.SSS0.Px2.p2.1.3">Imagen</span> <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">saharia2022photorealistic</span>]</cite> train a diffusion model for image generation based on a U-Net image model and a T5 text encoder pre-trained only with text. To condition the image generation based on text, the authors find that using cross-attention significantly outperforms other pooling strategies, and achieves high image-text alignment as well as photo-realistic results.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px2.p3">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px2.p3.1">Other works expanded diffusion models in different directions. For example, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2023adding</span></cite> increase the controllability of the generated results, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">brooks2023instructpix2pix</span></cite> add instruction-following capabilities for image modification, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">ruiz2023dreambooth</span></cite> improve the consistency of the generated subject’s identity by fine-tuning the model with a few images, and <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">Chen2024mmdiff</span></cite> propose a multi-modal, multi-task, diffusion model, where multiple input modalities are fused and fed to various decoders to accomplish multiple tasks simultaneously.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px2.p4">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px2.p4.1">Diffusion models have also been used for sound generation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2023diffsound</span>]</cite>, video generation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jeong2023power</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">videoworldsimulators2024</span>]</cite>, and other modalities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">pmlr-v202-kotelnikov23a</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2023diffusion</span>]</cite>, or multiple modalities simultaneously <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2024any</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">ruan2023mm</span>]</cite>. See <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">cao2024survey</span>]</cite> for a recent survey on diffusion models and its applications.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS3.SSS0.Px2.p5">
<p class="ltx_p" id="Ch5.S3.SS3.SSS0.Px2.p5.1">This rapid progress in diffusion model research shows great potential in their usefulness for recommendation applications.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2023tryondiffusion</span></cite> propose a virtual try-on system based on a diffusion model, which outperforms earlier ones based on GANs. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">haokai24mmcdiff</span></cite> and <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">jiang2024diffmm</span></cite> use diffusion models to combine multimodal item information with user-item interaction data.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Ch5.S3.SS4">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3.4 </span>Interactive Multimodal Recommendation Models</h4>
<div class="ltx_para" id="Ch5.S3.SS4.p1">
<p class="ltx_p" id="Ch5.S3.SS4.p1.1">As seen in Chapter 4, Large Language Models (LLMs) have been widely used in recommender systems, to do tasks like top-k recommendation, rating prediction or explanation generation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">geng2022recommendation</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023survey</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">he2023large</span>]</cite>. In this section we discuss interactive multimodal recommendation models based on LLMs, which have demonstrated impressive generalization capabilities and apparent emergent properties to solve tasks not directly targeted during training <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">brown2020language</span>]</cite>.</p>
</div>
<section class="ltx_paragraph" id="Ch5.S3.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Multimodal Large Language Models</h5>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px1.p1.1">One approach to designing interactive multimodal recommendation systems is to train or adapt specialized <em class="ltx_emph ltx_font_italic" id="Ch5.S3.SS4.SSS0.Px1.p1.1.1">X-to-text</em> encoders that allow LLMs to accept multimodal input, such as images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024visual</span>]</cite> or other modalities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023next</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2023codi2</span>]</cite>. These new models are called Multimodal Large Language Models (MLLM), and greatly extend the capabilities of LLMs not only at the input side, by accepting information expressed in different modalities, but also at the output side, where appropriate decoders can be used to allow the model to generate content in various modalities, replacing or complementing the textual answer. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.10993v1#Ch5.F5" title="Figure 5.5 ‣ Multimodal Large Language Models ‣ 5.3.4 Interactive Multimodal Recommendation Models ‣ 5.3 Generative Multimodal Recommendation Systems"><span class="ltx_text ltx_ref_tag">5.5</span></a> shows a high-level diagram of an MLLM architecture.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px1.p2.1">With the addition of multiple modalities, MLLMs can become versatile task solvers for recommendation problems. They provide a natural language interface for users to express their queries in multiple modalities, they can tackle complex zero-shot recommendation tasks thanks to their emergent properties, or orchestrate several sub-systems to obtain the best recommendation, they can also generate fluent natural language explanations for a multi-modal recommendation, or even generate documents in different modalities to help the user visualize the products.</p>
</div>
<figure class="ltx_figure" id="Ch5.F5">
<p class="ltx_p ltx_align_center" id="Ch5.F5.1"><span class="ltx_text" id="Ch5.F5.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="Ch5.F5.1.1.g1" src="extracted/5860126/fig/ch5_mllm.png" width="419"/></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5.5: </span>High-level architecture of an MLLM model.
Each input is processed by a specialized
encoder to obtain modality specific features which are
then projected to a representation adequate for an LLM backbone via suitable adaptors. Similarly, the output of the LLM is then projected to serve as input for specific generators for each modality via a similar adaptor. The input and output modalities are independent.</figcaption>
</figure>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px1.p3">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px1.p3.1">As discussed earlier, given the complexity of training large generative models end-to-end, researchers typically assemble systems composed of discriminatively pre-trained components (encoders, decoders and LLM “reasoning” models), usually connected by adaptation layers. These adaptation layers are usually pre-trained using paired data for the different modalities, sometimes together with or followed by some form of parameter-efficient fine-tuning of the base models. For example, Low Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">hu2021lora</span>]</cite> freezes the pre-trained parameters and introduces low-rank decomposable trainable adaptation matrices to each transformer layer. This fine-tuning step ensures that representations from different modalities are aligned. In some cases, an existing expert model able to produce textual descriptions of the multi-media content is used in place of adaptation layers <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2023videochat</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2024gpt4tools</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">gao2023llama</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2024modaverse</span>]</cite>. This may lead to lower data needs for adaptation, but could also result in information lost in translation.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Controller LLMs</h5>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px2.p1.1">Similar to the “dialogue controller” described in Chapter 4.7.2, instead of training adaptation layers, another approach is to allow a “controller” LLM to use external tools (e.g., foundation models, classical recommendation systems, arbitrary functions), to deal with the multi-modal input and output <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yin2023survey</span>]</cite>. This approach has the advantage that it usually involves little or no training. With a carefully constructed prompt explaining all the available tool capabilities and providing usage examples, the controller LLM can create an execution plan with the multi-modal input and generate the desired result in a zero-shot fashion <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2024mm</span>]</cite>. Once the plan is complete, the controller LLM will have to re-asses the output, and decide if the desired result has been achieved, or further steps are needed. To improve results, researchers have also tried to use instruction-tuning of the controller LLM to improve the tool selection and planning abilities <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yang2024gpt4tools</span>]</cite>. An obvious drawback of this approach is that it requires processing multiple rounds of instructions and multiple rounds of (possibly slow) “tool” foundation models to get to the desired result.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Multimodal instruction tuning</h5>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px3.p1.1">As seen in Section 4.7.2, instruction tuning is an important step to make LLMs useful task solvers. It requires the creation of datasets of instruction-formatted examples that will be used as training data for the model. These datasets are usually created by extending input-output pairs from multiple multi-modal datasets, such as COCO Captions <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2015microsoft</span>]</cite>, LAION <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">schuhmann2022laion</span>]</cite> or VQAv2 <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">balanced_vqa_v2</span>]</cite>, with an instruction text defined using prompt templates for the different tasks <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">dai2024instructblip</span>]</cite>. Tasks can be created, for example, by using annotated bounding boxes to define a spatial relationship question, or using an existing image caption as supervision for an image description request.
When no suitable datasets are available, and collecting them from other sources is impractical,
researchers use generative models to create the examples through self-instruction <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">brooks2023instructpix2pix</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2022self</span>]</cite>. Models that extend instructions to multiple modalities have recently been proposed <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2023instructany2pix</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023next</span>]</cite>. For example, a user could issue a query such as <span class="ltx_text ltx_font_italic" id="Ch5.S3.SS4.SSS0.Px3.p1.1.1">“modify [image] to convey the feeling of [music]”</span>.
With instruction tuning, MLLMs can be used in dialog systems (c.f. Sec 4.7), enriching the conversation with multimodal understanding and generation.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Any-to-text MLLMs</h5>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px4.p1.1">Recently, many MLLMs that add images to the accepted inputs have been developed: <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">alayrac2022flamingo</span></cite> propose <span class="ltx_text ltx_font_italic" id="Ch5.S3.SS4.SSS0.Px4.p1.1.1">Flamingo</span>, which use an LLM and a vision encoder trained with a contrastive loss similar to CLIP to build a model able to meet the state of the art performance in various image and video tasks.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024visual</span></cite> propose <span class="ltx_text ltx_font_italic" id="Ch5.S3.SS4.SSS0.Px4.p1.1.2">Llava</span>, an instruction-tuned multi-modal LLM that is able to accept input in both text and image format, and produce useful textual responses. The authors connect the grid visual embeddings from the last layers of the CLIP image encoder <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">radford2021learning</span>]</cite> with the Vicuna language decoder <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">vicuna2023</span>]</cite> using a simple linear adaptation layer, and fine-tunning the model end to end (they keep the visual encoder weights frozen). To train the model, instruction-following training data is generated using GPT-4 <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">achiam2023gpt</span>]</cite> and image-caption datasets, such as COCO <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2015microsoft</span>]</cite>. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2023improved</span></cite> change the connection layer from a linear projection to a two-layer MLP and obtain better results. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">li2023blip</span></cite> propose <span class="ltx_text ltx_font_italic" id="Ch5.S3.SS4.SSS0.Px4.p1.1.3">BLIP-2</span>, introducing a lightweight Query-Transformer (Q-Former), which consists of two transformer modules, to bridge the modality gap between the image encoder output and the LLM, and allow prompts to include both text and image.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px4.p2">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px4.p2.1">Although image is the modality that received the most attention, some works have addressed adding audio <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">deshmukh2023pengi</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">kong2024audio</span>]</cite>, and multiple modalities, like text, image, audio or video <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">han2023imagebind</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">moon2023anymal</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lyu2023macaw</span>]</cite>. However, these models are still limited to generating only text output.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S3.SS4.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Any-to-any MLLMs</h5>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px5.p1">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px5.p1.1">As mentioned earlier, to overcome the single-modality output limitation, authors have proposed systems that can both absorb information in multiple modalities, as well as generate response content in different modalities. For example, Next-GPT <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wu2023next</span>]</cite> attempts any-to-any modality conversion through an MM-LLM by using state-of-the-art encoders and decoders, connected to the LLM by thin adapter layers. Multi-modality switching instruction tunning is learned using a custom dataset of 5000 high quality samples. After warming up the adaptation layers, the whole system is trained using LoRA with the modality-switching dataset. For input, the authors use ImageBind <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">girdhar2023imagebind</span>]</cite>, which has been trained to produce aligned representations for image, audio and video, among other modalities, and adapt it using a linear layer to the Vicuna LLM, that does the core reasoning/instruction-following. For the output, small modality-specific transformers are trained to produce the input for three state-of-the-art decoder models, for audio, image and video. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">tang2023codi2</span></cite> use a similar approach, with Llama2 <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">touvron2023llama</span>]</cite> as the core LLM and state-of-the-art diffusion models to generate the multi-modal outputs.</p>
</div>
<div class="ltx_para" id="Ch5.S3.SS4.SSS0.Px5.p2">
<p class="ltx_p" id="Ch5.S3.SS4.SSS0.Px5.p2.1">Several companies have released proprietary generalist MLLM-powered chatbots, like OpenAI GPT-4 <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">achiam2023gpt</span>]</cite> and Google Gemini <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">team2023gemini</span>]</cite> or Anthropic Claude <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">anthropic2024claude</span>]</cite>. Even though these models are not explicitly trained as recommender systems, they are able to produce a variety of recommendation results, including shopping recommendations. For example, Gemini can receive images, audio and video as input, recognize objects in them, provide general advice for product understanding, and recommend products based on customer input.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="Ch5.S4">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.4 </span>Applications of Multimodal Recommendation Systems</h3>
<div class="ltx_para" id="Ch5.S4.p1">
<p class="ltx_p" id="Ch5.S4.p1.1">Recent developments in multi-modal generative models open the door to many applications in recommender systems. In this section we review some of the most promising directions, in areas including e-commerce, in-context product visualization, marketing, online streaming, and travel and service recommendations.</p>
</div>
<section class="ltx_paragraph" id="Ch5.S4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">E-commerce</h5>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px1.p1.1">One of the most direct applications of generative multimodal models for recommendation is e-commerce, where there is a large volume of product and customer data available that can be used to benefit the customer recommendations. Applications range from improving product images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">corneanu2024latentpaint</span>]</cite>, names and descriptions <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">novgorodov2019generating</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">shao2021controllable</span>]</cite>, to generating reviews <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">truong2019multimodal</span></cite> and review summaries <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">amazon2023reviews</span>]</cite>, learning to generate better recommendation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">xiao2022abstract</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024rec</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">karra2024interarec</span>]</cite>, and answering user questions <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">deng2022toward</span>]</cite>.</p>
</div>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px1.p2.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">karra2024interarec</span></cite> propose to use multimodal large language models to improve recommendations by better understanding the behavior of users in e-commerce websites. As the user navigates during a browsing session, high-frequency screenshots are captured and provided to an MLLM together with specific prompts requesting to extract information such as price ranges, product categories and brand preferences, to generate a user behavioral summary. Next, this summary is provided to an LLM with tool-using abilities to derive features and constraints from the input, and use a recommender system to generate the final recommendation. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024rec</span></cite> describe the limitations of current MLLM when used with multiple images as input in the prompt. To improve the performance, they propose to process the list of products interacted by the user as pairs of image and title to obtain text descriptions of the products. These descriptions can then be used in lieu of the images when using the interaction history as in-context-learning to generate new recommendations for a user with an MLLM.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">truong2019multimodal</span></cite> propose a system to generate multi-modal reviews. The proposed system uses item and user embeddings, obtained via matrix factorization, to predict the rating and compose a review text with a Long Short-Term Memory network. If a review image is available, it is also used to condition the text generation.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S4.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">In-context product visualization</h5>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px2.p1.1">Applications such as “virtual try on” or “view in your room” augment an image or video with products such as clothes <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yuan2013mixed</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">han2018viton</span>]</cite>, sunglasses, or even makeup <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">borges2019virtual</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">beauty2023compare</span>]</cite> to help users visualize how they would look in themselves, or how furniture or appliances would look in the context of their home <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">reuksupasompon2018ar</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">amazonARtech</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">amazonARcsa</span>]</cite>, before making a purchase decision. A traditional approach for these tasks is Augmented Reality (AR), that mixes real images, obtained from a camera feed, with virtual objects to generate novel views in real time. While AR has been used in numerous applications, ranging from education <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">billinghurst2002augmented</span>]</cite> to assisting surgeons in medical operations <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">dennler2021augmented</span>]</cite>, recent diffusion-based image generation models can be used to further improve virtual-try-on experiences <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2024stablegarment</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2024ootdiffusion</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2024texfit</span>]</cite>, or generate outfits to try out <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2024difashion</span>]</cite>, and make them more controllable <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">seyfioglu2024diffuse</span>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S4.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Marketing</h5>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px3.p1.1">In marketing, multimodal generative models can be used to create personalized advertisement images and videos from product imagery and customer preferences to increase the probability of engagement <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2023generate</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2021automated</span>]</cite>. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2022towards</span></cite> generates personalized bundles and creates a customized image for display. <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">shilova2023adbooster</span></cite> fine-tune a Stable Diffusion model to generate personalized images by outpainting input images without modifying the targeted object. For training, they leverage a U<sup class="ltx_sup" id="Ch5.S4.SS0.SSS0.Px3.p1.1.1">2</sup>-Net segmentation network, and a BLIP model to generate masks and captions for a collection of training images, that the model will then learn to reconstruct. With adequate guardrails in place, generative models could also be used to synthesize personalized multimodal ad content like text <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">loukili23marketing</span>]</cite>, images <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mayahi2022impact</span>]</cite> or video <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2023ai</span>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S4.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Streaming services</h5>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px4.p1.1">Online video and audio streaming services strive to recommend the most valuable multimedia content to each user in order to maximize usage, ad revenue or click-through rate. Long and short-form video, music, audiobooks, podcasts and radio have different recommendation requirements, but the very content to recommend comes in multiple modalities that can be used to improve the suggestions. Even though most works on streaming content recommendation rely on user behavior and content metadata, recent works have applied multimodal learning to audio <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jones2023learning</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2021learning</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2020large</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">deldjoo2024content</span>]</cite> and video <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lei20mmmicrov</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2019mmgcn</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yi2022multi</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">sun2022long</span>]</cite> recommendation. Due to their extensive pre-training, large multi-modal generative models can further enhance the user experience in a content streaming recommendation setting by blending content understanding with personalization and generation, allowing them to complete tasks like answering to fine-grained content-related questions in natural language (e.g., “Does this movie contain a car chase scene that I will like?”), or generating personalized content to fulfill a user request (e.g., audio and music generation <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">briot2017deep</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lam2024efficient</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">vyas2023audiobox</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">dhariwal2020jukebox</span>]</cite>).</p>
</div>
</section>
<section class="ltx_paragraph" id="Ch5.S4.SS0.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Travel and service recommendations</h5>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="Ch5.S4.SS0.SSS0.Px5.p1.1">Services ranging from theme parks and concert venues to restaurants, auto mechanics, and laundry services receive customer ratings, reviews and clicks in many online platforms. Better understanding of contextual details such as location characteristics, services offered, past user experiences and popularity factors through multi-modal information, could lead to better and more personalized recommendations. Furthermore, future work could tackle comprehensive products such as interactive recommendation systems able to help users through the whole process of planning and booking complex multi-faceted events such as weddings (e.g., venue, menu, decoration, music) or travel (e.g., destination, transport, hotel, restaurant, activities, practical tips) in a conversational way <cite class="ltx_cite ltx_citemacro_citep">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2024travelplanner</span>]</cite>, accepting and incorporating user feedback and explaining the recommendations.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_ref ltx_missing_citation ltx_ref_self">yan2023personalized</span></cite> generates explanations for recommendations focusing on making them informative and diverse. For that, they start by selecting a set of images for a given user and business using a detrimental point process that leverages CLIP features from the user history, and the business images. Then, they use a GPT-2-powered multi-modal decoder, trained with a personalized cross-modal contrastive loss, to generate natural language explanations. The results show that the proposed method produces more informative and diverse explanations compared to text-only alternatives.</p>
</div>
<div class="ltx_para" id="Ch5.S4.SS0.SSS0.Px5.p2">
<span class="ltx_ERROR undefined" id="Ch5.S4.SS0.SSS0.Px5.p2.1">\printbibliography</span>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Sep 17 08:50:53 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
