<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>XRec: Large Language Models for Explainable Recommendation</title>
<!--Generated on Sun Sep 22 14:49:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.02377v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S1" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S2" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S2.SS1" title="In 2 Preliminaries ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Explainable Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S2.SS2" title="In 2 Preliminaries ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Graph Collaborative Filtering</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.SS1" title="In 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Collaborative Relation Tokenizer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.SS2" title="In 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Collaborative Instruction Tuning for Large Language Models (LLMs)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.SS2.SSS1" title="In 3.2 Collaborative Instruction Tuning for Large Language Models (LLMs) ‣ 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Collaborative Information Adapter</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.SS2.SSS2" title="In 3.2 Collaborative Instruction Tuning for Large Language Models (LLMs) ‣ 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Unifying CF with LLM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.SS2.SSS3" title="In 3.2 Collaborative Instruction Tuning for Large Language Models (LLMs) ‣ 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Ground Truth Explanation Generation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.SS1" title="In 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.SS2" title="In 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.SS3" title="In 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.SS4" title="In 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Model Robustness against Data Sparsity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S5" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S5.SS1" title="In 5 Related Work ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Explainable Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S5.SS2" title="In 5 Related Work ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>GNNs for Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S6" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S7" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1" title="In XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.SS1" title="In Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Generating Ground Truth Explanations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.SS2" title="In Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Item Profile Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.SS3" title="In Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>User Profile Generation</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">XRec: Large Language Models for Explainable Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qiyao Ma, Xubin Ren, <span class="ltx_text ltx_font_bold" id="id1.1.1">Chao Huang<sup class="ltx_sup" id="id1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id1.1.1.1.1">∗</span></sup></span>
<br class="ltx_break"/>University of Hong Kong 
<br class="ltx_break"/>{martin.qyma, xubinrencs, chaohuang75}@gmail.com
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Recommender systems help users navigate information overload by providing personalized recommendations aligned with their preferences. Collaborative Filtering (CF) is a widely adopted approach, but while advanced techniques like graph neural networks (GNNs) and self-supervised learning (SSL) have enhanced CF models for better user representations, they often lack the ability to provide explanations for the recommended items. Explainable recommendations aim to address this gap by offering transparency and insights into the recommendation decision-making process, enhancing users’ understanding. This work leverages the language capabilities of Large Language Models (LLMs) to push the boundaries of explainable recommender systems. We introduce a model-agnostic framework called XRec, which enables LLMs to provide comprehensive explanations for user behaviors in recommender systems. By integrating collaborative signals and designing a lightweight collaborative adaptor, the framework empowers LLMs to understand complex patterns in user-item interactions and gain a deeper understanding of user preferences. Our extensive experiments demonstrate the effectiveness of XRec, showcasing its ability to generate comprehensive and meaningful explanations that outperform baseline approaches in explainable recommender systems. We open-source our model implementation at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/HKUDS/XRec" style="color:#0000FF;" title="">https://github.com/HKUDS/XRec</a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.2"><span class="ltx_text ltx_font_bold" id="p1.1.2.1">XRec: Large Language Models for Explainable Recommendation</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.1.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.1.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.1.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1.1.1.1.1">Qiyao Ma, Xubin Ren, Chao Huang<sup class="ltx_sup" id="p1.1.1.1.1.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.1.1.1.1.1.1.1.1.1">∗</span></sup></span></span></span>
<span class="ltx_tr" id="p1.1.1.1.1.2.1">
<span class="ltx_td ltx_align_center" id="p1.1.1.1.1.2.1.1">University of Hong Kong</span></span>
<span class="ltx_tr" id="p1.1.1.1.1.3.2">
<span class="ltx_td ltx_align_center" id="p1.1.1.1.1.3.2.1">{martin.qyma, xubinrencs, chaohuang75}@gmail.com</span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the overwhelming abundance of content and products available in online platforms, users frequently encounter the daunting challenge of information overload. In response, recommender systems emerge as indispensable tools that aim to alleviate this burden. These systems effectively filter through the vast array of options and present users with tailored recommendations that are both relevant and personalized, aligning with their unique preferences and interests <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib26" title="">2019b</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Among the diverse range of recommendation techniques available, Collaborative Filtering (CF) framework emerges as a prominent and widely embraced approach within the field of recommender systems. CF operates on the fundamental premise that users who have demonstrated similar preferences in the past, such as common item ratings or similar purchase histories, are likely to exhibit comparable preferences when it comes to future recommendations <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib1" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In recent years, the field of collaborative filtering algorithms has undergone a remarkable revolution with the emergence of deep learning techniques. This transformative wave has brought about the integration of diverse neural network architectures, including Attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib2" title="">2017</a>)</cite>, Graph Neural Networks (GNNs) <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib4" title="">2020</a>)</cite>, and Self-Supervised Learning (SSL) <cite class="ltx_cite ltx_citemacro_cite">Xia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib18" title="">2023</a>)</cite>. Notably, the incorporation of GNNs in collaborative filtering models has yielded significant advancements by effectively capturing complex relational information and enhancing recommendation performance while preserving high-order collaborative dependencies. Moreover, self-supervised recommender systems have emerged as a promising solution to address the challenge of data sparsity. These systems leverage self-supervised learning signals to augment the available data, aiming to enhance recommendations.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">While existing collaborative filtering models excel at providing accurate recommendation results, there remains a critical aspect that has not received adequate attention: understanding the underlying reasons behind observed user-item interactions. Explainable recommendations aim to address this gap by providing transparency to users, offering insights into the decision-making process behind recommendations. This not only enhances users’ understanding of their own preferences, but also fosters trust in recommendation algorithms.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Several research studies have dedicated their focus to generating explanations for user-item interactions. Notably, Att2Seq <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib3" title="">2017</a>)</cite> and NRT <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib9" title="">2017</a>)</cite> employ attention mechanisms and recurrent neural networks (RNNs) to generate textual explanations. Recent advancements have further explored the utilization of Transformer <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib7" title="">2021</a>)</cite> and GPT2 <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib8" title="">2023</a>)</cite> for text generation, providing valuable insights into recommendation results. However, these approaches face a common challenge arising from the limited availability of explanation data, which hinders their ability to generate high-quality explanations. It is also important to emphasize that ID-based methods heavily rely on ID embeddings, resulting in limited generalization capabilities and difficulties when adapting to unseen users and items in a zero-shot recommendation scenario. 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Presented Work</span>. In light of the recent advancements in Large Language Models (LLMs), our primary objective is to push the boundaries of explainable recommender systems by harnessing the exceptional language capabilities of LLMs. To this end, we introduce model-agnostic XRec, a groundbreaking collaborative instruction-tuning framework that enables large language models to provide comprehensive explanations for user behaviors within recommender systems. Within our XRec framework, we equip LLMs with the unique ability to comprehend the intricate patterns of user-item interactions through the integration of collaborative signals via a collaborative instruction-tuning paradigm. In order to bridge the representation space of collaborative relationships and the language semantic space, we design a lightweight collaborative adaptor that incorporates behavior-aware collaborative signals into the LLMs, facilitating a deeper understanding of user preferences.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We conducted a series of thorough experiments to validate the effectiveness and superior performance of our proposed framework, XRec, in generating comprehensive and meaningful explanations within recommender systems. In addition to that, we conducted ablation studies and investigated the robustness of our model, providing further evidence of its effectiveness.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Explainable Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.2">Explainable Recommendation is essential in recommender systems as it clarifies the underlying reasons for user-item interactions. Our primary goal is to create clear textual explanations that allow us to understand the rationale behind each recommendation. Specifically, for each interaction between a user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_u</annotation></semantics></math> and an item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_i</annotation></semantics></math>, the explanations generated can be described as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textit{explanation}(u,i)=\textit{generate}(u,i,\mathcal{X}_{u},\mathcal{X}_{i%
},\tau)" class="ltx_Math" display="block" id="S2.E1.m1.7"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><mrow id="S2.E1.m1.7.7.4" xref="S2.E1.m1.7.7.4.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.7.7.4.2" xref="S2.E1.m1.7.7.4.2a.cmml">explanation</mtext><mo id="S2.E1.m1.7.7.4.1" xref="S2.E1.m1.7.7.4.1.cmml">⁢</mo><mrow id="S2.E1.m1.7.7.4.3.2" xref="S2.E1.m1.7.7.4.3.1.cmml"><mo id="S2.E1.m1.7.7.4.3.2.1" stretchy="false" xref="S2.E1.m1.7.7.4.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">u</mi><mo id="S2.E1.m1.7.7.4.3.2.2" xref="S2.E1.m1.7.7.4.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">i</mi><mo id="S2.E1.m1.7.7.4.3.2.3" stretchy="false" xref="S2.E1.m1.7.7.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.7.7.3" xref="S2.E1.m1.7.7.3.cmml">=</mo><mrow id="S2.E1.m1.7.7.2" xref="S2.E1.m1.7.7.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.7.7.2.4" xref="S2.E1.m1.7.7.2.4a.cmml">generate</mtext><mo id="S2.E1.m1.7.7.2.3" xref="S2.E1.m1.7.7.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.7.7.2.2.2" xref="S2.E1.m1.7.7.2.2.3.cmml"><mo id="S2.E1.m1.7.7.2.2.2.3" stretchy="false" xref="S2.E1.m1.7.7.2.2.3.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">u</mi><mo id="S2.E1.m1.7.7.2.2.2.4" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">i</mi><mo id="S2.E1.m1.7.7.2.2.2.5" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><msub id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml">𝒳</mi><mi id="S2.E1.m1.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.3.cmml">u</mi></msub><mo id="S2.E1.m1.7.7.2.2.2.6" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><msub id="S2.E1.m1.7.7.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.2.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.2.cmml">𝒳</mi><mi id="S2.E1.m1.7.7.2.2.2.2.3" xref="S2.E1.m1.7.7.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.7.7.2.2.2.7" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">τ</mi><mo id="S2.E1.m1.7.7.2.2.2.8" stretchy="false" xref="S2.E1.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><eq id="S2.E1.m1.7.7.3.cmml" xref="S2.E1.m1.7.7.3"></eq><apply id="S2.E1.m1.7.7.4.cmml" xref="S2.E1.m1.7.7.4"><times id="S2.E1.m1.7.7.4.1.cmml" xref="S2.E1.m1.7.7.4.1"></times><ci id="S2.E1.m1.7.7.4.2a.cmml" xref="S2.E1.m1.7.7.4.2"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.7.7.4.2.cmml" xref="S2.E1.m1.7.7.4.2">explanation</mtext></ci><interval closure="open" id="S2.E1.m1.7.7.4.3.1.cmml" xref="S2.E1.m1.7.7.4.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑢</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑖</ci></interval></apply><apply id="S2.E1.m1.7.7.2.cmml" xref="S2.E1.m1.7.7.2"><times id="S2.E1.m1.7.7.2.3.cmml" xref="S2.E1.m1.7.7.2.3"></times><ci id="S2.E1.m1.7.7.2.4a.cmml" xref="S2.E1.m1.7.7.2.4"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.7.7.2.4.cmml" xref="S2.E1.m1.7.7.2.4">generate</mtext></ci><vector id="S2.E1.m1.7.7.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑢</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑖</ci><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2">𝒳</ci><ci id="S2.E1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3">𝑢</ci></apply><apply id="S2.E1.m1.7.7.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2">𝒳</ci><ci id="S2.E1.m1.7.7.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝜏</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">\textit{explanation}(u,i)=\textit{generate}(u,i,\mathcal{X}_{u},\mathcal{X}_{i%
},\tau)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.7d">explanation ( italic_u , italic_i ) = generate ( italic_u , italic_i , caligraphic_X start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_τ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.7">In this context, <math alttext="\mathcal{X}_{u}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m1.1"><semantics id="S2.SS1.p1.3.m1.1a"><msub id="S2.SS1.p1.3.m1.1.1" xref="S2.SS1.p1.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m1.1.1.2" xref="S2.SS1.p1.3.m1.1.1.2.cmml">𝒳</mi><mi id="S2.SS1.p1.3.m1.1.1.3" xref="S2.SS1.p1.3.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m1.1b"><apply id="S2.SS1.p1.3.m1.1.1.cmml" xref="S2.SS1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m1.1.1.1.cmml" xref="S2.SS1.p1.3.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m1.1.1.2.cmml" xref="S2.SS1.p1.3.m1.1.1.2">𝒳</ci><ci id="S2.SS1.p1.3.m1.1.1.3.cmml" xref="S2.SS1.p1.3.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m1.1c">\mathcal{X}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m1.1d">caligraphic_X start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{X}_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m2.1"><semantics id="S2.SS1.p1.4.m2.1a"><msub id="S2.SS1.p1.4.m2.1.1" xref="S2.SS1.p1.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m2.1.1.2" xref="S2.SS1.p1.4.m2.1.1.2.cmml">𝒳</mi><mi id="S2.SS1.p1.4.m2.1.1.3" xref="S2.SS1.p1.4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m2.1b"><apply id="S2.SS1.p1.4.m2.1.1.cmml" xref="S2.SS1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m2.1.1.1.cmml" xref="S2.SS1.p1.4.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m2.1.1.2.cmml" xref="S2.SS1.p1.4.m2.1.1.2">𝒳</ci><ci id="S2.SS1.p1.4.m2.1.1.3.cmml" xref="S2.SS1.p1.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m2.1c">\mathcal{X}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m2.1d">caligraphic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represent the interaction histories of user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m3.1"><semantics id="S2.SS1.p1.5.m3.1a"><mi id="S2.SS1.p1.5.m3.1.1" xref="S2.SS1.p1.5.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m3.1b"><ci id="S2.SS1.p1.5.m3.1.1.cmml" xref="S2.SS1.p1.5.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m3.1d">italic_u</annotation></semantics></math> and item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m4.1"><semantics id="S2.SS1.p1.6.m4.1a"><mi id="S2.SS1.p1.6.m4.1.1" xref="S2.SS1.p1.6.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m4.1b"><ci id="S2.SS1.p1.6.m4.1.1.cmml" xref="S2.SS1.p1.6.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m4.1d">italic_i</annotation></semantics></math>, respectively. The symbol <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m5.1"><semantics id="S2.SS1.p1.7.m5.1a"><mi id="S2.SS1.p1.7.m5.1.1" xref="S2.SS1.p1.7.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m5.1b"><ci id="S2.SS1.p1.7.m5.1.1.cmml" xref="S2.SS1.p1.7.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m5.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m5.1d">italic_τ</annotation></semantics></math> denotes any additional side information related to both the users and the items.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.2">Building upon recent advancements in text-based profile generation <cite class="ltx_cite ltx_citemacro_cite">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib12" title="">2024</a>); Xi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib17" title="">2023</a>)</cite>, we enhance the explanation generation paradigm in recommender systems. Our method involves incorporating textual information into the generation of item profiles, utilizing a predefined item prompt (<math alttext="\mathcal{P}_{I}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">𝒫</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝒫</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{P}_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>) and item description (<math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">caligraphic_D</annotation></semantics></math>).</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{I}=\textit{LLMs}(\mathcal{P}_{I},\mathcal{D})" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.3" xref="S2.E2.m1.2.2.3.cmml">ℐ</mi><mo id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.2.2.1.3a.cmml">LLMs</mtext><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.2.cmml"><mo id="S2.E2.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">𝒫</mi><mi id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml">I</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝒟</mi><mo id="S2.E2.m1.2.2.1.1.1.4" stretchy="false" xref="S2.E2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"></eq><ci id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2.3">ℐ</ci><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><times id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1.2"></times><ci id="S2.E2.m1.2.2.1.3a.cmml" xref="S2.E2.m1.2.2.1.3"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.2.2.1.3.cmml" xref="S2.E2.m1.2.2.1.3">LLMs</mtext></ci><interval closure="open" id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1"><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2">𝒫</ci><ci id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3">𝐼</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝒟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathcal{I}=\textit{LLMs}(\mathcal{P}_{I},\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">caligraphic_I = LLMs ( caligraphic_P start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , caligraphic_D )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.6">In addition to item descriptions, we extend our approach to user profiles by considering their interactions with previously profiled items. This is achieved by sampling the items that the user has interacted with, resulting in a more comprehensive representation of their preferences and interests.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{U}=\textit{LLMs}(\mathcal{P}_{U},\{\mathcal{I}_{i}:i\in\mathcal{N}_{u%
}\})" class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.4" xref="S2.E3.m1.2.2.4.cmml">𝒰</mi><mo id="S2.E3.m1.2.2.3" xref="S2.E3.m1.2.2.3.cmml">=</mo><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.4a.cmml">LLMs</mtext><mo id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.3.cmml"><mo id="S2.E3.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E3.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">𝒫</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml">U</mi></msub><mo id="S2.E3.m1.2.2.2.2.2.4" xref="S2.E3.m1.2.2.2.2.3.cmml">,</mo><mrow id="S2.E3.m1.2.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.3.cmml"><mo id="S2.E3.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.E3.m1.2.2.2.2.2.2.3.1.cmml">{</mo><msub id="S2.E3.m1.2.2.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.2.2.1.1.2.cmml">ℐ</mi><mi id="S2.E3.m1.2.2.2.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m1.2.2.2.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S2.E3.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="S2.E3.m1.2.2.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.2.2.2.cmml">i</mi><mo id="S2.E3.m1.2.2.2.2.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.E3.m1.2.2.2.2.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.2.2.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3.2.cmml">𝒩</mi><mi id="S2.E3.m1.2.2.2.2.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3.3.cmml">u</mi></msub></mrow><mo id="S2.E3.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="S2.E3.m1.2.2.2.2.2.2.3.1.cmml">}</mo></mrow><mo id="S2.E3.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2.3"></eq><ci id="S2.E3.m1.2.2.4.cmml" xref="S2.E3.m1.2.2.4">𝒰</ci><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3"></times><ci id="S2.E3.m1.2.2.2.4a.cmml" xref="S2.E3.m1.2.2.2.4"><mtext class="ltx_mathvariant_italic" id="S2.E3.m1.2.2.2.4.cmml" xref="S2.E3.m1.2.2.2.4">LLMs</mtext></ci><interval closure="open" id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2"><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">𝒫</ci><ci id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">𝑈</ci></apply><apply id="S2.E3.m1.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.3">conditional-set</csymbol><apply id="S2.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.2">ℐ</ci><ci id="S2.E3.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.3">𝑖</ci></apply><apply id="S2.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2"><in id="S2.E3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.1"></in><ci id="S2.E3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.2">𝑖</ci><apply id="S2.E3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3.2">𝒩</ci><ci id="S2.E3.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.2.2.2.3.3">𝑢</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathcal{U}=\textit{LLMs}(\mathcal{P}_{U},\{\mathcal{I}_{i}:i\in\mathcal{N}_{u%
}\})</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">caligraphic_U = LLMs ( caligraphic_P start_POSTSUBSCRIPT italic_U end_POSTSUBSCRIPT , { caligraphic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : italic_i ∈ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT } )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.5">We denote the set of items interacted with by user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m1.1"><semantics id="S2.SS1.p2.3.m1.1a"><mi id="S2.SS1.p2.3.m1.1.1" xref="S2.SS1.p2.3.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m1.1b"><ci id="S2.SS1.p2.3.m1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m1.1d">italic_u</annotation></semantics></math> as <math alttext="\mathcal{N}_{u}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m2.1"><semantics id="S2.SS1.p2.4.m2.1a"><msub id="S2.SS1.p2.4.m2.1.1" xref="S2.SS1.p2.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.4.m2.1.1.2" xref="S2.SS1.p2.4.m2.1.1.2.cmml">𝒩</mi><mi id="S2.SS1.p2.4.m2.1.1.3" xref="S2.SS1.p2.4.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m2.1b"><apply id="S2.SS1.p2.4.m2.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m2.1.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m2.1.1.2.cmml" xref="S2.SS1.p2.4.m2.1.1.2">𝒩</ci><ci id="S2.SS1.p2.4.m2.1.1.3.cmml" xref="S2.SS1.p2.4.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m2.1c">\mathcal{N}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m2.1d">caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, and use <math alttext="\mathcal{P}_{U}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m3.1"><semantics id="S2.SS1.p2.5.m3.1a"><msub id="S2.SS1.p2.5.m3.1.1" xref="S2.SS1.p2.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.5.m3.1.1.2" xref="S2.SS1.p2.5.m3.1.1.2.cmml">𝒫</mi><mi id="S2.SS1.p2.5.m3.1.1.3" xref="S2.SS1.p2.5.m3.1.1.3.cmml">U</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m3.1b"><apply id="S2.SS1.p2.5.m3.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m3.1.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m3.1.1.2.cmml" xref="S2.SS1.p2.5.m3.1.1.2">𝒫</ci><ci id="S2.SS1.p2.5.m3.1.1.3.cmml" xref="S2.SS1.p2.5.m3.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m3.1c">\mathcal{P}_{U}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_U end_POSTSUBSCRIPT</annotation></semantics></math> as the user profile prompt.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Graph Collaborative Filtering</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.5">Graph Neural Networks (GNNs) have proven to be effective frameworks for capturing collaborative relationships between users and items, taking into account high-order dependencies. Through multiple rounds of message passing, nodes in the user-item interaction graph assimilate information and generate embeddings that capture these collaborative relationships <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib16" title="">2019</a>)</cite>. To encode the user-item interaction graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> using <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_L</annotation></semantics></math> layers of GNNs, the <math alttext="l^{th}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><msup id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">l</mi><mrow id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.2" xref="S2.SS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS2.p1.3.m3.1.1.3.1" xref="S2.SS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.3.m3.1.1.3.3" xref="S2.SS2.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑙</ci><apply id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3"><times id="S2.SS2.p1.3.m3.1.1.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1"></times><ci id="S2.SS2.p1.3.m3.1.1.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS2.p1.3.m3.1.1.3.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">l^{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_l start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer embedding of a user node <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_u</annotation></semantics></math> or an item node <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_i</annotation></semantics></math> is computed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e_{u}^{(l)}=\textit{AGG}\left(e_{u}^{(l-1)},\{e_{i}^{(l-1)}\mid i\in\mathcal{N%
}_{u}\}\right)" class="ltx_Math" display="block" id="S2.E4.m1.5"><semantics id="S2.E4.m1.5a"><mrow id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml"><msubsup id="S2.E4.m1.5.5.4" xref="S2.E4.m1.5.5.4.cmml"><mi id="S2.E4.m1.5.5.4.2.2" xref="S2.E4.m1.5.5.4.2.2.cmml">e</mi><mi id="S2.E4.m1.5.5.4.2.3" xref="S2.E4.m1.5.5.4.2.3.cmml">u</mi><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.5.5.4.cmml"><mo id="S2.E4.m1.1.1.1.3.1" stretchy="false" xref="S2.E4.m1.5.5.4.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">l</mi><mo id="S2.E4.m1.1.1.1.3.2" stretchy="false" xref="S2.E4.m1.5.5.4.cmml">)</mo></mrow></msubsup><mo id="S2.E4.m1.5.5.3" xref="S2.E4.m1.5.5.3.cmml">=</mo><mrow id="S2.E4.m1.5.5.2" xref="S2.E4.m1.5.5.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E4.m1.5.5.2.4" xref="S2.E4.m1.5.5.2.4a.cmml">AGG</mtext><mo id="S2.E4.m1.5.5.2.3" xref="S2.E4.m1.5.5.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.5.5.2.2.2" xref="S2.E4.m1.5.5.2.2.3.cmml"><mo id="S2.E4.m1.5.5.2.2.2.3" xref="S2.E4.m1.5.5.2.2.3.cmml">(</mo><msubsup id="S2.E4.m1.4.4.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.2.2" xref="S2.E4.m1.4.4.1.1.1.1.2.2.cmml">e</mi><mi id="S2.E4.m1.4.4.1.1.1.1.2.3" xref="S2.E4.m1.4.4.1.1.1.1.2.3.cmml">u</mi><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><mo id="S2.E4.m1.2.2.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E4.m1.2.2.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E4.m1.5.5.2.2.2.4" xref="S2.E4.m1.5.5.2.2.3.cmml">,</mo><mrow id="S2.E4.m1.5.5.2.2.2.2.2" xref="S2.E4.m1.5.5.2.2.2.2.3.cmml"><mo id="S2.E4.m1.5.5.2.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.5.5.2.2.2.2.3.1.cmml">{</mo><msubsup id="S2.E4.m1.5.5.2.2.2.2.1.1" xref="S2.E4.m1.5.5.2.2.2.2.1.1.cmml"><mi id="S2.E4.m1.5.5.2.2.2.2.1.1.2.2" xref="S2.E4.m1.5.5.2.2.2.2.1.1.2.2.cmml">e</mi><mi id="S2.E4.m1.5.5.2.2.2.2.1.1.2.3" xref="S2.E4.m1.5.5.2.2.2.2.1.1.2.3.cmml">i</mi><mrow id="S2.E4.m1.3.3.1.1" xref="S2.E4.m1.3.3.1.1.1.cmml"><mo id="S2.E4.m1.3.3.1.1.2" stretchy="false" xref="S2.E4.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.3.3.1.1.1" xref="S2.E4.m1.3.3.1.1.1.cmml"><mi id="S2.E4.m1.3.3.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S2.E4.m1.3.3.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S2.E4.m1.3.3.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E4.m1.3.3.1.1.3" stretchy="false" xref="S2.E4.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo fence="true" id="S2.E4.m1.5.5.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.E4.m1.5.5.2.2.2.2.3.1.cmml">∣</mo><mrow id="S2.E4.m1.5.5.2.2.2.2.2.2" xref="S2.E4.m1.5.5.2.2.2.2.2.2.cmml"><mi id="S2.E4.m1.5.5.2.2.2.2.2.2.2" xref="S2.E4.m1.5.5.2.2.2.2.2.2.2.cmml">i</mi><mo id="S2.E4.m1.5.5.2.2.2.2.2.2.1" xref="S2.E4.m1.5.5.2.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.E4.m1.5.5.2.2.2.2.2.2.3" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.5.5.2.2.2.2.2.2.3.2" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3.2.cmml">𝒩</mi><mi id="S2.E4.m1.5.5.2.2.2.2.2.2.3.3" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3.3.cmml">u</mi></msub></mrow><mo id="S2.E4.m1.5.5.2.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.5.5.2.2.2.2.3.1.cmml">}</mo></mrow><mo id="S2.E4.m1.5.5.2.2.2.5" xref="S2.E4.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.5b"><apply id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5"><eq id="S2.E4.m1.5.5.3.cmml" xref="S2.E4.m1.5.5.3"></eq><apply id="S2.E4.m1.5.5.4.cmml" xref="S2.E4.m1.5.5.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.4.1.cmml" xref="S2.E4.m1.5.5.4">superscript</csymbol><apply id="S2.E4.m1.5.5.4.2.cmml" xref="S2.E4.m1.5.5.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.4.2.1.cmml" xref="S2.E4.m1.5.5.4">subscript</csymbol><ci id="S2.E4.m1.5.5.4.2.2.cmml" xref="S2.E4.m1.5.5.4.2.2">𝑒</ci><ci id="S2.E4.m1.5.5.4.2.3.cmml" xref="S2.E4.m1.5.5.4.2.3">𝑢</ci></apply><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E4.m1.5.5.2.cmml" xref="S2.E4.m1.5.5.2"><times id="S2.E4.m1.5.5.2.3.cmml" xref="S2.E4.m1.5.5.2.3"></times><ci id="S2.E4.m1.5.5.2.4a.cmml" xref="S2.E4.m1.5.5.2.4"><mtext class="ltx_mathvariant_italic" id="S2.E4.m1.5.5.2.4.cmml" xref="S2.E4.m1.5.5.2.4">AGG</mtext></ci><interval closure="open" id="S2.E4.m1.5.5.2.2.3.cmml" xref="S2.E4.m1.5.5.2.2.2"><apply id="S2.E4.m1.4.4.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.2">𝑒</ci><ci id="S2.E4.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3">𝑢</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1"><minus id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"></minus><ci id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2">𝑙</ci><cn id="S2.E4.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S2.E4.m1.5.5.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2"><csymbol cd="latexml" id="S2.E4.m1.5.5.2.2.2.2.3.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.3">conditional-set</csymbol><apply id="S2.E4.m1.5.5.2.2.2.2.1.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.2.2.2.2.1.1.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1">superscript</csymbol><apply id="S2.E4.m1.5.5.2.2.2.2.1.1.2.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.2.2.2.2.1.1.2.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.2.2.2.2.1.1.2.2.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1.2.2">𝑒</ci><ci id="S2.E4.m1.5.5.2.2.2.2.1.1.2.3.cmml" xref="S2.E4.m1.5.5.2.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S2.E4.m1.3.3.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1"><minus id="S2.E4.m1.3.3.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1"></minus><ci id="S2.E4.m1.3.3.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.2">𝑙</ci><cn id="S2.E4.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S2.E4.m1.5.5.2.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2"><in id="S2.E4.m1.5.5.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.1"></in><ci id="S2.E4.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.2">𝑖</ci><apply id="S2.E4.m1.5.5.2.2.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.2.2.2.2.2.2.3.1.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E4.m1.5.5.2.2.2.2.2.2.3.2.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3.2">𝒩</ci><ci id="S2.E4.m1.5.5.2.2.2.2.2.2.3.3.cmml" xref="S2.E4.m1.5.5.2.2.2.2.2.2.3.3">𝑢</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.5c">e_{u}^{(l)}=\textit{AGG}\left(e_{u}^{(l-1)},\{e_{i}^{(l-1)}\mid i\in\mathcal{N%
}_{u}\}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.5d">italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = AGG ( italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , { italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ∣ italic_i ∈ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT } )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.11">In the context of graph collaborative filtering, <math alttext="\mathcal{N}_{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m1.1"><semantics id="S2.SS2.p1.6.m1.1a"><msub id="S2.SS2.p1.6.m1.1.1" xref="S2.SS2.p1.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.m1.1.1.2" xref="S2.SS2.p1.6.m1.1.1.2.cmml">𝒩</mi><mi id="S2.SS2.p1.6.m1.1.1.3" xref="S2.SS2.p1.6.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m1.1b"><apply id="S2.SS2.p1.6.m1.1.1.cmml" xref="S2.SS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m1.1.1.1.cmml" xref="S2.SS2.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m1.1.1.2.cmml" xref="S2.SS2.p1.6.m1.1.1.2">𝒩</ci><ci id="S2.SS2.p1.6.m1.1.1.3.cmml" xref="S2.SS2.p1.6.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m1.1c">\mathcal{N}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m1.1d">caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> refers to the neighborhood of node <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m2.1"><semantics id="S2.SS2.p1.7.m2.1a"><mi id="S2.SS2.p1.7.m2.1.1" xref="S2.SS2.p1.7.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m2.1b"><ci id="S2.SS2.p1.7.m2.1.1.cmml" xref="S2.SS2.p1.7.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m2.1d">italic_u</annotation></semantics></math>, while <math alttext="\textit{AGG}(\cdot)" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m3.1"><semantics id="S2.SS2.p1.8.m3.1a"><mrow id="S2.SS2.p1.8.m3.1.2" xref="S2.SS2.p1.8.m3.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m3.1.2.2" xref="S2.SS2.p1.8.m3.1.2.2a.cmml">AGG</mtext><mo id="S2.SS2.p1.8.m3.1.2.1" xref="S2.SS2.p1.8.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.8.m3.1.2.3.2" xref="S2.SS2.p1.8.m3.1.2.cmml"><mo id="S2.SS2.p1.8.m3.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.8.m3.1.2.cmml">(</mo><mo id="S2.SS2.p1.8.m3.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.8.m3.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.8.m3.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.8.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m3.1b"><apply id="S2.SS2.p1.8.m3.1.2.cmml" xref="S2.SS2.p1.8.m3.1.2"><times id="S2.SS2.p1.8.m3.1.2.1.cmml" xref="S2.SS2.p1.8.m3.1.2.1"></times><ci id="S2.SS2.p1.8.m3.1.2.2a.cmml" xref="S2.SS2.p1.8.m3.1.2.2"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m3.1.2.2.cmml" xref="S2.SS2.p1.8.m3.1.2.2">AGG</mtext></ci><ci id="S2.SS2.p1.8.m3.1.1.cmml" xref="S2.SS2.p1.8.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m3.1c">\textit{AGG}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m3.1d">AGG ( ⋅ )</annotation></semantics></math> is the aggregation function, which can vary across different models. By utilizing <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m4.1"><semantics id="S2.SS2.p1.9.m4.1a"><mi id="S2.SS2.p1.9.m4.1.1" xref="S2.SS2.p1.9.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m4.1b"><ci id="S2.SS2.p1.9.m4.1.1.cmml" xref="S2.SS2.p1.9.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m4.1d">italic_L</annotation></semantics></math> layers of propagation, graph neural networks (GNNs) generate <math alttext="L+1" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m5.1"><semantics id="S2.SS2.p1.10.m5.1a"><mrow id="S2.SS2.p1.10.m5.1.1" xref="S2.SS2.p1.10.m5.1.1.cmml"><mi id="S2.SS2.p1.10.m5.1.1.2" xref="S2.SS2.p1.10.m5.1.1.2.cmml">L</mi><mo id="S2.SS2.p1.10.m5.1.1.1" xref="S2.SS2.p1.10.m5.1.1.1.cmml">+</mo><mn id="S2.SS2.p1.10.m5.1.1.3" xref="S2.SS2.p1.10.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m5.1b"><apply id="S2.SS2.p1.10.m5.1.1.cmml" xref="S2.SS2.p1.10.m5.1.1"><plus id="S2.SS2.p1.10.m5.1.1.1.cmml" xref="S2.SS2.p1.10.m5.1.1.1"></plus><ci id="S2.SS2.p1.10.m5.1.1.2.cmml" xref="S2.SS2.p1.10.m5.1.1.2">𝐿</ci><cn id="S2.SS2.p1.10.m5.1.1.3.cmml" type="integer" xref="S2.SS2.p1.10.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m5.1c">L+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m5.1d">italic_L + 1</annotation></semantics></math> distinct embeddings for each node, namely <math alttext="(e^{(0)},e^{(1)},\dots,e^{(L)})" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m6.7"><semantics id="S2.SS2.p1.11.m6.7a"><mrow id="S2.SS2.p1.11.m6.7.7.3" xref="S2.SS2.p1.11.m6.7.7.4.cmml"><mo id="S2.SS2.p1.11.m6.7.7.3.4" stretchy="false" xref="S2.SS2.p1.11.m6.7.7.4.cmml">(</mo><msup id="S2.SS2.p1.11.m6.5.5.1.1" xref="S2.SS2.p1.11.m6.5.5.1.1.cmml"><mi id="S2.SS2.p1.11.m6.5.5.1.1.2" xref="S2.SS2.p1.11.m6.5.5.1.1.2.cmml">e</mi><mrow id="S2.SS2.p1.11.m6.1.1.1.3" xref="S2.SS2.p1.11.m6.5.5.1.1.cmml"><mo id="S2.SS2.p1.11.m6.1.1.1.3.1" stretchy="false" xref="S2.SS2.p1.11.m6.5.5.1.1.cmml">(</mo><mn id="S2.SS2.p1.11.m6.1.1.1.1" xref="S2.SS2.p1.11.m6.1.1.1.1.cmml">0</mn><mo id="S2.SS2.p1.11.m6.1.1.1.3.2" stretchy="false" xref="S2.SS2.p1.11.m6.5.5.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS2.p1.11.m6.7.7.3.5" xref="S2.SS2.p1.11.m6.7.7.4.cmml">,</mo><msup id="S2.SS2.p1.11.m6.6.6.2.2" xref="S2.SS2.p1.11.m6.6.6.2.2.cmml"><mi id="S2.SS2.p1.11.m6.6.6.2.2.2" xref="S2.SS2.p1.11.m6.6.6.2.2.2.cmml">e</mi><mrow id="S2.SS2.p1.11.m6.2.2.1.3" xref="S2.SS2.p1.11.m6.6.6.2.2.cmml"><mo id="S2.SS2.p1.11.m6.2.2.1.3.1" stretchy="false" xref="S2.SS2.p1.11.m6.6.6.2.2.cmml">(</mo><mn id="S2.SS2.p1.11.m6.2.2.1.1" xref="S2.SS2.p1.11.m6.2.2.1.1.cmml">1</mn><mo id="S2.SS2.p1.11.m6.2.2.1.3.2" stretchy="false" xref="S2.SS2.p1.11.m6.6.6.2.2.cmml">)</mo></mrow></msup><mo id="S2.SS2.p1.11.m6.7.7.3.6" xref="S2.SS2.p1.11.m6.7.7.4.cmml">,</mo><mi id="S2.SS2.p1.11.m6.4.4" mathvariant="normal" xref="S2.SS2.p1.11.m6.4.4.cmml">…</mi><mo id="S2.SS2.p1.11.m6.7.7.3.7" xref="S2.SS2.p1.11.m6.7.7.4.cmml">,</mo><msup id="S2.SS2.p1.11.m6.7.7.3.3" xref="S2.SS2.p1.11.m6.7.7.3.3.cmml"><mi id="S2.SS2.p1.11.m6.7.7.3.3.2" xref="S2.SS2.p1.11.m6.7.7.3.3.2.cmml">e</mi><mrow id="S2.SS2.p1.11.m6.3.3.1.3" xref="S2.SS2.p1.11.m6.7.7.3.3.cmml"><mo id="S2.SS2.p1.11.m6.3.3.1.3.1" stretchy="false" xref="S2.SS2.p1.11.m6.7.7.3.3.cmml">(</mo><mi id="S2.SS2.p1.11.m6.3.3.1.1" xref="S2.SS2.p1.11.m6.3.3.1.1.cmml">L</mi><mo id="S2.SS2.p1.11.m6.3.3.1.3.2" stretchy="false" xref="S2.SS2.p1.11.m6.7.7.3.3.cmml">)</mo></mrow></msup><mo id="S2.SS2.p1.11.m6.7.7.3.8" stretchy="false" xref="S2.SS2.p1.11.m6.7.7.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m6.7b"><vector id="S2.SS2.p1.11.m6.7.7.4.cmml" xref="S2.SS2.p1.11.m6.7.7.3"><apply id="S2.SS2.p1.11.m6.5.5.1.1.cmml" xref="S2.SS2.p1.11.m6.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m6.5.5.1.1.1.cmml" xref="S2.SS2.p1.11.m6.5.5.1.1">superscript</csymbol><ci id="S2.SS2.p1.11.m6.5.5.1.1.2.cmml" xref="S2.SS2.p1.11.m6.5.5.1.1.2">𝑒</ci><cn id="S2.SS2.p1.11.m6.1.1.1.1.cmml" type="integer" xref="S2.SS2.p1.11.m6.1.1.1.1">0</cn></apply><apply id="S2.SS2.p1.11.m6.6.6.2.2.cmml" xref="S2.SS2.p1.11.m6.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m6.6.6.2.2.1.cmml" xref="S2.SS2.p1.11.m6.6.6.2.2">superscript</csymbol><ci id="S2.SS2.p1.11.m6.6.6.2.2.2.cmml" xref="S2.SS2.p1.11.m6.6.6.2.2.2">𝑒</ci><cn id="S2.SS2.p1.11.m6.2.2.1.1.cmml" type="integer" xref="S2.SS2.p1.11.m6.2.2.1.1">1</cn></apply><ci id="S2.SS2.p1.11.m6.4.4.cmml" xref="S2.SS2.p1.11.m6.4.4">…</ci><apply id="S2.SS2.p1.11.m6.7.7.3.3.cmml" xref="S2.SS2.p1.11.m6.7.7.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m6.7.7.3.3.1.cmml" xref="S2.SS2.p1.11.m6.7.7.3.3">superscript</csymbol><ci id="S2.SS2.p1.11.m6.7.7.3.3.2.cmml" xref="S2.SS2.p1.11.m6.7.7.3.3.2">𝑒</ci><ci id="S2.SS2.p1.11.m6.3.3.1.1.cmml" xref="S2.SS2.p1.11.m6.3.3.1.1">𝐿</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m6.7c">(e^{(0)},e^{(1)},\dots,e^{(L)})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m6.7d">( italic_e start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT , italic_e start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , … , italic_e start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT )</annotation></semantics></math>. These embeddings are then concatenated to form the final node embedding.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.9">The embeddings of users and items are generated with the objective of maximizing the probability, considering the historical user interactions:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(\mathbf{e}|\mathcal{X})\propto p(\mathcal{X}|\mathbf{e})p(\mathbf{e})" class="ltx_Math" display="block" id="S2.E5.m1.3"><semantics id="S2.E5.m1.3a"><mrow id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.3" xref="S2.E5.m1.2.2.1.3.cmml">p</mi><mo id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mo id="S2.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.2.cmml">𝐞</mi><mo fence="false" id="S2.E5.m1.2.2.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.2.2.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.3.cmml">𝒳</mi></mrow><mo id="S2.E5.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml">∝</mo><mrow id="S2.E5.m1.3.3.2" xref="S2.E5.m1.3.3.2.cmml"><mi id="S2.E5.m1.3.3.2.3" xref="S2.E5.m1.3.3.2.3.cmml">p</mi><mo id="S2.E5.m1.3.3.2.2" xref="S2.E5.m1.3.3.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.2.1.1" xref="S2.E5.m1.3.3.2.1.1.1.cmml"><mo id="S2.E5.m1.3.3.2.1.1.2" stretchy="false" xref="S2.E5.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.2.1.1.1" xref="S2.E5.m1.3.3.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.3.3.2.1.1.1.2" xref="S2.E5.m1.3.3.2.1.1.1.2.cmml">𝒳</mi><mo fence="false" id="S2.E5.m1.3.3.2.1.1.1.1" xref="S2.E5.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.3.3.2.1.1.1.3" xref="S2.E5.m1.3.3.2.1.1.1.3.cmml">𝐞</mi></mrow><mo id="S2.E5.m1.3.3.2.1.1.3" stretchy="false" xref="S2.E5.m1.3.3.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.3.3.2.2a" xref="S2.E5.m1.3.3.2.2.cmml">⁢</mo><mi id="S2.E5.m1.3.3.2.4" xref="S2.E5.m1.3.3.2.4.cmml">p</mi><mo id="S2.E5.m1.3.3.2.2b" xref="S2.E5.m1.3.3.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.2.5.2" xref="S2.E5.m1.3.3.2.cmml"><mo id="S2.E5.m1.3.3.2.5.2.1" stretchy="false" xref="S2.E5.m1.3.3.2.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝐞</mi><mo id="S2.E5.m1.3.3.2.5.2.2" stretchy="false" xref="S2.E5.m1.3.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.3b"><apply id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3"><csymbol cd="latexml" id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3">proportional-to</csymbol><apply id="S2.E5.m1.2.2.1.cmml" xref="S2.E5.m1.2.2.1"><times id="S2.E5.m1.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.2"></times><ci id="S2.E5.m1.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.3">𝑝</ci><apply id="S2.E5.m1.2.2.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.2.2.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2">𝐞</ci><ci id="S2.E5.m1.2.2.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.3">𝒳</ci></apply></apply><apply id="S2.E5.m1.3.3.2.cmml" xref="S2.E5.m1.3.3.2"><times id="S2.E5.m1.3.3.2.2.cmml" xref="S2.E5.m1.3.3.2.2"></times><ci id="S2.E5.m1.3.3.2.3.cmml" xref="S2.E5.m1.3.3.2.3">𝑝</ci><apply id="S2.E5.m1.3.3.2.1.1.1.cmml" xref="S2.E5.m1.3.3.2.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.2.1.1.1.1.cmml" xref="S2.E5.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.3.3.2.1.1.1.2.cmml" xref="S2.E5.m1.3.3.2.1.1.1.2">𝒳</ci><ci id="S2.E5.m1.3.3.2.1.1.1.3.cmml" xref="S2.E5.m1.3.3.2.1.1.1.3">𝐞</ci></apply><ci id="S2.E5.m1.3.3.2.4.cmml" xref="S2.E5.m1.3.3.2.4">𝑝</ci><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝐞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.3c">p(\mathbf{e}|\mathcal{X})\propto p(\mathcal{X}|\mathbf{e})p(\mathbf{e})</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.3d">italic_p ( bold_e | caligraphic_X ) ∝ italic_p ( caligraphic_X | bold_e ) italic_p ( bold_e )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.3">For each user in the set <math alttext="U={u_{1},u_{2},\dots,u_{m}}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.4"><semantics id="S2.SS2.p2.1.m1.4a"><mrow id="S2.SS2.p2.1.m1.4.4" xref="S2.SS2.p2.1.m1.4.4.cmml"><mi id="S2.SS2.p2.1.m1.4.4.5" xref="S2.SS2.p2.1.m1.4.4.5.cmml">U</mi><mo id="S2.SS2.p2.1.m1.4.4.4" xref="S2.SS2.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS2.p2.1.m1.4.4.3.3" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml"><msub id="S2.SS2.p2.1.m1.2.2.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml">u</mi><mn id="S2.SS2.p2.1.m1.2.2.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.1.m1.4.4.3.3.4" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.3.3.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.1.m1.3.3.2.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2.cmml">u</mi><mn id="S2.SS2.p2.1.m1.3.3.2.2.2.3" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p2.1.m1.4.4.3.3.5" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS2.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS2.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p2.1.m1.4.4.3.3.6" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.4.4.3.3.3" xref="S2.SS2.p2.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS2.p2.1.m1.4.4.3.3.3.2" xref="S2.SS2.p2.1.m1.4.4.3.3.3.2.cmml">u</mi><mi id="S2.SS2.p2.1.m1.4.4.3.3.3.3" xref="S2.SS2.p2.1.m1.4.4.3.3.3.3.cmml">m</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.4b"><apply id="S2.SS2.p2.1.m1.4.4.cmml" xref="S2.SS2.p2.1.m1.4.4"><eq id="S2.SS2.p2.1.m1.4.4.4.cmml" xref="S2.SS2.p2.1.m1.4.4.4"></eq><ci id="S2.SS2.p2.1.m1.4.4.5.cmml" xref="S2.SS2.p2.1.m1.4.4.5">𝑈</ci><list id="S2.SS2.p2.1.m1.4.4.3.4.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3"><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2">𝑢</ci><cn id="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2">𝑢</ci><cn id="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">…</ci><apply id="S2.SS2.p2.1.m1.4.4.3.3.3.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3.2">𝑢</ci><ci id="S2.SS2.p2.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.4c">U={u_{1},u_{2},\dots,u_{m}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.4d">italic_U = italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and each item in the set <math alttext="I={i_{1},i_{2},\dots,i_{n}}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.4"><semantics id="S2.SS2.p2.2.m2.4a"><mrow id="S2.SS2.p2.2.m2.4.4" xref="S2.SS2.p2.2.m2.4.4.cmml"><mi id="S2.SS2.p2.2.m2.4.4.5" xref="S2.SS2.p2.2.m2.4.4.5.cmml">I</mi><mo id="S2.SS2.p2.2.m2.4.4.4" xref="S2.SS2.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS2.p2.2.m2.4.4.3.3" xref="S2.SS2.p2.2.m2.4.4.3.4.cmml"><msub id="S2.SS2.p2.2.m2.2.2.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S2.SS2.p2.2.m2.2.2.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.2.m2.4.4.3.3.4" xref="S2.SS2.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.2.m2.3.3.2.2.2" xref="S2.SS2.p2.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.2.m2.3.3.2.2.2.2" xref="S2.SS2.p2.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S2.SS2.p2.2.m2.3.3.2.2.2.3" xref="S2.SS2.p2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p2.2.m2.4.4.3.3.5" xref="S2.SS2.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S2.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S2.SS2.p2.2.m2.4.4.3.3.6" xref="S2.SS2.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.2.m2.4.4.3.3.3" xref="S2.SS2.p2.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS2.p2.2.m2.4.4.3.3.3.2" xref="S2.SS2.p2.2.m2.4.4.3.3.3.2.cmml">i</mi><mi id="S2.SS2.p2.2.m2.4.4.3.3.3.3" xref="S2.SS2.p2.2.m2.4.4.3.3.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.4b"><apply id="S2.SS2.p2.2.m2.4.4.cmml" xref="S2.SS2.p2.2.m2.4.4"><eq id="S2.SS2.p2.2.m2.4.4.4.cmml" xref="S2.SS2.p2.2.m2.4.4.4"></eq><ci id="S2.SS2.p2.2.m2.4.4.5.cmml" xref="S2.SS2.p2.2.m2.4.4.5">𝐼</ci><list id="S2.SS2.p2.2.m2.4.4.3.4.cmml" xref="S2.SS2.p2.2.m2.4.4.3.3"><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S2.SS2.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S2.SS2.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">…</ci><apply id="S2.SS2.p2.2.m2.4.4.3.3.3.cmml" xref="S2.SS2.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS2.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.p2.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS2.p2.2.m2.4.4.3.3.3.2">𝑖</ci><ci id="S2.SS2.p2.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS2.p2.2.m2.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.4c">I={i_{1},i_{2},\dots,i_{n}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.4d">italic_I = italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">caligraphic_X</annotation></semantics></math> represents the historical interactions between users and items. The predictive scoring function, which is determined by the inner product of the user and item embeddings, can be defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{ui}=\mathbf{e}_{u}^{T}\cdot\mathbf{e}_{i}" class="ltx_Math" display="block" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><msub id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml"><mover accent="true" id="S2.E6.m1.1.1.2.2" xref="S2.E6.m1.1.1.2.2.cmml"><mi id="S2.E6.m1.1.1.2.2.2" xref="S2.E6.m1.1.1.2.2.2.cmml">y</mi><mo id="S2.E6.m1.1.1.2.2.1" xref="S2.E6.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.E6.m1.1.1.2.3" xref="S2.E6.m1.1.1.2.3.cmml"><mi id="S2.E6.m1.1.1.2.3.2" xref="S2.E6.m1.1.1.2.3.2.cmml">u</mi><mo id="S2.E6.m1.1.1.2.3.1" xref="S2.E6.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E6.m1.1.1.2.3.3" xref="S2.E6.m1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><msubsup id="S2.E6.m1.1.1.3.2" xref="S2.E6.m1.1.1.3.2.cmml"><mi id="S2.E6.m1.1.1.3.2.2.2" xref="S2.E6.m1.1.1.3.2.2.2.cmml">𝐞</mi><mi id="S2.E6.m1.1.1.3.2.2.3" xref="S2.E6.m1.1.1.3.2.2.3.cmml">u</mi><mi id="S2.E6.m1.1.1.3.2.3" xref="S2.E6.m1.1.1.3.2.3.cmml">T</mi></msubsup><mo id="S2.E6.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E6.m1.1.1.3.1.cmml">⋅</mo><msub id="S2.E6.m1.1.1.3.3" xref="S2.E6.m1.1.1.3.3.cmml"><mi id="S2.E6.m1.1.1.3.3.2" xref="S2.E6.m1.1.1.3.3.2.cmml">𝐞</mi><mi id="S2.E6.m1.1.1.3.3.3" xref="S2.E6.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><eq id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"></eq><apply id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.2">subscript</csymbol><apply id="S2.E6.m1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.2.2"><ci id="S2.E6.m1.1.1.2.2.1.cmml" xref="S2.E6.m1.1.1.2.2.1">^</ci><ci id="S2.E6.m1.1.1.2.2.2.cmml" xref="S2.E6.m1.1.1.2.2.2">𝑦</ci></apply><apply id="S2.E6.m1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.2.3"><times id="S2.E6.m1.1.1.2.3.1.cmml" xref="S2.E6.m1.1.1.2.3.1"></times><ci id="S2.E6.m1.1.1.2.3.2.cmml" xref="S2.E6.m1.1.1.2.3.2">𝑢</ci><ci id="S2.E6.m1.1.1.2.3.3.cmml" xref="S2.E6.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><ci id="S2.E6.m1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.3.1">⋅</ci><apply id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.3.2">superscript</csymbol><apply id="S2.E6.m1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.2.2.1.cmml" xref="S2.E6.m1.1.1.3.2">subscript</csymbol><ci id="S2.E6.m1.1.1.3.2.2.2.cmml" xref="S2.E6.m1.1.1.3.2.2.2">𝐞</ci><ci id="S2.E6.m1.1.1.3.2.2.3.cmml" xref="S2.E6.m1.1.1.3.2.2.3">𝑢</ci></apply><ci id="S2.E6.m1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.3.2.3">𝑇</ci></apply><apply id="S2.E6.m1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.3.1.cmml" xref="S2.E6.m1.1.1.3.3">subscript</csymbol><ci id="S2.E6.m1.1.1.3.3.2.cmml" xref="S2.E6.m1.1.1.3.3.2">𝐞</ci><ci id="S2.E6.m1.1.1.3.3.3.cmml" xref="S2.E6.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\hat{y}_{ui}=\mathbf{e}_{u}^{T}\cdot\mathbf{e}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ⋅ bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.8">Assuming normalization, the range of <math alttext="\hat{y}_{ui}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m1.1"><semantics id="S2.SS2.p2.4.m1.1a"><msub id="S2.SS2.p2.4.m1.1.1" xref="S2.SS2.p2.4.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p2.4.m1.1.1.2" xref="S2.SS2.p2.4.m1.1.1.2.cmml"><mi id="S2.SS2.p2.4.m1.1.1.2.2" xref="S2.SS2.p2.4.m1.1.1.2.2.cmml">y</mi><mo id="S2.SS2.p2.4.m1.1.1.2.1" xref="S2.SS2.p2.4.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.SS2.p2.4.m1.1.1.3" xref="S2.SS2.p2.4.m1.1.1.3.cmml"><mi id="S2.SS2.p2.4.m1.1.1.3.2" xref="S2.SS2.p2.4.m1.1.1.3.2.cmml">u</mi><mo id="S2.SS2.p2.4.m1.1.1.3.1" xref="S2.SS2.p2.4.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.4.m1.1.1.3.3" xref="S2.SS2.p2.4.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m1.1b"><apply id="S2.SS2.p2.4.m1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m1.1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1">subscript</csymbol><apply id="S2.SS2.p2.4.m1.1.1.2.cmml" xref="S2.SS2.p2.4.m1.1.1.2"><ci id="S2.SS2.p2.4.m1.1.1.2.1.cmml" xref="S2.SS2.p2.4.m1.1.1.2.1">^</ci><ci id="S2.SS2.p2.4.m1.1.1.2.2.cmml" xref="S2.SS2.p2.4.m1.1.1.2.2">𝑦</ci></apply><apply id="S2.SS2.p2.4.m1.1.1.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3"><times id="S2.SS2.p2.4.m1.1.1.3.1.cmml" xref="S2.SS2.p2.4.m1.1.1.3.1"></times><ci id="S2.SS2.p2.4.m1.1.1.3.2.cmml" xref="S2.SS2.p2.4.m1.1.1.3.2">𝑢</ci><ci id="S2.SS2.p2.4.m1.1.1.3.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m1.1c">\hat{y}_{ui}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is between <math alttext="0" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m2.1"><semantics id="S2.SS2.p2.5.m2.1a"><mn id="S2.SS2.p2.5.m2.1.1" xref="S2.SS2.p2.5.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m2.1b"><cn id="S2.SS2.p2.5.m2.1.1.cmml" type="integer" xref="S2.SS2.p2.5.m2.1.1">0</cn></annotation-xml></semantics></math> and <math alttext="1" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m3.1"><semantics id="S2.SS2.p2.6.m3.1a"><mn id="S2.SS2.p2.6.m3.1.1" xref="S2.SS2.p2.6.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m3.1b"><cn id="S2.SS2.p2.6.m3.1.1.cmml" type="integer" xref="S2.SS2.p2.6.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m3.1d">1</annotation></semantics></math>, representing the predicted likelihood of user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m4.1"><semantics id="S2.SS2.p2.7.m4.1a"><mi id="S2.SS2.p2.7.m4.1.1" xref="S2.SS2.p2.7.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m4.1b"><ci id="S2.SS2.p2.7.m4.1.1.cmml" xref="S2.SS2.p2.7.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m4.1d">italic_u</annotation></semantics></math> interacting with item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m5.1"><semantics id="S2.SS2.p2.8.m5.1a"><mi id="S2.SS2.p2.8.m5.1.1" xref="S2.SS2.p2.8.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m5.1b"><ci id="S2.SS2.p2.8.m5.1.1.cmml" xref="S2.SS2.p2.8.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m5.1d">italic_i</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="348" id="S3.F1.g1" src="x1.png" width="797"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The overall architecture of our XRec. (i). <span class="ltx_text ltx_font_bold" id="S3.F1.4.1">Collaborative Relation Tokenizer</span>: Transforms complex user-item relationships into latent embeddings using GNNs; (ii) <span class="ltx_text ltx_font_bold" id="S3.F1.5.2">Collaborative Information Adapter</span>: A lightweight adapter that integrates collaborative signals into LLMs. (iii) <span class="ltx_text ltx_font_bold" id="S3.F1.6.3">Unifying CF with LLM</span>: Integrates collaborative filtering insights directly into large language models, enabling them to generate insightful explanations.</figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we provide a comprehensive overview of our XRec, which is specifically designed to generate explanations for user-item interactions. The goal of our model is to uncover the underlying reasons behind these interactions and shed light on the factors influencing user behavior. By unifying graph collaborative filtering and large language models, our XRec aims to provide insightful explanations which help users understand why certain interactions occur and enhance the transparency of the recommendation process.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Collaborative Relation Tokenizer</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To efficiently capture the collaborative relationships between a large number of users and items and reflect their interaction patterns, natural language falls short, but representations offer a powerful alternative. In our XRec, we harness the capabilities of graph neural networks as the tokenizer to encode the high-order collaborative relational information into a latent embedding space, enabling effective modeling of complex user preference.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Graph-based Message Passing.</span> The collaborative graph tokenizer in our approach utilizes message passing mechanisms to propagate and aggregate information across the user-item interaction graph, facilitating the learning of representations for user and item nodes. In our framework, we employ LightGCN <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib4" title="">2020</a>)</cite> as the backbone for effective collaborative information aggregation.</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{e}_{u}^{(l+1)}=\sum_{i\in\mathcal{N}_{u}}\frac{1}{\sqrt{|%
\mathcal{N}_{u}|}\sqrt{|\mathcal{N}_{i}|}}\mathbf{e}_{i}^{(l)}," class="ltx_Math" display="inline" id="S3.E7X.2.1.1.m1.5"><semantics id="S3.E7X.2.1.1.m1.5a"><mrow id="S3.E7X.2.1.1.m1.5.5.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.5.5.1.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.cmml"><msubsup id="S3.E7X.2.1.1.m1.5.5.1.1.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.2.cmml"><mi id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.2.2.2.cmml">𝐞</mi><mi id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.2.2.3.cmml">u</mi><mrow id="S3.E7X.2.1.1.m1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.E7X.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7X.2.1.1.m1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E7X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E7X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E7X.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7X.2.1.1.m1.5.5.1.1.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E7X.2.1.1.m1.5.5.1.1.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E7X.2.1.1.m1.5.5.1.1.3.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.cmml"><munder id="S3.E7X.2.1.1.m1.5.5.1.1.3.1a" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.cmml"><mo id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.2" movablelimits="false" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.cmml"><mi id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.2.cmml">i</mi><mo id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.1.cmml">∈</mo><msub id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.2.cmml">𝒩</mi><mi id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.3.cmml">u</mi></msub></mrow></munder></mstyle><mrow id="S3.E7X.2.1.1.m1.5.5.1.1.3.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E7X.2.1.1.m1.3.3" xref="S3.E7X.2.1.1.m1.3.3.cmml"><mfrac id="S3.E7X.2.1.1.m1.3.3a" xref="S3.E7X.2.1.1.m1.3.3.cmml"><mn id="S3.E7X.2.1.1.m1.3.3.4" xref="S3.E7X.2.1.1.m1.3.3.4.cmml">1</mn><mrow id="S3.E7X.2.1.1.m1.3.3.2" xref="S3.E7X.2.1.1.m1.3.3.2.cmml"><msqrt id="S3.E7X.2.1.1.m1.2.2.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.2.cmml"><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.2.1.cmml">|</mo><msub id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒩</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.2.1.cmml">|</mo></mrow></msqrt><mo id="S3.E7X.2.1.1.m1.3.3.2.3" xref="S3.E7X.2.1.1.m1.3.3.2.3.cmml">⁢</mo><msqrt id="S3.E7X.2.1.1.m1.3.3.2.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.cmml"><mrow id="S3.E7X.2.1.1.m1.3.3.2.2.1.1" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.2.cmml"><mo id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.2" stretchy="false" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.2.1.cmml">|</mo><msub id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.2" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.2.cmml">𝒩</mi><mi id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.3" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.3" stretchy="false" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.2.1.cmml">|</mo></mrow></msqrt></mrow></mfrac></mstyle><mo id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.1" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.2.cmml">𝐞</mi><mi id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.3.cmml">i</mi><mrow id="S3.E7X.2.1.1.m1.4.4.1.3" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.cmml"><mo id="S3.E7X.2.1.1.m1.4.4.1.3.1" stretchy="false" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.cmml">(</mo><mi id="S3.E7X.2.1.1.m1.4.4.1.1" xref="S3.E7X.2.1.1.m1.4.4.1.1.cmml">l</mi><mo id="S3.E7X.2.1.1.m1.4.4.1.3.2" stretchy="false" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E7X.2.1.1.m1.5.5.1.2" xref="S3.E7X.2.1.1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.5b"><apply id="S3.E7X.2.1.1.m1.5.5.1.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1"><eq id="S3.E7X.2.1.1.m1.5.5.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.1"></eq><apply id="S3.E7X.2.1.1.m1.5.5.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2.2.2">𝐞</ci><ci id="S3.E7X.2.1.1.m1.5.5.1.1.2.2.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.2.2.3">𝑢</ci></apply><apply id="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1"><plus id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1"></plus><ci id="S3.E7X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.2">𝑙</ci><cn id="S3.E7X.2.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3"><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.2"></sum><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3"><in id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.1"></in><ci id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.2">𝑖</ci><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.2">𝒩</ci><ci id="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.1.3.3.3">𝑢</ci></apply></apply></apply><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2"><times id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.1"></times><apply id="S3.E7X.2.1.1.m1.3.3.cmml" xref="S3.E7X.2.1.1.m1.3.3"><divide id="S3.E7X.2.1.1.m1.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.3.3"></divide><cn id="S3.E7X.2.1.1.m1.3.3.4.cmml" type="integer" xref="S3.E7X.2.1.1.m1.3.3.4">1</cn><apply id="S3.E7X.2.1.1.m1.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2"><times id="S3.E7X.2.1.1.m1.3.3.2.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.3"></times><apply id="S3.E7X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1"><root id="S3.E7X.2.1.1.m1.2.2.1.1a.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1"></root><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1"><abs id="S3.E7X.2.1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2"></abs><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2">𝒩</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><apply id="S3.E7X.2.1.1.m1.3.3.2.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2"><root id="S3.E7X.2.1.1.m1.3.3.2.2a.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2"></root><apply id="S3.E7X.2.1.1.m1.3.3.2.2.1.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1"><abs id="S3.E7X.2.1.1.m1.3.3.2.2.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.2"></abs><apply id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.2">𝒩</ci><ci id="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.3.3.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.2">𝐞</ci><ci id="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S3.E7X.2.1.1.m1.5.5.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E7X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E7X.2.1.1.m1.4.4.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.5c">\displaystyle\mathbf{e}_{u}^{(l+1)}=\sum_{i\in\mathcal{N}_{u}}\frac{1}{\sqrt{|%
\mathcal{N}_{u}|}\sqrt{|\mathcal{N}_{i}|}}\mathbf{e}_{i}^{(l)},</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.2.1.1.m1.5d">bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG square-root start_ARG | caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_ARG square-root start_ARG | caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG end_ARG bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{e}_{i}^{(l+1)}=\sum_{u\in\mathcal{N}_{i}}\frac{1}{\sqrt{|%
\mathcal{N}_{i}|}\sqrt{|\mathcal{N}_{u}|}}\mathbf{e}_{u}^{(l)}" class="ltx_Math" display="inline" id="S3.E7Xa.2.1.1.m1.4"><semantics id="S3.E7Xa.2.1.1.m1.4a"><mrow id="S3.E7Xa.2.1.1.m1.4.5" xref="S3.E7Xa.2.1.1.m1.4.5.cmml"><msubsup id="S3.E7Xa.2.1.1.m1.4.5.2" xref="S3.E7Xa.2.1.1.m1.4.5.2.cmml"><mi id="S3.E7Xa.2.1.1.m1.4.5.2.2.2" xref="S3.E7Xa.2.1.1.m1.4.5.2.2.2.cmml">𝐞</mi><mi id="S3.E7Xa.2.1.1.m1.4.5.2.2.3" xref="S3.E7Xa.2.1.1.m1.4.5.2.2.3.cmml">i</mi><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7Xa.2.1.1.m1.4.5.1" xref="S3.E7Xa.2.1.1.m1.4.5.1.cmml">=</mo><mrow id="S3.E7Xa.2.1.1.m1.4.5.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.cmml"><mstyle displaystyle="true" id="S3.E7Xa.2.1.1.m1.4.5.3.1" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.cmml"><munder id="S3.E7Xa.2.1.1.m1.4.5.3.1a" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.cmml"><mo id="S3.E7Xa.2.1.1.m1.4.5.3.1.2" movablelimits="false" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.2.cmml">∑</mo><mrow id="S3.E7Xa.2.1.1.m1.4.5.3.1.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.2" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.2.cmml">u</mi><mo id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.1" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.1.cmml">∈</mo><msub id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.2" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.2.cmml">𝒩</mi><mi id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S3.E7Xa.2.1.1.m1.4.5.3.2" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.cmml"><mstyle displaystyle="true" id="S3.E7Xa.2.1.1.m1.3.3" xref="S3.E7Xa.2.1.1.m1.3.3.cmml"><mfrac id="S3.E7Xa.2.1.1.m1.3.3a" xref="S3.E7Xa.2.1.1.m1.3.3.cmml"><mn id="S3.E7Xa.2.1.1.m1.3.3.4" xref="S3.E7Xa.2.1.1.m1.3.3.4.cmml">1</mn><mrow id="S3.E7Xa.2.1.1.m1.3.3.2" xref="S3.E7Xa.2.1.1.m1.3.3.2.cmml"><msqrt id="S3.E7Xa.2.1.1.m1.2.2.1.1" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.2.cmml"><mo id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.2.1.cmml">|</mo><msub id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒩</mi><mi id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.2.1.cmml">|</mo></mrow></msqrt><mo id="S3.E7Xa.2.1.1.m1.3.3.2.3" xref="S3.E7Xa.2.1.1.m1.3.3.2.3.cmml">⁢</mo><msqrt id="S3.E7Xa.2.1.1.m1.3.3.2.2" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.cmml"><mrow id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.2.cmml"><mo id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.2" stretchy="false" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.2.1.cmml">|</mo><msub id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.2.cmml">𝒩</mi><mi id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.3.cmml">u</mi></msub><mo id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.3" stretchy="false" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.2.1.cmml">|</mo></mrow></msqrt></mrow></mfrac></mstyle><mo id="S3.E7Xa.2.1.1.m1.4.5.3.2.1" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.1.cmml">⁢</mo><msubsup id="S3.E7Xa.2.1.1.m1.4.5.3.2.2" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.cmml"><mi id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.2" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.2.cmml">𝐞</mi><mi id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.3.cmml">u</mi><mrow id="S3.E7Xa.2.1.1.m1.4.4.1.3" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.cmml"><mo id="S3.E7Xa.2.1.1.m1.4.4.1.3.1" stretchy="false" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.cmml">(</mo><mi id="S3.E7Xa.2.1.1.m1.4.4.1.1" xref="S3.E7Xa.2.1.1.m1.4.4.1.1.cmml">l</mi><mo id="S3.E7Xa.2.1.1.m1.4.4.1.3.2" stretchy="false" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.4b"><apply id="S3.E7Xa.2.1.1.m1.4.5.cmml" xref="S3.E7Xa.2.1.1.m1.4.5"><eq id="S3.E7Xa.2.1.1.m1.4.5.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.1"></eq><apply id="S3.E7Xa.2.1.1.m1.4.5.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.4.5.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.4.5.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2.2.2">𝐞</ci><ci id="S3.E7Xa.2.1.1.m1.4.5.2.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.2.2.3">𝑖</ci></apply><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1"><plus id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1"></plus><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2">𝑙</ci><cn id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E7Xa.2.1.1.m1.4.5.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3"><apply id="S3.E7Xa.2.1.1.m1.4.5.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.3.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1">subscript</csymbol><sum id="S3.E7Xa.2.1.1.m1.4.5.3.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.2"></sum><apply id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3"><in id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.1"></in><ci id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.2">𝑢</ci><apply id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.2">𝒩</ci><ci id="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E7Xa.2.1.1.m1.4.5.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2"><times id="S3.E7Xa.2.1.1.m1.4.5.3.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.1"></times><apply id="S3.E7Xa.2.1.1.m1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.3.3"><divide id="S3.E7Xa.2.1.1.m1.3.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.3.3"></divide><cn id="S3.E7Xa.2.1.1.m1.3.3.4.cmml" type="integer" xref="S3.E7Xa.2.1.1.m1.3.3.4">1</cn><apply id="S3.E7Xa.2.1.1.m1.3.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2"><times id="S3.E7Xa.2.1.1.m1.3.3.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.3"></times><apply id="S3.E7Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1"><root id="S3.E7Xa.2.1.1.m1.2.2.1.1a.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1"></root><apply id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1"><abs id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.2"></abs><apply id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.2">𝒩</ci><ci id="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E7Xa.2.1.1.m1.3.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2"><root id="S3.E7Xa.2.1.1.m1.3.3.2.2a.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2"></root><apply id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1"><abs id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.2"></abs><apply id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.2">𝒩</ci><ci id="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.3.3.2.2.1.1.1.3">𝑢</ci></apply></apply></apply></apply></apply><apply id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.2">𝐞</ci><ci id="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.4.5.3.2.2.2.3">𝑢</ci></apply><ci id="S3.E7Xa.2.1.1.m1.4.4.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.4.4.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.4c">\displaystyle\mathbf{e}_{i}^{(l+1)}=\sum_{u\in\mathcal{N}_{i}}\frac{1}{\sqrt{|%
\mathcal{N}_{i}|}\sqrt{|\mathcal{N}_{u}|}}\mathbf{e}_{u}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.2.1.1.m1.4d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l + 1 ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG square-root start_ARG | caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG square-root start_ARG | caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_ARG end_ARG bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.2">The user and item final embeddings are computed by averaging all layer embeddings.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}_{u}=\sum_{k=0}^{K}\frac{1}{K+1}\mathbf{e}_{u}^{(k)},\quad\mathbf{e}%
_{i}=\sum_{k=0}^{K}\frac{1}{K+1}\mathbf{e}_{i}^{(k)}" class="ltx_Math" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4.2" xref="S3.E8.m1.4.4.3.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2" xref="S3.E8.m1.3.3.1.1.2.2.cmml">𝐞</mi><mi id="S3.E8.m1.3.3.1.1.2.3" xref="S3.E8.m1.3.3.1.1.2.3.cmml">u</mi></msub><mo id="S3.E8.m1.3.3.1.1.1" rspace="0.111em" xref="S3.E8.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml"><munderover id="S3.E8.m1.3.3.1.1.3.1" xref="S3.E8.m1.3.3.1.1.3.1.cmml"><mo id="S3.E8.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S3.E8.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.3.3.1.1.3.1.2.3" xref="S3.E8.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.1.2.3.2" xref="S3.E8.m1.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E8.m1.3.3.1.1.3.1.2.3.1" xref="S3.E8.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.3.3.1.1.3.1.2.3.3" xref="S3.E8.m1.3.3.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E8.m1.3.3.1.1.3.1.3" xref="S3.E8.m1.3.3.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.3.3.1.1.3.2" xref="S3.E8.m1.3.3.1.1.3.2.cmml"><mfrac id="S3.E8.m1.3.3.1.1.3.2.2" xref="S3.E8.m1.3.3.1.1.3.2.2.cmml"><mn id="S3.E8.m1.3.3.1.1.3.2.2.2" xref="S3.E8.m1.3.3.1.1.3.2.2.2.cmml">1</mn><mrow id="S3.E8.m1.3.3.1.1.3.2.2.3" xref="S3.E8.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.2.2.3.2" xref="S3.E8.m1.3.3.1.1.3.2.2.3.2.cmml">K</mi><mo id="S3.E8.m1.3.3.1.1.3.2.2.3.1" xref="S3.E8.m1.3.3.1.1.3.2.2.3.1.cmml">+</mo><mn id="S3.E8.m1.3.3.1.1.3.2.2.3.3" xref="S3.E8.m1.3.3.1.1.3.2.2.3.3.cmml">1</mn></mrow></mfrac><mo id="S3.E8.m1.3.3.1.1.3.2.1" xref="S3.E8.m1.3.3.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E8.m1.3.3.1.1.3.2.3" xref="S3.E8.m1.3.3.1.1.3.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.2.3.2.2" xref="S3.E8.m1.3.3.1.1.3.2.3.2.2.cmml">𝐞</mi><mi id="S3.E8.m1.3.3.1.1.3.2.3.2.3" xref="S3.E8.m1.3.3.1.1.3.2.3.2.3.cmml">u</mi><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.3.2.3.cmml"><mo id="S3.E8.m1.1.1.1.3.1" stretchy="false" xref="S3.E8.m1.3.3.1.1.3.2.3.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">k</mi><mo id="S3.E8.m1.1.1.1.3.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E8.m1.4.4.2.3" rspace="1.167em" xref="S3.E8.m1.4.4.3a.cmml">,</mo><mrow id="S3.E8.m1.4.4.2.2" xref="S3.E8.m1.4.4.2.2.cmml"><msub id="S3.E8.m1.4.4.2.2.2" xref="S3.E8.m1.4.4.2.2.2.cmml"><mi id="S3.E8.m1.4.4.2.2.2.2" xref="S3.E8.m1.4.4.2.2.2.2.cmml">𝐞</mi><mi id="S3.E8.m1.4.4.2.2.2.3" xref="S3.E8.m1.4.4.2.2.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.4.4.2.2.1" rspace="0.111em" xref="S3.E8.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E8.m1.4.4.2.2.3" xref="S3.E8.m1.4.4.2.2.3.cmml"><munderover id="S3.E8.m1.4.4.2.2.3.1" xref="S3.E8.m1.4.4.2.2.3.1.cmml"><mo id="S3.E8.m1.4.4.2.2.3.1.2.2" movablelimits="false" xref="S3.E8.m1.4.4.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.4.4.2.2.3.1.2.3" xref="S3.E8.m1.4.4.2.2.3.1.2.3.cmml"><mi id="S3.E8.m1.4.4.2.2.3.1.2.3.2" xref="S3.E8.m1.4.4.2.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E8.m1.4.4.2.2.3.1.2.3.1" xref="S3.E8.m1.4.4.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.4.4.2.2.3.1.2.3.3" xref="S3.E8.m1.4.4.2.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E8.m1.4.4.2.2.3.1.3" xref="S3.E8.m1.4.4.2.2.3.1.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.4.4.2.2.3.2" xref="S3.E8.m1.4.4.2.2.3.2.cmml"><mfrac id="S3.E8.m1.4.4.2.2.3.2.2" xref="S3.E8.m1.4.4.2.2.3.2.2.cmml"><mn id="S3.E8.m1.4.4.2.2.3.2.2.2" xref="S3.E8.m1.4.4.2.2.3.2.2.2.cmml">1</mn><mrow id="S3.E8.m1.4.4.2.2.3.2.2.3" xref="S3.E8.m1.4.4.2.2.3.2.2.3.cmml"><mi id="S3.E8.m1.4.4.2.2.3.2.2.3.2" xref="S3.E8.m1.4.4.2.2.3.2.2.3.2.cmml">K</mi><mo id="S3.E8.m1.4.4.2.2.3.2.2.3.1" xref="S3.E8.m1.4.4.2.2.3.2.2.3.1.cmml">+</mo><mn id="S3.E8.m1.4.4.2.2.3.2.2.3.3" xref="S3.E8.m1.4.4.2.2.3.2.2.3.3.cmml">1</mn></mrow></mfrac><mo id="S3.E8.m1.4.4.2.2.3.2.1" xref="S3.E8.m1.4.4.2.2.3.2.1.cmml">⁢</mo><msubsup id="S3.E8.m1.4.4.2.2.3.2.3" xref="S3.E8.m1.4.4.2.2.3.2.3.cmml"><mi id="S3.E8.m1.4.4.2.2.3.2.3.2.2" xref="S3.E8.m1.4.4.2.2.3.2.3.2.2.cmml">𝐞</mi><mi id="S3.E8.m1.4.4.2.2.3.2.3.2.3" xref="S3.E8.m1.4.4.2.2.3.2.3.2.3.cmml">i</mi><mrow id="S3.E8.m1.2.2.1.3" xref="S3.E8.m1.4.4.2.2.3.2.3.cmml"><mo id="S3.E8.m1.2.2.1.3.1" stretchy="false" xref="S3.E8.m1.4.4.2.2.3.2.3.cmml">(</mo><mi id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml">k</mi><mo id="S3.E8.m1.2.2.1.3.2" stretchy="false" xref="S3.E8.m1.4.4.2.2.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.3.cmml" xref="S3.E8.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.3a.cmml" xref="S3.E8.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1"><eq id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"></eq><apply id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2">𝐞</ci><ci id="S3.E8.m1.3.3.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.3">𝑢</ci></apply><apply id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3"><apply id="S3.E8.m1.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.3.1.2.cmml" xref="S3.E8.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E8.m1.3.3.1.1.3.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.3.1.2.2"></sum><apply id="S3.E8.m1.3.3.1.1.3.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.3.1.2.3"><eq id="S3.E8.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E8.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.E8.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.3.1.2.3.3">0</cn></apply></apply><ci id="S3.E8.m1.3.3.1.1.3.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E8.m1.3.3.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2"><times id="S3.E8.m1.3.3.1.1.3.2.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2.1"></times><apply id="S3.E8.m1.3.3.1.1.3.2.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2.2"><divide id="S3.E8.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2.2"></divide><cn id="S3.E8.m1.3.3.1.1.3.2.2.2.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.3.2.2.2">1</cn><apply id="S3.E8.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.3.2.2.3"><plus id="S3.E8.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2.2.3.1"></plus><ci id="S3.E8.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2.2.3.2">𝐾</ci><cn id="S3.E8.m1.3.3.1.1.3.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.3.2.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.3.3.1.1.3.2.3.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3.2.2">𝐞</ci><ci id="S3.E8.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S3.E8.m1.3.3.1.1.3.2.3.2.3">𝑢</ci></apply><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑘</ci></apply></apply></apply></apply><apply id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2"><eq id="S3.E8.m1.4.4.2.2.1.cmml" xref="S3.E8.m1.4.4.2.2.1"></eq><apply id="S3.E8.m1.4.4.2.2.2.cmml" xref="S3.E8.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.2.1.cmml" xref="S3.E8.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.E8.m1.4.4.2.2.2.2.cmml" xref="S3.E8.m1.4.4.2.2.2.2">𝐞</ci><ci id="S3.E8.m1.4.4.2.2.2.3.cmml" xref="S3.E8.m1.4.4.2.2.2.3">𝑖</ci></apply><apply id="S3.E8.m1.4.4.2.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3"><apply id="S3.E8.m1.4.4.2.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.3.1.1.cmml" xref="S3.E8.m1.4.4.2.2.3.1">superscript</csymbol><apply id="S3.E8.m1.4.4.2.2.3.1.2.cmml" xref="S3.E8.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.3.1.2.1.cmml" xref="S3.E8.m1.4.4.2.2.3.1">subscript</csymbol><sum id="S3.E8.m1.4.4.2.2.3.1.2.2.cmml" xref="S3.E8.m1.4.4.2.2.3.1.2.2"></sum><apply id="S3.E8.m1.4.4.2.2.3.1.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3.1.2.3"><eq id="S3.E8.m1.4.4.2.2.3.1.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.1.2.3.1"></eq><ci id="S3.E8.m1.4.4.2.2.3.1.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.1.2.3.2">𝑘</ci><cn id="S3.E8.m1.4.4.2.2.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.4.4.2.2.3.1.2.3.3">0</cn></apply></apply><ci id="S3.E8.m1.4.4.2.2.3.1.3.cmml" xref="S3.E8.m1.4.4.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E8.m1.4.4.2.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2"><times id="S3.E8.m1.4.4.2.2.3.2.1.cmml" xref="S3.E8.m1.4.4.2.2.3.2.1"></times><apply id="S3.E8.m1.4.4.2.2.3.2.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2.2"><divide id="S3.E8.m1.4.4.2.2.3.2.2.1.cmml" xref="S3.E8.m1.4.4.2.2.3.2.2"></divide><cn id="S3.E8.m1.4.4.2.2.3.2.2.2.cmml" type="integer" xref="S3.E8.m1.4.4.2.2.3.2.2.2">1</cn><apply id="S3.E8.m1.4.4.2.2.3.2.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3.2.2.3"><plus id="S3.E8.m1.4.4.2.2.3.2.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.2.2.3.1"></plus><ci id="S3.E8.m1.4.4.2.2.3.2.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2.2.3.2">𝐾</ci><cn id="S3.E8.m1.4.4.2.2.3.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.4.4.2.2.3.2.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.4.4.2.2.3.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.3.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3">superscript</csymbol><apply id="S3.E8.m1.4.4.2.2.3.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.3.2.3.2.1.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3">subscript</csymbol><ci id="S3.E8.m1.4.4.2.2.3.2.3.2.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3.2.2">𝐞</ci><ci id="S3.E8.m1.4.4.2.2.3.2.3.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1.1">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\mathbf{e}_{u}=\sum_{k=0}^{K}\frac{1}{K+1}\mathbf{e}_{u}^{(k)},\quad\mathbf{e}%
_{i}=\sum_{k=0}^{K}\frac{1}{K+1}\mathbf{e}_{i}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4d">bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_K + 1 end_ARG bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT , bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_K + 1 end_ARG bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.5.1">Tokenizer Optimization with CF signals.</span>
To optimize our collaborative graph tokenizer using implicit feedback signals from user interactions, we utilize the Bayesian Personalized Ranking (BPR) loss as a supervision signal to guide the generation of user and item embeddings, which is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{BPR}=-\sum_{u=1}^{m}\sum_{i\in\mathcal{N}_{u}}\sum_{j\notin\mathcal{N}_{u}}%
\ln\sigma(\hat{y}_{u,i}-\hat{y}_{u,j})" class="ltx_Math" display="block" id="S3.E9.m1.5"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><msub id="S3.E9.m1.5.5.3" xref="S3.E9.m1.5.5.3.cmml"><mi id="S3.E9.m1.5.5.3.2" xref="S3.E9.m1.5.5.3.2.cmml">L</mi><mrow id="S3.E9.m1.5.5.3.3" xref="S3.E9.m1.5.5.3.3.cmml"><mi id="S3.E9.m1.5.5.3.3.2" xref="S3.E9.m1.5.5.3.3.2.cmml">B</mi><mo id="S3.E9.m1.5.5.3.3.1" xref="S3.E9.m1.5.5.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.5.5.3.3.3" xref="S3.E9.m1.5.5.3.3.3.cmml">P</mi><mo id="S3.E9.m1.5.5.3.3.1a" xref="S3.E9.m1.5.5.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.5.5.3.3.4" xref="S3.E9.m1.5.5.3.3.4.cmml">R</mi></mrow></msub><mo id="S3.E9.m1.5.5.2" xref="S3.E9.m1.5.5.2.cmml">=</mo><mrow id="S3.E9.m1.5.5.1" xref="S3.E9.m1.5.5.1.cmml"><mo id="S3.E9.m1.5.5.1a" xref="S3.E9.m1.5.5.1.cmml">−</mo><mrow id="S3.E9.m1.5.5.1.1" xref="S3.E9.m1.5.5.1.1.cmml"><munderover id="S3.E9.m1.5.5.1.1.2" xref="S3.E9.m1.5.5.1.1.2.cmml"><mo id="S3.E9.m1.5.5.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E9.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.5.5.1.1.2.2.3" xref="S3.E9.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.2.2.3.2" xref="S3.E9.m1.5.5.1.1.2.2.3.2.cmml">u</mi><mo id="S3.E9.m1.5.5.1.1.2.2.3.1" xref="S3.E9.m1.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.5.5.1.1.2.2.3.3" xref="S3.E9.m1.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.5.5.1.1.2.3" xref="S3.E9.m1.5.5.1.1.2.3.cmml">m</mi></munderover><mrow id="S3.E9.m1.5.5.1.1.1" xref="S3.E9.m1.5.5.1.1.1.cmml"><munder id="S3.E9.m1.5.5.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.2.cmml"><mo id="S3.E9.m1.5.5.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E9.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.5.5.1.1.1.2.3" xref="S3.E9.m1.5.5.1.1.1.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.2.3.2" xref="S3.E9.m1.5.5.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E9.m1.5.5.1.1.1.2.3.1" xref="S3.E9.m1.5.5.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E9.m1.5.5.1.1.1.2.3.3" xref="S3.E9.m1.5.5.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1.1.2.3.3.2" xref="S3.E9.m1.5.5.1.1.1.2.3.3.2.cmml">𝒩</mi><mi id="S3.E9.m1.5.5.1.1.1.2.3.3.3" xref="S3.E9.m1.5.5.1.1.1.2.3.3.3.cmml">u</mi></msub></mrow></munder><mrow id="S3.E9.m1.5.5.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.cmml"><munder id="S3.E9.m1.5.5.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E9.m1.5.5.1.1.1.1.2.2" movablelimits="false" xref="S3.E9.m1.5.5.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.2.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E9.m1.5.5.1.1.1.1.2.3.1" xref="S3.E9.m1.5.5.1.1.1.1.2.3.1.cmml">∉</mo><msub id="S3.E9.m1.5.5.1.1.1.1.2.3.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1.1.1.2.3.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3.2.cmml">𝒩</mi><mi id="S3.E9.m1.5.5.1.1.1.1.2.3.3.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3.3.cmml">u</mi></msub></mrow></munder><mrow id="S3.E9.m1.5.5.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.5.5.1.1.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.1" xref="S3.E9.m1.5.5.1.1.1.1.1.3.1.cmml">ln</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E9.m1.5.5.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E9.m1.5.5.1.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">u</mi><mo id="S3.E9.m1.2.2.2.4.1" xref="S3.E9.m1.2.2.2.3.cmml">,</mo><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.4.4.2.4" xref="S3.E9.m1.4.4.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">u</mi><mo id="S3.E9.m1.4.4.2.4.1" xref="S3.E9.m1.4.4.2.3.cmml">,</mo><mi id="S3.E9.m1.4.4.2.2" xref="S3.E9.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.5b"><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><eq id="S3.E9.m1.5.5.2.cmml" xref="S3.E9.m1.5.5.2"></eq><apply id="S3.E9.m1.5.5.3.cmml" xref="S3.E9.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.3.1.cmml" xref="S3.E9.m1.5.5.3">subscript</csymbol><ci id="S3.E9.m1.5.5.3.2.cmml" xref="S3.E9.m1.5.5.3.2">𝐿</ci><apply id="S3.E9.m1.5.5.3.3.cmml" xref="S3.E9.m1.5.5.3.3"><times id="S3.E9.m1.5.5.3.3.1.cmml" xref="S3.E9.m1.5.5.3.3.1"></times><ci id="S3.E9.m1.5.5.3.3.2.cmml" xref="S3.E9.m1.5.5.3.3.2">𝐵</ci><ci id="S3.E9.m1.5.5.3.3.3.cmml" xref="S3.E9.m1.5.5.3.3.3">𝑃</ci><ci id="S3.E9.m1.5.5.3.3.4.cmml" xref="S3.E9.m1.5.5.3.3.4">𝑅</ci></apply></apply><apply id="S3.E9.m1.5.5.1.cmml" xref="S3.E9.m1.5.5.1"><minus id="S3.E9.m1.5.5.1.2.cmml" xref="S3.E9.m1.5.5.1"></minus><apply id="S3.E9.m1.5.5.1.1.cmml" xref="S3.E9.m1.5.5.1.1"><apply id="S3.E9.m1.5.5.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E9.m1.5.5.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E9.m1.5.5.1.1.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.2.2.2"></sum><apply id="S3.E9.m1.5.5.1.1.2.2.3.cmml" xref="S3.E9.m1.5.5.1.1.2.2.3"><eq id="S3.E9.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.2.2.3.2">𝑢</ci><cn id="S3.E9.m1.5.5.1.1.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.5.5.1.1.2.3.cmml" xref="S3.E9.m1.5.5.1.1.2.3">𝑚</ci></apply><apply id="S3.E9.m1.5.5.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1"><apply id="S3.E9.m1.5.5.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.5.5.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.2.2"></sum><apply id="S3.E9.m1.5.5.1.1.1.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3"><in id="S3.E9.m1.5.5.1.1.1.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.1"></in><ci id="S3.E9.m1.5.5.1.1.1.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.2">𝑖</ci><apply id="S3.E9.m1.5.5.1.1.1.2.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.2.3.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.2.3.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.3.2">𝒩</ci><ci id="S3.E9.m1.5.5.1.1.1.2.3.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.2.3.3.3">𝑢</ci></apply></apply></apply><apply id="S3.E9.m1.5.5.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1"><apply id="S3.E9.m1.5.5.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2"></sum><apply id="S3.E9.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3"><notin id="S3.E9.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.1"></notin><ci id="S3.E9.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2">𝑗</ci><apply id="S3.E9.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.3.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.1.2.3.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3.2">𝒩</ci><ci id="S3.E9.m1.5.5.1.1.1.1.2.3.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.3.3">𝑢</ci></apply></apply></apply><apply id="S3.E9.m1.5.5.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1"><times id="S3.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.2"></times><apply id="S3.E9.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3"><ln id="S3.E9.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.1"></ln><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1"><minus id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><list id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.4"><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑢</ci><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><list id="S3.E9.m1.4.4.2.3.cmml" xref="S3.E9.m1.4.4.2.4"><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">𝑢</ci><ci id="S3.E9.m1.4.4.2.2.cmml" xref="S3.E9.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.5c">L_{BPR}=-\sum_{u=1}^{m}\sum_{i\in\mathcal{N}_{u}}\sum_{j\notin\mathcal{N}_{u}}%
\ln\sigma(\hat{y}_{u,i}-\hat{y}_{u,j})</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.5d">italic_L start_POSTSUBSCRIPT italic_B italic_P italic_R end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_u = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∉ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_ln italic_σ ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.4"><math alttext="\hat{y}_{u,i}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.2"><semantics id="S3.SS1.p3.1.m1.2a"><msub id="S3.SS1.p3.1.m1.2.3" xref="S3.SS1.p3.1.m1.2.3.cmml"><mover accent="true" id="S3.SS1.p3.1.m1.2.3.2" xref="S3.SS1.p3.1.m1.2.3.2.cmml"><mi id="S3.SS1.p3.1.m1.2.3.2.2" xref="S3.SS1.p3.1.m1.2.3.2.2.cmml">y</mi><mo id="S3.SS1.p3.1.m1.2.3.2.1" xref="S3.SS1.p3.1.m1.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p3.1.m1.2.2.2.4" xref="S3.SS1.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p3.1.m1.2.2.2.4.1" xref="S3.SS1.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p3.1.m1.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><apply id="S3.SS1.p3.1.m1.2.3.cmml" xref="S3.SS1.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.2.3">subscript</csymbol><apply id="S3.SS1.p3.1.m1.2.3.2.cmml" xref="S3.SS1.p3.1.m1.2.3.2"><ci id="S3.SS1.p3.1.m1.2.3.2.1.cmml" xref="S3.SS1.p3.1.m1.2.3.2.1">^</ci><ci id="S3.SS1.p3.1.m1.2.3.2.2.cmml" xref="S3.SS1.p3.1.m1.2.3.2.2">𝑦</ci></apply><list id="S3.SS1.p3.1.m1.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.4"><ci id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">𝑢</ci><ci id="S3.SS1.p3.1.m1.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">\hat{y}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.2d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the prediction score (inner product) between user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_u</annotation></semantics></math> and item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_i</annotation></semantics></math>, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_σ</annotation></semantics></math> denotes the sigmoid function. Additionally, we include a regularization loss to maintain the norm of the embeddings:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{reg}=\lambda(\|\mathbf{e}_{u}^{(0)}\|^{2}+\|\mathbf{e}_{i}^{(0)}\|^{2})" class="ltx_Math" display="block" id="S3.E10.m1.3"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml"><msub id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml"><mi id="S3.E10.m1.3.3.3.2" xref="S3.E10.m1.3.3.3.2.cmml">L</mi><mrow id="S3.E10.m1.3.3.3.3" xref="S3.E10.m1.3.3.3.3.cmml"><mi id="S3.E10.m1.3.3.3.3.2" xref="S3.E10.m1.3.3.3.3.2.cmml">r</mi><mo id="S3.E10.m1.3.3.3.3.1" xref="S3.E10.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E10.m1.3.3.3.3.3" xref="S3.E10.m1.3.3.3.3.3.cmml">e</mi><mo id="S3.E10.m1.3.3.3.3.1a" xref="S3.E10.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E10.m1.3.3.3.3.4" xref="S3.E10.m1.3.3.3.3.4.cmml">g</mi></mrow></msub><mo id="S3.E10.m1.3.3.2" xref="S3.E10.m1.3.3.2.cmml">=</mo><mrow id="S3.E10.m1.3.3.1" xref="S3.E10.m1.3.3.1.cmml"><mi id="S3.E10.m1.3.3.1.3" xref="S3.E10.m1.3.3.1.3.cmml">λ</mi><mo id="S3.E10.m1.3.3.1.2" xref="S3.E10.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.3.3.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.cmml"><mo id="S3.E10.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.cmml"><msup id="S3.E10.m1.3.3.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">u</mi><mrow id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.3.1" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mn id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">0</mn><mo id="S3.E10.m1.1.1.1.3.2" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E10.m1.3.3.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E10.m1.3.3.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.3.cmml">+</mo><msup id="S3.E10.m1.3.3.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.2.cmml"><mrow id="S3.E10.m1.3.3.1.1.1.1.2.1.1" xref="S3.E10.m1.3.3.1.1.1.1.2.1.2.cmml"><mo id="S3.E10.m1.3.3.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.2.1.2.1.cmml">‖</mo><msubsup id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.2" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.3.cmml">i</mi><mrow id="S3.E10.m1.2.2.1.3" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.3.1" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.cmml">(</mo><mn id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml">0</mn><mo id="S3.E10.m1.2.2.1.3.2" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E10.m1.3.3.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E10.m1.3.3.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S3.E10.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E10.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"><eq id="S3.E10.m1.3.3.2.cmml" xref="S3.E10.m1.3.3.2"></eq><apply id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3">subscript</csymbol><ci id="S3.E10.m1.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.2">𝐿</ci><apply id="S3.E10.m1.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3"><times id="S3.E10.m1.3.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.3.1"></times><ci id="S3.E10.m1.3.3.3.3.2.cmml" xref="S3.E10.m1.3.3.3.3.2">𝑟</ci><ci id="S3.E10.m1.3.3.3.3.3.cmml" xref="S3.E10.m1.3.3.3.3.3">𝑒</ci><ci id="S3.E10.m1.3.3.3.3.4.cmml" xref="S3.E10.m1.3.3.3.3.4">𝑔</ci></apply></apply><apply id="S3.E10.m1.3.3.1.cmml" xref="S3.E10.m1.3.3.1"><times id="S3.E10.m1.3.3.1.2.cmml" xref="S3.E10.m1.3.3.1.2"></times><ci id="S3.E10.m1.3.3.1.3.cmml" xref="S3.E10.m1.3.3.1.3">𝜆</ci><apply id="S3.E10.m1.3.3.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1"><plus id="S3.E10.m1.3.3.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.3"></plus><apply id="S3.E10.m1.3.3.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><cn id="S3.E10.m1.1.1.1.1.cmml" type="integer" xref="S3.E10.m1.1.1.1.1">0</cn></apply></apply><cn id="S3.E10.m1.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E10.m1.3.3.1.1.1.1.1.3">2</cn></apply><apply id="S3.E10.m1.3.3.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.2.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.E10.m1.3.3.1.1.1.1.2.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.2">norm</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.2">𝐞</ci><ci id="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.2.1.1.1.2.3">𝑖</ci></apply><cn id="S3.E10.m1.2.2.1.1.cmml" type="integer" xref="S3.E10.m1.2.2.1.1">0</cn></apply></apply><cn id="S3.E10.m1.3.3.1.1.1.1.2.3.cmml" type="integer" xref="S3.E10.m1.3.3.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">L_{reg}=\lambda(\|\mathbf{e}_{u}^{(0)}\|^{2}+\|\mathbf{e}_{i}^{(0)}\|^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.3d">italic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT = italic_λ ( ∥ bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.6">By combining these terms, our joint optimization loss function is formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L=L_{BPR}+L_{reg}" class="ltx_Math" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><mi id="S3.E11.m1.1.1.2" xref="S3.E11.m1.1.1.2.cmml">L</mi><mo id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml">=</mo><mrow id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml"><msub id="S3.E11.m1.1.1.3.2" xref="S3.E11.m1.1.1.3.2.cmml"><mi id="S3.E11.m1.1.1.3.2.2" xref="S3.E11.m1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E11.m1.1.1.3.2.3" xref="S3.E11.m1.1.1.3.2.3.cmml"><mi id="S3.E11.m1.1.1.3.2.3.2" xref="S3.E11.m1.1.1.3.2.3.2.cmml">B</mi><mo id="S3.E11.m1.1.1.3.2.3.1" xref="S3.E11.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.3.2.3.3" xref="S3.E11.m1.1.1.3.2.3.3.cmml">P</mi><mo id="S3.E11.m1.1.1.3.2.3.1a" xref="S3.E11.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.3.2.3.4" xref="S3.E11.m1.1.1.3.2.3.4.cmml">R</mi></mrow></msub><mo id="S3.E11.m1.1.1.3.1" xref="S3.E11.m1.1.1.3.1.cmml">+</mo><msub id="S3.E11.m1.1.1.3.3" xref="S3.E11.m1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.2" xref="S3.E11.m1.1.1.3.3.2.cmml">L</mi><mrow id="S3.E11.m1.1.1.3.3.3" xref="S3.E11.m1.1.1.3.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.3.2" xref="S3.E11.m1.1.1.3.3.3.2.cmml">r</mi><mo id="S3.E11.m1.1.1.3.3.3.1" xref="S3.E11.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.3.3.3.3" xref="S3.E11.m1.1.1.3.3.3.3.cmml">e</mi><mo id="S3.E11.m1.1.1.3.3.3.1a" xref="S3.E11.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.3.3.3.4" xref="S3.E11.m1.1.1.3.3.3.4.cmml">g</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><eq id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"></eq><ci id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1.2">𝐿</ci><apply id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3"><plus id="S3.E11.m1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.3.1"></plus><apply id="S3.E11.m1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.2.1.cmml" xref="S3.E11.m1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.1.1.3.2.2.cmml" xref="S3.E11.m1.1.1.3.2.2">𝐿</ci><apply id="S3.E11.m1.1.1.3.2.3.cmml" xref="S3.E11.m1.1.1.3.2.3"><times id="S3.E11.m1.1.1.3.2.3.1.cmml" xref="S3.E11.m1.1.1.3.2.3.1"></times><ci id="S3.E11.m1.1.1.3.2.3.2.cmml" xref="S3.E11.m1.1.1.3.2.3.2">𝐵</ci><ci id="S3.E11.m1.1.1.3.2.3.3.cmml" xref="S3.E11.m1.1.1.3.2.3.3">𝑃</ci><ci id="S3.E11.m1.1.1.3.2.3.4.cmml" xref="S3.E11.m1.1.1.3.2.3.4">𝑅</ci></apply></apply><apply id="S3.E11.m1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.2">𝐿</ci><apply id="S3.E11.m1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.3.3.3"><times id="S3.E11.m1.1.1.3.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3.3.1"></times><ci id="S3.E11.m1.1.1.3.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.3.2">𝑟</ci><ci id="S3.E11.m1.1.1.3.3.3.3.cmml" xref="S3.E11.m1.1.1.3.3.3.3">𝑒</ci><ci id="S3.E11.m1.1.1.3.3.3.4.cmml" xref="S3.E11.m1.1.1.3.3.3.4">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">L=L_{BPR}+L_{reg}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">italic_L = italic_L start_POSTSUBSCRIPT italic_B italic_P italic_R end_POSTSUBSCRIPT + italic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Collaborative Instruction Tuning for Large Language Models (LLMs)</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To enable LLMs to understand collaborative information among users and items, we introduce a collaborative instruction tuning paradigm. This approach aligns behavior-level information with language-level semantics, thereby incorporating user preferences into the knowledge within LLMs.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Collaborative Information Adapter</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Given the potentially divergent semantic representation spaces between the behavior-level collaborative information and the textual semantics associated with users and items, our XRec is equipped with a lightweight yet effective adapter. This adapter serves to align these different modalities, enabling our model to effectively leverage both the collaborative signals and the textual semantics.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">To bridge the semantic gap between the input of large language models (LLMs) and our behavior-aware collaborative relation tokens, and to enhance the model’s generalization capabilities, we apply a Mixture of Experts (MoE) approach <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib5" title="">2022</a>)</cite> for embedding space adaptation. In this Mixture of Experts architecture, each expert is represented by a linear layer that captures different semantic dimensions, and these experts are then integrated using a learnable gating router mechanism. This allows the model to adaptively combine the different semantic representations encoded by the various experts, effectively bridging the gap between the behavior-aware collaborative relation tokens and textual language tokens.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Unifying CF with LLM</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">With the newly adapted embeddings, we are now ready to infuse collaborative information into LLMs. We introduce special tokens to reserve space in the input prompt, and after transforming the prompt into token embeddings, we inject the adapted embeddings into these reserved positions.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.3">However, a challenge arises as each node embedding is represented by only a single token in the input prompt. As the input length increases, the attention weight allocated to each embedding token inevitably diminishes, leading to a potential loss of collaborative information. To address this dilution of influence, we take inspiration from <cite class="ltx_cite ltx_citemacro_cite">Qin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib11" title="">2023</a>)</cite> and extend the injection of adapted embeddings beyond the initial input prompt. Specifically, we incorporate them into every layer of the LLM at reserved positions. To facilitate this, we modify the key, query, and value projection functions of every layer within the LLMs as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{\{q,k,v\}}(\mathbf{x}_{i})\quad{+=}\quad\mathbf{W}_{\{q,k,v\}}\cdot\mathbf{%
a}_{i}" class="ltx_math_unparsed" display="block" id="S3.E12.m1.6"><semantics id="S3.E12.m1.6a"><mrow id="S3.E12.m1.6b"><msub id="S3.E12.m1.6.7"><mi id="S3.E12.m1.6.7.2">f</mi><mrow id="S3.E12.m1.3.3.3.5"><mo id="S3.E12.m1.3.3.3.5.1" stretchy="false">{</mo><mi id="S3.E12.m1.1.1.1.1">q</mi><mo id="S3.E12.m1.3.3.3.5.2">,</mo><mi id="S3.E12.m1.2.2.2.2">k</mi><mo id="S3.E12.m1.3.3.3.5.3">,</mo><mi id="S3.E12.m1.3.3.3.3">v</mi><mo id="S3.E12.m1.3.3.3.5.4" stretchy="false">}</mo></mrow></msub><mrow id="S3.E12.m1.6.8"><mo id="S3.E12.m1.6.8.1" stretchy="false">(</mo><msub id="S3.E12.m1.6.8.2"><mi id="S3.E12.m1.6.8.2.2">𝐱</mi><mi id="S3.E12.m1.6.8.2.3">i</mi></msub><mo id="S3.E12.m1.6.8.3" stretchy="false">)</mo></mrow><mspace id="S3.E12.m1.6.9" width="1em"></mspace><mo id="S3.E12.m1.6.10" rspace="0em">+</mo><mo id="S3.E12.m1.6.11" lspace="0em">=</mo><mspace id="S3.E12.m1.6.12" width="1em"></mspace><msub id="S3.E12.m1.6.13"><mi id="S3.E12.m1.6.13.2">𝐖</mi><mrow id="S3.E12.m1.6.6.3.5"><mo id="S3.E12.m1.6.6.3.5.1" stretchy="false">{</mo><mi id="S3.E12.m1.4.4.1.1">q</mi><mo id="S3.E12.m1.6.6.3.5.2">,</mo><mi id="S3.E12.m1.5.5.2.2">k</mi><mo id="S3.E12.m1.6.6.3.5.3">,</mo><mi id="S3.E12.m1.6.6.3.3">v</mi><mo id="S3.E12.m1.6.6.3.5.4" stretchy="false">}</mo></mrow></msub><mo id="S3.E12.m1.6.14" lspace="0.222em" rspace="0.222em">⋅</mo><msub id="S3.E12.m1.6.15"><mi id="S3.E12.m1.6.15.2">𝐚</mi><mi id="S3.E12.m1.6.15.3">i</mi></msub></mrow><annotation encoding="application/x-tex" id="S3.E12.m1.6c">f_{\{q,k,v\}}(\mathbf{x}_{i})\quad{+=}\quad\mathbf{W}_{\{q,k,v\}}\cdot\mathbf{%
a}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.6d">italic_f start_POSTSUBSCRIPT { italic_q , italic_k , italic_v } end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + = bold_W start_POSTSUBSCRIPT { italic_q , italic_k , italic_v } end_POSTSUBSCRIPT ⋅ bold_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p2.2">Let’s denote the projection matrices for the query, key, and value as <math alttext="\mathbf{W}_{{q,k,v}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.3"><semantics id="S3.SS2.SSS2.p2.1.m1.3a"><msub id="S3.SS2.SSS2.p2.1.m1.3.4" xref="S3.SS2.SSS2.p2.1.m1.3.4.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.3.4.2" xref="S3.SS2.SSS2.p2.1.m1.3.4.2.cmml">𝐖</mi><mrow id="S3.SS2.SSS2.p2.1.m1.3.3.3.5" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.4.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.cmml">q</mi><mo id="S3.SS2.SSS2.p2.1.m1.3.3.3.5.1" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.p2.1.m1.2.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.cmml">k</mi><mo id="S3.SS2.SSS2.p2.1.m1.3.3.3.5.2" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.p2.1.m1.3.3.3.3" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.3.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.3b"><apply id="S3.SS2.SSS2.p2.1.m1.3.4.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.3.4.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.4">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.3.4.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.4.2">𝐖</ci><list id="S3.SS2.SSS2.p2.1.m1.3.3.3.4.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.5"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1">𝑞</ci><ci id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2">𝑘</ci><ci id="S3.SS2.SSS2.p2.1.m1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.3">𝑣</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.3c">\mathbf{W}_{{q,k,v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.3d">bold_W start_POSTSUBSCRIPT italic_q , italic_k , italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{a}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.2.m2.1"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><msub id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">𝐚</mi><mi id="S3.SS2.SSS2.p2.2.m2.1.1.3" xref="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">𝐚</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">\mathbf{a}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.2.m2.1d">bold_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the adapted embedding. Our approach ensures that the large language models (LLMs) continuously access and integrate the collaborative information throughout their entire structure, not just at the input stage. By injecting the graph-based knowledge into all layers of the LLMs, we not only maintain a robust representation of the collaborative context, but also enable more effective gradient flow directly back to the Mixture of Experts (MoE) module. This innovative integration of language modeling and graph representation learning allows our model to leverage the deep contextual insights provided by the LLMs, while benefiting from the structural patterns recognized by the Graph Neural Networks. 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS2.p3.1.1">Structured Prompt Embedding</span>.
We employ a structured prompt, illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S3.F2" title="Figure 2 ‣ 3.2.2 Unifying CF with LLM ‣ 3.2 Collaborative Instruction Tuning for Large Language Models (LLMs) ‣ 3 Methodology ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, which integrates various data elements. This process involves tokenizing the prompt and converting it into an embedding space representation. To ensure the special tokens within the prompt are recognized as unique entities, we incorporate them into the tokenizer of the LLM. These specialized tokens are then replaced by their corresponding adapted embeddings in the transformed token embeddings.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p4">
<p class="ltx_p" id="S3.SS2.SSS2.p4.10">Specifically, we define the input prompt as <math alttext="\mathcal{P}=[p_{1},\dots,p_{u},\dots,p_{i},\dots,p_{e},\dots,p_{l}]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.1.m1.9"><semantics id="S3.SS2.SSS2.p4.1.m1.9a"><mrow id="S3.SS2.SSS2.p4.1.m1.9.9" xref="S3.SS2.SSS2.p4.1.m1.9.9.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.1.m1.9.9.7" xref="S3.SS2.SSS2.p4.1.m1.9.9.7.cmml">𝒫</mi><mo id="S3.SS2.SSS2.p4.1.m1.9.9.6" xref="S3.SS2.SSS2.p4.1.m1.9.9.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p4.1.m1.9.9.5.5" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml"><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.6" stretchy="false" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">[</mo><msub id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.2" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.2.cmml">p</mi><mn id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.3" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.7" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.1.m1.1.1" mathvariant="normal" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.8" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.2" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.3" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.9" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.1.m1.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p4.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.10" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.2" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.11" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.1.m1.3.3" mathvariant="normal" xref="S3.SS2.SSS2.p4.1.m1.3.3.cmml">…</mi><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.12" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.2" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.3" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.3.cmml">e</mi></msub><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.13" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.1.m1.4.4" mathvariant="normal" xref="S3.SS2.SSS2.p4.1.m1.4.4.cmml">…</mi><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.14" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.2" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.3" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.3.cmml">l</mi></msub><mo id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.15" stretchy="false" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.9b"><apply id="S3.SS2.SSS2.p4.1.m1.9.9.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9"><eq id="S3.SS2.SSS2.p4.1.m1.9.9.6.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.6"></eq><ci id="S3.SS2.SSS2.p4.1.m1.9.9.7.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.7">𝒫</ci><list id="S3.SS2.SSS2.p4.1.m1.9.9.5.6.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5"><apply id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.2">𝑝</ci><cn id="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p4.1.m1.5.5.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1">…</ci><apply id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.6.6.2.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS2.p4.1.m1.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.2.2">…</ci><apply id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.7.7.3.3.3.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p4.1.m1.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.3.3">…</ci><apply id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.cmml" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.8.8.4.4.4.3">𝑒</ci></apply><ci id="S3.SS2.SSS2.p4.1.m1.4.4.cmml" xref="S3.SS2.SSS2.p4.1.m1.4.4">…</ci><apply id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.9.9.5.5.5.3">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.9c">\mathcal{P}=[p_{1},\dots,p_{u},\dots,p_{i},\dots,p_{e},\dots,p_{l}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.1.m1.9d">caligraphic_P = [ italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math>, where each element <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.2.m2.1"><semantics id="S3.SS2.SSS2.p4.2.m2.1a"><mi id="S3.SS2.SSS2.p4.2.m2.1.1" xref="S3.SS2.SSS2.p4.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.2.m2.1b"><ci id="S3.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.2.m2.1d">italic_p</annotation></semantics></math> represents one input token. The tokens <math alttext="p_{u},p_{i},p_{e}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.3.m3.3"><semantics id="S3.SS2.SSS2.p4.3.m3.3a"><mrow id="S3.SS2.SSS2.p4.3.m3.3.3.3" xref="S3.SS2.SSS2.p4.3.m3.3.3.4.cmml"><msub id="S3.SS2.SSS2.p4.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.2" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.3" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.SS2.SSS2.p4.3.m3.3.3.3.4" xref="S3.SS2.SSS2.p4.3.m3.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p4.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.2" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.3" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p4.3.m3.3.3.3.5" xref="S3.SS2.SSS2.p4.3.m3.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p4.3.m3.3.3.3.3" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.2" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.3" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.3.m3.3b"><list id="S3.SS2.SSS2.p4.3.m3.3.3.4.cmml" xref="S3.SS2.SSS2.p4.3.m3.3.3.3"><apply id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.3">𝑢</ci></apply><apply id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p4.3.m3.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.3.3.3.3.3">𝑒</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.3.m3.3c">p_{u},p_{i},p_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.3.m3.3d">italic_p start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> denote <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p4.10.1">&lt;USER_EMBED&gt;</span>, <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p4.10.2">&lt;ITEM_EMBED&gt;</span>, <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p4.10.3">&lt;EXPLAIN_POS&gt;</span> respectively. After processing through the positional embedding layer, we denote the output as <math alttext="\mathcal{E}=[\epsilon_{1},\dots,\epsilon_{u},\dots,\epsilon_{i},\dots,\epsilon%
_{e},\dots,\epsilon_{l}]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.4.m4.9"><semantics id="S3.SS2.SSS2.p4.4.m4.9a"><mrow id="S3.SS2.SSS2.p4.4.m4.9.9" xref="S3.SS2.SSS2.p4.4.m4.9.9.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.4.m4.9.9.7" xref="S3.SS2.SSS2.p4.4.m4.9.9.7.cmml">ℰ</mi><mo id="S3.SS2.SSS2.p4.4.m4.9.9.6" xref="S3.SS2.SSS2.p4.4.m4.9.9.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p4.4.m4.9.9.5.5" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml"><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.6" stretchy="false" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">[</mo><msub id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.2" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.2.cmml">ϵ</mi><mn id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.3" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.7" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.4.m4.1.1" mathvariant="normal" xref="S3.SS2.SSS2.p4.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.8" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.2" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.3" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.9" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.4.m4.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p4.4.m4.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.10" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.2" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.3" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.11" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.4.m4.3.3" mathvariant="normal" xref="S3.SS2.SSS2.p4.4.m4.3.3.cmml">…</mi><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.12" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.cmml"><mi id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.2" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.3" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.3.cmml">e</mi></msub><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.13" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.4.m4.4.4" mathvariant="normal" xref="S3.SS2.SSS2.p4.4.m4.4.4.cmml">…</mi><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.14" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.cmml"><mi id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.2" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.3" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.3.cmml">l</mi></msub><mo id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.15" stretchy="false" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.4.m4.9b"><apply id="S3.SS2.SSS2.p4.4.m4.9.9.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9"><eq id="S3.SS2.SSS2.p4.4.m4.9.9.6.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.6"></eq><ci id="S3.SS2.SSS2.p4.4.m4.9.9.7.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.7">ℰ</ci><list id="S3.SS2.SSS2.p4.4.m4.9.9.5.6.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5"><apply id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.2">italic-ϵ</ci><cn id="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p4.4.m4.5.5.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.1.1">…</ci><apply id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.6.6.2.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS2.p4.4.m4.2.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.2.2">…</ci><apply id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.7.7.3.3.3.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p4.4.m4.3.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.3.3">…</ci><apply id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.cmml" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.8.8.4.4.4.3">𝑒</ci></apply><ci id="S3.SS2.SSS2.p4.4.m4.4.4.cmml" xref="S3.SS2.SSS2.p4.4.m4.4.4">…</ci><apply id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5">subscript</csymbol><ci id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.2.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.3.cmml" xref="S3.SS2.SSS2.p4.4.m4.9.9.5.5.5.3">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.4.m4.9c">\mathcal{E}=[\epsilon_{1},\dots,\epsilon_{u},\dots,\epsilon_{i},\dots,\epsilon%
_{e},\dots,\epsilon_{l}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.4.m4.9d">caligraphic_E = [ italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math>, where each <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.5.m5.1"><semantics id="S3.SS2.SSS2.p4.5.m5.1a"><mi id="S3.SS2.SSS2.p4.5.m5.1.1" xref="S3.SS2.SSS2.p4.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.5.m5.1b"><ci id="S3.SS2.SSS2.p4.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p4.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.5.m5.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.5.m5.1d">italic_ϵ</annotation></semantics></math> is the token embedding of its corresponding token. Subsequently, <math alttext="\epsilon_{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.6.m6.1"><semantics id="S3.SS2.SSS2.p4.6.m6.1a"><msub id="S3.SS2.SSS2.p4.6.m6.1.1" xref="S3.SS2.SSS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p4.6.m6.1.1.2" xref="S3.SS2.SSS2.p4.6.m6.1.1.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.6.m6.1.1.3" xref="S3.SS2.SSS2.p4.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.6.m6.1b"><apply id="S3.SS2.SSS2.p4.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p4.6.m6.1.1.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p4.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.6.m6.1c">\epsilon_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.6.m6.1d">italic_ϵ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\epsilon_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.7.m7.1"><semantics id="S3.SS2.SSS2.p4.7.m7.1a"><msub id="S3.SS2.SSS2.p4.7.m7.1.1" xref="S3.SS2.SSS2.p4.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.p4.7.m7.1.1.2" xref="S3.SS2.SSS2.p4.7.m7.1.1.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.7.m7.1.1.3" xref="S3.SS2.SSS2.p4.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.7.m7.1b"><apply id="S3.SS2.SSS2.p4.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p4.7.m7.1.1.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p4.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.7.m7.1c">\epsilon_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.7.m7.1d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are replaced by the adapted embeddings <math alttext="a_{u}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.8.m8.1"><semantics id="S3.SS2.SSS2.p4.8.m8.1a"><msub id="S3.SS2.SSS2.p4.8.m8.1.1" xref="S3.SS2.SSS2.p4.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p4.8.m8.1.1.2" xref="S3.SS2.SSS2.p4.8.m8.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS2.p4.8.m8.1.1.3" xref="S3.SS2.SSS2.p4.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.8.m8.1b"><apply id="S3.SS2.SSS2.p4.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p4.8.m8.1.1.2">𝑎</ci><ci id="S3.SS2.SSS2.p4.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p4.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.8.m8.1c">a_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.9.m9.1"><semantics id="S3.SS2.SSS2.p4.9.m9.1a"><msub id="S3.SS2.SSS2.p4.9.m9.1.1" xref="S3.SS2.SSS2.p4.9.m9.1.1.cmml"><mi id="S3.SS2.SSS2.p4.9.m9.1.1.2" xref="S3.SS2.SSS2.p4.9.m9.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS2.p4.9.m9.1.1.3" xref="S3.SS2.SSS2.p4.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.9.m9.1b"><apply id="S3.SS2.SSS2.p4.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.9.m9.1.1.1.cmml" xref="S3.SS2.SSS2.p4.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.p4.9.m9.1.1.2">𝑎</ci><ci id="S3.SS2.SSS2.p4.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.p4.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.9.m9.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.9.m9.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, to form the final embedding layer <math alttext="\mathcal{E^{\prime}}=[\epsilon_{1},\dots,a_{u},\dots,a_{i},\dots,\epsilon_{e},%
\dots,\epsilon_{l}]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.10.m10.9"><semantics id="S3.SS2.SSS2.p4.10.m10.9a"><mrow id="S3.SS2.SSS2.p4.10.m10.9.9" xref="S3.SS2.SSS2.p4.10.m10.9.9.cmml"><msup id="S3.SS2.SSS2.p4.10.m10.9.9.7" xref="S3.SS2.SSS2.p4.10.m10.9.9.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p4.10.m10.9.9.7.2" xref="S3.SS2.SSS2.p4.10.m10.9.9.7.2.cmml">ℰ</mi><mo id="S3.SS2.SSS2.p4.10.m10.9.9.7.3" xref="S3.SS2.SSS2.p4.10.m10.9.9.7.3.cmml">′</mo></msup><mo id="S3.SS2.SSS2.p4.10.m10.9.9.6" xref="S3.SS2.SSS2.p4.10.m10.9.9.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p4.10.m10.9.9.5.5" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml"><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.6" stretchy="false" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">[</mo><msub id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.2" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.2.cmml">ϵ</mi><mn id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.3" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.7" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.10.m10.1.1" mathvariant="normal" xref="S3.SS2.SSS2.p4.10.m10.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.8" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.2" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.2.cmml">a</mi><mi id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.3" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.9" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.10.m10.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p4.10.m10.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.10" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.2" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.2.cmml">a</mi><mi id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.3" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.11" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.10.m10.3.3" mathvariant="normal" xref="S3.SS2.SSS2.p4.10.m10.3.3.cmml">…</mi><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.12" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.cmml"><mi id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.2" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.3" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.3.cmml">e</mi></msub><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.13" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><mi id="S3.SS2.SSS2.p4.10.m10.4.4" mathvariant="normal" xref="S3.SS2.SSS2.p4.10.m10.4.4.cmml">…</mi><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.14" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">,</mo><msub id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.cmml"><mi id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.2" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.2.cmml">ϵ</mi><mi id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.3" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.3.cmml">l</mi></msub><mo id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.15" stretchy="false" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.10.m10.9b"><apply id="S3.SS2.SSS2.p4.10.m10.9.9.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9"><eq id="S3.SS2.SSS2.p4.10.m10.9.9.6.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.6"></eq><apply id="S3.SS2.SSS2.p4.10.m10.9.9.7.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.7"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.9.9.7.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.7">superscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.9.9.7.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.7.2">ℰ</ci><ci id="S3.SS2.SSS2.p4.10.m10.9.9.7.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.7.3">′</ci></apply><list id="S3.SS2.SSS2.p4.10.m10.9.9.5.6.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5"><apply id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.2">italic-ϵ</ci><cn id="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p4.10.m10.5.5.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.p4.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.1.1">…</ci><apply id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.2">𝑎</ci><ci id="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.6.6.2.2.2.3">𝑢</ci></apply><ci id="S3.SS2.SSS2.p4.10.m10.2.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.2.2">…</ci><apply id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.2">𝑎</ci><ci id="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.7.7.3.3.3.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p4.10.m10.3.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.3.3">…</ci><apply id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.cmml" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.8.8.4.4.4.3">𝑒</ci></apply><ci id="S3.SS2.SSS2.p4.10.m10.4.4.cmml" xref="S3.SS2.SSS2.p4.10.m10.4.4">…</ci><apply id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.1.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5">subscript</csymbol><ci id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.2.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.2">italic-ϵ</ci><ci id="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.3.cmml" xref="S3.SS2.SSS2.p4.10.m10.9.9.5.5.5.3">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.10.m10.9c">\mathcal{E^{\prime}}=[\epsilon_{1},\dots,a_{u},\dots,a_{i},\dots,\epsilon_{e},%
\dots,\epsilon_{l}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.10.m10.9d">caligraphic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = [ italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , … , italic_ϵ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ]</annotation></semantics></math>, which is further used as input of LLMs.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p5">
<p class="ltx_p" id="S3.SS2.SSS2.p5.5">To improve the ability of large language models (LLMs) to generate contextually and syntactically coherent explanations, we aim to minimize the loss between the predicted probabilities of next tokens and the actual next tokens in the sequences. We utilize the negative log-likelihood (NLL) as our training loss, calculated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\frac{1}{N}\sum_{i=1}^{N}\sum_{c=1}^{C_{i}}y_{ic}\cdot\log(\hat{y%
}_{ic})" class="ltx_Math" display="block" id="S3.E13.m1.2"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.2.2.3" xref="S3.E13.m1.2.2.3.cmml">ℒ</mi><mo id="S3.E13.m1.2.2.2" xref="S3.E13.m1.2.2.2.cmml">=</mo><mrow id="S3.E13.m1.2.2.1" xref="S3.E13.m1.2.2.1.cmml"><mo id="S3.E13.m1.2.2.1a" xref="S3.E13.m1.2.2.1.cmml">−</mo><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><mfrac id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml"><mn id="S3.E13.m1.2.2.1.1.3.2" xref="S3.E13.m1.2.2.1.1.3.2.cmml">1</mn><mi id="S3.E13.m1.2.2.1.1.3.3" xref="S3.E13.m1.2.2.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.2.2.1.1.1" xref="S3.E13.m1.2.2.1.1.1.cmml"><munderover id="S3.E13.m1.2.2.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.2.cmml"><mo id="S3.E13.m1.2.2.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E13.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E13.m1.2.2.1.1.1.2.2.3" xref="S3.E13.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.2.2.3.2" xref="S3.E13.m1.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E13.m1.2.2.1.1.1.2.2.3.1" xref="S3.E13.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E13.m1.2.2.1.1.1.2.2.3.3" xref="S3.E13.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m1.2.2.1.1.1.2.3" xref="S3.E13.m1.2.2.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E13.m1.2.2.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.cmml"><munderover id="S3.E13.m1.2.2.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E13.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E13.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.2.2.3" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S3.E13.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E13.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E13.m1.2.2.1.1.1.1.2.3" xref="S3.E13.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.2.3.2" xref="S3.E13.m1.2.2.1.1.1.1.2.3.2.cmml">C</mi><mi id="S3.E13.m1.2.2.1.1.1.1.2.3.3" xref="S3.E13.m1.2.2.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E13.m1.2.2.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E13.m1.2.2.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.3.2" xref="S3.E13.m1.2.2.1.1.1.1.1.3.2.cmml">y</mi><mrow id="S3.E13.m1.2.2.1.1.1.1.1.3.3" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.3.3.2" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.3.3.1" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub><mo id="S3.E13.m1.2.2.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.2.2.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml">log</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1a" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></mrow></msub><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2"><eq id="S3.E13.m1.2.2.2.cmml" xref="S3.E13.m1.2.2.2"></eq><ci id="S3.E13.m1.2.2.3.cmml" xref="S3.E13.m1.2.2.3">ℒ</ci><apply id="S3.E13.m1.2.2.1.cmml" xref="S3.E13.m1.2.2.1"><minus id="S3.E13.m1.2.2.1.2.cmml" xref="S3.E13.m1.2.2.1"></minus><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1.1"><times id="S3.E13.m1.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2"></times><apply id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3"><divide id="S3.E13.m1.2.2.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3"></divide><cn id="S3.E13.m1.2.2.1.1.3.2.cmml" type="integer" xref="S3.E13.m1.2.2.1.1.3.2">1</cn><ci id="S3.E13.m1.2.2.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.3.3">𝑁</ci></apply><apply id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1"><apply id="S3.E13.m1.2.2.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E13.m1.2.2.1.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E13.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.E13.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.2.2.3"><eq id="S3.E13.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E13.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E13.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E13.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E13.m1.2.2.1.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E13.m1.2.2.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1"><apply id="S3.E13.m1.2.2.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E13.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.E13.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.E13.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.E13.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.E13.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.2">𝑐</ci><cn id="S3.E13.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E13.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E13.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E13.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E13.m1.2.2.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1"><ci id="S3.E13.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.2">⋅</ci><apply id="S3.E13.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3.2">𝑦</ci><apply id="S3.E13.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3"><times id="S3.E13.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="S3.E13.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1"><log id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"></log><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\mathcal{L}=-\frac{1}{N}\sum_{i=1}^{N}\sum_{c=1}^{C_{i}}y_{ic}\cdot\log(\hat{y%
}_{ic})</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.2d">caligraphic_L = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i italic_c end_POSTSUBSCRIPT ⋅ roman_log ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p5.4">Here, <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.1.m1.1"><semantics id="S3.SS2.SSS2.p5.1.m1.1a"><mi id="S3.SS2.SSS2.p5.1.m1.1.1" xref="S3.SS2.SSS2.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.1.m1.1b"><ci id="S3.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.1.m1.1d">italic_N</annotation></semantics></math> is the number of explanations, <math alttext="C_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.2.m2.1"><semantics id="S3.SS2.SSS2.p5.2.m2.1a"><msub id="S3.SS2.SSS2.p5.2.m2.1.1" xref="S3.SS2.SSS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p5.2.m2.1.1.2" xref="S3.SS2.SSS2.p5.2.m2.1.1.2.cmml">C</mi><mi id="S3.SS2.SSS2.p5.2.m2.1.1.3" xref="S3.SS2.SSS2.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.2.m2.1b"><apply id="S3.SS2.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1.2">𝐶</ci><ci id="S3.SS2.SSS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.2.m2.1c">C_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.2.m2.1d">italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the character count in each explanation, and <math alttext="y_{i,c}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.3.m3.2"><semantics id="S3.SS2.SSS2.p5.3.m3.2a"><msub id="S3.SS2.SSS2.p5.3.m3.2.3" xref="S3.SS2.SSS2.p5.3.m3.2.3.cmml"><mi id="S3.SS2.SSS2.p5.3.m3.2.3.2" xref="S3.SS2.SSS2.p5.3.m3.2.3.2.cmml">y</mi><mrow id="S3.SS2.SSS2.p5.3.m3.2.2.2.4" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p5.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS2.SSS2.p5.3.m3.2.2.2.4.1" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS2.p5.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.3.m3.2b"><apply id="S3.SS2.SSS2.p5.3.m3.2.3.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.3.m3.2.3.1.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.3.m3.2.3.2.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.3.2">𝑦</ci><list id="S3.SS2.SSS2.p5.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.4"><ci id="S3.SS2.SSS2.p5.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS2.SSS2.p5.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.3.m3.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.3.m3.2c">y_{i,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.3.m3.2d">italic_y start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{y}_{i,c}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.4.m4.2"><semantics id="S3.SS2.SSS2.p5.4.m4.2a"><msub id="S3.SS2.SSS2.p5.4.m4.2.3" xref="S3.SS2.SSS2.p5.4.m4.2.3.cmml"><mover accent="true" id="S3.SS2.SSS2.p5.4.m4.2.3.2" xref="S3.SS2.SSS2.p5.4.m4.2.3.2.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.2.3.2.2" xref="S3.SS2.SSS2.p5.4.m4.2.3.2.2.cmml">y</mi><mo id="S3.SS2.SSS2.p5.4.m4.2.3.2.1" xref="S3.SS2.SSS2.p5.4.m4.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS2.p5.4.m4.2.2.2.4" xref="S3.SS2.SSS2.p5.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p5.4.m4.1.1.1.1" xref="S3.SS2.SSS2.p5.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.SSS2.p5.4.m4.2.2.2.4.1" xref="S3.SS2.SSS2.p5.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS2.p5.4.m4.2.2.2.2" xref="S3.SS2.SSS2.p5.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.4.m4.2b"><apply id="S3.SS2.SSS2.p5.4.m4.2.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.4.m4.2.3.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.3">subscript</csymbol><apply id="S3.SS2.SSS2.p5.4.m4.2.3.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.3.2"><ci id="S3.SS2.SSS2.p5.4.m4.2.3.2.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.3.2.1">^</ci><ci id="S3.SS2.SSS2.p5.4.m4.2.3.2.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.3.2.2">𝑦</ci></apply><list id="S3.SS2.SSS2.p5.4.m4.2.2.2.3.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.2.4"><ci id="S3.SS2.SSS2.p5.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.4.m4.1.1.1.1">𝑖</ci><ci id="S3.SS2.SSS2.p5.4.m4.2.2.2.2.cmml" xref="S3.SS2.SSS2.p5.4.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.4.m4.2c">\hat{y}_{i,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.4.m4.2d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> represent the actual and predicted tokens, respectively. To minimize training complexity, we freeze all parameters within the LLMs, excluding any interactions with the GNN training procedure. The only trainable parameters are those within the Mixture-of-Experts (MoE) model.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>A depiction of model prompt instruction.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Ground Truth Explanation Generation</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.4">Prior research has directly used user reviews as ground truth explanations for recommender systems <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib7" title="">2021</a>)</cite>. However, these reviews tend to be subjective and may only implicitly convey the user’s intentions or sentiments. To address this limitation and improve the quality of ground truth explanations, the application of Large Language Models (LLMs) has been proposed to distill explicit user intentions from their raw reviews.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textit{explanation}(u,i)=\textit{LLMs}(\mathcal{P},r_{u,i})" class="ltx_Math" display="block" id="S3.E14.m1.6"><semantics id="S3.E14.m1.6a"><mrow id="S3.E14.m1.6.6" xref="S3.E14.m1.6.6.cmml"><mrow id="S3.E14.m1.6.6.3" xref="S3.E14.m1.6.6.3.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E14.m1.6.6.3.2" xref="S3.E14.m1.6.6.3.2a.cmml">explanation</mtext><mo id="S3.E14.m1.6.6.3.1" xref="S3.E14.m1.6.6.3.1.cmml">⁢</mo><mrow id="S3.E14.m1.6.6.3.3.2" xref="S3.E14.m1.6.6.3.3.1.cmml"><mo id="S3.E14.m1.6.6.3.3.2.1" stretchy="false" xref="S3.E14.m1.6.6.3.3.1.cmml">(</mo><mi id="S3.E14.m1.3.3" xref="S3.E14.m1.3.3.cmml">u</mi><mo id="S3.E14.m1.6.6.3.3.2.2" xref="S3.E14.m1.6.6.3.3.1.cmml">,</mo><mi id="S3.E14.m1.4.4" xref="S3.E14.m1.4.4.cmml">i</mi><mo id="S3.E14.m1.6.6.3.3.2.3" stretchy="false" xref="S3.E14.m1.6.6.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.6.6.2" xref="S3.E14.m1.6.6.2.cmml">=</mo><mrow id="S3.E14.m1.6.6.1" xref="S3.E14.m1.6.6.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E14.m1.6.6.1.3" xref="S3.E14.m1.6.6.1.3a.cmml">LLMs</mtext><mo id="S3.E14.m1.6.6.1.2" xref="S3.E14.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.6.6.1.1.1" xref="S3.E14.m1.6.6.1.1.2.cmml"><mo id="S3.E14.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E14.m1.6.6.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.5.5" xref="S3.E14.m1.5.5.cmml">𝒫</mi><mo id="S3.E14.m1.6.6.1.1.1.3" xref="S3.E14.m1.6.6.1.1.2.cmml">,</mo><msub id="S3.E14.m1.6.6.1.1.1.1" xref="S3.E14.m1.6.6.1.1.1.1.cmml"><mi id="S3.E14.m1.6.6.1.1.1.1.2" xref="S3.E14.m1.6.6.1.1.1.1.2.cmml">r</mi><mrow id="S3.E14.m1.2.2.2.4" xref="S3.E14.m1.2.2.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml">u</mi><mo id="S3.E14.m1.2.2.2.4.1" xref="S3.E14.m1.2.2.2.3.cmml">,</mo><mi id="S3.E14.m1.2.2.2.2" xref="S3.E14.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E14.m1.6.6.1.1.1.4" stretchy="false" xref="S3.E14.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.6b"><apply id="S3.E14.m1.6.6.cmml" xref="S3.E14.m1.6.6"><eq id="S3.E14.m1.6.6.2.cmml" xref="S3.E14.m1.6.6.2"></eq><apply id="S3.E14.m1.6.6.3.cmml" xref="S3.E14.m1.6.6.3"><times id="S3.E14.m1.6.6.3.1.cmml" xref="S3.E14.m1.6.6.3.1"></times><ci id="S3.E14.m1.6.6.3.2a.cmml" xref="S3.E14.m1.6.6.3.2"><mtext class="ltx_mathvariant_italic" id="S3.E14.m1.6.6.3.2.cmml" xref="S3.E14.m1.6.6.3.2">explanation</mtext></ci><interval closure="open" id="S3.E14.m1.6.6.3.3.1.cmml" xref="S3.E14.m1.6.6.3.3.2"><ci id="S3.E14.m1.3.3.cmml" xref="S3.E14.m1.3.3">𝑢</ci><ci id="S3.E14.m1.4.4.cmml" xref="S3.E14.m1.4.4">𝑖</ci></interval></apply><apply id="S3.E14.m1.6.6.1.cmml" xref="S3.E14.m1.6.6.1"><times id="S3.E14.m1.6.6.1.2.cmml" xref="S3.E14.m1.6.6.1.2"></times><ci id="S3.E14.m1.6.6.1.3a.cmml" xref="S3.E14.m1.6.6.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E14.m1.6.6.1.3.cmml" xref="S3.E14.m1.6.6.1.3">LLMs</mtext></ci><interval closure="open" id="S3.E14.m1.6.6.1.1.2.cmml" xref="S3.E14.m1.6.6.1.1.1"><ci id="S3.E14.m1.5.5.cmml" xref="S3.E14.m1.5.5">𝒫</ci><apply id="S3.E14.m1.6.6.1.1.1.1.cmml" xref="S3.E14.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.6.6.1.1.1.1.1.cmml" xref="S3.E14.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.6.6.1.1.1.1.2.cmml" xref="S3.E14.m1.6.6.1.1.1.1.2">𝑟</ci><list id="S3.E14.m1.2.2.2.3.cmml" xref="S3.E14.m1.2.2.2.4"><ci id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1">𝑢</ci><ci id="S3.E14.m1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.2.2">𝑖</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.6c">\textit{explanation}(u,i)=\textit{LLMs}(\mathcal{P},r_{u,i})</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.6d">explanation ( italic_u , italic_i ) = LLMs ( caligraphic_P , italic_r start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.3">where <math alttext="r_{u,i}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.2"><semantics id="S3.SS2.SSS3.p1.1.m1.2a"><msub id="S3.SS2.SSS3.p1.1.m1.2.3" xref="S3.SS2.SSS3.p1.1.m1.2.3.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.2.3.2" xref="S3.SS2.SSS3.p1.1.m1.2.3.2.cmml">r</mi><mrow id="S3.SS2.SSS3.p1.1.m1.2.2.2.4" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.1.1.cmml">u</mi><mo id="S3.SS2.SSS3.p1.1.m1.2.2.2.4.1" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS3.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.2b"><apply id="S3.SS2.SSS3.p1.1.m1.2.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.3.2">𝑟</ci><list id="S3.SS2.SSS3.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.4"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.1.1">𝑢</ci><ci id="S3.SS2.SSS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.2c">r_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.2d">italic_r start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the review of item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mi id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><ci id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">italic_i</annotation></semantics></math> given by user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.3.m3.1"><semantics id="S3.SS2.SSS3.p1.3.m3.1a"><mi id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.1b"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.3.m3.1d">italic_u</annotation></semantics></math>. An example case is shown in the Appendix.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Overall Comparison in Terms of Explainability and Stability. The superscripts <span class="ltx_text ltx_font_italic" id="S4.T1.15.1">P</span>, <span class="ltx_text ltx_font_italic" id="S4.T1.16.2">R</span>, and <span class="ltx_text ltx_font_italic" id="S4.T1.17.3">F1</span> indicate Precision, Recall, and F1-Score, respectively. The subscript std denotes the standard deviation of each score. The best performances are highlighted in bold, and the second-best are underlined.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.11" style="width:433.6pt;height:223.1pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-186.4pt,95.7pt) scale(0.537735646264023,0.537735646264023) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.11.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.2.2.2">
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T1.2.2.2.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.3.1">Metrics</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="7" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Explainability <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T1.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.2.1">Stability <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.1.m1.1"><semantics id="S4.T1.2.2.2.2.1.m1.1a"><mo id="S4.T1.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.1.m1.1b"><ci id="S4.T1.2.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.11.10">GPTScore</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.3.3.3.1">BERTScore<sup class="ltx_sup" id="S4.T1.3.3.3.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.3.3.3.1.1.1">P</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.4.4.4.2">BERTScore<sup class="ltx_sup" id="S4.T1.4.4.4.2.1"><span class="ltx_text ltx_font_italic" id="S4.T1.4.4.4.2.1.1">R</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.5.5.5.3">BERTScore<sup class="ltx_sup" id="S4.T1.5.5.5.3.1"><span class="ltx_text ltx_font_italic" id="S4.T1.5.5.5.3.1.1">F1</span></sup>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.11.11">BARTScore</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.11.12">BLEURT</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.11.13">USR</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.6.4">GPT<sub class="ltx_sub" id="S4.T1.6.6.6.4.1"><span class="ltx_text ltx_font_italic" id="S4.T1.6.6.6.4.1.1">std</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.7.7.7.5">BERT<math alttext="{}^{P}_{std}" class="ltx_Math" display="inline" id="S4.T1.7.7.7.5.m1.1"><semantics id="S4.T1.7.7.7.5.m1.1a"><mmultiscripts id="S4.T1.7.7.7.5.m1.1.1" xref="S4.T1.7.7.7.5.m1.1.1.cmml"><mi id="S4.T1.7.7.7.5.m1.1.1.2.2" xref="S4.T1.7.7.7.5.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T1.7.7.7.5.m1.1.1a" xref="S4.T1.7.7.7.5.m1.1.1.cmml"></mprescripts><mrow id="S4.T1.7.7.7.5.m1.1.1.3" xref="S4.T1.7.7.7.5.m1.1.1.3.cmml"><mi id="S4.T1.7.7.7.5.m1.1.1.3.2" xref="S4.T1.7.7.7.5.m1.1.1.3.2.cmml">s</mi><mo id="S4.T1.7.7.7.5.m1.1.1.3.1" xref="S4.T1.7.7.7.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.5.m1.1.1.3.3" xref="S4.T1.7.7.7.5.m1.1.1.3.3.cmml">t</mi><mo id="S4.T1.7.7.7.5.m1.1.1.3.1a" xref="S4.T1.7.7.7.5.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.5.m1.1.1.3.4" xref="S4.T1.7.7.7.5.m1.1.1.3.4.cmml">d</mi></mrow><mrow id="S4.T1.7.7.7.5.m1.1.1b" xref="S4.T1.7.7.7.5.m1.1.1.cmml"></mrow><mrow id="S4.T1.7.7.7.5.m1.1.1c" xref="S4.T1.7.7.7.5.m1.1.1.cmml"></mrow><mi id="S4.T1.7.7.7.5.m1.1.1.2.3" xref="S4.T1.7.7.7.5.m1.1.1.2.3.cmml">P</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.5.m1.1b"><apply id="S4.T1.7.7.7.5.m1.1.1.cmml" xref="S4.T1.7.7.7.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.7.5.m1.1.1.1.cmml" xref="S4.T1.7.7.7.5.m1.1.1">subscript</csymbol><apply id="S4.T1.7.7.7.5.m1.1.1.2.cmml" xref="S4.T1.7.7.7.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.7.5.m1.1.1.2.1.cmml" xref="S4.T1.7.7.7.5.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T1.7.7.7.5.m1.1.1.2.2.cmml" xref="S4.T1.7.7.7.5.m1.1.1.2.2">absent</csymbol><ci id="S4.T1.7.7.7.5.m1.1.1.2.3.cmml" xref="S4.T1.7.7.7.5.m1.1.1.2.3">𝑃</ci></apply><apply id="S4.T1.7.7.7.5.m1.1.1.3.cmml" xref="S4.T1.7.7.7.5.m1.1.1.3"><times id="S4.T1.7.7.7.5.m1.1.1.3.1.cmml" xref="S4.T1.7.7.7.5.m1.1.1.3.1"></times><ci id="S4.T1.7.7.7.5.m1.1.1.3.2.cmml" xref="S4.T1.7.7.7.5.m1.1.1.3.2">𝑠</ci><ci id="S4.T1.7.7.7.5.m1.1.1.3.3.cmml" xref="S4.T1.7.7.7.5.m1.1.1.3.3">𝑡</ci><ci id="S4.T1.7.7.7.5.m1.1.1.3.4.cmml" xref="S4.T1.7.7.7.5.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.5.m1.1c">{}^{P}_{std}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.7.5.m1.1d">start_FLOATSUPERSCRIPT italic_P end_FLOATSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.8.8.8.6">BERT<math alttext="{}^{R}_{std}" class="ltx_Math" display="inline" id="S4.T1.8.8.8.6.m1.1"><semantics id="S4.T1.8.8.8.6.m1.1a"><mmultiscripts id="S4.T1.8.8.8.6.m1.1.1" xref="S4.T1.8.8.8.6.m1.1.1.cmml"><mi id="S4.T1.8.8.8.6.m1.1.1.2.2" xref="S4.T1.8.8.8.6.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T1.8.8.8.6.m1.1.1a" xref="S4.T1.8.8.8.6.m1.1.1.cmml"></mprescripts><mrow id="S4.T1.8.8.8.6.m1.1.1.3" xref="S4.T1.8.8.8.6.m1.1.1.3.cmml"><mi id="S4.T1.8.8.8.6.m1.1.1.3.2" xref="S4.T1.8.8.8.6.m1.1.1.3.2.cmml">s</mi><mo id="S4.T1.8.8.8.6.m1.1.1.3.1" xref="S4.T1.8.8.8.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.8.8.8.6.m1.1.1.3.3" xref="S4.T1.8.8.8.6.m1.1.1.3.3.cmml">t</mi><mo id="S4.T1.8.8.8.6.m1.1.1.3.1a" xref="S4.T1.8.8.8.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.8.8.8.6.m1.1.1.3.4" xref="S4.T1.8.8.8.6.m1.1.1.3.4.cmml">d</mi></mrow><mrow id="S4.T1.8.8.8.6.m1.1.1b" xref="S4.T1.8.8.8.6.m1.1.1.cmml"></mrow><mrow id="S4.T1.8.8.8.6.m1.1.1c" xref="S4.T1.8.8.8.6.m1.1.1.cmml"></mrow><mi id="S4.T1.8.8.8.6.m1.1.1.2.3" xref="S4.T1.8.8.8.6.m1.1.1.2.3.cmml">R</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.6.m1.1b"><apply id="S4.T1.8.8.8.6.m1.1.1.cmml" xref="S4.T1.8.8.8.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.8.6.m1.1.1.1.cmml" xref="S4.T1.8.8.8.6.m1.1.1">subscript</csymbol><apply id="S4.T1.8.8.8.6.m1.1.1.2.cmml" xref="S4.T1.8.8.8.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.8.6.m1.1.1.2.1.cmml" xref="S4.T1.8.8.8.6.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T1.8.8.8.6.m1.1.1.2.2.cmml" xref="S4.T1.8.8.8.6.m1.1.1.2.2">absent</csymbol><ci id="S4.T1.8.8.8.6.m1.1.1.2.3.cmml" xref="S4.T1.8.8.8.6.m1.1.1.2.3">𝑅</ci></apply><apply id="S4.T1.8.8.8.6.m1.1.1.3.cmml" xref="S4.T1.8.8.8.6.m1.1.1.3"><times id="S4.T1.8.8.8.6.m1.1.1.3.1.cmml" xref="S4.T1.8.8.8.6.m1.1.1.3.1"></times><ci id="S4.T1.8.8.8.6.m1.1.1.3.2.cmml" xref="S4.T1.8.8.8.6.m1.1.1.3.2">𝑠</ci><ci id="S4.T1.8.8.8.6.m1.1.1.3.3.cmml" xref="S4.T1.8.8.8.6.m1.1.1.3.3">𝑡</ci><ci id="S4.T1.8.8.8.6.m1.1.1.3.4.cmml" xref="S4.T1.8.8.8.6.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.6.m1.1c">{}^{R}_{std}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.8.6.m1.1d">start_FLOATSUPERSCRIPT italic_R end_FLOATSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.9.9.9.7">BERT<math alttext="{}^{F1}_{std}" class="ltx_Math" display="inline" id="S4.T1.9.9.9.7.m1.1"><semantics id="S4.T1.9.9.9.7.m1.1a"><mmultiscripts id="S4.T1.9.9.9.7.m1.1.1" xref="S4.T1.9.9.9.7.m1.1.1.cmml"><mi id="S4.T1.9.9.9.7.m1.1.1.2.2" xref="S4.T1.9.9.9.7.m1.1.1.2.2.cmml"></mi><mprescripts id="S4.T1.9.9.9.7.m1.1.1a" xref="S4.T1.9.9.9.7.m1.1.1.cmml"></mprescripts><mrow id="S4.T1.9.9.9.7.m1.1.1.3" xref="S4.T1.9.9.9.7.m1.1.1.3.cmml"><mi id="S4.T1.9.9.9.7.m1.1.1.3.2" xref="S4.T1.9.9.9.7.m1.1.1.3.2.cmml">s</mi><mo id="S4.T1.9.9.9.7.m1.1.1.3.1" xref="S4.T1.9.9.9.7.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.9.9.7.m1.1.1.3.3" xref="S4.T1.9.9.9.7.m1.1.1.3.3.cmml">t</mi><mo id="S4.T1.9.9.9.7.m1.1.1.3.1a" xref="S4.T1.9.9.9.7.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.9.9.7.m1.1.1.3.4" xref="S4.T1.9.9.9.7.m1.1.1.3.4.cmml">d</mi></mrow><mrow id="S4.T1.9.9.9.7.m1.1.1b" xref="S4.T1.9.9.9.7.m1.1.1.cmml"></mrow><mrow id="S4.T1.9.9.9.7.m1.1.1c" xref="S4.T1.9.9.9.7.m1.1.1.cmml"></mrow><mrow id="S4.T1.9.9.9.7.m1.1.1.2.3" xref="S4.T1.9.9.9.7.m1.1.1.2.3.cmml"><mi id="S4.T1.9.9.9.7.m1.1.1.2.3.2" xref="S4.T1.9.9.9.7.m1.1.1.2.3.2.cmml">F</mi><mo id="S4.T1.9.9.9.7.m1.1.1.2.3.1" xref="S4.T1.9.9.9.7.m1.1.1.2.3.1.cmml">⁢</mo><mn id="S4.T1.9.9.9.7.m1.1.1.2.3.3" xref="S4.T1.9.9.9.7.m1.1.1.2.3.3.cmml">1</mn></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.7.m1.1b"><apply id="S4.T1.9.9.9.7.m1.1.1.cmml" xref="S4.T1.9.9.9.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.9.9.7.m1.1.1.1.cmml" xref="S4.T1.9.9.9.7.m1.1.1">subscript</csymbol><apply id="S4.T1.9.9.9.7.m1.1.1.2.cmml" xref="S4.T1.9.9.9.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.9.9.7.m1.1.1.2.1.cmml" xref="S4.T1.9.9.9.7.m1.1.1">superscript</csymbol><csymbol cd="latexml" id="S4.T1.9.9.9.7.m1.1.1.2.2.cmml" xref="S4.T1.9.9.9.7.m1.1.1.2.2">absent</csymbol><apply id="S4.T1.9.9.9.7.m1.1.1.2.3.cmml" xref="S4.T1.9.9.9.7.m1.1.1.2.3"><times id="S4.T1.9.9.9.7.m1.1.1.2.3.1.cmml" xref="S4.T1.9.9.9.7.m1.1.1.2.3.1"></times><ci id="S4.T1.9.9.9.7.m1.1.1.2.3.2.cmml" xref="S4.T1.9.9.9.7.m1.1.1.2.3.2">𝐹</ci><cn id="S4.T1.9.9.9.7.m1.1.1.2.3.3.cmml" type="integer" xref="S4.T1.9.9.9.7.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.T1.9.9.9.7.m1.1.1.3.cmml" xref="S4.T1.9.9.9.7.m1.1.1.3"><times id="S4.T1.9.9.9.7.m1.1.1.3.1.cmml" xref="S4.T1.9.9.9.7.m1.1.1.3.1"></times><ci id="S4.T1.9.9.9.7.m1.1.1.3.2.cmml" xref="S4.T1.9.9.9.7.m1.1.1.3.2">𝑠</ci><ci id="S4.T1.9.9.9.7.m1.1.1.3.3.cmml" xref="S4.T1.9.9.9.7.m1.1.1.3.3">𝑡</ci><ci id="S4.T1.9.9.9.7.m1.1.1.3.4.cmml" xref="S4.T1.9.9.9.7.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.7.m1.1c">{}^{F1}_{std}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.9.7.m1.1d">start_FLOATSUPERSCRIPT italic_F 1 end_FLOATSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.10.10.10.8">BART<sub class="ltx_sub" id="S4.T1.10.10.10.8.1"><span class="ltx_text ltx_font_italic" id="S4.T1.10.10.10.8.1.1">std</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.11.9">BLEURT<sub class="ltx_sub" id="S4.T1.11.11.11.9.1"><span class="ltx_text ltx_font_italic" id="S4.T1.11.11.11.9.1.1">std</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.12.1">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S4.T1.11.11.12.1.1">Amazon-books</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.13.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.13.2.1">Att2Seq</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.2">76.08</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.3">0.3746</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.4">0.3624</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.5">0.3687</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.6">-3.9440</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.7">-0.3302</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.13.2.8">0.7757</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.9">12.56</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.10">0.1691</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.11">0.1051</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.12">0.1275</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.13">0.5080</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.13.2.14">0.299</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.14.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.14.3.1">NRT</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.2">75.63</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.3">0.3444</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.4">0.3440</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.5">0.3443</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.6">-3.9806</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.7">-0.4073</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.14.3.8">0.5413</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.9">12.82</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.10">0.1804</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.11">0.1035</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.12">0.1321</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.13">0.5101</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.14.3.14">0.3104</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.15.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.15.4.1">PETER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.2">77.65</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.3"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.15.4.3.1">0.4279</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.4">0.3799</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.5">0.4043</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.6">-3.8968</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.7">-0.2937</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.15.4.8">0.8480</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.9">11.21</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.10">0.1334</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.11">0.1035</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.12">0.1098</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.13">0.5144</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.15.4.14">0.2667</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.16.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.16.5.1">PEPLER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.2">78.77</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.3">0.3506</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.4">0.3569</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.5">0.3543</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.6">-3.9142</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.7">-0.2950</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.16.5.8">0.9563</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.9">11.38</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.10">0.1105</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.16.5.11.1">0.0935</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.12">0.0893</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.13">0.5064</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.16.5.14">0.2195</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.17.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.17.6.1">Ours (w/o profile)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.2.1">81.77</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.3.1">0.4194</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.4.1">0.4004</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.5">0.4106</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.6.1">-3.8218</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.7.1">-0.1294</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.17.6.8"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.8.1">1.0000</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.9"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.9.1">9.60</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.10"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.17.6.10.1">0.0819</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.11">0.0955</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.12"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.17.6.12.1">0.0786</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.13"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.17.6.13.1">0.4799</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.17.6.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.17.6.14.1">0.1803</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.18.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.18.7.1">Ours</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.2"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.2.1">82.57</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.3">0.4193</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.4"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.4.1">0.4038</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.5"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.5.1">0.4122</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.6"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.6.1">-3.8035</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.7"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.7.1">-0.1061</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.18.7.8"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.18.7.8.1">1.0000</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.9"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.18.7.9.1">9.60</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.18.7.10.1">0.0836</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.11"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.11.1">0.0920</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.18.7.12.1">0.0800</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.18.7.13.1">0.4832</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.18.7.14"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.18.7.14.1">0.1780</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.19.8">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S4.T1.11.11.19.8.1">Yelp</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.20.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.20.9.1">Att2Seq</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.2">63.91</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.3">0.2099</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.4">0.2658</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.5">0.2379</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.6">-4.5316</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.7">-0.6707</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.20.9.8">0.7583</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.9">15.62</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.10">0.1583</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.11">0.1074</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.12">0.1147</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.20.9.13.1">0.5616</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.20.9.14">0.247</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.21.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.21.10.1">NRT</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.2">61.94</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.3">0.0795</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.4">0.2225</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.5">0.1495</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.6">-4.6142</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.7">-0.7913</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.21.10.8">0.2677</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.9">16.81</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.10">0.2293</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.11">0.1134</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.12">0.1581</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.13"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.21.10.13.1">0.5612</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.21.10.14">0.2728</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.22.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.22.11.1">PETER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.2">67.00</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.3">0.2102</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.4">0.2983</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.5">0.2513</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.6">-4.4100</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.7">-0.5816</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.22.11.8">0.8750</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.9">15.57</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.10">0.3315</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.11">0.1298</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.12">0.2230</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.13">0.5800</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.22.11.14">0.3555</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.23.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.23.12.1">PEPLER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.2">67.54</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.3">0.2920</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.4">0.3183</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.5">0.3052</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.6">-4.4563</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.7">-0.3354</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.23.12.8">0.9143</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.9">14.18</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.10">0.1476</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.11"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.23.12.11.1">0.1044</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.12">0.1050</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.13">0.5777</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.23.12.14">0.2524</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.24.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.24.13.1">Ours (w/o profile)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.2.1">71.81</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.3.1">0.3879</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.4.1">0.3427</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.5.1">0.3657</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.6.1">-4.4035</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.7.1">-0.2486</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.24.13.8"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.8.1">1.0000</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.9.1">12.71</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.10.1">0.1087</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.11">0.1072</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.24.13.12.1">0.0919</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.13">0.5717</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.24.13.14"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.24.13.14.1">0.2272</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.25.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.25.14.1">Ours</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.2"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.2.1">74.53</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.3"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.3.1">0.3946</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.4"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.4.1">0.3506</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.5"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.5.1">0.3730</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.6"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.6.1">-4.3911</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.7"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.7.1">-0.2287</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.25.14.8"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T1.11.11.25.14.8.1">1.0000</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.9"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.9.1">11.45</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.10"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.10.1">0.0969</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.25.14.11.1">0.1048</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.12"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.25.14.12.1">0.0852</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.13">0.5770</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.25.14.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.25.14.14.1">0.2322</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.26.15">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="14" id="S4.T1.11.11.26.15.1">Google-reviews</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.27.16">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.27.16.1">Att2Seq</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.2">61.31</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.3">0.3619</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.4">0.3653</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.5">0.3636</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.6">-4.2627</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.7">-0.4671</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.11.11.27.16.8">0.5070</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.9">17.47</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.10">0.1855</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.11">0.1247</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.12">0.1403</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.13">0.6663</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.11.11.27.16.14">0.3198</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.28.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.28.17.1">NRT</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.2">58.27</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.3">0.3509</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.4">0.3495</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.5">0.3496</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.6">-4.2915</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.7">-0.4838</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.28.17.8">0.2533</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.9">19.16</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.10">0.2176</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.11">0.1267</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.12">0.1571</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.13">0.6620</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.28.17.14">0.3118</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.29.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.29.18.1">PETER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.2">65.16</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.3">0.3892</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.4">0.3905</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.5">0.3881</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.29.18.6.1">-4.1527</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.7">-0.3375</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.29.18.8">0.4757</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.9">17.00</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.10">0.2819</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.11">0.1356</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.12">0.2005</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.13">0.6701</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.29.18.14">0.3272</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.30.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.30.19.1">PEPLER</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.2">61.58</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.3">0.3373</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.4">0.3711</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.5">0.3546</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.6">-4.1744</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.7">-0.2892</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.30.19.8">0.8660</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.9">17.17</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.30.19.10.1">0.1134</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.11"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.30.19.11.1">0.1161</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.30.19.12.1">0.0999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.13">0.6752</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.30.19.14">0.2484</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.31.20">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.31.20.1">Ours (w/o profile)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.2"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.2.1">69.71</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.31.20.3.1">0.4427</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.4"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.4.1">0.4187</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.31.20.5.1">0.4310</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.6"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.6.1">-4.1142</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.7"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.7.1">-0.2026</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.11.11.31.20.8"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.8.1">0.9997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.9"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.9.1">14.09</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.10">0.1180</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.11">0.1171</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.12">0.1034</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.13"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.13.1">0.6465</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.31.20.14"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.31.20.14.1">0.2439</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.32.21">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T1.11.11.32.21.1">Ours</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.2.1">69.12</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.3"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.32.21.3.1">0.4546</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.4.1">0.4069</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.5"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.32.21.5.1">0.4311</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.6">-4.1647</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.7.1">-0.2437</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T1.11.11.32.21.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.8.1">0.9993</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.9.1">14.24</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.10"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.32.21.10.1">0.0972</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.11.1">0.1163</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.12"><span class="ltx_text ltx_font_bold" id="S4.T1.11.11.32.21.12.1">0.0938</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.13.1">0.6591</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.11.11.32.21.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.11.11.32.21.14.1">0.2452</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Settings</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span>
To evaluate XRec, we utilize three prominent public datasets that offer distinct perspectives on user-item interactions: <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">Amazon</span> <cite class="ltx_cite ltx_citemacro_cite">Ni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib10" title="">2019</a>)</cite>: This dataset aggregates the purchasing behaviors of users within Amazon’s books category. It includes not only user ratings but also the textual reviews they provide after making a purchase. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">Yelp</span>: This dataset captures the interactions between users and businesses, with a focus on the service industry. It contains both user ratings and reviews. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.4">Google</span> <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib6" title="">2022</a>); Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib19" title="">2023</a>)</cite>: Centered on user interactions recorded through Google Maps, this dataset incorporates the metadata of businesses as well as the feedback provided by users. Detailed statistics of these datasets can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.T2" title="Table 2 ‣ 4.1 Experimental Settings ‣ 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. 
<br class="ltx_break"/></p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Statistics of the experimental datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.2">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.3">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.4">#Interactions</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.1.1">Amazon</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.1.2">15,349</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.1.3">15,247</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.1.4">360,839</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.3.2">
<td class="ltx_td ltx_align_center" id="S4.T2.1.3.2.1">Yelp</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.3.2.2">15,942</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.3.2.3">14,085</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.3.2.4">393,680</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.4.3.1">Google</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.4.3.2">22,582</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.4.3.3">16,557</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.4.3.4">411,840</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Evaluation Metrics.</span>
When evaluating our XRec, we employ a suite of metrics designed to capture the semantic explainability and stability of the generated explanations. Traditional n-gram based metrics like BLEU and ROUGE prove unsuitable, as they fail to grasp the underlying semantic meaning. For instance, "the weather is cold" and "it’s freezing" convey the same meaning, yet would score poorly due to a lack of n-gram overlap.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">Instead, we employ advanced metrics that incorporate semantic understanding: GPTScore <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib15" title="">2023</a>)</cite> aligns with human judgment by comparing the semantic similarity between generated and ground truth explanations. BERTScore <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib27" title="">2020</a>)</cite> utilizes contextual embeddings from BERT to compute token-level cosine similarity. BARTScore <cite class="ltx_cite ltx_citemacro_cite">Yuan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib24" title="">2021</a>)</cite> leverages the BART model, conceptualizing evaluation as a text generation task that assigns scores based on the probability of regenerating reference texts. BLEURT <cite class="ltx_cite ltx_citemacro_cite">Sellam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib14" title="">2020</a>)</cite> employs a novel pre-training approach with synthetic data to enhance generalization. USR <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib7" title="">2021</a>)</cite> (Unique Sentence Ratio) measures the uniqueness of generated explanations by calculating the ratio of unique to total sentences.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">To further assess quality stability, we analyze the standard deviations of these scores, with lower values indicating more consistent performance. The overall results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.T1" title="Table 1 ‣ 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Compared Methods.</span>
We compare our model’s performance against the following baselines:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Att2Seq</span> <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib3" title="">2017</a>)</cite>: Utilizes an attention-based attribute-to-sequence model to generate reviews based on attribute information.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">NRT</span> <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib9" title="">2017</a>)</cite>: Predicts ratings and generates abstractive tips for recommendations using multi-task learning to optimize parameters.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">PETER</span> <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib7" title="">2021</a>)</cite>: PETER is a personalized transformer model for explainable recommendation. It maps user and item IDs to the generated explanation text, connecting the IDs and words. Since the datasets lack word features, PETER is used instead of PETER+, which incorporates additional features.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">PEPLER</span> <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib8" title="">2023</a>)</cite>: PEPLER leverages pretrained transformer to generate explainable recommendations based on prompts that incorporate user and item ID vectors. To bridge the gap between these prompts and the pretrained model, the approach proposes sequential tuning and recommendation as regularization strategies. There are several variants of the PEPLER, and in this case, the researchers have opted to use the continuous prompt learning version.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.1.1">Ours (w/o profile)</span>: For a fair comparison across all the models, we remove the user and item profiles from the input to our model, as the other baselines do not have access to this information.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p6.1.1">Implementation Details.</span>
When generating the graph embeddings, we configure the embedding dimension to 64 and use a batch size of 1024. To optimize the training process, we implement an early stopping mechanism based on Recall@20, allowing for up to 10 patience steps. In our Mixture of Experts (MoE) setup, we utilize 8 experts and incorporate a dropout rate of 0.2, with an additional noise factor of 0.01 at the gating router. The LLM we use is built upon the LLaMA2-7B architecture. Additionally, we employ the gpt-3.5-turbo model for generating datasets and for computing the GPTScore. For the explanations, we ensure they are no longer than 50 words for both the ground truth and the generated explanations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Comparison</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To demonstrate the superiority of our model in explainability and stability, we conduct comparative analyses against four baseline methods across three datasets. The results are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.T1" title="Table 1 ‣ 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> and reveal several key findings:</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1">Our model consistently outperforms the baselines. Even after removing user and item profiles, the Ours (w/o profile) variant still demonstrates significant superiority. This success can be attributed to two key factors: i) Our model effectively captures collaborative information, enhancing the representation of rich semantics from user interaction behaviors, going beyond just textual information. ii) The model achieves strong alignment between the behavior-level collaborative information and text-level semantics.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1">A standout feature of our model is its Unique Sentence Ratio (USR), which is nearly 1. This indicates that XRec generates truly unique explanations for each distinct user-item interaction. This remarkable level of uniqueness in the generated explanations represents a significant breakthrough. No previous work has achieved such a high degree of personalization in model outputs.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Our model enhances learning efficacy and boosts overall performance by strategically exploiting the synergistic strengths across domains.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="553" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Ablation Study on Variant Models: Higher scores in GPTScore and BERTScore suggest improved explainability, while lower scores in GPT_std and BERT_std indicate enhanced stability.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this section, we conduct ablation studies to explore the impact of two pivotal components in our model: user/item profiles and the injection of collaborative information. We compare four model variants - i) our complete model with all features (<span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">Ours</span>); ii) <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.2">Ours (w/o profile)</span> which omits user and item profiles; iii) <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.3">Ours (w/o injection)</span> which retains aligned embeddings in the prompts but does not inject them into the LLM layers, and iv) <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.4">Ours (w/o profile &amp; injection)</span> lacking both profiles and embedding injection. To rigorously assess explainability and stability, we evaluate these variants using GPTScore and BERTScore on the Amazon-books and Google-reviews datasets, including their standard deviations, which sheds light on the critical role each of these elements plays in driving the model’s performance and capabilities.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">The results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#S4.F3" title="Figure 3 ‣ 4.3 Ablation Study ‣ 4 Evaluation ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> show our complete model (Ours) outperforms other variants in explainability and stability, highlighting its superior capability. i) While <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Ours (w/o profile)</span> declines only slightly, it exhibits a significant reduction in stability compared to Ours, underscoring the critical importance of user/item profiles for explanation stability. ii) Similarly, <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.2">Ours (w/o injection)</span> reports much lower scores, emphasizing the value of incorporating neighborhood knowledge to improve performance. iii) Notably, <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.3">Ours (w/o profile &amp; injection)</span> exhibits the lowest scores, confirming the synergistic combination of user/item profiles and knowledge injection is crucial for optimal performance. These findings underscore the complementary and synergistic contribution of these two critical components in driving the superior capabilities of our complete model.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="553" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Experiments of different data sparsity.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Model Robustness against Data Sparsity</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">To evaluate our model’s generalization capabilities, we conducted experiments across datasets with varying data sparsity. We segmented the testing data into five subsets (tst1 to tst5) based on the frequency of user appearances in the training data. This allowed us to systematically examine the model’s effectiveness across a spectrum of user familiarity, from rare to frequent users. Additionally, we introduced a zero-shot testing dataset consisting solely of users not encountered during training, which tested the model’s ability to address the cold-start problem. The evaluation results, summarized in Figure 1, highlight several key findings:</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1">The model demonstrates robust performance across all subsets, with noticeably better results as user frequency decreases. This trend suggests our model effectively leverages collaborative information, even with limited user interactions.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1">In the zero-shot scenario, lacking any prior user data, our model not only outperforms baselines but also performs comparably to the other subsets, from tst1 to tst5. This capability is valuable for new user recommendations, highlighting the practical utility of our approach in real-world applications with incomplete user data.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">These findings underscore the efficacy of our model in scenarios that traditionally challenge recommender systems, such as those involving new or infrequent users. The model’s success in the zero-shot learning confirms its robust generalization capabilities and highlights its potential to mitigate the cold-start problem, where new users or items lack historical interaction data. By maintaining high levels of explainability and stability across diverse scenarios, the model proves its suitability for deployment in dynamic environments where user behaviors and item catalogs frequently change.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Explainable Recommendation</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Explainable recommender systems have attracted considerable attention due to their ability to enhance user satisfaction and provide transparency in recommendation processes. Early approaches primarily relied on extracting attributes from users and items’ side information to generate explanations, employing techniques such as attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib3" title="">2017</a>)</cite> and recurrent neural networks (RNNs) <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib9" title="">2017</a>)</cite>. In recent studies, researchers have further explored the application of advanced models like Transformer <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib7" title="">2021</a>)</cite> and GPT2 <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib8" title="">2023</a>)</cite> for offering explanations regarding user behaviors in recommender systems.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">However, a predominant issue with most existing solutions for explainable recommendations is their heavy reliance on ID-based approaches. This dependency significantly restricts their generalization ability, especially when confronted with challenges such as data sparsity and zero-shot recommendation scenarios. Furthermore, the scarcity of explanatory data presents additional obstacles, as it poses challenges for existing methods to deliver explanations of high quality and comprehensiveness. Given the aforementioned obstacles, we propose the development of a novel large language model as an explainer for recommender systems. This model not only uncovers the underlying reasons behind user-item interactions, but also demonstrates robust generalization capabilities, even in zero-shot recommendation scenarios.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>GNNs for Recommendation</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Graph Neural Networks (GNNs) have become a core part of improving collaborative filtering models. They offer an effective way to capture the complex high-level interactions in recommendation systems <cite class="ltx_cite ltx_citemacro_cite">Ying et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib23" title="">2018</a>); Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib13" title="">2023</a>)</cite>. These networks leverage the natural relational structure of data, enabling a sophisticated understanding of the intricate dependencies that define user-item interactions. Recommender systems like LightGCN <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib4" title="">2020</a>)</cite> and Star-GCN <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib25" title="">2019a</a>)</cite> have set the standard, using iterative message passing to model and enhance collaborative relationships. To address the challenge of data sparsity, researchers have integrated self-supervised learning with the graph-based collaborative filtering approach. This introduces new methods to enrich the learning process and improve recommendation quality <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib20" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib21" title="">b</a>); Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#bib.bib22" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">Drawing inspiration from the aforementioned research endeavors that emphasize GNN-enhanced recommender systems, we have successfully developed our advanced language model, XRec. By incorporating GNN as the collaborative relation encoders, our model excels at capturing intricate user dependencies at higher orders. Through our collaborative instruction-tuning framework, we equip LLMs with the ability to recognize and leverage collaborative signals among users, effectively aligning behavior-level user preferences with the language semantic space. This enables our model to provide comprehensive textual explanations that correspond to user interaction behaviors.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This work presents a novel framework, XRec, that seamlessly integrates the graph-based collaborative filtering paradigm with the capabilities of Large Language Models (LLMs) to generate comprehensive and insightful explanations for recommendation outputs. By leveraging the inherent collaborative relationships encoded within the user-item interaction graph, XRec is able to effectively capture the high-order dependencies that underlie user preferences and item associations. XRec introduces a specialized collaborative information adaptor, which serves as the critical bridge for establishing a strong connection between the collaborative signals and the rich textual semantics encoded within the LLM. Through extensive experiments, the study’s findings underscore the significant advantages of the XRec framework. Not only does it enhance the explainability of the recommendation process, but it also ensures robustness, particularly in challenging zero-shot scenarios where the framework demonstrates strong generalization capabilities across unseen users and items.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Limitation</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">While XRec demonstrates promising advancements in explainable recommender systems, it also exhibits limitations in terms of data modality diversity. Currently, our approach is constrained to textual and graph-based data, excluding visual inputs such as images and videos. These visual modalities can provide extensive contextual information. For instance, images and videos can reveal aesthetic preferences, cultural trends, and emotional responses, capturing subtle cues that textual data might miss. They also help identify visual patterns that correspond to user behavior and preferences, such as color schemes, styles, and settings, which are crucial for personalization. Recognizing these limitations, future work could explore the integration of multimodal data processing techniques. This approach may potentially enhance the system’s predictive accuracy and improve its ability to personalize recommendation explanations, by incorporating advanced image and video analysis to better understand and respond to user preferences.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Hanxiong Chen, Shaoyun Shi, Yunqi Li, and Yongfeng Zhang. 2021.

</span>
<span class="ltx_bibblock">Neural collaborative reasoning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">WWW</em>, pages 1516–1527.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2017)</span>
<span class="ltx_bibblock">
Jingyuan Chen, Hanwang Zhang, Xiangnan He, Liqiang Nie, Wei Liu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Attentive collaborative filtering: Multimedia recommendation with item-and component-level attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">SIGIR</em>, pages 335–344.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2017)</span>
<span class="ltx_bibblock">
Li Dong, Shaohan Huang, Furu Wei, Mirella Lapata, Ming Zhou, and Ke Xu. 2017.

</span>
<span class="ltx_bibblock">Learning to generate product reviews from attributes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">EACL</em>, pages 623–632.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">Lightgcn: Simplifying and powering graph convolution network for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">SIGIR</em>, pages 639–648.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2022)</span>
<span class="ltx_bibblock">
Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Towards universal sequence representation learning for recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">SIGIR</em>, pages 585–593.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Jiacheng Li, Jingbo Shang, and Julian McAuley. 2022.

</span>
<span class="ltx_bibblock">Uctopic: Unsupervised contrastive learning for phrase representations and topic mining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2202.13469</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen. 2021.

</span>
<span class="ltx_bibblock">Personalized transformer for explainable recommendation.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen. 2023.

</span>
<span class="ltx_bibblock">Personalized prompt learning for explainable recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Transactions on Information Systems (TOIS)</em>, 41(4):1–26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Piji Li, Zihao Wang, Zhaochun Ren, Lidong Bing, and Wai Lam. 2017.

</span>
<span class="ltx_bibblock">Neural rating regression with abstractive tips generation for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">SIGIR</em>, pages 345–354.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. (2019)</span>
<span class="ltx_bibblock">
Jianmo Ni, Jiacheng Li, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">Justifying recommendations using distantly-labeled reviews and fine-grained aspects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">EMNLP</em>, pages 188–197.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2023)</span>
<span class="ltx_bibblock">
Yijian Qin, Xin Wang, Ziwei Zhang, and Wenwu Zhu. 2023.

</span>
<span class="ltx_bibblock">Disentangled representation learning with large language models for text-attributed graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2310.18152</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2024)</span>
<span class="ltx_bibblock">
Xubin Ren, Wei Wei, Lianghao Xia, Lixin Su, Suqi Cheng, Junfeng Wang, Dawei Yin, and Chao Huang. 2024.

</span>
<span class="ltx_bibblock">Representation learning with large language models for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">WWW</em>, pages 3464–3475.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2023)</span>
<span class="ltx_bibblock">
Xubin Ren, Lianghao Xia, Jiashu Zhao, Dawei Yin, and Chao Huang. 2023.

</span>
<span class="ltx_bibblock">Disentangled contrastive collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">SIGIR</em>, pages 1137–1146.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sellam et al. (2020)</span>
<span class="ltx_bibblock">
Thibault Sellam, Dipanjan Das, and Ankur P Parikh. 2020.

</span>
<span class="ltx_bibblock">Bleurt: Learning robust metrics for text generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Jiaan Wang, Yunlong Liang, Fandong Meng, Zengkui Sun, Haoxiang Shi, Zhixu Li, Jinan Xu, Jianfeng Qu, and Jie Zhou. 2023.

</span>
<span class="ltx_bibblock">Is chatgpt a good nlg evaluator? a preliminary study.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">EMNLP</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Meng Wang, Fuli Feng, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Neural graph collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">SIGIR</em>, pages 165–174.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al. (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards open-world recommendation with knowledge augmentation from large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2306.10933</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2023)</span>
<span class="ltx_bibblock">
Lianghao Xia, Chao Huang, Chunzhen Huang, Kangyi Lin, Tao Yu, and Ben Kao. 2023.

</span>
<span class="ltx_bibblock">Automated self-supervised learning for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">WWW</em>, pages 992–1002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2023)</span>
<span class="ltx_bibblock">
An Yan, Zhankui He, Jiacheng Li, Tianyang Zhang, and Julian McAuley. 2023.

</span>
<span class="ltx_bibblock">Personalized showcases: Generating multi-modal explanations for recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">SIGIR</em>, pages 2251–2255.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023a)</span>
<span class="ltx_bibblock">
Yonghui Yang, Zhengwei Wu, Le Wu, Kun Zhang, Richang Hong, Zhiqiang Zhang, Jun Zhou, and Meng Wang. 2023a.

</span>
<span class="ltx_bibblock">Generative-contrastive graph learning for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">SIGIR</em>, pages 1117–1126.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023b)</span>
<span class="ltx_bibblock">
Yuhao Yang, Chao Huang, Lianghao Xia, and Chunzhen Huang. 2023b.

</span>
<span class="ltx_bibblock">Knowledge graph self-supervised rationalization for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">KDD</em>, pages 3046–3056.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2021)</span>
<span class="ltx_bibblock">
Tiansheng Yao, Xinyang Yi, Derek Zhiyuan Cheng, Felix Yu, Ting Chen, Aditya Menon, Lichan Hong, Ed H Chi, Steve Tjoa, Jieqi Kang, et al. 2021.

</span>
<span class="ltx_bibblock">Self-supervised learning for large-scale item recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">CIKM</em>, pages 4321–4330.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et al. (2018)</span>
<span class="ltx_bibblock">
Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L Hamilton, and Jure Leskovec. 2018.

</span>
<span class="ltx_bibblock">Graph convolutional neural networks for web-scale recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">KDD</em>, pages 974–983.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2021)</span>
<span class="ltx_bibblock">
Weizhe Yuan, Graham Neubig, and Pengfei Liu. 2021.

</span>
<span class="ltx_bibblock">Bartscore: Evaluating generated text as text generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">NeurIPS</em>, volume 34, pages 27263–27277.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019a)</span>
<span class="ltx_bibblock">
Jiani Zhang, Xingjian Shi, Shenglin Zhao, and Irwin King. 2019a.

</span>
<span class="ltx_bibblock">Star-gcn: Stacked and reconstructed graph convolutional networks for recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">IJCAI</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019b)</span>
<span class="ltx_bibblock">
Shuai Zhang, Lina Yao, Aixin Sun, and Yi Tay. 2019b.

</span>
<span class="ltx_bibblock">Deep learning based recommender system: A survey and new perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">ACM Computing Surveys (CSUR)</em>, 52(1):1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Tianyi Zhang, Varsha Kishore, Felix Wu, Kilian Q Weinberger, and Yoav Artzi. 2020.

</span>
<span class="ltx_bibblock">Bertscore: Evaluating text generation with bert.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">ICLR</em>.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The supplementary materials accompanying this work offer a comprehensive and meticulous exploration of the methodologies and techniques utilized in crafting the ground truth explanations and developing the detailed user/item profiles.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Generating Ground Truth Explanations</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.F5" title="Figure 5 ‣ A.3 User Profile Generation ‣ Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> provides an illustrative example of the ground truth explanation generation process as applied to the Yelp dataset. To maintain a consistent approach across diverse user-item interactions, the instructions given to the language models remain uniform, guiding them to extract the most relevant information that accurately reflects the user’s underlying intentions. Notably, the prompt used in this process consists solely of the user’s review text, deliberately omitting any additional data about the user or the item being reviewed. This strategic decision helps to minimize the influence of extraneous information, allowing the language model to focus exclusively on discerning and articulating the implicit intentions behind the user’s interaction.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Item Profile Generation</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.F6" title="Figure 6 ‣ A.3 User Profile Generation ‣ Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the item profile generation process using the Yelp data. LLMs are fed metadata about the item, such as its name, location, and category, as well as user reviews. This approach allows the LLMs to gain a deeper understanding of the types of users who favor the business. By processing this multifaceted information, the LLMs generate comprehensive profiles that summarize the key characteristics of users inclined towards the item. For instance, the case study profiles capture insights into the preferences of users drawn to beer-related businesses. This granular understanding represents a significant advancement in modeling user-item interactions and preferences.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>User Profile Generation</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02377v2#A1.F7" title="Figure 7 ‣ A.3 User Profile Generation ‣ Appendix A Appendix ‣ XRec: Large Language Models for Explainable Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a> explores user profile generation on the Yelp dataset. Unlike items, users often lack extensive metadata, presenting a unique challenge. To deduce user preferences, the approach relies on Large Language Models (LLMs) to analyze the user’s historical interactions. Crucially, the LLMs leverage item descriptions derived from previously generated profiles, refined to better characterize the items. This methodology, incorporating metadata like item titles and reviews, empowers the LLMs to identify the specific types of items a user prefers. By leveraging this multifaceted information, the system develops nuanced user profiles to enable personalized recommendations.</p>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="1097" id="A1.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Case study on the generation of ground truth explanations for recommender systems on Yelp dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="438" id="A1.F6.g1" src="x6.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Case study of item profile generation on Yelp dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="488" id="A1.F7.g1" src="x7.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Case study of user profile generation on Yelp dataset.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Sep 22 14:49:01 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
