<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2307.04869] Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning</title><meta property="og:description" content="Federated continual learning (FCL) learns incremental tasks over time from confidential datasets distributed across clients. This paper focuses on rehearsal-free FCL, which has severe forgetting issues when learning ne…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2307.04869">

<!--Generated on Wed Feb 28 18:38:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Continual Learning,  Federated learning,  Rehearsal-free Continual Learning,  Prompt Learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gaurav Bagwe
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaoyong Yuan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Miao Pan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lan Zhang
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated continual learning (FCL) learns incremental tasks over time from confidential datasets distributed across clients. This paper focuses on rehearsal-free FCL, which has severe forgetting issues when learning new tasks due to the lack of access to historical task data. To address this issue, we propose Fed-CPrompt based on prompt learning techniques to obtain task-specific prompts in a communication-efficient way. Fed-CPrompt introduces two key components, asynchronous prompt learning, and contrastive continual loss, to handle asynchronous task arrival and heterogeneous data distributions in FCL, respectively. Extensive experiments demonstrate the effectiveness of Fed-CPrompt in achieving SOTA rehearsal-free FCL performance.</p>
</div>
<div class="ltx_keywords">Federated Continual Learning, Federated learning, Rehearsal-free Continual Learning, Prompt Learning
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) has been a popular collaborative machine learning paradigm enabling multiple clients to learn a shared model without exposing private client data <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>. While successful, existing FL algorithms are mainly designed for a single task with fixed datasets on clients <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>; Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>, <a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite>, which becomes ineffective in handling non-stationary data distribution over time. Therefore, recent efforts have been put into federated continual learning (FCL) to learn tasks that are presented sequentially. Since the model in continual learning (CL) may overfit data from the current task and suffer from catastrophic forgetting <cite class="ltx_cite ltx_citemacro_citep">(Kirkpatrick et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>, the mainstream research to address the forgetting issue can be roughly divided into two categories: rehearsal-based and rehearsal-free FCL.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Although rehearsal-based approaches achieve state-of-the-art (SOTA) performance by using the rehearsal buffer to store and retrain data from previous tasks, the buffer size needs to be large enough to effectively mitigate forgetting <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>; Dong et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>, leading to scalability and data storage constraints in FL. Moreover, many applications do not allow this buffer due to privacy concerns <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib24" title="" class="ltx_ref">2022b</a>)</cite>, further restricting their adoption in practice. Hence, this work focuses on rehearsal-free FCL. Existing efforts along this line regularize the global model with knowledge from previous tasks when learning a new task <cite class="ltx_cite ltx_citemacro_citep">(Shoham et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Yoon et al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>; Casado et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; Usmanova et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>; Ma et al., <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>. Unfortunately, they have substantially deteriorated performance compared to rehearsal-based approaches <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>)</cite>. Moreover, existing research requires continuously exchanging the entire model to learn incremental tasks in FCL, leading to significant communication overhead. In view of these, it is critical to developing <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">innovative rehearsal-free FCL in a communication-efficient way to address the forgetting issue while maintaining the model plasticity for new tasks</span>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Enlightened by the recent advance of prompting techniques <cite class="ltx_cite ltx_citemacro_citep">(Lester et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Liu et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Li &amp; Liang, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, in this work, we leverage prompt learning to achieve the above goal. As one promising transfer learning approach, prompt learning uses insertable embeddings called prompts to condition a pre-trained model for downstream tasks. Recent research enables prompt-based CL by using key-query mechanisms, which achieves SOTA rehearsal-free performance, even outperforming rehearsal-based CL <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib28" title="" class="ltx_ref">a</a>; Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite>. Due to the small size of prompt parameters, the communication efficiency of FCL is expected to be improved significantly. However, existing prompt-based CL is designed for centralized datasets, which becomes ineffective in FL with distributed and confidential datasets. The main limitation is due to the inherent heterogeneity of distributed clients. On the one hand, clients may observe heterogeneous data for the same task, leading to biased learning performance and slow convergence. On the other hand, incremental tasks may arrive asynchronously on clients, further deteriorating the overall learning performance. Therefore, to unleash the potential of prompting for rehearsal-free FCL, we propose Fed-CPrompt to facilitate inter-task and inter-client prompt-based knowledge transfer while addressing the heterogeneity concerns of data distribution and task arrival over clients.
Our key contributions are summarized below:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose Fed-CPrompt, an innovative rehearsal-free FCL framework based on prompting techniques. Fed-CPrompt achieves SOTA FCL performance to handle the stability-plasticity dilemma under heterogeneous FL environments in a communication-efficient way.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce two key components to Fed-CPrompt: <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">asynchronous prompt learning</span> takes advantage of task asynchronicity to strengthen the task-specific prompts; <span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_italic">C2L loss</span> alleviates inter-task forgetting and inter-client data heterogeneity via a contrastive and continual loss.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments to demonstrate the effectiveness of Fed-CPrompt in various challenging FCL settings, such as heterogeneous data distribution and asynchronous task arrival.
</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2307.04869/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="115" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of Fed-CPrompt. Left: overall system framework. A server maintains a pool of task-specific prompts to coordinate multiple clients for FCL. The clients may observe different tasks at the same time. Fed-CPrompt allows asynchronous prompt learning. Right: zoom in view of client <math id="S1.F1.5.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S1.F1.5.m1.1b"><mi id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><ci id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">c</annotation></semantics></math>’s local training for task <math id="S1.F1.6.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S1.F1.6.m2.1b"><msub id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.6.m2.1.1.2" xref="S1.F1.6.m2.1.1.2.cmml">𝒯</mi><mi id="S1.F1.6.m2.1.1.3" xref="S1.F1.6.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><apply id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m2.1.1.1.cmml" xref="S1.F1.6.m2.1.1">subscript</csymbol><ci id="S1.F1.6.m2.1.1.2.cmml" xref="S1.F1.6.m2.1.1.2">𝒯</ci><ci id="S1.F1.6.m2.1.1.3.cmml" xref="S1.F1.6.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">\mathcal{T}_{m}</annotation></semantics></math>. Since only the trainable parameters (<math id="S1.F1.7.m3.1" class="ltx_Math" alttext="w_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S1.F1.7.m3.1b"><msubsup id="S1.F1.7.m3.1.1" xref="S1.F1.7.m3.1.1.cmml"><mi id="S1.F1.7.m3.1.1.2.2" xref="S1.F1.7.m3.1.1.2.2.cmml">w</mi><mi id="S1.F1.7.m3.1.1.2.3" xref="S1.F1.7.m3.1.1.2.3.cmml">c</mi><msub id="S1.F1.7.m3.1.1.3" xref="S1.F1.7.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.7.m3.1.1.3.2" xref="S1.F1.7.m3.1.1.3.2.cmml">𝒯</mi><mi id="S1.F1.7.m3.1.1.3.3" xref="S1.F1.7.m3.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.1c"><apply id="S1.F1.7.m3.1.1.cmml" xref="S1.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.1.cmml" xref="S1.F1.7.m3.1.1">superscript</csymbol><apply id="S1.F1.7.m3.1.1.2.cmml" xref="S1.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.2.1.cmml" xref="S1.F1.7.m3.1.1">subscript</csymbol><ci id="S1.F1.7.m3.1.1.2.2.cmml" xref="S1.F1.7.m3.1.1.2.2">𝑤</ci><ci id="S1.F1.7.m3.1.1.2.3.cmml" xref="S1.F1.7.m3.1.1.2.3">𝑐</ci></apply><apply id="S1.F1.7.m3.1.1.3.cmml" xref="S1.F1.7.m3.1.1.3"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.3.1.cmml" xref="S1.F1.7.m3.1.1.3">subscript</csymbol><ci id="S1.F1.7.m3.1.1.3.2.cmml" xref="S1.F1.7.m3.1.1.3.2">𝒯</ci><ci id="S1.F1.7.m3.1.1.3.3.cmml" xref="S1.F1.7.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.1d">w_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> and <math id="S1.F1.8.m4.1" class="ltx_Math" alttext="\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S1.F1.8.m4.1b"><msubsup id="S1.F1.8.m4.1.1" xref="S1.F1.8.m4.1.1.cmml"><mi id="S1.F1.8.m4.1.1.2.2" xref="S1.F1.8.m4.1.1.2.2.cmml">ϕ</mi><mi id="S1.F1.8.m4.1.1.2.3" xref="S1.F1.8.m4.1.1.2.3.cmml">c</mi><msub id="S1.F1.8.m4.1.1.3" xref="S1.F1.8.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.8.m4.1.1.3.2" xref="S1.F1.8.m4.1.1.3.2.cmml">𝒯</mi><mi id="S1.F1.8.m4.1.1.3.3" xref="S1.F1.8.m4.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S1.F1.8.m4.1c"><apply id="S1.F1.8.m4.1.1.cmml" xref="S1.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m4.1.1.1.cmml" xref="S1.F1.8.m4.1.1">superscript</csymbol><apply id="S1.F1.8.m4.1.1.2.cmml" xref="S1.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m4.1.1.2.1.cmml" xref="S1.F1.8.m4.1.1">subscript</csymbol><ci id="S1.F1.8.m4.1.1.2.2.cmml" xref="S1.F1.8.m4.1.1.2.2">italic-ϕ</ci><ci id="S1.F1.8.m4.1.1.2.3.cmml" xref="S1.F1.8.m4.1.1.2.3">𝑐</ci></apply><apply id="S1.F1.8.m4.1.1.3.cmml" xref="S1.F1.8.m4.1.1.3"><csymbol cd="ambiguous" id="S1.F1.8.m4.1.1.3.1.cmml" xref="S1.F1.8.m4.1.1.3">subscript</csymbol><ci id="S1.F1.8.m4.1.1.3.2.cmml" xref="S1.F1.8.m4.1.1.3.2">𝒯</ci><ci id="S1.F1.8.m4.1.1.3.3.cmml" xref="S1.F1.8.m4.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m4.1d">\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math>) need to be exchanged, Fed-CPrompt is a communication-efficient FCL approach.
</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Proposed Method</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Statement</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.3" class="ltx_p">In a standard FCL setting, a central server coordinates a set of distributed clients <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math> to learn incremental tasks <math id="S2.SS1.p1.2.m2.3" class="ltx_Math" alttext="{\mathcal{T}_{1},\ldots,\mathcal{T}_{n}}" display="inline"><semantics id="S2.SS1.p1.2.m2.3a"><mrow id="S2.SS1.p1.2.m2.3.3.2" xref="S2.SS1.p1.2.m2.3.3.3.cmml"><msub id="S2.SS1.p1.2.m2.2.2.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.2.2.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.2.cmml">𝒯</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.3.3.2.3" xref="S2.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.3.3.2.4" xref="S2.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml">𝒯</mi><mi id="S2.SS1.p1.2.m2.3.3.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.3b"><list id="S2.SS1.p1.2.m2.3.3.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2"><apply id="S2.SS1.p1.2.m2.2.2.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.2">𝒯</ci><cn type="integer" id="S2.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.3.3.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">𝒯</ci><ci id="S2.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.3c">{\mathcal{T}_{1},\ldots,\mathcal{T}_{n}}</annotation></semantics></math> over time.
The training data for each task is distributed to clients and cannot be shared. FCL aims to obtain a global model parameterized by <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathbf{w}</annotation></semantics></math> to perform all existing tasks. In this work, we consider a challenging CL problem, class-incremental CL, where the task labels are unknown during inference <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>. Our design can be easily extended to the task- or domain-incremental FCL problems. The optimization objective can be written as</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\min_{\mathbf{w}}\sum_{i\in\{1,\ldots,n\}}\sum_{c\in\mathcal{C}}\frac{\mathrm{n}_{c}^{\mathcal{T}_{i}}}{\mathrm{n}^{\mathcal{T}_{i}}}\mathcal{L}(\mathcal{D}_{c}^{\mathcal{T}_{i}};\mathbf{w})," display="block"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><munder id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.2" xref="S2.E1.m1.5.5.1.1.3.2.cmml">min</mi><mi id="S2.E1.m1.5.5.1.1.3.3" xref="S2.E1.m1.5.5.1.1.3.3.cmml">𝐰</mi></munder><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.2" xref="S2.E1.m1.5.5.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.1.cmml"><munder id="S2.E1.m1.5.5.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.5.5.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml"><mi id="S2.E1.m1.3.3.3.5" xref="S2.E1.m1.3.3.3.5.cmml">i</mi><mo id="S2.E1.m1.3.3.3.4" xref="S2.E1.m1.3.3.3.4.cmml">∈</mo><mrow id="S2.E1.m1.3.3.3.6.2" xref="S2.E1.m1.3.3.3.6.1.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.6.2.1" xref="S2.E1.m1.3.3.3.6.1.cmml">{</mo><mn id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">1</mn><mo id="S2.E1.m1.3.3.3.6.2.2" xref="S2.E1.m1.3.3.3.6.1.cmml">,</mo><mi mathvariant="normal" id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">…</mi><mo id="S2.E1.m1.3.3.3.6.2.3" xref="S2.E1.m1.3.3.3.6.1.cmml">,</mo><mi id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml">n</mi><mo stretchy="false" id="S2.E1.m1.3.3.3.6.2.4" xref="S2.E1.m1.3.3.3.6.1.cmml">}</mo></mrow></mrow></munder><mrow id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><munder id="S2.E1.m1.5.5.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.5.5.1.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.2.3.2" xref="S2.E1.m1.5.5.1.1.1.1.2.3.2.cmml">c</mi><mo id="S2.E1.m1.5.5.1.1.1.1.2.3.1" xref="S2.E1.m1.5.5.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.2.3.3" xref="S2.E1.m1.5.5.1.1.1.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S2.E1.m1.5.5.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.cmml"><mfrac id="S2.E1.m1.5.5.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.cmml"><msubsup id="S2.E1.m1.5.5.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.2.cmml">n</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.3.cmml">c</mi><msub id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.2.cmml">𝒯</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></msubsup><msup id="S2.E1.m1.5.5.1.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.E1.m1.5.5.1.1.1.1.1.3.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.2.cmml">n</mi><msub id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.2.cmml">𝒯</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub></msup></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.4" xref="S2.E1.m1.5.5.1.1.1.1.1.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.1.2a" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msubsup><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝐰</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.4" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><times id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3">subscript</csymbol><min id="S2.E1.m1.5.5.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2"></min><ci id="S2.E1.m1.5.5.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3">𝐰</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.5.5.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2"></sum><apply id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3"><in id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.4"></in><ci id="S2.E1.m1.3.3.3.5.cmml" xref="S2.E1.m1.3.3.3.5">𝑖</ci><set id="S2.E1.m1.3.3.3.6.1.cmml" xref="S2.E1.m1.3.3.3.6.2"><cn type="integer" id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">1</cn><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">…</ci><ci id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3">𝑛</ci></set></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.2"></sum><apply id="S2.E1.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.3"><in id="S2.E1.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.3.1"></in><ci id="S2.E1.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.3.2">𝑐</ci><ci id="S2.E1.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3"><divide id="S2.E1.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3"></divide><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.2">n</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.2.3">𝑐</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.2">𝒯</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.2">n</ci><apply id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.2">𝒯</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><ci id="S2.E1.m1.5.5.1.1.1.1.1.4.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.4">ℒ</ci><list id="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝒯</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝐰</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\min_{\mathbf{w}}\sum_{i\in\{1,\ldots,n\}}\sum_{c\in\mathcal{C}}\frac{\mathrm{n}_{c}^{\mathcal{T}_{i}}}{\mathrm{n}^{\mathcal{T}_{i}}}\mathcal{L}(\mathcal{D}_{c}^{\mathcal{T}_{i}};\mathbf{w}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.10" class="ltx_p">where <math id="S2.SS1.p1.4.m1.1" class="ltx_Math" alttext="\mathrm{n}_{c}^{\mathcal{T}_{i}}" display="inline"><semantics id="S2.SS1.p1.4.m1.1a"><msubsup id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml"><mi mathvariant="normal" id="S2.SS1.p1.4.m1.1.1.2.2" xref="S2.SS1.p1.4.m1.1.1.2.2.cmml">n</mi><mi id="S2.SS1.p1.4.m1.1.1.2.3" xref="S2.SS1.p1.4.m1.1.1.2.3.cmml">c</mi><msub id="S2.SS1.p1.4.m1.1.1.3" xref="S2.SS1.p1.4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m1.1.1.3.2" xref="S2.SS1.p1.4.m1.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS1.p1.4.m1.1.1.3.3" xref="S2.SS1.p1.4.m1.1.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><apply id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m1.1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">superscript</csymbol><apply id="S2.SS1.p1.4.m1.1.1.2.cmml" xref="S2.SS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m1.1.1.2.1.cmml" xref="S2.SS1.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m1.1.1.2.2.cmml" xref="S2.SS1.p1.4.m1.1.1.2.2">n</ci><ci id="S2.SS1.p1.4.m1.1.1.2.3.cmml" xref="S2.SS1.p1.4.m1.1.1.2.3">𝑐</ci></apply><apply id="S2.SS1.p1.4.m1.1.1.3.cmml" xref="S2.SS1.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m1.1.1.3.1.cmml" xref="S2.SS1.p1.4.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.4.m1.1.1.3.2.cmml" xref="S2.SS1.p1.4.m1.1.1.3.2">𝒯</ci><ci id="S2.SS1.p1.4.m1.1.1.3.3.cmml" xref="S2.SS1.p1.4.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">\mathrm{n}_{c}^{\mathcal{T}_{i}}</annotation></semantics></math> and <math id="S2.SS1.p1.5.m2.1" class="ltx_Math" alttext="\mathrm{n}^{\mathcal{T}_{i}}" display="inline"><semantics id="S2.SS1.p1.5.m2.1a"><msup id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml"><mi mathvariant="normal" id="S2.SS1.p1.5.m2.1.1.2" xref="S2.SS1.p1.5.m2.1.1.2.cmml">n</mi><msub id="S2.SS1.p1.5.m2.1.1.3" xref="S2.SS1.p1.5.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m2.1.1.3.2" xref="S2.SS1.p1.5.m2.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS1.p1.5.m2.1.1.3.3" xref="S2.SS1.p1.5.m2.1.1.3.3.cmml">i</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.1b"><apply id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m2.1.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m2.1.1.2.cmml" xref="S2.SS1.p1.5.m2.1.1.2">n</ci><apply id="S2.SS1.p1.5.m2.1.1.3.cmml" xref="S2.SS1.p1.5.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m2.1.1.3.1.cmml" xref="S2.SS1.p1.5.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.5.m2.1.1.3.2.cmml" xref="S2.SS1.p1.5.m2.1.1.3.2">𝒯</ci><ci id="S2.SS1.p1.5.m2.1.1.3.3.cmml" xref="S2.SS1.p1.5.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.1c">\mathrm{n}^{\mathcal{T}_{i}}</annotation></semantics></math> represent the number of training samples from client <math id="S2.SS1.p1.6.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS1.p1.6.m3.1a"><mi id="S2.SS1.p1.6.m3.1.1" xref="S2.SS1.p1.6.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m3.1b"><ci id="S2.SS1.p1.6.m3.1.1.cmml" xref="S2.SS1.p1.6.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m3.1c">c</annotation></semantics></math> and all clients for task <math id="S2.SS1.p1.7.m4.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S2.SS1.p1.7.m4.1a"><msub id="S2.SS1.p1.7.m4.1.1" xref="S2.SS1.p1.7.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m4.1.1.2" xref="S2.SS1.p1.7.m4.1.1.2.cmml">𝒯</mi><mi id="S2.SS1.p1.7.m4.1.1.3" xref="S2.SS1.p1.7.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m4.1b"><apply id="S2.SS1.p1.7.m4.1.1.cmml" xref="S2.SS1.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m4.1.1.1.cmml" xref="S2.SS1.p1.7.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m4.1.1.2.cmml" xref="S2.SS1.p1.7.m4.1.1.2">𝒯</ci><ci id="S2.SS1.p1.7.m4.1.1.3.cmml" xref="S2.SS1.p1.7.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m4.1c">\mathcal{T}_{i}</annotation></semantics></math>, respectively. <math id="S2.SS1.p1.8.m5.1" class="ltx_Math" alttext="\mathcal{D}_{c}^{\mathcal{T}_{i}}" display="inline"><semantics id="S2.SS1.p1.8.m5.1a"><msubsup id="S2.SS1.p1.8.m5.1.1" xref="S2.SS1.p1.8.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m5.1.1.2.2" xref="S2.SS1.p1.8.m5.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.8.m5.1.1.2.3" xref="S2.SS1.p1.8.m5.1.1.2.3.cmml">c</mi><msub id="S2.SS1.p1.8.m5.1.1.3" xref="S2.SS1.p1.8.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m5.1.1.3.2" xref="S2.SS1.p1.8.m5.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS1.p1.8.m5.1.1.3.3" xref="S2.SS1.p1.8.m5.1.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m5.1b"><apply id="S2.SS1.p1.8.m5.1.1.cmml" xref="S2.SS1.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.1.1.1.cmml" xref="S2.SS1.p1.8.m5.1.1">superscript</csymbol><apply id="S2.SS1.p1.8.m5.1.1.2.cmml" xref="S2.SS1.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.1.1.2.1.cmml" xref="S2.SS1.p1.8.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m5.1.1.2.2.cmml" xref="S2.SS1.p1.8.m5.1.1.2.2">𝒟</ci><ci id="S2.SS1.p1.8.m5.1.1.2.3.cmml" xref="S2.SS1.p1.8.m5.1.1.2.3">𝑐</ci></apply><apply id="S2.SS1.p1.8.m5.1.1.3.cmml" xref="S2.SS1.p1.8.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m5.1.1.3.1.cmml" xref="S2.SS1.p1.8.m5.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.8.m5.1.1.3.2.cmml" xref="S2.SS1.p1.8.m5.1.1.3.2">𝒯</ci><ci id="S2.SS1.p1.8.m5.1.1.3.3.cmml" xref="S2.SS1.p1.8.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m5.1c">\mathcal{D}_{c}^{\mathcal{T}_{i}}</annotation></semantics></math> is the training dataset of <math id="S2.SS1.p1.9.m6.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S2.SS1.p1.9.m6.1a"><msub id="S2.SS1.p1.9.m6.1.1" xref="S2.SS1.p1.9.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m6.1.1.2" xref="S2.SS1.p1.9.m6.1.1.2.cmml">𝒯</mi><mi id="S2.SS1.p1.9.m6.1.1.3" xref="S2.SS1.p1.9.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m6.1b"><apply id="S2.SS1.p1.9.m6.1.1.cmml" xref="S2.SS1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m6.1.1.1.cmml" xref="S2.SS1.p1.9.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m6.1.1.2.cmml" xref="S2.SS1.p1.9.m6.1.1.2">𝒯</ci><ci id="S2.SS1.p1.9.m6.1.1.3.cmml" xref="S2.SS1.p1.9.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m6.1c">\mathcal{T}_{i}</annotation></semantics></math> on client <math id="S2.SS1.p1.10.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS1.p1.10.m7.1a"><mi id="S2.SS1.p1.10.m7.1.1" xref="S2.SS1.p1.10.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m7.1b"><ci id="S2.SS1.p1.10.m7.1.1.cmml" xref="S2.SS1.p1.10.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m7.1c">c</annotation></semantics></math>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.2" class="ltx_p">This objective function uses data from all existing tasks, making it a rehearsal-based FCL problem.
This work focuses on rehearsal-free FCL. Specifically, each client can only observe the training data of the current task, i.e., when training on task <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{n}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">𝒯</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝒯</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{T}_{n}</annotation></semantics></math>, training data of all previous tasks are unseen.
However, due to the unavailability of historical task data, training the current task can overwrite previous task information of the model <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\mathbf{w}</annotation></semantics></math> in (<a href="#S2.E1" title="Equation 1 ‣ 2.1 Problem Statement ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), deteriorating the forgetting issues in CL. Thus, existing rehearsal-free FCL approaches cannot achieve comparable performance to rehearsal-based approaches <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Design Principle</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.2" class="ltx_p">In this work, we aim to accommodate the forgetting issue for rehearsal-free FCL. Inspired by the success of the prompt-based rehearsal-free CL that achieves SOTA performance, we intend to implement prompting techniques in our design. Existing prompt-based CL <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>; Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib28" title="" class="ltx_ref">a</a>)</cite> use insertable embeddings, called prompts <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">p</annotation></semantics></math>, to condition a frozen pre-trained model <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\theta</annotation></semantics></math> to perform incremental tasks. Due to the small size of prompt parameters, a task-specific prompt is created and stored for each task to avoid overwriting previous knowledge. Here, we refer readers to Appendix <a href="#A1" title="Appendix A Preliminaries for Prompt-based Continual Learning ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> for more details. While successful, the above prompt-based CL research is designed for centralized datasets, which becomes ineffective in FL settings.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">The main challenge of implementing prompting techniques in FCL is the inherent heterogeneity of distributed clients. On the one hand, the data heterogeneity among clients leads to biased local updates and slow convergence. On the other hand, the sequential tasks may appear asynchronously over clients, further delaying convergence. Due to the small size of learnable parameters in prompt learning, it is essential to improve their learning capacity by facilitating knowledge transfer between tasks and clients. Therefore, we propose Fed-CPrompt, an innovative prompt-based rehearsal-free FCL framework. As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Fed-CPrompt introduces two key components, asynchronous prompt learning and contrastive and continual loss, to address the aforementioned task arrival and data heterogeneity concerns. In the following, we first introduce these two components and then present the overall training of Fed-CPrompt.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Asynchronous Prompt Learning</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.17" class="ltx_p">We adopt the existing prompt-based CL approach (CODA-P <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite>) on clients to learn incremental tasks based on their local data. In CODA-P, the prompt for the current task is re-weighted based on previous task information to refine task-specific representation via attention mechanisms (see Appendix <a href="#A1" title="Appendix A Preliminaries for Prompt-based Continual Learning ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>). In Fed-CPrompt, when client <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">c</mi><mo id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><in id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1"></in><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑐</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">c\in\mathcal{C}</annotation></semantics></math> learns task <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝒯</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\mathcal{T}_{m}</annotation></semantics></math>, <math id="S2.SS3.p1.3.m3.2" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}_{c}=\sum_{i\in[1,m-1]}\alpha^{\mathcal{T}_{i}}_{s}P^{\mathcal{T}_{i}}_{s}+\alpha^{\mathcal{T}_{m}}_{c}P^{\mathcal{T}_{m}}_{c}" display="inline"><semantics id="S2.SS3.p1.3.m3.2a"><mrow id="S2.SS3.p1.3.m3.2.3" xref="S2.SS3.p1.3.m3.2.3.cmml"><msubsup id="S2.SS3.p1.3.m3.2.3.2" xref="S2.SS3.p1.3.m3.2.3.2.cmml"><mi id="S2.SS3.p1.3.m3.2.3.2.2.2" xref="S2.SS3.p1.3.m3.2.3.2.2.2.cmml">p</mi><mi id="S2.SS3.p1.3.m3.2.3.2.3" xref="S2.SS3.p1.3.m3.2.3.2.3.cmml">c</mi><msub id="S2.SS3.p1.3.m3.2.3.2.2.3" xref="S2.SS3.p1.3.m3.2.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.2.2.3.2" xref="S2.SS3.p1.3.m3.2.3.2.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.3.m3.2.3.2.2.3.3" xref="S2.SS3.p1.3.m3.2.3.2.2.3.3.cmml">m</mi></msub></msubsup><mo rspace="0.111em" id="S2.SS3.p1.3.m3.2.3.1" xref="S2.SS3.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S2.SS3.p1.3.m3.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.cmml"><mrow id="S2.SS3.p1.3.m3.2.3.3.2" xref="S2.SS3.p1.3.m3.2.3.3.2.cmml"><msub id="S2.SS3.p1.3.m3.2.3.3.2.1" xref="S2.SS3.p1.3.m3.2.3.3.2.1.cmml"><mo id="S2.SS3.p1.3.m3.2.3.3.2.1.2" xref="S2.SS3.p1.3.m3.2.3.3.2.1.2.cmml">∑</mo><mrow id="S2.SS3.p1.3.m3.2.2.2" xref="S2.SS3.p1.3.m3.2.2.2.cmml"><mi id="S2.SS3.p1.3.m3.2.2.2.4" xref="S2.SS3.p1.3.m3.2.2.2.4.cmml">i</mi><mo id="S2.SS3.p1.3.m3.2.2.2.3" xref="S2.SS3.p1.3.m3.2.2.2.3.cmml">∈</mo><mrow id="S2.SS3.p1.3.m3.2.2.2.2.1" xref="S2.SS3.p1.3.m3.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m3.2.2.2.2.1.2" xref="S2.SS3.p1.3.m3.2.2.2.2.2.cmml">[</mo><mn id="S2.SS3.p1.3.m3.1.1.1.1" xref="S2.SS3.p1.3.m3.1.1.1.1.cmml">1</mn><mo id="S2.SS3.p1.3.m3.2.2.2.2.1.3" xref="S2.SS3.p1.3.m3.2.2.2.2.2.cmml">,</mo><mrow id="S2.SS3.p1.3.m3.2.2.2.2.1.1" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.cmml"><mi id="S2.SS3.p1.3.m3.2.2.2.2.1.1.2" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.2.cmml">m</mi><mo id="S2.SS3.p1.3.m3.2.2.2.2.1.1.1" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.1.cmml">−</mo><mn id="S2.SS3.p1.3.m3.2.2.2.2.1.1.3" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS3.p1.3.m3.2.2.2.2.1.4" xref="S2.SS3.p1.3.m3.2.2.2.2.2.cmml">]</mo></mrow></mrow></msub><mrow id="S2.SS3.p1.3.m3.2.3.3.2.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.cmml"><msubsup id="S2.SS3.p1.3.m3.2.3.3.2.2.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.cmml"><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.2.cmml">α</mi><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.2.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.3.cmml">s</mi><msub id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m3.2.3.3.2.2.1" xref="S2.SS3.p1.3.m3.2.3.3.2.2.1.cmml">​</mo><msubsup id="S2.SS3.p1.3.m3.2.3.3.2.2.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.cmml"><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.2.cmml">P</mi><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.3.cmml">s</mi><msub id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.2" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.3.cmml">i</mi></msub></msubsup></mrow></mrow><mo id="S2.SS3.p1.3.m3.2.3.3.1" xref="S2.SS3.p1.3.m3.2.3.3.1.cmml">+</mo><mrow id="S2.SS3.p1.3.m3.2.3.3.3" xref="S2.SS3.p1.3.m3.2.3.3.3.cmml"><msubsup id="S2.SS3.p1.3.m3.2.3.3.3.2" xref="S2.SS3.p1.3.m3.2.3.3.3.2.cmml"><mi id="S2.SS3.p1.3.m3.2.3.3.3.2.2.2" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.2.cmml">α</mi><mi id="S2.SS3.p1.3.m3.2.3.3.3.2.3" xref="S2.SS3.p1.3.m3.2.3.3.3.2.3.cmml">c</mi><msub id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.2" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.3.cmml">m</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m3.2.3.3.3.1" xref="S2.SS3.p1.3.m3.2.3.3.3.1.cmml">​</mo><msubsup id="S2.SS3.p1.3.m3.2.3.3.3.3" xref="S2.SS3.p1.3.m3.2.3.3.3.3.cmml"><mi id="S2.SS3.p1.3.m3.2.3.3.3.3.2.2" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.2.cmml">P</mi><mi id="S2.SS3.p1.3.m3.2.3.3.3.3.3" xref="S2.SS3.p1.3.m3.2.3.3.3.3.3.cmml">c</mi><msub id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.2" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.3" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.3.cmml">m</mi></msub></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.2b"><apply id="S2.SS3.p1.3.m3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3"><eq id="S2.SS3.p1.3.m3.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.1"></eq><apply id="S2.SS3.p1.3.m3.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.2">subscript</csymbol><apply id="S2.SS3.p1.3.m3.2.3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.2.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.2">superscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.2.2.2">𝑝</ci><apply id="S2.SS3.p1.3.m3.2.3.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.2.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.2.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.2.2.3.2">𝒯</ci><ci id="S2.SS3.p1.3.m3.2.3.2.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.3.m3.2.3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.2.3">𝑐</ci></apply><apply id="S2.SS3.p1.3.m3.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3"><plus id="S2.SS3.p1.3.m3.2.3.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.1"></plus><apply id="S2.SS3.p1.3.m3.2.3.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2"><apply id="S2.SS3.p1.3.m3.2.3.3.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.1.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.1">subscript</csymbol><sum id="S2.SS3.p1.3.m3.2.3.3.2.1.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.1.2"></sum><apply id="S2.SS3.p1.3.m3.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.2.2"><in id="S2.SS3.p1.3.m3.2.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.2.2.3"></in><ci id="S2.SS3.p1.3.m3.2.2.2.4.cmml" xref="S2.SS3.p1.3.m3.2.2.2.4">𝑖</ci><interval closure="closed" id="S2.SS3.p1.3.m3.2.2.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.2.2.2.1"><cn type="integer" id="S2.SS3.p1.3.m3.1.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1.1.1">1</cn><apply id="S2.SS3.p1.3.m3.2.2.2.2.1.1.cmml" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1"><minus id="S2.SS3.p1.3.m3.2.2.2.2.1.1.1.cmml" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.1"></minus><ci id="S2.SS3.p1.3.m3.2.2.2.2.1.1.2.cmml" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.2">𝑚</ci><cn type="integer" id="S2.SS3.p1.3.m3.2.2.2.2.1.1.3.cmml" xref="S2.SS3.p1.3.m3.2.2.2.2.1.1.3">1</cn></apply></interval></apply></apply><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2"><times id="S2.SS3.p1.3.m3.2.3.3.2.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.1"></times><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2">superscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.2">𝛼</ci><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.2">𝒯</ci><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.2.3">𝑠</ci></apply><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3">subscript</csymbol><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3">superscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.2">𝑃</ci><apply id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3">subscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.2">𝒯</ci><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S2.SS3.p1.3.m3.2.3.3.2.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2.2.3.3">𝑠</ci></apply></apply></apply><apply id="S2.SS3.p1.3.m3.2.3.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3"><times id="S2.SS3.p1.3.m3.2.3.3.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.1"></times><apply id="S2.SS3.p1.3.m3.2.3.3.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2">subscript</csymbol><apply id="S2.SS3.p1.3.m3.2.3.3.3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.2.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2">superscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.3.2.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.2">𝛼</ci><apply id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.2">𝒯</ci><ci id="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.3.m3.2.3.3.3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.2.3">𝑐</ci></apply><apply id="S2.SS3.p1.3.m3.2.3.3.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3">subscript</csymbol><apply id="S2.SS3.p1.3.m3.2.3.3.3.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.3.2.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3">superscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.3.3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.2">𝑃</ci><apply id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3">subscript</csymbol><ci id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.2">𝒯</ci><ci id="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.3.m3.2.3.3.3.3.3.cmml" xref="S2.SS3.p1.3.m3.2.3.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.2c">{p}^{\mathcal{T}_{m}}_{c}=\sum_{i\in[1,m-1]}\alpha^{\mathcal{T}_{i}}_{s}P^{\mathcal{T}_{i}}_{s}+\alpha^{\mathcal{T}_{m}}_{c}P^{\mathcal{T}_{m}}_{c}</annotation></semantics></math>, where <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="\alpha^{\mathcal{T}_{i}}_{b}" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><msubsup id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.2.2" xref="S2.SS3.p1.4.m4.1.1.2.2.cmml">α</mi><mi id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml">b</mi><msub id="S2.SS3.p1.4.m4.1.1.2.3" xref="S2.SS3.p1.4.m4.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.4.m4.1.1.2.3.2" xref="S2.SS3.p1.4.m4.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.4.m4.1.1.2.3.3" xref="S2.SS3.p1.4.m4.1.1.2.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.2.1.cmml" xref="S2.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2.2">𝛼</ci><apply id="S2.SS3.p1.4.m4.1.1.2.3.cmml" xref="S2.SS3.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p1.4.m4.1.1.2.3.3.cmml" xref="S2.SS3.p1.4.m4.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\alpha^{\mathcal{T}_{i}}_{b}</annotation></semantics></math> and <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="P^{\mathcal{T}_{i}}_{b}" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><msubsup id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml"><mi id="S2.SS3.p1.5.m5.1.1.2.2" xref="S2.SS3.p1.5.m5.1.1.2.2.cmml">P</mi><mi id="S2.SS3.p1.5.m5.1.1.3" xref="S2.SS3.p1.5.m5.1.1.3.cmml">b</mi><msub id="S2.SS3.p1.5.m5.1.1.2.3" xref="S2.SS3.p1.5.m5.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.5.m5.1.1.2.3.2" xref="S2.SS3.p1.5.m5.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.5.m5.1.1.2.3.3" xref="S2.SS3.p1.5.m5.1.1.2.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">subscript</csymbol><apply id="S2.SS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.2.1.cmml" xref="S2.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.p1.5.m5.1.1.2.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2.2">𝑃</ci><apply id="S2.SS3.p1.5.m5.1.1.2.3.cmml" xref="S2.SS3.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.2.3.1.cmml" xref="S2.SS3.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p1.5.m5.1.1.2.3.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p1.5.m5.1.1.2.3.3.cmml" xref="S2.SS3.p1.5.m5.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S2.SS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">P^{\mathcal{T}_{i}}_{b}</annotation></semantics></math> are the <math id="S2.SS3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S2.SS3.p1.6.m6.1a"><msub id="S2.SS3.p1.6.m6.1.1" xref="S2.SS3.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.6.m6.1.1.2" xref="S2.SS3.p1.6.m6.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p1.6.m6.1.1.3" xref="S2.SS3.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><apply id="S2.SS3.p1.6.m6.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p1.6.m6.1.1.2.cmml" xref="S2.SS3.p1.6.m6.1.1.2">𝒯</ci><ci id="S2.SS3.p1.6.m6.1.1.3.cmml" xref="S2.SS3.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">\mathcal{T}_{i}</annotation></semantics></math>-specific attention and prompt at the server (<math id="S2.SS3.p1.7.m7.1" class="ltx_Math" alttext="b=s" display="inline"><semantics id="S2.SS3.p1.7.m7.1a"><mrow id="S2.SS3.p1.7.m7.1.1" xref="S2.SS3.p1.7.m7.1.1.cmml"><mi id="S2.SS3.p1.7.m7.1.1.2" xref="S2.SS3.p1.7.m7.1.1.2.cmml">b</mi><mo id="S2.SS3.p1.7.m7.1.1.1" xref="S2.SS3.p1.7.m7.1.1.1.cmml">=</mo><mi id="S2.SS3.p1.7.m7.1.1.3" xref="S2.SS3.p1.7.m7.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m7.1b"><apply id="S2.SS3.p1.7.m7.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1"><eq id="S2.SS3.p1.7.m7.1.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1.1"></eq><ci id="S2.SS3.p1.7.m7.1.1.2.cmml" xref="S2.SS3.p1.7.m7.1.1.2">𝑏</ci><ci id="S2.SS3.p1.7.m7.1.1.3.cmml" xref="S2.SS3.p1.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m7.1c">b=s</annotation></semantics></math>) and client <math id="S2.SS3.p1.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p1.8.m8.1a"><mi id="S2.SS3.p1.8.m8.1.1" xref="S2.SS3.p1.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m8.1b"><ci id="S2.SS3.p1.8.m8.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m8.1c">c</annotation></semantics></math> (<math id="S2.SS3.p1.9.m9.1" class="ltx_Math" alttext="b=c" display="inline"><semantics id="S2.SS3.p1.9.m9.1a"><mrow id="S2.SS3.p1.9.m9.1.1" xref="S2.SS3.p1.9.m9.1.1.cmml"><mi id="S2.SS3.p1.9.m9.1.1.2" xref="S2.SS3.p1.9.m9.1.1.2.cmml">b</mi><mo id="S2.SS3.p1.9.m9.1.1.1" xref="S2.SS3.p1.9.m9.1.1.1.cmml">=</mo><mi id="S2.SS3.p1.9.m9.1.1.3" xref="S2.SS3.p1.9.m9.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m9.1b"><apply id="S2.SS3.p1.9.m9.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1"><eq id="S2.SS3.p1.9.m9.1.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1.1"></eq><ci id="S2.SS3.p1.9.m9.1.1.2.cmml" xref="S2.SS3.p1.9.m9.1.1.2">𝑏</ci><ci id="S2.SS3.p1.9.m9.1.1.3.cmml" xref="S2.SS3.p1.9.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m9.1c">b=c</annotation></semantics></math>), respectively. The updated client-side <math id="S2.SS3.p1.10.m10.1" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}_{c}" display="inline"><semantics id="S2.SS3.p1.10.m10.1a"><msubsup id="S2.SS3.p1.10.m10.1.1" xref="S2.SS3.p1.10.m10.1.1.cmml"><mi id="S2.SS3.p1.10.m10.1.1.2.2" xref="S2.SS3.p1.10.m10.1.1.2.2.cmml">p</mi><mi id="S2.SS3.p1.10.m10.1.1.3" xref="S2.SS3.p1.10.m10.1.1.3.cmml">c</mi><msub id="S2.SS3.p1.10.m10.1.1.2.3" xref="S2.SS3.p1.10.m10.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.10.m10.1.1.2.3.2" xref="S2.SS3.p1.10.m10.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.10.m10.1.1.2.3.3" xref="S2.SS3.p1.10.m10.1.1.2.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m10.1b"><apply id="S2.SS3.p1.10.m10.1.1.cmml" xref="S2.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.1.1.cmml" xref="S2.SS3.p1.10.m10.1.1">subscript</csymbol><apply id="S2.SS3.p1.10.m10.1.1.2.cmml" xref="S2.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.1.2.1.cmml" xref="S2.SS3.p1.10.m10.1.1">superscript</csymbol><ci id="S2.SS3.p1.10.m10.1.1.2.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2.2">𝑝</ci><apply id="S2.SS3.p1.10.m10.1.1.2.3.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.1.2.3.1.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p1.10.m10.1.1.2.3.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p1.10.m10.1.1.2.3.3.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.10.m10.1.1.3.cmml" xref="S2.SS3.p1.10.m10.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.10.m10.1c">{p}^{\mathcal{T}_{m}}_{c}</annotation></semantics></math> will be uploaded to the server and aggregated based on classical FL <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> to obtain server-side prompt <math id="S2.SS3.p1.11.m11.1" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}_{s}" display="inline"><semantics id="S2.SS3.p1.11.m11.1a"><msubsup id="S2.SS3.p1.11.m11.1.1" xref="S2.SS3.p1.11.m11.1.1.cmml"><mi id="S2.SS3.p1.11.m11.1.1.2.2" xref="S2.SS3.p1.11.m11.1.1.2.2.cmml">p</mi><mi id="S2.SS3.p1.11.m11.1.1.3" xref="S2.SS3.p1.11.m11.1.1.3.cmml">s</mi><msub id="S2.SS3.p1.11.m11.1.1.2.3" xref="S2.SS3.p1.11.m11.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.11.m11.1.1.2.3.2" xref="S2.SS3.p1.11.m11.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p1.11.m11.1.1.2.3.3" xref="S2.SS3.p1.11.m11.1.1.2.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m11.1b"><apply id="S2.SS3.p1.11.m11.1.1.cmml" xref="S2.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m11.1.1.1.cmml" xref="S2.SS3.p1.11.m11.1.1">subscript</csymbol><apply id="S2.SS3.p1.11.m11.1.1.2.cmml" xref="S2.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m11.1.1.2.1.cmml" xref="S2.SS3.p1.11.m11.1.1">superscript</csymbol><ci id="S2.SS3.p1.11.m11.1.1.2.2.cmml" xref="S2.SS3.p1.11.m11.1.1.2.2">𝑝</ci><apply id="S2.SS3.p1.11.m11.1.1.2.3.cmml" xref="S2.SS3.p1.11.m11.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m11.1.1.2.3.1.cmml" xref="S2.SS3.p1.11.m11.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p1.11.m11.1.1.2.3.2.cmml" xref="S2.SS3.p1.11.m11.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p1.11.m11.1.1.2.3.3.cmml" xref="S2.SS3.p1.11.m11.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.11.m11.1.1.3.cmml" xref="S2.SS3.p1.11.m11.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.11.m11.1c">{p}^{\mathcal{T}_{m}}_{s}</annotation></semantics></math>. However, such naive aggregation becomes inefficient in asynchronous task arrival. When client <math id="S2.SS3.p1.12.m12.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p1.12.m12.1a"><mi id="S2.SS3.p1.12.m12.1.1" xref="S2.SS3.p1.12.m12.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.12.m12.1b"><ci id="S2.SS3.p1.12.m12.1.1.cmml" xref="S2.SS3.p1.12.m12.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.12.m12.1c">c</annotation></semantics></math> is training task <math id="S2.SS3.p1.13.m13.1" class="ltx_Math" alttext="{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS3.p1.13.m13.1a"><msub id="S2.SS3.p1.13.m13.1.1" xref="S2.SS3.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.13.m13.1.1.2" xref="S2.SS3.p1.13.m13.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p1.13.m13.1.1.3" xref="S2.SS3.p1.13.m13.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.13.m13.1b"><apply id="S2.SS3.p1.13.m13.1.1.cmml" xref="S2.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m13.1.1.1.cmml" xref="S2.SS3.p1.13.m13.1.1">subscript</csymbol><ci id="S2.SS3.p1.13.m13.1.1.2.cmml" xref="S2.SS3.p1.13.m13.1.1.2">𝒯</ci><ci id="S2.SS3.p1.13.m13.1.1.3.cmml" xref="S2.SS3.p1.13.m13.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.13.m13.1c">{\mathcal{T}_{m}}</annotation></semantics></math>, the latest task observed by other clients might be task <math id="S2.SS3.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{T}_{n}" display="inline"><semantics id="S2.SS3.p1.14.m14.1a"><msub id="S2.SS3.p1.14.m14.1.1" xref="S2.SS3.p1.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.14.m14.1.1.2" xref="S2.SS3.p1.14.m14.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p1.14.m14.1.1.3" xref="S2.SS3.p1.14.m14.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.14.m14.1b"><apply id="S2.SS3.p1.14.m14.1.1.cmml" xref="S2.SS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.14.m14.1.1.1.cmml" xref="S2.SS3.p1.14.m14.1.1">subscript</csymbol><ci id="S2.SS3.p1.14.m14.1.1.2.cmml" xref="S2.SS3.p1.14.m14.1.1.2">𝒯</ci><ci id="S2.SS3.p1.14.m14.1.1.3.cmml" xref="S2.SS3.p1.14.m14.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.14.m14.1c">\mathcal{T}_{n}</annotation></semantics></math> (<math id="S2.SS3.p1.15.m15.1" class="ltx_Math" alttext="m&lt;n" display="inline"><semantics id="S2.SS3.p1.15.m15.1a"><mrow id="S2.SS3.p1.15.m15.1.1" xref="S2.SS3.p1.15.m15.1.1.cmml"><mi id="S2.SS3.p1.15.m15.1.1.2" xref="S2.SS3.p1.15.m15.1.1.2.cmml">m</mi><mo id="S2.SS3.p1.15.m15.1.1.1" xref="S2.SS3.p1.15.m15.1.1.1.cmml">&lt;</mo><mi id="S2.SS3.p1.15.m15.1.1.3" xref="S2.SS3.p1.15.m15.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.15.m15.1b"><apply id="S2.SS3.p1.15.m15.1.1.cmml" xref="S2.SS3.p1.15.m15.1.1"><lt id="S2.SS3.p1.15.m15.1.1.1.cmml" xref="S2.SS3.p1.15.m15.1.1.1"></lt><ci id="S2.SS3.p1.15.m15.1.1.2.cmml" xref="S2.SS3.p1.15.m15.1.1.2">𝑚</ci><ci id="S2.SS3.p1.15.m15.1.1.3.cmml" xref="S2.SS3.p1.15.m15.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.15.m15.1c">m&lt;n</annotation></semantics></math>), and <math id="S2.SS3.p1.16.m16.1" class="ltx_Math" alttext="\mathcal{T}_{n}" display="inline"><semantics id="S2.SS3.p1.16.m16.1a"><msub id="S2.SS3.p1.16.m16.1.1" xref="S2.SS3.p1.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.16.m16.1.1.2" xref="S2.SS3.p1.16.m16.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p1.16.m16.1.1.3" xref="S2.SS3.p1.16.m16.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.16.m16.1b"><apply id="S2.SS3.p1.16.m16.1.1.cmml" xref="S2.SS3.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.16.m16.1.1.1.cmml" xref="S2.SS3.p1.16.m16.1.1">subscript</csymbol><ci id="S2.SS3.p1.16.m16.1.1.2.cmml" xref="S2.SS3.p1.16.m16.1.1.2">𝒯</ci><ci id="S2.SS3.p1.16.m16.1.1.3.cmml" xref="S2.SS3.p1.16.m16.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.16.m16.1c">\mathcal{T}_{n}</annotation></semantics></math> will be observed by client <math id="S2.SS3.p1.17.m17.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p1.17.m17.1a"><mi id="S2.SS3.p1.17.m17.1.1" xref="S2.SS3.p1.17.m17.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.17.m17.1b"><ci id="S2.SS3.p1.17.m17.1.1.cmml" xref="S2.SS3.p1.17.m17.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.17.m17.1c">c</annotation></semantics></math> later. Hence, to handle this condition, Fed-CPrompt introduces asynchronous prompt learning.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.4" class="ltx_p">Instead of waiting for updated prompts of the current task <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{n}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝒯</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\mathcal{T}_{n}</annotation></semantics></math> from all clients before aggregation, we allow task-specific prompt aggregation in parallel. In this way, the previously learned prompt at the server <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="{p}_{s}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><msubsup id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2.2" xref="S2.SS3.p2.2.m2.1.1.2.2.cmml">p</mi><mi id="S2.SS3.p2.2.m2.1.1.2.3" xref="S2.SS3.p2.2.m2.1.1.2.3.cmml">s</mi><msub id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.2.m2.1.1.3.2" xref="S2.SS3.p2.2.m2.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS3.p2.2.m2.1.1.3.3" xref="S2.SS3.p2.2.m2.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">superscript</csymbol><apply id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.2.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2.2">𝑝</ci><ci id="S2.SS3.p2.2.m2.1.1.2.3.cmml" xref="S2.SS3.p2.2.m2.1.1.2.3">𝑠</ci></apply><apply id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.3.1.cmml" xref="S2.SS3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.3.2.cmml" xref="S2.SS3.p2.2.m2.1.1.3.2">𝒯</ci><ci id="S2.SS3.p2.2.m2.1.1.3.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">{p}_{s}^{\mathcal{T}_{m}}</annotation></semantics></math> can be refined by <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}_{c}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><msubsup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.2.2.cmml">p</mi><mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">c</mi><msub id="S2.SS3.p2.3.m3.1.1.2.3" xref="S2.SS3.p2.3.m3.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.3.m3.1.1.2.3.2" xref="S2.SS3.p2.3.m3.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p2.3.m3.1.1.2.3.3" xref="S2.SS3.p2.3.m3.1.1.2.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.2">𝑝</ci><apply id="S2.SS3.p2.3.m3.1.1.2.3.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.2.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p2.3.m3.1.1.2.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">{p}^{\mathcal{T}_{m}}_{c}</annotation></semantics></math>. Moreover, taking advantage of the task arrival heterogeneity, the training of <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}_{c}" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><msubsup id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2.2" xref="S2.SS3.p2.4.m4.1.1.2.2.cmml">p</mi><mi id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">c</mi><msub id="S2.SS3.p2.4.m4.1.1.2.3" xref="S2.SS3.p2.4.m4.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.4.m4.1.1.2.3.2" xref="S2.SS3.p2.4.m4.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.SS3.p2.4.m4.1.1.2.3.3" xref="S2.SS3.p2.4.m4.1.1.2.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.2">𝑝</ci><apply id="S2.SS3.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.2">𝒯</ci><ci id="S2.SS3.p2.4.m4.1.1.2.3.3.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">{p}^{\mathcal{T}_{m}}_{c}</annotation></semantics></math> becomes</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="p_{c}^{\mathcal{T}_{m}}=\sum_{i=1}^{m-1}\alpha^{\mathcal{T}_{i}}_{s}P^{\mathcal{T}_{i}}_{s}+\alpha_{c}^{\mathcal{T}_{m}}P_{c}^{\mathcal{T}_{m}}+\sum_{j={m+1}}^{n}\alpha^{\mathcal{T}_{j}}_{s}P^{\mathcal{T}_{j}}_{s}," display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S2.E2.m1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml">c</mi><msub id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.2.3.2" xref="S2.E2.m1.1.1.1.1.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.2.3.3.cmml">m</mi></msub></msubsup><mo rspace="0.111em" id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><munderover id="S2.E2.m1.1.1.1.1.3.2.1" xref="S2.E2.m1.1.1.1.1.3.2.1.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.1.1.3.2.1.2.2" xref="S2.E2.m1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.3.2.1.2.3" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.1.2.3.2" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.3.2.1.2.3.1" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.1.1.3.2.1.2.3.3" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.E2.m1.1.1.1.1.3.2.1.3" xref="S2.E2.m1.1.1.1.1.3.2.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.1.3.2.cmml">m</mi><mo id="S2.E2.m1.1.1.1.1.3.2.1.3.1" xref="S2.E2.m1.1.1.1.1.3.2.1.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.3.2.1.3.3" xref="S2.E2.m1.1.1.1.1.3.2.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml"><msubsup id="S2.E2.m1.1.1.1.1.3.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.2.cmml">α</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.2.3.cmml">s</mi><msub id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.3" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.3.2.2.1" xref="S2.E2.m1.1.1.1.1.3.2.2.1.cmml">​</mo><msubsup id="S2.E2.m1.1.1.1.1.3.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.2.cmml">P</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.3.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.3.cmml">s</mi><msub id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.2" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.3.cmml">i</mi></msub></msubsup></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><msubsup id="S2.E2.m1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2.2.2" xref="S2.E2.m1.1.1.1.1.3.3.2.2.2.cmml">α</mi><mi id="S2.E2.m1.1.1.1.1.3.3.2.2.3" xref="S2.E2.m1.1.1.1.1.3.3.2.2.3.cmml">c</mi><msub id="S2.E2.m1.1.1.1.1.3.3.2.3" xref="S2.E2.m1.1.1.1.1.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.3.2.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.3.2.3.3" xref="S2.E2.m1.1.1.1.1.3.3.2.3.3.cmml">m</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.3.2.2" xref="S2.E2.m1.1.1.1.1.3.3.3.2.2.cmml">P</mi><mi id="S2.E2.m1.1.1.1.1.3.3.3.2.3" xref="S2.E2.m1.1.1.1.1.3.3.3.2.3.cmml">c</mi><msub id="S2.E2.m1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.3.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.3.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.3.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.3.3.cmml">m</mi></msub></msubsup></mrow><mo rspace="0.055em" id="S2.E2.m1.1.1.1.1.3.1a" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.3.4" xref="S2.E2.m1.1.1.1.1.3.4.cmml"><munderover id="S2.E2.m1.1.1.1.1.3.4.1" xref="S2.E2.m1.1.1.1.1.3.4.1.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.1.1.3.4.1.2.2" xref="S2.E2.m1.1.1.1.1.3.4.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.3.4.1.2.3" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.4.1.2.3.2" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.2.cmml">j</mi><mo id="S2.E2.m1.1.1.1.1.3.4.1.2.3.1" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.2" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.2.cmml">m</mi><mo id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.1" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.1.cmml">+</mo><mn id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.3" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.E2.m1.1.1.1.1.3.4.1.3" xref="S2.E2.m1.1.1.1.1.3.4.1.3.cmml">n</mi></munderover><mrow id="S2.E2.m1.1.1.1.1.3.4.2" xref="S2.E2.m1.1.1.1.1.3.4.2.cmml"><msubsup id="S2.E2.m1.1.1.1.1.3.4.2.2" xref="S2.E2.m1.1.1.1.1.3.4.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.4.2.2.2.2" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.2.cmml">α</mi><mi id="S2.E2.m1.1.1.1.1.3.4.2.2.3" xref="S2.E2.m1.1.1.1.1.3.4.2.2.3.cmml">s</mi><msub id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.2" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.3" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.3.cmml">j</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.3.4.2.1" xref="S2.E2.m1.1.1.1.1.3.4.2.1.cmml">​</mo><msubsup id="S2.E2.m1.1.1.1.1.3.4.2.3" xref="S2.E2.m1.1.1.1.1.3.4.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.4.2.3.2.2" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.2.cmml">P</mi><mi id="S2.E2.m1.1.1.1.1.3.4.2.3.3" xref="S2.E2.m1.1.1.1.1.3.4.2.3.3.cmml">s</mi><msub id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.2" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.2.cmml">𝒯</mi><mi id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.3" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.3.cmml">j</mi></msub></msubsup></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"></eq><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2">𝑝</ci><ci id="S2.E2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3">𝑐</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><plus id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></plus><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><apply id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.2.1.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.3.2.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.3.2.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3"><eq id="S2.E2.m1.1.1.1.1.3.2.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.3.2.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.3.2.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.2.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.3"><minus id="S2.E2.m1.1.1.1.1.3.2.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.3.2.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.3.2">𝑚</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.3.2.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2"><times id="S2.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.1"></times><apply id="S2.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.2">𝛼</ci><apply id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.3">𝑠</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.2">𝑃</ci><apply id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.1"></times><apply id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2.2">𝛼</ci><ci id="S2.E2.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2.3">𝑐</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.3.3">𝑚</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.2.2">𝑃</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.2.3">𝑐</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.3">𝑚</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.4.cmml" xref="S2.E2.m1.1.1.1.1.3.4"><apply id="S2.E2.m1.1.1.1.1.3.4.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.4.1.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.3.4.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.3.4.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3"><eq id="S2.E2.m1.1.1.1.1.3.4.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.3.4.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.2">𝑗</ci><apply id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3"><plus id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.1"></plus><ci id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.2">𝑚</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.4.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1.3">𝑛</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.4.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2"><times id="S2.E2.m1.1.1.1.1.3.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.1"></times><apply id="S2.E2.m1.1.1.1.1.3.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.4.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.4.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.2">𝛼</ci><apply id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.4.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.2.3">𝑠</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.4.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.4.2.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.2">𝑃</ci><apply id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.2">𝒯</ci><ci id="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.4.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2.3.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">p_{c}^{\mathcal{T}_{m}}=\sum_{i=1}^{m-1}\alpha^{\mathcal{T}_{i}}_{s}P^{\mathcal{T}_{i}}_{s}+\alpha_{c}^{\mathcal{T}_{m}}P_{c}^{\mathcal{T}_{m}}+\sum_{j={m+1}}^{n}\alpha^{\mathcal{T}_{j}}_{s}P^{\mathcal{T}_{j}}_{s},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.8" class="ltx_p">where the first and the third terms are task knowledge from the server, which are frozen when training task <math id="S2.SS3.p2.5.m1.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS3.p2.5.m1.1a"><msub id="S2.SS3.p2.5.m1.1.1" xref="S2.SS3.p2.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.5.m1.1.1.2" xref="S2.SS3.p2.5.m1.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p2.5.m1.1.1.3" xref="S2.SS3.p2.5.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m1.1b"><apply id="S2.SS3.p2.5.m1.1.1.cmml" xref="S2.SS3.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m1.1.1.1.cmml" xref="S2.SS3.p2.5.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m1.1.1.2.cmml" xref="S2.SS3.p2.5.m1.1.1.2">𝒯</ci><ci id="S2.SS3.p2.5.m1.1.1.3.cmml" xref="S2.SS3.p2.5.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m1.1c">\mathcal{T}_{m}</annotation></semantics></math>. It should be mentioned that although the newest task for client <math id="S2.SS3.p2.6.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p2.6.m2.1a"><mi id="S2.SS3.p2.6.m2.1.1" xref="S2.SS3.p2.6.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m2.1b"><ci id="S2.SS3.p2.6.m2.1.1.cmml" xref="S2.SS3.p2.6.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m2.1c">c</annotation></semantics></math> is <math id="S2.SS3.p2.7.m3.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS3.p2.7.m3.1a"><msub id="S2.SS3.p2.7.m3.1.1" xref="S2.SS3.p2.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.7.m3.1.1.2" xref="S2.SS3.p2.7.m3.1.1.2.cmml">𝒯</mi><mi id="S2.SS3.p2.7.m3.1.1.3" xref="S2.SS3.p2.7.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m3.1b"><apply id="S2.SS3.p2.7.m3.1.1.cmml" xref="S2.SS3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m3.1.1.1.cmml" xref="S2.SS3.p2.7.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.7.m3.1.1.2.cmml" xref="S2.SS3.p2.7.m3.1.1.2">𝒯</ci><ci id="S2.SS3.p2.7.m3.1.1.3.cmml" xref="S2.SS3.p2.7.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m3.1c">\mathcal{T}_{m}</annotation></semantics></math>, the asynchronous task arrival in FCL allows client <math id="S2.SS3.p2.8.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p2.8.m4.1a"><mi id="S2.SS3.p2.8.m4.1.1" xref="S2.SS3.p2.8.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m4.1b"><ci id="S2.SS3.p2.8.m4.1.1.cmml" xref="S2.SS3.p2.8.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m4.1c">c</annotation></semantics></math> to leverage unseen task knowledge to navigate the local training. By incorporating past and future task representations, we increase the capacity of prompts to learn task-specific instructions.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>C2Loss: Contrastive and Continual Loss</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.3" class="ltx_p">To address the data heterogeneity issue while alleviating forgetting in FCL, we introduce a new loss function, contrastive and continual loss (C2Loss), to regularize local training on clients. The goal of C2Loss is mainly twofold. First, C2Loss accommodates disagreements between clients due to biased local training with heterogeneous data distribution. Second, C2Loss enforces distinct task-specific prompts construction, which facilitates CL to avoid the forgetting effect.
Specifically, when learning task <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><msub id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">𝒯</mi><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2">𝒯</ci><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\mathcal{T}_{m}</annotation></semantics></math> at communication round <math id="S2.SS4.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS4.p1.2.m2.1a"><mi id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">r</annotation></semantics></math>, we have the C2Loss on client <math id="S2.SS4.p1.3.m3.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="S2.SS4.p1.3.m3.1a"><mrow id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">c</mi><mo id="S2.SS4.p1.3.m3.1.1.1" xref="S2.SS4.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><in id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1.1"></in><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝑐</ci><ci id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">c\in\mathcal{C}</annotation></semantics></math> given by</p>
<table id="A5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{C2L}" display="inline"><semantics id="S2.E3.m1.1a"><msub id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.3.1" xref="S2.E3.m1.1.1.3.1.cmml">​</mo><mn id="S2.E3.m1.1.1.3.3" xref="S2.E3.m1.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.3.1a" xref="S2.E3.m1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.3.4" xref="S2.E3.m1.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2">ℒ</ci><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><times id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3.1"></times><ci id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2">𝐶</ci><cn type="integer" id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3">2</cn><ci id="S2.E3.m1.1.1.3.4.cmml" xref="S2.E3.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathcal{L}_{C2L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.2" class="ltx_math_unparsed" alttext="\displaystyle(P_{c}^{\mathcal{T}_{m}}(r))=\max\big{(}||P_{c}^{\mathcal{T}_{m}}(r)-P^{\mathcal{T}_{m}}_{s}(r-1)||_{2}" display="inline"><semantics id="S2.E3.m2.2a"><mrow id="S2.E3.m2.2b"><mrow id="S2.E3.m2.2.3"><mo stretchy="false" id="S2.E3.m2.2.3.1">(</mo><msubsup id="S2.E3.m2.2.3.2"><mi id="S2.E3.m2.2.3.2.2.2">P</mi><mi id="S2.E3.m2.2.3.2.2.3">c</mi><msub id="S2.E3.m2.2.3.2.3"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m2.2.3.2.3.2">𝒯</mi><mi id="S2.E3.m2.2.3.2.3.3">m</mi></msub></msubsup><mrow id="S2.E3.m2.2.3.3"><mo stretchy="false" id="S2.E3.m2.2.3.3.1">(</mo><mi id="S2.E3.m2.1.1">r</mi><mo stretchy="false" id="S2.E3.m2.2.3.3.2">)</mo></mrow><mo stretchy="false" id="S2.E3.m2.2.3.4">)</mo></mrow><mo id="S2.E3.m2.2.4">=</mo><mi id="S2.E3.m2.2.5">max</mi><mrow id="S2.E3.m2.2.6"><mo maxsize="120%" minsize="120%" id="S2.E3.m2.2.6.1">(</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E3.m2.2.6.2">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E3.m2.2.6.3">|</mo><msubsup id="S2.E3.m2.2.6.4"><mi id="S2.E3.m2.2.6.4.2.2">P</mi><mi id="S2.E3.m2.2.6.4.2.3">c</mi><msub id="S2.E3.m2.2.6.4.3"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m2.2.6.4.3.2">𝒯</mi><mi id="S2.E3.m2.2.6.4.3.3">m</mi></msub></msubsup><mrow id="S2.E3.m2.2.6.5"><mo stretchy="false" id="S2.E3.m2.2.6.5.1">(</mo><mi id="S2.E3.m2.2.2">r</mi><mo stretchy="false" id="S2.E3.m2.2.6.5.2">)</mo></mrow><mo id="S2.E3.m2.2.6.6">−</mo><msubsup id="S2.E3.m2.2.6.7"><mi id="S2.E3.m2.2.6.7.2.2">P</mi><mi id="S2.E3.m2.2.6.7.3">s</mi><msub id="S2.E3.m2.2.6.7.2.3"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m2.2.6.7.2.3.2">𝒯</mi><mi id="S2.E3.m2.2.6.7.2.3.3">m</mi></msub></msubsup><mrow id="S2.E3.m2.2.6.8"><mo stretchy="false" id="S2.E3.m2.2.6.8.1">(</mo><mi id="S2.E3.m2.2.6.8.2">r</mi><mo id="S2.E3.m2.2.6.8.3">−</mo><mn id="S2.E3.m2.2.6.8.4">1</mn><mo stretchy="false" id="S2.E3.m2.2.6.8.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E3.m2.2.6.9">|</mo><msub id="S2.E3.m2.2.6.10"><mo fence="false" stretchy="false" id="S2.E3.m2.2.6.10.2">|</mo><mn id="S2.E3.m2.2.6.10.3">2</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="S2.E3.m2.2c">\displaystyle(P_{c}^{\mathcal{T}_{m}}(r))=\max\big{(}||P_{c}^{\mathcal{T}_{m}}(r)-P^{\mathcal{T}_{m}}_{s}(r-1)||_{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle-\gamma" display="inline"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><mo id="S2.Ex1.m1.1.1a" xref="S2.Ex1.m1.1.1.cmml">−</mo><mi id="S2.Ex1.m1.1.1.2" xref="S2.Ex1.m1.1.1.2.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><minus id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1"></minus><ci id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.2">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle-\gamma</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.5" class="ltx_math_unparsed" alttext="\displaystyle\min\{||P_{c}^{\mathcal{T}_{m}}(r)-P^{\mathcal{T}_{i}}_{s}||_{2},i\in[1,n],i\neq m\}+\alpha,0\big{)}," display="inline"><semantics id="S2.Ex1.m2.5a"><mrow id="S2.Ex1.m2.5b"><mi id="S2.Ex1.m2.4.4">min</mi><mrow id="S2.Ex1.m2.5.6"><mo stretchy="false" id="S2.Ex1.m2.5.6.1">{</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.Ex1.m2.5.6.2">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.Ex1.m2.5.6.3">|</mo><msubsup id="S2.Ex1.m2.5.6.4"><mi id="S2.Ex1.m2.5.6.4.2.2">P</mi><mi id="S2.Ex1.m2.5.6.4.2.3">c</mi><msub id="S2.Ex1.m2.5.6.4.3"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m2.5.6.4.3.2">𝒯</mi><mi id="S2.Ex1.m2.5.6.4.3.3">m</mi></msub></msubsup><mrow id="S2.Ex1.m2.5.6.5"><mo stretchy="false" id="S2.Ex1.m2.5.6.5.1">(</mo><mi id="S2.Ex1.m2.1.1">r</mi><mo stretchy="false" id="S2.Ex1.m2.5.6.5.2">)</mo></mrow><mo id="S2.Ex1.m2.5.6.6">−</mo><msubsup id="S2.Ex1.m2.5.6.7"><mi id="S2.Ex1.m2.5.6.7.2.2">P</mi><mi id="S2.Ex1.m2.5.6.7.3">s</mi><msub id="S2.Ex1.m2.5.6.7.2.3"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m2.5.6.7.2.3.2">𝒯</mi><mi id="S2.Ex1.m2.5.6.7.2.3.3">i</mi></msub></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.Ex1.m2.5.6.8">|</mo><msub id="S2.Ex1.m2.5.6.9"><mo fence="false" rspace="0.167em" stretchy="false" id="S2.Ex1.m2.5.6.9.2">|</mo><mn id="S2.Ex1.m2.5.6.9.3">2</mn></msub><mo id="S2.Ex1.m2.5.6.10">,</mo><mi id="S2.Ex1.m2.5.6.11">i</mi><mo id="S2.Ex1.m2.5.6.12">∈</mo><mrow id="S2.Ex1.m2.5.6.13"><mo stretchy="false" id="S2.Ex1.m2.5.6.13.1">[</mo><mn id="S2.Ex1.m2.2.2">1</mn><mo id="S2.Ex1.m2.5.6.13.2">,</mo><mi id="S2.Ex1.m2.3.3">n</mi><mo stretchy="false" id="S2.Ex1.m2.5.6.13.3">]</mo></mrow><mo id="S2.Ex1.m2.5.6.14">,</mo><mi id="S2.Ex1.m2.5.6.15">i</mi><mo id="S2.Ex1.m2.5.6.16">≠</mo><mi id="S2.Ex1.m2.5.6.17">m</mi><mo stretchy="false" id="S2.Ex1.m2.5.6.18">}</mo></mrow><mo id="S2.Ex1.m2.5.7">+</mo><mi id="S2.Ex1.m2.5.8">α</mi><mo id="S2.Ex1.m2.5.9">,</mo><mn id="S2.Ex1.m2.5.5">0</mn><mo maxsize="120%" minsize="120%" id="S2.Ex1.m2.5.10">)</mo><mo id="S2.Ex1.m2.5.11">,</mo></mrow><annotation encoding="application/x-tex" id="S2.Ex1.m2.5c">\displaystyle\min\{||P_{c}^{\mathcal{T}_{m}}(r)-P^{\mathcal{T}_{i}}_{s}||_{2},i\in[1,n],i\neq m\}+\alpha,0\big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS4.p1.7" class="ltx_p">where the first term within the <math id="S2.SS4.p1.4.m1.1" class="ltx_Math" alttext="\max()" display="inline"><semantics id="S2.SS4.p1.4.m1.1a"><mrow id="S2.SS4.p1.4.m1.1.1" xref="S2.SS4.p1.4.m1.1.1.cmml"><mi id="S2.SS4.p1.4.m1.1.1.2" xref="S2.SS4.p1.4.m1.1.1.2.cmml">max</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.4.m1.1.1.1" xref="S2.SS4.p1.4.m1.1.1.1.cmml">​</mo><mrow id="S2.SS4.p1.4.m1.1.1.3.2" xref="S2.SS4.p1.4.m1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.4.m1.1.1.3.2.1" xref="S2.SS4.p1.4.m1.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S2.SS4.p1.4.m1.1.1.3.2.2" xref="S2.SS4.p1.4.m1.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m1.1b"><apply id="S2.SS4.p1.4.m1.1.1.cmml" xref="S2.SS4.p1.4.m1.1.1"><times id="S2.SS4.p1.4.m1.1.1.1.cmml" xref="S2.SS4.p1.4.m1.1.1.1"></times><max id="S2.SS4.p1.4.m1.1.1.2.cmml" xref="S2.SS4.p1.4.m1.1.1.2"></max><list id="S2.SS4.p1.4.m1.1.1.3.1.cmml" xref="S2.SS4.p1.4.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m1.1c">\max()</annotation></semantics></math> calculates the change of the current prompt compared to that in the previous round. By restricting this change, C2Loss smooths the local update to achieve the first goal. The second term within the <math id="S2.SS4.p1.5.m2.1" class="ltx_Math" alttext="\max()" display="inline"><semantics id="S2.SS4.p1.5.m2.1a"><mrow id="S2.SS4.p1.5.m2.1.1" xref="S2.SS4.p1.5.m2.1.1.cmml"><mi id="S2.SS4.p1.5.m2.1.1.2" xref="S2.SS4.p1.5.m2.1.1.2.cmml">max</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p1.5.m2.1.1.1" xref="S2.SS4.p1.5.m2.1.1.1.cmml">​</mo><mrow id="S2.SS4.p1.5.m2.1.1.3.2" xref="S2.SS4.p1.5.m2.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.5.m2.1.1.3.2.1" xref="S2.SS4.p1.5.m2.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S2.SS4.p1.5.m2.1.1.3.2.2" xref="S2.SS4.p1.5.m2.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m2.1b"><apply id="S2.SS4.p1.5.m2.1.1.cmml" xref="S2.SS4.p1.5.m2.1.1"><times id="S2.SS4.p1.5.m2.1.1.1.cmml" xref="S2.SS4.p1.5.m2.1.1.1"></times><max id="S2.SS4.p1.5.m2.1.1.2.cmml" xref="S2.SS4.p1.5.m2.1.1.2"></max><list id="S2.SS4.p1.5.m2.1.1.3.1.cmml" xref="S2.SS4.p1.5.m2.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m2.1c">\max()</annotation></semantics></math> finds the most similar prompt to the current prompt based on the distance between the current and all previous prompts. By increasing this distance, C2Loss enforces the discrimination between task-specific prompts to achieve the second goal. Besides, <math id="S2.SS4.p1.6.m3.1" class="ltx_Math" alttext="\gamma&gt;0" display="inline"><semantics id="S2.SS4.p1.6.m3.1a"><mrow id="S2.SS4.p1.6.m3.1.1" xref="S2.SS4.p1.6.m3.1.1.cmml"><mi id="S2.SS4.p1.6.m3.1.1.2" xref="S2.SS4.p1.6.m3.1.1.2.cmml">γ</mi><mo id="S2.SS4.p1.6.m3.1.1.1" xref="S2.SS4.p1.6.m3.1.1.1.cmml">&gt;</mo><mn id="S2.SS4.p1.6.m3.1.1.3" xref="S2.SS4.p1.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.6.m3.1b"><apply id="S2.SS4.p1.6.m3.1.1.cmml" xref="S2.SS4.p1.6.m3.1.1"><gt id="S2.SS4.p1.6.m3.1.1.1.cmml" xref="S2.SS4.p1.6.m3.1.1.1"></gt><ci id="S2.SS4.p1.6.m3.1.1.2.cmml" xref="S2.SS4.p1.6.m3.1.1.2">𝛾</ci><cn type="integer" id="S2.SS4.p1.6.m3.1.1.3.cmml" xref="S2.SS4.p1.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.6.m3.1c">\gamma&gt;0</annotation></semantics></math> is the hyperparameter to balance the impact between the first two terms. <math id="S2.SS4.p1.7.m4.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S2.SS4.p1.7.m4.2a"><mrow id="S2.SS4.p1.7.m4.2.3" xref="S2.SS4.p1.7.m4.2.3.cmml"><mi id="S2.SS4.p1.7.m4.2.3.2" xref="S2.SS4.p1.7.m4.2.3.2.cmml">α</mi><mo id="S2.SS4.p1.7.m4.2.3.1" xref="S2.SS4.p1.7.m4.2.3.1.cmml">∈</mo><mrow id="S2.SS4.p1.7.m4.2.3.3.2" xref="S2.SS4.p1.7.m4.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS4.p1.7.m4.2.3.3.2.1" xref="S2.SS4.p1.7.m4.2.3.3.1.cmml">[</mo><mn id="S2.SS4.p1.7.m4.1.1" xref="S2.SS4.p1.7.m4.1.1.cmml">0</mn><mo id="S2.SS4.p1.7.m4.2.3.3.2.2" xref="S2.SS4.p1.7.m4.2.3.3.1.cmml">,</mo><mn id="S2.SS4.p1.7.m4.2.2" xref="S2.SS4.p1.7.m4.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS4.p1.7.m4.2.3.3.2.3" xref="S2.SS4.p1.7.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.7.m4.2b"><apply id="S2.SS4.p1.7.m4.2.3.cmml" xref="S2.SS4.p1.7.m4.2.3"><in id="S2.SS4.p1.7.m4.2.3.1.cmml" xref="S2.SS4.p1.7.m4.2.3.1"></in><ci id="S2.SS4.p1.7.m4.2.3.2.cmml" xref="S2.SS4.p1.7.m4.2.3.2">𝛼</ci><interval closure="closed" id="S2.SS4.p1.7.m4.2.3.3.1.cmml" xref="S2.SS4.p1.7.m4.2.3.3.2"><cn type="integer" id="S2.SS4.p1.7.m4.1.1.cmml" xref="S2.SS4.p1.7.m4.1.1">0</cn><cn type="integer" id="S2.SS4.p1.7.m4.2.2.cmml" xref="S2.SS4.p1.7.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.7.m4.2c">\alpha\in[0,1]</annotation></semantics></math> represents a margin value that encourages a separation between the first two terms <cite class="ltx_cite ltx_citemacro_citep">(Schroff et al., <a href="#bib.bib19" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Overall Training</h3>

<div id="S2.SS5.p1" class="ltx_para">
<p id="S2.SS5.p1.9" class="ltx_p">In Fed-CPrompt, client <math id="S2.SS5.p1.1.m1.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="S2.SS5.p1.1.m1.1a"><mrow id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mi id="S2.SS5.p1.1.m1.1.1.2" xref="S2.SS5.p1.1.m1.1.1.2.cmml">c</mi><mo id="S2.SS5.p1.1.m1.1.1.1" xref="S2.SS5.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><in id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1.1"></in><ci id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2">𝑐</ci><ci id="S2.SS5.p1.1.m1.1.1.3.cmml" xref="S2.SS5.p1.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">c\in\mathcal{C}</annotation></semantics></math> conducts local training with dataset <math id="S2.SS5.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS5.p1.2.m2.1a"><msubsup id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.2.m2.1.1.2.2" xref="S2.SS5.p1.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS5.p1.2.m2.1.1.2.3" xref="S2.SS5.p1.2.m2.1.1.2.3.cmml">c</mi><msub id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.2.m2.1.1.3.2" xref="S2.SS5.p1.2.m2.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.2.m2.1.1.3.3" xref="S2.SS5.p1.2.m2.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.2.1.cmml" xref="S2.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS5.p1.2.m2.1.1.2.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2.2">𝒟</ci><ci id="S2.SS5.p1.2.m2.1.1.2.3.cmml" xref="S2.SS5.p1.2.m2.1.1.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.2.m2.1.1.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.3.1.cmml" xref="S2.SS5.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS5.p1.2.m2.1.1.3.2.cmml" xref="S2.SS5.p1.2.m2.1.1.3.2">𝒯</ci><ci id="S2.SS5.p1.2.m2.1.1.3.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">\mathcal{D}_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> for the current task <math id="S2.SS5.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS5.p1.3.m3.1a"><msub id="S2.SS5.p1.3.m3.1.1" xref="S2.SS5.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.3.m3.1.1.2" xref="S2.SS5.p1.3.m3.1.1.2.cmml">𝒯</mi><mi id="S2.SS5.p1.3.m3.1.1.3" xref="S2.SS5.p1.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m3.1b"><apply id="S2.SS5.p1.3.m3.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.1.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS5.p1.3.m3.1.1.2.cmml" xref="S2.SS5.p1.3.m3.1.1.2">𝒯</ci><ci id="S2.SS5.p1.3.m3.1.1.3.cmml" xref="S2.SS5.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m3.1c">\mathcal{T}_{m}</annotation></semantics></math>. As discussed in (<a href="#S2.E2" title="Equation 2 ‣ 2.3 Asynchronous Prompt Learning ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), a prompt is constructed based on attention mechanisms, and thus the learnable prompt parameter for client <math id="S2.SS5.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS5.p1.4.m4.1a"><mi id="S2.SS5.p1.4.m4.1.1" xref="S2.SS5.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.4.m4.1b"><ci id="S2.SS5.p1.4.m4.1.1.cmml" xref="S2.SS5.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.4.m4.1c">c</annotation></semantics></math> is defined by <math id="S2.SS5.p1.5.m5.3" class="ltx_Math" alttext="\mathbf{w}_{c}^{\mathcal{T}_{m}}=\{P_{c}^{\mathcal{T}_{m}},K_{c}^{\mathcal{T}_{m}},A_{c}^{\mathcal{T}_{m}}\}" display="inline"><semantics id="S2.SS5.p1.5.m5.3a"><mrow id="S2.SS5.p1.5.m5.3.3" xref="S2.SS5.p1.5.m5.3.3.cmml"><msubsup id="S2.SS5.p1.5.m5.3.3.5" xref="S2.SS5.p1.5.m5.3.3.5.cmml"><mi id="S2.SS5.p1.5.m5.3.3.5.2.2" xref="S2.SS5.p1.5.m5.3.3.5.2.2.cmml">𝐰</mi><mi id="S2.SS5.p1.5.m5.3.3.5.2.3" xref="S2.SS5.p1.5.m5.3.3.5.2.3.cmml">c</mi><msub id="S2.SS5.p1.5.m5.3.3.5.3" xref="S2.SS5.p1.5.m5.3.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.5.m5.3.3.5.3.2" xref="S2.SS5.p1.5.m5.3.3.5.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.5.m5.3.3.5.3.3" xref="S2.SS5.p1.5.m5.3.3.5.3.3.cmml">m</mi></msub></msubsup><mo id="S2.SS5.p1.5.m5.3.3.4" xref="S2.SS5.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S2.SS5.p1.5.m5.3.3.3.3" xref="S2.SS5.p1.5.m5.3.3.3.4.cmml"><mo stretchy="false" id="S2.SS5.p1.5.m5.3.3.3.3.4" xref="S2.SS5.p1.5.m5.3.3.3.4.cmml">{</mo><msubsup id="S2.SS5.p1.5.m5.1.1.1.1.1" xref="S2.SS5.p1.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS5.p1.5.m5.1.1.1.1.1.2.2" xref="S2.SS5.p1.5.m5.1.1.1.1.1.2.2.cmml">P</mi><mi id="S2.SS5.p1.5.m5.1.1.1.1.1.2.3" xref="S2.SS5.p1.5.m5.1.1.1.1.1.2.3.cmml">c</mi><msub id="S2.SS5.p1.5.m5.1.1.1.1.1.3" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.5.m5.1.1.1.1.1.3.2" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.5.m5.1.1.1.1.1.3.3" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo id="S2.SS5.p1.5.m5.3.3.3.3.5" xref="S2.SS5.p1.5.m5.3.3.3.4.cmml">,</mo><msubsup id="S2.SS5.p1.5.m5.2.2.2.2.2" xref="S2.SS5.p1.5.m5.2.2.2.2.2.cmml"><mi id="S2.SS5.p1.5.m5.2.2.2.2.2.2.2" xref="S2.SS5.p1.5.m5.2.2.2.2.2.2.2.cmml">K</mi><mi id="S2.SS5.p1.5.m5.2.2.2.2.2.2.3" xref="S2.SS5.p1.5.m5.2.2.2.2.2.2.3.cmml">c</mi><msub id="S2.SS5.p1.5.m5.2.2.2.2.2.3" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.5.m5.2.2.2.2.2.3.2" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.5.m5.2.2.2.2.2.3.3" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3.3.cmml">m</mi></msub></msubsup><mo id="S2.SS5.p1.5.m5.3.3.3.3.6" xref="S2.SS5.p1.5.m5.3.3.3.4.cmml">,</mo><msubsup id="S2.SS5.p1.5.m5.3.3.3.3.3" xref="S2.SS5.p1.5.m5.3.3.3.3.3.cmml"><mi id="S2.SS5.p1.5.m5.3.3.3.3.3.2.2" xref="S2.SS5.p1.5.m5.3.3.3.3.3.2.2.cmml">A</mi><mi id="S2.SS5.p1.5.m5.3.3.3.3.3.2.3" xref="S2.SS5.p1.5.m5.3.3.3.3.3.2.3.cmml">c</mi><msub id="S2.SS5.p1.5.m5.3.3.3.3.3.3" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.5.m5.3.3.3.3.3.3.2" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.5.m5.3.3.3.3.3.3.3" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3.3.cmml">m</mi></msub></msubsup><mo stretchy="false" id="S2.SS5.p1.5.m5.3.3.3.3.7" xref="S2.SS5.p1.5.m5.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.5.m5.3b"><apply id="S2.SS5.p1.5.m5.3.3.cmml" xref="S2.SS5.p1.5.m5.3.3"><eq id="S2.SS5.p1.5.m5.3.3.4.cmml" xref="S2.SS5.p1.5.m5.3.3.4"></eq><apply id="S2.SS5.p1.5.m5.3.3.5.cmml" xref="S2.SS5.p1.5.m5.3.3.5"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.5.1.cmml" xref="S2.SS5.p1.5.m5.3.3.5">superscript</csymbol><apply id="S2.SS5.p1.5.m5.3.3.5.2.cmml" xref="S2.SS5.p1.5.m5.3.3.5"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.5.2.1.cmml" xref="S2.SS5.p1.5.m5.3.3.5">subscript</csymbol><ci id="S2.SS5.p1.5.m5.3.3.5.2.2.cmml" xref="S2.SS5.p1.5.m5.3.3.5.2.2">𝐰</ci><ci id="S2.SS5.p1.5.m5.3.3.5.2.3.cmml" xref="S2.SS5.p1.5.m5.3.3.5.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.5.m5.3.3.5.3.cmml" xref="S2.SS5.p1.5.m5.3.3.5.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.5.3.1.cmml" xref="S2.SS5.p1.5.m5.3.3.5.3">subscript</csymbol><ci id="S2.SS5.p1.5.m5.3.3.5.3.2.cmml" xref="S2.SS5.p1.5.m5.3.3.5.3.2">𝒯</ci><ci id="S2.SS5.p1.5.m5.3.3.5.3.3.cmml" xref="S2.SS5.p1.5.m5.3.3.5.3.3">𝑚</ci></apply></apply><set id="S2.SS5.p1.5.m5.3.3.3.4.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3"><apply id="S2.SS5.p1.5.m5.1.1.1.1.1.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1">superscript</csymbol><apply id="S2.SS5.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.2.2">𝑃</ci><ci id="S2.SS5.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS5.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3.2">𝒯</ci><ci id="S2.SS5.p1.5.m5.1.1.1.1.1.3.3.cmml" xref="S2.SS5.p1.5.m5.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S2.SS5.p1.5.m5.2.2.2.2.2.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.2.2.2.2.2.1.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2">superscript</csymbol><apply id="S2.SS5.p1.5.m5.2.2.2.2.2.2.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.2.2.2.2.2.2.1.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S2.SS5.p1.5.m5.2.2.2.2.2.2.2.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.2.2">𝐾</ci><ci id="S2.SS5.p1.5.m5.2.2.2.2.2.2.3.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.5.m5.2.2.2.2.2.3.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.2.2.2.2.2.3.1.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3">subscript</csymbol><ci id="S2.SS5.p1.5.m5.2.2.2.2.2.3.2.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3.2">𝒯</ci><ci id="S2.SS5.p1.5.m5.2.2.2.2.2.3.3.cmml" xref="S2.SS5.p1.5.m5.2.2.2.2.2.3.3">𝑚</ci></apply></apply><apply id="S2.SS5.p1.5.m5.3.3.3.3.3.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.3.3.3.1.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3">superscript</csymbol><apply id="S2.SS5.p1.5.m5.3.3.3.3.3.2.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.3.3.3.2.1.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.5.m5.3.3.3.3.3.2.2.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.2.2">𝐴</ci><ci id="S2.SS5.p1.5.m5.3.3.3.3.3.2.3.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.5.m5.3.3.3.3.3.3.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m5.3.3.3.3.3.3.1.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.5.m5.3.3.3.3.3.3.2.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3.2">𝒯</ci><ci id="S2.SS5.p1.5.m5.3.3.3.3.3.3.3.cmml" xref="S2.SS5.p1.5.m5.3.3.3.3.3.3.3">𝑚</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.5.m5.3c">\mathbf{w}_{c}^{\mathcal{T}_{m}}=\{P_{c}^{\mathcal{T}_{m}},K_{c}^{\mathcal{T}_{m}},A_{c}^{\mathcal{T}_{m}}\}</annotation></semantics></math> (<math id="S2.SS5.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS5.p1.6.m6.1a"><mi id="S2.SS5.p1.6.m6.1.1" xref="S2.SS5.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.6.m6.1b"><ci id="S2.SS5.p1.6.m6.1.1.cmml" xref="S2.SS5.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.6.m6.1c">K</annotation></semantics></math> and <math id="S2.SS5.p1.7.m7.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S2.SS5.p1.7.m7.1a"><mi id="S2.SS5.p1.7.m7.1.1" xref="S2.SS5.p1.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.7.m7.1b"><ci id="S2.SS5.p1.7.m7.1.1.cmml" xref="S2.SS5.p1.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.7.m7.1c">A</annotation></semantics></math> composite the <math id="S2.SS5.p1.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS5.p1.8.m8.1a"><mi id="S2.SS5.p1.8.m8.1.1" xref="S2.SS5.p1.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.8.m8.1b"><ci id="S2.SS5.p1.8.m8.1.1.cmml" xref="S2.SS5.p1.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.8.m8.1c">\alpha</annotation></semantics></math> in (<a href="#S2.E2" title="Equation 2 ‣ 2.3 Asynchronous Prompt Learning ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), detailed in Appendix <a href="#A1" title="Appendix A Preliminaries for Prompt-based Continual Learning ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>). By incorporating the C2Loss to the cross-entropy loss, we have the local optimization function of client <math id="S2.SS5.p1.9.m9.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS5.p1.9.m9.1a"><mi id="S2.SS5.p1.9.m9.1.1" xref="S2.SS5.p1.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.9.m9.1b"><ci id="S2.SS5.p1.9.m9.1.1.cmml" xref="S2.SS5.p1.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.9.m9.1c">c</annotation></semantics></math> by</p>
<table id="A5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.6" class="ltx_Math" alttext="\displaystyle\min_{\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}}\mathcal{L}_{CE}(f_{\phi_{c}}(x;\theta,\mathbf{w}_{c}),y)+\lambda~{}\mathcal{L}_{C2L}(\mathbf{w}_{c}^{\mathcal{T}_{m}})," display="inline"><semantics id="S2.E4.m1.6a"><mrow id="S2.E4.m1.6.6.1" xref="S2.E4.m1.6.6.1.1.cmml"><mrow id="S2.E4.m1.6.6.1.1" xref="S2.E4.m1.6.6.1.1.cmml"><mrow id="S2.E4.m1.6.6.1.1.1" xref="S2.E4.m1.6.6.1.1.1.cmml"><mrow id="S2.E4.m1.6.6.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.3.cmml"><munder id="S2.E4.m1.6.6.1.1.1.3.1" xref="S2.E4.m1.6.6.1.1.1.3.1.cmml"><mi id="S2.E4.m1.6.6.1.1.1.3.1.2" xref="S2.E4.m1.6.6.1.1.1.3.1.2.cmml">min</mi><mrow id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.3.cmml"><msubsup id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S2.E4.m1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.2.3.cmml">c</mi><msub id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="S2.E4.m1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo id="S2.E4.m1.2.2.2.2.3" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><msubsup id="S2.E4.m1.2.2.2.2.2" xref="S2.E4.m1.2.2.2.2.2.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2" xref="S2.E4.m1.2.2.2.2.2.2.2.cmml">ϕ</mi><mi id="S2.E4.m1.2.2.2.2.2.2.3" xref="S2.E4.m1.2.2.2.2.2.2.3.cmml">c</mi><msub id="S2.E4.m1.2.2.2.2.2.3" xref="S2.E4.m1.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.2.2.2.2.2.3.2" xref="S2.E4.m1.2.2.2.2.2.3.2.cmml">𝒯</mi><mi id="S2.E4.m1.2.2.2.2.2.3.3" xref="S2.E4.m1.2.2.2.2.2.3.3.cmml">m</mi></msub></msubsup></mrow></munder><mo lspace="0.167em" id="S2.E4.m1.6.6.1.1.1.3a" xref="S2.E4.m1.6.6.1.1.1.3.cmml">⁡</mo><msub id="S2.E4.m1.6.6.1.1.1.3.2" xref="S2.E4.m1.6.6.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.6.6.1.1.1.3.2.2" xref="S2.E4.m1.6.6.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E4.m1.6.6.1.1.1.3.2.3" xref="S2.E4.m1.6.6.1.1.1.3.2.3.cmml"><mi id="S2.E4.m1.6.6.1.1.1.3.2.3.2" xref="S2.E4.m1.6.6.1.1.1.3.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.1.3.2.3.1" xref="S2.E4.m1.6.6.1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E4.m1.6.6.1.1.1.3.2.3.3" xref="S2.E4.m1.6.6.1.1.1.3.2.3.3.cmml">E</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.6.6.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.2.cmml">(</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.6.6.1.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.3.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.2.cmml">f</mi><msub id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.2.cmml">ϕ</mi><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.3.cmml">c</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">x</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">θ</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.4" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.5" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.6.6.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.2.cmml">,</mo><mi id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml">y</mi><mo stretchy="false" id="S2.E4.m1.6.6.1.1.1.1.1.4" xref="S2.E4.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.6.6.1.1.3" xref="S2.E4.m1.6.6.1.1.3.cmml">+</mo><mrow id="S2.E4.m1.6.6.1.1.2" xref="S2.E4.m1.6.6.1.1.2.cmml"><mi id="S2.E4.m1.6.6.1.1.2.3" xref="S2.E4.m1.6.6.1.1.2.3.cmml">λ</mi><mo lspace="0.330em" rspace="0em" id="S2.E4.m1.6.6.1.1.2.2" xref="S2.E4.m1.6.6.1.1.2.2.cmml">​</mo><msub id="S2.E4.m1.6.6.1.1.2.4" xref="S2.E4.m1.6.6.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.6.6.1.1.2.4.2" xref="S2.E4.m1.6.6.1.1.2.4.2.cmml">ℒ</mi><mrow id="S2.E4.m1.6.6.1.1.2.4.3" xref="S2.E4.m1.6.6.1.1.2.4.3.cmml"><mi id="S2.E4.m1.6.6.1.1.2.4.3.2" xref="S2.E4.m1.6.6.1.1.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.2.4.3.1" xref="S2.E4.m1.6.6.1.1.2.4.3.1.cmml">​</mo><mn id="S2.E4.m1.6.6.1.1.2.4.3.3" xref="S2.E4.m1.6.6.1.1.2.4.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.2.4.3.1a" xref="S2.E4.m1.6.6.1.1.2.4.3.1.cmml">​</mo><mi id="S2.E4.m1.6.6.1.1.2.4.3.4" xref="S2.E4.m1.6.6.1.1.2.4.3.4.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.6.6.1.1.2.2a" xref="S2.E4.m1.6.6.1.1.2.2.cmml">​</mo><mrow id="S2.E4.m1.6.6.1.1.2.1.1" xref="S2.E4.m1.6.6.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.6.6.1.1.2.1.1.2" xref="S2.E4.m1.6.6.1.1.2.1.1.1.cmml">(</mo><msubsup id="S2.E4.m1.6.6.1.1.2.1.1.1" xref="S2.E4.m1.6.6.1.1.2.1.1.1.cmml"><mi id="S2.E4.m1.6.6.1.1.2.1.1.1.2.2" xref="S2.E4.m1.6.6.1.1.2.1.1.1.2.2.cmml">𝐰</mi><mi id="S2.E4.m1.6.6.1.1.2.1.1.1.2.3" xref="S2.E4.m1.6.6.1.1.2.1.1.1.2.3.cmml">c</mi><msub id="S2.E4.m1.6.6.1.1.2.1.1.1.3" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.6.6.1.1.2.1.1.1.3.2" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3.2.cmml">𝒯</mi><mi id="S2.E4.m1.6.6.1.1.2.1.1.1.3.3" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo stretchy="false" id="S2.E4.m1.6.6.1.1.2.1.1.3" xref="S2.E4.m1.6.6.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.6.6.1.2" xref="S2.E4.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.6b"><apply id="S2.E4.m1.6.6.1.1.cmml" xref="S2.E4.m1.6.6.1"><plus id="S2.E4.m1.6.6.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.3"></plus><apply id="S2.E4.m1.6.6.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1"><times id="S2.E4.m1.6.6.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.2"></times><apply id="S2.E4.m1.6.6.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.3"><apply id="S2.E4.m1.6.6.1.1.1.3.1.cmml" xref="S2.E4.m1.6.6.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.3.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.3.1">subscript</csymbol><min id="S2.E4.m1.6.6.1.1.1.3.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.3.1.2"></min><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2"><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2.2">𝐰</ci><ci id="S2.E4.m1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2">𝒯</ci><ci id="S2.E4.m1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S2.E4.m1.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.E4.m1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2">italic-ϕ</ci><ci id="S2.E4.m1.2.2.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="S2.E4.m1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.3.1.cmml" xref="S2.E4.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.3.2.cmml" xref="S2.E4.m1.2.2.2.2.2.3.2">𝒯</ci><ci id="S2.E4.m1.2.2.2.2.2.3.3.cmml" xref="S2.E4.m1.2.2.2.2.2.3.3">𝑚</ci></apply></apply></list></apply><apply id="S2.E4.m1.6.6.1.1.1.3.2.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.3.2.1.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.3.2.2.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2.2">ℒ</ci><apply id="S2.E4.m1.6.6.1.1.1.3.2.3.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2.3"><times id="S2.E4.m1.6.6.1.1.1.3.2.3.1.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2.3.1"></times><ci id="S2.E4.m1.6.6.1.1.1.3.2.3.2.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2.3.2">𝐶</ci><ci id="S2.E4.m1.6.6.1.1.1.3.2.3.3.cmml" xref="S2.E4.m1.6.6.1.1.1.3.2.3.3">𝐸</ci></apply></apply></apply><interval closure="open" id="S2.E4.m1.6.6.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1"><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1"><times id="S2.E4.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.2">italic-ϕ</ci><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply><list id="S2.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1"><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">𝑥</ci><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">𝜃</ci><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></list></apply><ci id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5">𝑦</ci></interval></apply><apply id="S2.E4.m1.6.6.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.2"><times id="S2.E4.m1.6.6.1.1.2.2.cmml" xref="S2.E4.m1.6.6.1.1.2.2"></times><ci id="S2.E4.m1.6.6.1.1.2.3.cmml" xref="S2.E4.m1.6.6.1.1.2.3">𝜆</ci><apply id="S2.E4.m1.6.6.1.1.2.4.cmml" xref="S2.E4.m1.6.6.1.1.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.2.4.1.cmml" xref="S2.E4.m1.6.6.1.1.2.4">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.2.4.2.cmml" xref="S2.E4.m1.6.6.1.1.2.4.2">ℒ</ci><apply id="S2.E4.m1.6.6.1.1.2.4.3.cmml" xref="S2.E4.m1.6.6.1.1.2.4.3"><times id="S2.E4.m1.6.6.1.1.2.4.3.1.cmml" xref="S2.E4.m1.6.6.1.1.2.4.3.1"></times><ci id="S2.E4.m1.6.6.1.1.2.4.3.2.cmml" xref="S2.E4.m1.6.6.1.1.2.4.3.2">𝐶</ci><cn type="integer" id="S2.E4.m1.6.6.1.1.2.4.3.3.cmml" xref="S2.E4.m1.6.6.1.1.2.4.3.3">2</cn><ci id="S2.E4.m1.6.6.1.1.2.4.3.4.cmml" xref="S2.E4.m1.6.6.1.1.2.4.3.4">𝐿</ci></apply></apply><apply id="S2.E4.m1.6.6.1.1.2.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1">superscript</csymbol><apply id="S2.E4.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.2.1.1.1.2.1.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.2.1.1.1.2.2.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.2.2">𝐰</ci><ci id="S2.E4.m1.6.6.1.1.2.1.1.1.2.3.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.2.3">𝑐</ci></apply><apply id="S2.E4.m1.6.6.1.1.2.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3.2">𝒯</ci><ci id="S2.E4.m1.6.6.1.1.2.1.1.1.3.3.cmml" xref="S2.E4.m1.6.6.1.1.2.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.6c">\displaystyle\min_{\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}}\mathcal{L}_{CE}(f_{\phi_{c}}(x;\theta,\mathbf{w}_{c}),y)+\lambda~{}\mathcal{L}_{C2L}(\mathbf{w}_{c}^{\mathcal{T}_{m}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS5.p1.18" class="ltx_p">where <math id="S2.SS5.p1.10.m1.1" class="ltx_Math" alttext="\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS5.p1.10.m1.1a"><msubsup id="S2.SS5.p1.10.m1.1.1" xref="S2.SS5.p1.10.m1.1.1.cmml"><mi id="S2.SS5.p1.10.m1.1.1.2.2" xref="S2.SS5.p1.10.m1.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS5.p1.10.m1.1.1.2.3" xref="S2.SS5.p1.10.m1.1.1.2.3.cmml">c</mi><msub id="S2.SS5.p1.10.m1.1.1.3" xref="S2.SS5.p1.10.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.10.m1.1.1.3.2" xref="S2.SS5.p1.10.m1.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.10.m1.1.1.3.3" xref="S2.SS5.p1.10.m1.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.10.m1.1b"><apply id="S2.SS5.p1.10.m1.1.1.cmml" xref="S2.SS5.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.10.m1.1.1.1.cmml" xref="S2.SS5.p1.10.m1.1.1">superscript</csymbol><apply id="S2.SS5.p1.10.m1.1.1.2.cmml" xref="S2.SS5.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.10.m1.1.1.2.1.cmml" xref="S2.SS5.p1.10.m1.1.1">subscript</csymbol><ci id="S2.SS5.p1.10.m1.1.1.2.2.cmml" xref="S2.SS5.p1.10.m1.1.1.2.2">italic-ϕ</ci><ci id="S2.SS5.p1.10.m1.1.1.2.3.cmml" xref="S2.SS5.p1.10.m1.1.1.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.10.m1.1.1.3.cmml" xref="S2.SS5.p1.10.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.10.m1.1.1.3.1.cmml" xref="S2.SS5.p1.10.m1.1.1.3">subscript</csymbol><ci id="S2.SS5.p1.10.m1.1.1.3.2.cmml" xref="S2.SS5.p1.10.m1.1.1.3.2">𝒯</ci><ci id="S2.SS5.p1.10.m1.1.1.3.3.cmml" xref="S2.SS5.p1.10.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.10.m1.1c">\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> represents the classifier parameter for task <math id="S2.SS5.p1.11.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="S2.SS5.p1.11.m2.1a"><msub id="S2.SS5.p1.11.m2.1.1" xref="S2.SS5.p1.11.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.11.m2.1.1.2" xref="S2.SS5.p1.11.m2.1.1.2.cmml">𝒯</mi><mi id="S2.SS5.p1.11.m2.1.1.3" xref="S2.SS5.p1.11.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.11.m2.1b"><apply id="S2.SS5.p1.11.m2.1.1.cmml" xref="S2.SS5.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.11.m2.1.1.1.cmml" xref="S2.SS5.p1.11.m2.1.1">subscript</csymbol><ci id="S2.SS5.p1.11.m2.1.1.2.cmml" xref="S2.SS5.p1.11.m2.1.1.2">𝒯</ci><ci id="S2.SS5.p1.11.m2.1.1.3.cmml" xref="S2.SS5.p1.11.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.11.m2.1c">\mathcal{T}_{m}</annotation></semantics></math>. Note that <math id="S2.SS5.p1.12.m3.1" class="ltx_Math" alttext="\mathbf{w}_{c}" display="inline"><semantics id="S2.SS5.p1.12.m3.1a"><msub id="S2.SS5.p1.12.m3.1.1" xref="S2.SS5.p1.12.m3.1.1.cmml"><mi id="S2.SS5.p1.12.m3.1.1.2" xref="S2.SS5.p1.12.m3.1.1.2.cmml">𝐰</mi><mi id="S2.SS5.p1.12.m3.1.1.3" xref="S2.SS5.p1.12.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.12.m3.1b"><apply id="S2.SS5.p1.12.m3.1.1.cmml" xref="S2.SS5.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.12.m3.1.1.1.cmml" xref="S2.SS5.p1.12.m3.1.1">subscript</csymbol><ci id="S2.SS5.p1.12.m3.1.1.2.cmml" xref="S2.SS5.p1.12.m3.1.1.2">𝐰</ci><ci id="S2.SS5.p1.12.m3.1.1.3.cmml" xref="S2.SS5.p1.12.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.12.m3.1c">\mathbf{w}_{c}</annotation></semantics></math> and <math id="S2.SS5.p1.13.m4.1" class="ltx_Math" alttext="\phi_{c}" display="inline"><semantics id="S2.SS5.p1.13.m4.1a"><msub id="S2.SS5.p1.13.m4.1.1" xref="S2.SS5.p1.13.m4.1.1.cmml"><mi id="S2.SS5.p1.13.m4.1.1.2" xref="S2.SS5.p1.13.m4.1.1.2.cmml">ϕ</mi><mi id="S2.SS5.p1.13.m4.1.1.3" xref="S2.SS5.p1.13.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.13.m4.1b"><apply id="S2.SS5.p1.13.m4.1.1.cmml" xref="S2.SS5.p1.13.m4.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.13.m4.1.1.1.cmml" xref="S2.SS5.p1.13.m4.1.1">subscript</csymbol><ci id="S2.SS5.p1.13.m4.1.1.2.cmml" xref="S2.SS5.p1.13.m4.1.1.2">italic-ϕ</ci><ci id="S2.SS5.p1.13.m4.1.1.3.cmml" xref="S2.SS5.p1.13.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.13.m4.1c">\phi_{c}</annotation></semantics></math> concatenate both the frozen previous task parameter and the current task learnable parameter as discussed in (<a href="#S2.E2" title="Equation 2 ‣ 2.3 Asynchronous Prompt Learning ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Besides, <math id="S2.SS5.p1.14.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS5.p1.14.m5.1a"><mi id="S2.SS5.p1.14.m5.1.1" xref="S2.SS5.p1.14.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.14.m5.1b"><ci id="S2.SS5.p1.14.m5.1.1.cmml" xref="S2.SS5.p1.14.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.14.m5.1c">\theta</annotation></semantics></math> is the frozen pretrained model parameters; <math id="S2.SS5.p1.15.m6.2" class="ltx_Math" alttext="(x,y)\in\mathcal{D}_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS5.p1.15.m6.2a"><mrow id="S2.SS5.p1.15.m6.2.3" xref="S2.SS5.p1.15.m6.2.3.cmml"><mrow id="S2.SS5.p1.15.m6.2.3.2.2" xref="S2.SS5.p1.15.m6.2.3.2.1.cmml"><mo stretchy="false" id="S2.SS5.p1.15.m6.2.3.2.2.1" xref="S2.SS5.p1.15.m6.2.3.2.1.cmml">(</mo><mi id="S2.SS5.p1.15.m6.1.1" xref="S2.SS5.p1.15.m6.1.1.cmml">x</mi><mo id="S2.SS5.p1.15.m6.2.3.2.2.2" xref="S2.SS5.p1.15.m6.2.3.2.1.cmml">,</mo><mi id="S2.SS5.p1.15.m6.2.2" xref="S2.SS5.p1.15.m6.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS5.p1.15.m6.2.3.2.2.3" xref="S2.SS5.p1.15.m6.2.3.2.1.cmml">)</mo></mrow><mo id="S2.SS5.p1.15.m6.2.3.1" xref="S2.SS5.p1.15.m6.2.3.1.cmml">∈</mo><msubsup id="S2.SS5.p1.15.m6.2.3.3" xref="S2.SS5.p1.15.m6.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.15.m6.2.3.3.2.2" xref="S2.SS5.p1.15.m6.2.3.3.2.2.cmml">𝒟</mi><mi id="S2.SS5.p1.15.m6.2.3.3.2.3" xref="S2.SS5.p1.15.m6.2.3.3.2.3.cmml">c</mi><msub id="S2.SS5.p1.15.m6.2.3.3.3" xref="S2.SS5.p1.15.m6.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.15.m6.2.3.3.3.2" xref="S2.SS5.p1.15.m6.2.3.3.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.15.m6.2.3.3.3.3" xref="S2.SS5.p1.15.m6.2.3.3.3.3.cmml">m</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.15.m6.2b"><apply id="S2.SS5.p1.15.m6.2.3.cmml" xref="S2.SS5.p1.15.m6.2.3"><in id="S2.SS5.p1.15.m6.2.3.1.cmml" xref="S2.SS5.p1.15.m6.2.3.1"></in><interval closure="open" id="S2.SS5.p1.15.m6.2.3.2.1.cmml" xref="S2.SS5.p1.15.m6.2.3.2.2"><ci id="S2.SS5.p1.15.m6.1.1.cmml" xref="S2.SS5.p1.15.m6.1.1">𝑥</ci><ci id="S2.SS5.p1.15.m6.2.2.cmml" xref="S2.SS5.p1.15.m6.2.2">𝑦</ci></interval><apply id="S2.SS5.p1.15.m6.2.3.3.cmml" xref="S2.SS5.p1.15.m6.2.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.15.m6.2.3.3.1.cmml" xref="S2.SS5.p1.15.m6.2.3.3">superscript</csymbol><apply id="S2.SS5.p1.15.m6.2.3.3.2.cmml" xref="S2.SS5.p1.15.m6.2.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.15.m6.2.3.3.2.1.cmml" xref="S2.SS5.p1.15.m6.2.3.3">subscript</csymbol><ci id="S2.SS5.p1.15.m6.2.3.3.2.2.cmml" xref="S2.SS5.p1.15.m6.2.3.3.2.2">𝒟</ci><ci id="S2.SS5.p1.15.m6.2.3.3.2.3.cmml" xref="S2.SS5.p1.15.m6.2.3.3.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.15.m6.2.3.3.3.cmml" xref="S2.SS5.p1.15.m6.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.15.m6.2.3.3.3.1.cmml" xref="S2.SS5.p1.15.m6.2.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.15.m6.2.3.3.3.2.cmml" xref="S2.SS5.p1.15.m6.2.3.3.3.2">𝒯</ci><ci id="S2.SS5.p1.15.m6.2.3.3.3.3.cmml" xref="S2.SS5.p1.15.m6.2.3.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.15.m6.2c">(x,y)\in\mathcal{D}_{c}^{\mathcal{T}_{m}}</annotation></semantics></math>; <math id="S2.SS5.p1.16.m7.2" class="ltx_Math" alttext="\lambda\in[0,1]" display="inline"><semantics id="S2.SS5.p1.16.m7.2a"><mrow id="S2.SS5.p1.16.m7.2.3" xref="S2.SS5.p1.16.m7.2.3.cmml"><mi id="S2.SS5.p1.16.m7.2.3.2" xref="S2.SS5.p1.16.m7.2.3.2.cmml">λ</mi><mo id="S2.SS5.p1.16.m7.2.3.1" xref="S2.SS5.p1.16.m7.2.3.1.cmml">∈</mo><mrow id="S2.SS5.p1.16.m7.2.3.3.2" xref="S2.SS5.p1.16.m7.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS5.p1.16.m7.2.3.3.2.1" xref="S2.SS5.p1.16.m7.2.3.3.1.cmml">[</mo><mn id="S2.SS5.p1.16.m7.1.1" xref="S2.SS5.p1.16.m7.1.1.cmml">0</mn><mo id="S2.SS5.p1.16.m7.2.3.3.2.2" xref="S2.SS5.p1.16.m7.2.3.3.1.cmml">,</mo><mn id="S2.SS5.p1.16.m7.2.2" xref="S2.SS5.p1.16.m7.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS5.p1.16.m7.2.3.3.2.3" xref="S2.SS5.p1.16.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.16.m7.2b"><apply id="S2.SS5.p1.16.m7.2.3.cmml" xref="S2.SS5.p1.16.m7.2.3"><in id="S2.SS5.p1.16.m7.2.3.1.cmml" xref="S2.SS5.p1.16.m7.2.3.1"></in><ci id="S2.SS5.p1.16.m7.2.3.2.cmml" xref="S2.SS5.p1.16.m7.2.3.2">𝜆</ci><interval closure="closed" id="S2.SS5.p1.16.m7.2.3.3.1.cmml" xref="S2.SS5.p1.16.m7.2.3.3.2"><cn type="integer" id="S2.SS5.p1.16.m7.1.1.cmml" xref="S2.SS5.p1.16.m7.1.1">0</cn><cn type="integer" id="S2.SS5.p1.16.m7.2.2.cmml" xref="S2.SS5.p1.16.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.16.m7.2c">\lambda\in[0,1]</annotation></semantics></math> is the hyperparameter balancing losses.
Both prompt parameters <math id="S2.SS5.p1.17.m8.1" class="ltx_Math" alttext="\mathbf{w}_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS5.p1.17.m8.1a"><msubsup id="S2.SS5.p1.17.m8.1.1" xref="S2.SS5.p1.17.m8.1.1.cmml"><mi id="S2.SS5.p1.17.m8.1.1.2.2" xref="S2.SS5.p1.17.m8.1.1.2.2.cmml">𝐰</mi><mi id="S2.SS5.p1.17.m8.1.1.2.3" xref="S2.SS5.p1.17.m8.1.1.2.3.cmml">c</mi><msub id="S2.SS5.p1.17.m8.1.1.3" xref="S2.SS5.p1.17.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.17.m8.1.1.3.2" xref="S2.SS5.p1.17.m8.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.17.m8.1.1.3.3" xref="S2.SS5.p1.17.m8.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.17.m8.1b"><apply id="S2.SS5.p1.17.m8.1.1.cmml" xref="S2.SS5.p1.17.m8.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.17.m8.1.1.1.cmml" xref="S2.SS5.p1.17.m8.1.1">superscript</csymbol><apply id="S2.SS5.p1.17.m8.1.1.2.cmml" xref="S2.SS5.p1.17.m8.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.17.m8.1.1.2.1.cmml" xref="S2.SS5.p1.17.m8.1.1">subscript</csymbol><ci id="S2.SS5.p1.17.m8.1.1.2.2.cmml" xref="S2.SS5.p1.17.m8.1.1.2.2">𝐰</ci><ci id="S2.SS5.p1.17.m8.1.1.2.3.cmml" xref="S2.SS5.p1.17.m8.1.1.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.17.m8.1.1.3.cmml" xref="S2.SS5.p1.17.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.17.m8.1.1.3.1.cmml" xref="S2.SS5.p1.17.m8.1.1.3">subscript</csymbol><ci id="S2.SS5.p1.17.m8.1.1.3.2.cmml" xref="S2.SS5.p1.17.m8.1.1.3.2">𝒯</ci><ci id="S2.SS5.p1.17.m8.1.1.3.3.cmml" xref="S2.SS5.p1.17.m8.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.17.m8.1c">\mathbf{w}_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> and classifier parameters <math id="S2.SS5.p1.18.m9.1" class="ltx_Math" alttext="\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="S2.SS5.p1.18.m9.1a"><msubsup id="S2.SS5.p1.18.m9.1.1" xref="S2.SS5.p1.18.m9.1.1.cmml"><mi id="S2.SS5.p1.18.m9.1.1.2.2" xref="S2.SS5.p1.18.m9.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS5.p1.18.m9.1.1.2.3" xref="S2.SS5.p1.18.m9.1.1.2.3.cmml">c</mi><msub id="S2.SS5.p1.18.m9.1.1.3" xref="S2.SS5.p1.18.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS5.p1.18.m9.1.1.3.2" xref="S2.SS5.p1.18.m9.1.1.3.2.cmml">𝒯</mi><mi id="S2.SS5.p1.18.m9.1.1.3.3" xref="S2.SS5.p1.18.m9.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.18.m9.1b"><apply id="S2.SS5.p1.18.m9.1.1.cmml" xref="S2.SS5.p1.18.m9.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.18.m9.1.1.1.cmml" xref="S2.SS5.p1.18.m9.1.1">superscript</csymbol><apply id="S2.SS5.p1.18.m9.1.1.2.cmml" xref="S2.SS5.p1.18.m9.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.18.m9.1.1.2.1.cmml" xref="S2.SS5.p1.18.m9.1.1">subscript</csymbol><ci id="S2.SS5.p1.18.m9.1.1.2.2.cmml" xref="S2.SS5.p1.18.m9.1.1.2.2">italic-ϕ</ci><ci id="S2.SS5.p1.18.m9.1.1.2.3.cmml" xref="S2.SS5.p1.18.m9.1.1.2.3">𝑐</ci></apply><apply id="S2.SS5.p1.18.m9.1.1.3.cmml" xref="S2.SS5.p1.18.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.18.m9.1.1.3.1.cmml" xref="S2.SS5.p1.18.m9.1.1.3">subscript</csymbol><ci id="S2.SS5.p1.18.m9.1.1.3.2.cmml" xref="S2.SS5.p1.18.m9.1.1.3.2">𝒯</ci><ci id="S2.SS5.p1.18.m9.1.1.3.3.cmml" xref="S2.SS5.p1.18.m9.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.18.m9.1c">\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> will be uploaded to the server. The server handles asynchronous task arrival by conducting parallel aggregation following classical FL <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>.
The overall training is illustrated in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Algorithm ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> of Appendix  <a href="#A3" title="Appendix C Algorithm ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We evaluate the proposed Fed-CPrompt based on the CIFAR-100 dataset <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib8" title="" class="ltx_ref">2009</a>)</cite>, a widely used dataset in continual learning for classification tasks. We consider a total of 10 clients in FCL. The server-side knowledge aggregation is based on FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>. The evaluation metrics include average accuracy and average forgetting, which are standard metrics used in previous CL research <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>; Huang et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>. To comprehensively evaluate Fed-CPrompt, we consider baseline approaches, including rehearsal-free FL approaches (i.e., Fed-EWC and Fed-LWF) and recent prompt-based CL approaches (i.e., Fed-CODAP, Fed-DualP, Fed-L2P). Further details on the dataset setup, FL settings, evaluation metrics, and baseline approaches can be found in Appendix <a href="#A4" title="Appendix D Implementation details ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental Results</h3>

<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparison of rehearsal-free FCL methods under iid settings.</figcaption>
<table id="S3.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.3.1.1" class="ltx_tr">
<th id="S3.T1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T1.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S3.T1.3.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
<th id="S3.T1.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Forgetting</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.3.2.1" class="ltx_tr">
<th id="S3.T1.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.3.2.1.1.1" class="ltx_text" style="font-size:90%;">Fed-EWC</span></th>
<td id="S3.T1.3.2.1.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">9.79</span></td>
<td id="S3.T1.3.2.1.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T1.3.2.1.3.1" class="ltx_text" style="font-size:90%;">84.85</span></td>
</tr>
<tr id="S3.T1.3.3.2" class="ltx_tr">
<th id="S3.T1.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.3.3.2.1.1" class="ltx_text" style="font-size:90%;">Fed-LwF</span></th>
<td id="S3.T1.3.3.2.2" class="ltx_td ltx_align_right"><span id="S3.T1.3.3.2.2.1" class="ltx_text" style="font-size:90%;">60.92</span></td>
<td id="S3.T1.3.3.2.3" class="ltx_td ltx_align_right"><span id="S3.T1.3.3.2.3.1" class="ltx_text" style="font-size:90%;">33.75</span></td>
</tr>
<tr id="S3.T1.3.4.3" class="ltx_tr">
<th id="S3.T1.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.3.4.3.1.1" class="ltx_text" style="font-size:90%;">Fed-L2P</span></th>
<td id="S3.T1.3.4.3.2" class="ltx_td ltx_align_right"><span id="S3.T1.3.4.3.2.1" class="ltx_text" style="font-size:90%;">73.19</span></td>
<td id="S3.T1.3.4.3.3" class="ltx_td ltx_align_right"><span id="S3.T1.3.4.3.3.1" class="ltx_text" style="font-size:90%;">9.80</span></td>
</tr>
<tr id="S3.T1.3.5.4" class="ltx_tr">
<th id="S3.T1.3.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.3.5.4.1.1" class="ltx_text" style="font-size:90%;">Fed-DualP</span></th>
<td id="S3.T1.3.5.4.2" class="ltx_td ltx_align_right"><span id="S3.T1.3.5.4.2.1" class="ltx_text" style="font-size:90%;">76.00</span></td>
<td id="S3.T1.3.5.4.3" class="ltx_td ltx_align_right"><span id="S3.T1.3.5.4.3.1" class="ltx_text" style="font-size:90%;">9.84</span></td>
</tr>
<tr id="S3.T1.3.6.5" class="ltx_tr">
<th id="S3.T1.3.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.3.6.5.1.1" class="ltx_text" style="font-size:90%;">Fed-CODAP</span></th>
<td id="S3.T1.3.6.5.2" class="ltx_td ltx_align_right"><span id="S3.T1.3.6.5.2.1" class="ltx_text" style="font-size:90%;">77.28</span></td>
<td id="S3.T1.3.6.5.3" class="ltx_td ltx_align_right"><span id="S3.T1.3.6.5.3.1" class="ltx_text" style="font-size:90%;">6.42</span></td>
</tr>
<tr id="S3.T1.3.7.6" class="ltx_tr">
<th id="S3.T1.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.3.7.6.1.1" class="ltx_text" style="font-size:90%;">Fed-CPrompt</span></th>
<td id="S3.T1.3.7.6.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T1.3.7.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">79.43</span></td>
<td id="S3.T1.3.7.6.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T1.3.7.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">4.75</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison of prompt-based FCL methods under different non-iid settings (label and quantity skew). </figcaption>
<table id="S3.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.3.1.1" class="ltx_tr">
<th id="S3.T2.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T2.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T2.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S3.T2.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T2.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
<th id="S3.T2.3.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T2.3.1.1.4.1" class="ltx_text" style="font-size:90%;">Forgetting</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.3.2.1" class="ltx_tr">
<th id="S3.T2.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T2.3.2.1.1.1" class="ltx_text" style="font-size:90%;">Label Skew</span></th>
<th id="S3.T2.3.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.3.2.1.2.1" class="ltx_text" style="font-size:90%;">Fed-DualP</span></th>
<td id="S3.T2.3.2.1.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T2.3.2.1.3.1" class="ltx_text" style="font-size:90%;">46.28</span></td>
<td id="S3.T2.3.2.1.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T2.3.2.1.4.1" class="ltx_text" style="font-size:90%;">13.16</span></td>
</tr>
<tr id="S3.T2.3.3.2" class="ltx_tr">
<th id="S3.T2.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.3.3.2.1.1" class="ltx_text" style="font-size:90%;">Fed-CODAP</span></th>
<td id="S3.T2.3.3.2.2" class="ltx_td ltx_align_right"><span id="S3.T2.3.3.2.2.1" class="ltx_text" style="font-size:90%;">54.80</span></td>
<td id="S3.T2.3.3.2.3" class="ltx_td ltx_align_right"><span id="S3.T2.3.3.2.3.1" class="ltx_text" style="font-size:90%;">11.55</span></td>
</tr>
<tr id="S3.T2.3.4.3" class="ltx_tr">
<th id="S3.T2.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.3.4.3.1.1" class="ltx_text" style="font-size:90%;">Fed-CPrompt</span></th>
<td id="S3.T2.3.4.3.2" class="ltx_td ltx_align_right"><span id="S3.T2.3.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">65.45</span></td>
<td id="S3.T2.3.4.3.3" class="ltx_td ltx_align_right"><span id="S3.T2.3.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">9.15</span></td>
</tr>
<tr id="S3.T2.3.5.4" class="ltx_tr">
<th id="S3.T2.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T2.3.5.4.1.1" class="ltx_text" style="font-size:90%;">Quantity Skew</span></th>
<th id="S3.T2.3.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.3.5.4.2.1" class="ltx_text" style="font-size:90%;">Fed-DualP</span></th>
<td id="S3.T2.3.5.4.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T2.3.5.4.3.1" class="ltx_text" style="font-size:90%;">77.57</span></td>
<td id="S3.T2.3.5.4.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T2.3.5.4.4.1" class="ltx_text" style="font-size:90%;">8.38</span></td>
</tr>
<tr id="S3.T2.3.6.5" class="ltx_tr">
<th id="S3.T2.3.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.3.6.5.1.1" class="ltx_text" style="font-size:90%;">Fed-CODAP</span></th>
<td id="S3.T2.3.6.5.2" class="ltx_td ltx_align_right"><span id="S3.T2.3.6.5.2.1" class="ltx_text" style="font-size:90%;">78.56</span></td>
<td id="S3.T2.3.6.5.3" class="ltx_td ltx_align_right"><span id="S3.T2.3.6.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">5.00</span></td>
</tr>
<tr id="S3.T2.3.7.6" class="ltx_tr">
<th id="S3.T2.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S3.T2.3.7.6.1.1" class="ltx_text" style="font-size:90%;">Fed-CPrompt</span></th>
<td id="S3.T2.3.7.6.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T2.3.7.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">81.12</span></td>
<td id="S3.T2.3.7.6.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T2.3.7.6.3.1" class="ltx_text" style="font-size:90%;">7.75</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">Effectiveness of Fed-CPrompt.</span>
We evaluate the effectiveness of Fed-CPrompt under iid and non-iid FL settings. We report the average test accuracy and forgetting over all ten tasks. As illustrated in Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Experimental Results ‣ 3 Experiments ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Fed-CPrompt gains a significant performance improvement over all rehearsal-free FCL methods under iid settings. Compared with the best of existing works, Fed-CPrompt achieves around a 2% increase in Top-1 accuracy and around a 2% drop in Forgetting.
It should be mentioned that non-prompt-based methods (Fed-EWC and Fed-LwF) optimize about 86 million parameters, while Fed-CPrompt optimizes only 4 million <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="(\approx 4.18\%)" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml"></mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml">≈</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.3.cmml"><mn id="S3.SS2.p1.1.m1.1.1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.1.1.3.2.cmml">4.18</mn><mo id="S3.SS2.p1.1.m1.1.1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.1.1.3.1.cmml">%</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><approx id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"></approx><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">absent</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3.1">percent</csymbol><cn type="float" id="S3.SS2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3.2">4.18</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">(\approx 4.18\%)</annotation></semantics></math> to achieve better performance. Moreover, Fed-CPrompt has better convergence, which significantly reduces the communication cost for FCL.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Besides, we further compare the Fed-CPrompt with other prompt-based FCL baselines under non-iid settings. In the experiments following <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, we consider two non-iid settings: label skew and quantity skew. As illustrated in Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Experimental Results ‣ 3 Experiments ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Fed-CPrompt outperforms the existing prompt-based methods under non-iid settings. In particular, under a challenging label-skew setting, Fed-CPrompt achieves a significant performance improvement by <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="10.65\%" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mn id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">10.65</mn><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">10.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">10.65\%</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p"><span id="S3.SS2.p3.2.1" class="ltx_text ltx_font_bold">Impact of Asynchronous Continual Learning Tasks.</span> We demonstrate the effectiveness of Fed-CPrompt under asynchronous task arrival, where the clients train the models on different tasks at the same time.
As illustrated in Table <a href="#S3.T3" title="Table 3 ‣ 3.2 Experimental Results ‣ 3 Experiments ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the average test accuracy of Fed-CPrompt significantly outperforms the existing methods by <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="2.07\%" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mn id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">2.07</mn><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">2.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">2.07\%</annotation></semantics></math> and <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="11.79\%" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mn id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">11.79</mn><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="latexml" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1">percent</csymbol><cn type="float" id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">11.79</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">11.79\%</annotation></semantics></math> under iid and non-iid settings, respectively.
Our findings suggest jointly considering past and future task information can improve the training efficiency of FCL.
It should be noted that the forgetting of Fed-CPrompt is comparable to or higher than the existing works; however this is due to the high accuracy gained by Fed-CPrompt on the first task. Besides the impact of high accuracy on the first task, we can still observe the substantial advantage of Fed-CPrompt in mitigating catastrophic forgetting, as the average accuracy on all ten tasks achieved by Fed-CPrompt is much higher than the existing works.
</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p"><span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_bold">Impact of C2Loss.</span> We further perform ablation studies to evaluate the effectiveness of the proposed C2Loss. We compare the performance between FedProx and Fed-CPrompt with and without C2Loss. As shown in Table <a href="#S3.T4" title="Table 4 ‣ 3.2 Experimental Results ‣ 3 Experiments ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, Fed-CPrompt with C2Loss achieves the highest accuracy and lowest forgetting compared with the rest two methods.
This is mainly due to that C2Loss handles inter-task and inter-client knowledge transfer, thereby leading to better task discrimination and improved accuracy.
</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance comparison of asynchronous continual learning under iid and non-iid (label skew) settings.</figcaption>
<table id="S3.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.3.1.1" class="ltx_tr">
<th id="S3.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span id="S3.T3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S3.T3.3.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T3.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
<th id="S3.T3.3.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T3.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Forgetting</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.3.2.1" class="ltx_tr">
<th id="S3.T3.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T3.3.2.1.1.1" class="ltx_text" style="font-size:90%;">iid</span></th>
<th id="S3.T3.3.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T3.3.2.1.2.1" class="ltx_text" style="font-size:90%;">Fed-DualP</span></th>
<td id="S3.T3.3.2.1.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T3.3.2.1.3.1" class="ltx_text" style="font-size:90%;">70.27</span></td>
<td id="S3.T3.3.2.1.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T3.3.2.1.4.1" class="ltx_text" style="font-size:90%;">17.36</span></td>
</tr>
<tr id="S3.T3.3.3.2" class="ltx_tr">
<th id="S3.T3.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T3.3.3.2.1.1" class="ltx_text" style="font-size:90%;">Fed-CODAP</span></th>
<td id="S3.T3.3.3.2.2" class="ltx_td ltx_align_right"><span id="S3.T3.3.3.2.2.1" class="ltx_text" style="font-size:90%;">73.63</span></td>
<td id="S3.T3.3.3.2.3" class="ltx_td ltx_align_right"><span id="S3.T3.3.3.2.3.1" class="ltx_text" style="font-size:90%;">10.94</span></td>
</tr>
<tr id="S3.T3.3.4.3" class="ltx_tr">
<th id="S3.T3.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T3.3.4.3.1.1" class="ltx_text" style="font-size:90%;">Fed-CPrompt</span></th>
<td id="S3.T3.3.4.3.2" class="ltx_td ltx_align_right"><span id="S3.T3.3.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">75.70</span></td>
<td id="S3.T3.3.4.3.3" class="ltx_td ltx_align_right"><span id="S3.T3.3.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">9.82</span></td>
</tr>
<tr id="S3.T3.3.5.4" class="ltx_tr">
<th id="S3.T3.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T3.3.5.4.1.1" class="ltx_text" style="font-size:90%;">
<span id="S3.T3.3.5.4.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S3.T3.3.5.4.1.1.1.1" class="ltx_p">non-iid</span>
</span></span></th>
<th id="S3.T3.3.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T3.3.5.4.2.1" class="ltx_text" style="font-size:90%;">Fed-DualP</span></th>
<td id="S3.T3.3.5.4.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T3.3.5.4.3.1" class="ltx_text" style="font-size:90%;">46.80</span></td>
<td id="S3.T3.3.5.4.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T3.3.5.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;"> 3.89</span></td>
</tr>
<tr id="S3.T3.3.6.5" class="ltx_tr">
<th id="S3.T3.3.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T3.3.6.5.1.1" class="ltx_text" style="font-size:90%;">Fed-CODAP</span></th>
<td id="S3.T3.3.6.5.2" class="ltx_td ltx_align_right"><span id="S3.T3.3.6.5.2.1" class="ltx_text" style="font-size:90%;">50.81</span></td>
<td id="S3.T3.3.6.5.3" class="ltx_td ltx_align_right"><span id="S3.T3.3.6.5.3.1" class="ltx_text" style="font-size:90%;">8.05</span></td>
</tr>
<tr id="S3.T3.3.7.6" class="ltx_tr">
<th id="S3.T3.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S3.T3.3.7.6.1.1" class="ltx_text" style="font-size:90%;">Fed-CPrompt</span></th>
<td id="S3.T3.3.7.6.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T3.3.7.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.60</span></td>
<td id="S3.T3.3.7.6.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T3.3.7.6.3.1" class="ltx_text" style="font-size:90%;">10.55</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span> Impact of C2Loss under the non-iid (label skew) setting.</figcaption>
<table id="S3.T4.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.5.6.1" class="ltx_tr">
<th id="S3.T4.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T4.5.6.1.1.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S3.T4.5.6.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T4.5.6.1.2.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
<th id="S3.T4.5.6.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S3.T4.5.6.1.3.1" class="ltx_text" style="font-size:90%;">Forgetting</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<math id="S3.T4.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S3.T4.1.1.1.m1.1a"><msub id="S3.T4.1.1.1.m1.1.1" xref="S3.T4.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T4.1.1.1.m1.1.1.2" xref="S3.T4.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T4.1.1.1.m1.1.1.3" xref="S3.T4.1.1.1.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T4.1.1.1.m1.1.1.3.2" xref="S3.T4.1.1.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.T4.1.1.1.m1.1.1.3.1" xref="S3.T4.1.1.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T4.1.1.1.m1.1.1.3.3" xref="S3.T4.1.1.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.m1.1b"><apply id="S3.T4.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.1.1.1.m1.1.1.1.cmml" xref="S3.T4.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T4.1.1.1.m1.1.1.2.cmml" xref="S3.T4.1.1.1.m1.1.1.2">ℒ</ci><apply id="S3.T4.1.1.1.m1.1.1.3.cmml" xref="S3.T4.1.1.1.m1.1.1.3"><times id="S3.T4.1.1.1.m1.1.1.3.1.cmml" xref="S3.T4.1.1.1.m1.1.1.3.1"></times><ci id="S3.T4.1.1.1.m1.1.1.3.2.cmml" xref="S3.T4.1.1.1.m1.1.1.3.2">𝐶</ci><ci id="S3.T4.1.1.1.m1.1.1.3.3.cmml" xref="S3.T4.1.1.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.m1.1c">\mathcal{L}_{CE}</annotation></semantics></math><span id="S3.T4.1.1.1.1" class="ltx_text" style="font-size:90%;"> w/ FedProx</span>
</th>
<td id="S3.T4.1.1.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T4.1.1.2.1" class="ltx_text" style="font-size:90%;">50.81</span></td>
<td id="S3.T4.1.1.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T4.1.1.3.1" class="ltx_text" style="font-size:90%;">9.16</span></td>
</tr>
<tr id="S3.T4.3.3" class="ltx_tr">
<th id="S3.T4.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<math id="S3.T4.2.2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S3.T4.2.2.1.m1.1a"><msub id="S3.T4.2.2.1.m1.1.1" xref="S3.T4.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T4.2.2.1.m1.1.1.2" xref="S3.T4.2.2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T4.2.2.1.m1.1.1.3" xref="S3.T4.2.2.1.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T4.2.2.1.m1.1.1.3.2" xref="S3.T4.2.2.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.T4.2.2.1.m1.1.1.3.1" xref="S3.T4.2.2.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T4.2.2.1.m1.1.1.3.3" xref="S3.T4.2.2.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T4.2.2.1.m1.1b"><apply id="S3.T4.2.2.1.m1.1.1.cmml" xref="S3.T4.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.2.2.1.m1.1.1.1.cmml" xref="S3.T4.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T4.2.2.1.m1.1.1.2.cmml" xref="S3.T4.2.2.1.m1.1.1.2">ℒ</ci><apply id="S3.T4.2.2.1.m1.1.1.3.cmml" xref="S3.T4.2.2.1.m1.1.1.3"><times id="S3.T4.2.2.1.m1.1.1.3.1.cmml" xref="S3.T4.2.2.1.m1.1.1.3.1"></times><ci id="S3.T4.2.2.1.m1.1.1.3.2.cmml" xref="S3.T4.2.2.1.m1.1.1.3.2">𝐶</ci><ci id="S3.T4.2.2.1.m1.1.1.3.3.cmml" xref="S3.T4.2.2.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.2.1.m1.1c">\mathcal{L}_{CE}</annotation></semantics></math><span id="S3.T4.3.3.2.1" class="ltx_text" style="font-size:90%;"> w/o </span><math id="S3.T4.3.3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{C2L}" display="inline"><semantics id="S3.T4.3.3.2.m2.1a"><msub id="S3.T4.3.3.2.m2.1.1" xref="S3.T4.3.3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T4.3.3.2.m2.1.1.2" xref="S3.T4.3.3.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.T4.3.3.2.m2.1.1.3" xref="S3.T4.3.3.2.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T4.3.3.2.m2.1.1.3.2" xref="S3.T4.3.3.2.m2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.T4.3.3.2.m2.1.1.3.1" xref="S3.T4.3.3.2.m2.1.1.3.1.cmml">​</mo><mn mathsize="90%" id="S3.T4.3.3.2.m2.1.1.3.3" xref="S3.T4.3.3.2.m2.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.T4.3.3.2.m2.1.1.3.1a" xref="S3.T4.3.3.2.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T4.3.3.2.m2.1.1.3.4" xref="S3.T4.3.3.2.m2.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T4.3.3.2.m2.1b"><apply id="S3.T4.3.3.2.m2.1.1.cmml" xref="S3.T4.3.3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T4.3.3.2.m2.1.1.1.cmml" xref="S3.T4.3.3.2.m2.1.1">subscript</csymbol><ci id="S3.T4.3.3.2.m2.1.1.2.cmml" xref="S3.T4.3.3.2.m2.1.1.2">ℒ</ci><apply id="S3.T4.3.3.2.m2.1.1.3.cmml" xref="S3.T4.3.3.2.m2.1.1.3"><times id="S3.T4.3.3.2.m2.1.1.3.1.cmml" xref="S3.T4.3.3.2.m2.1.1.3.1"></times><ci id="S3.T4.3.3.2.m2.1.1.3.2.cmml" xref="S3.T4.3.3.2.m2.1.1.3.2">𝐶</ci><cn type="integer" id="S3.T4.3.3.2.m2.1.1.3.3.cmml" xref="S3.T4.3.3.2.m2.1.1.3.3">2</cn><ci id="S3.T4.3.3.2.m2.1.1.3.4.cmml" xref="S3.T4.3.3.2.m2.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.3.2.m2.1c">\mathcal{L}_{C2L}</annotation></semantics></math>
</th>
<td id="S3.T4.3.3.3" class="ltx_td ltx_align_right"><span id="S3.T4.3.3.3.1" class="ltx_text" style="font-size:90%;">71.30</span></td>
<td id="S3.T4.3.3.4" class="ltx_td ltx_align_right"><span id="S3.T4.3.3.4.1" class="ltx_text" style="font-size:90%;">13.52</span></td>
</tr>
<tr id="S3.T4.5.5" class="ltx_tr">
<th id="S3.T4.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<math id="S3.T4.4.4.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="S3.T4.4.4.1.m1.1a"><msub id="S3.T4.4.4.1.m1.1.1" xref="S3.T4.4.4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T4.4.4.1.m1.1.1.2" xref="S3.T4.4.4.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T4.4.4.1.m1.1.1.3" xref="S3.T4.4.4.1.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T4.4.4.1.m1.1.1.3.2" xref="S3.T4.4.4.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.T4.4.4.1.m1.1.1.3.1" xref="S3.T4.4.4.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T4.4.4.1.m1.1.1.3.3" xref="S3.T4.4.4.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T4.4.4.1.m1.1b"><apply id="S3.T4.4.4.1.m1.1.1.cmml" xref="S3.T4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.4.4.1.m1.1.1.1.cmml" xref="S3.T4.4.4.1.m1.1.1">subscript</csymbol><ci id="S3.T4.4.4.1.m1.1.1.2.cmml" xref="S3.T4.4.4.1.m1.1.1.2">ℒ</ci><apply id="S3.T4.4.4.1.m1.1.1.3.cmml" xref="S3.T4.4.4.1.m1.1.1.3"><times id="S3.T4.4.4.1.m1.1.1.3.1.cmml" xref="S3.T4.4.4.1.m1.1.1.3.1"></times><ci id="S3.T4.4.4.1.m1.1.1.3.2.cmml" xref="S3.T4.4.4.1.m1.1.1.3.2">𝐶</ci><ci id="S3.T4.4.4.1.m1.1.1.3.3.cmml" xref="S3.T4.4.4.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.4.4.1.m1.1c">\mathcal{L}_{CE}</annotation></semantics></math><span id="S3.T4.5.5.2.1" class="ltx_text" style="font-size:90%;"> w/ </span><math id="S3.T4.5.5.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{C2L}" display="inline"><semantics id="S3.T4.5.5.2.m2.1a"><msub id="S3.T4.5.5.2.m2.1.1" xref="S3.T4.5.5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T4.5.5.2.m2.1.1.2" xref="S3.T4.5.5.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.T4.5.5.2.m2.1.1.3" xref="S3.T4.5.5.2.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T4.5.5.2.m2.1.1.3.2" xref="S3.T4.5.5.2.m2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.T4.5.5.2.m2.1.1.3.1" xref="S3.T4.5.5.2.m2.1.1.3.1.cmml">​</mo><mn mathsize="90%" id="S3.T4.5.5.2.m2.1.1.3.3" xref="S3.T4.5.5.2.m2.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.T4.5.5.2.m2.1.1.3.1a" xref="S3.T4.5.5.2.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T4.5.5.2.m2.1.1.3.4" xref="S3.T4.5.5.2.m2.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T4.5.5.2.m2.1b"><apply id="S3.T4.5.5.2.m2.1.1.cmml" xref="S3.T4.5.5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T4.5.5.2.m2.1.1.1.cmml" xref="S3.T4.5.5.2.m2.1.1">subscript</csymbol><ci id="S3.T4.5.5.2.m2.1.1.2.cmml" xref="S3.T4.5.5.2.m2.1.1.2">ℒ</ci><apply id="S3.T4.5.5.2.m2.1.1.3.cmml" xref="S3.T4.5.5.2.m2.1.1.3"><times id="S3.T4.5.5.2.m2.1.1.3.1.cmml" xref="S3.T4.5.5.2.m2.1.1.3.1"></times><ci id="S3.T4.5.5.2.m2.1.1.3.2.cmml" xref="S3.T4.5.5.2.m2.1.1.3.2">𝐶</ci><cn type="integer" id="S3.T4.5.5.2.m2.1.1.3.3.cmml" xref="S3.T4.5.5.2.m2.1.1.3.3">2</cn><ci id="S3.T4.5.5.2.m2.1.1.3.4.cmml" xref="S3.T4.5.5.2.m2.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.5.5.2.m2.1c">\mathcal{L}_{C2L}</annotation></semantics></math>
</th>
<td id="S3.T4.5.5.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.5.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">79.30</span></td>
<td id="S3.T4.5.5.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.5.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">4.50</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This paper proposed Fed-CPrompt, an innovative rehearsal-free FCL framework to alleviate catastrophic forgetting over incremental tasks and facilitate knowledge transfer among distributed and heterogeneous clients. Fed-CPrompt introduces two key components: asynchronous prompt learning to handle asynchronous arrival, and a simple yet effective contrastive continual loss that optimizes prompt parameters while providing additional supervision for learning distinct task-specific prompts. Extensive experiments demonstrate the effectiveness of our proposal.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">The authors thank all anonymous reviewers for their insightful feedback. This work was supported by the National Science Foundation under Grants CCF-2106754, CCF-2221741, CCF-2153381, and CCF-2151238. The work of Miao Pan was supported in part by the US National Science Foundation under Grants CNS-2107057 and CNS-2318664.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J. D., Dhariwal, P.,
Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casado et al. (2022)</span>
<span class="ltx_bibblock">
Casado, F. E., Lema, D., Criado, M. F., Iglesias, R., Regueiro, C. V., and
Barro, S.

</span>
<span class="ltx_bibblock">Concept drift detection and adaptation for federated and continual
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Multimedia Tools and Applications</em>, pp.  1–23, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2022)</span>
<span class="ltx_bibblock">
Dong, J., Wang, L., Fang, Z., Sun, G., Xu, S., Wang, X., and Zhu, Q.

</span>
<span class="ltx_bibblock">Federated class-incremental learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  10164–10173, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Guo, T., Guo, S., Wang, J., and Xu, W.

</span>
<span class="ltx_bibblock">Promptfl: Let federated participants cooperatively learn prompts
instead of models–federated learning in age of foundation model.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.11625</em>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2022)</span>
<span class="ltx_bibblock">
Huang, W., Ye, M., and Du, B.

</span>
<span class="ltx_bibblock">Learn from others and be yourself in heterogeneous federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  10143–10153, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2020)</span>
<span class="ltx_bibblock">
Jiang, Z., Xu, F. F., Araki, J., and Neubig, G.

</span>
<span class="ltx_bibblock">How can we know what language models know?

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
8:423–438, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. (2017)</span>
<span class="ltx_bibblock">
Kirkpatrick, J., Pascanu, R., Rabinowitz, N., Veness, J., Desjardins, G., Rusu,
A. A., Milan, K., Quan, J., Ramalho, T., Grabska-Barwinska, A., et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al. (2021)</span>
<span class="ltx_bibblock">
Lester, B., Al-Rfou, R., and Constant, N.

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.08691</em>, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Li, Q., He, B., and Song, D.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  10713–10722, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Li, Q., Diao, Y., Chen, Q., and He, B.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An experimental study.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2022 IEEE 38th International Conference on Data Engineering
(ICDE)</em>, pp.  965–978. IEEE, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE signal processing magazine</em>, 37(3):50–60, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, X., Zhou, Y., Wu, T., Socher, R., and Xiong, C.

</span>
<span class="ltx_bibblock">Learn to grow: A continual structure learning framework for
overcoming catastrophic forgetting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 3925–3934. PMLR, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Liang (2021)</span>
<span class="ltx_bibblock">
Li, X. L. and Liang, P.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00190</em>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Liu, X., Ji, K., Fu, Y., Tam, W., Du, Z., Yang, Z., and Tang, J.

</span>
<span class="ltx_bibblock">P-tuning: Prompt tuning can be comparable to fine-tuning across
scales and tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association
for Computational Linguistics (Volume 2: Short Papers)</em>, pp.  61–68, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Ma, Y., Xie, Z., Wang, J., Chen, K., and Shou, L.

</span>
<span class="ltx_bibblock">Continual federated learning based on knowledge distillation.

</span>
<span class="ltx_bibblock">In Raedt, L. D. (ed.), <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirty-First
International Joint Conference on Artificial Intelligence, IJCAI-22</em>, pp. 2182–2188. International Joint Conferences on Artificial Intelligence
Organization, 7 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.24963/ijcai.2022/303</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.24963/ijcai.2022/303" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.24963/ijcai.2022/303</a>.

</span>
<span class="ltx_bibblock">Main Track.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rusu et al. (2016)</span>
<span class="ltx_bibblock">
Rusu, A. A., Rabinowitz, N. C., Desjardins, G., Soyer, H., Kirkpatrick, J.,
Kavukcuoglu, K., Pascanu, R., and Hadsell, R.

</span>
<span class="ltx_bibblock">Progressive neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.04671</em>, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff et al. (2015)</span>
<span class="ltx_bibblock">
Schroff, F., Kalenichenko, D., and Philbin, J.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition and clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  815–823, 2015.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shenaj et al. (2023)</span>
<span class="ltx_bibblock">
Shenaj, D., Toldo, M., Rigon, A., and Zanuttigh, P.

</span>
<span class="ltx_bibblock">Asynchronous federated continual learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.03626</em>, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin et al. (2020)</span>
<span class="ltx_bibblock">
Shin, T., Razeghi, Y., Logan IV, R. L., Wallace, E., and Singh, S.

</span>
<span class="ltx_bibblock">Autoprompt: Eliciting knowledge from language models with
automatically generated prompts.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.15980</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoham et al. (2019)</span>
<span class="ltx_bibblock">
Shoham, N., Avidor, T., Keren, A., Israel, N., Benditkis, D., Mor-Yosef, L.,
and Zeitak, I.

</span>
<span class="ltx_bibblock">Overcoming forgetting in federated learning on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.07796</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2022a)</span>
<span class="ltx_bibblock">
Smith, J. S., Karlinsky, L., Gutta, V., Cascante-Bonilla, P., Kim, D., Arbelle,
A., Panda, R., Feris, R., and Kira, Z.

</span>
<span class="ltx_bibblock">Coda-prompt: Continual decomposed attention-based prompting for
rehearsal-free continual learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.13218</em>, 2022a.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2022b)</span>
<span class="ltx_bibblock">
Smith, J. S., Tian, J., Hsu, Y.-C., and Kira, Z.

</span>
<span class="ltx_bibblock">A closer look at rehearsal-free continual learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.17269</em>, 2022b.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Usmanova et al. (2021)</span>
<span class="ltx_bibblock">
Usmanova, A., Portet, F., Lalanda, P., and Vega, G.

</span>
<span class="ltx_bibblock">A distillation-based approach integrating continual learning and
federated learning for pervasive services.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.04197</em>, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Usmanova et al. (2022)</span>
<span class="ltx_bibblock">
Usmanova, A., Portet, F., Lalanda, P., and Vega, G.

</span>
<span class="ltx_bibblock">Federated continual learning through distillation in pervasive
computing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">2022 IEEE International Conference on Smart Computing
(SMARTCOMP)</em>, pp.  86–91. IEEE, 2022.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N.,
Kaiser, Ł., and Polosukhin, I.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022a)</span>
<span class="ltx_bibblock">
Wang, Z., Zhang, Z., Ebrahimi, S., Sun, R., Zhang, H., Lee, C.-Y., Ren, X., Su,
G., Perot, V., Dy, J., and Pfister, T.

</span>
<span class="ltx_bibblock">Dualprompt: Complementary prompting for rehearsal-free continual
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2022: 17th European Conference, Tel
Aviv, Israel, October 23–27, 2022, Proceedings, Part XXVI</em>, pp.  631–648.
Springer, 2022a.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022b)</span>
<span class="ltx_bibblock">
Wang, Z., Zhang, Z., Lee, C.-Y., Zhang, H., Sun, R., Ren, X., Su, G., Perot,
V., Dy, J., and Pfister, T.

</span>
<span class="ltx_bibblock">Learning to prompt for continual learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  139–149, 2022b.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Wang, Z., Zhang, Y., Xu, X., Fu, Z., Yang, H., and Du, W.

</span>
<span class="ltx_bibblock">Federated probability memory recall for federated continual learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Information Sciences</em>, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoon et al. (2021)</span>
<span class="ltx_bibblock">
Yoon, J., Jeong, W., Lee, G., Yang, E., and Hwang, S. J.

</span>
<span class="ltx_bibblock">Federated continual learning with weighted inter-client transfer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 12073–12086. PMLR, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2022)</span>
<span class="ltx_bibblock">
Zhao, H., Du, W., Li, F., Li, P., and Liu, G.

</span>
<span class="ltx_bibblock">Reduce communication costs and preserve privacy: Prompt tuning method
in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.12268</em>, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zizzo et al. (2022)</span>
<span class="ltx_bibblock">
Zizzo, G., Rawat, A., Holohan, N., and Tirupathi, S.

</span>
<span class="ltx_bibblock">Federated continual learning with differentially private data
sharing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Workshop on Federated Learning: Recent Advances and New
Challenges (in Conjunction with NeurIPS 2022)</em>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Preliminaries for Prompt-based Continual Learning</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.13" class="ltx_p">In this work, we build upon the technical foundations of prompt-based methods from the prior centralized continual learning research <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>; Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2022a</a>, <a href="#bib.bib29" title="" class="ltx_ref">b</a>)</cite> to introduce prompts, which can collaboratively learn in heterogeneous federated settings.
As done in CODA-P, prompt parameters are attached to several multi-head self-attention (MSA) layers in a pre-trained ViT. Define a task-specific prompt parameter for task <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A1.p1.1.m1.1a"><msub id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">𝒯</mi><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝒯</ci><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\mathcal{T}_{m}</annotation></semantics></math> as <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="P^{\mathcal{T}_{m}}\in\mathbb{R}^{L_{P}\times D\times\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><msup id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml"><mi id="A1.p1.2.m2.1.1.2.2" xref="A1.p1.2.m2.1.1.2.2.cmml">P</mi><msub id="A1.p1.2.m2.1.1.2.3" xref="A1.p1.2.m2.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.2.m2.1.1.2.3.2" xref="A1.p1.2.m2.1.1.2.3.2.cmml">𝒯</mi><mi id="A1.p1.2.m2.1.1.2.3.3" xref="A1.p1.2.m2.1.1.2.3.3.cmml">m</mi></msub></msup><mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml"><mi id="A1.p1.2.m2.1.1.3.2" xref="A1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.p1.2.m2.1.1.3.3" xref="A1.p1.2.m2.1.1.3.3.cmml"><msub id="A1.p1.2.m2.1.1.3.3.2" xref="A1.p1.2.m2.1.1.3.3.2.cmml"><mi id="A1.p1.2.m2.1.1.3.3.2.2" xref="A1.p1.2.m2.1.1.3.3.2.2.cmml">L</mi><mi id="A1.p1.2.m2.1.1.3.3.2.3" xref="A1.p1.2.m2.1.1.3.3.2.3.cmml">P</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.p1.2.m2.1.1.3.3.1" xref="A1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="A1.p1.2.m2.1.1.3.3.3" xref="A1.p1.2.m2.1.1.3.3.3.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="A1.p1.2.m2.1.1.3.3.1a" xref="A1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="A1.p1.2.m2.1.1.3.3.4" xref="A1.p1.2.m2.1.1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.2.m2.1.1.3.3.4.2" xref="A1.p1.2.m2.1.1.3.3.4.2.cmml">𝒯</mi><mi id="A1.p1.2.m2.1.1.3.3.4.3" xref="A1.p1.2.m2.1.1.3.3.4.3.cmml">m</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><in id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></in><apply id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.2.1.cmml" xref="A1.p1.2.m2.1.1.2">superscript</csymbol><ci id="A1.p1.2.m2.1.1.2.2.cmml" xref="A1.p1.2.m2.1.1.2.2">𝑃</ci><apply id="A1.p1.2.m2.1.1.2.3.cmml" xref="A1.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.2.3.1.cmml" xref="A1.p1.2.m2.1.1.2.3">subscript</csymbol><ci id="A1.p1.2.m2.1.1.2.3.2.cmml" xref="A1.p1.2.m2.1.1.2.3.2">𝒯</ci><ci id="A1.p1.2.m2.1.1.2.3.3.cmml" xref="A1.p1.2.m2.1.1.2.3.3">𝑚</ci></apply></apply><apply id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.3.1.cmml" xref="A1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.p1.2.m2.1.1.3.2.cmml" xref="A1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="A1.p1.2.m2.1.1.3.3.cmml" xref="A1.p1.2.m2.1.1.3.3"><times id="A1.p1.2.m2.1.1.3.3.1.cmml" xref="A1.p1.2.m2.1.1.3.3.1"></times><apply id="A1.p1.2.m2.1.1.3.3.2.cmml" xref="A1.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.3.3.2.1.cmml" xref="A1.p1.2.m2.1.1.3.3.2">subscript</csymbol><ci id="A1.p1.2.m2.1.1.3.3.2.2.cmml" xref="A1.p1.2.m2.1.1.3.3.2.2">𝐿</ci><ci id="A1.p1.2.m2.1.1.3.3.2.3.cmml" xref="A1.p1.2.m2.1.1.3.3.2.3">𝑃</ci></apply><ci id="A1.p1.2.m2.1.1.3.3.3.cmml" xref="A1.p1.2.m2.1.1.3.3.3">𝐷</ci><apply id="A1.p1.2.m2.1.1.3.3.4.cmml" xref="A1.p1.2.m2.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.3.3.4.1.cmml" xref="A1.p1.2.m2.1.1.3.3.4">subscript</csymbol><ci id="A1.p1.2.m2.1.1.3.3.4.2.cmml" xref="A1.p1.2.m2.1.1.3.3.4.2">𝒯</ci><ci id="A1.p1.2.m2.1.1.3.3.4.3.cmml" xref="A1.p1.2.m2.1.1.3.3.4.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">P^{\mathcal{T}_{m}}\in\mathbb{R}^{L_{P}\times D\times\mathcal{T}_{m}}</annotation></semantics></math>, where <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="L_{P}" display="inline"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">L</mi><mi id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝐿</ci><ci id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">L_{P}</annotation></semantics></math>, <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.p1.4.m4.1a"><mi id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><ci id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">D</annotation></semantics></math>, and <math id="A1.p1.5.m5.1" class="ltx_Math" alttext="{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.5.m5.1a"><msub id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">𝒯</mi><mi id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">𝒯</ci><ci id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">{\mathcal{T}_{m}}</annotation></semantics></math> are the prompt lengths, embedding dimension, and the number of prompts for each task, respectively. We consider prefix-tuning to attach prompts to the keys and values of an MSA layer with input <math id="A1.p1.6.m6.1" class="ltx_Math" alttext="h\in\mathbb{R}^{L\times D}" display="inline"><semantics id="A1.p1.6.m6.1a"><mrow id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml"><mi id="A1.p1.6.m6.1.1.2" xref="A1.p1.6.m6.1.1.2.cmml">h</mi><mo id="A1.p1.6.m6.1.1.1" xref="A1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="A1.p1.6.m6.1.1.3" xref="A1.p1.6.m6.1.1.3.cmml"><mi id="A1.p1.6.m6.1.1.3.2" xref="A1.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="A1.p1.6.m6.1.1.3.3" xref="A1.p1.6.m6.1.1.3.3.cmml"><mi id="A1.p1.6.m6.1.1.3.3.2" xref="A1.p1.6.m6.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="A1.p1.6.m6.1.1.3.3.1" xref="A1.p1.6.m6.1.1.3.3.1.cmml">×</mo><mi id="A1.p1.6.m6.1.1.3.3.3" xref="A1.p1.6.m6.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><apply id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"><in id="A1.p1.6.m6.1.1.1.cmml" xref="A1.p1.6.m6.1.1.1"></in><ci id="A1.p1.6.m6.1.1.2.cmml" xref="A1.p1.6.m6.1.1.2">ℎ</ci><apply id="A1.p1.6.m6.1.1.3.cmml" xref="A1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.p1.6.m6.1.1.3.1.cmml" xref="A1.p1.6.m6.1.1.3">superscript</csymbol><ci id="A1.p1.6.m6.1.1.3.2.cmml" xref="A1.p1.6.m6.1.1.3.2">ℝ</ci><apply id="A1.p1.6.m6.1.1.3.3.cmml" xref="A1.p1.6.m6.1.1.3.3"><times id="A1.p1.6.m6.1.1.3.3.1.cmml" xref="A1.p1.6.m6.1.1.3.3.1"></times><ci id="A1.p1.6.m6.1.1.3.3.2.cmml" xref="A1.p1.6.m6.1.1.3.3.2">𝐿</ci><ci id="A1.p1.6.m6.1.1.3.3.3.cmml" xref="A1.p1.6.m6.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">h\in\mathbb{R}^{L\times D}</annotation></semantics></math> and the query, key, and value as <math id="A1.p1.7.m7.2" class="ltx_Math" alttext="h_{Q},h_{K}" display="inline"><semantics id="A1.p1.7.m7.2a"><mrow id="A1.p1.7.m7.2.2.2" xref="A1.p1.7.m7.2.2.3.cmml"><msub id="A1.p1.7.m7.1.1.1.1" xref="A1.p1.7.m7.1.1.1.1.cmml"><mi id="A1.p1.7.m7.1.1.1.1.2" xref="A1.p1.7.m7.1.1.1.1.2.cmml">h</mi><mi id="A1.p1.7.m7.1.1.1.1.3" xref="A1.p1.7.m7.1.1.1.1.3.cmml">Q</mi></msub><mo id="A1.p1.7.m7.2.2.2.3" xref="A1.p1.7.m7.2.2.3.cmml">,</mo><msub id="A1.p1.7.m7.2.2.2.2" xref="A1.p1.7.m7.2.2.2.2.cmml"><mi id="A1.p1.7.m7.2.2.2.2.2" xref="A1.p1.7.m7.2.2.2.2.2.cmml">h</mi><mi id="A1.p1.7.m7.2.2.2.2.3" xref="A1.p1.7.m7.2.2.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.2b"><list id="A1.p1.7.m7.2.2.3.cmml" xref="A1.p1.7.m7.2.2.2"><apply id="A1.p1.7.m7.1.1.1.1.cmml" xref="A1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.7.m7.1.1.1.1.1.cmml" xref="A1.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="A1.p1.7.m7.1.1.1.1.2.cmml" xref="A1.p1.7.m7.1.1.1.1.2">ℎ</ci><ci id="A1.p1.7.m7.1.1.1.1.3.cmml" xref="A1.p1.7.m7.1.1.1.1.3">𝑄</ci></apply><apply id="A1.p1.7.m7.2.2.2.2.cmml" xref="A1.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.7.m7.2.2.2.2.1.cmml" xref="A1.p1.7.m7.2.2.2.2">subscript</csymbol><ci id="A1.p1.7.m7.2.2.2.2.2.cmml" xref="A1.p1.7.m7.2.2.2.2.2">ℎ</ci><ci id="A1.p1.7.m7.2.2.2.2.3.cmml" xref="A1.p1.7.m7.2.2.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.2c">h_{Q},h_{K}</annotation></semantics></math>, and <math id="A1.p1.8.m8.1" class="ltx_Math" alttext="h_{V}" display="inline"><semantics id="A1.p1.8.m8.1a"><msub id="A1.p1.8.m8.1.1" xref="A1.p1.8.m8.1.1.cmml"><mi id="A1.p1.8.m8.1.1.2" xref="A1.p1.8.m8.1.1.2.cmml">h</mi><mi id="A1.p1.8.m8.1.1.3" xref="A1.p1.8.m8.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.1b"><apply id="A1.p1.8.m8.1.1.cmml" xref="A1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.p1.8.m8.1.1.1.cmml" xref="A1.p1.8.m8.1.1">subscript</csymbol><ci id="A1.p1.8.m8.1.1.2.cmml" xref="A1.p1.8.m8.1.1.2">ℎ</ci><ci id="A1.p1.8.m8.1.1.3.cmml" xref="A1.p1.8.m8.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.1c">h_{V}</annotation></semantics></math>. A prompt <math id="A1.p1.9.m9.1" class="ltx_Math" alttext="p" display="inline"><semantics id="A1.p1.9.m9.1a"><mi id="A1.p1.9.m9.1.1" xref="A1.p1.9.m9.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.p1.9.m9.1b"><ci id="A1.p1.9.m9.1.1.cmml" xref="A1.p1.9.m9.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m9.1c">p</annotation></semantics></math> is split into <math id="A1.p1.10.m10.2" class="ltx_Math" alttext="\{P_{K},P_{V}\}\in\mathbb{R}^{\frac{L_{p}}{2}\times D}" display="inline"><semantics id="A1.p1.10.m10.2a"><mrow id="A1.p1.10.m10.2.2" xref="A1.p1.10.m10.2.2.cmml"><mrow id="A1.p1.10.m10.2.2.2.2" xref="A1.p1.10.m10.2.2.2.3.cmml"><mo stretchy="false" id="A1.p1.10.m10.2.2.2.2.3" xref="A1.p1.10.m10.2.2.2.3.cmml">{</mo><msub id="A1.p1.10.m10.1.1.1.1.1" xref="A1.p1.10.m10.1.1.1.1.1.cmml"><mi id="A1.p1.10.m10.1.1.1.1.1.2" xref="A1.p1.10.m10.1.1.1.1.1.2.cmml">P</mi><mi id="A1.p1.10.m10.1.1.1.1.1.3" xref="A1.p1.10.m10.1.1.1.1.1.3.cmml">K</mi></msub><mo id="A1.p1.10.m10.2.2.2.2.4" xref="A1.p1.10.m10.2.2.2.3.cmml">,</mo><msub id="A1.p1.10.m10.2.2.2.2.2" xref="A1.p1.10.m10.2.2.2.2.2.cmml"><mi id="A1.p1.10.m10.2.2.2.2.2.2" xref="A1.p1.10.m10.2.2.2.2.2.2.cmml">P</mi><mi id="A1.p1.10.m10.2.2.2.2.2.3" xref="A1.p1.10.m10.2.2.2.2.2.3.cmml">V</mi></msub><mo stretchy="false" id="A1.p1.10.m10.2.2.2.2.5" xref="A1.p1.10.m10.2.2.2.3.cmml">}</mo></mrow><mo id="A1.p1.10.m10.2.2.3" xref="A1.p1.10.m10.2.2.3.cmml">∈</mo><msup id="A1.p1.10.m10.2.2.4" xref="A1.p1.10.m10.2.2.4.cmml"><mi id="A1.p1.10.m10.2.2.4.2" xref="A1.p1.10.m10.2.2.4.2.cmml">ℝ</mi><mrow id="A1.p1.10.m10.2.2.4.3" xref="A1.p1.10.m10.2.2.4.3.cmml"><mfrac id="A1.p1.10.m10.2.2.4.3.2" xref="A1.p1.10.m10.2.2.4.3.2.cmml"><msub id="A1.p1.10.m10.2.2.4.3.2.2" xref="A1.p1.10.m10.2.2.4.3.2.2.cmml"><mi id="A1.p1.10.m10.2.2.4.3.2.2.2" xref="A1.p1.10.m10.2.2.4.3.2.2.2.cmml">L</mi><mi id="A1.p1.10.m10.2.2.4.3.2.2.3" xref="A1.p1.10.m10.2.2.4.3.2.2.3.cmml">p</mi></msub><mn id="A1.p1.10.m10.2.2.4.3.2.3" xref="A1.p1.10.m10.2.2.4.3.2.3.cmml">2</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="A1.p1.10.m10.2.2.4.3.1" xref="A1.p1.10.m10.2.2.4.3.1.cmml">×</mo><mi id="A1.p1.10.m10.2.2.4.3.3" xref="A1.p1.10.m10.2.2.4.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.10.m10.2b"><apply id="A1.p1.10.m10.2.2.cmml" xref="A1.p1.10.m10.2.2"><in id="A1.p1.10.m10.2.2.3.cmml" xref="A1.p1.10.m10.2.2.3"></in><set id="A1.p1.10.m10.2.2.2.3.cmml" xref="A1.p1.10.m10.2.2.2.2"><apply id="A1.p1.10.m10.1.1.1.1.1.cmml" xref="A1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.10.m10.1.1.1.1.1.1.cmml" xref="A1.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="A1.p1.10.m10.1.1.1.1.1.2.cmml" xref="A1.p1.10.m10.1.1.1.1.1.2">𝑃</ci><ci id="A1.p1.10.m10.1.1.1.1.1.3.cmml" xref="A1.p1.10.m10.1.1.1.1.1.3">𝐾</ci></apply><apply id="A1.p1.10.m10.2.2.2.2.2.cmml" xref="A1.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.10.m10.2.2.2.2.2.1.cmml" xref="A1.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="A1.p1.10.m10.2.2.2.2.2.2.cmml" xref="A1.p1.10.m10.2.2.2.2.2.2">𝑃</ci><ci id="A1.p1.10.m10.2.2.2.2.2.3.cmml" xref="A1.p1.10.m10.2.2.2.2.2.3">𝑉</ci></apply></set><apply id="A1.p1.10.m10.2.2.4.cmml" xref="A1.p1.10.m10.2.2.4"><csymbol cd="ambiguous" id="A1.p1.10.m10.2.2.4.1.cmml" xref="A1.p1.10.m10.2.2.4">superscript</csymbol><ci id="A1.p1.10.m10.2.2.4.2.cmml" xref="A1.p1.10.m10.2.2.4.2">ℝ</ci><apply id="A1.p1.10.m10.2.2.4.3.cmml" xref="A1.p1.10.m10.2.2.4.3"><times id="A1.p1.10.m10.2.2.4.3.1.cmml" xref="A1.p1.10.m10.2.2.4.3.1"></times><apply id="A1.p1.10.m10.2.2.4.3.2.cmml" xref="A1.p1.10.m10.2.2.4.3.2"><divide id="A1.p1.10.m10.2.2.4.3.2.1.cmml" xref="A1.p1.10.m10.2.2.4.3.2"></divide><apply id="A1.p1.10.m10.2.2.4.3.2.2.cmml" xref="A1.p1.10.m10.2.2.4.3.2.2"><csymbol cd="ambiguous" id="A1.p1.10.m10.2.2.4.3.2.2.1.cmml" xref="A1.p1.10.m10.2.2.4.3.2.2">subscript</csymbol><ci id="A1.p1.10.m10.2.2.4.3.2.2.2.cmml" xref="A1.p1.10.m10.2.2.4.3.2.2.2">𝐿</ci><ci id="A1.p1.10.m10.2.2.4.3.2.2.3.cmml" xref="A1.p1.10.m10.2.2.4.3.2.2.3">𝑝</ci></apply><cn type="integer" id="A1.p1.10.m10.2.2.4.3.2.3.cmml" xref="A1.p1.10.m10.2.2.4.3.2.3">2</cn></apply><ci id="A1.p1.10.m10.2.2.4.3.3.cmml" xref="A1.p1.10.m10.2.2.4.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m10.2c">\{P_{K},P_{V}\}\in\mathbb{R}^{\frac{L_{p}}{2}\times D}</annotation></semantics></math>, which are respectively attached to the key and the value of this layer, i.e., <math id="A1.p1.11.m11.3" class="ltx_Math" alttext="MSA(h_{Q},[P_{K};h_{K}],[P_{V};h_{V}])" display="inline"><semantics id="A1.p1.11.m11.3a"><mrow id="A1.p1.11.m11.3.3" xref="A1.p1.11.m11.3.3.cmml"><mi id="A1.p1.11.m11.3.3.5" xref="A1.p1.11.m11.3.3.5.cmml">M</mi><mo lspace="0em" rspace="0em" id="A1.p1.11.m11.3.3.4" xref="A1.p1.11.m11.3.3.4.cmml">​</mo><mi id="A1.p1.11.m11.3.3.6" xref="A1.p1.11.m11.3.3.6.cmml">S</mi><mo lspace="0em" rspace="0em" id="A1.p1.11.m11.3.3.4a" xref="A1.p1.11.m11.3.3.4.cmml">​</mo><mi id="A1.p1.11.m11.3.3.7" xref="A1.p1.11.m11.3.3.7.cmml">A</mi><mo lspace="0em" rspace="0em" id="A1.p1.11.m11.3.3.4b" xref="A1.p1.11.m11.3.3.4.cmml">​</mo><mrow id="A1.p1.11.m11.3.3.3.3" xref="A1.p1.11.m11.3.3.3.4.cmml"><mo stretchy="false" id="A1.p1.11.m11.3.3.3.3.4" xref="A1.p1.11.m11.3.3.3.4.cmml">(</mo><msub id="A1.p1.11.m11.1.1.1.1.1" xref="A1.p1.11.m11.1.1.1.1.1.cmml"><mi id="A1.p1.11.m11.1.1.1.1.1.2" xref="A1.p1.11.m11.1.1.1.1.1.2.cmml">h</mi><mi id="A1.p1.11.m11.1.1.1.1.1.3" xref="A1.p1.11.m11.1.1.1.1.1.3.cmml">Q</mi></msub><mo id="A1.p1.11.m11.3.3.3.3.5" xref="A1.p1.11.m11.3.3.3.4.cmml">,</mo><mrow id="A1.p1.11.m11.2.2.2.2.2.2" xref="A1.p1.11.m11.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.p1.11.m11.2.2.2.2.2.2.3" xref="A1.p1.11.m11.2.2.2.2.2.3.cmml">[</mo><msub id="A1.p1.11.m11.2.2.2.2.2.1.1" xref="A1.p1.11.m11.2.2.2.2.2.1.1.cmml"><mi id="A1.p1.11.m11.2.2.2.2.2.1.1.2" xref="A1.p1.11.m11.2.2.2.2.2.1.1.2.cmml">P</mi><mi id="A1.p1.11.m11.2.2.2.2.2.1.1.3" xref="A1.p1.11.m11.2.2.2.2.2.1.1.3.cmml">K</mi></msub><mo id="A1.p1.11.m11.2.2.2.2.2.2.4" xref="A1.p1.11.m11.2.2.2.2.2.3.cmml">;</mo><msub id="A1.p1.11.m11.2.2.2.2.2.2.2" xref="A1.p1.11.m11.2.2.2.2.2.2.2.cmml"><mi id="A1.p1.11.m11.2.2.2.2.2.2.2.2" xref="A1.p1.11.m11.2.2.2.2.2.2.2.2.cmml">h</mi><mi id="A1.p1.11.m11.2.2.2.2.2.2.2.3" xref="A1.p1.11.m11.2.2.2.2.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="A1.p1.11.m11.2.2.2.2.2.2.5" xref="A1.p1.11.m11.2.2.2.2.2.3.cmml">]</mo></mrow><mo id="A1.p1.11.m11.3.3.3.3.6" xref="A1.p1.11.m11.3.3.3.4.cmml">,</mo><mrow id="A1.p1.11.m11.3.3.3.3.3.2" xref="A1.p1.11.m11.3.3.3.3.3.3.cmml"><mo stretchy="false" id="A1.p1.11.m11.3.3.3.3.3.2.3" xref="A1.p1.11.m11.3.3.3.3.3.3.cmml">[</mo><msub id="A1.p1.11.m11.3.3.3.3.3.1.1" xref="A1.p1.11.m11.3.3.3.3.3.1.1.cmml"><mi id="A1.p1.11.m11.3.3.3.3.3.1.1.2" xref="A1.p1.11.m11.3.3.3.3.3.1.1.2.cmml">P</mi><mi id="A1.p1.11.m11.3.3.3.3.3.1.1.3" xref="A1.p1.11.m11.3.3.3.3.3.1.1.3.cmml">V</mi></msub><mo id="A1.p1.11.m11.3.3.3.3.3.2.4" xref="A1.p1.11.m11.3.3.3.3.3.3.cmml">;</mo><msub id="A1.p1.11.m11.3.3.3.3.3.2.2" xref="A1.p1.11.m11.3.3.3.3.3.2.2.cmml"><mi id="A1.p1.11.m11.3.3.3.3.3.2.2.2" xref="A1.p1.11.m11.3.3.3.3.3.2.2.2.cmml">h</mi><mi id="A1.p1.11.m11.3.3.3.3.3.2.2.3" xref="A1.p1.11.m11.3.3.3.3.3.2.2.3.cmml">V</mi></msub><mo stretchy="false" id="A1.p1.11.m11.3.3.3.3.3.2.5" xref="A1.p1.11.m11.3.3.3.3.3.3.cmml">]</mo></mrow><mo stretchy="false" id="A1.p1.11.m11.3.3.3.3.7" xref="A1.p1.11.m11.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.11.m11.3b"><apply id="A1.p1.11.m11.3.3.cmml" xref="A1.p1.11.m11.3.3"><times id="A1.p1.11.m11.3.3.4.cmml" xref="A1.p1.11.m11.3.3.4"></times><ci id="A1.p1.11.m11.3.3.5.cmml" xref="A1.p1.11.m11.3.3.5">𝑀</ci><ci id="A1.p1.11.m11.3.3.6.cmml" xref="A1.p1.11.m11.3.3.6">𝑆</ci><ci id="A1.p1.11.m11.3.3.7.cmml" xref="A1.p1.11.m11.3.3.7">𝐴</ci><vector id="A1.p1.11.m11.3.3.3.4.cmml" xref="A1.p1.11.m11.3.3.3.3"><apply id="A1.p1.11.m11.1.1.1.1.1.cmml" xref="A1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.11.m11.1.1.1.1.1.1.cmml" xref="A1.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="A1.p1.11.m11.1.1.1.1.1.2.cmml" xref="A1.p1.11.m11.1.1.1.1.1.2">ℎ</ci><ci id="A1.p1.11.m11.1.1.1.1.1.3.cmml" xref="A1.p1.11.m11.1.1.1.1.1.3">𝑄</ci></apply><list id="A1.p1.11.m11.2.2.2.2.2.3.cmml" xref="A1.p1.11.m11.2.2.2.2.2.2"><apply id="A1.p1.11.m11.2.2.2.2.2.1.1.cmml" xref="A1.p1.11.m11.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.p1.11.m11.2.2.2.2.2.1.1.1.cmml" xref="A1.p1.11.m11.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.p1.11.m11.2.2.2.2.2.1.1.2.cmml" xref="A1.p1.11.m11.2.2.2.2.2.1.1.2">𝑃</ci><ci id="A1.p1.11.m11.2.2.2.2.2.1.1.3.cmml" xref="A1.p1.11.m11.2.2.2.2.2.1.1.3">𝐾</ci></apply><apply id="A1.p1.11.m11.2.2.2.2.2.2.2.cmml" xref="A1.p1.11.m11.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.11.m11.2.2.2.2.2.2.2.1.cmml" xref="A1.p1.11.m11.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.p1.11.m11.2.2.2.2.2.2.2.2.cmml" xref="A1.p1.11.m11.2.2.2.2.2.2.2.2">ℎ</ci><ci id="A1.p1.11.m11.2.2.2.2.2.2.2.3.cmml" xref="A1.p1.11.m11.2.2.2.2.2.2.2.3">𝐾</ci></apply></list><list id="A1.p1.11.m11.3.3.3.3.3.3.cmml" xref="A1.p1.11.m11.3.3.3.3.3.2"><apply id="A1.p1.11.m11.3.3.3.3.3.1.1.cmml" xref="A1.p1.11.m11.3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.p1.11.m11.3.3.3.3.3.1.1.1.cmml" xref="A1.p1.11.m11.3.3.3.3.3.1.1">subscript</csymbol><ci id="A1.p1.11.m11.3.3.3.3.3.1.1.2.cmml" xref="A1.p1.11.m11.3.3.3.3.3.1.1.2">𝑃</ci><ci id="A1.p1.11.m11.3.3.3.3.3.1.1.3.cmml" xref="A1.p1.11.m11.3.3.3.3.3.1.1.3">𝑉</ci></apply><apply id="A1.p1.11.m11.3.3.3.3.3.2.2.cmml" xref="A1.p1.11.m11.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.p1.11.m11.3.3.3.3.3.2.2.1.cmml" xref="A1.p1.11.m11.3.3.3.3.3.2.2">subscript</csymbol><ci id="A1.p1.11.m11.3.3.3.3.3.2.2.2.cmml" xref="A1.p1.11.m11.3.3.3.3.3.2.2.2">ℎ</ci><ci id="A1.p1.11.m11.3.3.3.3.3.2.2.3.cmml" xref="A1.p1.11.m11.3.3.3.3.3.2.2.3">𝑉</ci></apply></list></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m11.3c">MSA(h_{Q},[P_{K};h_{K}],[P_{V};h_{V}])</annotation></semantics></math>. where <math id="A1.p1.12.m12.2" class="ltx_Math" alttext="[\cdot;\cdot]" display="inline"><semantics id="A1.p1.12.m12.2a"><mrow id="A1.p1.12.m12.2.3.2" xref="A1.p1.12.m12.2.3.1.cmml"><mo stretchy="false" id="A1.p1.12.m12.2.3.2.1" xref="A1.p1.12.m12.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="A1.p1.12.m12.1.1" xref="A1.p1.12.m12.1.1.cmml">⋅</mo><mo rspace="0em" id="A1.p1.12.m12.2.3.2.2" xref="A1.p1.12.m12.2.3.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="A1.p1.12.m12.2.2" xref="A1.p1.12.m12.2.2.cmml">⋅</mo><mo stretchy="false" id="A1.p1.12.m12.2.3.2.3" xref="A1.p1.12.m12.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.12.m12.2b"><list id="A1.p1.12.m12.2.3.1.cmml" xref="A1.p1.12.m12.2.3.2"><ci id="A1.p1.12.m12.1.1.cmml" xref="A1.p1.12.m12.1.1">⋅</ci><ci id="A1.p1.12.m12.2.2.cmml" xref="A1.p1.12.m12.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.12.m12.2c">[\cdot;\cdot]</annotation></semantics></math> is a concatenation operation. Since CODA-P achieves SOTA centralized continual learning performance, we adopt the weighted prompt for local training, and the prompt for task <math id="A1.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A1.p1.13.m13.1a"><msub id="A1.p1.13.m13.1.1" xref="A1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.13.m13.1.1.2" xref="A1.p1.13.m13.1.1.2.cmml">𝒯</mi><mi id="A1.p1.13.m13.1.1.3" xref="A1.p1.13.m13.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.13.m13.1b"><apply id="A1.p1.13.m13.1.1.cmml" xref="A1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="A1.p1.13.m13.1.1.1.cmml" xref="A1.p1.13.m13.1.1">subscript</csymbol><ci id="A1.p1.13.m13.1.1.2.cmml" xref="A1.p1.13.m13.1.1.2">𝒯</ci><ci id="A1.p1.13.m13.1.1.3.cmml" xref="A1.p1.13.m13.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.13.m13.1c">\mathcal{T}_{m}</annotation></semantics></math> can be calculated by</p>
<table id="A1.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E5.m1.3" class="ltx_Math" alttext="{p}^{\mathcal{T}_{m}}=\sum_{i\in[1,m]}\alpha^{\mathcal{T}_{i}}P^{\mathcal{T}_{i}}," display="block"><semantics id="A1.E5.m1.3a"><mrow id="A1.E5.m1.3.3.1" xref="A1.E5.m1.3.3.1.1.cmml"><mrow id="A1.E5.m1.3.3.1.1" xref="A1.E5.m1.3.3.1.1.cmml"><msup id="A1.E5.m1.3.3.1.1.2" xref="A1.E5.m1.3.3.1.1.2.cmml"><mi id="A1.E5.m1.3.3.1.1.2.2" xref="A1.E5.m1.3.3.1.1.2.2.cmml">p</mi><msub id="A1.E5.m1.3.3.1.1.2.3" xref="A1.E5.m1.3.3.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.3.3.1.1.2.3.2" xref="A1.E5.m1.3.3.1.1.2.3.2.cmml">𝒯</mi><mi id="A1.E5.m1.3.3.1.1.2.3.3" xref="A1.E5.m1.3.3.1.1.2.3.3.cmml">m</mi></msub></msup><mo rspace="0.111em" id="A1.E5.m1.3.3.1.1.1" xref="A1.E5.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E5.m1.3.3.1.1.3" xref="A1.E5.m1.3.3.1.1.3.cmml"><munder id="A1.E5.m1.3.3.1.1.3.1" xref="A1.E5.m1.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="A1.E5.m1.3.3.1.1.3.1.2" xref="A1.E5.m1.3.3.1.1.3.1.2.cmml">∑</mo><mrow id="A1.E5.m1.2.2.2" xref="A1.E5.m1.2.2.2.cmml"><mi id="A1.E5.m1.2.2.2.4" xref="A1.E5.m1.2.2.2.4.cmml">i</mi><mo id="A1.E5.m1.2.2.2.3" xref="A1.E5.m1.2.2.2.3.cmml">∈</mo><mrow id="A1.E5.m1.2.2.2.5.2" xref="A1.E5.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="A1.E5.m1.2.2.2.5.2.1" xref="A1.E5.m1.2.2.2.5.1.cmml">[</mo><mn id="A1.E5.m1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.cmml">1</mn><mo id="A1.E5.m1.2.2.2.5.2.2" xref="A1.E5.m1.2.2.2.5.1.cmml">,</mo><mi id="A1.E5.m1.2.2.2.2" xref="A1.E5.m1.2.2.2.2.cmml">m</mi><mo stretchy="false" id="A1.E5.m1.2.2.2.5.2.3" xref="A1.E5.m1.2.2.2.5.1.cmml">]</mo></mrow></mrow></munder><mrow id="A1.E5.m1.3.3.1.1.3.2" xref="A1.E5.m1.3.3.1.1.3.2.cmml"><msup id="A1.E5.m1.3.3.1.1.3.2.2" xref="A1.E5.m1.3.3.1.1.3.2.2.cmml"><mi id="A1.E5.m1.3.3.1.1.3.2.2.2" xref="A1.E5.m1.3.3.1.1.3.2.2.2.cmml">α</mi><msub id="A1.E5.m1.3.3.1.1.3.2.2.3" xref="A1.E5.m1.3.3.1.1.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.3.3.1.1.3.2.2.3.2" xref="A1.E5.m1.3.3.1.1.3.2.2.3.2.cmml">𝒯</mi><mi id="A1.E5.m1.3.3.1.1.3.2.2.3.3" xref="A1.E5.m1.3.3.1.1.3.2.2.3.3.cmml">i</mi></msub></msup><mo lspace="0em" rspace="0em" id="A1.E5.m1.3.3.1.1.3.2.1" xref="A1.E5.m1.3.3.1.1.3.2.1.cmml">​</mo><msup id="A1.E5.m1.3.3.1.1.3.2.3" xref="A1.E5.m1.3.3.1.1.3.2.3.cmml"><mi id="A1.E5.m1.3.3.1.1.3.2.3.2" xref="A1.E5.m1.3.3.1.1.3.2.3.2.cmml">P</mi><msub id="A1.E5.m1.3.3.1.1.3.2.3.3" xref="A1.E5.m1.3.3.1.1.3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.3.3.1.1.3.2.3.3.2" xref="A1.E5.m1.3.3.1.1.3.2.3.3.2.cmml">𝒯</mi><mi id="A1.E5.m1.3.3.1.1.3.2.3.3.3" xref="A1.E5.m1.3.3.1.1.3.2.3.3.3.cmml">i</mi></msub></msup></mrow></mrow></mrow><mo id="A1.E5.m1.3.3.1.2" xref="A1.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.3b"><apply id="A1.E5.m1.3.3.1.1.cmml" xref="A1.E5.m1.3.3.1"><eq id="A1.E5.m1.3.3.1.1.1.cmml" xref="A1.E5.m1.3.3.1.1.1"></eq><apply id="A1.E5.m1.3.3.1.1.2.cmml" xref="A1.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.2.1.cmml" xref="A1.E5.m1.3.3.1.1.2">superscript</csymbol><ci id="A1.E5.m1.3.3.1.1.2.2.cmml" xref="A1.E5.m1.3.3.1.1.2.2">𝑝</ci><apply id="A1.E5.m1.3.3.1.1.2.3.cmml" xref="A1.E5.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.2.3.1.cmml" xref="A1.E5.m1.3.3.1.1.2.3">subscript</csymbol><ci id="A1.E5.m1.3.3.1.1.2.3.2.cmml" xref="A1.E5.m1.3.3.1.1.2.3.2">𝒯</ci><ci id="A1.E5.m1.3.3.1.1.2.3.3.cmml" xref="A1.E5.m1.3.3.1.1.2.3.3">𝑚</ci></apply></apply><apply id="A1.E5.m1.3.3.1.1.3.cmml" xref="A1.E5.m1.3.3.1.1.3"><apply id="A1.E5.m1.3.3.1.1.3.1.cmml" xref="A1.E5.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.3.1.1.cmml" xref="A1.E5.m1.3.3.1.1.3.1">subscript</csymbol><sum id="A1.E5.m1.3.3.1.1.3.1.2.cmml" xref="A1.E5.m1.3.3.1.1.3.1.2"></sum><apply id="A1.E5.m1.2.2.2.cmml" xref="A1.E5.m1.2.2.2"><in id="A1.E5.m1.2.2.2.3.cmml" xref="A1.E5.m1.2.2.2.3"></in><ci id="A1.E5.m1.2.2.2.4.cmml" xref="A1.E5.m1.2.2.2.4">𝑖</ci><interval closure="closed" id="A1.E5.m1.2.2.2.5.1.cmml" xref="A1.E5.m1.2.2.2.5.2"><cn type="integer" id="A1.E5.m1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1.1">1</cn><ci id="A1.E5.m1.2.2.2.2.cmml" xref="A1.E5.m1.2.2.2.2">𝑚</ci></interval></apply></apply><apply id="A1.E5.m1.3.3.1.1.3.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2"><times id="A1.E5.m1.3.3.1.1.3.2.1.cmml" xref="A1.E5.m1.3.3.1.1.3.2.1"></times><apply id="A1.E5.m1.3.3.1.1.3.2.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.3.2.2.1.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2">superscript</csymbol><ci id="A1.E5.m1.3.3.1.1.3.2.2.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2.2">𝛼</ci><apply id="A1.E5.m1.3.3.1.1.3.2.2.3.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.3.2.2.3.1.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="A1.E5.m1.3.3.1.1.3.2.2.3.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2.3.2">𝒯</ci><ci id="A1.E5.m1.3.3.1.1.3.2.2.3.3.cmml" xref="A1.E5.m1.3.3.1.1.3.2.2.3.3">𝑖</ci></apply></apply><apply id="A1.E5.m1.3.3.1.1.3.2.3.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.3.2.3.1.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3">superscript</csymbol><ci id="A1.E5.m1.3.3.1.1.3.2.3.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3.2">𝑃</ci><apply id="A1.E5.m1.3.3.1.1.3.2.3.3.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.1.1.3.2.3.3.1.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E5.m1.3.3.1.1.3.2.3.3.2.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3.3.2">𝒯</ci><ci id="A1.E5.m1.3.3.1.1.3.2.3.3.3.cmml" xref="A1.E5.m1.3.3.1.1.3.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.3c">{p}^{\mathcal{T}_{m}}=\sum_{i\in[1,m]}\alpha^{\mathcal{T}_{i}}P^{\mathcal{T}_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="A1.p1.27" class="ltx_p">where <math id="A1.p1.14.m1.1" class="ltx_Math" alttext="P^{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.14.m1.1a"><msup id="A1.p1.14.m1.1.1" xref="A1.p1.14.m1.1.1.cmml"><mi id="A1.p1.14.m1.1.1.2" xref="A1.p1.14.m1.1.1.2.cmml">P</mi><msub id="A1.p1.14.m1.1.1.3" xref="A1.p1.14.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.14.m1.1.1.3.2" xref="A1.p1.14.m1.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.14.m1.1.1.3.3" xref="A1.p1.14.m1.1.1.3.3.cmml">m</mi></msub></msup><annotation-xml encoding="MathML-Content" id="A1.p1.14.m1.1b"><apply id="A1.p1.14.m1.1.1.cmml" xref="A1.p1.14.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.14.m1.1.1.1.cmml" xref="A1.p1.14.m1.1.1">superscript</csymbol><ci id="A1.p1.14.m1.1.1.2.cmml" xref="A1.p1.14.m1.1.1.2">𝑃</ci><apply id="A1.p1.14.m1.1.1.3.cmml" xref="A1.p1.14.m1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.14.m1.1.1.3.1.cmml" xref="A1.p1.14.m1.1.1.3">subscript</csymbol><ci id="A1.p1.14.m1.1.1.3.2.cmml" xref="A1.p1.14.m1.1.1.3.2">𝒯</ci><ci id="A1.p1.14.m1.1.1.3.3.cmml" xref="A1.p1.14.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.14.m1.1c">P^{\mathcal{T}_{m}}</annotation></semantics></math> is a learnable prompt to the current task <math id="A1.p1.15.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A1.p1.15.m2.1a"><msub id="A1.p1.15.m2.1.1" xref="A1.p1.15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.15.m2.1.1.2" xref="A1.p1.15.m2.1.1.2.cmml">𝒯</mi><mi id="A1.p1.15.m2.1.1.3" xref="A1.p1.15.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.15.m2.1b"><apply id="A1.p1.15.m2.1.1.cmml" xref="A1.p1.15.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.15.m2.1.1.1.cmml" xref="A1.p1.15.m2.1.1">subscript</csymbol><ci id="A1.p1.15.m2.1.1.2.cmml" xref="A1.p1.15.m2.1.1.2">𝒯</ci><ci id="A1.p1.15.m2.1.1.3.cmml" xref="A1.p1.15.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.15.m2.1c">\mathcal{T}_{m}</annotation></semantics></math>, <math id="A1.p1.16.m3.3" class="ltx_Math" alttext="\alpha^{\mathcal{T}_{m}}=\gamma(q(x)\odot A^{\mathcal{T}_{m}},K^{\mathcal{T}_{m}})" display="inline"><semantics id="A1.p1.16.m3.3a"><mrow id="A1.p1.16.m3.3.3" xref="A1.p1.16.m3.3.3.cmml"><msup id="A1.p1.16.m3.3.3.4" xref="A1.p1.16.m3.3.3.4.cmml"><mi id="A1.p1.16.m3.3.3.4.2" xref="A1.p1.16.m3.3.3.4.2.cmml">α</mi><msub id="A1.p1.16.m3.3.3.4.3" xref="A1.p1.16.m3.3.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.16.m3.3.3.4.3.2" xref="A1.p1.16.m3.3.3.4.3.2.cmml">𝒯</mi><mi id="A1.p1.16.m3.3.3.4.3.3" xref="A1.p1.16.m3.3.3.4.3.3.cmml">m</mi></msub></msup><mo id="A1.p1.16.m3.3.3.3" xref="A1.p1.16.m3.3.3.3.cmml">=</mo><mrow id="A1.p1.16.m3.3.3.2" xref="A1.p1.16.m3.3.3.2.cmml"><mi id="A1.p1.16.m3.3.3.2.4" xref="A1.p1.16.m3.3.3.2.4.cmml">γ</mi><mo lspace="0em" rspace="0em" id="A1.p1.16.m3.3.3.2.3" xref="A1.p1.16.m3.3.3.2.3.cmml">​</mo><mrow id="A1.p1.16.m3.3.3.2.2.2" xref="A1.p1.16.m3.3.3.2.2.3.cmml"><mo stretchy="false" id="A1.p1.16.m3.3.3.2.2.2.3" xref="A1.p1.16.m3.3.3.2.2.3.cmml">(</mo><mrow id="A1.p1.16.m3.2.2.1.1.1.1" xref="A1.p1.16.m3.2.2.1.1.1.1.cmml"><mrow id="A1.p1.16.m3.2.2.1.1.1.1.2" xref="A1.p1.16.m3.2.2.1.1.1.1.2.cmml"><mi id="A1.p1.16.m3.2.2.1.1.1.1.2.2" xref="A1.p1.16.m3.2.2.1.1.1.1.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="A1.p1.16.m3.2.2.1.1.1.1.2.1" xref="A1.p1.16.m3.2.2.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.p1.16.m3.2.2.1.1.1.1.2.3.2" xref="A1.p1.16.m3.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.p1.16.m3.2.2.1.1.1.1.2.3.2.1" xref="A1.p1.16.m3.2.2.1.1.1.1.2.cmml">(</mo><mi id="A1.p1.16.m3.1.1" xref="A1.p1.16.m3.1.1.cmml">x</mi><mo rspace="0.055em" stretchy="false" id="A1.p1.16.m3.2.2.1.1.1.1.2.3.2.2" xref="A1.p1.16.m3.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A1.p1.16.m3.2.2.1.1.1.1.1" xref="A1.p1.16.m3.2.2.1.1.1.1.1.cmml">⊙</mo><msup id="A1.p1.16.m3.2.2.1.1.1.1.3" xref="A1.p1.16.m3.2.2.1.1.1.1.3.cmml"><mi id="A1.p1.16.m3.2.2.1.1.1.1.3.2" xref="A1.p1.16.m3.2.2.1.1.1.1.3.2.cmml">A</mi><msub id="A1.p1.16.m3.2.2.1.1.1.1.3.3" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.16.m3.2.2.1.1.1.1.3.3.2" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3.2.cmml">𝒯</mi><mi id="A1.p1.16.m3.2.2.1.1.1.1.3.3.3" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3.3.cmml">m</mi></msub></msup></mrow><mo id="A1.p1.16.m3.3.3.2.2.2.4" xref="A1.p1.16.m3.3.3.2.2.3.cmml">,</mo><msup id="A1.p1.16.m3.3.3.2.2.2.2" xref="A1.p1.16.m3.3.3.2.2.2.2.cmml"><mi id="A1.p1.16.m3.3.3.2.2.2.2.2" xref="A1.p1.16.m3.3.3.2.2.2.2.2.cmml">K</mi><msub id="A1.p1.16.m3.3.3.2.2.2.2.3" xref="A1.p1.16.m3.3.3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.16.m3.3.3.2.2.2.2.3.2" xref="A1.p1.16.m3.3.3.2.2.2.2.3.2.cmml">𝒯</mi><mi id="A1.p1.16.m3.3.3.2.2.2.2.3.3" xref="A1.p1.16.m3.3.3.2.2.2.2.3.3.cmml">m</mi></msub></msup><mo stretchy="false" id="A1.p1.16.m3.3.3.2.2.2.5" xref="A1.p1.16.m3.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.16.m3.3b"><apply id="A1.p1.16.m3.3.3.cmml" xref="A1.p1.16.m3.3.3"><eq id="A1.p1.16.m3.3.3.3.cmml" xref="A1.p1.16.m3.3.3.3"></eq><apply id="A1.p1.16.m3.3.3.4.cmml" xref="A1.p1.16.m3.3.3.4"><csymbol cd="ambiguous" id="A1.p1.16.m3.3.3.4.1.cmml" xref="A1.p1.16.m3.3.3.4">superscript</csymbol><ci id="A1.p1.16.m3.3.3.4.2.cmml" xref="A1.p1.16.m3.3.3.4.2">𝛼</ci><apply id="A1.p1.16.m3.3.3.4.3.cmml" xref="A1.p1.16.m3.3.3.4.3"><csymbol cd="ambiguous" id="A1.p1.16.m3.3.3.4.3.1.cmml" xref="A1.p1.16.m3.3.3.4.3">subscript</csymbol><ci id="A1.p1.16.m3.3.3.4.3.2.cmml" xref="A1.p1.16.m3.3.3.4.3.2">𝒯</ci><ci id="A1.p1.16.m3.3.3.4.3.3.cmml" xref="A1.p1.16.m3.3.3.4.3.3">𝑚</ci></apply></apply><apply id="A1.p1.16.m3.3.3.2.cmml" xref="A1.p1.16.m3.3.3.2"><times id="A1.p1.16.m3.3.3.2.3.cmml" xref="A1.p1.16.m3.3.3.2.3"></times><ci id="A1.p1.16.m3.3.3.2.4.cmml" xref="A1.p1.16.m3.3.3.2.4">𝛾</ci><interval closure="open" id="A1.p1.16.m3.3.3.2.2.3.cmml" xref="A1.p1.16.m3.3.3.2.2.2"><apply id="A1.p1.16.m3.2.2.1.1.1.1.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1"><csymbol cd="latexml" id="A1.p1.16.m3.2.2.1.1.1.1.1.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.1">direct-product</csymbol><apply id="A1.p1.16.m3.2.2.1.1.1.1.2.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.2"><times id="A1.p1.16.m3.2.2.1.1.1.1.2.1.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.2.1"></times><ci id="A1.p1.16.m3.2.2.1.1.1.1.2.2.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.2.2">𝑞</ci><ci id="A1.p1.16.m3.1.1.cmml" xref="A1.p1.16.m3.1.1">𝑥</ci></apply><apply id="A1.p1.16.m3.2.2.1.1.1.1.3.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.16.m3.2.2.1.1.1.1.3.1.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3">superscript</csymbol><ci id="A1.p1.16.m3.2.2.1.1.1.1.3.2.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3.2">𝐴</ci><apply id="A1.p1.16.m3.2.2.1.1.1.1.3.3.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.p1.16.m3.2.2.1.1.1.1.3.3.1.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="A1.p1.16.m3.2.2.1.1.1.1.3.3.2.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3.2">𝒯</ci><ci id="A1.p1.16.m3.2.2.1.1.1.1.3.3.3.cmml" xref="A1.p1.16.m3.2.2.1.1.1.1.3.3.3">𝑚</ci></apply></apply></apply><apply id="A1.p1.16.m3.3.3.2.2.2.2.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.16.m3.3.3.2.2.2.2.1.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2">superscript</csymbol><ci id="A1.p1.16.m3.3.3.2.2.2.2.2.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2.2">𝐾</ci><apply id="A1.p1.16.m3.3.3.2.2.2.2.3.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.p1.16.m3.3.3.2.2.2.2.3.1.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2.3">subscript</csymbol><ci id="A1.p1.16.m3.3.3.2.2.2.2.3.2.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2.3.2">𝒯</ci><ci id="A1.p1.16.m3.3.3.2.2.2.2.3.3.cmml" xref="A1.p1.16.m3.3.3.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.16.m3.3c">\alpha^{\mathcal{T}_{m}}=\gamma(q(x)\odot A^{\mathcal{T}_{m}},K^{\mathcal{T}_{m}})</annotation></semantics></math> measures the cosine similarity <math id="A1.p1.17.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.p1.17.m4.1a"><mi id="A1.p1.17.m4.1.1" xref="A1.p1.17.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.p1.17.m4.1b"><ci id="A1.p1.17.m4.1.1.cmml" xref="A1.p1.17.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.17.m4.1c">\gamma</annotation></semantics></math> between the attended query and the key, where the attended query defined by the element-wise product <math id="A1.p1.18.m5.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="A1.p1.18.m5.1a"><mo id="A1.p1.18.m5.1.1" xref="A1.p1.18.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="A1.p1.18.m5.1b"><csymbol cd="latexml" id="A1.p1.18.m5.1.1.cmml" xref="A1.p1.18.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.18.m5.1c">\odot</annotation></semantics></math> between query and learnable attention parameter. The query is produced as <math id="A1.p1.19.m6.3" class="ltx_Math" alttext="q(x)\in\mathbb{R}^{D}=f(x;{\theta})" display="inline"><semantics id="A1.p1.19.m6.3a"><mrow id="A1.p1.19.m6.3.4" xref="A1.p1.19.m6.3.4.cmml"><mrow id="A1.p1.19.m6.3.4.2" xref="A1.p1.19.m6.3.4.2.cmml"><mi id="A1.p1.19.m6.3.4.2.2" xref="A1.p1.19.m6.3.4.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="A1.p1.19.m6.3.4.2.1" xref="A1.p1.19.m6.3.4.2.1.cmml">​</mo><mrow id="A1.p1.19.m6.3.4.2.3.2" xref="A1.p1.19.m6.3.4.2.cmml"><mo stretchy="false" id="A1.p1.19.m6.3.4.2.3.2.1" xref="A1.p1.19.m6.3.4.2.cmml">(</mo><mi id="A1.p1.19.m6.1.1" xref="A1.p1.19.m6.1.1.cmml">x</mi><mo stretchy="false" id="A1.p1.19.m6.3.4.2.3.2.2" xref="A1.p1.19.m6.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.p1.19.m6.3.4.3" xref="A1.p1.19.m6.3.4.3.cmml">∈</mo><msup id="A1.p1.19.m6.3.4.4" xref="A1.p1.19.m6.3.4.4.cmml"><mi id="A1.p1.19.m6.3.4.4.2" xref="A1.p1.19.m6.3.4.4.2.cmml">ℝ</mi><mi id="A1.p1.19.m6.3.4.4.3" xref="A1.p1.19.m6.3.4.4.3.cmml">D</mi></msup><mo id="A1.p1.19.m6.3.4.5" xref="A1.p1.19.m6.3.4.5.cmml">=</mo><mrow id="A1.p1.19.m6.3.4.6" xref="A1.p1.19.m6.3.4.6.cmml"><mi id="A1.p1.19.m6.3.4.6.2" xref="A1.p1.19.m6.3.4.6.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.p1.19.m6.3.4.6.1" xref="A1.p1.19.m6.3.4.6.1.cmml">​</mo><mrow id="A1.p1.19.m6.3.4.6.3.2" xref="A1.p1.19.m6.3.4.6.3.1.cmml"><mo stretchy="false" id="A1.p1.19.m6.3.4.6.3.2.1" xref="A1.p1.19.m6.3.4.6.3.1.cmml">(</mo><mi id="A1.p1.19.m6.2.2" xref="A1.p1.19.m6.2.2.cmml">x</mi><mo id="A1.p1.19.m6.3.4.6.3.2.2" xref="A1.p1.19.m6.3.4.6.3.1.cmml">;</mo><mi id="A1.p1.19.m6.3.3" xref="A1.p1.19.m6.3.3.cmml">θ</mi><mo stretchy="false" id="A1.p1.19.m6.3.4.6.3.2.3" xref="A1.p1.19.m6.3.4.6.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.19.m6.3b"><apply id="A1.p1.19.m6.3.4.cmml" xref="A1.p1.19.m6.3.4"><and id="A1.p1.19.m6.3.4a.cmml" xref="A1.p1.19.m6.3.4"></and><apply id="A1.p1.19.m6.3.4b.cmml" xref="A1.p1.19.m6.3.4"><in id="A1.p1.19.m6.3.4.3.cmml" xref="A1.p1.19.m6.3.4.3"></in><apply id="A1.p1.19.m6.3.4.2.cmml" xref="A1.p1.19.m6.3.4.2"><times id="A1.p1.19.m6.3.4.2.1.cmml" xref="A1.p1.19.m6.3.4.2.1"></times><ci id="A1.p1.19.m6.3.4.2.2.cmml" xref="A1.p1.19.m6.3.4.2.2">𝑞</ci><ci id="A1.p1.19.m6.1.1.cmml" xref="A1.p1.19.m6.1.1">𝑥</ci></apply><apply id="A1.p1.19.m6.3.4.4.cmml" xref="A1.p1.19.m6.3.4.4"><csymbol cd="ambiguous" id="A1.p1.19.m6.3.4.4.1.cmml" xref="A1.p1.19.m6.3.4.4">superscript</csymbol><ci id="A1.p1.19.m6.3.4.4.2.cmml" xref="A1.p1.19.m6.3.4.4.2">ℝ</ci><ci id="A1.p1.19.m6.3.4.4.3.cmml" xref="A1.p1.19.m6.3.4.4.3">𝐷</ci></apply></apply><apply id="A1.p1.19.m6.3.4c.cmml" xref="A1.p1.19.m6.3.4"><eq id="A1.p1.19.m6.3.4.5.cmml" xref="A1.p1.19.m6.3.4.5"></eq><share href="#A1.p1.19.m6.3.4.4.cmml" id="A1.p1.19.m6.3.4d.cmml" xref="A1.p1.19.m6.3.4"></share><apply id="A1.p1.19.m6.3.4.6.cmml" xref="A1.p1.19.m6.3.4.6"><times id="A1.p1.19.m6.3.4.6.1.cmml" xref="A1.p1.19.m6.3.4.6.1"></times><ci id="A1.p1.19.m6.3.4.6.2.cmml" xref="A1.p1.19.m6.3.4.6.2">𝑓</ci><list id="A1.p1.19.m6.3.4.6.3.1.cmml" xref="A1.p1.19.m6.3.4.6.3.2"><ci id="A1.p1.19.m6.2.2.cmml" xref="A1.p1.19.m6.2.2">𝑥</ci><ci id="A1.p1.19.m6.3.3.cmml" xref="A1.p1.19.m6.3.3">𝜃</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.19.m6.3c">q(x)\in\mathbb{R}^{D}=f(x;{\theta})</annotation></semantics></math>, where <math id="A1.p1.20.m7.2" class="ltx_Math" alttext="f(\cdot;{\theta})" display="inline"><semantics id="A1.p1.20.m7.2a"><mrow id="A1.p1.20.m7.2.3" xref="A1.p1.20.m7.2.3.cmml"><mi id="A1.p1.20.m7.2.3.2" xref="A1.p1.20.m7.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.p1.20.m7.2.3.1" xref="A1.p1.20.m7.2.3.1.cmml">​</mo><mrow id="A1.p1.20.m7.2.3.3.2" xref="A1.p1.20.m7.2.3.3.1.cmml"><mo stretchy="false" id="A1.p1.20.m7.2.3.3.2.1" xref="A1.p1.20.m7.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.p1.20.m7.1.1" xref="A1.p1.20.m7.1.1.cmml">⋅</mo><mo id="A1.p1.20.m7.2.3.3.2.2" xref="A1.p1.20.m7.2.3.3.1.cmml">;</mo><mi id="A1.p1.20.m7.2.2" xref="A1.p1.20.m7.2.2.cmml">θ</mi><mo stretchy="false" id="A1.p1.20.m7.2.3.3.2.3" xref="A1.p1.20.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.20.m7.2b"><apply id="A1.p1.20.m7.2.3.cmml" xref="A1.p1.20.m7.2.3"><times id="A1.p1.20.m7.2.3.1.cmml" xref="A1.p1.20.m7.2.3.1"></times><ci id="A1.p1.20.m7.2.3.2.cmml" xref="A1.p1.20.m7.2.3.2">𝑓</ci><list id="A1.p1.20.m7.2.3.3.1.cmml" xref="A1.p1.20.m7.2.3.3.2"><ci id="A1.p1.20.m7.1.1.cmml" xref="A1.p1.20.m7.1.1">⋅</ci><ci id="A1.p1.20.m7.2.2.cmml" xref="A1.p1.20.m7.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.20.m7.2c">f(\cdot;{\theta})</annotation></semantics></math> is the encoder of the pre-trained ViT<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We refer the reader to sections 4.1 and 4.2 of the CODA-p <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite> paper for more details.</span></span></span>. For training task <math id="A1.p1.21.m8.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A1.p1.21.m8.1a"><msub id="A1.p1.21.m8.1.1" xref="A1.p1.21.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.21.m8.1.1.2" xref="A1.p1.21.m8.1.1.2.cmml">𝒯</mi><mi id="A1.p1.21.m8.1.1.3" xref="A1.p1.21.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.21.m8.1b"><apply id="A1.p1.21.m8.1.1.cmml" xref="A1.p1.21.m8.1.1"><csymbol cd="ambiguous" id="A1.p1.21.m8.1.1.1.cmml" xref="A1.p1.21.m8.1.1">subscript</csymbol><ci id="A1.p1.21.m8.1.1.2.cmml" xref="A1.p1.21.m8.1.1.2">𝒯</ci><ci id="A1.p1.21.m8.1.1.3.cmml" xref="A1.p1.21.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.21.m8.1c">\mathcal{T}_{m}</annotation></semantics></math>, the learnable parameters include <math id="A1.p1.22.m9.1" class="ltx_Math" alttext="P^{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.22.m9.1a"><msup id="A1.p1.22.m9.1.1" xref="A1.p1.22.m9.1.1.cmml"><mi id="A1.p1.22.m9.1.1.2" xref="A1.p1.22.m9.1.1.2.cmml">P</mi><msub id="A1.p1.22.m9.1.1.3" xref="A1.p1.22.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.22.m9.1.1.3.2" xref="A1.p1.22.m9.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.22.m9.1.1.3.3" xref="A1.p1.22.m9.1.1.3.3.cmml">m</mi></msub></msup><annotation-xml encoding="MathML-Content" id="A1.p1.22.m9.1b"><apply id="A1.p1.22.m9.1.1.cmml" xref="A1.p1.22.m9.1.1"><csymbol cd="ambiguous" id="A1.p1.22.m9.1.1.1.cmml" xref="A1.p1.22.m9.1.1">superscript</csymbol><ci id="A1.p1.22.m9.1.1.2.cmml" xref="A1.p1.22.m9.1.1.2">𝑃</ci><apply id="A1.p1.22.m9.1.1.3.cmml" xref="A1.p1.22.m9.1.1.3"><csymbol cd="ambiguous" id="A1.p1.22.m9.1.1.3.1.cmml" xref="A1.p1.22.m9.1.1.3">subscript</csymbol><ci id="A1.p1.22.m9.1.1.3.2.cmml" xref="A1.p1.22.m9.1.1.3.2">𝒯</ci><ci id="A1.p1.22.m9.1.1.3.3.cmml" xref="A1.p1.22.m9.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.22.m9.1c">P^{\mathcal{T}_{m}}</annotation></semantics></math>, <math id="A1.p1.23.m10.1" class="ltx_Math" alttext="K^{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.23.m10.1a"><msup id="A1.p1.23.m10.1.1" xref="A1.p1.23.m10.1.1.cmml"><mi id="A1.p1.23.m10.1.1.2" xref="A1.p1.23.m10.1.1.2.cmml">K</mi><msub id="A1.p1.23.m10.1.1.3" xref="A1.p1.23.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.23.m10.1.1.3.2" xref="A1.p1.23.m10.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.23.m10.1.1.3.3" xref="A1.p1.23.m10.1.1.3.3.cmml">m</mi></msub></msup><annotation-xml encoding="MathML-Content" id="A1.p1.23.m10.1b"><apply id="A1.p1.23.m10.1.1.cmml" xref="A1.p1.23.m10.1.1"><csymbol cd="ambiguous" id="A1.p1.23.m10.1.1.1.cmml" xref="A1.p1.23.m10.1.1">superscript</csymbol><ci id="A1.p1.23.m10.1.1.2.cmml" xref="A1.p1.23.m10.1.1.2">𝐾</ci><apply id="A1.p1.23.m10.1.1.3.cmml" xref="A1.p1.23.m10.1.1.3"><csymbol cd="ambiguous" id="A1.p1.23.m10.1.1.3.1.cmml" xref="A1.p1.23.m10.1.1.3">subscript</csymbol><ci id="A1.p1.23.m10.1.1.3.2.cmml" xref="A1.p1.23.m10.1.1.3.2">𝒯</ci><ci id="A1.p1.23.m10.1.1.3.3.cmml" xref="A1.p1.23.m10.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.23.m10.1c">K^{\mathcal{T}_{m}}</annotation></semantics></math>, <math id="A1.p1.24.m11.1" class="ltx_Math" alttext="A^{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.24.m11.1a"><msup id="A1.p1.24.m11.1.1" xref="A1.p1.24.m11.1.1.cmml"><mi id="A1.p1.24.m11.1.1.2" xref="A1.p1.24.m11.1.1.2.cmml">A</mi><msub id="A1.p1.24.m11.1.1.3" xref="A1.p1.24.m11.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.24.m11.1.1.3.2" xref="A1.p1.24.m11.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.24.m11.1.1.3.3" xref="A1.p1.24.m11.1.1.3.3.cmml">m</mi></msub></msup><annotation-xml encoding="MathML-Content" id="A1.p1.24.m11.1b"><apply id="A1.p1.24.m11.1.1.cmml" xref="A1.p1.24.m11.1.1"><csymbol cd="ambiguous" id="A1.p1.24.m11.1.1.1.cmml" xref="A1.p1.24.m11.1.1">superscript</csymbol><ci id="A1.p1.24.m11.1.1.2.cmml" xref="A1.p1.24.m11.1.1.2">𝐴</ci><apply id="A1.p1.24.m11.1.1.3.cmml" xref="A1.p1.24.m11.1.1.3"><csymbol cd="ambiguous" id="A1.p1.24.m11.1.1.3.1.cmml" xref="A1.p1.24.m11.1.1.3">subscript</csymbol><ci id="A1.p1.24.m11.1.1.3.2.cmml" xref="A1.p1.24.m11.1.1.3.2">𝒯</ci><ci id="A1.p1.24.m11.1.1.3.3.cmml" xref="A1.p1.24.m11.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.24.m11.1c">A^{\mathcal{T}_{m}}</annotation></semantics></math>, and the classification head <math id="A1.p1.25.m12.1" class="ltx_Math" alttext="\phi^{\mathcal{T}_{m}}" display="inline"><semantics id="A1.p1.25.m12.1a"><msup id="A1.p1.25.m12.1.1" xref="A1.p1.25.m12.1.1.cmml"><mi id="A1.p1.25.m12.1.1.2" xref="A1.p1.25.m12.1.1.2.cmml">ϕ</mi><msub id="A1.p1.25.m12.1.1.3" xref="A1.p1.25.m12.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.25.m12.1.1.3.2" xref="A1.p1.25.m12.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.25.m12.1.1.3.3" xref="A1.p1.25.m12.1.1.3.3.cmml">m</mi></msub></msup><annotation-xml encoding="MathML-Content" id="A1.p1.25.m12.1b"><apply id="A1.p1.25.m12.1.1.cmml" xref="A1.p1.25.m12.1.1"><csymbol cd="ambiguous" id="A1.p1.25.m12.1.1.1.cmml" xref="A1.p1.25.m12.1.1">superscript</csymbol><ci id="A1.p1.25.m12.1.1.2.cmml" xref="A1.p1.25.m12.1.1.2">italic-ϕ</ci><apply id="A1.p1.25.m12.1.1.3.cmml" xref="A1.p1.25.m12.1.1.3"><csymbol cd="ambiguous" id="A1.p1.25.m12.1.1.3.1.cmml" xref="A1.p1.25.m12.1.1.3">subscript</csymbol><ci id="A1.p1.25.m12.1.1.3.2.cmml" xref="A1.p1.25.m12.1.1.3.2">𝒯</ci><ci id="A1.p1.25.m12.1.1.3.3.cmml" xref="A1.p1.25.m12.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.25.m12.1c">\phi^{\mathcal{T}_{m}}</annotation></semantics></math>, whereas <math id="A1.p1.26.m13.4" class="ltx_Math" alttext="(\alpha^{\mathcal{T}_{i}},P^{\mathcal{T}_{i}})~{}\forall i\in[1,m-1]" display="inline"><semantics id="A1.p1.26.m13.4a"><mrow id="A1.p1.26.m13.4.4" xref="A1.p1.26.m13.4.4.cmml"><mrow id="A1.p1.26.m13.3.3.2" xref="A1.p1.26.m13.3.3.2.cmml"><mrow id="A1.p1.26.m13.3.3.2.2.2" xref="A1.p1.26.m13.3.3.2.2.3.cmml"><mo stretchy="false" id="A1.p1.26.m13.3.3.2.2.2.3" xref="A1.p1.26.m13.3.3.2.2.3.cmml">(</mo><msup id="A1.p1.26.m13.2.2.1.1.1.1" xref="A1.p1.26.m13.2.2.1.1.1.1.cmml"><mi id="A1.p1.26.m13.2.2.1.1.1.1.2" xref="A1.p1.26.m13.2.2.1.1.1.1.2.cmml">α</mi><msub id="A1.p1.26.m13.2.2.1.1.1.1.3" xref="A1.p1.26.m13.2.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.26.m13.2.2.1.1.1.1.3.2" xref="A1.p1.26.m13.2.2.1.1.1.1.3.2.cmml">𝒯</mi><mi id="A1.p1.26.m13.2.2.1.1.1.1.3.3" xref="A1.p1.26.m13.2.2.1.1.1.1.3.3.cmml">i</mi></msub></msup><mo id="A1.p1.26.m13.3.3.2.2.2.4" xref="A1.p1.26.m13.3.3.2.2.3.cmml">,</mo><msup id="A1.p1.26.m13.3.3.2.2.2.2" xref="A1.p1.26.m13.3.3.2.2.2.2.cmml"><mi id="A1.p1.26.m13.3.3.2.2.2.2.2" xref="A1.p1.26.m13.3.3.2.2.2.2.2.cmml">P</mi><msub id="A1.p1.26.m13.3.3.2.2.2.2.3" xref="A1.p1.26.m13.3.3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.26.m13.3.3.2.2.2.2.3.2" xref="A1.p1.26.m13.3.3.2.2.2.2.3.2.cmml">𝒯</mi><mi id="A1.p1.26.m13.3.3.2.2.2.2.3.3" xref="A1.p1.26.m13.3.3.2.2.2.2.3.3.cmml">i</mi></msub></msup><mo stretchy="false" id="A1.p1.26.m13.3.3.2.2.2.5" xref="A1.p1.26.m13.3.3.2.2.3.cmml">)</mo></mrow><mo lspace="0.497em" rspace="0em" id="A1.p1.26.m13.3.3.2.3" xref="A1.p1.26.m13.3.3.2.3.cmml">​</mo><mrow id="A1.p1.26.m13.3.3.2.4" xref="A1.p1.26.m13.3.3.2.4.cmml"><mo rspace="0.167em" id="A1.p1.26.m13.3.3.2.4.1" xref="A1.p1.26.m13.3.3.2.4.1.cmml">∀</mo><mi id="A1.p1.26.m13.3.3.2.4.2" xref="A1.p1.26.m13.3.3.2.4.2.cmml">i</mi></mrow></mrow><mo id="A1.p1.26.m13.4.4.4" xref="A1.p1.26.m13.4.4.4.cmml">∈</mo><mrow id="A1.p1.26.m13.4.4.3.1" xref="A1.p1.26.m13.4.4.3.2.cmml"><mo stretchy="false" id="A1.p1.26.m13.4.4.3.1.2" xref="A1.p1.26.m13.4.4.3.2.cmml">[</mo><mn id="A1.p1.26.m13.1.1" xref="A1.p1.26.m13.1.1.cmml">1</mn><mo id="A1.p1.26.m13.4.4.3.1.3" xref="A1.p1.26.m13.4.4.3.2.cmml">,</mo><mrow id="A1.p1.26.m13.4.4.3.1.1" xref="A1.p1.26.m13.4.4.3.1.1.cmml"><mi id="A1.p1.26.m13.4.4.3.1.1.2" xref="A1.p1.26.m13.4.4.3.1.1.2.cmml">m</mi><mo id="A1.p1.26.m13.4.4.3.1.1.1" xref="A1.p1.26.m13.4.4.3.1.1.1.cmml">−</mo><mn id="A1.p1.26.m13.4.4.3.1.1.3" xref="A1.p1.26.m13.4.4.3.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.p1.26.m13.4.4.3.1.4" xref="A1.p1.26.m13.4.4.3.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.26.m13.4b"><apply id="A1.p1.26.m13.4.4.cmml" xref="A1.p1.26.m13.4.4"><in id="A1.p1.26.m13.4.4.4.cmml" xref="A1.p1.26.m13.4.4.4"></in><apply id="A1.p1.26.m13.3.3.2.cmml" xref="A1.p1.26.m13.3.3.2"><times id="A1.p1.26.m13.3.3.2.3.cmml" xref="A1.p1.26.m13.3.3.2.3"></times><interval closure="open" id="A1.p1.26.m13.3.3.2.2.3.cmml" xref="A1.p1.26.m13.3.3.2.2.2"><apply id="A1.p1.26.m13.2.2.1.1.1.1.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.26.m13.2.2.1.1.1.1.1.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1">superscript</csymbol><ci id="A1.p1.26.m13.2.2.1.1.1.1.2.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1.2">𝛼</ci><apply id="A1.p1.26.m13.2.2.1.1.1.1.3.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.26.m13.2.2.1.1.1.1.3.1.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.p1.26.m13.2.2.1.1.1.1.3.2.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1.3.2">𝒯</ci><ci id="A1.p1.26.m13.2.2.1.1.1.1.3.3.cmml" xref="A1.p1.26.m13.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.p1.26.m13.3.3.2.2.2.2.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.26.m13.3.3.2.2.2.2.1.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2">superscript</csymbol><ci id="A1.p1.26.m13.3.3.2.2.2.2.2.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2.2">𝑃</ci><apply id="A1.p1.26.m13.3.3.2.2.2.2.3.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.p1.26.m13.3.3.2.2.2.2.3.1.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2.3">subscript</csymbol><ci id="A1.p1.26.m13.3.3.2.2.2.2.3.2.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2.3.2">𝒯</ci><ci id="A1.p1.26.m13.3.3.2.2.2.2.3.3.cmml" xref="A1.p1.26.m13.3.3.2.2.2.2.3.3">𝑖</ci></apply></apply></interval><apply id="A1.p1.26.m13.3.3.2.4.cmml" xref="A1.p1.26.m13.3.3.2.4"><csymbol cd="latexml" id="A1.p1.26.m13.3.3.2.4.1.cmml" xref="A1.p1.26.m13.3.3.2.4.1">for-all</csymbol><ci id="A1.p1.26.m13.3.3.2.4.2.cmml" xref="A1.p1.26.m13.3.3.2.4.2">𝑖</ci></apply></apply><interval closure="closed" id="A1.p1.26.m13.4.4.3.2.cmml" xref="A1.p1.26.m13.4.4.3.1"><cn type="integer" id="A1.p1.26.m13.1.1.cmml" xref="A1.p1.26.m13.1.1">1</cn><apply id="A1.p1.26.m13.4.4.3.1.1.cmml" xref="A1.p1.26.m13.4.4.3.1.1"><minus id="A1.p1.26.m13.4.4.3.1.1.1.cmml" xref="A1.p1.26.m13.4.4.3.1.1.1"></minus><ci id="A1.p1.26.m13.4.4.3.1.1.2.cmml" xref="A1.p1.26.m13.4.4.3.1.1.2">𝑚</ci><cn type="integer" id="A1.p1.26.m13.4.4.3.1.1.3.cmml" xref="A1.p1.26.m13.4.4.3.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.26.m13.4c">(\alpha^{\mathcal{T}_{i}},P^{\mathcal{T}_{i}})~{}\forall i\in[1,m-1]</annotation></semantics></math> is frozen but contributes to the training as in Equation (<a href="#A1.E5" title="Equation 5 ‣ Appendix A Preliminaries for Prompt-based Continual Learning ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). In addition, the classification head of the previous task <math id="A1.p1.27.m14.3" class="ltx_Math" alttext="\mathcal{T}_{1},\cdots,\mathcal{T}_{m-1}" display="inline"><semantics id="A1.p1.27.m14.3a"><mrow id="A1.p1.27.m14.3.3.2" xref="A1.p1.27.m14.3.3.3.cmml"><msub id="A1.p1.27.m14.2.2.1.1" xref="A1.p1.27.m14.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.27.m14.2.2.1.1.2" xref="A1.p1.27.m14.2.2.1.1.2.cmml">𝒯</mi><mn id="A1.p1.27.m14.2.2.1.1.3" xref="A1.p1.27.m14.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.p1.27.m14.3.3.2.3" xref="A1.p1.27.m14.3.3.3.cmml">,</mo><mi mathvariant="normal" id="A1.p1.27.m14.1.1" xref="A1.p1.27.m14.1.1.cmml">⋯</mi><mo id="A1.p1.27.m14.3.3.2.4" xref="A1.p1.27.m14.3.3.3.cmml">,</mo><msub id="A1.p1.27.m14.3.3.2.2" xref="A1.p1.27.m14.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.27.m14.3.3.2.2.2" xref="A1.p1.27.m14.3.3.2.2.2.cmml">𝒯</mi><mrow id="A1.p1.27.m14.3.3.2.2.3" xref="A1.p1.27.m14.3.3.2.2.3.cmml"><mi id="A1.p1.27.m14.3.3.2.2.3.2" xref="A1.p1.27.m14.3.3.2.2.3.2.cmml">m</mi><mo id="A1.p1.27.m14.3.3.2.2.3.1" xref="A1.p1.27.m14.3.3.2.2.3.1.cmml">−</mo><mn id="A1.p1.27.m14.3.3.2.2.3.3" xref="A1.p1.27.m14.3.3.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.27.m14.3b"><list id="A1.p1.27.m14.3.3.3.cmml" xref="A1.p1.27.m14.3.3.2"><apply id="A1.p1.27.m14.2.2.1.1.cmml" xref="A1.p1.27.m14.2.2.1.1"><csymbol cd="ambiguous" id="A1.p1.27.m14.2.2.1.1.1.cmml" xref="A1.p1.27.m14.2.2.1.1">subscript</csymbol><ci id="A1.p1.27.m14.2.2.1.1.2.cmml" xref="A1.p1.27.m14.2.2.1.1.2">𝒯</ci><cn type="integer" id="A1.p1.27.m14.2.2.1.1.3.cmml" xref="A1.p1.27.m14.2.2.1.1.3">1</cn></apply><ci id="A1.p1.27.m14.1.1.cmml" xref="A1.p1.27.m14.1.1">⋯</ci><apply id="A1.p1.27.m14.3.3.2.2.cmml" xref="A1.p1.27.m14.3.3.2.2"><csymbol cd="ambiguous" id="A1.p1.27.m14.3.3.2.2.1.cmml" xref="A1.p1.27.m14.3.3.2.2">subscript</csymbol><ci id="A1.p1.27.m14.3.3.2.2.2.cmml" xref="A1.p1.27.m14.3.3.2.2.2">𝒯</ci><apply id="A1.p1.27.m14.3.3.2.2.3.cmml" xref="A1.p1.27.m14.3.3.2.2.3"><minus id="A1.p1.27.m14.3.3.2.2.3.1.cmml" xref="A1.p1.27.m14.3.3.2.2.3.1"></minus><ci id="A1.p1.27.m14.3.3.2.2.3.2.cmml" xref="A1.p1.27.m14.3.3.2.2.3.2">𝑚</ci><cn type="integer" id="A1.p1.27.m14.3.3.2.2.3.3.cmml" xref="A1.p1.27.m14.3.3.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.27.m14.3c">\mathcal{T}_{1},\cdots,\mathcal{T}_{m-1}</annotation></semantics></math> , <span id="A1.p1.27.1" class="ltx_text ltx_font_italic">i.e</span> are frozen.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Related Work</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p"><span id="A2.p1.1.1" class="ltx_text ltx_font_bold">Federated Continual Learning (FCL).</span>
FCL performs addresses catastrophic forgetting across multiple clients trained on their private sequential tasks, where a global model is obtained by exchanging task-specific knowledge via a global server. The mainstream FCL research can be roughly divided into two categories: rehearsal-based and rehearsal-free FCL.
The rehearsal-based research stores and replays information from previous tasks to mitigate the global model’s forgetting over time <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>; Huang et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>; Zizzo et al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>. For example, Huang <span id="A2.p1.1.2" class="ltx_text ltx_font_italic">et al.</span> proposed FCCL to address the heterogeneity and catastrophic forgetting in federated learning based on buffered data for intra- and inter-domain knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>. Similarly, Zizzo <span id="A2.p1.1.3" class="ltx_text ltx_font_italic">et al.</span> and Wang <span id="A2.p1.1.4" class="ltx_text ltx_font_italic">et al.</span> leveraged replay buffers and novel data-sharing approaches based on differential privacy to mitigate forgetting <cite class="ltx_cite ltx_citemacro_citep">(Zizzo et al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>. To tackle the global model’s forgetting brought by heterogeneous clients, Dong <span id="A2.p1.1.5" class="ltx_text ltx_font_italic">et al.</span> introduced a proxy server to store and select the best old models to assist clients’ local training <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>. While successful, the above rehearsal-based FCL research requires large storage space and complex data-sharing strategies to replay past information, making it challenging to scale over time.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">Another category of FCL research is rehearsal-free approaches without storing past information.
One group of rehearsal-free continual learning (CL) expands the model architecture when encountering new tasks <cite class="ltx_cite ltx_citemacro_citep">(Rusu et al., <a href="#bib.bib18" title="" class="ltx_ref">2016</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>. However, most architecture-based approaches require task identity to condition the network during inference, leading to their ineffectiveness for class-incremental or task-agnostic CL scenarios, i.e., the task identity is unknown. In this work, we focus on the practical but more challenging class-incremental FCL in a rehearsal-free manner.
Existing FCL research along this line proposed regularizing the model with respect to the previous task knowledge when training a new task. For example, Shoham <span id="A2.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> and Yoon <span id="A2.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> leveraged the weight consolidation method to restrict the updates of the important parameters regarding previous tasks while improving the training performance for the new task <cite class="ltx_cite ltx_citemacro_citep">(Shoham et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Yoon et al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite>. Similarly, several recent works implemented knowledge distillation methods to transfer knowledge from the model for the old task to that for the current task <cite class="ltx_cite ltx_citemacro_citep">(Casado et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; Usmanova et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>; Ma et al., <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>.
In addition,  <cite class="ltx_cite ltx_citemacro_citep">(Shenaj et al., <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> investigates the asynchronous-task FCL while using representation loss and a modified aggregation strategy to address the forgetting across multiple clients asynchronously learning respective tasks.
While the aforementioned research enables class-incremental FCL without the rehearsal buffer, they rely on optimizing the entire model on the client side, leading to heavy communication overhead when iteratively exchanging distributed client knowledge in FL, especially for CL scenarios. To address the limitations of existing research, in this work, we propose a novel rehearsal-free FCL approach for class-incremental learning problems based on prompt learning techniques.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p"><span id="A2.p3.1.1" class="ltx_text ltx_font_bold">Prompt Learning.</span> Prompt learning has been a popular transfer learning approach that modifies the input sample with input embedding called prompts, aiming to provide additional information to condition the model to perform downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>; Jiang et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Shin et al., <a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>. However, designing the prompt function for various downstream tasks is challenging. Recent research has introduced ”soft prompts” to automatically train the learnable prompt parameters to replace the heuristic manual selection, such as the prompt tuning, p-tuning, and prefix tuning <cite class="ltx_cite ltx_citemacro_citep">(Lester et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Liu et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Li &amp; Liang, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>. Prompt learning has shown great potential for parameter-efficient transfer learning with a small set of prompt parameters. Taking advantage of the small parameter size, Zhao <span id="A2.p3.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite> and Guo <span id="A2.p3.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> adopted prompt learning to improve federated learning efficiency.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.1" class="ltx_p">Some recent works have implemented prompt learning techniques in CL. Wang <span id="A2.p4.1.1" class="ltx_text ltx_font_italic">et al.</span> proposed L2P by using the key-query-based similarity method to select prompts from a prompt pool to instruct different tasks in CL <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>)</cite>. Later, DualPrompt was introduced as the follow-up to L2P with better CL performance, which learns two sets of disjoint prompt spaces to encode task-specific and task-invariant instructions, respectively <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2022a</a>)</cite>. More recently, CODA-Prompt was proposed using an attention-based end-to-end key-query method, which produces the input-conditioned prompts to further improve CL performance <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite>. Nevertheless, the above prompt-based CL approaches designed for centralized datasets cannot be directly used for federated learning scenarios, as they ignore the unique challenges raised by distributed nature of clients, such as the heterogeneous data distribution and asynchronous task arrival over clients. To the best of our knowledge, none of the existing prompt learning research has been done for FCL.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Algorithm</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">The overall training process includes four main steps (a-d) as shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Algorithm ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
(a) The server distributes the prompts and model to each new participating device. (b) Each user first freezes the previous prompt parameters. (c) Each user optimizes the local prompt parameters and classifier head following CE loss and Equation  (<a href="#S2.E3" title="Equation 3 ‣ 2.4 C2Loss: Contrastive and Continual Loss ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). (d) The clients return the locally trained model to the server. Further, the server aggregates the model following classical FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite>. Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Algorithm ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> follows steps (a) - (d) until convergence.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Fed-CPrompt</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.3" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input</span>: Set of <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{C}</annotation></semantics></math> clients, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">R</annotation></semantics></math> communication rounds, total tasks <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="alg1.l1.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\mathcal{T}</annotation></semantics></math>, trainable parameters <math id="alg1.l1.m4.2" class="ltx_Math" alttext="\mathbf{w}_{s}=\{P_{s},A_{s},K_{s}\},\phi_{s}" display="inline"><semantics id="alg1.l1.m4.2a"><mrow id="alg1.l1.m4.2.2" xref="alg1.l1.m4.2.2.cmml"><msub id="alg1.l1.m4.2.2.4" xref="alg1.l1.m4.2.2.4.cmml"><mi id="alg1.l1.m4.2.2.4.2" xref="alg1.l1.m4.2.2.4.2.cmml">𝐰</mi><mi id="alg1.l1.m4.2.2.4.3" xref="alg1.l1.m4.2.2.4.3.cmml">s</mi></msub><mo id="alg1.l1.m4.2.2.3" xref="alg1.l1.m4.2.2.3.cmml">=</mo><mrow id="alg1.l1.m4.2.2.2.2" xref="alg1.l1.m4.2.2.2.3.cmml"><mrow id="alg1.l1.m4.1.1.1.1.1.3" xref="alg1.l1.m4.1.1.1.1.1.4.cmml"><mo stretchy="false" id="alg1.l1.m4.1.1.1.1.1.3.4" xref="alg1.l1.m4.1.1.1.1.1.4.cmml">{</mo><msub id="alg1.l1.m4.1.1.1.1.1.1.1" xref="alg1.l1.m4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m4.1.1.1.1.1.1.1.2" xref="alg1.l1.m4.1.1.1.1.1.1.1.2.cmml">P</mi><mi id="alg1.l1.m4.1.1.1.1.1.1.1.3" xref="alg1.l1.m4.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l1.m4.1.1.1.1.1.3.5" xref="alg1.l1.m4.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l1.m4.1.1.1.1.1.2.2" xref="alg1.l1.m4.1.1.1.1.1.2.2.cmml"><mi id="alg1.l1.m4.1.1.1.1.1.2.2.2" xref="alg1.l1.m4.1.1.1.1.1.2.2.2.cmml">A</mi><mi id="alg1.l1.m4.1.1.1.1.1.2.2.3" xref="alg1.l1.m4.1.1.1.1.1.2.2.3.cmml">s</mi></msub><mo id="alg1.l1.m4.1.1.1.1.1.3.6" xref="alg1.l1.m4.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l1.m4.1.1.1.1.1.3.3" xref="alg1.l1.m4.1.1.1.1.1.3.3.cmml"><mi id="alg1.l1.m4.1.1.1.1.1.3.3.2" xref="alg1.l1.m4.1.1.1.1.1.3.3.2.cmml">K</mi><mi id="alg1.l1.m4.1.1.1.1.1.3.3.3" xref="alg1.l1.m4.1.1.1.1.1.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l1.m4.1.1.1.1.1.3.7" xref="alg1.l1.m4.1.1.1.1.1.4.cmml">}</mo></mrow><mo id="alg1.l1.m4.2.2.2.2.3" xref="alg1.l1.m4.2.2.2.3.cmml">,</mo><msub id="alg1.l1.m4.2.2.2.2.2" xref="alg1.l1.m4.2.2.2.2.2.cmml"><mi id="alg1.l1.m4.2.2.2.2.2.2" xref="alg1.l1.m4.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l1.m4.2.2.2.2.2.3" xref="alg1.l1.m4.2.2.2.2.2.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.2b"><apply id="alg1.l1.m4.2.2.cmml" xref="alg1.l1.m4.2.2"><eq id="alg1.l1.m4.2.2.3.cmml" xref="alg1.l1.m4.2.2.3"></eq><apply id="alg1.l1.m4.2.2.4.cmml" xref="alg1.l1.m4.2.2.4"><csymbol cd="ambiguous" id="alg1.l1.m4.2.2.4.1.cmml" xref="alg1.l1.m4.2.2.4">subscript</csymbol><ci id="alg1.l1.m4.2.2.4.2.cmml" xref="alg1.l1.m4.2.2.4.2">𝐰</ci><ci id="alg1.l1.m4.2.2.4.3.cmml" xref="alg1.l1.m4.2.2.4.3">𝑠</ci></apply><list id="alg1.l1.m4.2.2.2.3.cmml" xref="alg1.l1.m4.2.2.2.2"><set id="alg1.l1.m4.1.1.1.1.1.4.cmml" xref="alg1.l1.m4.1.1.1.1.1.3"><apply id="alg1.l1.m4.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m4.1.1.1.1.1.1.1.2">𝑃</ci><ci id="alg1.l1.m4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m4.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l1.m4.1.1.1.1.1.2.2.cmml" xref="alg1.l1.m4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.1.1.2.2.1.cmml" xref="alg1.l1.m4.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l1.m4.1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m4.1.1.1.1.1.2.2.2">𝐴</ci><ci id="alg1.l1.m4.1.1.1.1.1.2.2.3.cmml" xref="alg1.l1.m4.1.1.1.1.1.2.2.3">𝑠</ci></apply><apply id="alg1.l1.m4.1.1.1.1.1.3.3.cmml" xref="alg1.l1.m4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.1.1.3.3.1.cmml" xref="alg1.l1.m4.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l1.m4.1.1.1.1.1.3.3.2.cmml" xref="alg1.l1.m4.1.1.1.1.1.3.3.2">𝐾</ci><ci id="alg1.l1.m4.1.1.1.1.1.3.3.3.cmml" xref="alg1.l1.m4.1.1.1.1.1.3.3.3">𝑠</ci></apply></set><apply id="alg1.l1.m4.2.2.2.2.2.cmml" xref="alg1.l1.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m4.2.2.2.2.2.1.cmml" xref="alg1.l1.m4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m4.2.2.2.2.2.2.cmml" xref="alg1.l1.m4.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l1.m4.2.2.2.2.2.3.cmml" xref="alg1.l1.m4.2.2.2.2.2.3">𝑠</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.2c">\mathbf{w}_{s}=\{P_{s},A_{s},K_{s}\},\phi_{s}</annotation></semantics></math>, frozen pretrained large model parameters <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\theta</annotation></semantics></math>, local epochs <math id="alg1.l1.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">E</annotation></semantics></math>, learning rate <math id="alg1.l1.m7.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">\eta</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Output</span>: <math id="alg1.l2.m1.2" class="ltx_Math" alttext="\mathbf{w},\phi" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.3.2" xref="alg1.l2.m1.2.3.1.cmml"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">𝐰</mi><mo id="alg1.l2.m1.2.3.2.1" xref="alg1.l2.m1.2.3.1.cmml">,</mo><mi id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">ϕ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><list id="alg1.l2.m1.2.3.1.cmml" xref="alg1.l2.m1.2.3.2"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐰</ci><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">italic-ϕ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">\mathbf{w},\phi</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.4" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1a.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1a.2" class="ltx_text ltx_font_bold">Server executes</span>:

</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Send the pretrained model <math id="alg1.l2a.m1.3" class="ltx_Math" alttext="\phi,\theta,\mathbf{w}_{s}" display="inline"><semantics id="alg1.l2a.m1.3a"><mrow id="alg1.l2a.m1.3.3.1" xref="alg1.l2a.m1.3.3.2.cmml"><mi id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml">ϕ</mi><mo id="alg1.l2a.m1.3.3.1.2" xref="alg1.l2a.m1.3.3.2.cmml">,</mo><mi id="alg1.l2a.m1.2.2" xref="alg1.l2a.m1.2.2.cmml">θ</mi><mo id="alg1.l2a.m1.3.3.1.3" xref="alg1.l2a.m1.3.3.2.cmml">,</mo><msub id="alg1.l2a.m1.3.3.1.1" xref="alg1.l2a.m1.3.3.1.1.cmml"><mi id="alg1.l2a.m1.3.3.1.1.2" xref="alg1.l2a.m1.3.3.1.1.2.cmml">𝐰</mi><mi id="alg1.l2a.m1.3.3.1.1.3" xref="alg1.l2a.m1.3.3.1.1.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.3b"><list id="alg1.l2a.m1.3.3.2.cmml" xref="alg1.l2a.m1.3.3.1"><ci id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1">italic-ϕ</ci><ci id="alg1.l2a.m1.2.2.cmml" xref="alg1.l2a.m1.2.2">𝜃</ci><apply id="alg1.l2a.m1.3.3.1.1.cmml" xref="alg1.l2a.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l2a.m1.3.3.1.1.1.cmml" xref="alg1.l2a.m1.3.3.1.1">subscript</csymbol><ci id="alg1.l2a.m1.3.3.1.1.2.cmml" xref="alg1.l2a.m1.3.3.1.1.2">𝐰</ci><ci id="alg1.l2a.m1.3.3.1.1.3.cmml" xref="alg1.l2a.m1.3.3.1.1.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.3c">\phi,\theta,\mathbf{w}_{s}</annotation></semantics></math> parameters to clients. <span id="alg1.l2a.2" class="ltx_text" style="float:right;"><span id="alg1.l2a.2.1" class="ltx_text ltx_font_bold">(a)</span>
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.3" class="ltx_Math" alttext="r\in\{1,\cdots,R\}" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">r</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">⋯</mi><mo id="alg1.l3.m1.3.4.3.2.3" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">R</mi><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.4" xref="alg1.l3.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><in id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></in><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑟</ci><set id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">⋯</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑅</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">r\in\{1,\cdots,R\}</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l4.m1.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">c</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑐</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">c\in\mathcal{C}</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathbf{w}_{c}\leftarrow\ \mathbf{w}_{s}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">c</mi></msub><mo rspace="0.778em" stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">𝐰</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝐰</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝐰</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathbf{w}_{c}\leftarrow\ \mathbf{w}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\phi_{c}\leftarrow\phi_{s}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">ϕ</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">c</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">ϕ</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">italic-ϕ</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">italic-ϕ</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\phi_{c}\leftarrow\phi_{s}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\mathbf{w_{c}},\phi_{c}\leftarrow" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mrow id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.3.cmml"><msub id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml">𝐜</mi></msub><mo id="alg1.l7.m1.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">←</mo><mi id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">←</ci><list id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">𝐰</ci><ci id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">𝐜</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3">𝑐</ci></apply></list><csymbol cd="latexml" id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\mathbf{w_{c}},\phi_{c}\leftarrow</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">Client Update</span>(<math id="alg1.l7.m2.2" class="ltx_Math" alttext="\mathbf{w_{c}},\phi_{c}" display="inline"><semantics id="alg1.l7.m2.2a"><mrow id="alg1.l7.m2.2.2.2" xref="alg1.l7.m2.2.2.3.cmml"><msub id="alg1.l7.m2.1.1.1.1" xref="alg1.l7.m2.1.1.1.1.cmml"><mi id="alg1.l7.m2.1.1.1.1.2" xref="alg1.l7.m2.1.1.1.1.2.cmml">𝐰</mi><mi id="alg1.l7.m2.1.1.1.1.3" xref="alg1.l7.m2.1.1.1.1.3.cmml">𝐜</mi></msub><mo id="alg1.l7.m2.2.2.2.3" xref="alg1.l7.m2.2.2.3.cmml">,</mo><msub id="alg1.l7.m2.2.2.2.2" xref="alg1.l7.m2.2.2.2.2.cmml"><mi id="alg1.l7.m2.2.2.2.2.2" xref="alg1.l7.m2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l7.m2.2.2.2.2.3" xref="alg1.l7.m2.2.2.2.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.2b"><list id="alg1.l7.m2.2.2.3.cmml" xref="alg1.l7.m2.2.2.2"><apply id="alg1.l7.m2.1.1.1.1.cmml" xref="alg1.l7.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.1.1.cmml" xref="alg1.l7.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m2.1.1.1.1.2.cmml" xref="alg1.l7.m2.1.1.1.1.2">𝐰</ci><ci id="alg1.l7.m2.1.1.1.1.3.cmml" xref="alg1.l7.m2.1.1.1.1.3">𝐜</ci></apply><apply id="alg1.l7.m2.2.2.2.2.cmml" xref="alg1.l7.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m2.2.2.2.2.1.cmml" xref="alg1.l7.m2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m2.2.2.2.2.2.cmml" xref="alg1.l7.m2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l7.m2.2.2.2.2.3.cmml" xref="alg1.l7.m2.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.2c">\mathbf{w_{c}},\phi_{c}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     Aggregate <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\mathbf{w}_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="alg1.l9.m1.1a"><msubsup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">c</mi><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝐰</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝒯</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\mathbf{w}_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> and <math id="alg1.l9.m2.1" class="ltx_Math" alttext="\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="alg1.l9.m2.1a"><msubsup id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2.2" xref="alg1.l9.m2.1.1.2.2.cmml">ϕ</mi><mi id="alg1.l9.m2.1.1.2.3" xref="alg1.l9.m2.1.1.2.3.cmml">c</mi><msub id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m2.1.1.3.2" xref="alg1.l9.m2.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l9.m2.1.1.3.3" xref="alg1.l9.m2.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">superscript</csymbol><apply id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.2.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.2.2">italic-ϕ</ci><ci id="alg1.l9.m2.1.1.2.3.cmml" xref="alg1.l9.m2.1.1.2.3">𝑐</ci></apply><apply id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.3">subscript</csymbol><ci id="alg1.l9.m2.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.3.2">𝒯</ci><ci id="alg1.l9.m2.1.1.3.3.cmml" xref="alg1.l9.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> using FedAvg <span id="alg1.l9.2" class="ltx_text" style="float:right;"><span id="alg1.l9.2.1" class="ltx_text ltx_font_bold">(d)</span>
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\theta_{r+1}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">θ</mi><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">r</mi><mo id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝜃</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><plus id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></plus><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑟</ci><cn type="integer" id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\theta_{r+1}</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.5" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1b.2.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1b.1" class="ltx_text ltx_font_bold">Client Update <math id="alg1.l1b.1.m1.2" class="ltx_Math" alttext="(\mathbf{w_{c}},\phi)" display="inline"><semantics id="alg1.l1b.1.m1.2a"><mrow id="alg1.l1b.1.m1.2.2.1" xref="alg1.l1b.1.m1.2.2.2.cmml"><mo stretchy="false" id="alg1.l1b.1.m1.2.2.1.2" xref="alg1.l1b.1.m1.2.2.2.cmml">(</mo><msub id="alg1.l1b.1.m1.2.2.1.1" xref="alg1.l1b.1.m1.2.2.1.1.cmml"><mi id="alg1.l1b.1.m1.2.2.1.1.2" xref="alg1.l1b.1.m1.2.2.1.1.2.cmml">𝐰</mi><mi id="alg1.l1b.1.m1.2.2.1.1.3" xref="alg1.l1b.1.m1.2.2.1.1.3.cmml">𝐜</mi></msub><mo id="alg1.l1b.1.m1.2.2.1.3" xref="alg1.l1b.1.m1.2.2.2.cmml">,</mo><mi id="alg1.l1b.1.m1.1.1" xref="alg1.l1b.1.m1.1.1.cmml">ϕ</mi><mo stretchy="false" id="alg1.l1b.1.m1.2.2.1.4" xref="alg1.l1b.1.m1.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1b.1.m1.2b"><interval closure="open" id="alg1.l1b.1.m1.2.2.2.cmml" xref="alg1.l1b.1.m1.2.2.1"><apply id="alg1.l1b.1.m1.2.2.1.1.cmml" xref="alg1.l1b.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1b.1.m1.2.2.1.1.1.cmml" xref="alg1.l1b.1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l1b.1.m1.2.2.1.1.2.cmml" xref="alg1.l1b.1.m1.2.2.1.1.2">𝐰</ci><ci id="alg1.l1b.1.m1.2.2.1.1.3.cmml" xref="alg1.l1b.1.m1.2.2.1.1.3">𝐜</ci></apply><ci id="alg1.l1b.1.m1.1.1.cmml" xref="alg1.l1b.1.m1.1.1">italic-ϕ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1b.1.m1.2c">(\mathbf{w_{c}},\phi)</annotation></semantics></math></span>:

</div>
<div id="alg1.l2b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2b.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2b.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2b.m1.2" class="ltx_Math" alttext="i\in[1,n]" display="inline"><semantics id="alg1.l2b.m1.2a"><mrow id="alg1.l2b.m1.2.3" xref="alg1.l2b.m1.2.3.cmml"><mi id="alg1.l2b.m1.2.3.2" xref="alg1.l2b.m1.2.3.2.cmml">i</mi><mo id="alg1.l2b.m1.2.3.1" xref="alg1.l2b.m1.2.3.1.cmml">∈</mo><mrow id="alg1.l2b.m1.2.3.3.2" xref="alg1.l2b.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l2b.m1.2.3.3.2.1" xref="alg1.l2b.m1.2.3.3.1.cmml">[</mo><mn id="alg1.l2b.m1.1.1" xref="alg1.l2b.m1.1.1.cmml">1</mn><mo id="alg1.l2b.m1.2.3.3.2.2" xref="alg1.l2b.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l2b.m1.2.2" xref="alg1.l2b.m1.2.2.cmml">n</mi><mo stretchy="false" id="alg1.l2b.m1.2.3.3.2.3" xref="alg1.l2b.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2b.m1.2b"><apply id="alg1.l2b.m1.2.3.cmml" xref="alg1.l2b.m1.2.3"><in id="alg1.l2b.m1.2.3.1.cmml" xref="alg1.l2b.m1.2.3.1"></in><ci id="alg1.l2b.m1.2.3.2.cmml" xref="alg1.l2b.m1.2.3.2">𝑖</ci><interval closure="closed" id="alg1.l2b.m1.2.3.3.1.cmml" xref="alg1.l2b.m1.2.3.3.2"><cn type="integer" id="alg1.l2b.m1.1.1.cmml" xref="alg1.l2b.m1.1.1">1</cn><ci id="alg1.l2b.m1.2.2.cmml" xref="alg1.l2b.m1.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2b.m1.2c">i\in[1,n]</annotation></semantics></math> <span id="alg1.l2b.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3a.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3a.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l3a.m1.1" class="ltx_Math" alttext="m\neq n" display="inline"><semantics id="alg1.l3a.m1.1a"><mrow id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml"><mi id="alg1.l3a.m1.1.1.2" xref="alg1.l3a.m1.1.1.2.cmml">m</mi><mo id="alg1.l3a.m1.1.1.1" xref="alg1.l3a.m1.1.1.1.cmml">≠</mo><mi id="alg1.l3a.m1.1.1.3" xref="alg1.l3a.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.1b"><apply id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1"><neq id="alg1.l3a.m1.1.1.1.cmml" xref="alg1.l3a.m1.1.1.1"></neq><ci id="alg1.l3a.m1.1.1.2.cmml" xref="alg1.l3a.m1.1.1.2">𝑚</ci><ci id="alg1.l3a.m1.1.1.3.cmml" xref="alg1.l3a.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.1c">m\neq n</annotation></semantics></math> <span id="alg1.l3a.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4a.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        Freeze <math id="alg1.l4a.m1.2" class="ltx_Math" alttext="w_{c}^{\mathcal{T}_{i}},\phi_{c}^{\mathcal{T}_{i}}" display="inline"><semantics id="alg1.l4a.m1.2a"><mrow id="alg1.l4a.m1.2.2.2" xref="alg1.l4a.m1.2.2.3.cmml"><msubsup id="alg1.l4a.m1.1.1.1.1" xref="alg1.l4a.m1.1.1.1.1.cmml"><mi id="alg1.l4a.m1.1.1.1.1.2.2" xref="alg1.l4a.m1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l4a.m1.1.1.1.1.2.3" xref="alg1.l4a.m1.1.1.1.1.2.3.cmml">c</mi><msub id="alg1.l4a.m1.1.1.1.1.3" xref="alg1.l4a.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4a.m1.1.1.1.1.3.2" xref="alg1.l4a.m1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l4a.m1.1.1.1.1.3.3" xref="alg1.l4a.m1.1.1.1.1.3.3.cmml">i</mi></msub></msubsup><mo id="alg1.l4a.m1.2.2.2.3" xref="alg1.l4a.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l4a.m1.2.2.2.2" xref="alg1.l4a.m1.2.2.2.2.cmml"><mi id="alg1.l4a.m1.2.2.2.2.2.2" xref="alg1.l4a.m1.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l4a.m1.2.2.2.2.2.3" xref="alg1.l4a.m1.2.2.2.2.2.3.cmml">c</mi><msub id="alg1.l4a.m1.2.2.2.2.3" xref="alg1.l4a.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4a.m1.2.2.2.2.3.2" xref="alg1.l4a.m1.2.2.2.2.3.2.cmml">𝒯</mi><mi id="alg1.l4a.m1.2.2.2.2.3.3" xref="alg1.l4a.m1.2.2.2.2.3.3.cmml">i</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.2b"><list id="alg1.l4a.m1.2.2.3.cmml" xref="alg1.l4a.m1.2.2.2"><apply id="alg1.l4a.m1.1.1.1.1.cmml" xref="alg1.l4a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.1.1.cmml" xref="alg1.l4a.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l4a.m1.1.1.1.1.2.cmml" xref="alg1.l4a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.1.2.1.cmml" xref="alg1.l4a.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l4a.m1.1.1.1.1.2.2.cmml" xref="alg1.l4a.m1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l4a.m1.1.1.1.1.2.3.cmml" xref="alg1.l4a.m1.1.1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l4a.m1.1.1.1.1.3.cmml" xref="alg1.l4a.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.1.3.1.cmml" xref="alg1.l4a.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l4a.m1.1.1.1.1.3.2.cmml" xref="alg1.l4a.m1.1.1.1.1.3.2">𝒯</ci><ci id="alg1.l4a.m1.1.1.1.1.3.3.cmml" xref="alg1.l4a.m1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l4a.m1.2.2.2.2.cmml" xref="alg1.l4a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4a.m1.2.2.2.2.1.cmml" xref="alg1.l4a.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l4a.m1.2.2.2.2.2.cmml" xref="alg1.l4a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4a.m1.2.2.2.2.2.1.cmml" xref="alg1.l4a.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l4a.m1.2.2.2.2.2.2.cmml" xref="alg1.l4a.m1.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l4a.m1.2.2.2.2.2.3.cmml" xref="alg1.l4a.m1.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg1.l4a.m1.2.2.2.2.3.cmml" xref="alg1.l4a.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.2.2.2.2.3.1.cmml" xref="alg1.l4a.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l4a.m1.2.2.2.2.3.2.cmml" xref="alg1.l4a.m1.2.2.2.2.3.2">𝒯</ci><ci id="alg1.l4a.m1.2.2.2.2.3.3.cmml" xref="alg1.l4a.m1.2.2.2.2.3.3">𝑖</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.2c">w_{c}^{\mathcal{T}_{i}},\phi_{c}^{\mathcal{T}_{i}}</annotation></semantics></math> <span id="alg1.l4a.2" class="ltx_text" style="float:right;"><span id="alg1.l4a.2.1" class="ltx_text ltx_font_bold">(b)</span>
</span>
</div>
<div id="alg1.l5a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5a.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5a.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l6a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6a.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  <span id="alg1.l6a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7a.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7a.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7a.m1.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg1.l7a.m1.1a"><mrow id="alg1.l7a.m1.1.1" xref="alg1.l7a.m1.1.1.cmml"><mi id="alg1.l7a.m1.1.1.2" xref="alg1.l7a.m1.1.1.2.cmml">e</mi><mo id="alg1.l7a.m1.1.1.1" xref="alg1.l7a.m1.1.1.1.cmml">∈</mo><mi id="alg1.l7a.m1.1.1.3" xref="alg1.l7a.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.1b"><apply id="alg1.l7a.m1.1.1.cmml" xref="alg1.l7a.m1.1.1"><in id="alg1.l7a.m1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1"></in><ci id="alg1.l7a.m1.1.1.2.cmml" xref="alg1.l7a.m1.1.1.2">𝑒</ci><ci id="alg1.l7a.m1.1.1.3.cmml" xref="alg1.l7a.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.1c">e\in E</annotation></semantics></math> <span id="alg1.l7a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l8a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8a.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <math id="alg1.l8a.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}\leftarrow" display="inline"><semantics id="alg1.l8a.m1.1a"><mrow id="alg1.l8a.m1.1.1" xref="alg1.l8a.m1.1.1.cmml"><msub id="alg1.l8a.m1.1.1.2" xref="alg1.l8a.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8a.m1.1.1.2.2" xref="alg1.l8a.m1.1.1.2.2.cmml">ℒ</mi><mrow id="alg1.l8a.m1.1.1.2.3" xref="alg1.l8a.m1.1.1.2.3.cmml"><mi id="alg1.l8a.m1.1.1.2.3.2" xref="alg1.l8a.m1.1.1.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.1.1.2.3.1" xref="alg1.l8a.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l8a.m1.1.1.2.3.3" xref="alg1.l8a.m1.1.1.2.3.3.cmml">E</mi></mrow></msub><mo stretchy="false" id="alg1.l8a.m1.1.1.1" xref="alg1.l8a.m1.1.1.1.cmml">←</mo><mi id="alg1.l8a.m1.1.1.3" xref="alg1.l8a.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.1b"><apply id="alg1.l8a.m1.1.1.cmml" xref="alg1.l8a.m1.1.1"><ci id="alg1.l8a.m1.1.1.1.cmml" xref="alg1.l8a.m1.1.1.1">←</ci><apply id="alg1.l8a.m1.1.1.2.cmml" xref="alg1.l8a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.2.1.cmml" xref="alg1.l8a.m1.1.1.2">subscript</csymbol><ci id="alg1.l8a.m1.1.1.2.2.cmml" xref="alg1.l8a.m1.1.1.2.2">ℒ</ci><apply id="alg1.l8a.m1.1.1.2.3.cmml" xref="alg1.l8a.m1.1.1.2.3"><times id="alg1.l8a.m1.1.1.2.3.1.cmml" xref="alg1.l8a.m1.1.1.2.3.1"></times><ci id="alg1.l8a.m1.1.1.2.3.2.cmml" xref="alg1.l8a.m1.1.1.2.3.2">𝐶</ci><ci id="alg1.l8a.m1.1.1.2.3.3.cmml" xref="alg1.l8a.m1.1.1.2.3.3">𝐸</ci></apply></apply><csymbol cd="latexml" id="alg1.l8a.m1.1.1.3.cmml" xref="alg1.l8a.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.1c">\mathcal{L}_{CE}\leftarrow</annotation></semantics></math> Calculate <span id="alg1.l8a.2" class="ltx_text ltx_font_italic">cross entropy</span> loss <math id="alg1.l8a.m2.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="alg1.l8a.m2.1a"><msub id="alg1.l8a.m2.1.1" xref="alg1.l8a.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8a.m2.1.1.2" xref="alg1.l8a.m2.1.1.2.cmml">ℒ</mi><mrow id="alg1.l8a.m2.1.1.3" xref="alg1.l8a.m2.1.1.3.cmml"><mi id="alg1.l8a.m2.1.1.3.2" xref="alg1.l8a.m2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l8a.m2.1.1.3.1" xref="alg1.l8a.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l8a.m2.1.1.3.3" xref="alg1.l8a.m2.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8a.m2.1b"><apply id="alg1.l8a.m2.1.1.cmml" xref="alg1.l8a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m2.1.1.1.cmml" xref="alg1.l8a.m2.1.1">subscript</csymbol><ci id="alg1.l8a.m2.1.1.2.cmml" xref="alg1.l8a.m2.1.1.2">ℒ</ci><apply id="alg1.l8a.m2.1.1.3.cmml" xref="alg1.l8a.m2.1.1.3"><times id="alg1.l8a.m2.1.1.3.1.cmml" xref="alg1.l8a.m2.1.1.3.1"></times><ci id="alg1.l8a.m2.1.1.3.2.cmml" xref="alg1.l8a.m2.1.1.3.2">𝐶</ci><ci id="alg1.l8a.m2.1.1.3.3.cmml" xref="alg1.l8a.m2.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m2.1c">\mathcal{L}_{CE}</annotation></semantics></math>

</div>
<div id="alg1.l9a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9a.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <math id="alg1.l9a.m1.1" class="ltx_Math" alttext="\mathcal{L}_{C2L}\leftarrow" display="inline"><semantics id="alg1.l9a.m1.1a"><mrow id="alg1.l9a.m1.1.1" xref="alg1.l9a.m1.1.1.cmml"><msub id="alg1.l9a.m1.1.1.2" xref="alg1.l9a.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9a.m1.1.1.2.2" xref="alg1.l9a.m1.1.1.2.2.cmml">ℒ</mi><mrow id="alg1.l9a.m1.1.1.2.3" xref="alg1.l9a.m1.1.1.2.3.cmml"><mi id="alg1.l9a.m1.1.1.2.3.2" xref="alg1.l9a.m1.1.1.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l9a.m1.1.1.2.3.1" xref="alg1.l9a.m1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l9a.m1.1.1.2.3.3" xref="alg1.l9a.m1.1.1.2.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg1.l9a.m1.1.1.2.3.1a" xref="alg1.l9a.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9a.m1.1.1.2.3.4" xref="alg1.l9a.m1.1.1.2.3.4.cmml">L</mi></mrow></msub><mo stretchy="false" id="alg1.l9a.m1.1.1.1" xref="alg1.l9a.m1.1.1.1.cmml">←</mo><mi id="alg1.l9a.m1.1.1.3" xref="alg1.l9a.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9a.m1.1b"><apply id="alg1.l9a.m1.1.1.cmml" xref="alg1.l9a.m1.1.1"><ci id="alg1.l9a.m1.1.1.1.cmml" xref="alg1.l9a.m1.1.1.1">←</ci><apply id="alg1.l9a.m1.1.1.2.cmml" xref="alg1.l9a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9a.m1.1.1.2.1.cmml" xref="alg1.l9a.m1.1.1.2">subscript</csymbol><ci id="alg1.l9a.m1.1.1.2.2.cmml" xref="alg1.l9a.m1.1.1.2.2">ℒ</ci><apply id="alg1.l9a.m1.1.1.2.3.cmml" xref="alg1.l9a.m1.1.1.2.3"><times id="alg1.l9a.m1.1.1.2.3.1.cmml" xref="alg1.l9a.m1.1.1.2.3.1"></times><ci id="alg1.l9a.m1.1.1.2.3.2.cmml" xref="alg1.l9a.m1.1.1.2.3.2">𝐶</ci><cn type="integer" id="alg1.l9a.m1.1.1.2.3.3.cmml" xref="alg1.l9a.m1.1.1.2.3.3">2</cn><ci id="alg1.l9a.m1.1.1.2.3.4.cmml" xref="alg1.l9a.m1.1.1.2.3.4">𝐿</ci></apply></apply><csymbol cd="latexml" id="alg1.l9a.m1.1.1.3.cmml" xref="alg1.l9a.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9a.m1.1c">\mathcal{L}_{C2L}\leftarrow</annotation></semantics></math> Calculate <span id="alg1.l9a.2" class="ltx_text ltx_font_italic">C2Loss</span> using (<a href="#S2.E3" title="Equation 3 ‣ 2.4 C2Loss: Contrastive and Continual Loss ‣ 2 Proposed Method ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div id="alg1.l10a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10a.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     Update <math id="alg1.l10a.m1.2" class="ltx_Math" alttext="\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="alg1.l10a.m1.2a"><mrow id="alg1.l10a.m1.2.2.2" xref="alg1.l10a.m1.2.2.3.cmml"><msubsup id="alg1.l10a.m1.1.1.1.1" xref="alg1.l10a.m1.1.1.1.1.cmml"><mi id="alg1.l10a.m1.1.1.1.1.2.2" xref="alg1.l10a.m1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l10a.m1.1.1.1.1.2.3" xref="alg1.l10a.m1.1.1.1.1.2.3.cmml">c</mi><msub id="alg1.l10a.m1.1.1.1.1.3" xref="alg1.l10a.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10a.m1.1.1.1.1.3.2" xref="alg1.l10a.m1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l10a.m1.1.1.1.1.3.3" xref="alg1.l10a.m1.1.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo id="alg1.l10a.m1.2.2.2.3" xref="alg1.l10a.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l10a.m1.2.2.2.2" xref="alg1.l10a.m1.2.2.2.2.cmml"><mi id="alg1.l10a.m1.2.2.2.2.2.2" xref="alg1.l10a.m1.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l10a.m1.2.2.2.2.2.3" xref="alg1.l10a.m1.2.2.2.2.2.3.cmml">c</mi><msub id="alg1.l10a.m1.2.2.2.2.3" xref="alg1.l10a.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10a.m1.2.2.2.2.3.2" xref="alg1.l10a.m1.2.2.2.2.3.2.cmml">𝒯</mi><mi id="alg1.l10a.m1.2.2.2.2.3.3" xref="alg1.l10a.m1.2.2.2.2.3.3.cmml">m</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10a.m1.2b"><list id="alg1.l10a.m1.2.2.3.cmml" xref="alg1.l10a.m1.2.2.2"><apply id="alg1.l10a.m1.1.1.1.1.cmml" xref="alg1.l10a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.1.1.cmml" xref="alg1.l10a.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l10a.m1.1.1.1.1.2.cmml" xref="alg1.l10a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.1.2.1.cmml" xref="alg1.l10a.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l10a.m1.1.1.1.1.2.2.cmml" xref="alg1.l10a.m1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.l10a.m1.1.1.1.1.2.3.cmml" xref="alg1.l10a.m1.1.1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l10a.m1.1.1.1.1.3.cmml" xref="alg1.l10a.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.1.3.1.cmml" xref="alg1.l10a.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10a.m1.1.1.1.1.3.2.cmml" xref="alg1.l10a.m1.1.1.1.1.3.2">𝒯</ci><ci id="alg1.l10a.m1.1.1.1.1.3.3.cmml" xref="alg1.l10a.m1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="alg1.l10a.m1.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10a.m1.2.2.2.2.1.cmml" xref="alg1.l10a.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l10a.m1.2.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10a.m1.2.2.2.2.2.1.cmml" xref="alg1.l10a.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l10a.m1.2.2.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l10a.m1.2.2.2.2.2.3.cmml" xref="alg1.l10a.m1.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg1.l10a.m1.2.2.2.2.3.cmml" xref="alg1.l10a.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.2.2.2.2.3.1.cmml" xref="alg1.l10a.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l10a.m1.2.2.2.2.3.2.cmml" xref="alg1.l10a.m1.2.2.2.2.3.2">𝒯</ci><ci id="alg1.l10a.m1.2.2.2.2.3.3.cmml" xref="alg1.l10a.m1.2.2.2.2.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10a.m1.2c">\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math> <span id="alg1.l10a.2" class="ltx_text" style="float:right;"><span id="alg1.l10a.2.1" class="ltx_text ltx_font_bold">(c)</span>
</span>
</div>
<div id="alg1.l11a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11a.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l12.m1.2" class="ltx_Math" alttext="\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.3.cmml"><msubsup id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.2.2" xref="alg1.l12.m1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l12.m1.1.1.1.1.2.3" xref="alg1.l12.m1.1.1.1.1.2.3.cmml">c</mi><msub id="alg1.l12.m1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.1.1.3.2" xref="alg1.l12.m1.1.1.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l12.m1.1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo id="alg1.l12.m1.2.2.2.3" xref="alg1.l12.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml"><mi id="alg1.l12.m1.2.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.2.cmml">ϕ</mi><mi id="alg1.l12.m1.2.2.2.2.2.3" xref="alg1.l12.m1.2.2.2.2.2.3.cmml">c</mi><msub id="alg1.l12.m1.2.2.2.2.3" xref="alg1.l12.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.2.2.2.2.3.2" xref="alg1.l12.m1.2.2.2.2.3.2.cmml">𝒯</mi><mi id="alg1.l12.m1.2.2.2.2.3.3" xref="alg1.l12.m1.2.2.2.2.3.3.cmml">m</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><list id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.2"><apply id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.l12.m1.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.2.3">𝑐</ci></apply><apply id="alg1.l12.m1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.3.2">𝒯</ci><ci id="alg1.l12.m1.1.1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.2.1.cmml" xref="alg1.l12.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l12.m1.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.2">italic-ϕ</ci><ci id="alg1.l12.m1.2.2.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg1.l12.m1.2.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.2.3.1.cmml" xref="alg1.l12.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l12.m1.2.2.2.2.3.2.cmml" xref="alg1.l12.m1.2.2.2.2.3.2">𝒯</ci><ci id="alg1.l12.m1.2.2.2.2.3.3.cmml" xref="alg1.l12.m1.2.2.2.2.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">\mathbf{w}_{c}^{\mathcal{T}_{m}},\phi_{c}^{\mathcal{T}_{m}}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Implementation details</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">In this section, we conduct extensive experiments to evaluate the proposed Fed-CPrompt. We first introduce the experimental setup, followed by the experimental results.
Additionally, the same random seed is used to conduct all experiments for reproducibility.
</p>
</div>
<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Dataset Setup.</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.8" class="ltx_p">The CIFAR-100 dataset consists of <math id="A4.SS1.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A4.SS1.p1.1.m1.1a"><mn id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><cn type="integer" id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">100</annotation></semantics></math> classes with <math id="A4.SS1.p1.2.m2.1" class="ltx_Math" alttext="600" display="inline"><semantics id="A4.SS1.p1.2.m2.1a"><mn id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml">600</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><cn type="integer" id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1">600</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">600</annotation></semantics></math> samples per class. In the experiments, we divide the dataset into <math id="A4.SS1.p1.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS1.p1.3.m3.1a"><mn id="A4.SS1.p1.3.m3.1.1" xref="A4.SS1.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m3.1b"><cn type="integer" id="A4.SS1.p1.3.m3.1.1.cmml" xref="A4.SS1.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m3.1c">10</annotation></semantics></math> disjoint tasks with <math id="A4.SS1.p1.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS1.p1.4.m4.1a"><mn id="A4.SS1.p1.4.m4.1.1" xref="A4.SS1.p1.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.4.m4.1b"><cn type="integer" id="A4.SS1.p1.4.m4.1.1.cmml" xref="A4.SS1.p1.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.4.m4.1c">10</annotation></semantics></math> classes per task (<math id="A4.SS1.p1.5.m5.2" class="ltx_Math" alttext="5,000" display="inline"><semantics id="A4.SS1.p1.5.m5.2a"><mrow id="A4.SS1.p1.5.m5.2.3.2" xref="A4.SS1.p1.5.m5.2.3.1.cmml"><mn id="A4.SS1.p1.5.m5.1.1" xref="A4.SS1.p1.5.m5.1.1.cmml">5</mn><mo id="A4.SS1.p1.5.m5.2.3.2.1" xref="A4.SS1.p1.5.m5.2.3.1.cmml">,</mo><mn id="A4.SS1.p1.5.m5.2.2" xref="A4.SS1.p1.5.m5.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.5.m5.2b"><list id="A4.SS1.p1.5.m5.2.3.1.cmml" xref="A4.SS1.p1.5.m5.2.3.2"><cn type="integer" id="A4.SS1.p1.5.m5.1.1.cmml" xref="A4.SS1.p1.5.m5.1.1">5</cn><cn type="integer" id="A4.SS1.p1.5.m5.2.2.cmml" xref="A4.SS1.p1.5.m5.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.5.m5.2c">5,000</annotation></semantics></math> training samples per task). We divide the samples on each task among clients following a uniform distribution for the iid settings in federated learning. We implement label-based and quantity-based distribution skew (i.e., label skew and quantity skew) for non-iid settings with non-iid degree <math id="A4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="A4.SS1.p1.6.m6.1a"><mrow id="A4.SS1.p1.6.m6.1.1" xref="A4.SS1.p1.6.m6.1.1.cmml"><mi id="A4.SS1.p1.6.m6.1.1.2" xref="A4.SS1.p1.6.m6.1.1.2.cmml">β</mi><mo id="A4.SS1.p1.6.m6.1.1.1" xref="A4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="A4.SS1.p1.6.m6.1.1.3" xref="A4.SS1.p1.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.6.m6.1b"><apply id="A4.SS1.p1.6.m6.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1"><eq id="A4.SS1.p1.6.m6.1.1.1.cmml" xref="A4.SS1.p1.6.m6.1.1.1"></eq><ci id="A4.SS1.p1.6.m6.1.1.2.cmml" xref="A4.SS1.p1.6.m6.1.1.2">𝛽</ci><cn type="float" id="A4.SS1.p1.6.m6.1.1.3.cmml" xref="A4.SS1.p1.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.6.m6.1c">\beta=0.5</annotation></semantics></math> following  <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib11" title="" class="ltx_ref">2022</a>)</cite>. The test dataset consists of <math id="A4.SS1.p1.7.m7.2" class="ltx_Math" alttext="10,000" display="inline"><semantics id="A4.SS1.p1.7.m7.2a"><mrow id="A4.SS1.p1.7.m7.2.3.2" xref="A4.SS1.p1.7.m7.2.3.1.cmml"><mn id="A4.SS1.p1.7.m7.1.1" xref="A4.SS1.p1.7.m7.1.1.cmml">10</mn><mo id="A4.SS1.p1.7.m7.2.3.2.1" xref="A4.SS1.p1.7.m7.2.3.1.cmml">,</mo><mn id="A4.SS1.p1.7.m7.2.2" xref="A4.SS1.p1.7.m7.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.7.m7.2b"><list id="A4.SS1.p1.7.m7.2.3.1.cmml" xref="A4.SS1.p1.7.m7.2.3.2"><cn type="integer" id="A4.SS1.p1.7.m7.1.1.cmml" xref="A4.SS1.p1.7.m7.1.1">10</cn><cn type="integer" id="A4.SS1.p1.7.m7.2.2.cmml" xref="A4.SS1.p1.7.m7.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.7.m7.2c">10,000</annotation></semantics></math> samples, with <math id="A4.SS1.p1.8.m8.2" class="ltx_Math" alttext="1,000" display="inline"><semantics id="A4.SS1.p1.8.m8.2a"><mrow id="A4.SS1.p1.8.m8.2.3.2" xref="A4.SS1.p1.8.m8.2.3.1.cmml"><mn id="A4.SS1.p1.8.m8.1.1" xref="A4.SS1.p1.8.m8.1.1.cmml">1</mn><mo id="A4.SS1.p1.8.m8.2.3.2.1" xref="A4.SS1.p1.8.m8.2.3.1.cmml">,</mo><mn id="A4.SS1.p1.8.m8.2.2" xref="A4.SS1.p1.8.m8.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.8.m8.2b"><list id="A4.SS1.p1.8.m8.2.3.1.cmml" xref="A4.SS1.p1.8.m8.2.3.2"><cn type="integer" id="A4.SS1.p1.8.m8.1.1.cmml" xref="A4.SS1.p1.8.m8.1.1">1</cn><cn type="integer" id="A4.SS1.p1.8.m8.2.2.cmml" xref="A4.SS1.p1.8.m8.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.8.m8.2c">1,000</annotation></semantics></math> samples per task.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Federated Learning Settings.</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.8" class="ltx_p">The learning rate is set to <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="lr=0.0001" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><mrow id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml"><mrow id="A4.SS2.p1.1.m1.1.1.2" xref="A4.SS2.p1.1.m1.1.1.2.cmml"><mi id="A4.SS2.p1.1.m1.1.1.2.2" xref="A4.SS2.p1.1.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.1.m1.1.1.2.1" xref="A4.SS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A4.SS2.p1.1.m1.1.1.2.3" xref="A4.SS2.p1.1.m1.1.1.2.3.cmml">r</mi></mrow><mo id="A4.SS2.p1.1.m1.1.1.1" xref="A4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.1.m1.1.1.3" xref="A4.SS2.p1.1.m1.1.1.3.cmml">0.0001</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><apply id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1"><eq id="A4.SS2.p1.1.m1.1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1.1"></eq><apply id="A4.SS2.p1.1.m1.1.1.2.cmml" xref="A4.SS2.p1.1.m1.1.1.2"><times id="A4.SS2.p1.1.m1.1.1.2.1.cmml" xref="A4.SS2.p1.1.m1.1.1.2.1"></times><ci id="A4.SS2.p1.1.m1.1.1.2.2.cmml" xref="A4.SS2.p1.1.m1.1.1.2.2">𝑙</ci><ci id="A4.SS2.p1.1.m1.1.1.2.3.cmml" xref="A4.SS2.p1.1.m1.1.1.2.3">𝑟</ci></apply><cn type="float" id="A4.SS2.p1.1.m1.1.1.3.cmml" xref="A4.SS2.p1.1.m1.1.1.3">0.0001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">lr=0.0001</annotation></semantics></math>. We also deploy an early-stopping mechanism in each task using a validation set.
We consider <math id="A4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{C}=10" display="inline"><semantics id="A4.SS2.p1.2.m2.1a"><mrow id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS2.p1.2.m2.1.1.2" xref="A4.SS2.p1.2.m2.1.1.2.cmml">𝒞</mi><mo id="A4.SS2.p1.2.m2.1.1.1" xref="A4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.2.m2.1.1.3" xref="A4.SS2.p1.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><apply id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1"><eq id="A4.SS2.p1.2.m2.1.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1.1"></eq><ci id="A4.SS2.p1.2.m2.1.1.2.cmml" xref="A4.SS2.p1.2.m2.1.1.2">𝒞</ci><cn type="integer" id="A4.SS2.p1.2.m2.1.1.3.cmml" xref="A4.SS2.p1.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">\mathcal{C}=10</annotation></semantics></math> clients, <math id="A4.SS2.p1.3.m3.1" class="ltx_Math" alttext="R=40" display="inline"><semantics id="A4.SS2.p1.3.m3.1a"><mrow id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml"><mi id="A4.SS2.p1.3.m3.1.1.2" xref="A4.SS2.p1.3.m3.1.1.2.cmml">R</mi><mo id="A4.SS2.p1.3.m3.1.1.1" xref="A4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.3.m3.1.1.3" xref="A4.SS2.p1.3.m3.1.1.3.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><apply id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1"><eq id="A4.SS2.p1.3.m3.1.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1.1"></eq><ci id="A4.SS2.p1.3.m3.1.1.2.cmml" xref="A4.SS2.p1.3.m3.1.1.2">𝑅</ci><cn type="integer" id="A4.SS2.p1.3.m3.1.1.3.cmml" xref="A4.SS2.p1.3.m3.1.1.3">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">R=40</annotation></semantics></math> communication rounds, and local epochs <math id="A4.SS2.p1.4.m4.1" class="ltx_Math" alttext="l_{epochs}=5" display="inline"><semantics id="A4.SS2.p1.4.m4.1a"><mrow id="A4.SS2.p1.4.m4.1.1" xref="A4.SS2.p1.4.m4.1.1.cmml"><msub id="A4.SS2.p1.4.m4.1.1.2" xref="A4.SS2.p1.4.m4.1.1.2.cmml"><mi id="A4.SS2.p1.4.m4.1.1.2.2" xref="A4.SS2.p1.4.m4.1.1.2.2.cmml">l</mi><mrow id="A4.SS2.p1.4.m4.1.1.2.3" xref="A4.SS2.p1.4.m4.1.1.2.3.cmml"><mi id="A4.SS2.p1.4.m4.1.1.2.3.2" xref="A4.SS2.p1.4.m4.1.1.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.4.m4.1.1.2.3.1" xref="A4.SS2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A4.SS2.p1.4.m4.1.1.2.3.3" xref="A4.SS2.p1.4.m4.1.1.2.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.4.m4.1.1.2.3.1a" xref="A4.SS2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A4.SS2.p1.4.m4.1.1.2.3.4" xref="A4.SS2.p1.4.m4.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.4.m4.1.1.2.3.1b" xref="A4.SS2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A4.SS2.p1.4.m4.1.1.2.3.5" xref="A4.SS2.p1.4.m4.1.1.2.3.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.4.m4.1.1.2.3.1c" xref="A4.SS2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A4.SS2.p1.4.m4.1.1.2.3.6" xref="A4.SS2.p1.4.m4.1.1.2.3.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.4.m4.1.1.2.3.1d" xref="A4.SS2.p1.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A4.SS2.p1.4.m4.1.1.2.3.7" xref="A4.SS2.p1.4.m4.1.1.2.3.7.cmml">s</mi></mrow></msub><mo id="A4.SS2.p1.4.m4.1.1.1" xref="A4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.4.m4.1.1.3" xref="A4.SS2.p1.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m4.1b"><apply id="A4.SS2.p1.4.m4.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1"><eq id="A4.SS2.p1.4.m4.1.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1.1"></eq><apply id="A4.SS2.p1.4.m4.1.1.2.cmml" xref="A4.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="A4.SS2.p1.4.m4.1.1.2.1.cmml" xref="A4.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="A4.SS2.p1.4.m4.1.1.2.2.cmml" xref="A4.SS2.p1.4.m4.1.1.2.2">𝑙</ci><apply id="A4.SS2.p1.4.m4.1.1.2.3.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3"><times id="A4.SS2.p1.4.m4.1.1.2.3.1.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.1"></times><ci id="A4.SS2.p1.4.m4.1.1.2.3.2.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.2">𝑒</ci><ci id="A4.SS2.p1.4.m4.1.1.2.3.3.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.3">𝑝</ci><ci id="A4.SS2.p1.4.m4.1.1.2.3.4.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.4">𝑜</ci><ci id="A4.SS2.p1.4.m4.1.1.2.3.5.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.5">𝑐</ci><ci id="A4.SS2.p1.4.m4.1.1.2.3.6.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.6">ℎ</ci><ci id="A4.SS2.p1.4.m4.1.1.2.3.7.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3.7">𝑠</ci></apply></apply><cn type="integer" id="A4.SS2.p1.4.m4.1.1.3.cmml" xref="A4.SS2.p1.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m4.1c">l_{epochs}=5</annotation></semantics></math>. The network parameters are optimized using Adam optimizer and a batch size of <math id="A4.SS2.p1.5.m5.1" class="ltx_Math" alttext="128" display="inline"><semantics id="A4.SS2.p1.5.m5.1a"><mn id="A4.SS2.p1.5.m5.1.1" xref="A4.SS2.p1.5.m5.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.5.m5.1b"><cn type="integer" id="A4.SS2.p1.5.m5.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.5.m5.1c">128</annotation></semantics></math> images. We split the CIFAR100 dataset into <math id="A4.SS2.p1.6.m6.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS2.p1.6.m6.1a"><mn id="A4.SS2.p1.6.m6.1.1" xref="A4.SS2.p1.6.m6.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.6.m6.1b"><cn type="integer" id="A4.SS2.p1.6.m6.1.1.cmml" xref="A4.SS2.p1.6.m6.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.6.m6.1c">10</annotation></semantics></math> tasks, each with <math id="A4.SS2.p1.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS2.p1.7.m7.1a"><mn id="A4.SS2.p1.7.m7.1.1" xref="A4.SS2.p1.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.7.m7.1b"><cn type="integer" id="A4.SS2.p1.7.m7.1.1.cmml" xref="A4.SS2.p1.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.7.m7.1c">10</annotation></semantics></math> classes. This is distributed among the <math id="A4.SS2.p1.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS2.p1.8.m8.1a"><mn id="A4.SS2.p1.8.m8.1.1" xref="A4.SS2.p1.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.8.m8.1b"><cn type="integer" id="A4.SS2.p1.8.m8.1.1.cmml" xref="A4.SS2.p1.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.8.m8.1c">10</annotation></semantics></math> clients following § <a href="#A4.SS1" title="D.1 Dataset Setup. ‣ Appendix D Implementation details ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D.1</span></a>.</p>
</div>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Asynchronous Tasks.</h3>

<div id="A4.SS3.p1" class="ltx_para">
<p id="A4.SS3.p1.2" class="ltx_p">We consider an asynchronous scenario where different clients learn from different tasks at the same time. Specifically, we select a random set of 5 clients to participate in the following task <math id="A4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{n}=\mathcal{T}_{m+1}" display="inline"><semantics id="A4.SS3.p1.1.m1.1a"><mrow id="A4.SS3.p1.1.m1.1.1" xref="A4.SS3.p1.1.m1.1.1.cmml"><msub id="A4.SS3.p1.1.m1.1.1.2" xref="A4.SS3.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS3.p1.1.m1.1.1.2.2" xref="A4.SS3.p1.1.m1.1.1.2.2.cmml">𝒯</mi><mi id="A4.SS3.p1.1.m1.1.1.2.3" xref="A4.SS3.p1.1.m1.1.1.2.3.cmml">n</mi></msub><mo id="A4.SS3.p1.1.m1.1.1.1" xref="A4.SS3.p1.1.m1.1.1.1.cmml">=</mo><msub id="A4.SS3.p1.1.m1.1.1.3" xref="A4.SS3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS3.p1.1.m1.1.1.3.2" xref="A4.SS3.p1.1.m1.1.1.3.2.cmml">𝒯</mi><mrow id="A4.SS3.p1.1.m1.1.1.3.3" xref="A4.SS3.p1.1.m1.1.1.3.3.cmml"><mi id="A4.SS3.p1.1.m1.1.1.3.3.2" xref="A4.SS3.p1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="A4.SS3.p1.1.m1.1.1.3.3.1" xref="A4.SS3.p1.1.m1.1.1.3.3.1.cmml">+</mo><mn id="A4.SS3.p1.1.m1.1.1.3.3.3" xref="A4.SS3.p1.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.1.m1.1b"><apply id="A4.SS3.p1.1.m1.1.1.cmml" xref="A4.SS3.p1.1.m1.1.1"><eq id="A4.SS3.p1.1.m1.1.1.1.cmml" xref="A4.SS3.p1.1.m1.1.1.1"></eq><apply id="A4.SS3.p1.1.m1.1.1.2.cmml" xref="A4.SS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS3.p1.1.m1.1.1.2.1.cmml" xref="A4.SS3.p1.1.m1.1.1.2">subscript</csymbol><ci id="A4.SS3.p1.1.m1.1.1.2.2.cmml" xref="A4.SS3.p1.1.m1.1.1.2.2">𝒯</ci><ci id="A4.SS3.p1.1.m1.1.1.2.3.cmml" xref="A4.SS3.p1.1.m1.1.1.2.3">𝑛</ci></apply><apply id="A4.SS3.p1.1.m1.1.1.3.cmml" xref="A4.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.SS3.p1.1.m1.1.1.3.1.cmml" xref="A4.SS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="A4.SS3.p1.1.m1.1.1.3.2.cmml" xref="A4.SS3.p1.1.m1.1.1.3.2">𝒯</ci><apply id="A4.SS3.p1.1.m1.1.1.3.3.cmml" xref="A4.SS3.p1.1.m1.1.1.3.3"><plus id="A4.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="A4.SS3.p1.1.m1.1.1.3.3.1"></plus><ci id="A4.SS3.p1.1.m1.1.1.3.3.2.cmml" xref="A4.SS3.p1.1.m1.1.1.3.3.2">𝑚</ci><cn type="integer" id="A4.SS3.p1.1.m1.1.1.3.3.3.cmml" xref="A4.SS3.p1.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.1.m1.1c">\mathcal{T}_{n}=\mathcal{T}_{m+1}</annotation></semantics></math>, while the remaining 5 clients remain on task <math id="A4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A4.SS3.p1.2.m2.1a"><msub id="A4.SS3.p1.2.m2.1.1" xref="A4.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS3.p1.2.m2.1.1.2" xref="A4.SS3.p1.2.m2.1.1.2.cmml">𝒯</mi><mi id="A4.SS3.p1.2.m2.1.1.3" xref="A4.SS3.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS3.p1.2.m2.1b"><apply id="A4.SS3.p1.2.m2.1.1.cmml" xref="A4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS3.p1.2.m2.1.1.1.cmml" xref="A4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="A4.SS3.p1.2.m2.1.1.2.cmml" xref="A4.SS3.p1.2.m2.1.1.2">𝒯</ci><ci id="A4.SS3.p1.2.m2.1.1.3.cmml" xref="A4.SS3.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS3.p1.2.m2.1c">\mathcal{T}_{m}</annotation></semantics></math>.</p>
</div>
</section>
<section id="A4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Baseline Approaches.</h3>

<div id="A4.SS4.p1" class="ltx_para">
<p id="A4.SS4.p1.1" class="ltx_p">We compare our proposed Fed-CPrompt with CODA-Prompt  <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite>, Dual prompt  <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2022a</a>)</cite>, L2P  <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2022b</a>)</cite> applied to federated settings. These prompt-based methods have shown potential parameter-efficient SOTA solutions in continual learning.
Additionally, we consider conventional non-prompt-based rehearsal-free methods to demonstrate the advantages of prompt-based methods. Specifically, Fed-EWC <cite class="ltx_cite ltx_citemacro_citep">(Shoham et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite> and Fed-LWF  <cite class="ltx_cite ltx_citemacro_citep">(Usmanova et al., <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> provide a fair representation of conventional non-prompt-based rehearsal-free methods in continual learning  <cite class="ltx_cite ltx_citemacro_citep">(Yoon et al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>; Casado et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; Usmanova et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>. This comparison allows us to show the potential of a prompt-based approach to other rehearsal-free methods.
The same set of hyper-parameters, such as the learning rate, batch size, and number of rounds is adopted in the baselines and our proposed Fed-CPrompt.</p>
</div>
</section>
<section id="A4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Prompt parameters.</h3>

<div id="A4.SS5.p1" class="ltx_para">
<p id="A4.SS5.p1.4" class="ltx_p">We use prefix-tuning <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Liang, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> to attach the prompts to layers (1-5) of the pretrained ViT network <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite>. The total prompt size is <math id="A4.SS5.p1.1.m1.1" class="ltx_Math" alttext="n=100" display="inline"><semantics id="A4.SS5.p1.1.m1.1a"><mrow id="A4.SS5.p1.1.m1.1.1" xref="A4.SS5.p1.1.m1.1.1.cmml"><mi id="A4.SS5.p1.1.m1.1.1.2" xref="A4.SS5.p1.1.m1.1.1.2.cmml">n</mi><mo id="A4.SS5.p1.1.m1.1.1.1" xref="A4.SS5.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS5.p1.1.m1.1.1.3" xref="A4.SS5.p1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.1.m1.1b"><apply id="A4.SS5.p1.1.m1.1.1.cmml" xref="A4.SS5.p1.1.m1.1.1"><eq id="A4.SS5.p1.1.m1.1.1.1.cmml" xref="A4.SS5.p1.1.m1.1.1.1"></eq><ci id="A4.SS5.p1.1.m1.1.1.2.cmml" xref="A4.SS5.p1.1.m1.1.1.2">𝑛</ci><cn type="integer" id="A4.SS5.p1.1.m1.1.1.3.cmml" xref="A4.SS5.p1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.1.m1.1c">n=100</annotation></semantics></math>, and <math id="A4.SS5.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A4.SS5.p1.2.m2.1a"><mn id="A4.SS5.p1.2.m2.1.1" xref="A4.SS5.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.2.m2.1b"><cn type="integer" id="A4.SS5.p1.2.m2.1.1.cmml" xref="A4.SS5.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.2.m2.1c">10</annotation></semantics></math> prompts per task. Each prompt is set with length <math id="A4.SS5.p1.3.m3.1" class="ltx_Math" alttext="L_{p}=8" display="inline"><semantics id="A4.SS5.p1.3.m3.1a"><mrow id="A4.SS5.p1.3.m3.1.1" xref="A4.SS5.p1.3.m3.1.1.cmml"><msub id="A4.SS5.p1.3.m3.1.1.2" xref="A4.SS5.p1.3.m3.1.1.2.cmml"><mi id="A4.SS5.p1.3.m3.1.1.2.2" xref="A4.SS5.p1.3.m3.1.1.2.2.cmml">L</mi><mi id="A4.SS5.p1.3.m3.1.1.2.3" xref="A4.SS5.p1.3.m3.1.1.2.3.cmml">p</mi></msub><mo id="A4.SS5.p1.3.m3.1.1.1" xref="A4.SS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="A4.SS5.p1.3.m3.1.1.3" xref="A4.SS5.p1.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.3.m3.1b"><apply id="A4.SS5.p1.3.m3.1.1.cmml" xref="A4.SS5.p1.3.m3.1.1"><eq id="A4.SS5.p1.3.m3.1.1.1.cmml" xref="A4.SS5.p1.3.m3.1.1.1"></eq><apply id="A4.SS5.p1.3.m3.1.1.2.cmml" xref="A4.SS5.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.SS5.p1.3.m3.1.1.2.1.cmml" xref="A4.SS5.p1.3.m3.1.1.2">subscript</csymbol><ci id="A4.SS5.p1.3.m3.1.1.2.2.cmml" xref="A4.SS5.p1.3.m3.1.1.2.2">𝐿</ci><ci id="A4.SS5.p1.3.m3.1.1.2.3.cmml" xref="A4.SS5.p1.3.m3.1.1.2.3">𝑝</ci></apply><cn type="integer" id="A4.SS5.p1.3.m3.1.1.3.cmml" xref="A4.SS5.p1.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.3.m3.1c">L_{p}=8</annotation></semantics></math> and embedding dimension <math id="A4.SS5.p1.4.m4.1" class="ltx_Math" alttext="D=768" display="inline"><semantics id="A4.SS5.p1.4.m4.1a"><mrow id="A4.SS5.p1.4.m4.1.1" xref="A4.SS5.p1.4.m4.1.1.cmml"><mi id="A4.SS5.p1.4.m4.1.1.2" xref="A4.SS5.p1.4.m4.1.1.2.cmml">D</mi><mo id="A4.SS5.p1.4.m4.1.1.1" xref="A4.SS5.p1.4.m4.1.1.1.cmml">=</mo><mn id="A4.SS5.p1.4.m4.1.1.3" xref="A4.SS5.p1.4.m4.1.1.3.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.4.m4.1b"><apply id="A4.SS5.p1.4.m4.1.1.cmml" xref="A4.SS5.p1.4.m4.1.1"><eq id="A4.SS5.p1.4.m4.1.1.1.cmml" xref="A4.SS5.p1.4.m4.1.1.1"></eq><ci id="A4.SS5.p1.4.m4.1.1.2.cmml" xref="A4.SS5.p1.4.m4.1.1.2">𝐷</ci><cn type="integer" id="A4.SS5.p1.4.m4.1.1.3.cmml" xref="A4.SS5.p1.4.m4.1.1.3">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.4.m4.1c">D=768</annotation></semantics></math>.</p>
</div>
</section>
<section id="A4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.6 </span>Evaluation metrics.</h3>

<div id="A4.SS6.p1" class="ltx_para">
<p id="A4.SS6.p1.1" class="ltx_p">We evaluate our model on the standard continual learning metrics, including average accuracy and average forgetting, which are widely used in previous works <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Liang, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>; Usmanova et al., <a href="#bib.bib26" title="" class="ltx_ref">2022</a>; Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>. We follow the standard definition of accuracy and forgetting mentioned in <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib23" title="" class="ltx_ref">2022a</a>)</cite>.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Results</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p"><span id="A5.p1.1.1" class="ltx_text ltx_font_bold">Training Efficiency.</span>
Figure <a href="#A5.F2.sf1" title="Figure 2(a) ‣ Figure 2 ‣ Appendix E Additional Results ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and Figure <a href="#A5.F2.sf2" title="Figure 2(b) ‣ Figure 2 ‣ Appendix E Additional Results ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a> demonstrate the effect of catastrophic forgetting when training new incremental tasks. Overall, we observe that in Fed-CPrompt retains knowledge from previous tasks, mitigating the catastrophic forgetting issues. Additionally, the accuracy per task is higher due to the increased capacity of prompts compared to prompts used in Dual Prompt and L2P.
Overall, our findings suggest that prompt-based algorithms, especially Fed-CPrompt, can effectively mitigate the problem of catastrophic forgetting and improve the training efficiency of lifelong learning systems.</p>
</div>
<figure id="A5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2307.04869/assets/x2.png" id="A5.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A5.F2.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A5.F2.sf1.3.2" class="ltx_text" style="font-size:80%;">Total Test Accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2307.04869/assets/x3.png" id="A5.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A5.F2.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A5.F2.sf2.3.2" class="ltx_text" style="font-size:80%;">Overall Forgetting.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Total test accuracy and forgetting of the global model after training each incremental task in standard iid settings. Note that the total test accuracy is the average test accuracy of the current task and all the previous tasks.</figcaption>
</figure>
<figure id="A5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2307.04869/assets/x4.png" id="A5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A5.F3.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A5.F3.sf1.3.2" class="ltx_text" style="font-size:80%;">Total Test Accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2307.04869/assets/x5.png" id="A5.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="221" height="166" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A5.F3.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A5.F3.sf2.3.2" class="ltx_text" style="font-size:80%;">Forgetting.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Total test accuracy and forgetting after training each incremental task on non-iid (label-skew).</figcaption>
</figure>
<figure id="A5.F4" class="ltx_figure"><img src="/html/2307.04869/assets/x6.png" id="A5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Test accuracy of the prompt-based methods at each round of federated training. </figcaption>
</figure>
<figure id="A5.F5" class="ltx_figure"><img src="/html/2307.04869/assets/x7.png" id="A5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="230" height="172" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy of first 5 tasks in synchronous (sync) and asynchronous (async) iid settings. Under asynchronous settings, prompts in our approach leverage information from other tasks, thus increasing the convergence speed and better initialization.</figcaption>
</figure>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p"><span id="A5.p2.1.1" class="ltx_text ltx_font_bold">Impact of Asynchronous Continual Learning Tasks.</span> To investigate the impact of client pacing on the training efficiency of our lifelong learning system, we conduct experiments with varying degrees of client pacing. Specifically, we compare the system’s performance when all clients move to the next task simultaneously versus when some clients move to the next task while others are still at the current task. Our results show that when some clients move to the next task, the knowledge of the next task can benefit the current task prompt by providing additional context and improving the convergence speed (Figure <a href="#A5.F5" title="Figure 5 ‣ Appendix E Additional Results ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). The model can leverage the knowledge learned from the next task to understand the current task better, leading to faster convergence and improved accuracy.</p>
</div>
<div id="A5.p3" class="ltx_para">
<p id="A5.p3.4" class="ltx_p">Moreover, we also explore the idea of leveraging the prompts from other tasks for example in our design, the clients on task <math id="A5.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{m+1}" display="inline"><semantics id="A5.p3.1.m1.1a"><msub id="A5.p3.1.m1.1.1" xref="A5.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p3.1.m1.1.1.2" xref="A5.p3.1.m1.1.1.2.cmml">𝒯</mi><mrow id="A5.p3.1.m1.1.1.3" xref="A5.p3.1.m1.1.1.3.cmml"><mi id="A5.p3.1.m1.1.1.3.2" xref="A5.p3.1.m1.1.1.3.2.cmml">m</mi><mo id="A5.p3.1.m1.1.1.3.1" xref="A5.p3.1.m1.1.1.3.1.cmml">+</mo><mn id="A5.p3.1.m1.1.1.3.3" xref="A5.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A5.p3.1.m1.1b"><apply id="A5.p3.1.m1.1.1.cmml" xref="A5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A5.p3.1.m1.1.1.1.cmml" xref="A5.p3.1.m1.1.1">subscript</csymbol><ci id="A5.p3.1.m1.1.1.2.cmml" xref="A5.p3.1.m1.1.1.2">𝒯</ci><apply id="A5.p3.1.m1.1.1.3.cmml" xref="A5.p3.1.m1.1.1.3"><plus id="A5.p3.1.m1.1.1.3.1.cmml" xref="A5.p3.1.m1.1.1.3.1"></plus><ci id="A5.p3.1.m1.1.1.3.2.cmml" xref="A5.p3.1.m1.1.1.3.2">𝑚</ci><cn type="integer" id="A5.p3.1.m1.1.1.3.3.cmml" xref="A5.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.1.m1.1c">\mathcal{T}_{m+1}</annotation></semantics></math> leverage prompts from task <math id="A5.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{T}_{m}" display="inline"><semantics id="A5.p3.2.m2.1a"><msub id="A5.p3.2.m2.1.1" xref="A5.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p3.2.m2.1.1.2" xref="A5.p3.2.m2.1.1.2.cmml">𝒯</mi><mi id="A5.p3.2.m2.1.1.3" xref="A5.p3.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="A5.p3.2.m2.1b"><apply id="A5.p3.2.m2.1.1.cmml" xref="A5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A5.p3.2.m2.1.1.1.cmml" xref="A5.p3.2.m2.1.1">subscript</csymbol><ci id="A5.p3.2.m2.1.1.2.cmml" xref="A5.p3.2.m2.1.1.2">𝒯</ci><ci id="A5.p3.2.m2.1.1.3.cmml" xref="A5.p3.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.2.m2.1c">\mathcal{T}_{m}</annotation></semantics></math> to improve the convergence speed of the current task. In addition, clients on task <math id="A5.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{T_{m}}" display="inline"><semantics id="A5.p3.3.m3.1a"><msub id="A5.p3.3.m3.1.1" xref="A5.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p3.3.m3.1.1.2" xref="A5.p3.3.m3.1.1.2.cmml">𝒯</mi><mi class="ltx_font_mathcaligraphic" id="A5.p3.3.m3.1.1.3" xref="A5.p3.3.m3.1.1.3.cmml">𝓂</mi></msub><annotation-xml encoding="MathML-Content" id="A5.p3.3.m3.1b"><apply id="A5.p3.3.m3.1.1.cmml" xref="A5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A5.p3.3.m3.1.1.1.cmml" xref="A5.p3.3.m3.1.1">subscript</csymbol><ci id="A5.p3.3.m3.1.1.2.cmml" xref="A5.p3.3.m3.1.1.2">𝒯</ci><ci id="A5.p3.3.m3.1.1.3.cmml" xref="A5.p3.3.m3.1.1.3">𝓂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.3.m3.1c">\mathcal{T_{m}}</annotation></semantics></math> have an increased capacity due to the additional prompt from task <math id="A5.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{T}_{m+1}" display="inline"><semantics id="A5.p3.4.m4.1a"><msub id="A5.p3.4.m4.1.1" xref="A5.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p3.4.m4.1.1.2" xref="A5.p3.4.m4.1.1.2.cmml">𝒯</mi><mrow id="A5.p3.4.m4.1.1.3" xref="A5.p3.4.m4.1.1.3.cmml"><mi id="A5.p3.4.m4.1.1.3.2" xref="A5.p3.4.m4.1.1.3.2.cmml">m</mi><mo id="A5.p3.4.m4.1.1.3.1" xref="A5.p3.4.m4.1.1.3.1.cmml">+</mo><mn id="A5.p3.4.m4.1.1.3.3" xref="A5.p3.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A5.p3.4.m4.1b"><apply id="A5.p3.4.m4.1.1.cmml" xref="A5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A5.p3.4.m4.1.1.1.cmml" xref="A5.p3.4.m4.1.1">subscript</csymbol><ci id="A5.p3.4.m4.1.1.2.cmml" xref="A5.p3.4.m4.1.1.2">𝒯</ci><apply id="A5.p3.4.m4.1.1.3.cmml" xref="A5.p3.4.m4.1.1.3"><plus id="A5.p3.4.m4.1.1.3.1.cmml" xref="A5.p3.4.m4.1.1.3.1"></plus><ci id="A5.p3.4.m4.1.1.3.2.cmml" xref="A5.p3.4.m4.1.1.3.2">𝑚</ci><cn type="integer" id="A5.p3.4.m4.1.1.3.3.cmml" xref="A5.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.4.m4.1c">\mathcal{T}_{m+1}</annotation></semantics></math>. Our experiments show that incorporating prompts from previous tasks into the current task prompt can significantly improve the convergence speed and reduce the training time, as shown in Figure <a href="#A5.F5" title="Figure 5 ‣ Appendix E Additional Results ‣ Fed-CPrompt: Contrastive Prompt for Rehearsal-Free Federated Continual Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. This is because the model can reuse the knowledge learned from previous tasks and incorporate it into the current task prompt to improve its understanding of the new task.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2307.04868" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2307.04869" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2307.04869">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2307.04869" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2307.04870" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 18:38:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
