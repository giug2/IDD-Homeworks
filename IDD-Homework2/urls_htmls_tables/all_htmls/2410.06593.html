<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Towards Natural Image Matting in the Wild via Real-Scenario Prior</title>
<!--Generated on Wed Oct  9 06:19:04 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.06593v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S2" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>COCO-Matting Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.SS1" title="In 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Investigation and Motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.SS2" title="In 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Dataset Creation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Semantic Enhanced Matting Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.SS1" title="In 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>SEMat Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.SS2" title="In 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>SEMat Training Objective</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.SS1" title="In 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Results on Interactive Matting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.SS2" title="In 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S6" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1" title="In Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS1" title="In Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Details of the SAM Mask Decoder and Matting Adapter</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS2" title="In Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Details of the Matting Decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS3" title="In Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Trainable Parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS4" title="In Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Quantitative Results</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Natural Image Matting in the Wild via Real-Scenario Prior</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ruihao Xia<sup class="ltx_sup" id="id12.12.id1"><span class="ltx_text ltx_font_italic" id="id12.12.id1.1">1,2</span></sup>
  Yu Liang<sup class="ltx_sup" id="id13.13.id2"><span class="ltx_text ltx_font_italic" id="id13.13.id2.1">2</span></sup>
  Peng-Tao Jiang<sup class="ltx_sup" id="id14.14.id3"><span class="ltx_text ltx_font_italic" id="id14.14.id3.1">2</span></sup>
  Hao Zhang<sup class="ltx_sup" id="id15.15.id4"><span class="ltx_text ltx_font_italic" id="id15.15.id4.1">2</span></sup>
  Qianru Sun<sup class="ltx_sup" id="id16.16.id5"><span class="ltx_text ltx_font_italic" id="id16.16.id5.1">3</span></sup>
  Yang Tang<sup class="ltx_sup" id="id17.17.id6"><span class="ltx_text ltx_font_italic" id="id17.17.id6.1">1</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>
<br class="ltx_break"/> <span class="ltx_text ltx_font_bold" id="id7.7.1">Bo Li<sup class="ltx_sup" id="id7.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.1.1.1">2</span></sup></span>
  <span class="ltx_text ltx_font_bold" id="id8.8.2">Pan Zhou<sup class="ltx_sup" id="id8.8.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.2.1.1">3</span></sup></span>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id18.18.id7">1</sup>East China University of Science and Technology    <sup class="ltx_sup" id="id19.19.id8">2</sup>vivo Mobile Communication Co., Ltd 
<br class="ltx_break"/><sup class="ltx_sup" id="id20.20.id9">3</sup>Singapore Management University
</span><span class="ltx_author_notes">Work was done during interning at vivo.Corresponding authors.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id21.id1">Recent approaches attempt to adapt powerful interactive segmentation models, such as SAM, to interactive matting and fine-tune the models based on synthetic matting datasets. However, models trained on synthetic data fail to generalize to complex and occlusion scenes. We address this challenge by proposing a new matting dataset based on the COCO dataset, namely COCO-Matting. Specifically, the construction of our COCO-Matting includes accessory fusion and mask-to-matte, which selects real-world complex images from COCO and converts semantic segmentation masks to matting labels. The built COCO-Matting comprises an extensive collection of 38,251 human instance-level alpha mattes in complex natural scenarios. Furthermore, existing SAM-based matting methods extract intermediate features and masks from a frozen SAM and only train a lightweight matting decoder by end-to-end matting losses, which do not fully exploit the potential of the pre-trained SAM. Thus, we propose SEMat which revamps the network architecture and training objectives. For network architecture, the proposed feature-aligned transformer learns to extract fine-grained edge and transparency features. The proposed matte-aligned decoder aims to segment matting-specific objects and convert coarse masks into high-precision mattes. For training objectives, the proposed regularization and trimap loss aim to retain the prior from the pre-trained model and push the matting logits extracted from the mask decoder to contain trimap-based semantic information. Extensive experiments across seven diverse datasets demonstrate the superior performance of our method, proving its efficacy in interactive natural image matting. We open-source our code, models, and dataset at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/XiaRho/SEMat" title="">https://github.com/XiaRho/SEMat</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Image matting <cite class="ltx_cite ltx_citemacro_citep">(Ruzon &amp; Tomasi, <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib28" title="">2000</a>; Levin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib11" title="">2007</a>)</cite> aims to predict the alpha mattes for foreground subjects, enabling their seamless extraction from complex backgrounds. This capability is indispensable for a multitude of applications, including film production, video editing, and graphic design <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib17" title="">2023a</a>)</cite>. Mainstream matting methods <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib35" title="">2024a</a>)</cite> take auxiliary trimaps as input, which divide the image into foreground, background, and unknown regions, and thus facilitate the image matting to the refinement of the unknown regions. Nonetheless, labeling trimaps is labour-consuming which limits their practical use. To address this, interactive matting <cite class="ltx_cite ltx_citemacro_citep">(Ding et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib3" title="">2022</a>)</cite> has emerged as a solution, replacing trimaps with more accessible cues such as bounding boxes (BBox), points, or scribbles. Among these, BBox are particularly advantageous because of their ease of acquisition, superior accuracy relative to other prompts <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, and compatibility with object detection networks for automatic matting on predefined classes <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite>. Thus, our work primarily focuses on interactive matting using BBox as the auxiliary input.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Unfortunately, due to the hard-to-obtain alpha matte annotations, existing interactive matting methods <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> combine an alpha matte with multiple background images <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite> to generate synthetic training data. These synthetic data suffer from a distribution discrepancy compared to natural data, hindering the network’s generalization to natural scenes. To overcome this, recent methods have sought the help from the robust pre-trained networks, like Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>)</cite> which is trained on one billion real-world masks. For instance, approaches like MatAny <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib36" title="">2024b</a>)</cite> and MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> utilize SAM’s intermediate features or segmentation masks to construct an additional matting network.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, the SAM-based approaches have not fully exploited the potential of pre-trained SAM, and are encumbered by several critical issues. <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">(1) Inappropriate Data</span>. Training on synthetic datasets like RefMatte <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> or simple natural datasets like P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(a)</span></a> is insufficient for robust generalization. This limitation not only impedes the model’s adaptation to diverse natural scenes like HIM2K dataset <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite> but also risks undermining the diverse pre-trained knowledge inherent in SAM.
<span class="ltx_text ltx_font_bold" id="S1.p3.1.2">(2) Feature Mismatch</span>. The intermediate features and predicted masks from a frozen SAM are not optimally aligned with the nuanced demands of matting which necessitates an enhanced sensitivity to edge refinement and transparency perception, as well as the mask prediction for transparent matting-specific objects that are not common in segmentation datasets.
<span class="ltx_text ltx_font_bold" id="S1.p3.1.3">(3) Loss Constraints</span>. Traditional matting losses supervise the network to learn the synthetic training data, neglecting the broader imperative of generalization across natural images. This oversight limits the model’s applicability and efficacy in real-world scenarios.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="224" id="S1.F1.sf1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Our COCO-Matting features both natural and complex scenes. Training SEMat with COCO-Matting enables a substantial lead on HIM2K than using RefMatte <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> and P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>.
</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="220" id="S1.F1.sf2.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Our SEMat trained on COCO-Matting significantly outperforms the SoTA methods like MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> and SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite> on several datasets, especially in transparency, details, and semantics.
</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Improvements of our proposed COCO-Matting dataset and SEMat framework.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1"><span class="ltx_text ltx_font_bold" id="S1.p4.1.1">Contribution.</span> To solve these challenges, we propose the COCO-Matting dataset consisting of complex natural images and Semantic Enhanced Matting (SEMat) framework to revamp training datasets, network architecture, and training objectives, greatly improving the interactive matting performance. Our main contributions are highlighted below.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Firstly, to solve the first challenge of inappropriate data, we construct the COCO-Matting dataset based on the renowned COCO dataset <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib20" title="">2014</a>)</cite>. Considering the complicated interactions between human and their surrounding environment, we focus on humans as the primary subjects and create 38,251 instance-level alpha mattes. Notably, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, our dataset is unique in featuring complex natural scenarios, setting it apart from others. Specifically, the construction of our COCO-Matting is composed of Accessory Fusion and Mask-to-Matte. (1) Accessory Fusion aims to solve the problem of missing accessories for human mask annotations through the overlap rate between masks, i.e., merging the accessory masks, such as hats, backpacks, or items being held that are considered part of human in matting tasks. (2) For Mask-to-Matte, it is proposed to solve the problem of coarse mask annotations by converting binary masks into continuous high-precision alpha mattes with a trained trimap-based network <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib8" title="">2023</a>)</cite> to match the matting annotations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Secondly, to address the second and third challenges, we design a novel and effective SEMat framework which improves the network architecture and training objectives. (1) Our network in SEMat consists of the Feature Aligned Transformer (FAT) and Matte Aligned Decoder (MAD). For FAT, it is to solve the problem of unaligned features between segmentation and matting through the introduced prompt enhancement and Low-Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib7" title="">2022</a>)</cite> on the transformer backbone. Regarding MAD, it aims to predict aligned mattes on matting-specific objects such as smoke, nets, and silk by the learnable matting tokens, matting adapter, and lightweight matting decoder. (2) We design more effective training objectives, including the regularization loss and trimap loss. Among them, the regularization loss ensures the consistency of predictions between the frozen and learnable networks to retain the prior of the pre-trained model; the trimap loss aims to encourage the matting logits extracted from the mask decoder to contain trimap-based semantic information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Finally, experiments show the significant improvement of our COCO-Matting dataset and SEMat framework compared with the state-of-the-arts (SoTAs).
For example, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(a)</span></a> shows that when combining the same 3 synthetic datasets Distinction-646 <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib24" title="">2020</a>)</cite>, AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite>, and Composition-1k <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite> with RefMatte <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> or P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite> or our COCO-Matting to train our SEMat, our COCO-Matting brings 11%, 8%, 11%, and 10% relative improvement than the runner-up in terms of Mean Absolute Difference (MAD), Mean Squared Error (MSE), Gradient (Grad), and Connectivity (Conn) metrics in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(a)</span></a>.
Moreover, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(b)</span></a> demonstrates 32%, 11%, 45%, 21%, and 5% relative improvement made by our SEMat trained by COCO-Matting on five datasets, including P3M, AIM, RW100, AM, and RWP636, compared with the second-best SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Interactive Matting</span>.
Trimap-based methods <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib35" title="">2024a</a>; Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib8" title="">2023</a>)</cite> have demonstrated impressive accuracy in image matting. However, trimaps are hard to obtain in real-world scenarios. Consequently, several approaches have sought alternative auxiliary inputs, such as backgrounds <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib19" title="">2021</a>)</cite>, coarse segmentation maps <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib38" title="">2021</a>)</cite>, and interactive prompts (e.g., points, scribbles, and BBox) <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib33" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib34" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">To eliminate the ambiguity of multiple objects in one image, UIM <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib33" title="">2022</a>)</cite> introduces interactive prompts and decouples the matting into foreground segmentation and transparency prediction. However, it is trained and tested only on the synthetic dataset <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite>. Recently, MatAny <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib36" title="">2024b</a>)</cite> and MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> leverage the robust generalization capabilities of pre-trained SAM <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>)</cite> to transfer from interactive segmentation to interactive matting. MatAny employs a training-free two-stage pipeline: it creates trimaps by eroding the masks generated from SAM and then predicts alpha mattes with a trained trimap-based network <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib35" title="">2024a</a>)</cite>. In contrast, MAM trains a learnable mask-to-matte module that takes predicted mask and intermediate features as input. On the other hand, SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite> extracts candidate features from the DINOV2 pre-trained ViT <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib23" title="">2024</a>)</cite> based on both saliency and interactive information, achieving a unified approach for both automatic and interactive matting.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Matting Datasets</span>.
Matting, as opposed to segmentation, aims to predict the alpha mattes of target objects which are continuous transparency between 0 and 1 rather than binary masks. The majority of matting datasets are limited in size due to the high annotation cost, often consisting of only a few thousand or even just a few hundred foreground objects <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib22" title="">2021</a>; Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite>. For instance, the Composition-1k dataset <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite> comprises 481 foreground instances, encompassing a variety of matting scenarios such as hair, fur, and semi-transparent objects. Considering the repetition of some foregrounds in the Composition-1k dataset (cropped patches from the same image), the Distinction-646 dataset <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib24" title="">2020</a>)</cite> is proposed, featuring 646 distinct foreground images. Focusing on specific categories, the AM-2K dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite> includes 20 categories of animals, with 100 real-world images per category, showcasing diverse appearances and forms. To amass a sufficient amount of training data, each foreground in the above datasets is typically merged with 20 to 100 different backgrounds to synthesize an expanded dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib17" title="">2023a</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Although there exists natural human matting dataset P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite> which contains approximately 10,000 annotations, it is designed for simple single-instance scenarios, where each image features only a single person as the primary subject. Training with the synthetic or simple natural datasets may prevent the network from learning complicated semantic cues and lead to inaccuracies in distinguishing foreground from background in complex real-world scenarios.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>COCO-Matting Dataset</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Investigation and Motivation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Interactive matting <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>; Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite> aims to predict the alpha matte of a specific object using a simple prompt, such as BBox. However, its training process typically requires labor-intensive and scarce alpha mattes. To mitigate this challenge, synthetic techniques are often employed to expand the training dataset by applying spatial transformations to foreground alpha mattes and overlaying them onto diverse background images. Unfortunately, training on synthetic data frequently fails to accurately distinguish between foreground and background in real-world and complex scenes. For example, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1(b)</span></a> (III), SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, a SoTA interactive matting method, has insufficient semantic comprehensibility and struggles to correctly segment foreground objects in scenes with complex occlusions, such as wrongly predicting intersection regions when two people overlap.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Dataset Creation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Inspired by the findings in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.SS1" title="3.1 Investigation and Motivation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we aim to leverage a large-scale, real-world segmentation dataset to improve the network’s semantic understanding. The COCO dataset <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib20" title="">2014</a>)</cite>, being one of the most representative and comprehensive benchmarks for segmentation, is a natural choice. However, due to the low-quality annotated masks in the original COCO dataset, we use the images from COCO combined with the refined annotations from COCONut <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib2" title="">2024</a>)</cite> to construct our COCO-Matting dataset. Given the complex interactions between humans and their surrounding environments, we focus on humans as the primary subjects, which also has many real-world applications, such as background replacement in video conferences <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib19" title="">2021</a>)</cite> and movie special effects production <cite class="ltx_cite ltx_citemacro_citep">(Fielding, <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib4" title="">2013</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Construction of the COCO-Matting dataset is fraught with two principal challenges. Firstly, the “human” category within the COCO dataset excludes accessories, such as hats, backpacks, or items being held, which are considered part human in matting tasks <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>, thus creating a difference in label distribution.
Secondly, annotations in COCO dataset are rough binary masks that lack precision and transparency, such as the delineation of hair strands.
In response to these challenges, we devise a comprehensive pipeline including 1) Accessory Fusion 2) Mask-to-Matte as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a>, and establish the COCO-Matting dataset.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="280" id="S3.F2.g1" src="x3.png" width="685"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
The construction of our proposed COCO-Matting dataset is divided into two parts: Accessory Fusion and Mask-to-Matte. Finally, a comparison of original masks and alpha mattes is shown.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.14"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.14.1">Accessory Fusion.</span> This step aims to merge masks that may belong to human accessories through the overlap rate between masks and thus aligns with the distribution of human annotations in the matting dataset. Specifically, given the instance segmentation masks for an image, we transform each binary mask <math alttext="M\in\{0,1\}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.2"><semantics id="S3.SS2.p3.1.m1.2a"><mrow id="S3.SS2.p3.1.m1.2.3" xref="S3.SS2.p3.1.m1.2.3.cmml"><mi id="S3.SS2.p3.1.m1.2.3.2" xref="S3.SS2.p3.1.m1.2.3.2.cmml">M</mi><mo id="S3.SS2.p3.1.m1.2.3.1" xref="S3.SS2.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p3.1.m1.2.3.3.2" xref="S3.SS2.p3.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.1.m1.2.3.3.1.cmml">{</mo><mn id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.p3.1.m1.2.3.3.2.2" xref="S3.SS2.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.1.m1.2.2" xref="S3.SS2.p3.1.m1.2.2.cmml">1</mn><mo id="S3.SS2.p3.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.p3.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.2b"><apply id="S3.SS2.p3.1.m1.2.3.cmml" xref="S3.SS2.p3.1.m1.2.3"><in id="S3.SS2.p3.1.m1.2.3.1.cmml" xref="S3.SS2.p3.1.m1.2.3.1"></in><ci id="S3.SS2.p3.1.m1.2.3.2.cmml" xref="S3.SS2.p3.1.m1.2.3.2">𝑀</ci><set id="S3.SS2.p3.1.m1.2.3.3.1.cmml" xref="S3.SS2.p3.1.m1.2.3.3.2"><cn id="S3.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p3.1.m1.1.1">0</cn><cn id="S3.SS2.p3.1.m1.2.2.cmml" type="integer" xref="S3.SS2.p3.1.m1.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">M\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.2d">italic_M ∈ { 0 , 1 }</annotation></semantics></math> into the form of minimum bounding rectangle <math alttext="M^{\text{rec}}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msup id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">M</mi><mtext id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3a.cmml">rec</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑀</ci><ci id="S3.SS2.p3.2.m2.1.1.3a.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><mtext id="S3.SS2.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.2.m2.1.1.3">rec</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">M^{\text{rec}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT</annotation></semantics></math>. For “human” mask <math alttext="M^{\text{rec}}_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msubsup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3a.cmml">human</mtext><mtext id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3a.cmml">rec</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3a.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3"><mtext id="S3.SS2.p3.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.3.m3.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.3.m3.1.1.3a.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><mtext id="S3.SS2.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.3.m3.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">M^{\text{rec}}_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math>, we measure its IoU with every other mask <math alttext="M^{\text{rec}}_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msubsup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3a.cmml">others</mtext><mtext id="S3.SS2.p3.4.m4.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.2.3a.cmml">rec</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.4.m4.1.1.2.3a.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3"><mtext id="S3.SS2.p3.4.m4.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.4.m4.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.4.m4.1.1.3a.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><mtext id="S3.SS2.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.4.m4.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">M^{\text{rec}}_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math>, which belongs to pre-defined possible accessories like bags, bottles, or ties.
When the calculated IoU value, denoted by <math alttext="\text{IoU}(M^{\text{rec}}_{\text{human}},M^{\text{rec}}_{\text{others}})" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.2"><semantics id="S3.SS2.p3.5.m5.2a"><mrow id="S3.SS2.p3.5.m5.2.2" xref="S3.SS2.p3.5.m5.2.2.cmml"><mtext id="S3.SS2.p3.5.m5.2.2.4" xref="S3.SS2.p3.5.m5.2.2.4a.cmml">IoU</mtext><mo id="S3.SS2.p3.5.m5.2.2.3" xref="S3.SS2.p3.5.m5.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p3.5.m5.2.2.2.2" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml"><mo id="S3.SS2.p3.5.m5.2.2.2.2.3" stretchy="false" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml">(</mo><msubsup id="S3.SS2.p3.5.m5.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.2.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.5.m5.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3a.cmml">human</mtext><mtext id="S3.SS2.p3.5.m5.1.1.1.1.1.2.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.3a.cmml">rec</mtext></msubsup><mo id="S3.SS2.p3.5.m5.2.2.2.2.4" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p3.5.m5.2.2.2.2.2" xref="S3.SS2.p3.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.5.m5.2.2.2.2.2.2.2" xref="S3.SS2.p3.5.m5.2.2.2.2.2.2.2.cmml">M</mi><mtext id="S3.SS2.p3.5.m5.2.2.2.2.2.3" xref="S3.SS2.p3.5.m5.2.2.2.2.2.3a.cmml">others</mtext><mtext id="S3.SS2.p3.5.m5.2.2.2.2.2.2.3" xref="S3.SS2.p3.5.m5.2.2.2.2.2.2.3a.cmml">rec</mtext></msubsup><mo id="S3.SS2.p3.5.m5.2.2.2.2.5" stretchy="false" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.2b"><apply id="S3.SS2.p3.5.m5.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2"><times id="S3.SS2.p3.5.m5.2.2.3.cmml" xref="S3.SS2.p3.5.m5.2.2.3"></times><ci id="S3.SS2.p3.5.m5.2.2.4a.cmml" xref="S3.SS2.p3.5.m5.2.2.4"><mtext id="S3.SS2.p3.5.m5.2.2.4.cmml" xref="S3.SS2.p3.5.m5.2.2.4">IoU</mtext></ci><interval closure="open" id="S3.SS2.p3.5.m5.2.2.2.3.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2"><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.2.3a.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.3"><mtext id="S3.SS2.p3.5.m5.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.3a.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3"><mtext id="S3.SS2.p3.5.m5.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3">human</mtext></ci></apply><apply id="S3.SS2.p3.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p3.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.5.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2.2.2">𝑀</ci><ci id="S3.SS2.p3.5.m5.2.2.2.2.2.2.3a.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2.2.3"><mtext id="S3.SS2.p3.5.m5.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.5.m5.2.2.2.2.2.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.5.m5.2.2.2.2.2.3a.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2.2.3"><mtext id="S3.SS2.p3.5.m5.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.5.m5.2.2.2.2.2.3">others</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.2c">\text{IoU}(M^{\text{rec}}_{\text{human}},M^{\text{rec}}_{\text{others}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.2d">IoU ( italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT human end_POSTSUBSCRIPT , italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT others end_POSTSUBSCRIPT )</annotation></semantics></math>, surpasses a predefined threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_τ</annotation></semantics></math>, we proceed to integrate <math alttext="M_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">M</mi><mtext id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3a.cmml">others</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑀</ci><ci id="S3.SS2.p3.7.m7.1.1.3a.cmml" xref="S3.SS2.p3.7.m7.1.1.3"><mtext id="S3.SS2.p3.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.7.m7.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">M_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="M_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><msub id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">M</mi><mtext id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3a.cmml">human</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑀</ci><ci id="S3.SS2.p3.8.m8.1.1.3a.cmml" xref="S3.SS2.p3.8.m8.1.1.3"><mtext id="S3.SS2.p3.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.8.m8.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">M_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_M start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math> which intuitively means that <math alttext="M_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><msub id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">M</mi><mtext id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3a.cmml">others</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2">𝑀</ci><ci id="S3.SS2.p3.9.m9.1.1.3a.cmml" xref="S3.SS2.p3.9.m9.1.1.3"><mtext id="S3.SS2.p3.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.9.m9.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">M_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math> is probably an accessory of <math alttext="M_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><msub id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">M</mi><mtext id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3a.cmml">human</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">𝑀</ci><ci id="S3.SS2.p3.10.m10.1.1.3a.cmml" xref="S3.SS2.p3.10.m10.1.1.3"><mtext id="S3.SS2.p3.10.m10.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.10.m10.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">M_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">italic_M start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math>.
In this work, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m11.1"><semantics id="S3.SS2.p3.11.m11.1a"><mi id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><ci id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m11.1d">italic_τ</annotation></semantics></math> is set to 0.8, empirically.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a> (upper left), the woman in the red BBox corresponds to <math alttext="M^{\text{rec}}_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m12.1"><semantics id="S3.SS2.p3.12.m12.1a"><msubsup id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml"><mi id="S3.SS2.p3.12.m12.1.1.2.2" xref="S3.SS2.p3.12.m12.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.12.m12.1.1.3" xref="S3.SS2.p3.12.m12.1.1.3a.cmml">human</mtext><mtext id="S3.SS2.p3.12.m12.1.1.2.3" xref="S3.SS2.p3.12.m12.1.1.2.3a.cmml">rec</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><apply id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1">subscript</csymbol><apply id="S3.SS2.p3.12.m12.1.1.2.cmml" xref="S3.SS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.2.1.cmml" xref="S3.SS2.p3.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.p3.12.m12.1.1.2.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.12.m12.1.1.2.3a.cmml" xref="S3.SS2.p3.12.m12.1.1.2.3"><mtext id="S3.SS2.p3.12.m12.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.12.m12.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.12.m12.1.1.3a.cmml" xref="S3.SS2.p3.12.m12.1.1.3"><mtext id="S3.SS2.p3.12.m12.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.12.m12.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">M^{\text{rec}}_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m12.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math>, while the tie and bottle in the yellow BBox represents those accessory objects <math alttext="M^{\text{rec}}_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m13.1"><semantics id="S3.SS2.p3.13.m13.1a"><msubsup id="S3.SS2.p3.13.m13.1.1" xref="S3.SS2.p3.13.m13.1.1.cmml"><mi id="S3.SS2.p3.13.m13.1.1.2.2" xref="S3.SS2.p3.13.m13.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.13.m13.1.1.3" xref="S3.SS2.p3.13.m13.1.1.3a.cmml">others</mtext><mtext id="S3.SS2.p3.13.m13.1.1.2.3" xref="S3.SS2.p3.13.m13.1.1.2.3a.cmml">rec</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.1b"><apply id="S3.SS2.p3.13.m13.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1">subscript</csymbol><apply id="S3.SS2.p3.13.m13.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.2.1.cmml" xref="S3.SS2.p3.13.m13.1.1">superscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.2.2.cmml" xref="S3.SS2.p3.13.m13.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.13.m13.1.1.2.3a.cmml" xref="S3.SS2.p3.13.m13.1.1.2.3"><mtext id="S3.SS2.p3.13.m13.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.13.m13.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.13.m13.1.1.3a.cmml" xref="S3.SS2.p3.13.m13.1.1.3"><mtext id="S3.SS2.p3.13.m13.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.13.m13.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.1c">M^{\text{rec}}_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m13.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math> with an IoU exceeding the threshold when calculated with <math alttext="M^{\text{rec}}_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p3.14.m14.1"><semantics id="S3.SS2.p3.14.m14.1a"><msubsup id="S3.SS2.p3.14.m14.1.1" xref="S3.SS2.p3.14.m14.1.1.cmml"><mi id="S3.SS2.p3.14.m14.1.1.2.2" xref="S3.SS2.p3.14.m14.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p3.14.m14.1.1.3" xref="S3.SS2.p3.14.m14.1.1.3a.cmml">human</mtext><mtext id="S3.SS2.p3.14.m14.1.1.2.3" xref="S3.SS2.p3.14.m14.1.1.2.3a.cmml">rec</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m14.1b"><apply id="S3.SS2.p3.14.m14.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m14.1.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1">subscript</csymbol><apply id="S3.SS2.p3.14.m14.1.1.2.cmml" xref="S3.SS2.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m14.1.1.2.1.cmml" xref="S3.SS2.p3.14.m14.1.1">superscript</csymbol><ci id="S3.SS2.p3.14.m14.1.1.2.2.cmml" xref="S3.SS2.p3.14.m14.1.1.2.2">𝑀</ci><ci id="S3.SS2.p3.14.m14.1.1.2.3a.cmml" xref="S3.SS2.p3.14.m14.1.1.2.3"><mtext id="S3.SS2.p3.14.m14.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p3.14.m14.1.1.2.3">rec</mtext></ci></apply><ci id="S3.SS2.p3.14.m14.1.1.3a.cmml" xref="S3.SS2.p3.14.m14.1.1.3"><mtext id="S3.SS2.p3.14.m14.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.14.m14.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m14.1c">M^{\text{rec}}_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.14.m14.1d">italic_M start_POSTSUPERSCRIPT rec end_POSTSUPERSCRIPT start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math>. Then, we integrate the masks of tie and bottle with the mask of woman, turning her into a woman wearing a tie and holding a bottle.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.6">However, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a> (lower left), the above fusion may incorrectly treat other objects like the green baseball mask as accessories. To counteract this, it is necessary to filter the mask <math alttext="M_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">M</mi><mtext id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3a.cmml">others</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p4.1.m1.1.1.3a.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><mtext id="S3.SS2.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.1.m1.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">M_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math>. We firstly apply a dilation operation <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib36" title="">2024b</a>)</cite> with a small kernel size of 4 and acquire <math alttext="{M_{\text{others}}}^{\prime}=\text{Dilate}(M_{\text{others}},4)" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.2"><semantics id="S3.SS2.p4.2.m2.2a"><mrow id="S3.SS2.p4.2.m2.2.2" xref="S3.SS2.p4.2.m2.2.2.cmml"><mmultiscripts id="S3.SS2.p4.2.m2.2.2.3" xref="S3.SS2.p4.2.m2.2.2.3.cmml"><mi id="S3.SS2.p4.2.m2.2.2.3.2.2" xref="S3.SS2.p4.2.m2.2.2.3.2.2.cmml">M</mi><mtext id="S3.SS2.p4.2.m2.2.2.3.2.3" xref="S3.SS2.p4.2.m2.2.2.3.2.3a.cmml">others</mtext><mrow id="S3.SS2.p4.2.m2.2.2.3a" xref="S3.SS2.p4.2.m2.2.2.3.cmml"></mrow><mrow id="S3.SS2.p4.2.m2.2.2.3b" xref="S3.SS2.p4.2.m2.2.2.3.cmml"></mrow><mo id="S3.SS2.p4.2.m2.2.2.3.3" xref="S3.SS2.p4.2.m2.2.2.3.3.cmml">′</mo></mmultiscripts><mo id="S3.SS2.p4.2.m2.2.2.2" xref="S3.SS2.p4.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS2.p4.2.m2.2.2.1" xref="S3.SS2.p4.2.m2.2.2.1.cmml"><mtext id="S3.SS2.p4.2.m2.2.2.1.3" xref="S3.SS2.p4.2.m2.2.2.1.3a.cmml">Dilate</mtext><mo id="S3.SS2.p4.2.m2.2.2.1.2" xref="S3.SS2.p4.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.2.m2.2.2.1.1.1" xref="S3.SS2.p4.2.m2.2.2.1.1.2.cmml"><mo id="S3.SS2.p4.2.m2.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p4.2.m2.2.2.1.1.2.cmml">(</mo><msub id="S3.SS2.p4.2.m2.2.2.1.1.1.1" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p4.2.m2.2.2.1.1.1.1.2" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.2.cmml">M</mi><mtext id="S3.SS2.p4.2.m2.2.2.1.1.1.1.3" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.3a.cmml">others</mtext></msub><mo id="S3.SS2.p4.2.m2.2.2.1.1.1.3" xref="S3.SS2.p4.2.m2.2.2.1.1.2.cmml">,</mo><mn id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">4</mn><mo id="S3.SS2.p4.2.m2.2.2.1.1.1.4" stretchy="false" xref="S3.SS2.p4.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.2b"><apply id="S3.SS2.p4.2.m2.2.2.cmml" xref="S3.SS2.p4.2.m2.2.2"><eq id="S3.SS2.p4.2.m2.2.2.2.cmml" xref="S3.SS2.p4.2.m2.2.2.2"></eq><apply id="S3.SS2.p4.2.m2.2.2.3.cmml" xref="S3.SS2.p4.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.2.2.3.1.cmml" xref="S3.SS2.p4.2.m2.2.2.3">superscript</csymbol><apply id="S3.SS2.p4.2.m2.2.2.3.2.cmml" xref="S3.SS2.p4.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.2.2.3.2.1.cmml" xref="S3.SS2.p4.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS2.p4.2.m2.2.2.3.2.2.cmml" xref="S3.SS2.p4.2.m2.2.2.3.2.2">𝑀</ci><ci id="S3.SS2.p4.2.m2.2.2.3.2.3a.cmml" xref="S3.SS2.p4.2.m2.2.2.3.2.3"><mtext id="S3.SS2.p4.2.m2.2.2.3.2.3.cmml" mathsize="70%" xref="S3.SS2.p4.2.m2.2.2.3.2.3">others</mtext></ci></apply><ci id="S3.SS2.p4.2.m2.2.2.3.3.cmml" xref="S3.SS2.p4.2.m2.2.2.3.3">′</ci></apply><apply id="S3.SS2.p4.2.m2.2.2.1.cmml" xref="S3.SS2.p4.2.m2.2.2.1"><times id="S3.SS2.p4.2.m2.2.2.1.2.cmml" xref="S3.SS2.p4.2.m2.2.2.1.2"></times><ci id="S3.SS2.p4.2.m2.2.2.1.3a.cmml" xref="S3.SS2.p4.2.m2.2.2.1.3"><mtext id="S3.SS2.p4.2.m2.2.2.1.3.cmml" xref="S3.SS2.p4.2.m2.2.2.1.3">Dilate</mtext></ci><interval closure="open" id="S3.SS2.p4.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.2.2.1.1.1"><apply id="S3.SS2.p4.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.2">𝑀</ci><ci id="S3.SS2.p4.2.m2.2.2.1.1.1.1.3a.cmml" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.3"><mtext id="S3.SS2.p4.2.m2.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.2.m2.2.2.1.1.1.1.3">others</mtext></ci></apply><cn id="S3.SS2.p4.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p4.2.m2.1.1">4</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.2c">{M_{\text{others}}}^{\prime}=\text{Dilate}(M_{\text{others}},4)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.2d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = Dilate ( italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT , 4 )</annotation></semantics></math> to expand the shape of <math alttext="M_{\text{others}}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">M</mi><mtext id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3a.cmml">others</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑀</ci><ci id="S3.SS2.p4.3.m3.1.1.3a.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><mtext id="S3.SS2.p4.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.3.m3.1.1.3">others</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">M_{\text{others}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT</annotation></semantics></math>. Then, if the intersection of <math alttext="M_{\text{human}}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">M</mi><mtext id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3a.cmml">human</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑀</ci><ci id="S3.SS2.p4.4.m4.1.1.3a.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><mtext id="S3.SS2.p4.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.4.m4.1.1.3">human</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">M_{\text{human}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_M start_POSTSUBSCRIPT human end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{M_{\text{others}}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mmultiscripts id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2.2" xref="S3.SS2.p4.5.m5.1.1.2.2.cmml">M</mi><mtext id="S3.SS2.p4.5.m5.1.1.2.3" xref="S3.SS2.p4.5.m5.1.1.2.3a.cmml">others</mtext><mrow id="S3.SS2.p4.5.m5.1.1a" xref="S3.SS2.p4.5.m5.1.1.cmml"></mrow><mrow id="S3.SS2.p4.5.m5.1.1b" xref="S3.SS2.p4.5.m5.1.1.cmml"></mrow><mo id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.2.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2.2">𝑀</ci><ci id="S3.SS2.p4.5.m5.1.1.2.3a.cmml" xref="S3.SS2.p4.5.m5.1.1.2.3"><mtext id="S3.SS2.p4.5.m5.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p4.5.m5.1.1.2.3">others</mtext></ci></apply><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">{M_{\text{others}}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_M start_POSTSUBSCRIPT others end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is empty, e.g., the baseball and the man holding the bat in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a>, we abandon this fusion. With the mask filter, our accessory fusion successfully incorporates items such as bottles, ties, and gloves into the “human” category and gets <math alttext="M_{\text{fusion}}" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">M</mi><mtext id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3a.cmml">fusion</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝑀</ci><ci id="S3.SS2.p4.6.m6.1.1.3a.cmml" xref="S3.SS2.p4.6.m6.1.1.3"><mtext id="S3.SS2.p4.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.6.m6.1.1.3">fusion</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">M_{\text{fusion}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT</annotation></semantics></math>, in accordance with the criteria of matting tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.2.1">Mask-to-Matte.</span> Here we aim to convert binary coarse masks into continuous high-precision alpha mattes that match the matting annotations. Specifically, given a fused mask <math alttext="M_{\text{fusion}}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">M</mi><mtext id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3a.cmml">fusion</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p5.1.m1.1.1.3a.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><mtext id="S3.SS2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p5.1.m1.1.1.3">fusion</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">M_{\text{fusion}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT</annotation></semantics></math>, a straightforward way to obtain alpha mattes is to obtain the trimap by erosion and forward it to the trained trimap-based matting network.
Nonetheless, after fusion as shown in the blue box in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a>, gaps between the masks of different objects are discernible, potentially impeding the generation of correct trimaps.
To address this, we firstly obtain <math alttext="M_{\text{fusion}}^{{}^{\prime}}=\text{Dilate}(M_{\text{fusion}},4)" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.2"><semantics id="S3.SS2.p5.2.m2.2a"><mrow id="S3.SS2.p5.2.m2.2.2" xref="S3.SS2.p5.2.m2.2.2.cmml"><msubsup id="S3.SS2.p5.2.m2.2.2.3" xref="S3.SS2.p5.2.m2.2.2.3.cmml"><mi id="S3.SS2.p5.2.m2.2.2.3.2.2" xref="S3.SS2.p5.2.m2.2.2.3.2.2.cmml">M</mi><mtext id="S3.SS2.p5.2.m2.2.2.3.2.3" xref="S3.SS2.p5.2.m2.2.2.3.2.3a.cmml">fusion</mtext><msup id="S3.SS2.p5.2.m2.2.2.3.3" xref="S3.SS2.p5.2.m2.2.2.3.3.cmml"><mi id="S3.SS2.p5.2.m2.2.2.3.3a" xref="S3.SS2.p5.2.m2.2.2.3.3.cmml"></mi><mo id="S3.SS2.p5.2.m2.2.2.3.3.1" xref="S3.SS2.p5.2.m2.2.2.3.3.1.cmml">′</mo></msup></msubsup><mo id="S3.SS2.p5.2.m2.2.2.2" xref="S3.SS2.p5.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS2.p5.2.m2.2.2.1" xref="S3.SS2.p5.2.m2.2.2.1.cmml"><mtext id="S3.SS2.p5.2.m2.2.2.1.3" xref="S3.SS2.p5.2.m2.2.2.1.3a.cmml">Dilate</mtext><mo id="S3.SS2.p5.2.m2.2.2.1.2" xref="S3.SS2.p5.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS2.p5.2.m2.2.2.1.1.1" xref="S3.SS2.p5.2.m2.2.2.1.1.2.cmml"><mo id="S3.SS2.p5.2.m2.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p5.2.m2.2.2.1.1.2.cmml">(</mo><msub id="S3.SS2.p5.2.m2.2.2.1.1.1.1" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.2.2.1.1.1.1.2" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.2.cmml">M</mi><mtext id="S3.SS2.p5.2.m2.2.2.1.1.1.1.3" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.3a.cmml">fusion</mtext></msub><mo id="S3.SS2.p5.2.m2.2.2.1.1.1.3" xref="S3.SS2.p5.2.m2.2.2.1.1.2.cmml">,</mo><mn id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">4</mn><mo id="S3.SS2.p5.2.m2.2.2.1.1.1.4" stretchy="false" xref="S3.SS2.p5.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.2b"><apply id="S3.SS2.p5.2.m2.2.2.cmml" xref="S3.SS2.p5.2.m2.2.2"><eq id="S3.SS2.p5.2.m2.2.2.2.cmml" xref="S3.SS2.p5.2.m2.2.2.2"></eq><apply id="S3.SS2.p5.2.m2.2.2.3.cmml" xref="S3.SS2.p5.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.2.2.3.1.cmml" xref="S3.SS2.p5.2.m2.2.2.3">superscript</csymbol><apply id="S3.SS2.p5.2.m2.2.2.3.2.cmml" xref="S3.SS2.p5.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.2.2.3.2.1.cmml" xref="S3.SS2.p5.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS2.p5.2.m2.2.2.3.2.2.cmml" xref="S3.SS2.p5.2.m2.2.2.3.2.2">𝑀</ci><ci id="S3.SS2.p5.2.m2.2.2.3.2.3a.cmml" xref="S3.SS2.p5.2.m2.2.2.3.2.3"><mtext id="S3.SS2.p5.2.m2.2.2.3.2.3.cmml" mathsize="70%" xref="S3.SS2.p5.2.m2.2.2.3.2.3">fusion</mtext></ci></apply><apply id="S3.SS2.p5.2.m2.2.2.3.3.cmml" xref="S3.SS2.p5.2.m2.2.2.3.3"><ci id="S3.SS2.p5.2.m2.2.2.3.3.1.cmml" xref="S3.SS2.p5.2.m2.2.2.3.3.1">′</ci></apply></apply><apply id="S3.SS2.p5.2.m2.2.2.1.cmml" xref="S3.SS2.p5.2.m2.2.2.1"><times id="S3.SS2.p5.2.m2.2.2.1.2.cmml" xref="S3.SS2.p5.2.m2.2.2.1.2"></times><ci id="S3.SS2.p5.2.m2.2.2.1.3a.cmml" xref="S3.SS2.p5.2.m2.2.2.1.3"><mtext id="S3.SS2.p5.2.m2.2.2.1.3.cmml" xref="S3.SS2.p5.2.m2.2.2.1.3">Dilate</mtext></ci><interval closure="open" id="S3.SS2.p5.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.2.2.1.1.1"><apply id="S3.SS2.p5.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.2">𝑀</ci><ci id="S3.SS2.p5.2.m2.2.2.1.1.1.1.3a.cmml" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.3"><mtext id="S3.SS2.p5.2.m2.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p5.2.m2.2.2.1.1.1.1.3">fusion</mtext></ci></apply><cn id="S3.SS2.p5.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p5.2.m2.1.1">4</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.2c">M_{\text{fusion}}^{{}^{\prime}}=\text{Dilate}(M_{\text{fusion}},4)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.2d">italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT = Dilate ( italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT , 4 )</annotation></semantics></math> by a dilation operation, and then perform two erosion operations on the mask and gain</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{M^{\text{ero}}_{\text{fusion}}}^{\prime}=\text{Erode}(M_{\text{fusion}}^{{}^{%
\prime}},\omega)\ \ \ \text{and}\ \ \ {\tilde{M}^{\text{ero}}_{\text{fusion}}}%
{}^{\prime}=\text{Erode}(1-M_{\text{fusion}}^{{}^{\prime}},\omega),\ \ \ \text%
{where}\ \ \omega=\sqrt{\sum\nolimits_{i,j}M_{\text{fusion}}^{{}^{\prime}}}/\eta." class="ltx_math_unparsed" display="block" id="S3.Ex1.m1.4"><semantics id="S3.Ex1.m1.4a"><mrow id="S3.Ex1.m1.4b"><mmultiscripts id="S3.Ex1.m1.4.5"><mi id="S3.Ex1.m1.4.5.2.2.2">M</mi><mtext id="S3.Ex1.m1.4.5.2.3">fusion</mtext><mtext id="S3.Ex1.m1.4.5.2.2.3">ero</mtext><mrow id="S3.Ex1.m1.4.5a"></mrow><mo id="S3.Ex1.m1.4.5.3">′</mo></mmultiscripts><mo id="S3.Ex1.m1.4.6">=</mo><mtext id="S3.Ex1.m1.4.7">Erode</mtext><mrow id="S3.Ex1.m1.4.8"><mo id="S3.Ex1.m1.4.8.1" stretchy="false">(</mo><msubsup id="S3.Ex1.m1.4.8.2"><mi id="S3.Ex1.m1.4.8.2.2.2">M</mi><mtext id="S3.Ex1.m1.4.8.2.2.3">fusion</mtext><msup id="S3.Ex1.m1.4.8.2.3"><mi id="S3.Ex1.m1.4.8.2.3a"></mi><mo id="S3.Ex1.m1.4.8.2.3.1">′</mo></msup></msubsup><mo id="S3.Ex1.m1.4.8.3">,</mo><mi id="S3.Ex1.m1.3.3">ω</mi><mo id="S3.Ex1.m1.4.8.4" stretchy="false">)</mo></mrow><mspace id="S3.Ex1.m1.4.9" width="1.5em"></mspace><mtext id="S3.Ex1.m1.4.4">and</mtext><mspace id="S3.Ex1.m1.4.10" width="1.5em"></mspace><msubsup id="S3.Ex1.m1.4.11"><mover accent="true" id="S3.Ex1.m1.4.11.2.2"><mi id="S3.Ex1.m1.4.11.2.2.2">M</mi><mo id="S3.Ex1.m1.4.11.2.2.1">~</mo></mover><mtext id="S3.Ex1.m1.4.11.3">fusion</mtext><mtext id="S3.Ex1.m1.4.11.2.3">ero</mtext></msubsup><mmultiscripts id="S3.Ex1.m1.4.12"><mo id="S3.Ex1.m1.4.12.2">=</mo><mprescripts id="S3.Ex1.m1.4.12a"></mprescripts><mrow id="S3.Ex1.m1.4.12b"></mrow><mo id="S3.Ex1.m1.4.12.3">′</mo></mmultiscripts><mtext id="S3.Ex1.m1.4.13">Erode</mtext><mrow id="S3.Ex1.m1.4.14"><mo id="S3.Ex1.m1.4.14.1" stretchy="false">(</mo><mn id="S3.Ex1.m1.4.14.2">1</mn><mo id="S3.Ex1.m1.4.14.3">−</mo><msubsup id="S3.Ex1.m1.4.14.4"><mi id="S3.Ex1.m1.4.14.4.2.2">M</mi><mtext id="S3.Ex1.m1.4.14.4.2.3">fusion</mtext><msup id="S3.Ex1.m1.4.14.4.3"><mi id="S3.Ex1.m1.4.14.4.3a"></mi><mo id="S3.Ex1.m1.4.14.4.3.1">′</mo></msup></msubsup><mo id="S3.Ex1.m1.4.14.5">,</mo><mi id="S3.Ex1.m1.4.14.6">ω</mi><mo id="S3.Ex1.m1.4.14.7" stretchy="false">)</mo></mrow><mo id="S3.Ex1.m1.4.15" rspace="1.667em">,</mo><mtext id="S3.Ex1.m1.4.16">where</mtext><mspace id="S3.Ex1.m1.4.17" width="1em"></mspace><mi id="S3.Ex1.m1.4.18">ω</mi><mo id="S3.Ex1.m1.4.19">=</mo><msqrt id="S3.Ex1.m1.2.2"><mrow id="S3.Ex1.m1.2.2.2"><msub id="S3.Ex1.m1.2.2.2.3"><mo id="S3.Ex1.m1.2.2.2.3.2">∑</mo><mrow id="S3.Ex1.m1.2.2.2.2.2.4"><mi id="S3.Ex1.m1.1.1.1.1.1.1">i</mi><mo id="S3.Ex1.m1.2.2.2.2.2.4.1">,</mo><mi id="S3.Ex1.m1.2.2.2.2.2.2">j</mi></mrow></msub><msubsup id="S3.Ex1.m1.2.2.2.4"><mi id="S3.Ex1.m1.2.2.2.4.2.2">M</mi><mtext id="S3.Ex1.m1.2.2.2.4.2.3">fusion</mtext><msup id="S3.Ex1.m1.2.2.2.4.3"><mi id="S3.Ex1.m1.2.2.2.4.3a"></mi><mo id="S3.Ex1.m1.2.2.2.4.3.1">′</mo></msup></msubsup></mrow></msqrt><mo id="S3.Ex1.m1.4.20">/</mo><mi id="S3.Ex1.m1.4.21">η</mi><mo id="S3.Ex1.m1.4.22" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">{M^{\text{ero}}_{\text{fusion}}}^{\prime}=\text{Erode}(M_{\text{fusion}}^{{}^{%
\prime}},\omega)\ \ \ \text{and}\ \ \ {\tilde{M}^{\text{ero}}_{\text{fusion}}}%
{}^{\prime}=\text{Erode}(1-M_{\text{fusion}}^{{}^{\prime}},\omega),\ \ \ \text%
{where}\ \ \omega=\sqrt{\sum\nolimits_{i,j}M_{\text{fusion}}^{{}^{\prime}}}/\eta.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.4d">italic_M start_POSTSUPERSCRIPT ero end_POSTSUPERSCRIPT start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = Erode ( italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_ω ) and over~ start_ARG italic_M end_ARG start_POSTSUPERSCRIPT ero end_POSTSUPERSCRIPT start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT = Erode ( 1 - italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_ω ) , where italic_ω = square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_ARG / italic_η .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.6">Here <math alttext="\omega" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m1.1"><semantics id="S3.SS2.p5.3.m1.1a"><mi id="S3.SS2.p5.3.m1.1.1" xref="S3.SS2.p5.3.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m1.1b"><ci id="S3.SS2.p5.3.m1.1.1.cmml" xref="S3.SS2.p5.3.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m1.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m1.1d">italic_ω</annotation></semantics></math> denotes an adaptive kernel size based on mask area and <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m2.1"><semantics id="S3.SS2.p5.4.m2.1a"><mi id="S3.SS2.p5.4.m2.1.1" xref="S3.SS2.p5.4.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m2.1b"><ci id="S3.SS2.p5.4.m2.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m2.1d">italic_η</annotation></semantics></math> is the scale factor set to 12 in our experiments.
Finally, we forward the following trimap <math alttext="T(x)" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m3.1"><semantics id="S3.SS2.p5.5.m3.1a"><mrow id="S3.SS2.p5.5.m3.1.2" xref="S3.SS2.p5.5.m3.1.2.cmml"><mi id="S3.SS2.p5.5.m3.1.2.2" xref="S3.SS2.p5.5.m3.1.2.2.cmml">T</mi><mo id="S3.SS2.p5.5.m3.1.2.1" xref="S3.SS2.p5.5.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p5.5.m3.1.2.3.2" xref="S3.SS2.p5.5.m3.1.2.cmml"><mo id="S3.SS2.p5.5.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p5.5.m3.1.2.cmml">(</mo><mi id="S3.SS2.p5.5.m3.1.1" xref="S3.SS2.p5.5.m3.1.1.cmml">x</mi><mo id="S3.SS2.p5.5.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p5.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m3.1b"><apply id="S3.SS2.p5.5.m3.1.2.cmml" xref="S3.SS2.p5.5.m3.1.2"><times id="S3.SS2.p5.5.m3.1.2.1.cmml" xref="S3.SS2.p5.5.m3.1.2.1"></times><ci id="S3.SS2.p5.5.m3.1.2.2.cmml" xref="S3.SS2.p5.5.m3.1.2.2">𝑇</ci><ci id="S3.SS2.p5.5.m3.1.1.cmml" xref="S3.SS2.p5.5.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m3.1c">T(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m3.1d">italic_T ( italic_x )</annotation></semantics></math> to the trained trimap-based network <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib8" title="">2023</a>)</cite> and obtain the corresponding alpha mattes <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m4.1"><semantics id="S3.SS2.p5.6.m4.1a"><mi id="S3.SS2.p5.6.m4.1.1" xref="S3.SS2.p5.6.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m4.1b"><ci id="S3.SS2.p5.6.m4.1.1.cmml" xref="S3.SS2.p5.6.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m4.1d">italic_A</annotation></semantics></math> which is our target.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T(x)=\begin{cases}1,&amp;\text{if }{M^{\text{ero}}_{\text{fusion}}}^{\prime}(x)=1,%
\\
0,&amp;\text{if }{\tilde{M}^{\text{ero}}_{\text{fusion}}}{}^{\prime}(x)=1,\\
0.5,&amp;\text{otherwise}.\end{cases}" class="ltx_math_unparsed" display="block" id="S3.Ex2.m1.7"><semantics id="S3.Ex2.m1.7a"><mrow id="S3.Ex2.m1.7.8"><mrow id="S3.Ex2.m1.7.8.2"><mi id="S3.Ex2.m1.7.8.2.2">T</mi><mo id="S3.Ex2.m1.7.8.2.1">⁢</mo><mrow id="S3.Ex2.m1.7.8.2.3.2"><mo id="S3.Ex2.m1.7.8.2.3.2.1" stretchy="false">(</mo><mi id="S3.Ex2.m1.7.7">x</mi><mo id="S3.Ex2.m1.7.8.2.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.Ex2.m1.7.8.1">=</mo><mrow id="S3.Ex2.m1.6.6"><mo id="S3.Ex2.m1.6.6.7">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex2.m1.6.6.6" rowspacing="0pt"><mtr id="S3.Ex2.m1.6.6.6a"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6b"><mrow id="S3.Ex2.m1.1.1.1.1.1.1.3"><mn id="S3.Ex2.m1.1.1.1.1.1.1.1">1</mn><mo id="S3.Ex2.m1.1.1.1.1.1.1.3.1">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6c"><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2"><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2.1"><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2"><mtext id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.2">if </mtext><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.1">⁢</mo><mmultiscripts id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3"><mi id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3.2.2.2">M</mi><mtext id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3.2.3">fusion</mtext><mtext id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3.2.2.3">ero</mtext><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3a"></mrow><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.3.3">′</mo></mmultiscripts><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.1a">⁢</mo><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.4.2"><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.4.2.1" stretchy="false">(</mo><mi id="S3.Ex2.m1.2.2.2.2.2.1.1">x</mi><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.2.4.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1.1">=</mo><mn id="S3.Ex2.m1.2.2.2.2.2.1.2.1.3">1</mn></mrow><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.2">,</mo></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6.6d"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6e"><mrow id="S3.Ex2.m1.3.3.3.3.1.1.3"><mn id="S3.Ex2.m1.3.3.3.3.1.1.1">0</mn><mo id="S3.Ex2.m1.3.3.3.3.1.1.3.1">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6f"><mrow id="S3.Ex2.m1.4.4.4.4.2.1"><mtext id="S3.Ex2.m1.4.4.4.4.2.1.1">if </mtext><msubsup id="S3.Ex2.m1.4.4.4.4.2.1.2"><mover accent="true" id="S3.Ex2.m1.4.4.4.4.2.1.2.2.2"><mi id="S3.Ex2.m1.4.4.4.4.2.1.2.2.2.2">M</mi><mo id="S3.Ex2.m1.4.4.4.4.2.1.2.2.2.1">~</mo></mover><mtext id="S3.Ex2.m1.4.4.4.4.2.1.2.3">fusion</mtext><mtext id="S3.Ex2.m1.4.4.4.4.2.1.2.2.3">ero</mtext></msubsup><mmultiscripts id="S3.Ex2.m1.4.4.4.4.2.1.3"><mrow id="S3.Ex2.m1.4.4.4.4.2.1.3.2"><mo id="S3.Ex2.m1.4.4.4.4.2.1.3.2.1" stretchy="false">(</mo><mi id="S3.Ex2.m1.4.4.4.4.2.1.3.2.2">x</mi><mo id="S3.Ex2.m1.4.4.4.4.2.1.3.2.3" stretchy="false">)</mo></mrow><mprescripts id="S3.Ex2.m1.4.4.4.4.2.1.3a"></mprescripts><mrow id="S3.Ex2.m1.4.4.4.4.2.1.3b"></mrow><mo id="S3.Ex2.m1.4.4.4.4.2.1.3.3">′</mo></mmultiscripts><mo id="S3.Ex2.m1.4.4.4.4.2.1.4">=</mo><mn id="S3.Ex2.m1.4.4.4.4.2.1.5">1</mn><mo id="S3.Ex2.m1.4.4.4.4.2.1.6">,</mo></mrow></mtd></mtr><mtr id="S3.Ex2.m1.6.6.6g"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6h"><mrow id="S3.Ex2.m1.5.5.5.5.1.1.3"><mn id="S3.Ex2.m1.5.5.5.5.1.1.1">0.5</mn><mo id="S3.Ex2.m1.5.5.5.5.1.1.3.1">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.6.6.6i"><mrow id="S3.Ex2.m1.6.6.6.6.2.1.3"><mtext id="S3.Ex2.m1.6.6.6.6.2.1.1">otherwise</mtext><mo id="S3.Ex2.m1.6.6.6.6.2.1.3.1" lspace="0em">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.7b">T(x)=\begin{cases}1,&amp;\text{if }{M^{\text{ero}}_{\text{fusion}}}^{\prime}(x)=1,%
\\
0,&amp;\text{if }{\tilde{M}^{\text{ero}}_{\text{fusion}}}{}^{\prime}(x)=1,\\
0.5,&amp;\text{otherwise}.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.7c">italic_T ( italic_x ) = { start_ROW start_CELL 1 , end_CELL start_CELL if italic_M start_POSTSUPERSCRIPT ero end_POSTSUPERSCRIPT start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x ) = 1 , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL if over~ start_ARG italic_M end_ARG start_POSTSUPERSCRIPT ero end_POSTSUPERSCRIPT start_POSTSUBSCRIPT fusion end_POSTSUBSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_x ) = 1 , end_CELL end_ROW start_ROW start_CELL 0.5 , end_CELL start_CELL otherwise . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table ltx_figure_panel ltx_align_floatright" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of our COCO-Matting with existing matting datasets. “Number” denotes number of alpha mattes. “Complex” and “Natural” refer to whether a complex scene contains multi-instance and whether the foreground is in the natural scene, respectively. </figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:429.3pt;height:156pt;vertical-align:-1.1pt;"><span class="ltx_transformed_inner" style="transform:translate(15.1pt,-5.4pt) scale(1.07559062445293,1.07559062445293) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">Number</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">Class</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">Complex</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.5" style="padding-left:2.8pt;padding-right:2.8pt;">Natural</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.2.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">Comp.-1K <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">481</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">Object</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.5" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.3.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">Dist-646 <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib24" title="">2020</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.2" style="padding-left:2.8pt;padding-right:2.8pt;">646</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">Object</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.3.1" style="padding-left:2.8pt;padding-right:2.8pt;">AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.2" style="padding-left:2.8pt;padding-right:2.8pt;">2,000</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">Animal</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.4" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.5" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.5.4.1" style="padding-left:2.8pt;padding-right:2.8pt;">Human-2K <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib22" title="">2021</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.2" style="padding-left:2.8pt;padding-right:2.8pt;">2,100</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.3" style="padding-left:2.8pt;padding-right:2.8pt;">Human</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.4" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.5" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.6.5.1" style="padding-left:2.8pt;padding-right:2.8pt;">P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.2" style="padding-left:2.8pt;padding-right:2.8pt;">10,421</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.3" style="padding-left:2.8pt;padding-right:2.8pt;">Human</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.4" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.5" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.7.6.1" style="padding-left:2.8pt;padding-right:2.8pt;">RefMatte <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.2" style="padding-left:2.8pt;padding-right:2.8pt;">13,181</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.3" style="padding-left:2.8pt;padding-right:2.8pt;">Human</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.4" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.5" style="padding-left:2.8pt;padding-right:2.8pt;">✗</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.1.1.8.7.1" style="padding-left:2.8pt;padding-right:2.8pt;">COCO-Matting</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.1.1.8.7.2" style="padding-left:2.8pt;padding-right:2.8pt;">38,251</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.1.1.8.7.3" style="padding-left:2.8pt;padding-right:2.8pt;">Human</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.1.1.8.7.4" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.1.1.8.7.5" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">With the above two steps, we convert the original masks into alpha mattes with superior precision. As shown in the lower right part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.F2" title="Figure 2 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a>, our generated alpha mattes exhibit refined edge transitions, particularly enhancing intricate details such as hair strands and the contours of objects like baseball gloves. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S3.T1" title="Table 1 ‣ 3.2 Dataset Creation ‣ 3 COCO-Matting Dataset ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1</span></a> highlights the advantages of our COCO-Matting dataset over previous datasets: 1) COCO-Matting includes a diverse and complex “human” class, with 38,251 alpha mattes—the largest of its kind. 2) Unlike P3M-10K which contains only a single human instance per image, our COCO-Matting features multiple human instances within complex scenes. 3) COCO-Matting presents natural scenes, as opposed to RefMatte which synthesizes multi-instance samples on arbitrary and disharmonious backgrounds.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Semantic Enhanced Matting Methodology</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Here we first introduce our proposed network architecture and then elaborate on its training loss.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>SEMat Network</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Our proposed SEMat builds on SAM <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>)</cite>, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.F3" title="Figure 3 ‣ 4.1 SEMat Network ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">3</span></a>. While previous works like MatAny <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib36" title="">2024b</a>)</cite> and MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> are also based on SAM, they rely on intermediate features or coarse masks from a frozen SAM, using additional refinement networks to produce alpha mattes.
However, these kinds of approaches face two significant challenges. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">(1) Unaligned Features:</span> Matting demands precise attention to edge details and object transparency, which cannot be adequately captured by simply extracting features from a frozen SAM designed primarily for rough object segmentation. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">(2) Unaligned Mattes:</span> The SAM decoder struggles to accurately segment objects specific to matting, such as smoke, nets, and silk as shown in <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite>, which are not common in typical segmentation tasks. This mismatch can severely degrade the performance of subsequent refinement stages.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To address the first challenge, we propose a Feature-Aligned Transformer, which fuses the prompt with image patches during the input stage through an additional patch embedding layer and integrates LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib7" title="">2022</a>)</cite> into the ViT backbone.
Accordingly, it can focus more on the prompt region while tuning itself to extract fine-grained and transparency features. For the second challenge, we introduce the Matte-Aligned Decoder, which adds several matting tokens and the matting adapter in SAM’s mask decoder to better segment matting-specific objects. Additionally, a lightweight, UNet-inspired <cite class="ltx_cite ltx_citemacro_citep">(Ronneberger et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib27" title="">2015</a>)</cite> matting decoder is incorporated to further refine the results. Consequently, our decoder is able to segment matting-specific objects and convert coarse masks into high-precision mattes.
Below, we elaborate on both of these solutions in detail.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Feature-Aligned Transformer.</span> Since our goal is to perform matting for specific objects of interest, we use their BBox prompts as additional guidance to help the ViT backbone focus on learning the features of these target objects. This extra guidance is essential because, without it, ViT would extract generic features for segmentation, making it difficult to distinguish the foreground object and its transparency. So in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.F3" title="Figure 3 ‣ 4.1 SEMat Network ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">3</span></a>, we convert the BBox prompt into a binary mask and concatenate it with the input image to forward a learnable embedding layer. This process directs ViT to identify which objects are of interest, thereby aligning the extracted features with the matting task.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">Additionally, we incorporate LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib7" title="">2022</a>)</cite> into the ViT backbone for efficient fine-tuning, further aligning the feature extraction with the matting task. Moreover, by focusing on the features of the specific objects indicated by the BBox prompts, the ViT backbone can learn more fine-grained details, such as precise edges and transparency, which are crucial for accurate matting.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="236" id="S4.F3.g1" src="x4.png" width="685"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Given an image and a box prompt, the alpha matte is obtained by the process of our proposed Feature-Aligned Transformer and Matte-Aligned Decoder sequentially. Furthermore, combined with the traditional matting loss, the frozen SAM and trimap annotations are introduced to calculate the regularization and trimap loss during training. 
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.3.1">Matte-Aligned Decoder.</span> To effectively segment matting-specific objects, we enhance the SAM mask decoder by introducing three specialized matting tokens and a matting adapter. This shares a similar spirit with HQ-SAM <cite class="ltx_cite ltx_citemacro_citep">(Ke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib9" title="">2024</a>)</cite> which employs an additional learnable HQ-token to refine segmentation masks. As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.F3" title="Figure 3 ‣ 4.1 SEMat Network ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">3</span></a>, the SAM mask decoder augmented by matting adapter processes the extracted image features <math alttext="\{f_{i}\}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><mrow id="S4.SS1.p5.1.m1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.2.cmml"><mo id="S4.SS1.p5.1.m1.1.1.1.2" stretchy="false" xref="S4.SS1.p5.1.m1.1.1.2.cmml">{</mo><msub id="S4.SS1.p5.1.m1.1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p5.1.m1.1.1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p5.1.m1.1.1.1.3" stretchy="false" xref="S4.SS1.p5.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><set id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.1"><apply id="S4.SS1.p5.1.m1.1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.1.1.2">𝑓</ci><ci id="S4.SS1.p5.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\{f_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">{ italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> alongside a concatenation of BBox prompt tokens, SAM tokens from vanilla SAM, and our learnable matting tokens for generating mask features <math alttext="f_{M}\in\mathbb{R}^{[H\times W,C]}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.2"><semantics id="S4.SS1.p5.2.m2.2a"><mrow id="S4.SS1.p5.2.m2.2.3" xref="S4.SS1.p5.2.m2.2.3.cmml"><msub id="S4.SS1.p5.2.m2.2.3.2" xref="S4.SS1.p5.2.m2.2.3.2.cmml"><mi id="S4.SS1.p5.2.m2.2.3.2.2" xref="S4.SS1.p5.2.m2.2.3.2.2.cmml">f</mi><mi id="S4.SS1.p5.2.m2.2.3.2.3" xref="S4.SS1.p5.2.m2.2.3.2.3.cmml">M</mi></msub><mo id="S4.SS1.p5.2.m2.2.3.1" xref="S4.SS1.p5.2.m2.2.3.1.cmml">∈</mo><msup id="S4.SS1.p5.2.m2.2.3.3" xref="S4.SS1.p5.2.m2.2.3.3.cmml"><mi id="S4.SS1.p5.2.m2.2.3.3.2" xref="S4.SS1.p5.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p5.2.m2.2.2.2.2" xref="S4.SS1.p5.2.m2.2.2.2.3.cmml"><mo id="S4.SS1.p5.2.m2.2.2.2.2.2" stretchy="false" xref="S4.SS1.p5.2.m2.2.2.2.3.cmml">[</mo><mrow id="S4.SS1.p5.2.m2.2.2.2.2.1" xref="S4.SS1.p5.2.m2.2.2.2.2.1.cmml"><mi id="S4.SS1.p5.2.m2.2.2.2.2.1.2" xref="S4.SS1.p5.2.m2.2.2.2.2.1.2.cmml">H</mi><mo id="S4.SS1.p5.2.m2.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p5.2.m2.2.2.2.2.1.1.cmml">×</mo><mi id="S4.SS1.p5.2.m2.2.2.2.2.1.3" xref="S4.SS1.p5.2.m2.2.2.2.2.1.3.cmml">W</mi></mrow><mo id="S4.SS1.p5.2.m2.2.2.2.2.3" xref="S4.SS1.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.2.m2.1.1.1.1" xref="S4.SS1.p5.2.m2.1.1.1.1.cmml">C</mi><mo id="S4.SS1.p5.2.m2.2.2.2.2.4" stretchy="false" xref="S4.SS1.p5.2.m2.2.2.2.3.cmml">]</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.2b"><apply id="S4.SS1.p5.2.m2.2.3.cmml" xref="S4.SS1.p5.2.m2.2.3"><in id="S4.SS1.p5.2.m2.2.3.1.cmml" xref="S4.SS1.p5.2.m2.2.3.1"></in><apply id="S4.SS1.p5.2.m2.2.3.2.cmml" xref="S4.SS1.p5.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.2.3.2.1.cmml" xref="S4.SS1.p5.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS1.p5.2.m2.2.3.2.2.cmml" xref="S4.SS1.p5.2.m2.2.3.2.2">𝑓</ci><ci id="S4.SS1.p5.2.m2.2.3.2.3.cmml" xref="S4.SS1.p5.2.m2.2.3.2.3">𝑀</ci></apply><apply id="S4.SS1.p5.2.m2.2.3.3.cmml" xref="S4.SS1.p5.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.2.3.3.1.cmml" xref="S4.SS1.p5.2.m2.2.3.3">superscript</csymbol><ci id="S4.SS1.p5.2.m2.2.3.3.2.cmml" xref="S4.SS1.p5.2.m2.2.3.3.2">ℝ</ci><interval closure="closed" id="S4.SS1.p5.2.m2.2.2.2.3.cmml" xref="S4.SS1.p5.2.m2.2.2.2.2"><apply id="S4.SS1.p5.2.m2.2.2.2.2.1.cmml" xref="S4.SS1.p5.2.m2.2.2.2.2.1"><times id="S4.SS1.p5.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS1.p5.2.m2.2.2.2.2.1.1"></times><ci id="S4.SS1.p5.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS1.p5.2.m2.2.2.2.2.1.2">𝐻</ci><ci id="S4.SS1.p5.2.m2.2.2.2.2.1.3.cmml" xref="S4.SS1.p5.2.m2.2.2.2.2.1.3">𝑊</ci></apply><ci id="S4.SS1.p5.2.m2.1.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1.1.1">𝐶</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.2c">f_{M}\in\mathbb{R}^{[H\times W,C]}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.2d">italic_f start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT [ italic_H × italic_W , italic_C ] end_POSTSUPERSCRIPT</annotation></semantics></math> and output tokens <math alttext="t_{O}\in\mathbb{R}^{[4,C]}" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.2"><semantics id="S4.SS1.p5.3.m3.2a"><mrow id="S4.SS1.p5.3.m3.2.3" xref="S4.SS1.p5.3.m3.2.3.cmml"><msub id="S4.SS1.p5.3.m3.2.3.2" xref="S4.SS1.p5.3.m3.2.3.2.cmml"><mi id="S4.SS1.p5.3.m3.2.3.2.2" xref="S4.SS1.p5.3.m3.2.3.2.2.cmml">t</mi><mi id="S4.SS1.p5.3.m3.2.3.2.3" xref="S4.SS1.p5.3.m3.2.3.2.3.cmml">O</mi></msub><mo id="S4.SS1.p5.3.m3.2.3.1" xref="S4.SS1.p5.3.m3.2.3.1.cmml">∈</mo><msup id="S4.SS1.p5.3.m3.2.3.3" xref="S4.SS1.p5.3.m3.2.3.3.cmml"><mi id="S4.SS1.p5.3.m3.2.3.3.2" xref="S4.SS1.p5.3.m3.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p5.3.m3.2.2.2.4" xref="S4.SS1.p5.3.m3.2.2.2.3.cmml"><mo id="S4.SS1.p5.3.m3.2.2.2.4.1" stretchy="false" xref="S4.SS1.p5.3.m3.2.2.2.3.cmml">[</mo><mn id="S4.SS1.p5.3.m3.1.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.1.cmml">4</mn><mo id="S4.SS1.p5.3.m3.2.2.2.4.2" xref="S4.SS1.p5.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.3.m3.2.2.2.2" xref="S4.SS1.p5.3.m3.2.2.2.2.cmml">C</mi><mo id="S4.SS1.p5.3.m3.2.2.2.4.3" stretchy="false" xref="S4.SS1.p5.3.m3.2.2.2.3.cmml">]</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.2b"><apply id="S4.SS1.p5.3.m3.2.3.cmml" xref="S4.SS1.p5.3.m3.2.3"><in id="S4.SS1.p5.3.m3.2.3.1.cmml" xref="S4.SS1.p5.3.m3.2.3.1"></in><apply id="S4.SS1.p5.3.m3.2.3.2.cmml" xref="S4.SS1.p5.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.2.3.2.1.cmml" xref="S4.SS1.p5.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS1.p5.3.m3.2.3.2.2.cmml" xref="S4.SS1.p5.3.m3.2.3.2.2">𝑡</ci><ci id="S4.SS1.p5.3.m3.2.3.2.3.cmml" xref="S4.SS1.p5.3.m3.2.3.2.3">𝑂</ci></apply><apply id="S4.SS1.p5.3.m3.2.3.3.cmml" xref="S4.SS1.p5.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.2.3.3.1.cmml" xref="S4.SS1.p5.3.m3.2.3.3">superscript</csymbol><ci id="S4.SS1.p5.3.m3.2.3.3.2.cmml" xref="S4.SS1.p5.3.m3.2.3.3.2">ℝ</ci><interval closure="closed" id="S4.SS1.p5.3.m3.2.2.2.3.cmml" xref="S4.SS1.p5.3.m3.2.2.2.4"><cn id="S4.SS1.p5.3.m3.1.1.1.1.cmml" type="integer" xref="S4.SS1.p5.3.m3.1.1.1.1">4</cn><ci id="S4.SS1.p5.3.m3.2.2.2.2.cmml" xref="S4.SS1.p5.3.m3.2.2.2.2">𝐶</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.2c">t_{O}\in\mathbb{R}^{[4,C]}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.2d">italic_t start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT [ 4 , italic_C ] end_POSTSUPERSCRIPT</annotation></semantics></math>. For further details, refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS1" title="A.1 Details of the SAM Mask Decoder and Matting Adapter ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.5">Next, we compute the logits <math alttext="\hat{p}=t_{O}f_{M}\in\mathbb{R}^{[4,H\times W]}" class="ltx_Math" display="inline" id="S4.SS1.p6.1.m1.2"><semantics id="S4.SS1.p6.1.m1.2a"><mrow id="S4.SS1.p6.1.m1.2.3" xref="S4.SS1.p6.1.m1.2.3.cmml"><mover accent="true" id="S4.SS1.p6.1.m1.2.3.2" xref="S4.SS1.p6.1.m1.2.3.2.cmml"><mi id="S4.SS1.p6.1.m1.2.3.2.2" xref="S4.SS1.p6.1.m1.2.3.2.2.cmml">p</mi><mo id="S4.SS1.p6.1.m1.2.3.2.1" xref="S4.SS1.p6.1.m1.2.3.2.1.cmml">^</mo></mover><mo id="S4.SS1.p6.1.m1.2.3.3" xref="S4.SS1.p6.1.m1.2.3.3.cmml">=</mo><mrow id="S4.SS1.p6.1.m1.2.3.4" xref="S4.SS1.p6.1.m1.2.3.4.cmml"><msub id="S4.SS1.p6.1.m1.2.3.4.2" xref="S4.SS1.p6.1.m1.2.3.4.2.cmml"><mi id="S4.SS1.p6.1.m1.2.3.4.2.2" xref="S4.SS1.p6.1.m1.2.3.4.2.2.cmml">t</mi><mi id="S4.SS1.p6.1.m1.2.3.4.2.3" xref="S4.SS1.p6.1.m1.2.3.4.2.3.cmml">O</mi></msub><mo id="S4.SS1.p6.1.m1.2.3.4.1" xref="S4.SS1.p6.1.m1.2.3.4.1.cmml">⁢</mo><msub id="S4.SS1.p6.1.m1.2.3.4.3" xref="S4.SS1.p6.1.m1.2.3.4.3.cmml"><mi id="S4.SS1.p6.1.m1.2.3.4.3.2" xref="S4.SS1.p6.1.m1.2.3.4.3.2.cmml">f</mi><mi id="S4.SS1.p6.1.m1.2.3.4.3.3" xref="S4.SS1.p6.1.m1.2.3.4.3.3.cmml">M</mi></msub></mrow><mo id="S4.SS1.p6.1.m1.2.3.5" xref="S4.SS1.p6.1.m1.2.3.5.cmml">∈</mo><msup id="S4.SS1.p6.1.m1.2.3.6" xref="S4.SS1.p6.1.m1.2.3.6.cmml"><mi id="S4.SS1.p6.1.m1.2.3.6.2" xref="S4.SS1.p6.1.m1.2.3.6.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.1.m1.2.2.2.2" xref="S4.SS1.p6.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.p6.1.m1.2.2.2.2.2" stretchy="false" xref="S4.SS1.p6.1.m1.2.2.2.3.cmml">[</mo><mn id="S4.SS1.p6.1.m1.1.1.1.1" xref="S4.SS1.p6.1.m1.1.1.1.1.cmml">4</mn><mo id="S4.SS1.p6.1.m1.2.2.2.2.3" xref="S4.SS1.p6.1.m1.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p6.1.m1.2.2.2.2.1" xref="S4.SS1.p6.1.m1.2.2.2.2.1.cmml"><mi id="S4.SS1.p6.1.m1.2.2.2.2.1.2" xref="S4.SS1.p6.1.m1.2.2.2.2.1.2.cmml">H</mi><mo id="S4.SS1.p6.1.m1.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p6.1.m1.2.2.2.2.1.1.cmml">×</mo><mi id="S4.SS1.p6.1.m1.2.2.2.2.1.3" xref="S4.SS1.p6.1.m1.2.2.2.2.1.3.cmml">W</mi></mrow><mo id="S4.SS1.p6.1.m1.2.2.2.2.4" stretchy="false" xref="S4.SS1.p6.1.m1.2.2.2.3.cmml">]</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.2b"><apply id="S4.SS1.p6.1.m1.2.3.cmml" xref="S4.SS1.p6.1.m1.2.3"><and id="S4.SS1.p6.1.m1.2.3a.cmml" xref="S4.SS1.p6.1.m1.2.3"></and><apply id="S4.SS1.p6.1.m1.2.3b.cmml" xref="S4.SS1.p6.1.m1.2.3"><eq id="S4.SS1.p6.1.m1.2.3.3.cmml" xref="S4.SS1.p6.1.m1.2.3.3"></eq><apply id="S4.SS1.p6.1.m1.2.3.2.cmml" xref="S4.SS1.p6.1.m1.2.3.2"><ci id="S4.SS1.p6.1.m1.2.3.2.1.cmml" xref="S4.SS1.p6.1.m1.2.3.2.1">^</ci><ci id="S4.SS1.p6.1.m1.2.3.2.2.cmml" xref="S4.SS1.p6.1.m1.2.3.2.2">𝑝</ci></apply><apply id="S4.SS1.p6.1.m1.2.3.4.cmml" xref="S4.SS1.p6.1.m1.2.3.4"><times id="S4.SS1.p6.1.m1.2.3.4.1.cmml" xref="S4.SS1.p6.1.m1.2.3.4.1"></times><apply id="S4.SS1.p6.1.m1.2.3.4.2.cmml" xref="S4.SS1.p6.1.m1.2.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.2.3.4.2.1.cmml" xref="S4.SS1.p6.1.m1.2.3.4.2">subscript</csymbol><ci id="S4.SS1.p6.1.m1.2.3.4.2.2.cmml" xref="S4.SS1.p6.1.m1.2.3.4.2.2">𝑡</ci><ci id="S4.SS1.p6.1.m1.2.3.4.2.3.cmml" xref="S4.SS1.p6.1.m1.2.3.4.2.3">𝑂</ci></apply><apply id="S4.SS1.p6.1.m1.2.3.4.3.cmml" xref="S4.SS1.p6.1.m1.2.3.4.3"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.2.3.4.3.1.cmml" xref="S4.SS1.p6.1.m1.2.3.4.3">subscript</csymbol><ci id="S4.SS1.p6.1.m1.2.3.4.3.2.cmml" xref="S4.SS1.p6.1.m1.2.3.4.3.2">𝑓</ci><ci id="S4.SS1.p6.1.m1.2.3.4.3.3.cmml" xref="S4.SS1.p6.1.m1.2.3.4.3.3">𝑀</ci></apply></apply></apply><apply id="S4.SS1.p6.1.m1.2.3c.cmml" xref="S4.SS1.p6.1.m1.2.3"><in id="S4.SS1.p6.1.m1.2.3.5.cmml" xref="S4.SS1.p6.1.m1.2.3.5"></in><share href="https://arxiv.org/html/2410.06593v1#S4.SS1.p6.1.m1.2.3.4.cmml" id="S4.SS1.p6.1.m1.2.3d.cmml" xref="S4.SS1.p6.1.m1.2.3"></share><apply id="S4.SS1.p6.1.m1.2.3.6.cmml" xref="S4.SS1.p6.1.m1.2.3.6"><csymbol cd="ambiguous" id="S4.SS1.p6.1.m1.2.3.6.1.cmml" xref="S4.SS1.p6.1.m1.2.3.6">superscript</csymbol><ci id="S4.SS1.p6.1.m1.2.3.6.2.cmml" xref="S4.SS1.p6.1.m1.2.3.6.2">ℝ</ci><interval closure="closed" id="S4.SS1.p6.1.m1.2.2.2.3.cmml" xref="S4.SS1.p6.1.m1.2.2.2.2"><cn id="S4.SS1.p6.1.m1.1.1.1.1.cmml" type="integer" xref="S4.SS1.p6.1.m1.1.1.1.1">4</cn><apply id="S4.SS1.p6.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.p6.1.m1.2.2.2.2.1"><times id="S4.SS1.p6.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS1.p6.1.m1.2.2.2.2.1.1"></times><ci id="S4.SS1.p6.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.p6.1.m1.2.2.2.2.1.2">𝐻</ci><ci id="S4.SS1.p6.1.m1.2.2.2.2.1.3.cmml" xref="S4.SS1.p6.1.m1.2.2.2.2.1.3">𝑊</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.2c">\hat{p}=t_{O}f_{M}\in\mathbb{R}^{[4,H\times W]}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.1.m1.2d">over^ start_ARG italic_p end_ARG = italic_t start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT [ 4 , italic_H × italic_W ] end_POSTSUPERSCRIPT</annotation></semantics></math>, and split it into two parts, i.e., SAM logits <math alttext="\hat{p}^{\text{SAM}}\in\mathbb{R}^{[1,H,W]}" class="ltx_Math" display="inline" id="S4.SS1.p6.2.m2.3"><semantics id="S4.SS1.p6.2.m2.3a"><mrow id="S4.SS1.p6.2.m2.3.4" xref="S4.SS1.p6.2.m2.3.4.cmml"><msup id="S4.SS1.p6.2.m2.3.4.2" xref="S4.SS1.p6.2.m2.3.4.2.cmml"><mover accent="true" id="S4.SS1.p6.2.m2.3.4.2.2" xref="S4.SS1.p6.2.m2.3.4.2.2.cmml"><mi id="S4.SS1.p6.2.m2.3.4.2.2.2" xref="S4.SS1.p6.2.m2.3.4.2.2.2.cmml">p</mi><mo id="S4.SS1.p6.2.m2.3.4.2.2.1" xref="S4.SS1.p6.2.m2.3.4.2.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p6.2.m2.3.4.2.3" xref="S4.SS1.p6.2.m2.3.4.2.3a.cmml">SAM</mtext></msup><mo id="S4.SS1.p6.2.m2.3.4.1" xref="S4.SS1.p6.2.m2.3.4.1.cmml">∈</mo><msup id="S4.SS1.p6.2.m2.3.4.3" xref="S4.SS1.p6.2.m2.3.4.3.cmml"><mi id="S4.SS1.p6.2.m2.3.4.3.2" xref="S4.SS1.p6.2.m2.3.4.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.2.m2.3.3.3.5" xref="S4.SS1.p6.2.m2.3.3.3.4.cmml"><mo id="S4.SS1.p6.2.m2.3.3.3.5.1" stretchy="false" xref="S4.SS1.p6.2.m2.3.3.3.4.cmml">[</mo><mn id="S4.SS1.p6.2.m2.1.1.1.1" xref="S4.SS1.p6.2.m2.1.1.1.1.cmml">1</mn><mo id="S4.SS1.p6.2.m2.3.3.3.5.2" xref="S4.SS1.p6.2.m2.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p6.2.m2.2.2.2.2" xref="S4.SS1.p6.2.m2.2.2.2.2.cmml">H</mi><mo id="S4.SS1.p6.2.m2.3.3.3.5.3" xref="S4.SS1.p6.2.m2.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p6.2.m2.3.3.3.3" xref="S4.SS1.p6.2.m2.3.3.3.3.cmml">W</mi><mo id="S4.SS1.p6.2.m2.3.3.3.5.4" stretchy="false" xref="S4.SS1.p6.2.m2.3.3.3.4.cmml">]</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.3b"><apply id="S4.SS1.p6.2.m2.3.4.cmml" xref="S4.SS1.p6.2.m2.3.4"><in id="S4.SS1.p6.2.m2.3.4.1.cmml" xref="S4.SS1.p6.2.m2.3.4.1"></in><apply id="S4.SS1.p6.2.m2.3.4.2.cmml" xref="S4.SS1.p6.2.m2.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.3.4.2.1.cmml" xref="S4.SS1.p6.2.m2.3.4.2">superscript</csymbol><apply id="S4.SS1.p6.2.m2.3.4.2.2.cmml" xref="S4.SS1.p6.2.m2.3.4.2.2"><ci id="S4.SS1.p6.2.m2.3.4.2.2.1.cmml" xref="S4.SS1.p6.2.m2.3.4.2.2.1">^</ci><ci id="S4.SS1.p6.2.m2.3.4.2.2.2.cmml" xref="S4.SS1.p6.2.m2.3.4.2.2.2">𝑝</ci></apply><ci id="S4.SS1.p6.2.m2.3.4.2.3a.cmml" xref="S4.SS1.p6.2.m2.3.4.2.3"><mtext id="S4.SS1.p6.2.m2.3.4.2.3.cmml" mathsize="70%" xref="S4.SS1.p6.2.m2.3.4.2.3">SAM</mtext></ci></apply><apply id="S4.SS1.p6.2.m2.3.4.3.cmml" xref="S4.SS1.p6.2.m2.3.4.3"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.3.4.3.1.cmml" xref="S4.SS1.p6.2.m2.3.4.3">superscript</csymbol><ci id="S4.SS1.p6.2.m2.3.4.3.2.cmml" xref="S4.SS1.p6.2.m2.3.4.3.2">ℝ</ci><list id="S4.SS1.p6.2.m2.3.3.3.4.cmml" xref="S4.SS1.p6.2.m2.3.3.3.5"><cn id="S4.SS1.p6.2.m2.1.1.1.1.cmml" type="integer" xref="S4.SS1.p6.2.m2.1.1.1.1">1</cn><ci id="S4.SS1.p6.2.m2.2.2.2.2.cmml" xref="S4.SS1.p6.2.m2.2.2.2.2">𝐻</ci><ci id="S4.SS1.p6.2.m2.3.3.3.3.cmml" xref="S4.SS1.p6.2.m2.3.3.3.3">𝑊</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.3c">\hat{p}^{\text{SAM}}\in\mathbb{R}^{[1,H,W]}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.2.m2.3d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT [ 1 , italic_H , italic_W ] end_POSTSUPERSCRIPT</annotation></semantics></math> and
matting logits <math alttext="\hat{p}^{\text{Mat}}\in\mathbb{R}^{[3,H,W]}" class="ltx_Math" display="inline" id="S4.SS1.p6.3.m3.3"><semantics id="S4.SS1.p6.3.m3.3a"><mrow id="S4.SS1.p6.3.m3.3.4" xref="S4.SS1.p6.3.m3.3.4.cmml"><msup id="S4.SS1.p6.3.m3.3.4.2" xref="S4.SS1.p6.3.m3.3.4.2.cmml"><mover accent="true" id="S4.SS1.p6.3.m3.3.4.2.2" xref="S4.SS1.p6.3.m3.3.4.2.2.cmml"><mi id="S4.SS1.p6.3.m3.3.4.2.2.2" xref="S4.SS1.p6.3.m3.3.4.2.2.2.cmml">p</mi><mo id="S4.SS1.p6.3.m3.3.4.2.2.1" xref="S4.SS1.p6.3.m3.3.4.2.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p6.3.m3.3.4.2.3" xref="S4.SS1.p6.3.m3.3.4.2.3a.cmml">Mat</mtext></msup><mo id="S4.SS1.p6.3.m3.3.4.1" xref="S4.SS1.p6.3.m3.3.4.1.cmml">∈</mo><msup id="S4.SS1.p6.3.m3.3.4.3" xref="S4.SS1.p6.3.m3.3.4.3.cmml"><mi id="S4.SS1.p6.3.m3.3.4.3.2" xref="S4.SS1.p6.3.m3.3.4.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p6.3.m3.3.3.3.5" xref="S4.SS1.p6.3.m3.3.3.3.4.cmml"><mo id="S4.SS1.p6.3.m3.3.3.3.5.1" stretchy="false" xref="S4.SS1.p6.3.m3.3.3.3.4.cmml">[</mo><mn id="S4.SS1.p6.3.m3.1.1.1.1" xref="S4.SS1.p6.3.m3.1.1.1.1.cmml">3</mn><mo id="S4.SS1.p6.3.m3.3.3.3.5.2" xref="S4.SS1.p6.3.m3.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p6.3.m3.2.2.2.2" xref="S4.SS1.p6.3.m3.2.2.2.2.cmml">H</mi><mo id="S4.SS1.p6.3.m3.3.3.3.5.3" xref="S4.SS1.p6.3.m3.3.3.3.4.cmml">,</mo><mi id="S4.SS1.p6.3.m3.3.3.3.3" xref="S4.SS1.p6.3.m3.3.3.3.3.cmml">W</mi><mo id="S4.SS1.p6.3.m3.3.3.3.5.4" stretchy="false" xref="S4.SS1.p6.3.m3.3.3.3.4.cmml">]</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.3b"><apply id="S4.SS1.p6.3.m3.3.4.cmml" xref="S4.SS1.p6.3.m3.3.4"><in id="S4.SS1.p6.3.m3.3.4.1.cmml" xref="S4.SS1.p6.3.m3.3.4.1"></in><apply id="S4.SS1.p6.3.m3.3.4.2.cmml" xref="S4.SS1.p6.3.m3.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.3.4.2.1.cmml" xref="S4.SS1.p6.3.m3.3.4.2">superscript</csymbol><apply id="S4.SS1.p6.3.m3.3.4.2.2.cmml" xref="S4.SS1.p6.3.m3.3.4.2.2"><ci id="S4.SS1.p6.3.m3.3.4.2.2.1.cmml" xref="S4.SS1.p6.3.m3.3.4.2.2.1">^</ci><ci id="S4.SS1.p6.3.m3.3.4.2.2.2.cmml" xref="S4.SS1.p6.3.m3.3.4.2.2.2">𝑝</ci></apply><ci id="S4.SS1.p6.3.m3.3.4.2.3a.cmml" xref="S4.SS1.p6.3.m3.3.4.2.3"><mtext id="S4.SS1.p6.3.m3.3.4.2.3.cmml" mathsize="70%" xref="S4.SS1.p6.3.m3.3.4.2.3">Mat</mtext></ci></apply><apply id="S4.SS1.p6.3.m3.3.4.3.cmml" xref="S4.SS1.p6.3.m3.3.4.3"><csymbol cd="ambiguous" id="S4.SS1.p6.3.m3.3.4.3.1.cmml" xref="S4.SS1.p6.3.m3.3.4.3">superscript</csymbol><ci id="S4.SS1.p6.3.m3.3.4.3.2.cmml" xref="S4.SS1.p6.3.m3.3.4.3.2">ℝ</ci><list id="S4.SS1.p6.3.m3.3.3.3.4.cmml" xref="S4.SS1.p6.3.m3.3.3.3.5"><cn id="S4.SS1.p6.3.m3.1.1.1.1.cmml" type="integer" xref="S4.SS1.p6.3.m3.1.1.1.1">3</cn><ci id="S4.SS1.p6.3.m3.2.2.2.2.cmml" xref="S4.SS1.p6.3.m3.2.2.2.2">𝐻</ci><ci id="S4.SS1.p6.3.m3.3.3.3.3.cmml" xref="S4.SS1.p6.3.m3.3.3.3.3">𝑊</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.3c">\hat{p}^{\text{Mat}}\in\mathbb{R}^{[3,H,W]}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.3.m3.3d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT [ 3 , italic_H , italic_W ] end_POSTSUPERSCRIPT</annotation></semantics></math>. Among them, <math alttext="\hat{p}^{\text{SAM}}" class="ltx_Math" display="inline" id="S4.SS1.p6.4.m4.1"><semantics id="S4.SS1.p6.4.m4.1a"><msup id="S4.SS1.p6.4.m4.1.1" xref="S4.SS1.p6.4.m4.1.1.cmml"><mover accent="true" id="S4.SS1.p6.4.m4.1.1.2" xref="S4.SS1.p6.4.m4.1.1.2.cmml"><mi id="S4.SS1.p6.4.m4.1.1.2.2" xref="S4.SS1.p6.4.m4.1.1.2.2.cmml">p</mi><mo id="S4.SS1.p6.4.m4.1.1.2.1" xref="S4.SS1.p6.4.m4.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p6.4.m4.1.1.3" xref="S4.SS1.p6.4.m4.1.1.3a.cmml">SAM</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m4.1b"><apply id="S4.SS1.p6.4.m4.1.1.cmml" xref="S4.SS1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.4.m4.1.1.1.cmml" xref="S4.SS1.p6.4.m4.1.1">superscript</csymbol><apply id="S4.SS1.p6.4.m4.1.1.2.cmml" xref="S4.SS1.p6.4.m4.1.1.2"><ci id="S4.SS1.p6.4.m4.1.1.2.1.cmml" xref="S4.SS1.p6.4.m4.1.1.2.1">^</ci><ci id="S4.SS1.p6.4.m4.1.1.2.2.cmml" xref="S4.SS1.p6.4.m4.1.1.2.2">𝑝</ci></apply><ci id="S4.SS1.p6.4.m4.1.1.3a.cmml" xref="S4.SS1.p6.4.m4.1.1.3"><mtext id="S4.SS1.p6.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p6.4.m4.1.1.3">SAM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.4.m4.1c">\hat{p}^{\text{SAM}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.4.m4.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the original SAM mask prediction, crucial for constructing the regularization loss outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.SS2" title="4.2 SEMat Training Objective ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">4.2</span></a>, while <math alttext="\hat{p}^{\text{Mat}}" class="ltx_Math" display="inline" id="S4.SS1.p6.5.m5.1"><semantics id="S4.SS1.p6.5.m5.1a"><msup id="S4.SS1.p6.5.m5.1.1" xref="S4.SS1.p6.5.m5.1.1.cmml"><mover accent="true" id="S4.SS1.p6.5.m5.1.1.2" xref="S4.SS1.p6.5.m5.1.1.2.cmml"><mi id="S4.SS1.p6.5.m5.1.1.2.2" xref="S4.SS1.p6.5.m5.1.1.2.2.cmml">p</mi><mo id="S4.SS1.p6.5.m5.1.1.2.1" xref="S4.SS1.p6.5.m5.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p6.5.m5.1.1.3" xref="S4.SS1.p6.5.m5.1.1.3a.cmml">Mat</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m5.1b"><apply id="S4.SS1.p6.5.m5.1.1.cmml" xref="S4.SS1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.5.m5.1.1.1.cmml" xref="S4.SS1.p6.5.m5.1.1">superscript</csymbol><apply id="S4.SS1.p6.5.m5.1.1.2.cmml" xref="S4.SS1.p6.5.m5.1.1.2"><ci id="S4.SS1.p6.5.m5.1.1.2.1.cmml" xref="S4.SS1.p6.5.m5.1.1.2.1">^</ci><ci id="S4.SS1.p6.5.m5.1.1.2.2.cmml" xref="S4.SS1.p6.5.m5.1.1.2.2">𝑝</ci></apply><ci id="S4.SS1.p6.5.m5.1.1.3a.cmml" xref="S4.SS1.p6.5.m5.1.1.3"><mtext id="S4.SS1.p6.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p6.5.m5.1.1.3">Mat</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.5.m5.1c">\hat{p}^{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.5.m5.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT</annotation></semantics></math> represents three-channel course-grained matting mask prediction, and will be adopted to generate the trimap enriched with enhanced semantic knowledge and constructs the trimap loss in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.SS2" title="4.2 SEMat Training Objective ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.1">During training, our learnable matting tokens and matting adapter are meticulously fine-tuned to discern matting-specific objects, ensuring accurate segmentation and mask generation that align with matting requirements. Unlike HQ-SAM <cite class="ltx_cite ltx_citemacro_citep">(Ke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib9" title="">2024</a>)</cite>, which derives binary masks from a single HQ-token, we employ multiple matting tokens to generate a trimap that meticulously distinguishes between foreground, background, and unknown regions of an object. Additionally, <math alttext="\hat{p}^{\text{SAM}}" class="ltx_Math" display="inline" id="S4.SS1.p7.1.m1.1"><semantics id="S4.SS1.p7.1.m1.1a"><msup id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p7.1.m1.1.1.2" xref="S4.SS1.p7.1.m1.1.1.2.cmml"><mi id="S4.SS1.p7.1.m1.1.1.2.2" xref="S4.SS1.p7.1.m1.1.1.2.2.cmml">p</mi><mo id="S4.SS1.p7.1.m1.1.1.2.1" xref="S4.SS1.p7.1.m1.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p7.1.m1.1.1.3" xref="S4.SS1.p7.1.m1.1.1.3a.cmml">SAM</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.1b"><apply id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2"><ci id="S4.SS1.p7.1.m1.1.1.2.1.cmml" xref="S4.SS1.p7.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.p7.1.m1.1.1.2.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2.2">𝑝</ci></apply><ci id="S4.SS1.p7.1.m1.1.1.3a.cmml" xref="S4.SS1.p7.1.m1.1.1.3"><mtext id="S4.SS1.p7.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p7.1.m1.1.1.3">SAM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.1c">\hat{p}^{\text{SAM}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.1.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT</annotation></semantics></math> is preserved throughout the training process to maintain the pre-trained SAM’s inherent priors.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p8">
<p class="ltx_p" id="S4.SS1.p8.1">However, due to memory constraints, SAM extracts features at a reduced resolution and generates logits downsampled by a factor of 4, leading to a loss of fine details. To address this, we propose a lightweight matting decoder that stacks residual blocks <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib5" title="">2016</a>)</cite> in a UNet architecture <cite class="ltx_cite ltx_citemacro_citep">(Ronneberger et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib27" title="">2015</a>)</cite>. The central concept is that the network takes the concatenation of the image and upsampled matting logits <math alttext="\text{Upsample}(\hat{p}^{\text{Mat}})" class="ltx_Math" display="inline" id="S4.SS1.p8.1.m1.1"><semantics id="S4.SS1.p8.1.m1.1a"><mrow id="S4.SS1.p8.1.m1.1.1" xref="S4.SS1.p8.1.m1.1.1.cmml"><mtext id="S4.SS1.p8.1.m1.1.1.3" xref="S4.SS1.p8.1.m1.1.1.3a.cmml">Upsample</mtext><mo id="S4.SS1.p8.1.m1.1.1.2" xref="S4.SS1.p8.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p8.1.m1.1.1.1.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS1.p8.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.p8.1.m1.1.1.1.1.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p8.1.m1.1.1.1.1.1.2" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p8.1.m1.1.1.1.1.1.2.2" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.2.cmml">p</mi><mo id="S4.SS1.p8.1.m1.1.1.1.1.1.2.1" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS1.p8.1.m1.1.1.1.1.1.3" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3a.cmml">Mat</mtext></msup><mo id="S4.SS1.p8.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.1b"><apply id="S4.SS1.p8.1.m1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1"><times id="S4.SS1.p8.1.m1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.1.1.2"></times><ci id="S4.SS1.p8.1.m1.1.1.3a.cmml" xref="S4.SS1.p8.1.m1.1.1.3"><mtext id="S4.SS1.p8.1.m1.1.1.3.cmml" xref="S4.SS1.p8.1.m1.1.1.3">Upsample</mtext></ci><apply id="S4.SS1.p8.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p8.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2"><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.1">^</ci><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.2.2">𝑝</ci></apply><ci id="S4.SS1.p8.1.m1.1.1.1.1.1.3a.cmml" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3"><mtext id="S4.SS1.p8.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p8.1.m1.1.1.1.1.1.3">Mat</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.1c">\text{Upsample}(\hat{p}^{\text{Mat}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.1.m1.1d">Upsample ( over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT )</annotation></semantics></math> as input. The U-shaped structure, augmented with skip connections, effectively retains high-resolution image details, allowing the decoder to recover fine-grained details within the matting logits and produce high-precision alpha mattes. More details of the matting decoder and trainable parameters in SEMat are presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS2" title="A.2 Details of the Matting Decoder ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS3" title="A.3 Trainable Parameters ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>SEMat Training Objective</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Existing interactive matting <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite> is trained by the end-to-end matting loss. We argue that utilizing only matting loss may corrupt the prior of the pre-trained model and produce erroneous foreground segmentation. Therefore, we propose a regularization loss to ensure the consistency of predictions between the frozen and learnable networks. In addition, to enhance the semantic guidance during mask generation, we propose a trimap prediction loss which encourages the matting logits extracted from the mask decoder to contain trimap-based semantic information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.3.1">Regularization Loss.</span>
Despite the introduction of real-world COCO-Matting data enhancing the semantic comprehension, synthetic training data inevitably undermine the robust feature representations of the pre-trained SAM. Driven by this insight, we introduce a novel regularization loss designed to maintain the original priors during training.
Specifically, We integrate an additional frozen SAM that processes an image alongside the BBox prompt to yield SAM logits <math alttext="p^{\text{SAM}}\in[0,1]" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.2"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.3" xref="S4.SS2.p2.1.m1.2.3.cmml"><msup id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.2.cmml"><mi id="S4.SS2.p2.1.m1.2.3.2.2" xref="S4.SS2.p2.1.m1.2.3.2.2.cmml">p</mi><mtext id="S4.SS2.p2.1.m1.2.3.2.3" xref="S4.SS2.p2.1.m1.2.3.2.3a.cmml">SAM</mtext></msup><mo id="S4.SS2.p2.1.m1.2.3.1" xref="S4.SS2.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p2.1.m1.2.3.3.2" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml"><mo id="S4.SS2.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">0</mn><mo id="S4.SS2.p2.1.m1.2.3.3.2.2" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">1</mn><mo id="S4.SS2.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS2.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><apply id="S4.SS2.p2.1.m1.2.3.cmml" xref="S4.SS2.p2.1.m1.2.3"><in id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.1"></in><apply id="S4.SS2.p2.1.m1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.3.2.1.cmml" xref="S4.SS2.p2.1.m1.2.3.2">superscript</csymbol><ci id="S4.SS2.p2.1.m1.2.3.2.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2.2">𝑝</ci><ci id="S4.SS2.p2.1.m1.2.3.2.3a.cmml" xref="S4.SS2.p2.1.m1.2.3.2.3"><mtext id="S4.SS2.p2.1.m1.2.3.2.3.cmml" mathsize="70%" xref="S4.SS2.p2.1.m1.2.3.2.3">SAM</mtext></ci></apply><interval closure="closed" id="S4.SS2.p2.1.m1.2.3.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.3.2"><cn id="S4.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1">0</cn><cn id="S4.SS2.p2.1.m1.2.2.cmml" type="integer" xref="S4.SS2.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">p^{\text{SAM}}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.2d">italic_p start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math>. Then, we generate the label <math alttext="y_{i,j}^{\text{SAM}}=\bm{1}_{p^{\text{SAM}}&gt;0.5}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.2"><semantics id="S4.SS2.p2.2.m2.2a"><mrow id="S4.SS2.p2.2.m2.2.3" xref="S4.SS2.p2.2.m2.2.3.cmml"><msubsup id="S4.SS2.p2.2.m2.2.3.2" xref="S4.SS2.p2.2.m2.2.3.2.cmml"><mi id="S4.SS2.p2.2.m2.2.3.2.2.2" xref="S4.SS2.p2.2.m2.2.3.2.2.2.cmml">y</mi><mrow id="S4.SS2.p2.2.m2.2.2.2.4" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p2.2.m2.2.2.2.4.1" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.2.m2.2.2.2.2" xref="S4.SS2.p2.2.m2.2.2.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p2.2.m2.2.3.2.3" xref="S4.SS2.p2.2.m2.2.3.2.3a.cmml">SAM</mtext></msubsup><mo id="S4.SS2.p2.2.m2.2.3.1" xref="S4.SS2.p2.2.m2.2.3.1.cmml">=</mo><msub id="S4.SS2.p2.2.m2.2.3.3" xref="S4.SS2.p2.2.m2.2.3.3.cmml"><mn id="S4.SS2.p2.2.m2.2.3.3.2" xref="S4.SS2.p2.2.m2.2.3.3.2.cmml">𝟏</mn><mrow id="S4.SS2.p2.2.m2.2.3.3.3" xref="S4.SS2.p2.2.m2.2.3.3.3.cmml"><msup id="S4.SS2.p2.2.m2.2.3.3.3.2" xref="S4.SS2.p2.2.m2.2.3.3.3.2.cmml"><mi id="S4.SS2.p2.2.m2.2.3.3.3.2.2" xref="S4.SS2.p2.2.m2.2.3.3.3.2.2.cmml">p</mi><mtext id="S4.SS2.p2.2.m2.2.3.3.3.2.3" xref="S4.SS2.p2.2.m2.2.3.3.3.2.3a.cmml">SAM</mtext></msup><mo id="S4.SS2.p2.2.m2.2.3.3.3.1" xref="S4.SS2.p2.2.m2.2.3.3.3.1.cmml">&gt;</mo><mn id="S4.SS2.p2.2.m2.2.3.3.3.3" xref="S4.SS2.p2.2.m2.2.3.3.3.3.cmml">0.5</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><apply id="S4.SS2.p2.2.m2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.3"><eq id="S4.SS2.p2.2.m2.2.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.1"></eq><apply id="S4.SS2.p2.2.m2.2.3.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.2.1.cmml" xref="S4.SS2.p2.2.m2.2.3.2">superscript</csymbol><apply id="S4.SS2.p2.2.m2.2.3.2.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.2.2.1.cmml" xref="S4.SS2.p2.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.3.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2.2.2">𝑦</ci><list id="S4.SS2.p2.2.m2.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.4"><ci id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p2.2.m2.2.3.2.3a.cmml" xref="S4.SS2.p2.2.m2.2.3.2.3"><mtext id="S4.SS2.p2.2.m2.2.3.2.3.cmml" mathsize="70%" xref="S4.SS2.p2.2.m2.2.3.2.3">SAM</mtext></ci></apply><apply id="S4.SS2.p2.2.m2.2.3.3.cmml" xref="S4.SS2.p2.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.3">subscript</csymbol><cn id="S4.SS2.p2.2.m2.2.3.3.2.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.3.3.2">1</cn><apply id="S4.SS2.p2.2.m2.2.3.3.3.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3"><gt id="S4.SS2.p2.2.m2.2.3.3.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3.1"></gt><apply id="S4.SS2.p2.2.m2.2.3.3.3.2.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.3.3.2.1.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3.2">superscript</csymbol><ci id="S4.SS2.p2.2.m2.2.3.3.3.2.2.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3.2.2">𝑝</ci><ci id="S4.SS2.p2.2.m2.2.3.3.3.2.3a.cmml" xref="S4.SS2.p2.2.m2.2.3.3.3.2.3"><mtext id="S4.SS2.p2.2.m2.2.3.3.3.2.3.cmml" mathsize="50%" xref="S4.SS2.p2.2.m2.2.3.3.3.2.3">SAM</mtext></ci></apply><cn id="S4.SS2.p2.2.m2.2.3.3.3.3.cmml" type="float" xref="S4.SS2.p2.2.m2.2.3.3.3.3">0.5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">y_{i,j}^{\text{SAM}}=\bm{1}_{p^{\text{SAM}}&gt;0.5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.2d">italic_y start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT = bold_1 start_POSTSUBSCRIPT italic_p start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT &gt; 0.5 end_POSTSUBSCRIPT</annotation></semantics></math> to supervise the predicted SAM logits <math alttext="\hat{p}^{\text{SAM}}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">p</mi><mo id="S4.SS2.p2.3.m3.1.1.2.1" xref="S4.SS2.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3a.cmml">SAM</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><ci id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝑝</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.3a.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><mtext id="S4.SS2.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p2.3.m3.1.1.3">SAM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\hat{p}^{\text{SAM}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{Reg}}=-\sum\nolimits_{i,j}y_{i,j}^{\text{SAM}}\log(\hat{p}_%
{i,j}^{\text{SAM}})+(1-y_{i,j}^{\text{SAM}})\log(1-\hat{p}_{i,j}^{\text{SAM}})." class="ltx_Math" display="block" id="S4.Ex3.m1.13"><semantics id="S4.Ex3.m1.13a"><mrow id="S4.Ex3.m1.13.13.1" xref="S4.Ex3.m1.13.13.1.1.cmml"><mrow id="S4.Ex3.m1.13.13.1.1" xref="S4.Ex3.m1.13.13.1.1.cmml"><msub id="S4.Ex3.m1.13.13.1.1.5" xref="S4.Ex3.m1.13.13.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.13.13.1.1.5.2" xref="S4.Ex3.m1.13.13.1.1.5.2.cmml">ℒ</mi><mtext id="S4.Ex3.m1.13.13.1.1.5.3" xref="S4.Ex3.m1.13.13.1.1.5.3a.cmml">Reg</mtext></msub><mo id="S4.Ex3.m1.13.13.1.1.4" xref="S4.Ex3.m1.13.13.1.1.4.cmml">=</mo><mrow id="S4.Ex3.m1.13.13.1.1.3" xref="S4.Ex3.m1.13.13.1.1.3.cmml"><mrow id="S4.Ex3.m1.13.13.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.cmml"><mo id="S4.Ex3.m1.13.13.1.1.1.1a" xref="S4.Ex3.m1.13.13.1.1.1.1.cmml">−</mo><mrow id="S4.Ex3.m1.13.13.1.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.cmml"><msub id="S4.Ex3.m1.13.13.1.1.1.1.1.2" xref="S4.Ex3.m1.13.13.1.1.1.1.1.2.cmml"><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.2.2" xref="S4.Ex3.m1.13.13.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.Ex3.m1.2.2.2.4" xref="S4.Ex3.m1.2.2.2.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex3.m1.2.2.2.4.1" xref="S4.Ex3.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex3.m1.2.2.2.2" xref="S4.Ex3.m1.2.2.2.2.cmml">j</mi></mrow></msub><mrow id="S4.Ex3.m1.13.13.1.1.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.2" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.2.cmml">y</mi><mrow id="S4.Ex3.m1.4.4.2.4" xref="S4.Ex3.m1.4.4.2.3.cmml"><mi id="S4.Ex3.m1.3.3.1.1" xref="S4.Ex3.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex3.m1.4.4.2.4.1" xref="S4.Ex3.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex3.m1.4.4.2.2" xref="S4.Ex3.m1.4.4.2.2.cmml">j</mi></mrow><mtext id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3a.cmml">SAM</mtext></msubsup><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.1.2" lspace="0.167em" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex3.m1.11.11" xref="S4.Ex3.m1.11.11.cmml">log</mi><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1a" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.Ex3.m1.6.6.2.4" xref="S4.Ex3.m1.6.6.2.3.cmml"><mi id="S4.Ex3.m1.5.5.1.1" xref="S4.Ex3.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex3.m1.6.6.2.4.1" xref="S4.Ex3.m1.6.6.2.3.cmml">,</mo><mi id="S4.Ex3.m1.6.6.2.2" xref="S4.Ex3.m1.6.6.2.2.cmml">j</mi></mrow><mtext id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3a.cmml">SAM</mtext></msubsup><mo id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.Ex3.m1.13.13.1.1.3.4" xref="S4.Ex3.m1.13.13.1.1.3.4.cmml">+</mo><mrow id="S4.Ex3.m1.13.13.1.1.3.3" xref="S4.Ex3.m1.13.13.1.1.3.3.cmml"><mrow id="S4.Ex3.m1.13.13.1.1.2.2.1.1" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.cmml"><mo id="S4.Ex3.m1.13.13.1.1.2.2.1.1.2" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.cmml"><mn id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.2" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.1.cmml">−</mo><msubsup id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.cmml"><mi id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.2" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.2.cmml">y</mi><mrow id="S4.Ex3.m1.8.8.2.4" xref="S4.Ex3.m1.8.8.2.3.cmml"><mi id="S4.Ex3.m1.7.7.1.1" xref="S4.Ex3.m1.7.7.1.1.cmml">i</mi><mo id="S4.Ex3.m1.8.8.2.4.1" xref="S4.Ex3.m1.8.8.2.3.cmml">,</mo><mi id="S4.Ex3.m1.8.8.2.2" xref="S4.Ex3.m1.8.8.2.2.cmml">j</mi></mrow><mtext id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3a.cmml">SAM</mtext></msubsup></mrow><mo id="S4.Ex3.m1.13.13.1.1.2.2.1.1.3" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex3.m1.13.13.1.1.3.3.3" lspace="0.167em" xref="S4.Ex3.m1.13.13.1.1.3.3.3.cmml">⁢</mo><mrow id="S4.Ex3.m1.13.13.1.1.3.3.2.1" xref="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml"><mi id="S4.Ex3.m1.12.12" xref="S4.Ex3.m1.12.12.cmml">log</mi><mo id="S4.Ex3.m1.13.13.1.1.3.3.2.1a" xref="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1" xref="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml"><mo id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.2" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml">(</mo><mrow id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.cmml"><mn id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.2" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.1" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.1.cmml">−</mo><msubsup id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.cmml"><mi id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.2" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.2.cmml">p</mi><mo id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.1" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S4.Ex3.m1.10.10.2.4" xref="S4.Ex3.m1.10.10.2.3.cmml"><mi id="S4.Ex3.m1.9.9.1.1" xref="S4.Ex3.m1.9.9.1.1.cmml">i</mi><mo id="S4.Ex3.m1.10.10.2.4.1" xref="S4.Ex3.m1.10.10.2.3.cmml">,</mo><mi id="S4.Ex3.m1.10.10.2.2" xref="S4.Ex3.m1.10.10.2.2.cmml">j</mi></mrow><mtext id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3a.cmml">SAM</mtext></msubsup></mrow><mo id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.3" stretchy="false" xref="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.Ex3.m1.13.13.1.2" lspace="0em" xref="S4.Ex3.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.13b"><apply id="S4.Ex3.m1.13.13.1.1.cmml" xref="S4.Ex3.m1.13.13.1"><eq id="S4.Ex3.m1.13.13.1.1.4.cmml" xref="S4.Ex3.m1.13.13.1.1.4"></eq><apply id="S4.Ex3.m1.13.13.1.1.5.cmml" xref="S4.Ex3.m1.13.13.1.1.5"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.5.1.cmml" xref="S4.Ex3.m1.13.13.1.1.5">subscript</csymbol><ci id="S4.Ex3.m1.13.13.1.1.5.2.cmml" xref="S4.Ex3.m1.13.13.1.1.5.2">ℒ</ci><ci id="S4.Ex3.m1.13.13.1.1.5.3a.cmml" xref="S4.Ex3.m1.13.13.1.1.5.3"><mtext id="S4.Ex3.m1.13.13.1.1.5.3.cmml" mathsize="70%" xref="S4.Ex3.m1.13.13.1.1.5.3">Reg</mtext></ci></apply><apply id="S4.Ex3.m1.13.13.1.1.3.cmml" xref="S4.Ex3.m1.13.13.1.1.3"><plus id="S4.Ex3.m1.13.13.1.1.3.4.cmml" xref="S4.Ex3.m1.13.13.1.1.3.4"></plus><apply id="S4.Ex3.m1.13.13.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1"><minus id="S4.Ex3.m1.13.13.1.1.1.1.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1"></minus><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1"><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.2">subscript</csymbol><sum id="S4.Ex3.m1.13.13.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.2.2"></sum><list id="S4.Ex3.m1.2.2.2.3.cmml" xref="S4.Ex3.m1.2.2.2.4"><ci id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex3.m1.2.2.2.2.cmml" xref="S4.Ex3.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1"><times id="S4.Ex3.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.2"></times><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.2.2">𝑦</ci><list id="S4.Ex3.m1.4.4.2.3.cmml" xref="S4.Ex3.m1.4.4.2.4"><ci id="S4.Ex3.m1.3.3.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex3.m1.4.4.2.2.cmml" xref="S4.Ex3.m1.4.4.2.2">𝑗</ci></list></apply><ci id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3a.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3"><mtext id="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.3.3">SAM</mtext></ci></apply><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1"><log id="S4.Ex3.m1.11.11.cmml" xref="S4.Ex3.m1.11.11"></log><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑝</ci></apply><list id="S4.Ex3.m1.6.6.2.3.cmml" xref="S4.Ex3.m1.6.6.2.4"><ci id="S4.Ex3.m1.5.5.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1">𝑖</ci><ci id="S4.Ex3.m1.6.6.2.2.cmml" xref="S4.Ex3.m1.6.6.2.2">𝑗</ci></list></apply><ci id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.Ex3.m1.13.13.1.1.1.1.1.1.1.1.1.1.3">SAM</mtext></ci></apply></apply></apply></apply></apply><apply id="S4.Ex3.m1.13.13.1.1.3.3.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3"><times id="S4.Ex3.m1.13.13.1.1.3.3.3.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.3"></times><apply id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1"><minus id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.1"></minus><cn id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.2">1</cn><apply id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.1.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3">superscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.2.2">𝑦</ci><list id="S4.Ex3.m1.8.8.2.3.cmml" xref="S4.Ex3.m1.8.8.2.4"><ci id="S4.Ex3.m1.7.7.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1">𝑖</ci><ci id="S4.Ex3.m1.8.8.2.2.cmml" xref="S4.Ex3.m1.8.8.2.2">𝑗</ci></list></apply><ci id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3a.cmml" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3"><mtext id="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex3.m1.13.13.1.1.2.2.1.1.1.3.3">SAM</mtext></ci></apply></apply><apply id="S4.Ex3.m1.13.13.1.1.3.3.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1"><log id="S4.Ex3.m1.12.12.cmml" xref="S4.Ex3.m1.12.12"></log><apply id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1"><minus id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.1.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.1"></minus><cn id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.2">1</cn><apply id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.1.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3">superscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2"><ci id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.1.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.1">^</ci><ci id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.2.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.2.2.2">𝑝</ci></apply><list id="S4.Ex3.m1.10.10.2.3.cmml" xref="S4.Ex3.m1.10.10.2.4"><ci id="S4.Ex3.m1.9.9.1.1.cmml" xref="S4.Ex3.m1.9.9.1.1">𝑖</ci><ci id="S4.Ex3.m1.10.10.2.2.cmml" xref="S4.Ex3.m1.10.10.2.2">𝑗</ci></list></apply><ci id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3a.cmml" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3"><mtext id="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex3.m1.13.13.1.1.3.3.2.1.1.1.3.3">SAM</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.13c">\mathcal{L}_{\text{Reg}}=-\sum\nolimits_{i,j}y_{i,j}^{\text{SAM}}\log(\hat{p}_%
{i,j}^{\text{SAM}})+(1-y_{i,j}^{\text{SAM}})\log(1-\hat{p}_{i,j}^{\text{SAM}}).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.13d">caligraphic_L start_POSTSUBSCRIPT Reg end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT roman_log ( over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ) roman_log ( 1 - over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.4">This binary cross-entropy loss ensures that our model can retain the pre-trained knowledge essential for generalizing to real-world samples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.9.1">Trimap Loss.</span>
A trimap divides an image into foreground, background, and unknown regions. Given an image and its trimap, trimap-based matting network <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib35" title="">2024a</a>)</cite> is tasked solely with predicting refined alpha mattes for the unknown regions, without distinguishing between foreground and background. It allows trimap-based methods to achieve higher accuracy. Building on this idea, we explore whether the benefits of the trimap’s rich semantic information can be utilized without directly using it as input. Here we use the trimap annotations to supervise the matting logits with Gradient Harmonizing Mechanism (GHM) loss <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib12" title="">2019</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{Trimap}}=-\frac{1}{\mbox{GD}(g_{i,j})}\sum\nolimits_{i,j}%
\log(\hat{p}_{i,j}^{\text{Mat}})," class="ltx_Math" display="block" id="S4.Ex4.m1.9"><semantics id="S4.Ex4.m1.9a"><mrow id="S4.Ex4.m1.9.9.1" xref="S4.Ex4.m1.9.9.1.1.cmml"><mrow id="S4.Ex4.m1.9.9.1.1" xref="S4.Ex4.m1.9.9.1.1.cmml"><msub id="S4.Ex4.m1.9.9.1.1.3" xref="S4.Ex4.m1.9.9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.9.9.1.1.3.2" xref="S4.Ex4.m1.9.9.1.1.3.2.cmml">ℒ</mi><mtext id="S4.Ex4.m1.9.9.1.1.3.3" xref="S4.Ex4.m1.9.9.1.1.3.3a.cmml">Trimap</mtext></msub><mo id="S4.Ex4.m1.9.9.1.1.2" xref="S4.Ex4.m1.9.9.1.1.2.cmml">=</mo><mrow id="S4.Ex4.m1.9.9.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.cmml"><mo id="S4.Ex4.m1.9.9.1.1.1a" xref="S4.Ex4.m1.9.9.1.1.1.cmml">−</mo><mrow id="S4.Ex4.m1.9.9.1.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.1.cmml"><mfrac id="S4.Ex4.m1.3.3" xref="S4.Ex4.m1.3.3.cmml"><mn id="S4.Ex4.m1.3.3.5" xref="S4.Ex4.m1.3.3.5.cmml">1</mn><mrow id="S4.Ex4.m1.3.3.3" xref="S4.Ex4.m1.3.3.3.cmml"><mtext id="S4.Ex4.m1.3.3.3.5" xref="S4.Ex4.m1.3.3.3.5a.cmml">GD</mtext><mo id="S4.Ex4.m1.3.3.3.4" xref="S4.Ex4.m1.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex4.m1.3.3.3.3.1" xref="S4.Ex4.m1.3.3.3.3.1.1.cmml"><mo id="S4.Ex4.m1.3.3.3.3.1.2" stretchy="false" xref="S4.Ex4.m1.3.3.3.3.1.1.cmml">(</mo><msub id="S4.Ex4.m1.3.3.3.3.1.1" xref="S4.Ex4.m1.3.3.3.3.1.1.cmml"><mi id="S4.Ex4.m1.3.3.3.3.1.1.2" xref="S4.Ex4.m1.3.3.3.3.1.1.2.cmml">g</mi><mrow id="S4.Ex4.m1.2.2.2.2.2.4" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.Ex4.m1.2.2.2.2.2.4.1" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex4.m1.2.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.Ex4.m1.3.3.3.3.1.3" stretchy="false" xref="S4.Ex4.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.Ex4.m1.9.9.1.1.1.1.2" xref="S4.Ex4.m1.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m1.9.9.1.1.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.1.1.cmml"><msub id="S4.Ex4.m1.9.9.1.1.1.1.1.2" xref="S4.Ex4.m1.9.9.1.1.1.1.1.2.cmml"><mo id="S4.Ex4.m1.9.9.1.1.1.1.1.2.2" xref="S4.Ex4.m1.9.9.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.Ex4.m1.5.5.2.4" xref="S4.Ex4.m1.5.5.2.3.cmml"><mi id="S4.Ex4.m1.4.4.1.1" xref="S4.Ex4.m1.4.4.1.1.cmml">i</mi><mo id="S4.Ex4.m1.5.5.2.4.1" xref="S4.Ex4.m1.5.5.2.3.cmml">,</mo><mi id="S4.Ex4.m1.5.5.2.2" xref="S4.Ex4.m1.5.5.2.2.cmml">j</mi></mrow></msub><mrow id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex4.m1.8.8" xref="S4.Ex4.m1.8.8.cmml">log</mi><mo id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1a" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.Ex4.m1.7.7.2.4" xref="S4.Ex4.m1.7.7.2.3.cmml"><mi id="S4.Ex4.m1.6.6.1.1" xref="S4.Ex4.m1.6.6.1.1.cmml">i</mi><mo id="S4.Ex4.m1.7.7.2.4.1" xref="S4.Ex4.m1.7.7.2.3.cmml">,</mo><mi id="S4.Ex4.m1.7.7.2.2" xref="S4.Ex4.m1.7.7.2.2.cmml">j</mi></mrow><mtext id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3a.cmml">Mat</mtext></msubsup><mo id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.Ex4.m1.9.9.1.2" xref="S4.Ex4.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.9b"><apply id="S4.Ex4.m1.9.9.1.1.cmml" xref="S4.Ex4.m1.9.9.1"><eq id="S4.Ex4.m1.9.9.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.2"></eq><apply id="S4.Ex4.m1.9.9.1.1.3.cmml" xref="S4.Ex4.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.9.9.1.1.3.1.cmml" xref="S4.Ex4.m1.9.9.1.1.3">subscript</csymbol><ci id="S4.Ex4.m1.9.9.1.1.3.2.cmml" xref="S4.Ex4.m1.9.9.1.1.3.2">ℒ</ci><ci id="S4.Ex4.m1.9.9.1.1.3.3a.cmml" xref="S4.Ex4.m1.9.9.1.1.3.3"><mtext id="S4.Ex4.m1.9.9.1.1.3.3.cmml" mathsize="70%" xref="S4.Ex4.m1.9.9.1.1.3.3">Trimap</mtext></ci></apply><apply id="S4.Ex4.m1.9.9.1.1.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1"><minus id="S4.Ex4.m1.9.9.1.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1"></minus><apply id="S4.Ex4.m1.9.9.1.1.1.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1"><times id="S4.Ex4.m1.9.9.1.1.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.2"></times><apply id="S4.Ex4.m1.3.3.cmml" xref="S4.Ex4.m1.3.3"><divide id="S4.Ex4.m1.3.3.4.cmml" xref="S4.Ex4.m1.3.3"></divide><cn id="S4.Ex4.m1.3.3.5.cmml" type="integer" xref="S4.Ex4.m1.3.3.5">1</cn><apply id="S4.Ex4.m1.3.3.3.cmml" xref="S4.Ex4.m1.3.3.3"><times id="S4.Ex4.m1.3.3.3.4.cmml" xref="S4.Ex4.m1.3.3.3.4"></times><ci id="S4.Ex4.m1.3.3.3.5a.cmml" xref="S4.Ex4.m1.3.3.3.5"><mtext id="S4.Ex4.m1.3.3.3.5.cmml" xref="S4.Ex4.m1.3.3.3.5">GD</mtext></ci><apply id="S4.Ex4.m1.3.3.3.3.1.1.cmml" xref="S4.Ex4.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.3.3.3.3.1.1.1.cmml" xref="S4.Ex4.m1.3.3.3.3.1">subscript</csymbol><ci id="S4.Ex4.m1.3.3.3.3.1.1.2.cmml" xref="S4.Ex4.m1.3.3.3.3.1.1.2">𝑔</ci><list id="S4.Ex4.m1.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.2.2.2.4"><ci id="S4.Ex4.m1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1">𝑖</ci><ci id="S4.Ex4.m1.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1"><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.2">subscript</csymbol><sum id="S4.Ex4.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.2.2"></sum><list id="S4.Ex4.m1.5.5.2.3.cmml" xref="S4.Ex4.m1.5.5.2.4"><ci id="S4.Ex4.m1.4.4.1.1.cmml" xref="S4.Ex4.m1.4.4.1.1">𝑖</ci><ci id="S4.Ex4.m1.5.5.2.2.cmml" xref="S4.Ex4.m1.5.5.2.2">𝑗</ci></list></apply><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1"><log id="S4.Ex4.m1.8.8.cmml" xref="S4.Ex4.m1.8.8"></log><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2"><ci id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2">𝑝</ci></apply><list id="S4.Ex4.m1.7.7.2.3.cmml" xref="S4.Ex4.m1.7.7.2.4"><ci id="S4.Ex4.m1.6.6.1.1.cmml" xref="S4.Ex4.m1.6.6.1.1">𝑖</ci><ci id="S4.Ex4.m1.7.7.2.2.cmml" xref="S4.Ex4.m1.7.7.2.2">𝑗</ci></list></apply><ci id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3">Mat</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.9c">\mathcal{L}_{\text{Trimap}}=-\frac{1}{\mbox{GD}(g_{i,j})}\sum\nolimits_{i,j}%
\log(\hat{p}_{i,j}^{\text{Mat}}),</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.9d">caligraphic_L start_POSTSUBSCRIPT Trimap end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG GD ( italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) end_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.8">where <math alttext="\hat{p}_{i,j}^{\text{Mat}}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.2"><semantics id="S4.SS2.p3.1.m1.2a"><msubsup id="S4.SS2.p3.1.m1.2.3" xref="S4.SS2.p3.1.m1.2.3.cmml"><mover accent="true" id="S4.SS2.p3.1.m1.2.3.2.2" xref="S4.SS2.p3.1.m1.2.3.2.2.cmml"><mi id="S4.SS2.p3.1.m1.2.3.2.2.2" xref="S4.SS2.p3.1.m1.2.3.2.2.2.cmml">p</mi><mo id="S4.SS2.p3.1.m1.2.3.2.2.1" xref="S4.SS2.p3.1.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS2.p3.1.m1.2.2.2.4" xref="S4.SS2.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.1.m1.2.2.2.4.1" xref="S4.SS2.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.1.m1.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p3.1.m1.2.3.3" xref="S4.SS2.p3.1.m1.2.3.3a.cmml">Mat</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.2b"><apply id="S4.SS2.p3.1.m1.2.3.cmml" xref="S4.SS2.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.2.3">superscript</csymbol><apply id="S4.SS2.p3.1.m1.2.3.2.cmml" xref="S4.SS2.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.3.2.1.cmml" xref="S4.SS2.p3.1.m1.2.3">subscript</csymbol><apply id="S4.SS2.p3.1.m1.2.3.2.2.cmml" xref="S4.SS2.p3.1.m1.2.3.2.2"><ci id="S4.SS2.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS2.p3.1.m1.2.3.2.2.1">^</ci><ci id="S4.SS2.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.3.2.2.2">𝑝</ci></apply><list id="S4.SS2.p3.1.m1.2.2.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.2.4"><ci id="S4.SS2.p3.1.m1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.1.m1.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p3.1.m1.2.3.3a.cmml" xref="S4.SS2.p3.1.m1.2.3.3"><mtext id="S4.SS2.p3.1.m1.2.3.3.cmml" mathsize="70%" xref="S4.SS2.p3.1.m1.2.3.3">Mat</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.2c">\hat{p}_{i,j}^{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.2d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the confidence calculated with the trimap annotations at the point <math alttext="(i,j)" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.2"><semantics id="S4.SS2.p3.2.m2.2a"><mrow id="S4.SS2.p3.2.m2.2.3.2" xref="S4.SS2.p3.2.m2.2.3.1.cmml"><mo id="S4.SS2.p3.2.m2.2.3.2.1" stretchy="false" xref="S4.SS2.p3.2.m2.2.3.1.cmml">(</mo><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">i</mi><mo id="S4.SS2.p3.2.m2.2.3.2.2" xref="S4.SS2.p3.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS2.p3.2.m2.2.2" xref="S4.SS2.p3.2.m2.2.2.cmml">j</mi><mo id="S4.SS2.p3.2.m2.2.3.2.3" stretchy="false" xref="S4.SS2.p3.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.2b"><interval closure="open" id="S4.SS2.p3.2.m2.2.3.1.cmml" xref="S4.SS2.p3.2.m2.2.3.2"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑖</ci><ci id="S4.SS2.p3.2.m2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.2d">( italic_i , italic_j )</annotation></semantics></math>. <math alttext="\mbox{GD}(g_{i,j})" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.3"><semantics id="S4.SS2.p3.3.m3.3a"><mrow id="S4.SS2.p3.3.m3.3.3" xref="S4.SS2.p3.3.m3.3.3.cmml"><mtext id="S4.SS2.p3.3.m3.3.3.3" xref="S4.SS2.p3.3.m3.3.3.3a.cmml">GD</mtext><mo id="S4.SS2.p3.3.m3.3.3.2" xref="S4.SS2.p3.3.m3.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p3.3.m3.3.3.1.1" xref="S4.SS2.p3.3.m3.3.3.1.1.1.cmml"><mo id="S4.SS2.p3.3.m3.3.3.1.1.2" stretchy="false" xref="S4.SS2.p3.3.m3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS2.p3.3.m3.3.3.1.1.1" xref="S4.SS2.p3.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS2.p3.3.m3.3.3.1.1.1.2" xref="S4.SS2.p3.3.m3.3.3.1.1.1.2.cmml">g</mi><mrow id="S4.SS2.p3.3.m3.2.2.2.4" xref="S4.SS2.p3.3.m3.2.2.2.3.cmml"><mi id="S4.SS2.p3.3.m3.1.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.3.m3.2.2.2.4.1" xref="S4.SS2.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.3.m3.2.2.2.2" xref="S4.SS2.p3.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.SS2.p3.3.m3.3.3.1.1.3" stretchy="false" xref="S4.SS2.p3.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.3b"><apply id="S4.SS2.p3.3.m3.3.3.cmml" xref="S4.SS2.p3.3.m3.3.3"><times id="S4.SS2.p3.3.m3.3.3.2.cmml" xref="S4.SS2.p3.3.m3.3.3.2"></times><ci id="S4.SS2.p3.3.m3.3.3.3a.cmml" xref="S4.SS2.p3.3.m3.3.3.3"><mtext id="S4.SS2.p3.3.m3.3.3.3.cmml" xref="S4.SS2.p3.3.m3.3.3.3">GD</mtext></ci><apply id="S4.SS2.p3.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS2.p3.3.m3.3.3.1.1.1.2">𝑔</ci><list id="S4.SS2.p3.3.m3.2.2.2.3.cmml" xref="S4.SS2.p3.3.m3.2.2.2.4"><ci id="S4.SS2.p3.3.m3.1.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.3.m3.2.2.2.2.cmml" xref="S4.SS2.p3.3.m3.2.2.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.3c">\mbox{GD}(g_{i,j})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.3d">GD ( italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the density of gradient <math alttext="g_{i,j}=y_{i,j}^{\text{Tri}}-p_{i,j}^{\text{Mat}}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.6"><semantics id="S4.SS2.p3.4.m4.6a"><mrow id="S4.SS2.p3.4.m4.6.7" xref="S4.SS2.p3.4.m4.6.7.cmml"><msub id="S4.SS2.p3.4.m4.6.7.2" xref="S4.SS2.p3.4.m4.6.7.2.cmml"><mi id="S4.SS2.p3.4.m4.6.7.2.2" xref="S4.SS2.p3.4.m4.6.7.2.2.cmml">g</mi><mrow id="S4.SS2.p3.4.m4.2.2.2.4" xref="S4.SS2.p3.4.m4.2.2.2.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.4.m4.2.2.2.4.1" xref="S4.SS2.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.4.m4.2.2.2.2" xref="S4.SS2.p3.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.SS2.p3.4.m4.6.7.1" xref="S4.SS2.p3.4.m4.6.7.1.cmml">=</mo><mrow id="S4.SS2.p3.4.m4.6.7.3" xref="S4.SS2.p3.4.m4.6.7.3.cmml"><msubsup id="S4.SS2.p3.4.m4.6.7.3.2" xref="S4.SS2.p3.4.m4.6.7.3.2.cmml"><mi id="S4.SS2.p3.4.m4.6.7.3.2.2.2" xref="S4.SS2.p3.4.m4.6.7.3.2.2.2.cmml">y</mi><mrow id="S4.SS2.p3.4.m4.4.4.2.4" xref="S4.SS2.p3.4.m4.4.4.2.3.cmml"><mi id="S4.SS2.p3.4.m4.3.3.1.1" xref="S4.SS2.p3.4.m4.3.3.1.1.cmml">i</mi><mo id="S4.SS2.p3.4.m4.4.4.2.4.1" xref="S4.SS2.p3.4.m4.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p3.4.m4.4.4.2.2" xref="S4.SS2.p3.4.m4.4.4.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p3.4.m4.6.7.3.2.3" xref="S4.SS2.p3.4.m4.6.7.3.2.3a.cmml">Tri</mtext></msubsup><mo id="S4.SS2.p3.4.m4.6.7.3.1" xref="S4.SS2.p3.4.m4.6.7.3.1.cmml">−</mo><msubsup id="S4.SS2.p3.4.m4.6.7.3.3" xref="S4.SS2.p3.4.m4.6.7.3.3.cmml"><mi id="S4.SS2.p3.4.m4.6.7.3.3.2.2" xref="S4.SS2.p3.4.m4.6.7.3.3.2.2.cmml">p</mi><mrow id="S4.SS2.p3.4.m4.6.6.2.4" xref="S4.SS2.p3.4.m4.6.6.2.3.cmml"><mi id="S4.SS2.p3.4.m4.5.5.1.1" xref="S4.SS2.p3.4.m4.5.5.1.1.cmml">i</mi><mo id="S4.SS2.p3.4.m4.6.6.2.4.1" xref="S4.SS2.p3.4.m4.6.6.2.3.cmml">,</mo><mi id="S4.SS2.p3.4.m4.6.6.2.2" xref="S4.SS2.p3.4.m4.6.6.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p3.4.m4.6.7.3.3.3" xref="S4.SS2.p3.4.m4.6.7.3.3.3a.cmml">Mat</mtext></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.6b"><apply id="S4.SS2.p3.4.m4.6.7.cmml" xref="S4.SS2.p3.4.m4.6.7"><eq id="S4.SS2.p3.4.m4.6.7.1.cmml" xref="S4.SS2.p3.4.m4.6.7.1"></eq><apply id="S4.SS2.p3.4.m4.6.7.2.cmml" xref="S4.SS2.p3.4.m4.6.7.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.6.7.2.1.cmml" xref="S4.SS2.p3.4.m4.6.7.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.6.7.2.2.cmml" xref="S4.SS2.p3.4.m4.6.7.2.2">𝑔</ci><list id="S4.SS2.p3.4.m4.2.2.2.3.cmml" xref="S4.SS2.p3.4.m4.2.2.2.4"><ci id="S4.SS2.p3.4.m4.1.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.4.m4.2.2.2.2.cmml" xref="S4.SS2.p3.4.m4.2.2.2.2">𝑗</ci></list></apply><apply id="S4.SS2.p3.4.m4.6.7.3.cmml" xref="S4.SS2.p3.4.m4.6.7.3"><minus id="S4.SS2.p3.4.m4.6.7.3.1.cmml" xref="S4.SS2.p3.4.m4.6.7.3.1"></minus><apply id="S4.SS2.p3.4.m4.6.7.3.2.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.6.7.3.2.1.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2">superscript</csymbol><apply id="S4.SS2.p3.4.m4.6.7.3.2.2.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.6.7.3.2.2.1.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2">subscript</csymbol><ci id="S4.SS2.p3.4.m4.6.7.3.2.2.2.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2.2.2">𝑦</ci><list id="S4.SS2.p3.4.m4.4.4.2.3.cmml" xref="S4.SS2.p3.4.m4.4.4.2.4"><ci id="S4.SS2.p3.4.m4.3.3.1.1.cmml" xref="S4.SS2.p3.4.m4.3.3.1.1">𝑖</ci><ci id="S4.SS2.p3.4.m4.4.4.2.2.cmml" xref="S4.SS2.p3.4.m4.4.4.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p3.4.m4.6.7.3.2.3a.cmml" xref="S4.SS2.p3.4.m4.6.7.3.2.3"><mtext id="S4.SS2.p3.4.m4.6.7.3.2.3.cmml" mathsize="70%" xref="S4.SS2.p3.4.m4.6.7.3.2.3">Tri</mtext></ci></apply><apply id="S4.SS2.p3.4.m4.6.7.3.3.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.6.7.3.3.1.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3">superscript</csymbol><apply id="S4.SS2.p3.4.m4.6.7.3.3.2.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.6.7.3.3.2.1.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3">subscript</csymbol><ci id="S4.SS2.p3.4.m4.6.7.3.3.2.2.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3.2.2">𝑝</ci><list id="S4.SS2.p3.4.m4.6.6.2.3.cmml" xref="S4.SS2.p3.4.m4.6.6.2.4"><ci id="S4.SS2.p3.4.m4.5.5.1.1.cmml" xref="S4.SS2.p3.4.m4.5.5.1.1">𝑖</ci><ci id="S4.SS2.p3.4.m4.6.6.2.2.cmml" xref="S4.SS2.p3.4.m4.6.6.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p3.4.m4.6.7.3.3.3a.cmml" xref="S4.SS2.p3.4.m4.6.7.3.3.3"><mtext id="S4.SS2.p3.4.m4.6.7.3.3.3.cmml" mathsize="70%" xref="S4.SS2.p3.4.m4.6.7.3.3.3">Mat</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.6c">g_{i,j}=y_{i,j}^{\text{Tri}}-p_{i,j}^{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.6d">italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Tri end_POSTSUPERSCRIPT - italic_p start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT</annotation></semantics></math> of the cross-entropy loss (<math alttext="-\log p_{i,j}^{\text{Mat}}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.2"><semantics id="S4.SS2.p3.5.m5.2a"><mrow id="S4.SS2.p3.5.m5.2.3" xref="S4.SS2.p3.5.m5.2.3.cmml"><mo id="S4.SS2.p3.5.m5.2.3a" rspace="0.167em" xref="S4.SS2.p3.5.m5.2.3.cmml">−</mo><mrow id="S4.SS2.p3.5.m5.2.3.2" xref="S4.SS2.p3.5.m5.2.3.2.cmml"><mi id="S4.SS2.p3.5.m5.2.3.2.1" xref="S4.SS2.p3.5.m5.2.3.2.1.cmml">log</mi><mo id="S4.SS2.p3.5.m5.2.3.2a" lspace="0.167em" xref="S4.SS2.p3.5.m5.2.3.2.cmml">⁡</mo><msubsup id="S4.SS2.p3.5.m5.2.3.2.2" xref="S4.SS2.p3.5.m5.2.3.2.2.cmml"><mi id="S4.SS2.p3.5.m5.2.3.2.2.2.2" xref="S4.SS2.p3.5.m5.2.3.2.2.2.2.cmml">p</mi><mrow id="S4.SS2.p3.5.m5.2.2.2.4" xref="S4.SS2.p3.5.m5.2.2.2.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.5.m5.2.2.2.4.1" xref="S4.SS2.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.5.m5.2.2.2.2" xref="S4.SS2.p3.5.m5.2.2.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p3.5.m5.2.3.2.2.3" xref="S4.SS2.p3.5.m5.2.3.2.2.3a.cmml">Mat</mtext></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.2b"><apply id="S4.SS2.p3.5.m5.2.3.cmml" xref="S4.SS2.p3.5.m5.2.3"><minus id="S4.SS2.p3.5.m5.2.3.1.cmml" xref="S4.SS2.p3.5.m5.2.3"></minus><apply id="S4.SS2.p3.5.m5.2.3.2.cmml" xref="S4.SS2.p3.5.m5.2.3.2"><log id="S4.SS2.p3.5.m5.2.3.2.1.cmml" xref="S4.SS2.p3.5.m5.2.3.2.1"></log><apply id="S4.SS2.p3.5.m5.2.3.2.2.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.3.2.2.1.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2">superscript</csymbol><apply id="S4.SS2.p3.5.m5.2.3.2.2.2.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.3.2.2.2.1.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.3.2.2.2.2.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2.2.2">𝑝</ci><list id="S4.SS2.p3.5.m5.2.2.2.3.cmml" xref="S4.SS2.p3.5.m5.2.2.2.4"><ci id="S4.SS2.p3.5.m5.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.5.m5.2.2.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p3.5.m5.2.3.2.2.3a.cmml" xref="S4.SS2.p3.5.m5.2.3.2.2.3"><mtext id="S4.SS2.p3.5.m5.2.3.2.2.3.cmml" mathsize="70%" xref="S4.SS2.p3.5.m5.2.3.2.2.3">Mat</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.2c">-\log p_{i,j}^{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.2d">- roman_log italic_p start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT</annotation></semantics></math>), where <math alttext="y_{i,j}^{\text{Tri}}" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.2"><semantics id="S4.SS2.p3.6.m6.2a"><msubsup id="S4.SS2.p3.6.m6.2.3" xref="S4.SS2.p3.6.m6.2.3.cmml"><mi id="S4.SS2.p3.6.m6.2.3.2.2" xref="S4.SS2.p3.6.m6.2.3.2.2.cmml">y</mi><mrow id="S4.SS2.p3.6.m6.2.2.2.4" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml"><mi id="S4.SS2.p3.6.m6.1.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.6.m6.2.2.2.4.1" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.6.m6.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.2.cmml">j</mi></mrow><mtext id="S4.SS2.p3.6.m6.2.3.3" xref="S4.SS2.p3.6.m6.2.3.3a.cmml">Tri</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.2b"><apply id="S4.SS2.p3.6.m6.2.3.cmml" xref="S4.SS2.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.3.1.cmml" xref="S4.SS2.p3.6.m6.2.3">superscript</csymbol><apply id="S4.SS2.p3.6.m6.2.3.2.cmml" xref="S4.SS2.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.3.2.1.cmml" xref="S4.SS2.p3.6.m6.2.3">subscript</csymbol><ci id="S4.SS2.p3.6.m6.2.3.2.2.cmml" xref="S4.SS2.p3.6.m6.2.3.2.2">𝑦</ci><list id="S4.SS2.p3.6.m6.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.2.4"><ci id="S4.SS2.p3.6.m6.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.6.m6.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS2.p3.6.m6.2.3.3a.cmml" xref="S4.SS2.p3.6.m6.2.3.3"><mtext id="S4.SS2.p3.6.m6.2.3.3.cmml" mathsize="70%" xref="S4.SS2.p3.6.m6.2.3.3">Tri</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.2c">y_{i,j}^{\text{Tri}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.2d">italic_y start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Tri end_POSTSUPERSCRIPT</annotation></semantics></math> is the ground-truth trimap. Intuitively, for too easy or too difficult samples, their corresponding density <math alttext="\mbox{GD}(g_{i,j})" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.3"><semantics id="S4.SS2.p3.7.m7.3a"><mrow id="S4.SS2.p3.7.m7.3.3" xref="S4.SS2.p3.7.m7.3.3.cmml"><mtext id="S4.SS2.p3.7.m7.3.3.3" xref="S4.SS2.p3.7.m7.3.3.3a.cmml">GD</mtext><mo id="S4.SS2.p3.7.m7.3.3.2" xref="S4.SS2.p3.7.m7.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p3.7.m7.3.3.1.1" xref="S4.SS2.p3.7.m7.3.3.1.1.1.cmml"><mo id="S4.SS2.p3.7.m7.3.3.1.1.2" stretchy="false" xref="S4.SS2.p3.7.m7.3.3.1.1.1.cmml">(</mo><msub id="S4.SS2.p3.7.m7.3.3.1.1.1" xref="S4.SS2.p3.7.m7.3.3.1.1.1.cmml"><mi id="S4.SS2.p3.7.m7.3.3.1.1.1.2" xref="S4.SS2.p3.7.m7.3.3.1.1.1.2.cmml">g</mi><mrow id="S4.SS2.p3.7.m7.2.2.2.4" xref="S4.SS2.p3.7.m7.2.2.2.3.cmml"><mi id="S4.SS2.p3.7.m7.1.1.1.1" xref="S4.SS2.p3.7.m7.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.7.m7.2.2.2.4.1" xref="S4.SS2.p3.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.7.m7.2.2.2.2" xref="S4.SS2.p3.7.m7.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.SS2.p3.7.m7.3.3.1.1.3" stretchy="false" xref="S4.SS2.p3.7.m7.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.3b"><apply id="S4.SS2.p3.7.m7.3.3.cmml" xref="S4.SS2.p3.7.m7.3.3"><times id="S4.SS2.p3.7.m7.3.3.2.cmml" xref="S4.SS2.p3.7.m7.3.3.2"></times><ci id="S4.SS2.p3.7.m7.3.3.3a.cmml" xref="S4.SS2.p3.7.m7.3.3.3"><mtext id="S4.SS2.p3.7.m7.3.3.3.cmml" xref="S4.SS2.p3.7.m7.3.3.3">GD</mtext></ci><apply id="S4.SS2.p3.7.m7.3.3.1.1.1.cmml" xref="S4.SS2.p3.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.3.3.1.1.1.1.cmml" xref="S4.SS2.p3.7.m7.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p3.7.m7.3.3.1.1.1.2.cmml" xref="S4.SS2.p3.7.m7.3.3.1.1.1.2">𝑔</ci><list id="S4.SS2.p3.7.m7.2.2.2.3.cmml" xref="S4.SS2.p3.7.m7.2.2.2.4"><ci id="S4.SS2.p3.7.m7.1.1.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.7.m7.2.2.2.2.cmml" xref="S4.SS2.p3.7.m7.2.2.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.3c">\mbox{GD}(g_{i,j})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.3d">GD ( italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> are often large and thus have a small loss weight <math alttext="{1}/{\mbox{GD}(g_{i,j})}" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m8.3"><semantics id="S4.SS2.p3.8.m8.3a"><mrow id="S4.SS2.p3.8.m8.3.3" xref="S4.SS2.p3.8.m8.3.3.cmml"><mrow id="S4.SS2.p3.8.m8.3.3.3" xref="S4.SS2.p3.8.m8.3.3.3.cmml"><mn id="S4.SS2.p3.8.m8.3.3.3.2" xref="S4.SS2.p3.8.m8.3.3.3.2.cmml">1</mn><mo id="S4.SS2.p3.8.m8.3.3.3.1" xref="S4.SS2.p3.8.m8.3.3.3.1.cmml">/</mo><mtext id="S4.SS2.p3.8.m8.3.3.3.3" xref="S4.SS2.p3.8.m8.3.3.3.3a.cmml">GD</mtext></mrow><mo id="S4.SS2.p3.8.m8.3.3.2" xref="S4.SS2.p3.8.m8.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p3.8.m8.3.3.1.1" xref="S4.SS2.p3.8.m8.3.3.1.1.1.cmml"><mo id="S4.SS2.p3.8.m8.3.3.1.1.2" stretchy="false" xref="S4.SS2.p3.8.m8.3.3.1.1.1.cmml">(</mo><msub id="S4.SS2.p3.8.m8.3.3.1.1.1" xref="S4.SS2.p3.8.m8.3.3.1.1.1.cmml"><mi id="S4.SS2.p3.8.m8.3.3.1.1.1.2" xref="S4.SS2.p3.8.m8.3.3.1.1.1.2.cmml">g</mi><mrow id="S4.SS2.p3.8.m8.2.2.2.4" xref="S4.SS2.p3.8.m8.2.2.2.3.cmml"><mi id="S4.SS2.p3.8.m8.1.1.1.1" xref="S4.SS2.p3.8.m8.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.8.m8.2.2.2.4.1" xref="S4.SS2.p3.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.8.m8.2.2.2.2" xref="S4.SS2.p3.8.m8.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.SS2.p3.8.m8.3.3.1.1.3" stretchy="false" xref="S4.SS2.p3.8.m8.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.3b"><apply id="S4.SS2.p3.8.m8.3.3.cmml" xref="S4.SS2.p3.8.m8.3.3"><times id="S4.SS2.p3.8.m8.3.3.2.cmml" xref="S4.SS2.p3.8.m8.3.3.2"></times><apply id="S4.SS2.p3.8.m8.3.3.3.cmml" xref="S4.SS2.p3.8.m8.3.3.3"><divide id="S4.SS2.p3.8.m8.3.3.3.1.cmml" xref="S4.SS2.p3.8.m8.3.3.3.1"></divide><cn id="S4.SS2.p3.8.m8.3.3.3.2.cmml" type="integer" xref="S4.SS2.p3.8.m8.3.3.3.2">1</cn><ci id="S4.SS2.p3.8.m8.3.3.3.3a.cmml" xref="S4.SS2.p3.8.m8.3.3.3.3"><mtext id="S4.SS2.p3.8.m8.3.3.3.3.cmml" xref="S4.SS2.p3.8.m8.3.3.3.3">GD</mtext></ci></apply><apply id="S4.SS2.p3.8.m8.3.3.1.1.1.cmml" xref="S4.SS2.p3.8.m8.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.3.3.1.1.1.1.cmml" xref="S4.SS2.p3.8.m8.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p3.8.m8.3.3.1.1.1.2.cmml" xref="S4.SS2.p3.8.m8.3.3.1.1.1.2">𝑔</ci><list id="S4.SS2.p3.8.m8.2.2.2.3.cmml" xref="S4.SS2.p3.8.m8.2.2.2.4"><ci id="S4.SS2.p3.8.m8.1.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.8.m8.2.2.2.2.cmml" xref="S4.SS2.p3.8.m8.2.2.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.3c">{1}/{\mbox{GD}(g_{i,j})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m8.3d">1 / GD ( italic_g start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib12" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">Matting Loss.</span> We follow the loss in ViTMatte <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib35" title="">2024a</a>)</cite>, i.e., adopt the <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" mathvariant="normal" xref="S4.SS2.p4.1.m1.1.1.2.cmml">ℓ</mi><mn id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">ℓ</ci><cn id="S4.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss on known and unknown regions, gradient penalty loss <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib1" title="">2022</a>)</cite> and laplacian loss <cite class="ltx_cite ltx_citemacro_citep">(Hou &amp; Liu, <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib6" title="">2019</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{Mat}}=\left\|\alpha-\hat{\alpha}\right\|_{1,\mathcal{K}}+%
\left\|\alpha-\hat{\alpha}\right\|_{1,\mathcal{U}}+(\left\|\nabla\alpha-\nabla%
\hat{\alpha}\right\|_{1}+\lambda\left\|\nabla\alpha\right\|_{1})+\sum\nolimits%
_{k=1}^{5}2^{k-1}\left\|L^{k}(\alpha)-L^{k}(\hat{\alpha})\right\|_{1}," class="ltx_Math" display="block" id="S4.Ex5.m1.7"><semantics id="S4.Ex5.m1.7a"><mrow id="S4.Ex5.m1.7.7.1" xref="S4.Ex5.m1.7.7.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1" xref="S4.Ex5.m1.7.7.1.1.cmml"><msub id="S4.Ex5.m1.7.7.1.1.6" xref="S4.Ex5.m1.7.7.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.7.7.1.1.6.2" xref="S4.Ex5.m1.7.7.1.1.6.2.cmml">ℒ</mi><mtext id="S4.Ex5.m1.7.7.1.1.6.3" xref="S4.Ex5.m1.7.7.1.1.6.3a.cmml">Mat</mtext></msub><mo id="S4.Ex5.m1.7.7.1.1.5" xref="S4.Ex5.m1.7.7.1.1.5.cmml">=</mo><mrow id="S4.Ex5.m1.7.7.1.1.4" xref="S4.Ex5.m1.7.7.1.1.4.cmml"><msub id="S4.Ex5.m1.7.7.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.2.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.1" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S4.Ex5.m1.7.7.1.1.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="S4.Ex5.m1.2.2.2.4" xref="S4.Ex5.m1.2.2.2.3.cmml"><mn id="S4.Ex5.m1.1.1.1.1" xref="S4.Ex5.m1.1.1.1.1.cmml">1</mn><mo id="S4.Ex5.m1.2.2.2.4.1" xref="S4.Ex5.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.2.2.2.2" xref="S4.Ex5.m1.2.2.2.2.cmml">𝒦</mi></mrow></msub><mo id="S4.Ex5.m1.7.7.1.1.4.5" xref="S4.Ex5.m1.7.7.1.1.4.5.cmml">+</mo><msub id="S4.Ex5.m1.7.7.1.1.2.2" xref="S4.Ex5.m1.7.7.1.1.2.2.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.2.2.1.1" xref="S4.Ex5.m1.7.7.1.1.2.2.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.2.2.1.1.2" xref="S4.Ex5.m1.7.7.1.1.2.2.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.cmml"><mi id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.2.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.cmml"><mi id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.2" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.2.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.1" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S4.Ex5.m1.7.7.1.1.2.2.1.1.3" xref="S4.Ex5.m1.7.7.1.1.2.2.1.2.1.cmml">‖</mo></mrow><mrow id="S4.Ex5.m1.4.4.2.4" xref="S4.Ex5.m1.4.4.2.3.cmml"><mn id="S4.Ex5.m1.3.3.1.1" xref="S4.Ex5.m1.3.3.1.1.cmml">1</mn><mo id="S4.Ex5.m1.4.4.2.4.1" xref="S4.Ex5.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.4.4.2.2" xref="S4.Ex5.m1.4.4.2.2.cmml">𝒰</mi></mrow></msub><mo id="S4.Ex5.m1.7.7.1.1.4.5a" xref="S4.Ex5.m1.7.7.1.1.4.5.cmml">+</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.2" stretchy="false" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.cmml">(</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.cmml"><msub id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.1" rspace="0.167em" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.1.cmml">∇</mo><mi id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.cmml">α</mi></mrow><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.1" rspace="0.167em" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.1.cmml">∇</mo><mover accent="true" id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.2.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover></mrow></mrow><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.3.cmml">+</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.cmml"><mi id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.3.cmml">λ</mi><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.2.cmml">⁢</mo><msub id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.1" rspace="0.167em" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.1.cmml">∇</mo><mi id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.2.cmml">α</mi></mrow><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.3" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.3.cmml">1</mn></msub></mrow></mrow><mo id="S4.Ex5.m1.7.7.1.1.3.3.1.3" stretchy="false" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.cmml">)</mo></mrow><mo id="S4.Ex5.m1.7.7.1.1.4.5b" rspace="0.055em" xref="S4.Ex5.m1.7.7.1.1.4.5.cmml">+</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4" xref="S4.Ex5.m1.7.7.1.1.4.4.cmml"><msubsup id="S4.Ex5.m1.7.7.1.1.4.4.2" xref="S4.Ex5.m1.7.7.1.1.4.4.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.4.4.2.2.2" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.2.cmml">∑</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.cmml"><mi id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.2" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.2.cmml">k</mi><mo id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.1" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.1.cmml">=</mo><mn id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.3" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.3.cmml">1</mn></mrow><mn id="S4.Ex5.m1.7.7.1.1.4.4.2.3" xref="S4.Ex5.m1.7.7.1.1.4.4.2.3.cmml">5</mn></msubsup><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.cmml"><msup id="S4.Ex5.m1.7.7.1.1.4.4.1.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.cmml"><mn id="S4.Ex5.m1.7.7.1.1.4.4.1.3.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.2.cmml">2</mn><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.cmml"><mi id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.2.cmml">k</mi><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.1.cmml">−</mo><mn id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.2.cmml">⁢</mo><msub id="S4.Ex5.m1.7.7.1.1.4.4.1.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.cmml"><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.cmml"><msup id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.cmml"><mi id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.3.cmml">k</mi></msup><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.3.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.cmml"><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="S4.Ex5.m1.5.5" xref="S4.Ex5.m1.5.5.cmml">α</mi><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.cmml"><msup id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.2" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.3.cmml">k</mi></msup><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.1" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.3.2" xref="S4.Ex5.m1.6.6.cmml"><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.Ex5.m1.6.6.cmml">(</mo><mover accent="true" id="S4.Ex5.m1.6.6" xref="S4.Ex5.m1.6.6.cmml"><mi id="S4.Ex5.m1.6.6.2" xref="S4.Ex5.m1.6.6.2.cmml">α</mi><mo id="S4.Ex5.m1.6.6.1" xref="S4.Ex5.m1.6.6.1.cmml">^</mo></mover><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.Ex5.m1.6.6.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex5.m1.7.7.1.1.4.4.1.1.3" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.3.cmml">1</mn></msub></mrow></mrow></mrow></mrow><mo id="S4.Ex5.m1.7.7.1.2" xref="S4.Ex5.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.7b"><apply id="S4.Ex5.m1.7.7.1.1.cmml" xref="S4.Ex5.m1.7.7.1"><eq id="S4.Ex5.m1.7.7.1.1.5.cmml" xref="S4.Ex5.m1.7.7.1.1.5"></eq><apply id="S4.Ex5.m1.7.7.1.1.6.cmml" xref="S4.Ex5.m1.7.7.1.1.6"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.6.1.cmml" xref="S4.Ex5.m1.7.7.1.1.6">subscript</csymbol><ci id="S4.Ex5.m1.7.7.1.1.6.2.cmml" xref="S4.Ex5.m1.7.7.1.1.6.2">ℒ</ci><ci id="S4.Ex5.m1.7.7.1.1.6.3a.cmml" xref="S4.Ex5.m1.7.7.1.1.6.3"><mtext id="S4.Ex5.m1.7.7.1.1.6.3.cmml" mathsize="70%" xref="S4.Ex5.m1.7.7.1.1.6.3">Mat</mtext></ci></apply><apply id="S4.Ex5.m1.7.7.1.1.4.cmml" xref="S4.Ex5.m1.7.7.1.1.4"><plus id="S4.Ex5.m1.7.7.1.1.4.5.cmml" xref="S4.Ex5.m1.7.7.1.1.4.5"></plus><apply id="S4.Ex5.m1.7.7.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1">subscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1"><minus id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.1"></minus><ci id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.2">𝛼</ci><apply id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3"><ci id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.1">^</ci><ci id="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.1.1.1.1.1.3.2">𝛼</ci></apply></apply></apply><list id="S4.Ex5.m1.2.2.2.3.cmml" xref="S4.Ex5.m1.2.2.2.4"><cn id="S4.Ex5.m1.1.1.1.1.cmml" type="integer" xref="S4.Ex5.m1.1.1.1.1">1</cn><ci id="S4.Ex5.m1.2.2.2.2.cmml" xref="S4.Ex5.m1.2.2.2.2">𝒦</ci></list></apply><apply id="S4.Ex5.m1.7.7.1.1.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.2.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2">subscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.2.2.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.7.7.1.1.2.2.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1"><minus id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.1"></minus><ci id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.2">𝛼</ci><apply id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3"><ci id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.1">^</ci><ci id="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.2.2.1.1.1.3.2">𝛼</ci></apply></apply></apply><list id="S4.Ex5.m1.4.4.2.3.cmml" xref="S4.Ex5.m1.4.4.2.4"><cn id="S4.Ex5.m1.3.3.1.1.cmml" type="integer" xref="S4.Ex5.m1.3.3.1.1">1</cn><ci id="S4.Ex5.m1.4.4.2.2.cmml" xref="S4.Ex5.m1.4.4.2.2">𝒰</ci></list></apply><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1"><plus id="S4.Ex5.m1.7.7.1.1.3.3.1.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.3"></plus><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1">subscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1"><minus id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.1"></minus><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2"><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.1">∇</ci><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2">𝛼</ci></apply><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3"><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.1">∇</ci><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2"><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.2.2">𝛼</ci></apply></apply></apply></apply><cn id="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.1.3">1</cn></apply><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2"><times id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.2"></times><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.3.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.3">𝜆</ci><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1">subscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1"><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.1">∇</ci><ci id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.1.1.1.2">𝛼</ci></apply></apply><cn id="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.3.3.1.1.2.1.3">1</cn></apply></apply></apply><apply id="S4.Ex5.m1.7.7.1.1.4.4.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4"><apply id="S4.Ex5.m1.7.7.1.1.4.4.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2">superscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.4.4.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.2.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2">subscript</csymbol><sum id="S4.Ex5.m1.7.7.1.1.4.4.2.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.2"></sum><apply id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3"><eq id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.1"></eq><ci id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.2">𝑘</ci><cn id="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.4.4.2.2.3.3">1</cn></apply></apply><cn id="S4.Ex5.m1.7.7.1.1.4.4.2.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.4.4.2.3">5</cn></apply><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1"><times id="S4.Ex5.m1.7.7.1.1.4.4.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.2"></times><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.1.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3">superscript</csymbol><cn id="S4.Ex5.m1.7.7.1.1.4.4.1.3.2.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.2">2</cn><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3"><minus id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.1"></minus><ci id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.2">𝑘</ci><cn id="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.4.4.1.3.3.3">1</cn></apply></apply><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1">subscript</csymbol><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1"><minus id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.1"></minus><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2"><times id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.1"></times><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.2">𝐿</ci><ci id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.Ex5.m1.5.5.cmml" xref="S4.Ex5.m1.5.5">𝛼</ci></apply><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3"><times id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.1"></times><apply id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S4.Ex5.m1.6.6.cmml" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.1.1.1.3.3.2"><ci id="S4.Ex5.m1.6.6.1.cmml" xref="S4.Ex5.m1.6.6.1">^</ci><ci id="S4.Ex5.m1.6.6.2.cmml" xref="S4.Ex5.m1.6.6.2">𝛼</ci></apply></apply></apply></apply><cn id="S4.Ex5.m1.7.7.1.1.4.4.1.1.3.cmml" type="integer" xref="S4.Ex5.m1.7.7.1.1.4.4.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.7c">\mathcal{L}_{\text{Mat}}=\left\|\alpha-\hat{\alpha}\right\|_{1,\mathcal{K}}+%
\left\|\alpha-\hat{\alpha}\right\|_{1,\mathcal{U}}+(\left\|\nabla\alpha-\nabla%
\hat{\alpha}\right\|_{1}+\lambda\left\|\nabla\alpha\right\|_{1})+\sum\nolimits%
_{k=1}^{5}2^{k-1}\left\|L^{k}(\alpha)-L^{k}(\hat{\alpha})\right\|_{1},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex5.m1.7d">caligraphic_L start_POSTSUBSCRIPT Mat end_POSTSUBSCRIPT = ∥ italic_α - over^ start_ARG italic_α end_ARG ∥ start_POSTSUBSCRIPT 1 , caligraphic_K end_POSTSUBSCRIPT + ∥ italic_α - over^ start_ARG italic_α end_ARG ∥ start_POSTSUBSCRIPT 1 , caligraphic_U end_POSTSUBSCRIPT + ( ∥ ∇ italic_α - ∇ over^ start_ARG italic_α end_ARG ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_λ ∥ ∇ italic_α ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT ∥ italic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_α ) - italic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( over^ start_ARG italic_α end_ARG ) ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p4.7">where <math alttext="\hat{\alpha}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m1.1"><semantics id="S4.SS2.p4.2.m1.1a"><mover accent="true" id="S4.SS2.p4.2.m1.1.1" xref="S4.SS2.p4.2.m1.1.1.cmml"><mi id="S4.SS2.p4.2.m1.1.1.2" xref="S4.SS2.p4.2.m1.1.1.2.cmml">α</mi><mo id="S4.SS2.p4.2.m1.1.1.1" xref="S4.SS2.p4.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m1.1b"><apply id="S4.SS2.p4.2.m1.1.1.cmml" xref="S4.SS2.p4.2.m1.1.1"><ci id="S4.SS2.p4.2.m1.1.1.1.cmml" xref="S4.SS2.p4.2.m1.1.1.1">^</ci><ci id="S4.SS2.p4.2.m1.1.1.2.cmml" xref="S4.SS2.p4.2.m1.1.1.2">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m1.1c">\hat{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m1.1d">over^ start_ARG italic_α end_ARG</annotation></semantics></math> is the predicted alpha mattes, <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m2.1"><semantics id="S4.SS2.p4.3.m2.1a"><mi id="S4.SS2.p4.3.m2.1.1" xref="S4.SS2.p4.3.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m2.1b"><ci id="S4.SS2.p4.3.m2.1.1.cmml" xref="S4.SS2.p4.3.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m2.1d">italic_α</annotation></semantics></math> is the ground truth, <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m3.1"><semantics id="S4.SS2.p4.4.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.4.m3.1.1" xref="S4.SS2.p4.4.m3.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m3.1b"><ci id="S4.SS2.p4.4.m3.1.1.cmml" xref="S4.SS2.p4.4.m3.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m3.1c">\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m3.1d">caligraphic_K</annotation></semantics></math> denotes the known region in trimap, <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m4.1"><semantics id="S4.SS2.p4.5.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.5.m4.1.1" xref="S4.SS2.p4.5.m4.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m4.1b"><ci id="S4.SS2.p4.5.m4.1.1.cmml" xref="S4.SS2.p4.5.m4.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m4.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m4.1d">caligraphic_U</annotation></semantics></math> denotes the unknown region in trimap, and <math alttext="L^{k}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m5.1"><semantics id="S4.SS2.p4.6.m5.1a"><mrow id="S4.SS2.p4.6.m5.1.2" xref="S4.SS2.p4.6.m5.1.2.cmml"><msup id="S4.SS2.p4.6.m5.1.2.2" xref="S4.SS2.p4.6.m5.1.2.2.cmml"><mi id="S4.SS2.p4.6.m5.1.2.2.2" xref="S4.SS2.p4.6.m5.1.2.2.2.cmml">L</mi><mi id="S4.SS2.p4.6.m5.1.2.2.3" xref="S4.SS2.p4.6.m5.1.2.2.3.cmml">k</mi></msup><mo id="S4.SS2.p4.6.m5.1.2.1" xref="S4.SS2.p4.6.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p4.6.m5.1.2.3.2" xref="S4.SS2.p4.6.m5.1.2.cmml"><mo id="S4.SS2.p4.6.m5.1.2.3.2.1" stretchy="false" xref="S4.SS2.p4.6.m5.1.2.cmml">(</mo><mo id="S4.SS2.p4.6.m5.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p4.6.m5.1.1.cmml">⋅</mo><mo id="S4.SS2.p4.6.m5.1.2.3.2.2" stretchy="false" xref="S4.SS2.p4.6.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m5.1b"><apply id="S4.SS2.p4.6.m5.1.2.cmml" xref="S4.SS2.p4.6.m5.1.2"><times id="S4.SS2.p4.6.m5.1.2.1.cmml" xref="S4.SS2.p4.6.m5.1.2.1"></times><apply id="S4.SS2.p4.6.m5.1.2.2.cmml" xref="S4.SS2.p4.6.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m5.1.2.2.1.cmml" xref="S4.SS2.p4.6.m5.1.2.2">superscript</csymbol><ci id="S4.SS2.p4.6.m5.1.2.2.2.cmml" xref="S4.SS2.p4.6.m5.1.2.2.2">𝐿</ci><ci id="S4.SS2.p4.6.m5.1.2.2.3.cmml" xref="S4.SS2.p4.6.m5.1.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p4.6.m5.1.1.cmml" xref="S4.SS2.p4.6.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m5.1c">L^{k}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m5.1d">italic_L start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> denotes the <math alttext="k^{th}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m6.1"><semantics id="S4.SS2.p4.7.m6.1a"><msup id="S4.SS2.p4.7.m6.1.1" xref="S4.SS2.p4.7.m6.1.1.cmml"><mi id="S4.SS2.p4.7.m6.1.1.2" xref="S4.SS2.p4.7.m6.1.1.2.cmml">k</mi><mrow id="S4.SS2.p4.7.m6.1.1.3" xref="S4.SS2.p4.7.m6.1.1.3.cmml"><mi id="S4.SS2.p4.7.m6.1.1.3.2" xref="S4.SS2.p4.7.m6.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p4.7.m6.1.1.3.1" xref="S4.SS2.p4.7.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p4.7.m6.1.1.3.3" xref="S4.SS2.p4.7.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m6.1b"><apply id="S4.SS2.p4.7.m6.1.1.cmml" xref="S4.SS2.p4.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m6.1.1.1.cmml" xref="S4.SS2.p4.7.m6.1.1">superscript</csymbol><ci id="S4.SS2.p4.7.m6.1.1.2.cmml" xref="S4.SS2.p4.7.m6.1.1.2">𝑘</ci><apply id="S4.SS2.p4.7.m6.1.1.3.cmml" xref="S4.SS2.p4.7.m6.1.1.3"><times id="S4.SS2.p4.7.m6.1.1.3.1.cmml" xref="S4.SS2.p4.7.m6.1.1.3.1"></times><ci id="S4.SS2.p4.7.m6.1.1.3.2.cmml" xref="S4.SS2.p4.7.m6.1.1.3.2">𝑡</ci><ci id="S4.SS2.p4.7.m6.1.1.3.3.cmml" xref="S4.SS2.p4.7.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m6.1c">k^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m6.1d">italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> output of the laplacian pyramid.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.3">Now we are ready to define the overall objective which is a combination of the three losses:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{\text{Mat}}+\lambda_{\text{R}}\mathcal{L}_{\text{Reg}%
}+\lambda_{\text{T}}\mathcal{L}_{\text{Trimap}}," class="ltx_Math" display="block" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.3.cmml"><msub id="S4.E1.m1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.1.1.3.2.2" xref="S4.E1.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S4.E1.m1.1.1.1.1.3.2.3" xref="S4.E1.m1.1.1.1.1.3.2.3a.cmml">Mat</mtext></msub><mo id="S4.E1.m1.1.1.1.1.3.1" xref="S4.E1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E1.m1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.3.3.cmml"><msub id="S4.E1.m1.1.1.1.1.3.3.2" xref="S4.E1.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E1.m1.1.1.1.1.3.3.2.2" xref="S4.E1.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mtext id="S4.E1.m1.1.1.1.1.3.3.2.3" xref="S4.E1.m1.1.1.1.1.3.3.2.3a.cmml">R</mtext></msub><mo id="S4.E1.m1.1.1.1.1.3.3.1" xref="S4.E1.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.E1.m1.1.1.1.1.3.3.3" xref="S4.E1.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.1.1.3.3.3.2" xref="S4.E1.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S4.E1.m1.1.1.1.1.3.3.3.3" xref="S4.E1.m1.1.1.1.1.3.3.3.3a.cmml">Reg</mtext></msub></mrow><mo id="S4.E1.m1.1.1.1.1.3.1a" xref="S4.E1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E1.m1.1.1.1.1.3.4" xref="S4.E1.m1.1.1.1.1.3.4.cmml"><msub id="S4.E1.m1.1.1.1.1.3.4.2" xref="S4.E1.m1.1.1.1.1.3.4.2.cmml"><mi id="S4.E1.m1.1.1.1.1.3.4.2.2" xref="S4.E1.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S4.E1.m1.1.1.1.1.3.4.2.3" xref="S4.E1.m1.1.1.1.1.3.4.2.3a.cmml">T</mtext></msub><mo id="S4.E1.m1.1.1.1.1.3.4.1" xref="S4.E1.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S4.E1.m1.1.1.1.1.3.4.3" xref="S4.E1.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.1.1.3.4.3.2" xref="S4.E1.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S4.E1.m1.1.1.1.1.3.4.3.3" xref="S4.E1.m1.1.1.1.1.3.4.3.3a.cmml">Trimap</mtext></msub></mrow></mrow></mrow><mo id="S4.E1.m1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><eq id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"></eq><ci id="S4.E1.m1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2">ℒ</ci><apply id="S4.E1.m1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.3"><plus id="S4.E1.m1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.1"></plus><apply id="S4.E1.m1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E1.m1.1.1.1.1.3.2.3a.cmml" xref="S4.E1.m1.1.1.1.1.3.2.3"><mtext id="S4.E1.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1.3.2.3">Mat</mtext></ci></apply><apply id="S4.E1.m1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3"><times id="S4.E1.m1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.1"></times><apply id="S4.E1.m1.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S4.E1.m1.1.1.1.1.3.3.2.3a.cmml" xref="S4.E1.m1.1.1.1.1.3.3.2.3"><mtext id="S4.E1.m1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1.3.3.2.3">R</mtext></ci></apply><apply id="S4.E1.m1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S4.E1.m1.1.1.1.1.3.3.3.3a.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.3"><mtext id="S4.E1.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1.3.3.3.3">Reg</mtext></ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.3.4.cmml" xref="S4.E1.m1.1.1.1.1.3.4"><times id="S4.E1.m1.1.1.1.1.3.4.1.cmml" xref="S4.E1.m1.1.1.1.1.3.4.1"></times><apply id="S4.E1.m1.1.1.1.1.3.4.2.cmml" xref="S4.E1.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.4.2.1.cmml" xref="S4.E1.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.4.2.2.cmml" xref="S4.E1.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="S4.E1.m1.1.1.1.1.3.4.2.3a.cmml" xref="S4.E1.m1.1.1.1.1.3.4.2.3"><mtext id="S4.E1.m1.1.1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1.3.4.2.3">T</mtext></ci></apply><apply id="S4.E1.m1.1.1.1.1.3.4.3.cmml" xref="S4.E1.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.4.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.4.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S4.E1.m1.1.1.1.1.3.4.3.3a.cmml" xref="S4.E1.m1.1.1.1.1.3.4.3.3"><mtext id="S4.E1.m1.1.1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1.3.4.3.3">Trimap</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\mathcal{L}=\mathcal{L}_{\text{Mat}}+\lambda_{\text{R}}\mathcal{L}_{\text{Reg}%
}+\lambda_{\text{T}}\mathcal{L}_{\text{Trimap}},</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT Mat end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT Reg end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT Trimap end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p5.2">where <math alttext="\lambda_{\text{R}}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3a.cmml">R</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝜆</ci><ci id="S4.SS2.p5.1.m1.1.1.3a.cmml" xref="S4.SS2.p5.1.m1.1.1.3"><mtext id="S4.SS2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p5.1.m1.1.1.3">R</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\lambda_{\text{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{T}}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝜆</ci><ci id="S4.SS2.p5.2.m2.1.1.3a.cmml" xref="S4.SS2.p5.2.m2.1.1.3"><mtext id="S4.SS2.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p5.2.m2.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\lambda_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math> are weights to balance the loss.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Quantitative results of our <span class="ltx_text" id="S4.T2.16.1" style="background-color:#DFDFDF;">SEMat</span> and other methods on six datasets, including P3M-500-NP, AIM-500, RefMatte-RW100, AM-2K, RWP636, and SIM. The <span class="ltx_text" id="S4.T2.17.2" style="background-color:#FFD9D9;">best</span> and <span class="ltx_text" id="S4.T2.18.3" style="background-color:#D9D9FF;">second best</span> are highlighted. “Impro.” denotes the average relative improvement on the five metrics compared with the baseline MatAny. </figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.12.12" style="width:397.5pt;height:303pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.6pt,46.9pt) scale(0.763250046015497,0.763250046015497) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.12.12.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.12.12.12.13.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.12.12.12.13.1.1" rowspan="2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.13.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.12.12.12.13.1.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.13.1.2.1">Pretraind</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="6" id="S4.T2.12.12.12.13.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.13.1.3.1">P3M-500-NP</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S4.T2.12.12.12.13.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.13.1.4.1">AIM-500</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib15" title="">2021b</a>)</cite>
</th>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T2.12.12.12.12.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.12.13.1">Backbone</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.1.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">SAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.2.2.2.2.2" style="padding-left:2.8pt;padding-right:2.8pt;">MSE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.2.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.3.3.3.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">MAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.4.4.4.4.4" style="padding-left:2.8pt;padding-right:2.8pt;">Grad<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.4.m1.1b"><ci id="S4.T2.4.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.5.5.5.5.5" style="padding-left:2.8pt;padding-right:2.8pt;">Conn<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.5.5.m1.1a"><mo id="S4.T2.5.5.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.5.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S4.T2.6.6.6.6.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.6.6.6.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.6.6.6.6.1.m1.1"><semantics id="S4.T2.6.6.6.6.6.1.m1.1a"><mo id="S4.T2.6.6.6.6.6.1.m1.1.1" stretchy="false" xref="S4.T2.6.6.6.6.6.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.6.1.m1.1b"><ci id="S4.T2.6.6.6.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.6.6.6.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.6.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.6.6.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.7.7.7.7.7" style="padding-left:2.8pt;padding-right:2.8pt;">SAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.7.7.7.7.7.m1.1"><semantics id="S4.T2.7.7.7.7.7.m1.1a"><mo id="S4.T2.7.7.7.7.7.m1.1.1" stretchy="false" xref="S4.T2.7.7.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.7.7.m1.1b"><ci id="S4.T2.7.7.7.7.7.m1.1.1.cmml" xref="S4.T2.7.7.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.7.7.7.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.8.8.8.8.8" style="padding-left:2.8pt;padding-right:2.8pt;">MSE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.8.8.8.8.8.m1.1"><semantics id="S4.T2.8.8.8.8.8.m1.1a"><mo id="S4.T2.8.8.8.8.8.m1.1.1" stretchy="false" xref="S4.T2.8.8.8.8.8.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.8.8.m1.1b"><ci id="S4.T2.8.8.8.8.8.m1.1.1.cmml" xref="S4.T2.8.8.8.8.8.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.8.8.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.8.8.8.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.9.9.9.9.9" style="padding-left:2.8pt;padding-right:2.8pt;">MAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.9.9.9.9.9.m1.1"><semantics id="S4.T2.9.9.9.9.9.m1.1a"><mo id="S4.T2.9.9.9.9.9.m1.1.1" stretchy="false" xref="S4.T2.9.9.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.9.9.m1.1b"><ci id="S4.T2.9.9.9.9.9.m1.1.1.cmml" xref="S4.T2.9.9.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.9.9.9.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.10.10.10.10.10" style="padding-left:2.8pt;padding-right:2.8pt;">Grad<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.10.10.10.10.10.m1.1"><semantics id="S4.T2.10.10.10.10.10.m1.1a"><mo id="S4.T2.10.10.10.10.10.m1.1.1" stretchy="false" xref="S4.T2.10.10.10.10.10.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.10.10.m1.1b"><ci id="S4.T2.10.10.10.10.10.m1.1.1.cmml" xref="S4.T2.10.10.10.10.10.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.10.10.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.10.10.10.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.11.11.11.11.11" style="padding-left:2.8pt;padding-right:2.8pt;">Conn<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.11.11.11.11.11.m1.1"><semantics id="S4.T2.11.11.11.11.11.m1.1a"><mo id="S4.T2.11.11.11.11.11.m1.1.1" stretchy="false" xref="S4.T2.11.11.11.11.11.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.11.11.m1.1b"><ci id="S4.T2.11.11.11.11.11.m1.1.1.cmml" xref="S4.T2.11.11.11.11.11.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.11.11.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.11.11.11.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T2.12.12.12.12.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.12.12.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.12.12.12.12.12.1.m1.1"><semantics id="S4.T2.12.12.12.12.12.1.m1.1a"><mo id="S4.T2.12.12.12.12.12.1.m1.1.1" stretchy="false" xref="S4.T2.12.12.12.12.12.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.12.12.1.m1.1b"><ci id="S4.T2.12.12.12.12.12.1.m1.1.1.cmml" xref="S4.T2.12.12.12.12.12.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.12.12.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.12.12.12.12.1.m1.1d">↑</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.12.12.12.14.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.14.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">SmartMat</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.14.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">DINOv2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">5.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0026</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0070</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.6" style="padding-left:2.8pt;padding-right:2.8pt;">8.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.7" style="padding-left:2.8pt;padding-right:2.8pt;">3.66</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.12.12.12.14.1.8" style="padding-left:2.8pt;padding-right:2.8pt;">58.9%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.9" style="padding-left:2.8pt;padding-right:2.8pt;">11.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0077</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0152</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.12" style="padding-left:2.8pt;padding-right:2.8pt;">14.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.13" style="padding-left:2.8pt;padding-right:2.8pt;">6.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.14.1.14" style="padding-left:2.8pt;padding-right:2.8pt;">56.2%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.15.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.15.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">MatAny</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.15.2.2" rowspan="3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.15.2.2.1">SAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">21.67</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0243</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0294</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">10.79</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">5.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.15.2.8" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.9" style="padding-left:2.8pt;padding-right:2.8pt;">38.71</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0428</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0516</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.12" style="padding-left:2.8pt;padding-right:2.8pt;">18.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.13" style="padding-left:2.8pt;padding-right:2.8pt;">10.05</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.15.2.14" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.16.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.16.3.1" style="padding-left:2.8pt;padding-right:2.8pt;">MAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.2" style="padding-left:2.8pt;padding-right:2.8pt;">7.54</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.0051</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0104</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.5" style="padding-left:2.8pt;padding-right:2.8pt;">6.35</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.6" style="padding-left:2.8pt;padding-right:2.8pt;">4.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.16.3.7" style="padding-left:2.8pt;padding-right:2.8pt;">53.7%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.8" style="padding-left:2.8pt;padding-right:2.8pt;">14.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.9" style="padding-left:2.8pt;padding-right:2.8pt;">0.0090</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0187</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.11" style="padding-left:2.8pt;padding-right:2.8pt;">10.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.12" style="padding-left:2.8pt;padding-right:2.8pt;">7.74</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.16.3.13" style="padding-left:2.8pt;padding-right:2.8pt;">54.3%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.17.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.17.4.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.2.1" style="background-color:#D9D9FF;">3.91</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.3.1" style="background-color:#D9D9FF;">0.0021</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.4.1" style="background-color:#D9D9FF;">0.0054</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.5.1" style="background-color:#D9D9FF;">5.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.6.1" style="background-color:#D9D9FF;">2.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.17.4.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.7.1" style="background-color:#D9D9FF;">69.8%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.8" style="padding-left:2.8pt;padding-right:2.8pt;">11.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.9" style="padding-left:2.8pt;padding-right:2.8pt;">0.0078</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0154</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.11.1" style="background-color:#D9D9FF;">7.76</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.17.4.12.1" style="background-color:#D9D9FF;">5.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.17.4.13" style="padding-left:2.8pt;padding-right:2.8pt;">64.1%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.18.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.18.5.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.18.5.2" style="padding-left:2.8pt;padding-right:2.8pt;">HQ-SAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.3.1" style="background-color:#FFD9D9;">3.42</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.4.1" style="background-color:#FFD9D9;">0.0016</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.5.1" style="background-color:#FFD9D9;">0.0048</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.6.1" style="background-color:#FFD9D9;">4.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.7.1" style="background-color:#FFD9D9;">2.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.18.5.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.8.1" style="background-color:#FFD9D9;">73.6%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.9.1" style="background-color:#FFD9D9;">10.01</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.10.1" style="background-color:#FFD9D9;">0.0061</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.11.1" style="background-color:#FFD9D9;">0.0134</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.12" style="padding-left:2.8pt;padding-right:2.8pt;">7.85</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.13.1" style="background-color:#FFD9D9;">5.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.18.5.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.18.5.14.1" style="background-color:#FFD9D9;">66.6%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.19.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.19.6.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.19.6.2" style="padding-left:2.8pt;padding-right:2.8pt;">SAM2</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.3" style="padding-left:2.8pt;padding-right:2.8pt;">4.28</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0027</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0060</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.6" style="padding-left:2.8pt;padding-right:2.8pt;">5.06</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.7" style="padding-left:2.8pt;padding-right:2.8pt;">3.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.19.6.8" style="padding-left:2.8pt;padding-right:2.8pt;">68.3%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.9.1" style="background-color:#D9D9FF;">10.52</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.10.1" style="background-color:#D9D9FF;">0.0069</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.11.1" style="background-color:#D9D9FF;">0.0142</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.12.1" style="background-color:#FFD9D9;">7.68</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.13" style="padding-left:2.8pt;padding-right:2.8pt;">5.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.19.6.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.19.6.14.1" style="background-color:#D9D9FF;">65.5%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.20.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T2.12.12.12.20.7.1" style="padding-left:2.8pt;padding-right:2.8pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="6" id="S4.T2.12.12.12.20.7.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.20.7.2.1">RefMatte-RW100</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.12.12.12.20.7.3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.20.7.3.1">AM-2K</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.21.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.21.8.1" style="padding-left:2.8pt;padding-right:2.8pt;">SmartMat</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.21.8.2" style="padding-left:2.8pt;padding-right:2.8pt;">DINOv2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.3" style="padding-left:2.8pt;padding-right:2.8pt;">11.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0143</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0168</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.6" style="padding-left:2.8pt;padding-right:2.8pt;">11.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.7" style="padding-left:2.8pt;padding-right:2.8pt;">1.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.12.12.12.21.8.8" style="padding-left:2.8pt;padding-right:2.8pt;">-17.4%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.9" style="padding-left:2.8pt;padding-right:2.8pt;">6.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0040</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0091</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.12" style="padding-left:2.8pt;padding-right:2.8pt;">10.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.13" style="padding-left:2.8pt;padding-right:2.8pt;">4.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.21.8.14" style="padding-left:2.8pt;padding-right:2.8pt;">-3.2%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.22.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.22.9.1" style="padding-left:2.8pt;padding-right:2.8pt;">MatAny</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.22.9.2" rowspan="3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.22.9.2.1">SAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.3" style="padding-left:2.8pt;padding-right:2.8pt;">9.19</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0107</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0132</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.6" style="padding-left:2.8pt;padding-right:2.8pt;">9.89</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.7" style="padding-left:2.8pt;padding-right:2.8pt;">1.92</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.22.9.8" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.9" style="padding-left:2.8pt;padding-right:2.8pt;">7.19</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0046</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0100</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.12" style="padding-left:2.8pt;padding-right:2.8pt;">7.06</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.13" style="padding-left:2.8pt;padding-right:2.8pt;">4.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.22.9.14" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.23.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.23.10.1" style="padding-left:2.8pt;padding-right:2.8pt;">MAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.2" style="padding-left:2.8pt;padding-right:2.8pt;">12.39</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.0130</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0178</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.5" style="padding-left:2.8pt;padding-right:2.8pt;">8.91</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.6" style="padding-left:2.8pt;padding-right:2.8pt;">2.34</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.23.10.7" style="padding-left:2.8pt;padding-right:2.8pt;">-20.6%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.8" style="padding-left:2.8pt;padding-right:2.8pt;">6.11</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.9" style="padding-left:2.8pt;padding-right:2.8pt;">0.0028</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0085</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.11" style="padding-left:2.8pt;padding-right:2.8pt;">6.09</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.12" style="padding-left:2.8pt;padding-right:2.8pt;">4.13</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.23.10.13" style="padding-left:2.8pt;padding-right:2.8pt;">16.9%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.24.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.24.11.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.2" style="padding-left:2.8pt;padding-right:2.8pt;">6.73</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.3.1" style="background-color:#D9D9FF;">0.0074</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0097</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.5" style="padding-left:2.8pt;padding-right:2.8pt;">6.13</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.6" style="padding-left:2.8pt;padding-right:2.8pt;">1.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.24.11.7" style="padding-left:2.8pt;padding-right:2.8pt;">28.0%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.8.1" style="background-color:#FFD9D9;">5.13</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.9.1" style="background-color:#FFD9D9;">0.0026</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.10.1" style="background-color:#FFD9D9;">0.0071</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.11.1" style="background-color:#D9D9FF;">4.78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.12" style="padding-left:2.8pt;padding-right:2.8pt;">3.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.24.11.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.24.11.13.1" style="background-color:#FFD9D9;">30.2%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.25.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.25.12.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.25.12.2" style="padding-left:2.8pt;padding-right:2.8pt;">HQ-SAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.3.1" style="background-color:#D9D9FF;">6.51</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.4.1" style="background-color:#D9D9FF;">0.0074</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.5.1" style="background-color:#D9D9FF;">0.0094</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.6.1" style="background-color:#D9D9FF;">5.89</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.7.1" style="background-color:#D9D9FF;">1.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.25.12.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.8.1" style="background-color:#D9D9FF;">32.4%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.9" style="padding-left:2.8pt;padding-right:2.8pt;">5.23</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.10.1" style="background-color:#FFD9D9;">0.0026</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0073</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.12" style="padding-left:2.8pt;padding-right:2.8pt;">4.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.13.1" style="background-color:#FFD9D9;">3.41</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.25.12.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.25.12.14.1" style="background-color:#D9D9FF;">29.6%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.26.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.26.13.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.26.13.2" style="padding-left:2.8pt;padding-right:2.8pt;">SAM2</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.3.1" style="background-color:#FFD9D9;">5.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.4.1" style="background-color:#FFD9D9;">0.0054</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.5.1" style="background-color:#FFD9D9;">0.0073</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.6.1" style="background-color:#FFD9D9;">5.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.7.1" style="background-color:#FFD9D9;">1.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.26.13.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.8.1" style="background-color:#FFD9D9;">43.7%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.9.1" style="background-color:#D9D9FF;">5.20</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.10.1" style="background-color:#D9D9FF;">0.0027</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.11.1" style="background-color:#D9D9FF;">0.0072</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.12.1" style="background-color:#FFD9D9;">4.71</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.13.1" style="background-color:#D9D9FF;">3.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.26.13.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.26.13.14.1" style="background-color:#D9D9FF;">29.6%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.27.14">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T2.12.12.12.27.14.1" style="padding-left:2.8pt;padding-right:2.8pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="6" id="S4.T2.12.12.12.27.14.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.27.14.2.1">RWP-636</span> <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib38" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.12.12.12.27.14.3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.12.12.12.27.14.3.1">SIM</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.28.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.28.15.1" style="padding-left:2.8pt;padding-right:2.8pt;">SmartMat</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.28.15.2" style="padding-left:2.8pt;padding-right:2.8pt;">DINOv2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.3" style="padding-left:2.8pt;padding-right:2.8pt;">17.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0102</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0210</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.6" style="padding-left:2.8pt;padding-right:2.8pt;">35.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.7" style="padding-left:2.8pt;padding-right:2.8pt;">13.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.12.12.12.28.15.8" style="padding-left:2.8pt;padding-right:2.8pt;">50.6%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.9" style="padding-left:2.8pt;padding-right:2.8pt;">51.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0448</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0689</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.12" style="padding-left:2.8pt;padding-right:2.8pt;">36.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.13" style="padding-left:2.8pt;padding-right:2.8pt;">22.97</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.28.15.14" style="padding-left:2.8pt;padding-right:2.8pt;">52.7%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.29.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.29.16.1" style="padding-left:2.8pt;padding-right:2.8pt;">MatAny</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.29.16.2" rowspan="3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.29.16.2.1">SAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.3" style="padding-left:2.8pt;padding-right:2.8pt;">55.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0566</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.5" style="padding-left:2.8pt;padding-right:2.8pt;">0.0656</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.6" style="padding-left:2.8pt;padding-right:2.8pt;">45.06</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.7" style="padding-left:2.8pt;padding-right:2.8pt;">15.18</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.29.16.8" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.9" style="padding-left:2.8pt;padding-right:2.8pt;">118.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.1273</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.1527</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.12" style="padding-left:2.8pt;padding-right:2.8pt;">77.86</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.13" style="padding-left:2.8pt;padding-right:2.8pt;">34.62</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.29.16.14" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.30.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.30.17.1" style="padding-left:2.8pt;padding-right:2.8pt;">MAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.2" style="padding-left:2.8pt;padding-right:2.8pt;">25.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.0161</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0302</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.5" style="padding-left:2.8pt;padding-right:2.8pt;">32.42</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.6" style="padding-left:2.8pt;padding-right:2.8pt;">16.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.30.17.7" style="padding-left:2.8pt;padding-right:2.8pt;">39.7%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.8" style="padding-left:2.8pt;padding-right:2.8pt;">56.76</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.9" style="padding-left:2.8pt;padding-right:2.8pt;">0.0418</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0754</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.11" style="padding-left:2.8pt;padding-right:2.8pt;">53.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.12" style="padding-left:2.8pt;padding-right:2.8pt;">29.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.30.17.13" style="padding-left:2.8pt;padding-right:2.8pt;">43.2%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.31.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.12.12.12.31.18.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.31.18.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.2" style="padding-left:2.8pt;padding-right:2.8pt;">16.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.3" style="padding-left:2.8pt;padding-right:2.8pt;">0.0102</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.4" style="padding-left:2.8pt;padding-right:2.8pt;">0.0204</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.5" style="padding-left:2.8pt;padding-right:2.8pt;">31.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.6" style="padding-left:2.8pt;padding-right:2.8pt;">13.24</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.31.18.7" style="padding-left:2.8pt;padding-right:2.8pt;">52.6%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.31.18.8.1" style="background-color:#D9D9FF;">23.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.31.18.9.1" style="background-color:#D9D9FF;">0.0103</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.31.18.10.1" style="background-color:#D9D9FF;">0.0310</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.11" style="padding-left:2.8pt;padding-right:2.8pt;">18.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.12" style="padding-left:2.8pt;padding-right:2.8pt;">17.69</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.31.18.13" style="padding-left:2.8pt;padding-right:2.8pt;">75.4%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.32.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.32.19.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.12.12.12.32.19.2" style="padding-left:2.8pt;padding-right:2.8pt;">HQ-SAM</th>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.3.1" style="background-color:#D9D9FF;">16.53</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.4.1" style="background-color:#D9D9FF;">0.0095</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.5.1" style="background-color:#D9D9FF;">0.0199</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.6.1" style="background-color:#D9D9FF;">31.64</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.7.1" style="background-color:#D9D9FF;">13.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.12.12.12.32.19.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.8.1" style="background-color:#D9D9FF;">53.4%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.9" style="padding-left:2.8pt;padding-right:2.8pt;">23.28</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.10" style="padding-left:2.8pt;padding-right:2.8pt;">0.0105</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.11" style="padding-left:2.8pt;padding-right:2.8pt;">0.0312</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.12.1" style="background-color:#D9D9FF;">17.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.13.1" style="background-color:#D9D9FF;">17.31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.12.32.19.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.32.19.14.1" style="background-color:#D9D9FF;">75.8%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12.12.33.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.12.12.12.33.20.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.12.12.12.33.20.2" style="padding-left:2.8pt;padding-right:2.8pt;">SAM2</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.3.1" style="background-color:#FFD9D9;">15.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.4.1" style="background-color:#FFD9D9;">0.0093</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.5.1" style="background-color:#FFD9D9;">0.0191</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.6.1" style="background-color:#FFD9D9;">30.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.7.1" style="background-color:#FFD9D9;">12.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.12.12.12.33.20.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.8.1" style="background-color:#FFD9D9;">55.1%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.9" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.9.1" style="background-color:#FFD9D9;">20.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.10" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.10.1" style="background-color:#FFD9D9;">0.0072</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.11" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.11.1" style="background-color:#FFD9D9;">0.0269</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.12" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.12.1" style="background-color:#FFD9D9;">17.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.13" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.13.1" style="background-color:#FFD9D9;">16.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.12.12.12.33.20.14" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T2.12.12.12.33.20.14.1" style="background-color:#FFD9D9;">77.8%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Datasets and Metrics.</span>
We employ the Distinction-646 <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib24" title="">2020</a>)</cite>, AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite>, Composition-1k <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite> adopted in SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, and our proposed COCO-Matting datasets for training. Evaluation is conducted across various benchmarks, encompassing P3M-500-NP <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>, RWP636 <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib38" title="">2021</a>)</cite>, and RefMatte-RW100 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> for human matting, AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite> for animal matting, AIM-500 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib15" title="">2021b</a>)</cite> for object matting, and SIM <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite> for synthetic image matting. We leverage five standard metrics for evaluation: Sum of Absolute Difference (SAD), Mean Squared Error (MSE), Mean Absolute Difference (MAD), Gradient (Grad), and Connectivity (Conn) <cite class="ltx_cite ltx_citemacro_citep">(Rhemann et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib26" title="">2009</a>)</cite>, where a lower value indicates superior performance. Additionally, we assess our approach on the HIM2K human instance matting dataset <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite> with the Instance Matting Quality (IMQ), where a higher value signifies a more favorable outcome. For fair comparison, all methods take images resized proportionally to 1024 resolution as input in evaluation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.2"><span class="ltx_text ltx_font_bold" id="S5.p2.2.1">Training Details.</span>
We initialize our network with SAM <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>)</cite>, HQ-SAM <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>)</cite>, and SAM2 <cite class="ltx_cite ltx_citemacro_citep">(Ravi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib25" title="">2024</a>)</cite>, respectively. The learnable modules are trained with 60k iterations and a batch size of 2 on one Nvidia L40S GPU. AdamW is chosen as the optimizer with a learning rate of 5e-5. The rank is set to 16 in LoRA. <math alttext="\lambda_{\text{R}}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">λ</mi><mtext id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3a.cmml">R</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝜆</ci><ci id="S5.p2.1.m1.1.1.3a.cmml" xref="S5.p2.1.m1.1.1.3"><mtext id="S5.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.p2.1.m1.1.1.3">R</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\lambda_{\text{R}}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{T}}" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><msub id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mi id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">λ</mi><mtext id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1">subscript</csymbol><ci id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">𝜆</ci><ci id="S5.p2.2.m2.1.1.3a.cmml" xref="S5.p2.2.m2.1.1.3"><mtext id="S5.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S5.p2.2.m2.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">\lambda_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math> are set to 0.2 and 0.05.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Results on Interactive Matting</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Comparison with SoTAs.</span> Here we train our proposed SEMat built upon three different pre-trained backbones (SAM, HQ-SAM, and SAM2) on our COCO-Matting dataset, and compare them with SoTAs such as MatAny <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib36" title="">2024b</a>)</cite>, MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite>, and SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.T2" title="Table 2 ‣ 4.2 SEMat Training Objective ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the quantitative results on six test datasets, and shows the superior performance of our proposed SEMat in all datasets as evidenced by the average relative improvement “Improv.” on widely used five metrics. Specifically, <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">(a)</span> building upon the same SAM, SEMat improves the baseline MatAny and MAM by significant overall relative improvement on six datasets. <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.2">(b)</span> Based on HQ-SAM and SAM2, our SEMat can further improve its SAM based counterpart. <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.3">(c)</span> Compared with previous SoTA SmartMat, our three SEMat versions always surpass it by a big margin. For instance, our HQ-SAM based SEMat makes 9.4%, 9.3%, 61.1%, 32.8%, 2.8%, and 13.1% relative improvement on the six datasets, which highlights the superiority and robustness of our SEMat.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="S5.F4.g1" src="x5.png" width="685"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Qualitative matting results of MAM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib13" title="">2024</a>)</cite>, SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, and our SEMat (SAM) on different datasets. See more matting results in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS4" title="A.4 Quantitative Results ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.4</span></a>.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.F4" title="Figure 4 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">4</span></a> shows a qualitative assessment.
Our SAM-based SEMat showcases superior detail preservation, such as animal and human hair in the first and second row. Meanwhile, the enhanced semantic understanding of our methods is evident with occlusions or similar color distributions between the foreground and background in the third row. For multi-instance matting in the fourth row, our SEMat is able to predict both net and human mattes. Also, our method achieves better performance in the perception of transparent objects in the fifth row. See more qualitative results in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS4" title="A.4 Quantitative Results ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.4</span></a>.</p>
</div>
<figure class="ltx_table ltx_figure_panel" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of different matting methods on the human instance matting HIM2K dataset. </figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S5.SS1.9.9" style="width:429.3pt;height:241.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.5pt,-39.6pt) scale(1.48950329397442,1.48950329397442) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.SS1.9.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.SS1.1.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.SS1.1.1.1.1.2" rowspan="2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.SS1.1.1.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.SS1.1.1.1.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">
<span class="ltx_text ltx_font_bold" id="S5.SS1.1.1.1.1.3.1">HIM2K</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.SS1.1.1.1.1.1" rowspan="2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.SS1.1.1.1.1.1.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS1.1.1.1.1.1.1.1.m1.1"><semantics id="S5.SS1.1.1.1.1.1.1.1.m1.1a"><mo id="S5.SS1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.SS1.1.1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.1.1.1.1.1.1.1.m1.1b"><ci id="S5.SS1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.SS1.1.1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></th>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.SS1.3.3.3.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{mad}}" class="ltx_Math" display="inline" id="S5.SS1.2.2.2.2.1.m1.1"><semantics id="S5.SS1.2.2.2.2.1.m1.1a"><msub id="S5.SS1.2.2.2.2.1.m1.1.1" xref="S5.SS1.2.2.2.2.1.m1.1.1.cmml"><mi id="S5.SS1.2.2.2.2.1.m1.1.1a" xref="S5.SS1.2.2.2.2.1.m1.1.1.cmml"></mi><mtext id="S5.SS1.2.2.2.2.1.m1.1.1.1" xref="S5.SS1.2.2.2.2.1.m1.1.1.1a.cmml">mad</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.2.2.2.2.1.m1.1b"><apply id="S5.SS1.2.2.2.2.1.m1.1.1.cmml" xref="S5.SS1.2.2.2.2.1.m1.1.1"><ci id="S5.SS1.2.2.2.2.1.m1.1.1.1a.cmml" xref="S5.SS1.2.2.2.2.1.m1.1.1.1"><mtext id="S5.SS1.2.2.2.2.1.m1.1.1.1.cmml" mathsize="70%" xref="S5.SS1.2.2.2.2.1.m1.1.1.1">mad</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.2.2.2.2.1.m1.1c">{}_{\text{mad}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.2.2.2.2.1.m1.1d">start_FLOATSUBSCRIPT mad end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS1.3.3.3.3.2.m2.1"><semantics id="S5.SS1.3.3.3.3.2.m2.1a"><mo id="S5.SS1.3.3.3.3.2.m2.1.1" stretchy="false" xref="S5.SS1.3.3.3.3.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.3.3.3.3.2.m2.1b"><ci id="S5.SS1.3.3.3.3.2.m2.1.1.cmml" xref="S5.SS1.3.3.3.3.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.3.3.3.3.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.3.3.3.3.2.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.SS1.5.5.5.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{mse}}" class="ltx_Math" display="inline" id="S5.SS1.4.4.4.4.3.m1.1"><semantics id="S5.SS1.4.4.4.4.3.m1.1a"><msub id="S5.SS1.4.4.4.4.3.m1.1.1" xref="S5.SS1.4.4.4.4.3.m1.1.1.cmml"><mi id="S5.SS1.4.4.4.4.3.m1.1.1a" xref="S5.SS1.4.4.4.4.3.m1.1.1.cmml"></mi><mtext id="S5.SS1.4.4.4.4.3.m1.1.1.1" xref="S5.SS1.4.4.4.4.3.m1.1.1.1a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.4.4.4.4.3.m1.1b"><apply id="S5.SS1.4.4.4.4.3.m1.1.1.cmml" xref="S5.SS1.4.4.4.4.3.m1.1.1"><ci id="S5.SS1.4.4.4.4.3.m1.1.1.1a.cmml" xref="S5.SS1.4.4.4.4.3.m1.1.1.1"><mtext id="S5.SS1.4.4.4.4.3.m1.1.1.1.cmml" mathsize="70%" xref="S5.SS1.4.4.4.4.3.m1.1.1.1">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.4.4.4.4.3.m1.1c">{}_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.4.4.4.4.3.m1.1d">start_FLOATSUBSCRIPT mse end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS1.5.5.5.5.4.m2.1"><semantics id="S5.SS1.5.5.5.5.4.m2.1a"><mo id="S5.SS1.5.5.5.5.4.m2.1.1" stretchy="false" xref="S5.SS1.5.5.5.5.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.5.5.5.5.4.m2.1b"><ci id="S5.SS1.5.5.5.5.4.m2.1.1.cmml" xref="S5.SS1.5.5.5.5.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.5.5.5.5.4.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.5.5.5.5.4.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.SS1.7.7.7.7.6" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{grad}}" class="ltx_Math" display="inline" id="S5.SS1.6.6.6.6.5.m1.1"><semantics id="S5.SS1.6.6.6.6.5.m1.1a"><msub id="S5.SS1.6.6.6.6.5.m1.1.1" xref="S5.SS1.6.6.6.6.5.m1.1.1.cmml"><mi id="S5.SS1.6.6.6.6.5.m1.1.1a" xref="S5.SS1.6.6.6.6.5.m1.1.1.cmml"></mi><mtext id="S5.SS1.6.6.6.6.5.m1.1.1.1" xref="S5.SS1.6.6.6.6.5.m1.1.1.1a.cmml">grad</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.6.6.6.6.5.m1.1b"><apply id="S5.SS1.6.6.6.6.5.m1.1.1.cmml" xref="S5.SS1.6.6.6.6.5.m1.1.1"><ci id="S5.SS1.6.6.6.6.5.m1.1.1.1a.cmml" xref="S5.SS1.6.6.6.6.5.m1.1.1.1"><mtext id="S5.SS1.6.6.6.6.5.m1.1.1.1.cmml" mathsize="70%" xref="S5.SS1.6.6.6.6.5.m1.1.1.1">grad</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.6.6.6.6.5.m1.1c">{}_{\text{grad}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.6.6.6.6.5.m1.1d">start_FLOATSUBSCRIPT grad end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS1.7.7.7.7.6.m2.1"><semantics id="S5.SS1.7.7.7.7.6.m2.1a"><mo id="S5.SS1.7.7.7.7.6.m2.1.1" stretchy="false" xref="S5.SS1.7.7.7.7.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.7.7.7.7.6.m2.1b"><ci id="S5.SS1.7.7.7.7.6.m2.1.1.cmml" xref="S5.SS1.7.7.7.7.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.7.7.7.7.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.7.7.7.7.6.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.SS1.9.9.9.9.8" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{conn}}" class="ltx_Math" display="inline" id="S5.SS1.8.8.8.8.7.m1.1"><semantics id="S5.SS1.8.8.8.8.7.m1.1a"><msub id="S5.SS1.8.8.8.8.7.m1.1.1" xref="S5.SS1.8.8.8.8.7.m1.1.1.cmml"><mi id="S5.SS1.8.8.8.8.7.m1.1.1a" xref="S5.SS1.8.8.8.8.7.m1.1.1.cmml"></mi><mtext id="S5.SS1.8.8.8.8.7.m1.1.1.1" xref="S5.SS1.8.8.8.8.7.m1.1.1.1a.cmml">conn</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.8.8.8.8.7.m1.1b"><apply id="S5.SS1.8.8.8.8.7.m1.1.1.cmml" xref="S5.SS1.8.8.8.8.7.m1.1.1"><ci id="S5.SS1.8.8.8.8.7.m1.1.1.1a.cmml" xref="S5.SS1.8.8.8.8.7.m1.1.1.1"><mtext id="S5.SS1.8.8.8.8.7.m1.1.1.1.cmml" mathsize="70%" xref="S5.SS1.8.8.8.8.7.m1.1.1.1">conn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.8.8.8.8.7.m1.1c">{}_{\text{conn}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.8.8.8.8.7.m1.1d">start_FLOATSUBSCRIPT conn end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS1.9.9.9.9.8.m2.1"><semantics id="S5.SS1.9.9.9.9.8.m2.1a"><mo id="S5.SS1.9.9.9.9.8.m2.1.1" stretchy="false" xref="S5.SS1.9.9.9.9.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.9.9.9.9.8.m2.1b"><ci id="S5.SS1.9.9.9.9.8.m2.1.1.cmml" xref="S5.SS1.9.9.9.9.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.9.9.9.9.8.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.9.9.9.9.8.m2.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.SS1.9.9.9.10.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.SS1.9.9.9.10.1.1" style="padding-left:1.4pt;padding-right:1.4pt;">MAM</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.SS1.9.9.9.10.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">53.99</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.SS1.9.9.9.10.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">67.17</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.SS1.9.9.9.10.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">62.46</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" id="S5.SS1.9.9.9.10.1.5" style="padding-left:1.4pt;padding-right:1.4pt;">56.11</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.SS1.9.9.9.10.1.6" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.11.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.SS1.9.9.9.11.2.1" style="padding-left:1.4pt;padding-right:1.4pt;">MatAny</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.11.2.2" style="padding-left:1.4pt;padding-right:1.4pt;">62.08</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.11.2.3" style="padding-left:1.4pt;padding-right:1.4pt;">73.24</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.11.2.4" style="padding-left:1.4pt;padding-right:1.4pt;">61.02</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.SS1.9.9.9.11.2.5" style="padding-left:1.4pt;padding-right:1.4pt;">65.62</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.11.2.6" style="padding-left:1.4pt;padding-right:1.4pt;">9.7%</td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.12.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.SS1.9.9.9.12.3.1" style="padding-left:1.4pt;padding-right:1.4pt;">SmartMat</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.12.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">66.29</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.12.3.3" style="padding-left:1.4pt;padding-right:1.4pt;">75.09</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.12.3.4" style="padding-left:1.4pt;padding-right:1.4pt;">60.27</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.SS1.9.9.9.12.3.5" style="padding-left:1.4pt;padding-right:1.4pt;">67.93</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.12.3.6" style="padding-left:1.4pt;padding-right:1.4pt;">13.0%</td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.13.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.SS1.9.9.9.13.4.1" style="padding-left:1.4pt;padding-right:1.4pt;">InstMatt</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.13.4.2" style="padding-left:1.4pt;padding-right:1.4pt;">71.06</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.13.4.3" style="padding-left:1.4pt;padding-right:1.4pt;">82.99</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.13.4.4" style="padding-left:1.4pt;padding-right:1.4pt;">74.92</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.SS1.9.9.9.13.4.5" style="padding-left:1.4pt;padding-right:1.4pt;">73.39</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.13.4.6" style="padding-left:1.4pt;padding-right:1.4pt;">26.5%</td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.14.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.SS1.9.9.9.14.5.1" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.14.5.1.1" style="background-color:#DFDFDF;">SEMat (SAM)</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.14.5.2" style="padding-left:1.4pt;padding-right:1.4pt;">76.25</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.14.5.3" style="padding-left:1.4pt;padding-right:1.4pt;">88.89</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.14.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">75.28</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.SS1.9.9.9.14.5.5" style="padding-left:1.4pt;padding-right:1.4pt;">80.33</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.14.5.6" style="padding-left:1.4pt;padding-right:1.4pt;">34.3%</td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.15.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.SS1.9.9.9.15.6.1" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.1.1" style="background-color:#DFDFDF;">SEMat (HQ-SAM)</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.15.6.2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.2.1" style="background-color:#D9D9FF;">76.67</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.15.6.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.3.1" style="background-color:#D9D9FF;">89.04</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.15.6.4" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.4.1" style="background-color:#D9D9FF;">75.76</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.SS1.9.9.9.15.6.5" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.5.1" style="background-color:#D9D9FF;">80.76</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.SS1.9.9.9.15.6.6" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.15.6.6.1" style="background-color:#D9D9FF;">34.9%</span></td>
</tr>
<tr class="ltx_tr" id="S5.SS1.9.9.9.16.7">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.SS1.9.9.9.16.7.1" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.1.1" style="background-color:#DFDFDF;">SEMat (SAM2)</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.SS1.9.9.9.16.7.2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.2.1" style="background-color:#FFD9D9;">77.32</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.SS1.9.9.9.16.7.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.3.1" style="background-color:#FFD9D9;">89.70</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.SS1.9.9.9.16.7.4" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.4.1" style="background-color:#FFD9D9;">76.31</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_r" id="S5.SS1.9.9.9.16.7.5" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.5.1" style="background-color:#FFD9D9;">81.52</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.SS1.9.9.9.16.7.6" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.SS1.9.9.9.16.7.6.1" style="background-color:#FFD9D9;">36.1%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Comparison of Human Instance Matting SoTAs.</span>
In interactive matting, BBox prompts are obtained from the alpha matte annotations, which are not available in instance matting. Therefore, we integrate the object detection network Grounding DINO <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib21" title="">2023</a>)</cite> for interactive matting methods, which outputs BBox for all “human” classes in each testing image. As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.T3" title="Table 3 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">3</span></a>, compared to the dedicated instance matting method InstMatt <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib31" title="">2022b</a>)</cite>, previous interactive matting methods are not ideal for instance distinguish and have a poor performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1">Our three SEMat versions achieve superiority in handling the complexities of human instance matting, and respectively show 5.8%, 7.4%, and 9.6% average improvement over the SoTA InstMatt. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.F5" title="Figure 5 ‣ A.4 Quantitative Results ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">5</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.SS4" title="A.4 Quantitative Results ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">A.4</span></a> provides a clearer visualized comparison. Our SEMat exhibits exceptional semantics understanding and high-quality edge matting in multi-instance samples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p6.1.1">Performance Improvement Analysis.</span>
In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.T5" title="Table 5 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">5</span></a>, we independently investigate the performance improvement made by our COCO-Matting dataset and SEMat framework. Specifically, we independently combine Distinction-646 <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib24" title="">2020</a>)</cite>, AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite>, Composition-1k <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib32" title="">2017</a>)</cite> datasets with P3M-10K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite> or RefMatte <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> or COCO-Matting dataset for training MAM and our SAM-based SEMat methods. <span class="ltx_text ltx_font_bold" id="S5.SS1.p6.1.2">(a)</span> By comparison, one can observe that with the same matting method, e.g., MAM or SEMat, our COCO-Matting dataset always guarantees much higher overall performance improvement, e.g., making 31.5% and 16.8% overall improvement than the runner-up on MAM or SEMat, respectively. The superiority of our COCO-Matting can be attributed to its rich and diverse set of human instance-level alpha mattes which yields better generalization and robustness on complex and varied scenarios in HIM2K. <span class="ltx_text ltx_font_bold" id="S5.SS1.p6.1.3">(b)</span> Building upon the same training datasets and the same SAM backbone, SEMat always surpasses MAM across the three settings, e.g., 45.1% overall improvement on the RefMatte-RW100 dataset.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.T5.9" style="width:230.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 4: </span>Benefits of different datasets on SAM-based MAM and our SEMat evaluated with HIM2K dataset. “Impro.” denotes the average relative improvement on the four metrics compared with the baseline “+ P3M-10K ”. 
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T5.1.1.1.2" rowspan="2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.3.1">Training</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="4" id="S5.T5.1.1.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">
<span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.4.1">HIM2K</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.1" rowspan="2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.1.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.1.1.1.1.1.1.m1.1"><semantics id="S5.T5.1.1.1.1.1.1.m1.1a"><mo id="S5.T5.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T5.1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.1.1.1.m1.1b"><ci id="S5.T5.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></th>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S5.T5.9.9.9.9" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.9.9.9.9.1">Dataset</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.T5.3.3.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{mad}}" class="ltx_Math" display="inline" id="S5.T5.2.2.2.1.m1.1"><semantics id="S5.T5.2.2.2.1.m1.1a"><msub id="S5.T5.2.2.2.1.m1.1.1" xref="S5.T5.2.2.2.1.m1.1.1.cmml"><mi id="S5.T5.2.2.2.1.m1.1.1a" xref="S5.T5.2.2.2.1.m1.1.1.cmml"></mi><mtext id="S5.T5.2.2.2.1.m1.1.1.1" xref="S5.T5.2.2.2.1.m1.1.1.1a.cmml">mad</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.1.m1.1b"><apply id="S5.T5.2.2.2.1.m1.1.1.cmml" xref="S5.T5.2.2.2.1.m1.1.1"><ci id="S5.T5.2.2.2.1.m1.1.1.1a.cmml" xref="S5.T5.2.2.2.1.m1.1.1.1"><mtext id="S5.T5.2.2.2.1.m1.1.1.1.cmml" mathsize="70%" xref="S5.T5.2.2.2.1.m1.1.1.1">mad</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.1.m1.1c">{}_{\text{mad}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.2.2.2.1.m1.1d">start_FLOATSUBSCRIPT mad end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.3.3.3.2.m2.1"><semantics id="S5.T5.3.3.3.2.m2.1a"><mo id="S5.T5.3.3.3.2.m2.1.1" stretchy="false" xref="S5.T5.3.3.3.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.3.2.m2.1b"><ci id="S5.T5.3.3.3.2.m2.1.1.cmml" xref="S5.T5.3.3.3.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.3.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.3.3.3.2.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.T5.5.5.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{mse}}" class="ltx_Math" display="inline" id="S5.T5.4.4.4.3.m1.1"><semantics id="S5.T5.4.4.4.3.m1.1a"><msub id="S5.T5.4.4.4.3.m1.1.1" xref="S5.T5.4.4.4.3.m1.1.1.cmml"><mi id="S5.T5.4.4.4.3.m1.1.1a" xref="S5.T5.4.4.4.3.m1.1.1.cmml"></mi><mtext id="S5.T5.4.4.4.3.m1.1.1.1" xref="S5.T5.4.4.4.3.m1.1.1.1a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.4.3.m1.1b"><apply id="S5.T5.4.4.4.3.m1.1.1.cmml" xref="S5.T5.4.4.4.3.m1.1.1"><ci id="S5.T5.4.4.4.3.m1.1.1.1a.cmml" xref="S5.T5.4.4.4.3.m1.1.1.1"><mtext id="S5.T5.4.4.4.3.m1.1.1.1.cmml" mathsize="70%" xref="S5.T5.4.4.4.3.m1.1.1.1">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.4.3.m1.1c">{}_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.4.4.4.3.m1.1d">start_FLOATSUBSCRIPT mse end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.5.5.5.4.m2.1"><semantics id="S5.T5.5.5.5.4.m2.1a"><mo id="S5.T5.5.5.5.4.m2.1.1" stretchy="false" xref="S5.T5.5.5.5.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.5.5.5.4.m2.1b"><ci id="S5.T5.5.5.5.4.m2.1.1.cmml" xref="S5.T5.5.5.5.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.5.5.4.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.5.5.5.4.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S5.T5.7.7.7.6" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{grad}}" class="ltx_Math" display="inline" id="S5.T5.6.6.6.5.m1.1"><semantics id="S5.T5.6.6.6.5.m1.1a"><msub id="S5.T5.6.6.6.5.m1.1.1" xref="S5.T5.6.6.6.5.m1.1.1.cmml"><mi id="S5.T5.6.6.6.5.m1.1.1a" xref="S5.T5.6.6.6.5.m1.1.1.cmml"></mi><mtext id="S5.T5.6.6.6.5.m1.1.1.1" xref="S5.T5.6.6.6.5.m1.1.1.1a.cmml">grad</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.6.6.6.5.m1.1b"><apply id="S5.T5.6.6.6.5.m1.1.1.cmml" xref="S5.T5.6.6.6.5.m1.1.1"><ci id="S5.T5.6.6.6.5.m1.1.1.1a.cmml" xref="S5.T5.6.6.6.5.m1.1.1.1"><mtext id="S5.T5.6.6.6.5.m1.1.1.1.cmml" mathsize="70%" xref="S5.T5.6.6.6.5.m1.1.1.1">grad</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.6.6.5.m1.1c">{}_{\text{grad}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.6.6.6.5.m1.1d">start_FLOATSUBSCRIPT grad end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.7.7.7.6.m2.1"><semantics id="S5.T5.7.7.7.6.m2.1a"><mo id="S5.T5.7.7.7.6.m2.1.1" stretchy="false" xref="S5.T5.7.7.7.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.7.7.7.6.m2.1b"><ci id="S5.T5.7.7.7.6.m2.1.1.cmml" xref="S5.T5.7.7.7.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.7.7.7.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.7.7.7.6.m2.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T5.9.9.9.8" style="padding-left:1.4pt;padding-right:1.4pt;">IMQ<math alttext="{}_{\text{conn}}" class="ltx_Math" display="inline" id="S5.T5.8.8.8.7.m1.1"><semantics id="S5.T5.8.8.8.7.m1.1a"><msub id="S5.T5.8.8.8.7.m1.1.1" xref="S5.T5.8.8.8.7.m1.1.1.cmml"><mi id="S5.T5.8.8.8.7.m1.1.1a" xref="S5.T5.8.8.8.7.m1.1.1.cmml"></mi><mtext id="S5.T5.8.8.8.7.m1.1.1.1" xref="S5.T5.8.8.8.7.m1.1.1.1a.cmml">conn</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.8.8.8.7.m1.1b"><apply id="S5.T5.8.8.8.7.m1.1.1.cmml" xref="S5.T5.8.8.8.7.m1.1.1"><ci id="S5.T5.8.8.8.7.m1.1.1.1a.cmml" xref="S5.T5.8.8.8.7.m1.1.1.1"><mtext id="S5.T5.8.8.8.7.m1.1.1.1.cmml" mathsize="70%" xref="S5.T5.8.8.8.7.m1.1.1.1">conn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.8.8.8.7.m1.1c">{}_{\text{conn}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.8.8.8.7.m1.1d">start_FLOATSUBSCRIPT conn end_FLOATSUBSCRIPT</annotation></semantics></math><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.9.9.9.8.m2.1"><semantics id="S5.T5.9.9.9.8.m2.1a"><mo id="S5.T5.9.9.9.8.m2.1.1" stretchy="false" xref="S5.T5.9.9.9.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.9.9.9.8.m2.1b"><ci id="S5.T5.9.9.9.8.m2.1.1.cmml" xref="S5.T5.9.9.9.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.9.9.9.8.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.9.9.9.8.m2.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.9.9.10.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T5.9.9.10.1.1" rowspan="3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.10.1.1.1">MAM</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.9.9.10.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">+ P3M-10K</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T5.9.9.10.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">39.11</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T5.9.9.10.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">46.56</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T5.9.9.10.1.5" style="padding-left:1.4pt;padding-right:1.4pt;">47.80</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.9.9.10.1.6" style="padding-left:1.4pt;padding-right:1.4pt;">40.51</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T5.9.9.10.1.7" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.11.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.9.9.11.2.1" style="padding-left:1.4pt;padding-right:1.4pt;">+ RefMatte</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.11.2.2" style="padding-left:1.4pt;padding-right:1.4pt;">59.58</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.11.2.3" style="padding-left:1.4pt;padding-right:1.4pt;">72.62</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.11.2.4" style="padding-left:1.4pt;padding-right:1.4pt;">64.98</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.T5.9.9.11.2.5" style="padding-left:1.4pt;padding-right:1.4pt;">61.80</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.11.2.6" style="padding-left:1.4pt;padding-right:1.4pt;">49.2%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.12.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.9.9.12.3.1" style="padding-left:1.4pt;padding-right:1.4pt;">+ COCO-Mat.</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.12.3.2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.12.3.2.1" style="background-color:#D9D9FF;">75.23</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.12.3.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.12.3.3.1" style="background-color:#D9D9FF;">87.04</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.12.3.4" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.12.3.4.1" style="background-color:#D9D9FF;">72.50</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.T5.9.9.12.3.5" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.12.3.5.1" style="background-color:#D9D9FF;">77.65</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.12.3.6" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.12.3.6.1" style="background-color:#D9D9FF;">80.7%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.13.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T5.9.9.13.4.1" rowspan="3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.13.4.1.1" style="background-color:#DFDFDF;">SEMat</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.9.9.13.4.2" style="padding-left:1.4pt;padding-right:1.4pt;">+ P3M-10K</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.13.4.3" style="padding-left:1.4pt;padding-right:1.4pt;">68.62</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.13.4.4" style="padding-left:1.4pt;padding-right:1.4pt;">80.56</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.13.4.5" style="padding-left:1.4pt;padding-right:1.4pt;">72.03</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.T5.9.9.13.4.6" style="padding-left:1.4pt;padding-right:1.4pt;">72.46</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.13.4.7" style="padding-left:1.4pt;padding-right:1.4pt;">69.5%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.14.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.9.9.14.5.1" style="padding-left:1.4pt;padding-right:1.4pt;">+ RefMatte</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.14.5.2" style="padding-left:1.4pt;padding-right:1.4pt;">69.20</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.14.5.3" style="padding-left:1.4pt;padding-right:1.4pt;">81.17</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.14.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">70.29</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" id="S5.T5.9.9.14.5.5" style="padding-left:1.4pt;padding-right:1.4pt;">72.83</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T5.9.9.14.5.6" style="padding-left:1.4pt;padding-right:1.4pt;">69.5%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.9.9.15.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T5.9.9.15.6.1" style="padding-left:1.4pt;padding-right:1.4pt;">+ COCO-Mat.</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T5.9.9.15.6.2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.15.6.2.1" style="background-color:#FFD9D9;">76.67</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T5.9.9.15.6.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.15.6.3.1" style="background-color:#FFD9D9;">89.04</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T5.9.9.15.6.4" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.15.6.4.1" style="background-color:#FFD9D9;">75.76</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_r" id="S5.T5.9.9.15.6.5" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.15.6.5.1" style="background-color:#FFD9D9;">80.76</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T5.9.9.15.6.6" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="S5.T5.9.9.15.6.6.1" style="background-color:#FFD9D9;">86.3%</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.T5.17" style="width:151.0pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span>Effect investigation of hyperparameters <math alttext="\lambda_{\text{R}}" class="ltx_Math" display="inline" id="S5.T5.12.3.m1.1"><semantics id="S5.T5.12.3.m1.1b"><msub id="S5.T5.12.3.m1.1.1" xref="S5.T5.12.3.m1.1.1.cmml"><mi id="S5.T5.12.3.m1.1.1.2" xref="S5.T5.12.3.m1.1.1.2.cmml">λ</mi><mtext id="S5.T5.12.3.m1.1.1.3" xref="S5.T5.12.3.m1.1.1.3a.cmml">R</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.12.3.m1.1c"><apply id="S5.T5.12.3.m1.1.1.cmml" xref="S5.T5.12.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.12.3.m1.1.1.1.cmml" xref="S5.T5.12.3.m1.1.1">subscript</csymbol><ci id="S5.T5.12.3.m1.1.1.2.cmml" xref="S5.T5.12.3.m1.1.1.2">𝜆</ci><ci id="S5.T5.12.3.m1.1.1.3a.cmml" xref="S5.T5.12.3.m1.1.1.3"><mtext id="S5.T5.12.3.m1.1.1.3.cmml" mathsize="70%" xref="S5.T5.12.3.m1.1.1.3">R</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.12.3.m1.1d">\lambda_{\text{R}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.12.3.m1.1e">italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{T}}" class="ltx_Math" display="inline" id="S5.T5.13.4.m2.1"><semantics id="S5.T5.13.4.m2.1b"><msub id="S5.T5.13.4.m2.1.1" xref="S5.T5.13.4.m2.1.1.cmml"><mi id="S5.T5.13.4.m2.1.1.2" xref="S5.T5.13.4.m2.1.1.2.cmml">λ</mi><mtext id="S5.T5.13.4.m2.1.1.3" xref="S5.T5.13.4.m2.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.13.4.m2.1c"><apply id="S5.T5.13.4.m2.1.1.cmml" xref="S5.T5.13.4.m2.1.1"><csymbol cd="ambiguous" id="S5.T5.13.4.m2.1.1.1.cmml" xref="S5.T5.13.4.m2.1.1">subscript</csymbol><ci id="S5.T5.13.4.m2.1.1.2.cmml" xref="S5.T5.13.4.m2.1.1.2">𝜆</ci><ci id="S5.T5.13.4.m2.1.1.3a.cmml" xref="S5.T5.13.4.m2.1.1.3"><mtext id="S5.T5.13.4.m2.1.1.3.cmml" mathsize="70%" xref="S5.T5.13.4.m2.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.13.4.m2.1d">\lambda_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.13.4.m2.1e">italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math> in the training loss (<a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.E1" title="In 4.2 SEMat Training Objective ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1</span></a>). When adjusting one hyperparameter, another one uses the value in the gray background and always remains unchanged.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.17.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.14.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T5.14.5.1.1" style="padding-left:2.3pt;padding-right:2.3pt;"><math alttext="\lambda_{\text{T}}" class="ltx_Math" display="inline" id="S5.T5.14.5.1.1.m1.1"><semantics id="S5.T5.14.5.1.1.m1.1a"><msub id="S5.T5.14.5.1.1.m1.1.1" xref="S5.T5.14.5.1.1.m1.1.1.cmml"><mi id="S5.T5.14.5.1.1.m1.1.1.2" xref="S5.T5.14.5.1.1.m1.1.1.2.cmml">λ</mi><mtext id="S5.T5.14.5.1.1.m1.1.1.3" xref="S5.T5.14.5.1.1.m1.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.14.5.1.1.m1.1b"><apply id="S5.T5.14.5.1.1.m1.1.1.cmml" xref="S5.T5.14.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.14.5.1.1.m1.1.1.1.cmml" xref="S5.T5.14.5.1.1.m1.1.1">subscript</csymbol><ci id="S5.T5.14.5.1.1.m1.1.1.2.cmml" xref="S5.T5.14.5.1.1.m1.1.1.2">𝜆</ci><ci id="S5.T5.14.5.1.1.m1.1.1.3a.cmml" xref="S5.T5.14.5.1.1.m1.1.1.3"><mtext id="S5.T5.14.5.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.T5.14.5.1.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.14.5.1.1.m1.1c">\lambda_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.14.5.1.1.m1.1d">italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.14.5.1.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.01</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.14.5.1.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.025</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.14.5.1.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.14.5.1.4.1" style="background-color:#DFDFDF;">0.05</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.14.5.1.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.075</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.14.5.1.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.1</th>
</tr>
<tr class="ltx_tr" id="S5.T5.15.6.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.15.6.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">Avg. SAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T5.15.6.2.1.m1.1"><semantics id="S5.T5.15.6.2.1.m1.1a"><mo id="S5.T5.15.6.2.1.m1.1.1" stretchy="false" xref="S5.T5.15.6.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T5.15.6.2.1.m1.1b"><ci id="S5.T5.15.6.2.1.m1.1.1.cmml" xref="S5.T5.15.6.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.15.6.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.15.6.2.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.15.6.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">6.92</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.15.6.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">6.68</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.15.6.2.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.15.6.2.4.1" style="background-color:#FFD9D9;">6.29</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.15.6.2.5" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.15.6.2.5.1" style="background-color:#D9D9FF;">6.61</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.15.6.2.6" style="padding-left:2.3pt;padding-right:2.3pt;">6.63</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.16.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T5.16.7.3.1" style="padding-left:2.3pt;padding-right:2.3pt;"><math alttext="\lambda_{\text{R}}" class="ltx_Math" display="inline" id="S5.T5.16.7.3.1.m1.1"><semantics id="S5.T5.16.7.3.1.m1.1a"><msub id="S5.T5.16.7.3.1.m1.1.1" xref="S5.T5.16.7.3.1.m1.1.1.cmml"><mi id="S5.T5.16.7.3.1.m1.1.1.2" xref="S5.T5.16.7.3.1.m1.1.1.2.cmml">λ</mi><mtext id="S5.T5.16.7.3.1.m1.1.1.3" xref="S5.T5.16.7.3.1.m1.1.1.3a.cmml">R</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T5.16.7.3.1.m1.1b"><apply id="S5.T5.16.7.3.1.m1.1.1.cmml" xref="S5.T5.16.7.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T5.16.7.3.1.m1.1.1.1.cmml" xref="S5.T5.16.7.3.1.m1.1.1">subscript</csymbol><ci id="S5.T5.16.7.3.1.m1.1.1.2.cmml" xref="S5.T5.16.7.3.1.m1.1.1.2">𝜆</ci><ci id="S5.T5.16.7.3.1.m1.1.1.3a.cmml" xref="S5.T5.16.7.3.1.m1.1.1.3"><mtext id="S5.T5.16.7.3.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.T5.16.7.3.1.m1.1.1.3">R</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.16.7.3.1.m1.1c">\lambda_{\text{R}}</annotation><annotation encoding="application/x-llamapun" id="S5.T5.16.7.3.1.m1.1d">italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.16.7.3.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.16.7.3.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.15</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.16.7.3.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.16.7.3.4.1" style="background-color:#DFDFDF;">0.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.16.7.3.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.25</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.16.7.3.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.30</td>
</tr>
<tr class="ltx_tr" id="S5.T5.17.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T5.17.8.4.1" style="padding-left:2.3pt;padding-right:2.3pt;">Avg. SAD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T5.17.8.4.1.m1.1"><semantics id="S5.T5.17.8.4.1.m1.1a"><mo id="S5.T5.17.8.4.1.m1.1.1" stretchy="false" xref="S5.T5.17.8.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T5.17.8.4.1.m1.1b"><ci id="S5.T5.17.8.4.1.m1.1.1.cmml" xref="S5.T5.17.8.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.17.8.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.17.8.4.1.m1.1d">↓</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.17.8.4.2" style="padding-left:2.3pt;padding-right:2.3pt;">6.68</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.17.8.4.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.17.8.4.3.1" style="background-color:#D9D9FF;">6.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.17.8.4.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T5.17.8.4.4.1" style="background-color:#FFD9D9;">6.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.17.8.4.5" style="padding-left:2.3pt;padding-right:2.3pt;">6.70</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.17.8.4.6" style="padding-left:2.3pt;padding-right:2.3pt;">6.64</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation study of different components in dataset, network, and training, evaluated with SAD metrics <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.2.m1.1"><semantics id="S5.T6.2.m1.1b"><mo id="S5.T6.2.m1.1.1" stretchy="false" xref="S5.T6.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.2.m1.1c"><ci id="S5.T6.2.m1.1.1.cmml" xref="S5.T6.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.2.m1.1e">↓</annotation></semantics></math> on four datasets. “Impro.” denotes the average relative improvement on the “Avg.” (average) metric compared with the baseline. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top ltx_transformed_outer" id="S5.T6.4.2" style="width:190.8pt;height:213.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.4pt,-34.6pt) scale(1.48105026041371,1.48105026041371) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T6.4.2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.4.2.2.3.1">
<td class="ltx_td ltx_align_center" colspan="6" id="S5.T6.4.2.2.3.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.2.2.3.1.1.1">(a) COCO Mask</span></td>
<td class="ltx_td" id="S5.T6.4.2.2.3.1.2" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.2">
<td class="ltx_td ltx_border_r ltx_border_tt" id="S5.T6.4.2.2.2.3" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.2.2.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">P3M</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.2.2.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">AIM</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.2.2.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">RW100</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T6.4.2.2.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">AM</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.3.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.3.1.1.1.1.1">Avg.<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.3.1.1.1.1.1.m1.1"><semantics id="S5.T6.3.1.1.1.1.1.m1.1a"><mo id="S5.T6.3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T6.3.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.3.1.1.1.1.1.m1.1b"><ci id="S5.T6.3.1.1.1.1.1.m1.1.1.cmml" xref="S5.T6.3.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.3.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.2.2.2.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.2.2.2.2.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.4.2.2.2.2.1.m1.1"><semantics id="S5.T6.4.2.2.2.2.1.m1.1a"><mo id="S5.T6.4.2.2.2.2.1.m1.1.1" stretchy="false" xref="S5.T6.4.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.4.2.2.2.2.1.m1.1b"><ci id="S5.T6.4.2.2.2.2.1.m1.1.1.cmml" xref="S5.T6.4.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.4.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.4.2.2.4.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4.2.2" style="padding-left:2.8pt;padding-right:2.8pt;">27.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">32.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">42.11</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.4.2.2.4.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">17.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">29.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.4.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.5.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.4.2.2.5.3.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ COCO Mask</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.5.3.2" style="padding-left:2.8pt;padding-right:2.8pt;">14.80</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.5.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">32.02</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.5.3.4" style="padding-left:2.8pt;padding-right:2.8pt;">35.62</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.4.2.2.5.3.5" style="padding-left:2.8pt;padding-right:2.8pt;">23.91</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.5.3.6" style="padding-left:2.8pt;padding-right:2.8pt;">26.59</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.5.3.7" style="padding-left:2.8pt;padding-right:2.8pt;">11.1%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.6.4">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S5.T6.4.2.2.6.4.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.4.2.2.6.4.1.1">(b) Network</span></td>
<td class="ltx_td ltx_border_t" id="S5.T6.4.2.2.6.4.2" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.7.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.4.2.2.7.5.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7.5.2" style="padding-left:2.8pt;padding-right:2.8pt;">9.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7.5.3" style="padding-left:2.8pt;padding-right:2.8pt;">17.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7.5.4" style="padding-left:2.8pt;padding-right:2.8pt;">12.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.4.2.2.7.5.5" style="padding-left:2.8pt;padding-right:2.8pt;">7.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7.5.6" style="padding-left:2.8pt;padding-right:2.8pt;">11.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.2.2.7.5.7" style="padding-left:2.8pt;padding-right:2.8pt;">60.0%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.8.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.4.2.2.8.6.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Mat. Tok.&amp;Ada.</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.8.6.2" style="padding-left:2.8pt;padding-right:2.8pt;">10.69</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.8.6.3" style="padding-left:2.8pt;padding-right:2.8pt;">15.64</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.8.6.4" style="padding-left:2.8pt;padding-right:2.8pt;">10.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.4.2.2.8.6.5" style="padding-left:2.8pt;padding-right:2.8pt;">6.47</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.8.6.6" style="padding-left:2.8pt;padding-right:2.8pt;">10.83</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.2.2.8.6.7" style="padding-left:2.8pt;padding-right:2.8pt;">63.8%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.2.2.9.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T6.4.2.2.9.7.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Prom. Enhan.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.2.2.9.7.2" style="padding-left:2.8pt;padding-right:2.8pt;">9.78</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.2.2.9.7.3" style="padding-left:2.8pt;padding-right:2.8pt;">16.12</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.2.2.9.7.4" style="padding-left:2.8pt;padding-right:2.8pt;">9.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T6.4.2.2.9.7.5" style="padding-left:2.8pt;padding-right:2.8pt;">5.99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.2.2.9.7.6" style="padding-left:2.8pt;padding-right:2.8pt;">10.29</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.2.2.9.7.7" style="padding-left:2.8pt;padding-right:2.8pt;">65.6%</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.T6.6" style="width:190.8pt;">
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T6.6.2" style="width:433.6pt;height:199.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(80.0pt,-36.9pt) scale(1.58528187005525,1.58528187005525) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T6.6.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T6.6.2.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="6" id="S5.T6.6.2.2.3.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.6.2.2.3.1.1.1">(c) Dataset</span></th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T6.6.2.2.3.1.2" style="padding-left:2.8pt;padding-right:2.8pt;"></th>
</tr>
<tr class="ltx_tr" id="S5.T6.6.2.2.2">
<th class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T6.6.2.2.2.3" style="padding-left:2.8pt;padding-right:2.8pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.6.2.2.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">P3M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.6.2.2.2.5" style="padding-left:2.8pt;padding-right:2.8pt;">AIM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.6.2.2.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">RW100</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T6.6.2.2.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">AM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.5.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.5.1.1.1.1.1">Avg.<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.5.1.1.1.1.1.m1.1"><semantics id="S5.T6.5.1.1.1.1.1.m1.1a"><mo id="S5.T6.5.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T6.5.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.5.1.1.1.1.1.m1.1b"><ci id="S5.T6.5.1.1.1.1.1.m1.1.1.cmml" xref="S5.T6.5.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.5.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.6.2.2.2.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.6.2.2.2.2.1">Impro.<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.6.2.2.2.2.1.m1.1"><semantics id="S5.T6.6.2.2.2.2.1.m1.1a"><mo id="S5.T6.6.2.2.2.2.1.m1.1.1" stretchy="false" xref="S5.T6.6.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.6.2.2.2.2.1.m1.1b"><ci id="S5.T6.6.2.2.2.2.1.m1.1.1.cmml" xref="S5.T6.6.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.6.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.6.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.6.2.2.4.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.6.2.2.4.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Acc. Fusion</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.4.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">6.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.4.1.3" style="padding-left:2.8pt;padding-right:2.8pt;">15.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.4.1.4" style="padding-left:2.8pt;padding-right:2.8pt;">9.01</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.6.2.2.4.1.5" style="padding-left:2.8pt;padding-right:2.8pt;">6.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.4.1.6" style="padding-left:2.8pt;padding-right:2.8pt;">9.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.4.1.7" style="padding-left:2.8pt;padding-right:2.8pt;">68.4%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.6.2.2.5.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.6.2.2.5.2.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Mask-to-Mat.</td>
<td class="ltx_td ltx_align_center" id="S5.T6.6.2.2.5.2.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.5.2.2.1" style="background-color:#D9D9FF;">3.76</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.6.2.2.5.2.3" style="padding-left:2.8pt;padding-right:2.8pt;">11.37</td>
<td class="ltx_td ltx_align_center" id="S5.T6.6.2.2.5.2.4" style="padding-left:2.8pt;padding-right:2.8pt;">7.09</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.6.2.2.5.2.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.5.2.5.1" style="background-color:#D9D9FF;">5.23</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.6.2.2.5.2.6" style="padding-left:2.8pt;padding-right:2.8pt;">6.86</td>
<td class="ltx_td ltx_align_center" id="S5.T6.6.2.2.5.2.7" style="padding-left:2.8pt;padding-right:2.8pt;">77.1%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.6.2.2.6.3">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S5.T6.6.2.2.6.3.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.6.2.2.6.3.1.1">(d) Training</span></td>
<td class="ltx_td ltx_border_t" id="S5.T6.6.2.2.6.3.2" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
</tr>
<tr class="ltx_tr" id="S5.T6.6.2.2.7.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.6.2.2.7.4.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Reg. Loss</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.7.4.2" style="padding-left:2.8pt;padding-right:2.8pt;">4.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.7.4.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.7.4.3.1" style="background-color:#D9D9FF;">10.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.7.4.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.7.4.4.1" style="background-color:#D9D9FF;">6.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.6.2.2.7.4.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.7.4.5.1" style="background-color:#FFD9D9;">5.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.7.4.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.7.4.6.1" style="background-color:#D9D9FF;">6.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.6.2.2.7.4.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.7.4.7.1" style="background-color:#D9D9FF;">77.7%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.6.2.2.8.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T6.6.2.2.8.5.1" style="padding-left:2.8pt;padding-right:2.8pt;">+ Trimap Loss</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.6.2.2.8.5.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.2.1" style="background-color:#FFD9D9;">3.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.6.2.2.8.5.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.3.1" style="background-color:#FFD9D9;">10.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.6.2.2.8.5.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.4.1" style="background-color:#FFD9D9;">6.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T6.6.2.2.8.5.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.5.1" style="background-color:#D9D9FF;">5.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.6.2.2.8.5.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.6.1" style="background-color:#FFD9D9;">6.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.6.2.2.8.5.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S5.T6.6.2.2.8.5.7.1" style="background-color:#FFD9D9;">79.0%</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Ablation Study</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.T5" title="Table 5 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">5</span></a> shows the effects of two hyperparameters <math alttext="\lambda_{\text{T}}" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><msub id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">λ</mi><mtext id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">𝜆</ci><ci id="S5.SS2.p1.1.m1.1.1.3a.cmml" xref="S5.SS2.p1.1.m1.1.1.3"><mtext id="S5.SS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS2.p1.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\lambda_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{R}}" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><msub id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">λ</mi><mtext id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3a.cmml">R</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝜆</ci><ci id="S5.SS2.p1.2.m2.1.1.3a.cmml" xref="S5.SS2.p1.2.m2.1.1.3"><mtext id="S5.SS2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S5.SS2.p1.2.m2.1.1.3">R</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\lambda_{\text{R}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT R end_POSTSUBSCRIPT</annotation></semantics></math> in the training loss (refer to Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S4.E1" title="In 4.2 SEMat Training Objective ‣ 4 Semantic Enhanced Matting Methodology ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1</span></a>). One can observe that our method is generally robust to these two hyperparameters.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">Next, we conduct four ablation studies in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.T6" title="Table 6 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">6</span></a>. The <span class="ltx_text ltx_font_italic" id="S5.SS2.p2.1.1">baseline</span> in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#S5.T6" title="Table 6 ‣ 5.1 Results on Interactive Matting ‣ 5 Experiments ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">6</span></a> denotes fine-tuning only a learnable matting decoder on the synthetic datasets.
<span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.2">(a) COCO Mask.</span> When integrating with the original COCO masks, the performance improves slightly due to simply taking the coarse masks as alpha matte annotations.
<span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.3">(b) Network.</span> By applying feature-aligned transformer and matte-aligned decoder, i.e., LoRA, prompt enhancement, matting token and adapter, our model demonstrates a superior extraction of matting-specific features. A substantial reduction in average SAD from 26.59 to 10.29 highlights the benefits of tailored network adjustments.
<span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.4">(c) Dataset.</span> Integrating with accessory fusion, SAD on the P3M human dataset has a significant reduction. Then, mask-to-matte provides fine-grained annotations that further reduce prediction errors. Contributions on our COCO-Matting help reduce the average SAD of -3.43. It is worth noting that although our COCO-Matting is human-centred, it also has a significant improvement on the AIM dataset including various objects.
<span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.5">(d) Training.</span> Our proposed regularization loss helps retain the pre-trained model’s knowledge while adapting to matting data, leading to a balanced and robust performance. The final model with the addition of trimap loss exhibits the best performance, with the smallest average SAD of 6.29.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose the COCO-Matting dataset and SEMat framework to revamp training datasets, network architecture, and training objectives. Solving the problem of inappropriate synthetic training data, unaligned features and mattes from a frozen SAM, and end-to-end matting loss lacking generalization, we greatly improve the interactive matting performance on diverse datasets.
<span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Limitations:</span>
Our method heavily relies on the pre-trained SAM, and its limitations may also affect our model’s performance. For instance, while SAM is trained on large-scale data and effectively segments common objects, it struggles with rare objects, possibly limiting our model’s capabilities.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2022)</span>
<span class="ltx_bibblock">
Yutong Dai, Brian Price, He Zhang, and Chunhua Shen.

</span>
<span class="ltx_bibblock">Boosting robustness of image matting with context assembling and strong data augmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  11707–11716, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2024)</span>
<span class="ltx_bibblock">
Xueqing Deng, Qihang Yu, Peng Wang, Xiaohui Shen, and Liang-Chieh Chen.

</span>
<span class="ltx_bibblock">COCONut: Modernizing COCO segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  21863–21873, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. (2022)</span>
<span class="ltx_bibblock">
Henghui Ding, Hui Zhang, Chang Liu, and Xudong Jiang.

</span>
<span class="ltx_bibblock">Deep interactive image matting with feature propagation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE Transactions on Image Processing</em>, 31:2421–2432, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fielding (2013)</span>
<span class="ltx_bibblock">
Raymond Fielding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Techniques of Special Effects of Cinematography</em>.

</span>
<span class="ltx_bibblock">Routledge, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou &amp; Liu (2019)</span>
<span class="ltx_bibblock">
Qiqi Hou and Feng Liu.

</span>
<span class="ltx_bibblock">Context-aware image matting for simultaneous foreground and alpha estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  4130–4139, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2022)</span>
<span class="ltx_bibblock">
Edward J Hu, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Yihan Hu, Yiheng Lin, Wei Wang, Yao Zhao, Yunchao Wei, and Humphrey Shi.

</span>
<span class="ltx_bibblock">Diffusion for natural image matting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2312.05915</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. (2024)</span>
<span class="ltx_bibblock">
Lei Ke, Mingqiao Ye, Martin Danelljan, Yu-Wing Tai, Chi-Keung Tang, Fisher Yu, et al.

</span>
<span class="ltx_bibblock">Segment anything in high quality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirillov et al. (2023)</span>
<span class="ltx_bibblock">
Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al.

</span>
<span class="ltx_bibblock">Segment anything.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  4015–4026, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levin et al. (2007)</span>
<span class="ltx_bibblock">
Anat Levin, Dani Lischinski, and Yair Weiss.

</span>
<span class="ltx_bibblock">A closed-form solution to natural image matting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 30(2):228–242, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Buyu Li, Yu Liu, and Xiaogang Wang.

</span>
<span class="ltx_bibblock">Gradient harmonized single-stage detector.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 33, pp.  8577–8584, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Jiachen Li, Jitesh Jain, and Humphrey Shi.

</span>
<span class="ltx_bibblock">Matting anything.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops</em>, pp.  1775–1785, June 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021a)</span>
<span class="ltx_bibblock">
Jizhizi Li, Sihan Ma, Jing Zhang, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Privacy-preserving portrait matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the ACM International Conference on Multimedia</em>, pp.  3501–3509, 2021a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021b)</span>
<span class="ltx_bibblock">
Jizhizi Li, Jing Zhang, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Deep automatic natural image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the International Joint Conference on Artificial Intelligence</em>, 2021b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Jizhizi Li, Jing Zhang, Stephen J Maybank, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Bridging composite and real: Towards end-to-end deep image matting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Journal of Computer Vision</em>, 130(2):246–266, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Jizhizi Li, Jing Zhang, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Deep image matting: A comprehensive survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2304.04672</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Jizhizi Li, Jing Zhang, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Referring image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  22448–22457, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2021)</span>
<span class="ltx_bibblock">
Shanchuan Lin, Andrey Ryabtsev, Soumyadip Sengupta, Brian L Curless, Steven M Seitz, and Ira Kemelmacher-Shlizerman.

</span>
<span class="ltx_bibblock">Real-time high-resolution background matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8762–8771, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C Lawrence Zitnick.

</span>
<span class="ltx_bibblock">Microsoft COCO: Common objects in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">European Conference on Computer Vision</em>, pp.  740–755, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Shilong Liu, Zhaoyang Zeng, Tianhe Ren, Feng Li, Hao Zhang, Jie Yang, Chunyuan Li, Jianwei Yang, Hang Su, Jun Zhu, et al.

</span>
<span class="ltx_bibblock">Grounding DINO: Marrying DINO with grounded pre-training for open-set object detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2303.05499</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Yuhao Liu, Jiake Xie, Xiao Shi, Yu Qiao, Yujie Huang, Yong Tang, and Xin Yang.

</span>
<span class="ltx_bibblock">Tripartite information mining and integration for image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  7555–7564, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. (2024)</span>
<span class="ltx_bibblock">
Maxime Oquab, Timothée Darcet, Théo Moutakanni, Huy Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa, Alaaeldin El-Nouby, et al.

</span>
<span class="ltx_bibblock">DINOv2: Learning robust visual features without supervision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions on Machine Learning Research Journal</em>, pp.  1–31, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiao et al. (2020)</span>
<span class="ltx_bibblock">
Yu Qiao, Yuhao Liu, Xin Yang, Dongsheng Zhou, Mingliang Xu, Qiang Zhang, and Xiaopeng Wei.

</span>
<span class="ltx_bibblock">Attention-guided hierarchical structure aggregation for image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  13676–13685, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ravi et al. (2024)</span>
<span class="ltx_bibblock">
Nikhila Ravi, Valentin Gabeur, Yuan-Ting Hu, Ronghang Hu, Chaitanya Ryali, Tengyu Ma, Haitham Khedr, Roman Rädle, Chloe Rolland, Laura Gustafson, Eric Mintun, Junting Pan, Kalyan Vasudev Alwala, Nicolas Carion, Chao-Yuan Wu, Ross Girshick, Piotr Dollár, and Christoph Feichtenhofer.

</span>
<span class="ltx_bibblock">SAM 2: Segment anything in images and videos.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2408.00714</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rhemann et al. (2009)</span>
<span class="ltx_bibblock">
Christoph Rhemann, Carsten Rother, Jue Wang, Margrit Gelautz, Pushmeet Kohli, and Pamela Rott.

</span>
<span class="ltx_bibblock">A perceptually motivated online benchmark for image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  1826–1833, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et al. (2015)</span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.

</span>
<span class="ltx_bibblock">U-Net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Medical Image Computing and Computer-Assisted Intervention</em>, pp.  234–241. Springer, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruzon &amp; Tomasi (2000)</span>
<span class="ltx_bibblock">
Mark A. Ruzon and Carlo Tomasi.

</span>
<span class="ltx_bibblock">Alpha estimation in natural images.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings IEEE Conference on Computer Vision and Pattern Recognition</em>, volume 1, pp.  18–25, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Yanan Sun, Chi-Keung Tang, and Yu-Wing Tai.

</span>
<span class="ltx_bibblock">Semantic image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  11120–11129, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022a)</span>
<span class="ltx_bibblock">
Yanan Sun, Chi-Keung Tang, and Yu-Wing Tai.

</span>
<span class="ltx_bibblock">Human instance matting via mutual guidance and multi-instance refinement.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  2647–2656, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022b)</span>
<span class="ltx_bibblock">
Yanan Sun, Chi-Keung Tang, and Yu-Wing Tai.

</span>
<span class="ltx_bibblock">Human instance matting via mutual guidance and multi-instance refinement.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  2647–2656, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2017)</span>
<span class="ltx_bibblock">
Ning Xu, Brian Price, Scott Cohen, and Thomas Huang.

</span>
<span class="ltx_bibblock">Deep image matting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pp.  2970–2979, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2022)</span>
<span class="ltx_bibblock">
Stephen DH Yang, Bin Wang, Weijia Li, YiQi Lin, and Conghui He.

</span>
<span class="ltx_bibblock">Unified interactive image matting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2205.08324</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2020)</span>
<span class="ltx_bibblock">
Xin Yang, Yu Qiao, Shaozhe Chen, Shengfeng He, Baocai Yin, Qiang Zhang, Xiaopeng Wei, and Rynson WH Lau.

</span>
<span class="ltx_bibblock">Smart scribbles for image matting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ACM Transactions on Multimedia Computing, Communications, and Applications</em>, 16(4):1–21, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2024a)</span>
<span class="ltx_bibblock">
Jingfeng Yao, Xinggang Wang, Shusheng Yang, and Baoyuan Wang.

</span>
<span class="ltx_bibblock">ViTMatte: Boosting image matting with pre-trained plain vision transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Information Fusion</em>, 103:102091, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2024b)</span>
<span class="ltx_bibblock">
Jingfeng Yao, Xinggang Wang, Lang Ye, and Wenyu Liu.

</span>
<span class="ltx_bibblock">Matte anything: Interactive natural image matting with segment anything model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Image and Vision Computing</em>, 147:105067, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2024)</span>
<span class="ltx_bibblock">
Zixuan Ye, Wenze Liu, He Guo, Yujia Liang, Chaoyi Hong, Hao Lu, and Zhiguo Cao.

</span>
<span class="ltx_bibblock">Unifying automatic and interactive matting with pretrained ViTs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  25585–25594, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021)</span>
<span class="ltx_bibblock">
Qihang Yu, Jianming Zhang, He Zhang, Yilin Wang, Zhe Lin, Ning Xu, Yutong Bai, and Alan Yuille.

</span>
<span class="ltx_bibblock">Mask guided matting via progressive refinement network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  1154–1163, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Details of the SAM Mask Decoder and Matting Adapter</h3>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Details of the SAM Mask Decoder and Matting Adapter</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  Shallow image features <math alttext="f_{0}" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">f</mi><mn id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝑓</ci><cn id="alg1.l0.m1.1.1.3.cmml" type="integer" xref="alg1.l0.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">f_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, Deep image features <math alttext="f_{3}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><msub id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mi id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">f</mi><mn id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2">𝑓</ci><cn id="alg1.l0.m2.1.1.3.cmml" type="integer" xref="alg1.l0.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">f_{3}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, Prompt tokens <math alttext="t_{\text{P}}" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><msub id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><mi id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml">t</mi><mtext id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3a.cmml">P</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2">𝑡</ci><ci id="alg1.l0.m3.1.1.3a.cmml" xref="alg1.l0.m3.1.1.3"><mtext id="alg1.l0.m3.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m3.1.1.3">P</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">t_{\text{P}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_t start_POSTSUBSCRIPT P end_POSTSUBSCRIPT</annotation></semantics></math>, SAM tokens <math alttext="t_{\text{SAM}}" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><msub id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">t</mi><mtext id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3a.cmml">SAM</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">subscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝑡</ci><ci id="alg1.l0.m4.1.1.3a.cmml" xref="alg1.l0.m4.1.1.3"><mtext id="alg1.l0.m4.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m4.1.1.3">SAM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">t_{\text{SAM}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_t start_POSTSUBSCRIPT SAM end_POSTSUBSCRIPT</annotation></semantics></math>, Matting tokens <span class="ltx_text" id="alg1.l0.1"><math alttext="t_{\text{Mat}}" class="ltx_Math" display="inline" id="alg1.l0.1.m1.1" style="background-color:#FBE5D6;"><semantics id="alg1.l0.1.m1.1a"><msub id="alg1.l0.1.m1.1.1" xref="alg1.l0.1.m1.1.1.cmml"><mi id="alg1.l0.1.m1.1.1.2" mathbackground="#FBE5D6" xref="alg1.l0.1.m1.1.1.2.cmml">t</mi><mtext id="alg1.l0.1.m1.1.1.3" mathbackground="#FBE5D6" xref="alg1.l0.1.m1.1.1.3a.cmml">Mat</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.1.m1.1b"><apply id="alg1.l0.1.m1.1.1.cmml" xref="alg1.l0.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.1.m1.1.1.1.cmml" xref="alg1.l0.1.m1.1.1">subscript</csymbol><ci id="alg1.l0.1.m1.1.1.2.cmml" xref="alg1.l0.1.m1.1.1.2">𝑡</ci><ci id="alg1.l0.1.m1.1.1.3a.cmml" xref="alg1.l0.1.m1.1.1.3"><mtext id="alg1.l0.1.m1.1.1.3.cmml" mathbackground="#FBE5D6" mathsize="70%" xref="alg1.l0.1.m1.1.1.3">Mat</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.1.m1.1c">t_{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.1.m1.1d">italic_t start_POSTSUBSCRIPT Mat end_POSTSUBSCRIPT</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Obtain <math alttext="t_{\text{Input}}=\text{Concat}(t_{\text{P}},t_{\text{SAM}},t_{\text{Mat}})" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><msub id="alg1.l1.m1.3.3.5" xref="alg1.l1.m1.3.3.5.cmml"><mi id="alg1.l1.m1.3.3.5.2" xref="alg1.l1.m1.3.3.5.2.cmml">t</mi><mtext id="alg1.l1.m1.3.3.5.3" xref="alg1.l1.m1.3.3.5.3a.cmml">Input</mtext></msub><mo id="alg1.l1.m1.3.3.4" xref="alg1.l1.m1.3.3.4.cmml">=</mo><mrow id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml"><mtext id="alg1.l1.m1.3.3.3.5" xref="alg1.l1.m1.3.3.3.5a.cmml">Concat</mtext><mo id="alg1.l1.m1.3.3.3.4" xref="alg1.l1.m1.3.3.3.4.cmml">⁢</mo><mrow id="alg1.l1.m1.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.4.cmml"><mo id="alg1.l1.m1.3.3.3.3.3.4" stretchy="false" xref="alg1.l1.m1.3.3.3.3.4.cmml">(</mo><msub id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.cmml">t</mi><mtext id="alg1.l1.m1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.3a.cmml">P</mtext></msub><mo id="alg1.l1.m1.3.3.3.3.3.5" xref="alg1.l1.m1.3.3.3.3.4.cmml">,</mo><msub id="alg1.l1.m1.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.cmml">t</mi><mtext id="alg1.l1.m1.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.3a.cmml">SAM</mtext></msub><mo id="alg1.l1.m1.3.3.3.3.3.6" xref="alg1.l1.m1.3.3.3.3.4.cmml">,</mo><msub id="alg1.l1.m1.3.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l1.m1.3.3.3.3.3.3.2" xref="alg1.l1.m1.3.3.3.3.3.3.2.cmml">t</mi><mtext id="alg1.l1.m1.3.3.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.3.3a.cmml">Mat</mtext></msub><mo id="alg1.l1.m1.3.3.3.3.3.7" stretchy="false" xref="alg1.l1.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.4"></eq><apply id="alg1.l1.m1.3.3.5.cmml" xref="alg1.l1.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.5.1.cmml" xref="alg1.l1.m1.3.3.5">subscript</csymbol><ci id="alg1.l1.m1.3.3.5.2.cmml" xref="alg1.l1.m1.3.3.5.2">𝑡</ci><ci id="alg1.l1.m1.3.3.5.3a.cmml" xref="alg1.l1.m1.3.3.5.3"><mtext id="alg1.l1.m1.3.3.5.3.cmml" mathsize="70%" xref="alg1.l1.m1.3.3.5.3">Input</mtext></ci></apply><apply id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3"><times id="alg1.l1.m1.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3.4"></times><ci id="alg1.l1.m1.3.3.3.5a.cmml" xref="alg1.l1.m1.3.3.3.5"><mtext id="alg1.l1.m1.3.3.3.5.cmml" xref="alg1.l1.m1.3.3.3.5">Concat</mtext></ci><vector id="alg1.l1.m1.3.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3.3.3"><apply id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2">𝑡</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.3"><mtext id="alg1.l1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l1.m1.1.1.1.1.1.1.3">P</mtext></ci></apply><apply id="alg1.l1.m1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">𝑡</ci><ci id="alg1.l1.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.3"><mtext id="alg1.l1.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l1.m1.2.2.2.2.2.2.3">SAM</mtext></ci></apply><apply id="alg1.l1.m1.3.3.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l1.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l1.m1.3.3.3.3.3.3.3a.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3"><mtext id="alg1.l1.m1.3.3.3.3.3.3.3.cmml" mathsize="70%" xref="alg1.l1.m1.3.3.3.3.3.3.3">Mat</mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">t_{\text{Input}}=\text{Concat}(t_{\text{P}},t_{\text{SAM}},t_{\text{Mat}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT = Concat ( italic_t start_POSTSUBSCRIPT P end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT SAM end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT Mat end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.1">for</span> <math alttext="n=1" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">n</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑛</ci><cn id="alg1.l2.m1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">n=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_n = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.2">to</span> <math alttext="2" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mn id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><cn id="alg1.l2.m2.1.1.cmml" type="integer" xref="alg1.l2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">2</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math alttext="t_{\text{Input}}\mathrel{+}=\text{SelfAttn}(t_{\text{Input}})" class="ltx_math_unparsed" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1b"><msub id="alg1.l3.m1.1.1"><mi id="alg1.l3.m1.1.1.2">t</mi><mtext id="alg1.l3.m1.1.1.3">Input</mtext></msub><mo id="alg1.l3.m1.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l3.m1.1.3" lspace="0em">=</mo><mtext id="alg1.l3.m1.1.4">SelfAttn</mtext><mrow id="alg1.l3.m1.1.5"><mo id="alg1.l3.m1.1.5.1" stretchy="false">(</mo><msub id="alg1.l3.m1.1.5.2"><mi id="alg1.l3.m1.1.5.2.2">t</mi><mtext id="alg1.l3.m1.1.5.2.3">Input</mtext></msub><mo id="alg1.l3.m1.1.5.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t_{\text{Input}}\mathrel{+}=\text{SelfAttn}(t_{\text{Input}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT + = SelfAttn ( italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math alttext="t_{\text{Input}}\mathrel{+}=\text{CrossAttn}(q=t_{\text{Input}},k=f_{3},v=f_{3})" class="ltx_math_unparsed" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1b"><msub id="alg1.l4.m1.1.1"><mi id="alg1.l4.m1.1.1.2">t</mi><mtext id="alg1.l4.m1.1.1.3">Input</mtext></msub><mo id="alg1.l4.m1.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l4.m1.1.3" lspace="0em">=</mo><mtext id="alg1.l4.m1.1.4">CrossAttn</mtext><mrow id="alg1.l4.m1.1.5"><mo id="alg1.l4.m1.1.5.1" stretchy="false">(</mo><mi id="alg1.l4.m1.1.5.2">q</mi><mo id="alg1.l4.m1.1.5.3">=</mo><msub id="alg1.l4.m1.1.5.4"><mi id="alg1.l4.m1.1.5.4.2">t</mi><mtext id="alg1.l4.m1.1.5.4.3">Input</mtext></msub><mo id="alg1.l4.m1.1.5.5">,</mo><mi id="alg1.l4.m1.1.5.6">k</mi><mo id="alg1.l4.m1.1.5.7">=</mo><msub id="alg1.l4.m1.1.5.8"><mi id="alg1.l4.m1.1.5.8.2">f</mi><mn id="alg1.l4.m1.1.5.8.3">3</mn></msub><mo id="alg1.l4.m1.1.5.9">,</mo><mi id="alg1.l4.m1.1.5.10">v</mi><mo id="alg1.l4.m1.1.5.11">=</mo><msub id="alg1.l4.m1.1.5.12"><mi id="alg1.l4.m1.1.5.12.2">f</mi><mn id="alg1.l4.m1.1.5.12.3">3</mn></msub><mo id="alg1.l4.m1.1.5.13" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">t_{\text{Input}}\mathrel{+}=\text{CrossAttn}(q=t_{\text{Input}},k=f_{3},v=f_{3})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT + = CrossAttn ( italic_q = italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT , italic_k = italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_v = italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="t_{\text{Input}}\mathrel{+}=\text{MLP}(t_{\text{Input}})" class="ltx_math_unparsed" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1b"><msub id="alg1.l5.m1.1.1"><mi id="alg1.l5.m1.1.1.2">t</mi><mtext id="alg1.l5.m1.1.1.3">Input</mtext></msub><mo id="alg1.l5.m1.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l5.m1.1.3" lspace="0em">=</mo><mtext id="alg1.l5.m1.1.4">MLP</mtext><mrow id="alg1.l5.m1.1.5"><mo id="alg1.l5.m1.1.5.1" stretchy="false">(</mo><msub id="alg1.l5.m1.1.5.2"><mi id="alg1.l5.m1.1.5.2.2">t</mi><mtext id="alg1.l5.m1.1.5.2.3">Input</mtext></msub><mo id="alg1.l5.m1.1.5.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">t_{\text{Input}}\mathrel{+}=\text{MLP}(t_{\text{Input}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT + = MLP ( italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="f_{3}\mathrel{+}=\text{CrossAttn}(q=f_{3},k=t_{\text{Input}},v=t_{\text{Input}})" class="ltx_math_unparsed" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1b"><msub id="alg1.l6.m1.1.1"><mi id="alg1.l6.m1.1.1.2">f</mi><mn id="alg1.l6.m1.1.1.3">3</mn></msub><mo id="alg1.l6.m1.1.2" lspace="0.278em" rspace="0em">+</mo><mo id="alg1.l6.m1.1.3" lspace="0em">=</mo><mtext id="alg1.l6.m1.1.4">CrossAttn</mtext><mrow id="alg1.l6.m1.1.5"><mo id="alg1.l6.m1.1.5.1" stretchy="false">(</mo><mi id="alg1.l6.m1.1.5.2">q</mi><mo id="alg1.l6.m1.1.5.3">=</mo><msub id="alg1.l6.m1.1.5.4"><mi id="alg1.l6.m1.1.5.4.2">f</mi><mn id="alg1.l6.m1.1.5.4.3">3</mn></msub><mo id="alg1.l6.m1.1.5.5">,</mo><mi id="alg1.l6.m1.1.5.6">k</mi><mo id="alg1.l6.m1.1.5.7">=</mo><msub id="alg1.l6.m1.1.5.8"><mi id="alg1.l6.m1.1.5.8.2">t</mi><mtext id="alg1.l6.m1.1.5.8.3">Input</mtext></msub><mo id="alg1.l6.m1.1.5.9">,</mo><mi id="alg1.l6.m1.1.5.10">v</mi><mo id="alg1.l6.m1.1.5.11">=</mo><msub id="alg1.l6.m1.1.5.12"><mi id="alg1.l6.m1.1.5.12.2">t</mi><mtext id="alg1.l6.m1.1.5.12.3">Input</mtext></msub><mo id="alg1.l6.m1.1.5.13" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">f_{3}\mathrel{+}=\text{CrossAttn}(q=f_{3},k=t_{\text{Input}},v=t_{\text{Input}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT + = CrossAttn ( italic_q = italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_k = italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT , italic_v = italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>  <math alttext="t_{\text{Output}}=t_{\text{Input}}+\text{CrossAttn}(q=t_{\text{Input}},k=f_{3}%
,v=f_{3})" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">t</mi><mtext id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3a.cmml">Output</mtext></msub><mo id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">=</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.3.2.cmml">t</mi><mtext id="alg1.l8.m1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.3.3a.cmml">Input</mtext></msub><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><mtext id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3a.cmml">CrossAttn</mtext><mo id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mtext id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">Input</mtext></msub></mrow><mo id="alg1.l8.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">k</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.1.cmml">=</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml">f</mi><mn id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml">3</mn></msub></mrow><mo id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">=</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">f</mi><mn id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">3</mn></msub></mrow></mrow></mrow><mo id="alg1.l8.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><eq id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"></eq><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.3.3a.cmml" xref="alg1.l8.m1.1.1.3.3"><mtext id="alg1.l8.m1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.3.3">Output</mtext></ci></apply><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><plus id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></plus><apply id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.3.3a.cmml" xref="alg1.l8.m1.1.1.1.3.3"><mtext id="alg1.l8.m1.1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.1.3.3">Input</mtext></ci></apply><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><times id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"></times><ci id="alg1.l8.m1.1.1.1.1.3a.cmml" xref="alg1.l8.m1.1.1.1.1.3"><mtext id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3">CrossAttn</mtext></ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1"><eq id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3">Input</mtext></ci></apply></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1"><eq id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.1"></eq><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.2">𝑘</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.2">𝑓</ci><cn id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.1.1.3.3">3</cn></apply></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2"><eq id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.1"></eq><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑓</ci><cn id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.2.2.3.3">3</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">t_{\text{Output}}=t_{\text{Input}}+\text{CrossAttn}(q=t_{\text{Input}},k=f_{3}%
,v=f_{3})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT = italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT + CrossAttn ( italic_q = italic_t start_POSTSUBSCRIPT Input end_POSTSUBSCRIPT , italic_k = italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_v = italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <math alttext="t_{\text{Output}}^{\text{SAM}},t_{\text{Output}}^{\text{Mat}}=\text{Split}(t_{%
\text{Output}})" class="ltx_Math" display="inline" id="alg1.l9.m1.3"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml"><msubsup id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.2.2.cmml">t</mi><mtext id="alg1.l9.m1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.2.3a.cmml">Output</mtext><mtext id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3a.cmml">SAM</mtext></msubsup><mo id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">t</mi><mtext id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3a.cmml">Output</mtext><mtext id="alg1.l9.m1.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.3a.cmml">Mat</mtext></msubsup></mrow><mo id="alg1.l9.m1.3.3.4" xref="alg1.l9.m1.3.3.4.cmml">=</mo><mrow id="alg1.l9.m1.3.3.3" xref="alg1.l9.m1.3.3.3.cmml"><mtext id="alg1.l9.m1.3.3.3.3" xref="alg1.l9.m1.3.3.3.3a.cmml">Split</mtext><mo id="alg1.l9.m1.3.3.3.2" xref="alg1.l9.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l9.m1.3.3.3.1.1" xref="alg1.l9.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l9.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l9.m1.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l9.m1.3.3.3.1.1.1" xref="alg1.l9.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.3.1.1.1.2" xref="alg1.l9.m1.3.3.3.1.1.1.2.cmml">t</mi><mtext id="alg1.l9.m1.3.3.3.1.1.1.3" xref="alg1.l9.m1.3.3.3.1.1.1.3a.cmml">Output</mtext></msub><mo id="alg1.l9.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l9.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><eq id="alg1.l9.m1.3.3.4.cmml" xref="alg1.l9.m1.3.3.4"></eq><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.2">𝑡</ci><ci id="alg1.l9.m1.1.1.1.1.1.2.3a.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.3"><mtext id="alg1.l9.m1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l9.m1.1.1.1.1.1.2.3">Output</mtext></ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.3a.cmml" xref="alg1.l9.m1.1.1.1.1.1.3"><mtext id="alg1.l9.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l9.m1.1.1.1.1.1.3">SAM</mtext></ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝑡</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3"><mtext id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l9.m1.2.2.2.2.2.2.3">Output</mtext></ci></apply><ci id="alg1.l9.m1.2.2.2.2.2.3a.cmml" xref="alg1.l9.m1.2.2.2.2.2.3"><mtext id="alg1.l9.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l9.m1.2.2.2.2.2.3">Mat</mtext></ci></apply></list><apply id="alg1.l9.m1.3.3.3.cmml" xref="alg1.l9.m1.3.3.3"><times id="alg1.l9.m1.3.3.3.2.cmml" xref="alg1.l9.m1.3.3.3.2"></times><ci id="alg1.l9.m1.3.3.3.3a.cmml" xref="alg1.l9.m1.3.3.3.3"><mtext id="alg1.l9.m1.3.3.3.3.cmml" xref="alg1.l9.m1.3.3.3.3">Split</mtext></ci><apply id="alg1.l9.m1.3.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.3.1.1.1.2">𝑡</ci><ci id="alg1.l9.m1.3.3.3.1.1.1.3a.cmml" xref="alg1.l9.m1.3.3.3.1.1.1.3"><mtext id="alg1.l9.m1.3.3.3.1.1.1.3.cmml" mathsize="70%" xref="alg1.l9.m1.3.3.3.1.1.1.3">Output</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">t_{\text{Output}}^{\text{SAM}},t_{\text{Output}}^{\text{Mat}}=\text{Split}(t_{%
\text{Output}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.3d">italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT , italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT = Split ( italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <math alttext="f_{\text{Mask}}^{\text{SAM}}=\text{UpsampledConv}(f_{3})" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msubsup id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml">f</mi><mtext id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3a.cmml">Mask</mtext><mtext id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3a.cmml">SAM</mtext></msubsup><mo id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">=</mo><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mtext id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.3a.cmml">UpsampledConv</mtext><mo id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">f</mi><mn id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">3</mn></msub><mo id="alg1.l10.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></eq><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">superscript</csymbol><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2">𝑓</ci><ci id="alg1.l10.m1.1.1.3.2.3a.cmml" xref="alg1.l10.m1.1.1.3.2.3"><mtext id="alg1.l10.m1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l10.m1.1.1.3.2.3">Mask</mtext></ci></apply><ci id="alg1.l10.m1.1.1.3.3a.cmml" xref="alg1.l10.m1.1.1.3.3"><mtext id="alg1.l10.m1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l10.m1.1.1.3.3">SAM</mtext></ci></apply><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.3a.cmml" xref="alg1.l10.m1.1.1.1.3"><mtext id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3">UpsampledConv</mtext></ci><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝑓</ci><cn id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l10.m1.1.1.1.1.1.1.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">f_{\text{Mask}}^{\text{SAM}}=\text{UpsampledConv}(f_{3})</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_f start_POSTSUBSCRIPT Mask end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT = UpsampledConv ( italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <math alttext="f_{\text{Mask}}^{\text{Mat}}=\hbox{\pagecolor{learnable_color}\text{Conv}}(f_{%
\text{Mask}}^{\text{SAM}})+\hbox{\pagecolor{learnable_color}\text{%
UpsampledConv}}(f_{0})+\hbox{\pagecolor{learnable_color}\text{UpsampledConv}}(%
f_{3})" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml"><msubsup id="alg1.l11.m1.3.3.5" xref="alg1.l11.m1.3.3.5.cmml"><mi id="alg1.l11.m1.3.3.5.2.2" xref="alg1.l11.m1.3.3.5.2.2.cmml">f</mi><mtext id="alg1.l11.m1.3.3.5.2.3" xref="alg1.l11.m1.3.3.5.2.3a.cmml">Mask</mtext><mtext id="alg1.l11.m1.3.3.5.3" xref="alg1.l11.m1.3.3.5.3a.cmml">Mat</mtext></msubsup><mo id="alg1.l11.m1.3.3.4" xref="alg1.l11.m1.3.3.4.cmml">=</mo><mrow id="alg1.l11.m1.3.3.3" xref="alg1.l11.m1.3.3.3.cmml"><mrow id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml"><mtext id="alg1.l11.m1.1.1.1.1.3" mathbackground="#FBE5D6" xref="alg1.l11.m1.1.1.1.1.3a.cmml">Conv</mtext><mo id="alg1.l11.m1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l11.m1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.3a.cmml">Mask</mtext><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3a.cmml">SAM</mtext></msubsup><mo id="alg1.l11.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.3.3.3.4" xref="alg1.l11.m1.3.3.3.4.cmml">+</mo><mrow id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml"><mtext id="alg1.l11.m1.2.2.2.2.3" mathbackground="#FBE5D6" xref="alg1.l11.m1.2.2.2.2.3a.cmml">UpsampledConv</mtext><mo id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l11.m1.2.2.2.2.1.1" xref="alg1.l11.m1.2.2.2.2.1.1.1.cmml"><mo id="alg1.l11.m1.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l11.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.2.2.2.2.1.1.1" xref="alg1.l11.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.1.1.1.2" xref="alg1.l11.m1.2.2.2.2.1.1.1.2.cmml">f</mi><mn id="alg1.l11.m1.2.2.2.2.1.1.1.3" xref="alg1.l11.m1.2.2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l11.m1.2.2.2.2.1.1.3" stretchy="false" xref="alg1.l11.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.3.3.3.4a" xref="alg1.l11.m1.3.3.3.4.cmml">+</mo><mrow id="alg1.l11.m1.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.cmml"><mtext id="alg1.l11.m1.3.3.3.3.3" mathbackground="#FBE5D6" xref="alg1.l11.m1.3.3.3.3.3a.cmml">UpsampledConv</mtext><mo id="alg1.l11.m1.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l11.m1.3.3.3.3.1.1" xref="alg1.l11.m1.3.3.3.3.1.1.1.cmml"><mo id="alg1.l11.m1.3.3.3.3.1.1.2" stretchy="false" xref="alg1.l11.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.3.3.3.3.1.1.1" xref="alg1.l11.m1.3.3.3.3.1.1.1.cmml"><mi id="alg1.l11.m1.3.3.3.3.1.1.1.2" xref="alg1.l11.m1.3.3.3.3.1.1.1.2.cmml">f</mi><mn id="alg1.l11.m1.3.3.3.3.1.1.1.3" xref="alg1.l11.m1.3.3.3.3.1.1.1.3.cmml">3</mn></msub><mo id="alg1.l11.m1.3.3.3.3.1.1.3" stretchy="false" xref="alg1.l11.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3"><eq id="alg1.l11.m1.3.3.4.cmml" xref="alg1.l11.m1.3.3.4"></eq><apply id="alg1.l11.m1.3.3.5.cmml" xref="alg1.l11.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.5.1.cmml" xref="alg1.l11.m1.3.3.5">superscript</csymbol><apply id="alg1.l11.m1.3.3.5.2.cmml" xref="alg1.l11.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.5.2.1.cmml" xref="alg1.l11.m1.3.3.5">subscript</csymbol><ci id="alg1.l11.m1.3.3.5.2.2.cmml" xref="alg1.l11.m1.3.3.5.2.2">𝑓</ci><ci id="alg1.l11.m1.3.3.5.2.3a.cmml" xref="alg1.l11.m1.3.3.5.2.3"><mtext id="alg1.l11.m1.3.3.5.2.3.cmml" mathsize="70%" xref="alg1.l11.m1.3.3.5.2.3">Mask</mtext></ci></apply><ci id="alg1.l11.m1.3.3.5.3a.cmml" xref="alg1.l11.m1.3.3.5.3"><mtext id="alg1.l11.m1.3.3.5.3.cmml" mathsize="70%" xref="alg1.l11.m1.3.3.5.3">Mat</mtext></ci></apply><apply id="alg1.l11.m1.3.3.3.cmml" xref="alg1.l11.m1.3.3.3"><plus id="alg1.l11.m1.3.3.3.4.cmml" xref="alg1.l11.m1.3.3.3.4"></plus><apply id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.2"></times><ci id="alg1.l11.m1.1.1.1.1.3a.cmml" xref="alg1.l11.m1.1.1.1.1.3"><mtext id="alg1.l11.m1.1.1.1.1.3.cmml" mathbackground="#FBE5D6" xref="alg1.l11.m1.1.1.1.1.3">Conv</mtext></ci><apply id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.3">Mask</mtext></ci></apply><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3"><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.3">SAM</mtext></ci></apply></apply><apply id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"><times id="alg1.l11.m1.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2"></times><ci id="alg1.l11.m1.2.2.2.2.3a.cmml" xref="alg1.l11.m1.2.2.2.2.3"><mtext id="alg1.l11.m1.2.2.2.2.3.cmml" mathbackground="#FBE5D6" xref="alg1.l11.m1.2.2.2.2.3">UpsampledConv</mtext></ci><apply id="alg1.l11.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.1.1.1.2">𝑓</ci><cn id="alg1.l11.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l11.m1.2.2.2.2.1.1.1.3">0</cn></apply></apply><apply id="alg1.l11.m1.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3"><times id="alg1.l11.m1.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.2"></times><ci id="alg1.l11.m1.3.3.3.3.3a.cmml" xref="alg1.l11.m1.3.3.3.3.3"><mtext id="alg1.l11.m1.3.3.3.3.3.cmml" mathbackground="#FBE5D6" xref="alg1.l11.m1.3.3.3.3.3">UpsampledConv</mtext></ci><apply id="alg1.l11.m1.3.3.3.3.1.1.1.cmml" xref="alg1.l11.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.1.1.1.1.cmml" xref="alg1.l11.m1.3.3.3.3.1.1">subscript</csymbol><ci id="alg1.l11.m1.3.3.3.3.1.1.1.2.cmml" xref="alg1.l11.m1.3.3.3.3.1.1.1.2">𝑓</ci><cn id="alg1.l11.m1.3.3.3.3.1.1.1.3.cmml" type="integer" xref="alg1.l11.m1.3.3.3.3.1.1.1.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">f_{\text{Mask}}^{\text{Mat}}=\hbox{\pagecolor{learnable_color}\text{Conv}}(f_{%
\text{Mask}}^{\text{SAM}})+\hbox{\pagecolor{learnable_color}\text{%
UpsampledConv}}(f_{0})+\hbox{\pagecolor{learnable_color}\text{UpsampledConv}}(%
f_{3})</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">italic_f start_POSTSUBSCRIPT Mask end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT = Conv ( italic_f start_POSTSUBSCRIPT Mask end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ) + UpsampledConv ( italic_f start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + UpsampledConv ( italic_f start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <math alttext="\hat{p}^{\text{SAM}}=\text{MLP}(t_{\text{Output}}^{\text{SAM}})\cdot f_{\text{%
Mask}}^{\text{SAM}}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msup id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mover accent="true" id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">p</mi><mo id="alg1.l12.m1.1.1.3.2.1" xref="alg1.l12.m1.1.1.3.2.1.cmml">^</mo></mover><mtext id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3a.cmml">SAM</mtext></msup><mo id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">=</mo><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml"><mtext id="alg1.l12.m1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.3a.cmml">MLP</mtext><mo id="alg1.l12.m1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l12.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l12.m1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mtext id="alg1.l12.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.3a.cmml">Output</mtext><mtext id="alg1.l12.m1.1.1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.3a.cmml">SAM</mtext></msubsup><mo id="alg1.l12.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l12.m1.1.1.1.2" rspace="0.222em" xref="alg1.l12.m1.1.1.1.2.cmml">⋅</mo><msubsup id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.1.3.2.2" xref="alg1.l12.m1.1.1.1.3.2.2.cmml">f</mi><mtext id="alg1.l12.m1.1.1.1.3.2.3" xref="alg1.l12.m1.1.1.1.3.2.3a.cmml">Mask</mtext><mtext id="alg1.l12.m1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.3.3a.cmml">SAM</mtext></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"></eq><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><ci id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2.1">^</ci><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝑝</ci></apply><ci id="alg1.l12.m1.1.1.3.3a.cmml" xref="alg1.l12.m1.1.1.3.3"><mtext id="alg1.l12.m1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l12.m1.1.1.3.3">SAM</mtext></ci></apply><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><ci id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2">⋅</ci><apply id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1"><times id="alg1.l12.m1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.2"></times><ci id="alg1.l12.m1.1.1.1.1.3a.cmml" xref="alg1.l12.m1.1.1.1.1.3"><mtext id="alg1.l12.m1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.3">MLP</mtext></ci><apply id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l12.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.3">Output</mtext></ci></apply><ci id="alg1.l12.m1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.3"><mtext id="alg1.l12.m1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.1.1.1.3">SAM</mtext></ci></apply></apply><apply id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.1.3.2.2">𝑓</ci><ci id="alg1.l12.m1.1.1.1.3.2.3a.cmml" xref="alg1.l12.m1.1.1.1.3.2.3"><mtext id="alg1.l12.m1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l12.m1.1.1.1.3.2.3">Mask</mtext></ci></apply><ci id="alg1.l12.m1.1.1.1.3.3a.cmml" xref="alg1.l12.m1.1.1.1.3.3"><mtext id="alg1.l12.m1.1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l12.m1.1.1.1.3.3">SAM</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\hat{p}^{\text{SAM}}=\text{MLP}(t_{\text{Output}}^{\text{SAM}})\cdot f_{\text{%
Mask}}^{\text{SAM}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT = MLP ( italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT ) ⋅ italic_f start_POSTSUBSCRIPT Mask end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SAM end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>  <math alttext="\hat{p}^{\text{Mat}}=\hbox{\pagecolor{learnable_color}\text{MLP}}(t_{\text{%
Output}}^{\text{Mat}})\cdot f_{\text{Mask}}^{\text{Mat}}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mover accent="true" id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">p</mi><mo id="alg1.l13.m1.1.1.3.2.1" xref="alg1.l13.m1.1.1.3.2.1.cmml">^</mo></mover><mtext id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3a.cmml">Mat</mtext></msup><mo id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">=</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml"><mtext id="alg1.l13.m1.1.1.1.1.3" mathbackground="#FBE5D6" xref="alg1.l13.m1.1.1.1.1.3a.cmml">MLP</mtext><mo id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l13.m1.1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mtext id="alg1.l13.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.3a.cmml">Output</mtext><mtext id="alg1.l13.m1.1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.1.3a.cmml">Mat</mtext></msubsup><mo id="alg1.l13.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m1.1.1.1.2" rspace="0.222em" xref="alg1.l13.m1.1.1.1.2.cmml">⋅</mo><msubsup id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.3.2.2" xref="alg1.l13.m1.1.1.1.3.2.2.cmml">f</mi><mtext id="alg1.l13.m1.1.1.1.3.2.3" xref="alg1.l13.m1.1.1.1.3.2.3a.cmml">Mask</mtext><mtext id="alg1.l13.m1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.3.3a.cmml">Mat</mtext></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"></eq><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2"><ci id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.2.1">^</ci><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝑝</ci></apply><ci id="alg1.l13.m1.1.1.3.3a.cmml" xref="alg1.l13.m1.1.1.3.3"><mtext id="alg1.l13.m1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.3.3">Mat</mtext></ci></apply><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><ci id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2">⋅</ci><apply id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><times id="alg1.l13.m1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.2"></times><ci id="alg1.l13.m1.1.1.1.1.3a.cmml" xref="alg1.l13.m1.1.1.1.1.3"><mtext id="alg1.l13.m1.1.1.1.1.3.cmml" mathbackground="#FBE5D6" xref="alg1.l13.m1.1.1.1.1.3">MLP</mtext></ci><apply id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l13.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.3">Output</mtext></ci></apply><ci id="alg1.l13.m1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.3"><mtext id="alg1.l13.m1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.1.1.1.1.1.3">Mat</mtext></ci></apply></apply><apply id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.3.2.2">𝑓</ci><ci id="alg1.l13.m1.1.1.1.3.2.3a.cmml" xref="alg1.l13.m1.1.1.1.3.2.3"><mtext id="alg1.l13.m1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.1.3.2.3">Mask</mtext></ci></apply><ci id="alg1.l13.m1.1.1.1.3.3a.cmml" xref="alg1.l13.m1.1.1.1.3.3"><mtext id="alg1.l13.m1.1.1.1.3.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.1.3.3">Mat</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\hat{p}^{\text{Mat}}=\hbox{\pagecolor{learnable_color}\text{MLP}}(t_{\text{%
Output}}^{\text{Mat}})\cdot f_{\text{Mask}}^{\text{Mat}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT = MLP ( italic_t start_POSTSUBSCRIPT Output end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT ) ⋅ italic_f start_POSTSUBSCRIPT Mask end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
</div>
<br class="ltx_break ltx_break"/>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#alg1" title="Algorithm 1 ‣ A.1 Details of the SAM Mask Decoder and Matting Adapter ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">1</span></a>, we elaborate on the forward details of the SAM mask decoder and matting adapter. The activation function and normalization are omitted for brevity. <span class="ltx_text" id="A1.SS1.p1.1.1" style="background-color:#FBE5D6;">Learnable parameters</span> are highlighted.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Details of the Matting Decoder</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.2">Our matting decoder with the UNet shape takes the concatenation of the image and upsampled matting logits <math alttext="\text{Upsample}(\hat{p}^{\text{Mat}})" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mtext id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3a.cmml">Upsample</mtext><mo id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.1.m1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="A1.SS2.p1.1.m1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p1.1.m1.1.1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.2.2" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml">p</mi><mo id="A1.SS2.p1.1.m1.1.1.1.1.1.2.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mtext id="A1.SS2.p1.1.m1.1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.1.3a.cmml">Mat</mtext></msup><mo id="A1.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><times id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2"></times><ci id="A1.SS2.p1.1.m1.1.1.3a.cmml" xref="A1.SS2.p1.1.m1.1.1.3"><mtext id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">Upsample</mtext></ci><apply id="A1.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1">superscript</csymbol><apply id="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2"><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.1">^</ci><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.2">𝑝</ci></apply><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.3a.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.3"><mtext id="A1.SS2.p1.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.1.1.1.1.1.3">Mat</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\text{Upsample}(\hat{p}^{\text{Mat}})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">Upsample ( over^ start_ARG italic_p end_ARG start_POSTSUPERSCRIPT Mat end_POSTSUPERSCRIPT )</annotation></semantics></math> as input and extracts matting features through four downsampling residual blocks, progressively reducing the resolution to one-eighth of the original. Subsequently, intermediate features <math alttext="\{f_{i}\}" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><mrow id="A1.SS2.p1.2.m2.1.1.1" xref="A1.SS2.p1.2.m2.1.1.2.cmml"><mo id="A1.SS2.p1.2.m2.1.1.1.2" stretchy="false" xref="A1.SS2.p1.2.m2.1.1.2.cmml">{</mo><msub id="A1.SS2.p1.2.m2.1.1.1.1" xref="A1.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="A1.SS2.p1.2.m2.1.1.1.1.2" xref="A1.SS2.p1.2.m2.1.1.1.1.2.cmml">f</mi><mi id="A1.SS2.p1.2.m2.1.1.1.1.3" xref="A1.SS2.p1.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p1.2.m2.1.1.1.3" stretchy="false" xref="A1.SS2.p1.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><set id="A1.SS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.1"><apply id="A1.SS2.p1.2.m2.1.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.2">𝑓</ci><ci id="A1.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">\{f_{i}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">{ italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> extracted from the ViT backbone are fused with the matting features through a residual block at the bottom of matting decoder. Lastly, four upsampling residual blocks with skip connections restore the features to the original resolution, yielding the alpha mattes.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Trainable Parameters</h3>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Overview of the trainable parameters (millions) distribution across the proposed SEMat.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.1.1">Component</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.2.1">SEMat (SAM &amp; HQ-SAM)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.3.1">SEMat (SAM2)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.1">Prompt Enhancement</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.2">1.0 M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.3">0.03 M</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.2">
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.1">LoRA</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.2">2.4 M</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.3">2.7 M</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.3">
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.3.1">Matting Tokens &amp; Adapter</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.3.2">1.3 M</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.3.3">0.5 M</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.5.4">
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.4.1">Matting Decoder</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.4.2">13.6 M</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.4.3">14.6 M</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T7.1.6.5.1"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.5.1.1">Total</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T7.1.6.5.2"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.5.2.1">18.3 M</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A1.T7.1.6.5.3"><span class="ltx_text ltx_font_bold" id="A1.T7.1.6.5.3.1">17.8 M</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#A1.T7" title="Table 7 ‣ A.3 Trainable Parameters ‣ Appendix A Appendix ‣ Towards Natural Image Matting in the Wild via Real-Scenario Prior"><span class="ltx_text ltx_ref_tag">7</span></a> presents a detailed account of the distribution of trainable parameters within the proposed SEMat of different versions. The table delineates four key components in our proposed feature aligned transformer and matte aligned decoder, each accompanied by the respective number of trainable parameters in millions. The total trainable parameters of 18.2 or 17.8 million are added to the pre-trained SAM <cite class="ltx_cite ltx_citemacro_citep">(Kirillov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib10" title="">2023</a>; Ke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib9" title="">2024</a>; Ravi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib25" title="">2024</a>)</cite> to construct our SEMat.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Quantitative Results</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">In the subsequent part, we present a detailed quantitative analysis comparing the performance of InstMatt <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib31" title="">2022b</a>)</cite>, SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, our novel SEMat (HQ-SAM), and SEMat (SAM2) on various benchmark datasets, including HIM-2K <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite>, P3M-500-NP <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite>, RefMatte-RW100 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite>, RWP636 <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib38" title="">2021</a>)</cite>, AIM-500 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib15" title="">2021b</a>)</cite>, AM-2K <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite> and SIM <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite>.

<br class="ltx_break"/></p>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="911" id="A1.F5.g1" src="x6.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
Qualitative matting results on the HIM-2K dataset <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib30" title="">2022a</a>)</cite> with InstMatt <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib31" title="">2022b</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="570" id="A1.F6.g1" src="x7.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
Qualitative matting results on the P3M-500-NP dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib14" title="">2021a</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="437" id="A1.F7.g1" src="x8.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Qualitative matting results on the RefMatte-RW100 dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib18" title="">2023b</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="588" id="A1.F8.g1" src="x9.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>
Qualitative matting results on the RWP-636 dataset <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib38" title="">2021</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="480" id="A1.F9.g1" src="x10.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>
Qualitative matting results on the AIM-500 dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib15" title="">2021b</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="450" id="A1.F10.g1" src="x11.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>
Qualitative matting results on the AM-2K dataset <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib16" title="">2022</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="578" id="A1.F11.g1" src="x12.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>
Qualitative matting results on the SIM dataset <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib29" title="">2021</a>)</cite> with SmartMat <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.06593v1#bib.bib37" title="">2024</a>)</cite>, SEMat (HQ-SAM) and SEMat (SAM2).
</figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  9 06:19:04 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
