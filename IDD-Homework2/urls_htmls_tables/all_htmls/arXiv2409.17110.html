<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies</title>
<!--Generated on Wed Sep 25 17:23:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.17110v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S1" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2.SS1" title="In 2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Medical and Biological Image Segmentation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2.SS2" title="In 2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Virtual Outliers Synthesis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS1" title="In 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>TransUNet for Cell Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS2" title="In 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Robust Cell Segmentation via Virtual Outlier Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS3" title="In 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Unknown-aware Training Objective</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Dataset Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4.SS1" title="In 4 Dataset Analysis ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Data Description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4.SS2" title="In 4 Dataset Analysis ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Data Preprocessing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS1" title="In 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Implementation details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS2" title="In 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS3" title="In 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Comparison with Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS4" title="In 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Studies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS5" title="In 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Patch-Based Approach for High-Resolution Inference and Visualization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S6" title="In MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn" lang="en">
<h1 class="ltx_title ltx_title_document">MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tianhao Zhang
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Heather J. McCourty
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Berardo M. Sanchez-Tafolla
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Anton Nikolaev
</span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lyudmila S. Mihaylova
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1"><span class="ltx_text" id="id1.id1.1">Deep learning has revolutionized medical and biological imaging, particularly in segmentation tasks. However, segmenting biological cells remains challenging due to the high variability and complexity of cell shapes. Addressing this challenge requires high-quality datasets that accurately represent the diverse morphologies found in biological cells. Existing cell segmentation datasets are often limited by their focus on regular and uniform shapes. In this paper, we introduce a novel benchmark dataset of Ntera-2 (NT2) cells, a pluripotent carcinoma cell line, exhibiting diverse morphologies across multiple stages of differentiation, capturing the intricate and heterogeneous cellular structures that complicate segmentation tasks. To address these challenges, we propose an uncertainty-aware deep learning framework for complex cellular morphology segmentation (MorphoSeg) by incorporating sampling of virtual outliers from low-likelihood regions during training. Our comprehensive experimental evaluations against state-of-the-art baselines demonstrate that MorphoSeg significantly enhances segmentation accuracy, achieving up to a 7.74% increase in the Dice Similarity Coefficient (DSC) and a 28.36% reduction in the Hausdorff Distance. These findings highlight the effectiveness of our dataset and methodology in advancing cell segmentation capabilities, especially for complex and variable cell morphologies. The dataset and source code is publicly available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RanchoGoose/MorphoSeg" title="">https://github.com/RanchoGoose/MorphoSeg</a>.</span></p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
<span class="ltx_text" id="id2.id1">
Biomedical Segmentation, Cell Segmentation, Machine Learning, Deep Learning, Ntera-2 Cells, Data Repository, Complex Cell Shapes, Vision Transformer
</span>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Neurocomputing Journal</span></span></span>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\affiliation</span>
<p class="ltx_p" id="p1.2">[1]organization=School of Electrical and Electronic Enigeering, The University of Sheffield,
city=Sheffield,
country=United Kingdom
</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\affiliation</span>
<p class="ltx_p" id="p2.2">[2]organization=School of Biosciences, The University of Sheffield,
city=Sheffield,
country=United Kingdom
</p>
</div>
<section class="ltx_section ltx_indent_first" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The advent of deep learning has significantly advanced the field of medical imaging, particularly in segmentation tasks. While substantial progress has been made in segmenting well-defined objects such as organs in computed tomography (CT) scans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib4" title="">4</a>]</cite>, cell segmentation presents unique challenges due to the complexity and variability of cell shapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib8" title="">8</a>]</cite>. Existing datasets for cell segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib12" title="">12</a>]</cite> often fall short in covering the full spectrum of cell types, hindering the effective training of deep learning models for diverse research applications.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In the broader context of medical image analysis, cell segmentation is crucial yet challenging, particularly due to the high variability in cell stages and the resolutions of medical images. Current state-of-the-art (SOTA) deep learning models, including advanced architectures such as Convolutional Neural Networks (CNNs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib13" title="">13</a>]</cite> and Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib3" title="">3</a>]</cite>, typically require large, well-annotated datasets, which are resource-intensive to acquire. Beyond focusing on model algorithms, some researchers have shifted towards developing methods for rapid, easy data annotation or advancing weak, semi, or unsupervised learning algorithms to address data insufficiency <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib15" title="">15</a>]</cite>. However, irregular cell shapes and the need for multi-stage observation
remain significant challenges.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we present a novel benchmark dataset featuring Ntera-2 cells (NT2) cells <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib16" title="">16</a>]</cite>. NT2 is a pluripotent carcinoma cell line known for its ability to differentiate into neuro-ectodermal lineages <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib17" title="">17</a>]</cite>. NT2 cells have previously been shown to transform into neurons, after exposure to all-<span class="ltx_text ltx_font_italic" id="S1.p3.1.1">trans</span>-retinoic acid <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib18" title="">18</a>]</cite> (ATRA). During differentiation, NT2 cells exhibit a range of heterogeneous morphologies, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">1</span></a>, which poses challenges for reliable segmentation. The dataset includes images of NT2 cells at numerous stages of differentiation, spanning from day 7 to day 12, and captures the diverse and complex cell morphologies formed during this period. The complexities can make it difficult to accurately annotate cells, with some cellular features barely discernible even to trained experts. Furthermore, the variability in shape across different stages complicates the segmentation process, necessitating robust deep-learning solutions capable of adapting to such heterogeneity.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="481" id="S1.F1.g1" src="x1.png" width="481"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Undifferentiated and Differentiating NT2 Cell Example Images From the Training Set.
(A) Undifferentiated Ntera-2 cells.
(B) shows the original bright-field images of cells exposed to <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S1.F1.2.m1.1"><semantics id="S1.F1.2.m1.1b"><msup id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml"><mn id="S1.F1.2.m1.1.1.2" xref="S1.F1.2.m1.1.1.2.cmml">10</mn><mrow id="S1.F1.2.m1.1.1.3" xref="S1.F1.2.m1.1.1.3.cmml"><mo id="S1.F1.2.m1.1.1.3b" xref="S1.F1.2.m1.1.1.3.cmml">−</mo><mn id="S1.F1.2.m1.1.1.3.2" xref="S1.F1.2.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><apply id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.2.m1.1.1.1.cmml" xref="S1.F1.2.m1.1.1">superscript</csymbol><cn id="S1.F1.2.m1.1.1.2.cmml" type="integer" xref="S1.F1.2.m1.1.1.2">10</cn><apply id="S1.F1.2.m1.1.1.3.cmml" xref="S1.F1.2.m1.1.1.3"><minus id="S1.F1.2.m1.1.1.3.1.cmml" xref="S1.F1.2.m1.1.1.3"></minus><cn id="S1.F1.2.m1.1.1.3.2.cmml" type="integer" xref="S1.F1.2.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.2.m1.1e">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> M ATRA every 48 hours for 2 weeks. (C) displays the mask created from manual annotations. The images highlight the diverse data set used for training.</figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address the aforementioned challenges, we propose a novel unknown-aware enhancement algorithm based on the SOTA medical segmentation framework TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite>. Our approach involves sampling virtual outliers from the low-likelihood regions of the class-conditional distributions during the training stage to improve the decision boundaries of the segmented objects. This strategy enhances the robustness of the deep learning models, making them effective solutions in such complex scenarios. By incorporating uncertainties into the training objective, our proposed deep learning model achieves strong segmentation of cells with random shapes. When compared against several benchmarks, we demonstrate significant improvements with our proposed dataset: the mean Dice Similarity Coefficient (DSC) increased from 80.35% to 86.57% and the mean Hausdorff Distance (HD95) decreased from 21.98% to 15.75%. These results confirm that our approach not only mitigates data scarcity but also enhances the model’s generalization capabilities across varied cell morphologies. We have provided the full code and pre-trained models with simple inference instructions to facilitate easy implementation and further research by field researchers.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The key contributions of this paper are:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Development of a pluripotent carcinoma cell repository, specifically curated to support the development and validation of advanced biological cell segmentation models.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Proposal of a practical and scalable framework for cell segmentation that leverages synthetic outliers and data augmentation to significantly enhance the performance of the SOTA cell segmentation deep-learning models, particularly in scenarios typical of limited data availability.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Comprehensive quantitative and qualitative analyses highlighting that the proposed model performs favourably compared to existing techniques.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The remainder of this paper is organized as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2" title="2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">2</span></a> reviews the literature on deep learning methods for biological cell segmentation, and outlier generation methods. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3" title="3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3</span></a> details our proposed model’s methodology and framework. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4" title="4 Dataset Analysis ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4</span></a> elaborates on the dataset and preprocessing techniques. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5" title="5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">5</span></a> presents experimental setup, results, analyses, and ablation studies, as well as inference and visualization techniques. Finally, Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S6" title="6 Conclusion and Future Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">6</span></a> concludes the paper, summarizing key findings and future research directions.</p>
</div>
</section>
<section class="ltx_section ltx_indent_first" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection ltx_indent_first" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Medical and Biological Image Segmentation.</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In recent years, deep learning techniques in computer vision have achieved promising performance in medical image segmentation. Encoder-decoder-based CNN structures have been widely applied, with U-Net and its variants significantly advancing the field <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib21" title="">21</a>]</cite>. Building upon this structure, UNet++ incorporates densely connected links to enhance the fusion of multi-scale features, improving the analysis of medical images across CT, MRI, and EM modalities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib22" title="">22</a>]</cite>. Furthermore, nnU-Net, a self-configuring U-Net, has shown remarkable performance across various segmentation tasks with minimal manual parameter tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib24" title="">24</a>]</cite>. In terms of segmenting cell structures, the Cellpose model utilizes a two-headed output architecture to predict cell probabilities and spatial organization, effectively handling cells of regular shapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib6" title="">6</a>]</cite>. However, its performance is limited for irregularly shaped cells, as often encountered in advanced disease stages.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Semantic segmentation is pivotal for clinical tasks such as disease detection, differential diagnosis, survival prediction, therapy planning, and treatment response assessment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib29" title="">29</a>]</cite>. Besides deep learning methods based on CNN structures, attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib30" title="">30</a>]</cite> are extensively employed in semantic segmentation to prioritize salient features. The integration of Vision Transformers (ViTs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib31" title="">31</a>]</cite> into medical segmentation networks has enhanced performance by leveraging self-attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib34" title="">34</a>]</cite>. Some research focuses on combining the strengths of transformers with traditional CNN architectures, creating hybrid encoder structures. TransUNet combines CNNs for spatial information extraction with transformers for capturing long-range dependencies, featuring a U-Net structure with self-attention mechanisms to ensure comprehensive image analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite>. This integration makes TransUNet particularly effective for detailed medical and biological image segmentation, where preserving spatial hierarchies is crucial. Other research includes employing channel attention to capture boundary-aware features for enhancing polyp segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib35" title="">35</a>]</cite>. CellViT replaces the CNN encoder with a transformer block in the U-Net architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib36" title="">36</a>]</cite>. The recent SAMed model extends the capabilities of the Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib37" title="">37</a>]</cite> to medical imaging by employing a Low-rank Adaptation (LoRA) fine-tuning strategy to adapt the large-scale image encoder for medical contexts effectively <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib3" title="">3</a>]</cite>. This method illustrates the advantage of using extensive pre-trained models for specialized medical segmentation tasks. However, SAM is designed for multi-class segmentation, posing limitations for binary segmentation scenarios.</p>
</div>
</section>
<section class="ltx_subsection ltx_indent_first" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Virtual Outliers Synthesis</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Outliers in data mining and statistics are typically considered representations of abnormalities, discordants, deviants, or anomalies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib39" title="">39</a>]</cite>. In the context of deep learning, outliers are often viewed as anomalies compared to inliers, with multiple deep learning methods developed to detect these outliers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib39" title="">39</a>]</cite>. Unlike traditional approaches that focus on outlier detection, recent works in computer vision have explored synthesizing outliers to enhance the accuracy and robustness of deep learning models, particularly in scenarios where datasets are insufficient, such as the medical image classification <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib39" title="">39</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Further research has leveraged synthetic data to quantify uncertainty, primarily for out-of-distribution (OOD) detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib4" title="">4</a>]</cite>. OOD detection aims to identify conditions unrepresented in the training dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib43" title="">43</a>]</cite>. In the realm of OOD detection, the challenge is to detect OOD samples; in our case, these include unseen cells in annotations that are difficult for precise human annotation and cells at transitional stages that can be considered OOD. The subtle differences between foreground elements in medical images turn OOD detection into a near-OOD problem, where traditional methods often fall short <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib47" title="">47</a>]</cite>. In our research, we treat segmentation targets, specifically NT2 cells at various stages, as OOD data. Virtual outlier synthesis has proven effective for OOD detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib41" title="">41</a>]</cite>, inspiring us to adapt this approach to enhance the robustness and accuracy of our model for cell segmentation.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Synthesis methods for medical and biological image segmentation remain relatively underexplored. Few synthesis methods have been applied to enhance the training of deep learning models in this area <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib50" title="">50</a>]</cite>. Our proposed method dynamically estimates class-conditional Gaussian distributions during training, shaping the uncertainty surface over time with our specially formulated loss.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="283" id="S2.F2.g1" src="extracted/5879740/fig/method1.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The overall framework of the proposed method, following the architecture of TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite>. The process for virtual outlier sampling is depicted with red dotted lines. In this framework, we model the feature representations as class-conditional Gaussians and sample virtual outliers <math alttext="v" class="ltx_Math" display="inline" id="S2.F2.4.m1.1"><semantics id="S2.F2.4.m1.1b"><mi id="S2.F2.4.m1.1.1" xref="S2.F2.4.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.F2.4.m1.1c"><ci id="S2.F2.4.m1.1.1.cmml" xref="S2.F2.4.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.m1.1d">v</annotation><annotation encoding="application/x-llamapun" id="S2.F2.4.m1.1e">italic_v</annotation></semantics></math> from regions of low likelihood. These virtual outliers contribute to generating the uncertainty loss for regularization. The synthetic segmentation map, incorporating the uncertainty estimation branch <math alttext="\mathcal{L}_{\text{uncertainty}}" class="ltx_Math" display="inline" id="S2.F2.5.m2.1"><semantics id="S2.F2.5.m2.1b"><msub id="S2.F2.5.m2.1.1" xref="S2.F2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.5.m2.1.1.2" xref="S2.F2.5.m2.1.1.2.cmml">ℒ</mi><mtext id="S2.F2.5.m2.1.1.3" xref="S2.F2.5.m2.1.1.3a.cmml">uncertainty</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.5.m2.1c"><apply id="S2.F2.5.m2.1.1.cmml" xref="S2.F2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.5.m2.1.1.1.cmml" xref="S2.F2.5.m2.1.1">subscript</csymbol><ci id="S2.F2.5.m2.1.1.2.cmml" xref="S2.F2.5.m2.1.1.2">ℒ</ci><ci id="S2.F2.5.m2.1.1.3a.cmml" xref="S2.F2.5.m2.1.1.3"><mtext id="S2.F2.5.m2.1.1.3.cmml" mathsize="70%" xref="S2.F2.5.m2.1.1.3">uncertainty</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m2.1d">\mathcal{L}_{\text{uncertainty}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.5.m2.1e">caligraphic_L start_POSTSUBSCRIPT uncertainty end_POSTSUBSCRIPT</annotation></semantics></math>, is trained concurrently with the mixed segmentation loss <math alttext="\mathcal{L}_{\text{seg}}" class="ltx_Math" display="inline" id="S2.F2.6.m3.1"><semantics id="S2.F2.6.m3.1b"><msub id="S2.F2.6.m3.1.1" xref="S2.F2.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.6.m3.1.1.2" xref="S2.F2.6.m3.1.1.2.cmml">ℒ</mi><mtext id="S2.F2.6.m3.1.1.3" xref="S2.F2.6.m3.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.m3.1c"><apply id="S2.F2.6.m3.1.1.cmml" xref="S2.F2.6.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.6.m3.1.1.1.cmml" xref="S2.F2.6.m3.1.1">subscript</csymbol><ci id="S2.F2.6.m3.1.1.2.cmml" xref="S2.F2.6.m3.1.1.2">ℒ</ci><ci id="S2.F2.6.m3.1.1.3a.cmml" xref="S2.F2.6.m3.1.1.3"><mtext id="S2.F2.6.m3.1.1.3.cmml" mathsize="70%" xref="S2.F2.6.m3.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m3.1d">\mathcal{L}_{\text{seg}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.m3.1e">caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.E12" title="Equation 12 ‣ 3.3 Unknown-aware Training Objective ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">12</span></a>).</figcaption>
</figure>
</section>
</section>
<section class="ltx_section ltx_indent_first" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The overall framework of our approach is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2.F2" title="Figure 2 ‣ 2.2 Virtual Outliers Synthesis ‣ 2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">2</span></a>. We utilize the TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite> architecture as the foundational framework for our method. Initially, high-resolution images are subdivided into small patches to align with the input constraints of the vision transformer and enhance the model’s ability to capture cellular details at the pixel level (details in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4.SS2" title="4.2 Data Preprocessing ‣ 4 Dataset Analysis ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4.2</span></a>). For the original TransUNet, there are two types of encoders for feature extraction: a hybrid encoder combining a pre-trained CNN and a pure Transformer encoder. We present the hybrid structure in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2.F2" title="Figure 2 ‣ 2.2 Virtual Outliers Synthesis ‣ 2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">2</span></a> as it provides better results (shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS3" title="5.3 Comparison with Baselines ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">5.3</span></a>). It is noteworthy that our method is scalable to different deep learning frameworks since the sampling method works on the raw segmentation predictions (details in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS2" title="3.2 Robust Cell Segmentation via Virtual Outlier Sampling ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3.2</span></a>). The rest of this section is orgnized as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS1" title="3.1 TransUNet for Cell Segmentation ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3.1</span></a> provides preliminary information and an overview of the TransUNet framework for image segmentation tasks. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS2" title="3.2 Robust Cell Segmentation via Virtual Outlier Sampling ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we present our robust cell segmentation enhancement via virtual outlier sampling. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS3" title="3.3 Unknown-aware Training Objective ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3.3</span></a> introduces the overall uncertainty-aware training objective for MorphoSeg.</p>
</div>
<section class="ltx_subsection ltx_indent_first" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>TransUNet for Cell Segmentation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">Given an image <math alttext="\bm{\mathrm{x}}\in\mathbb{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐱</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐱</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bm{\mathrm{x}}\in\mathbb{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> with a spatial resolution of <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">H</mi><mo id="S3.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐻</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_H × italic_W</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_C</annotation></semantics></math> channels, our objective is to predict the corresponding pixel-wise label map of the same dimensions. Traditionally, this is achieved by training a CNN (e.g., U-Net) that encodes the image into high-level feature representations and subsequently decodes these representations back to the original spatial resolution. To enhance segmentation accuracy, particularly for cell segmentation, we incorporate a Vision Transformer with self-attention mechanisms for instance segmentation without losing fine-grained information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.4.1">Image Sequentialization.</span>
For a pure Transformer encoder structure, following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib31" title="">31</a>]</cite>, we first perform tokenization by reshaping the input <math alttext="\bm{\mathrm{x}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\bm{\mathrm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_x</annotation></semantics></math> into a sequence of flattened 2D patches {<math alttext="\bm{\mathrm{x}}^{i}_{p}\in\mathbb{R}^{P^{2}\cdot C}|i=1,..,N\}" class="ltx_math_unparsed" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1b"><msubsup id="S3.SS1.p2.2.m2.1.1"><mi id="S3.SS1.p2.2.m2.1.1.2.2">𝐱</mi><mi id="S3.SS1.p2.2.m2.1.1.3">p</mi><mi id="S3.SS1.p2.2.m2.1.1.2.3">i</mi></msubsup><mo id="S3.SS1.p2.2.m2.1.2">∈</mo><msup id="S3.SS1.p2.2.m2.1.3"><mi id="S3.SS1.p2.2.m2.1.3.2">ℝ</mi><mrow id="S3.SS1.p2.2.m2.1.3.3"><msup id="S3.SS1.p2.2.m2.1.3.3.2"><mi id="S3.SS1.p2.2.m2.1.3.3.2.2">P</mi><mn id="S3.SS1.p2.2.m2.1.3.3.2.3">2</mn></msup><mo id="S3.SS1.p2.2.m2.1.3.3.1" lspace="0.222em" rspace="0.222em">⋅</mo><mi id="S3.SS1.p2.2.m2.1.3.3.3">C</mi></mrow></msup><mo fence="false" id="S3.SS1.p2.2.m2.1.4" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS1.p2.2.m2.1.5">i</mi><mo id="S3.SS1.p2.2.m2.1.6">=</mo><mn id="S3.SS1.p2.2.m2.1.7">1</mn><mo id="S3.SS1.p2.2.m2.1.8">,</mo><mo id="S3.SS1.p2.2.m2.1.9" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.SS1.p2.2.m2.1.10" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S3.SS1.p2.2.m2.1.11">,</mo><mi id="S3.SS1.p2.2.m2.1.12">N</mi><mo id="S3.SS1.p2.2.m2.1.13" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\bm{\mathrm{x}}^{i}_{p}\in\mathbb{R}^{P^{2}\cdot C}|i=1,..,N\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_C end_POSTSUPERSCRIPT | italic_i = 1 , . . , italic_N }</annotation></semantics></math>, where each patch is of size <math alttext="P\times P" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">P</mi><mo id="S3.SS1.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.3.m3.1.1.1.cmml">×</mo><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><times id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></times><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑃</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">P\times P</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_P × italic_P</annotation></semantics></math> and <math alttext="N=\frac{HW}{P^{2}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">=</mo><mfrac id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mrow id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2.2" xref="S3.SS1.p2.4.m4.1.1.3.2.2.cmml">H</mi><mo id="S3.SS1.p2.4.m4.1.1.3.2.1" xref="S3.SS1.p2.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.2.3" xref="S3.SS1.p2.4.m4.1.1.3.2.3.cmml">W</mi></mrow><msup id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.2.cmml">P</mi><mn id="S3.SS1.p2.4.m4.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></eq><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑁</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><divide id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3"></divide><apply id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2"><times id="S3.SS1.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.2">𝐻</ci><ci id="S3.SS1.p2.4.m4.1.1.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.3">𝑊</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2">𝑃</ci><cn id="S3.SS1.p2.4.m4.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">N=\frac{HW}{P^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_N = divide start_ARG italic_H italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is the number of image patches (<em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.4.2">i.e.</em>, the input sequence length).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.2.1">Patch Embedding.</span> We map the vectorized patches <math alttext="\bm{\mathrm{x}}_{p}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝐱</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\bm{\mathrm{x}}_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> into a latent <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_D</annotation></semantics></math>-dimensional embedding space using a trainable linear projection.
To encode the patch spatial information, we learn specific position embeddings which are added to the patch embeddings to retain positional information as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{\mathrm{z}}_{0}" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><msub id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">𝐳</mi><mn id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝐳</ci><cn id="S3.E1.m1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\bm{\mathrm{z}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">bold_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[\bm{\mathrm{x}}^{1}_{p}\bm{\mathrm{E}};\,\bm{\mathrm{x}}^{2}_{p%
}\bm{\mathrm{E}};\cdots;\,\bm{\mathrm{x}}^{N}_{p}\bm{\mathrm{E}}]+\bm{\mathrm{%
E}}_{pos}," class="ltx_Math" display="inline" id="S3.E1.m2.2"><semantics id="S3.E1.m2.2a"><mrow id="S3.E1.m2.2.2.1" xref="S3.E1.m2.2.2.1.1.cmml"><mrow id="S3.E1.m2.2.2.1.1" xref="S3.E1.m2.2.2.1.1.cmml"><mi id="S3.E1.m2.2.2.1.1.5" xref="S3.E1.m2.2.2.1.1.5.cmml"></mi><mo id="S3.E1.m2.2.2.1.1.4" xref="S3.E1.m2.2.2.1.1.4.cmml">=</mo><mrow id="S3.E1.m2.2.2.1.1.3" xref="S3.E1.m2.2.2.1.1.3.cmml"><mrow id="S3.E1.m2.2.2.1.1.3.3.3" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml"><mo id="S3.E1.m2.2.2.1.1.3.3.3.4" stretchy="false" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml">[</mo><mrow id="S3.E1.m2.2.2.1.1.1.1.1.1" xref="S3.E1.m2.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E1.m2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.2.cmml">𝐱</mi><mi id="S3.E1.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.3.cmml">p</mi><mn id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S3.E1.m2.2.2.1.1.1.1.1.1.1" xref="S3.E1.m2.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m2.2.2.1.1.1.1.1.1.3.cmml">𝐄</mi></mrow><mo id="S3.E1.m2.2.2.1.1.3.3.3.5" rspace="0.337em" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml">;</mo><mrow id="S3.E1.m2.2.2.1.1.2.2.2.2" xref="S3.E1.m2.2.2.1.1.2.2.2.2.cmml"><msubsup id="S3.E1.m2.2.2.1.1.2.2.2.2.2" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.2.cmml">𝐱</mi><mi id="S3.E1.m2.2.2.1.1.2.2.2.2.2.3" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.3.cmml">p</mi><mn id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E1.m2.2.2.1.1.2.2.2.2.1" xref="S3.E1.m2.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E1.m2.2.2.1.1.2.2.2.2.3" xref="S3.E1.m2.2.2.1.1.2.2.2.2.3.cmml">𝐄</mi></mrow><mo id="S3.E1.m2.2.2.1.1.3.3.3.6" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml">;</mo><mi id="S3.E1.m2.1.1" mathvariant="normal" xref="S3.E1.m2.1.1.cmml">⋯</mi><mo id="S3.E1.m2.2.2.1.1.3.3.3.7" rspace="0.337em" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml">;</mo><mrow id="S3.E1.m2.2.2.1.1.3.3.3.3" xref="S3.E1.m2.2.2.1.1.3.3.3.3.cmml"><msubsup id="S3.E1.m2.2.2.1.1.3.3.3.3.2" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.cmml"><mi id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.2" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.2.cmml">𝐱</mi><mi id="S3.E1.m2.2.2.1.1.3.3.3.3.2.3" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.3.cmml">p</mi><mi id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.3" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.3.cmml">N</mi></msubsup><mo id="S3.E1.m2.2.2.1.1.3.3.3.3.1" xref="S3.E1.m2.2.2.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E1.m2.2.2.1.1.3.3.3.3.3" xref="S3.E1.m2.2.2.1.1.3.3.3.3.3.cmml">𝐄</mi></mrow><mo id="S3.E1.m2.2.2.1.1.3.3.3.8" stretchy="false" xref="S3.E1.m2.2.2.1.1.3.3.4.cmml">]</mo></mrow><mo id="S3.E1.m2.2.2.1.1.3.4" xref="S3.E1.m2.2.2.1.1.3.4.cmml">+</mo><msub id="S3.E1.m2.2.2.1.1.3.5" xref="S3.E1.m2.2.2.1.1.3.5.cmml"><mi id="S3.E1.m2.2.2.1.1.3.5.2" xref="S3.E1.m2.2.2.1.1.3.5.2.cmml">𝐄</mi><mrow id="S3.E1.m2.2.2.1.1.3.5.3" xref="S3.E1.m2.2.2.1.1.3.5.3.cmml"><mi id="S3.E1.m2.2.2.1.1.3.5.3.2" xref="S3.E1.m2.2.2.1.1.3.5.3.2.cmml">p</mi><mo id="S3.E1.m2.2.2.1.1.3.5.3.1" xref="S3.E1.m2.2.2.1.1.3.5.3.1.cmml">⁢</mo><mi id="S3.E1.m2.2.2.1.1.3.5.3.3" xref="S3.E1.m2.2.2.1.1.3.5.3.3.cmml">o</mi><mo id="S3.E1.m2.2.2.1.1.3.5.3.1a" xref="S3.E1.m2.2.2.1.1.3.5.3.1.cmml">⁢</mo><mi id="S3.E1.m2.2.2.1.1.3.5.3.4" xref="S3.E1.m2.2.2.1.1.3.5.3.4.cmml">s</mi></mrow></msub></mrow></mrow><mo id="S3.E1.m2.2.2.1.2" xref="S3.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.2b"><apply id="S3.E1.m2.2.2.1.1.cmml" xref="S3.E1.m2.2.2.1"><eq id="S3.E1.m2.2.2.1.1.4.cmml" xref="S3.E1.m2.2.2.1.1.4"></eq><csymbol cd="latexml" id="S3.E1.m2.2.2.1.1.5.cmml" xref="S3.E1.m2.2.2.1.1.5">absent</csymbol><apply id="S3.E1.m2.2.2.1.1.3.cmml" xref="S3.E1.m2.2.2.1.1.3"><plus id="S3.E1.m2.2.2.1.1.3.4.cmml" xref="S3.E1.m2.2.2.1.1.3.4"></plus><list id="S3.E1.m2.2.2.1.1.3.3.4.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3"><apply id="S3.E1.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1"><times id="S3.E1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E1.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.2">𝐱</ci><cn id="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S3.E1.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.E1.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m2.2.2.1.1.1.1.1.1.3">𝐄</ci></apply><apply id="S3.E1.m2.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2"><times id="S3.E1.m2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.1"></times><apply id="S3.E1.m2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.2">𝐱</ci><cn id="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.E1.m2.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.2.3">𝑝</ci></apply><ci id="S3.E1.m2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E1.m2.2.2.1.1.2.2.2.2.3">𝐄</ci></apply><ci id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1">⋯</ci><apply id="S3.E1.m2.2.2.1.1.3.3.3.3.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3"><times id="S3.E1.m2.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.1"></times><apply id="S3.E1.m2.2.2.1.1.3.3.3.3.2.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.3.3.3.3.2.1.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2">subscript</csymbol><apply id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.1.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2">superscript</csymbol><ci id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.2.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.2">𝐱</ci><ci id="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.3.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.2.3">𝑁</ci></apply><ci id="S3.E1.m2.2.2.1.1.3.3.3.3.2.3.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.2.3">𝑝</ci></apply><ci id="S3.E1.m2.2.2.1.1.3.3.3.3.3.cmml" xref="S3.E1.m2.2.2.1.1.3.3.3.3.3">𝐄</ci></apply></list><apply id="S3.E1.m2.2.2.1.1.3.5.cmml" xref="S3.E1.m2.2.2.1.1.3.5"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.1.3.5.1.cmml" xref="S3.E1.m2.2.2.1.1.3.5">subscript</csymbol><ci id="S3.E1.m2.2.2.1.1.3.5.2.cmml" xref="S3.E1.m2.2.2.1.1.3.5.2">𝐄</ci><apply id="S3.E1.m2.2.2.1.1.3.5.3.cmml" xref="S3.E1.m2.2.2.1.1.3.5.3"><times id="S3.E1.m2.2.2.1.1.3.5.3.1.cmml" xref="S3.E1.m2.2.2.1.1.3.5.3.1"></times><ci id="S3.E1.m2.2.2.1.1.3.5.3.2.cmml" xref="S3.E1.m2.2.2.1.1.3.5.3.2">𝑝</ci><ci id="S3.E1.m2.2.2.1.1.3.5.3.3.cmml" xref="S3.E1.m2.2.2.1.1.3.5.3.3">𝑜</ci><ci id="S3.E1.m2.2.2.1.1.3.5.3.4.cmml" xref="S3.E1.m2.2.2.1.1.3.5.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.2c">\displaystyle=[\bm{\mathrm{x}}^{1}_{p}\bm{\mathrm{E}};\,\bm{\mathrm{x}}^{2}_{p%
}\bm{\mathrm{E}};\cdots;\,\bm{\mathrm{x}}^{N}_{p}\bm{\mathrm{E}}]+\bm{\mathrm{%
E}}_{pos},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m2.2d">= [ bold_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT bold_E ; bold_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT bold_E ; ⋯ ; bold_x start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT bold_E ] + bold_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">where <math alttext="\bm{\mathrm{E}}\in\mathbb{R}^{(P^{2}\cdot C)\times D}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2" xref="S3.SS1.p4.1.m1.1.2.2.cmml">𝐄</mi><mo id="S3.SS1.p4.1.m1.1.2.1" xref="S3.SS1.p4.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.1.2.3" xref="S3.SS1.p4.1.m1.1.2.3.cmml"><mi id="S3.SS1.p4.1.m1.1.2.3.2" xref="S3.SS1.p4.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><msup id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p4.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS1.p4.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS1.p4.1.m1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><in id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.1"></in><ci id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2">𝐄</ci><apply id="S3.SS1.p4.1.m1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.3.1.cmml" xref="S3.SS1.p4.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.2.3.2.cmml" xref="S3.SS1.p4.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.2"></times><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1"><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3">𝐶</ci></apply><ci id="S3.SS1.p4.1.m1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\bm{\mathrm{E}}\in\mathbb{R}^{(P^{2}\cdot C)\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_C ) × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the patch embedding projection, and <math alttext="\bm{\mathrm{E}}_{pos}\in\mathbb{R}^{N\times D}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><msub id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">𝐄</mi><mrow id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.3.2" xref="S3.SS1.p4.2.m2.1.1.2.3.2.cmml">p</mi><mo id="S3.SS1.p4.2.m2.1.1.2.3.1" xref="S3.SS1.p4.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.3.3" xref="S3.SS1.p4.2.m2.1.1.2.3.3.cmml">o</mi><mo id="S3.SS1.p4.2.m2.1.1.2.3.1a" xref="S3.SS1.p4.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.3.4" xref="S3.SS1.p4.2.m2.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.3.2" xref="S3.SS1.p4.2.m2.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p4.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.2.m2.1.1.3.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><in id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></in><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝐄</ci><apply id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3"><times id="S3.SS1.p4.2.m2.1.1.2.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3.1"></times><ci id="S3.SS1.p4.2.m2.1.1.2.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3.2">𝑝</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3.3">𝑜</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.4.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3"><times id="S3.SS1.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\bm{\mathrm{E}}_{pos}\in\mathbb{R}^{N\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">bold_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the position embedding.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">The concatenated sequence <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">bold_T</annotation></semantics></math> is processed through the Transformer encoder layers to yield the final representations. Following the the architecture of the vanilla ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib31" title="">31</a>]</cite>, we employ multi-headed self-attention (MSA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib30" title="">30</a>]</cite> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.E3" title="Equation 3 ‣ 3.1 TransUNet for Cell Segmentation ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3</span></a>) and multi-layer perceptron (MLP) blocks (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.E4" title="Equation 4 ‣ 3.1 TransUNet for Cell Segmentation ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4</span></a>). Layer normalization (LN) is applied before each block (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.E5" title="Equation 5 ‣ 3.1 TransUNet for Cell Segmentation ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">5</span></a>), as described in the following equations:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Z}_{0}" class="ltx_Math" display="inline" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝐙</mi><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐙</ci><cn id="S3.E2.m1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathbf{Z}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">bold_Z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{T}," class="ltx_Math" display="inline" id="S3.E2.m2.1"><semantics id="S3.E2.m2.1a"><mrow id="S3.E2.m2.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mrow id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mi id="S3.E2.m2.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E2.m2.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.cmml">=</mo><mi id="S3.E2.m2.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.3.cmml">𝐓</mi></mrow><mo id="S3.E2.m2.1.1.1.2" xref="S3.E2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><apply id="S3.E2.m2.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1"><eq id="S3.E2.m2.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E2.m2.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.2">absent</csymbol><ci id="S3.E2.m2.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=\mathbf{T},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m2.1d">= bold_T ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Z}^{\prime}_{\ell}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><msubsup id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">𝐙</mi><mi id="S3.E3.m1.1.1.3" mathvariant="normal" xref="S3.E3.m1.1.1.3.cmml">ℓ</mi><mo id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝐙</ci><ci id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3">′</ci></apply><ci id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\mathbf{Z}^{\prime}_{\ell}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">bold_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{MSA}(\text{LN}(\mathbf{Z}_{\ell-1}))+\mathbf{Z}_{\ell-1},%
\quad\ell=1\ldots L," class="ltx_Math" display="inline" id="S3.E3.m2.1"><semantics id="S3.E3.m2.1a"><mrow id="S3.E3.m2.1.1.1"><mrow id="S3.E3.m2.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.3.cmml"><mrow id="S3.E3.m2.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.3.cmml"></mi><mo id="S3.E3.m2.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E3.m2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.3a.cmml">MSA</mtext><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐙</mi><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ℓ</mi><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m2.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E3.m2.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.3.2" xref="S3.E3.m2.1.1.1.1.1.1.1.3.2.cmml">𝐙</mi><mrow id="S3.E3.m2.1.1.1.1.1.1.1.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.3.3.2" mathvariant="normal" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.2.cmml">ℓ</mi><mo id="S3.E3.m2.1.1.1.1.1.1.1.3.3.1" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E3.m2.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.E3.m2.1.1.1.1.2.3" rspace="1.167em" xref="S3.E3.m2.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E3.m2.1.1.1.1.2.2" xref="S3.E3.m2.1.1.1.1.2.2.cmml"><mi id="S3.E3.m2.1.1.1.1.2.2.2" mathvariant="normal" xref="S3.E3.m2.1.1.1.1.2.2.2.cmml">ℓ</mi><mo id="S3.E3.m2.1.1.1.1.2.2.1" xref="S3.E3.m2.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E3.m2.1.1.1.1.2.2.3" xref="S3.E3.m2.1.1.1.1.2.2.3.cmml"><mn id="S3.E3.m2.1.1.1.1.2.2.3.2" xref="S3.E3.m2.1.1.1.1.2.2.3.2.cmml">1</mn><mo id="S3.E3.m2.1.1.1.1.2.2.3.1" xref="S3.E3.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m2.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S3.E3.m2.1.1.1.1.2.2.3.3.cmml">…</mi><mo id="S3.E3.m2.1.1.1.1.2.2.3.1a" xref="S3.E3.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m2.1.1.1.1.2.2.3.4" xref="S3.E3.m2.1.1.1.1.2.2.3.4.cmml">L</mi></mrow></mrow></mrow><mo id="S3.E3.m2.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.1b"><apply id="S3.E3.m2.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.3a.cmml" xref="S3.E3.m2.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m2.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1"><eq id="S3.E3.m2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E3.m2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.3">absent</csymbol><apply id="S3.E3.m2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1"><plus id="S3.E3.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.2"></plus><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1"><times id="S3.E3.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.3"><mtext id="S3.E3.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.3">MSA</mtext></ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐙</ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">ℓ</ci><cn id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E3.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3.2">𝐙</ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3"><minus id="S3.E3.m2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E3.m2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.2">ℓ</ci><cn id="S3.E3.m2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E3.m2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E3.m2.1.1.1.1.2.2.cmml" xref="S3.E3.m2.1.1.1.1.2.2"><eq id="S3.E3.m2.1.1.1.1.2.2.1.cmml" xref="S3.E3.m2.1.1.1.1.2.2.1"></eq><ci id="S3.E3.m2.1.1.1.1.2.2.2.cmml" xref="S3.E3.m2.1.1.1.1.2.2.2">ℓ</ci><apply id="S3.E3.m2.1.1.1.1.2.2.3.cmml" xref="S3.E3.m2.1.1.1.1.2.2.3"><times id="S3.E3.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m2.1.1.1.1.2.2.3.1"></times><cn id="S3.E3.m2.1.1.1.1.2.2.3.2.cmml" type="integer" xref="S3.E3.m2.1.1.1.1.2.2.3.2">1</cn><ci id="S3.E3.m2.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m2.1.1.1.1.2.2.3.3">…</ci><ci id="S3.E3.m2.1.1.1.1.2.2.3.4.cmml" xref="S3.E3.m2.1.1.1.1.2.2.3.4">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.1c">\displaystyle=\text{MSA}(\text{LN}(\mathbf{Z}_{\ell-1}))+\mathbf{Z}_{\ell-1},%
\quad\ell=1\ldots L,</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.1d">= MSA ( LN ( bold_Z start_POSTSUBSCRIPT roman_ℓ - 1 end_POSTSUBSCRIPT ) ) + bold_Z start_POSTSUBSCRIPT roman_ℓ - 1 end_POSTSUBSCRIPT , roman_ℓ = 1 … italic_L ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Z}_{\ell}" class="ltx_Math" display="inline" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><msub id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">𝐙</mi><mi id="S3.E4.m1.1.1.3" mathvariant="normal" xref="S3.E4.m1.1.1.3.cmml">ℓ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">𝐙</ci><ci id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\mathbf{Z}_{\ell}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_Z start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{MLP}(\text{LN}(\mathbf{Z}^{\prime}_{\ell}))+\mathbf{Z}^{%
\prime}_{\ell},\quad\ell=1\ldots L," class="ltx_Math" display="inline" id="S3.E4.m2.1"><semantics id="S3.E4.m2.1a"><mrow id="S3.E4.m2.1.1.1"><mrow id="S3.E4.m2.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.3.cmml"><mrow id="S3.E4.m2.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.1.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.3.cmml"></mi><mo id="S3.E4.m2.1.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m2.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m2.1.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mi id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ℓ</mi><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m2.1.1.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.1.2.cmml">+</mo><msubsup id="S3.E4.m2.1.1.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m2.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m2.1.1.1.1.1.1.1.3.2.2.cmml">𝐙</mi><mi id="S3.E4.m2.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S3.E4.m2.1.1.1.1.1.1.1.3.3.cmml">ℓ</mi><mo id="S3.E4.m2.1.1.1.1.1.1.1.3.2.3" xref="S3.E4.m2.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.E4.m2.1.1.1.1.2.3" rspace="1.167em" xref="S3.E4.m2.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E4.m2.1.1.1.1.2.2" xref="S3.E4.m2.1.1.1.1.2.2.cmml"><mi id="S3.E4.m2.1.1.1.1.2.2.2" mathvariant="normal" xref="S3.E4.m2.1.1.1.1.2.2.2.cmml">ℓ</mi><mo id="S3.E4.m2.1.1.1.1.2.2.1" xref="S3.E4.m2.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E4.m2.1.1.1.1.2.2.3" xref="S3.E4.m2.1.1.1.1.2.2.3.cmml"><mn id="S3.E4.m2.1.1.1.1.2.2.3.2" xref="S3.E4.m2.1.1.1.1.2.2.3.2.cmml">1</mn><mo id="S3.E4.m2.1.1.1.1.2.2.3.1" xref="S3.E4.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S3.E4.m2.1.1.1.1.2.2.3.3.cmml">…</mi><mo id="S3.E4.m2.1.1.1.1.2.2.3.1a" xref="S3.E4.m2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.1.1.1.1.2.2.3.4" xref="S3.E4.m2.1.1.1.1.2.2.3.4.cmml">L</mi></mrow></mrow></mrow><mo id="S3.E4.m2.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.1b"><apply id="S3.E4.m2.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.3a.cmml" xref="S3.E4.m2.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m2.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1"><eq id="S3.E4.m2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E4.m2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.3">absent</csymbol><apply id="S3.E4.m2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1"><plus id="S3.E4.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.2"></plus><apply id="S3.E4.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1"><times id="S3.E4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.3"><mtext id="S3.E4.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐙</ci><ci id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ℓ</ci></apply></apply></apply><apply id="S3.E4.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3.2.2">𝐙</ci><ci id="S3.E4.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E4.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1.3.3">ℓ</ci></apply></apply></apply><apply id="S3.E4.m2.1.1.1.1.2.2.cmml" xref="S3.E4.m2.1.1.1.1.2.2"><eq id="S3.E4.m2.1.1.1.1.2.2.1.cmml" xref="S3.E4.m2.1.1.1.1.2.2.1"></eq><ci id="S3.E4.m2.1.1.1.1.2.2.2.cmml" xref="S3.E4.m2.1.1.1.1.2.2.2">ℓ</ci><apply id="S3.E4.m2.1.1.1.1.2.2.3.cmml" xref="S3.E4.m2.1.1.1.1.2.2.3"><times id="S3.E4.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m2.1.1.1.1.2.2.3.1"></times><cn id="S3.E4.m2.1.1.1.1.2.2.3.2.cmml" type="integer" xref="S3.E4.m2.1.1.1.1.2.2.3.2">1</cn><ci id="S3.E4.m2.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m2.1.1.1.1.2.2.3.3">…</ci><ci id="S3.E4.m2.1.1.1.1.2.2.3.4.cmml" xref="S3.E4.m2.1.1.1.1.2.2.3.4">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.1c">\displaystyle=\text{MLP}(\text{LN}(\mathbf{Z}^{\prime}_{\ell}))+\mathbf{Z}^{%
\prime}_{\ell},\quad\ell=1\ldots L,</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m2.1d">= MLP ( LN ( bold_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT ) ) + bold_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT , roman_ℓ = 1 … italic_L ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Y}" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\mathbf{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_Y</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{LN}(\mathbf{Z}_{L}[0])," class="ltx_Math" display="inline" id="S3.E5.m2.2"><semantics id="S3.E5.m2.2a"><mrow id="S3.E5.m2.2.2.1" xref="S3.E5.m2.2.2.1.1.cmml"><mrow id="S3.E5.m2.2.2.1.1" xref="S3.E5.m2.2.2.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.3" xref="S3.E5.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E5.m2.2.2.1.1.2" xref="S3.E5.m2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m2.2.2.1.1.1" xref="S3.E5.m2.2.2.1.1.1.cmml"><mtext id="S3.E5.m2.2.2.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.3a.cmml">LN</mtext><mo id="S3.E5.m2.2.2.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E5.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.cmml">𝐙</mi><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.3.cmml">L</mi></msub><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.1.cmml">[</mo><mn id="S3.E5.m2.1.1" xref="S3.E5.m2.1.1.cmml">0</mn><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m2.2.2.1.2" xref="S3.E5.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.2b"><apply id="S3.E5.m2.2.2.1.1.cmml" xref="S3.E5.m2.2.2.1"><eq id="S3.E5.m2.2.2.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E5.m2.2.2.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E5.m2.2.2.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1"><times id="S3.E5.m2.2.2.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.2"></times><ci id="S3.E5.m2.2.2.1.1.1.3a.cmml" xref="S3.E5.m2.2.2.1.1.1.3"><mtext id="S3.E5.m2.2.2.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.3">LN</mtext></ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1"><times id="S3.E5.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2">𝐙</ci><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E5.m2.2.2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.2.1">delimited-[]</csymbol><cn id="S3.E5.m2.1.1.cmml" type="integer" xref="S3.E5.m2.1.1">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.2c">\displaystyle=\text{LN}(\mathbf{Z}_{L}[0]),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m2.2d">= LN ( bold_Z start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT [ 0 ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.8">where <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_L</annotation></semantics></math> denotes the number of Transformer layers, and <math alttext="\mathbf{Z}_{L}[0]" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><mrow id="S3.SS1.p6.2.m2.1.2" xref="S3.SS1.p6.2.m2.1.2.cmml"><msub id="S3.SS1.p6.2.m2.1.2.2" xref="S3.SS1.p6.2.m2.1.2.2.cmml"><mi id="S3.SS1.p6.2.m2.1.2.2.2" xref="S3.SS1.p6.2.m2.1.2.2.2.cmml">𝐙</mi><mi id="S3.SS1.p6.2.m2.1.2.2.3" xref="S3.SS1.p6.2.m2.1.2.2.3.cmml">L</mi></msub><mo id="S3.SS1.p6.2.m2.1.2.1" xref="S3.SS1.p6.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p6.2.m2.1.2.3.2" xref="S3.SS1.p6.2.m2.1.2.3.1.cmml"><mo id="S3.SS1.p6.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p6.2.m2.1.2.3.1.1.cmml">[</mo><mn id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">0</mn><mo id="S3.SS1.p6.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p6.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.2.cmml" xref="S3.SS1.p6.2.m2.1.2"><times id="S3.SS1.p6.2.m2.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.2.1"></times><apply id="S3.SS1.p6.2.m2.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.2.2.1.cmml" xref="S3.SS1.p6.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.2.2.2.cmml" xref="S3.SS1.p6.2.m2.1.2.2.2">𝐙</ci><ci id="S3.SS1.p6.2.m2.1.2.2.3.cmml" xref="S3.SS1.p6.2.m2.1.2.2.3">𝐿</ci></apply><apply id="S3.SS1.p6.2.m2.1.2.3.1.cmml" xref="S3.SS1.p6.2.m2.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.p6.2.m2.1.2.3.1.1.cmml" xref="S3.SS1.p6.2.m2.1.2.3.2.1">delimited-[]</csymbol><cn id="S3.SS1.p6.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p6.2.m2.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\mathbf{Z}_{L}[0]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">bold_Z start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT [ 0 ]</annotation></semantics></math> represents the final layer’s class token representation. The output <math alttext="\mathbf{Y}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m3.1"><semantics id="S3.SS1.p6.3.m3.1a"><mrow id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml"><mi id="S3.SS1.p6.3.m3.1.1.2" xref="S3.SS1.p6.3.m3.1.1.2.cmml">𝐘</mi><mo id="S3.SS1.p6.3.m3.1.1.1" xref="S3.SS1.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p6.3.m3.1.1.3" xref="S3.SS1.p6.3.m3.1.1.3.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.2" xref="S3.SS1.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p6.3.m3.1.1.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1"><in id="S3.SS1.p6.3.m3.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1.1"></in><ci id="S3.SS1.p6.3.m3.1.1.2.cmml" xref="S3.SS1.p6.3.m3.1.1.2">𝐘</ci><apply id="S3.SS1.p6.3.m3.1.1.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.p6.3.m3.1.1.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">\mathbf{Y}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m3.1d">bold_Y ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> serves as the input to a classifier head for the task at hand. For segmentation, an effective approach is to upsample the encoded feature representation <math alttext="\bm{\mathrm{z}}_{L}\in\mathbb{R}^{\frac{HW}{P^{2}}\times D}" class="ltx_Math" display="inline" id="S3.SS1.p6.4.m4.1"><semantics id="S3.SS1.p6.4.m4.1a"><mrow id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml"><msub id="S3.SS1.p6.4.m4.1.1.2" xref="S3.SS1.p6.4.m4.1.1.2.cmml"><mi id="S3.SS1.p6.4.m4.1.1.2.2" xref="S3.SS1.p6.4.m4.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS1.p6.4.m4.1.1.2.3" xref="S3.SS1.p6.4.m4.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS1.p6.4.m4.1.1.1" xref="S3.SS1.p6.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p6.4.m4.1.1.3" xref="S3.SS1.p6.4.m4.1.1.3.cmml"><mi id="S3.SS1.p6.4.m4.1.1.3.2" xref="S3.SS1.p6.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p6.4.m4.1.1.3.3" xref="S3.SS1.p6.4.m4.1.1.3.3.cmml"><mfrac id="S3.SS1.p6.4.m4.1.1.3.3.2" xref="S3.SS1.p6.4.m4.1.1.3.3.2.cmml"><mrow id="S3.SS1.p6.4.m4.1.1.3.3.2.2" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p6.4.m4.1.1.3.3.2.2.2" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.2.cmml">H</mi><mo id="S3.SS1.p6.4.m4.1.1.3.3.2.2.1" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p6.4.m4.1.1.3.3.2.2.3" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.3.cmml">W</mi></mrow><msup id="S3.SS1.p6.4.m4.1.1.3.3.2.3" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p6.4.m4.1.1.3.3.2.3.2" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3.2.cmml">P</mi><mn id="S3.SS1.p6.4.m4.1.1.3.3.2.3.3" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3.3.cmml">2</mn></msup></mfrac><mo id="S3.SS1.p6.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p6.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p6.4.m4.1.1.3.3.3" xref="S3.SS1.p6.4.m4.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><apply id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1"><in id="S3.SS1.p6.4.m4.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1.1"></in><apply id="S3.SS1.p6.4.m4.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.2.1.cmml" xref="S3.SS1.p6.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.2.2.cmml" xref="S3.SS1.p6.4.m4.1.1.2.2">𝐳</ci><ci id="S3.SS1.p6.4.m4.1.1.2.3.cmml" xref="S3.SS1.p6.4.m4.1.1.2.3">𝐿</ci></apply><apply id="S3.SS1.p6.4.m4.1.1.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.3.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.3.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p6.4.m4.1.1.3.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3"><times id="S3.SS1.p6.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.1"></times><apply id="S3.SS1.p6.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2"><divide id="S3.SS1.p6.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2"></divide><apply id="S3.SS1.p6.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2"><times id="S3.SS1.p6.4.m4.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.1"></times><ci id="S3.SS1.p6.4.m4.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.2">𝐻</ci><ci id="S3.SS1.p6.4.m4.1.1.3.3.2.2.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.2.3">𝑊</ci></apply><apply id="S3.SS1.p6.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3">superscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3.2">𝑃</ci><cn id="S3.SS1.p6.4.m4.1.1.3.3.2.3.3.cmml" type="integer" xref="S3.SS1.p6.4.m4.1.1.3.3.2.3.3">2</cn></apply></apply><ci id="S3.SS1.p6.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">\bm{\mathrm{z}}_{L}\in\mathbb{R}^{\frac{HW}{P^{2}}\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.4.m4.1d">bold_z start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_H italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to the full resolution. This involves reshaping the encoded feature from <math alttext="\frac{HW}{P^{2}}" class="ltx_Math" display="inline" id="S3.SS1.p6.5.m5.1"><semantics id="S3.SS1.p6.5.m5.1a"><mfrac id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml"><mrow id="S3.SS1.p6.5.m5.1.1.2" xref="S3.SS1.p6.5.m5.1.1.2.cmml"><mi id="S3.SS1.p6.5.m5.1.1.2.2" xref="S3.SS1.p6.5.m5.1.1.2.2.cmml">H</mi><mo id="S3.SS1.p6.5.m5.1.1.2.1" xref="S3.SS1.p6.5.m5.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p6.5.m5.1.1.2.3" xref="S3.SS1.p6.5.m5.1.1.2.3.cmml">W</mi></mrow><msup id="S3.SS1.p6.5.m5.1.1.3" xref="S3.SS1.p6.5.m5.1.1.3.cmml"><mi id="S3.SS1.p6.5.m5.1.1.3.2" xref="S3.SS1.p6.5.m5.1.1.3.2.cmml">P</mi><mn id="S3.SS1.p6.5.m5.1.1.3.3" xref="S3.SS1.p6.5.m5.1.1.3.3.cmml">2</mn></msup></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"><divide id="S3.SS1.p6.5.m5.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"></divide><apply id="S3.SS1.p6.5.m5.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2"><times id="S3.SS1.p6.5.m5.1.1.2.1.cmml" xref="S3.SS1.p6.5.m5.1.1.2.1"></times><ci id="S3.SS1.p6.5.m5.1.1.2.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2.2">𝐻</ci><ci id="S3.SS1.p6.5.m5.1.1.2.3.cmml" xref="S3.SS1.p6.5.m5.1.1.2.3">𝑊</ci></apply><apply id="S3.SS1.p6.5.m5.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.3.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.3.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.2">𝑃</ci><cn id="S3.SS1.p6.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS1.p6.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">\frac{HW}{P^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.5.m5.1d">divide start_ARG italic_H italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> to <math alttext="\frac{H}{P}\times\frac{W}{P}" class="ltx_Math" display="inline" id="S3.SS1.p6.6.m6.1"><semantics id="S3.SS1.p6.6.m6.1a"><mrow id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml"><mfrac id="S3.SS1.p6.6.m6.1.1.2" xref="S3.SS1.p6.6.m6.1.1.2.cmml"><mi id="S3.SS1.p6.6.m6.1.1.2.2" xref="S3.SS1.p6.6.m6.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p6.6.m6.1.1.2.3" xref="S3.SS1.p6.6.m6.1.1.2.3.cmml">P</mi></mfrac><mo id="S3.SS1.p6.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p6.6.m6.1.1.1.cmml">×</mo><mfrac id="S3.SS1.p6.6.m6.1.1.3" xref="S3.SS1.p6.6.m6.1.1.3.cmml"><mi id="S3.SS1.p6.6.m6.1.1.3.2" xref="S3.SS1.p6.6.m6.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p6.6.m6.1.1.3.3" xref="S3.SS1.p6.6.m6.1.1.3.3.cmml">P</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><apply id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1"><times id="S3.SS1.p6.6.m6.1.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1.1"></times><apply id="S3.SS1.p6.6.m6.1.1.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2"><divide id="S3.SS1.p6.6.m6.1.1.2.1.cmml" xref="S3.SS1.p6.6.m6.1.1.2"></divide><ci id="S3.SS1.p6.6.m6.1.1.2.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2.2">𝐻</ci><ci id="S3.SS1.p6.6.m6.1.1.2.3.cmml" xref="S3.SS1.p6.6.m6.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p6.6.m6.1.1.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3"><divide id="S3.SS1.p6.6.m6.1.1.3.1.cmml" xref="S3.SS1.p6.6.m6.1.1.3"></divide><ci id="S3.SS1.p6.6.m6.1.1.3.2.cmml" xref="S3.SS1.p6.6.m6.1.1.3.2">𝑊</ci><ci id="S3.SS1.p6.6.m6.1.1.3.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">\frac{H}{P}\times\frac{W}{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.6.m6.1d">divide start_ARG italic_H end_ARG start_ARG italic_P end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_P end_ARG</annotation></semantics></math>, applying a <math alttext="1\times 1" class="ltx_Math" display="inline" id="S3.SS1.p6.7.m7.1"><semantics id="S3.SS1.p6.7.m7.1a"><mrow id="S3.SS1.p6.7.m7.1.1" xref="S3.SS1.p6.7.m7.1.1.cmml"><mn id="S3.SS1.p6.7.m7.1.1.2" xref="S3.SS1.p6.7.m7.1.1.2.cmml">1</mn><mo id="S3.SS1.p6.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p6.7.m7.1.1.1.cmml">×</mo><mn id="S3.SS1.p6.7.m7.1.1.3" xref="S3.SS1.p6.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m7.1b"><apply id="S3.SS1.p6.7.m7.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1"><times id="S3.SS1.p6.7.m7.1.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1.1"></times><cn id="S3.SS1.p6.7.m7.1.1.2.cmml" type="integer" xref="S3.SS1.p6.7.m7.1.1.2">1</cn><cn id="S3.SS1.p6.7.m7.1.1.3.cmml" type="integer" xref="S3.SS1.p6.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m7.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.7.m7.1d">1 × 1</annotation></semantics></math> convolution to reduce the channel size to the number of classes, and then bilinearly upsampling the feature map to the full resolution <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.p6.8.m8.1"><semantics id="S3.SS1.p6.8.m8.1a"><mrow id="S3.SS1.p6.8.m8.1.1" xref="S3.SS1.p6.8.m8.1.1.cmml"><mi id="S3.SS1.p6.8.m8.1.1.2" xref="S3.SS1.p6.8.m8.1.1.2.cmml">H</mi><mo id="S3.SS1.p6.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p6.8.m8.1.1.1.cmml">×</mo><mi id="S3.SS1.p6.8.m8.1.1.3" xref="S3.SS1.p6.8.m8.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.8.m8.1b"><apply id="S3.SS1.p6.8.m8.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1"><times id="S3.SS1.p6.8.m8.1.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1.1"></times><ci id="S3.SS1.p6.8.m8.1.1.2.cmml" xref="S3.SS1.p6.8.m8.1.1.2">𝐻</ci><ci id="S3.SS1.p6.8.m8.1.1.3.cmml" xref="S3.SS1.p6.8.m8.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.8.m8.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.8.m8.1d">italic_H × italic_W</annotation></semantics></math> for the final segmentation outcome.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.3">Due to the limited dimensions of ViT input tokens, input image patch sizes <math alttext="\frac{H}{P}\times\frac{W}{P}" class="ltx_Math" display="inline" id="S3.SS1.p7.1.m1.1"><semantics id="S3.SS1.p7.1.m1.1a"><mrow id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml"><mfrac id="S3.SS1.p7.1.m1.1.1.2" xref="S3.SS1.p7.1.m1.1.1.2.cmml"><mi id="S3.SS1.p7.1.m1.1.1.2.2" xref="S3.SS1.p7.1.m1.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p7.1.m1.1.1.2.3" xref="S3.SS1.p7.1.m1.1.1.2.3.cmml">P</mi></mfrac><mo id="S3.SS1.p7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p7.1.m1.1.1.1.cmml">×</mo><mfrac id="S3.SS1.p7.1.m1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.3.cmml"><mi id="S3.SS1.p7.1.m1.1.1.3.2" xref="S3.SS1.p7.1.m1.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p7.1.m1.1.1.3.3" xref="S3.SS1.p7.1.m1.1.1.3.3.cmml">P</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><apply id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1"><times id="S3.SS1.p7.1.m1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1.1"></times><apply id="S3.SS1.p7.1.m1.1.1.2.cmml" xref="S3.SS1.p7.1.m1.1.1.2"><divide id="S3.SS1.p7.1.m1.1.1.2.1.cmml" xref="S3.SS1.p7.1.m1.1.1.2"></divide><ci id="S3.SS1.p7.1.m1.1.1.2.2.cmml" xref="S3.SS1.p7.1.m1.1.1.2.2">𝐻</ci><ci id="S3.SS1.p7.1.m1.1.1.2.3.cmml" xref="S3.SS1.p7.1.m1.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p7.1.m1.1.1.3.cmml" xref="S3.SS1.p7.1.m1.1.1.3"><divide id="S3.SS1.p7.1.m1.1.1.3.1.cmml" xref="S3.SS1.p7.1.m1.1.1.3"></divide><ci id="S3.SS1.p7.1.m1.1.1.3.2.cmml" xref="S3.SS1.p7.1.m1.1.1.3.2">𝑊</ci><ci id="S3.SS1.p7.1.m1.1.1.3.3.cmml" xref="S3.SS1.p7.1.m1.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">\frac{H}{P}\times\frac{W}{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.1.m1.1d">divide start_ARG italic_H end_ARG start_ARG italic_P end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_P end_ARG</annotation></semantics></math> are often much smaller than the original image resolution <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.p7.2.m2.1"><semantics id="S3.SS1.p7.2.m2.1a"><mrow id="S3.SS1.p7.2.m2.1.1" xref="S3.SS1.p7.2.m2.1.1.cmml"><mi id="S3.SS1.p7.2.m2.1.1.2" xref="S3.SS1.p7.2.m2.1.1.2.cmml">H</mi><mo id="S3.SS1.p7.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p7.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS1.p7.2.m2.1.1.3" xref="S3.SS1.p7.2.m2.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.1b"><apply id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1"><times id="S3.SS1.p7.2.m2.1.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1.1"></times><ci id="S3.SS1.p7.2.m2.1.1.2.cmml" xref="S3.SS1.p7.2.m2.1.1.2">𝐻</ci><ci id="S3.SS1.p7.2.m2.1.1.3.cmml" xref="S3.SS1.p7.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.2.m2.1d">italic_H × italic_W</annotation></semantics></math> in high-resolution medical images, leading to a loss of low-level details (e.g., cell shape and boundary). TransUNet addresses this by using a CNN-Transformer hybrid model, where a CNN first extracts a feature map from the input. Patch embedding is then applied to <math alttext="1\times 1" class="ltx_Math" display="inline" id="S3.SS1.p7.3.m3.1"><semantics id="S3.SS1.p7.3.m3.1a"><mrow id="S3.SS1.p7.3.m3.1.1" xref="S3.SS1.p7.3.m3.1.1.cmml"><mn id="S3.SS1.p7.3.m3.1.1.2" xref="S3.SS1.p7.3.m3.1.1.2.cmml">1</mn><mo id="S3.SS1.p7.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p7.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS1.p7.3.m3.1.1.3" xref="S3.SS1.p7.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.1b"><apply id="S3.SS1.p7.3.m3.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1"><times id="S3.SS1.p7.3.m3.1.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1"></times><cn id="S3.SS1.p7.3.m3.1.1.2.cmml" type="integer" xref="S3.SS1.p7.3.m3.1.1.2">1</cn><cn id="S3.SS1.p7.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p7.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.3.m3.1d">1 × 1</annotation></semantics></math> patches from the CNN feature map instead of raw images, ensuring better retention of details. This method’s efficacy is demonstrated in the comparative analysis of different encoders presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.T1" title="Table 1 ‣ 5.3 Comparison with Baselines ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">1</span></a> in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS3" title="5.3 Comparison with Baselines ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">5.3</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p8">
<p class="ltx_p" id="S3.SS1.p8.6"><span class="ltx_text ltx_font_bold" id="S3.SS1.p8.6.1">Cascaded Upsampler.</span>
Instead of naive upsampling in a ViT, a Cascaded Upsampler (CUP) is implemented, consisting of multiple upsampling steps to decode the hidden features and output the final segmentation mask. After reshaping the sequence of hidden features <math alttext="\bm{\mathrm{z}}_{L}\in\mathbb{R}^{\frac{HW}{P^{2}}\times D}" class="ltx_Math" display="inline" id="S3.SS1.p8.1.m1.1"><semantics id="S3.SS1.p8.1.m1.1a"><mrow id="S3.SS1.p8.1.m1.1.1" xref="S3.SS1.p8.1.m1.1.1.cmml"><msub id="S3.SS1.p8.1.m1.1.1.2" xref="S3.SS1.p8.1.m1.1.1.2.cmml"><mi id="S3.SS1.p8.1.m1.1.1.2.2" xref="S3.SS1.p8.1.m1.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS1.p8.1.m1.1.1.2.3" xref="S3.SS1.p8.1.m1.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS1.p8.1.m1.1.1.1" xref="S3.SS1.p8.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p8.1.m1.1.1.3" xref="S3.SS1.p8.1.m1.1.1.3.cmml"><mi id="S3.SS1.p8.1.m1.1.1.3.2" xref="S3.SS1.p8.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p8.1.m1.1.1.3.3" xref="S3.SS1.p8.1.m1.1.1.3.3.cmml"><mfrac id="S3.SS1.p8.1.m1.1.1.3.3.2" xref="S3.SS1.p8.1.m1.1.1.3.3.2.cmml"><mrow id="S3.SS1.p8.1.m1.1.1.3.3.2.2" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p8.1.m1.1.1.3.3.2.2.2" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.2.cmml">H</mi><mo id="S3.SS1.p8.1.m1.1.1.3.3.2.2.1" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p8.1.m1.1.1.3.3.2.2.3" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.3.cmml">W</mi></mrow><msup id="S3.SS1.p8.1.m1.1.1.3.3.2.3" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p8.1.m1.1.1.3.3.2.3.2" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3.2.cmml">P</mi><mn id="S3.SS1.p8.1.m1.1.1.3.3.2.3.3" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3.3.cmml">2</mn></msup></mfrac><mo id="S3.SS1.p8.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p8.1.m1.1.1.3.3.3" xref="S3.SS1.p8.1.m1.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.m1.1b"><apply id="S3.SS1.p8.1.m1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1"><in id="S3.SS1.p8.1.m1.1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1.1"></in><apply id="S3.SS1.p8.1.m1.1.1.2.cmml" xref="S3.SS1.p8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.2.1.cmml" xref="S3.SS1.p8.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.2.2.cmml" xref="S3.SS1.p8.1.m1.1.1.2.2">𝐳</ci><ci id="S3.SS1.p8.1.m1.1.1.2.3.cmml" xref="S3.SS1.p8.1.m1.1.1.2.3">𝐿</ci></apply><apply id="S3.SS1.p8.1.m1.1.1.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.3.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.3.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p8.1.m1.1.1.3.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3"><times id="S3.SS1.p8.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.1"></times><apply id="S3.SS1.p8.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2"><divide id="S3.SS1.p8.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2"></divide><apply id="S3.SS1.p8.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2"><times id="S3.SS1.p8.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.1"></times><ci id="S3.SS1.p8.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.2">𝐻</ci><ci id="S3.SS1.p8.1.m1.1.1.3.3.2.2.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.2.3">𝑊</ci></apply><apply id="S3.SS1.p8.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3">superscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3.2">𝑃</ci><cn id="S3.SS1.p8.1.m1.1.1.3.3.2.3.3.cmml" type="integer" xref="S3.SS1.p8.1.m1.1.1.3.3.2.3.3">2</cn></apply></apply><ci id="S3.SS1.p8.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.m1.1c">\bm{\mathrm{z}}_{L}\in\mathbb{R}^{\frac{HW}{P^{2}}\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.1.m1.1d">bold_z start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_H italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to the shape <math alttext="\frac{H}{P}\times\frac{W}{P}\times D" class="ltx_Math" display="inline" id="S3.SS1.p8.2.m2.1"><semantics id="S3.SS1.p8.2.m2.1a"><mrow id="S3.SS1.p8.2.m2.1.1" xref="S3.SS1.p8.2.m2.1.1.cmml"><mfrac id="S3.SS1.p8.2.m2.1.1.2" xref="S3.SS1.p8.2.m2.1.1.2.cmml"><mi id="S3.SS1.p8.2.m2.1.1.2.2" xref="S3.SS1.p8.2.m2.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p8.2.m2.1.1.2.3" xref="S3.SS1.p8.2.m2.1.1.2.3.cmml">P</mi></mfrac><mo id="S3.SS1.p8.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.2.m2.1.1.1.cmml">×</mo><mfrac id="S3.SS1.p8.2.m2.1.1.3" xref="S3.SS1.p8.2.m2.1.1.3.cmml"><mi id="S3.SS1.p8.2.m2.1.1.3.2" xref="S3.SS1.p8.2.m2.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p8.2.m2.1.1.3.3" xref="S3.SS1.p8.2.m2.1.1.3.3.cmml">P</mi></mfrac><mo id="S3.SS1.p8.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS1.p8.2.m2.1.1.4" xref="S3.SS1.p8.2.m2.1.1.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.m2.1b"><apply id="S3.SS1.p8.2.m2.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1"><times id="S3.SS1.p8.2.m2.1.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1.1"></times><apply id="S3.SS1.p8.2.m2.1.1.2.cmml" xref="S3.SS1.p8.2.m2.1.1.2"><divide id="S3.SS1.p8.2.m2.1.1.2.1.cmml" xref="S3.SS1.p8.2.m2.1.1.2"></divide><ci id="S3.SS1.p8.2.m2.1.1.2.2.cmml" xref="S3.SS1.p8.2.m2.1.1.2.2">𝐻</ci><ci id="S3.SS1.p8.2.m2.1.1.2.3.cmml" xref="S3.SS1.p8.2.m2.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p8.2.m2.1.1.3.cmml" xref="S3.SS1.p8.2.m2.1.1.3"><divide id="S3.SS1.p8.2.m2.1.1.3.1.cmml" xref="S3.SS1.p8.2.m2.1.1.3"></divide><ci id="S3.SS1.p8.2.m2.1.1.3.2.cmml" xref="S3.SS1.p8.2.m2.1.1.3.2">𝑊</ci><ci id="S3.SS1.p8.2.m2.1.1.3.3.cmml" xref="S3.SS1.p8.2.m2.1.1.3.3">𝑃</ci></apply><ci id="S3.SS1.p8.2.m2.1.1.4.cmml" xref="S3.SS1.p8.2.m2.1.1.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.m2.1c">\frac{H}{P}\times\frac{W}{P}\times D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.2.m2.1d">divide start_ARG italic_H end_ARG start_ARG italic_P end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_P end_ARG × italic_D</annotation></semantics></math>, CUP is instantiated by cascading multiple upsampling blocks to reach the full resolution from <math alttext="\frac{H}{P}\times\frac{W}{P}" class="ltx_Math" display="inline" id="S3.SS1.p8.3.m3.1"><semantics id="S3.SS1.p8.3.m3.1a"><mrow id="S3.SS1.p8.3.m3.1.1" xref="S3.SS1.p8.3.m3.1.1.cmml"><mfrac id="S3.SS1.p8.3.m3.1.1.2" xref="S3.SS1.p8.3.m3.1.1.2.cmml"><mi id="S3.SS1.p8.3.m3.1.1.2.2" xref="S3.SS1.p8.3.m3.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p8.3.m3.1.1.2.3" xref="S3.SS1.p8.3.m3.1.1.2.3.cmml">P</mi></mfrac><mo id="S3.SS1.p8.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.3.m3.1.1.1.cmml">×</mo><mfrac id="S3.SS1.p8.3.m3.1.1.3" xref="S3.SS1.p8.3.m3.1.1.3.cmml"><mi id="S3.SS1.p8.3.m3.1.1.3.2" xref="S3.SS1.p8.3.m3.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p8.3.m3.1.1.3.3" xref="S3.SS1.p8.3.m3.1.1.3.3.cmml">P</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.3.m3.1b"><apply id="S3.SS1.p8.3.m3.1.1.cmml" xref="S3.SS1.p8.3.m3.1.1"><times id="S3.SS1.p8.3.m3.1.1.1.cmml" xref="S3.SS1.p8.3.m3.1.1.1"></times><apply id="S3.SS1.p8.3.m3.1.1.2.cmml" xref="S3.SS1.p8.3.m3.1.1.2"><divide id="S3.SS1.p8.3.m3.1.1.2.1.cmml" xref="S3.SS1.p8.3.m3.1.1.2"></divide><ci id="S3.SS1.p8.3.m3.1.1.2.2.cmml" xref="S3.SS1.p8.3.m3.1.1.2.2">𝐻</ci><ci id="S3.SS1.p8.3.m3.1.1.2.3.cmml" xref="S3.SS1.p8.3.m3.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p8.3.m3.1.1.3.cmml" xref="S3.SS1.p8.3.m3.1.1.3"><divide id="S3.SS1.p8.3.m3.1.1.3.1.cmml" xref="S3.SS1.p8.3.m3.1.1.3"></divide><ci id="S3.SS1.p8.3.m3.1.1.3.2.cmml" xref="S3.SS1.p8.3.m3.1.1.3.2">𝑊</ci><ci id="S3.SS1.p8.3.m3.1.1.3.3.cmml" xref="S3.SS1.p8.3.m3.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.3.m3.1c">\frac{H}{P}\times\frac{W}{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.3.m3.1d">divide start_ARG italic_H end_ARG start_ARG italic_P end_ARG × divide start_ARG italic_W end_ARG start_ARG italic_P end_ARG</annotation></semantics></math> to <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.p8.4.m4.1"><semantics id="S3.SS1.p8.4.m4.1a"><mrow id="S3.SS1.p8.4.m4.1.1" xref="S3.SS1.p8.4.m4.1.1.cmml"><mi id="S3.SS1.p8.4.m4.1.1.2" xref="S3.SS1.p8.4.m4.1.1.2.cmml">H</mi><mo id="S3.SS1.p8.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS1.p8.4.m4.1.1.3" xref="S3.SS1.p8.4.m4.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.4.m4.1b"><apply id="S3.SS1.p8.4.m4.1.1.cmml" xref="S3.SS1.p8.4.m4.1.1"><times id="S3.SS1.p8.4.m4.1.1.1.cmml" xref="S3.SS1.p8.4.m4.1.1.1"></times><ci id="S3.SS1.p8.4.m4.1.1.2.cmml" xref="S3.SS1.p8.4.m4.1.1.2">𝐻</ci><ci id="S3.SS1.p8.4.m4.1.1.3.cmml" xref="S3.SS1.p8.4.m4.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.4.m4.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.4.m4.1d">italic_H × italic_W</annotation></semantics></math>. Each block consists of a <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="S3.SS1.p8.5.m5.1"><semantics id="S3.SS1.p8.5.m5.1a"><mrow id="S3.SS1.p8.5.m5.1b"><mn id="S3.SS1.p8.5.m5.1.1">2</mn><mo id="S3.SS1.p8.5.m5.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p8.5.m5.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.5.m5.1d">2 ×</annotation></semantics></math> upsampling operator, a <math alttext="3\times 3" class="ltx_Math" display="inline" id="S3.SS1.p8.6.m6.1"><semantics id="S3.SS1.p8.6.m6.1a"><mrow id="S3.SS1.p8.6.m6.1.1" xref="S3.SS1.p8.6.m6.1.1.cmml"><mn id="S3.SS1.p8.6.m6.1.1.2" xref="S3.SS1.p8.6.m6.1.1.2.cmml">3</mn><mo id="S3.SS1.p8.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p8.6.m6.1.1.1.cmml">×</mo><mn id="S3.SS1.p8.6.m6.1.1.3" xref="S3.SS1.p8.6.m6.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.6.m6.1b"><apply id="S3.SS1.p8.6.m6.1.1.cmml" xref="S3.SS1.p8.6.m6.1.1"><times id="S3.SS1.p8.6.m6.1.1.1.cmml" xref="S3.SS1.p8.6.m6.1.1.1"></times><cn id="S3.SS1.p8.6.m6.1.1.2.cmml" type="integer" xref="S3.SS1.p8.6.m6.1.1.2">3</cn><cn id="S3.SS1.p8.6.m6.1.1.3.cmml" type="integer" xref="S3.SS1.p8.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.6.m6.1c">3\times 3</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p8.6.m6.1d">3 × 3</annotation></semantics></math> convolution layer, and a ReLU layer successively. CUP, together with the hybrid encoder, forms a U-shaped architecture that enables feature aggregation at different resolution levels via skip connections. The upsampling process is also illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S2.F2" title="Figure 2 ‣ 2.2 Virtual Outliers Synthesis ‣ 2 Related Work ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection ltx_indent_first" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Robust Cell Segmentation via Virtual Outlier Sampling</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To enhance the robustness of our model and accurately simulate the different stages of pluripotent carcinoma cells, we propose the sampling of virtual outliers during the training process. Traditional deep learning models for image segmentation typically utilize CNN frameworks, which compress the latent space into lower dimensions through feature extraction. In contrast, our model is built on a Vision Transformer architecture, which poses challenges in synthesizing virtual outliers directly in the high-dimensional <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">pixel space</em> due to its complexity and the optimization difficulties involved. Despite the CNN-Transformer hybrid structure as its encoder in the form of TransUNet, the latent features of high-dimensional images remain in a large matrix. To address this, we opt to sample directly from the output logits of the segmentation map, denoted by <math alttext="s(\mathbf{x}_{i})" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">s</mi><mo id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"></times><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑠</ci><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">s(\mathbf{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_s ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, instead of sampling from the latent space.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Given the generic nature of our method, we establish general notations applicable to similar tasks in image classification or segmentation. We model the features of all target classes as conditional multivariate Gaussian distributions:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx3">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{\theta}(s(\mathbf{x})|y=k)=\mathcal{N}(\boldsymbol{\mu}_{k},%
\boldsymbol{\Sigma})," class="ltx_Math" display="inline" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.3.2.cmml">p</mi><mi id="S3.E6.m1.3.3.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">s</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.3.2.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐱</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.3.2.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.3.cmml">y</mi></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">𝒩</mi><mo id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.1.1" xref="S3.E6.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E6.m1.3.3.1.1.2.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.1.2.cmml">(</mo><msub id="S3.E6.m1.3.3.1.1.2.1.1.1" xref="S3.E6.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.2.1.1.1.2" xref="S3.E6.m1.3.3.1.1.2.1.1.1.2.cmml">𝝁</mi><mi id="S3.E6.m1.3.3.1.1.2.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.1.1.1.3.cmml">k</mi></msub><mo id="S3.E6.m1.3.3.1.1.2.1.1.3" xref="S3.E6.m1.3.3.1.1.2.1.2.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝚺</mi><mo id="S3.E6.m1.3.3.1.1.2.1.1.4" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"></eq><apply id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"></times><apply id="S3.E6.m1.3.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.3.2">𝑝</ci><ci id="S3.E6.m1.3.3.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><eq id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"></eq><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.1">conditional</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.2.2">𝑠</ci><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐱</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.3">𝑦</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><times id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2"></times><ci id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3">𝒩</ci><interval closure="open" id="S3.E6.m1.3.3.1.1.2.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.1.1"><apply id="S3.E6.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.1.1.1.2">𝝁</ci><ci id="S3.E6.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2.1.1.1.3">𝑘</ci></apply><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝚺</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle p_{\theta}(s(\mathbf{x})|y=k)=\mathcal{N}(\boldsymbol{\mu}_{k},%
\boldsymbol{\Sigma}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s ( bold_x ) | italic_y = italic_k ) = caligraphic_N ( bold_italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_Σ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.8">where <math alttext="\boldsymbol{\mu}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝝁</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝝁</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\boldsymbol{\mu}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">bold_italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> represents the mean for class <math alttext="k\in\{1,2,\dots,K\}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.4"><semantics id="S3.SS2.p3.2.m2.4a"><mrow id="S3.SS2.p3.2.m2.4.5" xref="S3.SS2.p3.2.m2.4.5.cmml"><mi id="S3.SS2.p3.2.m2.4.5.2" xref="S3.SS2.p3.2.m2.4.5.2.cmml">k</mi><mo id="S3.SS2.p3.2.m2.4.5.1" xref="S3.SS2.p3.2.m2.4.5.1.cmml">∈</mo><mrow id="S3.SS2.p3.2.m2.4.5.3.2" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml"><mo id="S3.SS2.p3.2.m2.4.5.3.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml">{</mo><mn id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p3.2.m2.4.5.3.2.2" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml">,</mo><mn id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml">2</mn><mo id="S3.SS2.p3.2.m2.4.5.3.2.3" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml">,</mo><mi id="S3.SS2.p3.2.m2.3.3" mathvariant="normal" xref="S3.SS2.p3.2.m2.3.3.cmml">…</mi><mo id="S3.SS2.p3.2.m2.4.5.3.2.4" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml">,</mo><mi id="S3.SS2.p3.2.m2.4.4" xref="S3.SS2.p3.2.m2.4.4.cmml">K</mi><mo id="S3.SS2.p3.2.m2.4.5.3.2.5" stretchy="false" xref="S3.SS2.p3.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.4b"><apply id="S3.SS2.p3.2.m2.4.5.cmml" xref="S3.SS2.p3.2.m2.4.5"><in id="S3.SS2.p3.2.m2.4.5.1.cmml" xref="S3.SS2.p3.2.m2.4.5.1"></in><ci id="S3.SS2.p3.2.m2.4.5.2.cmml" xref="S3.SS2.p3.2.m2.4.5.2">𝑘</ci><set id="S3.SS2.p3.2.m2.4.5.3.1.cmml" xref="S3.SS2.p3.2.m2.4.5.3.2"><cn id="S3.SS2.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.1">1</cn><cn id="S3.SS2.p3.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p3.2.m2.2.2">2</cn><ci id="S3.SS2.p3.2.m2.3.3.cmml" xref="S3.SS2.p3.2.m2.3.3">…</ci><ci id="S3.SS2.p3.2.m2.4.4.cmml" xref="S3.SS2.p3.2.m2.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.4c">k\in\{1,2,\dots,K\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.4d">italic_k ∈ { 1 , 2 , … , italic_K }</annotation></semantics></math>, and <math alttext="\boldsymbol{\Sigma}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">𝚺</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝚺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\boldsymbol{\Sigma}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">bold_Σ</annotation></semantics></math> is the covariance matrix shared across classes. The function <math alttext="s(\mathbf{x})\in\mathbb{R}^{m}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.2" xref="S3.SS2.p3.4.m4.1.2.cmml"><mrow id="S3.SS2.p3.4.m4.1.2.2" xref="S3.SS2.p3.4.m4.1.2.2.cmml"><mi id="S3.SS2.p3.4.m4.1.2.2.2" xref="S3.SS2.p3.4.m4.1.2.2.2.cmml">s</mi><mo id="S3.SS2.p3.4.m4.1.2.2.1" xref="S3.SS2.p3.4.m4.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.4.m4.1.2.2.3.2" xref="S3.SS2.p3.4.m4.1.2.2.cmml"><mo id="S3.SS2.p3.4.m4.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.p3.4.m4.1.2.2.cmml">(</mo><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">𝐱</mi><mo id="S3.SS2.p3.4.m4.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.p3.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.4.m4.1.2.1" xref="S3.SS2.p3.4.m4.1.2.1.cmml">∈</mo><msup id="S3.SS2.p3.4.m4.1.2.3" xref="S3.SS2.p3.4.m4.1.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.2.3.2" xref="S3.SS2.p3.4.m4.1.2.3.2.cmml">ℝ</mi><mi id="S3.SS2.p3.4.m4.1.2.3.3" xref="S3.SS2.p3.4.m4.1.2.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.2.cmml" xref="S3.SS2.p3.4.m4.1.2"><in id="S3.SS2.p3.4.m4.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.2.1"></in><apply id="S3.SS2.p3.4.m4.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.2.2"><times id="S3.SS2.p3.4.m4.1.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.2.2.1"></times><ci id="S3.SS2.p3.4.m4.1.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.2.2.2">𝑠</ci><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝐱</ci></apply><apply id="S3.SS2.p3.4.m4.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.2.3.1.cmml" xref="S3.SS2.p3.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.2.3.2.cmml" xref="S3.SS2.p3.4.m4.1.2.3.2">ℝ</ci><ci id="S3.SS2.p3.4.m4.1.2.3.3.cmml" xref="S3.SS2.p3.4.m4.1.2.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">s(\mathbf{x})\in\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_s ( bold_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> represents the segmentation map of a cell instance <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">bold_x</annotation></semantics></math>, where <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_m</annotation></semantics></math> is significantly smaller than the input dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_d</annotation></semantics></math>. In our specific application to the pluripotent carcinoma cell dataset, we focus on two classes: the cells and the background, implying <math alttext="k=2" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mrow id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">k</mi><mo id="S3.SS2.p3.8.m8.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><eq id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1"></eq><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑘</ci><cn id="S3.SS2.p3.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.p3.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">k=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_k = 2</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">To estimate the parameters of the Gaussian distribution, we calculate the empirical class means and covariance matrix from the training samples <math alttext="\{\mathbf{x}_{i},y_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.2"><semantics id="S3.SS2.p4.1.m1.2a"><msubsup id="S3.SS2.p4.1.m1.2.2" xref="S3.SS2.p4.1.m1.2.2.cmml"><mrow id="S3.SS2.p4.1.m1.2.2.2.2.2" xref="S3.SS2.p4.1.m1.2.2.2.2.3.cmml"><mo id="S3.SS2.p4.1.m1.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.p4.1.m1.2.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p4.1.m1.1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p4.1.m1.2.2.2.2.2.4" xref="S3.SS2.p4.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p4.1.m1.2.2.2.2.2.2" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p4.1.m1.2.2.2.2.2.2.2" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p4.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p4.1.m1.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.p4.1.m1.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS2.p4.1.m1.2.2.2.4" xref="S3.SS2.p4.1.m1.2.2.2.4.cmml"><mi id="S3.SS2.p4.1.m1.2.2.2.4.2" xref="S3.SS2.p4.1.m1.2.2.2.4.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.2.2.2.4.1" xref="S3.SS2.p4.1.m1.2.2.2.4.1.cmml">=</mo><mn id="S3.SS2.p4.1.m1.2.2.2.4.3" xref="S3.SS2.p4.1.m1.2.2.2.4.3.cmml">1</mn></mrow><mi id="S3.SS2.p4.1.m1.2.2.4" xref="S3.SS2.p4.1.m1.2.2.4.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.2b"><apply id="S3.SS2.p4.1.m1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2">superscript</csymbol><apply id="S3.SS2.p4.1.m1.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2">subscript</csymbol><set id="S3.SS2.p4.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.2.2.2"><apply id="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.p4.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.SS2.p4.1.m1.2.2.2.4.cmml" xref="S3.SS2.p4.1.m1.2.2.2.4"><eq id="S3.SS2.p4.1.m1.2.2.2.4.1.cmml" xref="S3.SS2.p4.1.m1.2.2.2.4.1"></eq><ci id="S3.SS2.p4.1.m1.2.2.2.4.2.cmml" xref="S3.SS2.p4.1.m1.2.2.2.4.2">𝑖</ci><cn id="S3.SS2.p4.1.m1.2.2.2.4.3.cmml" type="integer" xref="S3.SS2.p4.1.m1.2.2.2.4.3">1</cn></apply></apply><ci id="S3.SS2.p4.1.m1.2.2.4.cmml" xref="S3.SS2.p4.1.m1.2.2.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.2c">\{\mathbf{x}_{i},y_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.2d">{ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx4">
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\widehat{\boldsymbol{\mu}}_{k}" class="ltx_Math" display="inline" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><msub id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mover accent="true" id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.2.2" xref="S3.E7.m1.1.1.2.2.cmml">𝝁</mi><mo id="S3.E7.m1.1.1.2.1" xref="S3.E7.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1">subscript</csymbol><apply id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"><ci id="S3.E7.m1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.2.1">^</ci><ci id="S3.E7.m1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.2.2">𝝁</ci></apply><ci id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\widehat{\boldsymbol{\mu}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">over^ start_ARG bold_italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N_{k}}\sum_{i:y_{i}=k}s(\mathbf{x}_{i})," class="ltx_Math" display="inline" id="S3.E7.m2.1"><semantics id="S3.E7.m2.1a"><mrow id="S3.E7.m2.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml"><mrow id="S3.E7.m2.1.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.3.cmml"></mi><mo id="S3.E7.m2.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m2.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E7.m2.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.3.cmml"><mfrac id="S3.E7.m2.1.1.1.1.1.3a" xref="S3.E7.m2.1.1.1.1.1.3.cmml"><mn id="S3.E7.m2.1.1.1.1.1.3.2" xref="S3.E7.m2.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.E7.m2.1.1.1.1.1.3.3" xref="S3.E7.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.3.3.2" xref="S3.E7.m2.1.1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.E7.m2.1.1.1.1.1.3.3.3" xref="S3.E7.m2.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mfrac></mstyle><mo id="S3.E7.m2.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m2.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E7.m2.1.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.1.2.cmml"><munder id="S3.E7.m2.1.1.1.1.1.1.2a" xref="S3.E7.m2.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m2.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E7.m2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m2.1.1.1.1.1.1.2.3" xref="S3.E7.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.2.3.2" xref="S3.E7.m2.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E7.m2.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7.m2.1.1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="S3.E7.m2.1.1.1.1.1.1.2.3.3" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.cmml"><msub id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.2" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.2.cmml">y</mi><mi id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.3" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.3.cmml">i</mi></msub><mo id="S3.E7.m2.1.1.1.1.1.1.2.3.3.1" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.1.cmml">=</mo><mi id="S3.E7.m2.1.1.1.1.1.1.2.3.3.3" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.3.cmml">k</mi></mrow></mrow></munder></mstyle><mrow id="S3.E7.m2.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S3.E7.m2.1.1.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m2.1.1.1.2" xref="S3.E7.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.1b"><apply id="S3.E7.m2.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1"><eq id="S3.E7.m2.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E7.m2.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E7.m2.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1"><times id="S3.E7.m2.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.2"></times><apply id="S3.E7.m2.1.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.1.3"><divide id="S3.E7.m2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.3"></divide><cn id="S3.E7.m2.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E7.m2.1.1.1.1.1.3.2">1</cn><apply id="S3.E7.m2.1.1.1.1.1.3.3.cmml" xref="S3.E7.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m2.1.1.1.1.1.3.3.2">𝑁</ci><ci id="S3.E7.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m2.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m2.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1"><apply id="S3.E7.m2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3"><ci id="S3.E7.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.1">:</ci><ci id="S3.E7.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.2">𝑖</ci><apply id="S3.E7.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3"><eq id="S3.E7.m2.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.1"></eq><apply id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.2">𝑦</ci><ci id="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.2.3">𝑖</ci></apply><ci id="S3.E7.m2.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E7.m2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1"><times id="S3.E7.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.2"></times><ci id="S3.E7.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.3">𝑠</ci><apply id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.1c">\displaystyle=\frac{1}{N_{k}}\sum_{i:y_{i}=k}s(\mathbf{x}_{i}),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m2.1d">= divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i : italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_k end_POSTSUBSCRIPT italic_s ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\widehat{\boldsymbol{\Sigma}}" class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mover accent="true" id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">𝚺</mi><mo id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><ci id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1">^</ci><ci id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2">𝚺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\widehat{\boldsymbol{\Sigma}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">over^ start_ARG bold_Σ end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N}\sum_{k=1}^{K}\sum_{i:y_{i}=k}\left(s(\mathbf{x}_{i})%
-\widehat{\boldsymbol{\mu}}_{k}\right)\left(s(\mathbf{x}_{i})-\widehat{%
\boldsymbol{\mu}}_{k}\right)^{\top}." class="ltx_Math" display="inline" id="S3.E8.m2.1"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.4" xref="S3.E8.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E8.m2.1.1.1.1.2.4" xref="S3.E8.m2.1.1.1.1.2.4.cmml"><mfrac id="S3.E8.m2.1.1.1.1.2.4a" xref="S3.E8.m2.1.1.1.1.2.4.cmml"><mn id="S3.E8.m2.1.1.1.1.2.4.2" xref="S3.E8.m2.1.1.1.1.2.4.2.cmml">1</mn><mi id="S3.E8.m2.1.1.1.1.2.4.3" xref="S3.E8.m2.1.1.1.1.2.4.3.cmml">N</mi></mfrac></mstyle><mo id="S3.E8.m2.1.1.1.1.2.3" xref="S3.E8.m2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E8.m2.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E8.m2.1.1.1.1.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.3.cmml"><munderover id="S3.E8.m2.1.1.1.1.2.2.3a" xref="S3.E8.m2.1.1.1.1.2.2.3.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.3.2.2" movablelimits="false" xref="S3.E8.m2.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.3.2.3" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.3.2.3.2" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.2.cmml">k</mi><mo id="S3.E8.m2.1.1.1.1.2.2.3.2.3.1" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E8.m2.1.1.1.1.2.2.3.2.3.3" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m2.1.1.1.1.2.2.3.3" xref="S3.E8.m2.1.1.1.1.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E8.m2.1.1.1.1.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E8.m2.1.1.1.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.3.cmml"><munder id="S3.E8.m2.1.1.1.1.2.2.2.3a" xref="S3.E8.m2.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.3.2" movablelimits="false" xref="S3.E8.m2.1.1.1.1.2.2.2.3.2.cmml">∑</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.3.3.2" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.2.cmml">i</mi><mo id="S3.E8.m2.1.1.1.1.2.2.2.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.1.cmml">:</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.cmml"><msub id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.2.cmml">y</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.1" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.1.cmml">=</mo><mi id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.3.cmml">k</mi></mrow></mrow></munder></mstyle><mrow id="S3.E8.m2.1.1.1.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.cmml"><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝝁</mi><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.3.cmml">⁢</mo><msup id="S3.E8.m2.1.1.1.1.2.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.cmml"><mrow id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml">s</mi><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml">−</mo><msub id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.2.cmml">𝝁</mi><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.1" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.3.cmml">⊤</mo></msup></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" lspace="0em" xref="S3.E8.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.4.cmml" xref="S3.E8.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2"><times id="S3.E8.m2.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.3"></times><apply id="S3.E8.m2.1.1.1.1.2.4.cmml" xref="S3.E8.m2.1.1.1.1.2.4"><divide id="S3.E8.m2.1.1.1.1.2.4.1.cmml" xref="S3.E8.m2.1.1.1.1.2.4"></divide><cn id="S3.E8.m2.1.1.1.1.2.4.2.cmml" type="integer" xref="S3.E8.m2.1.1.1.1.2.4.2">1</cn><ci id="S3.E8.m2.1.1.1.1.2.4.3.cmml" xref="S3.E8.m2.1.1.1.1.2.4.3">𝑁</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2"><apply id="S3.E8.m2.1.1.1.1.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E8.m2.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E8.m2.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3"><eq id="S3.E8.m2.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E8.m2.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.2">𝑘</ci><cn id="S3.E8.m2.1.1.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E8.m2.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E8.m2.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.3.3">𝐾</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2"><apply id="S3.E8.m2.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E8.m2.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.2"></sum><apply id="S3.E8.m2.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3"><ci id="S3.E8.m2.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.1">:</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.2">𝑖</ci><apply id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3"><eq id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.1"></eq><apply id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.2">𝑦</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2"><times id="S3.E8.m2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.3"></times><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝝁</ci></apply><ci id="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1"><minus id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.2"></minus><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1"><times id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.2"></times><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.3">𝑠</ci><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2"><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.1">^</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.2.2">𝝁</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.2.2.3">top</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\frac{1}{N}\sum_{k=1}^{K}\sum_{i:y_{i}=k}\left(s(\mathbf{x}_{i})%
-\widehat{\boldsymbol{\mu}}_{k}\right)\left(s(\mathbf{x}_{i})-\widehat{%
\boldsymbol{\mu}}_{k}\right)^{\top}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.1d">= divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i : italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_k end_POSTSUBSCRIPT ( italic_s ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - over^ start_ARG bold_italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ( italic_s ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - over^ start_ARG bold_italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.4">where <math alttext="N_{k}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑁</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">N_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the number of objects in class <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">italic_k</annotation></semantics></math>, and <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><mi id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_N</annotation></semantics></math> is the total number of objects. We use online estimation for efficient training, where we maintain a class-conditional queue with <math alttext="|Q_{k}|" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><mrow id="S3.SS2.p5.4.m4.1.1.1" xref="S3.SS2.p5.4.m4.1.1.2.cmml"><mo id="S3.SS2.p5.4.m4.1.1.1.2" stretchy="false" xref="S3.SS2.p5.4.m4.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p5.4.m4.1.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.1.1.2" xref="S3.SS2.p5.4.m4.1.1.1.1.2.cmml">Q</mi><mi id="S3.SS2.p5.4.m4.1.1.1.1.3" xref="S3.SS2.p5.4.m4.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p5.4.m4.1.1.1.3" stretchy="false" xref="S3.SS2.p5.4.m4.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1"><abs id="S3.SS2.p5.4.m4.1.1.2.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.2"></abs><apply id="S3.SS2.p5.4.m4.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.2">𝑄</ci><ci id="S3.SS2.p5.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">|Q_{k}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">| italic_Q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT |</annotation></semantics></math> object instances from each class. In each iteration, we enqueue the embeddings of objects to their corresponding class-conditional queues and dequeue the same number of object embeddings.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p6.1.1">Sampling from the Feature Representation Space</span> We propose sampling virtual outliers from the feature representation space of cell images, utilizing the multivariate distributions estimated from these features. These virtual outliers are designed to refine the decision boundary between different stages of cell development and other outlier data, which may not be adequately represented in the training set.</p>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.2">To accomplish this, we generate virtual outliers <math alttext="\mathcal{V}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1"><semantics id="S3.SS2.p7.1.m1.1a"><msub id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝒱</ci><ci id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\mathcal{V}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">caligraphic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> from the <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1"><semantics id="S3.SS2.p7.2.m2.1a"><mi id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><ci id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.2.m2.1d">italic_ϵ</annotation></semantics></math>-likelihood region of the estimated class-conditional distribution for each cell stage:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx5">
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{V}_{k}=\left\{v_{k}\mid\frac{1}{(2\pi)^{m/2}|\widehat{%
\Sigma}|^{1/2}}\exp\left(-\frac{1}{2}(v_{k}-\widehat{\mu}_{k})^{\top}\widehat{%
\Sigma}^{-1}(v_{k}-\widehat{\mu}_{k})\right)&lt;\epsilon\right\}," class="ltx_Math" display="inline" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.4" xref="S3.E9.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.4.4.1.1.4.2" xref="S3.E9.m1.4.4.1.1.4.2.cmml">𝒱</mi><mi id="S3.E9.m1.4.4.1.1.4.3" xref="S3.E9.m1.4.4.1.1.4.3.cmml">k</mi></msub><mo id="S3.E9.m1.4.4.1.1.3" xref="S3.E9.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E9.m1.4.4.1.1.2.2" xref="S3.E9.m1.4.4.1.1.2.3.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.3" xref="S3.E9.m1.4.4.1.1.2.3.1.cmml">{</mo><msub id="S3.E9.m1.4.4.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E9.m1.4.4.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.3.cmml">k</mi></msub><mo fence="true" id="S3.E9.m1.4.4.1.1.2.2.4" lspace="0em" rspace="0em" xref="S3.E9.m1.4.4.1.1.2.3.1.cmml">∣</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.cmml"><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.cmml"><mstyle displaystyle="true" id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mfrac id="S3.E9.m1.2.2a" xref="S3.E9.m1.2.2.cmml"><mn id="S3.E9.m1.2.2.4" xref="S3.E9.m1.2.2.4.cmml">1</mn><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><msup id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml"><mrow id="S3.E9.m1.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.E9.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml"><mn id="S3.E9.m1.2.2.2.2.1.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mo id="S3.E9.m1.2.2.2.2.1.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E9.m1.2.2.2.2.1.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.1.3.cmml">π</mi></mrow><mo id="S3.E9.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S3.E9.m1.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.3.2" xref="S3.E9.m1.2.2.2.2.3.2.cmml">m</mi><mo id="S3.E9.m1.2.2.2.2.3.1" xref="S3.E9.m1.2.2.2.2.3.1.cmml">/</mo><mn id="S3.E9.m1.2.2.2.2.3.3" xref="S3.E9.m1.2.2.2.2.3.3.cmml">2</mn></mrow></msup><mo id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">⁢</mo><msup id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.4.cmml"><mrow id="S3.E9.m1.2.2.2.4.2.2" xref="S3.E9.m1.2.2.2.4.2.1.cmml"><mo id="S3.E9.m1.2.2.2.4.2.2.1" stretchy="false" xref="S3.E9.m1.2.2.2.4.2.1.1.cmml">|</mo><mover accent="true" id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.2" mathvariant="normal" xref="S3.E9.m1.1.1.1.1.2.cmml">Σ</mi><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="S3.E9.m1.2.2.2.4.2.2.2" stretchy="false" xref="S3.E9.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mrow id="S3.E9.m1.2.2.2.4.3" xref="S3.E9.m1.2.2.2.4.3.cmml"><mn id="S3.E9.m1.2.2.2.4.3.2" xref="S3.E9.m1.2.2.2.4.3.2.cmml">1</mn><mo id="S3.E9.m1.2.2.2.4.3.1" xref="S3.E9.m1.2.2.2.4.3.1.cmml">/</mo><mn id="S3.E9.m1.2.2.2.4.3.3" xref="S3.E9.m1.2.2.2.4.3.3.cmml">2</mn></mrow></msup></mrow></mfrac></mstyle><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.2" lspace="0.167em" xref="S3.E9.m1.4.4.1.1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">exp</mi><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1a" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1a" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.cmml">−</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.cmml"><mfrac id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4a" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.cmml"><mn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.2.cmml">1</mn><mn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.3.cmml">2</mn></mfrac></mstyle><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3a" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.cmml"><mover accent="true" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.2" mathvariant="normal" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.2.cmml">Σ</mi><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3a" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.cmml">−</mo><mn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.2.cmml">1</mn></mrow></msup><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3b" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.2.cmml">v</mi><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.3.cmml">k</mi></msub><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.1.cmml">−</mo><msub id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.2.cmml">μ</mi><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.1" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.2.cmml">&lt;</mo><mi id="S3.E9.m1.4.4.1.1.2.2.2.3" xref="S3.E9.m1.4.4.1.1.2.2.2.3.cmml">ϵ</mi></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.5" xref="S3.E9.m1.4.4.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.2" xref="S3.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.1.1.cmml" xref="S3.E9.m1.4.4.1"><eq id="S3.E9.m1.4.4.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.3"></eq><apply id="S3.E9.m1.4.4.1.1.4.cmml" xref="S3.E9.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.4.1.cmml" xref="S3.E9.m1.4.4.1.1.4">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.4.2.cmml" xref="S3.E9.m1.4.4.1.1.4.2">𝒱</ci><ci id="S3.E9.m1.4.4.1.1.4.3.cmml" xref="S3.E9.m1.4.4.1.1.4.3">𝑘</ci></apply><apply id="S3.E9.m1.4.4.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.2.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3">conditional-set</csymbol><apply id="S3.E9.m1.4.4.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.2">𝑣</ci><ci id="S3.E9.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2"><lt id="S3.E9.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.2"></lt><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1"><times id="S3.E9.m1.4.4.1.1.2.2.2.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.2"></times><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2"></divide><cn id="S3.E9.m1.2.2.4.cmml" type="integer" xref="S3.E9.m1.2.2.4">1</cn><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></times><apply id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1"><times id="S3.E9.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1"></times><cn id="S3.E9.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.1.1.1.2">2</cn><ci id="S3.E9.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.3">𝜋</ci></apply><apply id="S3.E9.m1.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.3"><divide id="S3.E9.m1.2.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.3.1"></divide><ci id="S3.E9.m1.2.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.3.2">𝑚</ci><cn id="S3.E9.m1.2.2.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.3.3">2</cn></apply></apply><apply id="S3.E9.m1.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.4">superscript</csymbol><apply id="S3.E9.m1.2.2.2.4.2.1.cmml" xref="S3.E9.m1.2.2.2.4.2.2"><abs id="S3.E9.m1.2.2.2.4.2.1.1.cmml" xref="S3.E9.m1.2.2.2.4.2.2.1"></abs><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1">^</ci><ci id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2">Σ</ci></apply></apply><apply id="S3.E9.m1.2.2.2.4.3.cmml" xref="S3.E9.m1.2.2.2.4.3"><divide id="S3.E9.m1.2.2.2.4.3.1.cmml" xref="S3.E9.m1.2.2.2.4.3.1"></divide><cn id="S3.E9.m1.2.2.2.4.3.2.cmml" type="integer" xref="S3.E9.m1.2.2.2.4.3.2">1</cn><cn id="S3.E9.m1.2.2.2.4.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.2.4.3.3">2</cn></apply></apply></apply></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1"><exp id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"></exp><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1"><minus id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1"></minus><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2"><times id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.3"></times><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4"><divide id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4"></divide><cn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.2.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.2">1</cn><cn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.4.3">2</cn></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜇</ci></apply><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5">superscript</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2"><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.1">^</ci><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.2.2">Σ</ci></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3"><minus id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3"></minus><cn id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.2.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.5.3.2">1</cn></apply></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1"><minus id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.1"></minus><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.2">𝑣</ci><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.2.3">𝑘</ci></apply><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2"><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.1">^</ci><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.2.2">𝜇</ci></apply><ci id="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.1.1.1.1.1.2.2.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply><ci id="S3.E9.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\displaystyle\mathcal{V}_{k}=\left\{v_{k}\mid\frac{1}{(2\pi)^{m/2}|\widehat{%
\Sigma}|^{1/2}}\exp\left(-\frac{1}{2}(v_{k}-\widehat{\mu}_{k})^{\top}\widehat{%
\Sigma}^{-1}(v_{k}-\widehat{\mu}_{k})\right)&lt;\epsilon\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">caligraphic_V start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∣ divide start_ARG 1 end_ARG start_ARG ( 2 italic_π ) start_POSTSUPERSCRIPT italic_m / 2 end_POSTSUPERSCRIPT | over^ start_ARG roman_Σ end_ARG | start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT end_ARG roman_exp ( - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - over^ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT over^ start_ARG roman_Σ end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - over^ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) &lt; italic_ϵ } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p7.5">where <math alttext="v_{k}\sim\mathcal{N}(\widehat{\mu}_{k},\widehat{\Sigma}_{k})" class="ltx_Math" display="inline" id="S3.SS2.p7.3.m1.2"><semantics id="S3.SS2.p7.3.m1.2a"><mrow id="S3.SS2.p7.3.m1.2.2" xref="S3.SS2.p7.3.m1.2.2.cmml"><msub id="S3.SS2.p7.3.m1.2.2.4" xref="S3.SS2.p7.3.m1.2.2.4.cmml"><mi id="S3.SS2.p7.3.m1.2.2.4.2" xref="S3.SS2.p7.3.m1.2.2.4.2.cmml">v</mi><mi id="S3.SS2.p7.3.m1.2.2.4.3" xref="S3.SS2.p7.3.m1.2.2.4.3.cmml">k</mi></msub><mo id="S3.SS2.p7.3.m1.2.2.3" xref="S3.SS2.p7.3.m1.2.2.3.cmml">∼</mo><mrow id="S3.SS2.p7.3.m1.2.2.2" xref="S3.SS2.p7.3.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p7.3.m1.2.2.2.4" xref="S3.SS2.p7.3.m1.2.2.2.4.cmml">𝒩</mi><mo id="S3.SS2.p7.3.m1.2.2.2.3" xref="S3.SS2.p7.3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p7.3.m1.2.2.2.2.2" xref="S3.SS2.p7.3.m1.2.2.2.2.3.cmml"><mo id="S3.SS2.p7.3.m1.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.p7.3.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p7.3.m1.1.1.1.1.1.1" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.1" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p7.3.m1.1.1.1.1.1.1.3" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p7.3.m1.2.2.2.2.2.4" xref="S3.SS2.p7.3.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p7.3.m1.2.2.2.2.2.2" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.2.cmml">Σ</mi><mo id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.1" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p7.3.m1.2.2.2.2.2.2.3" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS2.p7.3.m1.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.p7.3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m1.2b"><apply id="S3.SS2.p7.3.m1.2.2.cmml" xref="S3.SS2.p7.3.m1.2.2"><csymbol cd="latexml" id="S3.SS2.p7.3.m1.2.2.3.cmml" xref="S3.SS2.p7.3.m1.2.2.3">similar-to</csymbol><apply id="S3.SS2.p7.3.m1.2.2.4.cmml" xref="S3.SS2.p7.3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m1.2.2.4.1.cmml" xref="S3.SS2.p7.3.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.p7.3.m1.2.2.4.2.cmml" xref="S3.SS2.p7.3.m1.2.2.4.2">𝑣</ci><ci id="S3.SS2.p7.3.m1.2.2.4.3.cmml" xref="S3.SS2.p7.3.m1.2.2.4.3">𝑘</ci></apply><apply id="S3.SS2.p7.3.m1.2.2.2.cmml" xref="S3.SS2.p7.3.m1.2.2.2"><times id="S3.SS2.p7.3.m1.2.2.2.3.cmml" xref="S3.SS2.p7.3.m1.2.2.2.3"></times><ci id="S3.SS2.p7.3.m1.2.2.2.4.cmml" xref="S3.SS2.p7.3.m1.2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS2.p7.3.m1.2.2.2.2.3.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2"><apply id="S3.SS2.p7.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2"><ci id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.2.2">𝜇</ci></apply><ci id="S3.SS2.p7.3.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p7.3.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.p7.3.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2"><ci id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.1">^</ci><ci id="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.2.2">Σ</ci></apply><ci id="S3.SS2.p7.3.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p7.3.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m1.2c">v_{k}\sim\mathcal{N}(\widehat{\mu}_{k},\widehat{\Sigma}_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.3.m1.2d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∼ caligraphic_N ( over^ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , over^ start_ARG roman_Σ end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> represents the sampled virtual outliers for class <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p7.4.m2.1"><semantics id="S3.SS2.p7.4.m2.1a"><mi id="S3.SS2.p7.4.m2.1.1" xref="S3.SS2.p7.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m2.1b"><ci id="S3.SS2.p7.4.m2.1.1.cmml" xref="S3.SS2.p7.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.4.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.4.m2.1d">italic_k</annotation></semantics></math>. These samples are chosen from a sublevel set defined by a small <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS2.p7.5.m3.1"><semantics id="S3.SS2.p7.5.m3.1a"><mi id="S3.SS2.p7.5.m3.1.1" xref="S3.SS2.p7.5.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m3.1b"><ci id="S3.SS2.p7.5.m3.1.1.cmml" xref="S3.SS2.p7.5.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.5.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.5.m3.1d">italic_ϵ</annotation></semantics></math>, ensuring that the outliers are near the decision boundary of the class. We hypothesize that most of the cell pixels are near the boundary of existing cells as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.F3" title="Figure 3 ‣ 3.2 Robust Cell Segmentation via Virtual Outlier Sampling ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3</span></a>. Compared to the ground truth masks shown in the second subfigure in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.F3" title="Figure 3 ‣ 3.2 Robust Cell Segmentation via Virtual Outlier Sampling ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3</span></a>, the synthesized outliers contain more information about the cells, which are difficult for humans to annotate due to their small size. This strategy aims to enhance the model’s sensitivity to subtle yet critical variations in cell morphology that might indicate different developmental stages or pathological conditions.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="S3.F3.sf1.g1" src="x2.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Original cell images from the training set</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="S3.F3.sf2.g1" src="x3.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Corresponding ground truth masks</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="S3.F3.sf3.g1" src="x4.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Visualization of the proposed segmentation map with synthesis outliers</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Examples showcasing the training with visual outliers. Patches are taken from the training set, presented in sizes of <math alttext="224\times 224" class="ltx_Math" display="inline" id="S3.F3.3.m1.1"><semantics id="S3.F3.3.m1.1b"><mrow id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml"><mn id="S3.F3.3.m1.1.1.2" xref="S3.F3.3.m1.1.1.2.cmml">224</mn><mo id="S3.F3.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F3.3.m1.1.1.1.cmml">×</mo><mn id="S3.F3.3.m1.1.1.3" xref="S3.F3.3.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><apply id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1"><times id="S3.F3.3.m1.1.1.1.cmml" xref="S3.F3.3.m1.1.1.1"></times><cn id="S3.F3.3.m1.1.1.2.cmml" type="integer" xref="S3.F3.3.m1.1.1.2">224</cn><cn id="S3.F3.3.m1.1.1.3.cmml" type="integer" xref="S3.F3.3.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S3.F3.3.m1.1e">224 × 224</annotation></semantics></math> and <math alttext="448\times 448" class="ltx_Math" display="inline" id="S3.F3.4.m2.1"><semantics id="S3.F3.4.m2.1b"><mrow id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml"><mn id="S3.F3.4.m2.1.1.2" xref="S3.F3.4.m2.1.1.2.cmml">448</mn><mo id="S3.F3.4.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F3.4.m2.1.1.1.cmml">×</mo><mn id="S3.F3.4.m2.1.1.3" xref="S3.F3.4.m2.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><apply id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1"><times id="S3.F3.4.m2.1.1.1.cmml" xref="S3.F3.4.m2.1.1.1"></times><cn id="S3.F3.4.m2.1.1.2.cmml" type="integer" xref="S3.F3.4.m2.1.1.2">448</cn><cn id="S3.F3.4.m2.1.1.3.cmml" type="integer" xref="S3.F3.4.m2.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">448\times 448</annotation><annotation encoding="application/x-llamapun" id="S3.F3.4.m2.1e">448 × 448</annotation></semantics></math>. Compared to the ground truth masks, the synthetic outlier samples simulate small cell dots at the pixel level, which are challenging for human annotation. Additionally, small white dots are presented as outliers, which may be difficult to discern without magnification.</figcaption>
</figure>
</section>
<section class="ltx_subsection ltx_indent_first" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Unknown-aware Training Objective</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">The objective is to develop an uncertainty-aware deep learning model capable of predicting a segmentation map <math alttext="\hat{S}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mover accent="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">S</mi><mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">^</ci><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\hat{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">over^ start_ARG italic_S end_ARG</annotation></semantics></math> for input cell images. To this end, we introduce a new training objective for unknown-aware learning, which utilizes virtual outliers as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.SS2" title="3.2 Robust Cell Segmentation via Virtual Outlier Sampling ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">3.2</span></a>. We start by defining the standard Dice loss between the predicted pixel scores <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mover accent="true" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">y</mi><mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><ci id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1">^</ci><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> and the ground truth targets <math alttext="y" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_y</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx6">
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{Dice}}(f(\mathbf{x};\theta),y)=1-\frac{2\sum_{%
i}p_{i}g_{i}+\epsilon}{\sum_{i}p_{i}^{2}+\sum_{i}g_{i}^{2}+\epsilon}," class="ltx_Math" display="inline" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.4.1" xref="S3.E10.m1.4.4.1.1.cmml"><mrow id="S3.E10.m1.4.4.1.1" xref="S3.E10.m1.4.4.1.1.cmml"><mrow id="S3.E10.m1.4.4.1.1.1" xref="S3.E10.m1.4.4.1.1.1.cmml"><msub id="S3.E10.m1.4.4.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.4.4.1.1.1.3.2" xref="S3.E10.m1.4.4.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E10.m1.4.4.1.1.1.3.3" xref="S3.E10.m1.4.4.1.1.1.3.3a.cmml">Dice</mtext></msub><mo id="S3.E10.m1.4.4.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml">(</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">𝐱</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.3.2.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml">θ</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml">,</mo><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">y</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.4.4.1.1.2" xref="S3.E10.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.4.4.1.1.3" xref="S3.E10.m1.4.4.1.1.3.cmml"><mn id="S3.E10.m1.4.4.1.1.3.2" xref="S3.E10.m1.4.4.1.1.3.2.cmml">1</mn><mo id="S3.E10.m1.4.4.1.1.3.1" xref="S3.E10.m1.4.4.1.1.3.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E10.m1.4.4.1.1.3.3" xref="S3.E10.m1.4.4.1.1.3.3.cmml"><mfrac id="S3.E10.m1.4.4.1.1.3.3a" xref="S3.E10.m1.4.4.1.1.3.3.cmml"><mrow id="S3.E10.m1.4.4.1.1.3.3.2" xref="S3.E10.m1.4.4.1.1.3.3.2.cmml"><mrow id="S3.E10.m1.4.4.1.1.3.3.2.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.cmml"><mn id="S3.E10.m1.4.4.1.1.3.3.2.2.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.2.cmml">2</mn><mo id="S3.E10.m1.4.4.1.1.3.3.2.2.1" xref="S3.E10.m1.4.4.1.1.3.3.2.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.3.3.2.2.3" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.cmml"><msub id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.cmml"><mo id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.2.cmml">∑</mo><mi id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.3" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.3.cmml">i</mi></msub><mrow id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.cmml"><msub id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.cmml"><mi id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.2.cmml">p</mi><mi id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.3" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.1" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.1.cmml">⁢</mo><msub id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.cmml"><mi id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.2" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.2.cmml">g</mi><mi id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.3" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E10.m1.4.4.1.1.3.3.2.1" xref="S3.E10.m1.4.4.1.1.3.3.2.1.cmml">+</mo><mi id="S3.E10.m1.4.4.1.1.3.3.2.3" xref="S3.E10.m1.4.4.1.1.3.3.2.3.cmml">ϵ</mi></mrow><mrow id="S3.E10.m1.4.4.1.1.3.3.3" xref="S3.E10.m1.4.4.1.1.3.3.3.cmml"><mrow id="S3.E10.m1.4.4.1.1.3.3.3.2" xref="S3.E10.m1.4.4.1.1.3.3.3.2.cmml"><msub id="S3.E10.m1.4.4.1.1.3.3.3.2.1" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1.cmml"><mo id="S3.E10.m1.4.4.1.1.3.3.3.2.1.2" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1.2.cmml">∑</mo><mi id="S3.E10.m1.4.4.1.1.3.3.3.2.1.3" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1.3.cmml">i</mi></msub><msubsup id="S3.E10.m1.4.4.1.1.3.3.3.2.2" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.cmml"><mi id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.2" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.2.cmml">p</mi><mi id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.3" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.3.cmml">i</mi><mn id="S3.E10.m1.4.4.1.1.3.3.3.2.2.3" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E10.m1.4.4.1.1.3.3.3.1" rspace="0.055em" xref="S3.E10.m1.4.4.1.1.3.3.3.1.cmml">+</mo><mrow id="S3.E10.m1.4.4.1.1.3.3.3.3" xref="S3.E10.m1.4.4.1.1.3.3.3.3.cmml"><msub id="S3.E10.m1.4.4.1.1.3.3.3.3.1" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1.cmml"><mo id="S3.E10.m1.4.4.1.1.3.3.3.3.1.2" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1.2.cmml">∑</mo><mi id="S3.E10.m1.4.4.1.1.3.3.3.3.1.3" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1.3.cmml">i</mi></msub><msubsup id="S3.E10.m1.4.4.1.1.3.3.3.3.2" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.cmml"><mi id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.2" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.2.cmml">g</mi><mi id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.3" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.3.cmml">i</mi><mn id="S3.E10.m1.4.4.1.1.3.3.3.3.2.3" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E10.m1.4.4.1.1.3.3.3.1a" xref="S3.E10.m1.4.4.1.1.3.3.3.1.cmml">+</mo><mi id="S3.E10.m1.4.4.1.1.3.3.3.4" xref="S3.E10.m1.4.4.1.1.3.3.3.4.cmml">ϵ</mi></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E10.m1.4.4.1.2" xref="S3.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.4.1.1.cmml" xref="S3.E10.m1.4.4.1"><eq id="S3.E10.m1.4.4.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.2"></eq><apply id="S3.E10.m1.4.4.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1"><times id="S3.E10.m1.4.4.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.2"></times><apply id="S3.E10.m1.4.4.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.1.3.2.cmml" xref="S3.E10.m1.4.4.1.1.1.3.2">ℒ</ci><ci id="S3.E10.m1.4.4.1.1.1.3.3a.cmml" xref="S3.E10.m1.4.4.1.1.1.3.3"><mtext id="S3.E10.m1.4.4.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E10.m1.4.4.1.1.1.3.3">Dice</mtext></ci></apply><interval closure="open" id="S3.E10.m1.4.4.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1"><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1"><times id="S3.E10.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.2">𝑓</ci><list id="S3.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.3.2"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝐱</ci><ci id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2">𝜃</ci></list></apply><ci id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">𝑦</ci></interval></apply><apply id="S3.E10.m1.4.4.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.3"><minus id="S3.E10.m1.4.4.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.1"></minus><cn id="S3.E10.m1.4.4.1.1.3.2.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.3.2">1</cn><apply id="S3.E10.m1.4.4.1.1.3.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3"><divide id="S3.E10.m1.4.4.1.1.3.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3"></divide><apply id="S3.E10.m1.4.4.1.1.3.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2"><plus id="S3.E10.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.1"></plus><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2"><times id="S3.E10.m1.4.4.1.1.3.3.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.1"></times><cn id="S3.E10.m1.4.4.1.1.3.3.2.2.2.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.3.3.2.2.2">2</cn><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3"><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1">subscript</csymbol><sum id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.2"></sum><ci id="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.1.3">𝑖</ci></apply><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2"><times id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.1"></times><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.2">𝑝</ci><ci id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.2.3">𝑖</ci></apply><apply id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.2">𝑔</ci><ci id="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E10.m1.4.4.1.1.3.3.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.2.3">italic-ϵ</ci></apply><apply id="S3.E10.m1.4.4.1.1.3.3.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3"><plus id="S3.E10.m1.4.4.1.1.3.3.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.1"></plus><apply id="S3.E10.m1.4.4.1.1.3.3.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2"><apply id="S3.E10.m1.4.4.1.1.3.3.3.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.2.1.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1">subscript</csymbol><sum id="S3.E10.m1.4.4.1.1.3.3.3.2.1.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1.2"></sum><ci id="S3.E10.m1.4.4.1.1.3.3.3.2.1.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.1.3">𝑖</ci></apply><apply id="S3.E10.m1.4.4.1.1.3.3.3.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2">superscript</csymbol><apply id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.2">𝑝</ci><ci id="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.2.3">𝑖</ci></apply><cn id="S3.E10.m1.4.4.1.1.3.3.3.2.2.3.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.3.3.3.2.2.3">2</cn></apply></apply><apply id="S3.E10.m1.4.4.1.1.3.3.3.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3"><apply id="S3.E10.m1.4.4.1.1.3.3.3.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.3.1.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1">subscript</csymbol><sum id="S3.E10.m1.4.4.1.1.3.3.3.3.1.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1.2"></sum><ci id="S3.E10.m1.4.4.1.1.3.3.3.3.1.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.1.3">𝑖</ci></apply><apply id="S3.E10.m1.4.4.1.1.3.3.3.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.3.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2">superscript</csymbol><apply id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.2">𝑔</ci><ci id="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.3.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.2.3">𝑖</ci></apply><cn id="S3.E10.m1.4.4.1.1.3.3.3.3.2.3.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.3.3.3.3.2.3">2</cn></apply></apply><ci id="S3.E10.m1.4.4.1.1.3.3.3.4.cmml" xref="S3.E10.m1.4.4.1.1.3.3.3.4">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">\displaystyle\mathcal{L}_{\text{Dice}}(f(\mathbf{x};\theta),y)=1-\frac{2\sum_{%
i}p_{i}g_{i}+\epsilon}{\sum_{i}p_{i}^{2}+\sum_{i}g_{i}^{2}+\epsilon},</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">caligraphic_L start_POSTSUBSCRIPT Dice end_POSTSUBSCRIPT ( italic_f ( bold_x ; italic_θ ) , italic_y ) = 1 - divide start_ARG 2 ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_ϵ end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.6">where <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m1.1"><semantics id="S3.SS3.p1.4.m1.1a"><msub id="S3.SS3.p1.4.m1.1.1" xref="S3.SS3.p1.4.m1.1.1.cmml"><mi id="S3.SS3.p1.4.m1.1.1.2" xref="S3.SS3.p1.4.m1.1.1.2.cmml">p</mi><mi id="S3.SS3.p1.4.m1.1.1.3" xref="S3.SS3.p1.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.1b"><apply id="S3.SS3.p1.4.m1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.1.1.2">𝑝</ci><ci id="S3.SS3.p1.4.m1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the predicted probabilities for the actual class labels <math alttext="g_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m2.1"><semantics id="S3.SS3.p1.5.m2.1a"><msub id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml"><mi id="S3.SS3.p1.5.m2.1.1.2" xref="S3.SS3.p1.5.m2.1.1.2.cmml">g</mi><mi id="S3.SS3.p1.5.m2.1.1.3" xref="S3.SS3.p1.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.1b"><apply id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2">𝑔</ci><ci id="S3.SS3.p1.5.m2.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.1c">g_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m3.1"><semantics id="S3.SS3.p1.6.m3.1a"><mi id="S3.SS3.p1.6.m3.1.1" xref="S3.SS3.p1.6.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m3.1b"><ci id="S3.SS3.p1.6.m3.1.1.cmml" xref="S3.SS3.p1.6.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m3.1d">italic_ϵ</annotation></semantics></math> is a small constant introduced to prevent division by zero.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.4">In the case of medical segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib51" title="">51</a>]</cite>, Dice loss is frequently combined with Cross Entropy loss to form the overall training objective. The Cross Entropy loss is defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx7">
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{CE}}(f(\mathbf{x};\theta),y)" class="ltx_Math" display="inline" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml"><msub id="S3.E11.m1.4.4.3" xref="S3.E11.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.4.4.3.2" xref="S3.E11.m1.4.4.3.2.cmml">ℒ</mi><mtext id="S3.E11.m1.4.4.3.3" xref="S3.E11.m1.4.4.3.3a.cmml">CE</mtext></msub><mo id="S3.E11.m1.4.4.2" xref="S3.E11.m1.4.4.2.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.1.1" xref="S3.E11.m1.4.4.1.2.cmml"><mo id="S3.E11.m1.4.4.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.1.2.cmml">(</mo><mrow id="S3.E11.m1.4.4.1.1.1" xref="S3.E11.m1.4.4.1.1.1.cmml"><mi id="S3.E11.m1.4.4.1.1.1.2" xref="S3.E11.m1.4.4.1.1.1.2.cmml">f</mi><mo id="S3.E11.m1.4.4.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.1.1.1.3.2" xref="S3.E11.m1.4.4.1.1.1.3.1.cmml"><mo id="S3.E11.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.3.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐱</mi><mo id="S3.E11.m1.4.4.1.1.1.3.2.2" xref="S3.E11.m1.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">θ</mi><mo id="S3.E11.m1.4.4.1.1.1.3.2.3" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.1.1.3" xref="S3.E11.m1.4.4.1.2.cmml">,</mo><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">y</mi><mo id="S3.E11.m1.4.4.1.1.4" stretchy="false" xref="S3.E11.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"><times id="S3.E11.m1.4.4.2.cmml" xref="S3.E11.m1.4.4.2"></times><apply id="S3.E11.m1.4.4.3.cmml" xref="S3.E11.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.cmml" xref="S3.E11.m1.4.4.3">subscript</csymbol><ci id="S3.E11.m1.4.4.3.2.cmml" xref="S3.E11.m1.4.4.3.2">ℒ</ci><ci id="S3.E11.m1.4.4.3.3a.cmml" xref="S3.E11.m1.4.4.3.3"><mtext id="S3.E11.m1.4.4.3.3.cmml" mathsize="70%" xref="S3.E11.m1.4.4.3.3">CE</mtext></ci></apply><interval closure="open" id="S3.E11.m1.4.4.1.2.cmml" xref="S3.E11.m1.4.4.1.1"><apply id="S3.E11.m1.4.4.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1"><times id="S3.E11.m1.4.4.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1"></times><ci id="S3.E11.m1.4.4.1.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1.2">𝑓</ci><list id="S3.E11.m1.4.4.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.3.2"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐱</ci><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝜃</ci></list></apply><ci id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\displaystyle\mathcal{L}_{\text{CE}}(f(\mathbf{x};\theta),y)</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">caligraphic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT ( italic_f ( bold_x ; italic_θ ) , italic_y )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\sum_{i}y_{i}\log(f(\mathbf{x}_{i};\theta))," class="ltx_Math" display="inline" id="S3.E11.m2.3"><semantics id="S3.E11.m2.3a"><mrow id="S3.E11.m2.3.3.1" xref="S3.E11.m2.3.3.1.1.cmml"><mrow id="S3.E11.m2.3.3.1.1" xref="S3.E11.m2.3.3.1.1.cmml"><mi id="S3.E11.m2.3.3.1.1.3" xref="S3.E11.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E11.m2.3.3.1.1.2" xref="S3.E11.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E11.m2.3.3.1.1.1" xref="S3.E11.m2.3.3.1.1.1.cmml"><mo id="S3.E11.m2.3.3.1.1.1a" xref="S3.E11.m2.3.3.1.1.1.cmml">−</mo><mrow id="S3.E11.m2.3.3.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E11.m2.3.3.1.1.1.1.2" xref="S3.E11.m2.3.3.1.1.1.1.2.cmml"><munder id="S3.E11.m2.3.3.1.1.1.1.2a" xref="S3.E11.m2.3.3.1.1.1.1.2.cmml"><mo id="S3.E11.m2.3.3.1.1.1.1.2.2" movablelimits="false" xref="S3.E11.m2.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E11.m2.3.3.1.1.1.1.2.3" xref="S3.E11.m2.3.3.1.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="S3.E11.m2.3.3.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.cmml"><msub id="S3.E11.m2.3.3.1.1.1.1.1.3" xref="S3.E11.m2.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E11.m2.3.3.1.1.1.1.1.3.2" xref="S3.E11.m2.3.3.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E11.m2.3.3.1.1.1.1.1.3.3" xref="S3.E11.m2.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E11.m2.3.3.1.1.1.1.1.2" lspace="0.167em" xref="S3.E11.m2.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m2.3.3.1.1.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E11.m2.2.2" xref="S3.E11.m2.2.2.cmml">log</mi><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1a" xref="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E11.m2.1.1" xref="S3.E11.m2.1.1.cmml">θ</mi><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E11.m2.3.3.1.2" xref="S3.E11.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.3b"><apply id="S3.E11.m2.3.3.1.1.cmml" xref="S3.E11.m2.3.3.1"><eq id="S3.E11.m2.3.3.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E11.m2.3.3.1.1.3.cmml" xref="S3.E11.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E11.m2.3.3.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1"><minus id="S3.E11.m2.3.3.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1"></minus><apply id="S3.E11.m2.3.3.1.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1"><apply id="S3.E11.m2.3.3.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E11.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.2.2"></sum><ci id="S3.E11.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E11.m2.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E11.m2.3.3.1.1.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1"><times id="S3.E11.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.2"></times><apply id="S3.E11.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m2.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E11.m2.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E11.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1"><log id="S3.E11.m2.2.2.cmml" xref="S3.E11.m2.2.2"></log><apply id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E11.m2.1.1.cmml" xref="S3.E11.m2.1.1">𝜃</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.3c">\displaystyle=-\sum_{i}y_{i}\log(f(\mathbf{x}_{i};\theta)),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m2.3d">= - ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( italic_f ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; italic_θ ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.3">where <math alttext="f(\mathbf{x}_{i};\theta)" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.2"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml"><mi id="S3.SS3.p2.1.m1.2.2.3" xref="S3.SS3.p2.1.m1.2.2.3.cmml">f</mi><mo id="S3.SS3.p2.1.m1.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml"><mo id="S3.SS3.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.1.m1.2.2.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">;</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">θ</mi><mo id="S3.SS3.p2.1.m1.2.2.1.1.4" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2"><times id="S3.SS3.p2.1.m1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2"></times><ci id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.3">𝑓</ci><list id="S3.SS3.p2.1.m1.2.2.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1"><apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2">𝐱</ci><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">f(\mathbf{x}_{i};\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.2d">italic_f ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; italic_θ )</annotation></semantics></math> is the model’s output for the input <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝐱</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑦</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding true label.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.3">The overall training objective for medical segmentation, as used in vanilla TransUNet, combines both Cross Entropy and Dice losses <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib52" title="">52</a>]</cite>. This combined loss function is employed as the primary training loss, defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx8">
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{seg}}=\lambda_{1}\mathcal{L}_{\text{CE}}(\hat{%
S}_{l},D(S))+\lambda_{2}\mathcal{L}_{\text{DICE}}(\hat{S}_{l},D(S))." class="ltx_Math" display="inline" id="S3.E12.m1.3"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><msub id="S3.E12.m1.3.3.1.1.6" xref="S3.E12.m1.3.3.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.3.3.1.1.6.2" xref="S3.E12.m1.3.3.1.1.6.2.cmml">ℒ</mi><mtext id="S3.E12.m1.3.3.1.1.6.3" xref="S3.E12.m1.3.3.1.1.6.3a.cmml">seg</mtext></msub><mo id="S3.E12.m1.3.3.1.1.5" xref="S3.E12.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.4" xref="S3.E12.m1.3.3.1.1.4.cmml"><mrow id="S3.E12.m1.3.3.1.1.2.2" xref="S3.E12.m1.3.3.1.1.2.2.cmml"><msub id="S3.E12.m1.3.3.1.1.2.2.4" xref="S3.E12.m1.3.3.1.1.2.2.4.cmml"><mi id="S3.E12.m1.3.3.1.1.2.2.4.2" xref="S3.E12.m1.3.3.1.1.2.2.4.2.cmml">λ</mi><mn id="S3.E12.m1.3.3.1.1.2.2.4.3" xref="S3.E12.m1.3.3.1.1.2.2.4.3.cmml">1</mn></msub><mo id="S3.E12.m1.3.3.1.1.2.2.3" xref="S3.E12.m1.3.3.1.1.2.2.3.cmml">⁢</mo><msub id="S3.E12.m1.3.3.1.1.2.2.5" xref="S3.E12.m1.3.3.1.1.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.3.3.1.1.2.2.5.2" xref="S3.E12.m1.3.3.1.1.2.2.5.2.cmml">ℒ</mi><mtext id="S3.E12.m1.3.3.1.1.2.2.5.3" xref="S3.E12.m1.3.3.1.1.2.2.5.3a.cmml">CE</mtext></msub><mo id="S3.E12.m1.3.3.1.1.2.2.3a" xref="S3.E12.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.2.2.2.2" xref="S3.E12.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">S</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.4" xref="S3.E12.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E12.m1.3.3.1.1.2.2.2.2.2" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E12.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.2.cmml">D</mi><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.2.1" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.cmml"><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">S</mi><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S3.E12.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.4.5" xref="S3.E12.m1.3.3.1.1.4.5.cmml">+</mo><mrow id="S3.E12.m1.3.3.1.1.4.4" xref="S3.E12.m1.3.3.1.1.4.4.cmml"><msub id="S3.E12.m1.3.3.1.1.4.4.4" xref="S3.E12.m1.3.3.1.1.4.4.4.cmml"><mi id="S3.E12.m1.3.3.1.1.4.4.4.2" xref="S3.E12.m1.3.3.1.1.4.4.4.2.cmml">λ</mi><mn id="S3.E12.m1.3.3.1.1.4.4.4.3" xref="S3.E12.m1.3.3.1.1.4.4.4.3.cmml">2</mn></msub><mo id="S3.E12.m1.3.3.1.1.4.4.3" xref="S3.E12.m1.3.3.1.1.4.4.3.cmml">⁢</mo><msub id="S3.E12.m1.3.3.1.1.4.4.5" xref="S3.E12.m1.3.3.1.1.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.3.3.1.1.4.4.5.2" xref="S3.E12.m1.3.3.1.1.4.4.5.2.cmml">ℒ</mi><mtext id="S3.E12.m1.3.3.1.1.4.4.5.3" xref="S3.E12.m1.3.3.1.1.4.4.5.3a.cmml">DICE</mtext></msub><mo id="S3.E12.m1.3.3.1.1.4.4.3a" xref="S3.E12.m1.3.3.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.4.4.2.2" xref="S3.E12.m1.3.3.1.1.4.4.2.3.cmml"><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.3" stretchy="false" xref="S3.E12.m1.3.3.1.1.4.4.2.3.cmml">(</mo><msub id="S3.E12.m1.3.3.1.1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.2.cmml">S</mi><mo id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.1" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E12.m1.3.3.1.1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.3.cmml">l</mi></msub><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.4" xref="S3.E12.m1.3.3.1.1.4.4.2.3.cmml">,</mo><mrow id="S3.E12.m1.3.3.1.1.4.4.2.2.2" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.cmml"><mi id="S3.E12.m1.3.3.1.1.4.4.2.2.2.2" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.2.cmml">D</mi><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.2.1" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.1.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.4.4.2.2.2.3.2" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.cmml"><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.2.3.2.1" stretchy="false" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.cmml">(</mo><mi id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">S</mi><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.2.3.2.2" stretchy="false" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.4.4.2.2.5" stretchy="false" xref="S3.E12.m1.3.3.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E12.m1.3.3.1.2" lspace="0em" xref="S3.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.5.cmml" xref="S3.E12.m1.3.3.1.1.5"></eq><apply id="S3.E12.m1.3.3.1.1.6.cmml" xref="S3.E12.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.6.1.cmml" xref="S3.E12.m1.3.3.1.1.6">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.6.2.cmml" xref="S3.E12.m1.3.3.1.1.6.2">ℒ</ci><ci id="S3.E12.m1.3.3.1.1.6.3a.cmml" xref="S3.E12.m1.3.3.1.1.6.3"><mtext id="S3.E12.m1.3.3.1.1.6.3.cmml" mathsize="70%" xref="S3.E12.m1.3.3.1.1.6.3">seg</mtext></ci></apply><apply id="S3.E12.m1.3.3.1.1.4.cmml" xref="S3.E12.m1.3.3.1.1.4"><plus id="S3.E12.m1.3.3.1.1.4.5.cmml" xref="S3.E12.m1.3.3.1.1.4.5"></plus><apply id="S3.E12.m1.3.3.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2"><times id="S3.E12.m1.3.3.1.1.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.2.2.3"></times><apply id="S3.E12.m1.3.3.1.1.2.2.4.cmml" xref="S3.E12.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.2.4.1.cmml" xref="S3.E12.m1.3.3.1.1.2.2.4">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.2.4.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2.4.2">𝜆</ci><cn id="S3.E12.m1.3.3.1.1.2.2.4.3.cmml" type="integer" xref="S3.E12.m1.3.3.1.1.2.2.4.3">1</cn></apply><apply id="S3.E12.m1.3.3.1.1.2.2.5.cmml" xref="S3.E12.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.2.2.5.1.cmml" xref="S3.E12.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.2.2.5.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2.5.2">ℒ</ci><ci id="S3.E12.m1.3.3.1.1.2.2.5.3a.cmml" xref="S3.E12.m1.3.3.1.1.2.2.5.3"><mtext id="S3.E12.m1.3.3.1.1.2.2.5.3.cmml" mathsize="70%" xref="S3.E12.m1.3.3.1.1.2.2.5.3">CE</mtext></ci></apply><interval closure="open" id="S3.E12.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.2.2.2.2"><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2">𝑆</ci></apply><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.E12.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2"><times id="S3.E12.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.1"></times><ci id="S3.E12.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.2.2.2.2.2.2">𝐷</ci><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">𝑆</ci></apply></interval></apply><apply id="S3.E12.m1.3.3.1.1.4.4.cmml" xref="S3.E12.m1.3.3.1.1.4.4"><times id="S3.E12.m1.3.3.1.1.4.4.3.cmml" xref="S3.E12.m1.3.3.1.1.4.4.3"></times><apply id="S3.E12.m1.3.3.1.1.4.4.4.cmml" xref="S3.E12.m1.3.3.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.4.4.4.1.cmml" xref="S3.E12.m1.3.3.1.1.4.4.4">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.4.4.4.2.cmml" xref="S3.E12.m1.3.3.1.1.4.4.4.2">𝜆</ci><cn id="S3.E12.m1.3.3.1.1.4.4.4.3.cmml" type="integer" xref="S3.E12.m1.3.3.1.1.4.4.4.3">2</cn></apply><apply id="S3.E12.m1.3.3.1.1.4.4.5.cmml" xref="S3.E12.m1.3.3.1.1.4.4.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.4.4.5.1.cmml" xref="S3.E12.m1.3.3.1.1.4.4.5">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.4.4.5.2.cmml" xref="S3.E12.m1.3.3.1.1.4.4.5.2">ℒ</ci><ci id="S3.E12.m1.3.3.1.1.4.4.5.3a.cmml" xref="S3.E12.m1.3.3.1.1.4.4.5.3"><mtext id="S3.E12.m1.3.3.1.1.4.4.5.3.cmml" mathsize="70%" xref="S3.E12.m1.3.3.1.1.4.4.5.3">DICE</mtext></ci></apply><interval closure="open" id="S3.E12.m1.3.3.1.1.4.4.2.3.cmml" xref="S3.E12.m1.3.3.1.1.4.4.2.2"><apply id="S3.E12.m1.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1">subscript</csymbol><apply id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2"><ci id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.2.2">𝑆</ci></apply><ci id="S3.E12.m1.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3.3.1.1.1.3">𝑙</ci></apply><apply id="S3.E12.m1.3.3.1.1.4.4.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2"><times id="S3.E12.m1.3.3.1.1.4.4.2.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.1"></times><ci id="S3.E12.m1.3.3.1.1.4.4.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.4.4.2.2.2.2">𝐷</ci><ci id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">𝑆</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">\displaystyle\mathcal{L}_{\text{seg}}=\lambda_{1}\mathcal{L}_{\text{CE}}(\hat{%
S}_{l},D(S))+\lambda_{2}\mathcal{L}_{\text{DICE}}(\hat{S}_{l},D(S)).</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.3d">caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT ( over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_D ( italic_S ) ) + italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DICE end_POSTSUBSCRIPT ( over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_D ( italic_S ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.2">The weights <math alttext="\lambda_{1}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">λ</mi><mn id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝜆</ci><cn id="S3.SS3.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{2}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">λ</mi><mn id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝜆</ci><cn id="S3.SS3.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\lambda_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are used to balance these two terms, typically set to be equally distributed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.2">With the virtual outliers <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝑣</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> sampled from the predicted segmentation map <math alttext="s(\mathbf{x}_{i})" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">s</mi><mo id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.2.m2.1.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.1.1.1.2" xref="S3.SS3.p4.2.m2.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p4.2.m2.1.1.1.1.1.3" xref="S3.SS3.p4.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><times id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"></times><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑠</ci><apply id="S3.SS3.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS3.p4.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">s(\mathbf{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_s ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, we effectively capture the inherent uncertainty of the segmentation process. To make our model uncertainty-aware, we adapt both the Dice loss and Cross Entropy loss for training as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx9">
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{Dice\_out}}(f_{\text{syn}}(\mathbf{x};\theta),y)" class="ltx_Math" display="inline" id="S3.E13.m1.4"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4.4" xref="S3.E13.m1.4.4.cmml"><msub id="S3.E13.m1.4.4.3" xref="S3.E13.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.4.4.3.2" xref="S3.E13.m1.4.4.3.2.cmml">ℒ</mi><mtext id="S3.E13.m1.4.4.3.3" xref="S3.E13.m1.4.4.3.3a.cmml">Dice_out</mtext></msub><mo id="S3.E13.m1.4.4.2" xref="S3.E13.m1.4.4.2.cmml">⁢</mo><mrow id="S3.E13.m1.4.4.1.1" xref="S3.E13.m1.4.4.1.2.cmml"><mo id="S3.E13.m1.4.4.1.1.2" stretchy="false" xref="S3.E13.m1.4.4.1.2.cmml">(</mo><mrow id="S3.E13.m1.4.4.1.1.1" xref="S3.E13.m1.4.4.1.1.1.cmml"><msub id="S3.E13.m1.4.4.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.2.cmml"><mi id="S3.E13.m1.4.4.1.1.1.2.2" xref="S3.E13.m1.4.4.1.1.1.2.2.cmml">f</mi><mtext id="S3.E13.m1.4.4.1.1.1.2.3" xref="S3.E13.m1.4.4.1.1.1.2.3a.cmml">syn</mtext></msub><mo id="S3.E13.m1.4.4.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.E13.m1.4.4.1.1.1.3.2" xref="S3.E13.m1.4.4.1.1.1.3.1.cmml"><mo id="S3.E13.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.E13.m1.4.4.1.1.1.3.1.cmml">(</mo><mi id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml">𝐱</mi><mo id="S3.E13.m1.4.4.1.1.1.3.2.2" xref="S3.E13.m1.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml">θ</mi><mo id="S3.E13.m1.4.4.1.1.1.3.2.3" stretchy="false" xref="S3.E13.m1.4.4.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.1.1.3" xref="S3.E13.m1.4.4.1.2.cmml">,</mo><mi id="S3.E13.m1.3.3" xref="S3.E13.m1.3.3.cmml">y</mi><mo id="S3.E13.m1.4.4.1.1.4" stretchy="false" xref="S3.E13.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.4b"><apply id="S3.E13.m1.4.4.cmml" xref="S3.E13.m1.4.4"><times id="S3.E13.m1.4.4.2.cmml" xref="S3.E13.m1.4.4.2"></times><apply id="S3.E13.m1.4.4.3.cmml" xref="S3.E13.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.3.1.cmml" xref="S3.E13.m1.4.4.3">subscript</csymbol><ci id="S3.E13.m1.4.4.3.2.cmml" xref="S3.E13.m1.4.4.3.2">ℒ</ci><ci id="S3.E13.m1.4.4.3.3a.cmml" xref="S3.E13.m1.4.4.3.3"><mtext id="S3.E13.m1.4.4.3.3.cmml" mathsize="70%" xref="S3.E13.m1.4.4.3.3">Dice_out</mtext></ci></apply><interval closure="open" id="S3.E13.m1.4.4.1.2.cmml" xref="S3.E13.m1.4.4.1.1"><apply id="S3.E13.m1.4.4.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1"><times id="S3.E13.m1.4.4.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1"></times><apply id="S3.E13.m1.4.4.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.2.1.cmml" xref="S3.E13.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.1.2.2.cmml" xref="S3.E13.m1.4.4.1.1.1.2.2">𝑓</ci><ci id="S3.E13.m1.4.4.1.1.1.2.3a.cmml" xref="S3.E13.m1.4.4.1.1.1.2.3"><mtext id="S3.E13.m1.4.4.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E13.m1.4.4.1.1.1.2.3">syn</mtext></ci></apply><list id="S3.E13.m1.4.4.1.1.1.3.1.cmml" xref="S3.E13.m1.4.4.1.1.1.3.2"><ci id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1">𝐱</ci><ci id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2">𝜃</ci></list></apply><ci id="S3.E13.m1.3.3.cmml" xref="S3.E13.m1.3.3">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.4c">\displaystyle\mathcal{L}_{\text{Dice\_out}}(f_{\text{syn}}(\mathbf{x};\theta),y)</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.4d">caligraphic_L start_POSTSUBSCRIPT Dice_out end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT ( bold_x ; italic_θ ) , italic_y )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1-\frac{2\sum_{i}p_{\text{syn},i}g_{i}+\epsilon}{\sum_{i}p_{%
\text{syn},i}^{2}+\sum_{i}g_{i}^{2}+\epsilon}," class="ltx_Math" display="inline" id="S3.E13.m2.5"><semantics id="S3.E13.m2.5a"><mrow id="S3.E13.m2.5.5.1" xref="S3.E13.m2.5.5.1.1.cmml"><mrow id="S3.E13.m2.5.5.1.1" xref="S3.E13.m2.5.5.1.1.cmml"><mi id="S3.E13.m2.5.5.1.1.2" xref="S3.E13.m2.5.5.1.1.2.cmml"></mi><mo id="S3.E13.m2.5.5.1.1.1" xref="S3.E13.m2.5.5.1.1.1.cmml">=</mo><mrow id="S3.E13.m2.5.5.1.1.3" xref="S3.E13.m2.5.5.1.1.3.cmml"><mn id="S3.E13.m2.5.5.1.1.3.2" xref="S3.E13.m2.5.5.1.1.3.2.cmml">1</mn><mo id="S3.E13.m2.5.5.1.1.3.1" xref="S3.E13.m2.5.5.1.1.3.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E13.m2.4.4" xref="S3.E13.m2.4.4.cmml"><mfrac id="S3.E13.m2.4.4a" xref="S3.E13.m2.4.4.cmml"><mrow id="S3.E13.m2.2.2.2" xref="S3.E13.m2.2.2.2.cmml"><mrow id="S3.E13.m2.2.2.2.4" xref="S3.E13.m2.2.2.2.4.cmml"><mn id="S3.E13.m2.2.2.2.4.2" xref="S3.E13.m2.2.2.2.4.2.cmml">2</mn><mo id="S3.E13.m2.2.2.2.4.1" xref="S3.E13.m2.2.2.2.4.1.cmml">⁢</mo><mrow id="S3.E13.m2.2.2.2.4.3" xref="S3.E13.m2.2.2.2.4.3.cmml"><msub id="S3.E13.m2.2.2.2.4.3.1" xref="S3.E13.m2.2.2.2.4.3.1.cmml"><mo id="S3.E13.m2.2.2.2.4.3.1.2" xref="S3.E13.m2.2.2.2.4.3.1.2.cmml">∑</mo><mi id="S3.E13.m2.2.2.2.4.3.1.3" xref="S3.E13.m2.2.2.2.4.3.1.3.cmml">i</mi></msub><mrow id="S3.E13.m2.2.2.2.4.3.2" xref="S3.E13.m2.2.2.2.4.3.2.cmml"><msub id="S3.E13.m2.2.2.2.4.3.2.2" xref="S3.E13.m2.2.2.2.4.3.2.2.cmml"><mi id="S3.E13.m2.2.2.2.4.3.2.2.2" xref="S3.E13.m2.2.2.2.4.3.2.2.2.cmml">p</mi><mrow id="S3.E13.m2.2.2.2.2.2.4" xref="S3.E13.m2.2.2.2.2.2.3.cmml"><mtext id="S3.E13.m2.1.1.1.1.1.1" xref="S3.E13.m2.1.1.1.1.1.1a.cmml">syn</mtext><mo id="S3.E13.m2.2.2.2.2.2.4.1" xref="S3.E13.m2.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E13.m2.2.2.2.2.2.2" xref="S3.E13.m2.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E13.m2.2.2.2.4.3.2.1" xref="S3.E13.m2.2.2.2.4.3.2.1.cmml">⁢</mo><msub id="S3.E13.m2.2.2.2.4.3.2.3" xref="S3.E13.m2.2.2.2.4.3.2.3.cmml"><mi id="S3.E13.m2.2.2.2.4.3.2.3.2" xref="S3.E13.m2.2.2.2.4.3.2.3.2.cmml">g</mi><mi id="S3.E13.m2.2.2.2.4.3.2.3.3" xref="S3.E13.m2.2.2.2.4.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E13.m2.2.2.2.3" xref="S3.E13.m2.2.2.2.3.cmml">+</mo><mi id="S3.E13.m2.2.2.2.5" xref="S3.E13.m2.2.2.2.5.cmml">ϵ</mi></mrow><mrow id="S3.E13.m2.4.4.4" xref="S3.E13.m2.4.4.4.cmml"><mrow id="S3.E13.m2.4.4.4.4" xref="S3.E13.m2.4.4.4.4.cmml"><msub id="S3.E13.m2.4.4.4.4.1" xref="S3.E13.m2.4.4.4.4.1.cmml"><mo id="S3.E13.m2.4.4.4.4.1.2" xref="S3.E13.m2.4.4.4.4.1.2.cmml">∑</mo><mi id="S3.E13.m2.4.4.4.4.1.3" xref="S3.E13.m2.4.4.4.4.1.3.cmml">i</mi></msub><msubsup id="S3.E13.m2.4.4.4.4.2" xref="S3.E13.m2.4.4.4.4.2.cmml"><mi id="S3.E13.m2.4.4.4.4.2.2.2" xref="S3.E13.m2.4.4.4.4.2.2.2.cmml">p</mi><mrow id="S3.E13.m2.4.4.4.2.2.4" xref="S3.E13.m2.4.4.4.2.2.3.cmml"><mtext id="S3.E13.m2.3.3.3.1.1.1" xref="S3.E13.m2.3.3.3.1.1.1a.cmml">syn</mtext><mo id="S3.E13.m2.4.4.4.2.2.4.1" xref="S3.E13.m2.4.4.4.2.2.3.cmml">,</mo><mi id="S3.E13.m2.4.4.4.2.2.2" xref="S3.E13.m2.4.4.4.2.2.2.cmml">i</mi></mrow><mn id="S3.E13.m2.4.4.4.4.2.3" xref="S3.E13.m2.4.4.4.4.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E13.m2.4.4.4.3" rspace="0.055em" xref="S3.E13.m2.4.4.4.3.cmml">+</mo><mrow id="S3.E13.m2.4.4.4.5" xref="S3.E13.m2.4.4.4.5.cmml"><msub id="S3.E13.m2.4.4.4.5.1" xref="S3.E13.m2.4.4.4.5.1.cmml"><mo id="S3.E13.m2.4.4.4.5.1.2" xref="S3.E13.m2.4.4.4.5.1.2.cmml">∑</mo><mi id="S3.E13.m2.4.4.4.5.1.3" xref="S3.E13.m2.4.4.4.5.1.3.cmml">i</mi></msub><msubsup id="S3.E13.m2.4.4.4.5.2" xref="S3.E13.m2.4.4.4.5.2.cmml"><mi id="S3.E13.m2.4.4.4.5.2.2.2" xref="S3.E13.m2.4.4.4.5.2.2.2.cmml">g</mi><mi id="S3.E13.m2.4.4.4.5.2.2.3" xref="S3.E13.m2.4.4.4.5.2.2.3.cmml">i</mi><mn id="S3.E13.m2.4.4.4.5.2.3" xref="S3.E13.m2.4.4.4.5.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E13.m2.4.4.4.3a" xref="S3.E13.m2.4.4.4.3.cmml">+</mo><mi id="S3.E13.m2.4.4.4.6" xref="S3.E13.m2.4.4.4.6.cmml">ϵ</mi></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E13.m2.5.5.1.2" xref="S3.E13.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m2.5b"><apply id="S3.E13.m2.5.5.1.1.cmml" xref="S3.E13.m2.5.5.1"><eq id="S3.E13.m2.5.5.1.1.1.cmml" xref="S3.E13.m2.5.5.1.1.1"></eq><csymbol cd="latexml" id="S3.E13.m2.5.5.1.1.2.cmml" xref="S3.E13.m2.5.5.1.1.2">absent</csymbol><apply id="S3.E13.m2.5.5.1.1.3.cmml" xref="S3.E13.m2.5.5.1.1.3"><minus id="S3.E13.m2.5.5.1.1.3.1.cmml" xref="S3.E13.m2.5.5.1.1.3.1"></minus><cn id="S3.E13.m2.5.5.1.1.3.2.cmml" type="integer" xref="S3.E13.m2.5.5.1.1.3.2">1</cn><apply id="S3.E13.m2.4.4.cmml" xref="S3.E13.m2.4.4"><divide id="S3.E13.m2.4.4.5.cmml" xref="S3.E13.m2.4.4"></divide><apply id="S3.E13.m2.2.2.2.cmml" xref="S3.E13.m2.2.2.2"><plus id="S3.E13.m2.2.2.2.3.cmml" xref="S3.E13.m2.2.2.2.3"></plus><apply id="S3.E13.m2.2.2.2.4.cmml" xref="S3.E13.m2.2.2.2.4"><times id="S3.E13.m2.2.2.2.4.1.cmml" xref="S3.E13.m2.2.2.2.4.1"></times><cn id="S3.E13.m2.2.2.2.4.2.cmml" type="integer" xref="S3.E13.m2.2.2.2.4.2">2</cn><apply id="S3.E13.m2.2.2.2.4.3.cmml" xref="S3.E13.m2.2.2.2.4.3"><apply id="S3.E13.m2.2.2.2.4.3.1.cmml" xref="S3.E13.m2.2.2.2.4.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.2.4.3.1.1.cmml" xref="S3.E13.m2.2.2.2.4.3.1">subscript</csymbol><sum id="S3.E13.m2.2.2.2.4.3.1.2.cmml" xref="S3.E13.m2.2.2.2.4.3.1.2"></sum><ci id="S3.E13.m2.2.2.2.4.3.1.3.cmml" xref="S3.E13.m2.2.2.2.4.3.1.3">𝑖</ci></apply><apply id="S3.E13.m2.2.2.2.4.3.2.cmml" xref="S3.E13.m2.2.2.2.4.3.2"><times id="S3.E13.m2.2.2.2.4.3.2.1.cmml" xref="S3.E13.m2.2.2.2.4.3.2.1"></times><apply id="S3.E13.m2.2.2.2.4.3.2.2.cmml" xref="S3.E13.m2.2.2.2.4.3.2.2"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.2.4.3.2.2.1.cmml" xref="S3.E13.m2.2.2.2.4.3.2.2">subscript</csymbol><ci id="S3.E13.m2.2.2.2.4.3.2.2.2.cmml" xref="S3.E13.m2.2.2.2.4.3.2.2.2">𝑝</ci><list id="S3.E13.m2.2.2.2.2.2.3.cmml" xref="S3.E13.m2.2.2.2.2.2.4"><ci id="S3.E13.m2.1.1.1.1.1.1a.cmml" xref="S3.E13.m2.1.1.1.1.1.1"><mtext id="S3.E13.m2.1.1.1.1.1.1.cmml" mathsize="70%" xref="S3.E13.m2.1.1.1.1.1.1">syn</mtext></ci><ci id="S3.E13.m2.2.2.2.2.2.2.cmml" xref="S3.E13.m2.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E13.m2.2.2.2.4.3.2.3.cmml" xref="S3.E13.m2.2.2.2.4.3.2.3"><csymbol cd="ambiguous" id="S3.E13.m2.2.2.2.4.3.2.3.1.cmml" xref="S3.E13.m2.2.2.2.4.3.2.3">subscript</csymbol><ci id="S3.E13.m2.2.2.2.4.3.2.3.2.cmml" xref="S3.E13.m2.2.2.2.4.3.2.3.2">𝑔</ci><ci id="S3.E13.m2.2.2.2.4.3.2.3.3.cmml" xref="S3.E13.m2.2.2.2.4.3.2.3.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E13.m2.2.2.2.5.cmml" xref="S3.E13.m2.2.2.2.5">italic-ϵ</ci></apply><apply id="S3.E13.m2.4.4.4.cmml" xref="S3.E13.m2.4.4.4"><plus id="S3.E13.m2.4.4.4.3.cmml" xref="S3.E13.m2.4.4.4.3"></plus><apply id="S3.E13.m2.4.4.4.4.cmml" xref="S3.E13.m2.4.4.4.4"><apply id="S3.E13.m2.4.4.4.4.1.cmml" xref="S3.E13.m2.4.4.4.4.1"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.4.1.1.cmml" xref="S3.E13.m2.4.4.4.4.1">subscript</csymbol><sum id="S3.E13.m2.4.4.4.4.1.2.cmml" xref="S3.E13.m2.4.4.4.4.1.2"></sum><ci id="S3.E13.m2.4.4.4.4.1.3.cmml" xref="S3.E13.m2.4.4.4.4.1.3">𝑖</ci></apply><apply id="S3.E13.m2.4.4.4.4.2.cmml" xref="S3.E13.m2.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.4.2.1.cmml" xref="S3.E13.m2.4.4.4.4.2">superscript</csymbol><apply id="S3.E13.m2.4.4.4.4.2.2.cmml" xref="S3.E13.m2.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.4.2.2.1.cmml" xref="S3.E13.m2.4.4.4.4.2">subscript</csymbol><ci id="S3.E13.m2.4.4.4.4.2.2.2.cmml" xref="S3.E13.m2.4.4.4.4.2.2.2">𝑝</ci><list id="S3.E13.m2.4.4.4.2.2.3.cmml" xref="S3.E13.m2.4.4.4.2.2.4"><ci id="S3.E13.m2.3.3.3.1.1.1a.cmml" xref="S3.E13.m2.3.3.3.1.1.1"><mtext id="S3.E13.m2.3.3.3.1.1.1.cmml" mathsize="70%" xref="S3.E13.m2.3.3.3.1.1.1">syn</mtext></ci><ci id="S3.E13.m2.4.4.4.2.2.2.cmml" xref="S3.E13.m2.4.4.4.2.2.2">𝑖</ci></list></apply><cn id="S3.E13.m2.4.4.4.4.2.3.cmml" type="integer" xref="S3.E13.m2.4.4.4.4.2.3">2</cn></apply></apply><apply id="S3.E13.m2.4.4.4.5.cmml" xref="S3.E13.m2.4.4.4.5"><apply id="S3.E13.m2.4.4.4.5.1.cmml" xref="S3.E13.m2.4.4.4.5.1"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.5.1.1.cmml" xref="S3.E13.m2.4.4.4.5.1">subscript</csymbol><sum id="S3.E13.m2.4.4.4.5.1.2.cmml" xref="S3.E13.m2.4.4.4.5.1.2"></sum><ci id="S3.E13.m2.4.4.4.5.1.3.cmml" xref="S3.E13.m2.4.4.4.5.1.3">𝑖</ci></apply><apply id="S3.E13.m2.4.4.4.5.2.cmml" xref="S3.E13.m2.4.4.4.5.2"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.5.2.1.cmml" xref="S3.E13.m2.4.4.4.5.2">superscript</csymbol><apply id="S3.E13.m2.4.4.4.5.2.2.cmml" xref="S3.E13.m2.4.4.4.5.2"><csymbol cd="ambiguous" id="S3.E13.m2.4.4.4.5.2.2.1.cmml" xref="S3.E13.m2.4.4.4.5.2">subscript</csymbol><ci id="S3.E13.m2.4.4.4.5.2.2.2.cmml" xref="S3.E13.m2.4.4.4.5.2.2.2">𝑔</ci><ci id="S3.E13.m2.4.4.4.5.2.2.3.cmml" xref="S3.E13.m2.4.4.4.5.2.2.3">𝑖</ci></apply><cn id="S3.E13.m2.4.4.4.5.2.3.cmml" type="integer" xref="S3.E13.m2.4.4.4.5.2.3">2</cn></apply></apply><ci id="S3.E13.m2.4.4.4.6.cmml" xref="S3.E13.m2.4.4.4.6">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.5c">\displaystyle=1-\frac{2\sum_{i}p_{\text{syn},i}g_{i}+\epsilon}{\sum_{i}p_{%
\text{syn},i}^{2}+\sum_{i}g_{i}^{2}+\epsilon},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m2.5d">= 1 - divide start_ARG 2 ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT syn , italic_i end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_ϵ end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT syn , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{CE\_out}}(f_{\text{out}}(\mathbf{x};\theta),y)" class="ltx_Math" display="inline" id="S3.E14.m1.4"><semantics id="S3.E14.m1.4a"><mrow id="S3.E14.m1.4.4" xref="S3.E14.m1.4.4.cmml"><msub id="S3.E14.m1.4.4.3" xref="S3.E14.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.4.4.3.2" xref="S3.E14.m1.4.4.3.2.cmml">ℒ</mi><mtext id="S3.E14.m1.4.4.3.3" xref="S3.E14.m1.4.4.3.3a.cmml">CE_out</mtext></msub><mo id="S3.E14.m1.4.4.2" xref="S3.E14.m1.4.4.2.cmml">⁢</mo><mrow id="S3.E14.m1.4.4.1.1" xref="S3.E14.m1.4.4.1.2.cmml"><mo id="S3.E14.m1.4.4.1.1.2" stretchy="false" xref="S3.E14.m1.4.4.1.2.cmml">(</mo><mrow id="S3.E14.m1.4.4.1.1.1" xref="S3.E14.m1.4.4.1.1.1.cmml"><msub id="S3.E14.m1.4.4.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.2.cmml"><mi id="S3.E14.m1.4.4.1.1.1.2.2" xref="S3.E14.m1.4.4.1.1.1.2.2.cmml">f</mi><mtext id="S3.E14.m1.4.4.1.1.1.2.3" xref="S3.E14.m1.4.4.1.1.1.2.3a.cmml">out</mtext></msub><mo id="S3.E14.m1.4.4.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.4.4.1.1.1.3.2" xref="S3.E14.m1.4.4.1.1.1.3.1.cmml"><mo id="S3.E14.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.E14.m1.4.4.1.1.1.3.1.cmml">(</mo><mi id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">𝐱</mi><mo id="S3.E14.m1.4.4.1.1.1.3.2.2" xref="S3.E14.m1.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.E14.m1.2.2" xref="S3.E14.m1.2.2.cmml">θ</mi><mo id="S3.E14.m1.4.4.1.1.1.3.2.3" stretchy="false" xref="S3.E14.m1.4.4.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.4.4.1.1.3" xref="S3.E14.m1.4.4.1.2.cmml">,</mo><mi id="S3.E14.m1.3.3" xref="S3.E14.m1.3.3.cmml">y</mi><mo id="S3.E14.m1.4.4.1.1.4" stretchy="false" xref="S3.E14.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.4b"><apply id="S3.E14.m1.4.4.cmml" xref="S3.E14.m1.4.4"><times id="S3.E14.m1.4.4.2.cmml" xref="S3.E14.m1.4.4.2"></times><apply id="S3.E14.m1.4.4.3.cmml" xref="S3.E14.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.3.1.cmml" xref="S3.E14.m1.4.4.3">subscript</csymbol><ci id="S3.E14.m1.4.4.3.2.cmml" xref="S3.E14.m1.4.4.3.2">ℒ</ci><ci id="S3.E14.m1.4.4.3.3a.cmml" xref="S3.E14.m1.4.4.3.3"><mtext id="S3.E14.m1.4.4.3.3.cmml" mathsize="70%" xref="S3.E14.m1.4.4.3.3">CE_out</mtext></ci></apply><interval closure="open" id="S3.E14.m1.4.4.1.2.cmml" xref="S3.E14.m1.4.4.1.1"><apply id="S3.E14.m1.4.4.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1"><times id="S3.E14.m1.4.4.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1"></times><apply id="S3.E14.m1.4.4.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.2.1.cmml" xref="S3.E14.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.2.2.cmml" xref="S3.E14.m1.4.4.1.1.1.2.2">𝑓</ci><ci id="S3.E14.m1.4.4.1.1.1.2.3a.cmml" xref="S3.E14.m1.4.4.1.1.1.2.3"><mtext id="S3.E14.m1.4.4.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E14.m1.4.4.1.1.1.2.3">out</mtext></ci></apply><list id="S3.E14.m1.4.4.1.1.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2"><ci id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">𝐱</ci><ci id="S3.E14.m1.2.2.cmml" xref="S3.E14.m1.2.2">𝜃</ci></list></apply><ci id="S3.E14.m1.3.3.cmml" xref="S3.E14.m1.3.3">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.4c">\displaystyle\mathcal{L}_{\text{CE\_out}}(f_{\text{out}}(\mathbf{x};\theta),y)</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.4d">caligraphic_L start_POSTSUBSCRIPT CE_out end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT out end_POSTSUBSCRIPT ( bold_x ; italic_θ ) , italic_y )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\sum_{i}y_{i}\log(f_{\text{out}}(\mathbf{x}_{i};\theta))," class="ltx_Math" display="inline" id="S3.E14.m2.3"><semantics id="S3.E14.m2.3a"><mrow id="S3.E14.m2.3.3.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.1" xref="S3.E14.m2.3.3.1.1.1.cmml"><mo id="S3.E14.m2.3.3.1.1.1a" xref="S3.E14.m2.3.3.1.1.1.cmml">−</mo><mrow id="S3.E14.m2.3.3.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.2.cmml"><munder id="S3.E14.m2.3.3.1.1.1.1.2a" xref="S3.E14.m2.3.3.1.1.1.1.2.cmml"><mo id="S3.E14.m2.3.3.1.1.1.1.2.2" movablelimits="false" xref="S3.E14.m2.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E14.m2.3.3.1.1.1.1.2.3" xref="S3.E14.m2.3.3.1.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="S3.E14.m2.3.3.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.cmml"><msub id="S3.E14.m2.3.3.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E14.m2.3.3.1.1.1.1.1.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E14.m2.3.3.1.1.1.1.1.2" lspace="0.167em" xref="S3.E14.m2.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m2.2.2" xref="S3.E14.m2.2.2.cmml">log</mi><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1a" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mtext id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3a.cmml">out</mtext></msub><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E14.m2.1.1" xref="S3.E14.m2.1.1.cmml">θ</mi><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E14.m2.3.3.1.2" xref="S3.E14.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.3b"><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1"><eq id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E14.m2.3.3.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1"><minus id="S3.E14.m2.3.3.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1"></minus><apply id="S3.E14.m2.3.3.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1"><apply id="S3.E14.m2.3.3.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E14.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.2.2"></sum><ci id="S3.E14.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E14.m2.3.3.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1"><times id="S3.E14.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.2"></times><apply id="S3.E14.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1"><log id="S3.E14.m2.2.2.cmml" xref="S3.E14.m2.2.2"></log><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.3">out</mtext></ci></apply><list id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E14.m2.1.1.cmml" xref="S3.E14.m2.1.1">𝜃</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.3c">\displaystyle=-\sum_{i}y_{i}\log(f_{\text{out}}(\mathbf{x}_{i};\theta)),</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m2.3d">= - ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( italic_f start_POSTSUBSCRIPT out end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; italic_θ ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p5.3">where <math alttext="p_{\text{syn},i}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.2"><semantics id="S3.SS3.p5.1.m1.2a"><msub id="S3.SS3.p5.1.m1.2.3" xref="S3.SS3.p5.1.m1.2.3.cmml"><mi id="S3.SS3.p5.1.m1.2.3.2" xref="S3.SS3.p5.1.m1.2.3.2.cmml">p</mi><mrow id="S3.SS3.p5.1.m1.2.2.2.4" xref="S3.SS3.p5.1.m1.2.2.2.3.cmml"><mtext id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1a.cmml">syn</mtext><mo id="S3.SS3.p5.1.m1.2.2.2.4.1" xref="S3.SS3.p5.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p5.1.m1.2.2.2.2" xref="S3.SS3.p5.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.2b"><apply id="S3.SS3.p5.1.m1.2.3.cmml" xref="S3.SS3.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.2.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3">subscript</csymbol><ci id="S3.SS3.p5.1.m1.2.3.2.cmml" xref="S3.SS3.p5.1.m1.2.3.2">𝑝</ci><list id="S3.SS3.p5.1.m1.2.2.2.3.cmml" xref="S3.SS3.p5.1.m1.2.2.2.4"><ci id="S3.SS3.p5.1.m1.1.1.1.1a.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1"><mtext id="S3.SS3.p5.1.m1.1.1.1.1.cmml" mathsize="70%" xref="S3.SS3.p5.1.m1.1.1.1.1">syn</mtext></ci><ci id="S3.SS3.p5.1.m1.2.2.2.2.cmml" xref="S3.SS3.p5.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.2c">p_{\text{syn},i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.2d">italic_p start_POSTSUBSCRIPT syn , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the predicted probabilities for the actual class labels <math alttext="g_{i}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><msub id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝑔</ci><ci id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">g_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from the synthetic outputs, and <math alttext="f_{\text{out}}(\mathbf{x}_{i};\theta)" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.2"><semantics id="S3.SS3.p5.3.m3.2a"><mrow id="S3.SS3.p5.3.m3.2.2" xref="S3.SS3.p5.3.m3.2.2.cmml"><msub id="S3.SS3.p5.3.m3.2.2.3" xref="S3.SS3.p5.3.m3.2.2.3.cmml"><mi id="S3.SS3.p5.3.m3.2.2.3.2" xref="S3.SS3.p5.3.m3.2.2.3.2.cmml">f</mi><mtext id="S3.SS3.p5.3.m3.2.2.3.3" xref="S3.SS3.p5.3.m3.2.2.3.3a.cmml">out</mtext></msub><mo id="S3.SS3.p5.3.m3.2.2.2" xref="S3.SS3.p5.3.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p5.3.m3.2.2.1.1" xref="S3.SS3.p5.3.m3.2.2.1.2.cmml"><mo id="S3.SS3.p5.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS3.p5.3.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS3.p5.3.m3.2.2.1.1.1" xref="S3.SS3.p5.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS3.p5.3.m3.2.2.1.1.1.2" xref="S3.SS3.p5.3.m3.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p5.3.m3.2.2.1.1.1.3" xref="S3.SS3.p5.3.m3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p5.3.m3.2.2.1.1.3" xref="S3.SS3.p5.3.m3.2.2.1.2.cmml">;</mo><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">θ</mi><mo id="S3.SS3.p5.3.m3.2.2.1.1.4" stretchy="false" xref="S3.SS3.p5.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.2b"><apply id="S3.SS3.p5.3.m3.2.2.cmml" xref="S3.SS3.p5.3.m3.2.2"><times id="S3.SS3.p5.3.m3.2.2.2.cmml" xref="S3.SS3.p5.3.m3.2.2.2"></times><apply id="S3.SS3.p5.3.m3.2.2.3.cmml" xref="S3.SS3.p5.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.2.2.3.1.cmml" xref="S3.SS3.p5.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.2.2.3.2.cmml" xref="S3.SS3.p5.3.m3.2.2.3.2">𝑓</ci><ci id="S3.SS3.p5.3.m3.2.2.3.3a.cmml" xref="S3.SS3.p5.3.m3.2.2.3.3"><mtext id="S3.SS3.p5.3.m3.2.2.3.3.cmml" mathsize="70%" xref="S3.SS3.p5.3.m3.2.2.3.3">out</mtext></ci></apply><list id="S3.SS3.p5.3.m3.2.2.1.2.cmml" xref="S3.SS3.p5.3.m3.2.2.1.1"><apply id="S3.SS3.p5.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.p5.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.p5.3.m3.2.2.1.1.1.2">𝐱</ci><ci id="S3.SS3.p5.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS3.p5.3.m3.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.2c">f_{\text{out}}(\mathbf{x}_{i};\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.2d">italic_f start_POSTSUBSCRIPT out end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; italic_θ )</annotation></semantics></math> denotes the model’s output for synthetic data designed to simulate under-represented features.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.3">Furthermore, we model the uncertainty captured by the virtual outliers through a specific loss function:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx10">
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{uncertainty}}=\beta_{1}\mathcal{L}_{\text{CE\_%
out}}(\hat{S}_{l},D(S))+\beta_{2}\mathcal{L}_{\text{DICE\_out}}(\hat{S}_{l},D(%
S))," class="ltx_Math" display="inline" id="S3.E15.m1.3"><semantics id="S3.E15.m1.3a"><mrow id="S3.E15.m1.3.3.1" xref="S3.E15.m1.3.3.1.1.cmml"><mrow id="S3.E15.m1.3.3.1.1" xref="S3.E15.m1.3.3.1.1.cmml"><msub id="S3.E15.m1.3.3.1.1.6" xref="S3.E15.m1.3.3.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.3.3.1.1.6.2" xref="S3.E15.m1.3.3.1.1.6.2.cmml">ℒ</mi><mtext id="S3.E15.m1.3.3.1.1.6.3" xref="S3.E15.m1.3.3.1.1.6.3a.cmml">uncertainty</mtext></msub><mo id="S3.E15.m1.3.3.1.1.5" xref="S3.E15.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E15.m1.3.3.1.1.4" xref="S3.E15.m1.3.3.1.1.4.cmml"><mrow id="S3.E15.m1.3.3.1.1.2.2" xref="S3.E15.m1.3.3.1.1.2.2.cmml"><msub id="S3.E15.m1.3.3.1.1.2.2.4" xref="S3.E15.m1.3.3.1.1.2.2.4.cmml"><mi id="S3.E15.m1.3.3.1.1.2.2.4.2" xref="S3.E15.m1.3.3.1.1.2.2.4.2.cmml">β</mi><mn id="S3.E15.m1.3.3.1.1.2.2.4.3" xref="S3.E15.m1.3.3.1.1.2.2.4.3.cmml">1</mn></msub><mo id="S3.E15.m1.3.3.1.1.2.2.3" xref="S3.E15.m1.3.3.1.1.2.2.3.cmml">⁢</mo><msub id="S3.E15.m1.3.3.1.1.2.2.5" xref="S3.E15.m1.3.3.1.1.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.3.3.1.1.2.2.5.2" xref="S3.E15.m1.3.3.1.1.2.2.5.2.cmml">ℒ</mi><mtext id="S3.E15.m1.3.3.1.1.2.2.5.3" xref="S3.E15.m1.3.3.1.1.2.2.5.3a.cmml">CE_out</mtext></msub><mo id="S3.E15.m1.3.3.1.1.2.2.3a" xref="S3.E15.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E15.m1.3.3.1.1.2.2.2.2" xref="S3.E15.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S3.E15.m1.3.3.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E15.m1.3.3.1.1.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">S</mi><mo id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E15.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.4" xref="S3.E15.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E15.m1.3.3.1.1.2.2.2.2.2" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E15.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.2.cmml">D</mi><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.2.1" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E15.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.cmml"><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">S</mi><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S3.E15.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.3.3.1.1.4.5" xref="S3.E15.m1.3.3.1.1.4.5.cmml">+</mo><mrow id="S3.E15.m1.3.3.1.1.4.4" xref="S3.E15.m1.3.3.1.1.4.4.cmml"><msub id="S3.E15.m1.3.3.1.1.4.4.4" xref="S3.E15.m1.3.3.1.1.4.4.4.cmml"><mi id="S3.E15.m1.3.3.1.1.4.4.4.2" xref="S3.E15.m1.3.3.1.1.4.4.4.2.cmml">β</mi><mn id="S3.E15.m1.3.3.1.1.4.4.4.3" xref="S3.E15.m1.3.3.1.1.4.4.4.3.cmml">2</mn></msub><mo id="S3.E15.m1.3.3.1.1.4.4.3" xref="S3.E15.m1.3.3.1.1.4.4.3.cmml">⁢</mo><msub id="S3.E15.m1.3.3.1.1.4.4.5" xref="S3.E15.m1.3.3.1.1.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.3.3.1.1.4.4.5.2" xref="S3.E15.m1.3.3.1.1.4.4.5.2.cmml">ℒ</mi><mtext id="S3.E15.m1.3.3.1.1.4.4.5.3" xref="S3.E15.m1.3.3.1.1.4.4.5.3a.cmml">DICE_out</mtext></msub><mo id="S3.E15.m1.3.3.1.1.4.4.3a" xref="S3.E15.m1.3.3.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E15.m1.3.3.1.1.4.4.2.2" xref="S3.E15.m1.3.3.1.1.4.4.2.3.cmml"><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.3" stretchy="false" xref="S3.E15.m1.3.3.1.1.4.4.2.3.cmml">(</mo><msub id="S3.E15.m1.3.3.1.1.3.3.1.1.1" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.cmml"><mover accent="true" id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.cmml"><mi id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.2.cmml">S</mi><mo id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.1" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E15.m1.3.3.1.1.3.3.1.1.1.3" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.3.cmml">l</mi></msub><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.4" xref="S3.E15.m1.3.3.1.1.4.4.2.3.cmml">,</mo><mrow id="S3.E15.m1.3.3.1.1.4.4.2.2.2" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.cmml"><mi id="S3.E15.m1.3.3.1.1.4.4.2.2.2.2" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.2.cmml">D</mi><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.2.1" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.1.cmml">⁢</mo><mrow id="S3.E15.m1.3.3.1.1.4.4.2.2.2.3.2" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.cmml"><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.2.3.2.1" stretchy="false" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.cmml">(</mo><mi id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml">S</mi><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.2.3.2.2" stretchy="false" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.3.3.1.1.4.4.2.2.5" stretchy="false" xref="S3.E15.m1.3.3.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.3.3.1.2" xref="S3.E15.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.3b"><apply id="S3.E15.m1.3.3.1.1.cmml" xref="S3.E15.m1.3.3.1"><eq id="S3.E15.m1.3.3.1.1.5.cmml" xref="S3.E15.m1.3.3.1.1.5"></eq><apply id="S3.E15.m1.3.3.1.1.6.cmml" xref="S3.E15.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.6.1.cmml" xref="S3.E15.m1.3.3.1.1.6">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.6.2.cmml" xref="S3.E15.m1.3.3.1.1.6.2">ℒ</ci><ci id="S3.E15.m1.3.3.1.1.6.3a.cmml" xref="S3.E15.m1.3.3.1.1.6.3"><mtext id="S3.E15.m1.3.3.1.1.6.3.cmml" mathsize="70%" xref="S3.E15.m1.3.3.1.1.6.3">uncertainty</mtext></ci></apply><apply id="S3.E15.m1.3.3.1.1.4.cmml" xref="S3.E15.m1.3.3.1.1.4"><plus id="S3.E15.m1.3.3.1.1.4.5.cmml" xref="S3.E15.m1.3.3.1.1.4.5"></plus><apply id="S3.E15.m1.3.3.1.1.2.2.cmml" xref="S3.E15.m1.3.3.1.1.2.2"><times id="S3.E15.m1.3.3.1.1.2.2.3.cmml" xref="S3.E15.m1.3.3.1.1.2.2.3"></times><apply id="S3.E15.m1.3.3.1.1.2.2.4.cmml" xref="S3.E15.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.2.2.4.1.cmml" xref="S3.E15.m1.3.3.1.1.2.2.4">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.2.2.4.2.cmml" xref="S3.E15.m1.3.3.1.1.2.2.4.2">𝛽</ci><cn id="S3.E15.m1.3.3.1.1.2.2.4.3.cmml" type="integer" xref="S3.E15.m1.3.3.1.1.2.2.4.3">1</cn></apply><apply id="S3.E15.m1.3.3.1.1.2.2.5.cmml" xref="S3.E15.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.2.2.5.1.cmml" xref="S3.E15.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.2.2.5.2.cmml" xref="S3.E15.m1.3.3.1.1.2.2.5.2">ℒ</ci><ci id="S3.E15.m1.3.3.1.1.2.2.5.3a.cmml" xref="S3.E15.m1.3.3.1.1.2.2.5.3"><mtext id="S3.E15.m1.3.3.1.1.2.2.5.3.cmml" mathsize="70%" xref="S3.E15.m1.3.3.1.1.2.2.5.3">CE_out</mtext></ci></apply><interval closure="open" id="S3.E15.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E15.m1.3.3.1.1.2.2.2.2"><apply id="S3.E15.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2"><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.2.2">𝑆</ci></apply><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.E15.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2"><times id="S3.E15.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.1"></times><ci id="S3.E15.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E15.m1.3.3.1.1.2.2.2.2.2.2">𝐷</ci><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝑆</ci></apply></interval></apply><apply id="S3.E15.m1.3.3.1.1.4.4.cmml" xref="S3.E15.m1.3.3.1.1.4.4"><times id="S3.E15.m1.3.3.1.1.4.4.3.cmml" xref="S3.E15.m1.3.3.1.1.4.4.3"></times><apply id="S3.E15.m1.3.3.1.1.4.4.4.cmml" xref="S3.E15.m1.3.3.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.4.4.4.1.cmml" xref="S3.E15.m1.3.3.1.1.4.4.4">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.4.4.4.2.cmml" xref="S3.E15.m1.3.3.1.1.4.4.4.2">𝛽</ci><cn id="S3.E15.m1.3.3.1.1.4.4.4.3.cmml" type="integer" xref="S3.E15.m1.3.3.1.1.4.4.4.3">2</cn></apply><apply id="S3.E15.m1.3.3.1.1.4.4.5.cmml" xref="S3.E15.m1.3.3.1.1.4.4.5"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.4.4.5.1.cmml" xref="S3.E15.m1.3.3.1.1.4.4.5">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.4.4.5.2.cmml" xref="S3.E15.m1.3.3.1.1.4.4.5.2">ℒ</ci><ci id="S3.E15.m1.3.3.1.1.4.4.5.3a.cmml" xref="S3.E15.m1.3.3.1.1.4.4.5.3"><mtext id="S3.E15.m1.3.3.1.1.4.4.5.3.cmml" mathsize="70%" xref="S3.E15.m1.3.3.1.1.4.4.5.3">DICE_out</mtext></ci></apply><interval closure="open" id="S3.E15.m1.3.3.1.1.4.4.2.3.cmml" xref="S3.E15.m1.3.3.1.1.4.4.2.2"><apply id="S3.E15.m1.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.3.3.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1">subscript</csymbol><apply id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2"><ci id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.1">^</ci><ci id="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.2.2">𝑆</ci></apply><ci id="S3.E15.m1.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E15.m1.3.3.1.1.3.3.1.1.1.3">𝑙</ci></apply><apply id="S3.E15.m1.3.3.1.1.4.4.2.2.2.cmml" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2"><times id="S3.E15.m1.3.3.1.1.4.4.2.2.2.1.cmml" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.1"></times><ci id="S3.E15.m1.3.3.1.1.4.4.2.2.2.2.cmml" xref="S3.E15.m1.3.3.1.1.4.4.2.2.2.2">𝐷</ci><ci id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2">𝑆</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.3c">\displaystyle\mathcal{L}_{\text{uncertainty}}=\beta_{1}\mathcal{L}_{\text{CE\_%
out}}(\hat{S}_{l},D(S))+\beta_{2}\mathcal{L}_{\text{DICE\_out}}(\hat{S}_{l},D(%
S)),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.3d">caligraphic_L start_POSTSUBSCRIPT uncertainty end_POSTSUBSCRIPT = italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT CE_out end_POSTSUBSCRIPT ( over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_D ( italic_S ) ) + italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DICE_out end_POSTSUBSCRIPT ( over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_D ( italic_S ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p6.2">where <math alttext="\beta_{1}" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><msub id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">β</mi><mn id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝛽</ci><cn id="S3.SS3.p6.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\beta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\beta_{2}" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m2.1"><semantics id="S3.SS3.p6.2.m2.1a"><msub id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml"><mi id="S3.SS3.p6.2.m2.1.1.2" xref="S3.SS3.p6.2.m2.1.1.2.cmml">β</mi><mn id="S3.SS3.p6.2.m2.1.1.3" xref="S3.SS3.p6.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p6.2.m2.1.1.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2">𝛽</ci><cn id="S3.SS3.p6.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p6.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">\beta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are coefficients that weigh the contributions of the cross-entropy and Dice losses, respectively, in quantifying the uncertainty associated with the segmentation of cells.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.7"><span class="ltx_text ltx_font_bold" id="S3.SS3.p7.7.1">Overall Training Objective.</span> Although the proposed loss function is initially designed for binary segmentation, it is adaptable for multi-class segmentation scenarios. Our overall training objective integrates the segmentation loss, which includes both Dice and Cross Entropy losses, and a regularization component that addresses model uncertainty:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx11">
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\theta}\mathbb{E}_{(\mathbf{x},y)\sim\mathcal{D}}\left[%
\lambda\mathcal{L}_{\text{seg}}(\mathbf{x},y;\theta)+\beta\mathcal{L}_{\text{%
uncertainty}}(\mathbf{x},y;\theta)\right]," class="ltx_Math" display="inline" id="S3.E16.m1.9"><semantics id="S3.E16.m1.9a"><mrow id="S3.E16.m1.9.9.1" xref="S3.E16.m1.9.9.1.1.cmml"><mrow id="S3.E16.m1.9.9.1.1" xref="S3.E16.m1.9.9.1.1.cmml"><mrow id="S3.E16.m1.9.9.1.1.3" xref="S3.E16.m1.9.9.1.1.3.cmml"><munder id="S3.E16.m1.9.9.1.1.3.1" xref="S3.E16.m1.9.9.1.1.3.1.cmml"><mi id="S3.E16.m1.9.9.1.1.3.1.2" xref="S3.E16.m1.9.9.1.1.3.1.2.cmml">min</mi><mi id="S3.E16.m1.9.9.1.1.3.1.3" xref="S3.E16.m1.9.9.1.1.3.1.3.cmml">θ</mi></munder><mo id="S3.E16.m1.9.9.1.1.3a" lspace="0.167em" xref="S3.E16.m1.9.9.1.1.3.cmml">⁡</mo><msub id="S3.E16.m1.9.9.1.1.3.2" xref="S3.E16.m1.9.9.1.1.3.2.cmml"><mi id="S3.E16.m1.9.9.1.1.3.2.2" xref="S3.E16.m1.9.9.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E16.m1.2.2.2" xref="S3.E16.m1.2.2.2.cmml"><mrow id="S3.E16.m1.2.2.2.4.2" xref="S3.E16.m1.2.2.2.4.1.cmml"><mo id="S3.E16.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E16.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E16.m1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml">𝐱</mi><mo id="S3.E16.m1.2.2.2.4.2.2" xref="S3.E16.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E16.m1.2.2.2.2" xref="S3.E16.m1.2.2.2.2.cmml">y</mi><mo id="S3.E16.m1.2.2.2.4.2.3" stretchy="false" xref="S3.E16.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E16.m1.2.2.2.3" xref="S3.E16.m1.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.2.2.2.5" xref="S3.E16.m1.2.2.2.5.cmml">𝒟</mi></mrow></msub></mrow><mo id="S3.E16.m1.9.9.1.1.2" xref="S3.E16.m1.9.9.1.1.2.cmml">⁢</mo><mrow id="S3.E16.m1.9.9.1.1.1.1" xref="S3.E16.m1.9.9.1.1.1.2.cmml"><mo id="S3.E16.m1.9.9.1.1.1.1.2" xref="S3.E16.m1.9.9.1.1.1.2.1.cmml">[</mo><mrow id="S3.E16.m1.9.9.1.1.1.1.1" xref="S3.E16.m1.9.9.1.1.1.1.1.cmml"><mrow id="S3.E16.m1.9.9.1.1.1.1.1.2" xref="S3.E16.m1.9.9.1.1.1.1.1.2.cmml"><mi id="S3.E16.m1.9.9.1.1.1.1.1.2.2" xref="S3.E16.m1.9.9.1.1.1.1.1.2.2.cmml">λ</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.1" xref="S3.E16.m1.9.9.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E16.m1.9.9.1.1.1.1.1.2.3" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.9.9.1.1.1.1.1.2.3.2" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.2.cmml">ℒ</mi><mtext id="S3.E16.m1.9.9.1.1.1.1.1.2.3.3" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.3a.cmml">seg</mtext></msub><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.1a" xref="S3.E16.m1.9.9.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E16.m1.9.9.1.1.1.1.1.2.4.2" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml"><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.4.2.1" stretchy="false" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml">(</mo><mi id="S3.E16.m1.3.3" xref="S3.E16.m1.3.3.cmml">𝐱</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.4.2.2" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml">,</mo><mi id="S3.E16.m1.4.4" xref="S3.E16.m1.4.4.cmml">y</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.4.2.3" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml">;</mo><mi id="S3.E16.m1.5.5" xref="S3.E16.m1.5.5.cmml">θ</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.2.4.2.4" stretchy="false" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.9.9.1.1.1.1.1.1" xref="S3.E16.m1.9.9.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E16.m1.9.9.1.1.1.1.1.3" xref="S3.E16.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.9.9.1.1.1.1.1.3.2" xref="S3.E16.m1.9.9.1.1.1.1.1.3.2.cmml">β</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.1" xref="S3.E16.m1.9.9.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E16.m1.9.9.1.1.1.1.1.3.3" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.9.9.1.1.1.1.1.3.3.2" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E16.m1.9.9.1.1.1.1.1.3.3.3" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.3a.cmml">uncertainty</mtext></msub><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.1a" xref="S3.E16.m1.9.9.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E16.m1.9.9.1.1.1.1.1.3.4.2" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml"><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.4.2.1" stretchy="false" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml">(</mo><mi id="S3.E16.m1.6.6" xref="S3.E16.m1.6.6.cmml">𝐱</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.4.2.2" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml">,</mo><mi id="S3.E16.m1.7.7" xref="S3.E16.m1.7.7.cmml">y</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.4.2.3" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml">;</mo><mi id="S3.E16.m1.8.8" xref="S3.E16.m1.8.8.cmml">θ</mi><mo id="S3.E16.m1.9.9.1.1.1.1.1.3.4.2.4" stretchy="false" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E16.m1.9.9.1.1.1.1.3" xref="S3.E16.m1.9.9.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E16.m1.9.9.1.2" xref="S3.E16.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.9b"><apply id="S3.E16.m1.9.9.1.1.cmml" xref="S3.E16.m1.9.9.1"><times id="S3.E16.m1.9.9.1.1.2.cmml" xref="S3.E16.m1.9.9.1.1.2"></times><apply id="S3.E16.m1.9.9.1.1.3.cmml" xref="S3.E16.m1.9.9.1.1.3"><apply id="S3.E16.m1.9.9.1.1.3.1.cmml" xref="S3.E16.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S3.E16.m1.9.9.1.1.3.1.1.cmml" xref="S3.E16.m1.9.9.1.1.3.1">subscript</csymbol><min id="S3.E16.m1.9.9.1.1.3.1.2.cmml" xref="S3.E16.m1.9.9.1.1.3.1.2"></min><ci id="S3.E16.m1.9.9.1.1.3.1.3.cmml" xref="S3.E16.m1.9.9.1.1.3.1.3">𝜃</ci></apply><apply id="S3.E16.m1.9.9.1.1.3.2.cmml" xref="S3.E16.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S3.E16.m1.9.9.1.1.3.2.1.cmml" xref="S3.E16.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S3.E16.m1.9.9.1.1.3.2.2.cmml" xref="S3.E16.m1.9.9.1.1.3.2.2">𝔼</ci><apply id="S3.E16.m1.2.2.2.cmml" xref="S3.E16.m1.2.2.2"><csymbol cd="latexml" id="S3.E16.m1.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E16.m1.2.2.2.4.1.cmml" xref="S3.E16.m1.2.2.2.4.2"><ci id="S3.E16.m1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1">𝐱</ci><ci id="S3.E16.m1.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2">𝑦</ci></interval><ci id="S3.E16.m1.2.2.2.5.cmml" xref="S3.E16.m1.2.2.2.5">𝒟</ci></apply></apply></apply><apply id="S3.E16.m1.9.9.1.1.1.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m1.9.9.1.1.1.2.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E16.m1.9.9.1.1.1.1.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1"><plus id="S3.E16.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.1"></plus><apply id="S3.E16.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2"><times id="S3.E16.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.1"></times><ci id="S3.E16.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.2">𝜆</ci><apply id="S3.E16.m1.9.9.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.9.9.1.1.1.1.1.2.3.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E16.m1.9.9.1.1.1.1.1.2.3.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.2">ℒ</ci><ci id="S3.E16.m1.9.9.1.1.1.1.1.2.3.3a.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.3"><mtext id="S3.E16.m1.9.9.1.1.1.1.1.2.3.3.cmml" mathsize="70%" xref="S3.E16.m1.9.9.1.1.1.1.1.2.3.3">seg</mtext></ci></apply><vector id="S3.E16.m1.9.9.1.1.1.1.1.2.4.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.2.4.2"><ci id="S3.E16.m1.3.3.cmml" xref="S3.E16.m1.3.3">𝐱</ci><ci id="S3.E16.m1.4.4.cmml" xref="S3.E16.m1.4.4">𝑦</ci><ci id="S3.E16.m1.5.5.cmml" xref="S3.E16.m1.5.5">𝜃</ci></vector></apply><apply id="S3.E16.m1.9.9.1.1.1.1.1.3.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3"><times id="S3.E16.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.1"></times><ci id="S3.E16.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.2">𝛽</ci><apply id="S3.E16.m1.9.9.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.9.9.1.1.1.1.1.3.3.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E16.m1.9.9.1.1.1.1.1.3.3.2.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E16.m1.9.9.1.1.1.1.1.3.3.3a.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.3"><mtext id="S3.E16.m1.9.9.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E16.m1.9.9.1.1.1.1.1.3.3.3">uncertainty</mtext></ci></apply><vector id="S3.E16.m1.9.9.1.1.1.1.1.3.4.1.cmml" xref="S3.E16.m1.9.9.1.1.1.1.1.3.4.2"><ci id="S3.E16.m1.6.6.cmml" xref="S3.E16.m1.6.6">𝐱</ci><ci id="S3.E16.m1.7.7.cmml" xref="S3.E16.m1.7.7">𝑦</ci><ci id="S3.E16.m1.8.8.cmml" xref="S3.E16.m1.8.8">𝜃</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.9c">\displaystyle\min_{\theta}\mathbb{E}_{(\mathbf{x},y)\sim\mathcal{D}}\left[%
\lambda\mathcal{L}_{\text{seg}}(\mathbf{x},y;\theta)+\beta\mathcal{L}_{\text{%
uncertainty}}(\mathbf{x},y;\theta)\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.9d">roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( bold_x , italic_y ) ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_λ caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT ( bold_x , italic_y ; italic_θ ) + italic_β caligraphic_L start_POSTSUBSCRIPT uncertainty end_POSTSUBSCRIPT ( bold_x , italic_y ; italic_θ ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.6">where <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><mi id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><ci id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">italic_λ</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><mi id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><ci id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">italic_β</annotation></semantics></math> is the weighting coefficient for the uncertainty regularization. The segmentation loss, <math alttext="\mathcal{L}_{\text{seg}}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><msub id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.3.m3.1.1.2" xref="S3.SS3.p7.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2">ℒ</ci><ci id="S3.SS3.p7.3.m3.1.1.3a.cmml" xref="S3.SS3.p7.3.m3.1.1.3"><mtext id="S3.SS3.p7.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.3.m3.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">\mathcal{L}_{\text{seg}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT seg end_POSTSUBSCRIPT</annotation></semantics></math>, combines the Dice loss, <math alttext="\mathcal{L}_{\text{DICE}}" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><msub id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.4.m4.1.1.2" xref="S3.SS3.p7.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p7.4.m4.1.1.3" xref="S3.SS3.p7.4.m4.1.1.3a.cmml">DICE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><apply id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.4.m4.1.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p7.4.m4.1.1.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2">ℒ</ci><ci id="S3.SS3.p7.4.m4.1.1.3a.cmml" xref="S3.SS3.p7.4.m4.1.1.3"><mtext id="S3.SS3.p7.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.4.m4.1.1.3">DICE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">\mathcal{L}_{\text{DICE}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT DICE end_POSTSUBSCRIPT</annotation></semantics></math>, and the cross-entropy loss, <math alttext="\mathcal{L}_{\text{CE}}" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><msub id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.5.m5.1.1.2" xref="S3.SS3.p7.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p7.5.m5.1.1.3" xref="S3.SS3.p7.5.m5.1.1.3a.cmml">CE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><apply id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.5.m5.1.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p7.5.m5.1.1.2.cmml" xref="S3.SS3.p7.5.m5.1.1.2">ℒ</ci><ci id="S3.SS3.p7.5.m5.1.1.3a.cmml" xref="S3.SS3.p7.5.m5.1.1.3"><mtext id="S3.SS3.p7.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.5.m5.1.1.3">CE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\mathcal{L}_{\text{CE}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT CE end_POSTSUBSCRIPT</annotation></semantics></math>, formulated to effectively handle the segmentation of cells across different stages and morphologies. The uncertainty component, <math alttext="\mathcal{L}_{\text{uncertainty}}" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m6.1"><semantics id="S3.SS3.p7.6.m6.1a"><msub id="S3.SS3.p7.6.m6.1.1" xref="S3.SS3.p7.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.6.m6.1.1.2" xref="S3.SS3.p7.6.m6.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p7.6.m6.1.1.3" xref="S3.SS3.p7.6.m6.1.1.3a.cmml">uncertainty</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m6.1b"><apply id="S3.SS3.p7.6.m6.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.1.2.cmml" xref="S3.SS3.p7.6.m6.1.1.2">ℒ</ci><ci id="S3.SS3.p7.6.m6.1.1.3a.cmml" xref="S3.SS3.p7.6.m6.1.1.3"><mtext id="S3.SS3.p7.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.6.m6.1.1.3">uncertainty</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m6.1c">\mathcal{L}_{\text{uncertainty}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT uncertainty end_POSTSUBSCRIPT</annotation></semantics></math>, leverages synthetic data to enhance the model’s ability to predict underrepresented features and quantify predictive confidence. Ablation studies, detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.SS4" title="5.4 Ablation Studies ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">5.4</span></a>, demonstrate the efficacy of this loss function in improving segmentation accuracy and model robustness.</p>
</div>
</section>
</section>
<section class="ltx_section ltx_indent_first" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Dataset Analysis</h2>
<section class="ltx_subsection ltx_indent_first" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Data Description</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">NT2 cells were exposed to <math alttext="10\textsuperscript{-5}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">10</mn><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3b.cmml"><sup class="ltx_sup" id="S4.SS1.p1.1.m1.1.1.3.1nest">-5</sup></mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn id="S4.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2">10</cn><ci id="S4.SS1.p1.1.m1.1.1.3b.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><mtext id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><sup class="ltx_sup" id="S4.SS1.p1.1.m1.1.1.3.1anest">-5</sup></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">10\textsuperscript{-5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">10</annotation></semantics></math> ATRA every 48 hours for 14 days  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib18" title="">18</a>]</cite>. The cells were imaged using a bright-field microscope on treatment days. ATRA exposure induces neuronal differentiation in NT2 cells, leading to notable morphological changes including an increase in cytoplasm size, elongation of the cell body and neurite extension, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">1</span></a>B.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The NT2 dataset consists of 105 high-resolution raw images of NT2 cells undergoing differentiation, of which 36 images are fully annotated. These images have resolutions primarily around <math alttext="4000\times 3000" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">4000</mn><mo id="S4.SS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">3000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></times><cn id="S4.SS1.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1.2">4000</cn><cn id="S4.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1.3">3000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">4000\times 3000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">4000 × 3000</annotation></semantics></math> pixels, enabling detailed morphological analysis and accurate segmentation.</p>
</div>
</section>
<section class="ltx_subsection ltx_indent_first" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Data Preprocessing</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.5.1">Data Augmentation.</span> To efficiently train our TransUNet model, we have devised a method to augment the dataset by transforming the high-resolution images into smaller, manageable patches. This is achieved by dividing the images into patches of sizes <math alttext="224\times 224" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">224</mn><mo id="S4.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></times><cn id="S4.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.2">224</cn><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">224 × 224</annotation></semantics></math>, <math alttext="448\times 448" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">448</mn><mo id="S4.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><times id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></times><cn id="S4.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.2">448</cn><cn id="S4.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">448\times 448</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">448 × 448</annotation></semantics></math>, <math alttext="1000\times 1000" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">1000</mn><mo id="S4.SS2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></times><cn id="S4.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.2">1000</cn><cn id="S4.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">1000\times 1000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">1000 × 1000</annotation></semantics></math>, <math alttext="1500\times 1500" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">1500</mn><mo id="S4.SS2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.4.m4.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">1500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><times id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></times><cn id="S4.SS2.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.2">1500</cn><cn id="S4.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.3">1500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">1500\times 1500</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">1500 × 1500</annotation></semantics></math>, and <math alttext="2000\times 2000" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">2000</mn><mo id="S4.SS2.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><times id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></times><cn id="S4.SS2.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1.2">2000</cn><cn id="S4.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1.3">2000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">2000\times 2000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">2000 × 2000</annotation></semantics></math> pixels. We employ an overlapping strategy with an overlap ratio of 0.35 to preserve the spatial context across adjacent patches, which is crucial for capturing the comprehensive spatial information of the cell structures. Combined with the original undivided images and masks, this makes the full dataset for training and testing.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Using this technique, we generate a total of 15,710 patches. These patches are then randomly split into a training set and a testing set, maintaining an 80% to 20% ratio, respectively. This distribution results in 12,568 patches for training and 3,142 patches for testing. To optimize the model’s performance, we implement a data pruning strategy during both the training and testing stages, excluding all patches that do not contain any part of the annotated masks, which will reduce the training set to 10,016 samples for testing.</p>
</div>
</section>
</section>
<section class="ltx_section ltx_indent_first" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection ltx_indent_first" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Implementation details</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.10">We evaluate our model against established benchmarks including Cellpose and TransUNet, utilizing the AdamW optimizer with exponential learning rate decay on the R50-ViT-B architecture. Specifically for Cellpose, we utilize two of the highest performing pre-trained configurations, cyto3 and cyto2, both set with a cell diameter of <math alttext="30" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><cn id="S5.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">30</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">30</annotation></semantics></math>. These models are trained with a learning rate of <math alttext="0.01" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mn id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><cn id="S5.SS1.p1.2.m2.1.1.cmml" type="float" xref="S5.SS1.p1.2.m2.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">0.01</annotation></semantics></math>, a weight decay of <math alttext="5\times 10^{-5}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">5</mn><mo id="S5.SS1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.3.m3.1.1.1.cmml">×</mo><msup id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml"><mn id="S5.SS1.p1.3.m3.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p1.3.m3.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml"><mo id="S5.SS1.p1.3.m3.1.1.3.3a" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p1.3.m3.1.1.3.3.2" xref="S5.SS1.p1.3.m3.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><times id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1"></times><cn id="S5.SS1.p1.3.m3.1.1.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.2">5</cn><apply id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3">superscript</csymbol><cn id="S5.SS1.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.3.2">10</cn><apply id="S5.SS1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3"><minus id="S5.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3"></minus><cn id="S5.SS1.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">5\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">5 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>, and over <math alttext="200" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mn id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><cn id="S5.SS1.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">200</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">200</annotation></semantics></math> epochs. The batch size for training is set at <math alttext="8" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><mn id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><cn id="S5.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S5.SS1.p1.5.m5.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">8</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">8</annotation></semantics></math>, with verbose output enabled for detailed progress tracking. During testing, we adapted the Cellpose model to handle larger cells by setting the diameter parameter to <math alttext="100" class="ltx_Math" display="inline" id="S5.SS1.p1.6.m6.1"><semantics id="S5.SS1.p1.6.m6.1a"><mn id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><cn id="S5.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S5.SS1.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m6.1d">100</annotation></semantics></math>, with no flow threshold and a cell probability threshold of <math alttext="0.2" class="ltx_Math" display="inline" id="S5.SS1.p1.7.m7.1"><semantics id="S5.SS1.p1.7.m7.1a"><mn id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><cn id="S5.SS1.p1.7.m7.1.1.cmml" type="float" xref="S5.SS1.p1.7.m7.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">0.2</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.7.m7.1d">0.2</annotation></semantics></math>, adjusting the channels accordingly to match specific imaging conditions. For the TransUNet, we adhere which includes two types of encoders: a pure Transformer-based encoder, denoted as “ViT-B16,” and a hybrid encoder that combines ResNet-50 with ViT, denoted as “R50-B16”. The input resolution and patch size <math alttext="P" class="ltx_Math" display="inline" id="S5.SS1.p1.8.m8.1"><semantics id="S5.SS1.p1.8.m8.1a"><mi id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><ci id="S5.SS1.p1.8.m8.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">P</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.8.m8.1d">italic_P</annotation></semantics></math> are set to 224<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.p1.9.m9.1"><semantics id="S5.SS1.p1.9.m9.1a"><mo id="S5.SS1.p1.9.m9.1.1" xref="S5.SS1.p1.9.m9.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.9.m9.1b"><times id="S5.SS1.p1.9.m9.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.9.m9.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.9.m9.1d">×</annotation></semantics></math>224 and 16, respectively. We set the learning rate to 0.01, momentum to 0.9, and weight decay to <math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="S5.SS1.p1.10.m10.1"><semantics id="S5.SS1.p1.10.m10.1a"><mrow id="S5.SS1.p1.10.m10.1.1" xref="S5.SS1.p1.10.m10.1.1.cmml"><mn id="S5.SS1.p1.10.m10.1.1.2" xref="S5.SS1.p1.10.m10.1.1.2.cmml">1</mn><mo id="S5.SS1.p1.10.m10.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.10.m10.1.1.1.cmml">×</mo><msup id="S5.SS1.p1.10.m10.1.1.3" xref="S5.SS1.p1.10.m10.1.1.3.cmml"><mn id="S5.SS1.p1.10.m10.1.1.3.2" xref="S5.SS1.p1.10.m10.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p1.10.m10.1.1.3.3" xref="S5.SS1.p1.10.m10.1.1.3.3.cmml"><mo id="S5.SS1.p1.10.m10.1.1.3.3a" xref="S5.SS1.p1.10.m10.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p1.10.m10.1.1.3.3.2" xref="S5.SS1.p1.10.m10.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.10.m10.1b"><apply id="S5.SS1.p1.10.m10.1.1.cmml" xref="S5.SS1.p1.10.m10.1.1"><times id="S5.SS1.p1.10.m10.1.1.1.cmml" xref="S5.SS1.p1.10.m10.1.1.1"></times><cn id="S5.SS1.p1.10.m10.1.1.2.cmml" type="integer" xref="S5.SS1.p1.10.m10.1.1.2">1</cn><apply id="S5.SS1.p1.10.m10.1.1.3.cmml" xref="S5.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.10.m10.1.1.3.1.cmml" xref="S5.SS1.p1.10.m10.1.1.3">superscript</csymbol><cn id="S5.SS1.p1.10.m10.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.10.m10.1.1.3.2">10</cn><apply id="S5.SS1.p1.10.m10.1.1.3.3.cmml" xref="S5.SS1.p1.10.m10.1.1.3.3"><minus id="S5.SS1.p1.10.m10.1.1.3.3.1.cmml" xref="S5.SS1.p1.10.m10.1.1.3.3"></minus><cn id="S5.SS1.p1.10.m10.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p1.10.m10.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.10.m10.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.10.m10.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. The models are trained over 200 epochs, with sampling commencing at the 150th epoch.
Both models are trained on two NVIDIA A100 GPUs with a batch size of 256, focusing on 10,000 critical samples by selectively sampling 1,000 pixels per image to enhance training efficiency and effectiveness.</p>
</div>
</section>
<section class="ltx_subsection ltx_indent_first" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">To evaluate our method, we considered four key metrics: 1) the average Dice Similarity Coefficient (DSC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib53" title="">53</a>]</cite>, 2) the average Hausdorff Distance (HD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib54" title="">54</a>]</cite>, 3) the Intersection over Union (IoU) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib55" title="">55</a>]</cite>, and 4) the mean Average Precision (mAP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib56" title="">56</a>]</cite>. These metrics provide a comprehensive assessment of segmentation accuracy and model performance.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">For each class, the unique matching of <math alttext="(y,\hat{y})" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.2"><semantics id="S5.SS2.p2.1.m1.2a"><mrow id="S5.SS2.p2.1.m1.2.3.2" xref="S5.SS2.p2.1.m1.2.3.1.cmml"><mo id="S5.SS2.p2.1.m1.2.3.2.1" stretchy="false" xref="S5.SS2.p2.1.m1.2.3.1.cmml">(</mo><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">y</mi><mo id="S5.SS2.p2.1.m1.2.3.2.2" xref="S5.SS2.p2.1.m1.2.3.1.cmml">,</mo><mover accent="true" id="S5.SS2.p2.1.m1.2.2" xref="S5.SS2.p2.1.m1.2.2.cmml"><mi id="S5.SS2.p2.1.m1.2.2.2" xref="S5.SS2.p2.1.m1.2.2.2.cmml">y</mi><mo id="S5.SS2.p2.1.m1.2.2.1" xref="S5.SS2.p2.1.m1.2.2.1.cmml">^</mo></mover><mo id="S5.SS2.p2.1.m1.2.3.2.3" stretchy="false" xref="S5.SS2.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.2b"><interval closure="open" id="S5.SS2.p2.1.m1.2.3.1.cmml" xref="S5.SS2.p2.1.m1.2.3.2"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝑦</ci><apply id="S5.SS2.p2.1.m1.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2"><ci id="S5.SS2.p2.1.m1.2.2.1.cmml" xref="S5.SS2.p2.1.m1.2.2.1">^</ci><ci id="S5.SS2.p2.1.m1.2.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2.2">𝑦</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.2c">(y,\hat{y})</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.2d">( italic_y , over^ start_ARG italic_y end_ARG )</annotation></semantics></math> splits the predicted and the GT segments into three sets:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">True Positives (TP): the number of correctly predicted pixels that match the ground truth.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">False Positives (FP): the number of pixels incorrectly predicted as part of the object when they are not in the ground truth.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1">False negatives (FN): the number of pixels that are missed by the prediction but are present in the ground truth.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">The Dice Similarity Coefficient (DSC) is a standard metric for assessing the overlap between the predicted segmentation mask and the ground truth mask. It is defined as:</p>
</div>
<div class="ltx_para" id="S5.SS2.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx12">
<tbody id="S5.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S5.E17.2.1.1.1">DSC</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{2\times\text{TP}}{2\times\text{TP}+\text{FP}+\text{FN}}," class="ltx_Math" display="inline" id="S5.E17.m2.1"><semantics id="S5.E17.m2.1a"><mrow id="S5.E17.m2.1.1.1" xref="S5.E17.m2.1.1.1.1.cmml"><mrow id="S5.E17.m2.1.1.1.1" xref="S5.E17.m2.1.1.1.1.cmml"><mi id="S5.E17.m2.1.1.1.1.2" xref="S5.E17.m2.1.1.1.1.2.cmml"></mi><mo id="S5.E17.m2.1.1.1.1.1" xref="S5.E17.m2.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S5.E17.m2.1.1.1.1.3" xref="S5.E17.m2.1.1.1.1.3.cmml"><mfrac id="S5.E17.m2.1.1.1.1.3a" xref="S5.E17.m2.1.1.1.1.3.cmml"><mrow id="S5.E17.m2.1.1.1.1.3.2" xref="S5.E17.m2.1.1.1.1.3.2.cmml"><mn id="S5.E17.m2.1.1.1.1.3.2.2" xref="S5.E17.m2.1.1.1.1.3.2.2.cmml">2</mn><mo id="S5.E17.m2.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E17.m2.1.1.1.1.3.2.1.cmml">×</mo><mtext id="S5.E17.m2.1.1.1.1.3.2.3" xref="S5.E17.m2.1.1.1.1.3.2.3a.cmml">TP</mtext></mrow><mrow id="S5.E17.m2.1.1.1.1.3.3" xref="S5.E17.m2.1.1.1.1.3.3.cmml"><mrow id="S5.E17.m2.1.1.1.1.3.3.2" xref="S5.E17.m2.1.1.1.1.3.3.2.cmml"><mn id="S5.E17.m2.1.1.1.1.3.3.2.2" xref="S5.E17.m2.1.1.1.1.3.3.2.2.cmml">2</mn><mo id="S5.E17.m2.1.1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E17.m2.1.1.1.1.3.3.2.1.cmml">×</mo><mtext id="S5.E17.m2.1.1.1.1.3.3.2.3" xref="S5.E17.m2.1.1.1.1.3.3.2.3a.cmml">TP</mtext></mrow><mo id="S5.E17.m2.1.1.1.1.3.3.1" xref="S5.E17.m2.1.1.1.1.3.3.1.cmml">+</mo><mtext id="S5.E17.m2.1.1.1.1.3.3.3" xref="S5.E17.m2.1.1.1.1.3.3.3a.cmml">FP</mtext><mo id="S5.E17.m2.1.1.1.1.3.3.1a" xref="S5.E17.m2.1.1.1.1.3.3.1.cmml">+</mo><mtext id="S5.E17.m2.1.1.1.1.3.3.4" xref="S5.E17.m2.1.1.1.1.3.3.4a.cmml">FN</mtext></mrow></mfrac></mstyle></mrow><mo id="S5.E17.m2.1.1.1.2" xref="S5.E17.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E17.m2.1b"><apply id="S5.E17.m2.1.1.1.1.cmml" xref="S5.E17.m2.1.1.1"><eq id="S5.E17.m2.1.1.1.1.1.cmml" xref="S5.E17.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S5.E17.m2.1.1.1.1.2.cmml" xref="S5.E17.m2.1.1.1.1.2">absent</csymbol><apply id="S5.E17.m2.1.1.1.1.3.cmml" xref="S5.E17.m2.1.1.1.1.3"><divide id="S5.E17.m2.1.1.1.1.3.1.cmml" xref="S5.E17.m2.1.1.1.1.3"></divide><apply id="S5.E17.m2.1.1.1.1.3.2.cmml" xref="S5.E17.m2.1.1.1.1.3.2"><times id="S5.E17.m2.1.1.1.1.3.2.1.cmml" xref="S5.E17.m2.1.1.1.1.3.2.1"></times><cn id="S5.E17.m2.1.1.1.1.3.2.2.cmml" type="integer" xref="S5.E17.m2.1.1.1.1.3.2.2">2</cn><ci id="S5.E17.m2.1.1.1.1.3.2.3a.cmml" xref="S5.E17.m2.1.1.1.1.3.2.3"><mtext id="S5.E17.m2.1.1.1.1.3.2.3.cmml" xref="S5.E17.m2.1.1.1.1.3.2.3">TP</mtext></ci></apply><apply id="S5.E17.m2.1.1.1.1.3.3.cmml" xref="S5.E17.m2.1.1.1.1.3.3"><plus id="S5.E17.m2.1.1.1.1.3.3.1.cmml" xref="S5.E17.m2.1.1.1.1.3.3.1"></plus><apply id="S5.E17.m2.1.1.1.1.3.3.2.cmml" xref="S5.E17.m2.1.1.1.1.3.3.2"><times id="S5.E17.m2.1.1.1.1.3.3.2.1.cmml" xref="S5.E17.m2.1.1.1.1.3.3.2.1"></times><cn id="S5.E17.m2.1.1.1.1.3.3.2.2.cmml" type="integer" xref="S5.E17.m2.1.1.1.1.3.3.2.2">2</cn><ci id="S5.E17.m2.1.1.1.1.3.3.2.3a.cmml" xref="S5.E17.m2.1.1.1.1.3.3.2.3"><mtext id="S5.E17.m2.1.1.1.1.3.3.2.3.cmml" xref="S5.E17.m2.1.1.1.1.3.3.2.3">TP</mtext></ci></apply><ci id="S5.E17.m2.1.1.1.1.3.3.3a.cmml" xref="S5.E17.m2.1.1.1.1.3.3.3"><mtext id="S5.E17.m2.1.1.1.1.3.3.3.cmml" xref="S5.E17.m2.1.1.1.1.3.3.3">FP</mtext></ci><ci id="S5.E17.m2.1.1.1.1.3.3.4a.cmml" xref="S5.E17.m2.1.1.1.1.3.3.4"><mtext id="S5.E17.m2.1.1.1.1.3.3.4.cmml" xref="S5.E17.m2.1.1.1.1.3.3.4">FN</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E17.m2.1c">\displaystyle=\frac{2\times\text{TP}}{2\times\text{TP}+\text{FP}+\text{FN}},</annotation><annotation encoding="application/x-llamapun" id="S5.E17.m2.1d">= divide start_ARG 2 × TP end_ARG start_ARG 2 × TP + FP + FN end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.4">where <span class="ltx_text ltx_markedasmath" id="S5.SS2.p5.4.1">TP</span>, <span class="ltx_text ltx_markedasmath" id="S5.SS2.p5.4.2">FP</span>, and <span class="ltx_text ltx_markedasmath" id="S5.SS2.p5.4.3">FN</span> denote the number of true positive, false positive, and false negative pixels, respectively. The Mean DSC is computed by averaging the DSC values across all segmentation instances or classes in the dataset. The Mean DSC provides a robust measure of overall segmentation accuracy, facilitating a comprehensive evaluation of model performance across all classes or instances. Since we only have <math alttext="1" class="ltx_Math" display="inline" id="S5.SS2.p5.4.m4.1"><semantics id="S5.SS2.p5.4.m4.1a"><mn id="S5.SS2.p5.4.m4.1.1" xref="S5.SS2.p5.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.4.m4.1b"><cn id="S5.SS2.p5.4.m4.1.1.cmml" type="integer" xref="S5.SS2.p5.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p5.4.m4.1d">1</annotation></semantics></math> target class which is the cell, we only use the DSC as the evaluation metric.</p>
</div>
<div class="ltx_para" id="S5.SS2.p6">
<p class="ltx_p" id="S5.SS2.p6.2">To further assess the boundary accuracy, we employ the 95th Percentile Hausdorff Distance (HD95), which offers a more robust measure of the spatial discrepancy between the predicted and ground truth segmentation boundaries. The Hausdorff Distance (HD) between two sets, <math alttext="X" class="ltx_Math" display="inline" id="S5.SS2.p6.1.m1.1"><semantics id="S5.SS2.p6.1.m1.1a"><mi id="S5.SS2.p6.1.m1.1.1" xref="S5.SS2.p6.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.1.m1.1b"><ci id="S5.SS2.p6.1.m1.1.1.cmml" xref="S5.SS2.p6.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.1.m1.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S5.SS2.p6.2.m2.1"><semantics id="S5.SS2.p6.2.m2.1a"><mi id="S5.SS2.p6.2.m2.1.1" xref="S5.SS2.p6.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.2.m2.1b"><ci id="S5.SS2.p6.2.m2.1.1.cmml" xref="S5.SS2.p6.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.2.m2.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.2.m2.1d">italic_Y</annotation></semantics></math>, is given by:</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p7">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx13">
<tbody id="S5.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{HD}(X,Y)" class="ltx_Math" display="inline" id="S5.E18.m1.2"><semantics id="S5.E18.m1.2a"><mrow id="S5.E18.m1.2.3" xref="S5.E18.m1.2.3.cmml"><mtext id="S5.E18.m1.2.3.2" xref="S5.E18.m1.2.3.2a.cmml">HD</mtext><mo id="S5.E18.m1.2.3.1" xref="S5.E18.m1.2.3.1.cmml">⁢</mo><mrow id="S5.E18.m1.2.3.3.2" xref="S5.E18.m1.2.3.3.1.cmml"><mo id="S5.E18.m1.2.3.3.2.1" stretchy="false" xref="S5.E18.m1.2.3.3.1.cmml">(</mo><mi id="S5.E18.m1.1.1" xref="S5.E18.m1.1.1.cmml">X</mi><mo id="S5.E18.m1.2.3.3.2.2" xref="S5.E18.m1.2.3.3.1.cmml">,</mo><mi id="S5.E18.m1.2.2" xref="S5.E18.m1.2.2.cmml">Y</mi><mo id="S5.E18.m1.2.3.3.2.3" stretchy="false" xref="S5.E18.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E18.m1.2b"><apply id="S5.E18.m1.2.3.cmml" xref="S5.E18.m1.2.3"><times id="S5.E18.m1.2.3.1.cmml" xref="S5.E18.m1.2.3.1"></times><ci id="S5.E18.m1.2.3.2a.cmml" xref="S5.E18.m1.2.3.2"><mtext id="S5.E18.m1.2.3.2.cmml" xref="S5.E18.m1.2.3.2">HD</mtext></ci><interval closure="open" id="S5.E18.m1.2.3.3.1.cmml" xref="S5.E18.m1.2.3.3.2"><ci id="S5.E18.m1.1.1.cmml" xref="S5.E18.m1.1.1">𝑋</ci><ci id="S5.E18.m1.2.2.cmml" xref="S5.E18.m1.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E18.m1.2c">\displaystyle\text{HD}(X,Y)</annotation><annotation encoding="application/x-llamapun" id="S5.E18.m1.2d">HD ( italic_X , italic_Y )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\max(h(X,Y),h(Y,X))," class="ltx_Math" display="inline" id="S5.E18.m2.6"><semantics id="S5.E18.m2.6a"><mrow id="S5.E18.m2.6.6.1" xref="S5.E18.m2.6.6.1.1.cmml"><mrow id="S5.E18.m2.6.6.1.1" xref="S5.E18.m2.6.6.1.1.cmml"><mi id="S5.E18.m2.6.6.1.1.4" xref="S5.E18.m2.6.6.1.1.4.cmml"></mi><mo id="S5.E18.m2.6.6.1.1.3" xref="S5.E18.m2.6.6.1.1.3.cmml">=</mo><mrow id="S5.E18.m2.6.6.1.1.2.2" xref="S5.E18.m2.6.6.1.1.2.3.cmml"><mi id="S5.E18.m2.5.5" xref="S5.E18.m2.5.5.cmml">max</mi><mo id="S5.E18.m2.6.6.1.1.2.2a" xref="S5.E18.m2.6.6.1.1.2.3.cmml">⁡</mo><mrow id="S5.E18.m2.6.6.1.1.2.2.2" xref="S5.E18.m2.6.6.1.1.2.3.cmml"><mo id="S5.E18.m2.6.6.1.1.2.2.2.3" stretchy="false" xref="S5.E18.m2.6.6.1.1.2.3.cmml">(</mo><mrow id="S5.E18.m2.6.6.1.1.1.1.1.1" xref="S5.E18.m2.6.6.1.1.1.1.1.1.cmml"><mi id="S5.E18.m2.6.6.1.1.1.1.1.1.2" xref="S5.E18.m2.6.6.1.1.1.1.1.1.2.cmml">h</mi><mo id="S5.E18.m2.6.6.1.1.1.1.1.1.1" xref="S5.E18.m2.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.E18.m2.6.6.1.1.1.1.1.1.3.2" xref="S5.E18.m2.6.6.1.1.1.1.1.1.3.1.cmml"><mo id="S5.E18.m2.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.E18.m2.6.6.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S5.E18.m2.1.1" xref="S5.E18.m2.1.1.cmml">X</mi><mo id="S5.E18.m2.6.6.1.1.1.1.1.1.3.2.2" xref="S5.E18.m2.6.6.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S5.E18.m2.2.2" xref="S5.E18.m2.2.2.cmml">Y</mi><mo id="S5.E18.m2.6.6.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S5.E18.m2.6.6.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E18.m2.6.6.1.1.2.2.2.4" xref="S5.E18.m2.6.6.1.1.2.3.cmml">,</mo><mrow id="S5.E18.m2.6.6.1.1.2.2.2.2" xref="S5.E18.m2.6.6.1.1.2.2.2.2.cmml"><mi id="S5.E18.m2.6.6.1.1.2.2.2.2.2" xref="S5.E18.m2.6.6.1.1.2.2.2.2.2.cmml">h</mi><mo id="S5.E18.m2.6.6.1.1.2.2.2.2.1" xref="S5.E18.m2.6.6.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S5.E18.m2.6.6.1.1.2.2.2.2.3.2" xref="S5.E18.m2.6.6.1.1.2.2.2.2.3.1.cmml"><mo id="S5.E18.m2.6.6.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S5.E18.m2.6.6.1.1.2.2.2.2.3.1.cmml">(</mo><mi id="S5.E18.m2.3.3" xref="S5.E18.m2.3.3.cmml">Y</mi><mo id="S5.E18.m2.6.6.1.1.2.2.2.2.3.2.2" xref="S5.E18.m2.6.6.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S5.E18.m2.4.4" xref="S5.E18.m2.4.4.cmml">X</mi><mo id="S5.E18.m2.6.6.1.1.2.2.2.2.3.2.3" stretchy="false" xref="S5.E18.m2.6.6.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E18.m2.6.6.1.1.2.2.2.5" stretchy="false" xref="S5.E18.m2.6.6.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E18.m2.6.6.1.2" xref="S5.E18.m2.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E18.m2.6b"><apply id="S5.E18.m2.6.6.1.1.cmml" xref="S5.E18.m2.6.6.1"><eq id="S5.E18.m2.6.6.1.1.3.cmml" xref="S5.E18.m2.6.6.1.1.3"></eq><csymbol cd="latexml" id="S5.E18.m2.6.6.1.1.4.cmml" xref="S5.E18.m2.6.6.1.1.4">absent</csymbol><apply id="S5.E18.m2.6.6.1.1.2.3.cmml" xref="S5.E18.m2.6.6.1.1.2.2"><max id="S5.E18.m2.5.5.cmml" xref="S5.E18.m2.5.5"></max><apply id="S5.E18.m2.6.6.1.1.1.1.1.1.cmml" xref="S5.E18.m2.6.6.1.1.1.1.1.1"><times id="S5.E18.m2.6.6.1.1.1.1.1.1.1.cmml" xref="S5.E18.m2.6.6.1.1.1.1.1.1.1"></times><ci id="S5.E18.m2.6.6.1.1.1.1.1.1.2.cmml" xref="S5.E18.m2.6.6.1.1.1.1.1.1.2">ℎ</ci><interval closure="open" id="S5.E18.m2.6.6.1.1.1.1.1.1.3.1.cmml" xref="S5.E18.m2.6.6.1.1.1.1.1.1.3.2"><ci id="S5.E18.m2.1.1.cmml" xref="S5.E18.m2.1.1">𝑋</ci><ci id="S5.E18.m2.2.2.cmml" xref="S5.E18.m2.2.2">𝑌</ci></interval></apply><apply id="S5.E18.m2.6.6.1.1.2.2.2.2.cmml" xref="S5.E18.m2.6.6.1.1.2.2.2.2"><times id="S5.E18.m2.6.6.1.1.2.2.2.2.1.cmml" xref="S5.E18.m2.6.6.1.1.2.2.2.2.1"></times><ci id="S5.E18.m2.6.6.1.1.2.2.2.2.2.cmml" xref="S5.E18.m2.6.6.1.1.2.2.2.2.2">ℎ</ci><interval closure="open" id="S5.E18.m2.6.6.1.1.2.2.2.2.3.1.cmml" xref="S5.E18.m2.6.6.1.1.2.2.2.2.3.2"><ci id="S5.E18.m2.3.3.cmml" xref="S5.E18.m2.3.3">𝑌</ci><ci id="S5.E18.m2.4.4.cmml" xref="S5.E18.m2.4.4">𝑋</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E18.m2.6c">\displaystyle=\max(h(X,Y),h(Y,X)),</annotation><annotation encoding="application/x-llamapun" id="S5.E18.m2.6d">= roman_max ( italic_h ( italic_X , italic_Y ) , italic_h ( italic_Y , italic_X ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p7.1">where</p>
</div>
<div class="ltx_para" id="S5.SS2.p8">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx14">
<tbody id="S5.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h(X,Y)=\max_{x\in X}\min_{y\in Y}d(x,y)," class="ltx_Math" display="inline" id="S5.E19.m1.5"><semantics id="S5.E19.m1.5a"><mrow id="S5.E19.m1.5.5.1" xref="S5.E19.m1.5.5.1.1.cmml"><mrow id="S5.E19.m1.5.5.1.1" xref="S5.E19.m1.5.5.1.1.cmml"><mrow id="S5.E19.m1.5.5.1.1.2" xref="S5.E19.m1.5.5.1.1.2.cmml"><mi id="S5.E19.m1.5.5.1.1.2.2" xref="S5.E19.m1.5.5.1.1.2.2.cmml">h</mi><mo id="S5.E19.m1.5.5.1.1.2.1" xref="S5.E19.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S5.E19.m1.5.5.1.1.2.3.2" xref="S5.E19.m1.5.5.1.1.2.3.1.cmml"><mo id="S5.E19.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S5.E19.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S5.E19.m1.1.1" xref="S5.E19.m1.1.1.cmml">X</mi><mo id="S5.E19.m1.5.5.1.1.2.3.2.2" xref="S5.E19.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S5.E19.m1.2.2" xref="S5.E19.m1.2.2.cmml">Y</mi><mo id="S5.E19.m1.5.5.1.1.2.3.2.3" stretchy="false" xref="S5.E19.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E19.m1.5.5.1.1.1" xref="S5.E19.m1.5.5.1.1.1.cmml">=</mo><mrow id="S5.E19.m1.5.5.1.1.3" xref="S5.E19.m1.5.5.1.1.3.cmml"><mrow id="S5.E19.m1.5.5.1.1.3.2" xref="S5.E19.m1.5.5.1.1.3.2.cmml"><munder id="S5.E19.m1.5.5.1.1.3.2.1" xref="S5.E19.m1.5.5.1.1.3.2.1.cmml"><mi id="S5.E19.m1.5.5.1.1.3.2.1.2" xref="S5.E19.m1.5.5.1.1.3.2.1.2.cmml">max</mi><mrow id="S5.E19.m1.5.5.1.1.3.2.1.3" xref="S5.E19.m1.5.5.1.1.3.2.1.3.cmml"><mi id="S5.E19.m1.5.5.1.1.3.2.1.3.2" xref="S5.E19.m1.5.5.1.1.3.2.1.3.2.cmml">x</mi><mo id="S5.E19.m1.5.5.1.1.3.2.1.3.1" xref="S5.E19.m1.5.5.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S5.E19.m1.5.5.1.1.3.2.1.3.3" xref="S5.E19.m1.5.5.1.1.3.2.1.3.3.cmml">X</mi></mrow></munder><mo id="S5.E19.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S5.E19.m1.5.5.1.1.3.2.cmml">⁡</mo><mrow id="S5.E19.m1.5.5.1.1.3.2.2" xref="S5.E19.m1.5.5.1.1.3.2.2.cmml"><munder id="S5.E19.m1.5.5.1.1.3.2.2.1" xref="S5.E19.m1.5.5.1.1.3.2.2.1.cmml"><mi id="S5.E19.m1.5.5.1.1.3.2.2.1.2" xref="S5.E19.m1.5.5.1.1.3.2.2.1.2.cmml">min</mi><mrow id="S5.E19.m1.5.5.1.1.3.2.2.1.3" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.cmml"><mi id="S5.E19.m1.5.5.1.1.3.2.2.1.3.2" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.2.cmml">y</mi><mo id="S5.E19.m1.5.5.1.1.3.2.2.1.3.1" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.1.cmml">∈</mo><mi id="S5.E19.m1.5.5.1.1.3.2.2.1.3.3" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.3.cmml">Y</mi></mrow></munder><mo id="S5.E19.m1.5.5.1.1.3.2.2a" lspace="0.167em" xref="S5.E19.m1.5.5.1.1.3.2.2.cmml">⁡</mo><mi id="S5.E19.m1.5.5.1.1.3.2.2.2" xref="S5.E19.m1.5.5.1.1.3.2.2.2.cmml">d</mi></mrow></mrow><mo id="S5.E19.m1.5.5.1.1.3.1" xref="S5.E19.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S5.E19.m1.5.5.1.1.3.3.2" xref="S5.E19.m1.5.5.1.1.3.3.1.cmml"><mo id="S5.E19.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S5.E19.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S5.E19.m1.3.3" xref="S5.E19.m1.3.3.cmml">x</mi><mo id="S5.E19.m1.5.5.1.1.3.3.2.2" xref="S5.E19.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S5.E19.m1.4.4" xref="S5.E19.m1.4.4.cmml">y</mi><mo id="S5.E19.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S5.E19.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E19.m1.5.5.1.2" xref="S5.E19.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E19.m1.5b"><apply id="S5.E19.m1.5.5.1.1.cmml" xref="S5.E19.m1.5.5.1"><eq id="S5.E19.m1.5.5.1.1.1.cmml" xref="S5.E19.m1.5.5.1.1.1"></eq><apply id="S5.E19.m1.5.5.1.1.2.cmml" xref="S5.E19.m1.5.5.1.1.2"><times id="S5.E19.m1.5.5.1.1.2.1.cmml" xref="S5.E19.m1.5.5.1.1.2.1"></times><ci id="S5.E19.m1.5.5.1.1.2.2.cmml" xref="S5.E19.m1.5.5.1.1.2.2">ℎ</ci><interval closure="open" id="S5.E19.m1.5.5.1.1.2.3.1.cmml" xref="S5.E19.m1.5.5.1.1.2.3.2"><ci id="S5.E19.m1.1.1.cmml" xref="S5.E19.m1.1.1">𝑋</ci><ci id="S5.E19.m1.2.2.cmml" xref="S5.E19.m1.2.2">𝑌</ci></interval></apply><apply id="S5.E19.m1.5.5.1.1.3.cmml" xref="S5.E19.m1.5.5.1.1.3"><times id="S5.E19.m1.5.5.1.1.3.1.cmml" xref="S5.E19.m1.5.5.1.1.3.1"></times><apply id="S5.E19.m1.5.5.1.1.3.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2"><apply id="S5.E19.m1.5.5.1.1.3.2.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S5.E19.m1.5.5.1.1.3.2.1.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1">subscript</csymbol><max id="S5.E19.m1.5.5.1.1.3.2.1.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1.2"></max><apply id="S5.E19.m1.5.5.1.1.3.2.1.3.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1.3"><in id="S5.E19.m1.5.5.1.1.3.2.1.3.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1.3.1"></in><ci id="S5.E19.m1.5.5.1.1.3.2.1.3.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1.3.2">𝑥</ci><ci id="S5.E19.m1.5.5.1.1.3.2.1.3.3.cmml" xref="S5.E19.m1.5.5.1.1.3.2.1.3.3">𝑋</ci></apply></apply><apply id="S5.E19.m1.5.5.1.1.3.2.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2"><apply id="S5.E19.m1.5.5.1.1.3.2.2.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S5.E19.m1.5.5.1.1.3.2.2.1.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1">subscript</csymbol><min id="S5.E19.m1.5.5.1.1.3.2.2.1.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1.2"></min><apply id="S5.E19.m1.5.5.1.1.3.2.2.1.3.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3"><in id="S5.E19.m1.5.5.1.1.3.2.2.1.3.1.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.1"></in><ci id="S5.E19.m1.5.5.1.1.3.2.2.1.3.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.2">𝑦</ci><ci id="S5.E19.m1.5.5.1.1.3.2.2.1.3.3.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.1.3.3">𝑌</ci></apply></apply><ci id="S5.E19.m1.5.5.1.1.3.2.2.2.cmml" xref="S5.E19.m1.5.5.1.1.3.2.2.2">𝑑</ci></apply></apply><interval closure="open" id="S5.E19.m1.5.5.1.1.3.3.1.cmml" xref="S5.E19.m1.5.5.1.1.3.3.2"><ci id="S5.E19.m1.3.3.cmml" xref="S5.E19.m1.3.3">𝑥</ci><ci id="S5.E19.m1.4.4.cmml" xref="S5.E19.m1.4.4">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E19.m1.5c">\displaystyle h(X,Y)=\max_{x\in X}\min_{y\in Y}d(x,y),</annotation><annotation encoding="application/x-llamapun" id="S5.E19.m1.5d">italic_h ( italic_X , italic_Y ) = roman_max start_POSTSUBSCRIPT italic_x ∈ italic_X end_POSTSUBSCRIPT roman_min start_POSTSUBSCRIPT italic_y ∈ italic_Y end_POSTSUBSCRIPT italic_d ( italic_x , italic_y ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p9">
<p class="ltx_p" id="S5.SS2.p9.3">and <math alttext="d(x,y)" class="ltx_Math" display="inline" id="S5.SS2.p9.1.m1.2"><semantics id="S5.SS2.p9.1.m1.2a"><mrow id="S5.SS2.p9.1.m1.2.3" xref="S5.SS2.p9.1.m1.2.3.cmml"><mi id="S5.SS2.p9.1.m1.2.3.2" xref="S5.SS2.p9.1.m1.2.3.2.cmml">d</mi><mo id="S5.SS2.p9.1.m1.2.3.1" xref="S5.SS2.p9.1.m1.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p9.1.m1.2.3.3.2" xref="S5.SS2.p9.1.m1.2.3.3.1.cmml"><mo id="S5.SS2.p9.1.m1.2.3.3.2.1" stretchy="false" xref="S5.SS2.p9.1.m1.2.3.3.1.cmml">(</mo><mi id="S5.SS2.p9.1.m1.1.1" xref="S5.SS2.p9.1.m1.1.1.cmml">x</mi><mo id="S5.SS2.p9.1.m1.2.3.3.2.2" xref="S5.SS2.p9.1.m1.2.3.3.1.cmml">,</mo><mi id="S5.SS2.p9.1.m1.2.2" xref="S5.SS2.p9.1.m1.2.2.cmml">y</mi><mo id="S5.SS2.p9.1.m1.2.3.3.2.3" stretchy="false" xref="S5.SS2.p9.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p9.1.m1.2b"><apply id="S5.SS2.p9.1.m1.2.3.cmml" xref="S5.SS2.p9.1.m1.2.3"><times id="S5.SS2.p9.1.m1.2.3.1.cmml" xref="S5.SS2.p9.1.m1.2.3.1"></times><ci id="S5.SS2.p9.1.m1.2.3.2.cmml" xref="S5.SS2.p9.1.m1.2.3.2">𝑑</ci><interval closure="open" id="S5.SS2.p9.1.m1.2.3.3.1.cmml" xref="S5.SS2.p9.1.m1.2.3.3.2"><ci id="S5.SS2.p9.1.m1.1.1.cmml" xref="S5.SS2.p9.1.m1.1.1">𝑥</ci><ci id="S5.SS2.p9.1.m1.2.2.cmml" xref="S5.SS2.p9.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p9.1.m1.2c">d(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p9.1.m1.2d">italic_d ( italic_x , italic_y )</annotation></semantics></math> denotes the Euclidean distance between points <math alttext="x\in X" class="ltx_Math" display="inline" id="S5.SS2.p9.2.m2.1"><semantics id="S5.SS2.p9.2.m2.1a"><mrow id="S5.SS2.p9.2.m2.1.1" xref="S5.SS2.p9.2.m2.1.1.cmml"><mi id="S5.SS2.p9.2.m2.1.1.2" xref="S5.SS2.p9.2.m2.1.1.2.cmml">x</mi><mo id="S5.SS2.p9.2.m2.1.1.1" xref="S5.SS2.p9.2.m2.1.1.1.cmml">∈</mo><mi id="S5.SS2.p9.2.m2.1.1.3" xref="S5.SS2.p9.2.m2.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p9.2.m2.1b"><apply id="S5.SS2.p9.2.m2.1.1.cmml" xref="S5.SS2.p9.2.m2.1.1"><in id="S5.SS2.p9.2.m2.1.1.1.cmml" xref="S5.SS2.p9.2.m2.1.1.1"></in><ci id="S5.SS2.p9.2.m2.1.1.2.cmml" xref="S5.SS2.p9.2.m2.1.1.2">𝑥</ci><ci id="S5.SS2.p9.2.m2.1.1.3.cmml" xref="S5.SS2.p9.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p9.2.m2.1c">x\in X</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p9.2.m2.1d">italic_x ∈ italic_X</annotation></semantics></math> and <math alttext="y\in Y" class="ltx_Math" display="inline" id="S5.SS2.p9.3.m3.1"><semantics id="S5.SS2.p9.3.m3.1a"><mrow id="S5.SS2.p9.3.m3.1.1" xref="S5.SS2.p9.3.m3.1.1.cmml"><mi id="S5.SS2.p9.3.m3.1.1.2" xref="S5.SS2.p9.3.m3.1.1.2.cmml">y</mi><mo id="S5.SS2.p9.3.m3.1.1.1" xref="S5.SS2.p9.3.m3.1.1.1.cmml">∈</mo><mi id="S5.SS2.p9.3.m3.1.1.3" xref="S5.SS2.p9.3.m3.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p9.3.m3.1b"><apply id="S5.SS2.p9.3.m3.1.1.cmml" xref="S5.SS2.p9.3.m3.1.1"><in id="S5.SS2.p9.3.m3.1.1.1.cmml" xref="S5.SS2.p9.3.m3.1.1.1"></in><ci id="S5.SS2.p9.3.m3.1.1.2.cmml" xref="S5.SS2.p9.3.m3.1.1.2">𝑦</ci><ci id="S5.SS2.p9.3.m3.1.1.3.cmml" xref="S5.SS2.p9.3.m3.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p9.3.m3.1c">y\in Y</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p9.3.m3.1d">italic_y ∈ italic_Y</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p10">
<p class="ltx_p" id="S5.SS2.p10.1">The HD95 is defined as the 95th percentile of the sorted set of all distances between the predicted and ground truth boundaries:</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p11">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx15">
<tbody id="S5.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{HD95}(X,Y)=\text{Percentile}_{95}\left(\{d(x,Y):x\in X\}%
\cup\{d(y,X):y\in Y\}\right)," class="ltx_Math" display="inline" id="S5.E20.m1.7"><semantics id="S5.E20.m1.7a"><mrow id="S5.E20.m1.7.7.1" xref="S5.E20.m1.7.7.1.1.cmml"><mrow id="S5.E20.m1.7.7.1.1" xref="S5.E20.m1.7.7.1.1.cmml"><mrow id="S5.E20.m1.7.7.1.1.3" xref="S5.E20.m1.7.7.1.1.3.cmml"><mtext id="S5.E20.m1.7.7.1.1.3.2" xref="S5.E20.m1.7.7.1.1.3.2a.cmml">HD95</mtext><mo id="S5.E20.m1.7.7.1.1.3.1" xref="S5.E20.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S5.E20.m1.7.7.1.1.3.3.2" xref="S5.E20.m1.7.7.1.1.3.3.1.cmml"><mo id="S5.E20.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="S5.E20.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="S5.E20.m1.1.1" xref="S5.E20.m1.1.1.cmml">X</mi><mo id="S5.E20.m1.7.7.1.1.3.3.2.2" xref="S5.E20.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S5.E20.m1.2.2" xref="S5.E20.m1.2.2.cmml">Y</mi><mo id="S5.E20.m1.7.7.1.1.3.3.2.3" stretchy="false" xref="S5.E20.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E20.m1.7.7.1.1.2" xref="S5.E20.m1.7.7.1.1.2.cmml">=</mo><mrow id="S5.E20.m1.7.7.1.1.1" xref="S5.E20.m1.7.7.1.1.1.cmml"><msub id="S5.E20.m1.7.7.1.1.1.3" xref="S5.E20.m1.7.7.1.1.1.3.cmml"><mtext id="S5.E20.m1.7.7.1.1.1.3.2" xref="S5.E20.m1.7.7.1.1.1.3.2a.cmml">Percentile</mtext><mn id="S5.E20.m1.7.7.1.1.1.3.3" xref="S5.E20.m1.7.7.1.1.1.3.3.cmml">95</mn></msub><mo id="S5.E20.m1.7.7.1.1.1.2" xref="S5.E20.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S5.E20.m1.7.7.1.1.1.1.1.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.cmml"><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.1.cmml">{</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S5.E20.m1.3.3" xref="S5.E20.m1.3.3.cmml">x</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S5.E20.m1.4.4" xref="S5.E20.m1.4.4.cmml">Y</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.3" rspace="0.278em" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.4" rspace="0.278em" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.cmml"><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml">∈</mo><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.3" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml">X</mi></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.1.cmml">}</mo></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.5" xref="S5.E20.m1.7.7.1.1.1.1.1.1.5.cmml">∪</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.cmml"><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.3" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">{</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.cmml"><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.2.cmml">d</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.1.cmml">⁢</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.1.cmml"><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.2.1" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.1.cmml">(</mo><mi id="S5.E20.m1.5.5" xref="S5.E20.m1.5.5.cmml">y</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.1.cmml">,</mo><mi id="S5.E20.m1.6.6" xref="S5.E20.m1.6.6.cmml">X</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.2.3" rspace="0.278em" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.4" rspace="0.278em" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">:</mo><mrow id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.cmml"><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.2" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.2.cmml">y</mi><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.1" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.1.cmml">∈</mo><mi id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.3" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.3.cmml">Y</mi></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.5" stretchy="false" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">}</mo></mrow></mrow><mo id="S5.E20.m1.7.7.1.1.1.1.1.3" xref="S5.E20.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E20.m1.7.7.1.2" xref="S5.E20.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E20.m1.7b"><apply id="S5.E20.m1.7.7.1.1.cmml" xref="S5.E20.m1.7.7.1"><eq id="S5.E20.m1.7.7.1.1.2.cmml" xref="S5.E20.m1.7.7.1.1.2"></eq><apply id="S5.E20.m1.7.7.1.1.3.cmml" xref="S5.E20.m1.7.7.1.1.3"><times id="S5.E20.m1.7.7.1.1.3.1.cmml" xref="S5.E20.m1.7.7.1.1.3.1"></times><ci id="S5.E20.m1.7.7.1.1.3.2a.cmml" xref="S5.E20.m1.7.7.1.1.3.2"><mtext id="S5.E20.m1.7.7.1.1.3.2.cmml" xref="S5.E20.m1.7.7.1.1.3.2">HD95</mtext></ci><interval closure="open" id="S5.E20.m1.7.7.1.1.3.3.1.cmml" xref="S5.E20.m1.7.7.1.1.3.3.2"><ci id="S5.E20.m1.1.1.cmml" xref="S5.E20.m1.1.1">𝑋</ci><ci id="S5.E20.m1.2.2.cmml" xref="S5.E20.m1.2.2">𝑌</ci></interval></apply><apply id="S5.E20.m1.7.7.1.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1"><times id="S5.E20.m1.7.7.1.1.1.2.cmml" xref="S5.E20.m1.7.7.1.1.1.2"></times><apply id="S5.E20.m1.7.7.1.1.1.3.cmml" xref="S5.E20.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S5.E20.m1.7.7.1.1.1.3.1.cmml" xref="S5.E20.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S5.E20.m1.7.7.1.1.1.3.2a.cmml" xref="S5.E20.m1.7.7.1.1.1.3.2"><mtext id="S5.E20.m1.7.7.1.1.1.3.2.cmml" xref="S5.E20.m1.7.7.1.1.1.3.2">Percentile</mtext></ci><cn id="S5.E20.m1.7.7.1.1.1.3.3.cmml" type="integer" xref="S5.E20.m1.7.7.1.1.1.3.3">95</cn></apply><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1"><union id="S5.E20.m1.7.7.1.1.1.1.1.1.5.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.5"></union><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="S5.E20.m1.7.7.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.3">conditional-set</csymbol><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1"><times id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.1"></times><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝑑</ci><interval closure="open" id="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.1.1.1.3.2"><ci id="S5.E20.m1.3.3.cmml" xref="S5.E20.m1.3.3">𝑥</ci><ci id="S5.E20.m1.4.4.cmml" xref="S5.E20.m1.4.4">𝑌</ci></interval></apply><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2"><in id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.1"></in><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.2.2.2.3">𝑋</ci></apply></apply><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S5.E20.m1.7.7.1.1.1.1.1.1.4.3.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.3">conditional-set</csymbol><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1"><times id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.1"></times><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.2">𝑑</ci><interval closure="open" id="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.3.1.1.3.2"><ci id="S5.E20.m1.5.5.cmml" xref="S5.E20.m1.5.5">𝑦</ci><ci id="S5.E20.m1.6.6.cmml" xref="S5.E20.m1.6.6">𝑋</ci></interval></apply><apply id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2"><in id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.1.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.1"></in><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.2.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.2">𝑦</ci><ci id="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.3.cmml" xref="S5.E20.m1.7.7.1.1.1.1.1.1.4.2.2.3">𝑌</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E20.m1.7c">\displaystyle\text{HD95}(X,Y)=\text{Percentile}_{95}\left(\{d(x,Y):x\in X\}%
\cup\{d(y,X):y\in Y\}\right),</annotation><annotation encoding="application/x-llamapun" id="S5.E20.m1.7d">HD95 ( italic_X , italic_Y ) = Percentile start_POSTSUBSCRIPT 95 end_POSTSUBSCRIPT ( { italic_d ( italic_x , italic_Y ) : italic_x ∈ italic_X } ∪ { italic_d ( italic_y , italic_X ) : italic_y ∈ italic_Y } ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p11.2">where <math alttext="d(x,Y)=\min_{y\in Y}d(x,y)" class="ltx_Math" display="inline" id="S5.SS2.p11.1.m1.4"><semantics id="S5.SS2.p11.1.m1.4a"><mrow id="S5.SS2.p11.1.m1.4.5" xref="S5.SS2.p11.1.m1.4.5.cmml"><mrow id="S5.SS2.p11.1.m1.4.5.2" xref="S5.SS2.p11.1.m1.4.5.2.cmml"><mi id="S5.SS2.p11.1.m1.4.5.2.2" xref="S5.SS2.p11.1.m1.4.5.2.2.cmml">d</mi><mo id="S5.SS2.p11.1.m1.4.5.2.1" xref="S5.SS2.p11.1.m1.4.5.2.1.cmml">⁢</mo><mrow id="S5.SS2.p11.1.m1.4.5.2.3.2" xref="S5.SS2.p11.1.m1.4.5.2.3.1.cmml"><mo id="S5.SS2.p11.1.m1.4.5.2.3.2.1" stretchy="false" xref="S5.SS2.p11.1.m1.4.5.2.3.1.cmml">(</mo><mi id="S5.SS2.p11.1.m1.1.1" xref="S5.SS2.p11.1.m1.1.1.cmml">x</mi><mo id="S5.SS2.p11.1.m1.4.5.2.3.2.2" xref="S5.SS2.p11.1.m1.4.5.2.3.1.cmml">,</mo><mi id="S5.SS2.p11.1.m1.2.2" xref="S5.SS2.p11.1.m1.2.2.cmml">Y</mi><mo id="S5.SS2.p11.1.m1.4.5.2.3.2.3" stretchy="false" xref="S5.SS2.p11.1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p11.1.m1.4.5.1" xref="S5.SS2.p11.1.m1.4.5.1.cmml">=</mo><mrow id="S5.SS2.p11.1.m1.4.5.3" xref="S5.SS2.p11.1.m1.4.5.3.cmml"><mrow id="S5.SS2.p11.1.m1.4.5.3.2" xref="S5.SS2.p11.1.m1.4.5.3.2.cmml"><msub id="S5.SS2.p11.1.m1.4.5.3.2.1" xref="S5.SS2.p11.1.m1.4.5.3.2.1.cmml"><mi id="S5.SS2.p11.1.m1.4.5.3.2.1.2" xref="S5.SS2.p11.1.m1.4.5.3.2.1.2.cmml">min</mi><mrow id="S5.SS2.p11.1.m1.4.5.3.2.1.3" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.cmml"><mi id="S5.SS2.p11.1.m1.4.5.3.2.1.3.2" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.2.cmml">y</mi><mo id="S5.SS2.p11.1.m1.4.5.3.2.1.3.1" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.1.cmml">∈</mo><mi id="S5.SS2.p11.1.m1.4.5.3.2.1.3.3" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.3.cmml">Y</mi></mrow></msub><mo id="S5.SS2.p11.1.m1.4.5.3.2a" lspace="0.167em" xref="S5.SS2.p11.1.m1.4.5.3.2.cmml">⁡</mo><mi id="S5.SS2.p11.1.m1.4.5.3.2.2" xref="S5.SS2.p11.1.m1.4.5.3.2.2.cmml">d</mi></mrow><mo id="S5.SS2.p11.1.m1.4.5.3.1" xref="S5.SS2.p11.1.m1.4.5.3.1.cmml">⁢</mo><mrow id="S5.SS2.p11.1.m1.4.5.3.3.2" xref="S5.SS2.p11.1.m1.4.5.3.3.1.cmml"><mo id="S5.SS2.p11.1.m1.4.5.3.3.2.1" stretchy="false" xref="S5.SS2.p11.1.m1.4.5.3.3.1.cmml">(</mo><mi id="S5.SS2.p11.1.m1.3.3" xref="S5.SS2.p11.1.m1.3.3.cmml">x</mi><mo id="S5.SS2.p11.1.m1.4.5.3.3.2.2" xref="S5.SS2.p11.1.m1.4.5.3.3.1.cmml">,</mo><mi id="S5.SS2.p11.1.m1.4.4" xref="S5.SS2.p11.1.m1.4.4.cmml">y</mi><mo id="S5.SS2.p11.1.m1.4.5.3.3.2.3" stretchy="false" xref="S5.SS2.p11.1.m1.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p11.1.m1.4b"><apply id="S5.SS2.p11.1.m1.4.5.cmml" xref="S5.SS2.p11.1.m1.4.5"><eq id="S5.SS2.p11.1.m1.4.5.1.cmml" xref="S5.SS2.p11.1.m1.4.5.1"></eq><apply id="S5.SS2.p11.1.m1.4.5.2.cmml" xref="S5.SS2.p11.1.m1.4.5.2"><times id="S5.SS2.p11.1.m1.4.5.2.1.cmml" xref="S5.SS2.p11.1.m1.4.5.2.1"></times><ci id="S5.SS2.p11.1.m1.4.5.2.2.cmml" xref="S5.SS2.p11.1.m1.4.5.2.2">𝑑</ci><interval closure="open" id="S5.SS2.p11.1.m1.4.5.2.3.1.cmml" xref="S5.SS2.p11.1.m1.4.5.2.3.2"><ci id="S5.SS2.p11.1.m1.1.1.cmml" xref="S5.SS2.p11.1.m1.1.1">𝑥</ci><ci id="S5.SS2.p11.1.m1.2.2.cmml" xref="S5.SS2.p11.1.m1.2.2">𝑌</ci></interval></apply><apply id="S5.SS2.p11.1.m1.4.5.3.cmml" xref="S5.SS2.p11.1.m1.4.5.3"><times id="S5.SS2.p11.1.m1.4.5.3.1.cmml" xref="S5.SS2.p11.1.m1.4.5.3.1"></times><apply id="S5.SS2.p11.1.m1.4.5.3.2.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2"><apply id="S5.SS2.p11.1.m1.4.5.3.2.1.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="S5.SS2.p11.1.m1.4.5.3.2.1.1.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1">subscript</csymbol><min id="S5.SS2.p11.1.m1.4.5.3.2.1.2.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1.2"></min><apply id="S5.SS2.p11.1.m1.4.5.3.2.1.3.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3"><in id="S5.SS2.p11.1.m1.4.5.3.2.1.3.1.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.1"></in><ci id="S5.SS2.p11.1.m1.4.5.3.2.1.3.2.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.2">𝑦</ci><ci id="S5.SS2.p11.1.m1.4.5.3.2.1.3.3.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.1.3.3">𝑌</ci></apply></apply><ci id="S5.SS2.p11.1.m1.4.5.3.2.2.cmml" xref="S5.SS2.p11.1.m1.4.5.3.2.2">𝑑</ci></apply><interval closure="open" id="S5.SS2.p11.1.m1.4.5.3.3.1.cmml" xref="S5.SS2.p11.1.m1.4.5.3.3.2"><ci id="S5.SS2.p11.1.m1.3.3.cmml" xref="S5.SS2.p11.1.m1.3.3">𝑥</ci><ci id="S5.SS2.p11.1.m1.4.4.cmml" xref="S5.SS2.p11.1.m1.4.4">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p11.1.m1.4c">d(x,Y)=\min_{y\in Y}d(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p11.1.m1.4d">italic_d ( italic_x , italic_Y ) = roman_min start_POSTSUBSCRIPT italic_y ∈ italic_Y end_POSTSUBSCRIPT italic_d ( italic_x , italic_y )</annotation></semantics></math> and <math alttext="d(y,X)=\min_{x\in X}d(y,x)" class="ltx_Math" display="inline" id="S5.SS2.p11.2.m2.4"><semantics id="S5.SS2.p11.2.m2.4a"><mrow id="S5.SS2.p11.2.m2.4.5" xref="S5.SS2.p11.2.m2.4.5.cmml"><mrow id="S5.SS2.p11.2.m2.4.5.2" xref="S5.SS2.p11.2.m2.4.5.2.cmml"><mi id="S5.SS2.p11.2.m2.4.5.2.2" xref="S5.SS2.p11.2.m2.4.5.2.2.cmml">d</mi><mo id="S5.SS2.p11.2.m2.4.5.2.1" xref="S5.SS2.p11.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="S5.SS2.p11.2.m2.4.5.2.3.2" xref="S5.SS2.p11.2.m2.4.5.2.3.1.cmml"><mo id="S5.SS2.p11.2.m2.4.5.2.3.2.1" stretchy="false" xref="S5.SS2.p11.2.m2.4.5.2.3.1.cmml">(</mo><mi id="S5.SS2.p11.2.m2.1.1" xref="S5.SS2.p11.2.m2.1.1.cmml">y</mi><mo id="S5.SS2.p11.2.m2.4.5.2.3.2.2" xref="S5.SS2.p11.2.m2.4.5.2.3.1.cmml">,</mo><mi id="S5.SS2.p11.2.m2.2.2" xref="S5.SS2.p11.2.m2.2.2.cmml">X</mi><mo id="S5.SS2.p11.2.m2.4.5.2.3.2.3" stretchy="false" xref="S5.SS2.p11.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.SS2.p11.2.m2.4.5.1" xref="S5.SS2.p11.2.m2.4.5.1.cmml">=</mo><mrow id="S5.SS2.p11.2.m2.4.5.3" xref="S5.SS2.p11.2.m2.4.5.3.cmml"><mrow id="S5.SS2.p11.2.m2.4.5.3.2" xref="S5.SS2.p11.2.m2.4.5.3.2.cmml"><msub id="S5.SS2.p11.2.m2.4.5.3.2.1" xref="S5.SS2.p11.2.m2.4.5.3.2.1.cmml"><mi id="S5.SS2.p11.2.m2.4.5.3.2.1.2" xref="S5.SS2.p11.2.m2.4.5.3.2.1.2.cmml">min</mi><mrow id="S5.SS2.p11.2.m2.4.5.3.2.1.3" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.cmml"><mi id="S5.SS2.p11.2.m2.4.5.3.2.1.3.2" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.2.cmml">x</mi><mo id="S5.SS2.p11.2.m2.4.5.3.2.1.3.1" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.1.cmml">∈</mo><mi id="S5.SS2.p11.2.m2.4.5.3.2.1.3.3" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.3.cmml">X</mi></mrow></msub><mo id="S5.SS2.p11.2.m2.4.5.3.2a" lspace="0.167em" xref="S5.SS2.p11.2.m2.4.5.3.2.cmml">⁡</mo><mi id="S5.SS2.p11.2.m2.4.5.3.2.2" xref="S5.SS2.p11.2.m2.4.5.3.2.2.cmml">d</mi></mrow><mo id="S5.SS2.p11.2.m2.4.5.3.1" xref="S5.SS2.p11.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S5.SS2.p11.2.m2.4.5.3.3.2" xref="S5.SS2.p11.2.m2.4.5.3.3.1.cmml"><mo id="S5.SS2.p11.2.m2.4.5.3.3.2.1" stretchy="false" xref="S5.SS2.p11.2.m2.4.5.3.3.1.cmml">(</mo><mi id="S5.SS2.p11.2.m2.3.3" xref="S5.SS2.p11.2.m2.3.3.cmml">y</mi><mo id="S5.SS2.p11.2.m2.4.5.3.3.2.2" xref="S5.SS2.p11.2.m2.4.5.3.3.1.cmml">,</mo><mi id="S5.SS2.p11.2.m2.4.4" xref="S5.SS2.p11.2.m2.4.4.cmml">x</mi><mo id="S5.SS2.p11.2.m2.4.5.3.3.2.3" stretchy="false" xref="S5.SS2.p11.2.m2.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p11.2.m2.4b"><apply id="S5.SS2.p11.2.m2.4.5.cmml" xref="S5.SS2.p11.2.m2.4.5"><eq id="S5.SS2.p11.2.m2.4.5.1.cmml" xref="S5.SS2.p11.2.m2.4.5.1"></eq><apply id="S5.SS2.p11.2.m2.4.5.2.cmml" xref="S5.SS2.p11.2.m2.4.5.2"><times id="S5.SS2.p11.2.m2.4.5.2.1.cmml" xref="S5.SS2.p11.2.m2.4.5.2.1"></times><ci id="S5.SS2.p11.2.m2.4.5.2.2.cmml" xref="S5.SS2.p11.2.m2.4.5.2.2">𝑑</ci><interval closure="open" id="S5.SS2.p11.2.m2.4.5.2.3.1.cmml" xref="S5.SS2.p11.2.m2.4.5.2.3.2"><ci id="S5.SS2.p11.2.m2.1.1.cmml" xref="S5.SS2.p11.2.m2.1.1">𝑦</ci><ci id="S5.SS2.p11.2.m2.2.2.cmml" xref="S5.SS2.p11.2.m2.2.2">𝑋</ci></interval></apply><apply id="S5.SS2.p11.2.m2.4.5.3.cmml" xref="S5.SS2.p11.2.m2.4.5.3"><times id="S5.SS2.p11.2.m2.4.5.3.1.cmml" xref="S5.SS2.p11.2.m2.4.5.3.1"></times><apply id="S5.SS2.p11.2.m2.4.5.3.2.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2"><apply id="S5.SS2.p11.2.m2.4.5.3.2.1.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1"><csymbol cd="ambiguous" id="S5.SS2.p11.2.m2.4.5.3.2.1.1.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1">subscript</csymbol><min id="S5.SS2.p11.2.m2.4.5.3.2.1.2.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1.2"></min><apply id="S5.SS2.p11.2.m2.4.5.3.2.1.3.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3"><in id="S5.SS2.p11.2.m2.4.5.3.2.1.3.1.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.1"></in><ci id="S5.SS2.p11.2.m2.4.5.3.2.1.3.2.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.2">𝑥</ci><ci id="S5.SS2.p11.2.m2.4.5.3.2.1.3.3.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.1.3.3">𝑋</ci></apply></apply><ci id="S5.SS2.p11.2.m2.4.5.3.2.2.cmml" xref="S5.SS2.p11.2.m2.4.5.3.2.2">𝑑</ci></apply><interval closure="open" id="S5.SS2.p11.2.m2.4.5.3.3.1.cmml" xref="S5.SS2.p11.2.m2.4.5.3.3.2"><ci id="S5.SS2.p11.2.m2.3.3.cmml" xref="S5.SS2.p11.2.m2.3.3">𝑦</ci><ci id="S5.SS2.p11.2.m2.4.4.cmml" xref="S5.SS2.p11.2.m2.4.4">𝑥</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p11.2.m2.4c">d(y,X)=\min_{x\in X}d(y,x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p11.2.m2.4d">italic_d ( italic_y , italic_X ) = roman_min start_POSTSUBSCRIPT italic_x ∈ italic_X end_POSTSUBSCRIPT italic_d ( italic_y , italic_x )</annotation></semantics></math>. The HD95 metric reduces the influence of outliers by focusing on the 95th percentile distance, providing a robust measure of boundary alignment between the predicted and ground truth segmentations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p12">
<p class="ltx_p" id="S5.SS2.p12.3">The model evaluation should not only use the statistic metrics but also need a qualitative evaluation from the actual segmentation view. The intersection over union (IoU) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib57" title="">57</a>]</cite> as an important evaluation index in semantic segmentation measures the overlap of the ground truth and prediction region. It is also calculated:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{IoU}=\frac{\text{Ground Truth}\bigcap\text{Prediction}}{\text{Ground %
Truth}\bigcup\text{Prediction}}," class="ltx_Math" display="block" id="S5.E21.m1.1"><semantics id="S5.E21.m1.1a"><mrow id="S5.E21.m1.1.1.1" xref="S5.E21.m1.1.1.1.1.cmml"><mrow id="S5.E21.m1.1.1.1.1" xref="S5.E21.m1.1.1.1.1.cmml"><mtext id="S5.E21.m1.1.1.1.1.2" xref="S5.E21.m1.1.1.1.1.2a.cmml">IoU</mtext><mo id="S5.E21.m1.1.1.1.1.1" xref="S5.E21.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S5.E21.m1.1.1.1.1.3" xref="S5.E21.m1.1.1.1.1.3.cmml"><mrow id="S5.E21.m1.1.1.1.1.3.2" xref="S5.E21.m1.1.1.1.1.3.2.cmml"><mtext id="S5.E21.m1.1.1.1.1.3.2.2" xref="S5.E21.m1.1.1.1.1.3.2.2a.cmml">Ground Truth</mtext><mo id="S5.E21.m1.1.1.1.1.3.2.1" xref="S5.E21.m1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S5.E21.m1.1.1.1.1.3.2.3" xref="S5.E21.m1.1.1.1.1.3.2.3.cmml"><mo id="S5.E21.m1.1.1.1.1.3.2.3.1" xref="S5.E21.m1.1.1.1.1.3.2.3.1.cmml">⋂</mo><mtext id="S5.E21.m1.1.1.1.1.3.2.3.2" xref="S5.E21.m1.1.1.1.1.3.2.3.2a.cmml">Prediction</mtext></mrow></mrow><mrow id="S5.E21.m1.1.1.1.1.3.3" xref="S5.E21.m1.1.1.1.1.3.3.cmml"><mtext id="S5.E21.m1.1.1.1.1.3.3.2" xref="S5.E21.m1.1.1.1.1.3.3.2a.cmml">Ground Truth</mtext><mo id="S5.E21.m1.1.1.1.1.3.3.1" xref="S5.E21.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S5.E21.m1.1.1.1.1.3.3.3" xref="S5.E21.m1.1.1.1.1.3.3.3.cmml"><mo id="S5.E21.m1.1.1.1.1.3.3.3.1" xref="S5.E21.m1.1.1.1.1.3.3.3.1.cmml">⋃</mo><mtext id="S5.E21.m1.1.1.1.1.3.3.3.2" xref="S5.E21.m1.1.1.1.1.3.3.3.2a.cmml">Prediction</mtext></mrow></mrow></mfrac></mrow><mo id="S5.E21.m1.1.1.1.2" xref="S5.E21.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E21.m1.1b"><apply id="S5.E21.m1.1.1.1.1.cmml" xref="S5.E21.m1.1.1.1"><eq id="S5.E21.m1.1.1.1.1.1.cmml" xref="S5.E21.m1.1.1.1.1.1"></eq><ci id="S5.E21.m1.1.1.1.1.2a.cmml" xref="S5.E21.m1.1.1.1.1.2"><mtext id="S5.E21.m1.1.1.1.1.2.cmml" xref="S5.E21.m1.1.1.1.1.2">IoU</mtext></ci><apply id="S5.E21.m1.1.1.1.1.3.cmml" xref="S5.E21.m1.1.1.1.1.3"><divide id="S5.E21.m1.1.1.1.1.3.1.cmml" xref="S5.E21.m1.1.1.1.1.3"></divide><apply id="S5.E21.m1.1.1.1.1.3.2.cmml" xref="S5.E21.m1.1.1.1.1.3.2"><times id="S5.E21.m1.1.1.1.1.3.2.1.cmml" xref="S5.E21.m1.1.1.1.1.3.2.1"></times><ci id="S5.E21.m1.1.1.1.1.3.2.2a.cmml" xref="S5.E21.m1.1.1.1.1.3.2.2"><mtext id="S5.E21.m1.1.1.1.1.3.2.2.cmml" xref="S5.E21.m1.1.1.1.1.3.2.2">Ground Truth</mtext></ci><apply id="S5.E21.m1.1.1.1.1.3.2.3.cmml" xref="S5.E21.m1.1.1.1.1.3.2.3"><intersect id="S5.E21.m1.1.1.1.1.3.2.3.1.cmml" xref="S5.E21.m1.1.1.1.1.3.2.3.1"></intersect><ci id="S5.E21.m1.1.1.1.1.3.2.3.2a.cmml" xref="S5.E21.m1.1.1.1.1.3.2.3.2"><mtext id="S5.E21.m1.1.1.1.1.3.2.3.2.cmml" xref="S5.E21.m1.1.1.1.1.3.2.3.2">Prediction</mtext></ci></apply></apply><apply id="S5.E21.m1.1.1.1.1.3.3.cmml" xref="S5.E21.m1.1.1.1.1.3.3"><times id="S5.E21.m1.1.1.1.1.3.3.1.cmml" xref="S5.E21.m1.1.1.1.1.3.3.1"></times><ci id="S5.E21.m1.1.1.1.1.3.3.2a.cmml" xref="S5.E21.m1.1.1.1.1.3.3.2"><mtext id="S5.E21.m1.1.1.1.1.3.3.2.cmml" xref="S5.E21.m1.1.1.1.1.3.3.2">Ground Truth</mtext></ci><apply id="S5.E21.m1.1.1.1.1.3.3.3.cmml" xref="S5.E21.m1.1.1.1.1.3.3.3"><union id="S5.E21.m1.1.1.1.1.3.3.3.1.cmml" xref="S5.E21.m1.1.1.1.1.3.3.3.1"></union><ci id="S5.E21.m1.1.1.1.1.3.3.3.2a.cmml" xref="S5.E21.m1.1.1.1.1.3.3.3.2"><mtext id="S5.E21.m1.1.1.1.1.3.3.3.2.cmml" xref="S5.E21.m1.1.1.1.1.3.3.3.2">Prediction</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E21.m1.1c">\text{IoU}=\frac{\text{Ground Truth}\bigcap\text{Prediction}}{\text{Ground %
Truth}\bigcup\text{Prediction}},</annotation><annotation encoding="application/x-llamapun" id="S5.E21.m1.1d">IoU = divide start_ARG Ground Truth ⋂ Prediction end_ARG start_ARG Ground Truth ⋃ Prediction end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p12.2">where <math alttext="\bigcap" class="ltx_Math" display="inline" id="S5.SS2.p12.1.m1.1"><semantics id="S5.SS2.p12.1.m1.1a"><mo id="S5.SS2.p12.1.m1.1.1" xref="S5.SS2.p12.1.m1.1.1.cmml">⋂</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p12.1.m1.1b"><intersect id="S5.SS2.p12.1.m1.1.1.cmml" xref="S5.SS2.p12.1.m1.1.1"></intersect></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p12.1.m1.1c">\bigcap</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p12.1.m1.1d">⋂</annotation></semantics></math> denotes the intersection operator and <math alttext="\bigcup" class="ltx_Math" display="inline" id="S5.SS2.p12.2.m2.1"><semantics id="S5.SS2.p12.2.m2.1a"><mo id="S5.SS2.p12.2.m2.1.1" xref="S5.SS2.p12.2.m2.1.1.cmml">⋃</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p12.2.m2.1b"><union id="S5.SS2.p12.2.m2.1.1.cmml" xref="S5.SS2.p12.2.m2.1.1"></union></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p12.2.m2.1c">\bigcup</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p12.2.m2.1d">⋃</annotation></semantics></math> represents the union operator. The IoU is generally calculated based on categories, which is to accumulate the IoU value of each category. The IoU value is to average the sum IoU results of each category to obtain a global evaluation. Therefore, the IoU is actually the mean value, that is, the average crossover ratio (mean IoU).</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p13">
<p class="ltx_p" id="S5.SS2.p13.4">Finally, the mean Average Precision (mAP) is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx16">
<tbody id="S5.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S5.E22.2.1.1.1">mAP</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{AP}_{i}," class="ltx_Math" display="inline" id="S5.E22.m2.1"><semantics id="S5.E22.m2.1a"><mrow id="S5.E22.m2.1.1.1" xref="S5.E22.m2.1.1.1.1.cmml"><mrow id="S5.E22.m2.1.1.1.1" xref="S5.E22.m2.1.1.1.1.cmml"><mi id="S5.E22.m2.1.1.1.1.2" xref="S5.E22.m2.1.1.1.1.2.cmml"></mi><mo id="S5.E22.m2.1.1.1.1.1" xref="S5.E22.m2.1.1.1.1.1.cmml">=</mo><mrow id="S5.E22.m2.1.1.1.1.3" xref="S5.E22.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S5.E22.m2.1.1.1.1.3.2" xref="S5.E22.m2.1.1.1.1.3.2.cmml"><mfrac id="S5.E22.m2.1.1.1.1.3.2a" xref="S5.E22.m2.1.1.1.1.3.2.cmml"><mn id="S5.E22.m2.1.1.1.1.3.2.2" xref="S5.E22.m2.1.1.1.1.3.2.2.cmml">1</mn><mi id="S5.E22.m2.1.1.1.1.3.2.3" xref="S5.E22.m2.1.1.1.1.3.2.3.cmml">N</mi></mfrac></mstyle><mo id="S5.E22.m2.1.1.1.1.3.1" xref="S5.E22.m2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S5.E22.m2.1.1.1.1.3.3" xref="S5.E22.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S5.E22.m2.1.1.1.1.3.3.1" xref="S5.E22.m2.1.1.1.1.3.3.1.cmml"><munderover id="S5.E22.m2.1.1.1.1.3.3.1a" xref="S5.E22.m2.1.1.1.1.3.3.1.cmml"><mo id="S5.E22.m2.1.1.1.1.3.3.1.2.2" movablelimits="false" xref="S5.E22.m2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.E22.m2.1.1.1.1.3.3.1.2.3" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S5.E22.m2.1.1.1.1.3.3.1.2.3.2" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S5.E22.m2.1.1.1.1.3.3.1.2.3.1" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S5.E22.m2.1.1.1.1.3.3.1.2.3.3" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.E22.m2.1.1.1.1.3.3.1.3" xref="S5.E22.m2.1.1.1.1.3.3.1.3.cmml">N</mi></munderover></mstyle><msub id="S5.E22.m2.1.1.1.1.3.3.2" xref="S5.E22.m2.1.1.1.1.3.3.2.cmml"><mtext id="S5.E22.m2.1.1.1.1.3.3.2.2" xref="S5.E22.m2.1.1.1.1.3.3.2.2a.cmml">AP</mtext><mi id="S5.E22.m2.1.1.1.1.3.3.2.3" xref="S5.E22.m2.1.1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S5.E22.m2.1.1.1.2" xref="S5.E22.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E22.m2.1b"><apply id="S5.E22.m2.1.1.1.1.cmml" xref="S5.E22.m2.1.1.1"><eq id="S5.E22.m2.1.1.1.1.1.cmml" xref="S5.E22.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S5.E22.m2.1.1.1.1.2.cmml" xref="S5.E22.m2.1.1.1.1.2">absent</csymbol><apply id="S5.E22.m2.1.1.1.1.3.cmml" xref="S5.E22.m2.1.1.1.1.3"><times id="S5.E22.m2.1.1.1.1.3.1.cmml" xref="S5.E22.m2.1.1.1.1.3.1"></times><apply id="S5.E22.m2.1.1.1.1.3.2.cmml" xref="S5.E22.m2.1.1.1.1.3.2"><divide id="S5.E22.m2.1.1.1.1.3.2.1.cmml" xref="S5.E22.m2.1.1.1.1.3.2"></divide><cn id="S5.E22.m2.1.1.1.1.3.2.2.cmml" type="integer" xref="S5.E22.m2.1.1.1.1.3.2.2">1</cn><ci id="S5.E22.m2.1.1.1.1.3.2.3.cmml" xref="S5.E22.m2.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S5.E22.m2.1.1.1.1.3.3.cmml" xref="S5.E22.m2.1.1.1.1.3.3"><apply id="S5.E22.m2.1.1.1.1.3.3.1.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E22.m2.1.1.1.1.3.3.1.1.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S5.E22.m2.1.1.1.1.3.3.1.2.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E22.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S5.E22.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S5.E22.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3"><eq id="S5.E22.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S5.E22.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S5.E22.m2.1.1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S5.E22.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S5.E22.m2.1.1.1.1.3.3.1.3.cmml" xref="S5.E22.m2.1.1.1.1.3.3.1.3">𝑁</ci></apply><apply id="S5.E22.m2.1.1.1.1.3.3.2.cmml" xref="S5.E22.m2.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.E22.m2.1.1.1.1.3.3.2.1.cmml" xref="S5.E22.m2.1.1.1.1.3.3.2">subscript</csymbol><ci id="S5.E22.m2.1.1.1.1.3.3.2.2a.cmml" xref="S5.E22.m2.1.1.1.1.3.3.2.2"><mtext id="S5.E22.m2.1.1.1.1.3.3.2.2.cmml" xref="S5.E22.m2.1.1.1.1.3.3.2.2">AP</mtext></ci><ci id="S5.E22.m2.1.1.1.1.3.3.2.3.cmml" xref="S5.E22.m2.1.1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E22.m2.1c">\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\text{AP}_{i},</annotation><annotation encoding="application/x-llamapun" id="S5.E22.m2.1d">= divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT AP start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p13.3">where <math alttext="\text{AP}_{i}" class="ltx_Math" display="inline" id="S5.SS2.p13.1.m1.1"><semantics id="S5.SS2.p13.1.m1.1a"><msub id="S5.SS2.p13.1.m1.1.1" xref="S5.SS2.p13.1.m1.1.1.cmml"><mtext id="S5.SS2.p13.1.m1.1.1.2" xref="S5.SS2.p13.1.m1.1.1.2a.cmml">AP</mtext><mi id="S5.SS2.p13.1.m1.1.1.3" xref="S5.SS2.p13.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p13.1.m1.1b"><apply id="S5.SS2.p13.1.m1.1.1.cmml" xref="S5.SS2.p13.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p13.1.m1.1.1.1.cmml" xref="S5.SS2.p13.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p13.1.m1.1.1.2a.cmml" xref="S5.SS2.p13.1.m1.1.1.2"><mtext id="S5.SS2.p13.1.m1.1.1.2.cmml" xref="S5.SS2.p13.1.m1.1.1.2">AP</mtext></ci><ci id="S5.SS2.p13.1.m1.1.1.3.cmml" xref="S5.SS2.p13.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p13.1.m1.1c">\text{AP}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p13.1.m1.1d">AP start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the average precision for the <math alttext="i" class="ltx_Math" display="inline" id="S5.SS2.p13.2.m2.1"><semantics id="S5.SS2.p13.2.m2.1a"><mi id="S5.SS2.p13.2.m2.1.1" xref="S5.SS2.p13.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p13.2.m2.1b"><ci id="S5.SS2.p13.2.m2.1.1.cmml" xref="S5.SS2.p13.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p13.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p13.2.m2.1d">italic_i</annotation></semantics></math>-th class, and <math alttext="N" class="ltx_Math" display="inline" id="S5.SS2.p13.3.m3.1"><semantics id="S5.SS2.p13.3.m3.1a"><mi id="S5.SS2.p13.3.m3.1.1" xref="S5.SS2.p13.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p13.3.m3.1b"><ci id="S5.SS2.p13.3.m3.1.1.cmml" xref="S5.SS2.p13.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p13.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p13.3.m3.1d">italic_N</annotation></semantics></math> is the total number of classes.</p>
</div>
<div class="ltx_para" id="S5.SS2.p14">
<p class="ltx_p" id="S5.SS2.p14.1">These metrics collectively enable a robust evaluation of our model’s performance in terms of segmentation accuracy and overall effectiveness.</p>
</div>
</section>
<section class="ltx_subsection ltx_indent_first" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Comparison with Baselines</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Table. <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.T1" title="Table 1 ‣ 5.3 Comparison with Baselines ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">1</span></a> presents the main results of the proposed approach, which includes training with outliers compared to the Cellpose pretrained on cyto3 and cyto2, and TransUNet of ViT-B16 and R50-B16 variants. Despite the advantages of the Cellpose model, such as requiring a smaller number of annotations, it does not offer superior performance due to its reliance on the flow and diameter of cells. In our study, these characteristic properties vary across different stages, and the irregular shapes of cells do not provide consistent diameters for effective segmentation. In comparison, our training approach with Outlier Synthesis enhances the performance significantly over the state-of-the-art TransUNet across all types of loss combinations.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.6" style="width:517.8pt;height:206.1pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.6pt,5.4pt) scale(0.95,0.95) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.6.6">
<tr class="ltx_tr" id="S5.T1.6.6.7">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T1.6.6.7.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.2.1">DSC</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.3.1">HD95</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.4.1">IoU-0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.5.1">IoU-0.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.6.1">IoU-0.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.6.6.7.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.7.7.1">mAP</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.6.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.6.7.1">Framework</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.6.8"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.6.8.1">Encoder</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.6.9"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.6.9.1">Loss</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.1.1"><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.1.m1.1d">↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T1.2.2.2.2"><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T1.2.2.2.2.m1.1"><semantics id="S5.T1.2.2.2.2.m1.1a"><mo id="S5.T1.2.2.2.2.m1.1.1" stretchy="false" xref="S5.T1.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.2.m1.1b"><ci id="S5.T1.2.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.2.m1.1d">↓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T1.3.3.3.3"><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.3.3.3.3.m1.1"><semantics id="S5.T1.3.3.3.3.m1.1a"><mo id="S5.T1.3.3.3.3.m1.1.1" stretchy="false" xref="S5.T1.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.3.m1.1b"><ci id="S5.T1.3.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.3.m1.1d">↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.4.4"><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.4.4.4.4.m1.1"><semantics id="S5.T1.4.4.4.4.m1.1a"><mo id="S5.T1.4.4.4.4.m1.1.1" stretchy="false" xref="S5.T1.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.4.m1.1b"><ci id="S5.T1.4.4.4.4.m1.1.1.cmml" xref="S5.T1.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.4.4.m1.1d">↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T1.5.5.5.5"><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.5.5.5.5.m1.1"><semantics id="S5.T1.5.5.5.5.m1.1a"><mo id="S5.T1.5.5.5.5.m1.1.1" stretchy="false" xref="S5.T1.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.5.m1.1b"><ci id="S5.T1.5.5.5.5.m1.1.1.cmml" xref="S5.T1.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.5.5.m1.1d">↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.6.6"><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.6.6.6.6.m1.1"><semantics id="S5.T1.6.6.6.6.m1.1a"><mo id="S5.T1.6.6.6.6.m1.1.1" stretchy="false" xref="S5.T1.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.6.m1.1b"><ci id="S5.T1.6.6.6.6.m1.1.1.cmml" xref="S5.T1.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.6.6.m1.1d">↑</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.1" rowspan="2"><span class="ltx_text" id="S5.T1.6.6.8.1.1">Cellpose <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib6" title="">6</a>]</cite></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T1.6.6.8.2">cyto3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.3">63.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.4">137.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.5">25.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.6">12.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.7">3.641</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.8.8">48.51</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.9">
<td class="ltx_td ltx_align_center" colspan="2" id="S5.T1.6.6.9.1">cyto2</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.2">48.15</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.3">181.5</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.4">19.02</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.5">8.220</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.6">2.569</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.9.7">36.78</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.10">
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.1" rowspan="2"><span class="ltx_text" id="S5.T1.6.6.10.1.1">TransUnet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib1" title="">1</a>]</cite></span></td>
<td class="ltx_td ltx_align_center" colspan="2" id="S5.T1.6.6.10.2">ViT-B16</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.3">72.47</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.4">38.21</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.5">76.42</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.6">30.19</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.7">3.019</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.10.8">36.54</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.11">
<td class="ltx_td ltx_align_center" colspan="2" id="S5.T1.6.6.11.1">R50-B16</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.2">80.35</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.3">21.98</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.4">88.00</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.5">58.67</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.6">9.220</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.11.7">51.97</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.12">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.6.6.12.1" rowspan="6"><span class="ltx_text" id="S5.T1.6.6.12.1.1">MorphoSeg</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.2" rowspan="3"><span class="ltx_text" id="S5.T1.6.6.12.2.1">ViT-B16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.3">Balance</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.4">72.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.5">38.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.6">77.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.7">30.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.8">3.787</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.12.9">37.46</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.13">
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.1">Norm</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.2">74.24</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.3">36.82</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.4">81.54</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.5">43.82</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.6">4.765</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.13.7">38.96</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.14">
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.1">Pareto</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.2">73.67</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.3">37.10</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.4">80.43</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.5">42.66</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.6">3.433</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.14.7">37.58</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.15">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.6.6.15.1" rowspan="3"><span class="ltx_text" id="S5.T1.6.6.15.1.1">R50-B16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.2">Balance</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.3">86.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.4">16.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.5">93.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.6">79.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.7">20.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.15.8">64.27</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.16">
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.1">Norm</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.2">84.40</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.3">26.37</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.4">91.64</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.5">72.50</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.6">11.30</td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.6.16.7">58.48</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6.17">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.1">Pareto</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.2.1">86.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.3.1">15.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.4.1">93.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.5.1">80.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.6.1">21.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.6.6.17.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.17.7.1">64.96</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison on our proposed cell dataset. All methods incorporating Outlier Synthesis are trained with a sample size of <math alttext="100,000" class="ltx_Math" display="inline" id="S5.T1.11.m1.2"><semantics id="S5.T1.11.m1.2b"><mrow id="S5.T1.11.m1.2.3.2" xref="S5.T1.11.m1.2.3.1.cmml"><mn id="S5.T1.11.m1.1.1" xref="S5.T1.11.m1.1.1.cmml">100</mn><mo id="S5.T1.11.m1.2.3.2.1" xref="S5.T1.11.m1.2.3.1.cmml">,</mo><mn id="S5.T1.11.m1.2.2" xref="S5.T1.11.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.11.m1.2c"><list id="S5.T1.11.m1.2.3.1.cmml" xref="S5.T1.11.m1.2.3.2"><cn id="S5.T1.11.m1.1.1.cmml" type="integer" xref="S5.T1.11.m1.1.1">100</cn><cn id="S5.T1.11.m1.2.2.cmml" type="integer" xref="S5.T1.11.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.m1.2d">100,000</annotation><annotation encoding="application/x-llamapun" id="S5.T1.11.m1.2e">100 , 000</annotation></semantics></math>, and the selection count is set to <math alttext="10,000" class="ltx_Math" display="inline" id="S5.T1.12.m2.2"><semantics id="S5.T1.12.m2.2b"><mrow id="S5.T1.12.m2.2.3.2" xref="S5.T1.12.m2.2.3.1.cmml"><mn id="S5.T1.12.m2.1.1" xref="S5.T1.12.m2.1.1.cmml">10</mn><mo id="S5.T1.12.m2.2.3.2.1" xref="S5.T1.12.m2.2.3.1.cmml">,</mo><mn id="S5.T1.12.m2.2.2" xref="S5.T1.12.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.12.m2.2c"><list id="S5.T1.12.m2.2.3.1.cmml" xref="S5.T1.12.m2.2.3.2"><cn id="S5.T1.12.m2.1.1.cmml" type="integer" xref="S5.T1.12.m2.1.1">10</cn><cn id="S5.T1.12.m2.2.2.cmml" type="integer" xref="S5.T1.12.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.m2.2d">10,000</annotation><annotation encoding="application/x-llamapun" id="S5.T1.12.m2.2e">10 , 000</annotation></semantics></math>. <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.13.m3.1"><semantics id="S5.T1.13.m3.1b"><mo id="S5.T1.13.m3.1.1" stretchy="false" xref="S5.T1.13.m3.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.13.m3.1c"><ci id="S5.T1.13.m3.1.1.cmml" xref="S5.T1.13.m3.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.m3.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.13.m3.1e">↑</annotation></semantics></math> indicates that larger values are preferable, while <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T1.14.m4.1"><semantics id="S5.T1.14.m4.1b"><mo id="S5.T1.14.m4.1.1" stretchy="false" xref="S5.T1.14.m4.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.m4.1c"><ci id="S5.T1.14.m4.1.1.cmml" xref="S5.T1.14.m4.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.m4.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.14.m4.1e">↓</annotation></semantics></math> indicates that smaller values are better. All numerical values are presented as percentages. <span class="ltx_text ltx_font_bold" id="S5.T1.16.1">Bold</span> numbers indicate superior results.</figcaption>
</figure>
</section>
<section class="ltx_subsection ltx_indent_first" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Studies</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.2"><span class="ltx_text ltx_font_bold" id="S5.SS4.p1.2.1">Incorporating Uncertainty into Loss Function Design.</span> 
To determine the optimal values for the weight parameters <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mi id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><ci id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_λ</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_β</annotation></semantics></math> in Equation.(<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S3.E16" title="Equation 16 ‣ 3.3 Unknown-aware Training Objective ‣ 3 Methodology ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">16</span></a>), we evaluate three sophisticated approaches to weight the loss components, tailored for enhanced model training and testing. The <span class="ltx_text ltx_font_bold" id="S5.SS4.p1.2.2">Original Balancing</span> method, consistent with TranUNet, evenly distributes weights across all loss components, simplifying optimization but potentially overlooking specific task requirements within the model. Alternatively, the <span class="ltx_text ltx_font_bold" id="S5.SS4.p1.2.3">Normalized Losses</span> method dynamically scales each loss component by its magnitude:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{norm}}=\sum_{i}\frac{\mathcal{L}_{i}}{\|\mathcal{L}_{i}\|}+\epsilon," class="ltx_Math" display="block" id="S5.E23.m1.2"><semantics id="S5.E23.m1.2a"><mrow id="S5.E23.m1.2.2.1" xref="S5.E23.m1.2.2.1.1.cmml"><mrow id="S5.E23.m1.2.2.1.1" xref="S5.E23.m1.2.2.1.1.cmml"><msub id="S5.E23.m1.2.2.1.1.2" xref="S5.E23.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E23.m1.2.2.1.1.2.2" xref="S5.E23.m1.2.2.1.1.2.2.cmml">ℒ</mi><mtext id="S5.E23.m1.2.2.1.1.2.3" xref="S5.E23.m1.2.2.1.1.2.3a.cmml">norm</mtext></msub><mo id="S5.E23.m1.2.2.1.1.1" rspace="0.111em" xref="S5.E23.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E23.m1.2.2.1.1.3" xref="S5.E23.m1.2.2.1.1.3.cmml"><mrow id="S5.E23.m1.2.2.1.1.3.2" xref="S5.E23.m1.2.2.1.1.3.2.cmml"><munder id="S5.E23.m1.2.2.1.1.3.2.1" xref="S5.E23.m1.2.2.1.1.3.2.1.cmml"><mo id="S5.E23.m1.2.2.1.1.3.2.1.2" movablelimits="false" xref="S5.E23.m1.2.2.1.1.3.2.1.2.cmml">∑</mo><mi id="S5.E23.m1.2.2.1.1.3.2.1.3" xref="S5.E23.m1.2.2.1.1.3.2.1.3.cmml">i</mi></munder><mfrac id="S5.E23.m1.1.1" xref="S5.E23.m1.1.1.cmml"><msub id="S5.E23.m1.1.1.3" xref="S5.E23.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E23.m1.1.1.3.2" xref="S5.E23.m1.1.1.3.2.cmml">ℒ</mi><mi id="S5.E23.m1.1.1.3.3" xref="S5.E23.m1.1.1.3.3.cmml">i</mi></msub><mrow id="S5.E23.m1.1.1.1.1" xref="S5.E23.m1.1.1.1.2.cmml"><mo id="S5.E23.m1.1.1.1.1.2" stretchy="false" xref="S5.E23.m1.1.1.1.2.1.cmml">‖</mo><msub id="S5.E23.m1.1.1.1.1.1" xref="S5.E23.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E23.m1.1.1.1.1.1.2" xref="S5.E23.m1.1.1.1.1.1.2.cmml">ℒ</mi><mi id="S5.E23.m1.1.1.1.1.1.3" xref="S5.E23.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E23.m1.1.1.1.1.3" stretchy="false" xref="S5.E23.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S5.E23.m1.2.2.1.1.3.1" xref="S5.E23.m1.2.2.1.1.3.1.cmml">+</mo><mi id="S5.E23.m1.2.2.1.1.3.3" xref="S5.E23.m1.2.2.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S5.E23.m1.2.2.1.2" xref="S5.E23.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E23.m1.2b"><apply id="S5.E23.m1.2.2.1.1.cmml" xref="S5.E23.m1.2.2.1"><eq id="S5.E23.m1.2.2.1.1.1.cmml" xref="S5.E23.m1.2.2.1.1.1"></eq><apply id="S5.E23.m1.2.2.1.1.2.cmml" xref="S5.E23.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E23.m1.2.2.1.1.2.1.cmml" xref="S5.E23.m1.2.2.1.1.2">subscript</csymbol><ci id="S5.E23.m1.2.2.1.1.2.2.cmml" xref="S5.E23.m1.2.2.1.1.2.2">ℒ</ci><ci id="S5.E23.m1.2.2.1.1.2.3a.cmml" xref="S5.E23.m1.2.2.1.1.2.3"><mtext id="S5.E23.m1.2.2.1.1.2.3.cmml" mathsize="70%" xref="S5.E23.m1.2.2.1.1.2.3">norm</mtext></ci></apply><apply id="S5.E23.m1.2.2.1.1.3.cmml" xref="S5.E23.m1.2.2.1.1.3"><plus id="S5.E23.m1.2.2.1.1.3.1.cmml" xref="S5.E23.m1.2.2.1.1.3.1"></plus><apply id="S5.E23.m1.2.2.1.1.3.2.cmml" xref="S5.E23.m1.2.2.1.1.3.2"><apply id="S5.E23.m1.2.2.1.1.3.2.1.cmml" xref="S5.E23.m1.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S5.E23.m1.2.2.1.1.3.2.1.1.cmml" xref="S5.E23.m1.2.2.1.1.3.2.1">subscript</csymbol><sum id="S5.E23.m1.2.2.1.1.3.2.1.2.cmml" xref="S5.E23.m1.2.2.1.1.3.2.1.2"></sum><ci id="S5.E23.m1.2.2.1.1.3.2.1.3.cmml" xref="S5.E23.m1.2.2.1.1.3.2.1.3">𝑖</ci></apply><apply id="S5.E23.m1.1.1.cmml" xref="S5.E23.m1.1.1"><divide id="S5.E23.m1.1.1.2.cmml" xref="S5.E23.m1.1.1"></divide><apply id="S5.E23.m1.1.1.3.cmml" xref="S5.E23.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E23.m1.1.1.3.1.cmml" xref="S5.E23.m1.1.1.3">subscript</csymbol><ci id="S5.E23.m1.1.1.3.2.cmml" xref="S5.E23.m1.1.1.3.2">ℒ</ci><ci id="S5.E23.m1.1.1.3.3.cmml" xref="S5.E23.m1.1.1.3.3">𝑖</ci></apply><apply id="S5.E23.m1.1.1.1.2.cmml" xref="S5.E23.m1.1.1.1.1"><csymbol cd="latexml" id="S5.E23.m1.1.1.1.2.1.cmml" xref="S5.E23.m1.1.1.1.1.2">norm</csymbol><apply id="S5.E23.m1.1.1.1.1.1.cmml" xref="S5.E23.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E23.m1.1.1.1.1.1.1.cmml" xref="S5.E23.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.E23.m1.1.1.1.1.1.2.cmml" xref="S5.E23.m1.1.1.1.1.1.2">ℒ</ci><ci id="S5.E23.m1.1.1.1.1.1.3.cmml" xref="S5.E23.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><ci id="S5.E23.m1.2.2.1.1.3.3.cmml" xref="S5.E23.m1.2.2.1.1.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E23.m1.2c">\mathcal{L}_{\text{norm}}=\sum_{i}\frac{\mathcal{L}_{i}}{\|\mathcal{L}_{i}\|}+\epsilon,</annotation><annotation encoding="application/x-llamapun" id="S5.E23.m1.2d">caligraphic_L start_POSTSUBSCRIPT norm end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT divide start_ARG caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ end_ARG + italic_ϵ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS4.p1.6">where <math alttext="\mathcal{L}_{i}" class="ltx_Math" display="inline" id="S5.SS4.p1.3.m1.1"><semantics id="S5.SS4.p1.3.m1.1a"><msub id="S5.SS4.p1.3.m1.1.1" xref="S5.SS4.p1.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.3.m1.1.1.2" xref="S5.SS4.p1.3.m1.1.1.2.cmml">ℒ</mi><mi id="S5.SS4.p1.3.m1.1.1.3" xref="S5.SS4.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m1.1b"><apply id="S5.SS4.p1.3.m1.1.1.cmml" xref="S5.SS4.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.3.m1.1.1.1.cmml" xref="S5.SS4.p1.3.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.3.m1.1.1.2.cmml" xref="S5.SS4.p1.3.m1.1.1.2">ℒ</ci><ci id="S5.SS4.p1.3.m1.1.1.3.cmml" xref="S5.SS4.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m1.1c">\mathcal{L}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes individual loss components, <math alttext="\|\cdot\|" class="ltx_math_unparsed" display="inline" id="S5.SS4.p1.4.m2.1"><semantics id="S5.SS4.p1.4.m2.1a"><mrow id="S5.SS4.p1.4.m2.1b"><mo id="S5.SS4.p1.4.m2.1.1" rspace="0em">∥</mo><mo id="S5.SS4.p1.4.m2.1.2" lspace="0em" rspace="0em">⋅</mo><mo id="S5.SS4.p1.4.m2.1.3" lspace="0em">∥</mo></mrow><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m2.1c">\|\cdot\|</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.4.m2.1d">∥ ⋅ ∥</annotation></semantics></math> signifies the norm operation applied to each loss component to normalize its scale, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S5.SS4.p1.5.m3.1"><semantics id="S5.SS4.p1.5.m3.1a"><mi id="S5.SS4.p1.5.m3.1.1" xref="S5.SS4.p1.5.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m3.1b"><ci id="S5.SS4.p1.5.m3.1.1.cmml" xref="S5.SS4.p1.5.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.5.m3.1d">italic_ϵ</annotation></semantics></math> is a small constant to prevent division by zero. This adjustment ensures that hyperparameters <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S5.SS4.p1.6.m4.1"><semantics id="S5.SS4.p1.6.m4.1a"><msub id="S5.SS4.p1.6.m4.1.1" xref="S5.SS4.p1.6.m4.1.1.cmml"><mi id="S5.SS4.p1.6.m4.1.1.2" xref="S5.SS4.p1.6.m4.1.1.2.cmml">λ</mi><mi id="S5.SS4.p1.6.m4.1.1.3" xref="S5.SS4.p1.6.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m4.1b"><apply id="S5.SS4.p1.6.m4.1.1.cmml" xref="S5.SS4.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.6.m4.1.1.1.cmml" xref="S5.SS4.p1.6.m4.1.1">subscript</csymbol><ci id="S5.SS4.p1.6.m4.1.1.2.cmml" xref="S5.SS4.p1.6.m4.1.1.2">𝜆</ci><ci id="S5.SS4.p1.6.m4.1.1.3.cmml" xref="S5.SS4.p1.6.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m4.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.6.m4.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are iteratively tuned to maintain balance among the loss components. A refinement of this approach normalizes subsequent losses relative to the first, calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{pareto}}=\mathcal{L}_{\text{loss}}+\sum_{i\neq\text{loss}}%
\frac{\mathcal{L}_{i}}{\|\mathcal{L}_{i}/\mathcal{L}_{\text{loss}}\|}," class="ltx_Math" display="block" id="S5.E24.m1.2"><semantics id="S5.E24.m1.2a"><mrow id="S5.E24.m1.2.2.1" xref="S5.E24.m1.2.2.1.1.cmml"><mrow id="S5.E24.m1.2.2.1.1" xref="S5.E24.m1.2.2.1.1.cmml"><msub id="S5.E24.m1.2.2.1.1.2" xref="S5.E24.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E24.m1.2.2.1.1.2.2" xref="S5.E24.m1.2.2.1.1.2.2.cmml">ℒ</mi><mtext id="S5.E24.m1.2.2.1.1.2.3" xref="S5.E24.m1.2.2.1.1.2.3a.cmml">pareto</mtext></msub><mo id="S5.E24.m1.2.2.1.1.1" xref="S5.E24.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E24.m1.2.2.1.1.3" xref="S5.E24.m1.2.2.1.1.3.cmml"><msub id="S5.E24.m1.2.2.1.1.3.2" xref="S5.E24.m1.2.2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E24.m1.2.2.1.1.3.2.2" xref="S5.E24.m1.2.2.1.1.3.2.2.cmml">ℒ</mi><mtext id="S5.E24.m1.2.2.1.1.3.2.3" xref="S5.E24.m1.2.2.1.1.3.2.3a.cmml">loss</mtext></msub><mo id="S5.E24.m1.2.2.1.1.3.1" rspace="0.055em" xref="S5.E24.m1.2.2.1.1.3.1.cmml">+</mo><mrow id="S5.E24.m1.2.2.1.1.3.3" xref="S5.E24.m1.2.2.1.1.3.3.cmml"><munder id="S5.E24.m1.2.2.1.1.3.3.1" xref="S5.E24.m1.2.2.1.1.3.3.1.cmml"><mo id="S5.E24.m1.2.2.1.1.3.3.1.2" movablelimits="false" xref="S5.E24.m1.2.2.1.1.3.3.1.2.cmml">∑</mo><mrow id="S5.E24.m1.2.2.1.1.3.3.1.3" xref="S5.E24.m1.2.2.1.1.3.3.1.3.cmml"><mi id="S5.E24.m1.2.2.1.1.3.3.1.3.2" xref="S5.E24.m1.2.2.1.1.3.3.1.3.2.cmml">i</mi><mo id="S5.E24.m1.2.2.1.1.3.3.1.3.1" xref="S5.E24.m1.2.2.1.1.3.3.1.3.1.cmml">≠</mo><mtext id="S5.E24.m1.2.2.1.1.3.3.1.3.3" xref="S5.E24.m1.2.2.1.1.3.3.1.3.3a.cmml">loss</mtext></mrow></munder><mfrac id="S5.E24.m1.1.1" xref="S5.E24.m1.1.1.cmml"><msub id="S5.E24.m1.1.1.3" xref="S5.E24.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E24.m1.1.1.3.2" xref="S5.E24.m1.1.1.3.2.cmml">ℒ</mi><mi id="S5.E24.m1.1.1.3.3" xref="S5.E24.m1.1.1.3.3.cmml">i</mi></msub><mrow id="S5.E24.m1.1.1.1.1" xref="S5.E24.m1.1.1.1.2.cmml"><mo id="S5.E24.m1.1.1.1.1.2" stretchy="false" xref="S5.E24.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.E24.m1.1.1.1.1.1" xref="S5.E24.m1.1.1.1.1.1.cmml"><msub id="S5.E24.m1.1.1.1.1.1.2" xref="S5.E24.m1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E24.m1.1.1.1.1.1.2.2" xref="S5.E24.m1.1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S5.E24.m1.1.1.1.1.1.2.3" xref="S5.E24.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.E24.m1.1.1.1.1.1.1" xref="S5.E24.m1.1.1.1.1.1.1.cmml">/</mo><msub id="S5.E24.m1.1.1.1.1.1.3" xref="S5.E24.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E24.m1.1.1.1.1.1.3.2" xref="S5.E24.m1.1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S5.E24.m1.1.1.1.1.1.3.3" xref="S5.E24.m1.1.1.1.1.1.3.3a.cmml">loss</mtext></msub></mrow><mo id="S5.E24.m1.1.1.1.1.3" stretchy="false" xref="S5.E24.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow></mrow><mo id="S5.E24.m1.2.2.1.2" xref="S5.E24.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E24.m1.2b"><apply id="S5.E24.m1.2.2.1.1.cmml" xref="S5.E24.m1.2.2.1"><eq id="S5.E24.m1.2.2.1.1.1.cmml" xref="S5.E24.m1.2.2.1.1.1"></eq><apply id="S5.E24.m1.2.2.1.1.2.cmml" xref="S5.E24.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E24.m1.2.2.1.1.2.1.cmml" xref="S5.E24.m1.2.2.1.1.2">subscript</csymbol><ci id="S5.E24.m1.2.2.1.1.2.2.cmml" xref="S5.E24.m1.2.2.1.1.2.2">ℒ</ci><ci id="S5.E24.m1.2.2.1.1.2.3a.cmml" xref="S5.E24.m1.2.2.1.1.2.3"><mtext id="S5.E24.m1.2.2.1.1.2.3.cmml" mathsize="70%" xref="S5.E24.m1.2.2.1.1.2.3">pareto</mtext></ci></apply><apply id="S5.E24.m1.2.2.1.1.3.cmml" xref="S5.E24.m1.2.2.1.1.3"><plus id="S5.E24.m1.2.2.1.1.3.1.cmml" xref="S5.E24.m1.2.2.1.1.3.1"></plus><apply id="S5.E24.m1.2.2.1.1.3.2.cmml" xref="S5.E24.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S5.E24.m1.2.2.1.1.3.2.1.cmml" xref="S5.E24.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S5.E24.m1.2.2.1.1.3.2.2.cmml" xref="S5.E24.m1.2.2.1.1.3.2.2">ℒ</ci><ci id="S5.E24.m1.2.2.1.1.3.2.3a.cmml" xref="S5.E24.m1.2.2.1.1.3.2.3"><mtext id="S5.E24.m1.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S5.E24.m1.2.2.1.1.3.2.3">loss</mtext></ci></apply><apply id="S5.E24.m1.2.2.1.1.3.3.cmml" xref="S5.E24.m1.2.2.1.1.3.3"><apply id="S5.E24.m1.2.2.1.1.3.3.1.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S5.E24.m1.2.2.1.1.3.3.1.1.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S5.E24.m1.2.2.1.1.3.3.1.2.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1.2"></sum><apply id="S5.E24.m1.2.2.1.1.3.3.1.3.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1.3"><neq id="S5.E24.m1.2.2.1.1.3.3.1.3.1.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1.3.1"></neq><ci id="S5.E24.m1.2.2.1.1.3.3.1.3.2.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1.3.2">𝑖</ci><ci id="S5.E24.m1.2.2.1.1.3.3.1.3.3a.cmml" xref="S5.E24.m1.2.2.1.1.3.3.1.3.3"><mtext id="S5.E24.m1.2.2.1.1.3.3.1.3.3.cmml" mathsize="70%" xref="S5.E24.m1.2.2.1.1.3.3.1.3.3">loss</mtext></ci></apply></apply><apply id="S5.E24.m1.1.1.cmml" xref="S5.E24.m1.1.1"><divide id="S5.E24.m1.1.1.2.cmml" xref="S5.E24.m1.1.1"></divide><apply id="S5.E24.m1.1.1.3.cmml" xref="S5.E24.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E24.m1.1.1.3.1.cmml" xref="S5.E24.m1.1.1.3">subscript</csymbol><ci id="S5.E24.m1.1.1.3.2.cmml" xref="S5.E24.m1.1.1.3.2">ℒ</ci><ci id="S5.E24.m1.1.1.3.3.cmml" xref="S5.E24.m1.1.1.3.3">𝑖</ci></apply><apply id="S5.E24.m1.1.1.1.2.cmml" xref="S5.E24.m1.1.1.1.1"><csymbol cd="latexml" id="S5.E24.m1.1.1.1.2.1.cmml" xref="S5.E24.m1.1.1.1.1.2">norm</csymbol><apply id="S5.E24.m1.1.1.1.1.1.cmml" xref="S5.E24.m1.1.1.1.1.1"><divide id="S5.E24.m1.1.1.1.1.1.1.cmml" xref="S5.E24.m1.1.1.1.1.1.1"></divide><apply id="S5.E24.m1.1.1.1.1.1.2.cmml" xref="S5.E24.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E24.m1.1.1.1.1.1.2.1.cmml" xref="S5.E24.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E24.m1.1.1.1.1.1.2.2.cmml" xref="S5.E24.m1.1.1.1.1.1.2.2">ℒ</ci><ci id="S5.E24.m1.1.1.1.1.1.2.3.cmml" xref="S5.E24.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.E24.m1.1.1.1.1.1.3.cmml" xref="S5.E24.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E24.m1.1.1.1.1.1.3.1.cmml" xref="S5.E24.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E24.m1.1.1.1.1.1.3.2.cmml" xref="S5.E24.m1.1.1.1.1.1.3.2">ℒ</ci><ci id="S5.E24.m1.1.1.1.1.1.3.3a.cmml" xref="S5.E24.m1.1.1.1.1.1.3.3"><mtext id="S5.E24.m1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S5.E24.m1.1.1.1.1.1.3.3">loss</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E24.m1.2c">\mathcal{L}_{\text{pareto}}=\mathcal{L}_{\text{loss}}+\sum_{i\neq\text{loss}}%
\frac{\mathcal{L}_{i}}{\|\mathcal{L}_{i}/\mathcal{L}_{\text{loss}}\|},</annotation><annotation encoding="application/x-llamapun" id="S5.E24.m1.2d">caligraphic_L start_POSTSUBSCRIPT pareto end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT loss end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_i ≠ loss end_POSTSUBSCRIPT divide start_ARG caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / caligraphic_L start_POSTSUBSCRIPT loss end_POSTSUBSCRIPT ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS4.p1.7">which potentially provides a more rational scaling by relating all losses back to the primary loss component. Lastly, the <span class="ltx_text ltx_font_bold" id="S5.SS4.p1.7.1">Pareto Optimization</span> strategy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#bib.bib58" title="">58</a>]</cite>, aims to achieve a Pareto efficient solution by treating each loss as an objective in a multi-objective optimization framework, wherein improvements in one objective are sought without significant compromises in others, facilitating an equilibrium that optimizes overall model performance.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="553" id="S5.F4.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visualization of Ntera-2 Cell Segmentation in the Testing Dataset: Original Images, Segmentation Masks, and Overlays. Row A displays the original images, Row B displays the segmentation mask and Row C displays the mask overlay on the original image. Image set 1 highlights the ability of the network to segment cells in an unfocused image. Image set 2 highlights the ability of the network to segment cells despite low contrast and unclear cell borders. Images 3 and 4 display ability of the network to segment high-quality images at different magnifications, x10 and x25, respectively. </figcaption>
</figure>
</section>
<section class="ltx_subsection ltx_indent_first" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Patch-Based Approach for High-Resolution Inference and Visualization</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">Given the inherent limitations of Vision Transformers, where token size constraints can result in vague and imprecise inference on large images, we propose an advanced patch-based inference technique to address the sensitivity to pixel-level cellular details. This approach enhances segmentation accuracy for high-resolution biological cell images while making the framework more practical and accessible for researchers. Example visualizations of the results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.F4" title="Figure 4 ‣ 5.4 Ablation Studies ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.2">During a single image inference stage, the image is initially subdivided into patches of size <math alttext="224\times 224" class="ltx_Math" display="inline" id="S5.SS5.p2.1.m1.1"><semantics id="S5.SS5.p2.1.m1.1a"><mrow id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml"><mn id="S5.SS5.p2.1.m1.1.1.2" xref="S5.SS5.p2.1.m1.1.1.2.cmml">224</mn><mo id="S5.SS5.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS5.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS5.p2.1.m1.1.1.3" xref="S5.SS5.p2.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><apply id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1"><times id="S5.SS5.p2.1.m1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1.1"></times><cn id="S5.SS5.p2.1.m1.1.1.2.cmml" type="integer" xref="S5.SS5.p2.1.m1.1.1.2">224</cn><cn id="S5.SS5.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS5.p2.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.1.m1.1d">224 × 224</annotation></semantics></math>, similar to the data augmentation strategy presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S4.SS2" title="4.2 Data Preprocessing ‣ 4 Dataset Analysis ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4.2</span></a>. This subdivision allows the model to focus on and accurately detect fine-grained variations at the boundaries of the Ntera-2 cells and their surrounding environment. Each patch undergoes a separate inference process. To preserve the global spatial context, we incorporate an overlapping strategy with a <math alttext="56" class="ltx_Math" display="inline" id="S5.SS5.p2.2.m2.1"><semantics id="S5.SS5.p2.2.m2.1a"><mn id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml">56</mn><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><cn id="S5.SS5.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS5.p2.2.m2.1.1">56</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">56</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.2.m2.1d">56</annotation></semantics></math>-pixel margin. This overlap ensures continuity and minimizes edge artifacts. The inference results from the patches are then combined using an average pooling strategy and visualized as segmentation masks, shown in red in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17110v1#S5.F4" title="Figure 4 ‣ 5.4 Ablation Studies ‣ 5 Experiments ‣ MorphoSeg: An Uncertainty-Aware Deep Learning Method for Biomedical Segmentation of Complex Cellular Morphologies"><span class="ltx_text ltx_ref_tag">4</span></a>. This end-to-end training and visualization strategy significantly facilitates the application of our framework, enabling researchers to use it without requiring further modifications.</p>
</div>
</section>
</section>
<section class="ltx_section ltx_indent_first" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we introduced a novel data repository containing differentiating NT2 cells, designed to facilitate the segmentation of complex cell morphologies. This dataset requires pixel-level segmentation, which presents new challenges for accurately segmenting cells with intricate shapes. To address these challenges, we proposed an uncertainty-aware segmentation method MorphoSeg enhancing the base TranUNet by training on virtual outliers sampled near the feature representation space, thereby increasing the model’s sensitivity to small pixel variations and morphological changes across different cell stages. This enhancement makes our MorphoSeg more robust and effective for segmenting complex and irregularly shaped cells.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">The experimental results demonstrate that the proposed MorphoSeg outperforms existing benchmarks, including Cellpose and TransUNet. Our best-performing model, MorphoSeg with a hybrid encoder, showed a notable improvement in performance metrics, achieving a 6.23% increase in the Dice Similarity Coefficient (DSC). This statistic measures the similarity between the segmented cells and the ground truth. A reduction in HD95 (Hausdorff Distance at the 95th percentile) was also measured, indicating a decreased spatial discrepancy between the predicted and actual segmentation boundaries compared to the baseline configuration.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">By providing comprehensive visualizations and complete code, we aim to contribute to not only advance further research in this emerging domain but also to serve as a practical solution for cell segmentation and visualization in diverse medical AI applications.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p4">
<p class="ltx_p" id="S6.p4.1"><span class="ltx_text ltx_font_bold" id="S6.p4.1.1">Future Work:</span> Building on the proposed NT2 cells dataset, future research will address the challenge of segmenting complex cell morphologies, particularly those with substantial overlapping regions, which remain a significant obstacle to achieving accurate segmentation. Further efforts will focus on developing advanced deep-learning methods for biological AI to overcome these challenges.</p>
</div>
</section>
<section class="ltx_section ltx_indentfirst" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We express our gratitude to the UK Engineering and Physical Sciences Research Council (EPSRC) for their support through the following projects: EP/V026747/1 (Trustworthy Autonomous Systems Node in Resilience) and EP/T013265/1 (NSF-EPSRC: ShiRAS. Towards Safe and Reliable Autonomy in Sensor Driven Systems). We also acknowledge the support of the National Science Foundation (NSF) under Grant No. ECCS 1903466 for the ShiRAS project. For the purpose of open access, the authors have applied a Creative Commons Attribution (CC BY) licence to any Author Accepted Manuscript (AAM) version arising from this work.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
J. Chen, Y. Lu, Q. Yu, X. Luo, E. Adeli, Y. Wang, L. Lu, A. L. Yuille, Y. Zhou, Transunet: Transformers make strong encoders for medical image segmentation, arXiv preprint arXiv:2102.04306 (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
O. Ronneberger, P. Fischer, T. Brox, U-net: Convolutional networks for biomedical image segmentation, in: International Conference on Medical image computing and computer-assisted intervention, Springer, 2015, pp. 234–241.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
K. Zhang, D. Liu, Customized segment anything model for medical image segmentation, arXiv preprint arXiv:2304.13785 (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Zhao, K. Cao, J. Yao, I. Nogues, L. Lu, L. Huang, J. Xiao, Z. Yin, L. Zhang, 3D graph anatomy geometry-integrated network for pancreatic mass segmentation, diagnosis, and quantitative patient management, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2021, pp. 13743–13752.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
M. Saha, C. Chakraborty, Her2net: A deep framework for semantic segmentation and classification of cell membranes and nuclei in breast cancer evaluation, IEEE Transactions on Image Processing 27 (5) (2018) 2189–2200.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Stringer, T. Wang, M. Michaelos, M. Pachitariu, Cellpose: a generalist algorithm for cellular segmentation, Nature methods 18 (1) (2021) 100–106.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
V. Petukhov, R. J. Xu, R. A. Soldatov, P. Cadinu, K. Khodosevich, J. R. Moffitt, P. V. Kharchenko, Cell segmentation in imaging-based spatial transcriptomics 40 (2021) 345–354.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
C. Edlund, T. R. Jackson, N. Khalid, N. Bevan, T. Dale, A. Dengel, S. Ahmed, J. Trygg, R. Sjögren, Livecell—a large-scale dataset for label-free live cell segmentation 18 (2021) 1038–1045.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
U. Israel, M. Marks, R. Dilip, Q. Li, M. Schwartz, E. Pradhan, E. Pao, S. Li, A. Pearson-Goulart, P. Perona, et al., A foundation model for cell segmentation, bioRxiv.<a class="ltx_ref ltx_href" href="https://doi.org/10.1101/2023.11.17.567630" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:10.1101/2023.11.17.567630</span></a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. Edlund, T. R. Jackson, N. Khalid, N. Bevan, T. Dale, A. Dengel, S. Ahmed, J. Trygg, R. Sjögren, Livecell—a large-scale dataset for label-free live cell segmentation, Nature methods 18 (9) (2021) 1038–1045.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
D. A. Van Valen, T. Kudo, K. M. Lane, D. N. Macklin, N. T. Quach, M. M. DeFelice, I. Maayan, Y. Tanouchi, E. A. Ashley, M. W. Covert, <a class="ltx_ref ltx_href" href="https://doi.org/10.1371/journal.pcbi.1005177" title="">Deep learning automates the quantitative analysis of individual cells in live-cell imaging experiments</a>, PLOS Computational Biology 12 (11) (2016) 1–24.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1371/journal.pcbi.1005177" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:10.1371/journal.pcbi.1005177</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1371/journal.pcbi.1005177" title="">https://doi.org/10.1371/journal.pcbi.1005177</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
E. Moen, E. Borba, G. Miller, M. Schwartz, D. Bannon, N. Koe, I. Camplisson, D. Kyme, C. Pavelchek, T. Price, T. Kudo, E. Pao, W. Graf, D. Van Valen, <a class="ltx_ref ltx_href" href="https://www.biorxiv.org/content/early/2019/10/14/803205" title="">Accurate cell tracking and lineage construction in live-cell imaging experiments with deep learning</a>, bioRxiv (2019).

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/https://www.biorxiv.org/content/early/2019/10/14/803205.full.pdf" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">arXiv:https://www.biorxiv.org/content/early/2019/10/14/803205.full.pdf</span></a>, <a class="ltx_ref ltx_href" href="https://doi.org/10.1101/803205" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:10.1101/803205</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.biorxiv.org/content/early/2019/10/14/803205" title="">https://www.biorxiv.org/content/early/2019/10/14/803205</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
X. Li, H. Chen, X. Qi, Q. Dou, C.-W. Fu, P. A. Heng, H-DenseUNet: Hybrid densely connected UNet for liver and liver tumor segmentation from CT volumes, IEEE Transactions on Medical Imaging (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
T. Zhao, Z. Yin, Weakly supervised cell segmentation by point annotation 40 (2021) 2736–2747.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. C. Robitaille, J. M. Byers, J. A. Christodoulides, M. P. Raphael, Self-supervised machine learning for live cell imagery segmentation 5 (2022) 1162–8.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. J. McCourty, T. Zhang, A. Nikolaev, B. M. Sanchez-Tafoll, L. S. Mihaylova, Dataset of Ntera-2 cells for segmentation (2024).

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/https://doi.org/10.15131/shef.data.25604421" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:https://doi.org/10.15131/shef.data.25604421</span></a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Pleasure, V. Lee, Ntera 2 cells: A human cell line which displays characteristics expected of a human committed neuronal progenitor cell, Journal of Neuroscience Research 34 (1993) 585–602.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
P. W. Andrews, Retinoic acid induces neuronal differentiation of a cloned human embryonal carcinoma cell line in vitro, Developmental Biology 103 (2) (1984) 285–293.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
S. Liu, D. Xu, S. K. Zhou, O. Pauly, S. Grbic, T. Mertelmeier, J. Wicklein, A. Jerebko, W. Cai, D. Comaniciu, 3d anisotropic hybrid network: Transferring convolutional features from 2d images to 3d anisotropic volumes, in: International Conference on Medical Image Computing and Computer-Assisted Intervention, Springer, 2018, pp. 851–858.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
F. Milletari, N. Navab, S.-A. Ahmadi, V-net: Fully convolutional neural networks for volumetric medical image segmentation, in: 2016 Fourth International Conference on 3D Vision (3DV), IEEE, 2016, pp. 565–571.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
L. Yu, X. Yang, H. Chen, J. Qin, P. Heng, Volumetric convnets with mixed residual connections for automated prostate segmentation from 3D MR images, in: AAAI, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Z. Zhou, M. M. R. Siddiquee, N. Tajbakhsh, J. Liang, Unet++: Redesigning skip connections to exploit multiscale features in image segmentation, IEEE Transactions on Medical Imaging 39 (6) (2019) 1856–1867.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
F. Isensee, J. Petersen, A. Klein, D. Zimmerer, P. F. Jaeger, S. Kohl, J. Wasserthal, G. Koehler, T. Norajitra, S. Wirkert, et al., nnu-net: Self-adapting framework for u-net-based medical image segmentation, arXiv preprint arXiv:1809.10486 (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
F. Isensee, P. F. Jaeger, S. A. Kohl, J. Petersen, K. H. Maier-Hein, nnu-net: a self-configuring method for deep learning-based biomedical image segmentation, Nature methods 18 (2) (2021) 203–211.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
L. C. Chu, S. Park, S. Kawamoto, Y. Wang, Y. Zhou, W. Shen, Z. Zhu, Y. Xia, L. Xie, F. Liu, et al., Application of deep learning to pancreatic cancer detection: lessons learned from our initial experience, Journal of the American College of Radiology 16 (9) (2019) 1338–1342.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
J. De Fauw, J. R. Ledsam, B. Romera-Paredes, S. Nikolov, N. Tomasev, S. Blackwell, H. Askham, X. Glorot, B. O’Donoghue, D. Visentin, et al., Clinically applicable deep learning for diagnosis and referral in retinal disease, Nature Medicine 24 (9) (2018) 1342–1350.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
J. Yao, K. Cao, Y. Hou, J. Zhou, Y. Xia, I. Nogues, Q. Song, H. Jiang, X. Ye, J. Lu, et al., Deep learning for fully automated prediction of overall survival in patients undergoing resection for pancreatic cancer: A retrospective multicenter study., Annals of Surgery (2022).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
H. Tang, X. Chen, Y. Liu, Z. Lu, J. You, M. Yang, S. Yao, G. Zhao, Y. Xu, T. Chen, et al., Clinically applicable deep learning framework for organs at risk delineation in ct images, Nature Machine Intelligence 1 (10) (2019) 480–491.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
P. Kickingereder, F. Isensee, I. Tursunova, J. Petersen, U. Neuberger, D. Bonekamp, G. Brugnara, M. Schell, T. Kessler, M. Foltyn, et al., Automated quantitative tumour response assessment of MRI in neuro-oncology with artificial neural networks: a multicentre, retrospective study, The Lancet Oncology 20 (5) (2019) 728–740.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, L. Kaiser, I. Polosukhin, Attention is all you need, Advances in Neural Information Processing Systems 30 (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, et al., An image is worth 16x16 words: Transformers for image recognition at scale, ICLR (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
A. Hatamizadeh, Y. Tang, V. Nath, D. Yang, A. Myronenko, B. Landman, H. R. Roth, D. Xu, Unetr: Transformers for 3d medical image segmentation, in: Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, 2022, pp. 574–584.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
A. Hatamizadeh, V. Nath, Y. Tang, D. Yang, H. R. Roth, D. Xu, Swin unetr: Swin transformers for semantic segmentation of brain tumors in mri images, in: International MICCAI Brainlesion Workshop, Springer, 2022, pp. 272–284.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Y. Tang, D. Yang, W. Li, H. R. Roth, B. Landman, D. Xu, V. Nath, A. Hatamizadeh, Self-supervised pre-training of swin transformers for 3d medical image analysis, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 20730–20740.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
T. Zhou, Y. Zhou, K. He, C. Gong, J. Yang, H. Fu, D. Shen, Cross-level feature aggregation network for polyp segmentation, Pattern Recognition 140 (2023) 109555.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
F. Hörst, M. Rempe, L. Heine, C. Seibold, J. Keyl, G. Baldini, S. Ugurel, J. Siveke, B. Grünwald, J. Egger, J. Kleesiek, <a class="ltx_ref ltx_href" href="https://www.sciencedirect.com/science/article/pii/S1361841524000689" title="">Cellvit: Vision transformers for precise cell segmentation and classification</a>, Medical Image Analysis 94 (2024) 103143.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/https://doi.org/10.1016/j.media.2024.103143" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:https://doi.org/10.1016/j.media.2024.103143</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S1361841524000689" title="">https://www.sciencedirect.com/science/article/pii/S1361841524000689</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao, S. Whitehead, A. C. Berg, W.-Y. Lo, et al., Segment anything, arXiv preprint arXiv:2304.02643 (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
C. C. Aggarwal, <a class="ltx_ref ltx_href" href="https://doi.org/10.1007/978-3-319-47578-3_1" title="">An Introduction to Outlier Analysis</a>, Springer International Publishing, Cham, 2017, pp. 1–34.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1007/978-3-319-47578-3_1" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:10.1007/978-3-319-47578-3_1</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-319-47578-3_1" title="">https://doi.org/10.1007/978-3-319-47578-3_1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
A. Boukerche, L. Zheng, O. Alfandi, Outlier detection: Methods, models, and classification, ACM Computing Surveys (CSUR) 53 (3) (2020) 1–37.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
H. Wang, M. J. Bah, M. Hammad, Progress in outlier detection techniques: A survey, Ieee Access 7 (2019) 107964–108000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
X. Du, Z. Wang, M. Cai, Y. Li, Vos: Learning what you don’t know by virtual outlier synthesis, in: Proceedings of the International Conference on Learning Representations, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
R. He, Z. Han, X. Lu, Y. Yin, Ronf: Reliable outlier synthesis under noisy feature space for out-of-distribution detection (2022) 4242–4251.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
M. Yuan, Y. Xia, H. Dong, Z. Chen, J. Yao, M. Qiu, K. Yan, X. Yin, Y. Shi, X. Chen, Z. Liu, B. Dong, J. Zhou, L. Lu, L. Zhang, L. Zhang, Devil is in the queries: Advancing mask transformers for real-world medical image segmentation and out-of-distribution localization, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), 2023, pp. 23879–23889.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
J. Winkens, R. Bunel, A. G. Roy, R. Stanforth, V. Natarajan, J. R. Ledsam, P. MacWilliams, P. Kohli, A. Karthikesalingam, S. Kohl, et al., Contrastive training for improved out-of-distribution detection, arXiv preprint arXiv:2007.05566 (2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
J. Ren, S. Fort, J. Liu, A. G. Roy, S. Padhy, B. Lakshminarayanan, A simple fix to mahalanobis distance for improving near-ood detection, arXiv preprint arXiv:2106.09022 (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
H. Mirzaei, M. Salehi, S. Shahabi, E. Gavves, C. G. Snoek, M. Sabokrou, M. H. Rohban, Fake it till you make it: Near-distribution novelty detection by score-based generative models, arXiv preprint arXiv:2205.14297 (2022).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
X. Dong, J. Guo, A. Li, W.-T. Ting, C. Liu, H. Kung, Neural mean discrepancy for efficient out-of-distribution detection, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 19217–19227.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
C. Bowles, C. Qin, R. Guerrero, R. Gunn, A. Hammers, D. A. Dickie, M. Valdés Hernández, J. Wardlaw, D. Rueckert, <a class="ltx_ref ltx_href" href="https://www.sciencedirect.com/science/article/pii/S2213158217302164" title="">Brain lesion segmentation through image synthesis and outlier detection</a>, NeuroImage: Clinical 16 (2017) 643–658.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/https://doi.org/10.1016/j.nicl.2017.09.003" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:https://doi.org/10.1016/j.nicl.2017.09.003</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S2213158217302164" title="">https://www.sciencedirect.com/science/article/pii/S2213158217302164</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
V. Thambawita, P. Salehi, S. A. Sheshkal, S. A. Hicks, H. L. Hammer, S. Parasa, T. d. Lange, P. Halvorsen, M. A. Riegler, Singan-seg: Synthetic training data generation for medical image segmentation, PloS one 17 (5) (2022) e0267976.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
D. Nie, D. Shen, <a class="ltx_ref ltx_href" href="https://doi.org/10.1007/s11263-020-01321-2" title="">Adversarial confidence learning for medical image segmentation and synthesis</a>, International Journal of Computer Vision 128 (10) (2020) 2494–2513.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1007/s11263-020-01321-2" title=""><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter">doi:10.1007/s11263-020-01321-2</span></a>.

<br class="ltx_break"/>URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/s11263-020-01321-2" title="">https://doi.org/10.1007/s11263-020-01321-2</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
T.-Y. Lin, P. Goyal, R. Girshick, K. He, P. Dollar, Focal loss for dense object detection, Vol. 42 of 2, 2017, pp. 2999–3007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Y. Tian, M. Shi, Y. Luo, A. Kouhana, T. Elze, M. Wang, Fairseg: A large-scale medical image segmentation dataset for fairness learning using segment anything model with fair error-bound scaling, in: International Conference on Learning Representations (ICLR), 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
R. R. Shamir, Y. Duchin, J. Kim, G. Sapiro, N. Harel, Continuous dice coefficient: a method for evaluating probabilistic segmentations, arXiv preprint arXiv:1906.11031 (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
D. P. Huttenlocher, G. A. Klanderman, W. J. Rucklidge, Comparing images using the hausdorff distance, IEEE Transactions on pattern analysis and machine intelligence 15 (9) (1993) 850–863.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
H. Rezatofighi, N. Tsoi, J. Gwak, A. Sadeghian, I. Reid, S. Savarese, Generalized intersection over union: A metric and a loss for bounding box regression, in: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, 2019, pp. 658–666.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
P. Henderson, V. Ferrari, End-to-end training of object class detectors for mean average precision, in: Computer Vision–ACCV 2016: 13th Asian Conference on Computer Vision, Taipei, Taiwan, November 20-24, 2016, Revised Selected Papers, Part V 13, Springer, 2017, pp. 198–213.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
M. A. Rahman, Y. Wang, Optimizing intersection-over-union in deep neural networks for image segmentation, in: Proceedings of the International Symposium on Visual Computing, Springer, 2016, pp. 234–244.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
O. Sener, V. Koltun, Multi-task learning as multi-objective optimization, in: S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, R. Garnett (Eds.), Advances in Neural Information Processing Systems 31, Curran Associates, Inc., 2018, pp. 525–536.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 25 17:23:12 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
