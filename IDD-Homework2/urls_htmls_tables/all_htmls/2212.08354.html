<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.08354] FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks</title><meta property="og:description" content="Massively multi-task learning with large language models has recently made substantial progress on few-shot generalization.
However, this is usually performed in a centralized learning fashion, ignoring the privacy sen…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.08354">

<!--Generated on Fri Mar  1 10:59:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id1.id1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>: Few-shot Federated Learning Framework across Multiple NLP Tasks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Weilong Dong<sup id="id2.1.id1" class="ltx_sup">1</sup><span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equal contribution.</span></span></span> <span id="footnotex2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Work done while this author was an intern at BtyeDance Lark AI.</span></span></span>, Xinwei Wu<sup id="id3.2.id2" class="ltx_sup">1</sup><span id="footnotex3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equal contribution.</span></span></span> <span id="footnotex4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Work done while this author was an intern at BtyeDance Lark AI.</span></span></span>, Junzhuo Li<sup id="id4.3.id3" class="ltx_sup">2</sup><span id="footnotex5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Work done while this author was an intern at BtyeDance Lark AI.</span></span></span>, 
<br class="ltx_break"><span id="id5.4.id4" class="ltx_text ltx_font_bold">Shuangzhi Wu<sup id="id5.4.id4.1" class="ltx_sup">3</sup>, Chao Bian<sup id="id5.4.id4.2" class="ltx_sup">3</sup>, Deyi Xiong<sup id="id5.4.id4.3" class="ltx_sup">1</sup><sup id="id5.4.id4.4" class="ltx_sup">2</sup> <span id="footnotex6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex6.1.1.1" class="ltx_text ltx_font_medium">1</span></span>Corresponding author.</span></span></span>
<br class="ltx_break"><sup id="id5.4.id4.5" class="ltx_sup">1</sup>College of Intelligence and Computing, Tianjin University, Tianjin, China 
<br class="ltx_break"><sup id="id5.4.id4.6" class="ltx_sup">2</sup>School of New Media and Communication, Tianjin University, Tianjin, China 
<br class="ltx_break"><sup id="id5.4.id4.7" class="ltx_sup">3</sup>ByteDance Lark AI, Beijing, China 
<br class="ltx_break"></span><span id="id6.5.id5" class="ltx_text ltx_font_typewriter">{willowd, wuxw2021, jzli, dyxiong}@tju.edu.cn,</span><span id="id7.6.id6" class="ltx_text ltx_font_bold"> 
<br class="ltx_break"></span><span id="id8.7.id7" class="ltx_text ltx_font_typewriter">wufurui@bytedance.com, chaobian@outlook.com
</span><span id="id9.8.id8" class="ltx_text ltx_font_bold">
</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">Massively multi-task learning with large language models has recently made substantial progress on few-shot generalization.
However, this is usually performed in a centralized learning fashion, ignoring the privacy sensitivity issue of (annotated) data used in multiple tasks.
To mitigate this issue, we propose <span id="id10.id1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>, a few-shot federated learning framework across multiple tasks, to achieve the best of both worlds: privacy preservation and cross-task generalization.
<span id="id10.id1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> trains client models in isolated devices without sharing data.
It broadcasts the global model in the server to each client and produces pseudo data for clients so that knowledge from the global model can be explored to enhance few-shot learning of each client model.
An energy-based algorithm is further proposed to weight pseudo samples in order to reduce the negative impact of noise from the generated pseudo data.
Adaptive model weights of client models are also tuned according to their performance.
We use these model weights to dynamically aggregate client models to update the global model.
Experiments on 118 NLP tasks show that <span id="id10.id1.3" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> can significantly improve the performance of client models on 61% tasks with an average performance improvement rate of 30.5% over the baseline and substantially outperform FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> and other decentralized learning methods.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Large language models <cite class="ltx_cite ltx_citemacro_citep">(Brown <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2021b</a>)</cite> (LLMs) are capable of performing few-shot learning on downstream tasks, where a small number of annotated instances are provided to teach the model a new task <cite class="ltx_cite ltx_citemacro_citep">(Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2021b</a>, <a href="#bib.bib22" title="" class="ltx_ref">c</a>; Du <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite>.
Significant interest has recently emerged on transforming a wide array of downstream tasks into a unified form, e.g., human-readable prompts or instructions <cite class="ltx_cite ltx_citemacro_cite">Sanh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>); Wei <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>, and continuing to train/finetune LLMs on the transformed data so as to endow LLMs with few/zero-shot task generalization <cite class="ltx_cite ltx_citemacro_citep">(Sun <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2021</a>; Ye <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>; Xu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>.
The goal of such efforts might be towards general linguistic intelligence that can reuse previously acquired linguistic knowledge and adapt to a new task quickly <cite class="ltx_cite ltx_citemacro_citep">(Yogatama <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2019</a>)</cite>.
Intuitively and empirically, cross-task generalization benefits from massive and diversified downstream tasks <cite class="ltx_cite ltx_citemacro_cite">Sanh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>); Wei <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, in real-world scenarios, the data of different tasks are usually distributed across isolated clients (e.g., devices, users or institutions) and privacy-sensitive.
Local private data are not legally allowed to leave their owners/clients by law, e.g., EU GDPR <cite class="ltx_cite ltx_citemacro_cite">Voigt and Von dem Bussche (<a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite>.
Owing to privacy risk or legality, collecting sufficient multi-task data for centralized training becomes difficult.
To address this issue, Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2016</a>; McMahan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> is proposed, where each client participates in a training process without sharing private data with other clients.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2212.08354/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="438" height="203" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Isolated multi-task data in local devices.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, our key interest is to combine federated learning with multi-task learning in the few-shot setting, where each client owns a small amount of private data (illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), in the goal of achieving the best of both worlds: cross-task generalization and data privacy.
This scenario is pervasive, for example, different hospitals own a small number of annotated privacy-sensitive examples on different tasks (e.g., medical QA, named entity recognition or relation extraction over electronic health records (EHR), EHR summarization, medical image captioning).
The challenges of this few-shot federated learning across multiple tasks are at least two-fold: (1) teaching models to few-shot learn and (2) sharing cross-task knowledge across clients without sharing private data.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To deal with the aforementioned research questions, we propose a weighted few-shot federated learning framework (<span id="S1.p4.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>) for massive tasks to harness LLM-based few-shot learning with federated learning.
Specifically, we construct a global model at the server, which aggregates information from client models located in each client and facilitates knowledge transfer across clients and tasks.
In order to few-shot learn efficiently in each client, we use the global model to produce pseudo labeled data for each client model.
To reduce the negative impact from noise in the generated pseudo data, we further propose an energy-based algorithm to weight the generated examples.
In order to aggregate the trained client models into the global model, we introduce a dynamic aggregation method, which estimates the weights of client models according to the performance of the corresponding client model on the pseudo examples generated by the global model and the annotated examples.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The main contributions of our work are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a federated learning framework for multi-task learning in the few-shot and private setting, which is equipped with two components: an energy-based weighting algorithm for updating the weights of pseudo examples generated by the global model and a dynamic aggregation method based on the performance of client models.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We conduct experiments on 118 open-source tasks to evaluate the proposed <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> framework. To the best of our knowledge, this is the first attempt to perform federated learning on massive NLP tasks.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Experiments demonstrate that (1) <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> significantly outperforms the classic federated learning FedAVG, the personalized federated learning Ditto <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, centralized training, data silo data augmentation and meta weighting based data augmentation and (2) the client models trained by <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> gain 30.5% over the original model and they can generalize well cross multiple tasks.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary: Federated Learning</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2212.08354/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="192" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The diagram of <span id="S2.F2.2.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.4" class="ltx_p">In federated learning, each client has its own private data which are not shared during training. Let <math id="S2.p1.1.m1.4" class="ltx_Math" alttext="\mathbb{U}=\{u_{1},u_{2},...,u_{K}\}" display="inline"><semantics id="S2.p1.1.m1.4a"><mrow id="S2.p1.1.m1.4.4" xref="S2.p1.1.m1.4.4.cmml"><mi id="S2.p1.1.m1.4.4.5" xref="S2.p1.1.m1.4.4.5.cmml">𝕌</mi><mo id="S2.p1.1.m1.4.4.4" xref="S2.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.p1.1.m1.4.4.3.3" xref="S2.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S2.p1.1.m1.4.4.3.3.4" xref="S2.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.p1.1.m1.2.2.1.1.1" xref="S2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.p1.1.m1.2.2.1.1.1.2" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml">u</mi><mn id="S2.p1.1.m1.2.2.1.1.1.3" xref="S2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.5" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.3.3.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.p1.1.m1.3.3.2.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.2.cmml">u</mi><mn id="S2.p1.1.m1.3.3.2.2.2.3" xref="S2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.6" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">…</mi><mo id="S2.p1.1.m1.4.4.3.3.7" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.4.4.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.p1.1.m1.4.4.3.3.3.2" xref="S2.p1.1.m1.4.4.3.3.3.2.cmml">u</mi><mi id="S2.p1.1.m1.4.4.3.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.3.cmml">K</mi></msub><mo stretchy="false" id="S2.p1.1.m1.4.4.3.3.8" xref="S2.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.4b"><apply id="S2.p1.1.m1.4.4.cmml" xref="S2.p1.1.m1.4.4"><eq id="S2.p1.1.m1.4.4.4.cmml" xref="S2.p1.1.m1.4.4.4"></eq><ci id="S2.p1.1.m1.4.4.5.cmml" xref="S2.p1.1.m1.4.4.5">𝕌</ci><set id="S2.p1.1.m1.4.4.3.4.cmml" xref="S2.p1.1.m1.4.4.3.3"><apply id="S2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.1.2">𝑢</ci><cn type="integer" id="S2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2.2">𝑢</ci><cn type="integer" id="S2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">…</ci><apply id="S2.p1.1.m1.4.4.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.p1.1.m1.4.4.3.3.3.2">𝑢</ci><ci id="S2.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.4c">\mathbb{U}=\{u_{1},u_{2},...,u_{K}\}</annotation></semantics></math> be a set of clients, where <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">K</annotation></semantics></math> is the number of clients. Apart from the clients, there is a central server. The server initializes a global model, sends the global model to a subset of clients for updating and aggregates the updated client models into the global model. We denote the server as <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{S}</annotation></semantics></math>. In the classic FL framework FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite>, <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\mathcal{S}</annotation></semantics></math> aggregates the client models as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\bm{F}_{\text{global}}=\sum_{i=1}^{N}\bm{\delta}_{i}\cdot\bm{F}_{i}," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml">𝑭</mi><mtext id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3a.cmml">global</mtext></msub><mo rspace="0.111em" id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><munderover id="S2.E1.m1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.1.1.1.1.3.1.2.2" xref="S2.E1.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.1.1.1.1.3.1.2.3" xref="S2.E1.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.1.2.3.2" xref="S2.E1.m1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.3.1.2.3.1" xref="S2.E1.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.1.1.1.1.3.1.2.3.3" xref="S2.E1.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.1.1.1.1.3.1.3" xref="S2.E1.m1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml"><msub id="S2.E1.m1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.2.cmml">𝜹</mi><mi id="S2.E1.m1.1.1.1.1.3.2.2.3" xref="S2.E1.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.1.1.1.1.3.2.1" xref="S2.E1.m1.1.1.1.1.3.2.1.cmml">⋅</mo><msub id="S2.E1.m1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.3.2" xref="S2.E1.m1.1.1.1.1.3.2.3.2.cmml">𝑭</mi><mi id="S2.E1.m1.1.1.1.1.3.2.3.3" xref="S2.E1.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"></eq><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2">𝑭</ci><ci id="S2.E1.m1.1.1.1.1.2.3a.cmml" xref="S2.E1.m1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.E1.m1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3">global</mtext></ci></apply><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><apply id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.3.1.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3"><eq id="S2.E1.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.E1.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.1.1.1.1.3.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2"><ci id="S2.E1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.1">⋅</ci><apply id="S2.E1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.2">𝜹</ci><ci id="S2.E1.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.2">𝑭</ci><ci id="S2.E1.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\bm{F}_{\text{global}}=\sum_{i=1}^{N}\bm{\delta}_{i}\cdot\bm{F}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.13" class="ltx_p">where <math id="S2.p1.5.m1.1" class="ltx_Math" alttext="\bm{F}_{\text{global}}" display="inline"><semantics id="S2.p1.5.m1.1a"><msub id="S2.p1.5.m1.1.1" xref="S2.p1.5.m1.1.1.cmml"><mi id="S2.p1.5.m1.1.1.2" xref="S2.p1.5.m1.1.1.2.cmml">𝑭</mi><mtext id="S2.p1.5.m1.1.1.3" xref="S2.p1.5.m1.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p1.5.m1.1b"><apply id="S2.p1.5.m1.1.1.cmml" xref="S2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m1.1.1.1.cmml" xref="S2.p1.5.m1.1.1">subscript</csymbol><ci id="S2.p1.5.m1.1.1.2.cmml" xref="S2.p1.5.m1.1.1.2">𝑭</ci><ci id="S2.p1.5.m1.1.1.3a.cmml" xref="S2.p1.5.m1.1.1.3"><mtext mathsize="70%" id="S2.p1.5.m1.1.1.3.cmml" xref="S2.p1.5.m1.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m1.1c">\bm{F}_{\text{global}}</annotation></semantics></math> is the aggregated global model, <math id="S2.p1.6.m2.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="S2.p1.6.m2.1a"><msub id="S2.p1.6.m2.1.1" xref="S2.p1.6.m2.1.1.cmml"><mi id="S2.p1.6.m2.1.1.2" xref="S2.p1.6.m2.1.1.2.cmml">𝑭</mi><mi id="S2.p1.6.m2.1.1.3" xref="S2.p1.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m2.1b"><apply id="S2.p1.6.m2.1.1.cmml" xref="S2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m2.1.1.1.cmml" xref="S2.p1.6.m2.1.1">subscript</csymbol><ci id="S2.p1.6.m2.1.1.2.cmml" xref="S2.p1.6.m2.1.1.2">𝑭</ci><ci id="S2.p1.6.m2.1.1.3.cmml" xref="S2.p1.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m2.1c">\bm{F}_{i}</annotation></semantics></math> is the local model on client <math id="S2.p1.7.m3.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S2.p1.7.m3.1a"><msub id="S2.p1.7.m3.1.1" xref="S2.p1.7.m3.1.1.cmml"><mi id="S2.p1.7.m3.1.1.2" xref="S2.p1.7.m3.1.1.2.cmml">u</mi><mi id="S2.p1.7.m3.1.1.3" xref="S2.p1.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m3.1b"><apply id="S2.p1.7.m3.1.1.cmml" xref="S2.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m3.1.1.1.cmml" xref="S2.p1.7.m3.1.1">subscript</csymbol><ci id="S2.p1.7.m3.1.1.2.cmml" xref="S2.p1.7.m3.1.1.2">𝑢</ci><ci id="S2.p1.7.m3.1.1.3.cmml" xref="S2.p1.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m3.1c">u_{i}</annotation></semantics></math> and <math id="S2.p1.8.m4.1" class="ltx_Math" alttext="\bm{\delta}_{i}" display="inline"><semantics id="S2.p1.8.m4.1a"><msub id="S2.p1.8.m4.1.1" xref="S2.p1.8.m4.1.1.cmml"><mi id="S2.p1.8.m4.1.1.2" xref="S2.p1.8.m4.1.1.2.cmml">𝜹</mi><mi id="S2.p1.8.m4.1.1.3" xref="S2.p1.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.8.m4.1b"><apply id="S2.p1.8.m4.1.1.cmml" xref="S2.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m4.1.1.1.cmml" xref="S2.p1.8.m4.1.1">subscript</csymbol><ci id="S2.p1.8.m4.1.1.2.cmml" xref="S2.p1.8.m4.1.1.2">𝜹</ci><ci id="S2.p1.8.m4.1.1.3.cmml" xref="S2.p1.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m4.1c">\bm{\delta}_{i}</annotation></semantics></math> is the model weight for <math id="S2.p1.9.m5.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="S2.p1.9.m5.1a"><msub id="S2.p1.9.m5.1.1" xref="S2.p1.9.m5.1.1.cmml"><mi id="S2.p1.9.m5.1.1.2" xref="S2.p1.9.m5.1.1.2.cmml">𝑭</mi><mi id="S2.p1.9.m5.1.1.3" xref="S2.p1.9.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.9.m5.1b"><apply id="S2.p1.9.m5.1.1.cmml" xref="S2.p1.9.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m5.1.1.1.cmml" xref="S2.p1.9.m5.1.1">subscript</csymbol><ci id="S2.p1.9.m5.1.1.2.cmml" xref="S2.p1.9.m5.1.1.2">𝑭</ci><ci id="S2.p1.9.m5.1.1.3.cmml" xref="S2.p1.9.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m5.1c">\bm{F}_{i}</annotation></semantics></math>. In FedAvg, the model weight <math id="S2.p1.10.m6.1" class="ltx_Math" alttext="\bm{\delta}" display="inline"><semantics id="S2.p1.10.m6.1a"><mi id="S2.p1.10.m6.1.1" xref="S2.p1.10.m6.1.1.cmml">𝜹</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m6.1b"><ci id="S2.p1.10.m6.1.1.cmml" xref="S2.p1.10.m6.1.1">𝜹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m6.1c">\bm{\delta}</annotation></semantics></math> is estimated according to the amount of data on each client, which is computed as <math id="S2.p1.11.m7.1" class="ltx_Math" alttext="\bm{\delta}_{j}=\frac{n_{j}}{\sum_{j=1}^{K}n_{j}}" display="inline"><semantics id="S2.p1.11.m7.1a"><mrow id="S2.p1.11.m7.1.1" xref="S2.p1.11.m7.1.1.cmml"><msub id="S2.p1.11.m7.1.1.2" xref="S2.p1.11.m7.1.1.2.cmml"><mi id="S2.p1.11.m7.1.1.2.2" xref="S2.p1.11.m7.1.1.2.2.cmml">𝜹</mi><mi id="S2.p1.11.m7.1.1.2.3" xref="S2.p1.11.m7.1.1.2.3.cmml">j</mi></msub><mo id="S2.p1.11.m7.1.1.1" xref="S2.p1.11.m7.1.1.1.cmml">=</mo><mfrac id="S2.p1.11.m7.1.1.3" xref="S2.p1.11.m7.1.1.3.cmml"><msub id="S2.p1.11.m7.1.1.3.2" xref="S2.p1.11.m7.1.1.3.2.cmml"><mi id="S2.p1.11.m7.1.1.3.2.2" xref="S2.p1.11.m7.1.1.3.2.2.cmml">n</mi><mi id="S2.p1.11.m7.1.1.3.2.3" xref="S2.p1.11.m7.1.1.3.2.3.cmml">j</mi></msub><mrow id="S2.p1.11.m7.1.1.3.3" xref="S2.p1.11.m7.1.1.3.3.cmml"><mstyle displaystyle="false" id="S2.p1.11.m7.1.1.3.3.1" xref="S2.p1.11.m7.1.1.3.3.1.cmml"><msubsup id="S2.p1.11.m7.1.1.3.3.1a" xref="S2.p1.11.m7.1.1.3.3.1.cmml"><mo id="S2.p1.11.m7.1.1.3.3.1.2.2" xref="S2.p1.11.m7.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.p1.11.m7.1.1.3.3.1.2.3" xref="S2.p1.11.m7.1.1.3.3.1.2.3.cmml"><mi id="S2.p1.11.m7.1.1.3.3.1.2.3.2" xref="S2.p1.11.m7.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S2.p1.11.m7.1.1.3.3.1.2.3.1" xref="S2.p1.11.m7.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.p1.11.m7.1.1.3.3.1.2.3.3" xref="S2.p1.11.m7.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.11.m7.1.1.3.3.1.3" xref="S2.p1.11.m7.1.1.3.3.1.3.cmml">K</mi></msubsup></mstyle><msub id="S2.p1.11.m7.1.1.3.3.2" xref="S2.p1.11.m7.1.1.3.3.2.cmml"><mi id="S2.p1.11.m7.1.1.3.3.2.2" xref="S2.p1.11.m7.1.1.3.3.2.2.cmml">n</mi><mi id="S2.p1.11.m7.1.1.3.3.2.3" xref="S2.p1.11.m7.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m7.1b"><apply id="S2.p1.11.m7.1.1.cmml" xref="S2.p1.11.m7.1.1"><eq id="S2.p1.11.m7.1.1.1.cmml" xref="S2.p1.11.m7.1.1.1"></eq><apply id="S2.p1.11.m7.1.1.2.cmml" xref="S2.p1.11.m7.1.1.2"><csymbol cd="ambiguous" id="S2.p1.11.m7.1.1.2.1.cmml" xref="S2.p1.11.m7.1.1.2">subscript</csymbol><ci id="S2.p1.11.m7.1.1.2.2.cmml" xref="S2.p1.11.m7.1.1.2.2">𝜹</ci><ci id="S2.p1.11.m7.1.1.2.3.cmml" xref="S2.p1.11.m7.1.1.2.3">𝑗</ci></apply><apply id="S2.p1.11.m7.1.1.3.cmml" xref="S2.p1.11.m7.1.1.3"><divide id="S2.p1.11.m7.1.1.3.1.cmml" xref="S2.p1.11.m7.1.1.3"></divide><apply id="S2.p1.11.m7.1.1.3.2.cmml" xref="S2.p1.11.m7.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.11.m7.1.1.3.2.1.cmml" xref="S2.p1.11.m7.1.1.3.2">subscript</csymbol><ci id="S2.p1.11.m7.1.1.3.2.2.cmml" xref="S2.p1.11.m7.1.1.3.2.2">𝑛</ci><ci id="S2.p1.11.m7.1.1.3.2.3.cmml" xref="S2.p1.11.m7.1.1.3.2.3">𝑗</ci></apply><apply id="S2.p1.11.m7.1.1.3.3.cmml" xref="S2.p1.11.m7.1.1.3.3"><apply id="S2.p1.11.m7.1.1.3.3.1.cmml" xref="S2.p1.11.m7.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.p1.11.m7.1.1.3.3.1.1.cmml" xref="S2.p1.11.m7.1.1.3.3.1">superscript</csymbol><apply id="S2.p1.11.m7.1.1.3.3.1.2.cmml" xref="S2.p1.11.m7.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.p1.11.m7.1.1.3.3.1.2.1.cmml" xref="S2.p1.11.m7.1.1.3.3.1">subscript</csymbol><sum id="S2.p1.11.m7.1.1.3.3.1.2.2.cmml" xref="S2.p1.11.m7.1.1.3.3.1.2.2"></sum><apply id="S2.p1.11.m7.1.1.3.3.1.2.3.cmml" xref="S2.p1.11.m7.1.1.3.3.1.2.3"><eq id="S2.p1.11.m7.1.1.3.3.1.2.3.1.cmml" xref="S2.p1.11.m7.1.1.3.3.1.2.3.1"></eq><ci id="S2.p1.11.m7.1.1.3.3.1.2.3.2.cmml" xref="S2.p1.11.m7.1.1.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S2.p1.11.m7.1.1.3.3.1.2.3.3.cmml" xref="S2.p1.11.m7.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.p1.11.m7.1.1.3.3.1.3.cmml" xref="S2.p1.11.m7.1.1.3.3.1.3">𝐾</ci></apply><apply id="S2.p1.11.m7.1.1.3.3.2.cmml" xref="S2.p1.11.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p1.11.m7.1.1.3.3.2.1.cmml" xref="S2.p1.11.m7.1.1.3.3.2">subscript</csymbol><ci id="S2.p1.11.m7.1.1.3.3.2.2.cmml" xref="S2.p1.11.m7.1.1.3.3.2.2">𝑛</ci><ci id="S2.p1.11.m7.1.1.3.3.2.3.cmml" xref="S2.p1.11.m7.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m7.1c">\bm{\delta}_{j}=\frac{n_{j}}{\sum_{j=1}^{K}n_{j}}</annotation></semantics></math>, where <math id="S2.p1.12.m8.1" class="ltx_Math" alttext="n_{j}" display="inline"><semantics id="S2.p1.12.m8.1a"><msub id="S2.p1.12.m8.1.1" xref="S2.p1.12.m8.1.1.cmml"><mi id="S2.p1.12.m8.1.1.2" xref="S2.p1.12.m8.1.1.2.cmml">n</mi><mi id="S2.p1.12.m8.1.1.3" xref="S2.p1.12.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.12.m8.1b"><apply id="S2.p1.12.m8.1.1.cmml" xref="S2.p1.12.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m8.1.1.1.cmml" xref="S2.p1.12.m8.1.1">subscript</csymbol><ci id="S2.p1.12.m8.1.1.2.cmml" xref="S2.p1.12.m8.1.1.2">𝑛</ci><ci id="S2.p1.12.m8.1.1.3.cmml" xref="S2.p1.12.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m8.1c">n_{j}</annotation></semantics></math> is the number of training samples on <math id="S2.p1.13.m9.1" class="ltx_Math" alttext="u_{j}" display="inline"><semantics id="S2.p1.13.m9.1a"><msub id="S2.p1.13.m9.1.1" xref="S2.p1.13.m9.1.1.cmml"><mi id="S2.p1.13.m9.1.1.2" xref="S2.p1.13.m9.1.1.2.cmml">u</mi><mi id="S2.p1.13.m9.1.1.3" xref="S2.p1.13.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.13.m9.1b"><apply id="S2.p1.13.m9.1.1.cmml" xref="S2.p1.13.m9.1.1"><csymbol cd="ambiguous" id="S2.p1.13.m9.1.1.1.cmml" xref="S2.p1.13.m9.1.1">subscript</csymbol><ci id="S2.p1.13.m9.1.1.2.cmml" xref="S2.p1.13.m9.1.1.2">𝑢</ci><ci id="S2.p1.13.m9.1.1.3.cmml" xref="S2.p1.13.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m9.1c">u_{j}</annotation></semantics></math>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p">In addition to the global federated learning methods, prior works <cite class="ltx_cite ltx_citemacro_citep">(Smith <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2017</a>; Marfoq <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> have explored personalized federated learning (PFL) for multi-task learning. In PFL, all clients jointly train a global model, but each client can built its own personalized client model by interpolating the global model and its client model. During training, a personalized client model is able to exploit information of other clients from the global model without sharing their data. A common method in PFL is to add a regularization term in the loss function. Specifically, the loss of each client model is computed as <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{i}=\hat{\mathcal{L}}_{i}+||\bm{F}_{\text{global}}-\bm{F}_{i}||^{2}" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">ℒ</mi><mi id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml">i</mi></msub><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.3.cmml"><mover accent="true" id="S2.p2.1.m1.1.1.1.3.2" xref="S2.p2.1.m1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.3.2.2" xref="S2.p2.1.m1.1.1.1.3.2.2.cmml">ℒ</mi><mo id="S2.p2.1.m1.1.1.1.3.2.1" xref="S2.p2.1.m1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.p2.1.m1.1.1.1.3.3" xref="S2.p2.1.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.p2.1.m1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.2.cmml">+</mo><msup id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml"><mrow id="S2.p2.1.m1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.1.m1.1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.p2.1.m1.1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml">𝑭</mi><mtext id="S2.p2.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.3a.cmml">global</mtext></msub><mo id="S2.p2.1.m1.1.1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.p2.1.m1.1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.3.2" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml">𝑭</mi><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.3.3" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.p2.1.m1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.p2.1.m1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><eq id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2"></eq><apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.p2.1.m1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.3.2">ℒ</ci><ci id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"><plus id="S2.p2.1.m1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.2"></plus><apply id="S2.p2.1.m1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.1.3">subscript</csymbol><apply id="S2.p2.1.m1.1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.1.3.2"><ci id="S2.p2.1.m1.1.1.1.3.2.1.cmml" xref="S2.p2.1.m1.1.1.1.3.2.1">^</ci><ci id="S2.p2.1.m1.1.1.1.3.2.2.cmml" xref="S2.p2.1.m1.1.1.1.3.2.2">ℒ</ci></apply><ci id="S2.p2.1.m1.1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1">superscript</csymbol><apply id="S2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1"><minus id="S2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1"></minus><apply id="S2.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.2">𝑭</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.3">global</mtext></ci></apply><apply id="S2.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.2">𝑭</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S2.p2.1.m1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{L}_{i}=\hat{\mathcal{L}}_{i}+||\bm{F}_{\text{global}}-\bm{F}_{i}||^{2}</annotation></semantics></math>, where <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\hat{\mathcal{L}}_{i}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mover accent="true" id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1.2.2" xref="S2.p2.2.m2.1.1.2.2.cmml">ℒ</mi><mo id="S2.p2.2.m2.1.1.2.1" xref="S2.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><apply id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2"><ci id="S2.p2.2.m2.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1.2.1">^</ci><ci id="S2.p2.2.m2.1.1.2.2.cmml" xref="S2.p2.2.m2.1.1.2.2">ℒ</ci></apply><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\hat{\mathcal{L}}_{i}</annotation></semantics></math> is the original loss on <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">u</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑢</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">u_{i}</annotation></semantics></math>. We choose this PFL setting in our work for tackling different tasks.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we introduce our proposed <span id="S3.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> for few-shot federated learning across multiple tasks. The architecture of our module is illustrated in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Preliminary: Federated Learning ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We first overview <span id="S3.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> (§<a href="#S3.SS1" title="3.1 Overview ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>) and then elaborate the two essential components in our framework: data augmentation with energy-based sample weighting (§<a href="#S3.SS2" title="3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>) and dynamic model aggregation (§<a href="#S3.SS3" title="3.3 Dynamic Aggregation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.4" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Overview ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> formalizes the entire flow of <span id="S3.SS1.p1.4.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>. We denote the training data as <math id="S3.SS1.p1.1.m1.7" class="ltx_Math" alttext="\{(\bm{X},\bm{Y})\},\bm{X}=\{\bm{X}_{1},...,\bm{X}_{K}\},\bm{Y}=\{\bm{Y}_{1},...,\bm{Y}_{K}\}" display="inline"><semantics id="S3.SS1.p1.1.m1.7a"><mrow id="S3.SS1.p1.1.m1.7.7.2" xref="S3.SS1.p1.1.m1.7.7.3.cmml"><mrow id="S3.SS1.p1.1.m1.6.6.1.1" xref="S3.SS1.p1.1.m1.6.6.1.1.cmml"><mrow id="S3.SS1.p1.1.m1.6.6.1.1.1.1" xref="S3.SS1.p1.1.m1.6.6.1.1.1.2.cmml"><mrow id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝑿</mi><mo id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">𝒀</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.SS1.p1.1.m1.6.6.1.1.1.1.2" xref="S3.SS1.p1.1.m1.6.6.1.1.1.2.cmml">,</mo><mi id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml">𝑿</mi></mrow><mo id="S3.SS1.p1.1.m1.6.6.1.1.4" xref="S3.SS1.p1.1.m1.6.6.1.1.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.6.6.1.1.3.2" xref="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.3.2.3" xref="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml">{</mo><msub id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.cmml"><mi id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.2" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.2.cmml">𝑿</mi><mn id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.3" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.6.6.1.1.3.2.4" xref="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">…</mi><mo id="S3.SS1.p1.1.m1.6.6.1.1.3.2.5" xref="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.cmml"><mi id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.2" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.2.cmml">𝑿</mi><mi id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.3" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.6.6.1.1.3.2.6" xref="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml">}</mo></mrow></mrow><mo id="S3.SS1.p1.1.m1.7.7.2.3" xref="S3.SS1.p1.1.m1.7.7.3a.cmml">,</mo><mrow id="S3.SS1.p1.1.m1.7.7.2.2" xref="S3.SS1.p1.1.m1.7.7.2.2.cmml"><mi id="S3.SS1.p1.1.m1.7.7.2.2.4" xref="S3.SS1.p1.1.m1.7.7.2.2.4.cmml">𝒀</mi><mo id="S3.SS1.p1.1.m1.7.7.2.2.3" xref="S3.SS1.p1.1.m1.7.7.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.7.7.2.2.2.2" xref="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.7.7.2.2.2.2.3" xref="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.2.cmml">𝒀</mi><mn id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.7.7.2.2.2.2.4" xref="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml">…</mi><mo id="S3.SS1.p1.1.m1.7.7.2.2.2.2.5" xref="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.2.cmml">𝒀</mi><mi id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.7.7.2.2.2.2.6" xref="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.7b"><apply id="S3.SS1.p1.1.m1.7.7.3.cmml" xref="S3.SS1.p1.1.m1.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.7.7.3a.cmml" xref="S3.SS1.p1.1.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.1.m1.6.6.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1"><eq id="S3.SS1.p1.1.m1.6.6.1.1.4.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.4"></eq><list id="S3.SS1.p1.1.m1.6.6.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1"><set id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1"><interval closure="open" id="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.1.1.1.1.1.2"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑿</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝒀</ci></interval></set><ci id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4">𝑿</ci></list><set id="S3.SS1.p1.1.m1.6.6.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2"><apply id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.2">𝑿</ci><cn type="integer" id="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.3.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">…</ci><apply id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.2">𝑿</ci><ci id="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.1.m1.6.6.1.1.3.2.2.3">𝐾</ci></apply></set></apply><apply id="S3.SS1.p1.1.m1.7.7.2.2.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2"><eq id="S3.SS1.p1.1.m1.7.7.2.2.3.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.3"></eq><ci id="S3.SS1.p1.1.m1.7.7.2.2.4.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.4">𝒀</ci><set id="S3.SS1.p1.1.m1.7.7.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2"><apply id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.2">𝒀</ci><cn type="integer" id="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5">…</ci><apply id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.2">𝒀</ci><ci id="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.7.7.2.2.2.2.2.3">𝐾</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.7c">\{(\bm{X},\bm{Y})\},\bm{X}=\{\bm{X}_{1},...,\bm{X}_{K}\},\bm{Y}=\{\bm{Y}_{1},...,\bm{Y}_{K}\}</annotation></semantics></math>, where <math id="S3.SS1.p1.2.m2.1" class="ltx_math_unparsed" alttext="(\bm{X}_{i}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1b"><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1">(</mo><msub id="S3.SS1.p1.2.m2.1.2"><mi id="S3.SS1.p1.2.m2.1.2.2">𝑿</mi><mi id="S3.SS1.p1.2.m2.1.2.3">i</mi></msub></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">(\bm{X}_{i}</annotation></semantics></math>, <math id="S3.SS1.p1.3.m3.1" class="ltx_math_unparsed" alttext="\bm{Y}_{i})" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1b"><msub id="S3.SS1.p1.3.m3.1.1"><mi id="S3.SS1.p1.3.m3.1.1.2">𝒀</mi><mi id="S3.SS1.p1.3.m3.1.1.3">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\bm{Y}_{i})</annotation></semantics></math> is the training data on client <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑢</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">u_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p">At the beginning, the server <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{S}</annotation></semantics></math> uses a pre-trained language model as the initial global model <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\bm{F}^{(0)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msubsup id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.2.2" xref="S3.SS1.p2.2.m2.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p2.2.m2.1.2.3" xref="S3.SS1.p2.2.m2.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p2.2.m2.1.1.1.3" xref="S3.SS1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.3.1" xref="S3.SS1.p2.2.m2.1.2.cmml">(</mo><mn id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.3.2" xref="S3.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2">subscript</csymbol><apply id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2.2">𝑭</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">0</cn></apply><ci id="S3.SS1.p2.2.m2.1.2.3a.cmml" xref="S3.SS1.p2.2.m2.1.2.3"><mtext mathsize="70%" id="S3.SS1.p2.2.m2.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\bm{F}^{(0)}_{\text{global}}</annotation></semantics></math> and defines the number of training epochs <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">T</annotation></semantics></math>. <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathcal{S}</annotation></semantics></math> broadcasts <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\bm{F}^{(0)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msubsup id="S3.SS1.p2.5.m5.1.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><mi id="S3.SS1.p2.5.m5.1.2.2.2" xref="S3.SS1.p2.5.m5.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p2.5.m5.1.2.3" xref="S3.SS1.p2.5.m5.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p2.5.m5.1.1.1.3" xref="S3.SS1.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.1" xref="S3.SS1.p2.5.m5.1.2.cmml">(</mo><mn id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.2" xref="S3.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2">subscript</csymbol><apply id="S3.SS1.p2.5.m5.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.2.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2.2">𝑭</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">0</cn></apply><ci id="S3.SS1.p2.5.m5.1.2.3a.cmml" xref="S3.SS1.p2.5.m5.1.2.3"><mtext mathsize="70%" id="S3.SS1.p2.5.m5.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\bm{F}^{(0)}_{\text{global}}</annotation></semantics></math> to each client and the initial client model <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\bm{F}_{i}^{(0)}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msubsup id="S3.SS1.p2.6.m6.1.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.2.2.2" xref="S3.SS1.p2.6.m6.1.2.2.2.cmml">𝑭</mi><mi id="S3.SS1.p2.6.m6.1.2.2.3" xref="S3.SS1.p2.6.m6.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p2.6.m6.1.1.1.3" xref="S3.SS1.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.3.1" xref="S3.SS1.p2.6.m6.1.2.cmml">(</mo><mn id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.3.2" xref="S3.SS1.p2.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2">superscript</csymbol><apply id="S3.SS1.p2.6.m6.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.2.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2.2">𝑭</ci><ci id="S3.SS1.p2.6.m6.1.2.2.3.cmml" xref="S3.SS1.p2.6.m6.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\bm{F}_{i}^{(0)}</annotation></semantics></math> on <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">u</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑢</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">u_{i}</annotation></semantics></math> is initialized as <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="\bm{F}^{(0)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msubsup id="S3.SS1.p2.8.m8.1.2" xref="S3.SS1.p2.8.m8.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.2.2.2" xref="S3.SS1.p2.8.m8.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p2.8.m8.1.2.3" xref="S3.SS1.p2.8.m8.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p2.8.m8.1.1.1.3" xref="S3.SS1.p2.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.8.m8.1.1.1.3.1" xref="S3.SS1.p2.8.m8.1.2.cmml">(</mo><mn id="S3.SS1.p2.8.m8.1.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS1.p2.8.m8.1.1.1.3.2" xref="S3.SS1.p2.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.2.cmml" xref="S3.SS1.p2.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.2">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.2.2.1.cmml" xref="S3.SS1.p2.8.m8.1.2">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.2.2.2.cmml" xref="S3.SS1.p2.8.m8.1.2.2.2">𝑭</ci><cn type="integer" id="S3.SS1.p2.8.m8.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1">0</cn></apply><ci id="S3.SS1.p2.8.m8.1.2.3a.cmml" xref="S3.SS1.p2.8.m8.1.2.3"><mtext mathsize="70%" id="S3.SS1.p2.8.m8.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\bm{F}^{(0)}_{\text{global}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.17" class="ltx_p">In the <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">t</annotation></semantics></math>-th training epoch, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathcal{S}</annotation></semantics></math> sends <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\bm{F}^{(t)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msubsup id="S3.SS1.p3.3.m3.1.2" xref="S3.SS1.p3.3.m3.1.2.cmml"><mi id="S3.SS1.p3.3.m3.1.2.2.2" xref="S3.SS1.p3.3.m3.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p3.3.m3.1.2.3" xref="S3.SS1.p3.3.m3.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p3.3.m3.1.1.1.3" xref="S3.SS1.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.1.1.1.3.1" xref="S3.SS1.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.p3.3.m3.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p3.3.m3.1.1.1.3.2" xref="S3.SS1.p3.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.2.cmml" xref="S3.SS1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2">subscript</csymbol><apply id="S3.SS1.p3.3.m3.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1">𝑡</ci></apply><ci id="S3.SS1.p3.3.m3.1.2.3a.cmml" xref="S3.SS1.p3.3.m3.1.2.3"><mtext mathsize="70%" id="S3.SS1.p3.3.m3.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\bm{F}^{(t)}_{\text{global}}</annotation></semantics></math> to each client. Instead of replacing <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\bm{F}^{(t)}_{i}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msubsup id="S3.SS1.p3.4.m4.1.2" xref="S3.SS1.p3.4.m4.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.2.2.2" xref="S3.SS1.p3.4.m4.1.2.2.2.cmml">𝑭</mi><mi id="S3.SS1.p3.4.m4.1.2.3" xref="S3.SS1.p3.4.m4.1.2.3.cmml">i</mi><mrow id="S3.SS1.p3.4.m4.1.1.1.3" xref="S3.SS1.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.4.m4.1.1.1.3.1" xref="S3.SS1.p3.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p3.4.m4.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p3.4.m4.1.1.1.3.2" xref="S3.SS1.p3.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.2.cmml" xref="S3.SS1.p3.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2">subscript</csymbol><apply id="S3.SS1.p3.4.m4.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.2.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.4.m4.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1">𝑡</ci></apply><ci id="S3.SS1.p3.4.m4.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\bm{F}^{(t)}_{i}</annotation></semantics></math> with <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="\bm{F}^{(t)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><msubsup id="S3.SS1.p3.5.m5.1.2" xref="S3.SS1.p3.5.m5.1.2.cmml"><mi id="S3.SS1.p3.5.m5.1.2.2.2" xref="S3.SS1.p3.5.m5.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p3.5.m5.1.2.3" xref="S3.SS1.p3.5.m5.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p3.5.m5.1.1.1.3" xref="S3.SS1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.5.m5.1.1.1.3.1" xref="S3.SS1.p3.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p3.5.m5.1.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p3.5.m5.1.1.1.3.2" xref="S3.SS1.p3.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.2.cmml" xref="S3.SS1.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.2.1.cmml" xref="S3.SS1.p3.5.m5.1.2">subscript</csymbol><apply id="S3.SS1.p3.5.m5.1.2.2.cmml" xref="S3.SS1.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.2.2.1.cmml" xref="S3.SS1.p3.5.m5.1.2">superscript</csymbol><ci id="S3.SS1.p3.5.m5.1.2.2.2.cmml" xref="S3.SS1.p3.5.m5.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.5.m5.1.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1.1">𝑡</ci></apply><ci id="S3.SS1.p3.5.m5.1.2.3a.cmml" xref="S3.SS1.p3.5.m5.1.2.3"><mtext mathsize="70%" id="S3.SS1.p3.5.m5.1.2.3.cmml" xref="S3.SS1.p3.5.m5.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">\bm{F}^{(t)}_{\text{global}}</annotation></semantics></math>, <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\bm{F}^{(t)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><msubsup id="S3.SS1.p3.6.m6.1.2" xref="S3.SS1.p3.6.m6.1.2.cmml"><mi id="S3.SS1.p3.6.m6.1.2.2.2" xref="S3.SS1.p3.6.m6.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p3.6.m6.1.2.3" xref="S3.SS1.p3.6.m6.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p3.6.m6.1.1.1.3" xref="S3.SS1.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.1" xref="S3.SS1.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p3.6.m6.1.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p3.6.m6.1.1.1.3.2" xref="S3.SS1.p3.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.2.cmml" xref="S3.SS1.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.2">subscript</csymbol><apply id="S3.SS1.p3.6.m6.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.2.2.1.cmml" xref="S3.SS1.p3.6.m6.1.2">superscript</csymbol><ci id="S3.SS1.p3.6.m6.1.2.2.2.cmml" xref="S3.SS1.p3.6.m6.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.6.m6.1.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.1">𝑡</ci></apply><ci id="S3.SS1.p3.6.m6.1.2.3a.cmml" xref="S3.SS1.p3.6.m6.1.2.3"><mtext mathsize="70%" id="S3.SS1.p3.6.m6.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\bm{F}^{(t)}_{\text{global}}</annotation></semantics></math> is used to predict pseudo labels <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\hat{\bm{Y}}_{i}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mover accent="true" id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2.2" xref="S3.SS1.p3.7.m7.1.1.2.2.cmml">𝒀</mi><mo id="S3.SS1.p3.7.m7.1.1.2.1" xref="S3.SS1.p3.7.m7.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2"><ci id="S3.SS1.p3.7.m7.1.1.2.1.cmml" xref="S3.SS1.p3.7.m7.1.1.2.1">^</ci><ci id="S3.SS1.p3.7.m7.1.1.2.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2.2">𝒀</ci></apply><ci id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\hat{\bm{Y}}_{i}</annotation></semantics></math> on <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="\bm{X}_{i}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msub id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">𝑿</mi><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">𝑿</ci><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\bm{X}_{i}</annotation></semantics></math>, which will be described in subsection <a href="#S3.SS2" title="3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> (Line 7 in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Overview ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Then an energy-based weighting algorithm is performed to evaluate <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="\hat{\bm{Y}}_{i}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msub id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mover accent="true" id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2.2" xref="S3.SS1.p3.9.m9.1.1.2.2.cmml">𝒀</mi><mo id="S3.SS1.p3.9.m9.1.1.2.1" xref="S3.SS1.p3.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><apply id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2"><ci id="S3.SS1.p3.9.m9.1.1.2.1.cmml" xref="S3.SS1.p3.9.m9.1.1.2.1">^</ci><ci id="S3.SS1.p3.9.m9.1.1.2.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2.2">𝒀</ci></apply><ci id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">\hat{\bm{Y}}_{i}</annotation></semantics></math>’s quality and estimate weights <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="\bm{w}_{\text{pseudo}}" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><msub id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.2" xref="S3.SS1.p3.10.m10.1.1.2.cmml">𝒘</mi><mtext id="S3.SS1.p3.10.m10.1.1.3" xref="S3.SS1.p3.10.m10.1.1.3a.cmml">pseudo</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><apply id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p3.10.m10.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.2">𝒘</ci><ci id="S3.SS1.p3.10.m10.1.1.3a.cmml" xref="S3.SS1.p3.10.m10.1.1.3"><mtext mathsize="70%" id="S3.SS1.p3.10.m10.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3">pseudo</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">\bm{w}_{\text{pseudo}}</annotation></semantics></math>. With the estimated weights, the client model <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="\bm{F}_{i}^{(t)}" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><msubsup id="S3.SS1.p3.11.m11.1.2" xref="S3.SS1.p3.11.m11.1.2.cmml"><mi id="S3.SS1.p3.11.m11.1.2.2.2" xref="S3.SS1.p3.11.m11.1.2.2.2.cmml">𝑭</mi><mi id="S3.SS1.p3.11.m11.1.2.2.3" xref="S3.SS1.p3.11.m11.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p3.11.m11.1.1.1.3" xref="S3.SS1.p3.11.m11.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.11.m11.1.1.1.3.1" xref="S3.SS1.p3.11.m11.1.2.cmml">(</mo><mi id="S3.SS1.p3.11.m11.1.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p3.11.m11.1.1.1.3.2" xref="S3.SS1.p3.11.m11.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><apply id="S3.SS1.p3.11.m11.1.2.cmml" xref="S3.SS1.p3.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.1.2.1.cmml" xref="S3.SS1.p3.11.m11.1.2">superscript</csymbol><apply id="S3.SS1.p3.11.m11.1.2.2.cmml" xref="S3.SS1.p3.11.m11.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.1.2.2.1.cmml" xref="S3.SS1.p3.11.m11.1.2">subscript</csymbol><ci id="S3.SS1.p3.11.m11.1.2.2.2.cmml" xref="S3.SS1.p3.11.m11.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.11.m11.1.2.2.3.cmml" xref="S3.SS1.p3.11.m11.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p3.11.m11.1.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">\bm{F}_{i}^{(t)}</annotation></semantics></math> is updated on the combination of <math id="S3.SS1.p3.12.m12.2" class="ltx_Math" alttext="(\bm{X}_{i},\bm{Y}_{i})" display="inline"><semantics id="S3.SS1.p3.12.m12.2a"><mrow id="S3.SS1.p3.12.m12.2.2.2" xref="S3.SS1.p3.12.m12.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.12.m12.2.2.2.3" xref="S3.SS1.p3.12.m12.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.12.m12.1.1.1.1" xref="S3.SS1.p3.12.m12.1.1.1.1.cmml"><mi id="S3.SS1.p3.12.m12.1.1.1.1.2" xref="S3.SS1.p3.12.m12.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.SS1.p3.12.m12.1.1.1.1.3" xref="S3.SS1.p3.12.m12.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.12.m12.2.2.2.4" xref="S3.SS1.p3.12.m12.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.12.m12.2.2.2.2" xref="S3.SS1.p3.12.m12.2.2.2.2.cmml"><mi id="S3.SS1.p3.12.m12.2.2.2.2.2" xref="S3.SS1.p3.12.m12.2.2.2.2.2.cmml">𝒀</mi><mi id="S3.SS1.p3.12.m12.2.2.2.2.3" xref="S3.SS1.p3.12.m12.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p3.12.m12.2.2.2.5" xref="S3.SS1.p3.12.m12.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.2b"><interval closure="open" id="S3.SS1.p3.12.m12.2.2.3.cmml" xref="S3.SS1.p3.12.m12.2.2.2"><apply id="S3.SS1.p3.12.m12.1.1.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.12.m12.1.1.1.1.2.cmml" xref="S3.SS1.p3.12.m12.1.1.1.1.2">𝑿</ci><ci id="S3.SS1.p3.12.m12.1.1.1.1.3.cmml" xref="S3.SS1.p3.12.m12.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p3.12.m12.2.2.2.2.cmml" xref="S3.SS1.p3.12.m12.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.2.2.2.2.1.cmml" xref="S3.SS1.p3.12.m12.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.12.m12.2.2.2.2.2.cmml" xref="S3.SS1.p3.12.m12.2.2.2.2.2">𝒀</ci><ci id="S3.SS1.p3.12.m12.2.2.2.2.3.cmml" xref="S3.SS1.p3.12.m12.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.2c">(\bm{X}_{i},\bm{Y}_{i})</annotation></semantics></math> and <math id="S3.SS1.p3.13.m13.2" class="ltx_Math" alttext="(\bm{X}_{i},\hat{\bm{Y}}_{i})" display="inline"><semantics id="S3.SS1.p3.13.m13.2a"><mrow id="S3.SS1.p3.13.m13.2.2.2" xref="S3.SS1.p3.13.m13.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.13.m13.2.2.2.3" xref="S3.SS1.p3.13.m13.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.13.m13.1.1.1.1" xref="S3.SS1.p3.13.m13.1.1.1.1.cmml"><mi id="S3.SS1.p3.13.m13.1.1.1.1.2" xref="S3.SS1.p3.13.m13.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.SS1.p3.13.m13.1.1.1.1.3" xref="S3.SS1.p3.13.m13.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.13.m13.2.2.2.4" xref="S3.SS1.p3.13.m13.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.13.m13.2.2.2.2" xref="S3.SS1.p3.13.m13.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.p3.13.m13.2.2.2.2.2" xref="S3.SS1.p3.13.m13.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.13.m13.2.2.2.2.2.2" xref="S3.SS1.p3.13.m13.2.2.2.2.2.2.cmml">𝒀</mi><mo id="S3.SS1.p3.13.m13.2.2.2.2.2.1" xref="S3.SS1.p3.13.m13.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.13.m13.2.2.2.2.3" xref="S3.SS1.p3.13.m13.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p3.13.m13.2.2.2.5" xref="S3.SS1.p3.13.m13.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.2b"><interval closure="open" id="S3.SS1.p3.13.m13.2.2.3.cmml" xref="S3.SS1.p3.13.m13.2.2.2"><apply id="S3.SS1.p3.13.m13.1.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.13.m13.1.1.1.1.2.cmml" xref="S3.SS1.p3.13.m13.1.1.1.1.2">𝑿</ci><ci id="S3.SS1.p3.13.m13.1.1.1.1.3.cmml" xref="S3.SS1.p3.13.m13.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p3.13.m13.2.2.2.2.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.2.2.2.2.1.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p3.13.m13.2.2.2.2.2.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2.2"><ci id="S3.SS1.p3.13.m13.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2.2.1">^</ci><ci id="S3.SS1.p3.13.m13.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2.2.2">𝒀</ci></apply><ci id="S3.SS1.p3.13.m13.2.2.2.2.3.cmml" xref="S3.SS1.p3.13.m13.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.2c">(\bm{X}_{i},\hat{\bm{Y}}_{i})</annotation></semantics></math> (Line 8 in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Overview ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
The updated model <math id="S3.SS1.p3.14.m14.1" class="ltx_Math" alttext="\bm{F}_{i}^{(t+1)}" display="inline"><semantics id="S3.SS1.p3.14.m14.1a"><msubsup id="S3.SS1.p3.14.m14.1.2" xref="S3.SS1.p3.14.m14.1.2.cmml"><mi id="S3.SS1.p3.14.m14.1.2.2.2" xref="S3.SS1.p3.14.m14.1.2.2.2.cmml">𝑭</mi><mi id="S3.SS1.p3.14.m14.1.2.2.3" xref="S3.SS1.p3.14.m14.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p3.14.m14.1.1.1.1" xref="S3.SS1.p3.14.m14.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.14.m14.1.1.1.1.2" xref="S3.SS1.p3.14.m14.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.14.m14.1.1.1.1.1" xref="S3.SS1.p3.14.m14.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.14.m14.1.1.1.1.1.2" xref="S3.SS1.p3.14.m14.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.14.m14.1.1.1.1.1.1" xref="S3.SS1.p3.14.m14.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.14.m14.1.1.1.1.1.3" xref="S3.SS1.p3.14.m14.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p3.14.m14.1.1.1.1.3" xref="S3.SS1.p3.14.m14.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><apply id="S3.SS1.p3.14.m14.1.2.cmml" xref="S3.SS1.p3.14.m14.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.14.m14.1.2.1.cmml" xref="S3.SS1.p3.14.m14.1.2">superscript</csymbol><apply id="S3.SS1.p3.14.m14.1.2.2.cmml" xref="S3.SS1.p3.14.m14.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.14.m14.1.2.2.1.cmml" xref="S3.SS1.p3.14.m14.1.2">subscript</csymbol><ci id="S3.SS1.p3.14.m14.1.2.2.2.cmml" xref="S3.SS1.p3.14.m14.1.2.2.2">𝑭</ci><ci id="S3.SS1.p3.14.m14.1.2.2.3.cmml" xref="S3.SS1.p3.14.m14.1.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p3.14.m14.1.1.1.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1.1.1"><plus id="S3.SS1.p3.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1.1.1.1.1"></plus><ci id="S3.SS1.p3.14.m14.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.14.m14.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.14.m14.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.14.m14.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">\bm{F}_{i}^{(t+1)}</annotation></semantics></math> and training loss are sent to <math id="S3.SS1.p3.15.m15.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p3.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.15.m15.1.1" xref="S3.SS1.p3.15.m15.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m15.1b"><ci id="S3.SS1.p3.15.m15.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m15.1c">\mathcal{S}</annotation></semantics></math> for model aggregation. The server <math id="S3.SS1.p3.16.m16.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p3.16.m16.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.16.m16.1.1" xref="S3.SS1.p3.16.m16.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m16.1b"><ci id="S3.SS1.p3.16.m16.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m16.1c">\mathcal{S}</annotation></semantics></math> computes the new global model <math id="S3.SS1.p3.17.m17.1" class="ltx_Math" alttext="\bm{F}^{(t+1)}_{\text{global}}" display="inline"><semantics id="S3.SS1.p3.17.m17.1a"><msubsup id="S3.SS1.p3.17.m17.1.2" xref="S3.SS1.p3.17.m17.1.2.cmml"><mi id="S3.SS1.p3.17.m17.1.2.2.2" xref="S3.SS1.p3.17.m17.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS1.p3.17.m17.1.2.3" xref="S3.SS1.p3.17.m17.1.2.3a.cmml">global</mtext><mrow id="S3.SS1.p3.17.m17.1.1.1.1" xref="S3.SS1.p3.17.m17.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.17.m17.1.1.1.1.2" xref="S3.SS1.p3.17.m17.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.17.m17.1.1.1.1.1" xref="S3.SS1.p3.17.m17.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.17.m17.1.1.1.1.1.2" xref="S3.SS1.p3.17.m17.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.17.m17.1.1.1.1.1.1" xref="S3.SS1.p3.17.m17.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.17.m17.1.1.1.1.1.3" xref="S3.SS1.p3.17.m17.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p3.17.m17.1.1.1.1.3" xref="S3.SS1.p3.17.m17.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.17.m17.1b"><apply id="S3.SS1.p3.17.m17.1.2.cmml" xref="S3.SS1.p3.17.m17.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.17.m17.1.2.1.cmml" xref="S3.SS1.p3.17.m17.1.2">subscript</csymbol><apply id="S3.SS1.p3.17.m17.1.2.2.cmml" xref="S3.SS1.p3.17.m17.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.17.m17.1.2.2.1.cmml" xref="S3.SS1.p3.17.m17.1.2">superscript</csymbol><ci id="S3.SS1.p3.17.m17.1.2.2.2.cmml" xref="S3.SS1.p3.17.m17.1.2.2.2">𝑭</ci><apply id="S3.SS1.p3.17.m17.1.1.1.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1.1.1"><plus id="S3.SS1.p3.17.m17.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1.1.1.1.1"></plus><ci id="S3.SS1.p3.17.m17.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.17.m17.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.17.m17.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.17.m17.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS1.p3.17.m17.1.2.3a.cmml" xref="S3.SS1.p3.17.m17.1.2.3"><mtext mathsize="70%" id="S3.SS1.p3.17.m17.1.2.3.cmml" xref="S3.SS1.p3.17.m17.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.17.m17.1c">\bm{F}^{(t+1)}_{\text{global}}</annotation></semantics></math>, which will be elaborated in subsection <a href="#S3.SS3" title="3.3 Dynamic Aggregation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> (Line 5 in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Overview ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.6.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.7.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.2" class="ltx_p ltx_figure_panel"><span id="alg1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Input</span><span id="alg1.2.2" class="ltx_text" style="font-size:90%;">: </span><math id="alg1.1.m1.4" class="ltx_Math" alttext="T,\{(\bm{X},\bm{Y})\}" display="inline"><semantics id="alg1.1.m1.4a"><mrow id="alg1.1.m1.4.4.1" xref="alg1.1.m1.4.4.2.cmml"><mi mathsize="90%" id="alg1.1.m1.3.3" xref="alg1.1.m1.3.3.cmml">T</mi><mo mathsize="90%" id="alg1.1.m1.4.4.1.2" xref="alg1.1.m1.4.4.2.cmml">,</mo><mrow id="alg1.1.m1.4.4.1.1.1" xref="alg1.1.m1.4.4.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.1.m1.4.4.1.1.1.2" xref="alg1.1.m1.4.4.1.1.2.cmml">{</mo><mrow id="alg1.1.m1.4.4.1.1.1.1.2" xref="alg1.1.m1.4.4.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.1.m1.4.4.1.1.1.1.2.1" xref="alg1.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">𝑿</mi><mo mathsize="90%" id="alg1.1.m1.4.4.1.1.1.1.2.2" xref="alg1.1.m1.4.4.1.1.1.1.1.cmml">,</mo><mi mathsize="90%" id="alg1.1.m1.2.2" xref="alg1.1.m1.2.2.cmml">𝒀</mi><mo maxsize="90%" minsize="90%" id="alg1.1.m1.4.4.1.1.1.1.2.3" xref="alg1.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo maxsize="90%" minsize="90%" id="alg1.1.m1.4.4.1.1.1.3" xref="alg1.1.m1.4.4.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.4b"><list id="alg1.1.m1.4.4.2.cmml" xref="alg1.1.m1.4.4.1"><ci id="alg1.1.m1.3.3.cmml" xref="alg1.1.m1.3.3">𝑇</ci><set id="alg1.1.m1.4.4.1.1.2.cmml" xref="alg1.1.m1.4.4.1.1.1"><interval closure="open" id="alg1.1.m1.4.4.1.1.1.1.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.2"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑿</ci><ci id="alg1.1.m1.2.2.cmml" xref="alg1.1.m1.2.2">𝒀</ci></interval></set></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.4c">T,\{(\bm{X},\bm{Y})\}</annotation></semantics></math><span id="alg1.2.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.2.m2.1" class="ltx_Math" alttext="\bm{F}^{(0)}_{\text{global}}" display="inline"><semantics id="alg1.2.m2.1a"><msubsup id="alg1.2.m2.1.2" xref="alg1.2.m2.1.2.cmml"><mi mathsize="90%" id="alg1.2.m2.1.2.2.2" xref="alg1.2.m2.1.2.2.2.cmml">𝑭</mi><mtext mathsize="90%" id="alg1.2.m2.1.2.3" xref="alg1.2.m2.1.2.3a.cmml">global</mtext><mrow id="alg1.2.m2.1.1.1.3" xref="alg1.2.m2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.2.m2.1.1.1.3.1" xref="alg1.2.m2.1.2.cmml">(</mo><mn mathsize="90%" id="alg1.2.m2.1.1.1.1" xref="alg1.2.m2.1.1.1.1.cmml">0</mn><mo maxsize="90%" minsize="90%" id="alg1.2.m2.1.1.1.3.2" xref="alg1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.2.cmml" xref="alg1.2.m2.1.2"><csymbol cd="ambiguous" id="alg1.2.m2.1.2.1.cmml" xref="alg1.2.m2.1.2">subscript</csymbol><apply id="alg1.2.m2.1.2.2.cmml" xref="alg1.2.m2.1.2"><csymbol cd="ambiguous" id="alg1.2.m2.1.2.2.1.cmml" xref="alg1.2.m2.1.2">superscript</csymbol><ci id="alg1.2.m2.1.2.2.2.cmml" xref="alg1.2.m2.1.2.2.2">𝑭</ci><cn type="integer" id="alg1.2.m2.1.1.1.1.cmml" xref="alg1.2.m2.1.1.1.1">0</cn></apply><ci id="alg1.2.m2.1.2.3a.cmml" xref="alg1.2.m2.1.2.3"><mtext mathsize="63%" id="alg1.2.m2.1.2.3.cmml" xref="alg1.2.m2.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\bm{F}^{(0)}_{\text{global}}</annotation></semantics></math><span id="alg1.2.4" class="ltx_text" style="font-size:90%;"> </span>
<br class="ltx_break"><span id="alg1.2.5" class="ltx_text" style="font-size:90%;"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.8" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l1.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l1.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l1.m1.5" class="ltx_Math" alttext="t=0,1,2,...,T-1" display="inline"><semantics id="alg1.l1.m1.5a"><mrow id="alg1.l1.m1.5.5" xref="alg1.l1.m1.5.5.cmml"><mi mathsize="90%" id="alg1.l1.m1.5.5.3" xref="alg1.l1.m1.5.5.3.cmml">t</mi><mo mathsize="90%" id="alg1.l1.m1.5.5.2" xref="alg1.l1.m1.5.5.2.cmml">=</mo><mrow id="alg1.l1.m1.5.5.1.1" xref="alg1.l1.m1.5.5.1.2.cmml"><mn mathsize="90%" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l1.m1.5.5.1.1.2" xref="alg1.l1.m1.5.5.1.2.cmml">,</mo><mn mathsize="90%" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">1</mn><mo mathsize="90%" id="alg1.l1.m1.5.5.1.1.3" xref="alg1.l1.m1.5.5.1.2.cmml">,</mo><mn mathsize="90%" id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">2</mn><mo mathsize="90%" id="alg1.l1.m1.5.5.1.1.4" xref="alg1.l1.m1.5.5.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l1.m1.4.4" xref="alg1.l1.m1.4.4.cmml">…</mi><mo mathsize="90%" id="alg1.l1.m1.5.5.1.1.5" xref="alg1.l1.m1.5.5.1.2.cmml">,</mo><mrow id="alg1.l1.m1.5.5.1.1.1" xref="alg1.l1.m1.5.5.1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.5.5.1.1.1.2" xref="alg1.l1.m1.5.5.1.1.1.2.cmml">T</mi><mo mathsize="90%" id="alg1.l1.m1.5.5.1.1.1.1" xref="alg1.l1.m1.5.5.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="alg1.l1.m1.5.5.1.1.1.3" xref="alg1.l1.m1.5.5.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.5b"><apply id="alg1.l1.m1.5.5.cmml" xref="alg1.l1.m1.5.5"><eq id="alg1.l1.m1.5.5.2.cmml" xref="alg1.l1.m1.5.5.2"></eq><ci id="alg1.l1.m1.5.5.3.cmml" xref="alg1.l1.m1.5.5.3">𝑡</ci><list id="alg1.l1.m1.5.5.1.2.cmml" xref="alg1.l1.m1.5.5.1.1"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">0</cn><cn type="integer" id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">1</cn><cn type="integer" id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">2</cn><ci id="alg1.l1.m1.4.4.cmml" xref="alg1.l1.m1.4.4">…</ci><apply id="alg1.l1.m1.5.5.1.1.1.cmml" xref="alg1.l1.m1.5.5.1.1.1"><minus id="alg1.l1.m1.5.5.1.1.1.1.cmml" xref="alg1.l1.m1.5.5.1.1.1.1"></minus><ci id="alg1.l1.m1.5.5.1.1.1.2.cmml" xref="alg1.l1.m1.5.5.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l1.m1.5.5.1.1.1.3.cmml" xref="alg1.l1.m1.5.5.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.5c">t=0,1,2,...,T-1</annotation></semantics></math><span id="alg1.l1.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l1.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l1.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l2.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Server:</span><span id="alg1.l2.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text" style="font-size:90%;">     Send </span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="\bm{F}^{(t)}_{\text{global}}" display="inline"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.2.2.2" xref="alg1.l3.m1.1.2.2.2.cmml">𝑭</mi><mtext mathsize="90%" id="alg1.l3.m1.1.2.3" xref="alg1.l3.m1.1.2.3a.cmml">global</mtext><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.2.cmml">(</mo><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2">subscript</csymbol><apply id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.2.1.cmml" xref="alg1.l3.m1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.2.2.2.cmml" xref="alg1.l3.m1.1.2.2.2">𝑭</ci><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝑡</ci></apply><ci id="alg1.l3.m1.1.2.3a.cmml" xref="alg1.l3.m1.1.2.3"><mtext mathsize="63%" id="alg1.l3.m1.1.2.3.cmml" xref="alg1.l3.m1.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\bm{F}^{(t)}_{\text{global}}</annotation></semantics></math><span id="alg1.l3.3" class="ltx_text" style="font-size:90%;"> to clients
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l4.m1.8" class="ltx_Math" alttext="\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}\leftarrow\text{Client}(\bm{F}^{(t)}_{\text{global}},\bm{X}_{i},\bm{Y}_{i})" display="inline"><semantics id="alg1.l4.m1.8a"><mrow id="alg1.l4.m1.8.8" xref="alg1.l4.m1.8.8.cmml"><mrow id="alg1.l4.m1.5.5.2.2" xref="alg1.l4.m1.5.5.2.3.cmml"><msubsup id="alg1.l4.m1.4.4.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m1.4.4.1.1.1.2.2" xref="alg1.l4.m1.4.4.1.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg1.l4.m1.4.4.1.1.1.2.3" xref="alg1.l4.m1.4.4.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">+</mo><mn mathsize="90%" id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l4.m1.5.5.2.2.3" xref="alg1.l4.m1.5.5.2.3.cmml">,</mo><msup id="alg1.l4.m1.5.5.2.2.2" xref="alg1.l4.m1.5.5.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l4.m1.5.5.2.2.2.2" xref="alg1.l4.m1.5.5.2.2.2.2.cmml">ℒ</mi><mrow id="alg1.l4.m1.2.2.1.3" xref="alg1.l4.m1.5.5.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.2.2.1.3.1" xref="alg1.l4.m1.5.5.2.2.2.cmml">(</mo><mi mathsize="90%" id="alg1.l4.m1.2.2.1.1" xref="alg1.l4.m1.2.2.1.1.cmml">i</mi><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.2.2.1.3.2" xref="alg1.l4.m1.5.5.2.2.2.cmml">)</mo></mrow></msup></mrow><mo mathsize="90%" stretchy="false" id="alg1.l4.m1.8.8.6" xref="alg1.l4.m1.8.8.6.cmml">←</mo><mrow id="alg1.l4.m1.8.8.5" xref="alg1.l4.m1.8.8.5.cmml"><mtext mathsize="90%" id="alg1.l4.m1.8.8.5.5" xref="alg1.l4.m1.8.8.5.5a.cmml">Client</mtext><mo lspace="0em" rspace="0em" id="alg1.l4.m1.8.8.5.4" xref="alg1.l4.m1.8.8.5.4.cmml">​</mo><mrow id="alg1.l4.m1.8.8.5.3.3" xref="alg1.l4.m1.8.8.5.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.8.8.5.3.3.4" xref="alg1.l4.m1.8.8.5.3.4.cmml">(</mo><msubsup id="alg1.l4.m1.6.6.3.1.1.1" xref="alg1.l4.m1.6.6.3.1.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m1.6.6.3.1.1.1.2.2" xref="alg1.l4.m1.6.6.3.1.1.1.2.2.cmml">𝑭</mi><mtext mathsize="90%" id="alg1.l4.m1.6.6.3.1.1.1.3" xref="alg1.l4.m1.6.6.3.1.1.1.3a.cmml">global</mtext><mrow id="alg1.l4.m1.3.3.1.3" xref="alg1.l4.m1.6.6.3.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.3.3.1.3.1" xref="alg1.l4.m1.6.6.3.1.1.1.cmml">(</mo><mi mathsize="90%" id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.3.3.1.3.2" xref="alg1.l4.m1.6.6.3.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l4.m1.8.8.5.3.3.5" xref="alg1.l4.m1.8.8.5.3.4.cmml">,</mo><msub id="alg1.l4.m1.7.7.4.2.2.2" xref="alg1.l4.m1.7.7.4.2.2.2.cmml"><mi mathsize="90%" id="alg1.l4.m1.7.7.4.2.2.2.2" xref="alg1.l4.m1.7.7.4.2.2.2.2.cmml">𝑿</mi><mi mathsize="90%" id="alg1.l4.m1.7.7.4.2.2.2.3" xref="alg1.l4.m1.7.7.4.2.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="alg1.l4.m1.8.8.5.3.3.6" xref="alg1.l4.m1.8.8.5.3.4.cmml">,</mo><msub id="alg1.l4.m1.8.8.5.3.3.3" xref="alg1.l4.m1.8.8.5.3.3.3.cmml"><mi mathsize="90%" id="alg1.l4.m1.8.8.5.3.3.3.2" xref="alg1.l4.m1.8.8.5.3.3.3.2.cmml">𝒀</mi><mi mathsize="90%" id="alg1.l4.m1.8.8.5.3.3.3.3" xref="alg1.l4.m1.8.8.5.3.3.3.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.8.8.5.3.3.7" xref="alg1.l4.m1.8.8.5.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.8b"><apply id="alg1.l4.m1.8.8.cmml" xref="alg1.l4.m1.8.8"><ci id="alg1.l4.m1.8.8.6.cmml" xref="alg1.l4.m1.8.8.6">←</ci><list id="alg1.l4.m1.5.5.2.3.cmml" xref="alg1.l4.m1.5.5.2.2"><apply id="alg1.l4.m1.4.4.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1">superscript</csymbol><apply id="alg1.l4.m1.4.4.1.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.1.1.1.2.1.cmml" xref="alg1.l4.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.4.4.1.1.1.2.2.cmml" xref="alg1.l4.m1.4.4.1.1.1.2.2">𝑭</ci><ci id="alg1.l4.m1.4.4.1.1.1.2.3.cmml" xref="alg1.l4.m1.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1"><plus id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1"></plus><ci id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l4.m1.5.5.2.2.2.cmml" xref="alg1.l4.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.2.2.2.1.cmml" xref="alg1.l4.m1.5.5.2.2.2">superscript</csymbol><ci id="alg1.l4.m1.5.5.2.2.2.2.cmml" xref="alg1.l4.m1.5.5.2.2.2.2">ℒ</ci><ci id="alg1.l4.m1.2.2.1.1.cmml" xref="alg1.l4.m1.2.2.1.1">𝑖</ci></apply></list><apply id="alg1.l4.m1.8.8.5.cmml" xref="alg1.l4.m1.8.8.5"><times id="alg1.l4.m1.8.8.5.4.cmml" xref="alg1.l4.m1.8.8.5.4"></times><ci id="alg1.l4.m1.8.8.5.5a.cmml" xref="alg1.l4.m1.8.8.5.5"><mtext mathsize="90%" id="alg1.l4.m1.8.8.5.5.cmml" xref="alg1.l4.m1.8.8.5.5">Client</mtext></ci><vector id="alg1.l4.m1.8.8.5.3.4.cmml" xref="alg1.l4.m1.8.8.5.3.3"><apply id="alg1.l4.m1.6.6.3.1.1.1.cmml" xref="alg1.l4.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.3.1.1.1.1.cmml" xref="alg1.l4.m1.6.6.3.1.1.1">subscript</csymbol><apply id="alg1.l4.m1.6.6.3.1.1.1.2.cmml" xref="alg1.l4.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.3.1.1.1.2.1.cmml" xref="alg1.l4.m1.6.6.3.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.6.6.3.1.1.1.2.2.cmml" xref="alg1.l4.m1.6.6.3.1.1.1.2.2">𝑭</ci><ci id="alg1.l4.m1.3.3.1.1.cmml" xref="alg1.l4.m1.3.3.1.1">𝑡</ci></apply><ci id="alg1.l4.m1.6.6.3.1.1.1.3a.cmml" xref="alg1.l4.m1.6.6.3.1.1.1.3"><mtext mathsize="63%" id="alg1.l4.m1.6.6.3.1.1.1.3.cmml" xref="alg1.l4.m1.6.6.3.1.1.1.3">global</mtext></ci></apply><apply id="alg1.l4.m1.7.7.4.2.2.2.cmml" xref="alg1.l4.m1.7.7.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.7.7.4.2.2.2.1.cmml" xref="alg1.l4.m1.7.7.4.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.7.7.4.2.2.2.2.cmml" xref="alg1.l4.m1.7.7.4.2.2.2.2">𝑿</ci><ci id="alg1.l4.m1.7.7.4.2.2.2.3.cmml" xref="alg1.l4.m1.7.7.4.2.2.2.3">𝑖</ci></apply><apply id="alg1.l4.m1.8.8.5.3.3.3.cmml" xref="alg1.l4.m1.8.8.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.8.8.5.3.3.3.1.cmml" xref="alg1.l4.m1.8.8.5.3.3.3">subscript</csymbol><ci id="alg1.l4.m1.8.8.5.3.3.3.2.cmml" xref="alg1.l4.m1.8.8.5.3.3.3.2">𝒀</ci><ci id="alg1.l4.m1.8.8.5.3.3.3.3.cmml" xref="alg1.l4.m1.8.8.5.3.3.3.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.8c">\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}\leftarrow\text{Client}(\bm{F}^{(t)}_{\text{global}},\bm{X}_{i},\bm{Y}_{i})</annotation></semantics></math><span id="alg1.l4.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text" style="font-size:90%;">     Compute </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="\bm{F}^{(t+1)}_{\text{global}}" display="inline"><semantics id="alg1.l5.m1.1a"><msubsup id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.2.2.2" xref="alg1.l5.m1.1.2.2.2.cmml">𝑭</mi><mtext mathsize="90%" id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3a.cmml">global</mtext><mrow id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">+</mo><mn mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2">subscript</csymbol><apply id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.1.cmml" xref="alg1.l5.m1.1.2">superscript</csymbol><ci id="alg1.l5.m1.1.2.2.2.cmml" xref="alg1.l5.m1.1.2.2.2">𝑭</ci><apply id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><plus id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"></plus><ci id="alg1.l5.m1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l5.m1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.3">1</cn></apply></apply><ci id="alg1.l5.m1.1.2.3a.cmml" xref="alg1.l5.m1.1.2.3"><mtext mathsize="63%" id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\bm{F}^{(t+1)}_{\text{global}}</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;"> based on Eq. (</span><a href="#S2.E1" title="In 2 Preliminary: Federated Learning ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="alg1.l5.4" class="ltx_text" style="font-size:90%;">) &amp; (</span><a href="#S3.E5" title="In 3.3 Dynamic Aggregation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">5</span></a><span id="alg1.l5.5" class="ltx_text" style="font-size:90%;">)
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Client:</span><span id="alg1.l6.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;">     Generate pseudo labels
</span>
</div>
<div id="alg1.l7a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7a.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7a.2" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l7a.m1.3" class="ltx_Math" alttext="\hat{\bm{Y_{i}}}=\text{Predict}(\bm{F}_{i}^{(t)},\bm{X}_{i})" display="inline"><semantics id="alg1.l7a.m1.3a"><mrow id="alg1.l7a.m1.3.3" xref="alg1.l7a.m1.3.3.cmml"><mover accent="true" id="alg1.l7a.m1.3.3.4" xref="alg1.l7a.m1.3.3.4.cmml"><msub id="alg1.l7a.m1.3.3.4.2" xref="alg1.l7a.m1.3.3.4.2.cmml"><mi mathsize="90%" id="alg1.l7a.m1.3.3.4.2.2" xref="alg1.l7a.m1.3.3.4.2.2.cmml">𝒀</mi><mi mathsize="90%" id="alg1.l7a.m1.3.3.4.2.3" xref="alg1.l7a.m1.3.3.4.2.3.cmml">𝒊</mi></msub><mo mathsize="90%" id="alg1.l7a.m1.3.3.4.1" xref="alg1.l7a.m1.3.3.4.1.cmml">^</mo></mover><mo mathsize="90%" id="alg1.l7a.m1.3.3.3" xref="alg1.l7a.m1.3.3.3.cmml">=</mo><mrow id="alg1.l7a.m1.3.3.2" xref="alg1.l7a.m1.3.3.2.cmml"><mtext mathsize="90%" id="alg1.l7a.m1.3.3.2.4" xref="alg1.l7a.m1.3.3.2.4a.cmml">Predict</mtext><mo lspace="0em" rspace="0em" id="alg1.l7a.m1.3.3.2.3" xref="alg1.l7a.m1.3.3.2.3.cmml">​</mo><mrow id="alg1.l7a.m1.3.3.2.2.2" xref="alg1.l7a.m1.3.3.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7a.m1.3.3.2.2.2.3" xref="alg1.l7a.m1.3.3.2.2.3.cmml">(</mo><msubsup id="alg1.l7a.m1.2.2.1.1.1.1" xref="alg1.l7a.m1.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l7a.m1.2.2.1.1.1.1.2.2" xref="alg1.l7a.m1.2.2.1.1.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg1.l7a.m1.2.2.1.1.1.1.2.3" xref="alg1.l7a.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l7a.m1.1.1.1.3" xref="alg1.l7a.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7a.m1.1.1.1.3.1" xref="alg1.l7a.m1.2.2.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="alg1.l7a.m1.1.1.1.1" xref="alg1.l7a.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l7a.m1.1.1.1.3.2" xref="alg1.l7a.m1.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l7a.m1.3.3.2.2.2.4" xref="alg1.l7a.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l7a.m1.3.3.2.2.2.2" xref="alg1.l7a.m1.3.3.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l7a.m1.3.3.2.2.2.2.2" xref="alg1.l7a.m1.3.3.2.2.2.2.2.cmml">𝑿</mi><mi mathsize="90%" id="alg1.l7a.m1.3.3.2.2.2.2.3" xref="alg1.l7a.m1.3.3.2.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l7a.m1.3.3.2.2.2.5" xref="alg1.l7a.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.3b"><apply id="alg1.l7a.m1.3.3.cmml" xref="alg1.l7a.m1.3.3"><eq id="alg1.l7a.m1.3.3.3.cmml" xref="alg1.l7a.m1.3.3.3"></eq><apply id="alg1.l7a.m1.3.3.4.cmml" xref="alg1.l7a.m1.3.3.4"><ci id="alg1.l7a.m1.3.3.4.1.cmml" xref="alg1.l7a.m1.3.3.4.1">^</ci><apply id="alg1.l7a.m1.3.3.4.2.cmml" xref="alg1.l7a.m1.3.3.4.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.3.4.2.1.cmml" xref="alg1.l7a.m1.3.3.4.2">subscript</csymbol><ci id="alg1.l7a.m1.3.3.4.2.2.cmml" xref="alg1.l7a.m1.3.3.4.2.2">𝒀</ci><ci id="alg1.l7a.m1.3.3.4.2.3.cmml" xref="alg1.l7a.m1.3.3.4.2.3">𝒊</ci></apply></apply><apply id="alg1.l7a.m1.3.3.2.cmml" xref="alg1.l7a.m1.3.3.2"><times id="alg1.l7a.m1.3.3.2.3.cmml" xref="alg1.l7a.m1.3.3.2.3"></times><ci id="alg1.l7a.m1.3.3.2.4a.cmml" xref="alg1.l7a.m1.3.3.2.4"><mtext mathsize="90%" id="alg1.l7a.m1.3.3.2.4.cmml" xref="alg1.l7a.m1.3.3.2.4">Predict</mtext></ci><interval closure="open" id="alg1.l7a.m1.3.3.2.2.3.cmml" xref="alg1.l7a.m1.3.3.2.2.2"><apply id="alg1.l7a.m1.2.2.1.1.1.1.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1">superscript</csymbol><apply id="alg1.l7a.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7a.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l7a.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1.2.2">𝑭</ci><ci id="alg1.l7a.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l7a.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l7a.m1.1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1.1">𝑡</ci></apply><apply id="alg1.l7a.m1.3.3.2.2.2.2.cmml" xref="alg1.l7a.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l7a.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l7a.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l7a.m1.3.3.2.2.2.2.2">𝑿</ci><ci id="alg1.l7a.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l7a.m1.3.3.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.3c">\hat{\bm{Y_{i}}}=\text{Predict}(\bm{F}_{i}^{(t)},\bm{X}_{i})</annotation></semantics></math><span id="alg1.l7a.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l8.m1.4" class="ltx_Math" alttext="\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}\leftarrow" display="inline"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml"><mrow id="alg1.l8.m1.4.4.2.2" xref="alg1.l8.m1.4.4.2.3.cmml"><msubsup id="alg1.l8.m1.3.3.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.cmml"><mi mathsize="90%" id="alg1.l8.m1.3.3.1.1.1.2.2" xref="alg1.l8.m1.3.3.1.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg1.l8.m1.3.3.1.1.1.2.3" xref="alg1.l8.m1.3.3.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">+</mo><mn mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l8.m1.4.4.2.2.3" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><msup id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l8.m1.4.4.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.cmml">ℒ</mi><mrow id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.4.4.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.2.2.1.3.1" xref="alg1.l8.m1.4.4.2.2.2.cmml">(</mo><mi mathsize="90%" id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml">i</mi><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.2.2.1.3.2" xref="alg1.l8.m1.4.4.2.2.2.cmml">)</mo></mrow></msup></mrow><mo mathsize="90%" stretchy="false" id="alg1.l8.m1.4.4.3" xref="alg1.l8.m1.4.4.3.cmml">←</mo><mi id="alg1.l8.m1.4.4.4" xref="alg1.l8.m1.4.4.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4"><ci id="alg1.l8.m1.4.4.3.cmml" xref="alg1.l8.m1.4.4.3">←</ci><list id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.2"><apply id="alg1.l8.m1.3.3.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1">superscript</csymbol><apply id="alg1.l8.m1.3.3.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l8.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.2.2">𝑭</ci><ci id="alg1.l8.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><plus id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"></plus><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l8.m1.4.4.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2">superscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2">ℒ</ci><ci id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1">𝑖</ci></apply></list><csymbol cd="latexml" id="alg1.l8.m1.4.4.4.cmml" xref="alg1.l8.m1.4.4.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}\leftarrow</annotation></semantics></math><span id="alg1.l8.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l8a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8a.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8a.2" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l8a.m1.5" class="ltx_Math" alttext="\text{Client Model Updating}(\bm{F}_{i}^{(t)},\bm{X}_{i},\bm{Y}_{i},\hat{\bm{Y}}_{i})" display="inline"><semantics id="alg1.l8a.m1.5a"><mrow id="alg1.l8a.m1.5.5" xref="alg1.l8a.m1.5.5.cmml"><mtext mathsize="90%" id="alg1.l8a.m1.5.5.6" xref="alg1.l8a.m1.5.5.6a.cmml">Client Model Updating</mtext><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.5.5.5" xref="alg1.l8a.m1.5.5.5.cmml">​</mo><mrow id="alg1.l8a.m1.5.5.4.4" xref="alg1.l8a.m1.5.5.4.5.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8a.m1.5.5.4.4.5" xref="alg1.l8a.m1.5.5.4.5.cmml">(</mo><msubsup id="alg1.l8a.m1.2.2.1.1.1" xref="alg1.l8a.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l8a.m1.2.2.1.1.1.2.2" xref="alg1.l8a.m1.2.2.1.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg1.l8a.m1.2.2.1.1.1.2.3" xref="alg1.l8a.m1.2.2.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l8a.m1.1.1.1.3" xref="alg1.l8a.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8a.m1.1.1.1.3.1" xref="alg1.l8a.m1.2.2.1.1.1.cmml">(</mo><mi mathsize="90%" id="alg1.l8a.m1.1.1.1.1" xref="alg1.l8a.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l8a.m1.1.1.1.3.2" xref="alg1.l8a.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l8a.m1.5.5.4.4.6" xref="alg1.l8a.m1.5.5.4.5.cmml">,</mo><msub id="alg1.l8a.m1.3.3.2.2.2" xref="alg1.l8a.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="alg1.l8a.m1.3.3.2.2.2.2" xref="alg1.l8a.m1.3.3.2.2.2.2.cmml">𝑿</mi><mi mathsize="90%" id="alg1.l8a.m1.3.3.2.2.2.3" xref="alg1.l8a.m1.3.3.2.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="alg1.l8a.m1.5.5.4.4.7" xref="alg1.l8a.m1.5.5.4.5.cmml">,</mo><msub id="alg1.l8a.m1.4.4.3.3.3" xref="alg1.l8a.m1.4.4.3.3.3.cmml"><mi mathsize="90%" id="alg1.l8a.m1.4.4.3.3.3.2" xref="alg1.l8a.m1.4.4.3.3.3.2.cmml">𝒀</mi><mi mathsize="90%" id="alg1.l8a.m1.4.4.3.3.3.3" xref="alg1.l8a.m1.4.4.3.3.3.3.cmml">i</mi></msub><mo mathsize="90%" id="alg1.l8a.m1.5.5.4.4.8" xref="alg1.l8a.m1.5.5.4.5.cmml">,</mo><msub id="alg1.l8a.m1.5.5.4.4.4" xref="alg1.l8a.m1.5.5.4.4.4.cmml"><mover accent="true" id="alg1.l8a.m1.5.5.4.4.4.2" xref="alg1.l8a.m1.5.5.4.4.4.2.cmml"><mi mathsize="90%" id="alg1.l8a.m1.5.5.4.4.4.2.2" xref="alg1.l8a.m1.5.5.4.4.4.2.2.cmml">𝒀</mi><mo mathsize="90%" id="alg1.l8a.m1.5.5.4.4.4.2.1" xref="alg1.l8a.m1.5.5.4.4.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l8a.m1.5.5.4.4.4.3" xref="alg1.l8a.m1.5.5.4.4.4.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l8a.m1.5.5.4.4.9" xref="alg1.l8a.m1.5.5.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.5b"><apply id="alg1.l8a.m1.5.5.cmml" xref="alg1.l8a.m1.5.5"><times id="alg1.l8a.m1.5.5.5.cmml" xref="alg1.l8a.m1.5.5.5"></times><ci id="alg1.l8a.m1.5.5.6a.cmml" xref="alg1.l8a.m1.5.5.6"><mtext mathsize="90%" id="alg1.l8a.m1.5.5.6.cmml" xref="alg1.l8a.m1.5.5.6">Client Model Updating</mtext></ci><vector id="alg1.l8a.m1.5.5.4.5.cmml" xref="alg1.l8a.m1.5.5.4.4"><apply id="alg1.l8a.m1.2.2.1.1.1.cmml" xref="alg1.l8a.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m1.2.2.1.1.1.1.cmml" xref="alg1.l8a.m1.2.2.1.1.1">superscript</csymbol><apply id="alg1.l8a.m1.2.2.1.1.1.2.cmml" xref="alg1.l8a.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l8a.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l8a.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l8a.m1.2.2.1.1.1.2.2">𝑭</ci><ci id="alg1.l8a.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l8a.m1.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l8a.m1.1.1.1.1.cmml" xref="alg1.l8a.m1.1.1.1.1">𝑡</ci></apply><apply id="alg1.l8a.m1.3.3.2.2.2.cmml" xref="alg1.l8a.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l8a.m1.3.3.2.2.2.1.cmml" xref="alg1.l8a.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l8a.m1.3.3.2.2.2.2.cmml" xref="alg1.l8a.m1.3.3.2.2.2.2">𝑿</ci><ci id="alg1.l8a.m1.3.3.2.2.2.3.cmml" xref="alg1.l8a.m1.3.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l8a.m1.4.4.3.3.3.cmml" xref="alg1.l8a.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l8a.m1.4.4.3.3.3.1.cmml" xref="alg1.l8a.m1.4.4.3.3.3">subscript</csymbol><ci id="alg1.l8a.m1.4.4.3.3.3.2.cmml" xref="alg1.l8a.m1.4.4.3.3.3.2">𝒀</ci><ci id="alg1.l8a.m1.4.4.3.3.3.3.cmml" xref="alg1.l8a.m1.4.4.3.3.3.3">𝑖</ci></apply><apply id="alg1.l8a.m1.5.5.4.4.4.cmml" xref="alg1.l8a.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="alg1.l8a.m1.5.5.4.4.4.1.cmml" xref="alg1.l8a.m1.5.5.4.4.4">subscript</csymbol><apply id="alg1.l8a.m1.5.5.4.4.4.2.cmml" xref="alg1.l8a.m1.5.5.4.4.4.2"><ci id="alg1.l8a.m1.5.5.4.4.4.2.1.cmml" xref="alg1.l8a.m1.5.5.4.4.4.2.1">^</ci><ci id="alg1.l8a.m1.5.5.4.4.4.2.2.cmml" xref="alg1.l8a.m1.5.5.4.4.4.2.2">𝒀</ci></apply><ci id="alg1.l8a.m1.5.5.4.4.4.3.cmml" xref="alg1.l8a.m1.5.5.4.4.4.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.5c">\text{Client Model Updating}(\bm{F}_{i}^{(t)},\bm{X}_{i},\bm{Y}_{i},\hat{\bm{Y}}_{i})</annotation></semantics></math><span id="alg1.l8a.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l9.3" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg1.l9.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l9.m1.4" class="ltx_Math" alttext="\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}" display="inline"><semantics id="alg1.l9.m1.4a"><mrow id="alg1.l9.m1.4.4.2" xref="alg1.l9.m1.4.4.3.cmml"><msubsup id="alg1.l9.m1.3.3.1.1" xref="alg1.l9.m1.3.3.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m1.3.3.1.1.2.2" xref="alg1.l9.m1.3.3.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg1.l9.m1.3.3.1.1.2.3" xref="alg1.l9.m1.3.3.1.1.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">+</mo><mn mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathsize="90%" id="alg1.l9.m1.4.4.2.3" xref="alg1.l9.m1.4.4.3.cmml">,</mo><msup id="alg1.l9.m1.4.4.2.2" xref="alg1.l9.m1.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l9.m1.4.4.2.2.2" xref="alg1.l9.m1.4.4.2.2.2.cmml">ℒ</mi><mrow id="alg1.l9.m1.2.2.1.3" xref="alg1.l9.m1.4.4.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.2.2.1.3.1" xref="alg1.l9.m1.4.4.2.2.cmml">(</mo><mi mathsize="90%" id="alg1.l9.m1.2.2.1.1" xref="alg1.l9.m1.2.2.1.1.cmml">i</mi><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.2.2.1.3.2" xref="alg1.l9.m1.4.4.2.2.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.4b"><list id="alg1.l9.m1.4.4.3.cmml" xref="alg1.l9.m1.4.4.2"><apply id="alg1.l9.m1.3.3.1.1.cmml" xref="alg1.l9.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1">superscript</csymbol><apply id="alg1.l9.m1.3.3.1.1.2.cmml" xref="alg1.l9.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.2.1.cmml" xref="alg1.l9.m1.3.3.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.1.1.2.2.cmml" xref="alg1.l9.m1.3.3.1.1.2.2">𝑭</ci><ci id="alg1.l9.m1.3.3.1.1.2.3.cmml" xref="alg1.l9.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><plus id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"></plus><ci id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l9.m1.4.4.2.2.cmml" xref="alg1.l9.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.2.2.1.cmml" xref="alg1.l9.m1.4.4.2.2">superscript</csymbol><ci id="alg1.l9.m1.4.4.2.2.2.cmml" xref="alg1.l9.m1.4.4.2.2.2">ℒ</ci><ci id="alg1.l9.m1.2.2.1.1.cmml" xref="alg1.l9.m1.2.2.1.1">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.4c">\bm{F}_{i}^{(t+1)},\mathcal{L}^{(i)}</annotation></semantics></math><span id="alg1.l9.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l10.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l10.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l10.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
</div>
</div>
</div>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Data Augmentation</h3>

<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Pseudo Data Generation with Global Knowledge</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p1.1" class="ltx_p">Data augmentation can ease the data scarcity issue in few-shot learning <cite class="ltx_cite ltx_citemacro_citep">(Feng <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>. In our case, each client can synthesize pseudo data using its own client model. However, this cannot allow each client model to leverage information of other clients and the client model trained on its own data is not able to generalize across other tasks. Hence, we use the global model to synthesize data for each client.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p2.7" class="ltx_p">Suppose the unlabeled data on <math id="S3.SS2.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">u</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2">𝑢</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">u_{i}</annotation></semantics></math> is <math id="S3.SS2.SSS0.Px1.p2.2.m2.7" class="ltx_Math" alttext="\bm{X}_{i}=\{\bm{x}_{1}^{(i)},\bm{x}_{2}^{(i)},...,\bm{x}_{n_{i}}^{(i)}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.7a"><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.7.7" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.cmml"><msub id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.2.cmml">𝑿</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.4" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.4" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.2.cmml">𝒙</mi><mn id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.5" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.2.cmml">𝒙</mi><mn id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.3.cmml">2</mn><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.3.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.6" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p2.2.m2.4.4" xref="S3.SS2.SSS0.Px1.p2.2.m2.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.7" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.2.cmml">𝒙</mi><msub id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.3.cmml">i</mi></msub><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.3.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.8" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.7b"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7"><eq id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.4.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.4"></eq><apply id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.2">𝑿</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.5.3">𝑖</ci></apply><set id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.2">𝒙</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.5.5.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.2">𝒙</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.2.2.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.4.4.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.4.4">…</ci><apply id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.2">𝒙</ci><apply id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.7.7.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.3.3.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.7c">\bm{X}_{i}=\{\bm{x}_{1}^{(i)},\bm{x}_{2}^{(i)},...,\bm{x}_{n_{i}}^{(i)}\}</annotation></semantics></math> and corresponding label is <math id="S3.SS2.SSS0.Px1.p2.3.m3.7" class="ltx_Math" alttext="\bm{Y}_{i}=\{\bm{y}_{1}^{(i)},\bm{y}_{2}^{(i)},...,\bm{y}_{n_{i}}^{(i)}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.7a"><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.7.7" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.cmml"><msub id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.2.cmml">𝒀</mi><mi id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.4" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.4" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.2.cmml">𝒚</mi><mn id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.5" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.2.cmml">𝒚</mi><mn id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.3.cmml">2</mn><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.6" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p2.3.m3.4.4" xref="S3.SS2.SSS0.Px1.p2.3.m3.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.7" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.2.cmml">𝒚</mi><msub id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.3.cmml">i</mi></msub><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.3.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.8" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.7b"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7"><eq id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.4"></eq><apply id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.2">𝒀</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.5.3">𝑖</ci></apply><set id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.2">𝒚</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.2">𝒚</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.2.2.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m3.4.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.4.4">…</ci><apply id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.2">𝒚</ci><apply id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.7.7.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.3.3.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.7c">\bm{Y}_{i}=\{\bm{y}_{1}^{(i)},\bm{y}_{2}^{(i)},...,\bm{y}_{n_{i}}^{(i)}\}</annotation></semantics></math>. Following <cite class="ltx_cite ltx_citemacro_citet">Raffel <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib29" title="" class="ltx_ref">2020a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Ye <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>, where different tasks are unified into the same text-to-text format to enable knowledge transfer across tasks, we define a prompt template for task conversion and unification: <span id="S3.SS2.SSS0.Px1.p2.5.2" class="ltx_text ltx_font_italic">&lt;task name&gt;: &lt;<math id="S3.SS2.SSS0.Px1.p2.4.1.m1.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.4.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.2">𝐱</ci><ci id="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.1.m1.1c">\bm{x}_{i}</annotation></semantics></math>&gt; [SEP] &lt;<math id="S3.SS2.SSS0.Px1.p2.5.2.m2.1" class="ltx_Math" alttext="\bm{y}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.5.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.2.cmml">𝐲</mi><mi id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.2">𝐲</ci><ci id="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.2.m2.1c">\bm{y}_{i}</annotation></semantics></math>&gt;</span>. Take question answering as an example, <math id="S3.SS2.SSS0.Px1.p2.6.m4.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.6.m4.1a"><msub id="S3.SS2.SSS0.Px1.p2.6.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.6.m4.1b"><apply id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1.2">𝒙</ci><ci id="S3.SS2.SSS0.Px1.p2.6.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.6.m4.1c">\bm{x}_{i}</annotation></semantics></math> is reformulated as: <span id="S3.SS2.SSS0.Px1.p2.7.3" class="ltx_text ltx_font_italic">&lt;question&gt; [SEP] &lt;choices&gt;</span>, <math id="S3.SS2.SSS0.Px1.p2.7.m5.1" class="ltx_Math" alttext="\bm{y}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p2.7.m5.1a"><msub id="S3.SS2.SSS0.Px1.p2.7.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1.2.cmml">𝒚</mi><mi id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.7.m5.1b"><apply id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1.2">𝒚</ci><ci id="S3.SS2.SSS0.Px1.p2.7.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.7.m5.1c">\bm{y}_{i}</annotation></semantics></math> is the corresponding answer.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p3.11" class="ltx_p">At the <math id="S3.SS2.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.1.m1.1c">t</annotation></semantics></math>-th FL training epoch, <math id="S3.SS2.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml">u</mi><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2">𝑢</ci><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.2.m2.1c">u_{i}</annotation></semantics></math> receives the global model <math id="S3.SS2.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="\bm{F}_{\text{global}}^{(t)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.3.m3.1a"><msubsup id="S3.SS2.SSS0.Px1.p3.3.m3.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3a.cmml">global</mtext><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.2">𝑭</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.2.2.3">global</mtext></ci></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.3.m3.1c">\bm{F}_{\text{global}}^{(t)}</annotation></semantics></math> from the server <math id="S3.SS2.SSS0.Px1.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p3.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.4.m4.1c">\mathcal{S}</annotation></semantics></math> and uses <math id="S3.SS2.SSS0.Px1.p3.5.m5.1" class="ltx_Math" alttext="\bm{F}_{\text{global}}^{(t)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.5.m5.1a"><msubsup id="S3.SS2.SSS0.Px1.p3.5.m5.1.2" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3a.cmml">global</mtext><mrow id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.2">𝑭</ci><ci id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.2.2.3">global</mtext></ci></apply><ci id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.5.m5.1c">\bm{F}_{\text{global}}^{(t)}</annotation></semantics></math> to predict the labels of <math id="S3.SS2.SSS0.Px1.p3.6.m6.1" class="ltx_Math" alttext="\bm{X}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.6.m6.1a"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.2.cmml">𝑿</mi><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.2">𝑿</ci><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.6.m6.1c">\bm{X}_{i}</annotation></semantics></math>. We denote the predicted pseudo labels as <math id="S3.SS2.SSS0.Px1.p3.7.m7.7" class="ltx_Math" alttext="\hat{\bm{Y}}_{i}=\{\hat{\bm{y}}_{1}^{(i)},\hat{\bm{y}}_{2}^{(i)},...,\hat{\bm{y}}_{n_{i}}^{(i)}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.7.m7.7a"><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.7.7" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.cmml"><msub id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.2.cmml">𝒀</mi><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.4" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.4" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.2.cmml">𝒚</mi><mo id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.5" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.2.cmml">𝒚</mi><mo id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.3.cmml">2</mn><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.3.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.3.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.6" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p3.7.m7.4.4" xref="S3.SS2.SSS0.Px1.p3.7.m7.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.7" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.2.cmml">𝒚</mi><mo id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.1.cmml">^</mo></mover><msub id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.2.cmml">n</mi><mi id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.3.cmml">i</mi></msub><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.3.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.3.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.8" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.7.m7.7b"><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7"><eq id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.4.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.4"></eq><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2"><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.2.2">𝒀</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.5.3">𝑖</ci></apply><set id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3"><apply id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2"><ci id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.2.2">𝒚</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.5.5.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2"><ci id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.2.2">𝒚</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.2.2.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.7.m7.4.4.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.4.4">…</ci><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2"><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.2.2">𝒚</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.7.7.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.3.3.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.7.m7.7c">\hat{\bm{Y}}_{i}=\{\hat{\bm{y}}_{1}^{(i)},\hat{\bm{y}}_{2}^{(i)},...,\hat{\bm{y}}_{n_{i}}^{(i)}\}</annotation></semantics></math>. When predicting <math id="S3.SS2.SSS0.Px1.p3.8.m8.1" class="ltx_Math" alttext="\hat{\bm{Y}}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.8.m8.1a"><msub id="S3.SS2.SSS0.Px1.p3.8.m8.1.1" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2.cmml">𝒀</mi><mo id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.1" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.8.m8.1b"><apply id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2"><ci id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2">𝒀</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.8.m8.1c">\hat{\bm{Y}}_{i}</annotation></semantics></math>, <math id="S3.SS2.SSS0.Px1.p3.9.m9.1" class="ltx_Math" alttext="\bm{F}_{\text{global}}^{(t)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.9.m9.1a"><msubsup id="S3.SS2.SSS0.Px1.p3.9.m9.1.2" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.2.cmml">𝑭</mi><mtext id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3a.cmml">global</mtext><mrow id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.9.m9.1b"><apply id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.2">𝑭</ci><ci id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.2.2.3">global</mtext></ci></apply><ci id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.9.m9.1c">\bm{F}_{\text{global}}^{(t)}</annotation></semantics></math> actually performs the task with <math id="S3.SS2.SSS0.Px1.p3.10.m10.1" class="ltx_Math" alttext="\bm{X}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.10.m10.1a"><msub id="S3.SS2.SSS0.Px1.p3.10.m10.1.1" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.2" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.2.cmml">𝑿</mi><mi id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.3" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.10.m10.1b"><apply id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.2">𝑿</ci><ci id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.10.m10.1c">\bm{X}_{i}</annotation></semantics></math> being fed as input. The generated output with the highest probability will be taken as <math id="S3.SS2.SSS0.Px1.p3.11.m11.1" class="ltx_Math" alttext="\hat{\bm{Y}}_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.11.m11.1a"><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.2.cmml">𝒀</mi><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.11.m11.1b"><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2"><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.2.2">𝒀</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.11.m11.1c">\hat{\bm{Y}}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p4" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p4.4" class="ltx_p">The predicted pseudo data are then combined with the original local data to train the client model. On the training instances from the pseudo data <math id="S3.SS2.SSS0.Px1.p4.1.m1.2" class="ltx_Math" alttext="\{\bm{X}_{i},\hat{\bm{Y}}_{i}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p4.1.m1.2a"><mrow id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.3" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.4" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.2.cmml">𝒀</mi><mo id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.1" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.5" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p4.1.m1.2b"><set id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2"><apply id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.2">𝑿</ci><ci id="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2"><ci id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.2.2">𝒀</ci></apply><ci id="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.1.m1.2.2.2.2.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p4.1.m1.2c">\{\bm{X}_{i},\hat{\bm{Y}}_{i}\}</annotation></semantics></math>, the client model is updated with an energy-based weighting algorithm to minimize a loss <math id="S3.SS2.SSS0.Px1.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{L}^{(i)}_{\text{pseudo}}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p4.2.m2.1a"><msubsup id="S3.SS2.SSS0.Px1.p4.2.m2.1.2" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.2" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3a.cmml">pseudo</mtext><mrow id="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p4.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.2.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.2.m2.1.2.3">pseudo</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p4.2.m2.1c">\mathcal{L}^{(i)}_{\text{pseudo}}</annotation></semantics></math>, while on the instances from the original local data <math id="S3.SS2.SSS0.Px1.p4.3.m3.2" class="ltx_Math" alttext="\{\bm{X}_{i},\bm{Y}_{i}\}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p4.3.m3.2a"><mrow id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.4" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.2.cmml">𝒀</mi><mi id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.5" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p4.3.m3.2b"><set id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2"><apply id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.2">𝑿</ci><ci id="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.2">𝒀</ci><ci id="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.3.m3.2.2.2.2.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p4.3.m3.2c">\{\bm{X}_{i},\bm{Y}_{i}\}</annotation></semantics></math>, the client model is trained as usual to optimize a loss <math id="S3.SS2.SSS0.Px1.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{L}^{(i)}_{\text{annotated}}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p4.4.m4.1a"><msubsup id="S3.SS2.SSS0.Px1.p4.4.m4.1.2" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.2" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.2.cmml">ℒ</mi><mtext id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3a.cmml">annotated</mtext><mrow id="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.3" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p4.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.2.2">ℒ</ci><ci id="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3a.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p4.4.m4.1.2.3">annotated</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p4.4.m4.1c">\mathcal{L}^{(i)}_{\text{annotated}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Energy-based Pseudo Instance Weighting</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p1.1" class="ltx_p">Although the pseudo instances synthesized by the global model contain global knowledge, they are noisy. We hence propose an energy-based token-wise weighting method to reduce the negative impact of noise from these pseudo instances.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p2.8" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> introduce the following energy function to perform out-of-distribution detection in image classification:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="E(\bm{x};\bm{f})=-T\cdot\mathrm{log}\sum_{i}^{K}e^{\bm{f}_{i}(\bm{x})/T}" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.4" xref="S3.E2.m1.3.4.cmml"><mrow id="S3.E2.m1.3.4.2" xref="S3.E2.m1.3.4.2.cmml"><mi id="S3.E2.m1.3.4.2.2" xref="S3.E2.m1.3.4.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.4.2.1" xref="S3.E2.m1.3.4.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.2.3.2" xref="S3.E2.m1.3.4.2.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.4.2.3.2.1" xref="S3.E2.m1.3.4.2.3.1.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.3.4.2.3.2.2" xref="S3.E2.m1.3.4.2.3.1.cmml">;</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝒇</mi><mo stretchy="false" id="S3.E2.m1.3.4.2.3.2.3" xref="S3.E2.m1.3.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.4.1" xref="S3.E2.m1.3.4.1.cmml">=</mo><mrow id="S3.E2.m1.3.4.3" xref="S3.E2.m1.3.4.3.cmml"><mo id="S3.E2.m1.3.4.3a" xref="S3.E2.m1.3.4.3.cmml">−</mo><mrow id="S3.E2.m1.3.4.3.2" xref="S3.E2.m1.3.4.3.2.cmml"><mrow id="S3.E2.m1.3.4.3.2.2" xref="S3.E2.m1.3.4.3.2.2.cmml"><mi id="S3.E2.m1.3.4.3.2.2.2" xref="S3.E2.m1.3.4.3.2.2.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.3.4.3.2.2.1" xref="S3.E2.m1.3.4.3.2.2.1.cmml">⋅</mo><mi id="S3.E2.m1.3.4.3.2.2.3" xref="S3.E2.m1.3.4.3.2.2.3.cmml">log</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.4.3.2.1" xref="S3.E2.m1.3.4.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.4.3.2.3" xref="S3.E2.m1.3.4.3.2.3.cmml"><munderover id="S3.E2.m1.3.4.3.2.3.1" xref="S3.E2.m1.3.4.3.2.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.3.4.3.2.3.1.2.2" xref="S3.E2.m1.3.4.3.2.3.1.2.2.cmml">∑</mo><mi id="S3.E2.m1.3.4.3.2.3.1.2.3" xref="S3.E2.m1.3.4.3.2.3.1.2.3.cmml">i</mi><mi id="S3.E2.m1.3.4.3.2.3.1.3" xref="S3.E2.m1.3.4.3.2.3.1.3.cmml">K</mi></munderover><msup id="S3.E2.m1.3.4.3.2.3.2" xref="S3.E2.m1.3.4.3.2.3.2.cmml"><mi id="S3.E2.m1.3.4.3.2.3.2.2" xref="S3.E2.m1.3.4.3.2.3.2.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.3.2.2.cmml">𝒇</mi><mi id="S3.E2.m1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.3.3.2.1" xref="S3.E2.m1.1.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.3.3.2.2" xref="S3.E2.m1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">/</mo><mi id="S3.E2.m1.1.1.1.4" xref="S3.E2.m1.1.1.1.4.cmml">T</mi></mrow></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.4.cmml" xref="S3.E2.m1.3.4"><eq id="S3.E2.m1.3.4.1.cmml" xref="S3.E2.m1.3.4.1"></eq><apply id="S3.E2.m1.3.4.2.cmml" xref="S3.E2.m1.3.4.2"><times id="S3.E2.m1.3.4.2.1.cmml" xref="S3.E2.m1.3.4.2.1"></times><ci id="S3.E2.m1.3.4.2.2.cmml" xref="S3.E2.m1.3.4.2.2">𝐸</ci><list id="S3.E2.m1.3.4.2.3.1.cmml" xref="S3.E2.m1.3.4.2.3.2"><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝒙</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝒇</ci></list></apply><apply id="S3.E2.m1.3.4.3.cmml" xref="S3.E2.m1.3.4.3"><minus id="S3.E2.m1.3.4.3.1.cmml" xref="S3.E2.m1.3.4.3"></minus><apply id="S3.E2.m1.3.4.3.2.cmml" xref="S3.E2.m1.3.4.3.2"><times id="S3.E2.m1.3.4.3.2.1.cmml" xref="S3.E2.m1.3.4.3.2.1"></times><apply id="S3.E2.m1.3.4.3.2.2.cmml" xref="S3.E2.m1.3.4.3.2.2"><ci id="S3.E2.m1.3.4.3.2.2.1.cmml" xref="S3.E2.m1.3.4.3.2.2.1">⋅</ci><ci id="S3.E2.m1.3.4.3.2.2.2.cmml" xref="S3.E2.m1.3.4.3.2.2.2">𝑇</ci><ci id="S3.E2.m1.3.4.3.2.2.3.cmml" xref="S3.E2.m1.3.4.3.2.2.3">log</ci></apply><apply id="S3.E2.m1.3.4.3.2.3.cmml" xref="S3.E2.m1.3.4.3.2.3"><apply id="S3.E2.m1.3.4.3.2.3.1.cmml" xref="S3.E2.m1.3.4.3.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.3.1.1.cmml" xref="S3.E2.m1.3.4.3.2.3.1">superscript</csymbol><apply id="S3.E2.m1.3.4.3.2.3.1.2.cmml" xref="S3.E2.m1.3.4.3.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.3.1.2.1.cmml" xref="S3.E2.m1.3.4.3.2.3.1">subscript</csymbol><sum id="S3.E2.m1.3.4.3.2.3.1.2.2.cmml" xref="S3.E2.m1.3.4.3.2.3.1.2.2"></sum><ci id="S3.E2.m1.3.4.3.2.3.1.2.3.cmml" xref="S3.E2.m1.3.4.3.2.3.1.2.3">𝑖</ci></apply><ci id="S3.E2.m1.3.4.3.2.3.1.3.cmml" xref="S3.E2.m1.3.4.3.2.3.1.3">𝐾</ci></apply><apply id="S3.E2.m1.3.4.3.2.3.2.cmml" xref="S3.E2.m1.3.4.3.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.3.2.3.2.1.cmml" xref="S3.E2.m1.3.4.3.2.3.2">superscript</csymbol><ci id="S3.E2.m1.3.4.3.2.3.2.2.cmml" xref="S3.E2.m1.3.4.3.2.3.2.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><divide id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></divide><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><times id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3.1"></times><apply id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.3.2.2">𝒇</ci><ci id="S3.E2.m1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒙</ci></apply><ci id="S3.E2.m1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.4">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">E(\bm{x};\bm{f})=-T\cdot\mathrm{log}\sum_{i}^{K}e^{\bm{f}_{i}(\bm{x})/T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p2.7" class="ltx_p">where <math id="S3.SS2.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">T</annotation></semantics></math> is the temperature parameter, <math id="S3.SS2.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">K</annotation></semantics></math> is the number of image classes, <math id="S3.SS2.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">\bm{x}</annotation></semantics></math> is the input image and <math id="S3.SS2.SSS0.Px2.p2.4.m4.1" class="ltx_Math" alttext="\bm{f}_{i}(\bm{x})" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.2.cmml">𝒇</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.3.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.1"></times><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.2">𝒇</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">\bm{f}_{i}(\bm{x})</annotation></semantics></math> is the output logit in dimension <math id="S3.SS2.SSS0.Px2.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.1c">i</annotation></semantics></math> (i.e., the logit value for class <math id="S3.SS2.SSS0.Px2.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">i</annotation></semantics></math>). The energy <math id="S3.SS2.SSS0.Px2.p2.7.m7.2" class="ltx_Math" alttext="E(\bm{x};\bm{f})" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.2a"><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.2.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.2.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml">𝒙</mi><mo id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.2.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.1.cmml">;</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.2.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.2.cmml">𝒇</mi><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.2.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.2b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3"><times id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.2">𝐸</ci><list id="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.3.3.2"><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1">𝒙</ci><ci id="S3.SS2.SSS0.Px2.p2.7.m7.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.2.2">𝒇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.2c">E(\bm{x};\bm{f})</annotation></semantics></math> is higher for unobserved samples and lower for observed ones.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p3" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p3.1" class="ltx_p">The essence of the energy function indicates that noisy instances have higher energy than clean instances.
However, adapting Eq. (<a href="#S3.E2" title="In Energy-based Pseudo Instance Weighting ‣ 3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) to our model is nontrivial as we are confronted with two challenges. First, our task is a generation task rather than classification, which means that the number of sequences (classes) grows exponentially with sequence length. In order to deal with this, we estimate token-wise energy instead of sequence-wise energy as token-wise generation can be treated as a multi-class classification problem (prediting a word from the vocabulary). Second, due to the large size of the vocabulary used in our model,
energy for different tokens calculated by Eq. (<a href="#S3.E2" title="In Energy-based Pseudo Instance Weighting ‣ 3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) would be almost indistinguishable from each other, as shown in Figure <a href="#S3.F3" title="Figure 3 ‣ Energy-based Pseudo Instance Weighting ‣ 3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2212.08354/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="276" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Energy distributions over top-k logits and all logits. The energy distribution over all logits (orange curve) is "crowded" and the energy values for different tokens are almost indistinguishable from each other.</figcaption>
</figure>
<div id="S3.SS2.SSS0.Px2.p4" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p4.9" class="ltx_p">Although the dimension of logits is large, only logits with high values have a substantial impact on the final prediction. We hence choose the top-k logits to calculate the energy as follows:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="E(\bm{a};\bm{f})=-T\cdot\mathrm{log}\sum_{i}e^{\bm{f}_{i}(\bm{a})/T},i\in\mathbb{K}" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.3.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.2.1" xref="S3.E3.m1.4.4.1.1.2.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.2.3.2" xref="S3.E3.m1.4.4.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.3.2.1" xref="S3.E3.m1.4.4.1.1.2.3.1.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝒂</mi><mo id="S3.E3.m1.4.4.1.1.2.3.2.2" xref="S3.E3.m1.4.4.1.1.2.3.1.cmml">;</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝒇</mi><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.3.2.3" xref="S3.E3.m1.4.4.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mo id="S3.E3.m1.4.4.1.1.3a" xref="S3.E3.m1.4.4.1.1.3.cmml">−</mo><mrow id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml"><mrow id="S3.E3.m1.4.4.1.1.3.2.2" xref="S3.E3.m1.4.4.1.1.3.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.2.2" xref="S3.E3.m1.4.4.1.1.3.2.2.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.4.4.1.1.3.2.2.1" xref="S3.E3.m1.4.4.1.1.3.2.2.1.cmml">⋅</mo><mi id="S3.E3.m1.4.4.1.1.3.2.2.3" xref="S3.E3.m1.4.4.1.1.3.2.2.3.cmml">log</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.3.2.1" xref="S3.E3.m1.4.4.1.1.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.3.2.3" xref="S3.E3.m1.4.4.1.1.3.2.3.cmml"><munder id="S3.E3.m1.4.4.1.1.3.2.3.1" xref="S3.E3.m1.4.4.1.1.3.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.4.4.1.1.3.2.3.1.2" xref="S3.E3.m1.4.4.1.1.3.2.3.1.2.cmml">∑</mo><mi id="S3.E3.m1.4.4.1.1.3.2.3.1.3" xref="S3.E3.m1.4.4.1.1.3.2.3.1.3.cmml">i</mi></munder><msup id="S3.E3.m1.4.4.1.1.3.2.3.2" xref="S3.E3.m1.4.4.1.1.3.2.3.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.3.2.2" xref="S3.E3.m1.4.4.1.1.3.2.3.2.2.cmml">e</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><msub id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.3.2.2.cmml">𝒇</mi><mi id="S3.E3.m1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.3.3.2.1" xref="S3.E3.m1.1.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">𝒂</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">/</mo><mi id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml">T</mi></mrow></msup></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.2.3" xref="S3.E3.m1.5.5.3a.cmml">,</mo><mrow id="S3.E3.m1.5.5.2.2" xref="S3.E3.m1.5.5.2.2.cmml"><mi id="S3.E3.m1.5.5.2.2.2" xref="S3.E3.m1.5.5.2.2.2.cmml">i</mi><mo id="S3.E3.m1.5.5.2.2.1" xref="S3.E3.m1.5.5.2.2.1.cmml">∈</mo><mi id="S3.E3.m1.5.5.2.2.3" xref="S3.E3.m1.5.5.2.2.3.cmml">𝕂</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3a.cmml" xref="S3.E3.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1"><eq id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"></eq><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><times id="S3.E3.m1.4.4.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1"></times><ci id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2">𝐸</ci><list id="S3.E3.m1.4.4.1.1.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.3.2"><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝒂</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝒇</ci></list></apply><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><minus id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3"></minus><apply id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2"><times id="S3.E3.m1.4.4.1.1.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.1"></times><apply id="S3.E3.m1.4.4.1.1.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2"><ci id="S3.E3.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2.1">⋅</ci><ci id="S3.E3.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2.2">𝑇</ci><ci id="S3.E3.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2.3">log</ci></apply><apply id="S3.E3.m1.4.4.1.1.3.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3"><apply id="S3.E3.m1.4.4.1.1.3.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.2.3.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E3.m1.4.4.1.1.3.2.3.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.1.2"></sum><ci id="S3.E3.m1.4.4.1.1.3.2.3.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.1.3">𝑖</ci></apply><apply id="S3.E3.m1.4.4.1.1.3.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.2.2">𝑒</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><divide id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></divide><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><times id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.3.2.2">𝒇</ci><ci id="S3.E3.m1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝒂</ci></apply><ci id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4">𝑇</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E3.m1.5.5.2.2.cmml" xref="S3.E3.m1.5.5.2.2"><in id="S3.E3.m1.5.5.2.2.1.cmml" xref="S3.E3.m1.5.5.2.2.1"></in><ci id="S3.E3.m1.5.5.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2">𝑖</ci><ci id="S3.E3.m1.5.5.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.3">𝕂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">E(\bm{a};\bm{f})=-T\cdot\mathrm{log}\sum_{i}e^{\bm{f}_{i}(\bm{a})/T},i\in\mathbb{K}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p4.4" class="ltx_p">where <math id="S3.SS2.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="\bm{a}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.cmml">𝒂</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1">𝒂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.1.m1.1c">\bm{a}</annotation></semantics></math> is the predicted token, <math id="S3.SS2.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="\bm{f}(\bm{a})" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.2.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p4.2.m2.1.2" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.2" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.2.cmml">𝒇</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.1" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.3.2" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.3.2.1" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p4.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.cmml">𝒂</mi><mo stretchy="false" id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.3.2.2" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2"><times id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.1"></times><ci id="S3.SS2.SSS0.Px2.p4.2.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.2.2">𝒇</ci><ci id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1">𝒂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.2.m2.1c">\bm{f}(\bm{a})</annotation></semantics></math> denotes the logits corresponding to <math id="S3.SS2.SSS0.Px2.p4.3.m3.1" class="ltx_Math" alttext="\bm{a}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p4.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p4.3.m3.1.1.cmml">𝒂</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.3.m3.1.1">𝒂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.3.m3.1c">\bm{a}</annotation></semantics></math>, <math id="S3.SS2.SSS0.Px2.p4.4.m4.1" class="ltx_Math" alttext="\mathbb{K}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.4.m4.1a"><mi id="S3.SS2.SSS0.Px2.p4.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.cmml">𝕂</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1">𝕂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.4.m4.1c">\mathbb{K}</annotation></semantics></math> is the set of indices of logits with the top-k values.
A noisy token will have larger energy and should have a lower weight. The instance weight is hence computed by normalizing token-wise energy at the sequence level:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\bm{w}_{\text{pseudo}}^{\bm{a}}=\frac{-E(\bm{a};\bm{f})}{\sum_{i}^{l}-E(\bm{i};\bm{f})}" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.5" xref="S3.E4.m1.4.5.cmml"><msubsup id="S3.E4.m1.4.5.2" xref="S3.E4.m1.4.5.2.cmml"><mi id="S3.E4.m1.4.5.2.2.2" xref="S3.E4.m1.4.5.2.2.2.cmml">𝒘</mi><mtext id="S3.E4.m1.4.5.2.2.3" xref="S3.E4.m1.4.5.2.2.3a.cmml">pseudo</mtext><mi id="S3.E4.m1.4.5.2.3" xref="S3.E4.m1.4.5.2.3.cmml">𝒂</mi></msubsup><mo id="S3.E4.m1.4.5.1" xref="S3.E4.m1.4.5.1.cmml">=</mo><mfrac id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mo id="S3.E4.m1.2.2.2a" xref="S3.E4.m1.2.2.2.cmml">−</mo><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.4.cmml"><mi id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.4.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.4.1.cmml">​</mo><mrow id="S3.E4.m1.2.2.2.4.3.2" xref="S3.E4.m1.2.2.2.4.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.4.3.2.1" xref="S3.E4.m1.2.2.2.4.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒂</mi><mo id="S3.E4.m1.2.2.2.4.3.2.2" xref="S3.E4.m1.2.2.2.4.3.1.cmml">;</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">𝒇</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.4.3.2.3" xref="S3.E4.m1.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><msubsup id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.4.cmml"><mo id="S3.E4.m1.4.4.4.4.2.2" xref="S3.E4.m1.4.4.4.4.2.2.cmml">∑</mo><mi id="S3.E4.m1.4.4.4.4.2.3" xref="S3.E4.m1.4.4.4.4.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.4.4.3" xref="S3.E4.m1.4.4.4.4.3.cmml">l</mi></msubsup><mo lspace="0em" id="S3.E4.m1.4.4.4.3" xref="S3.E4.m1.4.4.4.3.cmml">−</mo><mrow id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml"><mi id="S3.E4.m1.4.4.4.5.2" xref="S3.E4.m1.4.4.4.5.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.5.1" xref="S3.E4.m1.4.4.4.5.1.cmml">​</mo><mrow id="S3.E4.m1.4.4.4.5.3.2" xref="S3.E4.m1.4.4.4.5.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.5.3.2.1" xref="S3.E4.m1.4.4.4.5.3.1.cmml">(</mo><mi id="S3.E4.m1.3.3.3.1" xref="S3.E4.m1.3.3.3.1.cmml">𝒊</mi><mo id="S3.E4.m1.4.4.4.5.3.2.2" xref="S3.E4.m1.4.4.4.5.3.1.cmml">;</mo><mi id="S3.E4.m1.4.4.4.2" xref="S3.E4.m1.4.4.4.2.cmml">𝒇</mi><mo stretchy="false" id="S3.E4.m1.4.4.4.5.3.2.3" xref="S3.E4.m1.4.4.4.5.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.5.cmml" xref="S3.E4.m1.4.5"><eq id="S3.E4.m1.4.5.1.cmml" xref="S3.E4.m1.4.5.1"></eq><apply id="S3.E4.m1.4.5.2.cmml" xref="S3.E4.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.2.1.cmml" xref="S3.E4.m1.4.5.2">superscript</csymbol><apply id="S3.E4.m1.4.5.2.2.cmml" xref="S3.E4.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.2.2.1.cmml" xref="S3.E4.m1.4.5.2">subscript</csymbol><ci id="S3.E4.m1.4.5.2.2.2.cmml" xref="S3.E4.m1.4.5.2.2.2">𝒘</ci><ci id="S3.E4.m1.4.5.2.2.3a.cmml" xref="S3.E4.m1.4.5.2.2.3"><mtext mathsize="70%" id="S3.E4.m1.4.5.2.2.3.cmml" xref="S3.E4.m1.4.5.2.2.3">pseudo</mtext></ci></apply><ci id="S3.E4.m1.4.5.2.3.cmml" xref="S3.E4.m1.4.5.2.3">𝒂</ci></apply><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.5.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><minus id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2"></minus><apply id="S3.E4.m1.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.4"><times id="S3.E4.m1.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.4.1"></times><ci id="S3.E4.m1.2.2.2.4.2.cmml" xref="S3.E4.m1.2.2.2.4.2">𝐸</ci><list id="S3.E4.m1.2.2.2.4.3.1.cmml" xref="S3.E4.m1.2.2.2.4.3.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒂</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝒇</ci></list></apply></apply><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><minus id="S3.E4.m1.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.3"></minus><apply id="S3.E4.m1.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4.4">superscript</csymbol><apply id="S3.E4.m1.4.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.2.1.cmml" xref="S3.E4.m1.4.4.4.4">subscript</csymbol><sum id="S3.E4.m1.4.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2"></sum><ci id="S3.E4.m1.4.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.4.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.4.3">𝑙</ci></apply><apply id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5"><times id="S3.E4.m1.4.4.4.5.1.cmml" xref="S3.E4.m1.4.4.4.5.1"></times><ci id="S3.E4.m1.4.4.4.5.2.cmml" xref="S3.E4.m1.4.4.4.5.2">𝐸</ci><list id="S3.E4.m1.4.4.4.5.3.1.cmml" xref="S3.E4.m1.4.4.4.5.3.2"><ci id="S3.E4.m1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.1">𝒊</ci><ci id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.2">𝒇</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\bm{w}_{\text{pseudo}}^{\bm{a}}=\frac{-E(\bm{a};\bm{f})}{\sum_{i}^{l}-E(\bm{i};\bm{f})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p4.8" class="ltx_p">where <math id="S3.SS2.SSS0.Px2.p4.5.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.5.m1.1a"><mi id="S3.SS2.SSS0.Px2.p4.5.m1.1.1" xref="S3.SS2.SSS0.Px2.p4.5.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.5.m1.1b"><ci id="S3.SS2.SSS0.Px2.p4.5.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.5.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.5.m1.1c">l</annotation></semantics></math> is the length of a predicted pseudo label. The training loss for this pseudo label is hence defined as:
<math id="S3.SS2.SSS0.Px2.p4.6.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\hat{y}}=\sum_{i}^{l}\bm{w}_{\text{pseudo}}^{i}\cdot\mathcal{L}_{\hat{y}}^{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.6.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p4.6.m2.1.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.2.cmml">ℒ</mi><mover accent="true" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.1.cmml">^</mo></mover></msub><mo rspace="0.111em" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.cmml"><msubsup id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.cmml"><mo id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.2.cmml">∑</mo><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.3.cmml">l</mi></msubsup><mrow id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.cmml"><msubsup id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.2.cmml">𝒘</mi><mtext id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3a.cmml">pseudo</mtext><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.1.cmml">⋅</mo><msubsup id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.2.cmml">ℒ</mi><mover accent="true" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.2" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.1" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.3" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.6.m2.1b"><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1"><eq id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.1"></eq><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.2">ℒ</ci><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3"><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.1">^</ci><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.2.3.2">𝑦</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3"><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.2"></sum><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.1.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2"><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.1">⋅</ci><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.2">𝒘</ci><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3a.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.2.3">pseudo</mtext></ci></apply><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.2">ℒ</ci><apply id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3"><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.1">^</ci><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.2.3.2">𝑦</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p4.6.m2.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.6.m2.1c">\mathcal{L}_{\hat{y}}=\sum_{i}^{l}\bm{w}_{\text{pseudo}}^{i}\cdot\mathcal{L}_{\hat{y}}^{i}</annotation></semantics></math>, where <math id="S3.SS2.SSS0.Px2.p4.7.m3.1" class="ltx_Math" alttext="\mathcal{L}_{\hat{y}}^{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.7.m3.1a"><msubsup id="S3.SS2.SSS0.Px2.p4.7.m3.1.1" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.2" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.2.cmml">ℒ</mi><mover accent="true" id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.2" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.1" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.7.m3.1b"><apply id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.2">ℒ</ci><apply id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3"><ci id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.1">^</ci><ci id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.2.3.2">𝑦</ci></apply></apply><ci id="S3.SS2.SSS0.Px2.p4.7.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.7.m3.1c">\mathcal{L}_{\hat{y}}^{i}</annotation></semantics></math> is the NLL loss of token <math id="S3.SS2.SSS0.Px2.p4.8.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p4.8.m4.1a"><mi id="S3.SS2.SSS0.Px2.p4.8.m4.1.1" xref="S3.SS2.SSS0.Px2.p4.8.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.8.m4.1b"><ci id="S3.SS2.SSS0.Px2.p4.8.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.8.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.8.m4.1c">i</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Dynamic Aggregation</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Aggregation weights in FL
<cite class="ltx_cite ltx_citemacro_citep">(McMahan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Li <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> and PFL <cite class="ltx_cite ltx_citemacro_citep">(Smith <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2017</a>; Li <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> are usually estimated according to the number of training instances in clients, which is not adaptive to the training performance of client models. Since different clients have different tasks and the degree of difficulty to learn is varying across tasks, it would be beneficial if aggregation weights could match the task difficulty of clients (i.e., paying more attention to harder tasks).</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">To achieve this purpose, we estimate the aggregation weight <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\bm{\delta_{i}}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝜹</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝜹</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\bm{\delta_{i}}</annotation></semantics></math> in Eq. (<a href="#S2.E1" title="In 2 Preliminary: Federated Learning ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\bm{\delta}_{i}=\frac{\mathcal{L}^{(i)}}{\sum_{i}^{K}\mathcal{L}^{(i)}},\\
" display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><msub id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2" xref="S3.E5.m1.3.3.1.1.2.2.cmml">𝜹</mi><mi id="S3.E5.m1.3.3.1.1.2.3" xref="S3.E5.m1.3.3.1.1.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msup id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.cmml">)</mo></mrow></msup><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><msubsup id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><mo id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">∑</mo><mi id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.cmml">K</mi></msubsup><msup id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.3.2" xref="S3.E5.m1.2.2.2.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.1.1.3.1" xref="S3.E5.m1.2.2.2.3.cmml">(</mo><mi id="S3.E5.m1.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.1.1.3.2" xref="S3.E5.m1.2.2.2.3.cmml">)</mo></mrow></msup></mrow></mfrac></mrow><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"></eq><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2">𝜹</ci><ci id="S3.E5.m1.3.3.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">ℒ</ci><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝑖</ci></apply><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2">subscript</csymbol><sum id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"></sum><ci id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.3">superscript</csymbol><ci id="S3.E5.m1.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.3.2">ℒ</ci><ci id="S3.E5.m1.2.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.2.1.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\bm{\delta}_{i}=\frac{\mathcal{L}^{(i)}}{\sum_{i}^{K}\mathcal{L}^{(i)}},\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.3" class="ltx_p">where <math id="S3.SS3.p2.2.m1.3" class="ltx_Math" alttext="\mathcal{L}^{(i)}=\mathcal{L}^{(i)}_{\text{pseudo}}+\mathcal{L}^{(i)}_{\text{annotated}}" display="inline"><semantics id="S3.SS3.p2.2.m1.3a"><mrow id="S3.SS3.p2.2.m1.3.4" xref="S3.SS3.p2.2.m1.3.4.cmml"><msup id="S3.SS3.p2.2.m1.3.4.2" xref="S3.SS3.p2.2.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m1.3.4.2.2" xref="S3.SS3.p2.2.m1.3.4.2.2.cmml">ℒ</mi><mrow id="S3.SS3.p2.2.m1.1.1.1.3" xref="S3.SS3.p2.2.m1.3.4.2.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m1.1.1.1.3.1" xref="S3.SS3.p2.2.m1.3.4.2.cmml">(</mo><mi id="S3.SS3.p2.2.m1.1.1.1.1" xref="S3.SS3.p2.2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p2.2.m1.1.1.1.3.2" xref="S3.SS3.p2.2.m1.3.4.2.cmml">)</mo></mrow></msup><mo id="S3.SS3.p2.2.m1.3.4.1" xref="S3.SS3.p2.2.m1.3.4.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m1.3.4.3" xref="S3.SS3.p2.2.m1.3.4.3.cmml"><msubsup id="S3.SS3.p2.2.m1.3.4.3.2" xref="S3.SS3.p2.2.m1.3.4.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m1.3.4.3.2.2.2" xref="S3.SS3.p2.2.m1.3.4.3.2.2.2.cmml">ℒ</mi><mtext id="S3.SS3.p2.2.m1.3.4.3.2.3" xref="S3.SS3.p2.2.m1.3.4.3.2.3a.cmml">pseudo</mtext><mrow id="S3.SS3.p2.2.m1.2.2.1.3" xref="S3.SS3.p2.2.m1.3.4.3.2.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m1.2.2.1.3.1" xref="S3.SS3.p2.2.m1.3.4.3.2.cmml">(</mo><mi id="S3.SS3.p2.2.m1.2.2.1.1" xref="S3.SS3.p2.2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p2.2.m1.2.2.1.3.2" xref="S3.SS3.p2.2.m1.3.4.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.2.m1.3.4.3.1" xref="S3.SS3.p2.2.m1.3.4.3.1.cmml">+</mo><msubsup id="S3.SS3.p2.2.m1.3.4.3.3" xref="S3.SS3.p2.2.m1.3.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m1.3.4.3.3.2.2" xref="S3.SS3.p2.2.m1.3.4.3.3.2.2.cmml">ℒ</mi><mtext id="S3.SS3.p2.2.m1.3.4.3.3.3" xref="S3.SS3.p2.2.m1.3.4.3.3.3a.cmml">annotated</mtext><mrow id="S3.SS3.p2.2.m1.3.3.1.3" xref="S3.SS3.p2.2.m1.3.4.3.3.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m1.3.3.1.3.1" xref="S3.SS3.p2.2.m1.3.4.3.3.cmml">(</mo><mi id="S3.SS3.p2.2.m1.3.3.1.1" xref="S3.SS3.p2.2.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p2.2.m1.3.3.1.3.2" xref="S3.SS3.p2.2.m1.3.4.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.3b"><apply id="S3.SS3.p2.2.m1.3.4.cmml" xref="S3.SS3.p2.2.m1.3.4"><eq id="S3.SS3.p2.2.m1.3.4.1.cmml" xref="S3.SS3.p2.2.m1.3.4.1"></eq><apply id="S3.SS3.p2.2.m1.3.4.2.cmml" xref="S3.SS3.p2.2.m1.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.3.4.2.1.cmml" xref="S3.SS3.p2.2.m1.3.4.2">superscript</csymbol><ci id="S3.SS3.p2.2.m1.3.4.2.2.cmml" xref="S3.SS3.p2.2.m1.3.4.2.2">ℒ</ci><ci id="S3.SS3.p2.2.m1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.p2.2.m1.3.4.3.cmml" xref="S3.SS3.p2.2.m1.3.4.3"><plus id="S3.SS3.p2.2.m1.3.4.3.1.cmml" xref="S3.SS3.p2.2.m1.3.4.3.1"></plus><apply id="S3.SS3.p2.2.m1.3.4.3.2.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.3.4.3.2.1.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2">subscript</csymbol><apply id="S3.SS3.p2.2.m1.3.4.3.2.2.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.3.4.3.2.2.1.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2">superscript</csymbol><ci id="S3.SS3.p2.2.m1.3.4.3.2.2.2.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2.2.2">ℒ</ci><ci id="S3.SS3.p2.2.m1.2.2.1.1.cmml" xref="S3.SS3.p2.2.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.SS3.p2.2.m1.3.4.3.2.3a.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2.3"><mtext mathsize="70%" id="S3.SS3.p2.2.m1.3.4.3.2.3.cmml" xref="S3.SS3.p2.2.m1.3.4.3.2.3">pseudo</mtext></ci></apply><apply id="S3.SS3.p2.2.m1.3.4.3.3.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.3.4.3.3.1.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3">subscript</csymbol><apply id="S3.SS3.p2.2.m1.3.4.3.3.2.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.3.4.3.3.2.1.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3">superscript</csymbol><ci id="S3.SS3.p2.2.m1.3.4.3.3.2.2.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3.2.2">ℒ</ci><ci id="S3.SS3.p2.2.m1.3.3.1.1.cmml" xref="S3.SS3.p2.2.m1.3.3.1.1">𝑖</ci></apply><ci id="S3.SS3.p2.2.m1.3.4.3.3.3a.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3.3"><mtext mathsize="70%" id="S3.SS3.p2.2.m1.3.4.3.3.3.cmml" xref="S3.SS3.p2.2.m1.3.4.3.3.3">annotated</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.3c">\mathcal{L}^{(i)}=\mathcal{L}^{(i)}_{\text{pseudo}}+\mathcal{L}^{(i)}_{\text{annotated}}</annotation></semantics></math>, which is the total training loss on client <math id="S3.SS3.p2.3.m2.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS3.p2.3.m2.1a"><msub id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml"><mi id="S3.SS3.p2.3.m2.1.1.2" xref="S3.SS3.p2.3.m2.1.1.2.cmml">u</mi><mi id="S3.SS3.p2.3.m2.1.1.3" xref="S3.SS3.p2.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><apply id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m2.1.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m2.1.1.2.cmml" xref="S3.SS3.p2.3.m2.1.1.2">𝑢</ci><ci id="S3.SS3.p2.3.m2.1.1.3.cmml" xref="S3.SS3.p2.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">u_{i}</annotation></semantics></math>, the sum of the loss on the weighted pseudo samples and that on the annotated samples.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.4" class="ltx_p">The weight <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\bm{\delta_{i}}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">𝜹</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝜹</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\bm{\delta_{i}}</annotation></semantics></math> for client model <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝑭</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑭</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\bm{F}_{i}</annotation></semantics></math> is proportional to <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">𝑭</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑭</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\bm{F}_{i}</annotation></semantics></math>’s training loss.
A large weight suggests that tasks in client <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑢</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">u_{i}</annotation></semantics></math> are challenging.
Similar to the essence of AdaBoost <cite class="ltx_cite ltx_citemacro_citep">(Freund <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib9" title="" class="ltx_ref">1996</a>)</cite>,
the client model with a larger weight (i.e., with poorer performance) plays a more important role in model aggregation and thus the challenging tasks are paid more attention to.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We examined the effectiveness of the proposed <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> on a wide range of tasks.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>

<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">We followed <cite class="ltx_cite ltx_citemacro_citet">Ye <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> to use 118 tasks from the Huggingface Datasets <cite class="ltx_cite ltx_citemacro_citep">(Lhoest <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>, which are categorized into 4 groups: classification, QA, conditional generation and other.
All tasks were reframed into the same text-to-text format.
The number of clients was set to 4 by default.
The numbers of tasks in the clients were set as evenly as possible: 29, 29, 29, 31, respectively.
Each client had randomly selected and diversified tasks so that we could evaluate the cross-task generalization performance in the client models.
Details of the selected tasks and task distribution over clients are shown in Appendix <a href="#A1.SS1" title="A.1 Task Type and Distribution ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Few-shot Setting</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">We used the few-shot sampling method of <cite class="ltx_cite ltx_citemacro_citet">Gao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite> for our few-shot learning.
For generation tasks (e.g., summarization, dialogue), 32 training examples were selected for each task.
For classification tasks (e.g., natural language inference, sentiment analysis), 16 examples were selected for each task.
Since labeled data are rare in real-world scenario, our test sets also followed the same few-shot setting as the training sets.
To eliminate random factors, we chose 5 different random seeds to select few-shot samples. These selected samples collectively construct the training set and test set.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training Details</h4>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.1" class="ltx_p">We chose BART-Base <cite class="ltx_cite ltx_citemacro_citep">(Lewis <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite> (140M parameters) as our client and global model.
The training hyperparameters for <span id="S4.SS1.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> were set as follows: 20 as the number of training epochs, 3e-5 for learning rate with a linear warm up, 8 for the batch size. The top-7 largest logit values were selected to compute the energy and the temperature parameter for the energy function was set to 1.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines</h4>

<div id="S4.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px4.p1.1" class="ltx_p">We compared the proposed <span id="S4.SS1.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> against the following baselines:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Data Silo:</span> Each client trains a model with its own private data. This method serves as the base model for PIR evaluation.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Data Silo DA:</span> Data augmentation is used for the Data Silo training and the numbers of training samples after data augmentation in clients are the same as those in <span id="S4.I1.i2.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Centralized Training:</span> We train a central model with all data put together. Note that the Centralized Training does not take data privacy into account, which is to show the oracle result at the cost of data privacy.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite><span id="S4.I1.i4.p1.1.2" class="ltx_text ltx_font_bold">:</span> A classical FL algorithm, in which clients participate in training a global model but there are no personalized client models.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><span id="S4.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">Ditto</span> <cite class="ltx_cite ltx_citemacro_citep">(Li <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite><span id="S4.I1.i5.p1.1.2" class="ltx_text ltx_font_bold">:</span> A general framework for personalized federate learning, which achieves personalization by regularizing client models towards their average. Ditto mainly focuses on fairness and robustness in FL instead of the limited data and task heterogeneity.</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para">
<p id="S4.I1.i6.p1.1" class="ltx_p"><span id="S4.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">Meta Weighting:</span> We follow <cite class="ltx_cite ltx_citemacro_citet">Ren <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> to use a meta-learning based method to weight pseudo samples in our data augmentation component (see Section <a href="#S3.SS2" title="3.2 Data Augmentation ‣ 3 Methodology ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>) for each client. This meta weighting approach serves as a strong baseline to compare with our energy-based weighting.
More details of the meta-learning based weighting are provided in Appendix <a href="#A1.SS2" title="A.2 Meta Weighting ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS1.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation Metrics</h4>

<div id="S4.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p1.3" class="ltx_p">Evaluation metrics for different tasks vary widely. Averaging metrics of different tasks hence doesn’t make sense.
In order to evaluate the performance of <span id="S4.SS1.SSS0.Px5.p1.3.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> in comparison to baselines and tackle the problem of incompatable metrics, we define a unified metric: average performance improvement rate (APIR).
The performance improvement rate (PIR) refers to how much the performance has been improved over the base model. The PIR is computed as follows:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\text{PIR}=\frac{m_{\text{new}}-m_{\text{base}}}{m_{\text{base}}}," display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mtext id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2a.cmml">PIR</mtext><mo id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mrow id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml"><msub id="S4.E6.m1.1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2.2.2" xref="S4.E6.m1.1.1.1.1.3.2.2.2.cmml">m</mi><mtext id="S4.E6.m1.1.1.1.1.3.2.2.3" xref="S4.E6.m1.1.1.1.1.3.2.2.3a.cmml">new</mtext></msub><mo id="S4.E6.m1.1.1.1.1.3.2.1" xref="S4.E6.m1.1.1.1.1.3.2.1.cmml">−</mo><msub id="S4.E6.m1.1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2.3.2" xref="S4.E6.m1.1.1.1.1.3.2.3.2.cmml">m</mi><mtext id="S4.E6.m1.1.1.1.1.3.2.3.3" xref="S4.E6.m1.1.1.1.1.3.2.3.3a.cmml">base</mtext></msub></mrow><msub id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.3.3.2.cmml">m</mi><mtext id="S4.E6.m1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.3.3.3a.cmml">base</mtext></msub></mfrac></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"></eq><ci id="S4.E6.m1.1.1.1.1.2a.cmml" xref="S4.E6.m1.1.1.1.1.2"><mtext id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2">PIR</mtext></ci><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><divide id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3"></divide><apply id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2"><minus id="S4.E6.m1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2.1"></minus><apply id="S4.E6.m1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2.2">𝑚</ci><ci id="S4.E6.m1.1.1.1.1.3.2.2.3a.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S4.E6.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2.3">new</mtext></ci></apply><apply id="S4.E6.m1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.2">𝑚</ci><ci id="S4.E6.m1.1.1.1.1.3.2.3.3a.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.3"><mtext mathsize="70%" id="S4.E6.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.3">base</mtext></ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2">𝑚</ci><ci id="S4.E6.m1.1.1.1.1.3.3.3a.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3"><mtext mathsize="70%" id="S4.E6.m1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3">base</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\text{PIR}=\frac{m_{\text{new}}-m_{\text{base}}}{m_{\text{base}}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px5.p1.2" class="ltx_p">where <math id="S4.SS1.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="m_{\text{new}}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px5.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.2.cmml">m</mi><mtext id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3a.cmml">new</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3a.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.3">new</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.1.m1.1c">m_{\text{new}}</annotation></semantics></math> refers to the performance of the new model
while <math id="S4.SS1.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="m_{\text{base}}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px5.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.2.cmml">m</mi><mtext id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3a.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.3">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.2.m2.1c">m_{\text{base}}</annotation></semantics></math> is the performance of the base model in terms of the widely-used metric for the corresponding task.
In our experiments, the base model refers to Data Silo by default.
The APIR is the average of PIRs across all tasks.
Each client has its own APIR and the APIR averaged over the four clients is reported as the APIR for the corresponding method.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:200.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(64.5pt,-37.3pt) scale(1.59145251304354,1.59145251304354) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">APIR</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Win</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Lose</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Tie</span></td>
</tr>
<tr id="S4.T1.1.1.2" class="ltx_tr">
<td id="S4.T1.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.1.1" class="ltx_text" style="font-size:90%;">Data Silo DA</span></td>
<td id="S4.T1.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.2.1" class="ltx_text" style="font-size:90%;">8.2%</span></td>
<td id="S4.T1.1.1.2.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.3.1" class="ltx_text" style="font-size:90%;">44</span></td>
<td id="S4.T1.1.1.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.4.1" class="ltx_text" style="font-size:90%;">29</span></td>
<td id="S4.T1.1.1.2.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.5.1" class="ltx_text" style="font-size:90%;">45</span></td>
</tr>
<tr id="S4.T1.1.1.3" class="ltx_tr">
<td id="S4.T1.1.1.3.1" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S4.T1.1.1.3.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.2.1" class="ltx_text" style="font-size:90%;">5.1%</span></td>
<td id="S4.T1.1.1.3.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.3.1" class="ltx_text" style="font-size:90%;">40</span></td>
<td id="S4.T1.1.1.3.4" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.4.1" class="ltx_text" style="font-size:90%;">41</span></td>
<td id="S4.T1.1.1.3.5" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.5.1" class="ltx_text" style="font-size:90%;">37</span></td>
</tr>
<tr id="S4.T1.1.1.4" class="ltx_tr">
<td id="S4.T1.1.1.4.1" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.4.1.1" class="ltx_text" style="font-size:90%;">Ditto</span></td>
<td id="S4.T1.1.1.4.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.4.2.1" class="ltx_text" style="font-size:90%;">14.1%</span></td>
<td id="S4.T1.1.1.4.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.4.3.1" class="ltx_text" style="font-size:90%;">45</span></td>
<td id="S4.T1.1.1.4.4" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.4.4.1" class="ltx_text" style="font-size:90%;">34</span></td>
<td id="S4.T1.1.1.4.5" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.4.5.1" class="ltx_text" style="font-size:90%;">39</span></td>
</tr>
<tr id="S4.T1.1.1.5" class="ltx_tr">
<td id="S4.T1.1.1.5.1" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.5.1.1" class="ltx_text" style="font-size:90%;">Meta Weighting</span></td>
<td id="S4.T1.1.1.5.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.5.2.1" class="ltx_text" style="font-size:90%;">22.6%</span></td>
<td id="S4.T1.1.1.5.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.5.3.1" class="ltx_text" style="font-size:90%;">49</span></td>
<td id="S4.T1.1.1.5.4" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.5.4.1" class="ltx_text" style="font-size:90%;">32</span></td>
<td id="S4.T1.1.1.5.5" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.5.5.1" class="ltx_text" style="font-size:90%;">37</span></td>
</tr>
<tr id="S4.T1.1.1.6" class="ltx_tr">
<td id="S4.T1.1.1.6.1" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FewFedWeight</span></td>
<td id="S4.T1.1.1.6.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">30.5%</span></td>
<td id="S4.T1.1.1.6.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">72</span></td>
<td id="S4.T1.1.1.6.4" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.6.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">7</span></td>
<td id="S4.T1.1.1.6.5" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.6.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39</span></td>
</tr>
<tr id="S4.T1.1.1.7" class="ltx_tr">
<td id="S4.T1.1.1.7.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T1.1.1.7.1.1" class="ltx_text" style="font-size:90%;">Centralized Training</span></td>
<td id="S4.T1.1.1.7.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T1.1.1.7.2.1" class="ltx_text" style="font-size:90%;">36.9%</span></td>
<td id="S4.T1.1.1.7.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T1.1.1.7.3.1" class="ltx_text" style="font-size:90%;">65</span></td>
<td id="S4.T1.1.1.7.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T1.1.1.7.4.1" class="ltx_text" style="font-size:90%;">16</span></td>
<td id="S4.T1.1.1.7.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t"><span id="S4.T1.1.1.7.5.1" class="ltx_text" style="font-size:90%;">37</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>APIR results of different methods. Win/Lose/Tie is the number of tasks on which the corresponding method is better/worse than or as good as the base model (i.e., data silo without data augmentation).</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Overall Performance</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The overall results are shown in Table <a href="#S4.T1" title="Table 1 ‣ Evaluation Metrics ‣ 4.1 Setup ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We observe that FedAvg is not able to well handle few-shot multi-task learning.
Although FedAvg leverages the data from all clients through federated learning, it performs just slightly better than Data Silo.
The AIPR of Data Silo DA demonstrates that data augmentation is beneficial to few-shot learning.
Although each client can only use its own private data in Data Silo DA, both its APIR and the number of Win tasks are better than those of FedAvg.
The recently proposed PFL framework, Ditto, achieves better APIR than FedAvg and Data Silo DA.
However, it is worse than Meta Weighting.
As a strong baseline, Meta Weighting achieves promising performance. Due to its global data augmentation and meta-learning based pseudo sample weighting, the dilemma between data scarcity in few-shot learning and noise in data augmentation can be alleviated to some extent. However, its time complexity is very high due to the meta-learning procedure shown in Appendix <a href="#A1.SS2" title="A.2 Meta Weighting ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>. Additionally, it is worse than <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> in terms of APIR.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2212.08354/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="241" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>PIR results of FedAvg and <span id="S4.F4.2.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> on different tasks.</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> achieves 30.5% in APIR over Data Silo.
Its APIR is close to that of Centralized Training and the number of Win tasks is even larger than that of Centralized Training.
In order to have a clear comparison with classic FedAvg, we illustrate their PIRs on non-tie tasks in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Overall Performance ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:108.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(29.9pt,-9.4pt) scale(1.20811473461053,1.20811473461053) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">APIR</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Win</span></td>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Lose</span></td>
<td id="S4.T2.1.1.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">Tie</span></td>
</tr>
<tr id="S4.T2.1.1.2" class="ltx_tr">
<td id="S4.T2.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg + Data Augmentation</td>
<td id="S4.T2.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t">11.5%</td>
<td id="S4.T2.1.1.2.3" class="ltx_td ltx_align_left ltx_border_t">43</td>
<td id="S4.T2.1.1.2.4" class="ltx_td ltx_align_left ltx_border_t">33</td>
<td id="S4.T2.1.1.2.5" class="ltx_td ltx_align_left ltx_border_t">42</td>
</tr>
<tr id="S4.T2.1.1.3" class="ltx_tr">
<td id="S4.T2.1.1.3.1" class="ltx_td ltx_align_left">   + Pseudo Data Weighting</td>
<td id="S4.T2.1.1.3.2" class="ltx_td ltx_align_left">27.0%</td>
<td id="S4.T2.1.1.3.3" class="ltx_td ltx_align_left">74</td>
<td id="S4.T2.1.1.3.4" class="ltx_td ltx_align_left">6</td>
<td id="S4.T2.1.1.3.5" class="ltx_td ltx_align_left">38</td>
</tr>
<tr id="S4.T2.1.1.4" class="ltx_tr">
<td id="S4.T2.1.1.4.1" class="ltx_td ltx_align_left">   + Dynamic Aggregation</td>
<td id="S4.T2.1.1.4.2" class="ltx_td ltx_align_left">21.0%</td>
<td id="S4.T2.1.1.4.3" class="ltx_td ltx_align_left">64</td>
<td id="S4.T2.1.1.4.4" class="ltx_td ltx_align_left">16</td>
<td id="S4.T2.1.1.4.5" class="ltx_td ltx_align_left">38</td>
</tr>
<tr id="S4.T2.1.1.5" class="ltx_tr">
<td id="S4.T2.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.1.5.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span></td>
<td id="S4.T2.1.1.5.2" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.1.5.2.1" class="ltx_text ltx_font_bold">30.5%</span></td>
<td id="S4.T2.1.1.5.3" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.1.5.3.1" class="ltx_text ltx_font_bold">72</span></td>
<td id="S4.T2.1.1.5.4" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.1.5.4.1" class="ltx_text ltx_font_bold">7</span></td>
<td id="S4.T2.1.1.5.5" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T2.1.1.5.5.1" class="ltx_text ltx_font_bold">39</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation study results of <span id="S4.T2.3.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> contains three essential components: data augmentation with global knowledge,
energy-based pseudo data weighting and dynamic aggregation,
which collectively contribute to the advantage of <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>. We further conducted ablation experiments to investigate the effectiveness of the three components. Results are shown in Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Overall Performance ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">FedAvg+Data Augmentation is similar to Data Silo DA in that both use augmented data, but the latter synthesizes pseudo data with its client model.
The APIR of FedAvg + DA is 3.3% higher than that of Data Silo DA. We conjecture that this improvement could attribute to cross-task knowledge transfer brought by pseudo data synthesized by the global model.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">The energy-based pseudo data weighting significantly outperforms data augmentation by 15.5% in APIR while the dynamic aggregation achieves an improvement of 9.5% over data augmentation, suggesting that the two components are effective and beneficial to <span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>. The three components together achieve further improvements over both the data augmentation + pseudo data weighting and data augmentation + dynamic aggregation.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Varying the Number of Clients</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To verify the stability of <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> over different numbers of clients, we conducted experiments in 4 settings with different numbers of clients. In order to have a fair comparison, we fixed the number of tasks on each client as the number of clients participating in FL training is varying. Five tasks were assigned to each client. We evaluated <span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> on 2, 4, 8, 12 clients respectively. Results are reported in Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Varying the Number of Clients ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We observe that <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> has a remarkable stability across different numbers of clients. The APIR of 2 clients and 12 clients is slightly lower than that of the other two settings although they win in almost all tasks.
We conjecture that increasing the number of clients can improve the number of win tasks as more information is incorporated. But it’s hard to improve the APIR over all tasks as these tasks are distributed over more clients.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:255.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(112.4pt,-82.9pt) scale(2.84180370830235,2.84180370830235) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:50%;">#Clients</span></td>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:50%;">APIR</span></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:50%;">Win</span></td>
<td id="S4.T3.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:50%;">Lose</span></td>
<td id="S4.T3.1.1.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:50%;">Tie</span></td>
</tr>
<tr id="S4.T3.1.1.2" class="ltx_tr">
<td id="S4.T3.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.2.1.1" class="ltx_text" style="font-size:50%;">2</span></td>
<td id="S4.T3.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.2.2.1" class="ltx_text" style="font-size:50%;">23.2%</span></td>
<td id="S4.T3.1.1.2.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.2.3.1" class="ltx_text" style="font-size:50%;">8</span></td>
<td id="S4.T3.1.1.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.2.4.1" class="ltx_text" style="font-size:50%;">0</span></td>
<td id="S4.T3.1.1.2.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.2.5.1" class="ltx_text" style="font-size:50%;">2</span></td>
</tr>
<tr id="S4.T3.1.1.3" class="ltx_tr">
<td id="S4.T3.1.1.3.1" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.3.1.1" class="ltx_text" style="font-size:50%;">4</span></td>
<td id="S4.T3.1.1.3.2" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.3.2.1" class="ltx_text" style="font-size:50%;">29.5%</span></td>
<td id="S4.T3.1.1.3.3" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.3.3.1" class="ltx_text" style="font-size:50%;">12</span></td>
<td id="S4.T3.1.1.3.4" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.3.4.1" class="ltx_text" style="font-size:50%;">5</span></td>
<td id="S4.T3.1.1.3.5" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.3.5.1" class="ltx_text" style="font-size:50%;">3</span></td>
</tr>
<tr id="S4.T3.1.1.4" class="ltx_tr">
<td id="S4.T3.1.1.4.1" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.4.1.1" class="ltx_text" style="font-size:50%;">8</span></td>
<td id="S4.T3.1.1.4.2" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.4.2.1" class="ltx_text" style="font-size:50%;">29.8%</span></td>
<td id="S4.T3.1.1.4.3" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.4.3.1" class="ltx_text" style="font-size:50%;">24</span></td>
<td id="S4.T3.1.1.4.4" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.4.4.1" class="ltx_text" style="font-size:50%;">9</span></td>
<td id="S4.T3.1.1.4.5" class="ltx_td ltx_align_left"><span id="S4.T3.1.1.4.5.1" class="ltx_text" style="font-size:50%;">7</span></td>
</tr>
<tr id="S4.T3.1.1.5" class="ltx_tr">
<td id="S4.T3.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T3.1.1.5.1.1" class="ltx_text" style="font-size:50%;">12</span></td>
<td id="S4.T3.1.1.5.2" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T3.1.1.5.2.1" class="ltx_text" style="font-size:50%;">22.8%</span></td>
<td id="S4.T3.1.1.5.3" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T3.1.1.5.3.1" class="ltx_text" style="font-size:50%;">37</span></td>
<td id="S4.T3.1.1.5.4" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T3.1.1.5.4.1" class="ltx_text" style="font-size:50%;">9</span></td>
<td id="S4.T3.1.1.5.5" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T3.1.1.5.5.1" class="ltx_text" style="font-size:50%;">14</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:50%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of different number of clients. The total number of tasks varies with the number of clients. </figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Training Cost</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We further compared <span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> with other baselines in terms of the training time and communication time between clients and the server.
The additional training time of <span id="S4.SS5.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> mainly comes from the data augmentation component because it needs to predict pseudo labels for all samples in each epoch. The time for generating pseudo data is the same for all methods with data augmentation (e.g., Data Silo DA, Meta Weighting). The training/generating time of one epoch over different methods is shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.5 Training Cost ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:86.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(29.5pt,-7.4pt) scale(1.20514190072235,1.20514190072235) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></td>
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">Generating</span></td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">Training</span></td>
<td id="S4.T4.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.1.1.4.1" class="ltx_text ltx_font_bold">Total</span></td>
</tr>
<tr id="S4.T4.1.1.2" class="ltx_tr">
<td id="S4.T4.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg/Ditto</td>
<td id="S4.T4.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t">0</td>
<td id="S4.T4.1.1.2.3" class="ltx_td ltx_align_left ltx_border_t">2</td>
<td id="S4.T4.1.1.2.4" class="ltx_td ltx_align_left ltx_border_t">2</td>
</tr>
<tr id="S4.T4.1.1.3" class="ltx_tr">
<td id="S4.T4.1.1.3.1" class="ltx_td ltx_align_left">
<span id="S4.T4.1.1.3.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>/DataSilo DA</td>
<td id="S4.T4.1.1.3.2" class="ltx_td ltx_align_left">13</td>
<td id="S4.T4.1.1.3.3" class="ltx_td ltx_align_left">4</td>
<td id="S4.T4.1.1.3.4" class="ltx_td ltx_align_left">17</td>
</tr>
<tr id="S4.T4.1.1.4" class="ltx_tr">
<td id="S4.T4.1.1.4.1" class="ltx_td ltx_align_left ltx_border_b">Meta Weighting</td>
<td id="S4.T4.1.1.4.2" class="ltx_td ltx_align_left ltx_border_b">13</td>
<td id="S4.T4.1.1.4.3" class="ltx_td ltx_align_left ltx_border_b">8</td>
<td id="S4.T4.1.1.4.4" class="ltx_td ltx_align_left ltx_border_b">21</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The time cost of different methods on one epoch of the local training of a client (i.e., time units per epoch).
</figcaption>
</figure>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> doesn’t require extra time except for generating and training on pseudo data (The training time is twice as long as FedAvg because the size of total training data is doubled) while Meta Weighting requires more training time on pseudo data (details of meta-weighting is shown in Appendix <a href="#A1.SS2" title="A.2 Meta Weighting ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>).</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.3" class="ltx_p">The communication cost of <span id="S4.SS5.p3.3.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> is almost the same as FedAvg or Ditto, as the extra communication is brought by sending the training loss <math id="S4.SS5.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}^{(i)}" display="inline"><semantics id="S4.SS5.p3.1.m1.1a"><msup id="S4.SS5.p3.1.m1.1.2" xref="S4.SS5.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p3.1.m1.1.2.2" xref="S4.SS5.p3.1.m1.1.2.2.cmml">ℒ</mi><mrow id="S4.SS5.p3.1.m1.1.1.1.3" xref="S4.SS5.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS5.p3.1.m1.1.1.1.3.1" xref="S4.SS5.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS5.p3.1.m1.1.1.1.1" xref="S4.SS5.p3.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.SS5.p3.1.m1.1.1.1.3.2" xref="S4.SS5.p3.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS5.p3.1.m1.1.2.1.cmml" xref="S4.SS5.p3.1.m1.1.2">superscript</csymbol><ci id="S4.SS5.p3.1.m1.1.2.2.cmml" xref="S4.SS5.p3.1.m1.1.2.2">ℒ</ci><ci id="S4.SS5.p3.1.m1.1.1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">\mathcal{L}^{(i)}</annotation></semantics></math> to the server <math id="S4.SS5.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S4.SS5.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><ci id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">\mathcal{S}</annotation></semantics></math>. Such transmission time is almost negligible compared to the training time of client model <math id="S4.SS5.p3.3.m3.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="S4.SS5.p3.3.m3.1a"><msub id="S4.SS5.p3.3.m3.1.1" xref="S4.SS5.p3.3.m3.1.1.cmml"><mi id="S4.SS5.p3.3.m3.1.1.2" xref="S4.SS5.p3.3.m3.1.1.2.cmml">𝑭</mi><mi id="S4.SS5.p3.3.m3.1.1.3" xref="S4.SS5.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.3.m3.1b"><apply id="S4.SS5.p3.3.m3.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.3.m3.1.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p3.3.m3.1.1.2.cmml" xref="S4.SS5.p3.3.m3.1.1.2">𝑭</ci><ci id="S4.SS5.p3.3.m3.1.1.3.cmml" xref="S4.SS5.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.3.m3.1c">\bm{F}_{i}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Analysis on the Impact of Dynamic Aggregation</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">In order to look into the difference between FedAvg and <span id="S4.SS6.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>, we adopted the model weights of FedAvg in the first 10 training epochs while those of <span id="S4.SS6.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> are used in the last 10 training epochs. The curves of weights of the 4 client models during training are shown in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.6 Analysis on the Impact of Dynamic Aggregation ‣ 4 Experiments ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2212.08354/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="276" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Client model weights learned by FedAvg vs. <span id="S4.F5.2.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>.</figcaption>
</figure>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">In the first 10 epochs, FedAvg assigns the smallest model weight to client 2 because the amount of training data in client 2 is the smallest.
When we use <span id="S4.SS6.p2.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span> in the second 10 epochs, the model weight of client 2 becomes the largest due to its worst performance.
Its weight then becomes lower, demonstrating that its performance is getting better gradually in the second 10 epochs. Additionally, the weights of the four client models tend to be stably changing as the number of training epochs increases.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>

<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Few-shot Multi-task Learning in NLP</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">Large language models <cite class="ltx_cite ltx_citemacro_citep">(Brown <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Zhang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2021b</a>; Perez <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> achieve substantial progress on few-shot learning, thanks to the implicit multi-task learning in the pretraining of language models <cite class="ltx_cite ltx_citemacro_cite">Radford <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib28" title="" class="ltx_ref">2019</a>); Sanh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>.
A variety of efforts <cite class="ltx_cite ltx_citemacro_citep">(Narayan <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>; Raffel <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2020b</a>; Du <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite> have been devoted to mapping a wide range of NLP downstream tasks into a unified form.
For example, <cite class="ltx_cite ltx_citemacro_citet">Narayan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite> redefines the NLU tasks as generating specified answers through automatic prompts.
Natural language templates (prompts) <cite class="ltx_cite ltx_citemacro_citep">(Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2021c</a>; Du <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite> have also been explored to reframe different NLP tasks into a unified text-to-text generation task.
Such efforts facilitate the standardization of few-shot multi-task learning process <cite class="ltx_cite ltx_citemacro_citep">(Bragg <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib1" title="" class="ltx_ref">2021</a>; Ye <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>.
Significantly different from these studies, we explore few-shot multi-task learning in a decentralized environment.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Data Augmentation</h4>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">Data augmentation is to automatically increase the amount and diversity of training data without explicitly collecting new data <cite class="ltx_cite ltx_citemacro_citep">(Feng <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>. It has been widely used in computer vision and natural language processing to address issues such as low-resource language processing <cite class="ltx_cite ltx_citemacro_citep">(Qin <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>, bias mitigation <cite class="ltx_cite ltx_citemacro_citep">(Zhao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite>, imbalanced data <cite class="ltx_cite ltx_citemacro_citep">(Chawla <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2002</a>)</cite>, few-shot learning <cite class="ltx_cite ltx_citemacro_citep">(Lee <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>. In our work, we automatically generate pseudo data to alleviate the problem of insufficient data in local client training.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Federated Learning</h4>

<div id="S5.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p1.1" class="ltx_p">Federated Learning (a.k.a collaborative learning) <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2016</a>; Chen <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite> is a decentralized machine learning technique, where heterogeneous training data are stored locally on each client and are not exchangeable across clients during the training process.
Textual data are crucial for many NLP tasks, which may be privacy-sensitive, especially for those collected from edge devices (e.g., mobile phones).
In this aspect, recent years have witnessed growing interest in the intersection of NLP and federated learning <cite class="ltx_cite ltx_citemacro_citep">(Garcia Bernal, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>; Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2021a</a>)</cite>.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">FL with Few-shot or Multi-task Learning</h4>

<div id="S5.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px4.p1.1" class="ltx_p">The inherent decentralization, heterogeneity and privacy-awareness in federated learning make it naturally suitable to unite FL with multi-task learning and few-shot learning <cite class="ltx_cite ltx_citemacro_cite">Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib41" title="" class="ltx_ref">2021a</a>)</cite>. For few-shot federated learning, methods such as adversarial learning <cite class="ltx_cite ltx_citemacro_citep">(Fan and Huang, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> or self-supervision <cite class="ltx_cite ltx_citemacro_citep">(Shome and Kar, <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> have been exploited in the federated learning setting to learn from scarce data or use unlabeled data to alleviate the lack of supervised data.
And federated learning can be naturally embedded into the multi-task learning framework due to its distributed learning <cite class="ltx_cite ltx_citemacro_citep">(Smith <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2017</a>; Marfoq <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2021</a>; Huang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>.
In this aspect, <cite class="ltx_cite ltx_citemacro_citet">Smith <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite> pioneer and frame federated multi-task learning with <span id="S5.SS0.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_italic">MOCHA</span>, where relationships among tasks (clients) are separately modeled during the optimization of weights of tasks.
Our work is different from these methods in that we focus on the scenario of both few-shot and multi-task learning.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we have presented <span id="S6.p1.1.1" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>, enabling few-shot learning across massive NLP tasks with federated learning.
In this new framework, the global model synthesizes pseudo samples for each client model, which are weighted by an energy-based algorithm.
Aggregation weights of client models are estimated according to their performance during training.
Experiments on 118 different tasks demonstrate the effectiveness of the proposed <span id="S6.p1.1.2" class="ltx_text ltx_font_smallcaps">FewFedWeight</span>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bragg <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Jonathan Bragg, Arman Cohan, Kyle Lo, and Iz Beltagy.

</span>
<span class="ltx_bibblock">Flex: Unifying evaluation for few-shot nlp.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
34:15787–15800, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chawla <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2002]</span>
<span class="ltx_bibblock">
Nitesh V Chawla, Kevin W Bowyer, Lawrence O Hall, and W Philip Kegelmeyer.

</span>
<span class="ltx_bibblock">Smote: synthetic minority over-sampling technique.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">Journal of artificial intelligence research</span>, 16:321–357, 2002.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Mingqing Chen, Rajiv Mathews, Tom Ouyang, and Françoise Beaufays.

</span>
<span class="ltx_bibblock">Federated learning of out-of-vocabulary words.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1903.10635</span>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and
Jie Tang.

</span>
<span class="ltx_bibblock">All nlp tasks are generation tasks: A general pretraining framework.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2103.10360</span>, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and
Jie Tang.

</span>
<span class="ltx_bibblock">Glm: General language model pretraining with autoregressive blank
infilling.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers)</span>, pages 320–335, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan and Huang [2021]</span>
<span class="ltx_bibblock">
Chenyou Fan and Jianwei Huang.

</span>
<span class="ltx_bibblock">Federated few-shot learning with adversarial learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">2021 19th International Symposium on Modeling and
Optimization in Mobile, Ad hoc, and Wireless Networks (WiOpt)</span>, pages 1–8.
IEEE, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Steven Y Feng, Varun Gangal, Jason Wei, Sarath Chandar, Soroush Vosoughi,
Teruko Mitamura, and Eduard Hovy.

</span>
<span class="ltx_bibblock">A survey of data augmentation approaches for nlp.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2105.03075</span>, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freund <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [1996]</span>
<span class="ltx_bibblock">
Yoav Freund, Robert E Schapire, et al.

</span>
<span class="ltx_bibblock">Experiments with a new boosting algorithm.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">icml</span>, volume 96, pages 148–156. Citeseer, 1996.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Tianyu Gao, Adam Fisch, and Danqi Chen.

</span>
<span class="ltx_bibblock">Making pre-trained language models better few-shot learners.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association for
Computational Linguistics and the 11th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</span>, pages 3816–3830, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garcia Bernal [2020]</span>
<span class="ltx_bibblock">
Daniel Garcia Bernal.

</span>
<span class="ltx_bibblock">Decentralizing large-scale natural language processing with federated
learning, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yutao Huang, Lingyang Chu, Zirui Zhou, Lanjun Wang, Jiangchuan Liu, Jian Pei,
and Yong Zhang.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">AAAI</span>, pages 7865–7873, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1610.05492</span>, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Kenton Lee, Kelvin Guu, Luheng He, Tim Dozat, and Hyung Won Chung.

</span>
<span class="ltx_bibblock">Neural data augmentation via example extrapolation.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.01335</span>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Veselin Stoyanov, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Bart: Denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">Proceedings of the 58th Annual Meeting of the Association for
Computational Linguistics</span>, pages 7871–7880, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lhoest <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Quentin Lhoest, Albert Villanova del Moral, Yacine Jernite, Abhishek Thakur,
Patrick von Platen, Suraj Patil, Julien Chaumond, Mariama Drame, Julien Plu,
Lewis Tunstall, et al.

</span>
<span class="ltx_bibblock">Datasets: A community library for natural language processing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in
Natural Language Processing: System Demonstrations</span>, pages 175–184, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
6357–6368. PMLR, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Weitang Liu, Xiaoyun Wang, John Owens, and Yixuan Li.

</span>
<span class="ltx_bibblock">Energy-based Out-of-distribution Detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
volume 33, pages 21464–21475. Curran Associates, Inc., 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021a]</span>
<span class="ltx_bibblock">
Ming Liu, Stella Ho, Mengqi Wang, Longxiang Gao, Yuan Jin, and He Zhang.

</span>
<span class="ltx_bibblock">Federated learning meets natural language processing: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2107.12603</span>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021b]</span>
<span class="ltx_bibblock">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and
Graham Neubig.

</span>
<span class="ltx_bibblock">Pre-train, prompt, and predict: A systematic survey of prompting
methods in natural language processing.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2107.13586</span>, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021c]</span>
<span class="ltx_bibblock">
Xiao Liu, Kaixuan Ji, Yicheng Fu, Zhengxiao Du, Zhilin Yang, and Jie Tang.

</span>
<span class="ltx_bibblock">P-tuning v2: Prompt tuning can be comparable to fine-tuning
universally across scales and tasks.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.07602</span>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marfoq <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Othmane Marfoq, Giovanni Neglia, Aurélien Bellet, Laetitia Kameni, and
Richard Vidal.

</span>
<span class="ltx_bibblock">Federated multi-task learning under a mixture of distributions.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 34, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayan <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Shashi Narayan, Shay B Cohen, and Mirella Lapata.

</span>
<span class="ltx_bibblock">Don’t give me the details, just the summary! topic-aware
convolutional neural networks for extreme summarization.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1808.08745</span>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Ethan Perez, Douwe Kiela, and Kyunghyun Cho.

</span>
<span class="ltx_bibblock">True few-shot learning with language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
34:11054–11070, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin <span id="bib.bib27.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Libo Qin, Minheng Ni, Yue Zhang, and Wanxiang Che.

</span>
<span class="ltx_bibblock">Cosda-ml: multi-lingual code-switching data augmentation for
zero-shot cross-lingual nlp.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">Proceedings of the Twenty-Ninth International Conference on
International Joint Conferences on Artificial Intelligence</span>, pages
3853–3860, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford <span id="bib.bib28.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic">OpenAI blog</span>, 1(8):9, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel <span id="bib.bib29.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020a]</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, Peter J Liu, et al.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic">J. Mach. Learn. Res.</span>, 21(140):1–67, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel <span id="bib.bib30.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020b]</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, Peter J Liu, et al.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic">J. Mach. Learn. Res.</span>, 21(140):1–67, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren <span id="bib.bib31.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Mengye Ren, Wenyuan Zeng, Bin Yang, and Raquel Urtasun.

</span>
<span class="ltx_bibblock">Learning to reweight examples for robust deep learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.3.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages
4334–4343. PMLR, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh <span id="bib.bib32.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Victor Sanh, Albert Webson, Colin Raffel, Stephen H Bach, Lintang Sutawika,
Zaid Alyafeai, Antoine Chaffin, Arnaud Stiegler, Teven Le Scao, Arun Raja,
et al.

</span>
<span class="ltx_bibblock">Multitask prompted training enables zero-shot task generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.08207</span>, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shome and Kar [2021]</span>
<span class="ltx_bibblock">
Debaditya Shome and Tejaswini Kar.

</span>
<span class="ltx_bibblock">Fedaffect: Few-shot federated learning for facial expression
recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, pages 4168–4175, 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith <span id="bib.bib34.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun <span id="bib.bib35.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yi Sun, Yu Zheng, Chao Hao, and Hangping Qiu.

</span>
<span class="ltx_bibblock">Nsp-bert: A prompt-based zero-shot learner through an original
pre-training task–next sentence prediction.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2109.03564</span>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Voigt and Von dem Bussche [2017]</span>
<span class="ltx_bibblock">
Paul Voigt and Axel Von dem Bussche.

</span>
<span class="ltx_bibblock">The eu general data protection regulation (gdpr).

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">A Practical Guide, 1st Ed., Cham: Springer International
Publishing</span>, 10(3152676):10–5555, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei <span id="bib.bib37.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian
Lester, Nan Du, Andrew M Dai, and Quoc V Le.

</span>
<span class="ltx_bibblock">Finetuned language models are zero-shot learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2109.01652</span>, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu <span id="bib.bib38.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Hanwei Xu, Yujun Chen, Yulun Du, Nan Shao, Yanggang Wang, Haiyu Li, and Zhilin
Yang.

</span>
<span class="ltx_bibblock">Zeroprompt: Scaling prompt-based pretraining to 1,000 tasks improves
zero-shot generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2201.06910</span>, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye <span id="bib.bib39.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Qinyuan Ye, Bill Yuchen Lin, and Xiang Ren.

</span>
<span class="ltx_bibblock">Crossfit: A few-shot learning challenge for cross-task generalization
in nlp.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.3.1" class="ltx_text ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in
Natural Language Processing</span>, pages 7163–7189, 2021.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yogatama <span id="bib.bib40.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Dani Yogatama, Cyprien de Masson d’Autume, Jerome Connor, Tomas Kocisky, Mike
Chrzanowski, Lingpeng Kong, Angeliki Lazaridou, Wang Ling, Lei Yu, Chris
Dyer, et al.

</span>
<span class="ltx_bibblock">Learning and evaluating general linguistic intelligence.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1901.11373</span>, 2019.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib41.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021a]</span>
<span class="ltx_bibblock">
Chen Zhang, Yu Xie, Hang Bai, Bin Yu, Weihong Li, and Yuan Gao.

</span>
<span class="ltx_bibblock">A survey on federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic">Knowledge-Based Systems</span>, 216:106775, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib42.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021b]</span>
<span class="ltx_bibblock">
Zhengyan Zhang, Xu Han, Hao Zhou, Pei Ke, Yuxian Gu, Deming Ye, Yujia Qin,
Yusheng Su, Haozhe Ji, Jian Guan, et al.

</span>
<span class="ltx_bibblock">Cpm: A large-scale generative chinese pre-trained language model.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic">AI Open</span>, 2:93–99, 2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao <span id="bib.bib43.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Jieyu Zhao, Tianlu Wang, Mark Yatskar, Vicente Ordonez, and Kai-Wei Chang.

</span>
<span class="ltx_bibblock">Gender bias in coreference resolution: Evaluation and debiasing
methods.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.3.1" class="ltx_text ltx_font_italic">Proceedings of the 2018 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 2 (Short Papers)</span>, pages 15–20, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Task Type and Distribution</h3>

<figure id="A1.T5" class="ltx_table">
<div id="A1.T5.1" class="ltx_inline-block ltx_transformed_outer" style="width:411.9pt;height:885.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(41.8pt,-89.9pt) scale(1.25494913961476,1.25494913961476) ;">
<table id="A1.T5.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T5.1.1.1" class="ltx_tr">
<td id="A1.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="A1.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Client</span></td>
<td id="A1.T5.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="A1.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">Tasks</span></td>
</tr>
<tr id="A1.T5.1.1.2" class="ltx_tr">
<td id="A1.T5.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">Client 1</td>
<td id="A1.T5.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T5.1.1.2.2.1" class="ltx_text"></span><span id="A1.T5.1.1.2.2.2" class="ltx_text">
<span id="A1.T5.1.1.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.1.1.2.2.2.1.1" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-determiner-noun-agreement-with-adj-irregular-1,</span></span>
<span id="A1.T5.1.1.2.2.2.1.2" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">aeslc, glue-mrpc, math qa, quarel, kilt ay2,</span></span>
<span id="A1.T5.1.1.2.2.2.1.3" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance atheism, lama-squad, tab fact, aqua rat,</span></span>
<span id="A1.T5.1.1.2.2.2.1.4" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-emoji, glue-wnli, codah, spider</span></span>
<span id="A1.T5.1.1.2.2.2.1.5" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-offensive, wiki qa, blimp-ellipsis n bar 1,</span></span>
<span id="A1.T5.1.1.2.2.2.1.6" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">openbookqa, sms spam, acronym identification,</span></span>
<span id="A1.T5.1.1.2.2.2.1.7" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">ethos-national origin, definite pronoun resolution,</span></span>
<span id="A1.T5.1.1.2.2.2.1.8" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">hellaswag, superglue-wsc, numer sense,</span></span>
<span id="A1.T5.1.1.2.2.2.1.9" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">ade corpus v2-dosage, blimp-ellipsis n bar 2,</span></span>
<span id="A1.T5.1.1.2.2.2.1.10" class="ltx_tr">
<span id="A1.T5.1.1.2.2.2.1.10.1" class="ltx_td ltx_nopad_r ltx_align_left">squad-no context, e2e nlg cleaned</span></span>
</span></span><span id="A1.T5.1.1.2.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T5.1.1.3" class="ltx_tr">
<td id="A1.T5.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t">Client 2</td>
<td id="A1.T5.1.1.3.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T5.1.1.3.2.1" class="ltx_text"></span><span id="A1.T5.1.1.3.2.2" class="ltx_text">
<span id="A1.T5.1.1.3.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.1.1.3.2.2.1.1" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">google wellformed query, xsum, wiqa, qa srl,</span></span>
<span id="A1.T5.1.1.3.2.2.1.2" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance abortion, ade corpus v2-effect, sick,</span></span>
<span id="A1.T5.1.1.3.2.2.1.3" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">ethos-religion, commonsense qa, jeopardy, biomrc,</span></span>
<span id="A1.T5.1.1.3.2.2.1.4" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-multirc, ethos-race, eli5-askh, glue-qqp,</span></span>
<span id="A1.T5.1.1.3.2.2.1.5" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">paws, ethos-directed vs generalized, glue-sst2, mocha,</span></span>
<span id="A1.T5.1.1.3.2.2.1.6" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-hate, glue-rte, hate speech offensive,</span></span>
<span id="A1.T5.1.1.3.2.2.1.7" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-anaphor number agreement, lama-conceptnet,</span></span>
<span id="A1.T5.1.1.3.2.2.1.8" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-wic, boolq, kilt hotpotqa, aslg pc12,</span></span>
<span id="A1.T5.1.1.3.2.2.1.9" class="ltx_tr">
<span id="A1.T5.1.1.3.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">quartz-no knowledge</span></span>
</span></span><span id="A1.T5.1.1.3.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T5.1.1.4" class="ltx_tr">
<td id="A1.T5.1.1.4.1" class="ltx_td ltx_align_left ltx_border_t">Client 3</td>
<td id="A1.T5.1.1.4.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T5.1.1.4.2.1" class="ltx_text"></span><span id="A1.T5.1.1.4.2.2" class="ltx_text">
<span id="A1.T5.1.1.4.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.1.1.4.2.2.1.1" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance climate, tweet eval-sentiment, qasc,</span></span>
<span id="A1.T5.1.1.4.2.2.1.2" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">medical questions pairs, break-QDMR-high-level,</span></span>
<span id="A1.T5.1.1.4.2.2.1.3" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">imdb, glue-mnli, ethos-gender, trec-finegrained,</span></span>
<span id="A1.T5.1.1.4.2.2.1.4" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">crows pairs, adversarialqa, onestop english, duorc,</span></span>
<span id="A1.T5.1.1.4.2.2.1.5" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">web questions, yelp review full, swag, proto qa, scitail,</span></span>
<span id="A1.T5.1.1.4.2.2.1.6" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance feminist, limit, common gen,</span></span>
<span id="A1.T5.1.1.4.2.2.1.7" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">scicite, blimp-irregular past participle adjectives,</span></span>
<span id="A1.T5.1.1.4.2.2.1.8" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">social i qa, anli, kilt zsre, cosmos qa, superglue-record,</span></span>
<span id="A1.T5.1.1.4.2.2.1.9" class="ltx_tr">
<span id="A1.T5.1.1.4.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">squad-with context</span></span>
</span></span><span id="A1.T5.1.1.4.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T5.1.1.5" class="ltx_tr">
<td id="A1.T5.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Client 4</td>
<td id="A1.T5.1.1.5.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="A1.T5.1.1.5.2.1" class="ltx_text"></span><span id="A1.T5.1.1.5.2.2" class="ltx_text">
<span id="A1.T5.1.1.5.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.1.1.5.2.2.1.1" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">emotion, blimp-existential there quantifiers 1, sciq,</span></span>
<span id="A1.T5.1.1.5.2.2.1.2" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">race-middle, kilt wow, wino grande, rotten tomatoes,</span></span>
<span id="A1.T5.1.1.5.2.2.1.3" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-cb, poem sentiment, ropes, piqa, quail,</span></span>
<span id="A1.T5.1.1.5.2.2.1.4" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">climate fever, lama-google re, search qa, wiki auto,</span></span>
<span id="A1.T5.1.1.5.2.2.1.5" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">mc taco, blimp-wh questions object gap, hotpot qa,</span></span>
<span id="A1.T5.1.1.5.2.2.1.6" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">emo, kilt nq, kilt trex, quartz-with knowledge, aeslc,</span></span>
<span id="A1.T5.1.1.5.2.2.1.7" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">dbpedia 14, yahoo answers topics, app reviews,</span></span>
<span id="A1.T5.1.1.5.2.2.1.8" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-copa, blimp-anaphor gender agreement,</span></span>
<span id="A1.T5.1.1.5.2.2.1.9" class="ltx_tr">
<span id="A1.T5.1.1.5.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">hate speech18, gigaword</span></span>
</span></span><span id="A1.T5.1.1.5.2.3" class="ltx_text"></span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Tasks assigned to different clients.</figcaption>
</figure>
<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">The 118 tasks were randomly dispatched to 4 clients, which is shown in Table <a href="#A1.T5" title="Table 5 ‣ A.1 Task Type and Distribution ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The 118 tasks can be categorized into 4 groups according to <cite class="ltx_cite ltx_citemacro_citep">[Ye <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>]</cite>: classification, QA, conditional generation and other. The categories of tasks are shown in Table <a href="#A1.T6" title="Table 6 ‣ A.1 Task Type and Distribution ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure id="A1.T6" class="ltx_table">
<div id="A1.T6.1" class="ltx_inline-block ltx_transformed_outer" style="width:411.9pt;height:739.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(14.4pt,-25.9pt) scale(1.07543637204751,1.07543637204751) ;">
<table id="A1.T6.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T6.1.1.1" class="ltx_tr">
<td id="A1.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="A1.T6.1.1.1.1.1" class="ltx_text ltx_font_bold">Type</span></td>
<td id="A1.T6.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="A1.T6.1.1.1.2.1" class="ltx_text ltx_font_bold">Tasks</span></td>
</tr>
<tr id="A1.T6.1.1.2" class="ltx_tr">
<td id="A1.T6.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">Classification</td>
<td id="A1.T6.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T6.1.1.2.2.1" class="ltx_text"></span><span id="A1.T6.1.1.2.2.2" class="ltx_text">
<span id="A1.T6.1.1.2.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T6.1.1.2.2.2.1.1" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">anli, medical questions pairs, paws, glue-rte,</span></span>
<span id="A1.T6.1.1.2.2.2.1.2" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">onestop english, poem sentiment, sick, glue-sst2,</span></span>
<span id="A1.T6.1.1.2.2.2.1.3" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">scicite, rotten tomatoes, climate fever, glue-qqp,</span></span>
<span id="A1.T6.1.1.2.2.2.1.4" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">scitail, sms spam, dbpedia 14, emotion, glue-wnli,</span></span>
<span id="A1.T6.1.1.2.2.2.1.5" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-cb, emo, ethos-gender, imdb, glue-mrpc,</span></span>
<span id="A1.T6.1.1.2.2.2.1.6" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">ethos-directed vs generalized, ethos-race, tab fact,</span></span>
<span id="A1.T6.1.1.2.2.2.1.7" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">ethos-national origin, superglue-wic, superglue-wsc,</span></span>
<span id="A1.T6.1.1.2.2.2.1.8" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">glue-mnli, google wellformed query, wiki qa,</span></span>
<span id="A1.T6.1.1.2.2.2.1.9" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">hate speech18, hate speech offensive, ethos-religion,</span></span>
<span id="A1.T6.1.1.2.2.2.1.10" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.10.1" class="ltx_td ltx_nopad_r ltx_align_left">trec-finegrained, tweet eval-emoji, wiki auto,</span></span>
<span id="A1.T6.1.1.2.2.2.1.11" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.11.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-hate, tweet eval-offensive,</span></span>
<span id="A1.T6.1.1.2.2.2.1.12" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.12.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-sentiment, tweet eval-stance abortion,</span></span>
<span id="A1.T6.1.1.2.2.2.1.13" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.13.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance atheism, tweet eval-stance climate,</span></span>
<span id="A1.T6.1.1.2.2.2.1.14" class="ltx_tr">
<span id="A1.T6.1.1.2.2.2.1.14.1" class="ltx_td ltx_nopad_r ltx_align_left">tweet eval-stance feminist, yahoo answers topics</span></span>
</span></span><span id="A1.T6.1.1.2.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T6.1.1.3" class="ltx_tr">
<td id="A1.T6.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t">QA</td>
<td id="A1.T6.1.1.3.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T6.1.1.3.2.1" class="ltx_text"></span><span id="A1.T6.1.1.3.2.2" class="ltx_text">
<span id="A1.T6.1.1.3.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T6.1.1.3.2.2.1.1" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">lama-conceptne, adversarialqa, lama-google re,</span></span>
<span id="A1.T6.1.1.3.2.2.1.2" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">lama-squad, math qa, mc taco, aqua rat, wino grande,</span></span>
<span id="A1.T6.1.1.3.2.2.1.3" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">numer sense, biomrc, openbookqa, qasc, quail,</span></span>
<span id="A1.T6.1.1.3.2.2.1.4" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">quarel, quartz-no knowledge, search qa, ropes,</span></span>
<span id="A1.T6.1.1.3.2.2.1.5" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">quartz-with knowledge, race-middle, boolq, sciq,</span></span>
<span id="A1.T6.1.1.3.2.2.1.6" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">codah, commonsense qa, jeopardy, social i qa,</span></span>
<span id="A1.T6.1.1.3.2.2.1.7" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">squad-no context, duorc, squad-with context,</span></span>
<span id="A1.T6.1.1.3.2.2.1.8" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-copa, eli5-askh, swag, superglue-multirc,</span></span>
<span id="A1.T6.1.1.3.2.2.1.9" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">superglue-record, web questions, hellaswag, wiqa,</span></span>
<span id="A1.T6.1.1.3.2.2.1.10" class="ltx_tr">
<span id="A1.T6.1.1.3.2.2.1.10.1" class="ltx_td ltx_nopad_r ltx_align_left">kilt zsre, kilt nq, kilt ay2, kilt trex, cosmos qa</span></span>
</span></span><span id="A1.T6.1.1.3.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T6.1.1.4" class="ltx_tr">
<td id="A1.T6.1.1.4.1" class="ltx_td ltx_align_left ltx_border_t">Conditional Generation</td>
<td id="A1.T6.1.1.4.2" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T6.1.1.4.2.1" class="ltx_text"></span><span id="A1.T6.1.1.4.2.2" class="ltx_text">
<span id="A1.T6.1.1.4.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T6.1.1.4.2.2.1.1" class="ltx_tr">
<span id="A1.T6.1.1.4.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">aeslc, spider, gigaword, xsum, kilt wow</span></span>
</span></span><span id="A1.T6.1.1.4.2.3" class="ltx_text"></span></td>
</tr>
<tr id="A1.T6.1.1.5" class="ltx_tr">
<td id="A1.T6.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Other</td>
<td id="A1.T6.1.1.5.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="A1.T6.1.1.5.2.1" class="ltx_text"></span><span id="A1.T6.1.1.5.2.2" class="ltx_text">
<span id="A1.T6.1.1.5.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T6.1.1.5.2.2.1.1" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">acronym identification, ade corpus v2-dosage,</span></span>
<span id="A1.T6.1.1.5.2.2.1.2" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">ade corpus v2-effect, limit, app reviews, crows pairs,</span></span>
<span id="A1.T6.1.1.5.2.2.1.3" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">mocha, aslg pc12, blimp-anaphor gender agreement,</span></span>
<span id="A1.T6.1.1.5.2.2.1.4" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">piqa, yelp review full, proto qa, common gen,</span></span>
<span id="A1.T6.1.1.5.2.2.1.5" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-determiner noun agreement with adj irregular 1,</span></span>
<span id="A1.T6.1.1.5.2.2.1.6" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">qa srl, blimp-ellipsis n bar 1, blimp-ellipsis n bar 2,</span></span>
<span id="A1.T6.1.1.5.2.2.1.7" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-existential there quantifiers 1, hotpot qa,</span></span>
<span id="A1.T6.1.1.5.2.2.1.8" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.8.1" class="ltx_td ltx_nopad_r ltx_align_left">e2e nlg cleaned, blimp-anaphor number agreement,</span></span>
<span id="A1.T6.1.1.5.2.2.1.9" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.9.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-irregular past participle adjectives,</span></span>
<span id="A1.T6.1.1.5.2.2.1.10" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.10.1" class="ltx_td ltx_nopad_r ltx_align_left">definite pronoun resolution, break-QDMR-high-level,</span></span>
<span id="A1.T6.1.1.5.2.2.1.11" class="ltx_tr">
<span id="A1.T6.1.1.5.2.2.1.11.1" class="ltx_td ltx_nopad_r ltx_align_left">blimp-wh questions object gap</span></span>
</span></span><span id="A1.T6.1.1.5.2.3" class="ltx_text"></span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>The categories of 118 tasks.</figcaption>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Meta Weighting</h3>

<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.5.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Meta Weighting</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.1" class="ltx_p ltx_figure_panel"><span id="alg2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Input</span><span id="alg2.1.2" class="ltx_text" style="font-size:90%;">: </span><math id="alg2.1.m1.6" class="ltx_Math" alttext="\bm{X}_{i},\bm{Y}_{i},\hat{\bm{Y}}_{i},\bm{F}_{i},T_{i},l" display="inline"><semantics id="alg2.1.m1.6a"><mrow id="alg2.1.m1.6.6.5" xref="alg2.1.m1.6.6.6.cmml"><msub id="alg2.1.m1.2.2.1.1" xref="alg2.1.m1.2.2.1.1.cmml"><mi mathsize="90%" id="alg2.1.m1.2.2.1.1.2" xref="alg2.1.m1.2.2.1.1.2.cmml">𝑿</mi><mi mathsize="90%" id="alg2.1.m1.2.2.1.1.3" xref="alg2.1.m1.2.2.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.1.m1.6.6.5.6" xref="alg2.1.m1.6.6.6.cmml">,</mo><msub id="alg2.1.m1.3.3.2.2" xref="alg2.1.m1.3.3.2.2.cmml"><mi mathsize="90%" id="alg2.1.m1.3.3.2.2.2" xref="alg2.1.m1.3.3.2.2.2.cmml">𝒀</mi><mi mathsize="90%" id="alg2.1.m1.3.3.2.2.3" xref="alg2.1.m1.3.3.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.1.m1.6.6.5.7" xref="alg2.1.m1.6.6.6.cmml">,</mo><msub id="alg2.1.m1.4.4.3.3" xref="alg2.1.m1.4.4.3.3.cmml"><mover accent="true" id="alg2.1.m1.4.4.3.3.2" xref="alg2.1.m1.4.4.3.3.2.cmml"><mi mathsize="90%" id="alg2.1.m1.4.4.3.3.2.2" xref="alg2.1.m1.4.4.3.3.2.2.cmml">𝒀</mi><mo mathsize="90%" id="alg2.1.m1.4.4.3.3.2.1" xref="alg2.1.m1.4.4.3.3.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.1.m1.4.4.3.3.3" xref="alg2.1.m1.4.4.3.3.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.1.m1.6.6.5.8" xref="alg2.1.m1.6.6.6.cmml">,</mo><msub id="alg2.1.m1.5.5.4.4" xref="alg2.1.m1.5.5.4.4.cmml"><mi mathsize="90%" id="alg2.1.m1.5.5.4.4.2" xref="alg2.1.m1.5.5.4.4.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.1.m1.5.5.4.4.3" xref="alg2.1.m1.5.5.4.4.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.1.m1.6.6.5.9" xref="alg2.1.m1.6.6.6.cmml">,</mo><msub id="alg2.1.m1.6.6.5.5" xref="alg2.1.m1.6.6.5.5.cmml"><mi mathsize="90%" id="alg2.1.m1.6.6.5.5.2" xref="alg2.1.m1.6.6.5.5.2.cmml">T</mi><mi mathsize="90%" id="alg2.1.m1.6.6.5.5.3" xref="alg2.1.m1.6.6.5.5.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.1.m1.6.6.5.10" xref="alg2.1.m1.6.6.6.cmml">,</mo><mi mathsize="90%" id="alg2.1.m1.1.1" xref="alg2.1.m1.1.1.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.m1.6b"><list id="alg2.1.m1.6.6.6.cmml" xref="alg2.1.m1.6.6.5"><apply id="alg2.1.m1.2.2.1.1.cmml" xref="alg2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg2.1.m1.2.2.1.1.1.cmml" xref="alg2.1.m1.2.2.1.1">subscript</csymbol><ci id="alg2.1.m1.2.2.1.1.2.cmml" xref="alg2.1.m1.2.2.1.1.2">𝑿</ci><ci id="alg2.1.m1.2.2.1.1.3.cmml" xref="alg2.1.m1.2.2.1.1.3">𝑖</ci></apply><apply id="alg2.1.m1.3.3.2.2.cmml" xref="alg2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg2.1.m1.3.3.2.2.1.cmml" xref="alg2.1.m1.3.3.2.2">subscript</csymbol><ci id="alg2.1.m1.3.3.2.2.2.cmml" xref="alg2.1.m1.3.3.2.2.2">𝒀</ci><ci id="alg2.1.m1.3.3.2.2.3.cmml" xref="alg2.1.m1.3.3.2.2.3">𝑖</ci></apply><apply id="alg2.1.m1.4.4.3.3.cmml" xref="alg2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg2.1.m1.4.4.3.3.1.cmml" xref="alg2.1.m1.4.4.3.3">subscript</csymbol><apply id="alg2.1.m1.4.4.3.3.2.cmml" xref="alg2.1.m1.4.4.3.3.2"><ci id="alg2.1.m1.4.4.3.3.2.1.cmml" xref="alg2.1.m1.4.4.3.3.2.1">^</ci><ci id="alg2.1.m1.4.4.3.3.2.2.cmml" xref="alg2.1.m1.4.4.3.3.2.2">𝒀</ci></apply><ci id="alg2.1.m1.4.4.3.3.3.cmml" xref="alg2.1.m1.4.4.3.3.3">𝑖</ci></apply><apply id="alg2.1.m1.5.5.4.4.cmml" xref="alg2.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="alg2.1.m1.5.5.4.4.1.cmml" xref="alg2.1.m1.5.5.4.4">subscript</csymbol><ci id="alg2.1.m1.5.5.4.4.2.cmml" xref="alg2.1.m1.5.5.4.4.2">𝑭</ci><ci id="alg2.1.m1.5.5.4.4.3.cmml" xref="alg2.1.m1.5.5.4.4.3">𝑖</ci></apply><apply id="alg2.1.m1.6.6.5.5.cmml" xref="alg2.1.m1.6.6.5.5"><csymbol cd="ambiguous" id="alg2.1.m1.6.6.5.5.1.cmml" xref="alg2.1.m1.6.6.5.5">subscript</csymbol><ci id="alg2.1.m1.6.6.5.5.2.cmml" xref="alg2.1.m1.6.6.5.5.2">𝑇</ci><ci id="alg2.1.m1.6.6.5.5.3.cmml" xref="alg2.1.m1.6.6.5.5.3">𝑖</ci></apply><ci id="alg2.1.m1.1.1.cmml" xref="alg2.1.m1.1.1">𝑙</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.6c">\bm{X}_{i},\bm{Y}_{i},\hat{\bm{Y}}_{i},\bm{F}_{i},T_{i},l</annotation></semantics></math><span id="alg2.1.3" class="ltx_text" style="font-size:90%;"> </span>
<br class="ltx_break"></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg2.l1.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l1.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l1.m1.5" class="ltx_Math" alttext="t=0,1,2,...,T_{i}-1" display="inline"><semantics id="alg2.l1.m1.5a"><mrow id="alg2.l1.m1.5.5" xref="alg2.l1.m1.5.5.cmml"><mi mathsize="90%" id="alg2.l1.m1.5.5.3" xref="alg2.l1.m1.5.5.3.cmml">t</mi><mo mathsize="90%" id="alg2.l1.m1.5.5.2" xref="alg2.l1.m1.5.5.2.cmml">=</mo><mrow id="alg2.l1.m1.5.5.1.1" xref="alg2.l1.m1.5.5.1.2.cmml"><mn mathsize="90%" id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">0</mn><mo mathsize="90%" id="alg2.l1.m1.5.5.1.1.2" xref="alg2.l1.m1.5.5.1.2.cmml">,</mo><mn mathsize="90%" id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml">1</mn><mo mathsize="90%" id="alg2.l1.m1.5.5.1.1.3" xref="alg2.l1.m1.5.5.1.2.cmml">,</mo><mn mathsize="90%" id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml">2</mn><mo mathsize="90%" id="alg2.l1.m1.5.5.1.1.4" xref="alg2.l1.m1.5.5.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg2.l1.m1.4.4" xref="alg2.l1.m1.4.4.cmml">…</mi><mo mathsize="90%" id="alg2.l1.m1.5.5.1.1.5" xref="alg2.l1.m1.5.5.1.2.cmml">,</mo><mrow id="alg2.l1.m1.5.5.1.1.1" xref="alg2.l1.m1.5.5.1.1.1.cmml"><msub id="alg2.l1.m1.5.5.1.1.1.2" xref="alg2.l1.m1.5.5.1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l1.m1.5.5.1.1.1.2.2" xref="alg2.l1.m1.5.5.1.1.1.2.2.cmml">T</mi><mi mathsize="90%" id="alg2.l1.m1.5.5.1.1.1.2.3" xref="alg2.l1.m1.5.5.1.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l1.m1.5.5.1.1.1.1" xref="alg2.l1.m1.5.5.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="alg2.l1.m1.5.5.1.1.1.3" xref="alg2.l1.m1.5.5.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.5b"><apply id="alg2.l1.m1.5.5.cmml" xref="alg2.l1.m1.5.5"><eq id="alg2.l1.m1.5.5.2.cmml" xref="alg2.l1.m1.5.5.2"></eq><ci id="alg2.l1.m1.5.5.3.cmml" xref="alg2.l1.m1.5.5.3">𝑡</ci><list id="alg2.l1.m1.5.5.1.2.cmml" xref="alg2.l1.m1.5.5.1.1"><cn type="integer" id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">0</cn><cn type="integer" id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">1</cn><cn type="integer" id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3">2</cn><ci id="alg2.l1.m1.4.4.cmml" xref="alg2.l1.m1.4.4">…</ci><apply id="alg2.l1.m1.5.5.1.1.1.cmml" xref="alg2.l1.m1.5.5.1.1.1"><minus id="alg2.l1.m1.5.5.1.1.1.1.cmml" xref="alg2.l1.m1.5.5.1.1.1.1"></minus><apply id="alg2.l1.m1.5.5.1.1.1.2.cmml" xref="alg2.l1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m1.5.5.1.1.1.2.1.cmml" xref="alg2.l1.m1.5.5.1.1.1.2">subscript</csymbol><ci id="alg2.l1.m1.5.5.1.1.1.2.2.cmml" xref="alg2.l1.m1.5.5.1.1.1.2.2">𝑇</ci><ci id="alg2.l1.m1.5.5.1.1.1.2.3.cmml" xref="alg2.l1.m1.5.5.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l1.m1.5.5.1.1.1.3.cmml" xref="alg2.l1.m1.5.5.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.5c">t=0,1,2,...,T_{i}-1</annotation></semantics></math><span id="alg2.l1.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l1.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l1.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg2.l2.2" class="ltx_text" style="font-size:90%;">     Sample </span><math id="alg2.l2.m1.2" class="ltx_Math" alttext="\bm{B}\in(\bm{X}_{i},\bm{Y}_{i})" display="inline"><semantics id="alg2.l2.m1.2a"><mrow id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml"><mi mathsize="90%" id="alg2.l2.m1.2.2.4" xref="alg2.l2.m1.2.2.4.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l2.m1.2.2.3" xref="alg2.l2.m1.2.2.3.cmml">∈</mo><mrow id="alg2.l2.m1.2.2.2.2" xref="alg2.l2.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l2.m1.2.2.2.2.3" xref="alg2.l2.m1.2.2.2.3.cmml">(</mo><msub id="alg2.l2.m1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l2.m1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.1.2.cmml">𝑿</mi><mi mathsize="90%" id="alg2.l2.m1.1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l2.m1.2.2.2.2.4" xref="alg2.l2.m1.2.2.2.3.cmml">,</mo><msub id="alg2.l2.m1.2.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l2.m1.2.2.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.2.2.cmml">𝒀</mi><mi mathsize="90%" id="alg2.l2.m1.2.2.2.2.2.3" xref="alg2.l2.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l2.m1.2.2.2.2.5" xref="alg2.l2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.2b"><apply id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2"><in id="alg2.l2.m1.2.2.3.cmml" xref="alg2.l2.m1.2.2.3"></in><ci id="alg2.l2.m1.2.2.4.cmml" xref="alg2.l2.m1.2.2.4">𝑩</ci><interval closure="open" id="alg2.l2.m1.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.2"><apply id="alg2.l2.m1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.2">𝑿</ci><ci id="alg2.l2.m1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l2.m1.2.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.2.2.2.1.cmml" xref="alg2.l2.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.l2.m1.2.2.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2.2.2">𝒀</ci><ci id="alg2.l2.m1.2.2.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.2c">\bm{B}\in(\bm{X}_{i},\bm{Y}_{i})</annotation></semantics></math><span id="alg2.l2.3" class="ltx_text" style="font-size:90%;"> and </span><math id="alg2.l2.m2.2" class="ltx_Math" alttext="\hat{\bm{B}}\in(\bm{X}_{i},\hat{\bm{Y}}_{i})" display="inline"><semantics id="alg2.l2.m2.2a"><mrow id="alg2.l2.m2.2.2" xref="alg2.l2.m2.2.2.cmml"><mover accent="true" id="alg2.l2.m2.2.2.4" xref="alg2.l2.m2.2.2.4.cmml"><mi mathsize="90%" id="alg2.l2.m2.2.2.4.2" xref="alg2.l2.m2.2.2.4.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l2.m2.2.2.4.1" xref="alg2.l2.m2.2.2.4.1.cmml">^</mo></mover><mo mathsize="90%" id="alg2.l2.m2.2.2.3" xref="alg2.l2.m2.2.2.3.cmml">∈</mo><mrow id="alg2.l2.m2.2.2.2.2" xref="alg2.l2.m2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l2.m2.2.2.2.2.3" xref="alg2.l2.m2.2.2.2.3.cmml">(</mo><msub id="alg2.l2.m2.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l2.m2.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.1.2.cmml">𝑿</mi><mi mathsize="90%" id="alg2.l2.m2.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l2.m2.2.2.2.2.4" xref="alg2.l2.m2.2.2.2.3.cmml">,</mo><msub id="alg2.l2.m2.2.2.2.2.2" xref="alg2.l2.m2.2.2.2.2.2.cmml"><mover accent="true" id="alg2.l2.m2.2.2.2.2.2.2" xref="alg2.l2.m2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l2.m2.2.2.2.2.2.2.2" xref="alg2.l2.m2.2.2.2.2.2.2.2.cmml">𝒀</mi><mo mathsize="90%" id="alg2.l2.m2.2.2.2.2.2.2.1" xref="alg2.l2.m2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l2.m2.2.2.2.2.2.3" xref="alg2.l2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l2.m2.2.2.2.2.5" xref="alg2.l2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.2b"><apply id="alg2.l2.m2.2.2.cmml" xref="alg2.l2.m2.2.2"><in id="alg2.l2.m2.2.2.3.cmml" xref="alg2.l2.m2.2.2.3"></in><apply id="alg2.l2.m2.2.2.4.cmml" xref="alg2.l2.m2.2.2.4"><ci id="alg2.l2.m2.2.2.4.1.cmml" xref="alg2.l2.m2.2.2.4.1">^</ci><ci id="alg2.l2.m2.2.2.4.2.cmml" xref="alg2.l2.m2.2.2.4.2">𝑩</ci></apply><interval closure="open" id="alg2.l2.m2.2.2.2.3.cmml" xref="alg2.l2.m2.2.2.2.2"><apply id="alg2.l2.m2.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.2">𝑿</ci><ci id="alg2.l2.m2.1.1.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l2.m2.2.2.2.2.2.cmml" xref="alg2.l2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l2.m2.2.2.2.2.2.1.cmml" xref="alg2.l2.m2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l2.m2.2.2.2.2.2.2.cmml" xref="alg2.l2.m2.2.2.2.2.2.2"><ci id="alg2.l2.m2.2.2.2.2.2.2.1.cmml" xref="alg2.l2.m2.2.2.2.2.2.2.1">^</ci><ci id="alg2.l2.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l2.m2.2.2.2.2.2.2.2">𝒀</ci></apply><ci id="alg2.l2.m2.2.2.2.2.2.3.cmml" xref="alg2.l2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.2c">\hat{\bm{B}}\in(\bm{X}_{i},\hat{\bm{Y}}_{i})</annotation></semantics></math><span id="alg2.l2.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg2.l3.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg2.l3.3" class="ltx_text ltx_font_bold" style="font-size:90%;">First Step:</span><span id="alg2.l3.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg2.l4.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l4.m1.2" class="ltx_Math" alttext="\tilde{\bm{y}}_{i}\leftarrow\text{Forward}(\bm{F}_{i},\bm{x}_{j})" display="inline"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml"><msub id="alg2.l4.m1.2.2.4" xref="alg2.l4.m1.2.2.4.cmml"><mover accent="true" id="alg2.l4.m1.2.2.4.2" xref="alg2.l4.m1.2.2.4.2.cmml"><mi mathsize="90%" id="alg2.l4.m1.2.2.4.2.2" xref="alg2.l4.m1.2.2.4.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l4.m1.2.2.4.2.1" xref="alg2.l4.m1.2.2.4.2.1.cmml">~</mo></mover><mi mathsize="90%" id="alg2.l4.m1.2.2.4.3" xref="alg2.l4.m1.2.2.4.3.cmml">i</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.l4.m1.2.2.3" xref="alg2.l4.m1.2.2.3.cmml">←</mo><mrow id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg2.l4.m1.2.2.2.4" xref="alg2.l4.m1.2.2.2.4a.cmml">Forward</mtext><mo lspace="0em" rspace="0em" id="alg2.l4.m1.2.2.2.3" xref="alg2.l4.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l4.m1.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l4.m1.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l4.m1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l4.m1.2.2.2.2.2.4" xref="alg2.l4.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l4.m1.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l4.m1.2.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l4.m1.2.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l4.m1.2.2.2.2.2.5" xref="alg2.l4.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2"><ci id="alg2.l4.m1.2.2.3.cmml" xref="alg2.l4.m1.2.2.3">←</ci><apply id="alg2.l4.m1.2.2.4.cmml" xref="alg2.l4.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.4.1.cmml" xref="alg2.l4.m1.2.2.4">subscript</csymbol><apply id="alg2.l4.m1.2.2.4.2.cmml" xref="alg2.l4.m1.2.2.4.2"><ci id="alg2.l4.m1.2.2.4.2.1.cmml" xref="alg2.l4.m1.2.2.4.2.1">~</ci><ci id="alg2.l4.m1.2.2.4.2.2.cmml" xref="alg2.l4.m1.2.2.4.2.2">𝒚</ci></apply><ci id="alg2.l4.m1.2.2.4.3.cmml" xref="alg2.l4.m1.2.2.4.3">𝑖</ci></apply><apply id="alg2.l4.m1.2.2.2.cmml" xref="alg2.l4.m1.2.2.2"><times id="alg2.l4.m1.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.3"></times><ci id="alg2.l4.m1.2.2.2.4a.cmml" xref="alg2.l4.m1.2.2.2.4"><mtext mathsize="90%" id="alg2.l4.m1.2.2.2.4.cmml" xref="alg2.l4.m1.2.2.2.4">Forward</mtext></ci><interval closure="open" id="alg2.l4.m1.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.2"><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2">𝑭</ci><ci id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l4.m1.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l4.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2.2">𝒙</ci><ci id="alg2.l4.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">\tilde{\bm{y}}_{i}\leftarrow\text{Forward}(\bm{F}_{i},\bm{x}_{j})</annotation></semantics></math><span id="alg2.l4.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l4.m2.1" class="ltx_Math" alttext="\bm{x}_{j}\in\hat{\bm{B}}" display="inline"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><msub id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml"><mi mathsize="90%" id="alg2.l4.m2.1.1.2.2" xref="alg2.l4.m2.1.1.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l4.m2.1.1.2.3" xref="alg2.l4.m2.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l4.m2.1.1.1" xref="alg2.l4.m2.1.1.1.cmml">∈</mo><mover accent="true" id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml"><mi mathsize="90%" id="alg2.l4.m2.1.1.3.2" xref="alg2.l4.m2.1.1.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l4.m2.1.1.3.1" xref="alg2.l4.m2.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><in id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1.1"></in><apply id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.2.1.cmml" xref="alg2.l4.m2.1.1.2">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.2.cmml" xref="alg2.l4.m2.1.1.2.2">𝒙</ci><ci id="alg2.l4.m2.1.1.2.3.cmml" xref="alg2.l4.m2.1.1.2.3">𝑗</ci></apply><apply id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3"><ci id="alg2.l4.m2.1.1.3.1.cmml" xref="alg2.l4.m2.1.1.3.1">^</ci><ci id="alg2.l4.m2.1.1.3.2.cmml" xref="alg2.l4.m2.1.1.3.2">𝑩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\bm{x}_{j}\in\hat{\bm{B}}</annotation></semantics></math><span id="alg2.l4.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg2.l5.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l5.m1.2" class="ltx_Math" alttext="l_{\hat{\bm{B}}}\leftarrow\sum_{1}^{b_{i}}l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><msub id="alg2.l5.m1.2.2.3" xref="alg2.l5.m1.2.2.3.cmml"><mi mathsize="90%" id="alg2.l5.m1.2.2.3.2" xref="alg2.l5.m1.2.2.3.2.cmml">l</mi><mover accent="true" id="alg2.l5.m1.2.2.3.3" xref="alg2.l5.m1.2.2.3.3.cmml"><mi mathsize="90%" id="alg2.l5.m1.2.2.3.3.2" xref="alg2.l5.m1.2.2.3.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l5.m1.2.2.3.3.1" xref="alg2.l5.m1.2.2.3.3.1.cmml">^</mo></mover></msub><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg2.l5.m1.2.2.2" xref="alg2.l5.m1.2.2.2.cmml">←</mo><mrow id="alg2.l5.m1.2.2.1" xref="alg2.l5.m1.2.2.1.cmml"><msubsup id="alg2.l5.m1.2.2.1.2" xref="alg2.l5.m1.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg2.l5.m1.2.2.1.2.2.2" xref="alg2.l5.m1.2.2.1.2.2.2.cmml">∑</mo><mn mathsize="90%" id="alg2.l5.m1.2.2.1.2.2.3" xref="alg2.l5.m1.2.2.1.2.2.3.cmml">1</mn><msub id="alg2.l5.m1.2.2.1.2.3" xref="alg2.l5.m1.2.2.1.2.3.cmml"><mi mathsize="90%" id="alg2.l5.m1.2.2.1.2.3.2" xref="alg2.l5.m1.2.2.1.2.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l5.m1.2.2.1.2.3.3" xref="alg2.l5.m1.2.2.1.2.3.3.cmml">i</mi></msub></msubsup><mrow id="alg2.l5.m1.2.2.1.1" xref="alg2.l5.m1.2.2.1.1.cmml"><mi mathsize="90%" id="alg2.l5.m1.2.2.1.1.3" xref="alg2.l5.m1.2.2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.2.2.1.1.2" xref="alg2.l5.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.2.cmml">(</mo><mover accent="true" id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">𝒚</mi><mi mathsize="90%" id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">~</mo></mover><mo mathsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.2.cmml">,</mo><msub id="alg2.l5.m1.2.2.1.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l5.m1.2.2.1.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.1.2.2" xref="alg2.l5.m1.2.2.1.1.1.1.1.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.1.2.1" xref="alg2.l5.m1.2.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.2.2.1.1.1.1.4" xref="alg2.l5.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><ci id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2.2">←</ci><apply id="alg2.l5.m1.2.2.3.cmml" xref="alg2.l5.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.3.1.cmml" xref="alg2.l5.m1.2.2.3">subscript</csymbol><ci id="alg2.l5.m1.2.2.3.2.cmml" xref="alg2.l5.m1.2.2.3.2">𝑙</ci><apply id="alg2.l5.m1.2.2.3.3.cmml" xref="alg2.l5.m1.2.2.3.3"><ci id="alg2.l5.m1.2.2.3.3.1.cmml" xref="alg2.l5.m1.2.2.3.3.1">^</ci><ci id="alg2.l5.m1.2.2.3.3.2.cmml" xref="alg2.l5.m1.2.2.3.3.2">𝑩</ci></apply></apply><apply id="alg2.l5.m1.2.2.1.cmml" xref="alg2.l5.m1.2.2.1"><apply id="alg2.l5.m1.2.2.1.2.cmml" xref="alg2.l5.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.1.cmml" xref="alg2.l5.m1.2.2.1.2">superscript</csymbol><apply id="alg2.l5.m1.2.2.1.2.2.cmml" xref="alg2.l5.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.2.1.cmml" xref="alg2.l5.m1.2.2.1.2">subscript</csymbol><sum id="alg2.l5.m1.2.2.1.2.2.2.cmml" xref="alg2.l5.m1.2.2.1.2.2.2"></sum><cn type="integer" id="alg2.l5.m1.2.2.1.2.2.3.cmml" xref="alg2.l5.m1.2.2.1.2.2.3">1</cn></apply><apply id="alg2.l5.m1.2.2.1.2.3.cmml" xref="alg2.l5.m1.2.2.1.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.3.1.cmml" xref="alg2.l5.m1.2.2.1.2.3">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.2.3.2.cmml" xref="alg2.l5.m1.2.2.1.2.3.2">𝑏</ci><ci id="alg2.l5.m1.2.2.1.2.3.3.cmml" xref="alg2.l5.m1.2.2.1.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l5.m1.2.2.1.1.cmml" xref="alg2.l5.m1.2.2.1.1"><times id="alg2.l5.m1.2.2.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.2"></times><ci id="alg2.l5.m1.2.2.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.3">𝑙</ci><interval closure="open" id="alg2.l5.m1.2.2.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">~</ci><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝒚</ci><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝑗</ci></apply></apply><apply id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="alg2.l5.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1.2"><ci id="alg2.l5.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1.2.1">^</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="alg2.l5.m1.2.2.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.1.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">l_{\hat{\bm{B}}}\leftarrow\sum_{1}^{b_{i}}l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})</annotation></semantics></math><span id="alg2.l5.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg2.l6.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l6.m1.2" class="ltx_Math" alttext="\bm{F}_{i}^{\prime}\leftarrow\text{Optimize}(\bm{F}_{i},l_{\hat{\bm{B}}})" display="inline"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml"><msubsup id="alg2.l6.m1.2.2.4" xref="alg2.l6.m1.2.2.4.cmml"><mi mathsize="90%" id="alg2.l6.m1.2.2.4.2.2" xref="alg2.l6.m1.2.2.4.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l6.m1.2.2.4.2.3" xref="alg2.l6.m1.2.2.4.2.3.cmml">i</mi><mo mathsize="90%" id="alg2.l6.m1.2.2.4.3" xref="alg2.l6.m1.2.2.4.3.cmml">′</mo></msubsup><mo mathsize="90%" stretchy="false" id="alg2.l6.m1.2.2.3" xref="alg2.l6.m1.2.2.3.cmml">←</mo><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg2.l6.m1.2.2.2.4" xref="alg2.l6.m1.2.2.2.4a.cmml">Optimize</mtext><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.2.2.3" xref="alg2.l6.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l6.m1.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l6.m1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l6.m1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l6.m1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l6.m1.2.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l6.m1.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l6.m1.2.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.2.cmml">l</mi><mover accent="true" id="alg2.l6.m1.2.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.l6.m1.2.2.2.2.2.2.3.2" xref="alg2.l6.m1.2.2.2.2.2.2.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l6.m1.2.2.2.2.2.2.3.1" xref="alg2.l6.m1.2.2.2.2.2.2.3.1.cmml">^</mo></mover></msub><mo maxsize="90%" minsize="90%" id="alg2.l6.m1.2.2.2.2.2.5" xref="alg2.l6.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2"><ci id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.3">←</ci><apply id="alg2.l6.m1.2.2.4.cmml" xref="alg2.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.4.1.cmml" xref="alg2.l6.m1.2.2.4">superscript</csymbol><apply id="alg2.l6.m1.2.2.4.2.cmml" xref="alg2.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.4.2.1.cmml" xref="alg2.l6.m1.2.2.4">subscript</csymbol><ci id="alg2.l6.m1.2.2.4.2.2.cmml" xref="alg2.l6.m1.2.2.4.2.2">𝑭</ci><ci id="alg2.l6.m1.2.2.4.2.3.cmml" xref="alg2.l6.m1.2.2.4.2.3">𝑖</ci></apply><ci id="alg2.l6.m1.2.2.4.3.cmml" xref="alg2.l6.m1.2.2.4.3">′</ci></apply><apply id="alg2.l6.m1.2.2.2.cmml" xref="alg2.l6.m1.2.2.2"><times id="alg2.l6.m1.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.3"></times><ci id="alg2.l6.m1.2.2.2.4a.cmml" xref="alg2.l6.m1.2.2.2.4"><mtext mathsize="90%" id="alg2.l6.m1.2.2.2.4.cmml" xref="alg2.l6.m1.2.2.2.4">Optimize</mtext></ci><interval closure="open" id="alg2.l6.m1.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2"><apply id="alg2.l6.m1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2">𝑭</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l6.m1.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2">𝑙</ci><apply id="alg2.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.3"><ci id="alg2.l6.m1.2.2.2.2.2.2.3.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.3.1">^</ci><ci id="alg2.l6.m1.2.2.2.2.2.2.3.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.3.2">𝑩</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">\bm{F}_{i}^{\prime}\leftarrow\text{Optimize}(\bm{F}_{i},l_{\hat{\bm{B}}})</annotation></semantics></math><span id="alg2.l6.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg2.l7.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg2.l7.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Second Step:</span><span id="alg2.l7.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg2.l8.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l8.m1.2" class="ltx_Math" alttext="\bar{\bm{y}}_{j}\leftarrow\text{Forward}(\bm{W_{i}}^{\prime},\bm{x}_{j})" display="inline"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml"><msub id="alg2.l8.m1.2.2.4" xref="alg2.l8.m1.2.2.4.cmml"><mover accent="true" id="alg2.l8.m1.2.2.4.2" xref="alg2.l8.m1.2.2.4.2.cmml"><mi mathsize="90%" id="alg2.l8.m1.2.2.4.2.2" xref="alg2.l8.m1.2.2.4.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l8.m1.2.2.4.2.1" xref="alg2.l8.m1.2.2.4.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="alg2.l8.m1.2.2.4.3" xref="alg2.l8.m1.2.2.4.3.cmml">j</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.l8.m1.2.2.3" xref="alg2.l8.m1.2.2.3.cmml">←</mo><mrow id="alg2.l8.m1.2.2.2" xref="alg2.l8.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg2.l8.m1.2.2.2.4" xref="alg2.l8.m1.2.2.2.4a.cmml">Forward</mtext><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.2.3" xref="alg2.l8.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l8.m1.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l8.m1.2.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.3.cmml">(</mo><mmultiscripts id="alg2.l8.m1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l8.m1.1.1.1.1.1.1.2.2" xref="alg2.l8.m1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="alg2.l8.m1.1.1.1.1.1.1.2.3" xref="alg2.l8.m1.1.1.1.1.1.1.2.3.cmml">𝒊</mi><mrow id="alg2.l8.m1.1.1.1.1.1.1a" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"></mrow><mrow id="alg2.l8.m1.1.1.1.1.1.1b" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"></mrow><mo mathsize="90%" id="alg2.l8.m1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo mathsize="90%" id="alg2.l8.m1.2.2.2.2.2.4" xref="alg2.l8.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l8.m1.2.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l8.m1.2.2.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l8.m1.2.2.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l8.m1.2.2.2.2.2.5" xref="alg2.l8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><apply id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2"><ci id="alg2.l8.m1.2.2.3.cmml" xref="alg2.l8.m1.2.2.3">←</ci><apply id="alg2.l8.m1.2.2.4.cmml" xref="alg2.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.4.1.cmml" xref="alg2.l8.m1.2.2.4">subscript</csymbol><apply id="alg2.l8.m1.2.2.4.2.cmml" xref="alg2.l8.m1.2.2.4.2"><ci id="alg2.l8.m1.2.2.4.2.1.cmml" xref="alg2.l8.m1.2.2.4.2.1">¯</ci><ci id="alg2.l8.m1.2.2.4.2.2.cmml" xref="alg2.l8.m1.2.2.4.2.2">𝒚</ci></apply><ci id="alg2.l8.m1.2.2.4.3.cmml" xref="alg2.l8.m1.2.2.4.3">𝑗</ci></apply><apply id="alg2.l8.m1.2.2.2.cmml" xref="alg2.l8.m1.2.2.2"><times id="alg2.l8.m1.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.3"></times><ci id="alg2.l8.m1.2.2.2.4a.cmml" xref="alg2.l8.m1.2.2.2.4"><mtext mathsize="90%" id="alg2.l8.m1.2.2.2.4.cmml" xref="alg2.l8.m1.2.2.2.4">Forward</mtext></ci><interval closure="open" id="alg2.l8.m1.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.2"><apply id="alg2.l8.m1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="alg2.l8.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.2.3">𝒊</ci></apply><ci id="alg2.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg2.l8.m1.2.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.2">𝒙</ci><ci id="alg2.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">\bar{\bm{y}}_{j}\leftarrow\text{Forward}(\bm{W_{i}}^{\prime},\bm{x}_{j})</annotation></semantics></math><span id="alg2.l8.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l8.m2.1" class="ltx_Math" alttext="\bm{x}_{j}\in\bm{B}" display="inline"><semantics id="alg2.l8.m2.1a"><mrow id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml"><msub id="alg2.l8.m2.1.1.2" xref="alg2.l8.m2.1.1.2.cmml"><mi mathsize="90%" id="alg2.l8.m2.1.1.2.2" xref="alg2.l8.m2.1.1.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l8.m2.1.1.2.3" xref="alg2.l8.m2.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l8.m2.1.1.1" xref="alg2.l8.m2.1.1.1.cmml">∈</mo><mi mathsize="90%" id="alg2.l8.m2.1.1.3" xref="alg2.l8.m2.1.1.3.cmml">𝑩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><apply id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1"><in id="alg2.l8.m2.1.1.1.cmml" xref="alg2.l8.m2.1.1.1"></in><apply id="alg2.l8.m2.1.1.2.cmml" xref="alg2.l8.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l8.m2.1.1.2.1.cmml" xref="alg2.l8.m2.1.1.2">subscript</csymbol><ci id="alg2.l8.m2.1.1.2.2.cmml" xref="alg2.l8.m2.1.1.2.2">𝒙</ci><ci id="alg2.l8.m2.1.1.2.3.cmml" xref="alg2.l8.m2.1.1.2.3">𝑗</ci></apply><ci id="alg2.l8.m2.1.1.3.cmml" xref="alg2.l8.m2.1.1.3">𝑩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">\bm{x}_{j}\in\bm{B}</annotation></semantics></math><span id="alg2.l8.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg2.l9.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l9.m1.2" class="ltx_Math" alttext="l_{\bm{B}}^{\prime}\leftarrow\sum_{1}^{b_{i}}\bm{\epsilon}_{j}\cdot l(\bar{\bm{y}}_{j},\bm{y}_{j})" display="inline"><semantics id="alg2.l9.m1.2a"><mrow id="alg2.l9.m1.2.2" xref="alg2.l9.m1.2.2.cmml"><msubsup id="alg2.l9.m1.2.2.4" xref="alg2.l9.m1.2.2.4.cmml"><mi mathsize="90%" id="alg2.l9.m1.2.2.4.2.2" xref="alg2.l9.m1.2.2.4.2.2.cmml">l</mi><mi mathsize="90%" id="alg2.l9.m1.2.2.4.2.3" xref="alg2.l9.m1.2.2.4.2.3.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l9.m1.2.2.4.3" xref="alg2.l9.m1.2.2.4.3.cmml">′</mo></msubsup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg2.l9.m1.2.2.3" xref="alg2.l9.m1.2.2.3.cmml">←</mo><mrow id="alg2.l9.m1.2.2.2" xref="alg2.l9.m1.2.2.2.cmml"><msubsup id="alg2.l9.m1.2.2.2.3" xref="alg2.l9.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg2.l9.m1.2.2.2.3.2.2" xref="alg2.l9.m1.2.2.2.3.2.2.cmml">∑</mo><mn mathsize="90%" id="alg2.l9.m1.2.2.2.3.2.3" xref="alg2.l9.m1.2.2.2.3.2.3.cmml">1</mn><msub id="alg2.l9.m1.2.2.2.3.3" xref="alg2.l9.m1.2.2.2.3.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.2.2.2.3.3.2" xref="alg2.l9.m1.2.2.2.3.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l9.m1.2.2.2.3.3.3" xref="alg2.l9.m1.2.2.2.3.3.3.cmml">i</mi></msub></msubsup><mrow id="alg2.l9.m1.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.cmml"><mrow id="alg2.l9.m1.2.2.2.2.4" xref="alg2.l9.m1.2.2.2.2.4.cmml"><msub id="alg2.l9.m1.2.2.2.2.4.2" xref="alg2.l9.m1.2.2.2.2.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathsize="90%" mathvariant="bold-italic" id="alg2.l9.m1.2.2.2.2.4.2.2" xref="alg2.l9.m1.2.2.2.2.4.2.2.cmml">ϵ</mi><mi mathsize="90%" id="alg2.l9.m1.2.2.2.2.4.2.3" xref="alg2.l9.m1.2.2.2.2.4.2.3.cmml">j</mi></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg2.l9.m1.2.2.2.2.4.1" xref="alg2.l9.m1.2.2.2.2.4.1.cmml">⋅</mo><mi mathsize="90%" id="alg2.l9.m1.2.2.2.2.4.3" xref="alg2.l9.m1.2.2.2.2.4.3.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l9.m1.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l9.m1.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg2.l9.m1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l9.m1.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l9.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l9.m1.1.1.1.1.1.1.1.2.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="alg2.l9.m1.1.1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l9.m1.2.2.2.2.2.2.4" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg2.l9.m1.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l9.m1.2.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.cmml">𝒚</mi><mi mathsize="90%" id="alg2.l9.m1.2.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.2.2.2.2.2.2.5" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.2b"><apply id="alg2.l9.m1.2.2.cmml" xref="alg2.l9.m1.2.2"><ci id="alg2.l9.m1.2.2.3.cmml" xref="alg2.l9.m1.2.2.3">←</ci><apply id="alg2.l9.m1.2.2.4.cmml" xref="alg2.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.4.1.cmml" xref="alg2.l9.m1.2.2.4">superscript</csymbol><apply id="alg2.l9.m1.2.2.4.2.cmml" xref="alg2.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.4.2.1.cmml" xref="alg2.l9.m1.2.2.4">subscript</csymbol><ci id="alg2.l9.m1.2.2.4.2.2.cmml" xref="alg2.l9.m1.2.2.4.2.2">𝑙</ci><ci id="alg2.l9.m1.2.2.4.2.3.cmml" xref="alg2.l9.m1.2.2.4.2.3">𝑩</ci></apply><ci id="alg2.l9.m1.2.2.4.3.cmml" xref="alg2.l9.m1.2.2.4.3">′</ci></apply><apply id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.2"><apply id="alg2.l9.m1.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.3.1.cmml" xref="alg2.l9.m1.2.2.2.3">superscript</csymbol><apply id="alg2.l9.m1.2.2.2.3.2.cmml" xref="alg2.l9.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.3.2.1.cmml" xref="alg2.l9.m1.2.2.2.3">subscript</csymbol><sum id="alg2.l9.m1.2.2.2.3.2.2.cmml" xref="alg2.l9.m1.2.2.2.3.2.2"></sum><cn type="integer" id="alg2.l9.m1.2.2.2.3.2.3.cmml" xref="alg2.l9.m1.2.2.2.3.2.3">1</cn></apply><apply id="alg2.l9.m1.2.2.2.3.3.cmml" xref="alg2.l9.m1.2.2.2.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.3.3.1.cmml" xref="alg2.l9.m1.2.2.2.3.3">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.3.3.2.cmml" xref="alg2.l9.m1.2.2.2.3.3.2">𝑏</ci><ci id="alg2.l9.m1.2.2.2.3.3.3.cmml" xref="alg2.l9.m1.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="alg2.l9.m1.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2"><times id="alg2.l9.m1.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.3"></times><apply id="alg2.l9.m1.2.2.2.2.4.cmml" xref="alg2.l9.m1.2.2.2.2.4"><ci id="alg2.l9.m1.2.2.2.2.4.1.cmml" xref="alg2.l9.m1.2.2.2.2.4.1">⋅</ci><apply id="alg2.l9.m1.2.2.2.2.4.2.cmml" xref="alg2.l9.m1.2.2.2.2.4.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.4.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.4.2">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.4.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.4.2.2">bold-italic-ϵ</ci><ci id="alg2.l9.m1.2.2.2.2.4.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.4.2.3">𝑗</ci></apply><ci id="alg2.l9.m1.2.2.2.2.4.3.cmml" xref="alg2.l9.m1.2.2.2.2.4.3">𝑙</ci></apply><interval closure="open" id="alg2.l9.m1.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2"><apply id="alg2.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.2"><ci id="alg2.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="alg2.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg2.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.2">𝒚</ci><ci id="alg2.l9.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.2c">l_{\bm{B}}^{\prime}\leftarrow\sum_{1}^{b_{i}}\bm{\epsilon}_{j}\cdot l(\bar{\bm{y}}_{j},\bm{y}_{j})</annotation></semantics></math><span id="alg2.l9.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg2.l10.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l10.m1.1" class="ltx_Math" alttext="\nabla{\bm{\epsilon}}\leftarrow\frac{\partial l_{\bm{B}}^{\prime}}{\partial\bm{\epsilon}}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mrow id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mo mathsize="90%" rspace="0.167em" id="alg2.l10.m1.1.1.2.1" xref="alg2.l10.m1.1.1.2.1.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathsize="90%" mathvariant="bold-italic" id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">ϵ</mi></mrow><mo mathsize="90%" stretchy="false" id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">←</mo><mfrac id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><mrow id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml"><mo mathsize="90%" rspace="0em" id="alg2.l10.m1.1.1.3.2.1" xref="alg2.l10.m1.1.1.3.2.1.cmml">∂</mo><msubsup id="alg2.l10.m1.1.1.3.2.2" xref="alg2.l10.m1.1.1.3.2.2.cmml"><mi mathsize="90%" id="alg2.l10.m1.1.1.3.2.2.2.2" xref="alg2.l10.m1.1.1.3.2.2.2.2.cmml">l</mi><mi mathsize="90%" id="alg2.l10.m1.1.1.3.2.2.2.3" xref="alg2.l10.m1.1.1.3.2.2.2.3.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l10.m1.1.1.3.2.2.3" xref="alg2.l10.m1.1.1.3.2.2.3.cmml">′</mo></msubsup></mrow><mrow id="alg2.l10.m1.1.1.3.3" xref="alg2.l10.m1.1.1.3.3.cmml"><mo mathsize="90%" rspace="0em" id="alg2.l10.m1.1.1.3.3.1" xref="alg2.l10.m1.1.1.3.3.1.cmml">∂</mo><mi class="ltx_mathvariant_bold-italic" mathsize="90%" mathvariant="bold-italic" id="alg2.l10.m1.1.1.3.3.2" xref="alg2.l10.m1.1.1.3.3.2.cmml">ϵ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">←</ci><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><ci id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2.1">∇</ci><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">bold-italic-ϵ</ci></apply><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><divide id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3"></divide><apply id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2"><partialdiff id="alg2.l10.m1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.1"></partialdiff><apply id="alg2.l10.m1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.2">superscript</csymbol><apply id="alg2.l10.m1.1.1.3.2.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.2.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.2.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2.2.2">𝑙</ci><ci id="alg2.l10.m1.1.1.3.2.2.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.2.3">𝑩</ci></apply><ci id="alg2.l10.m1.1.1.3.2.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.3">′</ci></apply></apply><apply id="alg2.l10.m1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.3"><partialdiff id="alg2.l10.m1.1.1.3.3.1.cmml" xref="alg2.l10.m1.1.1.3.3.1"></partialdiff><ci id="alg2.l10.m1.1.1.3.3.2.cmml" xref="alg2.l10.m1.1.1.3.3.2">bold-italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\nabla{\bm{\epsilon}}\leftarrow\frac{\partial l_{\bm{B}}^{\prime}}{\partial\bm{\epsilon}}</annotation></semantics></math><span id="alg2.l10.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg2.l11.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l11.m1.3" class="ltx_Math" alttext="\hat{\bm{w}}\leftarrow\mathrm{max}(-\nabla{\bm{\epsilon}},0);\bm{w_{j}}=\frac{\hat{\bm{w}}_{j}}{\sum_{1}^{b_{i}}\hat{\bm{w}}_{j}}" display="inline"><semantics id="alg2.l11.m1.3a"><mrow id="alg2.l11.m1.3.3.2" xref="alg2.l11.m1.3.3.3.cmml"><mrow id="alg2.l11.m1.2.2.1.1" xref="alg2.l11.m1.2.2.1.1.cmml"><mover accent="true" id="alg2.l11.m1.2.2.1.1.3" xref="alg2.l11.m1.2.2.1.1.3.cmml"><mi mathsize="90%" id="alg2.l11.m1.2.2.1.1.3.2" xref="alg2.l11.m1.2.2.1.1.3.2.cmml">𝒘</mi><mo mathsize="90%" id="alg2.l11.m1.2.2.1.1.3.1" xref="alg2.l11.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo mathsize="90%" stretchy="false" id="alg2.l11.m1.2.2.1.1.2" xref="alg2.l11.m1.2.2.1.1.2.cmml">←</mo><mrow id="alg2.l11.m1.2.2.1.1.1" xref="alg2.l11.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg2.l11.m1.2.2.1.1.1.3" xref="alg2.l11.m1.2.2.1.1.1.3.cmml">max</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.1.1.1.2" xref="alg2.l11.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="alg2.l11.m1.2.2.1.1.1.1.1" xref="alg2.l11.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l11.m1.2.2.1.1.1.1.1.2" xref="alg2.l11.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="alg2.l11.m1.2.2.1.1.1.1.1.1" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.cmml"><mo mathsize="90%" rspace="0.167em" id="alg2.l11.m1.2.2.1.1.1.1.1.1a" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="alg2.l11.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2.cmml"><mo mathsize="90%" rspace="0.167em" id="alg2.l11.m1.2.2.1.1.1.1.1.1.2.1" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2.1.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathsize="90%" mathvariant="bold-italic" id="alg2.l11.m1.2.2.1.1.1.1.1.1.2.2" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2.2.cmml">ϵ</mi></mrow></mrow><mo mathsize="90%" id="alg2.l11.m1.2.2.1.1.1.1.1.3" xref="alg2.l11.m1.2.2.1.1.1.1.2.cmml">,</mo><mn mathsize="90%" id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">0</mn><mo maxsize="90%" minsize="90%" id="alg2.l11.m1.2.2.1.1.1.1.1.4" xref="alg2.l11.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="alg2.l11.m1.3.3.2.3" xref="alg2.l11.m1.3.3.3a.cmml">;</mo><mrow id="alg2.l11.m1.3.3.2.2" xref="alg2.l11.m1.3.3.2.2.cmml"><msub id="alg2.l11.m1.3.3.2.2.2" xref="alg2.l11.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.2.2" xref="alg2.l11.m1.3.3.2.2.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.2.3" xref="alg2.l11.m1.3.3.2.2.2.3.cmml">𝒋</mi></msub><mo mathsize="90%" id="alg2.l11.m1.3.3.2.2.1" xref="alg2.l11.m1.3.3.2.2.1.cmml">=</mo><mfrac id="alg2.l11.m1.3.3.2.2.3" xref="alg2.l11.m1.3.3.2.2.3.cmml"><msub id="alg2.l11.m1.3.3.2.2.3.2" xref="alg2.l11.m1.3.3.2.2.3.2.cmml"><mover accent="true" id="alg2.l11.m1.3.3.2.2.3.2.2" xref="alg2.l11.m1.3.3.2.2.3.2.2.cmml"><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.2.2.2" xref="alg2.l11.m1.3.3.2.2.3.2.2.2.cmml">𝒘</mi><mo mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.2.2.1" xref="alg2.l11.m1.3.3.2.2.3.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.2.3" xref="alg2.l11.m1.3.3.2.2.3.2.3.cmml">j</mi></msub><mrow id="alg2.l11.m1.3.3.2.2.3.3" xref="alg2.l11.m1.3.3.2.2.3.3.cmml"><mstyle displaystyle="false" id="alg2.l11.m1.3.3.2.2.3.3.1" xref="alg2.l11.m1.3.3.2.2.3.3.1.cmml"><msubsup id="alg2.l11.m1.3.3.2.2.3.3.1a" xref="alg2.l11.m1.3.3.2.2.3.3.1.cmml"><mo maxsize="63%" minsize="63%" stretchy="true" id="alg2.l11.m1.3.3.2.2.3.3.1.2.2" xref="alg2.l11.m1.3.3.2.2.3.3.1.2.2.cmml">∑</mo><mn mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.1.2.3" xref="alg2.l11.m1.3.3.2.2.3.3.1.2.3.cmml">1</mn><msub id="alg2.l11.m1.3.3.2.2.3.3.1.3" xref="alg2.l11.m1.3.3.2.2.3.3.1.3.cmml"><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.1.3.2" xref="alg2.l11.m1.3.3.2.2.3.3.1.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.1.3.3" xref="alg2.l11.m1.3.3.2.2.3.3.1.3.3.cmml">i</mi></msub></msubsup></mstyle><msub id="alg2.l11.m1.3.3.2.2.3.3.2" xref="alg2.l11.m1.3.3.2.2.3.3.2.cmml"><mover accent="true" id="alg2.l11.m1.3.3.2.2.3.3.2.2" xref="alg2.l11.m1.3.3.2.2.3.3.2.2.cmml"><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.2.2.2" xref="alg2.l11.m1.3.3.2.2.3.3.2.2.2.cmml">𝒘</mi><mo mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.2.2.1" xref="alg2.l11.m1.3.3.2.2.3.3.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l11.m1.3.3.2.2.3.3.2.3" xref="alg2.l11.m1.3.3.2.2.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.3b"><apply id="alg2.l11.m1.3.3.3.cmml" xref="alg2.l11.m1.3.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.3a.cmml" xref="alg2.l11.m1.3.3.2.3">formulae-sequence</csymbol><apply id="alg2.l11.m1.2.2.1.1.cmml" xref="alg2.l11.m1.2.2.1.1"><ci id="alg2.l11.m1.2.2.1.1.2.cmml" xref="alg2.l11.m1.2.2.1.1.2">←</ci><apply id="alg2.l11.m1.2.2.1.1.3.cmml" xref="alg2.l11.m1.2.2.1.1.3"><ci id="alg2.l11.m1.2.2.1.1.3.1.cmml" xref="alg2.l11.m1.2.2.1.1.3.1">^</ci><ci id="alg2.l11.m1.2.2.1.1.3.2.cmml" xref="alg2.l11.m1.2.2.1.1.3.2">𝒘</ci></apply><apply id="alg2.l11.m1.2.2.1.1.1.cmml" xref="alg2.l11.m1.2.2.1.1.1"><times id="alg2.l11.m1.2.2.1.1.1.2.cmml" xref="alg2.l11.m1.2.2.1.1.1.2"></times><ci id="alg2.l11.m1.2.2.1.1.1.3.cmml" xref="alg2.l11.m1.2.2.1.1.1.3">max</ci><interval closure="open" id="alg2.l11.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1"><apply id="alg2.l11.m1.2.2.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1.1"><minus id="alg2.l11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1.1"></minus><apply id="alg2.l11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2"><ci id="alg2.l11.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2.1">∇</ci><ci id="alg2.l11.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg2.l11.m1.2.2.1.1.1.1.1.1.2.2">bold-italic-ϵ</ci></apply></apply><cn type="integer" id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">0</cn></interval></apply></apply><apply id="alg2.l11.m1.3.3.2.2.cmml" xref="alg2.l11.m1.3.3.2.2"><eq id="alg2.l11.m1.3.3.2.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.1"></eq><apply id="alg2.l11.m1.3.3.2.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.2">subscript</csymbol><ci id="alg2.l11.m1.3.3.2.2.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.2.2">𝒘</ci><ci id="alg2.l11.m1.3.3.2.2.2.3.cmml" xref="alg2.l11.m1.3.3.2.2.2.3">𝒋</ci></apply><apply id="alg2.l11.m1.3.3.2.2.3.cmml" xref="alg2.l11.m1.3.3.2.2.3"><divide id="alg2.l11.m1.3.3.2.2.3.1.cmml" xref="alg2.l11.m1.3.3.2.2.3"></divide><apply id="alg2.l11.m1.3.3.2.2.3.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.3.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.2">subscript</csymbol><apply id="alg2.l11.m1.3.3.2.2.3.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.2.2"><ci id="alg2.l11.m1.3.3.2.2.3.2.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.2.2.1">^</ci><ci id="alg2.l11.m1.3.3.2.2.3.2.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.2.2.2">𝒘</ci></apply><ci id="alg2.l11.m1.3.3.2.2.3.2.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.2.3">𝑗</ci></apply><apply id="alg2.l11.m1.3.3.2.2.3.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.3"><apply id="alg2.l11.m1.3.3.2.2.3.3.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.3.3.1.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1">superscript</csymbol><apply id="alg2.l11.m1.3.3.2.2.3.3.1.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.3.3.1.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1">subscript</csymbol><sum id="alg2.l11.m1.3.3.2.2.3.3.1.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.2.2"></sum><cn type="integer" id="alg2.l11.m1.3.3.2.2.3.3.1.2.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.2.3">1</cn></apply><apply id="alg2.l11.m1.3.3.2.2.3.3.1.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.3"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.3.3.1.3.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.3">subscript</csymbol><ci id="alg2.l11.m1.3.3.2.2.3.3.1.3.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.3.2">𝑏</ci><ci id="alg2.l11.m1.3.3.2.2.3.3.1.3.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.1.3.3">𝑖</ci></apply></apply><apply id="alg2.l11.m1.3.3.2.2.3.3.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.2.2.3.3.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2">subscript</csymbol><apply id="alg2.l11.m1.3.3.2.2.3.3.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2.2"><ci id="alg2.l11.m1.3.3.2.2.3.3.2.2.1.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2.2.1">^</ci><ci id="alg2.l11.m1.3.3.2.2.3.3.2.2.2.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2.2.2">𝒘</ci></apply><ci id="alg2.l11.m1.3.3.2.2.3.3.2.3.cmml" xref="alg2.l11.m1.3.3.2.2.3.3.2.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.3c">\hat{\bm{w}}\leftarrow\mathrm{max}(-\nabla{\bm{\epsilon}},0);\bm{w_{j}}=\frac{\hat{\bm{w}}_{j}}{\sum_{1}^{b_{i}}\hat{\bm{w}}_{j}}</annotation></semantics></math><span id="alg2.l11.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg2.l12.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg2.l12.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Third Step:</span><span id="alg2.l12.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg2.l13.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l13.m1.2" class="ltx_Math" alttext="\tilde{\bm{y}}_{i}\leftarrow\text{Forward}(\bm{F}_{i},\bm{x}_{j})" display="inline"><semantics id="alg2.l13.m1.2a"><mrow id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml"><msub id="alg2.l13.m1.2.2.4" xref="alg2.l13.m1.2.2.4.cmml"><mover accent="true" id="alg2.l13.m1.2.2.4.2" xref="alg2.l13.m1.2.2.4.2.cmml"><mi mathsize="90%" id="alg2.l13.m1.2.2.4.2.2" xref="alg2.l13.m1.2.2.4.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l13.m1.2.2.4.2.1" xref="alg2.l13.m1.2.2.4.2.1.cmml">~</mo></mover><mi mathsize="90%" id="alg2.l13.m1.2.2.4.3" xref="alg2.l13.m1.2.2.4.3.cmml">i</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.l13.m1.2.2.3" xref="alg2.l13.m1.2.2.3.cmml">←</mo><mrow id="alg2.l13.m1.2.2.2" xref="alg2.l13.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg2.l13.m1.2.2.2.4" xref="alg2.l13.m1.2.2.2.4a.cmml">Forward</mtext><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.2.2.3" xref="alg2.l13.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l13.m1.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l13.m1.2.2.2.2.2.3" xref="alg2.l13.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l13.m1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l13.m1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l13.m1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l13.m1.2.2.2.2.2.4" xref="alg2.l13.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l13.m1.2.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l13.m1.2.2.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.2.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l13.m1.2.2.2.2.2.2.3" xref="alg2.l13.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l13.m1.2.2.2.2.2.5" xref="alg2.l13.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.2b"><apply id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2"><ci id="alg2.l13.m1.2.2.3.cmml" xref="alg2.l13.m1.2.2.3">←</ci><apply id="alg2.l13.m1.2.2.4.cmml" xref="alg2.l13.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.4.1.cmml" xref="alg2.l13.m1.2.2.4">subscript</csymbol><apply id="alg2.l13.m1.2.2.4.2.cmml" xref="alg2.l13.m1.2.2.4.2"><ci id="alg2.l13.m1.2.2.4.2.1.cmml" xref="alg2.l13.m1.2.2.4.2.1">~</ci><ci id="alg2.l13.m1.2.2.4.2.2.cmml" xref="alg2.l13.m1.2.2.4.2.2">𝒚</ci></apply><ci id="alg2.l13.m1.2.2.4.3.cmml" xref="alg2.l13.m1.2.2.4.3">𝑖</ci></apply><apply id="alg2.l13.m1.2.2.2.cmml" xref="alg2.l13.m1.2.2.2"><times id="alg2.l13.m1.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.3"></times><ci id="alg2.l13.m1.2.2.2.4a.cmml" xref="alg2.l13.m1.2.2.2.4"><mtext mathsize="90%" id="alg2.l13.m1.2.2.2.4.cmml" xref="alg2.l13.m1.2.2.2.4">Forward</mtext></ci><interval closure="open" id="alg2.l13.m1.2.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.2.2"><apply id="alg2.l13.m1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2">𝑭</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l13.m1.2.2.2.2.2.2.cmml" xref="alg2.l13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l13.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2">𝒙</ci><ci id="alg2.l13.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.2c">\tilde{\bm{y}}_{i}\leftarrow\text{Forward}(\bm{F}_{i},\bm{x}_{j})</annotation></semantics></math><span id="alg2.l13.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l13.m2.1" class="ltx_Math" alttext="\bm{x}_{j}\in\hat{\bm{B}}" display="inline"><semantics id="alg2.l13.m2.1a"><mrow id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><msub id="alg2.l13.m2.1.1.2" xref="alg2.l13.m2.1.1.2.cmml"><mi mathsize="90%" id="alg2.l13.m2.1.1.2.2" xref="alg2.l13.m2.1.1.2.2.cmml">𝒙</mi><mi mathsize="90%" id="alg2.l13.m2.1.1.2.3" xref="alg2.l13.m2.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l13.m2.1.1.1" xref="alg2.l13.m2.1.1.1.cmml">∈</mo><mover accent="true" id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3.cmml"><mi mathsize="90%" id="alg2.l13.m2.1.1.3.2" xref="alg2.l13.m2.1.1.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l13.m2.1.1.3.1" xref="alg2.l13.m2.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><in id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1.1"></in><apply id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.2.1.cmml" xref="alg2.l13.m2.1.1.2">subscript</csymbol><ci id="alg2.l13.m2.1.1.2.2.cmml" xref="alg2.l13.m2.1.1.2.2">𝒙</ci><ci id="alg2.l13.m2.1.1.2.3.cmml" xref="alg2.l13.m2.1.1.2.3">𝑗</ci></apply><apply id="alg2.l13.m2.1.1.3.cmml" xref="alg2.l13.m2.1.1.3"><ci id="alg2.l13.m2.1.1.3.1.cmml" xref="alg2.l13.m2.1.1.3.1">^</ci><ci id="alg2.l13.m2.1.1.3.2.cmml" xref="alg2.l13.m2.1.1.3.2">𝑩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">\bm{x}_{j}\in\hat{\bm{B}}</annotation></semantics></math><span id="alg2.l13.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg2.l14.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l14.m1.4" class="ltx_Math" alttext="l_{\hat{\bm{B}}}^{\prime}\leftarrow\sum_{1}^{b_{i}}\bm{w}_{j}\cdot l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})+l(\tilde{\bm{y}_{j}},\bm{y}_{j})" display="inline"><semantics id="alg2.l14.m1.4a"><mrow id="alg2.l14.m1.4.4" xref="alg2.l14.m1.4.4.cmml"><msubsup id="alg2.l14.m1.4.4.4" xref="alg2.l14.m1.4.4.4.cmml"><mi mathsize="90%" id="alg2.l14.m1.4.4.4.2.2" xref="alg2.l14.m1.4.4.4.2.2.cmml">l</mi><mover accent="true" id="alg2.l14.m1.4.4.4.2.3" xref="alg2.l14.m1.4.4.4.2.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.4.4.4.2.3.2" xref="alg2.l14.m1.4.4.4.2.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l14.m1.4.4.4.2.3.1" xref="alg2.l14.m1.4.4.4.2.3.1.cmml">^</mo></mover><mo mathsize="90%" id="alg2.l14.m1.4.4.4.3" xref="alg2.l14.m1.4.4.4.3.cmml">′</mo></msubsup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg2.l14.m1.4.4.3" xref="alg2.l14.m1.4.4.3.cmml">←</mo><mrow id="alg2.l14.m1.4.4.2" xref="alg2.l14.m1.4.4.2.cmml"><mrow id="alg2.l14.m1.3.3.1.1" xref="alg2.l14.m1.3.3.1.1.cmml"><msubsup id="alg2.l14.m1.3.3.1.1.2" xref="alg2.l14.m1.3.3.1.1.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg2.l14.m1.3.3.1.1.2.2.2" xref="alg2.l14.m1.3.3.1.1.2.2.2.cmml">∑</mo><mn mathsize="90%" id="alg2.l14.m1.3.3.1.1.2.2.3" xref="alg2.l14.m1.3.3.1.1.2.2.3.cmml">1</mn><msub id="alg2.l14.m1.3.3.1.1.2.3" xref="alg2.l14.m1.3.3.1.1.2.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.2.3.2" xref="alg2.l14.m1.3.3.1.1.2.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.2.3.3" xref="alg2.l14.m1.3.3.1.1.2.3.3.cmml">i</mi></msub></msubsup><mrow id="alg2.l14.m1.3.3.1.1.1" xref="alg2.l14.m1.3.3.1.1.1.cmml"><mrow id="alg2.l14.m1.3.3.1.1.1.3" xref="alg2.l14.m1.3.3.1.1.1.3.cmml"><msub id="alg2.l14.m1.3.3.1.1.1.3.2" xref="alg2.l14.m1.3.3.1.1.1.3.2.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.3.2.2" xref="alg2.l14.m1.3.3.1.1.1.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.3.2.3" xref="alg2.l14.m1.3.3.1.1.1.3.2.3.cmml">j</mi></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg2.l14.m1.3.3.1.1.1.3.1" xref="alg2.l14.m1.3.3.1.1.1.3.1.cmml">⋅</mo><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.3.3" xref="alg2.l14.m1.3.3.1.1.1.3.3.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l14.m1.3.3.1.1.1.2" xref="alg2.l14.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="alg2.l14.m1.3.3.1.1.1.1.1" xref="alg2.l14.m1.3.3.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.2" xref="alg2.l14.m1.3.3.1.1.1.1.2.cmml">(</mo><mover accent="true" id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msub id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l14.m1.1.1.2.2" xref="alg2.l14.m1.1.1.2.2.cmml">𝒚</mi><mi mathsize="90%" id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">~</mo></mover><mo mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.3" xref="alg2.l14.m1.3.3.1.1.1.1.2.cmml">,</mo><msub id="alg2.l14.m1.3.3.1.1.1.1.1.1" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l14.m1.3.3.1.1.1.1.1.1.2" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.1.2.2" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.1.2.1" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.1.3" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.3.3.1.1.1.1.1.4" xref="alg2.l14.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="alg2.l14.m1.4.4.2.3" xref="alg2.l14.m1.4.4.2.3.cmml">+</mo><mrow id="alg2.l14.m1.4.4.2.2" xref="alg2.l14.m1.4.4.2.2.cmml"><mi mathsize="90%" id="alg2.l14.m1.4.4.2.2.3" xref="alg2.l14.m1.4.4.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.4.4.2.2.2" xref="alg2.l14.m1.4.4.2.2.2.cmml">​</mo><mrow id="alg2.l14.m1.4.4.2.2.1.1" xref="alg2.l14.m1.4.4.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.4.4.2.2.1.1.2" xref="alg2.l14.m1.4.4.2.2.1.2.cmml">(</mo><mover accent="true" id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2.cmml"><msub id="alg2.l14.m1.2.2.2" xref="alg2.l14.m1.2.2.2.cmml"><mi mathsize="90%" id="alg2.l14.m1.2.2.2.2" xref="alg2.l14.m1.2.2.2.2.cmml">𝒚</mi><mi mathsize="90%" id="alg2.l14.m1.2.2.2.3" xref="alg2.l14.m1.2.2.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg2.l14.m1.2.2.1" xref="alg2.l14.m1.2.2.1.cmml">~</mo></mover><mo mathsize="90%" id="alg2.l14.m1.4.4.2.2.1.1.3" xref="alg2.l14.m1.4.4.2.2.1.2.cmml">,</mo><msub id="alg2.l14.m1.4.4.2.2.1.1.1" xref="alg2.l14.m1.4.4.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg2.l14.m1.4.4.2.2.1.1.1.2" xref="alg2.l14.m1.4.4.2.2.1.1.1.2.cmml">𝒚</mi><mi mathsize="90%" id="alg2.l14.m1.4.4.2.2.1.1.1.3" xref="alg2.l14.m1.4.4.2.2.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.4.4.2.2.1.1.4" xref="alg2.l14.m1.4.4.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.4b"><apply id="alg2.l14.m1.4.4.cmml" xref="alg2.l14.m1.4.4"><ci id="alg2.l14.m1.4.4.3.cmml" xref="alg2.l14.m1.4.4.3">←</ci><apply id="alg2.l14.m1.4.4.4.cmml" xref="alg2.l14.m1.4.4.4"><csymbol cd="ambiguous" id="alg2.l14.m1.4.4.4.1.cmml" xref="alg2.l14.m1.4.4.4">superscript</csymbol><apply id="alg2.l14.m1.4.4.4.2.cmml" xref="alg2.l14.m1.4.4.4"><csymbol cd="ambiguous" id="alg2.l14.m1.4.4.4.2.1.cmml" xref="alg2.l14.m1.4.4.4">subscript</csymbol><ci id="alg2.l14.m1.4.4.4.2.2.cmml" xref="alg2.l14.m1.4.4.4.2.2">𝑙</ci><apply id="alg2.l14.m1.4.4.4.2.3.cmml" xref="alg2.l14.m1.4.4.4.2.3"><ci id="alg2.l14.m1.4.4.4.2.3.1.cmml" xref="alg2.l14.m1.4.4.4.2.3.1">^</ci><ci id="alg2.l14.m1.4.4.4.2.3.2.cmml" xref="alg2.l14.m1.4.4.4.2.3.2">𝑩</ci></apply></apply><ci id="alg2.l14.m1.4.4.4.3.cmml" xref="alg2.l14.m1.4.4.4.3">′</ci></apply><apply id="alg2.l14.m1.4.4.2.cmml" xref="alg2.l14.m1.4.4.2"><plus id="alg2.l14.m1.4.4.2.3.cmml" xref="alg2.l14.m1.4.4.2.3"></plus><apply id="alg2.l14.m1.3.3.1.1.cmml" xref="alg2.l14.m1.3.3.1.1"><apply id="alg2.l14.m1.3.3.1.1.2.cmml" xref="alg2.l14.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.1.1.2.1.cmml" xref="alg2.l14.m1.3.3.1.1.2">superscript</csymbol><apply id="alg2.l14.m1.3.3.1.1.2.2.cmml" xref="alg2.l14.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.1.1.2.2.1.cmml" xref="alg2.l14.m1.3.3.1.1.2">subscript</csymbol><sum id="alg2.l14.m1.3.3.1.1.2.2.2.cmml" xref="alg2.l14.m1.3.3.1.1.2.2.2"></sum><cn type="integer" id="alg2.l14.m1.3.3.1.1.2.2.3.cmml" xref="alg2.l14.m1.3.3.1.1.2.2.3">1</cn></apply><apply id="alg2.l14.m1.3.3.1.1.2.3.cmml" xref="alg2.l14.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.1.1.2.3.1.cmml" xref="alg2.l14.m1.3.3.1.1.2.3">subscript</csymbol><ci id="alg2.l14.m1.3.3.1.1.2.3.2.cmml" xref="alg2.l14.m1.3.3.1.1.2.3.2">𝑏</ci><ci id="alg2.l14.m1.3.3.1.1.2.3.3.cmml" xref="alg2.l14.m1.3.3.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l14.m1.3.3.1.1.1.cmml" xref="alg2.l14.m1.3.3.1.1.1"><times id="alg2.l14.m1.3.3.1.1.1.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.2"></times><apply id="alg2.l14.m1.3.3.1.1.1.3.cmml" xref="alg2.l14.m1.3.3.1.1.1.3"><ci id="alg2.l14.m1.3.3.1.1.1.3.1.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.1">⋅</ci><apply id="alg2.l14.m1.3.3.1.1.1.3.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.1.1.1.3.2.1.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.2">subscript</csymbol><ci id="alg2.l14.m1.3.3.1.1.1.3.2.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.2.2">𝒘</ci><ci id="alg2.l14.m1.3.3.1.1.1.3.2.3.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.2.3">𝑗</ci></apply><ci id="alg2.l14.m1.3.3.1.1.1.3.3.cmml" xref="alg2.l14.m1.3.3.1.1.1.3.3">𝑙</ci></apply><interval closure="open" id="alg2.l14.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><ci id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">~</ci><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2.2">𝒚</ci><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑗</ci></apply></apply><apply id="alg2.l14.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l14.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2"><ci id="alg2.l14.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l14.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="alg2.l14.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.3.3.1.1.1.1.1.1.3">𝑗</ci></apply></interval></apply></apply><apply id="alg2.l14.m1.4.4.2.2.cmml" xref="alg2.l14.m1.4.4.2.2"><times id="alg2.l14.m1.4.4.2.2.2.cmml" xref="alg2.l14.m1.4.4.2.2.2"></times><ci id="alg2.l14.m1.4.4.2.2.3.cmml" xref="alg2.l14.m1.4.4.2.2.3">𝑙</ci><interval closure="open" id="alg2.l14.m1.4.4.2.2.1.2.cmml" xref="alg2.l14.m1.4.4.2.2.1.1"><apply id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2"><ci id="alg2.l14.m1.2.2.1.cmml" xref="alg2.l14.m1.2.2.1">~</ci><apply id="alg2.l14.m1.2.2.2.cmml" xref="alg2.l14.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.2.1.cmml" xref="alg2.l14.m1.2.2.2">subscript</csymbol><ci id="alg2.l14.m1.2.2.2.2.cmml" xref="alg2.l14.m1.2.2.2.2">𝒚</ci><ci id="alg2.l14.m1.2.2.2.3.cmml" xref="alg2.l14.m1.2.2.2.3">𝑗</ci></apply></apply><apply id="alg2.l14.m1.4.4.2.2.1.1.1.cmml" xref="alg2.l14.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.4.4.2.2.1.1.1.1.cmml" xref="alg2.l14.m1.4.4.2.2.1.1.1">subscript</csymbol><ci id="alg2.l14.m1.4.4.2.2.1.1.1.2.cmml" xref="alg2.l14.m1.4.4.2.2.1.1.1.2">𝒚</ci><ci id="alg2.l14.m1.4.4.2.2.1.1.1.3.cmml" xref="alg2.l14.m1.4.4.2.2.1.1.1.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.4c">l_{\hat{\bm{B}}}^{\prime}\leftarrow\sum_{1}^{b_{i}}\bm{w}_{j}\cdot l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})+l(\tilde{\bm{y}_{j}},\bm{y}_{j})</annotation></semantics></math><span id="alg2.l14.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg2.l15.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg2.l15.m1.2" class="ltx_Math" alttext="\bm{F}_{i}^{t+1}\leftarrow\text{Optimize}(\bm{F}_{i},l_{\hat{\bm{B}}}^{\prime})" display="inline"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2.cmml"><msubsup id="alg2.l15.m1.2.2.4" xref="alg2.l15.m1.2.2.4.cmml"><mi mathsize="90%" id="alg2.l15.m1.2.2.4.2.2" xref="alg2.l15.m1.2.2.4.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l15.m1.2.2.4.2.3" xref="alg2.l15.m1.2.2.4.2.3.cmml">i</mi><mrow id="alg2.l15.m1.2.2.4.3" xref="alg2.l15.m1.2.2.4.3.cmml"><mi mathsize="90%" id="alg2.l15.m1.2.2.4.3.2" xref="alg2.l15.m1.2.2.4.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.l15.m1.2.2.4.3.1" xref="alg2.l15.m1.2.2.4.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.l15.m1.2.2.4.3.3" xref="alg2.l15.m1.2.2.4.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" stretchy="false" id="alg2.l15.m1.2.2.3" xref="alg2.l15.m1.2.2.3.cmml">←</mo><mrow id="alg2.l15.m1.2.2.2" xref="alg2.l15.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg2.l15.m1.2.2.2.4" xref="alg2.l15.m1.2.2.2.4a.cmml">Optimize</mtext><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.2.2.3" xref="alg2.l15.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l15.m1.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l15.m1.2.2.2.2.2.3" xref="alg2.l15.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l15.m1.1.1.1.1.1.1.2" xref="alg2.l15.m1.1.1.1.1.1.1.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l15.m1.1.1.1.1.1.1.3" xref="alg2.l15.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l15.m1.2.2.2.2.2.4" xref="alg2.l15.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg2.l15.m1.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l15.m1.2.2.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.2.2.2.cmml">l</mi><mover accent="true" id="alg2.l15.m1.2.2.2.2.2.2.2.3" xref="alg2.l15.m1.2.2.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.l15.m1.2.2.2.2.2.2.2.3.2" xref="alg2.l15.m1.2.2.2.2.2.2.2.3.2.cmml">𝑩</mi><mo mathsize="90%" id="alg2.l15.m1.2.2.2.2.2.2.2.3.1" xref="alg2.l15.m1.2.2.2.2.2.2.2.3.1.cmml">^</mo></mover><mo mathsize="90%" id="alg2.l15.m1.2.2.2.2.2.2.3" xref="alg2.l15.m1.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo maxsize="90%" minsize="90%" id="alg2.l15.m1.2.2.2.2.2.5" xref="alg2.l15.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2"><ci id="alg2.l15.m1.2.2.3.cmml" xref="alg2.l15.m1.2.2.3">←</ci><apply id="alg2.l15.m1.2.2.4.cmml" xref="alg2.l15.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.4.1.cmml" xref="alg2.l15.m1.2.2.4">superscript</csymbol><apply id="alg2.l15.m1.2.2.4.2.cmml" xref="alg2.l15.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.4.2.1.cmml" xref="alg2.l15.m1.2.2.4">subscript</csymbol><ci id="alg2.l15.m1.2.2.4.2.2.cmml" xref="alg2.l15.m1.2.2.4.2.2">𝑭</ci><ci id="alg2.l15.m1.2.2.4.2.3.cmml" xref="alg2.l15.m1.2.2.4.2.3">𝑖</ci></apply><apply id="alg2.l15.m1.2.2.4.3.cmml" xref="alg2.l15.m1.2.2.4.3"><plus id="alg2.l15.m1.2.2.4.3.1.cmml" xref="alg2.l15.m1.2.2.4.3.1"></plus><ci id="alg2.l15.m1.2.2.4.3.2.cmml" xref="alg2.l15.m1.2.2.4.3.2">𝑡</ci><cn type="integer" id="alg2.l15.m1.2.2.4.3.3.cmml" xref="alg2.l15.m1.2.2.4.3.3">1</cn></apply></apply><apply id="alg2.l15.m1.2.2.2.cmml" xref="alg2.l15.m1.2.2.2"><times id="alg2.l15.m1.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.3"></times><ci id="alg2.l15.m1.2.2.2.4a.cmml" xref="alg2.l15.m1.2.2.2.4"><mtext mathsize="90%" id="alg2.l15.m1.2.2.2.4.cmml" xref="alg2.l15.m1.2.2.2.4">Optimize</mtext></ci><interval closure="open" id="alg2.l15.m1.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2"><apply id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.2">𝑭</ci><ci id="alg2.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l15.m1.2.2.2.2.2.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg2.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l15.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.2.2">𝑙</ci><apply id="alg2.l15.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.2.3"><ci id="alg2.l15.m1.2.2.2.2.2.2.2.3.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.2.3.1">^</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.2.3.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.2.3.2">𝑩</ci></apply></apply><ci id="alg2.l15.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.3">′</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\bm{F}_{i}^{t+1}\leftarrow\text{Optimize}(\bm{F}_{i},l_{\hat{\bm{B}}}^{\prime})</annotation></semantics></math><span id="alg2.l15.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg2.l16.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg2.l16.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Return</span><span id="alg2.l16.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l16.m1.1" class="ltx_Math" alttext="\bm{F}_{i}^{t+1}" display="inline"><semantics id="alg2.l16.m1.1a"><msubsup id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi mathsize="90%" id="alg2.l16.m1.1.1.2.2" xref="alg2.l16.m1.1.1.2.2.cmml">𝑭</mi><mi mathsize="90%" id="alg2.l16.m1.1.1.2.3" xref="alg2.l16.m1.1.1.2.3.cmml">i</mi><mrow id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.l16.m1.1.1.3.1" xref="alg2.l16.m1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1">superscript</csymbol><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2.2">𝑭</ci><ci id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3">𝑖</ci></apply><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><plus id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3.1"></plus><ci id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">\bm{F}_{i}^{t+1}</annotation></semantics></math><span id="alg2.l16.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg2.l17.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg2.l17.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg2.l17.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l17.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
</div>
</div>
</div>
</figure>
<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.8" class="ltx_p">The meta weighting algorithm is shown in Algorithm <a href="#alg2" title="Algorithm 2 ‣ A.2 Meta Weighting ‣ Appendix A Appendix ‣ FewFedWeight: Few-shot Federated Learning Framework across Multiple NLP Tasks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. At the beginning, we randomly sample a mini-batch <math id="A1.SS2.p1.1.m1.2" class="ltx_Math" alttext="\hat{\bm{B}}\in(\bm{X}_{i},\hat{\bm{Y}}_{i})" display="inline"><semantics id="A1.SS2.p1.1.m1.2a"><mrow id="A1.SS2.p1.1.m1.2.2" xref="A1.SS2.p1.1.m1.2.2.cmml"><mover accent="true" id="A1.SS2.p1.1.m1.2.2.4" xref="A1.SS2.p1.1.m1.2.2.4.cmml"><mi id="A1.SS2.p1.1.m1.2.2.4.2" xref="A1.SS2.p1.1.m1.2.2.4.2.cmml">𝑩</mi><mo id="A1.SS2.p1.1.m1.2.2.4.1" xref="A1.SS2.p1.1.m1.2.2.4.1.cmml">^</mo></mover><mo id="A1.SS2.p1.1.m1.2.2.3" xref="A1.SS2.p1.1.m1.2.2.3.cmml">∈</mo><mrow id="A1.SS2.p1.1.m1.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p1.1.m1.2.2.2.2.3" xref="A1.SS2.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p1.1.m1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p1.1.m1.2.2.2.2.4" xref="A1.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p1.1.m1.2.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.2.cmml"><mover accent="true" id="A1.SS2.p1.1.m1.2.2.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p1.1.m1.2.2.2.2.2.2.2" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2.2.cmml">𝒀</mi><mo id="A1.SS2.p1.1.m1.2.2.2.2.2.2.1" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="A1.SS2.p1.1.m1.2.2.2.2.2.3" xref="A1.SS2.p1.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p1.1.m1.2.2.2.2.5" xref="A1.SS2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.2b"><apply id="A1.SS2.p1.1.m1.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2"><in id="A1.SS2.p1.1.m1.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.3"></in><apply id="A1.SS2.p1.1.m1.2.2.4.cmml" xref="A1.SS2.p1.1.m1.2.2.4"><ci id="A1.SS2.p1.1.m1.2.2.4.1.cmml" xref="A1.SS2.p1.1.m1.2.2.4.1">^</ci><ci id="A1.SS2.p1.1.m1.2.2.4.2.cmml" xref="A1.SS2.p1.1.m1.2.2.4.2">𝑩</ci></apply><interval closure="open" id="A1.SS2.p1.1.m1.2.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2"><apply id="A1.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2">𝑿</ci><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2">subscript</csymbol><apply id="A1.SS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2"><ci id="A1.SS2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2.1">^</ci><ci id="A1.SS2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2.2.2">𝒀</ci></apply><ci id="A1.SS2.p1.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS2.p1.1.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.2c">\hat{\bm{B}}\in(\bm{X}_{i},\hat{\bm{Y}}_{i})</annotation></semantics></math> and <math id="A1.SS2.p1.2.m2.2" class="ltx_Math" alttext="{\bm{B}}\in(\bm{X}_{i},\bm{Y}_{i})" display="inline"><semantics id="A1.SS2.p1.2.m2.2a"><mrow id="A1.SS2.p1.2.m2.2.2" xref="A1.SS2.p1.2.m2.2.2.cmml"><mi id="A1.SS2.p1.2.m2.2.2.4" xref="A1.SS2.p1.2.m2.2.2.4.cmml">𝑩</mi><mo id="A1.SS2.p1.2.m2.2.2.3" xref="A1.SS2.p1.2.m2.2.2.3.cmml">∈</mo><mrow id="A1.SS2.p1.2.m2.2.2.2.2" xref="A1.SS2.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p1.2.m2.2.2.2.2.3" xref="A1.SS2.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p1.2.m2.1.1.1.1.1" xref="A1.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.2.m2.1.1.1.1.1.2" xref="A1.SS2.p1.2.m2.1.1.1.1.1.2.cmml">𝑿</mi><mi id="A1.SS2.p1.2.m2.1.1.1.1.1.3" xref="A1.SS2.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p1.2.m2.2.2.2.2.4" xref="A1.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p1.2.m2.2.2.2.2.2" xref="A1.SS2.p1.2.m2.2.2.2.2.2.cmml"><mi id="A1.SS2.p1.2.m2.2.2.2.2.2.2" xref="A1.SS2.p1.2.m2.2.2.2.2.2.2.cmml">𝒀</mi><mi id="A1.SS2.p1.2.m2.2.2.2.2.2.3" xref="A1.SS2.p1.2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p1.2.m2.2.2.2.2.5" xref="A1.SS2.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.2b"><apply id="A1.SS2.p1.2.m2.2.2.cmml" xref="A1.SS2.p1.2.m2.2.2"><in id="A1.SS2.p1.2.m2.2.2.3.cmml" xref="A1.SS2.p1.2.m2.2.2.3"></in><ci id="A1.SS2.p1.2.m2.2.2.4.cmml" xref="A1.SS2.p1.2.m2.2.2.4">𝑩</ci><interval closure="open" id="A1.SS2.p1.2.m2.2.2.2.3.cmml" xref="A1.SS2.p1.2.m2.2.2.2.2"><apply id="A1.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.1.2">𝑿</ci><ci id="A1.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p1.2.m2.2.2.2.2.2.cmml" xref="A1.SS2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.2.2.2.2.2.1.cmml" xref="A1.SS2.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="A1.SS2.p1.2.m2.2.2.2.2.2.2">𝒀</ci><ci id="A1.SS2.p1.2.m2.2.2.2.2.2.3.cmml" xref="A1.SS2.p1.2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.2c">{\bm{B}}\in(\bm{X}_{i},\bm{Y}_{i})</annotation></semantics></math>. In the first step, backpropagation is performed on <math id="A1.SS2.p1.3.m3.1" class="ltx_Math" alttext="\hat{\bm{B}}" display="inline"><semantics id="A1.SS2.p1.3.m3.1a"><mover accent="true" id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml"><mi id="A1.SS2.p1.3.m3.1.1.2" xref="A1.SS2.p1.3.m3.1.1.2.cmml">𝑩</mi><mo id="A1.SS2.p1.3.m3.1.1.1" xref="A1.SS2.p1.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><apply id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1"><ci id="A1.SS2.p1.3.m3.1.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1.1">^</ci><ci id="A1.SS2.p1.3.m3.1.1.2.cmml" xref="A1.SS2.p1.3.m3.1.1.2">𝑩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">\hat{\bm{B}}</annotation></semantics></math> and the client model <math id="A1.SS2.p1.4.m4.1" class="ltx_Math" alttext="\bm{\bm{F}}_{i}" display="inline"><semantics id="A1.SS2.p1.4.m4.1a"><msub id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml"><mi id="A1.SS2.p1.4.m4.1.1.2" xref="A1.SS2.p1.4.m4.1.1.2.cmml">𝑭</mi><mi id="A1.SS2.p1.4.m4.1.1.3" xref="A1.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><apply id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.p1.4.m4.1.1.2.cmml" xref="A1.SS2.p1.4.m4.1.1.2">𝑭</ci><ci id="A1.SS2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">\bm{\bm{F}}_{i}</annotation></semantics></math> is updated. We denote the original client model as <math id="A1.SS2.p1.5.m5.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="A1.SS2.p1.5.m5.1a"><msub id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml"><mi id="A1.SS2.p1.5.m5.1.1.2" xref="A1.SS2.p1.5.m5.1.1.2.cmml">𝑭</mi><mi id="A1.SS2.p1.5.m5.1.1.3" xref="A1.SS2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><apply id="A1.SS2.p1.5.m5.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1.2">𝑭</ci><ci id="A1.SS2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">\bm{F}_{i}</annotation></semantics></math> and the updated client model as <math id="A1.SS2.p1.6.m6.1" class="ltx_Math" alttext="\bm{F}^{\prime}_{i}" display="inline"><semantics id="A1.SS2.p1.6.m6.1a"><msubsup id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml"><mi id="A1.SS2.p1.6.m6.1.1.2.2" xref="A1.SS2.p1.6.m6.1.1.2.2.cmml">𝑭</mi><mi id="A1.SS2.p1.6.m6.1.1.3" xref="A1.SS2.p1.6.m6.1.1.3.cmml">i</mi><mo id="A1.SS2.p1.6.m6.1.1.2.3" xref="A1.SS2.p1.6.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><apply id="A1.SS2.p1.6.m6.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m6.1.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1">subscript</csymbol><apply id="A1.SS2.p1.6.m6.1.1.2.cmml" xref="A1.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.6.m6.1.1.2.1.cmml" xref="A1.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="A1.SS2.p1.6.m6.1.1.2.2.cmml" xref="A1.SS2.p1.6.m6.1.1.2.2">𝑭</ci><ci id="A1.SS2.p1.6.m6.1.1.2.3.cmml" xref="A1.SS2.p1.6.m6.1.1.2.3">′</ci></apply><ci id="A1.SS2.p1.6.m6.1.1.3.cmml" xref="A1.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">\bm{F}^{\prime}_{i}</annotation></semantics></math>. <math id="A1.SS2.p1.7.m7.1" class="ltx_Math" alttext="\bm{F}^{\prime}_{i}" display="inline"><semantics id="A1.SS2.p1.7.m7.1a"><msubsup id="A1.SS2.p1.7.m7.1.1" xref="A1.SS2.p1.7.m7.1.1.cmml"><mi id="A1.SS2.p1.7.m7.1.1.2.2" xref="A1.SS2.p1.7.m7.1.1.2.2.cmml">𝑭</mi><mi id="A1.SS2.p1.7.m7.1.1.3" xref="A1.SS2.p1.7.m7.1.1.3.cmml">i</mi><mo id="A1.SS2.p1.7.m7.1.1.2.3" xref="A1.SS2.p1.7.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.7.m7.1b"><apply id="A1.SS2.p1.7.m7.1.1.cmml" xref="A1.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.7.m7.1.1.1.cmml" xref="A1.SS2.p1.7.m7.1.1">subscript</csymbol><apply id="A1.SS2.p1.7.m7.1.1.2.cmml" xref="A1.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.7.m7.1.1.2.1.cmml" xref="A1.SS2.p1.7.m7.1.1">superscript</csymbol><ci id="A1.SS2.p1.7.m7.1.1.2.2.cmml" xref="A1.SS2.p1.7.m7.1.1.2.2">𝑭</ci><ci id="A1.SS2.p1.7.m7.1.1.2.3.cmml" xref="A1.SS2.p1.7.m7.1.1.2.3">′</ci></apply><ci id="A1.SS2.p1.7.m7.1.1.3.cmml" xref="A1.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.7.m7.1c">\bm{F}^{\prime}_{i}</annotation></semantics></math> will be evaluated on <math id="A1.SS2.p1.8.m8.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="A1.SS2.p1.8.m8.1a"><mi id="A1.SS2.p1.8.m8.1.1" xref="A1.SS2.p1.8.m8.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.8.m8.1b"><ci id="A1.SS2.p1.8.m8.1.1.cmml" xref="A1.SS2.p1.8.m8.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.8.m8.1c">\bm{B}</annotation></semantics></math> to get the sample weight.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.8" class="ltx_p">In the second step, the loss function is changed. Assuming the original loss function is <math id="A1.SS2.p2.1.m1.2" class="ltx_Math" alttext="l_{\bm{B}}=\sum_{1}^{b_{i}}l(\bar{\bm{y}}_{j},\bm{y}_{j})" display="inline"><semantics id="A1.SS2.p2.1.m1.2a"><mrow id="A1.SS2.p2.1.m1.2.2" xref="A1.SS2.p2.1.m1.2.2.cmml"><msub id="A1.SS2.p2.1.m1.2.2.4" xref="A1.SS2.p2.1.m1.2.2.4.cmml"><mi id="A1.SS2.p2.1.m1.2.2.4.2" xref="A1.SS2.p2.1.m1.2.2.4.2.cmml">l</mi><mi id="A1.SS2.p2.1.m1.2.2.4.3" xref="A1.SS2.p2.1.m1.2.2.4.3.cmml">𝑩</mi></msub><mo rspace="0.111em" id="A1.SS2.p2.1.m1.2.2.3" xref="A1.SS2.p2.1.m1.2.2.3.cmml">=</mo><mrow id="A1.SS2.p2.1.m1.2.2.2" xref="A1.SS2.p2.1.m1.2.2.2.cmml"><msubsup id="A1.SS2.p2.1.m1.2.2.2.3" xref="A1.SS2.p2.1.m1.2.2.2.3.cmml"><mo id="A1.SS2.p2.1.m1.2.2.2.3.2.2" xref="A1.SS2.p2.1.m1.2.2.2.3.2.2.cmml">∑</mo><mn id="A1.SS2.p2.1.m1.2.2.2.3.2.3" xref="A1.SS2.p2.1.m1.2.2.2.3.2.3.cmml">1</mn><msub id="A1.SS2.p2.1.m1.2.2.2.3.3" xref="A1.SS2.p2.1.m1.2.2.2.3.3.cmml"><mi id="A1.SS2.p2.1.m1.2.2.2.3.3.2" xref="A1.SS2.p2.1.m1.2.2.2.3.3.2.cmml">b</mi><mi id="A1.SS2.p2.1.m1.2.2.2.3.3.3" xref="A1.SS2.p2.1.m1.2.2.2.3.3.3.cmml">i</mi></msub></msubsup><mrow id="A1.SS2.p2.1.m1.2.2.2.2" xref="A1.SS2.p2.1.m1.2.2.2.2.cmml"><mi id="A1.SS2.p2.1.m1.2.2.2.2.4" xref="A1.SS2.p2.1.m1.2.2.2.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p2.1.m1.2.2.2.2.3" xref="A1.SS2.p2.1.m1.2.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p2.1.m1.2.2.2.2.2.2" xref="A1.SS2.p2.1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p2.1.m1.2.2.2.2.2.2.3" xref="A1.SS2.p2.1.m1.2.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.1" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p2.1.m1.2.2.2.2.2.2.4" xref="A1.SS2.p2.1.m1.2.2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.2" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.2.cmml">𝒚</mi><mi id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.3" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="A1.SS2.p2.1.m1.2.2.2.2.2.2.5" xref="A1.SS2.p2.1.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.2b"><apply id="A1.SS2.p2.1.m1.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2"><eq id="A1.SS2.p2.1.m1.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.3"></eq><apply id="A1.SS2.p2.1.m1.2.2.4.cmml" xref="A1.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.4.1.cmml" xref="A1.SS2.p2.1.m1.2.2.4">subscript</csymbol><ci id="A1.SS2.p2.1.m1.2.2.4.2.cmml" xref="A1.SS2.p2.1.m1.2.2.4.2">𝑙</ci><ci id="A1.SS2.p2.1.m1.2.2.4.3.cmml" xref="A1.SS2.p2.1.m1.2.2.4.3">𝑩</ci></apply><apply id="A1.SS2.p2.1.m1.2.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2"><apply id="A1.SS2.p2.1.m1.2.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.2.3.1.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3">superscript</csymbol><apply id="A1.SS2.p2.1.m1.2.2.2.3.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.2.3.2.1.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3">subscript</csymbol><sum id="A1.SS2.p2.1.m1.2.2.2.3.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.2.2"></sum><cn type="integer" id="A1.SS2.p2.1.m1.2.2.2.3.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.2.3">1</cn></apply><apply id="A1.SS2.p2.1.m1.2.2.2.3.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.2.3.3.1.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.3">subscript</csymbol><ci id="A1.SS2.p2.1.m1.2.2.2.3.3.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.3.2">𝑏</ci><ci id="A1.SS2.p2.1.m1.2.2.2.3.3.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="A1.SS2.p2.1.m1.2.2.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2"><times id="A1.SS2.p2.1.m1.2.2.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.3"></times><ci id="A1.SS2.p2.1.m1.2.2.2.2.4.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.4">𝑙</ci><interval closure="open" id="A1.SS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2"><apply id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2"><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.2">𝒚</ci><ci id="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p2.1.m1.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.2c">l_{\bm{B}}=\sum_{1}^{b_{i}}l(\bar{\bm{y}}_{j},\bm{y}_{j})</annotation></semantics></math>, where <math id="A1.SS2.p2.2.m2.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="A1.SS2.p2.2.m2.1a"><msub id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mi id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml">b</mi><mi id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2">𝑏</ci><ci id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">b_{i}</annotation></semantics></math> is the batch size of <math id="A1.SS2.p2.3.m3.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="A1.SS2.p2.3.m3.1a"><mi id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><ci id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">\bm{B}</annotation></semantics></math> and <math id="A1.SS2.p2.4.m4.1" class="ltx_Math" alttext="\hat{\bm{B}}" display="inline"><semantics id="A1.SS2.p2.4.m4.1a"><mover accent="true" id="A1.SS2.p2.4.m4.1.1" xref="A1.SS2.p2.4.m4.1.1.cmml"><mi id="A1.SS2.p2.4.m4.1.1.2" xref="A1.SS2.p2.4.m4.1.1.2.cmml">𝑩</mi><mo id="A1.SS2.p2.4.m4.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.1b"><apply id="A1.SS2.p2.4.m4.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1"><ci id="A1.SS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1">^</ci><ci id="A1.SS2.p2.4.m4.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.2">𝑩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.1c">\hat{\bm{B}}</annotation></semantics></math>, <math id="A1.SS2.p2.5.m5.1" class="ltx_Math" alttext="\bar{\bm{y}}_{j}" display="inline"><semantics id="A1.SS2.p2.5.m5.1a"><msub id="A1.SS2.p2.5.m5.1.1" xref="A1.SS2.p2.5.m5.1.1.cmml"><mover accent="true" id="A1.SS2.p2.5.m5.1.1.2" xref="A1.SS2.p2.5.m5.1.1.2.cmml"><mi id="A1.SS2.p2.5.m5.1.1.2.2" xref="A1.SS2.p2.5.m5.1.1.2.2.cmml">𝒚</mi><mo id="A1.SS2.p2.5.m5.1.1.2.1" xref="A1.SS2.p2.5.m5.1.1.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p2.5.m5.1.1.3" xref="A1.SS2.p2.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m5.1b"><apply id="A1.SS2.p2.5.m5.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m5.1.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1">subscript</csymbol><apply id="A1.SS2.p2.5.m5.1.1.2.cmml" xref="A1.SS2.p2.5.m5.1.1.2"><ci id="A1.SS2.p2.5.m5.1.1.2.1.cmml" xref="A1.SS2.p2.5.m5.1.1.2.1">¯</ci><ci id="A1.SS2.p2.5.m5.1.1.2.2.cmml" xref="A1.SS2.p2.5.m5.1.1.2.2">𝒚</ci></apply><ci id="A1.SS2.p2.5.m5.1.1.3.cmml" xref="A1.SS2.p2.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m5.1c">\bar{\bm{y}}_{j}</annotation></semantics></math> is the prediction of <math id="A1.SS2.p2.6.m6.1" class="ltx_Math" alttext="\bm{F}^{\prime}_{i}" display="inline"><semantics id="A1.SS2.p2.6.m6.1a"><msubsup id="A1.SS2.p2.6.m6.1.1" xref="A1.SS2.p2.6.m6.1.1.cmml"><mi id="A1.SS2.p2.6.m6.1.1.2.2" xref="A1.SS2.p2.6.m6.1.1.2.2.cmml">𝑭</mi><mi id="A1.SS2.p2.6.m6.1.1.3" xref="A1.SS2.p2.6.m6.1.1.3.cmml">i</mi><mo id="A1.SS2.p2.6.m6.1.1.2.3" xref="A1.SS2.p2.6.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m6.1b"><apply id="A1.SS2.p2.6.m6.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.6.m6.1.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1">subscript</csymbol><apply id="A1.SS2.p2.6.m6.1.1.2.cmml" xref="A1.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.6.m6.1.1.2.1.cmml" xref="A1.SS2.p2.6.m6.1.1">superscript</csymbol><ci id="A1.SS2.p2.6.m6.1.1.2.2.cmml" xref="A1.SS2.p2.6.m6.1.1.2.2">𝑭</ci><ci id="A1.SS2.p2.6.m6.1.1.2.3.cmml" xref="A1.SS2.p2.6.m6.1.1.2.3">′</ci></apply><ci id="A1.SS2.p2.6.m6.1.1.3.cmml" xref="A1.SS2.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m6.1c">\bm{F}^{\prime}_{i}</annotation></semantics></math> and <math id="A1.SS2.p2.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A1.SS2.p2.7.m7.1a"><mi id="A1.SS2.p2.7.m7.1.1" xref="A1.SS2.p2.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m7.1b"><ci id="A1.SS2.p2.7.m7.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m7.1c">l</annotation></semantics></math> is per-sample loss function. In this paper, we use CrossEntropy to compute <math id="A1.SS2.p2.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A1.SS2.p2.8.m8.1a"><mi id="A1.SS2.p2.8.m8.1.1" xref="A1.SS2.p2.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.8.m8.1b"><ci id="A1.SS2.p2.8.m8.1.1.cmml" xref="A1.SS2.p2.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.8.m8.1c">l</annotation></semantics></math>. The new loss function is computed as follows:</p>
<table id="A1.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E7.m1.1" class="ltx_Math" alttext="\hat{l}_{\bm{B}}=\sum_{j=1}^{b_{i}}\bm{\epsilon}_{j}\cdot l(\bar{\bm{y}}_{j},\bm{y}_{j})," display="block"><semantics id="A1.E7.m1.1a"><mrow id="A1.E7.m1.1.1.1" xref="A1.E7.m1.1.1.1.1.cmml"><mrow id="A1.E7.m1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.cmml"><msub id="A1.E7.m1.1.1.1.1.4" xref="A1.E7.m1.1.1.1.1.4.cmml"><mover accent="true" id="A1.E7.m1.1.1.1.1.4.2" xref="A1.E7.m1.1.1.1.1.4.2.cmml"><mi id="A1.E7.m1.1.1.1.1.4.2.2" xref="A1.E7.m1.1.1.1.1.4.2.2.cmml">l</mi><mo id="A1.E7.m1.1.1.1.1.4.2.1" xref="A1.E7.m1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="A1.E7.m1.1.1.1.1.4.3" xref="A1.E7.m1.1.1.1.1.4.3.cmml">𝑩</mi></msub><mo rspace="0.111em" id="A1.E7.m1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.3.cmml">=</mo><mrow id="A1.E7.m1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.2.cmml"><munderover id="A1.E7.m1.1.1.1.1.2.3" xref="A1.E7.m1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="A1.E7.m1.1.1.1.1.2.3.2.2" xref="A1.E7.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="A1.E7.m1.1.1.1.1.2.3.2.3" xref="A1.E7.m1.1.1.1.1.2.3.2.3.cmml"><mi id="A1.E7.m1.1.1.1.1.2.3.2.3.2" xref="A1.E7.m1.1.1.1.1.2.3.2.3.2.cmml">j</mi><mo id="A1.E7.m1.1.1.1.1.2.3.2.3.1" xref="A1.E7.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="A1.E7.m1.1.1.1.1.2.3.2.3.3" xref="A1.E7.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><msub id="A1.E7.m1.1.1.1.1.2.3.3" xref="A1.E7.m1.1.1.1.1.2.3.3.cmml"><mi id="A1.E7.m1.1.1.1.1.2.3.3.2" xref="A1.E7.m1.1.1.1.1.2.3.3.2.cmml">b</mi><mi id="A1.E7.m1.1.1.1.1.2.3.3.3" xref="A1.E7.m1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></munderover><mrow id="A1.E7.m1.1.1.1.1.2.2" xref="A1.E7.m1.1.1.1.1.2.2.cmml"><mrow id="A1.E7.m1.1.1.1.1.2.2.4" xref="A1.E7.m1.1.1.1.1.2.2.4.cmml"><msub id="A1.E7.m1.1.1.1.1.2.2.4.2" xref="A1.E7.m1.1.1.1.1.2.2.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.E7.m1.1.1.1.1.2.2.4.2.2" xref="A1.E7.m1.1.1.1.1.2.2.4.2.2.cmml">ϵ</mi><mi id="A1.E7.m1.1.1.1.1.2.2.4.2.3" xref="A1.E7.m1.1.1.1.1.2.2.4.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E7.m1.1.1.1.1.2.2.4.1" xref="A1.E7.m1.1.1.1.1.2.2.4.1.cmml">⋅</mo><mi id="A1.E7.m1.1.1.1.1.2.2.4.3" xref="A1.E7.m1.1.1.1.1.2.2.4.3.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="A1.E7.m1.1.1.1.1.2.2.3" xref="A1.E7.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="A1.E7.m1.1.1.1.1.2.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="A1.E7.m1.1.1.1.1.2.2.2.2.3" xref="A1.E7.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="A1.E7.m1.1.1.1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mi id="A1.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E7.m1.1.1.1.1.2.2.2.2.4" xref="A1.E7.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="A1.E7.m1.1.1.1.1.2.2.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="A1.E7.m1.1.1.1.1.2.2.2.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝒚</mi><mi id="A1.E7.m1.1.1.1.1.2.2.2.2.2.3" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="A1.E7.m1.1.1.1.1.2.2.2.2.5" xref="A1.E7.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E7.m1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.1b"><apply id="A1.E7.m1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1"><eq id="A1.E7.m1.1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.3"></eq><apply id="A1.E7.m1.1.1.1.1.4.cmml" xref="A1.E7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.4.1.cmml" xref="A1.E7.m1.1.1.1.1.4">subscript</csymbol><apply id="A1.E7.m1.1.1.1.1.4.2.cmml" xref="A1.E7.m1.1.1.1.1.4.2"><ci id="A1.E7.m1.1.1.1.1.4.2.1.cmml" xref="A1.E7.m1.1.1.1.1.4.2.1">^</ci><ci id="A1.E7.m1.1.1.1.1.4.2.2.cmml" xref="A1.E7.m1.1.1.1.1.4.2.2">𝑙</ci></apply><ci id="A1.E7.m1.1.1.1.1.4.3.cmml" xref="A1.E7.m1.1.1.1.1.4.3">𝑩</ci></apply><apply id="A1.E7.m1.1.1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.2"><apply id="A1.E7.m1.1.1.1.1.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.3.1.cmml" xref="A1.E7.m1.1.1.1.1.2.3">superscript</csymbol><apply id="A1.E7.m1.1.1.1.1.2.3.2.cmml" xref="A1.E7.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.3.2.1.cmml" xref="A1.E7.m1.1.1.1.1.2.3">subscript</csymbol><sum id="A1.E7.m1.1.1.1.1.2.3.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.3.2.2"></sum><apply id="A1.E7.m1.1.1.1.1.2.3.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.3.2.3"><eq id="A1.E7.m1.1.1.1.1.2.3.2.3.1.cmml" xref="A1.E7.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="A1.E7.m1.1.1.1.1.2.3.2.3.2.cmml" xref="A1.E7.m1.1.1.1.1.2.3.2.3.2">𝑗</ci><cn type="integer" id="A1.E7.m1.1.1.1.1.2.3.2.3.3.cmml" xref="A1.E7.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><apply id="A1.E7.m1.1.1.1.1.2.3.3.cmml" xref="A1.E7.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.3.3.1.cmml" xref="A1.E7.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="A1.E7.m1.1.1.1.1.2.3.3.2.cmml" xref="A1.E7.m1.1.1.1.1.2.3.3.2">𝑏</ci><ci id="A1.E7.m1.1.1.1.1.2.3.3.3.cmml" xref="A1.E7.m1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply><apply id="A1.E7.m1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2"><times id="A1.E7.m1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.3"></times><apply id="A1.E7.m1.1.1.1.1.2.2.4.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4"><ci id="A1.E7.m1.1.1.1.1.2.2.4.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.1">⋅</ci><apply id="A1.E7.m1.1.1.1.1.2.2.4.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.2"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.2.4.2.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.2">subscript</csymbol><ci id="A1.E7.m1.1.1.1.1.2.2.4.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.2.2">bold-italic-ϵ</ci><ci id="A1.E7.m1.1.1.1.1.2.2.4.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.2.3">𝑗</ci></apply><ci id="A1.E7.m1.1.1.1.1.2.2.4.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.4.3">𝑙</ci></apply><interval closure="open" id="A1.E7.m1.1.1.1.1.2.2.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2"><apply id="A1.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2"><ci id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="A1.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.E7.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="A1.E7.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.2">𝒚</ci><ci id="A1.E7.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.1c">\hat{l}_{\bm{B}}=\sum_{j=1}^{b_{i}}\bm{\epsilon}_{j}\cdot l(\bar{\bm{y}}_{j},\bm{y}_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p2.15" class="ltx_p">where <math id="A1.SS2.p2.9.m1.1" class="ltx_Math" alttext="\bm{\epsilon}_{j}" display="inline"><semantics id="A1.SS2.p2.9.m1.1a"><msub id="A1.SS2.p2.9.m1.1.1" xref="A1.SS2.p2.9.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS2.p2.9.m1.1.1.2" xref="A1.SS2.p2.9.m1.1.1.2.cmml">ϵ</mi><mi id="A1.SS2.p2.9.m1.1.1.3" xref="A1.SS2.p2.9.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.9.m1.1b"><apply id="A1.SS2.p2.9.m1.1.1.cmml" xref="A1.SS2.p2.9.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.9.m1.1.1.1.cmml" xref="A1.SS2.p2.9.m1.1.1">subscript</csymbol><ci id="A1.SS2.p2.9.m1.1.1.2.cmml" xref="A1.SS2.p2.9.m1.1.1.2">bold-italic-ϵ</ci><ci id="A1.SS2.p2.9.m1.1.1.3.cmml" xref="A1.SS2.p2.9.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.9.m1.1c">\bm{\epsilon}_{j}</annotation></semantics></math> is the perturbation to the per-sample loss. <math id="A1.SS2.p2.10.m2.1" class="ltx_Math" alttext="\bm{\epsilon_{j}}" display="inline"><semantics id="A1.SS2.p2.10.m2.1a"><msub id="A1.SS2.p2.10.m2.1.1" xref="A1.SS2.p2.10.m2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS2.p2.10.m2.1.1.2" xref="A1.SS2.p2.10.m2.1.1.2.cmml">ϵ</mi><mi id="A1.SS2.p2.10.m2.1.1.3" xref="A1.SS2.p2.10.m2.1.1.3.cmml">𝒋</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.10.m2.1b"><apply id="A1.SS2.p2.10.m2.1.1.cmml" xref="A1.SS2.p2.10.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.10.m2.1.1.1.cmml" xref="A1.SS2.p2.10.m2.1.1">subscript</csymbol><ci id="A1.SS2.p2.10.m2.1.1.2.cmml" xref="A1.SS2.p2.10.m2.1.1.2">bold-italic-ϵ</ci><ci id="A1.SS2.p2.10.m2.1.1.3.cmml" xref="A1.SS2.p2.10.m2.1.1.3">𝒋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.10.m2.1c">\bm{\epsilon_{j}}</annotation></semantics></math> is initialized to 1 for all samples. When <math id="A1.SS2.p2.11.m3.1" class="ltx_Math" alttext="\bm{F}^{\prime}_{i}" display="inline"><semantics id="A1.SS2.p2.11.m3.1a"><msubsup id="A1.SS2.p2.11.m3.1.1" xref="A1.SS2.p2.11.m3.1.1.cmml"><mi id="A1.SS2.p2.11.m3.1.1.2.2" xref="A1.SS2.p2.11.m3.1.1.2.2.cmml">𝑭</mi><mi id="A1.SS2.p2.11.m3.1.1.3" xref="A1.SS2.p2.11.m3.1.1.3.cmml">i</mi><mo id="A1.SS2.p2.11.m3.1.1.2.3" xref="A1.SS2.p2.11.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.11.m3.1b"><apply id="A1.SS2.p2.11.m3.1.1.cmml" xref="A1.SS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.11.m3.1.1.1.cmml" xref="A1.SS2.p2.11.m3.1.1">subscript</csymbol><apply id="A1.SS2.p2.11.m3.1.1.2.cmml" xref="A1.SS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.11.m3.1.1.2.1.cmml" xref="A1.SS2.p2.11.m3.1.1">superscript</csymbol><ci id="A1.SS2.p2.11.m3.1.1.2.2.cmml" xref="A1.SS2.p2.11.m3.1.1.2.2">𝑭</ci><ci id="A1.SS2.p2.11.m3.1.1.2.3.cmml" xref="A1.SS2.p2.11.m3.1.1.2.3">′</ci></apply><ci id="A1.SS2.p2.11.m3.1.1.3.cmml" xref="A1.SS2.p2.11.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.11.m3.1c">\bm{F}^{\prime}_{i}</annotation></semantics></math> performs backpropagation on <math id="A1.SS2.p2.12.m4.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="A1.SS2.p2.12.m4.1a"><mi id="A1.SS2.p2.12.m4.1.1" xref="A1.SS2.p2.12.m4.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.12.m4.1b"><ci id="A1.SS2.p2.12.m4.1.1.cmml" xref="A1.SS2.p2.12.m4.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.12.m4.1c">\bm{B}</annotation></semantics></math> with <math id="A1.SS2.p2.13.m5.1" class="ltx_Math" alttext="\hat{l}_{\bm{B}}" display="inline"><semantics id="A1.SS2.p2.13.m5.1a"><msub id="A1.SS2.p2.13.m5.1.1" xref="A1.SS2.p2.13.m5.1.1.cmml"><mover accent="true" id="A1.SS2.p2.13.m5.1.1.2" xref="A1.SS2.p2.13.m5.1.1.2.cmml"><mi id="A1.SS2.p2.13.m5.1.1.2.2" xref="A1.SS2.p2.13.m5.1.1.2.2.cmml">l</mi><mo id="A1.SS2.p2.13.m5.1.1.2.1" xref="A1.SS2.p2.13.m5.1.1.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.13.m5.1.1.3" xref="A1.SS2.p2.13.m5.1.1.3.cmml">𝑩</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.13.m5.1b"><apply id="A1.SS2.p2.13.m5.1.1.cmml" xref="A1.SS2.p2.13.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.13.m5.1.1.1.cmml" xref="A1.SS2.p2.13.m5.1.1">subscript</csymbol><apply id="A1.SS2.p2.13.m5.1.1.2.cmml" xref="A1.SS2.p2.13.m5.1.1.2"><ci id="A1.SS2.p2.13.m5.1.1.2.1.cmml" xref="A1.SS2.p2.13.m5.1.1.2.1">^</ci><ci id="A1.SS2.p2.13.m5.1.1.2.2.cmml" xref="A1.SS2.p2.13.m5.1.1.2.2">𝑙</ci></apply><ci id="A1.SS2.p2.13.m5.1.1.3.cmml" xref="A1.SS2.p2.13.m5.1.1.3">𝑩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.13.m5.1c">\hat{l}_{\bm{B}}</annotation></semantics></math>, we get the grad to <math id="A1.SS2.p2.14.m6.1" class="ltx_Math" alttext="\bm{\epsilon}" display="inline"><semantics id="A1.SS2.p2.14.m6.1a"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS2.p2.14.m6.1.1" xref="A1.SS2.p2.14.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.14.m6.1b"><ci id="A1.SS2.p2.14.m6.1.1.cmml" xref="A1.SS2.p2.14.m6.1.1">bold-italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.14.m6.1c">\bm{\epsilon}</annotation></semantics></math>, <math id="A1.SS2.p2.15.m7.1" class="ltx_Math" alttext="\nabla{\bm{\epsilon}}=\frac{\partial\hat{l}_{\bm{B}}}{\partial\bm{\epsilon}}" display="inline"><semantics id="A1.SS2.p2.15.m7.1a"><mrow id="A1.SS2.p2.15.m7.1.1" xref="A1.SS2.p2.15.m7.1.1.cmml"><mrow id="A1.SS2.p2.15.m7.1.1.2" xref="A1.SS2.p2.15.m7.1.1.2.cmml"><mo rspace="0.167em" id="A1.SS2.p2.15.m7.1.1.2.1" xref="A1.SS2.p2.15.m7.1.1.2.1.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS2.p2.15.m7.1.1.2.2" xref="A1.SS2.p2.15.m7.1.1.2.2.cmml">ϵ</mi></mrow><mo id="A1.SS2.p2.15.m7.1.1.1" xref="A1.SS2.p2.15.m7.1.1.1.cmml">=</mo><mfrac id="A1.SS2.p2.15.m7.1.1.3" xref="A1.SS2.p2.15.m7.1.1.3.cmml"><mrow id="A1.SS2.p2.15.m7.1.1.3.2" xref="A1.SS2.p2.15.m7.1.1.3.2.cmml"><mo rspace="0em" id="A1.SS2.p2.15.m7.1.1.3.2.1" xref="A1.SS2.p2.15.m7.1.1.3.2.1.cmml">∂</mo><msub id="A1.SS2.p2.15.m7.1.1.3.2.2" xref="A1.SS2.p2.15.m7.1.1.3.2.2.cmml"><mover accent="true" id="A1.SS2.p2.15.m7.1.1.3.2.2.2" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2.cmml"><mi id="A1.SS2.p2.15.m7.1.1.3.2.2.2.2" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2.2.cmml">l</mi><mo id="A1.SS2.p2.15.m7.1.1.3.2.2.2.1" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.15.m7.1.1.3.2.2.3" xref="A1.SS2.p2.15.m7.1.1.3.2.2.3.cmml">𝑩</mi></msub></mrow><mrow id="A1.SS2.p2.15.m7.1.1.3.3" xref="A1.SS2.p2.15.m7.1.1.3.3.cmml"><mo rspace="0em" id="A1.SS2.p2.15.m7.1.1.3.3.1" xref="A1.SS2.p2.15.m7.1.1.3.3.1.cmml">∂</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.SS2.p2.15.m7.1.1.3.3.2" xref="A1.SS2.p2.15.m7.1.1.3.3.2.cmml">ϵ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.15.m7.1b"><apply id="A1.SS2.p2.15.m7.1.1.cmml" xref="A1.SS2.p2.15.m7.1.1"><eq id="A1.SS2.p2.15.m7.1.1.1.cmml" xref="A1.SS2.p2.15.m7.1.1.1"></eq><apply id="A1.SS2.p2.15.m7.1.1.2.cmml" xref="A1.SS2.p2.15.m7.1.1.2"><ci id="A1.SS2.p2.15.m7.1.1.2.1.cmml" xref="A1.SS2.p2.15.m7.1.1.2.1">∇</ci><ci id="A1.SS2.p2.15.m7.1.1.2.2.cmml" xref="A1.SS2.p2.15.m7.1.1.2.2">bold-italic-ϵ</ci></apply><apply id="A1.SS2.p2.15.m7.1.1.3.cmml" xref="A1.SS2.p2.15.m7.1.1.3"><divide id="A1.SS2.p2.15.m7.1.1.3.1.cmml" xref="A1.SS2.p2.15.m7.1.1.3"></divide><apply id="A1.SS2.p2.15.m7.1.1.3.2.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2"><partialdiff id="A1.SS2.p2.15.m7.1.1.3.2.1.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.1"></partialdiff><apply id="A1.SS2.p2.15.m7.1.1.3.2.2.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.15.m7.1.1.3.2.2.1.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2">subscript</csymbol><apply id="A1.SS2.p2.15.m7.1.1.3.2.2.2.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2"><ci id="A1.SS2.p2.15.m7.1.1.3.2.2.2.1.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2.1">^</ci><ci id="A1.SS2.p2.15.m7.1.1.3.2.2.2.2.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2.2.2">𝑙</ci></apply><ci id="A1.SS2.p2.15.m7.1.1.3.2.2.3.cmml" xref="A1.SS2.p2.15.m7.1.1.3.2.2.3">𝑩</ci></apply></apply><apply id="A1.SS2.p2.15.m7.1.1.3.3.cmml" xref="A1.SS2.p2.15.m7.1.1.3.3"><partialdiff id="A1.SS2.p2.15.m7.1.1.3.3.1.cmml" xref="A1.SS2.p2.15.m7.1.1.3.3.1"></partialdiff><ci id="A1.SS2.p2.15.m7.1.1.3.3.2.cmml" xref="A1.SS2.p2.15.m7.1.1.3.3.2">bold-italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.15.m7.1c">\nabla{\bm{\epsilon}}=\frac{\partial\hat{l}_{\bm{B}}}{\partial\bm{\epsilon}}</annotation></semantics></math>. The sample weight is computed as:</p>
<table id="A1.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E8.m1.2" class="ltx_Math" alttext="\hat{\bm{w}}=\mathrm{max}(-\nabla{\bm{\epsilon}},0)." display="block"><semantics id="A1.E8.m1.2a"><mrow id="A1.E8.m1.2.2.1" xref="A1.E8.m1.2.2.1.1.cmml"><mrow id="A1.E8.m1.2.2.1.1" xref="A1.E8.m1.2.2.1.1.cmml"><mover accent="true" id="A1.E8.m1.2.2.1.1.3" xref="A1.E8.m1.2.2.1.1.3.cmml"><mi id="A1.E8.m1.2.2.1.1.3.2" xref="A1.E8.m1.2.2.1.1.3.2.cmml">𝒘</mi><mo id="A1.E8.m1.2.2.1.1.3.1" xref="A1.E8.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="A1.E8.m1.2.2.1.1.2" xref="A1.E8.m1.2.2.1.1.2.cmml">=</mo><mrow id="A1.E8.m1.2.2.1.1.1" xref="A1.E8.m1.2.2.1.1.1.cmml"><mi id="A1.E8.m1.2.2.1.1.1.3" xref="A1.E8.m1.2.2.1.1.1.3.cmml">max</mi><mo lspace="0em" rspace="0em" id="A1.E8.m1.2.2.1.1.1.2" xref="A1.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.E8.m1.2.2.1.1.1.1.1" xref="A1.E8.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E8.m1.2.2.1.1.1.1.1.2" xref="A1.E8.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="A1.E8.m1.2.2.1.1.1.1.1.1" xref="A1.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="A1.E8.m1.2.2.1.1.1.1.1.1a" xref="A1.E8.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E8.m1.2.2.1.1.1.1.1.1.2" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="A1.E8.m1.2.2.1.1.1.1.1.1.2.1" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A1.E8.m1.2.2.1.1.1.1.1.1.2.2" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml">ϵ</mi></mrow></mrow><mo id="A1.E8.m1.2.2.1.1.1.1.1.3" xref="A1.E8.m1.2.2.1.1.1.1.2.cmml">,</mo><mn id="A1.E8.m1.1.1" xref="A1.E8.m1.1.1.cmml">0</mn><mo stretchy="false" id="A1.E8.m1.2.2.1.1.1.1.1.4" xref="A1.E8.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A1.E8.m1.2.2.1.2" xref="A1.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.2b"><apply id="A1.E8.m1.2.2.1.1.cmml" xref="A1.E8.m1.2.2.1"><eq id="A1.E8.m1.2.2.1.1.2.cmml" xref="A1.E8.m1.2.2.1.1.2"></eq><apply id="A1.E8.m1.2.2.1.1.3.cmml" xref="A1.E8.m1.2.2.1.1.3"><ci id="A1.E8.m1.2.2.1.1.3.1.cmml" xref="A1.E8.m1.2.2.1.1.3.1">^</ci><ci id="A1.E8.m1.2.2.1.1.3.2.cmml" xref="A1.E8.m1.2.2.1.1.3.2">𝒘</ci></apply><apply id="A1.E8.m1.2.2.1.1.1.cmml" xref="A1.E8.m1.2.2.1.1.1"><times id="A1.E8.m1.2.2.1.1.1.2.cmml" xref="A1.E8.m1.2.2.1.1.1.2"></times><ci id="A1.E8.m1.2.2.1.1.1.3.cmml" xref="A1.E8.m1.2.2.1.1.1.3">max</ci><interval closure="open" id="A1.E8.m1.2.2.1.1.1.1.2.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1"><apply id="A1.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1.1"><minus id="A1.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1.1"></minus><apply id="A1.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2"><ci id="A1.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2.1">∇</ci><ci id="A1.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.2.2.1.1.1.1.1.1.2.2">bold-italic-ϵ</ci></apply></apply><cn type="integer" id="A1.E8.m1.1.1.cmml" xref="A1.E8.m1.1.1">0</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.2c">\hat{\bm{w}}=\mathrm{max}(-\nabla{\bm{\epsilon}},0).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p2.16" class="ltx_p">To stabilize the training process, we normalize weights of samples from the same mini-batch as: <math id="A1.SS2.p2.16.m1.1" class="ltx_Math" alttext="\bm{w}_{j}=\frac{\hat{\bm{w}}_{j}}{\sum_{1}^{b_{i}}\hat{\bm{w}}_{j}}" display="inline"><semantics id="A1.SS2.p2.16.m1.1a"><mrow id="A1.SS2.p2.16.m1.1.1" xref="A1.SS2.p2.16.m1.1.1.cmml"><msub id="A1.SS2.p2.16.m1.1.1.2" xref="A1.SS2.p2.16.m1.1.1.2.cmml"><mi id="A1.SS2.p2.16.m1.1.1.2.2" xref="A1.SS2.p2.16.m1.1.1.2.2.cmml">𝒘</mi><mi id="A1.SS2.p2.16.m1.1.1.2.3" xref="A1.SS2.p2.16.m1.1.1.2.3.cmml">j</mi></msub><mo id="A1.SS2.p2.16.m1.1.1.1" xref="A1.SS2.p2.16.m1.1.1.1.cmml">=</mo><mfrac id="A1.SS2.p2.16.m1.1.1.3" xref="A1.SS2.p2.16.m1.1.1.3.cmml"><msub id="A1.SS2.p2.16.m1.1.1.3.2" xref="A1.SS2.p2.16.m1.1.1.3.2.cmml"><mover accent="true" id="A1.SS2.p2.16.m1.1.1.3.2.2" xref="A1.SS2.p2.16.m1.1.1.3.2.2.cmml"><mi id="A1.SS2.p2.16.m1.1.1.3.2.2.2" xref="A1.SS2.p2.16.m1.1.1.3.2.2.2.cmml">𝒘</mi><mo id="A1.SS2.p2.16.m1.1.1.3.2.2.1" xref="A1.SS2.p2.16.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.16.m1.1.1.3.2.3" xref="A1.SS2.p2.16.m1.1.1.3.2.3.cmml">j</mi></msub><mrow id="A1.SS2.p2.16.m1.1.1.3.3" xref="A1.SS2.p2.16.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="A1.SS2.p2.16.m1.1.1.3.3.1" xref="A1.SS2.p2.16.m1.1.1.3.3.1.cmml"><msubsup id="A1.SS2.p2.16.m1.1.1.3.3.1a" xref="A1.SS2.p2.16.m1.1.1.3.3.1.cmml"><mo id="A1.SS2.p2.16.m1.1.1.3.3.1.2.2" xref="A1.SS2.p2.16.m1.1.1.3.3.1.2.2.cmml">∑</mo><mn id="A1.SS2.p2.16.m1.1.1.3.3.1.2.3" xref="A1.SS2.p2.16.m1.1.1.3.3.1.2.3.cmml">1</mn><msub id="A1.SS2.p2.16.m1.1.1.3.3.1.3" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3.cmml"><mi id="A1.SS2.p2.16.m1.1.1.3.3.1.3.2" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3.2.cmml">b</mi><mi id="A1.SS2.p2.16.m1.1.1.3.3.1.3.3" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3.3.cmml">i</mi></msub></msubsup></mstyle><msub id="A1.SS2.p2.16.m1.1.1.3.3.2" xref="A1.SS2.p2.16.m1.1.1.3.3.2.cmml"><mover accent="true" id="A1.SS2.p2.16.m1.1.1.3.3.2.2" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2.cmml"><mi id="A1.SS2.p2.16.m1.1.1.3.3.2.2.2" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2.2.cmml">𝒘</mi><mo id="A1.SS2.p2.16.m1.1.1.3.3.2.2.1" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="A1.SS2.p2.16.m1.1.1.3.3.2.3" xref="A1.SS2.p2.16.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.16.m1.1b"><apply id="A1.SS2.p2.16.m1.1.1.cmml" xref="A1.SS2.p2.16.m1.1.1"><eq id="A1.SS2.p2.16.m1.1.1.1.cmml" xref="A1.SS2.p2.16.m1.1.1.1"></eq><apply id="A1.SS2.p2.16.m1.1.1.2.cmml" xref="A1.SS2.p2.16.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.16.m1.1.1.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.2.2">𝒘</ci><ci id="A1.SS2.p2.16.m1.1.1.2.3.cmml" xref="A1.SS2.p2.16.m1.1.1.2.3">𝑗</ci></apply><apply id="A1.SS2.p2.16.m1.1.1.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3"><divide id="A1.SS2.p2.16.m1.1.1.3.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3"></divide><apply id="A1.SS2.p2.16.m1.1.1.3.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.3.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2">subscript</csymbol><apply id="A1.SS2.p2.16.m1.1.1.3.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2.2"><ci id="A1.SS2.p2.16.m1.1.1.3.2.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2.2.1">^</ci><ci id="A1.SS2.p2.16.m1.1.1.3.2.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2.2.2">𝒘</ci></apply><ci id="A1.SS2.p2.16.m1.1.1.3.2.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.2.3">𝑗</ci></apply><apply id="A1.SS2.p2.16.m1.1.1.3.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3"><apply id="A1.SS2.p2.16.m1.1.1.3.3.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.3.3.1.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1">superscript</csymbol><apply id="A1.SS2.p2.16.m1.1.1.3.3.1.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.3.3.1.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1">subscript</csymbol><sum id="A1.SS2.p2.16.m1.1.1.3.3.1.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.2.2"></sum><cn type="integer" id="A1.SS2.p2.16.m1.1.1.3.3.1.2.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.2.3">1</cn></apply><apply id="A1.SS2.p2.16.m1.1.1.3.3.1.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.3.3.1.3.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3">subscript</csymbol><ci id="A1.SS2.p2.16.m1.1.1.3.3.1.3.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3.2">𝑏</ci><ci id="A1.SS2.p2.16.m1.1.1.3.3.1.3.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.1.3.3">𝑖</ci></apply></apply><apply id="A1.SS2.p2.16.m1.1.1.3.3.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.SS2.p2.16.m1.1.1.3.3.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2">subscript</csymbol><apply id="A1.SS2.p2.16.m1.1.1.3.3.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2"><ci id="A1.SS2.p2.16.m1.1.1.3.3.2.2.1.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2.1">^</ci><ci id="A1.SS2.p2.16.m1.1.1.3.3.2.2.2.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2.2.2">𝒘</ci></apply><ci id="A1.SS2.p2.16.m1.1.1.3.3.2.3.cmml" xref="A1.SS2.p2.16.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.16.m1.1c">\bm{w}_{j}=\frac{\hat{\bm{w}}_{j}}{\sum_{1}^{b_{i}}\hat{\bm{w}}_{j}}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para">
<p id="A1.SS2.p3.4" class="ltx_p">In the third step, <math id="A1.SS2.p3.1.m1.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">𝑭</mi><mi id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝑭</ci><ci id="A1.SS2.p3.1.m1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\bm{F}_{i}</annotation></semantics></math> is updated on <math id="A1.SS2.p3.2.m2.1" class="ltx_Math" alttext="\bm{B}" display="inline"><semantics id="A1.SS2.p3.2.m2.1a"><mi id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><ci id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">\bm{B}</annotation></semantics></math> and <math id="A1.SS2.p3.3.m3.1" class="ltx_Math" alttext="\hat{\bm{B}}" display="inline"><semantics id="A1.SS2.p3.3.m3.1a"><mover accent="true" id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml"><mi id="A1.SS2.p3.3.m3.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.cmml">𝑩</mi><mo id="A1.SS2.p3.3.m3.1.1.1" xref="A1.SS2.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1"><ci id="A1.SS2.p3.3.m3.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1">^</ci><ci id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2">𝑩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\hat{\bm{B}}</annotation></semantics></math> with sample weights <math id="A1.SS2.p3.4.m4.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="A1.SS2.p3.4.m4.1a"><mi id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><ci id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">\bm{w}</annotation></semantics></math>. The loss is computed as:</p>
<table id="A1.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E9.m1.3" class="ltx_Math" alttext="l_{\hat{\bm{B}}}^{\prime}=\sum_{j=1}^{b_{i}}\bm{w}_{j}\cdot l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})+l(\tilde{\bm{y}_{j}},\bm{y}_{j})," display="block"><semantics id="A1.E9.m1.3a"><mrow id="A1.E9.m1.3.3.1" xref="A1.E9.m1.3.3.1.1.cmml"><mrow id="A1.E9.m1.3.3.1.1" xref="A1.E9.m1.3.3.1.1.cmml"><msubsup id="A1.E9.m1.3.3.1.1.4" xref="A1.E9.m1.3.3.1.1.4.cmml"><mi id="A1.E9.m1.3.3.1.1.4.2.2" xref="A1.E9.m1.3.3.1.1.4.2.2.cmml">l</mi><mover accent="true" id="A1.E9.m1.3.3.1.1.4.2.3" xref="A1.E9.m1.3.3.1.1.4.2.3.cmml"><mi id="A1.E9.m1.3.3.1.1.4.2.3.2" xref="A1.E9.m1.3.3.1.1.4.2.3.2.cmml">𝑩</mi><mo id="A1.E9.m1.3.3.1.1.4.2.3.1" xref="A1.E9.m1.3.3.1.1.4.2.3.1.cmml">^</mo></mover><mo id="A1.E9.m1.3.3.1.1.4.3" xref="A1.E9.m1.3.3.1.1.4.3.cmml">′</mo></msubsup><mo rspace="0.111em" id="A1.E9.m1.3.3.1.1.3" xref="A1.E9.m1.3.3.1.1.3.cmml">=</mo><mrow id="A1.E9.m1.3.3.1.1.2" xref="A1.E9.m1.3.3.1.1.2.cmml"><mrow id="A1.E9.m1.3.3.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.cmml"><munderover id="A1.E9.m1.3.3.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="A1.E9.m1.3.3.1.1.1.1.2.2.2" xref="A1.E9.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E9.m1.3.3.1.1.1.1.2.2.3" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.2.2.3.2" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E9.m1.3.3.1.1.1.1.2.2.3.1" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E9.m1.3.3.1.1.1.1.2.2.3.3" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="A1.E9.m1.3.3.1.1.1.1.2.3" xref="A1.E9.m1.3.3.1.1.1.1.2.3.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.2.3.2" xref="A1.E9.m1.3.3.1.1.1.1.2.3.2.cmml">b</mi><mi id="A1.E9.m1.3.3.1.1.1.1.2.3.3" xref="A1.E9.m1.3.3.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="A1.E9.m1.3.3.1.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.1.cmml"><mrow id="A1.E9.m1.3.3.1.1.1.1.1.3" xref="A1.E9.m1.3.3.1.1.1.1.1.3.cmml"><msub id="A1.E9.m1.3.3.1.1.1.1.1.3.2" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.1.3.2.2" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2.2.cmml">𝒘</mi><mi id="A1.E9.m1.3.3.1.1.1.1.1.3.2.3" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E9.m1.3.3.1.1.1.1.1.3.1" xref="A1.E9.m1.3.3.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="A1.E9.m1.3.3.1.1.1.1.1.3.3" xref="A1.E9.m1.3.3.1.1.1.1.1.3.3.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="A1.E9.m1.3.3.1.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E9.m1.3.3.1.1.1.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mover accent="true" id="A1.E9.m1.1.1" xref="A1.E9.m1.1.1.cmml"><msub id="A1.E9.m1.1.1.2" xref="A1.E9.m1.1.1.2.cmml"><mi id="A1.E9.m1.1.1.2.2" xref="A1.E9.m1.1.1.2.2.cmml">𝒚</mi><mi id="A1.E9.m1.1.1.2.3" xref="A1.E9.m1.1.1.2.3.cmml">j</mi></msub><mo id="A1.E9.m1.1.1.1" xref="A1.E9.m1.1.1.1.cmml">~</mo></mover><mo id="A1.E9.m1.3.3.1.1.1.1.1.1.1.3" xref="A1.E9.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><msub id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.4" xref="A1.E9.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E9.m1.3.3.1.1.2.3" xref="A1.E9.m1.3.3.1.1.2.3.cmml">+</mo><mrow id="A1.E9.m1.3.3.1.1.2.2" xref="A1.E9.m1.3.3.1.1.2.2.cmml"><mi id="A1.E9.m1.3.3.1.1.2.2.3" xref="A1.E9.m1.3.3.1.1.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A1.E9.m1.3.3.1.1.2.2.2" xref="A1.E9.m1.3.3.1.1.2.2.2.cmml">​</mo><mrow id="A1.E9.m1.3.3.1.1.2.2.1.1" xref="A1.E9.m1.3.3.1.1.2.2.1.2.cmml"><mo stretchy="false" id="A1.E9.m1.3.3.1.1.2.2.1.1.2" xref="A1.E9.m1.3.3.1.1.2.2.1.2.cmml">(</mo><mover accent="true" id="A1.E9.m1.2.2" xref="A1.E9.m1.2.2.cmml"><msub id="A1.E9.m1.2.2.2" xref="A1.E9.m1.2.2.2.cmml"><mi id="A1.E9.m1.2.2.2.2" xref="A1.E9.m1.2.2.2.2.cmml">𝒚</mi><mi id="A1.E9.m1.2.2.2.3" xref="A1.E9.m1.2.2.2.3.cmml">j</mi></msub><mo id="A1.E9.m1.2.2.1" xref="A1.E9.m1.2.2.1.cmml">~</mo></mover><mo id="A1.E9.m1.3.3.1.1.2.2.1.1.3" xref="A1.E9.m1.3.3.1.1.2.2.1.2.cmml">,</mo><msub id="A1.E9.m1.3.3.1.1.2.2.1.1.1" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1.cmml"><mi id="A1.E9.m1.3.3.1.1.2.2.1.1.1.2" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1.2.cmml">𝒚</mi><mi id="A1.E9.m1.3.3.1.1.2.2.1.1.1.3" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A1.E9.m1.3.3.1.1.2.2.1.1.4" xref="A1.E9.m1.3.3.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E9.m1.3.3.1.2" xref="A1.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.3b"><apply id="A1.E9.m1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1"><eq id="A1.E9.m1.3.3.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.3"></eq><apply id="A1.E9.m1.3.3.1.1.4.cmml" xref="A1.E9.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.4.1.cmml" xref="A1.E9.m1.3.3.1.1.4">superscript</csymbol><apply id="A1.E9.m1.3.3.1.1.4.2.cmml" xref="A1.E9.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.4.2.1.cmml" xref="A1.E9.m1.3.3.1.1.4">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.4.2.2.cmml" xref="A1.E9.m1.3.3.1.1.4.2.2">𝑙</ci><apply id="A1.E9.m1.3.3.1.1.4.2.3.cmml" xref="A1.E9.m1.3.3.1.1.4.2.3"><ci id="A1.E9.m1.3.3.1.1.4.2.3.1.cmml" xref="A1.E9.m1.3.3.1.1.4.2.3.1">^</ci><ci id="A1.E9.m1.3.3.1.1.4.2.3.2.cmml" xref="A1.E9.m1.3.3.1.1.4.2.3.2">𝑩</ci></apply></apply><ci id="A1.E9.m1.3.3.1.1.4.3.cmml" xref="A1.E9.m1.3.3.1.1.4.3">′</ci></apply><apply id="A1.E9.m1.3.3.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.2"><plus id="A1.E9.m1.3.3.1.1.2.3.cmml" xref="A1.E9.m1.3.3.1.1.2.3"></plus><apply id="A1.E9.m1.3.3.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1"><apply id="A1.E9.m1.3.3.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="A1.E9.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.2.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="A1.E9.m1.3.3.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="A1.E9.m1.3.3.1.1.1.1.2.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3"><eq id="A1.E9.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="A1.E9.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="A1.E9.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E9.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.1.1.2.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.3.2">𝑏</ci><ci id="A1.E9.m1.3.3.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A1.E9.m1.3.3.1.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1"><times id="A1.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.2"></times><apply id="A1.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3"><ci id="A1.E9.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.1">⋅</ci><apply id="A1.E9.m1.3.3.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2.2">𝒘</ci><ci id="A1.E9.m1.3.3.1.1.1.1.1.3.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="A1.E9.m1.3.3.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.3.3">𝑙</ci></apply><interval closure="open" id="A1.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1"><apply id="A1.E9.m1.1.1.cmml" xref="A1.E9.m1.1.1"><ci id="A1.E9.m1.1.1.1.cmml" xref="A1.E9.m1.1.1.1">~</ci><apply id="A1.E9.m1.1.1.2.cmml" xref="A1.E9.m1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.2.1.cmml" xref="A1.E9.m1.1.1.2">subscript</csymbol><ci id="A1.E9.m1.1.1.2.2.cmml" xref="A1.E9.m1.1.1.2.2">𝒚</ci><ci id="A1.E9.m1.1.1.2.3.cmml" xref="A1.E9.m1.1.1.2.3">𝑗</ci></apply></apply><apply id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2"><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></interval></apply></apply><apply id="A1.E9.m1.3.3.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2"><times id="A1.E9.m1.3.3.1.1.2.2.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2.2"></times><ci id="A1.E9.m1.3.3.1.1.2.2.3.cmml" xref="A1.E9.m1.3.3.1.1.2.2.3">𝑙</ci><interval closure="open" id="A1.E9.m1.3.3.1.1.2.2.1.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2.1.1"><apply id="A1.E9.m1.2.2.cmml" xref="A1.E9.m1.2.2"><ci id="A1.E9.m1.2.2.1.cmml" xref="A1.E9.m1.2.2.1">~</ci><apply id="A1.E9.m1.2.2.2.cmml" xref="A1.E9.m1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.2.2.2.1.cmml" xref="A1.E9.m1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.2.2.2.2.cmml" xref="A1.E9.m1.2.2.2.2">𝒚</ci><ci id="A1.E9.m1.2.2.2.3.cmml" xref="A1.E9.m1.2.2.2.3">𝑗</ci></apply></apply><apply id="A1.E9.m1.3.3.1.1.2.2.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1.2">𝒚</ci><ci id="A1.E9.m1.3.3.1.1.2.2.1.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.2.2.1.1.1.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.3c">l_{\hat{\bm{B}}}^{\prime}=\sum_{j=1}^{b_{i}}\bm{w}_{j}\cdot l(\tilde{\bm{y}_{j}},\hat{\bm{y}}_{j})+l(\tilde{\bm{y}_{j}},\bm{y}_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p3.6" class="ltx_p">where <math id="A1.SS2.p3.5.m1.1" class="ltx_Math" alttext="\tilde{\bm{y}}_{j}" display="inline"><semantics id="A1.SS2.p3.5.m1.1a"><msub id="A1.SS2.p3.5.m1.1.1" xref="A1.SS2.p3.5.m1.1.1.cmml"><mover accent="true" id="A1.SS2.p3.5.m1.1.1.2" xref="A1.SS2.p3.5.m1.1.1.2.cmml"><mi id="A1.SS2.p3.5.m1.1.1.2.2" xref="A1.SS2.p3.5.m1.1.1.2.2.cmml">𝒚</mi><mo id="A1.SS2.p3.5.m1.1.1.2.1" xref="A1.SS2.p3.5.m1.1.1.2.1.cmml">~</mo></mover><mi id="A1.SS2.p3.5.m1.1.1.3" xref="A1.SS2.p3.5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m1.1b"><apply id="A1.SS2.p3.5.m1.1.1.cmml" xref="A1.SS2.p3.5.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m1.1.1.1.cmml" xref="A1.SS2.p3.5.m1.1.1">subscript</csymbol><apply id="A1.SS2.p3.5.m1.1.1.2.cmml" xref="A1.SS2.p3.5.m1.1.1.2"><ci id="A1.SS2.p3.5.m1.1.1.2.1.cmml" xref="A1.SS2.p3.5.m1.1.1.2.1">~</ci><ci id="A1.SS2.p3.5.m1.1.1.2.2.cmml" xref="A1.SS2.p3.5.m1.1.1.2.2">𝒚</ci></apply><ci id="A1.SS2.p3.5.m1.1.1.3.cmml" xref="A1.SS2.p3.5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m1.1c">\tilde{\bm{y}}_{j}</annotation></semantics></math> is the prediction of <math id="A1.SS2.p3.6.m2.1" class="ltx_Math" alttext="\bm{F}_{i}" display="inline"><semantics id="A1.SS2.p3.6.m2.1a"><msub id="A1.SS2.p3.6.m2.1.1" xref="A1.SS2.p3.6.m2.1.1.cmml"><mi id="A1.SS2.p3.6.m2.1.1.2" xref="A1.SS2.p3.6.m2.1.1.2.cmml">𝑭</mi><mi id="A1.SS2.p3.6.m2.1.1.3" xref="A1.SS2.p3.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m2.1b"><apply id="A1.SS2.p3.6.m2.1.1.cmml" xref="A1.SS2.p3.6.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.6.m2.1.1.1.cmml" xref="A1.SS2.p3.6.m2.1.1">subscript</csymbol><ci id="A1.SS2.p3.6.m2.1.1.2.cmml" xref="A1.SS2.p3.6.m2.1.1.2">𝑭</ci><ci id="A1.SS2.p3.6.m2.1.1.3.cmml" xref="A1.SS2.p3.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m2.1c">\bm{F}_{i}</annotation></semantics></math>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.08353" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.08354" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.08354">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.08354" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.08355" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 10:59:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
