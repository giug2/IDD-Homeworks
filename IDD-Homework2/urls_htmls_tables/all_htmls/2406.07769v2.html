<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation</title>
<!--Generated on Thu Jun 13 17:18:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.07769v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S1" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S2" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS1" title="In 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>3D Data Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS2" title="In 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Spatial Clustering</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS2.SSS1" title="In 3.2. Spatial Clustering ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Step 1: SpAGMM Estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS2.SSS2" title="In 3.2. Spatial Clustering ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Step 2: K-means</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS3" title="In 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Value estimation: Robust Bayesian Payoffs (RBP)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS4" title="In 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Candidate Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.SS5" title="In 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Heuristic Search</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS1" title="In 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Offline Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS2" title="In 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Online Experimental Phase</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS2.SSS1" title="In 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Experimental Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS2.SSS2" title="In 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS2.SSS2.Px1" title="In 4.2.2. Results ‣ 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title">Field Experiment #1</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS2.SSS2.Px2" title="In 4.2.2. Results ‣ 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title">Field Experiment #2</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS3" title="In 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Deployment Phase</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S5" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S6" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS1" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Table of Notation Used</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS2" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>SpAGMM Estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS3" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span><span class="ltx_text">EdgeRec3D</span> parameter settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS4" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4 </span>Complexity Analysis of <span class="ltx_text">EdgeRec3D</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS4.SSS1" title="In 7.4. Complexity Analysis of EdgeRec3D ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4.1 </span>Complexity of Candidate Generator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS4.SSS2" title="In 7.4. Complexity Analysis of EdgeRec3D ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4.2 </span>Complexity of Heuristic Search</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS5" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.5 </span>Wall-clock time of <span class="ltx_text">EdgeRec3D</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS6" title="In 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.6 </span>Training of Visual Layer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8" title="In Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Additional Experiments and Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS1" title="In 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.1 </span>Details of Offline Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS1.SSS1" title="In 8.1. Details of Offline Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.1.1 </span>Dataset Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS1.SSS2" title="In 8.1. Details of Offline Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.1.2 </span>Benchmarks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS2" title="In 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.2 </span>Details of Online Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS2.SSS1" title="In 8.2. Details of Online Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.2.1 </span>Users</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS2.SSS2" title="In 8.2. Details of Online Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.2.2 </span>User Workflow</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS3" title="In 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.3 </span>RBP Toy Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS4" title="In 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.4 </span>Selecting the Number of Clusters</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS4.SSS1" title="In 8.4. Selecting the Number of Clusters ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.4.1 </span>Visualization of Clusters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.SS5" title="In 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8.5 </span>Product Case Study</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Porter Jenkins*, Michael Selander<sup class="ltx_sup" id="id6.6.id1"><span class="ltx_text ltx_font_italic" id="id6.6.id1.1">†</span></sup>, J. Stockton Jenkins<sup class="ltx_sup" id="id7.7.id2"><span class="ltx_text ltx_font_italic" id="id7.7.id2.1">†</span></sup>, Andrew Merrill<sup class="ltx_sup" id="id8.8.id3"><span class="ltx_text ltx_font_italic" id="id8.8.id3.1">†</span></sup>, Kyle Armstrong<sup class="ltx_sup" id="id9.9.id4"><span class="ltx_text ltx_font_italic" id="id9.9.id4.1">†</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.5.1">Brigham Young University*, Delicious AI<sup class="ltx_sup" id="id5.5.1.1"><span class="ltx_text ltx_font_italic" id="id5.5.1.1.1">†</span></sup></span><span class="ltx_text ltx_affiliation_country" id="id10.10.id1">United States</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:pjenkins@cs.byu.edu*">pjenkins@cs.byu.edu*</a>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:michael.selander,%20stockton.jenkins,%20andrew.merrill,%20kyle.armstrong@deliciousai.com">michael.selander, stockton.jenkins, andrew.merrill, kyle.armstrong@deliciousai.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id11.id1">Product assortment selection is a critical challenge facing physical retailers. Effectively aligning inventory with the preferences of shoppers can increase sales and decrease out-of-stocks. However, in real-world settings the problem is challenging due to the combinatorial explosion of product assortment possibilities. Consumer preferences are typically heterogeneous across space and time, making inventory-preference alignment challenging. Additionally, existing strategies rely on syndicated data, which tends to be aggregated, low resolution, and suffer from high latency. To solve these challenges, we introduce a real-time recommendation system, which we call <span class="ltx_text" id="id11.id1.1">EdgeRec3D</span>. Our system utilizes recent advances in 3D computer vision for perception and automatic, fine grained sales estimation. These perceptual components run on the edge of the network and facilitate real-time reward signals. Additionally, we develop a Bayesian payoff model to account for noisy estimates from 3D LIDAR data. We rely on spatial clustering to allow the system to adapt to heterogeneous consumer preferences, and a graph-based candidate generation algorithm to address the combinatorial search problem. We test our system in real-world stores across two, 6-8 week A/B tests with beverage products and demonstrate a 35% and 27% increase in sales respectively. Finally, we monitor the deployed system for a period of 28 weeks with an observational study and show a 9.4% increase in sales.</p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining; August 25–29, 2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3637528.3671518</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0490-1/24/08</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The problem of effectively allocating shelf space is one of the most critical decisions facing physical retailers <cite class="ltx_cite ltx_citemacro_citep">(Yang and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib50" title="">1999</a>)</cite>. Optimal placement of physical product increases sales and decreases excess inventory. Prior work has shown that good product allocation can call the consumer’s attention and encourage “impulse” purchases <cite class="ltx_cite ltx_citemacro_citep">(Hwang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib25" title="">2005</a>; Mattila and Wirtz, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib36" title="">2008</a>; Badgaiyan and Verma, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib6" title="">2015</a>)</cite>. In most real-world scenarios, the number of available products far exceeds the amount of available shelf space. Additionally, the retailer must consider varying attributes of products such as price, shape, and dynamic consumer preferences. As such, the product assortment problem is a combinatorial decision problem.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A variety of previous work seeks to solve the shelf space allocation problem. Classical optimization methods such as integer <cite class="ltx_cite ltx_citemacro_citep">(Yang and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib50" title="">1999</a>; Geismar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib22" title="">2015</a>)</cite> linear, and dynamic <cite class="ltx_cite ltx_citemacro_citep">(Zufryden, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib53" title="">1986</a>)</cite> programming, genetic algorithms <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib52" title="">2023</a>; Castelli and Vanneschi, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib12" title="">2014</a>; Urban, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib48" title="">1998</a>)</cite> and simulated annealing approaches <cite class="ltx_cite ltx_citemacro_citep">(Borin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib10" title="">1994</a>)</cite> have been extensively studied. More recently, the Data Mining field has sought to replace the formal space elasticity optimization problem with association rule mining <cite class="ltx_cite ltx_citemacro_citep">(Tatiana and Mikhail, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib47" title="">2018</a>; Pandit et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib39" title="">2010</a>; Chen and Lin, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib16" title="">2007</a>; Brijs et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib11" title="">1999</a>)</cite>, and collaborative filtering <cite class="ltx_cite ltx_citemacro_citep">(Park and Nam, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib40" title="">2019</a>)</cite> as they can better leverage large-scale databases to generate effective product sets. In practice, these methods typically rely on syndicated data <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Syndicated data refers to retail sales data that is aggregated across many stores and sold by third parties</span></span></span> as input. These datasets tend to be aggregated, of low resolution, and can take weeks or months to assemble. In contrast, this work offers a solution to produce similar data instantly, in the hand of the person who needs it. A real-time approach to the problem is critical because it closes the feedback loop and facilitates faster discovery and convergence to shopper preferences.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="417" id="S1.F1.sf1.g1" src="extracted/5665233/figs/example-fig-plano.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S1.F1.sf1.3.2" style="font-size:90%;">Display states: before and after recommendation</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="664" id="S1.F1.sf2.g1" src="extracted/5665233/figs/swap-1.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:90%;">Recommended Change #1</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="664" id="S1.F1.sf3.g1" src="extracted/5665233/figs/swap-2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S1.F1.sf3.3.2" style="font-size:90%;">Recommended Change #2</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The product assortment problem can be described as choosing the set of products, and corresponding quantities, that will maximize expected payoff, subject to the total number of discrete locations (slots) within the product display. Our system maximizes expected payoff, while accounting for uncertainty. </span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The problem of real-time product assortment recommendation has four core challenges. First, obtaining sales estimates in real-time is not possible under current methodologies. Second, the problem is a special case of the knapsack problem <cite class="ltx_cite ltx_citemacro_citep">(Dudziński and Walukiewicz, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib20" title="">1987</a>; Yang and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib50" title="">1999</a>)</cite>, a well-known combinatorial optimization problem, and is therefore NP-complete. The number of possible combinations grows factorially, and follows the equation:</p>
</div>
<div class="ltx_para" id="S1.p4">
<table class="ltx_equation ltx_eqn_table" id="S1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="c=\binom{p+m-1}{m}=\frac{(p+m-1)!}{m!(p-1)!}" class="ltx_Math" display="block" id="S1.E1.m1.4"><semantics id="S1.E1.m1.4a"><mrow id="S1.E1.m1.4.5" xref="S1.E1.m1.4.5.cmml"><mi id="S1.E1.m1.4.5.2" xref="S1.E1.m1.4.5.2.cmml">c</mi><mo id="S1.E1.m1.4.5.3" xref="S1.E1.m1.4.5.3.cmml">=</mo><mrow id="S1.E1.m1.2.2.4" xref="S1.E1.m1.2.2.3.cmml"><mo id="S1.E1.m1.2.2.4.1" xref="S1.E1.m1.2.2.3.1.cmml">(</mo><mfrac id="S1.E1.m1.2.2.2.2" linethickness="0pt" xref="S1.E1.m1.2.2.3.cmml"><mrow id="S1.E1.m1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S1.E1.m1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1.3.2" xref="S1.E1.m1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="S1.E1.m1.1.1.1.1.1.1.3.1" xref="S1.E1.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S1.E1.m1.1.1.1.1.1.1.3.3" xref="S1.E1.m1.1.1.1.1.1.1.3.3.cmml">m</mi></mrow><mo id="S1.E1.m1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S1.E1.m1.1.1.1.1.1.1.4" xref="S1.E1.m1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mi id="S1.E1.m1.2.2.2.2.2.1" xref="S1.E1.m1.2.2.2.2.2.1.cmml">m</mi></mfrac><mo id="S1.E1.m1.2.2.4.2" xref="S1.E1.m1.2.2.3.1.cmml">)</mo></mrow><mo id="S1.E1.m1.4.5.4" xref="S1.E1.m1.4.5.4.cmml">=</mo><mfrac id="S1.E1.m1.4.4" xref="S1.E1.m1.4.4.cmml"><mrow id="S1.E1.m1.3.3.1" xref="S1.E1.m1.3.3.1.cmml"><mrow id="S1.E1.m1.3.3.1.1.1" xref="S1.E1.m1.3.3.1.1.1.1.cmml"><mo id="S1.E1.m1.3.3.1.1.1.2" stretchy="false" xref="S1.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S1.E1.m1.3.3.1.1.1.1" xref="S1.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S1.E1.m1.3.3.1.1.1.1.2" xref="S1.E1.m1.3.3.1.1.1.1.2.cmml"><mi id="S1.E1.m1.3.3.1.1.1.1.2.2" xref="S1.E1.m1.3.3.1.1.1.1.2.2.cmml">p</mi><mo id="S1.E1.m1.3.3.1.1.1.1.2.1" xref="S1.E1.m1.3.3.1.1.1.1.2.1.cmml">+</mo><mi id="S1.E1.m1.3.3.1.1.1.1.2.3" xref="S1.E1.m1.3.3.1.1.1.1.2.3.cmml">m</mi></mrow><mo id="S1.E1.m1.3.3.1.1.1.1.1" xref="S1.E1.m1.3.3.1.1.1.1.1.cmml">−</mo><mn id="S1.E1.m1.3.3.1.1.1.1.3" xref="S1.E1.m1.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S1.E1.m1.3.3.1.1.1.3" stretchy="false" xref="S1.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S1.E1.m1.3.3.1.2" xref="S1.E1.m1.3.3.1.2.cmml">!</mo></mrow><mrow id="S1.E1.m1.4.4.2" xref="S1.E1.m1.4.4.2.cmml"><mrow id="S1.E1.m1.4.4.2.3" xref="S1.E1.m1.4.4.2.3.cmml"><mi id="S1.E1.m1.4.4.2.3.2" xref="S1.E1.m1.4.4.2.3.2.cmml">m</mi><mo id="S1.E1.m1.4.4.2.3.1" xref="S1.E1.m1.4.4.2.3.1.cmml">!</mo></mrow><mo id="S1.E1.m1.4.4.2.2" xref="S1.E1.m1.4.4.2.2.cmml">⁢</mo><mrow id="S1.E1.m1.4.4.2.1" xref="S1.E1.m1.4.4.2.1.cmml"><mrow id="S1.E1.m1.4.4.2.1.1.1" xref="S1.E1.m1.4.4.2.1.1.1.1.cmml"><mo id="S1.E1.m1.4.4.2.1.1.1.2" stretchy="false" xref="S1.E1.m1.4.4.2.1.1.1.1.cmml">(</mo><mrow id="S1.E1.m1.4.4.2.1.1.1.1" xref="S1.E1.m1.4.4.2.1.1.1.1.cmml"><mi id="S1.E1.m1.4.4.2.1.1.1.1.2" xref="S1.E1.m1.4.4.2.1.1.1.1.2.cmml">p</mi><mo id="S1.E1.m1.4.4.2.1.1.1.1.1" xref="S1.E1.m1.4.4.2.1.1.1.1.1.cmml">−</mo><mn id="S1.E1.m1.4.4.2.1.1.1.1.3" xref="S1.E1.m1.4.4.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S1.E1.m1.4.4.2.1.1.1.3" stretchy="false" xref="S1.E1.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow><mo id="S1.E1.m1.4.4.2.1.2" xref="S1.E1.m1.4.4.2.1.2.cmml">!</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.4b"><apply id="S1.E1.m1.4.5.cmml" xref="S1.E1.m1.4.5"><and id="S1.E1.m1.4.5a.cmml" xref="S1.E1.m1.4.5"></and><apply id="S1.E1.m1.4.5b.cmml" xref="S1.E1.m1.4.5"><eq id="S1.E1.m1.4.5.3.cmml" xref="S1.E1.m1.4.5.3"></eq><ci id="S1.E1.m1.4.5.2.cmml" xref="S1.E1.m1.4.5.2">𝑐</ci><apply id="S1.E1.m1.2.2.3.cmml" xref="S1.E1.m1.2.2.4"><csymbol cd="latexml" id="S1.E1.m1.2.2.3.1.cmml" xref="S1.E1.m1.2.2.4.1">binomial</csymbol><apply id="S1.E1.m1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1"><minus id="S1.E1.m1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.2"></minus><apply id="S1.E1.m1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3"><plus id="S1.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3.1"></plus><ci id="S1.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S1.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3.3">𝑚</ci></apply><cn id="S1.E1.m1.1.1.1.1.1.1.4.cmml" type="integer" xref="S1.E1.m1.1.1.1.1.1.1.4">1</cn></apply><ci id="S1.E1.m1.2.2.2.2.2.1.cmml" xref="S1.E1.m1.2.2.2.2.2.1">𝑚</ci></apply></apply><apply id="S1.E1.m1.4.5c.cmml" xref="S1.E1.m1.4.5"><eq id="S1.E1.m1.4.5.4.cmml" xref="S1.E1.m1.4.5.4"></eq><share href="https://arxiv.org/html/2406.07769v2#S1.E1.m1.2.2.cmml" id="S1.E1.m1.4.5d.cmml" xref="S1.E1.m1.4.5"></share><apply id="S1.E1.m1.4.4.cmml" xref="S1.E1.m1.4.4"><divide id="S1.E1.m1.4.4.3.cmml" xref="S1.E1.m1.4.4"></divide><apply id="S1.E1.m1.3.3.1.cmml" xref="S1.E1.m1.3.3.1"><factorial id="S1.E1.m1.3.3.1.2.cmml" xref="S1.E1.m1.3.3.1.2"></factorial><apply id="S1.E1.m1.3.3.1.1.1.1.cmml" xref="S1.E1.m1.3.3.1.1.1"><minus id="S1.E1.m1.3.3.1.1.1.1.1.cmml" xref="S1.E1.m1.3.3.1.1.1.1.1"></minus><apply id="S1.E1.m1.3.3.1.1.1.1.2.cmml" xref="S1.E1.m1.3.3.1.1.1.1.2"><plus id="S1.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S1.E1.m1.3.3.1.1.1.1.2.1"></plus><ci id="S1.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S1.E1.m1.3.3.1.1.1.1.2.2">𝑝</ci><ci id="S1.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S1.E1.m1.3.3.1.1.1.1.2.3">𝑚</ci></apply><cn id="S1.E1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S1.E1.m1.3.3.1.1.1.1.3">1</cn></apply></apply><apply id="S1.E1.m1.4.4.2.cmml" xref="S1.E1.m1.4.4.2"><times id="S1.E1.m1.4.4.2.2.cmml" xref="S1.E1.m1.4.4.2.2"></times><apply id="S1.E1.m1.4.4.2.3.cmml" xref="S1.E1.m1.4.4.2.3"><factorial id="S1.E1.m1.4.4.2.3.1.cmml" xref="S1.E1.m1.4.4.2.3.1"></factorial><ci id="S1.E1.m1.4.4.2.3.2.cmml" xref="S1.E1.m1.4.4.2.3.2">𝑚</ci></apply><apply id="S1.E1.m1.4.4.2.1.cmml" xref="S1.E1.m1.4.4.2.1"><factorial id="S1.E1.m1.4.4.2.1.2.cmml" xref="S1.E1.m1.4.4.2.1.2"></factorial><apply id="S1.E1.m1.4.4.2.1.1.1.1.cmml" xref="S1.E1.m1.4.4.2.1.1.1"><minus id="S1.E1.m1.4.4.2.1.1.1.1.1.cmml" xref="S1.E1.m1.4.4.2.1.1.1.1.1"></minus><ci id="S1.E1.m1.4.4.2.1.1.1.1.2.cmml" xref="S1.E1.m1.4.4.2.1.1.1.1.2">𝑝</ci><cn id="S1.E1.m1.4.4.2.1.1.1.1.3.cmml" type="integer" xref="S1.E1.m1.4.4.2.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.4c">c=\binom{p+m-1}{m}=\frac{(p+m-1)!}{m!(p-1)!}</annotation><annotation encoding="application/x-llamapun" id="S1.E1.m1.4d">italic_c = ( FRACOP start_ARG italic_p + italic_m - 1 end_ARG start_ARG italic_m end_ARG ) = divide start_ARG ( italic_p + italic_m - 1 ) ! end_ARG start_ARG italic_m ! ( italic_p - 1 ) ! end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.3">for <math alttext="p" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_p</annotation></semantics></math> products and <math alttext="m" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">italic_m</annotation></semantics></math> discrete product locations, or slots. Even in somewhat small sub-problems comprised of a shelf with 20 slots and 100 products the number of possible combinations is <math alttext="2.5\times 10^{22}" class="ltx_Math" display="inline" id="S1.p5.3.m3.1"><semantics id="S1.p5.3.m3.1a"><mrow id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml"><mn id="S1.p5.3.m3.1.1.2" xref="S1.p5.3.m3.1.1.2.cmml">2.5</mn><mo id="S1.p5.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p5.3.m3.1.1.1.cmml">×</mo><msup id="S1.p5.3.m3.1.1.3" xref="S1.p5.3.m3.1.1.3.cmml"><mn id="S1.p5.3.m3.1.1.3.2" xref="S1.p5.3.m3.1.1.3.2.cmml">10</mn><mn id="S1.p5.3.m3.1.1.3.3" xref="S1.p5.3.m3.1.1.3.3.cmml">22</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><apply id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1"><times id="S1.p5.3.m3.1.1.1.cmml" xref="S1.p5.3.m3.1.1.1"></times><cn id="S1.p5.3.m3.1.1.2.cmml" type="float" xref="S1.p5.3.m3.1.1.2">2.5</cn><apply id="S1.p5.3.m3.1.1.3.cmml" xref="S1.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S1.p5.3.m3.1.1.3.1.cmml" xref="S1.p5.3.m3.1.1.3">superscript</csymbol><cn id="S1.p5.3.m3.1.1.3.2.cmml" type="integer" xref="S1.p5.3.m3.1.1.3.2">10</cn><cn id="S1.p5.3.m3.1.1.3.3.cmml" type="integer" xref="S1.p5.3.m3.1.1.3.3">22</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">2.5\times 10^{22}</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.m3.1d">2.5 × 10 start_POSTSUPERSCRIPT 22 end_POSTSUPERSCRIPT</annotation></semantics></math>. Second, most retail outlets are dynamical systems. The set of products on display frequently changes to account for out-of-stocks or supply chain constraints. Third, preferences are heterogeneous across both time and space <cite class="ltx_cite ltx_citemacro_citep">(Allenby and Rossi, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib2" title="">1998</a>; Rossi and Allenby, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib43" title="">2003</a>; Andersen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib3" title="">2010</a>; Jedidi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib26" title="">1997</a>)</cite>. Limited time products are periodically introduced into the market to satisfy seasonal demand. Additionally, product space allocation should be targeted to meet preferences that vary with respect to demographics. For example, a store near a college campus might sell more energy drinks than a store with an older population of customers. Classical methods are unable to account for these issues.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To solve these challenges, we design a large-scale recommender system, which we call <span class="ltx_text" id="S1.p6.1.1">EdgeRec3D</span>. The system guides retail workers and recommends the appropriate product set to put on display. A key differentiator of our system is that we use on-edge, 3D computer vision models <cite class="ltx_cite ltx_citemacro_citep">(Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib27" title="">2023</a>)</cite> for real-time perception and automatic sales estimation. This real-time perceptual layer is implemented at the edge of the network, making it easy to implement the recommended set quickly, and closes the feedback loop under changing market dynamics. A major trade-off under this design is the introduction of noise into estimates of sales. To quantify our uncertainty of product sales due to this observation noise, we propose a Robust Bayesian Payoff (RBP) reward model that learns the posterior distribution of product payoff <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>In this paper, we use the terms <span class="ltx_text ltx_font_italic" id="footnote2.1">payoff</span> and <span class="ltx_text ltx_font_italic" id="footnote2.2">reward</span> interchangeably</span></span></span>. We address the combinatorial search problem with intelligent candidate generation, along with a simple heuristic search based on an uncertainty penalized ranking statistic, which discounts uncertain recommendations. A novel spatial clustering technique along with the hierarchical parameterization of RBP allow for targeted recommendations and help solve the preference heterogeneity problem.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We validate our recommender system by running both offline and online experiments. Offline, <span class="ltx_text" id="S1.p7.1.1">EdgeRec3D</span> outperforms classic methods such as Linear Programming, Dynamic Programming, <math alttext="\epsilon" class="ltx_Math" display="inline" id="S1.p7.1.m1.1"><semantics id="S1.p7.1.m1.1a"><mi id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><ci id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S1.p7.1.m1.1d">italic_ϵ</annotation></semantics></math>-greedy, Genetic algorithms and modern techniques such as deep ensembles and model-based offline RL. Moreover, we perform two real-world A/B tests, each lasting 6-8 weeks. In these two controlled experiments, we demonstrate a 35% and 27% increase in product-level sales, respectively. Finally, a 28 week deployment study results in a 9.4% increase in product-level sales. Our key contributions can be summarized by the following:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose <span class="ltx_text" id="S1.I1.i1.p1.1.1">EdgeRec3D</span>, a real-time, 3D computer vision recommender system to solve the shelf space allocation problem. The system implements 3D visual perception models embedded in mobile devices to observe product display states and reward (sales) in real-time.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text" id="S1.I1.i2.p1.1.1">EdgeRec3D</span> uses a novel Robust Bayesian Payoff (RBP) model to estimate action payoffs, and quantify uncertainty under observation noise. This uncertainty quantification informs a heuristic search algorithm to help solve combinatorial explosion. Additionally, we devise a novel spatial clustering method, called SpAGMM, to produce store-level demographic profiles and solve the preference heterogeneity problem.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">We believe this work will broadly be interesting to those working in real-world recommender systems, brick and mortar commerce, and data-driven marketing.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminaries</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The product assortment problem is a special case of the knapsack problem <cite class="ltx_cite ltx_citemacro_citep">(Yang and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib50" title="">1999</a>)</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S2.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Definition 0 (Product Assortment Problem).</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p1">
<p class="ltx_p" id="S2.Thmtheorem1.p1.13"><span class="ltx_text ltx_font_italic" id="S2.Thmtheorem1.p1.13.13">We consider the problem of choosing from a set of <math alttext="i=1,...,N" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.1.1.m1.3"><semantics id="S2.Thmtheorem1.p1.1.1.m1.3a"><mrow id="S2.Thmtheorem1.p1.1.1.m1.3.4" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.cmml"><mi id="S2.Thmtheorem1.p1.1.1.m1.3.4.2" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.2.cmml">i</mi><mo id="S2.Thmtheorem1.p1.1.1.m1.3.4.1" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.1.cmml">=</mo><mrow id="S2.Thmtheorem1.p1.1.1.m1.3.4.3.2" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.3.1.cmml"><mn id="S2.Thmtheorem1.p1.1.1.m1.1.1" xref="S2.Thmtheorem1.p1.1.1.m1.1.1.cmml">1</mn><mo id="S2.Thmtheorem1.p1.1.1.m1.3.4.3.2.1" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.3.1.cmml">,</mo><mi id="S2.Thmtheorem1.p1.1.1.m1.2.2" mathvariant="normal" xref="S2.Thmtheorem1.p1.1.1.m1.2.2.cmml">…</mi><mo id="S2.Thmtheorem1.p1.1.1.m1.3.4.3.2.2" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.3.1.cmml">,</mo><mi id="S2.Thmtheorem1.p1.1.1.m1.3.3" xref="S2.Thmtheorem1.p1.1.1.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.1.1.m1.3b"><apply id="S2.Thmtheorem1.p1.1.1.m1.3.4.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.3.4"><eq id="S2.Thmtheorem1.p1.1.1.m1.3.4.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.1"></eq><ci id="S2.Thmtheorem1.p1.1.1.m1.3.4.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.2">𝑖</ci><list id="S2.Thmtheorem1.p1.1.1.m1.3.4.3.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.3.4.3.2"><cn id="S2.Thmtheorem1.p1.1.1.m1.1.1.cmml" type="integer" xref="S2.Thmtheorem1.p1.1.1.m1.1.1">1</cn><ci id="S2.Thmtheorem1.p1.1.1.m1.2.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.2">…</ci><ci id="S2.Thmtheorem1.p1.1.1.m1.3.3.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.1.1.m1.3c">i=1,...,N</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.1.1.m1.3d">italic_i = 1 , … , italic_N</annotation></semantics></math> products with quantities, <math alttext="q_{i}\in\{0,1,2,...\}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.2.2.m2.4"><semantics id="S2.Thmtheorem1.p1.2.2.m2.4a"><mrow id="S2.Thmtheorem1.p1.2.2.m2.4.5" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.cmml"><msub id="S2.Thmtheorem1.p1.2.2.m2.4.5.2" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2.cmml"><mi id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.2" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2.2.cmml">q</mi><mi id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.3" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2.3.cmml">i</mi></msub><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.1" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.1.cmml">∈</mo><mrow id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml"><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2.1" stretchy="false" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml">{</mo><mn id="S2.Thmtheorem1.p1.2.2.m2.1.1" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.cmml">0</mn><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2.2" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml">,</mo><mn id="S2.Thmtheorem1.p1.2.2.m2.2.2" xref="S2.Thmtheorem1.p1.2.2.m2.2.2.cmml">1</mn><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2.3" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml">,</mo><mn id="S2.Thmtheorem1.p1.2.2.m2.3.3" xref="S2.Thmtheorem1.p1.2.2.m2.3.3.cmml">2</mn><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2.4" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml">,</mo><mi id="S2.Thmtheorem1.p1.2.2.m2.4.4" mathvariant="normal" xref="S2.Thmtheorem1.p1.2.2.m2.4.4.cmml">…</mi><mo id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2.5" stretchy="false" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.2.2.m2.4b"><apply id="S2.Thmtheorem1.p1.2.2.m2.4.5.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5"><in id="S2.Thmtheorem1.p1.2.2.m2.4.5.1.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.1"></in><apply id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.1.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2">subscript</csymbol><ci id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.2.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2.2">𝑞</ci><ci id="S2.Thmtheorem1.p1.2.2.m2.4.5.2.3.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.2.3">𝑖</ci></apply><set id="S2.Thmtheorem1.p1.2.2.m2.4.5.3.1.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.5.3.2"><cn id="S2.Thmtheorem1.p1.2.2.m2.1.1.cmml" type="integer" xref="S2.Thmtheorem1.p1.2.2.m2.1.1">0</cn><cn id="S2.Thmtheorem1.p1.2.2.m2.2.2.cmml" type="integer" xref="S2.Thmtheorem1.p1.2.2.m2.2.2">1</cn><cn id="S2.Thmtheorem1.p1.2.2.m2.3.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.2.2.m2.3.3">2</cn><ci id="S2.Thmtheorem1.p1.2.2.m2.4.4.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.4.4">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.2.2.m2.4c">q_{i}\in\{0,1,2,...\}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.2.2.m2.4d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 0 , 1 , 2 , … }</annotation></semantics></math>. The quantity, <math alttext="q_{i}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.3.3.m3.1"><semantics id="S2.Thmtheorem1.p1.3.3.m3.1a"><msub id="S2.Thmtheorem1.p1.3.3.m3.1.1" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">q</mi><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.3.3.m3.1b"><apply id="S2.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.2">𝑞</ci><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.3.3.m3.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.3.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, denotes the number of discrete product locations (slots) occupied by product <math alttext="i" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.4.4.m4.1"><semantics id="S2.Thmtheorem1.p1.4.4.m4.1a"><mi id="S2.Thmtheorem1.p1.4.4.m4.1.1" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.4.4.m4.1b"><ci id="S2.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S2.Thmtheorem1.p1.4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.4.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.4.4.m4.1d">italic_i</annotation></semantics></math>, on a product display <math alttext="d_{j}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.5.5.m5.1"><semantics id="S2.Thmtheorem1.p1.5.5.m5.1a"><msub id="S2.Thmtheorem1.p1.5.5.m5.1.1" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="S2.Thmtheorem1.p1.5.5.m5.1.1.2" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">d</mi><mi id="S2.Thmtheorem1.p1.5.5.m5.1.1.3" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.5.5.m5.1b"><apply id="S2.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.5.5.m5.1.1.1.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.2">𝑑</ci><ci id="S2.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.5.5.m5.1c">d_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.5.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. We let <math alttext="p_{i}\in\{0,1\}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.6.6.m6.2"><semantics id="S2.Thmtheorem1.p1.6.6.m6.2a"><mrow id="S2.Thmtheorem1.p1.6.6.m6.2.3" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.cmml"><msub id="S2.Thmtheorem1.p1.6.6.m6.2.3.2" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2.cmml"><mi id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.2" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2.2.cmml">p</mi><mi id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.3" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2.3.cmml">i</mi></msub><mo id="S2.Thmtheorem1.p1.6.6.m6.2.3.1" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.1.cmml">∈</mo><mrow id="S2.Thmtheorem1.p1.6.6.m6.2.3.3.2" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.3.1.cmml"><mo id="S2.Thmtheorem1.p1.6.6.m6.2.3.3.2.1" stretchy="false" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.3.1.cmml">{</mo><mn id="S2.Thmtheorem1.p1.6.6.m6.1.1" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.cmml">0</mn><mo id="S2.Thmtheorem1.p1.6.6.m6.2.3.3.2.2" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.3.1.cmml">,</mo><mn id="S2.Thmtheorem1.p1.6.6.m6.2.2" xref="S2.Thmtheorem1.p1.6.6.m6.2.2.cmml">1</mn><mo id="S2.Thmtheorem1.p1.6.6.m6.2.3.3.2.3" stretchy="false" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.6.6.m6.2b"><apply id="S2.Thmtheorem1.p1.6.6.m6.2.3.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3"><in id="S2.Thmtheorem1.p1.6.6.m6.2.3.1.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.1"></in><apply id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.1.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2">subscript</csymbol><ci id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.2.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2.2">𝑝</ci><ci id="S2.Thmtheorem1.p1.6.6.m6.2.3.2.3.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.2.3">𝑖</ci></apply><set id="S2.Thmtheorem1.p1.6.6.m6.2.3.3.1.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.2.3.3.2"><cn id="S2.Thmtheorem1.p1.6.6.m6.1.1.cmml" type="integer" xref="S2.Thmtheorem1.p1.6.6.m6.1.1">0</cn><cn id="S2.Thmtheorem1.p1.6.6.m6.2.2.cmml" type="integer" xref="S2.Thmtheorem1.p1.6.6.m6.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.6.6.m6.2c">p_{i}\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.6.6.m6.2d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 0 , 1 }</annotation></semantics></math> be an indicator variable denoting the selection status of product <math alttext="i" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.7.7.m7.1"><semantics id="S2.Thmtheorem1.p1.7.7.m7.1a"><mi id="S2.Thmtheorem1.p1.7.7.m7.1.1" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.7.7.m7.1b"><ci id="S2.Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="S2.Thmtheorem1.p1.7.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.7.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.7.7.m7.1d">italic_i</annotation></semantics></math> (also called the 0-1 knapsack <cite class="ltx_cite ltx_citemacro_citep">(Balas and Zemel, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib8" title="">1980</a>)</cite>). Each store, <math alttext="s_{l}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.8.8.m8.1"><semantics id="S2.Thmtheorem1.p1.8.8.m8.1a"><msub id="S2.Thmtheorem1.p1.8.8.m8.1.1" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.cmml"><mi id="S2.Thmtheorem1.p1.8.8.m8.1.1.2" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.2.cmml">s</mi><mi id="S2.Thmtheorem1.p1.8.8.m8.1.1.3" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.8.8.m8.1b"><apply id="S2.Thmtheorem1.p1.8.8.m8.1.1.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.8.8.m8.1.1.1.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.8.8.m8.1.1.2.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.2">𝑠</ci><ci id="S2.Thmtheorem1.p1.8.8.m8.1.1.3.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.8.8.m8.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.8.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, is expected to contain multiple displays, <math alttext="s_{l}=\{d^{(l)}_{1},d^{(l)}_{2},...d^{(l)}_{j}\}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.9.9.m9.6"><semantics id="S2.Thmtheorem1.p1.9.9.m9.6a"><mrow id="S2.Thmtheorem1.p1.9.9.m9.6.6" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.cmml"><msub id="S2.Thmtheorem1.p1.9.9.m9.6.6.5" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.2" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5.2.cmml">s</mi><mi id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5.3.cmml">l</mi></msub><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.4" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.4.cmml">=</mo><mrow id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml"><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.4" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml">{</mo><msubsup id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.2" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.2.cmml">d</mi><mn id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.3" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.3.cmml">1</mn><mrow id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.3" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.cmml"><mo id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.3.1" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.cmml">(</mo><mi id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.1" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.1.1.cmml">l</mi><mo id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.3.2" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.5" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml">,</mo><msubsup id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.2" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.2.cmml">d</mi><mn id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.3" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.3.cmml">2</mn><mrow id="S2.Thmtheorem1.p1.9.9.m9.2.2.1.3" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.cmml"><mo id="S2.Thmtheorem1.p1.9.9.m9.2.2.1.3.1" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.cmml">(</mo><mi id="S2.Thmtheorem1.p1.9.9.m9.2.2.1.1" xref="S2.Thmtheorem1.p1.9.9.m9.2.2.1.1.cmml">l</mi><mo id="S2.Thmtheorem1.p1.9.9.m9.2.2.1.3.2" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.6" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml">,</mo><mrow id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.2" mathvariant="normal" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.2.cmml">…</mi><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.1" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.1.cmml">⁢</mo><msubsup id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.2" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.2.cmml">d</mi><mi id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.3.cmml">j</mi><mrow id="S2.Thmtheorem1.p1.9.9.m9.3.3.1.3" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.cmml"><mo id="S2.Thmtheorem1.p1.9.9.m9.3.3.1.3.1" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.cmml">(</mo><mi id="S2.Thmtheorem1.p1.9.9.m9.3.3.1.1" xref="S2.Thmtheorem1.p1.9.9.m9.3.3.1.1.cmml">l</mi><mo id="S2.Thmtheorem1.p1.9.9.m9.3.3.1.3.2" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.7" stretchy="false" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.9.9.m9.6b"><apply id="S2.Thmtheorem1.p1.9.9.m9.6.6.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6"><eq id="S2.Thmtheorem1.p1.9.9.m9.6.6.4.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.4"></eq><apply id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5">subscript</csymbol><ci id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5.2">𝑠</ci><ci id="S2.Thmtheorem1.p1.9.9.m9.6.6.5.3.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.5.3">𝑙</ci></apply><set id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.4.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3"><apply id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1">subscript</csymbol><apply id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.2.2">𝑑</ci><ci id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.1.1">𝑙</ci></apply><cn id="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.9.9.m9.4.4.1.1.1.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2">subscript</csymbol><apply id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.2.2">𝑑</ci><ci id="S2.Thmtheorem1.p1.9.9.m9.2.2.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.2.2.1.1">𝑙</ci></apply><cn id="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.9.9.m9.5.5.2.2.2.3">2</cn></apply><apply id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3"><times id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.1"></times><ci id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.2">…</ci><apply id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3">subscript</csymbol><apply id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3">superscript</csymbol><ci id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.2.2">𝑑</ci><ci id="S2.Thmtheorem1.p1.9.9.m9.3.3.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.3.3.1.1">𝑙</ci></apply><ci id="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.3.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.6.6.3.3.3.3.3">𝑗</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.9.9.m9.6c">s_{l}=\{d^{(l)}_{1},d^{(l)}_{2},...d^{(l)}_{j}\}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.9.9.m9.6d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = { italic_d start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_d start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math>. Additionally, each display has a maximum capacity, <math alttext="M^{(l)}_{j}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.10.10.m10.1"><semantics id="S2.Thmtheorem1.p1.10.10.m10.1a"><msubsup id="S2.Thmtheorem1.p1.10.10.m10.1.2" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.cmml"><mi id="S2.Thmtheorem1.p1.10.10.m10.1.2.2.2" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.2.2.cmml">M</mi><mi id="S2.Thmtheorem1.p1.10.10.m10.1.2.3" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.3.cmml">j</mi><mrow id="S2.Thmtheorem1.p1.10.10.m10.1.1.1.3" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.cmml"><mo id="S2.Thmtheorem1.p1.10.10.m10.1.1.1.3.1" stretchy="false" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.cmml">(</mo><mi id="S2.Thmtheorem1.p1.10.10.m10.1.1.1.1" xref="S2.Thmtheorem1.p1.10.10.m10.1.1.1.1.cmml">l</mi><mo id="S2.Thmtheorem1.p1.10.10.m10.1.1.1.3.2" stretchy="false" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.10.10.m10.1b"><apply id="S2.Thmtheorem1.p1.10.10.m10.1.2.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.10.10.m10.1.2.1.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2">subscript</csymbol><apply id="S2.Thmtheorem1.p1.10.10.m10.1.2.2.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.10.10.m10.1.2.2.1.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.10.10.m10.1.2.2.2.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.2.2">𝑀</ci><ci id="S2.Thmtheorem1.p1.10.10.m10.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.1.1.1">𝑙</ci></apply><ci id="S2.Thmtheorem1.p1.10.10.m10.1.2.3.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.2.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.10.10.m10.1c">M^{(l)}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.10.10.m10.1d">italic_M start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, denoting the available product volume. We assume reward follows an unknown, store-conditional distribution function, <math alttext="r_{ij}\sim p(r_{ij}|s_{l},q_{ij})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.11.11.m11.1"><semantics id="S2.Thmtheorem1.p1.11.11.m11.1a"><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.cmml"><msub id="S2.Thmtheorem1.p1.11.11.m11.1.1.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.2.cmml">r</mi><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.2.cmml">i</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.2.cmml">∼</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.3.cmml">p</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.2.cmml">⁢</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.cmml"><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.2" stretchy="false" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.cmml"><msub id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.2.cmml">r</mi><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.3.cmml"><msub id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.1" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.3" stretchy="false" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.11.11.m11.1b"><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1"><csymbol cd="latexml" id="S2.Thmtheorem1.p1.11.11.m11.1.1.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.2">similar-to</csymbol><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3">subscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.2">𝑟</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3"><times id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.1"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.2">𝑖</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1"><times id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.2"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.3">𝑝</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1"><csymbol cd="latexml" id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.2">𝑟</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3"><times id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.1"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2"><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3"><times id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.11.11.m11.1c">r_{ij}\sim p(r_{ij}|s_{l},q_{ij})</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.11.11.m11.1d">italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ∼ italic_p ( italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> that varies by quantity allocated. For example, one might expect diminishing marginal returns for larger quantities of the same product. Therefore our goal is to maximize expected reward for each display, <math alttext="d_{j}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.12.12.m12.1"><semantics id="S2.Thmtheorem1.p1.12.12.m12.1a"><msub id="S2.Thmtheorem1.p1.12.12.m12.1.1" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.cmml"><mi id="S2.Thmtheorem1.p1.12.12.m12.1.1.2" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.2.cmml">d</mi><mi id="S2.Thmtheorem1.p1.12.12.m12.1.1.3" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.12.12.m12.1b"><apply id="S2.Thmtheorem1.p1.12.12.m12.1.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.12.12.m12.1.1.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.12.12.m12.1.1.2.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.2">𝑑</ci><ci id="S2.Thmtheorem1.p1.12.12.m12.1.1.3.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.12.12.m12.1c">d_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.12.12.m12.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, at each discrete time step, <math alttext="t" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.13.13.m13.1"><semantics id="S2.Thmtheorem1.p1.13.13.m13.1a"><mi id="S2.Thmtheorem1.p1.13.13.m13.1.1" xref="S2.Thmtheorem1.p1.13.13.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.13.13.m13.1b"><ci id="S2.Thmtheorem1.p1.13.13.m13.1.1.cmml" xref="S2.Thmtheorem1.p1.13.13.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.13.13.m13.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.13.13.m13.1d">italic_t</annotation></semantics></math></span></p>
</div>
<div class="ltx_para" id="S2.Thmtheorem1.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S8.EGx1">
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textrm{maximize}\sum_{i}^{N}\mathbb{E}[r_{ij}|s_{l},q_{ij}]p_{ij}" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.1.1.3" mathsize="90%" xref="S2.E2.m1.1.1.3a.cmml">maximize</mtext><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml"><munderover id="S2.E2.m1.1.1.1.2a" xref="S2.E2.m1.1.1.1.2.cmml"><mo id="S2.E2.m1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.E2.m1.1.1.1.2.2.2.cmml">∑</mo><mi id="S2.E2.m1.1.1.1.2.2.3" mathsize="90%" xref="S2.E2.m1.1.1.1.2.2.3.cmml">i</mi><mi id="S2.E2.m1.1.1.1.2.3" mathsize="90%" xref="S2.E2.m1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.3.cmml">𝔼</mi><mo id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E2.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.cmml">r</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.3.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.4.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.3.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S2.E2.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E2.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E2.m1.1.1.1.1.2a" xref="S2.E2.m1.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.4.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.4.2.cmml">p</mi><mrow id="S2.E2.m1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.4.3.cmml"><mi id="S2.E2.m1.1.1.1.1.4.3.2" mathsize="90%" xref="S2.E2.m1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.4.3.1" xref="S2.E2.m1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.4.3.3" mathsize="90%" xref="S2.E2.m1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><times id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></times><ci id="S2.E2.m1.1.1.3a.cmml" xref="S2.E2.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.1.1.3.cmml" mathsize="90%" xref="S2.E2.m1.1.1.3">maximize</mtext></ci><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><apply id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.2.2.2"></sum><ci id="S2.E2.m1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E2.m1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3">𝔼</ci><apply id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2">𝑟</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3"><times id="S2.E2.m1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S2.E2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3"><times id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply><apply id="S2.E2.m1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.4.2">𝑝</ci><apply id="S2.E2.m1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.4.3"><times id="S2.E2.m1.1.1.1.1.4.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.3.1"></times><ci id="S2.E2.m1.1.1.1.1.4.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.4.3.3.cmml" xref="S2.E2.m1.1.1.1.1.4.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\textrm{maximize}\sum_{i}^{N}\mathbb{E}[r_{ij}|s_{l},q_{ij}]p_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">maximize ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT blackboard_E [ italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ] italic_p start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textrm{subject to}\sum_{i}^{N}p_{ij}q_{ij}\leq M_{j}\ " class="ltx_Math" display="inline" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mrow id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E3.m1.1.1.2.2" mathsize="90%" xref="S2.E3.m1.1.1.2.2a.cmml">subject to</mtext><mo id="S2.E3.m1.1.1.2.1" xref="S2.E3.m1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.1.1.2.3.1" xref="S2.E3.m1.1.1.2.3.1.cmml"><munderover id="S2.E3.m1.1.1.2.3.1a" xref="S2.E3.m1.1.1.2.3.1.cmml"><mo id="S2.E3.m1.1.1.2.3.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.E3.m1.1.1.2.3.1.2.2.cmml">∑</mo><mi id="S2.E3.m1.1.1.2.3.1.2.3" mathsize="90%" xref="S2.E3.m1.1.1.2.3.1.2.3.cmml">i</mi><mi id="S2.E3.m1.1.1.2.3.1.3" mathsize="90%" xref="S2.E3.m1.1.1.2.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E3.m1.1.1.2.3.2" xref="S2.E3.m1.1.1.2.3.2.cmml"><msub id="S2.E3.m1.1.1.2.3.2.2" xref="S2.E3.m1.1.1.2.3.2.2.cmml"><mi id="S2.E3.m1.1.1.2.3.2.2.2" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.2.2.cmml">p</mi><mrow id="S2.E3.m1.1.1.2.3.2.2.3" xref="S2.E3.m1.1.1.2.3.2.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2.2.3.2" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.1.1.2.3.2.2.3.1" xref="S2.E3.m1.1.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.3.2.2.3.3" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E3.m1.1.1.2.3.2.1" xref="S2.E3.m1.1.1.2.3.2.1.cmml">⁢</mo><msub id="S2.E3.m1.1.1.2.3.2.3" xref="S2.E3.m1.1.1.2.3.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2.3.2" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.3.2.cmml">q</mi><mrow id="S2.E3.m1.1.1.2.3.2.3.3" xref="S2.E3.m1.1.1.2.3.2.3.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2.3.3.2" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.3.3.2.cmml">i</mi><mo id="S2.E3.m1.1.1.2.3.2.3.3.1" xref="S2.E3.m1.1.1.2.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.2.3.2.3.3.3" mathsize="90%" xref="S2.E3.m1.1.1.2.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1" mathsize="90%" xref="S2.E3.m1.1.1.1.cmml">≤</mo><msub id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.3.2" mathsize="90%" xref="S2.E3.m1.1.1.3.2.cmml">M</mi><mi id="S2.E3.m1.1.1.3.3" mathsize="90%" xref="S2.E3.m1.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><leq id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"></leq><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><times id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2.1"></times><ci id="S2.E3.m1.1.1.2.2a.cmml" xref="S2.E3.m1.1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E3.m1.1.1.2.2.cmml" mathsize="90%" xref="S2.E3.m1.1.1.2.2">subject to</mtext></ci><apply id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3"><apply id="S2.E3.m1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.1.1.cmml" xref="S2.E3.m1.1.1.2.3.1">superscript</csymbol><apply id="S2.E3.m1.1.1.2.3.1.2.cmml" xref="S2.E3.m1.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.1.2.1.cmml" xref="S2.E3.m1.1.1.2.3.1">subscript</csymbol><sum id="S2.E3.m1.1.1.2.3.1.2.2.cmml" xref="S2.E3.m1.1.1.2.3.1.2.2"></sum><ci id="S2.E3.m1.1.1.2.3.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3.1.2.3">𝑖</ci></apply><ci id="S2.E3.m1.1.1.2.3.1.3.cmml" xref="S2.E3.m1.1.1.2.3.1.3">𝑁</ci></apply><apply id="S2.E3.m1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2"><times id="S2.E3.m1.1.1.2.3.2.1.cmml" xref="S2.E3.m1.1.1.2.3.2.1"></times><apply id="S2.E3.m1.1.1.2.3.2.2.cmml" xref="S2.E3.m1.1.1.2.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.2.2.1.cmml" xref="S2.E3.m1.1.1.2.3.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.2.3.2.2.2.cmml" xref="S2.E3.m1.1.1.2.3.2.2.2">𝑝</ci><apply id="S2.E3.m1.1.1.2.3.2.2.3.cmml" xref="S2.E3.m1.1.1.2.3.2.2.3"><times id="S2.E3.m1.1.1.2.3.2.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3.2.2.3.1"></times><ci id="S2.E3.m1.1.1.2.3.2.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2.2.3.2">𝑖</ci><ci id="S2.E3.m1.1.1.2.3.2.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.E3.m1.1.1.2.3.2.3.cmml" xref="S2.E3.m1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.2.3.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2.3.2">𝑞</ci><apply id="S2.E3.m1.1.1.2.3.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.2.3.3"><times id="S2.E3.m1.1.1.2.3.2.3.3.1.cmml" xref="S2.E3.m1.1.1.2.3.2.3.3.1"></times><ci id="S2.E3.m1.1.1.2.3.2.3.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2.3.3.2">𝑖</ci><ci id="S2.E3.m1.1.1.2.3.2.3.3.3.cmml" xref="S2.E3.m1.1.1.2.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2">𝑀</ci><ci id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\textrm{subject to}\sum_{i}^{N}p_{ij}q_{ij}\leq M_{j}\ </annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">subject to ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ≤ italic_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.2">One key challenge in the Product Assortment Problem is learning the store-conditional reward function, <math alttext="r_{i}\sim p(r_{ij}|s_{l},q_{ij})" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml"><mi id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">r</mi><mi id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml">i</mi></msub><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">∼</mo><mrow id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.3.cmml">p</mi><mo id="S2.p2.1.m1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.1.1.1.1.4" xref="S2.p2.1.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.4.2" xref="S2.p2.1.m1.1.1.1.1.1.1.4.2.cmml">r</mi><mrow id="S2.p2.1.m1.1.1.1.1.1.1.4.3" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.4.3.2" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.p2.1.m1.1.1.1.1.1.1.4.3.1" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.p2.1.m1.1.1.1.1.1.1.4.3.3" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S2.p2.1.m1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.p2.1.m1.1.1.1.1.1.1.2.2" xref="S2.p2.1.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.1.1.2.2.3" xref="S2.p2.1.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.1" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">similar-to</csymbol><apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.p2.1.m1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.3.2">𝑟</ci><ci id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"><times id="S2.p2.1.m1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.2"></times><ci id="S2.p2.1.m1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.3">𝑝</ci><apply id="S2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.p2.1.m1.1.1.1.1.1.1.4.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4.2">𝑟</ci><apply id="S2.p2.1.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3"><times id="S2.p2.1.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S2.p2.1.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S2.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2"><apply id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3"><times id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">r_{i}\sim p(r_{ij}|s_{l},q_{ij})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ italic_p ( italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, since preferences tend to be heterogeneous across locations. We tackle this problem by learning demographic profiles for stores and clustering them to estimate <math alttext="\mathbb{E}[r_{ij}|s_{l},q_{ij}]" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">𝔼</mi><mo id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p2.2.m2.1.1.1.1" xref="S2.p2.2.m2.1.1.1.2.cmml"><mo id="S2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S2.p2.2.m2.1.1.1.2.1.cmml">[</mo><mrow id="S2.p2.2.m2.1.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.cmml"><msub id="S2.p2.2.m2.1.1.1.1.1.4" xref="S2.p2.2.m2.1.1.1.1.1.4.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.4.2" xref="S2.p2.2.m2.1.1.1.1.1.4.2.cmml">r</mi><mrow id="S2.p2.2.m2.1.1.1.1.1.4.3" xref="S2.p2.2.m2.1.1.1.1.1.4.3.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.4.3.2" xref="S2.p2.2.m2.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.p2.2.m2.1.1.1.1.1.4.3.1" xref="S2.p2.2.m2.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.p2.2.m2.1.1.1.1.1.4.3.3" xref="S2.p2.2.m2.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S2.p2.2.m2.1.1.1.1.1.3" xref="S2.p2.2.m2.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.p2.2.m2.1.1.1.1.1.2.2" xref="S2.p2.2.m2.1.1.1.1.1.2.3.cmml"><msub id="S2.p2.2.m2.1.1.1.1.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.1.1.1.2" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.p2.2.m2.1.1.1.1.1.1.1.1.3" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.p2.2.m2.1.1.1.1.1.2.2.3" xref="S2.p2.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.p2.2.m2.1.1.1.1.1.2.2.2" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.2.2.2.2" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.2" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.1" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.3" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S2.p2.2.m2.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><times id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2"></times><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝔼</ci><apply id="S2.p2.2.m2.1.1.1.2.cmml" xref="S2.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p2.2.m2.1.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p2.2.m2.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.3">conditional</csymbol><apply id="S2.p2.2.m2.1.1.1.1.1.4.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.1.4.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.1.4.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4.2">𝑟</ci><apply id="S2.p2.2.m2.1.1.1.1.1.4.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4.3"><times id="S2.p2.2.m2.1.1.1.1.1.4.3.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4.3.1"></times><ci id="S2.p2.2.m2.1.1.1.1.1.4.3.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.p2.2.m2.1.1.1.1.1.4.3.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S2.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2"><apply id="S2.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3"><times id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbb{E}[r_{ij}|s_{l},q_{ij}]</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">blackboard_E [ italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S2.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Definition 0 (Demographic Spatial Clustering Problem).</h6>
<div class="ltx_para" id="S2.Thmtheorem2.p1">
<p class="ltx_p" id="S2.Thmtheorem2.p1.11"><span class="ltx_text ltx_font_italic" id="S2.Thmtheorem2.p1.11.11">Given a set of spatial areas, <math alttext="\alpha_{z}\in\{\alpha_{z}:1\leq z\leq Z\}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.1.1.m1.2"><semantics id="S2.Thmtheorem2.p1.1.1.m1.2a"><mrow id="S2.Thmtheorem2.p1.1.1.m1.2.2" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.cmml"><msub id="S2.Thmtheorem2.p1.1.1.m1.2.2.4" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4.cmml"><mi id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.2" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4.2.cmml">α</mi><mi id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.3" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4.3.cmml">z</mi></msub><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.3" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.3.cmml">∈</mo><mrow id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.cmml"><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.1.cmml">{</mo><msub id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml">α</mi><mi id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.1.cmml">:</mo><mrow id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.cmml"><mn id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.2" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.2.cmml">1</mn><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.3" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.3.cmml">≤</mo><mi id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.4" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.4.cmml">z</mi><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.5" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.5.cmml">≤</mo><mi id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.6" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.6.cmml">Z</mi></mrow><mo id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.5" stretchy="false" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.1.1.m1.2b"><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2"><in id="S2.Thmtheorem2.p1.1.1.m1.2.2.3.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.3"></in><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.1.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4">subscript</csymbol><ci id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.2.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4.2">𝛼</ci><ci id="S2.Thmtheorem2.p1.1.1.m1.2.2.4.3.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.4.3">𝑧</ci></apply><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2"><csymbol cd="latexml" id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.3.1.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2">𝛼</ci><ci id="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2"><and id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2a.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2"></and><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2b.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2"><leq id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.3"></leq><cn id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.2.cmml" type="integer" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.2">1</cn><ci id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.4.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.4">𝑧</ci></apply><apply id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2c.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2"><leq id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.5.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2406.07769v2#S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.4.cmml" id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2d.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2"></share><ci id="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.6.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.2.2.2.2.2.6">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.1.1.m1.2c">\alpha_{z}\in\{\alpha_{z}:1\leq z\leq Z\}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.1.1.m1.2d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ { italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT : 1 ≤ italic_z ≤ italic_Z }</annotation></semantics></math>, each with a demographic vector, <math alttext="x_{z}\in\mathbb{R}^{b}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.2.2.m2.1"><semantics id="S2.Thmtheorem2.p1.2.2.m2.1a"><mrow id="S2.Thmtheorem2.p1.2.2.m2.1.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.cmml"><msub id="S2.Thmtheorem2.p1.2.2.m2.1.1.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml">x</mi><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml">z</mi></msub><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.Thmtheorem2.p1.2.2.m2.1.1.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.3.cmml">b</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.2.2.m2.1b"><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1"><in id="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1"></in><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2">subscript</csymbol><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.2">𝑥</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.3">𝑧</ci></apply><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3">superscript</csymbol><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.2">ℝ</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.2.2.m2.1c">x_{z}\in\mathbb{R}^{b}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math> and stores, <math alttext="s_{l}\in\{s_{l}:1\leq l\leq L\}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.3.3.m3.2"><semantics id="S2.Thmtheorem2.p1.3.3.m3.2a"><mrow id="S2.Thmtheorem2.p1.3.3.m3.2.2" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.cmml"><msub id="S2.Thmtheorem2.p1.3.3.m3.2.2.4" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4.cmml"><mi id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.2" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.3" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.3" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.3.cmml">∈</mo><mrow id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.cmml"><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.1.cmml">{</mo><msub id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.1.cmml">:</mo><mrow id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.cmml"><mn id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.2" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.2.cmml">1</mn><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.3" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.3.cmml">≤</mo><mi id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.4" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.4.cmml">l</mi><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.5" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.5.cmml">≤</mo><mi id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.6" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.6.cmml">L</mi></mrow><mo id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.5" stretchy="false" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.3.3.m3.2b"><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2"><in id="S2.Thmtheorem2.p1.3.3.m3.2.2.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.3"></in><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4">subscript</csymbol><ci id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.2.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.3.3.m3.2.2.4.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.4.3">𝑙</ci></apply><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2"><csymbol cd="latexml" id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.3.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.3">conditional-set</csymbol><apply id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2"><and id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2a.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2"></and><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2b.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2"><leq id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.3"></leq><cn id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.2.cmml" type="integer" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.2">1</cn><ci id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.4.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.4">𝑙</ci></apply><apply id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2c.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2"><leq id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.5.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2406.07769v2#S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.4.cmml" id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2d.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2"></share><ci id="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.6.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.2.2.2.2.2.6">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.3.3.m3.2c">s_{l}\in\{s_{l}:1\leq l\leq L\}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.3.3.m3.2d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ { italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT : 1 ≤ italic_l ≤ italic_L }</annotation></semantics></math>, we have two goals. First, match stores to a set of areas by constructing a neighborhood around each store, <math alttext="s_{l}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.4.4.m4.1"><semantics id="S2.Thmtheorem2.p1.4.4.m4.1a"><msub id="S2.Thmtheorem2.p1.4.4.m4.1.1" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.cmml"><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.2" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.3" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.4.4.m4.1b"><apply id="S2.Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.4.4.m4.1.1.1.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.2.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.4.4.m4.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.4.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>: <math alttext="\mathcal{N}{s_{l}}(\{(a_{1},x_{1}),(a_{2},x_{2}),...\})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.5.5.m5.2"><semantics id="S2.Thmtheorem2.p1.5.5.m5.2a"><mrow id="S2.Thmtheorem2.p1.5.5.m5.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Thmtheorem2.p1.5.5.m5.2.2.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.3.cmml">𝒩</mi><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.2.cmml">⁢</mo><msub id="S2.Thmtheorem2.p1.5.5.m5.2.2.4" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.2a" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.2.cmml">⁢</mo><mrow id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.cmml"><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.2" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.cmml">(</mo><mrow id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml"><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml">{</mo><mrow id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.3.cmml"><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.4" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.2.cmml">x</mi><mn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.5" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.4" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml">,</mo><mrow id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.3.cmml"><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.3.cmml">(</mo><msub id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.2.cmml">a</mi><mn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.3.cmml">2</mn></msub><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.4" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.3.cmml">,</mo><msub id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.2" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.2.cmml">x</mi><mn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.3" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.5" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.3.cmml">)</mo></mrow><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.5" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml">,</mo><mi id="S2.Thmtheorem2.p1.5.5.m5.1.1" mathvariant="normal" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.cmml">…</mi><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.6" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml">}</mo></mrow><mo id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.3" stretchy="false" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.5.5.m5.2b"><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2"><times id="S2.Thmtheorem2.p1.5.5.m5.2.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.2"></times><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.3.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.3">𝒩</ci><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4">subscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.4.3.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.4.3">𝑙</ci></apply><set id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2"><interval closure="open" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2"><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.2">𝑎</ci><cn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.2">𝑥</ci><cn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.3.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2"><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.2">𝑎</ci><cn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.1.1.3">2</cn></apply><apply id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.2">𝑥</ci><cn id="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.5.5.m5.2.2.1.1.1.2.2.2.2.3">2</cn></apply></interval><ci id="S2.Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.5.5.m5.2c">\mathcal{N}{s_{l}}(\{(a_{1},x_{1}),(a_{2},x_{2}),...\})</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.5.5.m5.2d">caligraphic_N italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( { ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , ( italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , … } )</annotation></semantics></math>. Second within each neighborhood, produce a store-level demographic profile by aggregating over the demographic vectors, <math alttext="X_{l}=g\big{[}\mathcal{N}{s_{l}}(\{(a_{1},x_{1}),...\})\big{]}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.6.6.m6.2"><semantics id="S2.Thmtheorem2.p1.6.6.m6.2a"><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.cmml"><msub id="S2.Thmtheorem2.p1.6.6.m6.2.2.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3.2.cmml">X</mi><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.2.cmml">=</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.3.cmml">g</mi><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.2.cmml">⁢</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.2.cmml"><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.2" maxsize="120%" minsize="120%" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.3.cmml">𝒩</mi><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2a" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.cmml"><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.4" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mn id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.Thmtheorem2.p1.6.6.m6.1.1" mathvariant="normal" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.cmml">…</mi><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.3" maxsize="120%" minsize="120%" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.6.6.m6.2b"><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2"><eq id="S2.Thmtheorem2.p1.6.6.m6.2.2.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.2"></eq><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3">subscript</csymbol><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3.2">𝑋</ci><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.3.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.3.3">𝑙</ci></apply><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1"><times id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.2"></times><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.3">𝑔</ci><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1"><csymbol cd="latexml" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.2.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1"><times id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.2"></times><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.3">𝒩</ci><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.4.3">𝑙</ci></apply><set id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1"><interval closure="open" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2"><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><cn id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝑥</ci><cn id="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.6.6.m6.2.2.1.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply></interval><ci id="S2.Thmtheorem2.p1.6.6.m6.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.1.1">…</ci></set></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.6.6.m6.2c">X_{l}=g\big{[}\mathcal{N}{s_{l}}(\{(a_{1},x_{1}),...\})\big{]}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.6.6.m6.2d">italic_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_g [ caligraphic_N italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( { ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … } ) ]</annotation></semantics></math>. The aggregation function, <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.7.7.m7.1"><semantics id="S2.Thmtheorem2.p1.7.7.m7.1a"><mrow id="S2.Thmtheorem2.p1.7.7.m7.1.2" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.cmml"><mi id="S2.Thmtheorem2.p1.7.7.m7.1.2.2" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.2.cmml">g</mi><mo id="S2.Thmtheorem2.p1.7.7.m7.1.2.1" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.1.cmml">⁢</mo><mrow id="S2.Thmtheorem2.p1.7.7.m7.1.2.3.2" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.cmml"><mo id="S2.Thmtheorem2.p1.7.7.m7.1.2.3.2.1" stretchy="false" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.cmml">(</mo><mo id="S2.Thmtheorem2.p1.7.7.m7.1.1" lspace="0em" rspace="0em" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.cmml">⋅</mo><mo id="S2.Thmtheorem2.p1.7.7.m7.1.2.3.2.2" stretchy="false" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.7.7.m7.1b"><apply id="S2.Thmtheorem2.p1.7.7.m7.1.2.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.2"><times id="S2.Thmtheorem2.p1.7.7.m7.1.2.1.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.1"></times><ci id="S2.Thmtheorem2.p1.7.7.m7.1.2.2.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.2.2">𝑔</ci><ci id="S2.Thmtheorem2.p1.7.7.m7.1.1.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.7.7.m7.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.7.7.m7.1d">italic_g ( ⋅ )</annotation></semantics></math> could be any scalar-valued aggregation (i.e., mean, median, weighted average). Finally, we cluster the set of <math alttext="L" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.8.8.m8.1"><semantics id="S2.Thmtheorem2.p1.8.8.m8.1a"><mi id="S2.Thmtheorem2.p1.8.8.m8.1.1" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.8.8.m8.1b"><ci id="S2.Thmtheorem2.p1.8.8.m8.1.1.cmml" xref="S2.Thmtheorem2.p1.8.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.8.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.8.8.m8.1d">italic_L</annotation></semantics></math> store demographic profiles, <math alttext="X_{l}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.9.9.m9.1"><semantics id="S2.Thmtheorem2.p1.9.9.m9.1a"><msub id="S2.Thmtheorem2.p1.9.9.m9.1.1" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.cmml"><mi id="S2.Thmtheorem2.p1.9.9.m9.1.1.2" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.2.cmml">X</mi><mi id="S2.Thmtheorem2.p1.9.9.m9.1.1.3" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.9.9.m9.1b"><apply id="S2.Thmtheorem2.p1.9.9.m9.1.1.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.9.9.m9.1.1.1.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.9.9.m9.1.1.2.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.2">𝑋</ci><ci id="S2.Thmtheorem2.p1.9.9.m9.1.1.3.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.9.9.m9.1c">X_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.9.9.m9.1d">italic_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>’s, into <math alttext="K" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.10.10.m10.1"><semantics id="S2.Thmtheorem2.p1.10.10.m10.1a"><mi id="S2.Thmtheorem2.p1.10.10.m10.1.1" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.10.10.m10.1b"><ci id="S2.Thmtheorem2.p1.10.10.m10.1.1.cmml" xref="S2.Thmtheorem2.p1.10.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.10.10.m10.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.10.10.m10.1d">italic_K</annotation></semantics></math> different clusters. We expect stores within each cluster to have similar preferences, making it easier to estimate the store-conditional expectation, <math alttext="\mathbb{E}[r_{ij}|s_{l},q_{ij}]" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.11.11.m11.1"><semantics id="S2.Thmtheorem2.p1.11.11.m11.1a"><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.cmml">𝔼</mi><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.2.cmml">⁢</mo><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.2.cmml"><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.2" stretchy="false" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.2.1.cmml">[</mo><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.cmml"><msub id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.2.cmml">r</mi><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.3.cmml"><msub id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.3" stretchy="false" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.11.11.m11.1b"><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1"><times id="S2.Thmtheorem2.p1.11.11.m11.1.1.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.2"></times><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3">𝔼</ci><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1"><csymbol cd="latexml" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.2.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1"><csymbol cd="latexml" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.3">conditional</csymbol><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4">subscript</csymbol><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.2">𝑟</ci><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3"><times id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.1"></times><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2"><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3"><times id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.11.11.m11.1c">\mathbb{E}[r_{ij}|s_{l},q_{ij}]</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.11.11.m11.1d">blackboard_E [ italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ]</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">A summary of notation used throughout the paper is presented Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.SS1" title="7.1. Table of Notation Used ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7.1</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In the following section we discuss the various components of <span class="ltx_text" id="S3.p1.1.1">EdgeRec3D</span>. Our recommendation engine is comprised of the following modular components: 3D data collection and sales inference, spatial clustering, candidate generation, value estimation, ranking and heuristic search. The output is a recommended product set tailored <span class="ltx_text ltx_font_italic" id="S3.p1.1.2">to each display location</span> in a store, <math alttext="d_{ij}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">d</mi><mrow id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.p1.1.m1.1.1.3.1" xref="S3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑑</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><times id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3.1"></times><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">d_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, which a retail worker can choose to physically implement.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="270" id="S3.F2.sf1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F2.sf1.4.2" style="font-size:90%;">Logical architecture of <span class="ltx_text" id="S3.F2.sf1.4.2.1">EdgeRec3D</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="756" id="S3.F2.sf2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F2.sf2.4.2" style="font-size:90%;">Physical architecture of <span class="ltx_text" id="S3.F2.sf2.4.2.1">EdgeRec3D</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.4.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.5.2" style="font-size:90%;">(a) Logical design of <span class="ltx_text" id="S3.F2.5.2.1">EdgeRec3D</span>. The user performs successive 3D scans of a display to obtain product count predictions. These predictions are differenced over time following Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.E4" title="Equation 4 ‣ 3.1. 3D Data Collection ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> to estimate sales. We train our two-stage spatial clustering pipeline to group demographically similar stores. Within each cluster, we estimate a Robust Bayesian Payoff (RBP) model to obtain a ranking statistic (PEPF) for each product. We generate candidates for each display, rank each candidate, and produce recommendation sets with heuristic search. (b) Physical design of <span class="ltx_text" id="S3.F2.5.2.2">EdgeRec3D</span>. 3D perception is implemented at the edge of the network to facilitate real-time feedback. Data are aggregated across nodes for value estimation and candidate generation. When recommendations are served, we observe the state of the display in real-time and apply heuristic search to improve it. </span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>3D Data Collection</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The most important input to <span class="ltx_text" id="S3.SS1.p1.1.1">EdgeRec3D</span> is fine-grained estimates of product sales over time. Sales estimates need to be both high resolution in time, and specific to each product. Historically, this is done either by hand or by using point-of-sale (POS) data. Hand collected sales data is expensive to collect, while POS is too low resolution to understand how product sales vary by display location within a store. In real-world retail, it is common for a product to be displayed in many locations throughout a single store. Thus, POS data alone does not facilitate targeted recommendations throughout a store.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Instead, we train and deploy CountNet3D <cite class="ltx_cite ltx_citemacro_citep">(Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib27" title="">2023</a>)</cite>, a regression-based 3D computer vision model to infer counts of densely spaced objects. CountNet3D takes as input a set of images, and a LiDAR point cloud, and outputs a set of fine-grained, product-level count estimates. This is especially important when the number of available products is in the hundreds or thousands. CountNet3D is only trained to predict object counts in 3D space. In order to collect sales data, CountNet3D is deployed to a mobile device where inference on the images and point cloud data can occur on-edge. The user is a front-line retail worker (i.e. merchandiser), and is the person responsible for restocking the shelves with product, typically on a daily basis. Prior to the restock, the user performs a <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">pre-scan</span> of the shelf or product display. The pre-scan provides a current snapshot of the available inventory on the display. Next, the user restocks the display following a pre-specified plan (called a planogram or schematic). Finally, upon completion of the restock the user performs a <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.2">post-scan</span>, to capture the inventory when the display has been replenished with product. Using these two inventory snapshots, we can difference the counts over time to estimate sales with the following equation:</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="sales_{ijt}=\hat{c}^{(post)}_{ijt}-\hat{c}^{(pre)}_{ij(t-1)}" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.4" xref="S3.E4.m1.3.4.cmml"><mrow id="S3.E4.m1.3.4.2" xref="S3.E4.m1.3.4.2.cmml"><mi id="S3.E4.m1.3.4.2.2" mathsize="90%" xref="S3.E4.m1.3.4.2.2.cmml">s</mi><mo id="S3.E4.m1.3.4.2.1" xref="S3.E4.m1.3.4.2.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.2.3" mathsize="90%" xref="S3.E4.m1.3.4.2.3.cmml">a</mi><mo id="S3.E4.m1.3.4.2.1a" xref="S3.E4.m1.3.4.2.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.2.4" mathsize="90%" xref="S3.E4.m1.3.4.2.4.cmml">l</mi><mo id="S3.E4.m1.3.4.2.1b" xref="S3.E4.m1.3.4.2.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.2.5" mathsize="90%" xref="S3.E4.m1.3.4.2.5.cmml">e</mi><mo id="S3.E4.m1.3.4.2.1c" xref="S3.E4.m1.3.4.2.1.cmml">⁢</mo><msub id="S3.E4.m1.3.4.2.6" xref="S3.E4.m1.3.4.2.6.cmml"><mi id="S3.E4.m1.3.4.2.6.2" mathsize="90%" xref="S3.E4.m1.3.4.2.6.2.cmml">s</mi><mrow id="S3.E4.m1.3.4.2.6.3" xref="S3.E4.m1.3.4.2.6.3.cmml"><mi id="S3.E4.m1.3.4.2.6.3.2" mathsize="90%" xref="S3.E4.m1.3.4.2.6.3.2.cmml">i</mi><mo id="S3.E4.m1.3.4.2.6.3.1" xref="S3.E4.m1.3.4.2.6.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.2.6.3.3" mathsize="90%" xref="S3.E4.m1.3.4.2.6.3.3.cmml">j</mi><mo id="S3.E4.m1.3.4.2.6.3.1a" xref="S3.E4.m1.3.4.2.6.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.2.6.3.4" mathsize="90%" xref="S3.E4.m1.3.4.2.6.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.E4.m1.3.4.1" mathsize="90%" xref="S3.E4.m1.3.4.1.cmml">=</mo><mrow id="S3.E4.m1.3.4.3" xref="S3.E4.m1.3.4.3.cmml"><msubsup id="S3.E4.m1.3.4.3.2" xref="S3.E4.m1.3.4.3.2.cmml"><mover accent="true" id="S3.E4.m1.3.4.3.2.2.2" xref="S3.E4.m1.3.4.3.2.2.2.cmml"><mi id="S3.E4.m1.3.4.3.2.2.2.2" mathsize="90%" xref="S3.E4.m1.3.4.3.2.2.2.2.cmml">c</mi><mo id="S3.E4.m1.3.4.3.2.2.2.1" mathsize="90%" xref="S3.E4.m1.3.4.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E4.m1.3.4.3.2.3" xref="S3.E4.m1.3.4.3.2.3.cmml"><mi id="S3.E4.m1.3.4.3.2.3.2" mathsize="90%" xref="S3.E4.m1.3.4.3.2.3.2.cmml">i</mi><mo id="S3.E4.m1.3.4.3.2.3.1" xref="S3.E4.m1.3.4.3.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.3.2.3.3" mathsize="90%" xref="S3.E4.m1.3.4.3.2.3.3.cmml">j</mi><mo id="S3.E4.m1.3.4.3.2.3.1a" xref="S3.E4.m1.3.4.3.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.4.3.2.3.4" mathsize="90%" xref="S3.E4.m1.3.4.3.2.3.4.cmml">t</mi></mrow><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.2" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.3" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E4.m1.1.1.1.1.1.1a" xref="S3.E4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.4" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.4.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.1.1b" xref="S3.E4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.5" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.5.cmml">t</mi></mrow><mo id="S3.E4.m1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.3.4.3.1" mathsize="90%" xref="S3.E4.m1.3.4.3.1.cmml">−</mo><msubsup id="S3.E4.m1.3.4.3.3" xref="S3.E4.m1.3.4.3.3.cmml"><mover accent="true" id="S3.E4.m1.3.4.3.3.2.2" xref="S3.E4.m1.3.4.3.3.2.2.cmml"><mi id="S3.E4.m1.3.4.3.3.2.2.2" mathsize="90%" xref="S3.E4.m1.3.4.3.3.2.2.2.cmml">c</mi><mo id="S3.E4.m1.3.4.3.3.2.2.1" mathsize="90%" xref="S3.E4.m1.3.4.3.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><mi id="S3.E4.m1.3.3.1.3" mathsize="90%" xref="S3.E4.m1.3.3.1.3.cmml">i</mi><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.4" mathsize="90%" xref="S3.E4.m1.3.3.1.4.cmml">j</mi><mo id="S3.E4.m1.3.3.1.2a" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2" mathsize="90%" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">−</mo><mn id="S3.E4.m1.3.3.1.1.1.1.3" mathsize="90%" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E4.m1.3.3.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mo id="S3.E4.m1.2.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2" mathsize="90%" xref="S3.E4.m1.2.2.1.1.1.2.cmml">p</mi><mo id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.1.3" mathsize="90%" xref="S3.E4.m1.2.2.1.1.1.3.cmml">r</mi><mo id="S3.E4.m1.2.2.1.1.1.1a" xref="S3.E4.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.1.4" mathsize="90%" xref="S3.E4.m1.2.2.1.1.1.4.cmml">e</mi></mrow><mo id="S3.E4.m1.2.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.4.cmml" xref="S3.E4.m1.3.4"><eq id="S3.E4.m1.3.4.1.cmml" xref="S3.E4.m1.3.4.1"></eq><apply id="S3.E4.m1.3.4.2.cmml" xref="S3.E4.m1.3.4.2"><times id="S3.E4.m1.3.4.2.1.cmml" xref="S3.E4.m1.3.4.2.1"></times><ci id="S3.E4.m1.3.4.2.2.cmml" xref="S3.E4.m1.3.4.2.2">𝑠</ci><ci id="S3.E4.m1.3.4.2.3.cmml" xref="S3.E4.m1.3.4.2.3">𝑎</ci><ci id="S3.E4.m1.3.4.2.4.cmml" xref="S3.E4.m1.3.4.2.4">𝑙</ci><ci id="S3.E4.m1.3.4.2.5.cmml" xref="S3.E4.m1.3.4.2.5">𝑒</ci><apply id="S3.E4.m1.3.4.2.6.cmml" xref="S3.E4.m1.3.4.2.6"><csymbol cd="ambiguous" id="S3.E4.m1.3.4.2.6.1.cmml" xref="S3.E4.m1.3.4.2.6">subscript</csymbol><ci id="S3.E4.m1.3.4.2.6.2.cmml" xref="S3.E4.m1.3.4.2.6.2">𝑠</ci><apply id="S3.E4.m1.3.4.2.6.3.cmml" xref="S3.E4.m1.3.4.2.6.3"><times id="S3.E4.m1.3.4.2.6.3.1.cmml" xref="S3.E4.m1.3.4.2.6.3.1"></times><ci id="S3.E4.m1.3.4.2.6.3.2.cmml" xref="S3.E4.m1.3.4.2.6.3.2">𝑖</ci><ci id="S3.E4.m1.3.4.2.6.3.3.cmml" xref="S3.E4.m1.3.4.2.6.3.3">𝑗</ci><ci id="S3.E4.m1.3.4.2.6.3.4.cmml" xref="S3.E4.m1.3.4.2.6.3.4">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.3.4.3.cmml" xref="S3.E4.m1.3.4.3"><minus id="S3.E4.m1.3.4.3.1.cmml" xref="S3.E4.m1.3.4.3.1"></minus><apply id="S3.E4.m1.3.4.3.2.cmml" xref="S3.E4.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.4.3.2.1.cmml" xref="S3.E4.m1.3.4.3.2">subscript</csymbol><apply id="S3.E4.m1.3.4.3.2.2.cmml" xref="S3.E4.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.4.3.2.2.1.cmml" xref="S3.E4.m1.3.4.3.2">superscript</csymbol><apply id="S3.E4.m1.3.4.3.2.2.2.cmml" xref="S3.E4.m1.3.4.3.2.2.2"><ci id="S3.E4.m1.3.4.3.2.2.2.1.cmml" xref="S3.E4.m1.3.4.3.2.2.2.1">^</ci><ci id="S3.E4.m1.3.4.3.2.2.2.2.cmml" xref="S3.E4.m1.3.4.3.2.2.2.2">𝑐</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E4.m1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.4">𝑠</ci><ci id="S3.E4.m1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.5">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.4.3.2.3.cmml" xref="S3.E4.m1.3.4.3.2.3"><times id="S3.E4.m1.3.4.3.2.3.1.cmml" xref="S3.E4.m1.3.4.3.2.3.1"></times><ci id="S3.E4.m1.3.4.3.2.3.2.cmml" xref="S3.E4.m1.3.4.3.2.3.2">𝑖</ci><ci id="S3.E4.m1.3.4.3.2.3.3.cmml" xref="S3.E4.m1.3.4.3.2.3.3">𝑗</ci><ci id="S3.E4.m1.3.4.3.2.3.4.cmml" xref="S3.E4.m1.3.4.3.2.3.4">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.4.3.3.cmml" xref="S3.E4.m1.3.4.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.4.3.3.1.cmml" xref="S3.E4.m1.3.4.3.3">subscript</csymbol><apply id="S3.E4.m1.3.4.3.3.2.cmml" xref="S3.E4.m1.3.4.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.4.3.3.2.1.cmml" xref="S3.E4.m1.3.4.3.3">superscript</csymbol><apply id="S3.E4.m1.3.4.3.3.2.2.cmml" xref="S3.E4.m1.3.4.3.3.2.2"><ci id="S3.E4.m1.3.4.3.3.2.2.1.cmml" xref="S3.E4.m1.3.4.3.3.2.2.1">^</ci><ci id="S3.E4.m1.3.4.3.3.2.2.2.cmml" xref="S3.E4.m1.3.4.3.3.2.2.2">𝑐</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1"><times id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"></times><ci id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2">𝑝</ci><ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">𝑟</ci><ci id="S3.E4.m1.2.2.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.4">𝑒</ci></apply></apply><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><ci id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3">𝑖</ci><ci id="S3.E4.m1.3.3.1.4.cmml" xref="S3.E4.m1.3.3.1.4">𝑗</ci><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><minus id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"></minus><ci id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">𝑡</ci><cn id="S3.E4.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">sales_{ijt}=\hat{c}^{(post)}_{ijt}-\hat{c}^{(pre)}_{ij(t-1)}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_s italic_a italic_l italic_e italic_s start_POSTSUBSCRIPT italic_i italic_j italic_t end_POSTSUBSCRIPT = over^ start_ARG italic_c end_ARG start_POSTSUPERSCRIPT ( italic_p italic_o italic_s italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j italic_t end_POSTSUBSCRIPT - over^ start_ARG italic_c end_ARG start_POSTSUPERSCRIPT ( italic_p italic_r italic_e ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j ( italic_t - 1 ) end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.6">Where <math alttext="\hat{c}^{(post)}_{ijt}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msubsup id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.1.2.2.2" xref="S3.SS1.p4.1.m1.1.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2.2.2" xref="S3.SS1.p4.1.m1.1.2.2.2.2.cmml">c</mi><mo id="S3.SS1.p4.1.m1.1.2.2.2.1" xref="S3.SS1.p4.1.m1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p4.1.m1.1.2.3" xref="S3.SS1.p4.1.m1.1.2.3.cmml"><mi id="S3.SS1.p4.1.m1.1.2.3.2" xref="S3.SS1.p4.1.m1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p4.1.m1.1.2.3.1" xref="S3.SS1.p4.1.m1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.2.3.3" xref="S3.SS1.p4.1.m1.1.2.3.3.cmml">j</mi><mo id="S3.SS1.p4.1.m1.1.2.3.1a" xref="S3.SS1.p4.1.m1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.2.3.4" xref="S3.SS1.p4.1.m1.1.2.3.4.cmml">t</mi></mrow><mrow id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1a" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.4" xref="S3.SS1.p4.1.m1.1.1.1.1.1.4.cmml">s</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1b" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.5" xref="S3.SS1.p4.1.m1.1.1.1.1.1.5.cmml">t</mi></mrow><mo id="S3.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2">subscript</csymbol><apply id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2">superscript</csymbol><apply id="S3.SS1.p4.1.m1.1.2.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2"><ci id="S3.SS1.p4.1.m1.1.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2.1">^</ci><ci id="S3.SS1.p4.1.m1.1.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2.2">𝑐</ci></apply><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1"></times><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3">𝑜</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.4.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.4">𝑠</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.5.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.5">𝑡</ci></apply></apply><apply id="S3.SS1.p4.1.m1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3"><times id="S3.SS1.p4.1.m1.1.2.3.1.cmml" xref="S3.SS1.p4.1.m1.1.2.3.1"></times><ci id="S3.SS1.p4.1.m1.1.2.3.2.cmml" xref="S3.SS1.p4.1.m1.1.2.3.2">𝑖</ci><ci id="S3.SS1.p4.1.m1.1.2.3.3.cmml" xref="S3.SS1.p4.1.m1.1.2.3.3">𝑗</ci><ci id="S3.SS1.p4.1.m1.1.2.3.4.cmml" xref="S3.SS1.p4.1.m1.1.2.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\hat{c}^{(post)}_{ijt}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">over^ start_ARG italic_c end_ARG start_POSTSUPERSCRIPT ( italic_p italic_o italic_s italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, is the post-scan and captures the count estimate for product <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_i</annotation></semantics></math> at display <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_j</annotation></semantics></math> in the current timestamp, <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">italic_t</annotation></semantics></math>. Moreover, <math alttext="\hat{c}^{(pre)}_{ij(t-1)}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.2"><semantics id="S3.SS1.p4.5.m5.2a"><msubsup id="S3.SS1.p4.5.m5.2.3" xref="S3.SS1.p4.5.m5.2.3.cmml"><mover accent="true" id="S3.SS1.p4.5.m5.2.3.2.2" xref="S3.SS1.p4.5.m5.2.3.2.2.cmml"><mi id="S3.SS1.p4.5.m5.2.3.2.2.2" xref="S3.SS1.p4.5.m5.2.3.2.2.2.cmml">c</mi><mo id="S3.SS1.p4.5.m5.2.3.2.2.1" xref="S3.SS1.p4.5.m5.2.3.2.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p4.5.m5.2.2.1" xref="S3.SS1.p4.5.m5.2.2.1.cmml"><mi id="S3.SS1.p4.5.m5.2.2.1.3" xref="S3.SS1.p4.5.m5.2.2.1.3.cmml">i</mi><mo id="S3.SS1.p4.5.m5.2.2.1.2" xref="S3.SS1.p4.5.m5.2.2.1.2.cmml">⁢</mo><mi id="S3.SS1.p4.5.m5.2.2.1.4" xref="S3.SS1.p4.5.m5.2.2.1.4.cmml">j</mi><mo id="S3.SS1.p4.5.m5.2.2.1.2a" xref="S3.SS1.p4.5.m5.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.p4.5.m5.2.2.1.1.1" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.cmml"><mo id="S3.SS1.p4.5.m5.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.5.m5.2.2.1.1.1.1" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p4.5.m5.2.2.1.1.1.1.2" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p4.5.m5.2.2.1.1.1.1.1" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p4.5.m5.2.2.1.1.1.1.3" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p4.5.m5.2.2.1.1.1.3" stretchy="false" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS1.p4.5.m5.1.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS1.p4.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS1.p4.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.5.m5.1.1.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.5.m5.1.1.1.1.1.2" xref="S3.SS1.p4.5.m5.1.1.1.1.1.2.cmml">p</mi><mo id="S3.SS1.p4.5.m5.1.1.1.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.5.m5.1.1.1.1.1.3" xref="S3.SS1.p4.5.m5.1.1.1.1.1.3.cmml">r</mi><mo id="S3.SS1.p4.5.m5.1.1.1.1.1.1a" xref="S3.SS1.p4.5.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.5.m5.1.1.1.1.1.4" xref="S3.SS1.p4.5.m5.1.1.1.1.1.4.cmml">e</mi></mrow><mo id="S3.SS1.p4.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS1.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.2b"><apply id="S3.SS1.p4.5.m5.2.3.cmml" xref="S3.SS1.p4.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.2.3.1.cmml" xref="S3.SS1.p4.5.m5.2.3">subscript</csymbol><apply id="S3.SS1.p4.5.m5.2.3.2.cmml" xref="S3.SS1.p4.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.2.3.2.1.cmml" xref="S3.SS1.p4.5.m5.2.3">superscript</csymbol><apply id="S3.SS1.p4.5.m5.2.3.2.2.cmml" xref="S3.SS1.p4.5.m5.2.3.2.2"><ci id="S3.SS1.p4.5.m5.2.3.2.2.1.cmml" xref="S3.SS1.p4.5.m5.2.3.2.2.1">^</ci><ci id="S3.SS1.p4.5.m5.2.3.2.2.2.cmml" xref="S3.SS1.p4.5.m5.2.3.2.2.2">𝑐</ci></apply><apply id="S3.SS1.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1"><times id="S3.SS1.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.1.1"></times><ci id="S3.SS1.p4.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS1.p4.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.1.3">𝑟</ci><ci id="S3.SS1.p4.5.m5.1.1.1.1.1.4.cmml" xref="S3.SS1.p4.5.m5.1.1.1.1.1.4">𝑒</ci></apply></apply><apply id="S3.SS1.p4.5.m5.2.2.1.cmml" xref="S3.SS1.p4.5.m5.2.2.1"><times id="S3.SS1.p4.5.m5.2.2.1.2.cmml" xref="S3.SS1.p4.5.m5.2.2.1.2"></times><ci id="S3.SS1.p4.5.m5.2.2.1.3.cmml" xref="S3.SS1.p4.5.m5.2.2.1.3">𝑖</ci><ci id="S3.SS1.p4.5.m5.2.2.1.4.cmml" xref="S3.SS1.p4.5.m5.2.2.1.4">𝑗</ci><apply id="S3.SS1.p4.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.2.2.1.1.1"><minus id="S3.SS1.p4.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.1"></minus><ci id="S3.SS1.p4.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.2">𝑡</ci><cn id="S3.SS1.p4.5.m5.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p4.5.m5.2.2.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.2c">\hat{c}^{(pre)}_{ij(t-1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.2d">over^ start_ARG italic_c end_ARG start_POSTSUPERSCRIPT ( italic_p italic_r italic_e ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j ( italic_t - 1 ) end_POSTSUBSCRIPT</annotation></semantics></math> is the prescan in the current visit and captures the remaining inventory at the previous time <math alttext="t-1" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m6.1"><semantics id="S3.SS1.p4.6.m6.1a"><mrow id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml"><mi id="S3.SS1.p4.6.m6.1.1.2" xref="S3.SS1.p4.6.m6.1.1.2.cmml">t</mi><mo id="S3.SS1.p4.6.m6.1.1.1" xref="S3.SS1.p4.6.m6.1.1.1.cmml">−</mo><mn id="S3.SS1.p4.6.m6.1.1.3" xref="S3.SS1.p4.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><apply id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"><minus id="S3.SS1.p4.6.m6.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1.1"></minus><ci id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2">𝑡</ci><cn id="S3.SS1.p4.6.m6.1.1.3.cmml" type="integer" xref="S3.SS1.p4.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m6.1d">italic_t - 1</annotation></semantics></math>. Intuitively, Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.E4" title="Equation 4 ‣ 3.1. 3D Data Collection ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> captures what product has been removed since the previous merchandiser visit. We assume that all missing product has been sold. More details about workflow and deployment can be found in the supplement.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Spatial Clustering</h3>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.4.1.1">Algorithm 1</span> </span> SpAGMM Estimation</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_text ltx_font_bold" id="alg1.l1.1" style="font-size:90%;">Input</span><span class="ltx_text" id="alg1.l1.2" style="font-size:90%;">: Store Coordinates, </span><math alttext="S" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" mathsize="90%" xref="alg1.l1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_S</annotation></semantics></math><span class="ltx_text" id="alg1.l1.3" style="font-size:90%;">; Tract Coordinates, </span><math alttext="C" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" mathsize="90%" xref="alg1.l1.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_C</annotation></semantics></math><span class="ltx_text" id="alg1.l1.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_text ltx_font_bold" id="alg1.l2.1" style="font-size:90%;">Output</span><span class="ltx_text" id="alg1.l2.2" style="font-size:90%;">: </span><math alttext="K" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" mathsize="90%" xref="alg1.l2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg1.l2.3" style="font-size:90%;"> x </span><math alttext="Z" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" mathsize="90%" xref="alg1.l2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_Z</annotation></semantics></math><span class="ltx_text" id="alg1.l2.4" style="font-size:90%;"> Probability Matrix, </span><math alttext="\Pi" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l2.m3.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">roman_Π</annotation></semantics></math><span class="ltx_text" id="alg1.l2.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_text" id="alg1.l3.1" style="font-size:90%;">Initialize Likelihood history, </span><math alttext="H=" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="90%" xref="alg1.l3.m1.1.1.2.cmml">H</mi><mo id="alg1.l3.m1.1.1.1" mathsize="90%" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐻</ci><csymbol cd="latexml" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">H=</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_H =</annotation></semantics></math><span class="ltx_text" id="alg1.l3.2" style="font-size:90%;"> []; Number of Clusters, </span><math alttext="K" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" mathsize="90%" xref="alg1.l3.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg1.l3.3" style="font-size:90%;">; Number of Tracts, </span><math alttext="Z" class="ltx_Math" display="inline" id="alg1.l3.m3.1"><semantics id="alg1.l3.m3.1a"><mi id="alg1.l3.m3.1.1" mathsize="90%" xref="alg1.l3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.1d">italic_Z</annotation></semantics></math><span class="ltx_text" id="alg1.l3.4" style="font-size:90%;">; Weights, </span><math alttext="\pi=\frac{1}{S}I_{S}" class="ltx_Math" display="inline" id="alg1.l3.m4.1"><semantics id="alg1.l3.m4.1a"><mrow id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml"><mi id="alg1.l3.m4.1.1.2" mathsize="90%" xref="alg1.l3.m4.1.1.2.cmml">π</mi><mo id="alg1.l3.m4.1.1.1" mathsize="90%" xref="alg1.l3.m4.1.1.1.cmml">=</mo><mrow id="alg1.l3.m4.1.1.3" xref="alg1.l3.m4.1.1.3.cmml"><mfrac id="alg1.l3.m4.1.1.3.2" xref="alg1.l3.m4.1.1.3.2.cmml"><mn id="alg1.l3.m4.1.1.3.2.2" mathsize="90%" xref="alg1.l3.m4.1.1.3.2.2.cmml">1</mn><mi id="alg1.l3.m4.1.1.3.2.3" mathsize="90%" xref="alg1.l3.m4.1.1.3.2.3.cmml">S</mi></mfrac><mo id="alg1.l3.m4.1.1.3.1" xref="alg1.l3.m4.1.1.3.1.cmml">⁢</mo><msub id="alg1.l3.m4.1.1.3.3" xref="alg1.l3.m4.1.1.3.3.cmml"><mi id="alg1.l3.m4.1.1.3.3.2" mathsize="90%" xref="alg1.l3.m4.1.1.3.3.2.cmml">I</mi><mi id="alg1.l3.m4.1.1.3.3.3" mathsize="90%" xref="alg1.l3.m4.1.1.3.3.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><apply id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1"><eq id="alg1.l3.m4.1.1.1.cmml" xref="alg1.l3.m4.1.1.1"></eq><ci id="alg1.l3.m4.1.1.2.cmml" xref="alg1.l3.m4.1.1.2">𝜋</ci><apply id="alg1.l3.m4.1.1.3.cmml" xref="alg1.l3.m4.1.1.3"><times id="alg1.l3.m4.1.1.3.1.cmml" xref="alg1.l3.m4.1.1.3.1"></times><apply id="alg1.l3.m4.1.1.3.2.cmml" xref="alg1.l3.m4.1.1.3.2"><divide id="alg1.l3.m4.1.1.3.2.1.cmml" xref="alg1.l3.m4.1.1.3.2"></divide><cn id="alg1.l3.m4.1.1.3.2.2.cmml" type="integer" xref="alg1.l3.m4.1.1.3.2.2">1</cn><ci id="alg1.l3.m4.1.1.3.2.3.cmml" xref="alg1.l3.m4.1.1.3.2.3">𝑆</ci></apply><apply id="alg1.l3.m4.1.1.3.3.cmml" xref="alg1.l3.m4.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m4.1.1.3.3.1.cmml" xref="alg1.l3.m4.1.1.3.3">subscript</csymbol><ci id="alg1.l3.m4.1.1.3.3.2.cmml" xref="alg1.l3.m4.1.1.3.3.2">𝐼</ci><ci id="alg1.l3.m4.1.1.3.3.3.cmml" xref="alg1.l3.m4.1.1.3.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">\pi=\frac{1}{S}I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m4.1d">italic_π = divide start_ARG 1 end_ARG start_ARG italic_S end_ARG italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l3.5" style="font-size:90%;">; Covariance Matrix, </span><math alttext="\Sigma" class="ltx_Math" display="inline" id="alg1.l3.m5.1"><semantics id="alg1.l3.m5.1a"><mi id="alg1.l3.m5.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l3.m5.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m5.1b"><ci id="alg1.l3.m5.1.1.cmml" xref="alg1.l3.m5.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m5.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m5.1d">roman_Σ</annotation></semantics></math><span class="ltx_text" id="alg1.l3.6" style="font-size:90%;"> = SPD Matrix; Length of Each Data Vector (a </span><math alttext="\langle" class="ltx_Math" display="inline" id="alg1.l3.m6.1"><semantics id="alg1.l3.m6.1a"><mo id="alg1.l3.m6.1.1" maxsize="90%" minsize="90%" xref="alg1.l3.m6.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.m6.1b"><ci id="alg1.l3.m6.1.1.cmml" xref="alg1.l3.m6.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m6.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m6.1d">⟨</annotation></semantics></math><span class="ltx_text" id="alg1.l3.7" style="font-size:90%;"> lat, long </span><math alttext="\rangle" class="ltx_Math" display="inline" id="alg1.l3.m7.1"><semantics id="alg1.l3.m7.1a"><mo id="alg1.l3.m7.1.1" maxsize="90%" minsize="90%" xref="alg1.l3.m7.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.m7.1b"><ci id="alg1.l3.m7.1.1.cmml" xref="alg1.l3.m7.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m7.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m7.1d">⟩</annotation></semantics></math><span class="ltx_text" id="alg1.l3.8" style="font-size:90%;"> pair), </span><math alttext="D=2" class="ltx_Math" display="inline" id="alg1.l3.m8.1"><semantics id="alg1.l3.m8.1a"><mrow id="alg1.l3.m8.1.1" xref="alg1.l3.m8.1.1.cmml"><mi id="alg1.l3.m8.1.1.2" mathsize="90%" xref="alg1.l3.m8.1.1.2.cmml">D</mi><mo id="alg1.l3.m8.1.1.1" mathsize="90%" xref="alg1.l3.m8.1.1.1.cmml">=</mo><mn id="alg1.l3.m8.1.1.3" mathsize="90%" xref="alg1.l3.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m8.1b"><apply id="alg1.l3.m8.1.1.cmml" xref="alg1.l3.m8.1.1"><eq id="alg1.l3.m8.1.1.1.cmml" xref="alg1.l3.m8.1.1.1"></eq><ci id="alg1.l3.m8.1.1.2.cmml" xref="alg1.l3.m8.1.1.2">𝐷</ci><cn id="alg1.l3.m8.1.1.3.cmml" type="integer" xref="alg1.l3.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m8.1c">D=2</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m8.1d">italic_D = 2</annotation></semantics></math><span class="ltx_text" id="alg1.l3.9" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_text" id="alg1.l4.1" style="font-size:90%;">Normalize </span><math alttext="S" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" mathsize="90%" xref="alg1.l4.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_S</annotation></semantics></math><span class="ltx_text" id="alg1.l4.2" style="font-size:90%;"> to get fixed cluster centers:
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<math alttext="\mu\leftarrow\frac{S-\bar{S}}{\sigma(S)}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" mathsize="90%" xref="alg1.l5.m1.1.2.2.cmml">μ</mi><mo id="alg1.l5.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l5.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" mathsize="90%" xref="alg1.l5.m1.1.1.3.2.cmml">S</mi><mo id="alg1.l5.m1.1.1.3.1" mathsize="90%" xref="alg1.l5.m1.1.1.3.1.cmml">−</mo><mover accent="true" id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml"><mi id="alg1.l5.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l5.m1.1.1.3.3.2.cmml">S</mi><mo id="alg1.l5.m1.1.1.3.3.1" mathsize="90%" xref="alg1.l5.m1.1.1.3.3.1.cmml">¯</mo></mover></mrow><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.1.1.1.3.cmml">σ</mi><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.4.2" xref="alg1.l5.m1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.4.2.1" maxsize="90%" minsize="90%" xref="alg1.l5.m1.1.1.1.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" mathsize="90%" xref="alg1.l5.m1.1.1.1.1.cmml">S</mi><mo id="alg1.l5.m1.1.1.1.4.2.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><ci id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1">←</ci><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝜇</ci><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><divide id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"></divide><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><minus id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.1"></minus><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑆</ci><apply id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3"><ci id="alg1.l5.m1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.1">¯</ci><ci id="alg1.l5.m1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.2">𝑆</ci></apply></apply><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝜎</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mu\leftarrow\frac{S-\bar{S}}{\sigma(S)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_μ ← divide start_ARG italic_S - over¯ start_ARG italic_S end_ARG end_ARG start_ARG italic_σ ( italic_S ) end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l5.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l5.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Fix <math alttext="\mu" class="ltx_Math" display="inline" id="alg1.l5.2.m2.1"><semantics id="alg1.l5.2.m2.1a"><mi id="alg1.l5.2.m2.1.1" xref="alg1.l5.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.2.m2.1b"><ci id="alg1.l5.2.m2.1.1.cmml" xref="alg1.l5.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.2.m2.1d">italic_μ</annotation></semantics></math>. Don’t update during training
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<math alttext="\hat{C}\leftarrow\frac{C-\bar{C}}{\sigma(C)}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mover accent="true" id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml"><mi id="alg1.l6.m1.1.2.2.2" mathsize="90%" xref="alg1.l6.m1.1.2.2.2.cmml">C</mi><mo id="alg1.l6.m1.1.2.2.1" mathsize="90%" xref="alg1.l6.m1.1.2.2.1.cmml">^</mo></mover><mo id="alg1.l6.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" mathsize="90%" xref="alg1.l6.m1.1.1.3.2.cmml">C</mi><mo id="alg1.l6.m1.1.1.3.1" mathsize="90%" xref="alg1.l6.m1.1.1.3.1.cmml">−</mo><mover accent="true" id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l6.m1.1.1.3.3.2.cmml">C</mi><mo id="alg1.l6.m1.1.1.3.3.1" mathsize="90%" xref="alg1.l6.m1.1.1.3.3.1.cmml">¯</mo></mover></mrow><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.3" mathsize="90%" xref="alg1.l6.m1.1.1.1.3.cmml">σ</mi><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.4.2" xref="alg1.l6.m1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.4.2.1" maxsize="90%" minsize="90%" xref="alg1.l6.m1.1.1.1.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1" mathsize="90%" xref="alg1.l6.m1.1.1.1.1.cmml">C</mi><mo id="alg1.l6.m1.1.1.1.4.2.2" maxsize="90%" minsize="90%" xref="alg1.l6.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><apply id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2"><ci id="alg1.l6.m1.1.2.2.1.cmml" xref="alg1.l6.m1.1.2.2.1">^</ci><ci id="alg1.l6.m1.1.2.2.2.cmml" xref="alg1.l6.m1.1.2.2.2">𝐶</ci></apply><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><divide id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1"></divide><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><minus id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.1"></minus><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝐶</ci><apply id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3"><ci id="alg1.l6.m1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.3.3.1">¯</ci><ci id="alg1.l6.m1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.3.3.2">𝐶</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3">𝜎</ci><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\hat{C}\leftarrow\frac{C-\bar{C}}{\sigma(C)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">over^ start_ARG italic_C end_ARG ← divide start_ARG italic_C - over¯ start_ARG italic_C end_ARG end_ARG start_ARG italic_σ ( italic_C ) end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l6.1" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_text ltx_font_bold" id="alg1.l7.4" style="font-size:90%;">while</span><span class="ltx_text" id="alg1.l7.5" style="font-size:90%;"> True </span><span class="ltx_text ltx_font_bold" id="alg1.l7.6" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l7.7" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l7.3" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Estimate the probability that store <math alttext="s" class="ltx_Math" display="inline" id="alg1.l7.2.m2.1"><semantics id="alg1.l7.2.m2.1a"><mi id="alg1.l7.2.m2.1.1" xref="alg1.l7.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.2.m2.1b"><ci id="alg1.l7.2.m2.1.1.cmml" xref="alg1.l7.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.2.m2.1d">italic_s</annotation></semantics></math> belongs to tract <math alttext="t" class="ltx_Math" display="inline" id="alg1.l7.3.m3.1"><semantics id="alg1.l7.3.m3.1a"><mi id="alg1.l7.3.m3.1.1" xref="alg1.l7.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.3.m3.1b"><ci id="alg1.l7.3.m3.1.1.cmml" xref="alg1.l7.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.3.m3.1d">italic_t</annotation></semantics></math>:
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_text" id="alg1.l8.2" style="font-size:90%;">    </span><math alttext="E\sim\mathcal{L}(\hat{C},\mu,\Sigma)" class="ltx_Math" display="inline" id="alg1.l8.m1.3"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.4" xref="alg1.l8.m1.3.4.cmml"><mi id="alg1.l8.m1.3.4.2" mathsize="90%" xref="alg1.l8.m1.3.4.2.cmml">E</mi><mo id="alg1.l8.m1.3.4.1" mathsize="90%" xref="alg1.l8.m1.3.4.1.cmml">∼</mo><mrow id="alg1.l8.m1.3.4.3" xref="alg1.l8.m1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.3.4.3.2" mathsize="90%" xref="alg1.l8.m1.3.4.3.2.cmml">ℒ</mi><mo id="alg1.l8.m1.3.4.3.1" xref="alg1.l8.m1.3.4.3.1.cmml">⁢</mo><mrow id="alg1.l8.m1.3.4.3.3.2" xref="alg1.l8.m1.3.4.3.3.1.cmml"><mo id="alg1.l8.m1.3.4.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l8.m1.3.4.3.3.1.cmml">(</mo><mover accent="true" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" mathsize="90%" xref="alg1.l8.m1.1.1.2.cmml">C</mi><mo id="alg1.l8.m1.1.1.1" mathsize="90%" xref="alg1.l8.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l8.m1.3.4.3.3.2.2" mathsize="90%" xref="alg1.l8.m1.3.4.3.3.1.cmml">,</mo><mi id="alg1.l8.m1.2.2" mathsize="90%" xref="alg1.l8.m1.2.2.cmml">μ</mi><mo id="alg1.l8.m1.3.4.3.3.2.3" mathsize="90%" xref="alg1.l8.m1.3.4.3.3.1.cmml">,</mo><mi id="alg1.l8.m1.3.3" mathsize="90%" mathvariant="normal" xref="alg1.l8.m1.3.3.cmml">Σ</mi><mo id="alg1.l8.m1.3.4.3.3.2.4" maxsize="90%" minsize="90%" xref="alg1.l8.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.4.cmml" xref="alg1.l8.m1.3.4"><csymbol cd="latexml" id="alg1.l8.m1.3.4.1.cmml" xref="alg1.l8.m1.3.4.1">similar-to</csymbol><ci id="alg1.l8.m1.3.4.2.cmml" xref="alg1.l8.m1.3.4.2">𝐸</ci><apply id="alg1.l8.m1.3.4.3.cmml" xref="alg1.l8.m1.3.4.3"><times id="alg1.l8.m1.3.4.3.1.cmml" xref="alg1.l8.m1.3.4.3.1"></times><ci id="alg1.l8.m1.3.4.3.2.cmml" xref="alg1.l8.m1.3.4.3.2">ℒ</ci><vector id="alg1.l8.m1.3.4.3.3.1.cmml" xref="alg1.l8.m1.3.4.3.3.2"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">^</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝐶</ci></apply><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝜇</ci><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">Σ</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">E\sim\mathcal{L}(\hat{C},\mu,\Sigma)</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.3d">italic_E ∼ caligraphic_L ( over^ start_ARG italic_C end_ARG , italic_μ , roman_Σ )</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l8.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> Expectation Step
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_text" id="alg1.l9.2" style="font-size:90%;">    </span><math alttext="lik\leftarrow\Sigma_{t}^{Z}\Sigma_{k}^{K}E_{tk}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" mathsize="90%" xref="alg1.l9.m1.1.1.2.2.cmml">l</mi><mo id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3" mathsize="90%" xref="alg1.l9.m1.1.1.2.3.cmml">i</mi><mo id="alg1.l9.m1.1.1.2.1a" xref="alg1.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.4" mathsize="90%" xref="alg1.l9.m1.1.1.2.4.cmml">k</mi></mrow><mo id="alg1.l9.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mi id="alg1.l9.m1.1.1.3.2.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l9.m1.1.1.3.2.2.2.cmml">Σ</mi><mi id="alg1.l9.m1.1.1.3.2.2.3" mathsize="90%" xref="alg1.l9.m1.1.1.3.2.2.3.cmml">t</mi><mi id="alg1.l9.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l9.m1.1.1.3.2.3.cmml">Z</mi></msubsup><mo id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l9.m1.1.1.3.3.2.2.cmml">Σ</mi><mi id="alg1.l9.m1.1.1.3.3.2.3" mathsize="90%" xref="alg1.l9.m1.1.1.3.3.2.3.cmml">k</mi><mi id="alg1.l9.m1.1.1.3.3.3" mathsize="90%" xref="alg1.l9.m1.1.1.3.3.3.cmml">K</mi></msubsup><mo id="alg1.l9.m1.1.1.3.1a" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l9.m1.1.1.3.4" xref="alg1.l9.m1.1.1.3.4.cmml"><mi id="alg1.l9.m1.1.1.3.4.2" mathsize="90%" xref="alg1.l9.m1.1.1.3.4.2.cmml">E</mi><mrow id="alg1.l9.m1.1.1.3.4.3" xref="alg1.l9.m1.1.1.3.4.3.cmml"><mi id="alg1.l9.m1.1.1.3.4.3.2" mathsize="90%" xref="alg1.l9.m1.1.1.3.4.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.4.3.1" xref="alg1.l9.m1.1.1.3.4.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.4.3.3" mathsize="90%" xref="alg1.l9.m1.1.1.3.4.3.3.cmml">k</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑙</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑖</ci><ci id="alg1.l9.m1.1.1.2.4.cmml" xref="alg1.l9.m1.1.1.2.4">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><times id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></times><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">Σ</ci><ci id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3">𝑍</ci></apply><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.3.2.2">Σ</ci><ci id="alg1.l9.m1.1.1.3.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.3.2.3">𝑘</ci></apply><ci id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3">𝐾</ci></apply><apply id="alg1.l9.m1.1.1.3.4.cmml" xref="alg1.l9.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.4.1.cmml" xref="alg1.l9.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.4.2.cmml" xref="alg1.l9.m1.1.1.3.4.2">𝐸</ci><apply id="alg1.l9.m1.1.1.3.4.3.cmml" xref="alg1.l9.m1.1.1.3.4.3"><times id="alg1.l9.m1.1.1.3.4.3.1.cmml" xref="alg1.l9.m1.1.1.3.4.3.1"></times><ci id="alg1.l9.m1.1.1.3.4.3.2.cmml" xref="alg1.l9.m1.1.1.3.4.3.2">𝑡</ci><ci id="alg1.l9.m1.1.1.3.4.3.3.cmml" xref="alg1.l9.m1.1.1.3.4.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">lik\leftarrow\Sigma_{t}^{Z}\Sigma_{k}^{K}E_{tk}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_l italic_i italic_k ← roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Z end_POSTSUPERSCRIPT roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_E start_POSTSUBSCRIPT italic_t italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l9.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l9.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> Get sum of likelihood at step for convergence test
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_text" id="alg1.l10.1" style="font-size:90%;">    </span><math alttext="H.push(lik)" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2.1" xref="alg1.l10.m1.2.2.2.cmml"><mi id="alg1.l10.m1.1.1" mathsize="90%" xref="alg1.l10.m1.1.1.cmml">H</mi><mo id="alg1.l10.m1.2.2.1.2" lspace="0em" mathsize="90%" rspace="0.167em" xref="alg1.l10.m1.2.2.2a.cmml">.</mo><mrow id="alg1.l10.m1.2.2.1.1" xref="alg1.l10.m1.2.2.1.1.cmml"><mi id="alg1.l10.m1.2.2.1.1.3" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.3.cmml">p</mi><mo id="alg1.l10.m1.2.2.1.1.2" xref="alg1.l10.m1.2.2.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.1.1.4" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.4.cmml">u</mi><mo id="alg1.l10.m1.2.2.1.1.2a" xref="alg1.l10.m1.2.2.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.1.1.5" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.5.cmml">s</mi><mo id="alg1.l10.m1.2.2.1.1.2b" xref="alg1.l10.m1.2.2.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.1.1.6" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.6.cmml">h</mi><mo id="alg1.l10.m1.2.2.1.1.2c" xref="alg1.l10.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.2.2.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.2" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.1.1.1.2.cmml">l</mi><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.1.1.1.1.1.3" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.1.1.1.3.cmml">i</mi><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1a" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.1.1.1.1.1.4" mathsize="90%" xref="alg1.l10.m1.2.2.1.1.1.1.1.4.cmml">k</mi></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2a.cmml" xref="alg1.l10.m1.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝐻</ci><apply id="alg1.l10.m1.2.2.1.1.cmml" xref="alg1.l10.m1.2.2.1.1"><times id="alg1.l10.m1.2.2.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.2"></times><ci id="alg1.l10.m1.2.2.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.3">𝑝</ci><ci id="alg1.l10.m1.2.2.1.1.4.cmml" xref="alg1.l10.m1.2.2.1.1.4">𝑢</ci><ci id="alg1.l10.m1.2.2.1.1.5.cmml" xref="alg1.l10.m1.2.2.1.1.5">𝑠</ci><ci id="alg1.l10.m1.2.2.1.1.6.cmml" xref="alg1.l10.m1.2.2.1.1.6">ℎ</ci><apply id="alg1.l10.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1"><times id="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1"></times><ci id="alg1.l10.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.2">𝑙</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.3">𝑖</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.4.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.4">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">H.push(lik)</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">italic_H . italic_p italic_u italic_s italic_h ( italic_l italic_i italic_k )</annotation></semantics></math><span class="ltx_text" id="alg1.l10.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_text" id="alg1.l11.1" style="font-size:90%;">    </span><math alttext="\Pi\leftarrow" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" mathsize="90%" mathvariant="normal" xref="alg1.l11.m1.1.1.2.cmml">Π</mi><mo id="alg1.l11.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">Π</ci><csymbol cd="latexml" id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\Pi\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">roman_Π ←</annotation></semantics></math><span class="ltx_text" id="alg1.l11.2" style="font-size:90%;"> (</span><math alttext="K\times Z" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" mathsize="90%" xref="alg1.l11.m2.1.1.2.cmml">K</mi><mo id="alg1.l11.m2.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l11.m2.1.1.1.cmml">×</mo><mi id="alg1.l11.m2.1.1.3" mathsize="90%" xref="alg1.l11.m2.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><times id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1"></times><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝐾</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">K\times Z</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_K × italic_Z</annotation></semantics></math><span class="ltx_text" id="alg1.l11.3" style="font-size:90%;">) Array
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_text" id="alg1.l12.3" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l12.4" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l12.5" style="font-size:90%;"> </span><math alttext="k\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" mathsize="90%" xref="alg1.l12.m1.1.1.2.cmml">k</mi><mo id="alg1.l12.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mn id="alg1.l12.m1.1.1.3" mathsize="90%" xref="alg1.l12.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑘</ci><cn id="alg1.l12.m1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">k\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_k ← 0</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="alg1.l12.1" style="font-size:90%;"> : <math alttext="K" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mi id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">italic_K</annotation></semantics></math></span><span class="ltx_text" id="alg1.l12.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l12.7" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l12.8" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l12.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.2.m1.1"><semantics id="alg1.l12.2.m1.1a"><mo id="alg1.l12.2.m1.1.1" xref="alg1.l12.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.2.m1.1b"><ci id="alg1.l12.2.m1.1.1.cmml" xref="alg1.l12.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.2.m1.1d">▷</annotation></semantics></math> Maximization Step
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_text" id="alg1.l13.3" style="font-size:90%;">         </span><math alttext="\Pi_{k}\leftarrow\frac{E_{k}*{\pi}_{k}}{\Sigma_{k}^{K}(E_{k}*\pi_{k})+\epsilon}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.2" xref="alg1.l13.m1.1.2.cmml"><msub id="alg1.l13.m1.1.2.2" xref="alg1.l13.m1.1.2.2.cmml"><mi id="alg1.l13.m1.1.2.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l13.m1.1.2.2.2.cmml">Π</mi><mi id="alg1.l13.m1.1.2.2.3" mathsize="90%" xref="alg1.l13.m1.1.2.2.3.cmml">k</mi></msub><mo id="alg1.l13.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l13.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><msub id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l13.m1.1.1.3.2.2.cmml">E</mi><mi id="alg1.l13.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l13.m1.1.1.3.2.3.cmml">k</mi></msub><mo id="alg1.l13.m1.1.1.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l13.m1.1.1.3.1.cmml">∗</mo><msub id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml"><mi id="alg1.l13.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l13.m1.1.1.3.3.2.cmml">π</mi><mi id="alg1.l13.m1.1.1.3.3.3" mathsize="90%" xref="alg1.l13.m1.1.1.3.3.3.cmml">k</mi></msub></mrow><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml"><msubsup id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.3.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l13.m1.1.1.1.1.3.2.2.cmml">Σ</mi><mi id="alg1.l13.m1.1.1.1.1.3.2.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.3.2.3.cmml">k</mi><mi id="alg1.l13.m1.1.1.1.1.3.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.3.3.cmml">K</mi></msubsup><mo id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l13.m1.1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="alg1.l13.m1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l13.m1.1.1.1.1.1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="alg1.l13.m1.1.1.1.1.1.1.1.1.cmml">∗</mo><msub id="alg1.l13.m1.1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="alg1.l13.m1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="alg1.l13.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m1.1.1.1.2" mathsize="90%" xref="alg1.l13.m1.1.1.1.2.cmml">+</mo><mi id="alg1.l13.m1.1.1.1.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.3.cmml">ϵ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.2.cmml" xref="alg1.l13.m1.1.2"><ci id="alg1.l13.m1.1.2.1.cmml" xref="alg1.l13.m1.1.2.1">←</ci><apply id="alg1.l13.m1.1.2.2.cmml" xref="alg1.l13.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.2.2.1.cmml" xref="alg1.l13.m1.1.2.2">subscript</csymbol><ci id="alg1.l13.m1.1.2.2.2.cmml" xref="alg1.l13.m1.1.2.2.2">Π</ci><ci id="alg1.l13.m1.1.2.2.3.cmml" xref="alg1.l13.m1.1.2.2.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><divide id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1"></divide><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><times id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></times><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝐸</ci><ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.2">𝜋</ci><ci id="alg1.l13.m1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><plus id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></plus><apply id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><times id="alg1.l13.m1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.2"></times><apply id="alg1.l13.m1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.2.2">Σ</ci><ci id="alg1.l13.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="alg1.l13.m1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3">𝐾</ci></apply><apply id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"><times id="alg1.l13.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.1"></times><apply id="alg1.l13.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><ci id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\Pi_{k}\leftarrow\frac{E_{k}*{\pi}_{k}}{\Sigma_{k}^{K}(E_{k}*\pi_{k})+\epsilon}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">roman_Π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∗ italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∗ italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) + italic_ϵ end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l13.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l13.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Get weighted probability of store <math alttext="s" class="ltx_Math" display="inline" id="alg1.l13.2.m2.1"><semantics id="alg1.l13.2.m2.1a"><mi id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><ci id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.2.m2.1d">italic_s</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_text" id="alg1.l14.5" style="font-size:90%;">         </span><math alttext="\pi_{k}\leftarrow\bar{\Pi_{k}}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" mathsize="90%" xref="alg1.l14.m1.1.1.2.2.cmml">π</mi><mi id="alg1.l14.m1.1.1.2.3" mathsize="90%" xref="alg1.l14.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l14.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mover accent="true" id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><msub id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><mi id="alg1.l14.m1.1.1.3.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l14.m1.1.1.3.2.2.cmml">Π</mi><mi id="alg1.l14.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l14.m1.1.1.3.2.3.cmml">k</mi></msub><mo id="alg1.l14.m1.1.1.3.1" mathsize="90%" xref="alg1.l14.m1.1.1.3.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝜋</ci><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><ci id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1">¯</ci><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">Π</ci><ci id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\pi_{k}\leftarrow\bar{\Pi_{k}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← over¯ start_ARG roman_Π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l14.6" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l14.4" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">▷</annotation></semantics></math> Update parameters <math alttext="\pi" class="ltx_Math" display="inline" id="alg1.l14.2.m2.1"><semantics id="alg1.l14.2.m2.1a"><mi id="alg1.l14.2.m2.1.1" xref="alg1.l14.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.2.m2.1b"><ci id="alg1.l14.2.m2.1.1.cmml" xref="alg1.l14.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.2.m2.1d">italic_π</annotation></semantics></math> and <math alttext="\Sigma" class="ltx_Math" display="inline" id="alg1.l14.3.m3.1"><semantics id="alg1.l14.3.m3.1a"><mi id="alg1.l14.3.m3.1.1" mathvariant="normal" xref="alg1.l14.3.m3.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.3.m3.1b"><ci id="alg1.l14.3.m3.1.1.cmml" xref="alg1.l14.3.m3.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.3.m3.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.3.m3.1d">roman_Σ</annotation></semantics></math> that maximize <math alttext="E" class="ltx_Math" display="inline" id="alg1.l14.4.m4.1"><semantics id="alg1.l14.4.m4.1a"><mi id="alg1.l14.4.m4.1.1" xref="alg1.l14.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.4.m4.1b"><ci id="alg1.l14.4.m4.1.1.cmml" xref="alg1.l14.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.4.m4.1d">italic_E</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_text" id="alg1.l15.1" style="font-size:90%;">         Update </span><math alttext="\Sigma" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l15.m1.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">roman_Σ</annotation></semantics></math><span class="ltx_text" id="alg1.l15.2" style="font-size:90%;"> using MAP estimation to handle CVP:
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_text" id="alg1.l16.1" style="font-size:90%;">         </span><math alttext="Y_{0}\leftarrow\frac{1}{S^{1/D}}I_{D}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml"><mi id="alg1.l16.m1.1.1.2.2" mathsize="90%" xref="alg1.l16.m1.1.1.2.2.cmml">Y</mi><mn id="alg1.l16.m1.1.1.2.3" mathsize="90%" xref="alg1.l16.m1.1.1.2.3.cmml">0</mn></msub><mo id="alg1.l16.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mfrac id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml"><mn id="alg1.l16.m1.1.1.3.2.2" mathsize="90%" xref="alg1.l16.m1.1.1.3.2.2.cmml">1</mn><msup id="alg1.l16.m1.1.1.3.2.3" xref="alg1.l16.m1.1.1.3.2.3.cmml"><mi id="alg1.l16.m1.1.1.3.2.3.2" mathsize="90%" xref="alg1.l16.m1.1.1.3.2.3.2.cmml">S</mi><mrow id="alg1.l16.m1.1.1.3.2.3.3" xref="alg1.l16.m1.1.1.3.2.3.3.cmml"><mn id="alg1.l16.m1.1.1.3.2.3.3.2" mathsize="90%" xref="alg1.l16.m1.1.1.3.2.3.3.2.cmml">1</mn><mo id="alg1.l16.m1.1.1.3.2.3.3.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg1.l16.m1.1.1.3.2.3.3.1.cmml">/</mo><mi id="alg1.l16.m1.1.1.3.2.3.3.3" mathsize="90%" xref="alg1.l16.m1.1.1.3.2.3.3.3.cmml">D</mi></mrow></msup></mfrac><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l16.m1.1.1.3.3.2.cmml">I</mi><mi id="alg1.l16.m1.1.1.3.3.3" mathsize="90%" xref="alg1.l16.m1.1.1.3.3.3.cmml">D</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><apply id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.2.2">𝑌</ci><cn id="alg1.l16.m1.1.1.2.3.cmml" type="integer" xref="alg1.l16.m1.1.1.2.3">0</cn></apply><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><times id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></times><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2"><divide id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3.2"></divide><cn id="alg1.l16.m1.1.1.3.2.2.cmml" type="integer" xref="alg1.l16.m1.1.1.3.2.2">1</cn><apply id="alg1.l16.m1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.2.3.1.cmml" xref="alg1.l16.m1.1.1.3.2.3">superscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.3.2.cmml" xref="alg1.l16.m1.1.1.3.2.3.2">𝑆</ci><apply id="alg1.l16.m1.1.1.3.2.3.3.cmml" xref="alg1.l16.m1.1.1.3.2.3.3"><divide id="alg1.l16.m1.1.1.3.2.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.2.3.3.1"></divide><cn id="alg1.l16.m1.1.1.3.2.3.3.2.cmml" type="integer" xref="alg1.l16.m1.1.1.3.2.3.3.2">1</cn><ci id="alg1.l16.m1.1.1.3.2.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.2.3.3.3">𝐷</ci></apply></apply></apply><apply id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.2">𝐼</ci><ci id="alg1.l16.m1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">Y_{0}\leftarrow\frac{1}{S^{1/D}}I_{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_Y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← divide start_ARG 1 end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 1 / italic_D end_POSTSUPERSCRIPT end_ARG italic_I start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l16.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_text" id="alg1.l17.1" style="font-size:90%;">         </span><math alttext="Y_{k}\leftarrow\Sigma_{t}^{Z}\Pi_{tk}(\hat{C_{t}}-S_{k})(\hat{C_{z}}-S_{k})^{T}" class="ltx_Math" display="inline" id="alg1.l17.m1.2"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><msub id="alg1.l17.m1.2.2.4" xref="alg1.l17.m1.2.2.4.cmml"><mi id="alg1.l17.m1.2.2.4.2" mathsize="90%" xref="alg1.l17.m1.2.2.4.2.cmml">Y</mi><mi id="alg1.l17.m1.2.2.4.3" mathsize="90%" xref="alg1.l17.m1.2.2.4.3.cmml">k</mi></msub><mo id="alg1.l17.m1.2.2.3" mathsize="90%" stretchy="false" xref="alg1.l17.m1.2.2.3.cmml">←</mo><mrow id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.2.cmml"><msubsup id="alg1.l17.m1.2.2.2.4" xref="alg1.l17.m1.2.2.2.4.cmml"><mi id="alg1.l17.m1.2.2.2.4.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l17.m1.2.2.2.4.2.2.cmml">Σ</mi><mi id="alg1.l17.m1.2.2.2.4.2.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.4.2.3.cmml">t</mi><mi id="alg1.l17.m1.2.2.2.4.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.4.3.cmml">Z</mi></msubsup><mo id="alg1.l17.m1.2.2.2.3" xref="alg1.l17.m1.2.2.2.3.cmml">⁢</mo><msub id="alg1.l17.m1.2.2.2.5" xref="alg1.l17.m1.2.2.2.5.cmml"><mi id="alg1.l17.m1.2.2.2.5.2" mathsize="90%" mathvariant="normal" xref="alg1.l17.m1.2.2.2.5.2.cmml">Π</mi><mrow id="alg1.l17.m1.2.2.2.5.3" xref="alg1.l17.m1.2.2.2.5.3.cmml"><mi id="alg1.l17.m1.2.2.2.5.3.2" mathsize="90%" xref="alg1.l17.m1.2.2.2.5.3.2.cmml">t</mi><mo id="alg1.l17.m1.2.2.2.5.3.1" xref="alg1.l17.m1.2.2.2.5.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.5.3.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.5.3.3.cmml">k</mi></mrow></msub><mo id="alg1.l17.m1.2.2.2.3a" xref="alg1.l17.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l17.m1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.cmml"><msub id="alg1.l17.m1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="alg1.l17.m1.1.1.1.1.1.1.2.1" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l17.m1.1.1.1.1.1.1.1" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l17.m1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.3.2" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="alg1.l17.m1.1.1.1.1.1.1.3.3" mathsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="alg1.l17.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l17.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l17.m1.2.2.2.3b" xref="alg1.l17.m1.2.2.2.3.cmml">⁢</mo><msup id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.cmml"><mrow id="alg1.l17.m1.2.2.2.2.1.1" xref="alg1.l17.m1.2.2.2.2.1.1.1.cmml"><mo id="alg1.l17.m1.2.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.2.2.2.2.1.1.1" xref="alg1.l17.m1.2.2.2.2.1.1.1.cmml"><mover accent="true" id="alg1.l17.m1.2.2.2.2.1.1.1.2" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.cmml"><msub id="alg1.l17.m1.2.2.2.2.1.1.1.2.2" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2.cmml"><mi id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.2" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2.2.cmml">C</mi><mi id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2.3.cmml">z</mi></msub><mo id="alg1.l17.m1.2.2.2.2.1.1.1.2.1" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l17.m1.2.2.2.2.1.1.1.1" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="alg1.l17.m1.2.2.2.2.1.1.1.3" xref="alg1.l17.m1.2.2.2.2.1.1.1.3.cmml"><mi id="alg1.l17.m1.2.2.2.2.1.1.1.3.2" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.3.2.cmml">S</mi><mi id="alg1.l17.m1.2.2.2.2.1.1.1.3.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="alg1.l17.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l17.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="alg1.l17.m1.2.2.2.2.3" mathsize="90%" xref="alg1.l17.m1.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><ci id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.3">←</ci><apply id="alg1.l17.m1.2.2.4.cmml" xref="alg1.l17.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.4.1.cmml" xref="alg1.l17.m1.2.2.4">subscript</csymbol><ci id="alg1.l17.m1.2.2.4.2.cmml" xref="alg1.l17.m1.2.2.4.2">𝑌</ci><ci id="alg1.l17.m1.2.2.4.3.cmml" xref="alg1.l17.m1.2.2.4.3">𝑘</ci></apply><apply id="alg1.l17.m1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2"><times id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.3"></times><apply id="alg1.l17.m1.2.2.2.4.cmml" xref="alg1.l17.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.4.1.cmml" xref="alg1.l17.m1.2.2.2.4">superscript</csymbol><apply id="alg1.l17.m1.2.2.2.4.2.cmml" xref="alg1.l17.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.4.2.1.cmml" xref="alg1.l17.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.4.2.2.cmml" xref="alg1.l17.m1.2.2.2.4.2.2">Σ</ci><ci id="alg1.l17.m1.2.2.2.4.2.3.cmml" xref="alg1.l17.m1.2.2.2.4.2.3">𝑡</ci></apply><ci id="alg1.l17.m1.2.2.2.4.3.cmml" xref="alg1.l17.m1.2.2.2.4.3">𝑍</ci></apply><apply id="alg1.l17.m1.2.2.2.5.cmml" xref="alg1.l17.m1.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.5.1.cmml" xref="alg1.l17.m1.2.2.2.5">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.5.2.cmml" xref="alg1.l17.m1.2.2.2.5.2">Π</ci><apply id="alg1.l17.m1.2.2.2.5.3.cmml" xref="alg1.l17.m1.2.2.2.5.3"><times id="alg1.l17.m1.2.2.2.5.3.1.cmml" xref="alg1.l17.m1.2.2.2.5.3.1"></times><ci id="alg1.l17.m1.2.2.2.5.3.2.cmml" xref="alg1.l17.m1.2.2.2.5.3.2">𝑡</ci><ci id="alg1.l17.m1.2.2.2.5.3.3.cmml" xref="alg1.l17.m1.2.2.2.5.3.3">𝑘</ci></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"><minus id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"></minus><apply id="alg1.l17.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2"><ci id="alg1.l17.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.1">^</ci><apply id="alg1.l17.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.2">𝐶</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l17.m1.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l17.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1"><minus id="alg1.l17.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.1"></minus><apply id="alg1.l17.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2"><ci id="alg1.l17.m1.2.2.2.2.1.1.1.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.1">^</ci><apply id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2.2">𝐶</ci><ci id="alg1.l17.m1.2.2.2.2.1.1.1.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.2.2.3">𝑧</ci></apply></apply><apply id="alg1.l17.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.1.1.1.3.1.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.1.1.1.3.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.3.2">𝑆</ci><ci id="alg1.l17.m1.2.2.2.2.1.1.1.3.3.cmml" xref="alg1.l17.m1.2.2.2.2.1.1.1.3.3">𝑘</ci></apply></apply><ci id="alg1.l17.m1.2.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">Y_{k}\leftarrow\Sigma_{t}^{Z}\Pi_{tk}(\hat{C_{t}}-S_{k})(\hat{C_{z}}-S_{k})^{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.2d">italic_Y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Z end_POSTSUPERSCRIPT roman_Π start_POSTSUBSCRIPT italic_t italic_k end_POSTSUBSCRIPT ( over^ start_ARG italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG - italic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ( over^ start_ARG italic_C start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_ARG - italic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l17.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_text" id="alg1.l18.1" style="font-size:90%;">         </span><math alttext="r_{k}\leftarrow\Sigma_{t}\Pi_{tk}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msub id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2" mathsize="90%" xref="alg1.l18.m1.1.1.2.2.cmml">r</mi><mi id="alg1.l18.m1.1.1.2.3" mathsize="90%" xref="alg1.l18.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l18.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l18.m1.1.1.1.cmml">←</mo><mrow id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><msub id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml"><mi id="alg1.l18.m1.1.1.3.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l18.m1.1.1.3.2.2.cmml">Σ</mi><mi id="alg1.l18.m1.1.1.3.2.3" mathsize="90%" xref="alg1.l18.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg1.l18.m1.1.1.3.1" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.2" mathsize="90%" mathvariant="normal" xref="alg1.l18.m1.1.1.3.3.2.cmml">Π</mi><mrow id="alg1.l18.m1.1.1.3.3.3" xref="alg1.l18.m1.1.1.3.3.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.3.2" mathsize="90%" xref="alg1.l18.m1.1.1.3.3.3.2.cmml">t</mi><mo id="alg1.l18.m1.1.1.3.3.3.1" xref="alg1.l18.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3.3" mathsize="90%" xref="alg1.l18.m1.1.1.3.3.3.3.cmml">k</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><ci id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1">←</ci><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝑟</ci><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><times id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3.1"></times><apply id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.2.2">Σ</ci><ci id="alg1.l18.m1.1.1.3.2.3.cmml" xref="alg1.l18.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.2">Π</ci><apply id="alg1.l18.m1.1.1.3.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3"><times id="alg1.l18.m1.1.1.3.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.1"></times><ci id="alg1.l18.m1.1.1.3.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.2">𝑡</ci><ci id="alg1.l18.m1.1.1.3.3.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">r_{k}\leftarrow\Sigma_{t}\Pi_{tk}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT roman_Π start_POSTSUBSCRIPT italic_t italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l18.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_text" id="alg1.l19.1" style="font-size:90%;">         </span><math alttext="\Sigma_{k}\leftarrow\frac{Y_{0}+Y_{k}}{r_{k}+2D+4}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><msub id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l19.m1.1.1.2.2.cmml">Σ</mi><mi id="alg1.l19.m1.1.1.2.3" mathsize="90%" xref="alg1.l19.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l19.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l19.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><mrow id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2.cmml"><msub id="alg1.l19.m1.1.1.3.2.2" xref="alg1.l19.m1.1.1.3.2.2.cmml"><mi id="alg1.l19.m1.1.1.3.2.2.2" mathsize="90%" xref="alg1.l19.m1.1.1.3.2.2.2.cmml">Y</mi><mn id="alg1.l19.m1.1.1.3.2.2.3" mathsize="90%" xref="alg1.l19.m1.1.1.3.2.2.3.cmml">0</mn></msub><mo id="alg1.l19.m1.1.1.3.2.1" mathsize="90%" xref="alg1.l19.m1.1.1.3.2.1.cmml">+</mo><msub id="alg1.l19.m1.1.1.3.2.3" xref="alg1.l19.m1.1.1.3.2.3.cmml"><mi id="alg1.l19.m1.1.1.3.2.3.2" mathsize="90%" xref="alg1.l19.m1.1.1.3.2.3.2.cmml">Y</mi><mi id="alg1.l19.m1.1.1.3.2.3.3" mathsize="90%" xref="alg1.l19.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow><mrow id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml"><msub id="alg1.l19.m1.1.1.3.3.2" xref="alg1.l19.m1.1.1.3.3.2.cmml"><mi id="alg1.l19.m1.1.1.3.3.2.2" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.2.2.cmml">r</mi><mi id="alg1.l19.m1.1.1.3.3.2.3" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.2.3.cmml">k</mi></msub><mo id="alg1.l19.m1.1.1.3.3.1" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.1.cmml">+</mo><mrow id="alg1.l19.m1.1.1.3.3.3" xref="alg1.l19.m1.1.1.3.3.3.cmml"><mn id="alg1.l19.m1.1.1.3.3.3.2" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.3.2.cmml">2</mn><mo id="alg1.l19.m1.1.1.3.3.3.1" xref="alg1.l19.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l19.m1.1.1.3.3.3.3" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.3.3.cmml">D</mi></mrow><mo id="alg1.l19.m1.1.1.3.3.1a" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l19.m1.1.1.3.3.4" mathsize="90%" xref="alg1.l19.m1.1.1.3.3.4.cmml">4</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">←</ci><apply id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.2.2">Σ</ci><ci id="alg1.l19.m1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><divide id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3"></divide><apply id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2"><plus id="alg1.l19.m1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.2.1"></plus><apply id="alg1.l19.m1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.2.2.1.cmml" xref="alg1.l19.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.2.2.cmml" xref="alg1.l19.m1.1.1.3.2.2.2">𝑌</ci><cn id="alg1.l19.m1.1.1.3.2.2.3.cmml" type="integer" xref="alg1.l19.m1.1.1.3.2.2.3">0</cn></apply><apply id="alg1.l19.m1.1.1.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.2.3.1.cmml" xref="alg1.l19.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.3.2.cmml" xref="alg1.l19.m1.1.1.3.2.3.2">𝑌</ci><ci id="alg1.l19.m1.1.1.3.2.3.3.cmml" xref="alg1.l19.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3"><plus id="alg1.l19.m1.1.1.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.1"></plus><apply id="alg1.l19.m1.1.1.3.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.3.2.2">𝑟</ci><ci id="alg1.l19.m1.1.1.3.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.3.2.3">𝑘</ci></apply><apply id="alg1.l19.m1.1.1.3.3.3.cmml" xref="alg1.l19.m1.1.1.3.3.3"><times id="alg1.l19.m1.1.1.3.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.1"></times><cn id="alg1.l19.m1.1.1.3.3.3.2.cmml" type="integer" xref="alg1.l19.m1.1.1.3.3.3.2">2</cn><ci id="alg1.l19.m1.1.1.3.3.3.3.cmml" xref="alg1.l19.m1.1.1.3.3.3.3">𝐷</ci></apply><cn id="alg1.l19.m1.1.1.3.3.4.cmml" type="integer" xref="alg1.l19.m1.1.1.3.3.4">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\Sigma_{k}\leftarrow\frac{Y_{0}+Y_{k}}{r_{k}+2D+4}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG italic_Y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_Y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + 2 italic_D + 4 end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.l19.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_text" id="alg1.l20.1" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l20.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l20.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l20.4" style="font-size:90%;">for</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_text" id="alg1.l21.1" style="font-size:90%;">    converged </span><math alttext="\leftarrow length(H)&gt;2" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.2" xref="alg1.l21.m1.1.2.cmml"><mi id="alg1.l21.m1.1.2.2" xref="alg1.l21.m1.1.2.2.cmml"></mi><mo id="alg1.l21.m1.1.2.3" mathsize="90%" stretchy="false" xref="alg1.l21.m1.1.2.3.cmml">←</mo><mrow id="alg1.l21.m1.1.2.4" xref="alg1.l21.m1.1.2.4.cmml"><mi id="alg1.l21.m1.1.2.4.2" mathsize="90%" xref="alg1.l21.m1.1.2.4.2.cmml">l</mi><mo id="alg1.l21.m1.1.2.4.1" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.2.4.3" mathsize="90%" xref="alg1.l21.m1.1.2.4.3.cmml">e</mi><mo id="alg1.l21.m1.1.2.4.1a" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.2.4.4" mathsize="90%" xref="alg1.l21.m1.1.2.4.4.cmml">n</mi><mo id="alg1.l21.m1.1.2.4.1b" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.2.4.5" mathsize="90%" xref="alg1.l21.m1.1.2.4.5.cmml">g</mi><mo id="alg1.l21.m1.1.2.4.1c" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.2.4.6" mathsize="90%" xref="alg1.l21.m1.1.2.4.6.cmml">t</mi><mo id="alg1.l21.m1.1.2.4.1d" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.2.4.7" mathsize="90%" xref="alg1.l21.m1.1.2.4.7.cmml">h</mi><mo id="alg1.l21.m1.1.2.4.1e" xref="alg1.l21.m1.1.2.4.1.cmml">⁢</mo><mrow id="alg1.l21.m1.1.2.4.8.2" xref="alg1.l21.m1.1.2.4.cmml"><mo id="alg1.l21.m1.1.2.4.8.2.1" maxsize="90%" minsize="90%" xref="alg1.l21.m1.1.2.4.cmml">(</mo><mi id="alg1.l21.m1.1.1" mathsize="90%" xref="alg1.l21.m1.1.1.cmml">H</mi><mo id="alg1.l21.m1.1.2.4.8.2.2" maxsize="90%" minsize="90%" xref="alg1.l21.m1.1.2.4.cmml">)</mo></mrow></mrow><mo id="alg1.l21.m1.1.2.5" mathsize="90%" xref="alg1.l21.m1.1.2.5.cmml">&gt;</mo><mn id="alg1.l21.m1.1.2.6" mathsize="90%" xref="alg1.l21.m1.1.2.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.2.cmml" xref="alg1.l21.m1.1.2"><and id="alg1.l21.m1.1.2a.cmml" xref="alg1.l21.m1.1.2"></and><apply id="alg1.l21.m1.1.2b.cmml" xref="alg1.l21.m1.1.2"><ci id="alg1.l21.m1.1.2.3.cmml" xref="alg1.l21.m1.1.2.3">←</ci><csymbol cd="latexml" id="alg1.l21.m1.1.2.2.cmml" xref="alg1.l21.m1.1.2.2">absent</csymbol><apply id="alg1.l21.m1.1.2.4.cmml" xref="alg1.l21.m1.1.2.4"><times id="alg1.l21.m1.1.2.4.1.cmml" xref="alg1.l21.m1.1.2.4.1"></times><ci id="alg1.l21.m1.1.2.4.2.cmml" xref="alg1.l21.m1.1.2.4.2">𝑙</ci><ci id="alg1.l21.m1.1.2.4.3.cmml" xref="alg1.l21.m1.1.2.4.3">𝑒</ci><ci id="alg1.l21.m1.1.2.4.4.cmml" xref="alg1.l21.m1.1.2.4.4">𝑛</ci><ci id="alg1.l21.m1.1.2.4.5.cmml" xref="alg1.l21.m1.1.2.4.5">𝑔</ci><ci id="alg1.l21.m1.1.2.4.6.cmml" xref="alg1.l21.m1.1.2.4.6">𝑡</ci><ci id="alg1.l21.m1.1.2.4.7.cmml" xref="alg1.l21.m1.1.2.4.7">ℎ</ci><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">𝐻</ci></apply></apply><apply id="alg1.l21.m1.1.2c.cmml" xref="alg1.l21.m1.1.2"><gt id="alg1.l21.m1.1.2.5.cmml" xref="alg1.l21.m1.1.2.5"></gt><share href="https://arxiv.org/html/2406.07769v2#alg1.l21.m1.1.2.4.cmml" id="alg1.l21.m1.1.2d.cmml" xref="alg1.l21.m1.1.2"></share><cn id="alg1.l21.m1.1.2.6.cmml" type="integer" xref="alg1.l21.m1.1.2.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\leftarrow length(H)&gt;2</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">← italic_l italic_e italic_n italic_g italic_t italic_h ( italic_H ) &gt; 2</annotation></semantics></math><span class="ltx_text" id="alg1.l21.2" style="font-size:90%;"> and </span><math alttext="\frac{H[-2]-H[-1]}{H[-2]}\leq 0.05" class="ltx_Math" display="inline" id="alg1.l21.m2.3"><semantics id="alg1.l21.m2.3a"><mrow id="alg1.l21.m2.3.4" xref="alg1.l21.m2.3.4.cmml"><mfrac id="alg1.l21.m2.3.3" xref="alg1.l21.m2.3.3.cmml"><mrow id="alg1.l21.m2.2.2.2" xref="alg1.l21.m2.2.2.2.cmml"><mrow id="alg1.l21.m2.1.1.1.1" xref="alg1.l21.m2.1.1.1.1.cmml"><mi id="alg1.l21.m2.1.1.1.1.3" mathsize="90%" xref="alg1.l21.m2.1.1.1.1.3.cmml">H</mi><mo id="alg1.l21.m2.1.1.1.1.2" xref="alg1.l21.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l21.m2.1.1.1.1.1.1" xref="alg1.l21.m2.1.1.1.1.1.2.cmml"><mo id="alg1.l21.m2.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l21.m2.1.1.1.1.1.1.1" xref="alg1.l21.m2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l21.m2.1.1.1.1.1.1.1a" mathsize="90%" xref="alg1.l21.m2.1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l21.m2.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l21.m2.1.1.1.1.1.1.1.2.cmml">2</mn></mrow><mo id="alg1.l21.m2.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l21.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l21.m2.2.2.2.3" mathsize="90%" xref="alg1.l21.m2.2.2.2.3.cmml">−</mo><mrow id="alg1.l21.m2.2.2.2.2" xref="alg1.l21.m2.2.2.2.2.cmml"><mi id="alg1.l21.m2.2.2.2.2.3" mathsize="90%" xref="alg1.l21.m2.2.2.2.2.3.cmml">H</mi><mo id="alg1.l21.m2.2.2.2.2.2" xref="alg1.l21.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l21.m2.2.2.2.2.1.1" xref="alg1.l21.m2.2.2.2.2.1.2.cmml"><mo id="alg1.l21.m2.2.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.2.2.2.2.1.2.1.cmml">[</mo><mrow id="alg1.l21.m2.2.2.2.2.1.1.1" xref="alg1.l21.m2.2.2.2.2.1.1.1.cmml"><mo id="alg1.l21.m2.2.2.2.2.1.1.1a" mathsize="90%" xref="alg1.l21.m2.2.2.2.2.1.1.1.cmml">−</mo><mn id="alg1.l21.m2.2.2.2.2.1.1.1.2" mathsize="90%" xref="alg1.l21.m2.2.2.2.2.1.1.1.2.cmml">1</mn></mrow><mo id="alg1.l21.m2.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l21.m2.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mrow id="alg1.l21.m2.3.3.3" xref="alg1.l21.m2.3.3.3.cmml"><mi id="alg1.l21.m2.3.3.3.3" mathsize="90%" xref="alg1.l21.m2.3.3.3.3.cmml">H</mi><mo id="alg1.l21.m2.3.3.3.2" xref="alg1.l21.m2.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l21.m2.3.3.3.1.1" xref="alg1.l21.m2.3.3.3.1.2.cmml"><mo id="alg1.l21.m2.3.3.3.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.3.3.3.1.2.1.cmml">[</mo><mrow id="alg1.l21.m2.3.3.3.1.1.1" xref="alg1.l21.m2.3.3.3.1.1.1.cmml"><mo id="alg1.l21.m2.3.3.3.1.1.1a" mathsize="90%" xref="alg1.l21.m2.3.3.3.1.1.1.cmml">−</mo><mn id="alg1.l21.m2.3.3.3.1.1.1.2" mathsize="90%" xref="alg1.l21.m2.3.3.3.1.1.1.2.cmml">2</mn></mrow><mo id="alg1.l21.m2.3.3.3.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l21.m2.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></mfrac><mo id="alg1.l21.m2.3.4.1" mathsize="90%" xref="alg1.l21.m2.3.4.1.cmml">≤</mo><mn id="alg1.l21.m2.3.4.2" mathsize="90%" xref="alg1.l21.m2.3.4.2.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.3b"><apply id="alg1.l21.m2.3.4.cmml" xref="alg1.l21.m2.3.4"><leq id="alg1.l21.m2.3.4.1.cmml" xref="alg1.l21.m2.3.4.1"></leq><apply id="alg1.l21.m2.3.3.cmml" xref="alg1.l21.m2.3.3"><divide id="alg1.l21.m2.3.3.4.cmml" xref="alg1.l21.m2.3.3"></divide><apply id="alg1.l21.m2.2.2.2.cmml" xref="alg1.l21.m2.2.2.2"><minus id="alg1.l21.m2.2.2.2.3.cmml" xref="alg1.l21.m2.2.2.2.3"></minus><apply id="alg1.l21.m2.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1"><times id="alg1.l21.m2.1.1.1.1.2.cmml" xref="alg1.l21.m2.1.1.1.1.2"></times><ci id="alg1.l21.m2.1.1.1.1.3.cmml" xref="alg1.l21.m2.1.1.1.1.3">𝐻</ci><apply id="alg1.l21.m2.1.1.1.1.1.2.cmml" xref="alg1.l21.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l21.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l21.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1.1.1.1"><minus id="alg1.l21.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1.1.1.1"></minus><cn id="alg1.l21.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l21.m2.1.1.1.1.1.1.1.2">2</cn></apply></apply></apply><apply id="alg1.l21.m2.2.2.2.2.cmml" xref="alg1.l21.m2.2.2.2.2"><times id="alg1.l21.m2.2.2.2.2.2.cmml" xref="alg1.l21.m2.2.2.2.2.2"></times><ci id="alg1.l21.m2.2.2.2.2.3.cmml" xref="alg1.l21.m2.2.2.2.2.3">𝐻</ci><apply id="alg1.l21.m2.2.2.2.2.1.2.cmml" xref="alg1.l21.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="alg1.l21.m2.2.2.2.2.1.2.1.cmml" xref="alg1.l21.m2.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l21.m2.2.2.2.2.1.1.1.cmml" xref="alg1.l21.m2.2.2.2.2.1.1.1"><minus id="alg1.l21.m2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l21.m2.2.2.2.2.1.1.1"></minus><cn id="alg1.l21.m2.2.2.2.2.1.1.1.2.cmml" type="integer" xref="alg1.l21.m2.2.2.2.2.1.1.1.2">1</cn></apply></apply></apply></apply><apply id="alg1.l21.m2.3.3.3.cmml" xref="alg1.l21.m2.3.3.3"><times id="alg1.l21.m2.3.3.3.2.cmml" xref="alg1.l21.m2.3.3.3.2"></times><ci id="alg1.l21.m2.3.3.3.3.cmml" xref="alg1.l21.m2.3.3.3.3">𝐻</ci><apply id="alg1.l21.m2.3.3.3.1.2.cmml" xref="alg1.l21.m2.3.3.3.1.1"><csymbol cd="latexml" id="alg1.l21.m2.3.3.3.1.2.1.cmml" xref="alg1.l21.m2.3.3.3.1.1.2">delimited-[]</csymbol><apply id="alg1.l21.m2.3.3.3.1.1.1.cmml" xref="alg1.l21.m2.3.3.3.1.1.1"><minus id="alg1.l21.m2.3.3.3.1.1.1.1.cmml" xref="alg1.l21.m2.3.3.3.1.1.1"></minus><cn id="alg1.l21.m2.3.3.3.1.1.1.2.cmml" type="integer" xref="alg1.l21.m2.3.3.3.1.1.1.2">2</cn></apply></apply></apply></apply><cn id="alg1.l21.m2.3.4.2.cmml" type="float" xref="alg1.l21.m2.3.4.2">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.3c">\frac{H[-2]-H[-1]}{H[-2]}\leq 0.05</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.3d">divide start_ARG italic_H [ - 2 ] - italic_H [ - 1 ] end_ARG start_ARG italic_H [ - 2 ] end_ARG ≤ 0.05</annotation></semantics></math><span class="ltx_text" id="alg1.l21.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_text" id="alg1.l22.1" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l22.2" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l22.3" style="font-size:90%;"> converged </span><span class="ltx_text ltx_font_bold" id="alg1.l22.4" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l22.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_text" id="alg1.l23.1" style="font-size:90%;">         break
</span>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_text" id="alg1.l24.1" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l24.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l24.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l24.4" style="font-size:90%;">if</span>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_text ltx_font_bold" id="alg1.l25.1" style="font-size:90%;">end</span><span class="ltx_text" id="alg1.l25.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l25.3" style="font-size:90%;">while</span>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_text" id="alg1.l26.1" style="font-size:90%;">return </span><math alttext="\Pi" class="ltx_Math" display="inline" id="alg1.l26.m1.1"><semantics id="alg1.l26.m1.1a"><mi id="alg1.l26.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l26.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><ci id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.1d">roman_Π</annotation></semantics></math><span class="ltx_text" id="alg1.l26.2" style="font-size:90%;">
</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">After collecting a time series of product sales data, we segment the data for recommendation using a novel, two-step spatial clustering routine. Intuitively, we want to account for consumer preference heterogeneity using demographic data, since a large body of literature has linked consumer preferences to observable demographic variables <cite class="ltx_cite ltx_citemacro_citep">(Allenby and Rossi, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib2" title="">1998</a>; Rossi and Allenby, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib43" title="">2003</a>; Andersen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib3" title="">2010</a>)</cite>. Consistent with this literature, our expectation is that product preferences vary across these demographic clusters. However, it is typically challenging for retailers to estimate a demographic profile for shoppers as most consumers shop anonymously and do not reveal their demographic attributes. We refer to this as the Demographic Spatial Clustering problem.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.3">To solve this problem we use readily accessible 2020 US census data to create a demographic profile of each store. We are given stores, <math alttext="s_{l}\in\{s_{1},s_{2},...\}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.3"><semantics id="S3.SS2.p2.1.m1.3a"><mrow id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml"><msub id="S3.SS2.p2.1.m1.3.3.4" xref="S3.SS2.p2.1.m1.3.3.4.cmml"><mi id="S3.SS2.p2.1.m1.3.3.4.2" xref="S3.SS2.p2.1.m1.3.3.4.2.cmml">s</mi><mi id="S3.SS2.p2.1.m1.3.3.4.3" xref="S3.SS2.p2.1.m1.3.3.4.3.cmml">l</mi></msub><mo id="S3.SS2.p2.1.m1.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.cmml">∈</mo><mrow id="S3.SS2.p2.1.m1.3.3.2.2" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml"><mo id="S3.SS2.p2.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p2.1.m1.2.2.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS2.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.1.m1.3.3.2.2.4" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p2.1.m1.3.3.2.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.3.3.2.2.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS2.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.1.m1.3.3.2.2.5" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS2.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p2.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b"><apply id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3"><in id="S3.SS2.p2.1.m1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3"></in><apply id="S3.SS2.p2.1.m1.3.3.4.cmml" xref="S3.SS2.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.4.1.cmml" xref="S3.SS2.p2.1.m1.3.3.4">subscript</csymbol><ci id="S3.SS2.p2.1.m1.3.3.4.2.cmml" xref="S3.SS2.p2.1.m1.3.3.4.2">𝑠</ci><ci id="S3.SS2.p2.1.m1.3.3.4.3.cmml" xref="S3.SS2.p2.1.m1.3.3.4.3">𝑙</ci></apply><set id="S3.SS2.p2.1.m1.3.3.2.3.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2"><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS2.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">s_{l}\in\{s_{1},s_{2},...\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.3d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>, and census areas, or tracts, <math alttext="\alpha_{z}\in\{\alpha_{1},\alpha_{2},...\}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.3"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3" xref="S3.SS2.p2.2.m2.3.3.cmml"><msub id="S3.SS2.p2.2.m2.3.3.4" xref="S3.SS2.p2.2.m2.3.3.4.cmml"><mi id="S3.SS2.p2.2.m2.3.3.4.2" xref="S3.SS2.p2.2.m2.3.3.4.2.cmml">α</mi><mi id="S3.SS2.p2.2.m2.3.3.4.3" xref="S3.SS2.p2.2.m2.3.3.4.3.cmml">z</mi></msub><mo id="S3.SS2.p2.2.m2.3.3.3" xref="S3.SS2.p2.2.m2.3.3.3.cmml">∈</mo><mrow id="S3.SS2.p2.2.m2.3.3.2.2" xref="S3.SS2.p2.2.m2.3.3.2.3.cmml"><mo id="S3.SS2.p2.2.m2.3.3.2.2.3" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p2.2.m2.2.2.1.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.2.2.1.1.1.2" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml">α</mi><mn id="S3.SS2.p2.2.m2.2.2.1.1.1.3" xref="S3.SS2.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.2.m2.3.3.2.2.4" xref="S3.SS2.p2.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p2.2.m2.3.3.2.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.3.3.2.2.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.2.2.cmml">α</mi><mn id="S3.SS2.p2.2.m2.3.3.2.2.2.3" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.2.m2.3.3.2.2.5" xref="S3.SS2.p2.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p2.2.m2.3.3.2.2.6" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><apply id="S3.SS2.p2.2.m2.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3"><in id="S3.SS2.p2.2.m2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.3"></in><apply id="S3.SS2.p2.2.m2.3.3.4.cmml" xref="S3.SS2.p2.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.4.1.cmml" xref="S3.SS2.p2.2.m2.3.3.4">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.4.2.cmml" xref="S3.SS2.p2.2.m2.3.3.4.2">𝛼</ci><ci id="S3.SS2.p2.2.m2.3.3.4.3.cmml" xref="S3.SS2.p2.2.m2.3.3.4.3">𝑧</ci></apply><set id="S3.SS2.p2.2.m2.3.3.2.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2"><apply id="S3.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2">𝛼</ci><cn id="S3.SS2.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.2">𝛼</ci><cn id="S3.SS2.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">…</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">\alpha_{z}\in\{\alpha_{1},\alpha_{2},...\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.3d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ { italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … }</annotation></semantics></math>. The census data consists of <math alttext="b=30" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">b</mi><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><eq id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></eq><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑏</ci><cn id="S3.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p2.3.m3.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">b=30</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_b = 30</annotation></semantics></math> demographic variables. Unfortunately, matching stores to census tracts is not obvious. First, we typically have an unequal number of stores and tracts. In rural areas we might have more tracts than stores, and in urban areas we might have more stores than tracts. Second, stores might lie on the boundary of a census tract, making it difficult to simply apply the demographics of the nearest tract. Third, shoppers from a nearby census tract might visit multiple stores.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">To resolve these issues we propose the Spatially Anchored Gaussian Mixture Model (SpAGMM) to calculate spatially weighted demographic profiles of stores using census tract data. Once a demographic vector of each store is obtained, grouping similar stores together through K-means is straightforward and effective. We detail both steps below.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Step 1: SpAGMM Estimation</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.9">The core idea behind SpAGMM is we can use a mixture of Gaussians to learn the probability that shoppers from tract <math alttext="\alpha_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">α</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝛼</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\alpha_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> visits store <math alttext="s_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. This probability is inversely proportional to the distance between <math alttext="\alpha_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><msub id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">α</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">𝛼</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\alpha_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><msub id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p1.4.m4.1.1.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.4.m4.1.1.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><apply id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. For each store, <math alttext="s_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msub id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, we can then weight the demographic features of all other tracts, <math alttext="\alpha_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><msub id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml">α</mi><mi id="S3.SS2.SSS1.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2">𝛼</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">\alpha_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, by their respective probabilities to get a spatially weighted, demographic profile. SpAGMM is a special case of the Gaussian Mixture Model (GMM), a common clustering technique used to fit <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m7.1"><semantics id="S3.SS2.SSS1.p1.7.m7.1a"><mi id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.1b"><ci id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m7.1d">italic_K</annotation></semantics></math> Gaussians to unlabelled data. Its output is a set of parameters, <math alttext="\{\langle\mu" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS1.p1.8.m8.1"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mrow id="S3.SS2.SSS1.p1.8.m8.1b"><mo id="S3.SS2.SSS1.p1.8.m8.1.1" stretchy="false">{</mo><mrow id="S3.SS2.SSS1.p1.8.m8.1.2"><mo id="S3.SS2.SSS1.p1.8.m8.1.2.1" stretchy="false">⟨</mo><mi id="S3.SS2.SSS1.p1.8.m8.1.2.2">μ</mi></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">\{\langle\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m8.1d">{ ⟨ italic_μ</annotation></semantics></math>, <math alttext="\Sigma,\pi\rangle_{k}\}_{k=1}^{K}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS1.p1.9.m9.2"><semantics id="S3.SS2.SSS1.p1.9.m9.2a"><mrow id="S3.SS2.SSS1.p1.9.m9.2b"><msub id="S3.SS2.SSS1.p1.9.m9.2.3"><mrow id="S3.SS2.SSS1.p1.9.m9.2.3.2"><mi id="S3.SS2.SSS1.p1.9.m9.1.1" mathvariant="normal">Σ</mi><mo id="S3.SS2.SSS1.p1.9.m9.2.3.2.1">,</mo><mi id="S3.SS2.SSS1.p1.9.m9.2.2">π</mi><mo id="S3.SS2.SSS1.p1.9.m9.2.3.2.2" stretchy="false">⟩</mo></mrow><mi id="S3.SS2.SSS1.p1.9.m9.2.3.3">k</mi></msub><mo id="S3.SS2.SSS1.p1.9.m9.2.4" stretchy="false">}</mo><msub id="S3.SS2.SSS1.p1.9.m9.2.5"><mi id="S3.SS2.SSS1.p1.9.m9.2.5a"></mi><mrow id="S3.SS2.SSS1.p1.9.m9.2.5.1"><mi id="S3.SS2.SSS1.p1.9.m9.2.5.1.2">k</mi><mo id="S3.SS2.SSS1.p1.9.m9.2.5.1.1">=</mo><mn id="S3.SS2.SSS1.p1.9.m9.2.5.1.3">1</mn></mrow></msub><msup id="S3.SS2.SSS1.p1.9.m9.2.6"><mi id="S3.SS2.SSS1.p1.9.m9.2.6a"></mi><mi id="S3.SS2.SSS1.p1.9.m9.2.6.1">K</mi></msup></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.2c">\Sigma,\pi\rangle_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.9.m9.2d">roman_Σ , italic_π ⟩ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, which define the cluster mean, covariance, and membership weight.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.9">We modify the standard GMM by setting the number of clusters equal to the number of stores, <math alttext="K=L" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">K</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><eq id="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1"></eq><ci id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">K=L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">italic_K = italic_L</annotation></semantics></math> and anchoring the Gaussian means at the latitude/longitude coordinates of the stores, <math alttext="\mu_{k}=\langle lat,long\rangle_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.2"><semantics id="S3.SS2.SSS1.p2.2.m2.2a"><mrow id="S3.SS2.SSS1.p2.2.m2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.cmml"><msub id="S3.SS2.SSS1.p2.2.m2.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.2.2.4.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.2.2.4.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.4.2.cmml">μ</mi><mi id="S3.SS2.SSS1.p2.2.m2.2.2.4.3" xref="S3.SS2.SSS1.p2.2.m2.2.2.4.3.cmml">k</mi></msub><mo id="S3.SS2.SSS1.p2.2.m2.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml">=</mo><msub id="S3.SS2.SSS1.p2.2.m2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.cmml"><mrow id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">⟨</mo><mrow id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1a" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.4" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.4.cmml">t</mi></mrow><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2.cmml">l</mi><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3.cmml">o</mi><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1a" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.4.cmml">n</mi><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1b" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.5" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.5.cmml">g</mi></mrow><mo id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml">⟩</mo></mrow><mi id="S3.SS2.SSS1.p2.2.m2.2.2.2.4" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.4.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.2b"><apply id="S3.SS2.SSS1.p2.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2"><eq id="S3.SS2.SSS1.p2.2.m2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.3"></eq><apply id="S3.SS2.SSS1.p2.2.m2.2.2.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.2.2.4.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.2.2.4.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.4.2">𝜇</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.4.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.4.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p2.2.m2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2">subscript</csymbol><list id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1"><times id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.3">𝑎</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.4">𝑡</ci></apply><apply id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2"><times id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.2">𝑙</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.3">𝑜</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.4">𝑛</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.5.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.2.2.2.5">𝑔</ci></apply></list><ci id="S3.SS2.SSS1.p2.2.m2.2.2.2.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2.2.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.2c">\mu_{k}=\langle lat,long\rangle_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.2d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = ⟨ italic_l italic_a italic_t , italic_l italic_o italic_n italic_g ⟩ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Consequently, we do not update <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msub id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">μ</mi><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">𝜇</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> during training, and only update <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.1"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><msub id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.2" mathvariant="normal" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">Σ</mi><mi id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2">Σ</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\pi_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.5.m5.1"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><msub id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS1.p2.5.m5.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.2">𝜋</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">\pi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. We use Maximum A Posteriori (MAP) estimation instead of Maximum Likelihood Estimation (MLE) for numerical stability. When multiple stores and tracts lie in a small neighborhood, the MLE forces the variance of some clusters to be 0, which leads to the Collapsing Variance Problem (CVP) <cite class="ltx_cite ltx_citemacro_citep">(Murphy, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib37" title="">2012</a>)</cite>. To tackle this problem, we put a Normal/Inverse Wishart (NIW) prior over <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.6.m6.1"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><msub id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml">μ</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.2">𝜇</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.6.m6.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.7.m7.1"><semantics id="S3.SS2.SSS1.p2.7.m7.1a"><msub id="S3.SS2.SSS1.p2.7.m7.1.1" xref="S3.SS2.SSS1.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.p2.7.m7.1.1.2" mathvariant="normal" xref="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml">Σ</mi><mi id="S3.SS2.SSS1.p2.7.m7.1.1.3" xref="S3.SS2.SSS1.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m7.1b"><apply id="S3.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.2">Σ</ci><ci id="S3.SS2.SSS1.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m7.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.7.m7.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to derive the NIW conjugate model. We use the Expectation-Maximization (EM) algorithm to learn <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.8.m8.1"><semantics id="S3.SS2.SSS1.p2.8.m8.1a"><msub id="S3.SS2.SSS1.p2.8.m8.1.1" xref="S3.SS2.SSS1.p2.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p2.8.m8.1.1.2" mathvariant="normal" xref="S3.SS2.SSS1.p2.8.m8.1.1.2.cmml">Σ</mi><mi id="S3.SS2.SSS1.p2.8.m8.1.1.3" xref="S3.SS2.SSS1.p2.8.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m8.1b"><apply id="S3.SS2.SSS1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1.2">Σ</ci><ci id="S3.SS2.SSS1.p2.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m8.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.8.m8.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\pi_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.9.m9.1"><semantics id="S3.SS2.SSS1.p2.9.m9.1a"><msub id="S3.SS2.SSS1.p2.9.m9.1.1" xref="S3.SS2.SSS1.p2.9.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p2.9.m9.1.1.2" xref="S3.SS2.SSS1.p2.9.m9.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS1.p2.9.m9.1.1.3" xref="S3.SS2.SSS1.p2.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m9.1b"><apply id="S3.SS2.SSS1.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.1.1.2">𝜋</ci><ci id="S3.SS2.SSS1.p2.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m9.1c">\pi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.9.m9.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. We provide a formal definition in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#alg1" title="Algorithm 1 ‣ 3.2. Spatial Clustering ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.2">Given the outputs of SpAGMM, we can calculate a demographic profile for each store by weighting each tract’s demographics by the probability it belongs to <math alttext="s_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>’s cluster , <math alttext="X_{l}=\sum_{z=1}^{Z}\pi_{lz}x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.2.m2.1"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><mrow id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml"><msub id="S3.SS2.SSS1.p3.2.m2.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.2.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.2.cmml">X</mi><mi id="S3.SS2.SSS1.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS2.SSS1.p3.2.m2.1.1.1" rspace="0.111em" xref="S3.SS2.SSS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p3.2.m2.1.1.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml"><msubsup id="S3.SS2.SSS1.p3.2.m2.1.1.3.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.cmml"><mo id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.2.cmml">z</mi><mo id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.3.cmml">Z</mi></msubsup><mrow id="S3.SS2.SSS1.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.cmml"><msub id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.2.cmml">π</mi><mrow id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.2.cmml">l</mi><mo id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.3.cmml">z</mi></mrow></msub><mo id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.2" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.2.cmml">x</mi><mi id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.3" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.3.cmml">z</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><apply id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1"><eq id="S3.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.1"></eq><apply id="S3.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.2">𝑋</ci><ci id="S3.SS2.SSS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3"><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1">superscript</csymbol><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.2"></sum><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3"><eq id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.1"></eq><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.2">𝑧</ci><cn id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.1.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.1.3">𝑍</ci></apply><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2"><times id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.1"></times><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.2">𝜋</ci><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3"><times id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.1"></times><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.2">𝑙</ci><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.2.3.3">𝑧</ci></apply></apply><apply id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.2">𝑥</ci><ci id="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1.3.2.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">X_{l}=\sum_{z=1}^{Z}\pi_{lz}x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Z end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_l italic_z end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math></p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Step 2: K-means</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.2">Step 1 outputs a single demographic vector, <math alttext="X_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">X</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝑋</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">X_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> for each store. To model preference heterogeneity, we cluster stores into <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_K</annotation></semantics></math> groups. We use standard K-means to group similar stores together and provide a visualization of the learned clusters in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F8" title="Figure 8 ‣ 8.4. Selecting the Number of Clusters ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">8</span></a> in the supplement.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Value estimation: Robust Bayesian Payoffs (RBP)</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">After deriving the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_K</annotation></semantics></math> clusters, our system learns the posterior predictive distribution of payoff for each product, within each cluster using a Robust Bayesian Payoff (RBP) model. Since the use of a computer vision system introduces noise into the sales data, it is important to develop a technique that can make effective decisions under such observation uncertainty, and therefore avoid costly errors. In physical retail, errors are costly as there is significant shipping and labor cost to merchandise each product.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">RBP is a hierarchical Bayesian model, and has the following advantages over non-Bayesian reward models (i.e., linear regression or deep learning): 1) RBP is more robust to outliers through the use of regularizing priors. 2) RBP is able to pool information across stores within a cluster, but is also able to discount irrelevant data as more data is acquired within a store. This is due to the hierarchical structure of the model, where we learn store and cluster-level parameters. 3) RBP explicitly quantifies uncertainty. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F7" title="Figure 7 ‣ 8.3. RBP Toy Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a> of the supplement we analyze RBP on these three dimensions with a synthetic dataset. The RBP model can be specified as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S8.EGx2">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{aligned} \beta_{i,k}\sim\textrm{HalfNormal}(\mu_{0},\sigma%
_{0}),b_{i}\sim\textrm{HalfNormal}(\mu_{1},\sigma_{1})\\
\beta_{i,l,k}\sim\textrm{Laplace}(\beta_{i,k},b_{i}),\sigma^{(i)}_{r}\sim%
\textrm{HalfNormal}(\mu_{2},\sigma_{2})\\
r_{i,l,k}\sim\Gamma(x^{(i)}_{q}*\beta_{i,l,k},\ \sigma^{(i)}_{r})\end{aligned}" class="ltx_Math" display="inline" id="S3.E5.m1.22"><semantics id="S3.E5.m1.22a"><mtable id="S3.E5.m1.22.22" rowspacing="0pt" xref="S3.E5.m1.22.22.cmml"><mtr id="S3.E5.m1.22.22a" xref="S3.E5.m1.22.22.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.22.22b" xref="S3.E5.m1.22.22.cmml"><mrow id="S3.E5.m1.4.4.4.4.4.4" xref="S3.E5.m1.4.4.4.4.4.5.cmml"><mrow id="S3.E5.m1.3.3.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.3.3.1.cmml"><msub id="S3.E5.m1.3.3.3.3.3.3.1.4" xref="S3.E5.m1.3.3.3.3.3.3.1.4.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.4.2" xref="S3.E5.m1.3.3.3.3.3.3.1.4.2.cmml">β</mi><mrow id="S3.E5.m1.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.2.2.2.2.4.1" xref="S3.E5.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.3.3.3.3.3.3.1.3" xref="S3.E5.m1.3.3.3.3.3.3.1.3.cmml">∼</mo><mrow id="S3.E5.m1.3.3.3.3.3.3.1.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.cmml"><mtext id="S3.E5.m1.3.3.3.3.3.3.1.2.4" xref="S3.E5.m1.3.3.3.3.3.3.1.2.4a.cmml">HalfNormal</mtext><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.3" xref="S3.E5.m1.3.3.3.3.3.3.1.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml"><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.3" stretchy="false" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml">(</mo><msub id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml">μ</mi><mn id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.4" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml">,</mo><msub id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.2.cmml">σ</mi><mn id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.3" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.5" stretchy="false" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.4.4.4.4.3" xref="S3.E5.m1.4.4.4.4.4.5a.cmml">,</mo><mrow id="S3.E5.m1.4.4.4.4.4.4.2" xref="S3.E5.m1.4.4.4.4.4.4.2.cmml"><msub id="S3.E5.m1.4.4.4.4.4.4.2.4" xref="S3.E5.m1.4.4.4.4.4.4.2.4.cmml"><mi id="S3.E5.m1.4.4.4.4.4.4.2.4.2" xref="S3.E5.m1.4.4.4.4.4.4.2.4.2.cmml">b</mi><mi id="S3.E5.m1.4.4.4.4.4.4.2.4.3" xref="S3.E5.m1.4.4.4.4.4.4.2.4.3.cmml">i</mi></msub><mo id="S3.E5.m1.4.4.4.4.4.4.2.3" xref="S3.E5.m1.4.4.4.4.4.4.2.3.cmml">∼</mo><mrow id="S3.E5.m1.4.4.4.4.4.4.2.2" xref="S3.E5.m1.4.4.4.4.4.4.2.2.cmml"><mtext id="S3.E5.m1.4.4.4.4.4.4.2.2.4" xref="S3.E5.m1.4.4.4.4.4.4.2.2.4a.cmml">HalfNormal</mtext><mo id="S3.E5.m1.4.4.4.4.4.4.2.2.3" xref="S3.E5.m1.4.4.4.4.4.4.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.3.cmml"><mo id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.cmml"><mi id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.2" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.2.cmml">μ</mi><mn id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.3" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.4" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.cmml"><mi id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.2" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.2.cmml">σ</mi><mn id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.3" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.22.22c" xref="S3.E5.m1.22.22.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.22.22d" xref="S3.E5.m1.22.22.cmml"><mrow id="S3.E5.m1.12.12.12.8.8.8" xref="S3.E5.m1.12.12.12.8.8.9.cmml"><mrow id="S3.E5.m1.11.11.11.7.7.7.1" xref="S3.E5.m1.11.11.11.7.7.7.1.cmml"><msub id="S3.E5.m1.11.11.11.7.7.7.1.4" xref="S3.E5.m1.11.11.11.7.7.7.1.4.cmml"><mi id="S3.E5.m1.11.11.11.7.7.7.1.4.2" xref="S3.E5.m1.11.11.11.7.7.7.1.4.2.cmml">β</mi><mrow id="S3.E5.m1.7.7.7.3.3.3.3.5" xref="S3.E5.m1.7.7.7.3.3.3.3.4.cmml"><mi id="S3.E5.m1.5.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.5.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.7.7.7.3.3.3.3.5.1" xref="S3.E5.m1.7.7.7.3.3.3.3.4.cmml">,</mo><mi id="S3.E5.m1.6.6.6.2.2.2.2.2" xref="S3.E5.m1.6.6.6.2.2.2.2.2.cmml">l</mi><mo id="S3.E5.m1.7.7.7.3.3.3.3.5.2" xref="S3.E5.m1.7.7.7.3.3.3.3.4.cmml">,</mo><mi id="S3.E5.m1.7.7.7.3.3.3.3.3" xref="S3.E5.m1.7.7.7.3.3.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.11.11.11.7.7.7.1.3" xref="S3.E5.m1.11.11.11.7.7.7.1.3.cmml">∼</mo><mrow id="S3.E5.m1.11.11.11.7.7.7.1.2" xref="S3.E5.m1.11.11.11.7.7.7.1.2.cmml"><mtext id="S3.E5.m1.11.11.11.7.7.7.1.2.4" xref="S3.E5.m1.11.11.11.7.7.7.1.2.4a.cmml">Laplace</mtext><mo id="S3.E5.m1.11.11.11.7.7.7.1.2.3" xref="S3.E5.m1.11.11.11.7.7.7.1.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.3.cmml"><mo id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.3" stretchy="false" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.3.cmml">(</mo><msub id="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1" xref="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.cmml"><mi id="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.2" xref="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.2.cmml">β</mi><mrow id="S3.E5.m1.9.9.9.5.5.5.2.4" xref="S3.E5.m1.9.9.9.5.5.5.2.3.cmml"><mi id="S3.E5.m1.8.8.8.4.4.4.1.1" xref="S3.E5.m1.8.8.8.4.4.4.1.1.cmml">i</mi><mo id="S3.E5.m1.9.9.9.5.5.5.2.4.1" xref="S3.E5.m1.9.9.9.5.5.5.2.3.cmml">,</mo><mi id="S3.E5.m1.9.9.9.5.5.5.2.2" xref="S3.E5.m1.9.9.9.5.5.5.2.2.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.4" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.3.cmml">,</mo><msub id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.cmml"><mi id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.2" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.2.cmml">b</mi><mi id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.3" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.5" stretchy="false" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.12.12.12.8.8.8.3" xref="S3.E5.m1.12.12.12.8.8.9a.cmml">,</mo><mrow id="S3.E5.m1.12.12.12.8.8.8.2" xref="S3.E5.m1.12.12.12.8.8.8.2.cmml"><msubsup id="S3.E5.m1.12.12.12.8.8.8.2.4" xref="S3.E5.m1.12.12.12.8.8.8.2.4.cmml"><mi id="S3.E5.m1.12.12.12.8.8.8.2.4.2.2" xref="S3.E5.m1.12.12.12.8.8.8.2.4.2.2.cmml">σ</mi><mi id="S3.E5.m1.12.12.12.8.8.8.2.4.3" xref="S3.E5.m1.12.12.12.8.8.8.2.4.3.cmml">r</mi><mrow id="S3.E5.m1.10.10.10.6.6.6.1.3" xref="S3.E5.m1.12.12.12.8.8.8.2.4.cmml"><mo id="S3.E5.m1.10.10.10.6.6.6.1.3.1" stretchy="false" xref="S3.E5.m1.12.12.12.8.8.8.2.4.cmml">(</mo><mi id="S3.E5.m1.10.10.10.6.6.6.1.1" xref="S3.E5.m1.10.10.10.6.6.6.1.1.cmml">i</mi><mo id="S3.E5.m1.10.10.10.6.6.6.1.3.2" stretchy="false" xref="S3.E5.m1.12.12.12.8.8.8.2.4.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.12.12.12.8.8.8.2.3" xref="S3.E5.m1.12.12.12.8.8.8.2.3.cmml">∼</mo><mrow id="S3.E5.m1.12.12.12.8.8.8.2.2" xref="S3.E5.m1.12.12.12.8.8.8.2.2.cmml"><mtext id="S3.E5.m1.12.12.12.8.8.8.2.2.4" xref="S3.E5.m1.12.12.12.8.8.8.2.2.4a.cmml">HalfNormal</mtext><mo id="S3.E5.m1.12.12.12.8.8.8.2.2.3" xref="S3.E5.m1.12.12.12.8.8.8.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.3.cmml"><mo id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.cmml"><mi id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.2" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.2.cmml">μ</mi><mn id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.3" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.4" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.cmml"><mi id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.2" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.2.cmml">σ</mi><mn id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.3" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.22.22e" xref="S3.E5.m1.22.22.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.22.22f" xref="S3.E5.m1.22.22.cmml"><mrow id="S3.E5.m1.22.22.22.10.10" xref="S3.E5.m1.22.22.22.10.10.cmml"><msub id="S3.E5.m1.22.22.22.10.10.12" xref="S3.E5.m1.22.22.22.10.10.12.cmml"><mi id="S3.E5.m1.22.22.22.10.10.12.2" xref="S3.E5.m1.22.22.22.10.10.12.2.cmml">r</mi><mrow id="S3.E5.m1.15.15.15.3.3.3.3.5" xref="S3.E5.m1.15.15.15.3.3.3.3.4.cmml"><mi id="S3.E5.m1.13.13.13.1.1.1.1.1" xref="S3.E5.m1.13.13.13.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.15.15.15.3.3.3.3.5.1" xref="S3.E5.m1.15.15.15.3.3.3.3.4.cmml">,</mo><mi id="S3.E5.m1.14.14.14.2.2.2.2.2" xref="S3.E5.m1.14.14.14.2.2.2.2.2.cmml">l</mi><mo id="S3.E5.m1.15.15.15.3.3.3.3.5.2" xref="S3.E5.m1.15.15.15.3.3.3.3.4.cmml">,</mo><mi id="S3.E5.m1.15.15.15.3.3.3.3.3" xref="S3.E5.m1.15.15.15.3.3.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.22.22.22.10.10.11" xref="S3.E5.m1.22.22.22.10.10.11.cmml">∼</mo><mrow id="S3.E5.m1.22.22.22.10.10.10" xref="S3.E5.m1.22.22.22.10.10.10.cmml"><mi id="S3.E5.m1.22.22.22.10.10.10.4" mathvariant="normal" xref="S3.E5.m1.22.22.22.10.10.10.4.cmml">Γ</mi><mo id="S3.E5.m1.22.22.22.10.10.10.3" xref="S3.E5.m1.22.22.22.10.10.10.3.cmml">⁢</mo><mrow id="S3.E5.m1.22.22.22.10.10.10.2.2" xref="S3.E5.m1.22.22.22.10.10.10.2.3.cmml"><mo id="S3.E5.m1.22.22.22.10.10.10.2.2.3" stretchy="false" xref="S3.E5.m1.22.22.22.10.10.10.2.3.cmml">(</mo><mrow id="S3.E5.m1.21.21.21.9.9.9.1.1.1" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.cmml"><msubsup id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.cmml"><mi id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.2" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.2.cmml">x</mi><mi id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.3" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.3.cmml">q</mi><mrow id="S3.E5.m1.16.16.16.4.4.4.1.3" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.cmml"><mo id="S3.E5.m1.16.16.16.4.4.4.1.3.1" stretchy="false" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.16.16.16.4.4.4.1.1" xref="S3.E5.m1.16.16.16.4.4.4.1.1.cmml">i</mi><mo id="S3.E5.m1.16.16.16.4.4.4.1.3.2" stretchy="false" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.21.21.21.9.9.9.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.1.cmml">∗</mo><msub id="S3.E5.m1.21.21.21.9.9.9.1.1.1.3" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.cmml"><mi id="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.2" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.2.cmml">β</mi><mrow id="S3.E5.m1.19.19.19.7.7.7.3.5" xref="S3.E5.m1.19.19.19.7.7.7.3.4.cmml"><mi id="S3.E5.m1.17.17.17.5.5.5.1.1" xref="S3.E5.m1.17.17.17.5.5.5.1.1.cmml">i</mi><mo id="S3.E5.m1.19.19.19.7.7.7.3.5.1" xref="S3.E5.m1.19.19.19.7.7.7.3.4.cmml">,</mo><mi id="S3.E5.m1.18.18.18.6.6.6.2.2" xref="S3.E5.m1.18.18.18.6.6.6.2.2.cmml">l</mi><mo id="S3.E5.m1.19.19.19.7.7.7.3.5.2" xref="S3.E5.m1.19.19.19.7.7.7.3.4.cmml">,</mo><mi id="S3.E5.m1.19.19.19.7.7.7.3.3" xref="S3.E5.m1.19.19.19.7.7.7.3.3.cmml">k</mi></mrow></msub></mrow><mo id="S3.E5.m1.22.22.22.10.10.10.2.2.4" rspace="0.667em" xref="S3.E5.m1.22.22.22.10.10.10.2.3.cmml">,</mo><msubsup id="S3.E5.m1.22.22.22.10.10.10.2.2.2" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.cmml"><mi id="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.2" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.2.cmml">σ</mi><mi id="S3.E5.m1.22.22.22.10.10.10.2.2.2.3" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.3.cmml">r</mi><mrow id="S3.E5.m1.20.20.20.8.8.8.1.3" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.cmml"><mo id="S3.E5.m1.20.20.20.8.8.8.1.3.1" stretchy="false" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.cmml">(</mo><mi id="S3.E5.m1.20.20.20.8.8.8.1.1" xref="S3.E5.m1.20.20.20.8.8.8.1.1.cmml">i</mi><mo id="S3.E5.m1.20.20.20.8.8.8.1.3.2" stretchy="false" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.22.22.22.10.10.10.2.2.5" stretchy="false" xref="S3.E5.m1.22.22.22.10.10.10.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.22b"><matrix id="S3.E5.m1.22.22.cmml" xref="S3.E5.m1.22.22"><matrixrow id="S3.E5.m1.22.22a.cmml" xref="S3.E5.m1.22.22"><apply id="S3.E5.m1.4.4.4.4.4.5.cmml" xref="S3.E5.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.4.4.5a.cmml" xref="S3.E5.m1.4.4.4.4.4.4.3">formulae-sequence</csymbol><apply id="S3.E5.m1.3.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.3.3.3.3.1.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.3">similar-to</csymbol><apply id="S3.E5.m1.3.3.3.3.3.3.1.4.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.4.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.4">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.4.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.4.2">𝛽</ci><list id="S3.E5.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E5.m1.3.3.3.3.3.3.1.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2"><times id="S3.E5.m1.3.3.3.3.3.3.1.2.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.3"></times><ci id="S3.E5.m1.3.3.3.3.3.3.1.2.4a.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.4"><mtext id="S3.E5.m1.3.3.3.3.3.3.1.2.4.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.4">HalfNormal</mtext></ci><interval closure="open" id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2"><apply id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.2">𝜇</ci><cn id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.1.3">0</cn></apply><apply id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.2">𝜎</ci><cn id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.3">0</cn></apply></interval></apply></apply><apply id="S3.E5.m1.4.4.4.4.4.4.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2"><csymbol cd="latexml" id="S3.E5.m1.4.4.4.4.4.4.2.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.3">similar-to</csymbol><apply id="S3.E5.m1.4.4.4.4.4.4.2.4.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.4.4.4.2.4.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.4">subscript</csymbol><ci id="S3.E5.m1.4.4.4.4.4.4.2.4.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.4.2">𝑏</ci><ci id="S3.E5.m1.4.4.4.4.4.4.2.4.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.4.3">𝑖</ci></apply><apply id="S3.E5.m1.4.4.4.4.4.4.2.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2"><times id="S3.E5.m1.4.4.4.4.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.3"></times><ci id="S3.E5.m1.4.4.4.4.4.4.2.2.4a.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.4"><mtext id="S3.E5.m1.4.4.4.4.4.4.2.2.4.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.4">HalfNormal</mtext></ci><interval closure="open" id="S3.E5.m1.4.4.4.4.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2"><apply id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.2">𝜇</ci><cn id="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.4.4.4.4.4.4.2.1.1.1.1.3">1</cn></apply><apply id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.2">𝜎</ci><cn id="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.4.4.4.4.4.4.2.2.2.2.2.3">1</cn></apply></interval></apply></apply></apply></matrixrow><matrixrow id="S3.E5.m1.22.22b.cmml" xref="S3.E5.m1.22.22"><apply id="S3.E5.m1.12.12.12.8.8.9.cmml" xref="S3.E5.m1.12.12.12.8.8.8"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.8.8.9a.cmml" xref="S3.E5.m1.12.12.12.8.8.8.3">formulae-sequence</csymbol><apply id="S3.E5.m1.11.11.11.7.7.7.1.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1"><csymbol cd="latexml" id="S3.E5.m1.11.11.11.7.7.7.1.3.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.3">similar-to</csymbol><apply id="S3.E5.m1.11.11.11.7.7.7.1.4.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.7.7.7.1.4.1.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.4">subscript</csymbol><ci id="S3.E5.m1.11.11.11.7.7.7.1.4.2.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.4.2">𝛽</ci><list id="S3.E5.m1.7.7.7.3.3.3.3.4.cmml" xref="S3.E5.m1.7.7.7.3.3.3.3.5"><ci id="S3.E5.m1.5.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.6.6.6.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.6.2.2.2.2.2">𝑙</ci><ci id="S3.E5.m1.7.7.7.3.3.3.3.3.cmml" xref="S3.E5.m1.7.7.7.3.3.3.3.3">𝑘</ci></list></apply><apply id="S3.E5.m1.11.11.11.7.7.7.1.2.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2"><times id="S3.E5.m1.11.11.11.7.7.7.1.2.3.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.3"></times><ci id="S3.E5.m1.11.11.11.7.7.7.1.2.4a.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.4"><mtext id="S3.E5.m1.11.11.11.7.7.7.1.2.4.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.4">Laplace</mtext></ci><interval closure="open" id="S3.E5.m1.11.11.11.7.7.7.1.2.2.3.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2"><apply id="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.2.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.1.1.1.1.2">𝛽</ci><list id="S3.E5.m1.9.9.9.5.5.5.2.3.cmml" xref="S3.E5.m1.9.9.9.5.5.5.2.4"><ci id="S3.E5.m1.8.8.8.4.4.4.1.1.cmml" xref="S3.E5.m1.8.8.8.4.4.4.1.1">𝑖</ci><ci id="S3.E5.m1.9.9.9.5.5.5.2.2.cmml" xref="S3.E5.m1.9.9.9.5.5.5.2.2">𝑘</ci></list></apply><apply id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.1.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.2.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.2">𝑏</ci><ci id="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.3.cmml" xref="S3.E5.m1.11.11.11.7.7.7.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E5.m1.12.12.12.8.8.8.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2"><csymbol cd="latexml" id="S3.E5.m1.12.12.12.8.8.8.2.3.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.3">similar-to</csymbol><apply id="S3.E5.m1.12.12.12.8.8.8.2.4.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.8.8.8.2.4.1.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4">subscript</csymbol><apply id="S3.E5.m1.12.12.12.8.8.8.2.4.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.8.8.8.2.4.2.1.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4">superscript</csymbol><ci id="S3.E5.m1.12.12.12.8.8.8.2.4.2.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4.2.2">𝜎</ci><ci id="S3.E5.m1.10.10.10.6.6.6.1.1.cmml" xref="S3.E5.m1.10.10.10.6.6.6.1.1">𝑖</ci></apply><ci id="S3.E5.m1.12.12.12.8.8.8.2.4.3.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.4.3">𝑟</ci></apply><apply id="S3.E5.m1.12.12.12.8.8.8.2.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2"><times id="S3.E5.m1.12.12.12.8.8.8.2.2.3.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.3"></times><ci id="S3.E5.m1.12.12.12.8.8.8.2.2.4a.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.4"><mtext id="S3.E5.m1.12.12.12.8.8.8.2.2.4.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.4">HalfNormal</mtext></ci><interval closure="open" id="S3.E5.m1.12.12.12.8.8.8.2.2.2.3.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2"><apply id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.1.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.2">𝜇</ci><cn id="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.12.12.12.8.8.8.2.1.1.1.1.3">2</cn></apply><apply id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.1.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.2.cmml" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.2">𝜎</ci><cn id="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.12.12.12.8.8.8.2.2.2.2.2.3">2</cn></apply></interval></apply></apply></apply></matrixrow><matrixrow id="S3.E5.m1.22.22c.cmml" xref="S3.E5.m1.22.22"><apply id="S3.E5.m1.22.22.22.10.10.cmml" xref="S3.E5.m1.22.22.22.10.10"><csymbol cd="latexml" id="S3.E5.m1.22.22.22.10.10.11.cmml" xref="S3.E5.m1.22.22.22.10.10.11">similar-to</csymbol><apply id="S3.E5.m1.22.22.22.10.10.12.cmml" xref="S3.E5.m1.22.22.22.10.10.12"><csymbol cd="ambiguous" id="S3.E5.m1.22.22.22.10.10.12.1.cmml" xref="S3.E5.m1.22.22.22.10.10.12">subscript</csymbol><ci id="S3.E5.m1.22.22.22.10.10.12.2.cmml" xref="S3.E5.m1.22.22.22.10.10.12.2">𝑟</ci><list id="S3.E5.m1.15.15.15.3.3.3.3.4.cmml" xref="S3.E5.m1.15.15.15.3.3.3.3.5"><ci id="S3.E5.m1.13.13.13.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.13.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.14.14.14.2.2.2.2.2.cmml" xref="S3.E5.m1.14.14.14.2.2.2.2.2">𝑙</ci><ci id="S3.E5.m1.15.15.15.3.3.3.3.3.cmml" xref="S3.E5.m1.15.15.15.3.3.3.3.3">𝑘</ci></list></apply><apply id="S3.E5.m1.22.22.22.10.10.10.cmml" xref="S3.E5.m1.22.22.22.10.10.10"><times id="S3.E5.m1.22.22.22.10.10.10.3.cmml" xref="S3.E5.m1.22.22.22.10.10.10.3"></times><ci id="S3.E5.m1.22.22.22.10.10.10.4.cmml" xref="S3.E5.m1.22.22.22.10.10.10.4">Γ</ci><interval closure="open" id="S3.E5.m1.22.22.22.10.10.10.2.3.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2"><apply id="S3.E5.m1.21.21.21.9.9.9.1.1.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1"><times id="S3.E5.m1.21.21.21.9.9.9.1.1.1.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.1"></times><apply id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.2.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.2.2">𝑥</ci><ci id="S3.E5.m1.16.16.16.4.4.4.1.1.cmml" xref="S3.E5.m1.16.16.16.4.4.4.1.1">𝑖</ci></apply><ci id="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.3.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.2.3">𝑞</ci></apply><apply id="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.1.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.2.cmml" xref="S3.E5.m1.21.21.21.9.9.9.1.1.1.3.2">𝛽</ci><list id="S3.E5.m1.19.19.19.7.7.7.3.4.cmml" xref="S3.E5.m1.19.19.19.7.7.7.3.5"><ci id="S3.E5.m1.17.17.17.5.5.5.1.1.cmml" xref="S3.E5.m1.17.17.17.5.5.5.1.1">𝑖</ci><ci id="S3.E5.m1.18.18.18.6.6.6.2.2.cmml" xref="S3.E5.m1.18.18.18.6.6.6.2.2">𝑙</ci><ci id="S3.E5.m1.19.19.19.7.7.7.3.3.cmml" xref="S3.E5.m1.19.19.19.7.7.7.3.3">𝑘</ci></list></apply></apply><apply id="S3.E5.m1.22.22.22.10.10.10.2.2.2.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.22.22.22.10.10.10.2.2.2.1.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2">subscript</csymbol><apply id="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.1.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2">superscript</csymbol><ci id="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.2.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.2.2">𝜎</ci><ci id="S3.E5.m1.20.20.20.8.8.8.1.1.cmml" xref="S3.E5.m1.20.20.20.8.8.8.1.1">𝑖</ci></apply><ci id="S3.E5.m1.22.22.22.10.10.10.2.2.2.3.cmml" xref="S3.E5.m1.22.22.22.10.10.10.2.2.2.3">𝑟</ci></apply></interval></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.22c">\displaystyle\begin{aligned} \beta_{i,k}\sim\textrm{HalfNormal}(\mu_{0},\sigma%
_{0}),b_{i}\sim\textrm{HalfNormal}(\mu_{1},\sigma_{1})\\
\beta_{i,l,k}\sim\textrm{Laplace}(\beta_{i,k},b_{i}),\sigma^{(i)}_{r}\sim%
\textrm{HalfNormal}(\mu_{2},\sigma_{2})\\
r_{i,l,k}\sim\Gamma(x^{(i)}_{q}*\beta_{i,l,k},\ \sigma^{(i)}_{r})\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.22d">start_ROW start_CELL italic_β start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT ∼ HalfNormal ( italic_μ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ HalfNormal ( italic_μ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_β start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT ∼ Laplace ( italic_β start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_σ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∼ HalfNormal ( italic_μ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT ∼ roman_Γ ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∗ italic_β start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT , italic_σ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.15">where <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">italic_i</annotation></semantics></math> indexes product, <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_l</annotation></semantics></math> indexes store, and <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_k</annotation></semantics></math> indexes cluster. <math alttext="\beta_{i,k}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.2"><semantics id="S3.SS3.p4.4.m4.2a"><msub id="S3.SS3.p4.4.m4.2.3" xref="S3.SS3.p4.4.m4.2.3.cmml"><mi id="S3.SS3.p4.4.m4.2.3.2" xref="S3.SS3.p4.4.m4.2.3.2.cmml">β</mi><mrow id="S3.SS3.p4.4.m4.2.2.2.4" xref="S3.SS3.p4.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.4.m4.2.2.2.4.1" xref="S3.SS3.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.4.m4.2.2.2.2" xref="S3.SS3.p4.4.m4.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.2b"><apply id="S3.SS3.p4.4.m4.2.3.cmml" xref="S3.SS3.p4.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.2.3.1.cmml" xref="S3.SS3.p4.4.m4.2.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.2.3.2.cmml" xref="S3.SS3.p4.4.m4.2.3.2">𝛽</ci><list id="S3.SS3.p4.4.m4.2.2.2.3.cmml" xref="S3.SS3.p4.4.m4.2.2.2.4"><ci id="S3.SS3.p4.4.m4.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1">𝑖</ci><ci id="S3.SS3.p4.4.m4.2.2.2.2.cmml" xref="S3.SS3.p4.4.m4.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.2c">\beta_{i,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.2d">italic_β start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\beta_{i,l.k}" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.4"><semantics id="S3.SS3.p4.5.m5.4a"><msub id="S3.SS3.p4.5.m5.4.5" xref="S3.SS3.p4.5.m5.4.5.cmml"><mi id="S3.SS3.p4.5.m5.4.5.2" xref="S3.SS3.p4.5.m5.4.5.2.cmml">β</mi><mrow id="S3.SS3.p4.5.m5.4.4.4.4" xref="S3.SS3.p4.5.m5.4.4.4.5.cmml"><mrow id="S3.SS3.p4.5.m5.4.4.4.4.1.2" xref="S3.SS3.p4.5.m5.4.4.4.4.1.1.cmml"><mi id="S3.SS3.p4.5.m5.1.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.5.m5.4.4.4.4.1.2.1" xref="S3.SS3.p4.5.m5.4.4.4.4.1.1.cmml">,</mo><mi id="S3.SS3.p4.5.m5.2.2.2.2" xref="S3.SS3.p4.5.m5.2.2.2.2.cmml">l</mi></mrow><mo id="S3.SS3.p4.5.m5.4.4.4.4.2" lspace="0em" rspace="0.167em" xref="S3.SS3.p4.5.m5.4.4.4.5a.cmml">.</mo><mi id="S3.SS3.p4.5.m5.3.3.3.3" xref="S3.SS3.p4.5.m5.3.3.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.4b"><apply id="S3.SS3.p4.5.m5.4.5.cmml" xref="S3.SS3.p4.5.m5.4.5"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.4.5.1.cmml" xref="S3.SS3.p4.5.m5.4.5">subscript</csymbol><ci id="S3.SS3.p4.5.m5.4.5.2.cmml" xref="S3.SS3.p4.5.m5.4.5.2">𝛽</ci><apply id="S3.SS3.p4.5.m5.4.4.4.5.cmml" xref="S3.SS3.p4.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.4.4.4.5a.cmml" xref="S3.SS3.p4.5.m5.4.4.4.4.2">formulae-sequence</csymbol><list id="S3.SS3.p4.5.m5.4.4.4.4.1.1.cmml" xref="S3.SS3.p4.5.m5.4.4.4.4.1.2"><ci id="S3.SS3.p4.5.m5.1.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS3.p4.5.m5.2.2.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.2.2">𝑙</ci></list><ci id="S3.SS3.p4.5.m5.3.3.3.3.cmml" xref="S3.SS3.p4.5.m5.3.3.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.4c">\beta_{i,l.k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.4d">italic_β start_POSTSUBSCRIPT italic_i , italic_l . italic_k end_POSTSUBSCRIPT</annotation></semantics></math> denote the cluster- and store-level coefficients for product <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><msub id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">p</mi><mi id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝑝</ci><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Moreover, <math alttext="x^{(i)}_{q}" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1"><semantics id="S3.SS3.p4.7.m7.1a"><msubsup id="S3.SS3.p4.7.m7.1.2" xref="S3.SS3.p4.7.m7.1.2.cmml"><mi id="S3.SS3.p4.7.m7.1.2.2.2" xref="S3.SS3.p4.7.m7.1.2.2.2.cmml">x</mi><mi id="S3.SS3.p4.7.m7.1.2.3" xref="S3.SS3.p4.7.m7.1.2.3.cmml">q</mi><mrow id="S3.SS3.p4.7.m7.1.1.1.3" xref="S3.SS3.p4.7.m7.1.2.cmml"><mo id="S3.SS3.p4.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.7.m7.1.2.cmml">(</mo><mi id="S3.SS3.p4.7.m7.1.1.1.1" xref="S3.SS3.p4.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.7.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><apply id="S3.SS3.p4.7.m7.1.2.cmml" xref="S3.SS3.p4.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.2.1.cmml" xref="S3.SS3.p4.7.m7.1.2">subscript</csymbol><apply id="S3.SS3.p4.7.m7.1.2.2.cmml" xref="S3.SS3.p4.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.2.2.1.cmml" xref="S3.SS3.p4.7.m7.1.2">superscript</csymbol><ci id="S3.SS3.p4.7.m7.1.2.2.2.cmml" xref="S3.SS3.p4.7.m7.1.2.2.2">𝑥</ci><ci id="S3.SS3.p4.7.m7.1.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1.1.1">𝑖</ci></apply><ci id="S3.SS3.p4.7.m7.1.2.3.cmml" xref="S3.SS3.p4.7.m7.1.2.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">x^{(i)}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m7.1d">italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, is the allocated quantity of product, <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.8.m8.1"><semantics id="S3.SS3.p4.8.m8.1a"><msub id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml"><mi id="S3.SS3.p4.8.m8.1.1.2" xref="S3.SS3.p4.8.m8.1.1.2.cmml">p</mi><mi id="S3.SS3.p4.8.m8.1.1.3" xref="S3.SS3.p4.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><apply id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p4.8.m8.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.2">𝑝</ci><ci id="S3.SS3.p4.8.m8.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.8.m8.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, the <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p4.9.m9.1"><semantics id="S3.SS3.p4.9.m9.1a"><mi id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><ci id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.9.m9.1d">italic_β</annotation></semantics></math> parameters describe how reward changes as a function allocated space. We treat <math alttext="\{\mu_{0},\sigma_{0}\},\{\mu_{1},\sigma_{1}\}" class="ltx_Math" display="inline" id="S3.SS3.p4.10.m10.2"><semantics id="S3.SS3.p4.10.m10.2a"><mrow id="S3.SS3.p4.10.m10.2.2.2" xref="S3.SS3.p4.10.m10.2.2.3.cmml"><mrow id="S3.SS3.p4.10.m10.1.1.1.1.2" xref="S3.SS3.p4.10.m10.1.1.1.1.3.cmml"><mo id="S3.SS3.p4.10.m10.1.1.1.1.2.3" stretchy="false" xref="S3.SS3.p4.10.m10.1.1.1.1.3.cmml">{</mo><msub id="S3.SS3.p4.10.m10.1.1.1.1.1.1" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.10.m10.1.1.1.1.1.1.2" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1.2.cmml">μ</mi><mn id="S3.SS3.p4.10.m10.1.1.1.1.1.1.3" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS3.p4.10.m10.1.1.1.1.2.4" xref="S3.SS3.p4.10.m10.1.1.1.1.3.cmml">,</mo><msub id="S3.SS3.p4.10.m10.1.1.1.1.2.2" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p4.10.m10.1.1.1.1.2.2.2" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2.2.cmml">σ</mi><mn id="S3.SS3.p4.10.m10.1.1.1.1.2.2.3" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="S3.SS3.p4.10.m10.1.1.1.1.2.5" stretchy="false" xref="S3.SS3.p4.10.m10.1.1.1.1.3.cmml">}</mo></mrow><mo id="S3.SS3.p4.10.m10.2.2.2.3" xref="S3.SS3.p4.10.m10.2.2.3.cmml">,</mo><mrow id="S3.SS3.p4.10.m10.2.2.2.2.2" xref="S3.SS3.p4.10.m10.2.2.2.2.3.cmml"><mo id="S3.SS3.p4.10.m10.2.2.2.2.2.3" stretchy="false" xref="S3.SS3.p4.10.m10.2.2.2.2.3.cmml">{</mo><msub id="S3.SS3.p4.10.m10.2.2.2.2.1.1" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1.cmml"><mi id="S3.SS3.p4.10.m10.2.2.2.2.1.1.2" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1.2.cmml">μ</mi><mn id="S3.SS3.p4.10.m10.2.2.2.2.1.1.3" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p4.10.m10.2.2.2.2.2.4" xref="S3.SS3.p4.10.m10.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p4.10.m10.2.2.2.2.2.2" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p4.10.m10.2.2.2.2.2.2.2" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2.2.cmml">σ</mi><mn id="S3.SS3.p4.10.m10.2.2.2.2.2.2.3" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p4.10.m10.2.2.2.2.2.5" stretchy="false" xref="S3.SS3.p4.10.m10.2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.2b"><list id="S3.SS3.p4.10.m10.2.2.3.cmml" xref="S3.SS3.p4.10.m10.2.2.2"><set id="S3.SS3.p4.10.m10.1.1.1.1.3.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.2"><apply id="S3.SS3.p4.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1.2">𝜇</ci><cn id="S3.SS3.p4.10.m10.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p4.10.m10.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS3.p4.10.m10.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2.2">𝜎</ci><cn id="S3.SS3.p4.10.m10.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.SS3.p4.10.m10.1.1.1.1.2.2.3">0</cn></apply></set><set id="S3.SS3.p4.10.m10.2.2.2.2.3.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.2"><apply id="S3.SS3.p4.10.m10.2.2.2.2.1.1.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p4.10.m10.2.2.2.2.1.1.2.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1.2">𝜇</ci><cn id="S3.SS3.p4.10.m10.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p4.10.m10.2.2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.p4.10.m10.2.2.2.2.2.2.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p4.10.m10.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2.2">𝜎</ci><cn id="S3.SS3.p4.10.m10.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p4.10.m10.2.2.2.2.2.2.3">1</cn></apply></set></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.2c">\{\mu_{0},\sigma_{0}\},\{\mu_{1},\sigma_{1}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.10.m10.2d">{ italic_μ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT } , { italic_μ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT }</annotation></semantics></math>, and <math alttext="\{\mu_{2},\sigma_{2}\}" class="ltx_Math" display="inline" id="S3.SS3.p4.11.m11.2"><semantics id="S3.SS3.p4.11.m11.2a"><mrow id="S3.SS3.p4.11.m11.2.2.2" xref="S3.SS3.p4.11.m11.2.2.3.cmml"><mo id="S3.SS3.p4.11.m11.2.2.2.3" stretchy="false" xref="S3.SS3.p4.11.m11.2.2.3.cmml">{</mo><msub id="S3.SS3.p4.11.m11.1.1.1.1" xref="S3.SS3.p4.11.m11.1.1.1.1.cmml"><mi id="S3.SS3.p4.11.m11.1.1.1.1.2" xref="S3.SS3.p4.11.m11.1.1.1.1.2.cmml">μ</mi><mn id="S3.SS3.p4.11.m11.1.1.1.1.3" xref="S3.SS3.p4.11.m11.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS3.p4.11.m11.2.2.2.4" xref="S3.SS3.p4.11.m11.2.2.3.cmml">,</mo><msub id="S3.SS3.p4.11.m11.2.2.2.2" xref="S3.SS3.p4.11.m11.2.2.2.2.cmml"><mi id="S3.SS3.p4.11.m11.2.2.2.2.2" xref="S3.SS3.p4.11.m11.2.2.2.2.2.cmml">σ</mi><mn id="S3.SS3.p4.11.m11.2.2.2.2.3" xref="S3.SS3.p4.11.m11.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p4.11.m11.2.2.2.5" stretchy="false" xref="S3.SS3.p4.11.m11.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m11.2b"><set id="S3.SS3.p4.11.m11.2.2.3.cmml" xref="S3.SS3.p4.11.m11.2.2.2"><apply id="S3.SS3.p4.11.m11.1.1.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m11.1.1.1.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.11.m11.1.1.1.1.2.cmml" xref="S3.SS3.p4.11.m11.1.1.1.1.2">𝜇</ci><cn id="S3.SS3.p4.11.m11.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p4.11.m11.1.1.1.1.3">2</cn></apply><apply id="S3.SS3.p4.11.m11.2.2.2.2.cmml" xref="S3.SS3.p4.11.m11.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m11.2.2.2.2.1.cmml" xref="S3.SS3.p4.11.m11.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p4.11.m11.2.2.2.2.2.cmml" xref="S3.SS3.p4.11.m11.2.2.2.2.2">𝜎</ci><cn id="S3.SS3.p4.11.m11.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p4.11.m11.2.2.2.2.3">2</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m11.2c">\{\mu_{2},\sigma_{2}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.11.m11.2d">{ italic_μ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT }</annotation></semantics></math> as hyperparameters. Finally, <math alttext="r_{i,l,k}" class="ltx_Math" display="inline" id="S3.SS3.p4.12.m12.3"><semantics id="S3.SS3.p4.12.m12.3a"><msub id="S3.SS3.p4.12.m12.3.4" xref="S3.SS3.p4.12.m12.3.4.cmml"><mi id="S3.SS3.p4.12.m12.3.4.2" xref="S3.SS3.p4.12.m12.3.4.2.cmml">r</mi><mrow id="S3.SS3.p4.12.m12.3.3.3.5" xref="S3.SS3.p4.12.m12.3.3.3.4.cmml"><mi id="S3.SS3.p4.12.m12.1.1.1.1" xref="S3.SS3.p4.12.m12.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.12.m12.3.3.3.5.1" xref="S3.SS3.p4.12.m12.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p4.12.m12.2.2.2.2" xref="S3.SS3.p4.12.m12.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p4.12.m12.3.3.3.5.2" xref="S3.SS3.p4.12.m12.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p4.12.m12.3.3.3.3" xref="S3.SS3.p4.12.m12.3.3.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m12.3b"><apply id="S3.SS3.p4.12.m12.3.4.cmml" xref="S3.SS3.p4.12.m12.3.4"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m12.3.4.1.cmml" xref="S3.SS3.p4.12.m12.3.4">subscript</csymbol><ci id="S3.SS3.p4.12.m12.3.4.2.cmml" xref="S3.SS3.p4.12.m12.3.4.2">𝑟</ci><list id="S3.SS3.p4.12.m12.3.3.3.4.cmml" xref="S3.SS3.p4.12.m12.3.3.3.5"><ci id="S3.SS3.p4.12.m12.1.1.1.1.cmml" xref="S3.SS3.p4.12.m12.1.1.1.1">𝑖</ci><ci id="S3.SS3.p4.12.m12.2.2.2.2.cmml" xref="S3.SS3.p4.12.m12.2.2.2.2">𝑙</ci><ci id="S3.SS3.p4.12.m12.3.3.3.3.cmml" xref="S3.SS3.p4.12.m12.3.3.3.3">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m12.3c">r_{i,l,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.12.m12.3d">italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the observed payoff (reward) and is modelled with a Gamma likelihood, which has positive support (<math alttext="r&gt;0" class="ltx_Math" display="inline" id="S3.SS3.p4.13.m13.1"><semantics id="S3.SS3.p4.13.m13.1a"><mrow id="S3.SS3.p4.13.m13.1.1" xref="S3.SS3.p4.13.m13.1.1.cmml"><mi id="S3.SS3.p4.13.m13.1.1.2" xref="S3.SS3.p4.13.m13.1.1.2.cmml">r</mi><mo id="S3.SS3.p4.13.m13.1.1.1" xref="S3.SS3.p4.13.m13.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p4.13.m13.1.1.3" xref="S3.SS3.p4.13.m13.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m13.1b"><apply id="S3.SS3.p4.13.m13.1.1.cmml" xref="S3.SS3.p4.13.m13.1.1"><gt id="S3.SS3.p4.13.m13.1.1.1.cmml" xref="S3.SS3.p4.13.m13.1.1.1"></gt><ci id="S3.SS3.p4.13.m13.1.1.2.cmml" xref="S3.SS3.p4.13.m13.1.1.2">𝑟</ci><cn id="S3.SS3.p4.13.m13.1.1.3.cmml" type="integer" xref="S3.SS3.p4.13.m13.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m13.1c">r&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.13.m13.1d">italic_r &gt; 0</annotation></semantics></math>), since product sales are non-negative. We use HalfNormal priors to ensure that the upper-level coefficients are non-negative, and a Laplace prior to encourage robustness to outliers. We visualize the model with plate notation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.F4" title="Figure 4 ‣ 7.4.2. Complexity of Heuristic Search ‣ 7.4. Complexity Analysis of EdgeRec3D ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> of the supplement. Since RBP is a fully probabilistic model its output is the posterior predictive distribution, <math alttext="p(r_{i,l,k}|x^{(i)}_{q})" class="ltx_Math" display="inline" id="S3.SS3.p4.14.m14.5"><semantics id="S3.SS3.p4.14.m14.5a"><mrow id="S3.SS3.p4.14.m14.5.5" xref="S3.SS3.p4.14.m14.5.5.cmml"><mi id="S3.SS3.p4.14.m14.5.5.3" xref="S3.SS3.p4.14.m14.5.5.3.cmml">p</mi><mo id="S3.SS3.p4.14.m14.5.5.2" xref="S3.SS3.p4.14.m14.5.5.2.cmml">⁢</mo><mrow id="S3.SS3.p4.14.m14.5.5.1.1" xref="S3.SS3.p4.14.m14.5.5.1.1.1.cmml"><mo id="S3.SS3.p4.14.m14.5.5.1.1.2" stretchy="false" xref="S3.SS3.p4.14.m14.5.5.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.14.m14.5.5.1.1.1" xref="S3.SS3.p4.14.m14.5.5.1.1.1.cmml"><msub id="S3.SS3.p4.14.m14.5.5.1.1.1.2" xref="S3.SS3.p4.14.m14.5.5.1.1.1.2.cmml"><mi id="S3.SS3.p4.14.m14.5.5.1.1.1.2.2" xref="S3.SS3.p4.14.m14.5.5.1.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.p4.14.m14.3.3.3.5" xref="S3.SS3.p4.14.m14.3.3.3.4.cmml"><mi id="S3.SS3.p4.14.m14.1.1.1.1" xref="S3.SS3.p4.14.m14.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p4.14.m14.3.3.3.5.1" xref="S3.SS3.p4.14.m14.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p4.14.m14.2.2.2.2" xref="S3.SS3.p4.14.m14.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p4.14.m14.3.3.3.5.2" xref="S3.SS3.p4.14.m14.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p4.14.m14.3.3.3.3" xref="S3.SS3.p4.14.m14.3.3.3.3.cmml">k</mi></mrow></msub><mo fence="false" id="S3.SS3.p4.14.m14.5.5.1.1.1.1" xref="S3.SS3.p4.14.m14.5.5.1.1.1.1.cmml">|</mo><msubsup id="S3.SS3.p4.14.m14.5.5.1.1.1.3" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.cmml"><mi id="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.2" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.2.cmml">x</mi><mi id="S3.SS3.p4.14.m14.5.5.1.1.1.3.3" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.3.cmml">q</mi><mrow id="S3.SS3.p4.14.m14.4.4.1.3" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.cmml"><mo id="S3.SS3.p4.14.m14.4.4.1.3.1" stretchy="false" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p4.14.m14.4.4.1.1" xref="S3.SS3.p4.14.m14.4.4.1.1.cmml">i</mi><mo id="S3.SS3.p4.14.m14.4.4.1.3.2" stretchy="false" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p4.14.m14.5.5.1.1.3" stretchy="false" xref="S3.SS3.p4.14.m14.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m14.5b"><apply id="S3.SS3.p4.14.m14.5.5.cmml" xref="S3.SS3.p4.14.m14.5.5"><times id="S3.SS3.p4.14.m14.5.5.2.cmml" xref="S3.SS3.p4.14.m14.5.5.2"></times><ci id="S3.SS3.p4.14.m14.5.5.3.cmml" xref="S3.SS3.p4.14.m14.5.5.3">𝑝</ci><apply id="S3.SS3.p4.14.m14.5.5.1.1.1.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1"><csymbol cd="latexml" id="S3.SS3.p4.14.m14.5.5.1.1.1.1.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p4.14.m14.5.5.1.1.1.2.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m14.5.5.1.1.1.2.1.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.14.m14.5.5.1.1.1.2.2.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.2.2">𝑟</ci><list id="S3.SS3.p4.14.m14.3.3.3.4.cmml" xref="S3.SS3.p4.14.m14.3.3.3.5"><ci id="S3.SS3.p4.14.m14.1.1.1.1.cmml" xref="S3.SS3.p4.14.m14.1.1.1.1">𝑖</ci><ci id="S3.SS3.p4.14.m14.2.2.2.2.cmml" xref="S3.SS3.p4.14.m14.2.2.2.2">𝑙</ci><ci id="S3.SS3.p4.14.m14.3.3.3.3.cmml" xref="S3.SS3.p4.14.m14.3.3.3.3">𝑘</ci></list></apply><apply id="S3.SS3.p4.14.m14.5.5.1.1.1.3.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m14.5.5.1.1.1.3.1.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.1.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.2.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.2.2">𝑥</ci><ci id="S3.SS3.p4.14.m14.4.4.1.1.cmml" xref="S3.SS3.p4.14.m14.4.4.1.1">𝑖</ci></apply><ci id="S3.SS3.p4.14.m14.5.5.1.1.1.3.3.cmml" xref="S3.SS3.p4.14.m14.5.5.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m14.5c">p(r_{i,l,k}|x^{(i)}_{q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.14.m14.5d">italic_p ( italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT )</annotation></semantics></math>, or our belief about reward given the amount of space allocated to product, <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.15.m15.1"><semantics id="S3.SS3.p4.15.m15.1a"><msub id="S3.SS3.p4.15.m15.1.1" xref="S3.SS3.p4.15.m15.1.1.cmml"><mi id="S3.SS3.p4.15.m15.1.1.2" xref="S3.SS3.p4.15.m15.1.1.2.cmml">p</mi><mi id="S3.SS3.p4.15.m15.1.1.3" xref="S3.SS3.p4.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.15.m15.1b"><apply id="S3.SS3.p4.15.m15.1.1.cmml" xref="S3.SS3.p4.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.15.m15.1.1.1.cmml" xref="S3.SS3.p4.15.m15.1.1">subscript</csymbol><ci id="S3.SS3.p4.15.m15.1.1.2.cmml" xref="S3.SS3.p4.15.m15.1.1.2">𝑝</ci><ci id="S3.SS3.p4.15.m15.1.1.3.cmml" xref="S3.SS3.p4.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.15.m15.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.15.m15.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We train RBP using PyMC <cite class="ltx_cite ltx_citemacro_citep">(Salvatier et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib44" title="">2016</a>)</cite> and the No U-Turn Sampler <cite class="ltx_cite ltx_citemacro_citep">(Hoffman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib24" title="">2014</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Intuitively, we can use <math alttext="p(r_{i,l,k}|x^{(i)}_{q})" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.5"><semantics id="S3.SS3.p5.1.m1.5a"><mrow id="S3.SS3.p5.1.m1.5.5" xref="S3.SS3.p5.1.m1.5.5.cmml"><mi id="S3.SS3.p5.1.m1.5.5.3" xref="S3.SS3.p5.1.m1.5.5.3.cmml">p</mi><mo id="S3.SS3.p5.1.m1.5.5.2" xref="S3.SS3.p5.1.m1.5.5.2.cmml">⁢</mo><mrow id="S3.SS3.p5.1.m1.5.5.1.1" xref="S3.SS3.p5.1.m1.5.5.1.1.1.cmml"><mo id="S3.SS3.p5.1.m1.5.5.1.1.2" stretchy="false" xref="S3.SS3.p5.1.m1.5.5.1.1.1.cmml">(</mo><mrow id="S3.SS3.p5.1.m1.5.5.1.1.1" xref="S3.SS3.p5.1.m1.5.5.1.1.1.cmml"><msub id="S3.SS3.p5.1.m1.5.5.1.1.1.2" xref="S3.SS3.p5.1.m1.5.5.1.1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.5.5.1.1.1.2.2" xref="S3.SS3.p5.1.m1.5.5.1.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.p5.1.m1.3.3.3.5" xref="S3.SS3.p5.1.m1.3.3.3.4.cmml"><mi id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p5.1.m1.3.3.3.5.1" xref="S3.SS3.p5.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p5.1.m1.2.2.2.2" xref="S3.SS3.p5.1.m1.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p5.1.m1.3.3.3.5.2" xref="S3.SS3.p5.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p5.1.m1.3.3.3.3" xref="S3.SS3.p5.1.m1.3.3.3.3.cmml">k</mi></mrow></msub><mo fence="false" id="S3.SS3.p5.1.m1.5.5.1.1.1.1" xref="S3.SS3.p5.1.m1.5.5.1.1.1.1.cmml">|</mo><msubsup id="S3.SS3.p5.1.m1.5.5.1.1.1.3" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.2" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.2.cmml">x</mi><mi id="S3.SS3.p5.1.m1.5.5.1.1.1.3.3" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.3.cmml">q</mi><mrow id="S3.SS3.p5.1.m1.4.4.1.3" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.cmml"><mo id="S3.SS3.p5.1.m1.4.4.1.3.1" stretchy="false" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p5.1.m1.4.4.1.1" xref="S3.SS3.p5.1.m1.4.4.1.1.cmml">i</mi><mo id="S3.SS3.p5.1.m1.4.4.1.3.2" stretchy="false" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p5.1.m1.5.5.1.1.3" stretchy="false" xref="S3.SS3.p5.1.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.5b"><apply id="S3.SS3.p5.1.m1.5.5.cmml" xref="S3.SS3.p5.1.m1.5.5"><times id="S3.SS3.p5.1.m1.5.5.2.cmml" xref="S3.SS3.p5.1.m1.5.5.2"></times><ci id="S3.SS3.p5.1.m1.5.5.3.cmml" xref="S3.SS3.p5.1.m1.5.5.3">𝑝</ci><apply id="S3.SS3.p5.1.m1.5.5.1.1.1.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1"><csymbol cd="latexml" id="S3.SS3.p5.1.m1.5.5.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p5.1.m1.5.5.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.5.5.1.1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.1.m1.5.5.1.1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.2.2">𝑟</ci><list id="S3.SS3.p5.1.m1.3.3.3.4.cmml" xref="S3.SS3.p5.1.m1.3.3.3.5"><ci id="S3.SS3.p5.1.m1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1">𝑖</ci><ci id="S3.SS3.p5.1.m1.2.2.2.2.cmml" xref="S3.SS3.p5.1.m1.2.2.2.2">𝑙</ci><ci id="S3.SS3.p5.1.m1.3.3.3.3.cmml" xref="S3.SS3.p5.1.m1.3.3.3.3">𝑘</ci></list></apply><apply id="S3.SS3.p5.1.m1.5.5.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.5.5.1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.2.2">𝑥</ci><ci id="S3.SS3.p5.1.m1.4.4.1.1.cmml" xref="S3.SS3.p5.1.m1.4.4.1.1">𝑖</ci></apply><ci id="S3.SS3.p5.1.m1.5.5.1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.5.5.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.5c">p(r_{i,l,k}|x^{(i)}_{q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.5d">italic_p ( italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> to derive an uncertainty penalized ranking statistic, Penalized Expected Payoff per Facing (PEPF):</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textrm{PEPF}=\mathbb{E}[r_{i,l,k}]-\lambda\sigma(r_{i,l,k})" class="ltx_Math" display="block" id="S3.E6.m1.8"><semantics id="S3.E6.m1.8a"><mrow id="S3.E6.m1.8.8" xref="S3.E6.m1.8.8.cmml"><mtext id="S3.E6.m1.8.8.4" xref="S3.E6.m1.8.8.4a.cmml">PEPF</mtext><mo id="S3.E6.m1.8.8.3" xref="S3.E6.m1.8.8.3.cmml">=</mo><mrow id="S3.E6.m1.8.8.2" xref="S3.E6.m1.8.8.2.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.3" xref="S3.E6.m1.7.7.1.1.3.cmml">𝔼</mi><mo id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.2.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.2.1.cmml">[</mo><msub id="S3.E6.m1.7.7.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.2.cmml">r</mi><mrow id="S3.E6.m1.3.3.3.5" xref="S3.E6.m1.3.3.3.4.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.3.3.3.5.1" xref="S3.E6.m1.3.3.3.4.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">l</mi><mo id="S3.E6.m1.3.3.3.5.2" xref="S3.E6.m1.3.3.3.4.cmml">,</mo><mi id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.E6.m1.7.7.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E6.m1.8.8.2.3" xref="S3.E6.m1.8.8.2.3.cmml">−</mo><mrow id="S3.E6.m1.8.8.2.2" xref="S3.E6.m1.8.8.2.2.cmml"><mi id="S3.E6.m1.8.8.2.2.3" xref="S3.E6.m1.8.8.2.2.3.cmml">λ</mi><mo id="S3.E6.m1.8.8.2.2.2" xref="S3.E6.m1.8.8.2.2.2.cmml">⁢</mo><mi id="S3.E6.m1.8.8.2.2.4" xref="S3.E6.m1.8.8.2.2.4.cmml">σ</mi><mo id="S3.E6.m1.8.8.2.2.2a" xref="S3.E6.m1.8.8.2.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.8.8.2.2.1.1" xref="S3.E6.m1.8.8.2.2.1.1.1.cmml"><mo id="S3.E6.m1.8.8.2.2.1.1.2" stretchy="false" xref="S3.E6.m1.8.8.2.2.1.1.1.cmml">(</mo><msub id="S3.E6.m1.8.8.2.2.1.1.1" xref="S3.E6.m1.8.8.2.2.1.1.1.cmml"><mi id="S3.E6.m1.8.8.2.2.1.1.1.2" xref="S3.E6.m1.8.8.2.2.1.1.1.2.cmml">r</mi><mrow id="S3.E6.m1.6.6.3.5" xref="S3.E6.m1.6.6.3.4.cmml"><mi id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml">i</mi><mo id="S3.E6.m1.6.6.3.5.1" xref="S3.E6.m1.6.6.3.4.cmml">,</mo><mi id="S3.E6.m1.5.5.2.2" xref="S3.E6.m1.5.5.2.2.cmml">l</mi><mo id="S3.E6.m1.6.6.3.5.2" xref="S3.E6.m1.6.6.3.4.cmml">,</mo><mi id="S3.E6.m1.6.6.3.3" xref="S3.E6.m1.6.6.3.3.cmml">k</mi></mrow></msub><mo id="S3.E6.m1.8.8.2.2.1.1.3" stretchy="false" xref="S3.E6.m1.8.8.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.8b"><apply id="S3.E6.m1.8.8.cmml" xref="S3.E6.m1.8.8"><eq id="S3.E6.m1.8.8.3.cmml" xref="S3.E6.m1.8.8.3"></eq><ci id="S3.E6.m1.8.8.4a.cmml" xref="S3.E6.m1.8.8.4"><mtext id="S3.E6.m1.8.8.4.cmml" xref="S3.E6.m1.8.8.4">PEPF</mtext></ci><apply id="S3.E6.m1.8.8.2.cmml" xref="S3.E6.m1.8.8.2"><minus id="S3.E6.m1.8.8.2.3.cmml" xref="S3.E6.m1.8.8.2.3"></minus><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1.1"><times id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"></times><ci id="S3.E6.m1.7.7.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.3">𝔼</ci><apply id="S3.E6.m1.7.7.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.2">𝑟</ci><list id="S3.E6.m1.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.5"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑙</ci><ci id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3">𝑘</ci></list></apply></apply></apply><apply id="S3.E6.m1.8.8.2.2.cmml" xref="S3.E6.m1.8.8.2.2"><times id="S3.E6.m1.8.8.2.2.2.cmml" xref="S3.E6.m1.8.8.2.2.2"></times><ci id="S3.E6.m1.8.8.2.2.3.cmml" xref="S3.E6.m1.8.8.2.2.3">𝜆</ci><ci id="S3.E6.m1.8.8.2.2.4.cmml" xref="S3.E6.m1.8.8.2.2.4">𝜎</ci><apply id="S3.E6.m1.8.8.2.2.1.1.1.cmml" xref="S3.E6.m1.8.8.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.2.2.1.1.1.1.cmml" xref="S3.E6.m1.8.8.2.2.1.1">subscript</csymbol><ci id="S3.E6.m1.8.8.2.2.1.1.1.2.cmml" xref="S3.E6.m1.8.8.2.2.1.1.1.2">𝑟</ci><list id="S3.E6.m1.6.6.3.4.cmml" xref="S3.E6.m1.6.6.3.5"><ci id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1.1">𝑖</ci><ci id="S3.E6.m1.5.5.2.2.cmml" xref="S3.E6.m1.5.5.2.2">𝑙</ci><ci id="S3.E6.m1.6.6.3.3.cmml" xref="S3.E6.m1.6.6.3.3">𝑘</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.8c">\textrm{PEPF}=\mathbb{E}[r_{i,l,k}]-\lambda\sigma(r_{i,l,k})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.8d">PEPF = blackboard_E [ italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT ] - italic_λ italic_σ ( italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.6">Where <math alttext="\mathbb{E}[r_{i,l,k}]" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.4"><semantics id="S3.SS3.p7.1.m1.4a"><mrow id="S3.SS3.p7.1.m1.4.4" xref="S3.SS3.p7.1.m1.4.4.cmml"><mi id="S3.SS3.p7.1.m1.4.4.3" xref="S3.SS3.p7.1.m1.4.4.3.cmml">𝔼</mi><mo id="S3.SS3.p7.1.m1.4.4.2" xref="S3.SS3.p7.1.m1.4.4.2.cmml">⁢</mo><mrow id="S3.SS3.p7.1.m1.4.4.1.1" xref="S3.SS3.p7.1.m1.4.4.1.2.cmml"><mo id="S3.SS3.p7.1.m1.4.4.1.1.2" stretchy="false" xref="S3.SS3.p7.1.m1.4.4.1.2.1.cmml">[</mo><msub id="S3.SS3.p7.1.m1.4.4.1.1.1" xref="S3.SS3.p7.1.m1.4.4.1.1.1.cmml"><mi id="S3.SS3.p7.1.m1.4.4.1.1.1.2" xref="S3.SS3.p7.1.m1.4.4.1.1.1.2.cmml">r</mi><mrow id="S3.SS3.p7.1.m1.3.3.3.5" xref="S3.SS3.p7.1.m1.3.3.3.4.cmml"><mi id="S3.SS3.p7.1.m1.1.1.1.1" xref="S3.SS3.p7.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p7.1.m1.3.3.3.5.1" xref="S3.SS3.p7.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.1.m1.2.2.2.2" xref="S3.SS3.p7.1.m1.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p7.1.m1.3.3.3.5.2" xref="S3.SS3.p7.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.1.m1.3.3.3.3" xref="S3.SS3.p7.1.m1.3.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS3.p7.1.m1.4.4.1.1.3" stretchy="false" xref="S3.SS3.p7.1.m1.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.4b"><apply id="S3.SS3.p7.1.m1.4.4.cmml" xref="S3.SS3.p7.1.m1.4.4"><times id="S3.SS3.p7.1.m1.4.4.2.cmml" xref="S3.SS3.p7.1.m1.4.4.2"></times><ci id="S3.SS3.p7.1.m1.4.4.3.cmml" xref="S3.SS3.p7.1.m1.4.4.3">𝔼</ci><apply id="S3.SS3.p7.1.m1.4.4.1.2.cmml" xref="S3.SS3.p7.1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.SS3.p7.1.m1.4.4.1.2.1.cmml" xref="S3.SS3.p7.1.m1.4.4.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p7.1.m1.4.4.1.1.1.cmml" xref="S3.SS3.p7.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.SS3.p7.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS3.p7.1.m1.4.4.1.1.1.2">𝑟</ci><list id="S3.SS3.p7.1.m1.3.3.3.4.cmml" xref="S3.SS3.p7.1.m1.3.3.3.5"><ci id="S3.SS3.p7.1.m1.1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1.1.1">𝑖</ci><ci id="S3.SS3.p7.1.m1.2.2.2.2.cmml" xref="S3.SS3.p7.1.m1.2.2.2.2">𝑙</ci><ci id="S3.SS3.p7.1.m1.3.3.3.3.cmml" xref="S3.SS3.p7.1.m1.3.3.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.4c">\mathbb{E}[r_{i,l,k}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.4d">blackboard_E [ italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math> and <math alttext="\sigma(r_{i,l,k})" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.4"><semantics id="S3.SS3.p7.2.m2.4a"><mrow id="S3.SS3.p7.2.m2.4.4" xref="S3.SS3.p7.2.m2.4.4.cmml"><mi id="S3.SS3.p7.2.m2.4.4.3" xref="S3.SS3.p7.2.m2.4.4.3.cmml">σ</mi><mo id="S3.SS3.p7.2.m2.4.4.2" xref="S3.SS3.p7.2.m2.4.4.2.cmml">⁢</mo><mrow id="S3.SS3.p7.2.m2.4.4.1.1" xref="S3.SS3.p7.2.m2.4.4.1.1.1.cmml"><mo id="S3.SS3.p7.2.m2.4.4.1.1.2" stretchy="false" xref="S3.SS3.p7.2.m2.4.4.1.1.1.cmml">(</mo><msub id="S3.SS3.p7.2.m2.4.4.1.1.1" xref="S3.SS3.p7.2.m2.4.4.1.1.1.cmml"><mi id="S3.SS3.p7.2.m2.4.4.1.1.1.2" xref="S3.SS3.p7.2.m2.4.4.1.1.1.2.cmml">r</mi><mrow id="S3.SS3.p7.2.m2.3.3.3.5" xref="S3.SS3.p7.2.m2.3.3.3.4.cmml"><mi id="S3.SS3.p7.2.m2.1.1.1.1" xref="S3.SS3.p7.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p7.2.m2.3.3.3.5.1" xref="S3.SS3.p7.2.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.2.m2.2.2.2.2" xref="S3.SS3.p7.2.m2.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p7.2.m2.3.3.3.5.2" xref="S3.SS3.p7.2.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.2.m2.3.3.3.3" xref="S3.SS3.p7.2.m2.3.3.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS3.p7.2.m2.4.4.1.1.3" stretchy="false" xref="S3.SS3.p7.2.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.4b"><apply id="S3.SS3.p7.2.m2.4.4.cmml" xref="S3.SS3.p7.2.m2.4.4"><times id="S3.SS3.p7.2.m2.4.4.2.cmml" xref="S3.SS3.p7.2.m2.4.4.2"></times><ci id="S3.SS3.p7.2.m2.4.4.3.cmml" xref="S3.SS3.p7.2.m2.4.4.3">𝜎</ci><apply id="S3.SS3.p7.2.m2.4.4.1.1.1.cmml" xref="S3.SS3.p7.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS3.p7.2.m2.4.4.1.1">subscript</csymbol><ci id="S3.SS3.p7.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS3.p7.2.m2.4.4.1.1.1.2">𝑟</ci><list id="S3.SS3.p7.2.m2.3.3.3.4.cmml" xref="S3.SS3.p7.2.m2.3.3.3.5"><ci id="S3.SS3.p7.2.m2.1.1.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p7.2.m2.2.2.2.2.cmml" xref="S3.SS3.p7.2.m2.2.2.2.2">𝑙</ci><ci id="S3.SS3.p7.2.m2.3.3.3.3.cmml" xref="S3.SS3.p7.2.m2.3.3.3.3">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.4c">\sigma(r_{i,l,k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.4d">italic_σ ( italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> are the mean and standard deviation of <math alttext="p(r_{i,l,k}|x^{(i)}_{q})" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.5"><semantics id="S3.SS3.p7.3.m3.5a"><mrow id="S3.SS3.p7.3.m3.5.5" xref="S3.SS3.p7.3.m3.5.5.cmml"><mi id="S3.SS3.p7.3.m3.5.5.3" xref="S3.SS3.p7.3.m3.5.5.3.cmml">p</mi><mo id="S3.SS3.p7.3.m3.5.5.2" xref="S3.SS3.p7.3.m3.5.5.2.cmml">⁢</mo><mrow id="S3.SS3.p7.3.m3.5.5.1.1" xref="S3.SS3.p7.3.m3.5.5.1.1.1.cmml"><mo id="S3.SS3.p7.3.m3.5.5.1.1.2" stretchy="false" xref="S3.SS3.p7.3.m3.5.5.1.1.1.cmml">(</mo><mrow id="S3.SS3.p7.3.m3.5.5.1.1.1" xref="S3.SS3.p7.3.m3.5.5.1.1.1.cmml"><msub id="S3.SS3.p7.3.m3.5.5.1.1.1.2" xref="S3.SS3.p7.3.m3.5.5.1.1.1.2.cmml"><mi id="S3.SS3.p7.3.m3.5.5.1.1.1.2.2" xref="S3.SS3.p7.3.m3.5.5.1.1.1.2.2.cmml">r</mi><mrow id="S3.SS3.p7.3.m3.3.3.3.5" xref="S3.SS3.p7.3.m3.3.3.3.4.cmml"><mi id="S3.SS3.p7.3.m3.1.1.1.1" xref="S3.SS3.p7.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p7.3.m3.3.3.3.5.1" xref="S3.SS3.p7.3.m3.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.3.m3.2.2.2.2" xref="S3.SS3.p7.3.m3.2.2.2.2.cmml">l</mi><mo id="S3.SS3.p7.3.m3.3.3.3.5.2" xref="S3.SS3.p7.3.m3.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p7.3.m3.3.3.3.3" xref="S3.SS3.p7.3.m3.3.3.3.3.cmml">k</mi></mrow></msub><mo fence="false" id="S3.SS3.p7.3.m3.5.5.1.1.1.1" xref="S3.SS3.p7.3.m3.5.5.1.1.1.1.cmml">|</mo><msubsup id="S3.SS3.p7.3.m3.5.5.1.1.1.3" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.cmml"><mi id="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.2" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.2.cmml">x</mi><mi id="S3.SS3.p7.3.m3.5.5.1.1.1.3.3" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.3.cmml">q</mi><mrow id="S3.SS3.p7.3.m3.4.4.1.3" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.cmml"><mo id="S3.SS3.p7.3.m3.4.4.1.3.1" stretchy="false" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p7.3.m3.4.4.1.1" xref="S3.SS3.p7.3.m3.4.4.1.1.cmml">i</mi><mo id="S3.SS3.p7.3.m3.4.4.1.3.2" stretchy="false" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p7.3.m3.5.5.1.1.3" stretchy="false" xref="S3.SS3.p7.3.m3.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.5b"><apply id="S3.SS3.p7.3.m3.5.5.cmml" xref="S3.SS3.p7.3.m3.5.5"><times id="S3.SS3.p7.3.m3.5.5.2.cmml" xref="S3.SS3.p7.3.m3.5.5.2"></times><ci id="S3.SS3.p7.3.m3.5.5.3.cmml" xref="S3.SS3.p7.3.m3.5.5.3">𝑝</ci><apply id="S3.SS3.p7.3.m3.5.5.1.1.1.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1"><csymbol cd="latexml" id="S3.SS3.p7.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p7.3.m3.5.5.1.1.1.2.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.5.5.1.1.1.2.1.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p7.3.m3.5.5.1.1.1.2.2.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.2.2">𝑟</ci><list id="S3.SS3.p7.3.m3.3.3.3.4.cmml" xref="S3.SS3.p7.3.m3.3.3.3.5"><ci id="S3.SS3.p7.3.m3.1.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS3.p7.3.m3.2.2.2.2.cmml" xref="S3.SS3.p7.3.m3.2.2.2.2">𝑙</ci><ci id="S3.SS3.p7.3.m3.3.3.3.3.cmml" xref="S3.SS3.p7.3.m3.3.3.3.3">𝑘</ci></list></apply><apply id="S3.SS3.p7.3.m3.5.5.1.1.1.3.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.5.5.1.1.1.3.1.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.1.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.2.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.2.2">𝑥</ci><ci id="S3.SS3.p7.3.m3.4.4.1.1.cmml" xref="S3.SS3.p7.3.m3.4.4.1.1">𝑖</ci></apply><ci id="S3.SS3.p7.3.m3.5.5.1.1.1.3.3.cmml" xref="S3.SS3.p7.3.m3.5.5.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.5c">p(r_{i,l,k}|x^{(i)}_{q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.5d">italic_p ( italic_r start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT )</annotation></semantics></math>. We treat the penalty coefficient, <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><mi id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><ci id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_λ</annotation></semantics></math>, as a user-chosen hyperparameter. Larger <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><mi id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><ci id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">italic_λ</annotation></semantics></math> values correspond to more aggressive discounting of uncertain product recommendations. Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.E6" title="Equation 6 ‣ 3.3. Value estimation: Robust Bayesian Payoffs (RBP) ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">6</span></a> takes a similar form to Upper Confidence Bound (UCB) estimators in multi-armed bandit problems. UCB estimators <cite class="ltx_cite ltx_citemacro_citep">(Auer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib5" title="">2002</a>)</cite> have been shown to optimally manage the exploration-exploitation tradeoff. However, they systematically take actions with high expected payoff and <span class="ltx_text ltx_font_italic" id="S3.SS3.p7.6.1">high uncertainty</span>. UCB policies take actions that might increase short-term regret, but obtain more information about an action’s payoff and therefore minimize long-term regret. Conversely, recent work has shown that using an uncertainty penalized reward estimator can encourage safe policies <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib51" title="">2020</a>; Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib28" title="">2022</a>)</cite> in real-world reinforcement learning. In this penalized regime, the policy tends to choose actions with high expected payoff and <span class="ltx_text ltx_font_italic" id="S3.SS3.p7.6.2">low uncertainty</span>. Additionally, Yu et al. <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib51" title="">2020</a>)</cite> prove that the penalized reward estimator maximizes the lower bound of the true reward. We prefer the uncertainty penalized estimator over UCB because it is both theoretically sound and useful in real-world problems where errors are costly. In our experiments, we set <math alttext="\lambda=1" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m6.1"><semantics id="S3.SS3.p7.6.m6.1a"><mrow id="S3.SS3.p7.6.m6.1.1" xref="S3.SS3.p7.6.m6.1.1.cmml"><mi id="S3.SS3.p7.6.m6.1.1.2" xref="S3.SS3.p7.6.m6.1.1.2.cmml">λ</mi><mo id="S3.SS3.p7.6.m6.1.1.1" xref="S3.SS3.p7.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS3.p7.6.m6.1.1.3" xref="S3.SS3.p7.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m6.1b"><apply id="S3.SS3.p7.6.m6.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1"><eq id="S3.SS3.p7.6.m6.1.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1.1"></eq><ci id="S3.SS3.p7.6.m6.1.1.2.cmml" xref="S3.SS3.p7.6.m6.1.1.2">𝜆</ci><cn id="S3.SS3.p7.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.p7.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m6.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m6.1d">italic_λ = 1</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Candidate Generation</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We generate candidates to reduce the search space of products. We desire products that are physically and semantically compatible with the observed state of the display. Our candidate generation is comprised of three major steps: graph construction, sampling, and pruning. The initial product set observed on each display is treated as a “seed set” to seed the candidate generator.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.1">Graph Construction:</span> Mining a live database of observed display states (a list of products on a display at a specific time) we construct a weighted graph of products. Each node is a product and each edge is the number of times that two products appear together on the same display. Products that appear together frequently have very large edge weights while products that appear together rarely have small edge weights. Each product in our dataset is assigned to one of 5 sub-categories (Sparkling, Water, Isotonic, Rejuvenate, or Energy). We restrict our graph to only contain edges between products of the same sub-category. This graph partitioning ensures product consistency between the candidate set and the seed set. The graph is updated on a weekly basis.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.2.1">Sampling:</span>
To create the candidate set we first sample from neighbors of the seed set, proportional to the edge weights. For each seed product <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><msub id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">p</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝑝</ci><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we sample <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">italic_τ</annotation></semantics></math> products without replacement from its neighbors with respect to the edge weights. Each product sampled is given one “vote”, which are then summed and normalized across all of the seed products. The output of this operation is an initial candidate set.</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">Pruning:</span>
We prune the set of candidates based on known product dimensions from a product database. We compare the maximum height of any product in the “seed” set against the initial candidate set, and remove any products whose height exceeds that of the max of the seed set. This step ensures candidates will physically fit on the product display.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Heuristic Search</h3>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Heuristic Search</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_text ltx_font_bold" id="alg2.l1.1" style="font-size:90%;">Input</span><span class="ltx_text" id="alg2.l1.2" style="font-size:90%;">: Candidate set, </span><math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.1" mathsize="90%" xref="alg2.l1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">caligraphic_C</annotation></semantics></math><span class="ltx_text" id="alg2.l1.3" style="font-size:90%;">, Observed state set </span><math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m2.1.1" mathsize="90%" xref="alg2.l1.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">caligraphic_S</annotation></semantics></math><span class="ltx_text" id="alg2.l1.4" style="font-size:90%;">, scoring function </span><math alttext="f(\cdot)" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1.2" xref="alg2.l1.m3.1.2.cmml"><mi id="alg2.l1.m3.1.2.2" mathsize="90%" xref="alg2.l1.m3.1.2.2.cmml">f</mi><mo id="alg2.l1.m3.1.2.1" xref="alg2.l1.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.l1.m3.1.2.3.2" xref="alg2.l1.m3.1.2.cmml"><mo id="alg2.l1.m3.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l1.m3.1.2.cmml">(</mo><mo id="alg2.l1.m3.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l1.m3.1.1.cmml">⋅</mo><mo id="alg2.l1.m3.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l1.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.2.cmml" xref="alg2.l1.m3.1.2"><times id="alg2.l1.m3.1.2.1.cmml" xref="alg2.l1.m3.1.2.1"></times><ci id="alg2.l1.m3.1.2.2.cmml" xref="alg2.l1.m3.1.2.2">𝑓</ci><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_f ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l1.5" style="font-size:90%;">, decay function </span><math alttext="\delta(\cdot)" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><mrow id="alg2.l1.m4.1.2" xref="alg2.l1.m4.1.2.cmml"><mi id="alg2.l1.m4.1.2.2" mathsize="90%" xref="alg2.l1.m4.1.2.2.cmml">δ</mi><mo id="alg2.l1.m4.1.2.1" xref="alg2.l1.m4.1.2.1.cmml">⁢</mo><mrow id="alg2.l1.m4.1.2.3.2" xref="alg2.l1.m4.1.2.cmml"><mo id="alg2.l1.m4.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l1.m4.1.2.cmml">(</mo><mo id="alg2.l1.m4.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l1.m4.1.1.cmml">⋅</mo><mo id="alg2.l1.m4.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l1.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.2.cmml" xref="alg2.l1.m4.1.2"><times id="alg2.l1.m4.1.2.1.cmml" xref="alg2.l1.m4.1.2.1"></times><ci id="alg2.l1.m4.1.2.2.cmml" xref="alg2.l1.m4.1.2.2">𝛿</ci><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">\delta(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_δ ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l1.6" style="font-size:90%;">, number of products to swap </span><math alttext="V" class="ltx_Math" display="inline" id="alg2.l1.m5.1"><semantics id="alg2.l1.m5.1a"><mi id="alg2.l1.m5.1.1" mathsize="90%" xref="alg2.l1.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><ci id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m5.1d">italic_V</annotation></semantics></math><span class="ltx_text" id="alg2.l1.7" style="font-size:90%;">, time steps </span><math alttext="T" class="ltx_Math" display="inline" id="alg2.l1.m6.1"><semantics id="alg2.l1.m6.1a"><mi id="alg2.l1.m6.1.1" mathsize="90%" xref="alg2.l1.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><ci id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m6.1d">italic_T</annotation></semantics></math><span class="ltx_text" id="alg2.l1.8" style="font-size:90%;">, epsilon-greedy parameter </span><math alttext="\epsilon" class="ltx_Math" display="inline" id="alg2.l1.m7.1"><semantics id="alg2.l1.m7.1a"><mi id="alg2.l1.m7.1.1" mathsize="90%" xref="alg2.l1.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m7.1b"><ci id="alg2.l1.m7.1.1.cmml" xref="alg2.l1.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m7.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m7.1d">italic_ϵ</annotation></semantics></math><span class="ltx_text" id="alg2.l1.9" style="font-size:90%;">, maximum product facings </span><math alttext="M" class="ltx_Math" display="inline" id="alg2.l1.m8.1"><semantics id="alg2.l1.m8.1a"><mi id="alg2.l1.m8.1.1" mathsize="90%" xref="alg2.l1.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m8.1b"><ci id="alg2.l1.m8.1.1.cmml" xref="alg2.l1.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m8.1d">italic_M</annotation></semantics></math><span class="ltx_text" id="alg2.l1.10" style="font-size:90%;">, product-quantity lookup </span><math alttext="Q_{s}" class="ltx_Math" display="inline" id="alg2.l1.m9.1"><semantics id="alg2.l1.m9.1a"><msub id="alg2.l1.m9.1.1" xref="alg2.l1.m9.1.1.cmml"><mi id="alg2.l1.m9.1.1.2" mathsize="90%" xref="alg2.l1.m9.1.1.2.cmml">Q</mi><mi id="alg2.l1.m9.1.1.3" mathsize="90%" xref="alg2.l1.m9.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m9.1b"><apply id="alg2.l1.m9.1.1.cmml" xref="alg2.l1.m9.1.1"><csymbol cd="ambiguous" id="alg2.l1.m9.1.1.1.cmml" xref="alg2.l1.m9.1.1">subscript</csymbol><ci id="alg2.l1.m9.1.1.2.cmml" xref="alg2.l1.m9.1.1.2">𝑄</ci><ci id="alg2.l1.m9.1.1.3.cmml" xref="alg2.l1.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m9.1c">Q_{s}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m9.1d">italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l1.11" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_text ltx_font_bold" id="alg2.l2.1" style="font-size:90%;">Output</span><span class="ltx_text" id="alg2.l2.2" style="font-size:90%;">: Recommended product-quantity lookup </span><math alttext="R" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" mathsize="90%" xref="alg2.l2.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_R</annotation></semantics></math><span class="ltx_text" id="alg2.l2.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<math alttext="B\leftarrow M" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" mathsize="90%" xref="alg2.l3.m1.1.1.2.cmml">B</mi><mo id="alg2.l3.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.l3.m1.1.1.1.cmml">←</mo><mi id="alg2.l3.m1.1.1.3" mathsize="90%" xref="alg2.l3.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">←</ci><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝐵</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">B\leftarrow M</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_B ← italic_M</annotation></semantics></math><span class="ltx_text" id="alg2.l3.1" style="font-size:90%;">, assign budget, </span><math alttext="B" class="ltx_Math" display="inline" id="alg2.l3.m2.1"><semantics id="alg2.l3.m2.1a"><mi id="alg2.l3.m2.1.1" mathsize="90%" xref="alg2.l3.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m2.1d">italic_B</annotation></semantics></math><span class="ltx_text" id="alg2.l3.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<math alttext="R\leftarrow" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" mathsize="90%" xref="alg2.l4.m1.1.1.2.cmml">R</mi><mo id="alg2.l4.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.l4.m1.1.1.1.cmml">←</mo><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑅</ci><csymbol cd="latexml" id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">R\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_R ←</annotation></semantics></math><span class="ltx_text" id="alg2.l4.1" style="font-size:90%;"> KeyValue[], Initialize recommendation lookup
</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_text ltx_font_bold" id="alg2.l5.1" style="font-size:90%;">for</span><span class="ltx_text" id="alg2.l5.2" style="font-size:90%;"> </span><math alttext="t" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mi id="alg2.l5.m1.1.1" mathsize="90%" xref="alg2.l5.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_t</annotation></semantics></math><span class="ltx_text" id="alg2.l5.3" style="font-size:90%;"> in </span><math alttext="T" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" mathsize="90%" xref="alg2.l5.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">italic_T</annotation></semantics></math><span class="ltx_text" id="alg2.l5.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l5.5" style="font-size:90%;">do</span><span class="ltx_text" id="alg2.l5.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_text" id="alg2.l6.2" style="font-size:90%;">    </span><math alttext="\mathcal{C}=f(\mathcal{C})" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.2" xref="alg2.l6.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.2.2" mathsize="90%" xref="alg2.l6.m1.1.2.2.cmml">𝒞</mi><mo id="alg2.l6.m1.1.2.1" mathsize="90%" xref="alg2.l6.m1.1.2.1.cmml">=</mo><mrow id="alg2.l6.m1.1.2.3" xref="alg2.l6.m1.1.2.3.cmml"><mi id="alg2.l6.m1.1.2.3.2" mathsize="90%" xref="alg2.l6.m1.1.2.3.2.cmml">f</mi><mo id="alg2.l6.m1.1.2.3.1" xref="alg2.l6.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l6.m1.1.2.3.3.2" xref="alg2.l6.m1.1.2.3.cmml"><mo id="alg2.l6.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l6.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1" mathsize="90%" xref="alg2.l6.m1.1.1.cmml">𝒞</mi><mo id="alg2.l6.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l6.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.2.cmml" xref="alg2.l6.m1.1.2"><eq id="alg2.l6.m1.1.2.1.cmml" xref="alg2.l6.m1.1.2.1"></eq><ci id="alg2.l6.m1.1.2.2.cmml" xref="alg2.l6.m1.1.2.2">𝒞</ci><apply id="alg2.l6.m1.1.2.3.cmml" xref="alg2.l6.m1.1.2.3"><times id="alg2.l6.m1.1.2.3.1.cmml" xref="alg2.l6.m1.1.2.3.1"></times><ci id="alg2.l6.m1.1.2.3.2.cmml" xref="alg2.l6.m1.1.2.3.2">𝑓</ci><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\mathcal{C}=f(\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">caligraphic_C = italic_f ( caligraphic_C )</annotation></semantics></math><span class="ltx_text" id="alg2.l6.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l6.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l6.1.m1.1"><semantics id="alg2.l6.1.m1.1a"><mo id="alg2.l6.1.m1.1.1" xref="alg2.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.1.m1.1b"><ci id="alg2.l6.1.m1.1.1.cmml" xref="alg2.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.1.m1.1d">▷</annotation></semantics></math> score candidates, assign PEPF
</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_text" id="alg2.l7.2" style="font-size:90%;">    </span><math alttext="\mathcal{S}=f(\mathcal{S})" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.2" xref="alg2.l7.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.2.2" mathsize="90%" xref="alg2.l7.m1.1.2.2.cmml">𝒮</mi><mo id="alg2.l7.m1.1.2.1" mathsize="90%" xref="alg2.l7.m1.1.2.1.cmml">=</mo><mrow id="alg2.l7.m1.1.2.3" xref="alg2.l7.m1.1.2.3.cmml"><mi id="alg2.l7.m1.1.2.3.2" mathsize="90%" xref="alg2.l7.m1.1.2.3.2.cmml">f</mi><mo id="alg2.l7.m1.1.2.3.1" xref="alg2.l7.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l7.m1.1.2.3.3.2" xref="alg2.l7.m1.1.2.3.cmml"><mo id="alg2.l7.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l7.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1" mathsize="90%" xref="alg2.l7.m1.1.1.cmml">𝒮</mi><mo id="alg2.l7.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l7.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.2.cmml" xref="alg2.l7.m1.1.2"><eq id="alg2.l7.m1.1.2.1.cmml" xref="alg2.l7.m1.1.2.1"></eq><ci id="alg2.l7.m1.1.2.2.cmml" xref="alg2.l7.m1.1.2.2">𝒮</ci><apply id="alg2.l7.m1.1.2.3.cmml" xref="alg2.l7.m1.1.2.3"><times id="alg2.l7.m1.1.2.3.1.cmml" xref="alg2.l7.m1.1.2.3.1"></times><ci id="alg2.l7.m1.1.2.3.2.cmml" xref="alg2.l7.m1.1.2.3.2">𝑓</ci><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\mathcal{S}=f(\mathcal{S})</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">caligraphic_S = italic_f ( caligraphic_S )</annotation></semantics></math><span class="ltx_text" id="alg2.l7.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l7.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l7.1.m1.1"><semantics id="alg2.l7.1.m1.1a"><mo id="alg2.l7.1.m1.1.1" xref="alg2.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l7.1.m1.1b"><ci id="alg2.l7.1.m1.1.1.cmml" xref="alg2.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.1.m1.1d">▷</annotation></semantics></math> score current state, assign PEPF
</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_text" id="alg2.l8.2" style="font-size:90%;">    </span><math alttext="\tilde{\mathcal{C}}=\textrm{sort}(\mathcal{C})" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.2" xref="alg2.l8.m1.1.2.cmml"><mover accent="true" id="alg2.l8.m1.1.2.2" xref="alg2.l8.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.2.2.2" mathsize="90%" xref="alg2.l8.m1.1.2.2.2.cmml">𝒞</mi><mo id="alg2.l8.m1.1.2.2.1" mathsize="90%" xref="alg2.l8.m1.1.2.2.1.cmml">~</mo></mover><mo id="alg2.l8.m1.1.2.1" mathsize="90%" xref="alg2.l8.m1.1.2.1.cmml">=</mo><mrow id="alg2.l8.m1.1.2.3" xref="alg2.l8.m1.1.2.3.cmml"><mtext id="alg2.l8.m1.1.2.3.2" mathsize="90%" xref="alg2.l8.m1.1.2.3.2a.cmml">sort</mtext><mo id="alg2.l8.m1.1.2.3.1" xref="alg2.l8.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l8.m1.1.2.3.3.2" xref="alg2.l8.m1.1.2.3.cmml"><mo id="alg2.l8.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l8.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1" mathsize="90%" xref="alg2.l8.m1.1.1.cmml">𝒞</mi><mo id="alg2.l8.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.2.cmml" xref="alg2.l8.m1.1.2"><eq id="alg2.l8.m1.1.2.1.cmml" xref="alg2.l8.m1.1.2.1"></eq><apply id="alg2.l8.m1.1.2.2.cmml" xref="alg2.l8.m1.1.2.2"><ci id="alg2.l8.m1.1.2.2.1.cmml" xref="alg2.l8.m1.1.2.2.1">~</ci><ci id="alg2.l8.m1.1.2.2.2.cmml" xref="alg2.l8.m1.1.2.2.2">𝒞</ci></apply><apply id="alg2.l8.m1.1.2.3.cmml" xref="alg2.l8.m1.1.2.3"><times id="alg2.l8.m1.1.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.1"></times><ci id="alg2.l8.m1.1.2.3.2a.cmml" xref="alg2.l8.m1.1.2.3.2"><mtext id="alg2.l8.m1.1.2.3.2.cmml" mathsize="90%" xref="alg2.l8.m1.1.2.3.2">sort</mtext></ci><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\tilde{\mathcal{C}}=\textrm{sort}(\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">over~ start_ARG caligraphic_C end_ARG = sort ( caligraphic_C )</annotation></semantics></math><span class="ltx_text" id="alg2.l8.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l8.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l8.1.m1.1"><semantics id="alg2.l8.1.m1.1a"><mo id="alg2.l8.1.m1.1.1" xref="alg2.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><ci id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.1.m1.1d">▷</annotation></semantics></math> sort candidates by PEPF ascending
</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_text" id="alg2.l9.2" style="font-size:90%;">    </span><math alttext="\tilde{\mathcal{S}}=\textrm{sort}(\mathcal{S})" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.2" xref="alg2.l9.m1.1.2.cmml"><mover accent="true" id="alg2.l9.m1.1.2.2" xref="alg2.l9.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.2.2.2" mathsize="90%" xref="alg2.l9.m1.1.2.2.2.cmml">𝒮</mi><mo id="alg2.l9.m1.1.2.2.1" mathsize="90%" xref="alg2.l9.m1.1.2.2.1.cmml">~</mo></mover><mo id="alg2.l9.m1.1.2.1" mathsize="90%" xref="alg2.l9.m1.1.2.1.cmml">=</mo><mrow id="alg2.l9.m1.1.2.3" xref="alg2.l9.m1.1.2.3.cmml"><mtext id="alg2.l9.m1.1.2.3.2" mathsize="90%" xref="alg2.l9.m1.1.2.3.2a.cmml">sort</mtext><mo id="alg2.l9.m1.1.2.3.1" xref="alg2.l9.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l9.m1.1.2.3.3.2" xref="alg2.l9.m1.1.2.3.cmml"><mo id="alg2.l9.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l9.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.1" mathsize="90%" xref="alg2.l9.m1.1.1.cmml">𝒮</mi><mo id="alg2.l9.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l9.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.2.cmml" xref="alg2.l9.m1.1.2"><eq id="alg2.l9.m1.1.2.1.cmml" xref="alg2.l9.m1.1.2.1"></eq><apply id="alg2.l9.m1.1.2.2.cmml" xref="alg2.l9.m1.1.2.2"><ci id="alg2.l9.m1.1.2.2.1.cmml" xref="alg2.l9.m1.1.2.2.1">~</ci><ci id="alg2.l9.m1.1.2.2.2.cmml" xref="alg2.l9.m1.1.2.2.2">𝒮</ci></apply><apply id="alg2.l9.m1.1.2.3.cmml" xref="alg2.l9.m1.1.2.3"><times id="alg2.l9.m1.1.2.3.1.cmml" xref="alg2.l9.m1.1.2.3.1"></times><ci id="alg2.l9.m1.1.2.3.2a.cmml" xref="alg2.l9.m1.1.2.3.2"><mtext id="alg2.l9.m1.1.2.3.2.cmml" mathsize="90%" xref="alg2.l9.m1.1.2.3.2">sort</mtext></ci><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\tilde{\mathcal{S}}=\textrm{sort}(\mathcal{S})</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">over~ start_ARG caligraphic_S end_ARG = sort ( caligraphic_S )</annotation></semantics></math><span class="ltx_text" id="alg2.l9.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l9.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l9.1.m1.1"><semantics id="alg2.l9.1.m1.1a"><mo id="alg2.l9.1.m1.1.1" xref="alg2.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l9.1.m1.1b"><ci id="alg2.l9.1.m1.1.1.cmml" xref="alg2.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.1.m1.1d">▷</annotation></semantics></math> sort candidates by PEPF ascending
</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_text" id="alg2.l10.1" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l10.2" style="font-size:90%;">while</span><span class="ltx_text" id="alg2.l10.3" style="font-size:90%;"> </span><math alttext="B&gt;0" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" mathsize="90%" xref="alg2.l10.m1.1.1.2.cmml">B</mi><mo id="alg2.l10.m1.1.1.1" mathsize="90%" xref="alg2.l10.m1.1.1.1.cmml">&gt;</mo><mn id="alg2.l10.m1.1.1.3" mathsize="90%" xref="alg2.l10.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><gt id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"></gt><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝐵</ci><cn id="alg2.l10.m1.1.1.3.cmml" type="integer" xref="alg2.l10.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">B&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_B &gt; 0</annotation></semantics></math><span class="ltx_text" id="alg2.l10.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l10.5" style="font-size:90%;">do</span><span class="ltx_text" id="alg2.l10.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_text" id="alg2.l11.2" style="font-size:90%;">         </span><span class="ltx_text ltx_font_bold" id="alg2.l11.3" style="font-size:90%;">for</span><span class="ltx_text" id="alg2.l11.4" style="font-size:90%;"> </span><math alttext="j" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mi id="alg2.l11.m1.1.1" mathsize="90%" xref="alg2.l11.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_j</annotation></semantics></math><span class="ltx_text" id="alg2.l11.5" style="font-size:90%;"> in </span><math alttext="V" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><mi id="alg2.l11.m2.1.1" mathsize="90%" xref="alg2.l11.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><ci id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">italic_V</annotation></semantics></math><span class="ltx_text" id="alg2.l11.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l11.7" style="font-size:90%;">do</span><span class="ltx_text" id="alg2.l11.8" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l11.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l11.1.m1.1"><semantics id="alg2.l11.1.m1.1a"><mo id="alg2.l11.1.m1.1.1" xref="alg2.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l11.1.m1.1b"><ci id="alg2.l11.1.m1.1.1.cmml" xref="alg2.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.1.m1.1d">▷</annotation></semantics></math> search for new products
</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_text" id="alg2.l12.2" style="font-size:90%;">             </span><math alttext="p\leftarrow\mathcal{S}[0]" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.2" xref="alg2.l12.m1.1.2.cmml"><mi id="alg2.l12.m1.1.2.2" mathsize="90%" xref="alg2.l12.m1.1.2.2.cmml">p</mi><mo id="alg2.l12.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg2.l12.m1.1.2.1.cmml">←</mo><mrow id="alg2.l12.m1.1.2.3" xref="alg2.l12.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.2.3.2" mathsize="90%" xref="alg2.l12.m1.1.2.3.2.cmml">𝒮</mi><mo id="alg2.l12.m1.1.2.3.1" xref="alg2.l12.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l12.m1.1.2.3.3.2" xref="alg2.l12.m1.1.2.3.3.1.cmml"><mo id="alg2.l12.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l12.m1.1.2.3.3.1.1.cmml">[</mo><mn id="alg2.l12.m1.1.1" mathsize="90%" xref="alg2.l12.m1.1.1.cmml">0</mn><mo id="alg2.l12.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l12.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.2.cmml" xref="alg2.l12.m1.1.2"><ci id="alg2.l12.m1.1.2.1.cmml" xref="alg2.l12.m1.1.2.1">←</ci><ci id="alg2.l12.m1.1.2.2.cmml" xref="alg2.l12.m1.1.2.2">𝑝</ci><apply id="alg2.l12.m1.1.2.3.cmml" xref="alg2.l12.m1.1.2.3"><times id="alg2.l12.m1.1.2.3.1.cmml" xref="alg2.l12.m1.1.2.3.1"></times><ci id="alg2.l12.m1.1.2.3.2.cmml" xref="alg2.l12.m1.1.2.3.2">𝒮</ci><apply id="alg2.l12.m1.1.2.3.3.1.cmml" xref="alg2.l12.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg2.l12.m1.1.2.3.3.1.1.cmml" xref="alg2.l12.m1.1.2.3.3.2.1">delimited-[]</csymbol><cn id="alg2.l12.m1.1.1.cmml" type="integer" xref="alg2.l12.m1.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">p\leftarrow\mathcal{S}[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_p ← caligraphic_S [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.l12.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l12.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l12.1.m1.1"><semantics id="alg2.l12.1.m1.1a"><mo id="alg2.l12.1.m1.1.1" xref="alg2.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l12.1.m1.1b"><ci id="alg2.l12.1.m1.1.1.cmml" xref="alg2.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.1.m1.1d">▷</annotation></semantics></math> select lowest PEPF product
</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_text" id="alg2.l13.2" style="font-size:90%;">             </span><math alttext="q\leftarrow Q_{s}[p]" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.2" xref="alg2.l13.m1.1.2.cmml"><mi id="alg2.l13.m1.1.2.2" mathsize="90%" xref="alg2.l13.m1.1.2.2.cmml">q</mi><mo id="alg2.l13.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg2.l13.m1.1.2.1.cmml">←</mo><mrow id="alg2.l13.m1.1.2.3" xref="alg2.l13.m1.1.2.3.cmml"><msub id="alg2.l13.m1.1.2.3.2" xref="alg2.l13.m1.1.2.3.2.cmml"><mi id="alg2.l13.m1.1.2.3.2.2" mathsize="90%" xref="alg2.l13.m1.1.2.3.2.2.cmml">Q</mi><mi id="alg2.l13.m1.1.2.3.2.3" mathsize="90%" xref="alg2.l13.m1.1.2.3.2.3.cmml">s</mi></msub><mo id="alg2.l13.m1.1.2.3.1" xref="alg2.l13.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l13.m1.1.2.3.3.2" xref="alg2.l13.m1.1.2.3.3.1.cmml"><mo id="alg2.l13.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l13.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg2.l13.m1.1.1" mathsize="90%" xref="alg2.l13.m1.1.1.cmml">p</mi><mo id="alg2.l13.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l13.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.2.cmml" xref="alg2.l13.m1.1.2"><ci id="alg2.l13.m1.1.2.1.cmml" xref="alg2.l13.m1.1.2.1">←</ci><ci id="alg2.l13.m1.1.2.2.cmml" xref="alg2.l13.m1.1.2.2">𝑞</ci><apply id="alg2.l13.m1.1.2.3.cmml" xref="alg2.l13.m1.1.2.3"><times id="alg2.l13.m1.1.2.3.1.cmml" xref="alg2.l13.m1.1.2.3.1"></times><apply id="alg2.l13.m1.1.2.3.2.cmml" xref="alg2.l13.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.3.2.1.cmml" xref="alg2.l13.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l13.m1.1.2.3.2.2.cmml" xref="alg2.l13.m1.1.2.3.2.2">𝑄</ci><ci id="alg2.l13.m1.1.2.3.2.3.cmml" xref="alg2.l13.m1.1.2.3.2.3">𝑠</ci></apply><apply id="alg2.l13.m1.1.2.3.3.1.cmml" xref="alg2.l13.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg2.l13.m1.1.2.3.3.1.1.cmml" xref="alg2.l13.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">q\leftarrow Q_{s}[p]</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_q ← italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_p ]</annotation></semantics></math><span class="ltx_text" id="alg2.l13.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l13.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l13.1.m1.1"><semantics id="alg2.l13.1.m1.1a"><mo id="alg2.l13.1.m1.1.1" xref="alg2.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l13.1.m1.1b"><ci id="alg2.l13.1.m1.1.1.cmml" xref="alg2.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.1.m1.1d">▷</annotation></semantics></math> current quantity
</span>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_text" id="alg2.l14.3" style="font-size:90%;">             </span><math alttext="\alpha\sim\textrm{Unif}(0,1)" class="ltx_Math" display="inline" id="alg2.l14.m1.2"><semantics id="alg2.l14.m1.2a"><mrow id="alg2.l14.m1.2.3" xref="alg2.l14.m1.2.3.cmml"><mi id="alg2.l14.m1.2.3.2" mathsize="90%" xref="alg2.l14.m1.2.3.2.cmml">α</mi><mo id="alg2.l14.m1.2.3.1" mathsize="90%" xref="alg2.l14.m1.2.3.1.cmml">∼</mo><mrow id="alg2.l14.m1.2.3.3" xref="alg2.l14.m1.2.3.3.cmml"><mtext id="alg2.l14.m1.2.3.3.2" mathsize="90%" xref="alg2.l14.m1.2.3.3.2a.cmml">Unif</mtext><mo id="alg2.l14.m1.2.3.3.1" xref="alg2.l14.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg2.l14.m1.2.3.3.3.2" xref="alg2.l14.m1.2.3.3.3.1.cmml"><mo id="alg2.l14.m1.2.3.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l14.m1.2.3.3.3.1.cmml">(</mo><mn id="alg2.l14.m1.1.1" mathsize="90%" xref="alg2.l14.m1.1.1.cmml">0</mn><mo id="alg2.l14.m1.2.3.3.3.2.2" mathsize="90%" xref="alg2.l14.m1.2.3.3.3.1.cmml">,</mo><mn id="alg2.l14.m1.2.2" mathsize="90%" xref="alg2.l14.m1.2.2.cmml">1</mn><mo id="alg2.l14.m1.2.3.3.3.2.3" maxsize="90%" minsize="90%" xref="alg2.l14.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.2b"><apply id="alg2.l14.m1.2.3.cmml" xref="alg2.l14.m1.2.3"><csymbol cd="latexml" id="alg2.l14.m1.2.3.1.cmml" xref="alg2.l14.m1.2.3.1">similar-to</csymbol><ci id="alg2.l14.m1.2.3.2.cmml" xref="alg2.l14.m1.2.3.2">𝛼</ci><apply id="alg2.l14.m1.2.3.3.cmml" xref="alg2.l14.m1.2.3.3"><times id="alg2.l14.m1.2.3.3.1.cmml" xref="alg2.l14.m1.2.3.3.1"></times><ci id="alg2.l14.m1.2.3.3.2a.cmml" xref="alg2.l14.m1.2.3.3.2"><mtext id="alg2.l14.m1.2.3.3.2.cmml" mathsize="90%" xref="alg2.l14.m1.2.3.3.2">Unif</mtext></ci><interval closure="open" id="alg2.l14.m1.2.3.3.3.1.cmml" xref="alg2.l14.m1.2.3.3.3.2"><cn id="alg2.l14.m1.1.1.cmml" type="integer" xref="alg2.l14.m1.1.1">0</cn><cn id="alg2.l14.m1.2.2.cmml" type="integer" xref="alg2.l14.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.2c">\alpha\sim\textrm{Unif}(0,1)</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.2d">italic_α ∼ Unif ( 0 , 1 )</annotation></semantics></math><span class="ltx_text" id="alg2.l14.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l14.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l14.1.m1.1"><semantics id="alg2.l14.1.m1.1a"><mo id="alg2.l14.1.m1.1.1" xref="alg2.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l14.1.m1.1b"><ci id="alg2.l14.1.m1.1.1.cmml" xref="alg2.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.1.m1.1d">▷</annotation></semantics></math> <math alttext="\epsilon" class="ltx_Math" display="inline" id="alg2.l14.2.m2.1"><semantics id="alg2.l14.2.m2.1a"><mi id="alg2.l14.2.m2.1.1" xref="alg2.l14.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="alg2.l14.2.m2.1b"><ci id="alg2.l14.2.m2.1.1.cmml" xref="alg2.l14.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.2.m2.1d">italic_ϵ</annotation></semantics></math>-greedy action
</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_text" id="alg2.l15.1" style="font-size:90%;">             </span><span class="ltx_text ltx_font_bold" id="alg2.l15.2" style="font-size:90%;">if</span><span class="ltx_text" id="alg2.l15.3" style="font-size:90%;"> </span><math alttext="\alpha&lt;\epsilon" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" mathsize="90%" xref="alg2.l15.m1.1.1.2.cmml">α</mi><mo id="alg2.l15.m1.1.1.1" mathsize="90%" xref="alg2.l15.m1.1.1.1.cmml">&lt;</mo><mi id="alg2.l15.m1.1.1.3" mathsize="90%" xref="alg2.l15.m1.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><lt id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></lt><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝛼</ci><ci id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\alpha&lt;\epsilon</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">italic_α &lt; italic_ϵ</annotation></semantics></math><span class="ltx_text" id="alg2.l15.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l15.5" style="font-size:90%;">then</span><span class="ltx_text" id="alg2.l15.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_text" id="alg2.l16.2" style="font-size:90%;">                 </span><math alttext="p^{\prime}\sim\tilde{\mathcal{C}}" class="ltx_Math" display="inline" id="alg2.l16.m1.1"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><msup id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml"><mi id="alg2.l16.m1.1.1.2.2" mathsize="90%" xref="alg2.l16.m1.1.1.2.2.cmml">p</mi><mo id="alg2.l16.m1.1.1.2.3" mathsize="90%" xref="alg2.l16.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg2.l16.m1.1.1.1" mathsize="90%" xref="alg2.l16.m1.1.1.1.cmml">∼</mo><mover accent="true" id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l16.m1.1.1.3.2" mathsize="90%" xref="alg2.l16.m1.1.1.3.2.cmml">𝒞</mi><mo id="alg2.l16.m1.1.1.3.1" mathsize="90%" xref="alg2.l16.m1.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="latexml" id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1">similar-to</csymbol><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.2">superscript</csymbol><ci id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2.2">𝑝</ci><ci id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3">′</ci></apply><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><ci id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3.1">~</ci><ci id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">p^{\prime}\sim\tilde{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.1d">italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ over~ start_ARG caligraphic_C end_ARG</annotation></semantics></math><span class="ltx_text" id="alg2.l16.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l16.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l16.1.m1.1"><semantics id="alg2.l16.1.m1.1a"><mo id="alg2.l16.1.m1.1.1" xref="alg2.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l16.1.m1.1b"><ci id="alg2.l16.1.m1.1.1.cmml" xref="alg2.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.1.m1.1d">▷</annotation></semantics></math> choose random candidate
</span>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_text" id="alg2.l17.1" style="font-size:90%;">             </span><span class="ltx_text ltx_font_bold" id="alg2.l17.2" style="font-size:90%;">else</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_text" id="alg2.l18.2" style="font-size:90%;">                 </span><math alttext="p\leftarrow\tilde{\mathcal{C}}" class="ltx_Math" display="inline" id="alg2.l18.m1.1"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2" mathsize="90%" xref="alg2.l18.m1.1.1.2.cmml">p</mi><mo id="alg2.l18.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.l18.m1.1.1.1.cmml">←</mo><mover accent="true" id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.1.1.3.2" mathsize="90%" xref="alg2.l18.m1.1.1.3.2.cmml">𝒞</mi><mo id="alg2.l18.m1.1.1.3.1" mathsize="90%" xref="alg2.l18.m1.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><ci id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1">←</ci><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">𝑝</ci><apply id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3"><ci id="alg2.l18.m1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.3.1">~</ci><ci id="alg2.l18.m1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.3.2">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">p\leftarrow\tilde{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.1d">italic_p ← over~ start_ARG caligraphic_C end_ARG</annotation></semantics></math><span class="ltx_text" id="alg2.l18.3" style="font-size:90%;">.pop() </span><span class="ltx_text" id="alg2.l18.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l18.1.m1.1"><semantics id="alg2.l18.1.m1.1a"><mo id="alg2.l18.1.m1.1.1" xref="alg2.l18.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l18.1.m1.1b"><ci id="alg2.l18.1.m1.1.1.cmml" xref="alg2.l18.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.1.m1.1d">▷</annotation></semantics></math> greedy selection (highest PEPF)
</span>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_text" id="alg2.l19.1" style="font-size:90%;">             </span><span class="ltx_text ltx_font_bold" id="alg2.l19.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg2.l19.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l19.4" style="font-size:90%;">if</span>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_text" id="alg2.l20.2" style="font-size:90%;">             </span><math alttext="q^{\prime}=\delta(q)" class="ltx_Math" display="inline" id="alg2.l20.m1.1"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.2" xref="alg2.l20.m1.1.2.cmml"><msup id="alg2.l20.m1.1.2.2" xref="alg2.l20.m1.1.2.2.cmml"><mi id="alg2.l20.m1.1.2.2.2" mathsize="90%" xref="alg2.l20.m1.1.2.2.2.cmml">q</mi><mo id="alg2.l20.m1.1.2.2.3" mathsize="90%" xref="alg2.l20.m1.1.2.2.3.cmml">′</mo></msup><mo id="alg2.l20.m1.1.2.1" mathsize="90%" xref="alg2.l20.m1.1.2.1.cmml">=</mo><mrow id="alg2.l20.m1.1.2.3" xref="alg2.l20.m1.1.2.3.cmml"><mi id="alg2.l20.m1.1.2.3.2" mathsize="90%" xref="alg2.l20.m1.1.2.3.2.cmml">δ</mi><mo id="alg2.l20.m1.1.2.3.1" xref="alg2.l20.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l20.m1.1.2.3.3.2" xref="alg2.l20.m1.1.2.3.cmml"><mo id="alg2.l20.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l20.m1.1.2.3.cmml">(</mo><mi id="alg2.l20.m1.1.1" mathsize="90%" xref="alg2.l20.m1.1.1.cmml">q</mi><mo id="alg2.l20.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l20.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.2.cmml" xref="alg2.l20.m1.1.2"><eq id="alg2.l20.m1.1.2.1.cmml" xref="alg2.l20.m1.1.2.1"></eq><apply id="alg2.l20.m1.1.2.2.cmml" xref="alg2.l20.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l20.m1.1.2.2.1.cmml" xref="alg2.l20.m1.1.2.2">superscript</csymbol><ci id="alg2.l20.m1.1.2.2.2.cmml" xref="alg2.l20.m1.1.2.2.2">𝑞</ci><ci id="alg2.l20.m1.1.2.2.3.cmml" xref="alg2.l20.m1.1.2.2.3">′</ci></apply><apply id="alg2.l20.m1.1.2.3.cmml" xref="alg2.l20.m1.1.2.3"><times id="alg2.l20.m1.1.2.3.1.cmml" xref="alg2.l20.m1.1.2.3.1"></times><ci id="alg2.l20.m1.1.2.3.2.cmml" xref="alg2.l20.m1.1.2.3.2">𝛿</ci><ci id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">q^{\prime}=\delta(q)</annotation><annotation encoding="application/x-llamapun" id="alg2.l20.m1.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_δ ( italic_q )</annotation></semantics></math><span class="ltx_text" id="alg2.l20.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l20.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l20.1.m1.1"><semantics id="alg2.l20.1.m1.1a"><mo id="alg2.l20.1.m1.1.1" xref="alg2.l20.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l20.1.m1.1b"><ci id="alg2.l20.1.m1.1.1.cmml" xref="alg2.l20.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l20.1.m1.1d">▷</annotation></semantics></math> decay quantity
</span>
</div>
<div class="ltx_listingline" id="alg2.l21">
<span class="ltx_text" id="alg2.l21.2" style="font-size:90%;">             </span><math alttext="R[p^{\prime}]\leftarrow q^{\prime}" class="ltx_Math" display="inline" id="alg2.l21.m1.1"><semantics id="alg2.l21.m1.1a"><mrow id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml"><mrow id="alg2.l21.m1.1.1.1" xref="alg2.l21.m1.1.1.1.cmml"><mi id="alg2.l21.m1.1.1.1.3" mathsize="90%" xref="alg2.l21.m1.1.1.1.3.cmml">R</mi><mo id="alg2.l21.m1.1.1.1.2" xref="alg2.l21.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l21.m1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.2.cmml"><mo id="alg2.l21.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l21.m1.1.1.1.1.2.1.cmml">[</mo><msup id="alg2.l21.m1.1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l21.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg2.l21.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg2.l21.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg2.l21.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l21.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg2.l21.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg2.l21.m1.1.1.2" mathsize="90%" stretchy="false" xref="alg2.l21.m1.1.1.2.cmml">←</mo><msup id="alg2.l21.m1.1.1.3" xref="alg2.l21.m1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.3.2" mathsize="90%" xref="alg2.l21.m1.1.1.3.2.cmml">q</mi><mo id="alg2.l21.m1.1.1.3.3" mathsize="90%" xref="alg2.l21.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><apply id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1"><ci id="alg2.l21.m1.1.1.2.cmml" xref="alg2.l21.m1.1.1.2">←</ci><apply id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1"><times id="alg2.l21.m1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.2"></times><ci id="alg2.l21.m1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.3">𝑅</ci><apply id="alg2.l21.m1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l21.m1.1.1.1.1.2.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l21.m1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l21.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg2.l21.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="alg2.l21.m1.1.1.3.cmml" xref="alg2.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.3">superscript</csymbol><ci id="alg2.l21.m1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.3.2">𝑞</ci><ci id="alg2.l21.m1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">R[p^{\prime}]\leftarrow q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l21.m1.1d">italic_R [ italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ] ← italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l21.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l21.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l21.1.m1.1"><semantics id="alg2.l21.1.m1.1a"><mo id="alg2.l21.1.m1.1.1" xref="alg2.l21.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l21.1.m1.1b"><ci id="alg2.l21.1.m1.1.1.cmml" xref="alg2.l21.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l21.1.m1.1d">▷</annotation></semantics></math> assign recommendation
</span>
</div>
<div class="ltx_listingline" id="alg2.l22">
<span class="ltx_text" id="alg2.l22.1" style="font-size:90%;">             </span><math alttext="B=B-q^{\prime}" class="ltx_Math" display="inline" id="alg2.l22.m1.1"><semantics id="alg2.l22.m1.1a"><mrow id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1.cmml"><mi id="alg2.l22.m1.1.1.2" mathsize="90%" xref="alg2.l22.m1.1.1.2.cmml">B</mi><mo id="alg2.l22.m1.1.1.1" mathsize="90%" xref="alg2.l22.m1.1.1.1.cmml">=</mo><mrow id="alg2.l22.m1.1.1.3" xref="alg2.l22.m1.1.1.3.cmml"><mi id="alg2.l22.m1.1.1.3.2" mathsize="90%" xref="alg2.l22.m1.1.1.3.2.cmml">B</mi><mo id="alg2.l22.m1.1.1.3.1" mathsize="90%" xref="alg2.l22.m1.1.1.3.1.cmml">−</mo><msup id="alg2.l22.m1.1.1.3.3" xref="alg2.l22.m1.1.1.3.3.cmml"><mi id="alg2.l22.m1.1.1.3.3.2" mathsize="90%" xref="alg2.l22.m1.1.1.3.3.2.cmml">q</mi><mo id="alg2.l22.m1.1.1.3.3.3" mathsize="90%" xref="alg2.l22.m1.1.1.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.1b"><apply id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1"><eq id="alg2.l22.m1.1.1.1.cmml" xref="alg2.l22.m1.1.1.1"></eq><ci id="alg2.l22.m1.1.1.2.cmml" xref="alg2.l22.m1.1.1.2">𝐵</ci><apply id="alg2.l22.m1.1.1.3.cmml" xref="alg2.l22.m1.1.1.3"><minus id="alg2.l22.m1.1.1.3.1.cmml" xref="alg2.l22.m1.1.1.3.1"></minus><ci id="alg2.l22.m1.1.1.3.2.cmml" xref="alg2.l22.m1.1.1.3.2">𝐵</ci><apply id="alg2.l22.m1.1.1.3.3.cmml" xref="alg2.l22.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.3.3.1.cmml" xref="alg2.l22.m1.1.1.3.3">superscript</csymbol><ci id="alg2.l22.m1.1.1.3.3.2.cmml" xref="alg2.l22.m1.1.1.3.3.2">𝑞</ci><ci id="alg2.l22.m1.1.1.3.3.3.cmml" xref="alg2.l22.m1.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">B=B-q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l22.m1.1d">italic_B = italic_B - italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l22.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l23">
<span class="ltx_text" id="alg2.l23.2" style="font-size:90%;">             </span><math alttext="Q_{s}[p]=q-q^{\prime}" class="ltx_Math" display="inline" id="alg2.l23.m1.1"><semantics id="alg2.l23.m1.1a"><mrow id="alg2.l23.m1.1.2" xref="alg2.l23.m1.1.2.cmml"><mrow id="alg2.l23.m1.1.2.2" xref="alg2.l23.m1.1.2.2.cmml"><msub id="alg2.l23.m1.1.2.2.2" xref="alg2.l23.m1.1.2.2.2.cmml"><mi id="alg2.l23.m1.1.2.2.2.2" mathsize="90%" xref="alg2.l23.m1.1.2.2.2.2.cmml">Q</mi><mi id="alg2.l23.m1.1.2.2.2.3" mathsize="90%" xref="alg2.l23.m1.1.2.2.2.3.cmml">s</mi></msub><mo id="alg2.l23.m1.1.2.2.1" xref="alg2.l23.m1.1.2.2.1.cmml">⁢</mo><mrow id="alg2.l23.m1.1.2.2.3.2" xref="alg2.l23.m1.1.2.2.3.1.cmml"><mo id="alg2.l23.m1.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l23.m1.1.2.2.3.1.1.cmml">[</mo><mi id="alg2.l23.m1.1.1" mathsize="90%" xref="alg2.l23.m1.1.1.cmml">p</mi><mo id="alg2.l23.m1.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l23.m1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.l23.m1.1.2.1" mathsize="90%" xref="alg2.l23.m1.1.2.1.cmml">=</mo><mrow id="alg2.l23.m1.1.2.3" xref="alg2.l23.m1.1.2.3.cmml"><mi id="alg2.l23.m1.1.2.3.2" mathsize="90%" xref="alg2.l23.m1.1.2.3.2.cmml">q</mi><mo id="alg2.l23.m1.1.2.3.1" mathsize="90%" xref="alg2.l23.m1.1.2.3.1.cmml">−</mo><msup id="alg2.l23.m1.1.2.3.3" xref="alg2.l23.m1.1.2.3.3.cmml"><mi id="alg2.l23.m1.1.2.3.3.2" mathsize="90%" xref="alg2.l23.m1.1.2.3.3.2.cmml">q</mi><mo id="alg2.l23.m1.1.2.3.3.3" mathsize="90%" xref="alg2.l23.m1.1.2.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l23.m1.1b"><apply id="alg2.l23.m1.1.2.cmml" xref="alg2.l23.m1.1.2"><eq id="alg2.l23.m1.1.2.1.cmml" xref="alg2.l23.m1.1.2.1"></eq><apply id="alg2.l23.m1.1.2.2.cmml" xref="alg2.l23.m1.1.2.2"><times id="alg2.l23.m1.1.2.2.1.cmml" xref="alg2.l23.m1.1.2.2.1"></times><apply id="alg2.l23.m1.1.2.2.2.cmml" xref="alg2.l23.m1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l23.m1.1.2.2.2.1.cmml" xref="alg2.l23.m1.1.2.2.2">subscript</csymbol><ci id="alg2.l23.m1.1.2.2.2.2.cmml" xref="alg2.l23.m1.1.2.2.2.2">𝑄</ci><ci id="alg2.l23.m1.1.2.2.2.3.cmml" xref="alg2.l23.m1.1.2.2.2.3">𝑠</ci></apply><apply id="alg2.l23.m1.1.2.2.3.1.cmml" xref="alg2.l23.m1.1.2.2.3.2"><csymbol cd="latexml" id="alg2.l23.m1.1.2.2.3.1.1.cmml" xref="alg2.l23.m1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg2.l23.m1.1.1.cmml" xref="alg2.l23.m1.1.1">𝑝</ci></apply></apply><apply id="alg2.l23.m1.1.2.3.cmml" xref="alg2.l23.m1.1.2.3"><minus id="alg2.l23.m1.1.2.3.1.cmml" xref="alg2.l23.m1.1.2.3.1"></minus><ci id="alg2.l23.m1.1.2.3.2.cmml" xref="alg2.l23.m1.1.2.3.2">𝑞</ci><apply id="alg2.l23.m1.1.2.3.3.cmml" xref="alg2.l23.m1.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l23.m1.1.2.3.3.1.cmml" xref="alg2.l23.m1.1.2.3.3">superscript</csymbol><ci id="alg2.l23.m1.1.2.3.3.2.cmml" xref="alg2.l23.m1.1.2.3.3.2">𝑞</ci><ci id="alg2.l23.m1.1.2.3.3.3.cmml" xref="alg2.l23.m1.1.2.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.m1.1c">Q_{s}[p]=q-q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l23.m1.1d">italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_p ] = italic_q - italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l23.3" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l23.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l23.1.m1.1"><semantics id="alg2.l23.1.m1.1a"><mo id="alg2.l23.1.m1.1.1" xref="alg2.l23.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l23.1.m1.1b"><ci id="alg2.l23.1.m1.1.1.cmml" xref="alg2.l23.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l23.1.m1.1d">▷</annotation></semantics></math> update product quantity
</span>
</div>
<div class="ltx_listingline" id="alg2.l24">
<span class="ltx_text" id="alg2.l24.1" style="font-size:90%;">         </span><span class="ltx_text ltx_font_bold" id="alg2.l24.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg2.l24.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l24.4" style="font-size:90%;">for</span>
</div>
<div class="ltx_listingline" id="alg2.l25">
<span class="ltx_text" id="alg2.l25.2" style="font-size:90%;">         </span><math alttext="p^{\prime}=\tilde{\mathcal{S}}" class="ltx_Math" display="inline" id="alg2.l25.m1.1"><semantics id="alg2.l25.m1.1a"><mrow id="alg2.l25.m1.1.1" xref="alg2.l25.m1.1.1.cmml"><msup id="alg2.l25.m1.1.1.2" xref="alg2.l25.m1.1.1.2.cmml"><mi id="alg2.l25.m1.1.1.2.2" mathsize="90%" xref="alg2.l25.m1.1.1.2.2.cmml">p</mi><mo id="alg2.l25.m1.1.1.2.3" mathsize="90%" xref="alg2.l25.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg2.l25.m1.1.1.1" mathsize="90%" xref="alg2.l25.m1.1.1.1.cmml">=</mo><mover accent="true" id="alg2.l25.m1.1.1.3" xref="alg2.l25.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l25.m1.1.1.3.2" mathsize="90%" xref="alg2.l25.m1.1.1.3.2.cmml">𝒮</mi><mo id="alg2.l25.m1.1.1.3.1" mathsize="90%" xref="alg2.l25.m1.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l25.m1.1b"><apply id="alg2.l25.m1.1.1.cmml" xref="alg2.l25.m1.1.1"><eq id="alg2.l25.m1.1.1.1.cmml" xref="alg2.l25.m1.1.1.1"></eq><apply id="alg2.l25.m1.1.1.2.cmml" xref="alg2.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l25.m1.1.1.2.1.cmml" xref="alg2.l25.m1.1.1.2">superscript</csymbol><ci id="alg2.l25.m1.1.1.2.2.cmml" xref="alg2.l25.m1.1.1.2.2">𝑝</ci><ci id="alg2.l25.m1.1.1.2.3.cmml" xref="alg2.l25.m1.1.1.2.3">′</ci></apply><apply id="alg2.l25.m1.1.1.3.cmml" xref="alg2.l25.m1.1.1.3"><ci id="alg2.l25.m1.1.1.3.1.cmml" xref="alg2.l25.m1.1.1.3.1">~</ci><ci id="alg2.l25.m1.1.1.3.2.cmml" xref="alg2.l25.m1.1.1.3.2">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.m1.1c">p^{\prime}=\tilde{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l25.m1.1d">italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = over~ start_ARG caligraphic_S end_ARG</annotation></semantics></math><span class="ltx_text" id="alg2.l25.3" style="font-size:90%;">.pop() </span><span class="ltx_text" id="alg2.l25.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l25.1.m1.1"><semantics id="alg2.l25.1.m1.1a"><mo id="alg2.l25.1.m1.1.1" xref="alg2.l25.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l25.1.m1.1b"><ci id="alg2.l25.1.m1.1.1.cmml" xref="alg2.l25.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l25.1.m1.1d">▷</annotation></semantics></math> Collect existing, high PEPF products
</span>
</div>
<div class="ltx_listingline" id="alg2.l26">
<span class="ltx_text" id="alg2.l26.1" style="font-size:90%;">         </span><math alttext="q^{\prime}=Q_{s}[p^{\prime}]" class="ltx_Math" display="inline" id="alg2.l26.m1.1"><semantics id="alg2.l26.m1.1a"><mrow id="alg2.l26.m1.1.1" xref="alg2.l26.m1.1.1.cmml"><msup id="alg2.l26.m1.1.1.3" xref="alg2.l26.m1.1.1.3.cmml"><mi id="alg2.l26.m1.1.1.3.2" mathsize="90%" xref="alg2.l26.m1.1.1.3.2.cmml">q</mi><mo id="alg2.l26.m1.1.1.3.3" mathsize="90%" xref="alg2.l26.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l26.m1.1.1.2" mathsize="90%" xref="alg2.l26.m1.1.1.2.cmml">=</mo><mrow id="alg2.l26.m1.1.1.1" xref="alg2.l26.m1.1.1.1.cmml"><msub id="alg2.l26.m1.1.1.1.3" xref="alg2.l26.m1.1.1.1.3.cmml"><mi id="alg2.l26.m1.1.1.1.3.2" mathsize="90%" xref="alg2.l26.m1.1.1.1.3.2.cmml">Q</mi><mi id="alg2.l26.m1.1.1.1.3.3" mathsize="90%" xref="alg2.l26.m1.1.1.1.3.3.cmml">s</mi></msub><mo id="alg2.l26.m1.1.1.1.2" xref="alg2.l26.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l26.m1.1.1.1.1.1" xref="alg2.l26.m1.1.1.1.1.2.cmml"><mo id="alg2.l26.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l26.m1.1.1.1.1.2.1.cmml">[</mo><msup id="alg2.l26.m1.1.1.1.1.1.1" xref="alg2.l26.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l26.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg2.l26.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg2.l26.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg2.l26.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l26.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg2.l26.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l26.m1.1b"><apply id="alg2.l26.m1.1.1.cmml" xref="alg2.l26.m1.1.1"><eq id="alg2.l26.m1.1.1.2.cmml" xref="alg2.l26.m1.1.1.2"></eq><apply id="alg2.l26.m1.1.1.3.cmml" xref="alg2.l26.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l26.m1.1.1.3.1.cmml" xref="alg2.l26.m1.1.1.3">superscript</csymbol><ci id="alg2.l26.m1.1.1.3.2.cmml" xref="alg2.l26.m1.1.1.3.2">𝑞</ci><ci id="alg2.l26.m1.1.1.3.3.cmml" xref="alg2.l26.m1.1.1.3.3">′</ci></apply><apply id="alg2.l26.m1.1.1.1.cmml" xref="alg2.l26.m1.1.1.1"><times id="alg2.l26.m1.1.1.1.2.cmml" xref="alg2.l26.m1.1.1.1.2"></times><apply id="alg2.l26.m1.1.1.1.3.cmml" xref="alg2.l26.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l26.m1.1.1.1.3.1.cmml" xref="alg2.l26.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l26.m1.1.1.1.3.2.cmml" xref="alg2.l26.m1.1.1.1.3.2">𝑄</ci><ci id="alg2.l26.m1.1.1.1.3.3.cmml" xref="alg2.l26.m1.1.1.1.3.3">𝑠</ci></apply><apply id="alg2.l26.m1.1.1.1.1.2.cmml" xref="alg2.l26.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l26.m1.1.1.1.1.2.1.cmml" xref="alg2.l26.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l26.m1.1.1.1.1.1.1.cmml" xref="alg2.l26.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l26.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l26.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l26.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l26.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg2.l26.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l26.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l26.m1.1c">q^{\prime}=Q_{s}[p^{\prime}]</annotation><annotation encoding="application/x-llamapun" id="alg2.l26.m1.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ]</annotation></semantics></math><span class="ltx_text" id="alg2.l26.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l27">
<span class="ltx_text" id="alg2.l27.1" style="font-size:90%;">         </span><math alttext="R[p^{\prime}]\leftarrow q^{\prime}" class="ltx_Math" display="inline" id="alg2.l27.m1.1"><semantics id="alg2.l27.m1.1a"><mrow id="alg2.l27.m1.1.1" xref="alg2.l27.m1.1.1.cmml"><mrow id="alg2.l27.m1.1.1.1" xref="alg2.l27.m1.1.1.1.cmml"><mi id="alg2.l27.m1.1.1.1.3" mathsize="90%" xref="alg2.l27.m1.1.1.1.3.cmml">R</mi><mo id="alg2.l27.m1.1.1.1.2" xref="alg2.l27.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l27.m1.1.1.1.1.1" xref="alg2.l27.m1.1.1.1.1.2.cmml"><mo id="alg2.l27.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l27.m1.1.1.1.1.2.1.cmml">[</mo><msup id="alg2.l27.m1.1.1.1.1.1.1" xref="alg2.l27.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l27.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg2.l27.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg2.l27.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg2.l27.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l27.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg2.l27.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg2.l27.m1.1.1.2" mathsize="90%" stretchy="false" xref="alg2.l27.m1.1.1.2.cmml">←</mo><msup id="alg2.l27.m1.1.1.3" xref="alg2.l27.m1.1.1.3.cmml"><mi id="alg2.l27.m1.1.1.3.2" mathsize="90%" xref="alg2.l27.m1.1.1.3.2.cmml">q</mi><mo id="alg2.l27.m1.1.1.3.3" mathsize="90%" xref="alg2.l27.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l27.m1.1b"><apply id="alg2.l27.m1.1.1.cmml" xref="alg2.l27.m1.1.1"><ci id="alg2.l27.m1.1.1.2.cmml" xref="alg2.l27.m1.1.1.2">←</ci><apply id="alg2.l27.m1.1.1.1.cmml" xref="alg2.l27.m1.1.1.1"><times id="alg2.l27.m1.1.1.1.2.cmml" xref="alg2.l27.m1.1.1.1.2"></times><ci id="alg2.l27.m1.1.1.1.3.cmml" xref="alg2.l27.m1.1.1.1.3">𝑅</ci><apply id="alg2.l27.m1.1.1.1.1.2.cmml" xref="alg2.l27.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l27.m1.1.1.1.1.2.1.cmml" xref="alg2.l27.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l27.m1.1.1.1.1.1.1.cmml" xref="alg2.l27.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l27.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l27.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l27.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l27.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg2.l27.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l27.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="alg2.l27.m1.1.1.3.cmml" xref="alg2.l27.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l27.m1.1.1.3.1.cmml" xref="alg2.l27.m1.1.1.3">superscript</csymbol><ci id="alg2.l27.m1.1.1.3.2.cmml" xref="alg2.l27.m1.1.1.3.2">𝑞</ci><ci id="alg2.l27.m1.1.1.3.3.cmml" xref="alg2.l27.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l27.m1.1c">R[p^{\prime}]\leftarrow q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l27.m1.1d">italic_R [ italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ] ← italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l27.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l28">
<span class="ltx_text" id="alg2.l28.1" style="font-size:90%;">         </span><math alttext="B=B-q^{\prime}" class="ltx_Math" display="inline" id="alg2.l28.m1.1"><semantics id="alg2.l28.m1.1a"><mrow id="alg2.l28.m1.1.1" xref="alg2.l28.m1.1.1.cmml"><mi id="alg2.l28.m1.1.1.2" mathsize="90%" xref="alg2.l28.m1.1.1.2.cmml">B</mi><mo id="alg2.l28.m1.1.1.1" mathsize="90%" xref="alg2.l28.m1.1.1.1.cmml">=</mo><mrow id="alg2.l28.m1.1.1.3" xref="alg2.l28.m1.1.1.3.cmml"><mi id="alg2.l28.m1.1.1.3.2" mathsize="90%" xref="alg2.l28.m1.1.1.3.2.cmml">B</mi><mo id="alg2.l28.m1.1.1.3.1" mathsize="90%" xref="alg2.l28.m1.1.1.3.1.cmml">−</mo><msup id="alg2.l28.m1.1.1.3.3" xref="alg2.l28.m1.1.1.3.3.cmml"><mi id="alg2.l28.m1.1.1.3.3.2" mathsize="90%" xref="alg2.l28.m1.1.1.3.3.2.cmml">q</mi><mo id="alg2.l28.m1.1.1.3.3.3" mathsize="90%" xref="alg2.l28.m1.1.1.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l28.m1.1b"><apply id="alg2.l28.m1.1.1.cmml" xref="alg2.l28.m1.1.1"><eq id="alg2.l28.m1.1.1.1.cmml" xref="alg2.l28.m1.1.1.1"></eq><ci id="alg2.l28.m1.1.1.2.cmml" xref="alg2.l28.m1.1.1.2">𝐵</ci><apply id="alg2.l28.m1.1.1.3.cmml" xref="alg2.l28.m1.1.1.3"><minus id="alg2.l28.m1.1.1.3.1.cmml" xref="alg2.l28.m1.1.1.3.1"></minus><ci id="alg2.l28.m1.1.1.3.2.cmml" xref="alg2.l28.m1.1.1.3.2">𝐵</ci><apply id="alg2.l28.m1.1.1.3.3.cmml" xref="alg2.l28.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l28.m1.1.1.3.3.1.cmml" xref="alg2.l28.m1.1.1.3.3">superscript</csymbol><ci id="alg2.l28.m1.1.1.3.3.2.cmml" xref="alg2.l28.m1.1.1.3.3.2">𝑞</ci><ci id="alg2.l28.m1.1.1.3.3.3.cmml" xref="alg2.l28.m1.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l28.m1.1c">B=B-q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l28.m1.1d">italic_B = italic_B - italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l28.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l29">
<span class="ltx_text" id="alg2.l29.1" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l29.2" style="font-size:90%;">end</span><span class="ltx_text" id="alg2.l29.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l29.4" style="font-size:90%;">while</span>
</div>
<div class="ltx_listingline" id="alg2.l30">
<span class="ltx_text ltx_font_bold" id="alg2.l30.1" style="font-size:90%;">end</span><span class="ltx_text" id="alg2.l30.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l30.3" style="font-size:90%;">for</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">Using the candidates as input, we next perform a heuristic, combinatiorial search to produce a recommended product set. Due to the high stakes nature of physical world recommendation systems, we design a heuristic search algorithm that is relatively simple, in order to avoid catastrophic failures and lost sales. The core principle behind the search algorithm is to keep high payoff products, and slowly trade low payoff products for better ones, while accounting for uncertainty.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.12">Our search algorithm is comprised of the following general steps. First, we produce a PEPF score (Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S3.E6" title="Equation 6 ‣ 3.3. Value estimation: Robust Bayesian Payoffs (RBP) ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">6</span></a>) for each product in the candidate set, <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">caligraphic_C</annotation></semantics></math>, and the observed state set, <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS5.p2.2.m2.1"><semantics id="S3.SS5.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.2.m2.1.1" xref="S3.SS5.p2.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m2.1b"><ci id="S3.SS5.p2.2.m2.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.2.m2.1d">caligraphic_S</annotation></semantics></math>. Second, we sort the candidate set and state set by PEPF. Third, we choose the lowest <math alttext="V" class="ltx_Math" display="inline" id="S3.SS5.p2.3.m3.1"><semantics id="S3.SS5.p2.3.m3.1a"><mi id="S3.SS5.p2.3.m3.1.1" xref="S3.SS5.p2.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m3.1b"><ci id="S3.SS5.p2.3.m3.1.1.cmml" xref="S3.SS5.p2.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.3.m3.1d">italic_V</annotation></semantics></math> products by PEPF and reduce their quantities following the decay schedule <math alttext="\delta(t,q_{0})=\lfloor q_{0}\frac{1}{2}^{t}\rfloor" class="ltx_Math" display="inline" id="S3.SS5.p2.4.m4.3"><semantics id="S3.SS5.p2.4.m4.3a"><mrow id="S3.SS5.p2.4.m4.3.3" xref="S3.SS5.p2.4.m4.3.3.cmml"><mrow id="S3.SS5.p2.4.m4.2.2.1" xref="S3.SS5.p2.4.m4.2.2.1.cmml"><mi id="S3.SS5.p2.4.m4.2.2.1.3" xref="S3.SS5.p2.4.m4.2.2.1.3.cmml">δ</mi><mo id="S3.SS5.p2.4.m4.2.2.1.2" xref="S3.SS5.p2.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS5.p2.4.m4.2.2.1.1.1" xref="S3.SS5.p2.4.m4.2.2.1.1.2.cmml"><mo id="S3.SS5.p2.4.m4.2.2.1.1.1.2" stretchy="false" xref="S3.SS5.p2.4.m4.2.2.1.1.2.cmml">(</mo><mi id="S3.SS5.p2.4.m4.1.1" xref="S3.SS5.p2.4.m4.1.1.cmml">t</mi><mo id="S3.SS5.p2.4.m4.2.2.1.1.1.3" xref="S3.SS5.p2.4.m4.2.2.1.1.2.cmml">,</mo><msub id="S3.SS5.p2.4.m4.2.2.1.1.1.1" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS5.p2.4.m4.2.2.1.1.1.1.2" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1.2.cmml">q</mi><mn id="S3.SS5.p2.4.m4.2.2.1.1.1.1.3" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS5.p2.4.m4.2.2.1.1.1.4" stretchy="false" xref="S3.SS5.p2.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS5.p2.4.m4.3.3.3" xref="S3.SS5.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS5.p2.4.m4.3.3.2.1" xref="S3.SS5.p2.4.m4.3.3.2.2.cmml"><mo id="S3.SS5.p2.4.m4.3.3.2.1.2" stretchy="false" xref="S3.SS5.p2.4.m4.3.3.2.2.1.cmml">⌊</mo><mrow id="S3.SS5.p2.4.m4.3.3.2.1.1" xref="S3.SS5.p2.4.m4.3.3.2.1.1.cmml"><msub id="S3.SS5.p2.4.m4.3.3.2.1.1.2" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2.cmml"><mi id="S3.SS5.p2.4.m4.3.3.2.1.1.2.2" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2.2.cmml">q</mi><mn id="S3.SS5.p2.4.m4.3.3.2.1.1.2.3" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS5.p2.4.m4.3.3.2.1.1.1" xref="S3.SS5.p2.4.m4.3.3.2.1.1.1.cmml">⁢</mo><msup id="S3.SS5.p2.4.m4.3.3.2.1.1.3" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.cmml"><mfrac id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.cmml"><mn id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.2" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.2.cmml">1</mn><mn id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.3" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.3.cmml">2</mn></mfrac><mi id="S3.SS5.p2.4.m4.3.3.2.1.1.3.3" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.3.cmml">t</mi></msup></mrow><mo id="S3.SS5.p2.4.m4.3.3.2.1.3" stretchy="false" xref="S3.SS5.p2.4.m4.3.3.2.2.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.4.m4.3b"><apply id="S3.SS5.p2.4.m4.3.3.cmml" xref="S3.SS5.p2.4.m4.3.3"><eq id="S3.SS5.p2.4.m4.3.3.3.cmml" xref="S3.SS5.p2.4.m4.3.3.3"></eq><apply id="S3.SS5.p2.4.m4.2.2.1.cmml" xref="S3.SS5.p2.4.m4.2.2.1"><times id="S3.SS5.p2.4.m4.2.2.1.2.cmml" xref="S3.SS5.p2.4.m4.2.2.1.2"></times><ci id="S3.SS5.p2.4.m4.2.2.1.3.cmml" xref="S3.SS5.p2.4.m4.2.2.1.3">𝛿</ci><interval closure="open" id="S3.SS5.p2.4.m4.2.2.1.1.2.cmml" xref="S3.SS5.p2.4.m4.2.2.1.1.1"><ci id="S3.SS5.p2.4.m4.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1">𝑡</ci><apply id="S3.SS5.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p2.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1.2">𝑞</ci><cn id="S3.SS5.p2.4.m4.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS5.p2.4.m4.2.2.1.1.1.1.3">0</cn></apply></interval></apply><apply id="S3.SS5.p2.4.m4.3.3.2.2.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1"><floor id="S3.SS5.p2.4.m4.3.3.2.2.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.2"></floor><apply id="S3.SS5.p2.4.m4.3.3.2.1.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1"><times id="S3.SS5.p2.4.m4.3.3.2.1.1.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.1"></times><apply id="S3.SS5.p2.4.m4.3.3.2.1.1.2.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.3.3.2.1.1.2.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2">subscript</csymbol><ci id="S3.SS5.p2.4.m4.3.3.2.1.1.2.2.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2.2">𝑞</ci><cn id="S3.SS5.p2.4.m4.3.3.2.1.1.2.3.cmml" type="integer" xref="S3.SS5.p2.4.m4.3.3.2.1.1.2.3">0</cn></apply><apply id="S3.SS5.p2.4.m4.3.3.2.1.1.3.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.3.3.2.1.1.3.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3">superscript</csymbol><apply id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2"><divide id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.1.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2"></divide><cn id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.2.cmml" type="integer" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.2">1</cn><cn id="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.3.cmml" type="integer" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.2.3">2</cn></apply><ci id="S3.SS5.p2.4.m4.3.3.2.1.1.3.3.cmml" xref="S3.SS5.p2.4.m4.3.3.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.4.m4.3c">\delta(t,q_{0})=\lfloor q_{0}\frac{1}{2}^{t}\rfloor</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.4.m4.3d">italic_δ ( italic_t , italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = ⌊ italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG 2 end_ARG start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ⌋</annotation></semantics></math>, where <math alttext="q_{0}" class="ltx_Math" display="inline" id="S3.SS5.p2.5.m5.1"><semantics id="S3.SS5.p2.5.m5.1a"><msub id="S3.SS5.p2.5.m5.1.1" xref="S3.SS5.p2.5.m5.1.1.cmml"><mi id="S3.SS5.p2.5.m5.1.1.2" xref="S3.SS5.p2.5.m5.1.1.2.cmml">q</mi><mn id="S3.SS5.p2.5.m5.1.1.3" xref="S3.SS5.p2.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.5.m5.1b"><apply id="S3.SS5.p2.5.m5.1.1.cmml" xref="S3.SS5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.5.m5.1.1.1.cmml" xref="S3.SS5.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.p2.5.m5.1.1.2.cmml" xref="S3.SS5.p2.5.m5.1.1.2">𝑞</ci><cn id="S3.SS5.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS5.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.5.m5.1c">q_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.5.m5.1d">italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the first observed product quantity and <math alttext="t" class="ltx_Math" display="inline" id="S3.SS5.p2.6.m6.1"><semantics id="S3.SS5.p2.6.m6.1a"><mi id="S3.SS5.p2.6.m6.1.1" xref="S3.SS5.p2.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.6.m6.1b"><ci id="S3.SS5.p2.6.m6.1.1.cmml" xref="S3.SS5.p2.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.6.m6.1d">italic_t</annotation></semantics></math> is the time step, or the <math alttext="t^{th}" class="ltx_Math" display="inline" id="S3.SS5.p2.7.m7.1"><semantics id="S3.SS5.p2.7.m7.1a"><msup id="S3.SS5.p2.7.m7.1.1" xref="S3.SS5.p2.7.m7.1.1.cmml"><mi id="S3.SS5.p2.7.m7.1.1.2" xref="S3.SS5.p2.7.m7.1.1.2.cmml">t</mi><mrow id="S3.SS5.p2.7.m7.1.1.3" xref="S3.SS5.p2.7.m7.1.1.3.cmml"><mi id="S3.SS5.p2.7.m7.1.1.3.2" xref="S3.SS5.p2.7.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS5.p2.7.m7.1.1.3.1" xref="S3.SS5.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p2.7.m7.1.1.3.3" xref="S3.SS5.p2.7.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.7.m7.1b"><apply id="S3.SS5.p2.7.m7.1.1.cmml" xref="S3.SS5.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.7.m7.1.1.1.cmml" xref="S3.SS5.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS5.p2.7.m7.1.1.2.cmml" xref="S3.SS5.p2.7.m7.1.1.2">𝑡</ci><apply id="S3.SS5.p2.7.m7.1.1.3.cmml" xref="S3.SS5.p2.7.m7.1.1.3"><times id="S3.SS5.p2.7.m7.1.1.3.1.cmml" xref="S3.SS5.p2.7.m7.1.1.3.1"></times><ci id="S3.SS5.p2.7.m7.1.1.3.2.cmml" xref="S3.SS5.p2.7.m7.1.1.3.2">𝑡</ci><ci id="S3.SS5.p2.7.m7.1.1.3.3.cmml" xref="S3.SS5.p2.7.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.7.m7.1c">t^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.7.m7.1d">italic_t start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> time the product has been selected. The floor term ensures that the output is a discrete count, and that eventually, the decay will drop to zero. This decay schedule will slowly remove poorly performing products until they are completely removed. Fourth, we re-allocate the removed space with new products following an <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS5.p2.8.m8.1"><semantics id="S3.SS5.p2.8.m8.1a"><mi id="S3.SS5.p2.8.m8.1.1" xref="S3.SS5.p2.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.8.m8.1b"><ci id="S3.SS5.p2.8.m8.1.1.cmml" xref="S3.SS5.p2.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.8.m8.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.8.m8.1d">italic_ϵ</annotation></semantics></math>-greedy routine. With probability <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS5.p2.9.m9.1"><semantics id="S3.SS5.p2.9.m9.1a"><mi id="S3.SS5.p2.9.m9.1.1" xref="S3.SS5.p2.9.m9.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.9.m9.1b"><ci id="S3.SS5.p2.9.m9.1.1.cmml" xref="S3.SS5.p2.9.m9.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.9.m9.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.9.m9.1d">italic_ϵ</annotation></semantics></math>, we choose a random product from the candidate set, and with probability <math alttext="1-\epsilon" class="ltx_Math" display="inline" id="S3.SS5.p2.10.m10.1"><semantics id="S3.SS5.p2.10.m10.1a"><mrow id="S3.SS5.p2.10.m10.1.1" xref="S3.SS5.p2.10.m10.1.1.cmml"><mn id="S3.SS5.p2.10.m10.1.1.2" xref="S3.SS5.p2.10.m10.1.1.2.cmml">1</mn><mo id="S3.SS5.p2.10.m10.1.1.1" xref="S3.SS5.p2.10.m10.1.1.1.cmml">−</mo><mi id="S3.SS5.p2.10.m10.1.1.3" xref="S3.SS5.p2.10.m10.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.10.m10.1b"><apply id="S3.SS5.p2.10.m10.1.1.cmml" xref="S3.SS5.p2.10.m10.1.1"><minus id="S3.SS5.p2.10.m10.1.1.1.cmml" xref="S3.SS5.p2.10.m10.1.1.1"></minus><cn id="S3.SS5.p2.10.m10.1.1.2.cmml" type="integer" xref="S3.SS5.p2.10.m10.1.1.2">1</cn><ci id="S3.SS5.p2.10.m10.1.1.3.cmml" xref="S3.SS5.p2.10.m10.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.10.m10.1c">1-\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.10.m10.1d">1 - italic_ϵ</annotation></semantics></math> we choose a greedy action, or the candidate with the highest PEPF. Fifth, after we have <math alttext="V" class="ltx_Math" display="inline" id="S3.SS5.p2.11.m11.1"><semantics id="S3.SS5.p2.11.m11.1a"><mi id="S3.SS5.p2.11.m11.1.1" xref="S3.SS5.p2.11.m11.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.11.m11.1b"><ci id="S3.SS5.p2.11.m11.1.1.cmml" xref="S3.SS5.p2.11.m11.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.11.m11.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.11.m11.1d">italic_V</annotation></semantics></math> product swaps, we fill the remaining budget with the high PEPF products already in the state, <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS5.p2.12.m12.1"><semantics id="S3.SS5.p2.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.12.m12.1.1" xref="S3.SS5.p2.12.m12.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.12.m12.1b"><ci id="S3.SS5.p2.12.m12.1.1.cmml" xref="S3.SS5.p2.12.m12.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.12.m12.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.12.m12.1d">caligraphic_S</annotation></semantics></math>. We formally describe our search in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#alg2" title="Algorithm 2 ‣ 3.5. Heuristic Search ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In the following section we discuss our experimental setup to validate that <span class="ltx_text" id="S4.p1.1.1">EdgeRec3D</span> is an effective, real-world recommendation system for shelf space allocation. We perform both offline and online evaluation. Notably, we partner with a large beverage distribution company and perform two real-world experiments over the course of 2022. We then deploy the system to a larger set of users and stores in 2023.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Offline Evaluation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We perform an offline comparison of <span class="ltx_text" id="S4.SS1.p1.1.1">EdgeRec3D</span> to search algorithms that have been applied to the product assortment problem in prior work. Offline policy evaluation typical of reinforcement learning and bandit algorithms is notoriously difficult in part due to the ‘partial label’ problem <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib32" title="">2010</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>; Castells and Moffat, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib13" title="">2022</a>; Mandel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib34" title="">2016</a>)</cite>. We apply the evaluator proposed by Li et al. <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>)</cite>. To build a static dataset, we collect user logs from the <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.SS1.p1.1.2">control</span> group in experiment #2. This dataset is comprised of 33 stores, and covers approximately 8 weeks of time, and includes 14,830 transactions. It is important to note that the control data is a fair comparison because no online intervention is ever made by any of these search algorithms. The evaluator in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>)</cite> assumes the logged actions are <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.3">iid</span>. We randomly sample 50% of our logged interactions to reduce temporal dependency in the dataset.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We compare <span class="ltx_text" id="S4.SS1.p2.1.1">EdgeRec3D</span> to a variety of classic and modern baselines. We run each algorithm 30 times, and report the mean, standard deviation (in parentheses) and median payoff in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.T1" title="Table 1 ‣ 4.1. Offline Evaluation ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>. Both Deep Ensembles <cite class="ltx_cite ltx_citemacro_citep">(Lakshminarayanan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib30" title="">2017</a>)</cite> and Model-based Offline Policy Optimization (MOPO) <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib51" title="">2020</a>)</cite> feature modern neural networks with predictive uncertainty. For Deep Ensembles, we use the same heuristic search as <span class="ltx_text" id="S4.SS1.p2.1.2">EdgeRec3D</span> to measure the value of RBP. MOPO uses uncertainty penalized offline reinforcement learning for action selection. We observe that <span class="ltx_text" id="S4.SS1.p2.1.3">EdgeRec3D</span> outperforms all existing baselines in both mean and median payoff, indicating it can effectively take good actions under uncertainty.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">Additionally, we perform an ablation study of <span class="ltx_text" id="S4.SS1.p3.1.1">EdgeRec3D</span> using the same dataset and experimental setup described above. The results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.T3" title="Table 3 ‣ 4.2.1. Experimental Design ‣ 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">3</span></a>. We carefully remove each of the core components: clustering, Robust Bayesian Payoffs (RBP) and heuristic search. When we remove clustering, we fit a single, global reward model. When we remove RBP, the reward model is a non-Bayesian, simple linear regression. When we remove the heuristic search module, we apply a greedy search without the penalized reward ranking statistic. Overall, the heuristic search and Bayesian reward model have a large impact on performance and <span class="ltx_text" id="S4.SS1.p3.1.2">EdgeRec3D</span> outperforms all ablated variants.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.2.3"><span class="ltx_text" id="S4.T1.2.2.3.1" style="font-size:90%;">Algorithm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1">
<span class="ltx_text" id="S4.T1.1.1.1.1" style="font-size:90%;">Mean Reward </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.2.2.2">
<span class="ltx_text" id="S4.T1.2.2.2.1" style="font-size:90%;">Median Reward </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mo id="S4.T1.2.2.2.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T1.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.4.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.4.1.1"><span class="ltx_text" id="S4.T1.3.4.1.1.1" style="font-size:90%;">Dynamic Program</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.4.1.2"><span class="ltx_text" id="S4.T1.3.4.1.2.1" style="font-size:90%;">1.001 (1.8)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.4.1.3"><span class="ltx_text" id="S4.T1.3.4.1.3.1" style="font-size:90%;">0.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.5.2">
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.2.1"><span class="ltx_text" id="S4.T1.3.5.2.1.1" style="font-size:90%;">Linear Program</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.2.2"><span class="ltx_text" id="S4.T1.3.5.2.2.1" style="font-size:90%;">0.718 (1.6)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.2.3"><span class="ltx_text" id="S4.T1.3.5.2.3.1" style="font-size:90%;">0.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3">
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.1">
<math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.T1.3.3.1.m1.1"><semantics id="S4.T1.3.3.1.m1.1a"><mi id="S4.T1.3.3.1.m1.1.1" mathsize="90%" xref="S4.T1.3.3.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><ci id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">italic_ϵ</annotation></semantics></math><span class="ltx_text" id="S4.T1.3.3.1.1" style="font-size:90%;">-greedy</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.2"><span class="ltx_text" id="S4.T1.3.3.2.1" style="font-size:90%;">1.790 (1.6)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3"><span class="ltx_text" id="S4.T1.3.3.3.1" style="font-size:90%;">1.864</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.6.3">
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.3.1"><span class="ltx_text" id="S4.T1.3.6.3.1.1" style="font-size:90%;">Genetic</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.3.2"><span class="ltx_text" id="S4.T1.3.6.3.2.1" style="font-size:90%;">2.147 (1.8)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.3.3"><span class="ltx_text" id="S4.T1.3.6.3.3.1" style="font-size:90%;">2.265</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.7.4">
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.4.1"><span class="ltx_text" id="S4.T1.3.7.4.1.1" style="font-size:90%;">Deep Ensembles</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.4.2"><span class="ltx_text" id="S4.T1.3.7.4.2.1" style="font-size:90%;">1.895 (1.6)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.4.3"><span class="ltx_text" id="S4.T1.3.7.4.3.1" style="font-size:90%;">2.452</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.8.5">
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.5.1"><span class="ltx_text" id="S4.T1.3.8.5.1.1" style="font-size:90%;">MOPO</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.5.2"><span class="ltx_text" id="S4.T1.3.8.5.2.1" style="font-size:90%;">1.826 (1.6)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.5.3"><span class="ltx_text" id="S4.T1.3.8.5.3.1" style="font-size:90%;">2.048</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.9.6">
<td class="ltx_td ltx_align_center" id="S4.T1.3.9.6.1"><span class="ltx_text" id="S4.T1.3.9.6.1.1" style="font-size:90%;">EdgeRec3D</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.9.6.2">
<span class="ltx_text ltx_font_bold" id="S4.T1.3.9.6.2.1" style="font-size:90%;">2.466</span><span class="ltx_text" id="S4.T1.3.9.6.2.2" style="font-size:90%;"> (1.6)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.9.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.3.9.6.3.1" style="font-size:90%;">2.496</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Offline Evaluation using a static dataset and the offline policy evaluator algorithm from <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>)</cite></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T1.10"><span class="ltx_text" id="S4.T1.10.1" style="font-size:90%;">.</span></p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Online Experimental Phase</h3>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1">
<td class="ltx_td ltx_border_tt" id="S4.T2.1.1.2"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.3"><span class="ltx_text" id="S4.T2.1.1.3.1" style="font-size:90%;">Dates</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.4"><span class="ltx_text" id="S4.T2.1.1.4.1" style="font-size:90%;">Pre/Post (Days)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.5"><span class="ltx_text" id="S4.T2.1.1.5.1" style="font-size:90%;"># Stores</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.6"><span class="ltx_text" id="S4.T2.1.1.6.1" style="font-size:90%;"># Displays</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.7"><span class="ltx_text" id="S4.T2.1.1.7.1" style="font-size:90%;">Group</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.8"><span class="ltx_text" id="S4.T2.1.1.8.1" style="font-size:90%;">Avg Reco. Compliance</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.9"><span class="ltx_text" id="S4.T2.1.1.9.1" style="font-size:90%;">DID</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1">
<math alttext="p" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" mathsize="90%" xref="S4.T2.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S4.T2.1.1.1.1" style="font-size:90%;">-val</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.10"><span class="ltx_text" id="S4.T2.1.1.10.1" style="font-size:90%;">DID IQR</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2" rowspan="3"><span class="ltx_text" id="S4.T2.2.2.2.1" style="font-size:90%;">Exp. 1</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.3" rowspan="3"><span class="ltx_text" id="S4.T2.2.2.3.1" style="font-size:90%;">5/17 - 6/30</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.4" rowspan="3"><span class="ltx_text" id="S4.T2.2.2.4.1" style="font-size:90%;">25/20</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.5" rowspan="3"><span class="ltx_text" id="S4.T2.2.2.5.1" style="font-size:90%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.6" rowspan="3"><span class="ltx_text" id="S4.T2.2.2.6.1" style="font-size:90%;">22</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.7"><span class="ltx_text" id="S4.T2.2.2.7.1" style="font-size:90%;">Store #1</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.8"><span class="ltx_text" id="S4.T2.2.2.8.1" style="font-size:90%;">100%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.1"><math alttext="+35.10\%^{\ast\ast}" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mo id="S4.T2.2.2.1.m1.1.1a" mathsize="90%" xref="S4.T2.2.2.1.m1.1.1.cmml">+</mo><msup id="S4.T2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.2.cmml"><mrow id="S4.T2.2.2.1.m1.1.1.2.2" xref="S4.T2.2.2.1.m1.1.1.2.2.cmml"><mn id="S4.T2.2.2.1.m1.1.1.2.2.2" mathsize="90%" xref="S4.T2.2.2.1.m1.1.1.2.2.2.cmml">35.10</mn><mo id="S4.T2.2.2.1.m1.1.1.2.2.1" mathsize="90%" xref="S4.T2.2.2.1.m1.1.1.2.2.1.cmml">%</mo></mrow><mrow id="S4.T2.2.2.1.m1.1.1.2.3" xref="S4.T2.2.2.1.m1.1.1.2.3.cmml"><mi id="S4.T2.2.2.1.m1.1.1.2.3.2" xref="S4.T2.2.2.1.m1.1.1.2.3.2.cmml"></mi><mo id="S4.T2.2.2.1.m1.1.1.2.3.1" lspace="0.222em" mathsize="90%" rspace="0em" xref="S4.T2.2.2.1.m1.1.1.2.3.1.cmml">∗</mo><mo id="S4.T2.2.2.1.m1.1.1.2.3.3" lspace="0em" mathsize="90%" xref="S4.T2.2.2.1.m1.1.1.2.3.3.cmml">∗</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><plus id="S4.T2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"></plus><apply id="S4.T2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.2">superscript</csymbol><apply id="S4.T2.2.2.1.m1.1.1.2.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2.2"><csymbol cd="latexml" id="S4.T2.2.2.1.m1.1.1.2.2.1.cmml" xref="S4.T2.2.2.1.m1.1.1.2.2.1">percent</csymbol><cn id="S4.T2.2.2.1.m1.1.1.2.2.2.cmml" type="float" xref="S4.T2.2.2.1.m1.1.1.2.2.2">35.10</cn></apply><apply id="S4.T2.2.2.1.m1.1.1.2.3.cmml" xref="S4.T2.2.2.1.m1.1.1.2.3"><ci id="S4.T2.2.2.1.m1.1.1.2.3.1.cmml" xref="S4.T2.2.2.1.m1.1.1.2.3.1">∗</ci><csymbol cd="latexml" id="S4.T2.2.2.1.m1.1.1.2.3.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2.3.2">absent</csymbol><ci id="S4.T2.2.2.1.m1.1.1.2.3.3.cmml" xref="S4.T2.2.2.1.m1.1.1.2.3.3">∗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">+35.10\%^{\ast\ast}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">+ 35.10 % start_POSTSUPERSCRIPT ∗ ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.9"><span class="ltx_text" id="S4.T2.2.2.9.1" style="font-size:90%;">0.014</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.10"><span class="ltx_text" id="S4.T2.2.2.10.1" style="font-size:90%;">[23.65%, 46.08%]</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.2"><span class="ltx_text" id="S4.T2.3.3.2.1" style="font-size:90%;">Store #2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3"><span class="ltx_text" id="S4.T2.3.3.3.1" style="font-size:90%;">100%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.1"><math alttext="+32.04\%^{\ast}" class="ltx_Math" display="inline" id="S4.T2.3.3.1.m1.1"><semantics id="S4.T2.3.3.1.m1.1a"><mrow id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml"><mo id="S4.T2.3.3.1.m1.1.1a" mathsize="90%" xref="S4.T2.3.3.1.m1.1.1.cmml">+</mo><msup id="S4.T2.3.3.1.m1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.2.cmml"><mrow id="S4.T2.3.3.1.m1.1.1.2.2" xref="S4.T2.3.3.1.m1.1.1.2.2.cmml"><mn id="S4.T2.3.3.1.m1.1.1.2.2.2" mathsize="90%" xref="S4.T2.3.3.1.m1.1.1.2.2.2.cmml">32.04</mn><mo id="S4.T2.3.3.1.m1.1.1.2.2.1" mathsize="90%" xref="S4.T2.3.3.1.m1.1.1.2.2.1.cmml">%</mo></mrow><mo id="S4.T2.3.3.1.m1.1.1.2.3" mathsize="90%" xref="S4.T2.3.3.1.m1.1.1.2.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"><plus id="S4.T2.3.3.1.m1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"></plus><apply id="S4.T2.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.2">superscript</csymbol><apply id="S4.T2.3.3.1.m1.1.1.2.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2.2"><csymbol cd="latexml" id="S4.T2.3.3.1.m1.1.1.2.2.1.cmml" xref="S4.T2.3.3.1.m1.1.1.2.2.1">percent</csymbol><cn id="S4.T2.3.3.1.m1.1.1.2.2.2.cmml" type="float" xref="S4.T2.3.3.1.m1.1.1.2.2.2">32.04</cn></apply><ci id="S4.T2.3.3.1.m1.1.1.2.3.cmml" xref="S4.T2.3.3.1.m1.1.1.2.3">∗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">+32.04\%^{\ast}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.m1.1d">+ 32.04 % start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.4"><span class="ltx_text" id="S4.T2.3.3.4.1" style="font-size:90%;">0.064</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.5"><span class="ltx_text" id="S4.T2.3.3.5.1" style="font-size:90%;">[15.24%, 44.27%]</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2"><span class="ltx_text" id="S4.T2.4.4.2.1" style="font-size:90%;">All</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.3"><span class="ltx_text" id="S4.T2.4.4.3.1" style="font-size:90%;">100%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.1"><math alttext="+35.03\%^{\ast\ast}" class="ltx_Math" display="inline" id="S4.T2.4.4.1.m1.1"><semantics id="S4.T2.4.4.1.m1.1a"><mrow id="S4.T2.4.4.1.m1.1.1" xref="S4.T2.4.4.1.m1.1.1.cmml"><mo id="S4.T2.4.4.1.m1.1.1a" mathsize="90%" xref="S4.T2.4.4.1.m1.1.1.cmml">+</mo><msup id="S4.T2.4.4.1.m1.1.1.2" xref="S4.T2.4.4.1.m1.1.1.2.cmml"><mrow id="S4.T2.4.4.1.m1.1.1.2.2" xref="S4.T2.4.4.1.m1.1.1.2.2.cmml"><mn id="S4.T2.4.4.1.m1.1.1.2.2.2" mathsize="90%" xref="S4.T2.4.4.1.m1.1.1.2.2.2.cmml">35.03</mn><mo id="S4.T2.4.4.1.m1.1.1.2.2.1" mathsize="90%" xref="S4.T2.4.4.1.m1.1.1.2.2.1.cmml">%</mo></mrow><mrow id="S4.T2.4.4.1.m1.1.1.2.3" xref="S4.T2.4.4.1.m1.1.1.2.3.cmml"><mi id="S4.T2.4.4.1.m1.1.1.2.3.2" xref="S4.T2.4.4.1.m1.1.1.2.3.2.cmml"></mi><mo id="S4.T2.4.4.1.m1.1.1.2.3.1" lspace="0.222em" mathsize="90%" rspace="0em" xref="S4.T2.4.4.1.m1.1.1.2.3.1.cmml">∗</mo><mo id="S4.T2.4.4.1.m1.1.1.2.3.3" lspace="0em" mathsize="90%" xref="S4.T2.4.4.1.m1.1.1.2.3.3.cmml">∗</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.1b"><apply id="S4.T2.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1"><plus id="S4.T2.4.4.1.m1.1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1"></plus><apply id="S4.T2.4.4.1.m1.1.1.2.cmml" xref="S4.T2.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.4.4.1.m1.1.1.2.1.cmml" xref="S4.T2.4.4.1.m1.1.1.2">superscript</csymbol><apply id="S4.T2.4.4.1.m1.1.1.2.2.cmml" xref="S4.T2.4.4.1.m1.1.1.2.2"><csymbol cd="latexml" id="S4.T2.4.4.1.m1.1.1.2.2.1.cmml" xref="S4.T2.4.4.1.m1.1.1.2.2.1">percent</csymbol><cn id="S4.T2.4.4.1.m1.1.1.2.2.2.cmml" type="float" xref="S4.T2.4.4.1.m1.1.1.2.2.2">35.03</cn></apply><apply id="S4.T2.4.4.1.m1.1.1.2.3.cmml" xref="S4.T2.4.4.1.m1.1.1.2.3"><ci id="S4.T2.4.4.1.m1.1.1.2.3.1.cmml" xref="S4.T2.4.4.1.m1.1.1.2.3.1">∗</ci><csymbol cd="latexml" id="S4.T2.4.4.1.m1.1.1.2.3.2.cmml" xref="S4.T2.4.4.1.m1.1.1.2.3.2">absent</csymbol><ci id="S4.T2.4.4.1.m1.1.1.2.3.3.cmml" xref="S4.T2.4.4.1.m1.1.1.2.3.3">∗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.1c">+35.03\%^{\ast\ast}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.1.m1.1d">+ 35.03 % start_POSTSUPERSCRIPT ∗ ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.4"><span class="ltx_text" id="S4.T2.4.4.4.1" style="font-size:90%;">0.016</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.5"><span class="ltx_text" id="S4.T2.4.4.5.1" style="font-size:90%;">[23.42%, 42.78%]</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.6.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.5.6.1.1.1" style="font-size:90%;">Exp. 2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.2" rowspan="2"><span class="ltx_text" id="S4.T2.5.6.1.2.1" style="font-size:90%;">9/21 - 11/19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.3" rowspan="2"><span class="ltx_text" id="S4.T2.5.6.1.3.1" style="font-size:90%;">21/38</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.4" rowspan="2"><span class="ltx_text" id="S4.T2.5.6.1.4.1" style="font-size:90%;">33</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.5" rowspan="2"><span class="ltx_text" id="S4.T2.5.6.1.5.1" style="font-size:90%;">133</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.6"><span class="ltx_text" id="S4.T2.5.6.1.6.1" style="font-size:90%;">All</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.7"><span class="ltx_text" id="S4.T2.5.6.1.7.1" style="font-size:90%;">61.64%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.8"><span class="ltx_text" id="S4.T2.5.6.1.8.1" style="font-size:90%;">+07.83%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.9"><span class="ltx_text" id="S4.T2.5.6.1.9.1" style="font-size:90%;">0.222</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.6.1.10"><span class="ltx_text" id="S4.T2.5.6.1.10.1" style="font-size:90%;">[1.67%, 13.65%]</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.2"><span class="ltx_text" id="S4.T2.5.5.2.1" style="font-size:90%;">High</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.3"><span class="ltx_text" id="S4.T2.5.5.3.1" style="font-size:90%;">90.38%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.1">
<span class="ltx_text" id="S4.T2.5.5.1.1" style="font-size:90%;">+27.78%</span><sup class="ltx_sup" id="S4.T2.5.5.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.5.5.1.2.1" style="font-size:90%;">∗∗</span></sup>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.4"><span class="ltx_text" id="S4.T2.5.5.4.1" style="font-size:90%;">0.003</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.5"><span class="ltx_text" id="S4.T2.5.5.5.1" style="font-size:90%;">[21.12%, 35.18%]</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2. </span>Overall summary of our two field experiments based on the Difference-in-Difference (DID) experimental design. Where recommended changes are adopted (high compliance), we see large increases in sales that are statistically meaningful. We use <sup class="ltx_sup" id="S4.T2.23.1"><span class="ltx_text ltx_font_italic" id="S4.T2.23.1.1">∗∗</span></sup> to denote significance at <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S4.T2.11.m2.1"><semantics id="S4.T2.11.m2.1b"><mrow id="S4.T2.11.m2.1.1" xref="S4.T2.11.m2.1.1.cmml"><mi id="S4.T2.11.m2.1.1.2" xref="S4.T2.11.m2.1.1.2.cmml">α</mi><mo id="S4.T2.11.m2.1.1.1" xref="S4.T2.11.m2.1.1.1.cmml">=</mo><mn id="S4.T2.11.m2.1.1.3" xref="S4.T2.11.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.m2.1c"><apply id="S4.T2.11.m2.1.1.cmml" xref="S4.T2.11.m2.1.1"><eq id="S4.T2.11.m2.1.1.1.cmml" xref="S4.T2.11.m2.1.1.1"></eq><ci id="S4.T2.11.m2.1.1.2.cmml" xref="S4.T2.11.m2.1.1.2">𝛼</ci><cn id="S4.T2.11.m2.1.1.3.cmml" type="float" xref="S4.T2.11.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.m2.1d">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.m2.1e">italic_α = 0.05</annotation></semantics></math>, and <sup class="ltx_sup" id="S4.T2.24.2"><span class="ltx_text ltx_font_italic" id="S4.T2.24.2.1">∗</span></sup> for significance at <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S4.T2.13.m4.1"><semantics id="S4.T2.13.m4.1b"><mrow id="S4.T2.13.m4.1.1" xref="S4.T2.13.m4.1.1.cmml"><mi id="S4.T2.13.m4.1.1.2" xref="S4.T2.13.m4.1.1.2.cmml">α</mi><mo id="S4.T2.13.m4.1.1.1" xref="S4.T2.13.m4.1.1.1.cmml">=</mo><mn id="S4.T2.13.m4.1.1.3" xref="S4.T2.13.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.m4.1c"><apply id="S4.T2.13.m4.1.1.cmml" xref="S4.T2.13.m4.1.1"><eq id="S4.T2.13.m4.1.1.1.cmml" xref="S4.T2.13.m4.1.1.1"></eq><ci id="S4.T2.13.m4.1.1.2.cmml" xref="S4.T2.13.m4.1.1.2">𝛼</ci><cn id="S4.T2.13.m4.1.1.3.cmml" type="float" xref="S4.T2.13.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.m4.1d">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.m4.1e">italic_α = 0.1</annotation></semantics></math>.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Experimental Design</h4>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.1">Exp.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.2">Clustering</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.3">RBP</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.4">Heuristic Search</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.5">Reward</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.2.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.1.1"># 1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.1.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.1.3">✗</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.1.4">✗</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.1.5">0.866 (1.6)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.3.2">
<td class="ltx_td ltx_align_center" id="S4.T3.2.3.2.1"># 2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.3.2.2">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.3.2.3">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.3.2.4">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.3.2.5">2.020 (1.4)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.4.3">
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.3.1"># 3</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.3.2">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.3.3">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.3.4">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.3.5">0.585 (1.4)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.5.4">
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.4.1"># 4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.4.2">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.4.3">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.4.4">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.4.5">2.143 (1.4)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.6.5">
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.5.1"># 5</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.5.2">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.5.3">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.5.4">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.5.5">0.998 (1.7)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.7.6">
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.6.1"># 6</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.6.2">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.6.3">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.6.4">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.6.5">2.308 (1.7)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.8.7">
<td class="ltx_td ltx_align_center" id="S4.T3.2.8.7.1"># 7</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.8.7.2">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.8.7.3">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.8.7.4">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.8.7.5">0.490 (1.2)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.9.8">
<td class="ltx_td ltx_align_center" id="S4.T3.2.9.8.1"># 8</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.9.8.2">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.9.8.3">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.9.8.4">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.9.8.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.5.1">2.466 (1.6)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.3.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S4.T3.4.2" style="font-size:90%;">Offline ablation study using a static dataset and the offline policy evaluator algorithm from <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>)</cite></span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">Controlled experiments in real-world scenarios can be a challenging task due to the possibility of confounding, or omitted variables. To account for potential confounders, we use a <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p1.1.1">within-store</span> Difference-in-Difference (DID) experimental design for both of our field experiments. DID estimation is a commonly used experimental design technique in the Econometrics literature to assess causal relationships <cite class="ltx_cite ltx_citemacro_citep">(Angrist and Pischke, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib4" title="">2009</a>; DiNardo, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib19" title="">2010</a>)</cite>. The key idea behind the DID experimental design is to measure the change in a response variable before and after an intervention for both the affected and unaffected groups <cite class="ltx_cite ltx_citemacro_citep">(Bertrand et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib9" title="">2004</a>)</cite>. The difference of these changes is the treatment effect. More formally, <math alttext="\widehat{\textrm{DID}}=(\texttt{post}_{\textrm{treat}}-\texttt{pre}_{\textrm{%
treat}})-(\texttt{post}_{\textrm{control}}-\texttt{pre}_{\textrm{control}})" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.2"><semantics id="S4.SS2.SSS1.p1.1.m1.2a"><mrow id="S4.SS2.SSS1.p1.1.m1.2.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.1.m1.2.2.4" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.cmml"><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.4.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.2a.cmml">DID</mtext><mo id="S4.SS2.SSS1.p1.1.m1.2.2.4.1" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.1.cmml">^</mo></mover><mo id="S4.SS2.SSS1.p1.1.m1.2.2.3" xref="S4.SS2.SSS1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.1.m1.2.2.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.cmml"><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml"><msub id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2a.cmml">post</mtext><mtext id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3a.cmml">treat</mtext></msub><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2a.cmml">pre</mtext><mtext id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3a.cmml">treat</mtext></msub></mrow><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS1.p1.1.m1.2.2.2.3" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.3.cmml">−</mo><mrow id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml"><mo id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml"><msub id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2a.cmml">post</mtext><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3a.cmml">control</mtext></msub><mo id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.1.cmml">−</mo><msub id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2a.cmml">pre</mtext><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3a.cmml">control</mtext></msub></mrow><mo id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.2b"><apply id="S4.SS2.SSS1.p1.1.m1.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2"><eq id="S4.SS2.SSS1.p1.1.m1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.3"></eq><apply id="S4.SS2.SSS1.p1.1.m1.2.2.4.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.4"><ci id="S4.SS2.SSS1.p1.1.m1.2.2.4.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.1">^</ci><ci id="S4.SS2.SSS1.p1.1.m1.2.2.4.2a.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.2"><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.4.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.4.2">DID</mtext></ci></apply><apply id="S4.SS2.SSS1.p1.1.m1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2"><minus id="S4.SS2.SSS1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.3"></minus><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1"><minus id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1"></minus><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2a.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.2">post</mtext></ci><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3a.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3"><mtext id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.3">treat</mtext></ci></apply><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2a.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.2">pre</mtext></ci><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3a.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3"><mtext id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.3">treat</mtext></ci></apply></apply><apply id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1"><minus id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.1"></minus><apply id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2a.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.2">post</mtext></ci><ci id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3a.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3"><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3.cmml" mathsize="70%" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.2.3">control</mtext></ci></apply><apply id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2a.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.2">pre</mtext></ci><ci id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3a.cmml" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3"><mtext id="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.3.3">control</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.2c">\widehat{\textrm{DID}}=(\texttt{post}_{\textrm{treat}}-\texttt{pre}_{\textrm{%
treat}})-(\texttt{post}_{\textrm{control}}-\texttt{pre}_{\textrm{control}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.2d">over^ start_ARG DID end_ARG = ( post start_POSTSUBSCRIPT treat end_POSTSUBSCRIPT - pre start_POSTSUBSCRIPT treat end_POSTSUBSCRIPT ) - ( post start_POSTSUBSCRIPT control end_POSTSUBSCRIPT - pre start_POSTSUBSCRIPT control end_POSTSUBSCRIPT )</annotation></semantics></math>, where <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS1.p1.1.2">pre</span> and <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS1.p1.1.3">post</span> are pre-treatment and post-treatment periods respectively. Our controlled experiments have the following design steps:</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">We mark a set of product displays in each store for observation. A product display is a shelf, cooler, end-rack or other merchandising display. Each display is uniquely identified via QR code.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i2.p1.1.1">Within</span> each store, we randomly assign each display to either treatment or control with 50% probability.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">The control displays are merchandised according to current industry best practices. Treatment displays are merchandised with the recommended actions from EdgeRec3D.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">For both treatment and control, the user (retail worker or merchandiser) visits the display typically on a daily basis. A QR code is scanned to uniquely identify that display. The user replenishes the product, and uses a mobile app to observe the state and record new sales.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1">Pre-treatment: Sales are recorded for both treatment and control. For both groups, we monitor sales without making recommendations for a fixed period to get a sales baseline.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i6.p1">
<p class="ltx_p" id="S4.I1.i6.p1.1">Post-treatment: After the pre-treatment period has ended, EdgeRec3D begins serving product recommendations for the treatment group only.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i7.p1">
<p class="ltx_p" id="S4.I1.i7.p1.1">At the conclusion of the post-treatment period, we calculate the difference-in-difference estimator, <math alttext="\widehat{\textrm{DID}}" class="ltx_Math" display="inline" id="S4.I1.i7.p1.1.m1.1"><semantics id="S4.I1.i7.p1.1.m1.1a"><mover accent="true" id="S4.I1.i7.p1.1.m1.1.1" xref="S4.I1.i7.p1.1.m1.1.1.cmml"><mtext id="S4.I1.i7.p1.1.m1.1.1.2" xref="S4.I1.i7.p1.1.m1.1.1.2a.cmml">DID</mtext><mo id="S4.I1.i7.p1.1.m1.1.1.1" xref="S4.I1.i7.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I1.i7.p1.1.m1.1b"><apply id="S4.I1.i7.p1.1.m1.1.1.cmml" xref="S4.I1.i7.p1.1.m1.1.1"><ci id="S4.I1.i7.p1.1.m1.1.1.1.cmml" xref="S4.I1.i7.p1.1.m1.1.1.1">^</ci><ci id="S4.I1.i7.p1.1.m1.1.1.2a.cmml" xref="S4.I1.i7.p1.1.m1.1.1.2"><mtext id="S4.I1.i7.p1.1.m1.1.1.2.cmml" xref="S4.I1.i7.p1.1.m1.1.1.2">DID</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i7.p1.1.m1.1c">\widehat{\textrm{DID}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i7.p1.1.m1.1d">over^ start_ARG DID end_ARG</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.3">Note that recommendations are simply displayed to users (retail workers or merchandisers); ultimately, each user has the autonomy to accept or reject the EdgeRec3D suggestions. Some fail to accept due to time constraints, while others are simply resistant to using the system and prefer existing practice. We measure this acceptance rate with a compliance statistic, the Jaccard index between the recommended state, <math alttext="R" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.1.m1.1"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><mi id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><ci id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.1.m1.1d">italic_R</annotation></semantics></math>, and the observed state <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.2.m2.1"><semantics id="S4.SS2.SSS1.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.2.m2.1.1" xref="S4.SS2.SSS1.p3.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.2.m2.1b"><ci id="S4.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.2.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.2.m2.1d">caligraphic_S</annotation></semantics></math>: <math alttext="\rho(R,\mathcal{S})=J(R,\mathcal{S})" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.3.m3.4"><semantics id="S4.SS2.SSS1.p3.3.m3.4a"><mrow id="S4.SS2.SSS1.p3.3.m3.4.5" xref="S4.SS2.SSS1.p3.3.m3.4.5.cmml"><mrow id="S4.SS2.SSS1.p3.3.m3.4.5.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.cmml"><mi id="S4.SS2.SSS1.p3.3.m3.4.5.2.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.2.1" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p3.3.m3.4.5.2.3.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.3.1.cmml"><mo id="S4.SS2.SSS1.p3.3.m3.4.5.2.3.2.1" stretchy="false" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.3.1.cmml">(</mo><mi id="S4.SS2.SSS1.p3.3.m3.1.1" xref="S4.SS2.SSS1.p3.3.m3.1.1.cmml">R</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.2.3.2.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.3.m3.2.2" xref="S4.SS2.SSS1.p3.3.m3.2.2.cmml">𝒮</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.2.3.2.3" stretchy="false" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS1.p3.3.m3.4.5.1" xref="S4.SS2.SSS1.p3.3.m3.4.5.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p3.3.m3.4.5.3" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.cmml"><mi id="S4.SS2.SSS1.p3.3.m3.4.5.3.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.2.cmml">J</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.3.1" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.1.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p3.3.m3.4.5.3.3.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.3.1.cmml"><mo id="S4.SS2.SSS1.p3.3.m3.4.5.3.3.2.1" stretchy="false" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.3.1.cmml">(</mo><mi id="S4.SS2.SSS1.p3.3.m3.3.3" xref="S4.SS2.SSS1.p3.3.m3.3.3.cmml">R</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.3.3.2.2" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.3.m3.4.4" xref="S4.SS2.SSS1.p3.3.m3.4.4.cmml">𝒮</mi><mo id="S4.SS2.SSS1.p3.3.m3.4.5.3.3.2.3" stretchy="false" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.3.m3.4b"><apply id="S4.SS2.SSS1.p3.3.m3.4.5.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5"><eq id="S4.SS2.SSS1.p3.3.m3.4.5.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.1"></eq><apply id="S4.SS2.SSS1.p3.3.m3.4.5.2.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.2"><times id="S4.SS2.SSS1.p3.3.m3.4.5.2.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.1"></times><ci id="S4.SS2.SSS1.p3.3.m3.4.5.2.2.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.2">𝜌</ci><interval closure="open" id="S4.SS2.SSS1.p3.3.m3.4.5.2.3.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.2.3.2"><ci id="S4.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1">𝑅</ci><ci id="S4.SS2.SSS1.p3.3.m3.2.2.cmml" xref="S4.SS2.SSS1.p3.3.m3.2.2">𝒮</ci></interval></apply><apply id="S4.SS2.SSS1.p3.3.m3.4.5.3.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.3"><times id="S4.SS2.SSS1.p3.3.m3.4.5.3.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.1"></times><ci id="S4.SS2.SSS1.p3.3.m3.4.5.3.2.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.2">𝐽</ci><interval closure="open" id="S4.SS2.SSS1.p3.3.m3.4.5.3.3.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.5.3.3.2"><ci id="S4.SS2.SSS1.p3.3.m3.3.3.cmml" xref="S4.SS2.SSS1.p3.3.m3.3.3">𝑅</ci><ci id="S4.SS2.SSS1.p3.3.m3.4.4.cmml" xref="S4.SS2.SSS1.p3.3.m3.4.4">𝒮</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.3.m3.4c">\rho(R,\mathcal{S})=J(R,\mathcal{S})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.3.m3.4d">italic_ρ ( italic_R , caligraphic_S ) = italic_J ( italic_R , caligraphic_S )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p4">
<p class="ltx_p" id="S4.SS2.SSS1.p4.1">In our first experiment, we choose two stores in the Salt Lake City, Utah, USA region and focus the test on cooler displays. We run a six week experiment, from May 17 to June 30, 2022 using a DID design. The treatment period begins on June 10, 2022. Our second experiment is much larger and consists of 33 stores across the mountain west region of the United States (Utah, Colorado, Arizona, etc…). We again focus on cooler displays. Experiment #2 runs from September 21, 2022 to November 19, 2022, or approximately eight weeks. The treatment period begins on October 21, 2022. Due to the time and expense of online, controlled experiments we do not compare <span class="ltx_text" id="S4.SS2.SSS1.p4.1.1">EdgeRec3D</span> to the benchmark search algorithms studied in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.SS1" title="4.1. Offline Evaluation ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Instead, during our online evaluation we compare <span class="ltx_text" id="S4.SS2.SSS1.p4.1.2">EdgeRec3D</span> to current industry best practices.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Results</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">We provide an overall summary of our two field experiments in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.T2" title="Table 2 ‣ 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">2</span></a>. To obtain estimates of statistical confidence we perform a non-parametric permutation test <cite class="ltx_cite ltx_citemacro_citep">(Good, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib23" title="">2013</a>)</cite>. Across the two experiments, we see a +27.78% and +35.03% increase in average daily sales where recommendations are followed. These results are both statistically significant (<math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mrow id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS2.SSS2.p1.1.m1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><eq id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">𝛼</ci><cn id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">italic_α = 0.05</annotation></semantics></math>) and provide strong evidence that implementing and following the recommended product assortment decisions prescribed by <span class="ltx_text" id="S4.SS2.SSS2.p1.1.1">EdgeRec3D</span> have a positive, causal impact on daily average product sales.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Field Experiment #1</h5>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="207" id="S4.F3.g1" src="x3.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.3.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.4.2" style="font-size:90%;">Deployment phase observational study. We split stores into high a low compliance groups as in the experimental phase. We see that the two groups have roughly parallel trends in the pre-deployment period. We deploy <span class="ltx_text" id="S4.F3.4.2.1">EdgeRec3D</span> on April 16, 2023. In the post-deployment period, the two groups are still subject to the same seasonal trends, but the high compliance group diverges from the low compliance group. See Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.T4" title="Table 4 ‣ 4.3. Deployment Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> for full results.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS2.Px1.p1.1">In the first experiment, we deploy <span class="ltx_text" id="S4.SS2.SSS2.Px1.p1.1.1">EdgeRec3D</span> to only two stores with expert users. These users are able to take their time, and the implementation of recommendations served by <span class="ltx_text" id="S4.SS2.SSS2.Px1.p1.1.2">EdgeRec3D</span> is strictly enforced. Therefore, during experiment #1, the average recommendation compliance is 100%. We see a very high DID treatment effect of +35.03%.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS2.Px1.p2.1">Daily product sales in the treatment group increased by 0.95 units (+16.42%), while the control group saw a decrease of 1.0 units per day (-18.61%). The difference between these two yields the total treatment effect, <math alttext="16.42\%-(-18.62\%)=35.03\%" class="ltx_Math" display="inline" id="S4.SS2.SSS2.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS2.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.cmml"><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.cmml"><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.cmml"><mn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.2.cmml">16.42</mn><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.1.cmml">%</mo></mrow><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.2.cmml">−</mo><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1a" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.cmml"><mn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.2.cmml">18.62</mn><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.1.cmml">%</mo></mrow></mrow><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.cmml"><mn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.2.cmml">35.03</mn><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1"><eq id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2"></eq><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1"><minus id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.2"></minus><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3"><csymbol cd="latexml" id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.1">percent</csymbol><cn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.2.cmml" type="float" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.3.2">16.42</cn></apply><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1"><minus id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1"></minus><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.1">percent</csymbol><cn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.2.cmml" type="float" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.1.1.1.2.2">18.62</cn></apply></apply></apply><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3"><csymbol cd="latexml" id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.1">percent</csymbol><cn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.2.cmml" type="float" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.2">35.03</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p2.1.m1.1c">16.42\%-(-18.62\%)=35.03\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.Px1.p2.1.m1.1d">16.42 % - ( - 18.62 % ) = 35.03 %</annotation></semantics></math>. The control group offers a counterfactual estimate of what would have happened in the absence of the intervention (<span class="ltx_text" id="S4.SS2.SSS2.Px1.p2.1.1">EdgeRec3D</span>). This is known as the parallel trend assumption of DID <cite class="ltx_cite ltx_citemacro_citep">(Angrist and Pischke, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib4" title="">2009</a>)</cite>. Had we not deployed recommendations, it’s likely that average daily sales would have decreased at similar rates as the control group.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Field Experiment #2</h5>
<div class="ltx_para" id="S4.SS2.SSS2.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.Px2.p1.1">In this experiment, our user base consists of non-experts who have more time constraints (ie, other retail responsibilities), which is reflective of the real-world product assortment problem. Here, the user has the option to adopt the recommendation from <span class="ltx_text" id="S4.SS2.SSS2.Px2.p1.1.1">EdgeRec3D</span>. Consequently, we see more variation in recommendation compliance during experiment #2.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.Px2.p2.3">The DID treatment effect across all stores is +7.83%. While this result is positive, our confidence is not high enough to conclude statistical significance (<math alttext="p" class="ltx_Math" display="inline" id="S4.SS2.SSS2.Px2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.Px2.p2.1.m1.1a"><mi id="S4.SS2.SSS2.Px2.p2.1.m1.1.1" xref="S4.SS2.SSS2.Px2.p2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px2.p2.1.m1.1b"><ci id="S4.SS2.SSS2.Px2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px2.p2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px2.p2.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.Px2.p2.1.m1.1d">italic_p</annotation></semantics></math>-value = 0.222). However, the average recommendation compliance across all stores is only 61.64%. This suggests that a large number of users are ignoring the recommendations served by <span class="ltx_text" id="S4.SS2.SSS2.Px2.p2.3.1">EdgeRec3D</span>. Filtering to stores where recommended product sets are adopted (average compliance <math alttext="\geq 80\%" class="ltx_Math" display="inline" id="S4.SS2.SSS2.Px2.p2.2.m2.1"><semantics id="S4.SS2.SSS2.Px2.p2.2.m2.1a"><mrow id="S4.SS2.SSS2.Px2.p2.2.m2.1.1" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.2" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.2.cmml"></mi><mo id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.1" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.1.cmml">≥</mo><mrow id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.cmml"><mn id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.2" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.2.cmml">80</mn><mo id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.1" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px2.p2.2.m2.1b"><apply id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1"><geq id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.1"></geq><csymbol cd="latexml" id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.2">absent</csymbol><apply id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3"><csymbol cd="latexml" id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.1">percent</csymbol><cn id="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS2.SSS2.Px2.p2.2.m2.1.1.3.2">80</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px2.p2.2.m2.1c">\geq 80\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.Px2.p2.2.m2.1d">≥ 80 %</annotation></semantics></math>), shows a different result. Among this high compliance group we see very strong, positive results where the DID treatment effect is +27.78% and is significant at <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S4.SS2.SSS2.Px2.p2.3.m3.1"><semantics id="S4.SS2.SSS2.Px2.p2.3.m3.1a"><mrow id="S4.SS2.SSS2.Px2.p2.3.m3.1.1" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.2" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.1" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.3" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px2.p2.3.m3.1b"><apply id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1"><eq id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.1"></eq><ci id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.2">𝛼</ci><cn id="S4.SS2.SSS2.Px2.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS2.SSS2.Px2.p2.3.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px2.p2.3.m3.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.Px2.p2.3.m3.1d">italic_α = 0.05</annotation></semantics></math>. This leads us to conclude that high recommendation compliance leads to a large treatment effect. This aligns with our intuition because our system can only make recommendations, but it ultimately relies on a user to adopt and implement the change in the physical world. This relationship between compliance and treatment effect across our two experiments is captured in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F6" title="Figure 6 ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">6</span></a> of the supplement.</p>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Deployment Phase</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Following our two controlled experiments, we deploy <span class="ltx_text" id="S4.SS3.p1.1.1">EdgeRec3D</span> to 83 stores and monitor the impact on store-level sales for a period of 28 weeks (11 weeks pre-deployment and 17 week post-deployment). We again use a DID study design. However, this deployment phase differs from Experiment #1 and #2 in the following ways. First, recommendations are applied to all cooler displays; we do not randomly assign displays to treatment and control. Instead of a controlled experiment, we perform an observational study to monitor the effectiveness. Second, while <span class="ltx_text" id="S4.SS3.p1.1.2">EdgeRec3D</span> still uses 3D perception to estimate sales, here we measure performance using syndicated point-of-sale (POS) data. POS data allows us to observe sales prior to the deployment of our system, and quantify the impact of <span class="ltx_text" id="S4.SS3.p1.1.3">EdgeRec3D</span> post-deployment. The data contains sales information for all products and all locations within the store. We filter the POS data to products observed and tracked by <span class="ltx_text" id="S4.SS3.p1.1.4">EdgeRec3D</span> in our study. We are not able to disambiguate sale location in this data. Third, the syndicated POS data is reported weekly, instead of daily.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Results of our deployment are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.T4" title="Table 4 ‣ 4.3. Deployment Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> and visually depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S4.F3" title="Figure 3 ‣ Field Experiment #1 ‣ 4.2.2. Results ‣ 4.2. Online Experimental Phase ‣ 4. Experiments ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">3</span></a>. Since we no longer have treatment and control groups in our deployment phase, we use recommendation compliance as a measure of adoption. We again split stores into high and low compliance groups by calculating the average compliance over the course of the 17 week deployment period. Crucially, we also monitor average sales for these two groups <span class="ltx_text ltx_font_italic" id="S4.SS3.p2.1.1">prior</span> to deployment to get a baseline performance measurement.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">High compliance stores averaged sales of 80.91 units sales prior to the deployment date, and increased to an average of 88.01 post-deployment date, a change of 7.1 units or 8.8%. In contrast, low compliance stores averaged sales of 67.80 prior to the deployment date and stayed roughly the same, decreasing slightly, to 67.37 post-deployment date. These figures indicate a 7.53 unit per-product, per-week “treatment” effect on sales for the high compliance stores, which represents a 9.4% increase in weekly sales volume. This treatment effect is statistically meaningful (<math alttext="p=0.021" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">p</mi><mo id="S4.SS3.p3.1.m1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">0.021</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><eq id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"></eq><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑝</ci><cn id="S4.SS3.p3.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.p3.1.m1.1.1.3">0.021</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">p=0.021</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_p = 0.021</annotation></semantics></math>).</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">The results in the deployment phase are positive and meaningful, but lower in magnitude than the experimental phase. This is likely explained by the use of controlled experiments, which enable precise estimates of the treatment effect. In spite of this, we still see positive and statistically meaningful results as <span class="ltx_text" id="S4.SS3.p4.1.1">EdgeRec3D</span> is deployed.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.2.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.1.2.1">Low Comp.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.1.3.1">High Comp.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.1.4.1">Diff-in-Diff</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.3.1.1">Pre</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.3.1.2">67.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.1.3.1.3">80.91</td>
<td class="ltx_td ltx_border_tt" id="S4.T4.1.3.1.4"></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4.2">
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.2.1">Post</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.2.2">67.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.2.3">88.01</td>
<td class="ltx_td" id="S4.T4.1.4.2.4"></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2">Change</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3">-0.43 (-0.6%)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.4">+7.1 (+8.8%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1"><math alttext="\textbf{+7.53 (+9.4\%)}^{\ast\ast}" class="ltx_Math" display="inline" id="S4.T4.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.m1.1a"><msup id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.m1.1.1.2a.cmml">+7.53 (+9.4%)</mtext><mrow id="S4.T4.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.m1.1.1.3.cmml"><mi id="S4.T4.1.1.1.m1.1.1.3.2" xref="S4.T4.1.1.1.m1.1.1.3.2.cmml"></mi><mo id="S4.T4.1.1.1.m1.1.1.3.1" lspace="0.222em" rspace="0em" xref="S4.T4.1.1.1.m1.1.1.3.1.cmml">∗</mo><mo id="S4.T4.1.1.1.m1.1.1.3.3" lspace="0em" xref="S4.T4.1.1.1.m1.1.1.3.3.cmml">∗</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">superscript</csymbol><ci id="S4.T4.1.1.1.m1.1.1.2a.cmml" xref="S4.T4.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.m1.1.1.2">+7.53 (+9.4%)</mtext></ci><apply id="S4.T4.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.m1.1.1.3"><ci id="S4.T4.1.1.1.m1.1.1.3.1.cmml" xref="S4.T4.1.1.1.m1.1.1.3.1">∗</ci><csymbol cd="latexml" id="S4.T4.1.1.1.m1.1.1.3.2.cmml" xref="S4.T4.1.1.1.m1.1.1.3.2">absent</csymbol><ci id="S4.T4.1.1.1.m1.1.1.3.3.cmml" xref="S4.T4.1.1.1.m1.1.1.3.3">∗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\textbf{+7.53 (+9.4\%)}^{\ast\ast}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.m1.1d">+7.53 (+9.4%) start_POSTSUPERSCRIPT ∗ ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.7.2.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S4.T4.3.1" style="font-size:90%;">Observational study during the deployment phase of <span class="ltx_text" id="S4.T4.3.1.1">EdgeRec3D</span>. We show weekly average units sold before and after the intervention (<span class="ltx_text" id="S4.T4.3.1.2">EdgeRec3D</span>). The high compliance group increases by 7.1 (8.8%) weekly average units, while the low compliance group stays roughly the same. We calculate the percentage changes and difference these estimates to get the DID treatment effect of 9.4%. This estimate is statistically significant with <math alttext="p=0.021" class="ltx_Math" display="inline" id="S4.T4.3.1.m1.1"><semantics id="S4.T4.3.1.m1.1b"><mrow id="S4.T4.3.1.m1.1.1" xref="S4.T4.3.1.m1.1.1.cmml"><mi id="S4.T4.3.1.m1.1.1.2" xref="S4.T4.3.1.m1.1.1.2.cmml">p</mi><mo id="S4.T4.3.1.m1.1.1.1" xref="S4.T4.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.3.1.m1.1.1.3" xref="S4.T4.3.1.m1.1.1.3.cmml">0.021</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.m1.1c"><apply id="S4.T4.3.1.m1.1.1.cmml" xref="S4.T4.3.1.m1.1.1"><eq id="S4.T4.3.1.m1.1.1.1.cmml" xref="S4.T4.3.1.m1.1.1.1"></eq><ci id="S4.T4.3.1.m1.1.1.2.cmml" xref="S4.T4.3.1.m1.1.1.2">𝑝</ci><cn id="S4.T4.3.1.m1.1.1.3.cmml" type="float" xref="S4.T4.3.1.m1.1.1.3">0.021</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.m1.1d">p=0.021</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.1.m1.1e">italic_p = 0.021</annotation></semantics></math></span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_italic" id="S5.p1.1.1">Shelf Space Allocation</span> The shelf space allocation problem has been studied for many years in the Operations Research field <cite class="ltx_cite ltx_citemacro_citep">(Curhan, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib18" title="">1973</a>)</cite>. Classic optimization methods are commonly applied such as linear <cite class="ltx_cite ltx_citemacro_citep">(Yang and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib50" title="">1999</a>; Geismar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib22" title="">2015</a>)</cite>, or dynamic <cite class="ltx_cite ltx_citemacro_citep">(Zufryden, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib53" title="">1986</a>)</cite> programming, and game theory <cite class="ltx_cite ltx_citemacro_citep">(Martínez-de Albéniz and Roels, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib35" title="">2011</a>)</cite>. More computational methods such as genetic algorithms <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib52" title="">2023</a>; Castelli and Vanneschi, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib12" title="">2014</a>; Urban, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib48" title="">1998</a>; Hwang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib25" title="">2005</a>)</cite> and simulated annealing approaches <cite class="ltx_cite ltx_citemacro_citep">(Borin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib10" title="">1994</a>)</cite> have been proposed in recent years. Others have sought to jointly optimize both product assortment and price <cite class="ltx_cite ltx_citemacro_citep">(Murray et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib38" title="">2010</a>)</cite> via a branch-and-bound algorithm. <cite class="ltx_cite ltx_citemacro_citep">(Düsterhöft et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib21" title="">2020</a>)</cite> performed a controlled field test and showed a 9% increase in profit using a non-linear program to choose product assortment.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_italic" id="S5.p2.1.1">Offline Recommender Systems</span> The majority of work in recommender systems has been done online, in the e-commerce domain, but systems for offline commerce are growing in popularity <cite class="ltx_cite ltx_citemacro_citep">(Colombo-Mendoza et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib17" title="">2020</a>)</cite>. Early work <cite class="ltx_cite ltx_citemacro_citep">(Pathak et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib41" title="">2010</a>; Walter et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib49" title="">2012</a>)</cite> showed that recommender systems can positively impact offline product demand. Later work focused on collaborative filtering <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib46" title="">2014</a>; Park and Nam, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib40" title="">2019</a>)</cite> and association rule mining <cite class="ltx_cite ltx_citemacro_citep">(Tatiana and Mikhail, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib47" title="">2018</a>; Pandit et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib39" title="">2010</a>; Chen and Lin, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib16" title="">2007</a>; Brijs et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib11" title="">1999</a>)</cite>. Machine Learning techniques such as gradient-boosted trees <cite class="ltx_cite ltx_citemacro_citep">(Silva, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib45" title="">2020</a>)</cite>, K-nearest neighbors <cite class="ltx_cite ltx_citemacro_citep">(Leininger et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib31" title="">2020</a>)</cite>, ensemble techniques <cite class="ltx_cite ltx_citemacro_citep">(Bae and Kim, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib7" title="">2010</a>)</cite> and offline Reinforcement Learning <cite class="ltx_cite ltx_citemacro_citep">(Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib28" title="">2022</a>)</cite> have been studied. Location-based systems leverage customer location data from smartphones <cite class="ltx_cite ltx_citemacro_citep">(Chatzidimitris et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib14" title="">2020</a>)</cite> or RFID tags <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib15" title="">2015</a>)</cite> within a store. In contrast, <span class="ltx_text" id="S5.p2.1.2">EdgeRec3D</span> provides real-time assortment recommendations based on fine-grained sales estimates obtained via 3D computer vision, while also accounting for measurement error and preference heterogeneity across stores.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We proposed <span class="ltx_text" id="S6.p1.1.1">EdgeRec3D</span> to solve the product assortment problem in physical retail. <span class="ltx_text" id="S6.p1.1.2">EdgeRec3D</span> uses an edge-first architecture with real-time 3D perception to estimate product sales and observe display states. Making recommendations at the edge of the network closes the feedback loop and facilitates faster preference discovery. Additionally, <span class="ltx_text" id="S6.p1.1.3">EdgeRec3D</span> relies on a probabilistic reward model (RBP) for uncertainty quantification, spatial clustering to account for preference heterogeneity, and candidate generation with heuristic search to tackle combinatoric explosion. Controlled experiments and a 28 week observational study showed that <span class="ltx_text" id="S6.p1.1.4">EdgeRec3D</span> has meaningful, real-world impact.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allenby and Rossi (1998)</span>
<span class="ltx_bibblock">
Greg M Allenby and Peter E Rossi. 1998.

</span>
<span class="ltx_bibblock">Marketing models of consumer heterogeneity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Journal of econometrics</em> 89, 1-2 (1998), 57–78.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andersen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Andersen, Glenn W Harrison, Morten Igel Lau, and E Elisabet Rutström. 2010.

</span>
<span class="ltx_bibblock">Preference heterogeneity in experiments: Comparing the field and laboratory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Journal of Economic Behavior &amp; Organization</em> 73, 2 (2010), 209–224.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Angrist and Pischke (2009)</span>
<span class="ltx_bibblock">
Joshua D Angrist and Jörn-Steffen Pischke. 2009.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Mostly harmless econometrics: An empiricist’s companion</em>.

</span>
<span class="ltx_bibblock">Princeton university press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Auer et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2002)</span>
<span class="ltx_bibblock">
Peter Auer, Nicolo Cesa-Bianchi, and Paul Fischer. 2002.

</span>
<span class="ltx_bibblock">Finite-time analysis of the multiarmed bandit problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Machine learning</em> 47 (2002), 235–256.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Badgaiyan and Verma (2015)</span>
<span class="ltx_bibblock">
Anant Jyoti Badgaiyan and Anshul Verma. 2015.

</span>
<span class="ltx_bibblock">Does urge to buy impulsively differ from impulsive buying behaviour? Assessing the impact of situational factors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Journal of Retailing and Consumer Services</em> 22 (2015), 145–157.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bae and Kim (2010)</span>
<span class="ltx_bibblock">
Jae Kwon Bae and Jinhwa Kim. 2010.

</span>
<span class="ltx_bibblock">Integration of heterogeneous models to predict consumer behavior.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Expert Systems with Applications</em> 37, 3 (2010), 1821–1826.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balas and Zemel (1980)</span>
<span class="ltx_bibblock">
Egon Balas and Eitan Zemel. 1980.

</span>
<span class="ltx_bibblock">An algorithm for large zero-one knapsack problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">operations Research</em> 28, 5 (1980), 1130–1154.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertrand et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2004)</span>
<span class="ltx_bibblock">
Marianne Bertrand, Esther Duflo, and Sendhil Mullainathan. 2004.

</span>
<span class="ltx_bibblock">How much should we trust differences-in-differences estimates?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">The Quarterly journal of economics</em> 119, 1 (2004), 249–275.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borin et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (1994)</span>
<span class="ltx_bibblock">
Norm Borin, Paul W Farris, and James R Freeland. 1994.

</span>
<span class="ltx_bibblock">A model for determining retail product category assortment and shelf space allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Decision sciences</em> 25, 3 (1994), 359–384.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brijs et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (1999)</span>
<span class="ltx_bibblock">
Tom Brijs, Gilbert Swinnen, Koen Vanhoof, and Geert Wets. 1999.

</span>
<span class="ltx_bibblock">Using association rules for product assortment decisions: A case study. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the fifth ACM SIGKDD international conference on Knowledge discovery and data mining</em>. 254–260.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castelli and Vanneschi (2014)</span>
<span class="ltx_bibblock">
Mauro Castelli and Leonardo Vanneschi. 2014.

</span>
<span class="ltx_bibblock">Genetic algorithm with variable neighborhood search for the optimal allocation of goods in shop shelves.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Operations Research Letters</em> 42, 5 (2014), 355–360.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castells and Moffat (2022)</span>
<span class="ltx_bibblock">
Pablo Castells and Alistair Moffat. 2022.

</span>
<span class="ltx_bibblock">Offline recommender system evaluation: Challenges and new directions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">AI Magazine</em> 43, 2 (2022), 225–238.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chatzidimitris et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Thomas Chatzidimitris, Damianos Gavalas, Vlasios Kasapakis, Charalampos Konstantopoulos, Damianos Kypriadis, Grammati Pantziou, and Christos Zaroliagis. 2020.

</span>
<span class="ltx_bibblock">A location history-aware recommender system for smart retail environments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Personal and Ubiquitous Computing</em> 24 (2020), 683–694.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Chia-Chen Chen, Tien-Chi Huang, James J Park, and Neil Y Yen. 2015.

</span>
<span class="ltx_bibblock">Real-time smartphone sensing and recommendations towards context-awareness shopping.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Multimedia systems</em> 21 (2015), 61–72.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Lin (2007)</span>
<span class="ltx_bibblock">
Mu-Chen Chen and Chia-Ping Lin. 2007.

</span>
<span class="ltx_bibblock">A data mining approach to product assortment and shelf space allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Expert Systems with Applications</em> 32, 4 (2007), 976–986.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Colombo-Mendoza et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Luis Omar Colombo-Mendoza, Mario Andrés Paredes-Valverde, María del Pilar Salas-Zárate, Maritza Bustos-López, José Luis Sánchez-Cervantes, and Giner Alor-Hernández. 2020.

</span>
<span class="ltx_bibblock">Recommender systems in the offline retailing domain: a systematic literature review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Techniques, Tools and Methodologies Applied to Global Supply Chain Ecosystems</em> (2020), 383–409.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Curhan (1973)</span>
<span class="ltx_bibblock">
Ronald C Curhan. 1973.

</span>
<span class="ltx_bibblock">Shelf space allocation and profit maximization in mass retailing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Journal of Marketing</em> 37, 3 (1973), 54–60.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DiNardo (2010)</span>
<span class="ltx_bibblock">
John DiNardo. 2010.

</span>
<span class="ltx_bibblock">Natural experiments and quasi-natural experiments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Microeconometrics</em> (2010), 139–153.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dudziński and Walukiewicz (1987)</span>
<span class="ltx_bibblock">
Krzysztof Dudziński and Stanisław Walukiewicz. 1987.

</span>
<span class="ltx_bibblock">Exact methods for the knapsack problem and its generalizations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">European Journal of Operational Research</em> 28, 1 (1987), 3–21.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Düsterhöft et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tobias Düsterhöft, Alexander Hübner, and Kai Schaal. 2020.

</span>
<span class="ltx_bibblock">A practical approach to the shelf-space allocation and replenishment problem with heterogeneously sized shelves.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">European Journal of Operational Research</em> 282, 1 (2020), 252–266.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geismar et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
H Neil Geismar, Milind Dawande, BPS Murthi, and Chelliah Sriskandarajah. 2015.

</span>
<span class="ltx_bibblock">Maximizing revenue through two-dimensional shelf-space allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Production and Operations Management</em> 24, 7 (2015), 1148–1163.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Good (2013)</span>
<span class="ltx_bibblock">
Phillip Good. 2013.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Permutation tests: a practical guide to resampling methods for testing hypotheses</em>.

</span>
<span class="ltx_bibblock">Springer Science &amp; Business Media.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffman et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Matthew D Hoffman, Andrew Gelman, et al<span class="ltx_text" id="bib.bib24.3.1">.</span> 2014.

</span>
<span class="ltx_bibblock">The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.4.1">J. Mach. Learn. Res.</em> 15, 1 (2014), 1593–1623.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hwang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2005)</span>
<span class="ltx_bibblock">
Hark Hwang, Bum Choi, and Min-Jin Lee. 2005.

</span>
<span class="ltx_bibblock">A model for shelf space allocation and inventory control considering location and inventory level effects on demand.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">International Journal of Production Economics</em> 97, 2 (2005), 185–195.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jedidi et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (1997)</span>
<span class="ltx_bibblock">
Kamel Jedidi, Harsharanjeet S Jagpal, and Wayne S DeSarbo. 1997.

</span>
<span class="ltx_bibblock">Finite-mixture structural equation models for response-based segmentation and unobserved heterogeneity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Marketing Science</em> 16, 1 (1997), 39–59.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jenkins et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Porter Jenkins, Kyle Armstrong, Stephen Nelson, Siddhesh Gotad, J. Stockton Jenkins, Wade Wilkey, and Tanner Watts. 2023.

</span>
<span class="ltx_bibblock">CountNet3D: A 3D Computer Vision Approach To Infer Counts of Occluded Objects. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision (WACV)</em>. 3008–3017.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jenkins et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Porter Jenkins, Hua Wei, J Stockton Jenkins, and Zhenhui Li. 2022.

</span>
<span class="ltx_bibblock">Bayesian Model-Based Offline Reinforcement Learning for Product Allocation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 36. 12531–12537.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jocher et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Glenn Jocher, Ayush Chaurasia, Alex Stoken, Jirka Borovec, NanoCode012, Yonghye Kwon, Kalen Michael, TaoXie, Jiacong Fang, imyhxy, Lorna, (Zeng Yifu), Colin Wong, Abhiram V, Diego Montes, Zhiqiang Wang, Cristi Fati, Jebastin Nadar, Laughing, UnglvKitDe, Victor Sonck, tkianai, yxNONG, Piotr Skalski, Adam Hogan, Dhruv Nair, Max Strobel, and Mrinal Jain. 2022.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">ultralytics/yolov5: v7.0 - YOLOv5 SOTA Realtime Instance Segmentation</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.5281/zenodo.7347926" title="">https://doi.org/10.5281/zenodo.7347926</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lakshminarayanan et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell. 2017.

</span>
<span class="ltx_bibblock">Simple and scalable predictive uncertainty estimation using deep ensembles.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leininger et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Lisa Leininger, Johnny Gipson, Kito Patterson, and Brad Blanchard. 2020.

</span>
<span class="ltx_bibblock">Advancing performance of retail recommendation systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">SMU Data Science Review</em> 3, 1 (2020), 6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Lihong Li, Wei Chu, John Langford, and Robert E Schapire. 2010.

</span>
<span class="ltx_bibblock">A contextual-bandit approach to personalized news article recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 19th international conference on World wide web</em>. 661–670.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Lihong Li, Wei Chu, John Langford, and Xuanhui Wang. 2011.

</span>
<span class="ltx_bibblock">Unbiased offline evaluation of contextual-bandit-based news article recommendation algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the fourth ACM international conference on Web search and data mining</em>. 297–306.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mandel et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Travis Mandel, Yun-En Liu, Emma Brunskill, and Zoran Popović. 2016.

</span>
<span class="ltx_bibblock">Offline evaluation of online reinforcement learning algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 30.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martínez-de Albéniz and Roels (2011)</span>
<span class="ltx_bibblock">
Victor Martínez-de Albéniz and Guillaume Roels. 2011.

</span>
<span class="ltx_bibblock">Competing for shelf space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Production and Operations Management</em> 20, 1 (2011), 32–46.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mattila and Wirtz (2008)</span>
<span class="ltx_bibblock">
Anna Mattila and Jochen Wirtz. 2008.

</span>
<span class="ltx_bibblock">The role of store environmental stimulation and social factors on impulse purchasing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Journal of Services Marketing</em> (2008).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Murphy (2012)</span>
<span class="ltx_bibblock">
Kevin P Murphy. 2012.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Machine learning: a probabilistic perspective</em>.

</span>
<span class="ltx_bibblock">MIT press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Murray et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Chase C Murray, Debabrata Talukdar, and Abhijit Gosavi. 2010.

</span>
<span class="ltx_bibblock">Joint optimization of product price, display orientation and shelf-space allocation in retail category management.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Journal of Retailing</em> 86, 2 (2010), 125–136.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pandit et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Anala A Pandit, Jyot Talreja, Miloni Agrawal, Deepak Prasad, Swati Baheti, and G Khalsa. 2010.

</span>
<span class="ltx_bibblock">Intelligent recommender system using shopper’s path and purchase analysis. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">2010 International Conference on Computational Intelligence and Communication Networks</em>. IEEE, 597–602.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park and Nam (2019)</span>
<span class="ltx_bibblock">
Jihoi Park and Kihwan Nam. 2019.

</span>
<span class="ltx_bibblock">Group recommender system for store product placement.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Data Mining and Knowledge Discovery</em> 33, 1 (2019), 204–229.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pathak et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Bhavik Pathak, Robert Garfinkel, Ram D Gopal, Rajkumar Venkatesan, and Fang Yin. 2010.

</span>
<span class="ltx_bibblock">Empirical analysis of the impact of recommender systems on sales.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Journal of Management Information Systems</em> 27, 2 (2010), 159–188.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Charles R Qi, Hao Su, Kaichun Mo, and Leonidas J Guibas. 2017.

</span>
<span class="ltx_bibblock">Pointnet: Deep learning on point sets for 3d classification and segmentation. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>. 652–660.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rossi and Allenby (2003)</span>
<span class="ltx_bibblock">
Peter E Rossi and Greg M Allenby. 2003.

</span>
<span class="ltx_bibblock">Bayesian statistics and marketing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Marketing Science</em> 22, 3 (2003), 304–328.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salvatier et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
John Salvatier, Thomas V Wiecki, and Christopher Fonnesbeck. 2016.

</span>
<span class="ltx_bibblock">Probabilistic programming in Python using PyMC3.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">PeerJ Computer Science</em> 2 (2016), e55.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silva (2020)</span>
<span class="ltx_bibblock">
Xavier dos Santos Silva. 2020.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Recommender Systems for Grocery Retail-A Machine Learning Approach</em>.

</span>
<span class="ltx_bibblock">Ph. D. Dissertation.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Chen Sun, Rong Gao, and Hongsheng Xi. 2014.

</span>
<span class="ltx_bibblock">Big data based retail recommender system of non E-commerce. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Fifth International Conference on Computing, Communications and Networking Technologies (ICCCNT)</em>. IEEE, 1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tatiana and Mikhail (2018)</span>
<span class="ltx_bibblock">
Kutuzova Tatiana and Melnik Mikhail. 2018.

</span>
<span class="ltx_bibblock">Market basket analysis of heterogeneous data sources for recommendation system improvement.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Procedia Computer Science</em> 136 (2018), 246–254.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Urban (1998)</span>
<span class="ltx_bibblock">
Timothy L Urban. 1998.

</span>
<span class="ltx_bibblock">An inventory-theoretic approach to product assortment and shelf-space allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Journal of Retailing</em> 74, 1 (1998), 15–35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Walter et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Frank E Walter, Stefano Battiston, Mahir Yildirim, and Frank Schweitzer. 2012.

</span>
<span class="ltx_bibblock">Moving recommender systems from on-line commerce to retail stores.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Information systems and e-business management</em> 10 (2012), 367–393.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang and Chen (1999)</span>
<span class="ltx_bibblock">
Ming-Hsien Yang and Wen-Cher Chen. 1999.

</span>
<span class="ltx_bibblock">A study on shelf space allocation and management.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">International journal of production economics</em> 60 (1999), 309–317.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tianhe Yu, Garrett Thomas, Lantao Yu, Stefano Ermon, James Y Zou, Sergey Levine, Chelsea Finn, and Tengyu Ma. 2020.

</span>
<span class="ltx_bibblock">Mopo: Model-based offline policy optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">Advances in Neural Information Processing Systems</em> 33 (2020), 14129–14142.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lanlan Zheng, Xin Liu, Feng Wu, and Zijun Zhang. 2023.

</span>
<span class="ltx_bibblock">A data-driven model assisted hybrid genetic algorithm for a two-dimensional shelf space allocation problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Swarm and Evolutionary Computation</em> 77 (2023), 101251.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/j.swevo.2023.101251" title="">https://doi.org/10.1016/j.swevo.2023.101251</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zufryden (1986)</span>
<span class="ltx_bibblock">
Fred S. Zufryden. 1986.

</span>
<span class="ltx_bibblock">A Dynamic Programming Approach for Product Selection and Supermarket Shelf-Space Allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">The Journal of Operational Research Society</em> (1986).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Appendix</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In what follows we provide a technical appendix to accompany the main body of the paper. This appendix features two main sections. First, we provide additional methodological Details. Second, we present additional experimental results to further strengthen the claims made in the paper.</p>
</div>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1. </span>Table of Notation Used</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">In this section we provide three tables describing the notation used throughout the paper. Each table corresponds to a different sub-section of the main paper, namely Problem Definition (Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.T5" title="Table 5 ‣ 7.1. Table of Notation Used ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">5</span></a>), SpAGMM (Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.T6" title="Table 6 ‣ 7.1. Table of Notation Used ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">6</span></a>), and Heuristic Search (Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.T7" title="Table 7 ‣ 7.1. Table of Notation Used ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
<figure class="ltx_table" id="S7.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T5.35">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T5.35.36.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S7.T5.35.36.1.1">Variable</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T5.35.36.1.2">Quantity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T5.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S7.T5.1.1.1"><math alttext="N" class="ltx_Math" display="inline" id="S7.T5.1.1.1.m1.1"><semantics id="S7.T5.1.1.1.m1.1a"><mi id="S7.T5.1.1.1.m1.1.1" xref="S7.T5.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S7.T5.1.1.1.m1.1b"><ci id="S7.T5.1.1.1.m1.1.1.cmml" xref="S7.T5.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S7.T5.1.1.1.m1.1d">italic_N</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T5.1.1.2">number of products</td>
</tr>
<tr class="ltx_tr" id="S7.T5.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.2.2.1"><math alttext="p_{i}" class="ltx_Math" display="inline" id="S7.T5.2.2.1.m1.1"><semantics id="S7.T5.2.2.1.m1.1a"><msub id="S7.T5.2.2.1.m1.1.1" xref="S7.T5.2.2.1.m1.1.1.cmml"><mi id="S7.T5.2.2.1.m1.1.1.2" xref="S7.T5.2.2.1.m1.1.1.2.cmml">p</mi><mi id="S7.T5.2.2.1.m1.1.1.3" xref="S7.T5.2.2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.2.2.1.m1.1b"><apply id="S7.T5.2.2.1.m1.1.1.cmml" xref="S7.T5.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.2.2.1.m1.1.1.1.cmml" xref="S7.T5.2.2.1.m1.1.1">subscript</csymbol><ci id="S7.T5.2.2.1.m1.1.1.2.cmml" xref="S7.T5.2.2.1.m1.1.1.2">𝑝</ci><ci id="S7.T5.2.2.1.m1.1.1.3.cmml" xref="S7.T5.2.2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.2.2.1.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.2.2.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.3.3.2">product, indexed by <math alttext="i" class="ltx_Math" display="inline" id="S7.T5.3.3.2.m1.1"><semantics id="S7.T5.3.3.2.m1.1a"><mi id="S7.T5.3.3.2.m1.1.1" xref="S7.T5.3.3.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.T5.3.3.2.m1.1b"><ci id="S7.T5.3.3.2.m1.1.1.cmml" xref="S7.T5.3.3.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.3.3.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S7.T5.3.3.2.m1.1d">italic_i</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.4.4.1"><math alttext="q_{i}" class="ltx_Math" display="inline" id="S7.T5.4.4.1.m1.1"><semantics id="S7.T5.4.4.1.m1.1a"><msub id="S7.T5.4.4.1.m1.1.1" xref="S7.T5.4.4.1.m1.1.1.cmml"><mi id="S7.T5.4.4.1.m1.1.1.2" xref="S7.T5.4.4.1.m1.1.1.2.cmml">q</mi><mi id="S7.T5.4.4.1.m1.1.1.3" xref="S7.T5.4.4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.4.4.1.m1.1b"><apply id="S7.T5.4.4.1.m1.1.1.cmml" xref="S7.T5.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.4.4.1.m1.1.1.1.cmml" xref="S7.T5.4.4.1.m1.1.1">subscript</csymbol><ci id="S7.T5.4.4.1.m1.1.1.2.cmml" xref="S7.T5.4.4.1.m1.1.1.2">𝑞</ci><ci id="S7.T5.4.4.1.m1.1.1.3.cmml" xref="S7.T5.4.4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.4.4.1.m1.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.4.4.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.5.5.2">the quantity of product <math alttext="i" class="ltx_Math" display="inline" id="S7.T5.5.5.2.m1.1"><semantics id="S7.T5.5.5.2.m1.1a"><mi id="S7.T5.5.5.2.m1.1.1" xref="S7.T5.5.5.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.T5.5.5.2.m1.1b"><ci id="S7.T5.5.5.2.m1.1.1.cmml" xref="S7.T5.5.5.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.5.5.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S7.T5.5.5.2.m1.1d">italic_i</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.6.6.1"><math alttext="d_{j}" class="ltx_Math" display="inline" id="S7.T5.6.6.1.m1.1"><semantics id="S7.T5.6.6.1.m1.1a"><msub id="S7.T5.6.6.1.m1.1.1" xref="S7.T5.6.6.1.m1.1.1.cmml"><mi id="S7.T5.6.6.1.m1.1.1.2" xref="S7.T5.6.6.1.m1.1.1.2.cmml">d</mi><mi id="S7.T5.6.6.1.m1.1.1.3" xref="S7.T5.6.6.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.6.6.1.m1.1b"><apply id="S7.T5.6.6.1.m1.1.1.cmml" xref="S7.T5.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.6.6.1.m1.1.1.1.cmml" xref="S7.T5.6.6.1.m1.1.1">subscript</csymbol><ci id="S7.T5.6.6.1.m1.1.1.2.cmml" xref="S7.T5.6.6.1.m1.1.1.2">𝑑</ci><ci id="S7.T5.6.6.1.m1.1.1.3.cmml" xref="S7.T5.6.6.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.6.6.1.m1.1c">d_{j}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.6.6.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.7.7.2">the product display index by <math alttext="j" class="ltx_Math" display="inline" id="S7.T5.7.7.2.m1.1"><semantics id="S7.T5.7.7.2.m1.1a"><mi id="S7.T5.7.7.2.m1.1.1" xref="S7.T5.7.7.2.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S7.T5.7.7.2.m1.1b"><ci id="S7.T5.7.7.2.m1.1.1.cmml" xref="S7.T5.7.7.2.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.7.7.2.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S7.T5.7.7.2.m1.1d">italic_j</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.8.8.1"><math alttext="s_{l}" class="ltx_Math" display="inline" id="S7.T5.8.8.1.m1.1"><semantics id="S7.T5.8.8.1.m1.1a"><msub id="S7.T5.8.8.1.m1.1.1" xref="S7.T5.8.8.1.m1.1.1.cmml"><mi id="S7.T5.8.8.1.m1.1.1.2" xref="S7.T5.8.8.1.m1.1.1.2.cmml">s</mi><mi id="S7.T5.8.8.1.m1.1.1.3" xref="S7.T5.8.8.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.8.8.1.m1.1b"><apply id="S7.T5.8.8.1.m1.1.1.cmml" xref="S7.T5.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.8.8.1.m1.1.1.1.cmml" xref="S7.T5.8.8.1.m1.1.1">subscript</csymbol><ci id="S7.T5.8.8.1.m1.1.1.2.cmml" xref="S7.T5.8.8.1.m1.1.1.2">𝑠</ci><ci id="S7.T5.8.8.1.m1.1.1.3.cmml" xref="S7.T5.8.8.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.8.8.1.m1.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.8.8.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.9.9.2">store indexed by <math alttext="l" class="ltx_Math" display="inline" id="S7.T5.9.9.2.m1.1"><semantics id="S7.T5.9.9.2.m1.1a"><mi id="S7.T5.9.9.2.m1.1.1" xref="S7.T5.9.9.2.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S7.T5.9.9.2.m1.1b"><ci id="S7.T5.9.9.2.m1.1.1.cmml" xref="S7.T5.9.9.2.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.9.9.2.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S7.T5.9.9.2.m1.1d">italic_l</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.10.10.1"><math alttext="M_{j}^{l}" class="ltx_Math" display="inline" id="S7.T5.10.10.1.m1.1"><semantics id="S7.T5.10.10.1.m1.1a"><msubsup id="S7.T5.10.10.1.m1.1.1" xref="S7.T5.10.10.1.m1.1.1.cmml"><mi id="S7.T5.10.10.1.m1.1.1.2.2" xref="S7.T5.10.10.1.m1.1.1.2.2.cmml">M</mi><mi id="S7.T5.10.10.1.m1.1.1.2.3" xref="S7.T5.10.10.1.m1.1.1.2.3.cmml">j</mi><mi id="S7.T5.10.10.1.m1.1.1.3" xref="S7.T5.10.10.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S7.T5.10.10.1.m1.1b"><apply id="S7.T5.10.10.1.m1.1.1.cmml" xref="S7.T5.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.10.10.1.m1.1.1.1.cmml" xref="S7.T5.10.10.1.m1.1.1">superscript</csymbol><apply id="S7.T5.10.10.1.m1.1.1.2.cmml" xref="S7.T5.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.10.10.1.m1.1.1.2.1.cmml" xref="S7.T5.10.10.1.m1.1.1">subscript</csymbol><ci id="S7.T5.10.10.1.m1.1.1.2.2.cmml" xref="S7.T5.10.10.1.m1.1.1.2.2">𝑀</ci><ci id="S7.T5.10.10.1.m1.1.1.2.3.cmml" xref="S7.T5.10.10.1.m1.1.1.2.3">𝑗</ci></apply><ci id="S7.T5.10.10.1.m1.1.1.3.cmml" xref="S7.T5.10.10.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.10.10.1.m1.1c">M_{j}^{l}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.10.10.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.12.12.3">the maximum capacity of display <math alttext="j" class="ltx_Math" display="inline" id="S7.T5.11.11.2.m1.1"><semantics id="S7.T5.11.11.2.m1.1a"><mi id="S7.T5.11.11.2.m1.1.1" xref="S7.T5.11.11.2.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S7.T5.11.11.2.m1.1b"><ci id="S7.T5.11.11.2.m1.1.1.cmml" xref="S7.T5.11.11.2.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.11.11.2.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S7.T5.11.11.2.m1.1d">italic_j</annotation></semantics></math> in store <math alttext="l" class="ltx_Math" display="inline" id="S7.T5.12.12.3.m2.1"><semantics id="S7.T5.12.12.3.m2.1a"><mi id="S7.T5.12.12.3.m2.1.1" xref="S7.T5.12.12.3.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S7.T5.12.12.3.m2.1b"><ci id="S7.T5.12.12.3.m2.1.1.cmml" xref="S7.T5.12.12.3.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.12.12.3.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S7.T5.12.12.3.m2.1d">italic_l</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.13.13.1"><math alttext="r_{i}" class="ltx_Math" display="inline" id="S7.T5.13.13.1.m1.1"><semantics id="S7.T5.13.13.1.m1.1a"><msub id="S7.T5.13.13.1.m1.1.1" xref="S7.T5.13.13.1.m1.1.1.cmml"><mi id="S7.T5.13.13.1.m1.1.1.2" xref="S7.T5.13.13.1.m1.1.1.2.cmml">r</mi><mi id="S7.T5.13.13.1.m1.1.1.3" xref="S7.T5.13.13.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.13.13.1.m1.1b"><apply id="S7.T5.13.13.1.m1.1.1.cmml" xref="S7.T5.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.13.13.1.m1.1.1.1.cmml" xref="S7.T5.13.13.1.m1.1.1">subscript</csymbol><ci id="S7.T5.13.13.1.m1.1.1.2.cmml" xref="S7.T5.13.13.1.m1.1.1.2">𝑟</ci><ci id="S7.T5.13.13.1.m1.1.1.3.cmml" xref="S7.T5.13.13.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.13.13.1.m1.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.13.13.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.14.14.2">Observed reward for product <math alttext="i" class="ltx_Math" display="inline" id="S7.T5.14.14.2.m1.1"><semantics id="S7.T5.14.14.2.m1.1a"><mi id="S7.T5.14.14.2.m1.1.1" xref="S7.T5.14.14.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.T5.14.14.2.m1.1b"><ci id="S7.T5.14.14.2.m1.1.1.cmml" xref="S7.T5.14.14.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.14.14.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S7.T5.14.14.2.m1.1d">italic_i</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.15.15.1"><math alttext="t" class="ltx_Math" display="inline" id="S7.T5.15.15.1.m1.1"><semantics id="S7.T5.15.15.1.m1.1a"><mi id="S7.T5.15.15.1.m1.1.1" xref="S7.T5.15.15.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.T5.15.15.1.m1.1b"><ci id="S7.T5.15.15.1.m1.1.1.cmml" xref="S7.T5.15.15.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.15.15.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.T5.15.15.1.m1.1d">italic_t</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.15.15.2">time of observation</td>
</tr>
<tr class="ltx_tr" id="S7.T5.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.16.16.1"><math alttext="a_{z}" class="ltx_Math" display="inline" id="S7.T5.16.16.1.m1.1"><semantics id="S7.T5.16.16.1.m1.1a"><msub id="S7.T5.16.16.1.m1.1.1" xref="S7.T5.16.16.1.m1.1.1.cmml"><mi id="S7.T5.16.16.1.m1.1.1.2" xref="S7.T5.16.16.1.m1.1.1.2.cmml">a</mi><mi id="S7.T5.16.16.1.m1.1.1.3" xref="S7.T5.16.16.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.16.16.1.m1.1b"><apply id="S7.T5.16.16.1.m1.1.1.cmml" xref="S7.T5.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.16.16.1.m1.1.1.1.cmml" xref="S7.T5.16.16.1.m1.1.1">subscript</csymbol><ci id="S7.T5.16.16.1.m1.1.1.2.cmml" xref="S7.T5.16.16.1.m1.1.1.2">𝑎</ci><ci id="S7.T5.16.16.1.m1.1.1.3.cmml" xref="S7.T5.16.16.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.16.16.1.m1.1c">a_{z}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.16.16.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.17.17.2">spatial areas (census tracts) indexed by <math alttext="z" class="ltx_Math" display="inline" id="S7.T5.17.17.2.m1.1"><semantics id="S7.T5.17.17.2.m1.1a"><mi id="S7.T5.17.17.2.m1.1.1" xref="S7.T5.17.17.2.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S7.T5.17.17.2.m1.1b"><ci id="S7.T5.17.17.2.m1.1.1.cmml" xref="S7.T5.17.17.2.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.17.17.2.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S7.T5.17.17.2.m1.1d">italic_z</annotation></semantics></math>.</td>
</tr>
<tr class="ltx_tr" id="S7.T5.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.18.18.1"><math alttext="x_{z}" class="ltx_Math" display="inline" id="S7.T5.18.18.1.m1.1"><semantics id="S7.T5.18.18.1.m1.1a"><msub id="S7.T5.18.18.1.m1.1.1" xref="S7.T5.18.18.1.m1.1.1.cmml"><mi id="S7.T5.18.18.1.m1.1.1.2" xref="S7.T5.18.18.1.m1.1.1.2.cmml">x</mi><mi id="S7.T5.18.18.1.m1.1.1.3" xref="S7.T5.18.18.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.18.18.1.m1.1b"><apply id="S7.T5.18.18.1.m1.1.1.cmml" xref="S7.T5.18.18.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.18.18.1.m1.1.1.1.cmml" xref="S7.T5.18.18.1.m1.1.1">subscript</csymbol><ci id="S7.T5.18.18.1.m1.1.1.2.cmml" xref="S7.T5.18.18.1.m1.1.1.2">𝑥</ci><ci id="S7.T5.18.18.1.m1.1.1.3.cmml" xref="S7.T5.18.18.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.18.18.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.18.18.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.19.19.2">vector of demographic statistics for a spatial area, <math alttext="z" class="ltx_Math" display="inline" id="S7.T5.19.19.2.m1.1"><semantics id="S7.T5.19.19.2.m1.1a"><mi id="S7.T5.19.19.2.m1.1.1" xref="S7.T5.19.19.2.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S7.T5.19.19.2.m1.1b"><ci id="S7.T5.19.19.2.m1.1.1.cmml" xref="S7.T5.19.19.2.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.19.19.2.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S7.T5.19.19.2.m1.1d">italic_z</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.20.20.1"><math alttext="b" class="ltx_Math" display="inline" id="S7.T5.20.20.1.m1.1"><semantics id="S7.T5.20.20.1.m1.1a"><mi id="S7.T5.20.20.1.m1.1.1" xref="S7.T5.20.20.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T5.20.20.1.m1.1b"><ci id="S7.T5.20.20.1.m1.1.1.cmml" xref="S7.T5.20.20.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.20.20.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S7.T5.20.20.1.m1.1d">italic_b</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.20.20.2">number of demographic features</td>
</tr>
<tr class="ltx_tr" id="S7.T5.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.21.21.1"><math alttext="K" class="ltx_Math" display="inline" id="S7.T5.21.21.1.m1.1"><semantics id="S7.T5.21.21.1.m1.1a"><mi id="S7.T5.21.21.1.m1.1.1" xref="S7.T5.21.21.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S7.T5.21.21.1.m1.1b"><ci id="S7.T5.21.21.1.m1.1.1.cmml" xref="S7.T5.21.21.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.21.21.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S7.T5.21.21.1.m1.1d">italic_K</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.21.21.2">the number of store clusters</td>
</tr>
<tr class="ltx_tr" id="S7.T5.22.22">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.22.22.1"><math alttext="Z" class="ltx_Math" display="inline" id="S7.T5.22.22.1.m1.1"><semantics id="S7.T5.22.22.1.m1.1a"><mi id="S7.T5.22.22.1.m1.1.1" xref="S7.T5.22.22.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S7.T5.22.22.1.m1.1b"><ci id="S7.T5.22.22.1.m1.1.1.cmml" xref="S7.T5.22.22.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.22.22.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S7.T5.22.22.1.m1.1d">italic_Z</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.22.22.2">number of spatial areas</td>
</tr>
<tr class="ltx_tr" id="S7.T5.26.26">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.23.23.1"><math alttext="\hat{c}_{ijt}" class="ltx_Math" display="inline" id="S7.T5.23.23.1.m1.1"><semantics id="S7.T5.23.23.1.m1.1a"><msub id="S7.T5.23.23.1.m1.1.1" xref="S7.T5.23.23.1.m1.1.1.cmml"><mover accent="true" id="S7.T5.23.23.1.m1.1.1.2" xref="S7.T5.23.23.1.m1.1.1.2.cmml"><mi id="S7.T5.23.23.1.m1.1.1.2.2" xref="S7.T5.23.23.1.m1.1.1.2.2.cmml">c</mi><mo id="S7.T5.23.23.1.m1.1.1.2.1" xref="S7.T5.23.23.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S7.T5.23.23.1.m1.1.1.3" xref="S7.T5.23.23.1.m1.1.1.3.cmml"><mi id="S7.T5.23.23.1.m1.1.1.3.2" xref="S7.T5.23.23.1.m1.1.1.3.2.cmml">i</mi><mo id="S7.T5.23.23.1.m1.1.1.3.1" xref="S7.T5.23.23.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.T5.23.23.1.m1.1.1.3.3" xref="S7.T5.23.23.1.m1.1.1.3.3.cmml">j</mi><mo id="S7.T5.23.23.1.m1.1.1.3.1a" xref="S7.T5.23.23.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.T5.23.23.1.m1.1.1.3.4" xref="S7.T5.23.23.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T5.23.23.1.m1.1b"><apply id="S7.T5.23.23.1.m1.1.1.cmml" xref="S7.T5.23.23.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.23.23.1.m1.1.1.1.cmml" xref="S7.T5.23.23.1.m1.1.1">subscript</csymbol><apply id="S7.T5.23.23.1.m1.1.1.2.cmml" xref="S7.T5.23.23.1.m1.1.1.2"><ci id="S7.T5.23.23.1.m1.1.1.2.1.cmml" xref="S7.T5.23.23.1.m1.1.1.2.1">^</ci><ci id="S7.T5.23.23.1.m1.1.1.2.2.cmml" xref="S7.T5.23.23.1.m1.1.1.2.2">𝑐</ci></apply><apply id="S7.T5.23.23.1.m1.1.1.3.cmml" xref="S7.T5.23.23.1.m1.1.1.3"><times id="S7.T5.23.23.1.m1.1.1.3.1.cmml" xref="S7.T5.23.23.1.m1.1.1.3.1"></times><ci id="S7.T5.23.23.1.m1.1.1.3.2.cmml" xref="S7.T5.23.23.1.m1.1.1.3.2">𝑖</ci><ci id="S7.T5.23.23.1.m1.1.1.3.3.cmml" xref="S7.T5.23.23.1.m1.1.1.3.3">𝑗</ci><ci id="S7.T5.23.23.1.m1.1.1.3.4.cmml" xref="S7.T5.23.23.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.23.23.1.m1.1c">\hat{c}_{ijt}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.23.23.1.m1.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i italic_j italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.26.26.4">estimated counts of <math alttext="p_{i}" class="ltx_Math" display="inline" id="S7.T5.24.24.2.m1.1"><semantics id="S7.T5.24.24.2.m1.1a"><msub id="S7.T5.24.24.2.m1.1.1" xref="S7.T5.24.24.2.m1.1.1.cmml"><mi id="S7.T5.24.24.2.m1.1.1.2" xref="S7.T5.24.24.2.m1.1.1.2.cmml">p</mi><mi id="S7.T5.24.24.2.m1.1.1.3" xref="S7.T5.24.24.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.24.24.2.m1.1b"><apply id="S7.T5.24.24.2.m1.1.1.cmml" xref="S7.T5.24.24.2.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.24.24.2.m1.1.1.1.cmml" xref="S7.T5.24.24.2.m1.1.1">subscript</csymbol><ci id="S7.T5.24.24.2.m1.1.1.2.cmml" xref="S7.T5.24.24.2.m1.1.1.2">𝑝</ci><ci id="S7.T5.24.24.2.m1.1.1.3.cmml" xref="S7.T5.24.24.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.24.24.2.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.24.24.2.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="d_{j}" class="ltx_Math" display="inline" id="S7.T5.25.25.3.m2.1"><semantics id="S7.T5.25.25.3.m2.1a"><msub id="S7.T5.25.25.3.m2.1.1" xref="S7.T5.25.25.3.m2.1.1.cmml"><mi id="S7.T5.25.25.3.m2.1.1.2" xref="S7.T5.25.25.3.m2.1.1.2.cmml">d</mi><mi id="S7.T5.25.25.3.m2.1.1.3" xref="S7.T5.25.25.3.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.25.25.3.m2.1b"><apply id="S7.T5.25.25.3.m2.1.1.cmml" xref="S7.T5.25.25.3.m2.1.1"><csymbol cd="ambiguous" id="S7.T5.25.25.3.m2.1.1.1.cmml" xref="S7.T5.25.25.3.m2.1.1">subscript</csymbol><ci id="S7.T5.25.25.3.m2.1.1.2.cmml" xref="S7.T5.25.25.3.m2.1.1.2">𝑑</ci><ci id="S7.T5.25.25.3.m2.1.1.3.cmml" xref="S7.T5.25.25.3.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.25.25.3.m2.1c">d_{j}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.25.25.3.m2.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> at time <math alttext="t" class="ltx_Math" display="inline" id="S7.T5.26.26.4.m3.1"><semantics id="S7.T5.26.26.4.m3.1a"><mi id="S7.T5.26.26.4.m3.1.1" xref="S7.T5.26.26.4.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.T5.26.26.4.m3.1b"><ci id="S7.T5.26.26.4.m3.1.1.cmml" xref="S7.T5.26.26.4.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.26.26.4.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S7.T5.26.26.4.m3.1d">italic_t</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.29.29">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.27.27.1"><math alttext="\beta_{i,k}" class="ltx_Math" display="inline" id="S7.T5.27.27.1.m1.2"><semantics id="S7.T5.27.27.1.m1.2a"><msub id="S7.T5.27.27.1.m1.2.3" xref="S7.T5.27.27.1.m1.2.3.cmml"><mi id="S7.T5.27.27.1.m1.2.3.2" xref="S7.T5.27.27.1.m1.2.3.2.cmml">β</mi><mrow id="S7.T5.27.27.1.m1.2.2.2.4" xref="S7.T5.27.27.1.m1.2.2.2.3.cmml"><mi id="S7.T5.27.27.1.m1.1.1.1.1" xref="S7.T5.27.27.1.m1.1.1.1.1.cmml">i</mi><mo id="S7.T5.27.27.1.m1.2.2.2.4.1" xref="S7.T5.27.27.1.m1.2.2.2.3.cmml">,</mo><mi id="S7.T5.27.27.1.m1.2.2.2.2" xref="S7.T5.27.27.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T5.27.27.1.m1.2b"><apply id="S7.T5.27.27.1.m1.2.3.cmml" xref="S7.T5.27.27.1.m1.2.3"><csymbol cd="ambiguous" id="S7.T5.27.27.1.m1.2.3.1.cmml" xref="S7.T5.27.27.1.m1.2.3">subscript</csymbol><ci id="S7.T5.27.27.1.m1.2.3.2.cmml" xref="S7.T5.27.27.1.m1.2.3.2">𝛽</ci><list id="S7.T5.27.27.1.m1.2.2.2.3.cmml" xref="S7.T5.27.27.1.m1.2.2.2.4"><ci id="S7.T5.27.27.1.m1.1.1.1.1.cmml" xref="S7.T5.27.27.1.m1.1.1.1.1">𝑖</ci><ci id="S7.T5.27.27.1.m1.2.2.2.2.cmml" xref="S7.T5.27.27.1.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.27.27.1.m1.2c">\beta_{i,k}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.27.27.1.m1.2d">italic_β start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.29.29.3">reward coefficient for product <math alttext="i" class="ltx_Math" display="inline" id="S7.T5.28.28.2.m1.1"><semantics id="S7.T5.28.28.2.m1.1a"><mi id="S7.T5.28.28.2.m1.1.1" xref="S7.T5.28.28.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.T5.28.28.2.m1.1b"><ci id="S7.T5.28.28.2.m1.1.1.cmml" xref="S7.T5.28.28.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.28.28.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S7.T5.28.28.2.m1.1d">italic_i</annotation></semantics></math> in cluster <math alttext="k" class="ltx_Math" display="inline" id="S7.T5.29.29.3.m2.1"><semantics id="S7.T5.29.29.3.m2.1a"><mi id="S7.T5.29.29.3.m2.1.1" xref="S7.T5.29.29.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S7.T5.29.29.3.m2.1b"><ci id="S7.T5.29.29.3.m2.1.1.cmml" xref="S7.T5.29.29.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.29.29.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S7.T5.29.29.3.m2.1d">italic_k</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.33.33">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.30.30.1"><math alttext="\beta_{i,l,k}" class="ltx_Math" display="inline" id="S7.T5.30.30.1.m1.3"><semantics id="S7.T5.30.30.1.m1.3a"><msub id="S7.T5.30.30.1.m1.3.4" xref="S7.T5.30.30.1.m1.3.4.cmml"><mi id="S7.T5.30.30.1.m1.3.4.2" xref="S7.T5.30.30.1.m1.3.4.2.cmml">β</mi><mrow id="S7.T5.30.30.1.m1.3.3.3.5" xref="S7.T5.30.30.1.m1.3.3.3.4.cmml"><mi id="S7.T5.30.30.1.m1.1.1.1.1" xref="S7.T5.30.30.1.m1.1.1.1.1.cmml">i</mi><mo id="S7.T5.30.30.1.m1.3.3.3.5.1" xref="S7.T5.30.30.1.m1.3.3.3.4.cmml">,</mo><mi id="S7.T5.30.30.1.m1.2.2.2.2" xref="S7.T5.30.30.1.m1.2.2.2.2.cmml">l</mi><mo id="S7.T5.30.30.1.m1.3.3.3.5.2" xref="S7.T5.30.30.1.m1.3.3.3.4.cmml">,</mo><mi id="S7.T5.30.30.1.m1.3.3.3.3" xref="S7.T5.30.30.1.m1.3.3.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T5.30.30.1.m1.3b"><apply id="S7.T5.30.30.1.m1.3.4.cmml" xref="S7.T5.30.30.1.m1.3.4"><csymbol cd="ambiguous" id="S7.T5.30.30.1.m1.3.4.1.cmml" xref="S7.T5.30.30.1.m1.3.4">subscript</csymbol><ci id="S7.T5.30.30.1.m1.3.4.2.cmml" xref="S7.T5.30.30.1.m1.3.4.2">𝛽</ci><list id="S7.T5.30.30.1.m1.3.3.3.4.cmml" xref="S7.T5.30.30.1.m1.3.3.3.5"><ci id="S7.T5.30.30.1.m1.1.1.1.1.cmml" xref="S7.T5.30.30.1.m1.1.1.1.1">𝑖</ci><ci id="S7.T5.30.30.1.m1.2.2.2.2.cmml" xref="S7.T5.30.30.1.m1.2.2.2.2">𝑙</ci><ci id="S7.T5.30.30.1.m1.3.3.3.3.cmml" xref="S7.T5.30.30.1.m1.3.3.3.3">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.30.30.1.m1.3c">\beta_{i,l,k}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.30.30.1.m1.3d">italic_β start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.33.33.4">reward coefficient for product <math alttext="i" class="ltx_Math" display="inline" id="S7.T5.31.31.2.m1.1"><semantics id="S7.T5.31.31.2.m1.1a"><mi id="S7.T5.31.31.2.m1.1.1" xref="S7.T5.31.31.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.T5.31.31.2.m1.1b"><ci id="S7.T5.31.31.2.m1.1.1.cmml" xref="S7.T5.31.31.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.31.31.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S7.T5.31.31.2.m1.1d">italic_i</annotation></semantics></math>, store <math alttext="l" class="ltx_Math" display="inline" id="S7.T5.32.32.3.m2.1"><semantics id="S7.T5.32.32.3.m2.1a"><mi id="S7.T5.32.32.3.m2.1.1" xref="S7.T5.32.32.3.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S7.T5.32.32.3.m2.1b"><ci id="S7.T5.32.32.3.m2.1.1.cmml" xref="S7.T5.32.32.3.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.32.32.3.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S7.T5.32.32.3.m2.1d">italic_l</annotation></semantics></math>, in cluster <math alttext="k" class="ltx_Math" display="inline" id="S7.T5.33.33.4.m3.1"><semantics id="S7.T5.33.33.4.m3.1a"><mi id="S7.T5.33.33.4.m3.1.1" xref="S7.T5.33.33.4.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S7.T5.33.33.4.m3.1b"><ci id="S7.T5.33.33.4.m3.1.1.cmml" xref="S7.T5.33.33.4.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.33.33.4.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S7.T5.33.33.4.m3.1d">italic_k</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.34.34">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.34.34.1"><math alttext="\sigma_{r}" class="ltx_Math" display="inline" id="S7.T5.34.34.1.m1.1"><semantics id="S7.T5.34.34.1.m1.1a"><msub id="S7.T5.34.34.1.m1.1.1" xref="S7.T5.34.34.1.m1.1.1.cmml"><mi id="S7.T5.34.34.1.m1.1.1.2" xref="S7.T5.34.34.1.m1.1.1.2.cmml">σ</mi><mi id="S7.T5.34.34.1.m1.1.1.3" xref="S7.T5.34.34.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T5.34.34.1.m1.1b"><apply id="S7.T5.34.34.1.m1.1.1.cmml" xref="S7.T5.34.34.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T5.34.34.1.m1.1.1.1.cmml" xref="S7.T5.34.34.1.m1.1.1">subscript</csymbol><ci id="S7.T5.34.34.1.m1.1.1.2.cmml" xref="S7.T5.34.34.1.m1.1.1.2">𝜎</ci><ci id="S7.T5.34.34.1.m1.1.1.3.cmml" xref="S7.T5.34.34.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.34.34.1.m1.1c">\sigma_{r}</annotation><annotation encoding="application/x-llamapun" id="S7.T5.34.34.1.m1.1d">italic_σ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.34.34.2">variance of reward (prior)</td>
</tr>
<tr class="ltx_tr" id="S7.T5.35.35">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T5.35.35.1"><math alttext="\rho" class="ltx_Math" display="inline" id="S7.T5.35.35.1.m1.1"><semantics id="S7.T5.35.35.1.m1.1a"><mi id="S7.T5.35.35.1.m1.1.1" xref="S7.T5.35.35.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S7.T5.35.35.1.m1.1b"><ci id="S7.T5.35.35.1.m1.1.1.cmml" xref="S7.T5.35.35.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.35.35.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S7.T5.35.35.1.m1.1d">italic_ρ</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T5.35.35.2">compliance statistic (distance function over sets)</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T5.37.1.1" style="font-size:90%;">Table 5</span>. </span><span class="ltx_text" id="S7.T5.38.2" style="font-size:90%;">Notation Summary of Problem Definition</span></figcaption>
</figure>
<figure class="ltx_table" id="S7.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T6.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T6.8.9.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S7.T6.8.9.1.1">Variable</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T6.8.9.1.2">Quantity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T6.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S7.T6.1.1.1"><math alttext="S" class="ltx_Math" display="inline" id="S7.T6.1.1.1.m1.1"><semantics id="S7.T6.1.1.1.m1.1a"><mi id="S7.T6.1.1.1.m1.1.1" xref="S7.T6.1.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S7.T6.1.1.1.m1.1b"><ci id="S7.T6.1.1.1.m1.1.1.cmml" xref="S7.T6.1.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.1.1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S7.T6.1.1.1.m1.1d">italic_S</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.1.1.2">store coordinates</td>
</tr>
<tr class="ltx_tr" id="S7.T6.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.2.2.1"><math alttext="C" class="ltx_Math" display="inline" id="S7.T6.2.2.1.m1.1"><semantics id="S7.T6.2.2.1.m1.1a"><mi id="S7.T6.2.2.1.m1.1.1" xref="S7.T6.2.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S7.T6.2.2.1.m1.1b"><ci id="S7.T6.2.2.1.m1.1.1.cmml" xref="S7.T6.2.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.2.2.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S7.T6.2.2.1.m1.1d">italic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T6.2.2.2">tract coordinates</td>
</tr>
<tr class="ltx_tr" id="S7.T6.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.3.3.1"><math alttext="H" class="ltx_Math" display="inline" id="S7.T6.3.3.1.m1.1"><semantics id="S7.T6.3.3.1.m1.1a"><mi id="S7.T6.3.3.1.m1.1.1" xref="S7.T6.3.3.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S7.T6.3.3.1.m1.1b"><ci id="S7.T6.3.3.1.m1.1.1.cmml" xref="S7.T6.3.3.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.3.3.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S7.T6.3.3.1.m1.1d">italic_H</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T6.3.3.2">history of likelihood values</td>
</tr>
<tr class="ltx_tr" id="S7.T6.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.4.4.1"><math alttext="\pi" class="ltx_Math" display="inline" id="S7.T6.4.4.1.m1.1"><semantics id="S7.T6.4.4.1.m1.1a"><mi id="S7.T6.4.4.1.m1.1.1" xref="S7.T6.4.4.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S7.T6.4.4.1.m1.1b"><ci id="S7.T6.4.4.1.m1.1.1.cmml" xref="S7.T6.4.4.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.4.4.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S7.T6.4.4.1.m1.1d">italic_π</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T6.4.4.2">mixture probabilities</td>
</tr>
<tr class="ltx_tr" id="S7.T6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.5.5.1"><math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S7.T6.5.5.1.m1.1"><semantics id="S7.T6.5.5.1.m1.1a"><msub id="S7.T6.5.5.1.m1.1.1" xref="S7.T6.5.5.1.m1.1.1.cmml"><mi id="S7.T6.5.5.1.m1.1.1.2" xref="S7.T6.5.5.1.m1.1.1.2.cmml">μ</mi><mi id="S7.T6.5.5.1.m1.1.1.3" xref="S7.T6.5.5.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T6.5.5.1.m1.1b"><apply id="S7.T6.5.5.1.m1.1.1.cmml" xref="S7.T6.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T6.5.5.1.m1.1.1.1.cmml" xref="S7.T6.5.5.1.m1.1.1">subscript</csymbol><ci id="S7.T6.5.5.1.m1.1.1.2.cmml" xref="S7.T6.5.5.1.m1.1.1.2">𝜇</ci><ci id="S7.T6.5.5.1.m1.1.1.3.cmml" xref="S7.T6.5.5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.5.5.1.m1.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S7.T6.5.5.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T6.6.6.2">mean of <math alttext="k^{th}" class="ltx_Math" display="inline" id="S7.T6.6.6.2.m1.1"><semantics id="S7.T6.6.6.2.m1.1a"><msup id="S7.T6.6.6.2.m1.1.1" xref="S7.T6.6.6.2.m1.1.1.cmml"><mi id="S7.T6.6.6.2.m1.1.1.2" xref="S7.T6.6.6.2.m1.1.1.2.cmml">k</mi><mrow id="S7.T6.6.6.2.m1.1.1.3" xref="S7.T6.6.6.2.m1.1.1.3.cmml"><mi id="S7.T6.6.6.2.m1.1.1.3.2" xref="S7.T6.6.6.2.m1.1.1.3.2.cmml">t</mi><mo id="S7.T6.6.6.2.m1.1.1.3.1" xref="S7.T6.6.6.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.T6.6.6.2.m1.1.1.3.3" xref="S7.T6.6.6.2.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S7.T6.6.6.2.m1.1b"><apply id="S7.T6.6.6.2.m1.1.1.cmml" xref="S7.T6.6.6.2.m1.1.1"><csymbol cd="ambiguous" id="S7.T6.6.6.2.m1.1.1.1.cmml" xref="S7.T6.6.6.2.m1.1.1">superscript</csymbol><ci id="S7.T6.6.6.2.m1.1.1.2.cmml" xref="S7.T6.6.6.2.m1.1.1.2">𝑘</ci><apply id="S7.T6.6.6.2.m1.1.1.3.cmml" xref="S7.T6.6.6.2.m1.1.1.3"><times id="S7.T6.6.6.2.m1.1.1.3.1.cmml" xref="S7.T6.6.6.2.m1.1.1.3.1"></times><ci id="S7.T6.6.6.2.m1.1.1.3.2.cmml" xref="S7.T6.6.6.2.m1.1.1.3.2">𝑡</ci><ci id="S7.T6.6.6.2.m1.1.1.3.3.cmml" xref="S7.T6.6.6.2.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.6.6.2.m1.1c">k^{th}</annotation><annotation encoding="application/x-llamapun" id="S7.T6.6.6.2.m1.1d">italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> Gaussian (fixed)</td>
</tr>
<tr class="ltx_tr" id="S7.T6.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.7.7.1"><math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S7.T6.7.7.1.m1.1"><semantics id="S7.T6.7.7.1.m1.1a"><msub id="S7.T6.7.7.1.m1.1.1" xref="S7.T6.7.7.1.m1.1.1.cmml"><mi id="S7.T6.7.7.1.m1.1.1.2" mathvariant="normal" xref="S7.T6.7.7.1.m1.1.1.2.cmml">Σ</mi><mi id="S7.T6.7.7.1.m1.1.1.3" xref="S7.T6.7.7.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T6.7.7.1.m1.1b"><apply id="S7.T6.7.7.1.m1.1.1.cmml" xref="S7.T6.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T6.7.7.1.m1.1.1.1.cmml" xref="S7.T6.7.7.1.m1.1.1">subscript</csymbol><ci id="S7.T6.7.7.1.m1.1.1.2.cmml" xref="S7.T6.7.7.1.m1.1.1.2">Σ</ci><ci id="S7.T6.7.7.1.m1.1.1.3.cmml" xref="S7.T6.7.7.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.7.7.1.m1.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S7.T6.7.7.1.m1.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T6.8.8.2">covariance matrix of the <math alttext="k^{th}" class="ltx_Math" display="inline" id="S7.T6.8.8.2.m1.1"><semantics id="S7.T6.8.8.2.m1.1a"><msup id="S7.T6.8.8.2.m1.1.1" xref="S7.T6.8.8.2.m1.1.1.cmml"><mi id="S7.T6.8.8.2.m1.1.1.2" xref="S7.T6.8.8.2.m1.1.1.2.cmml">k</mi><mrow id="S7.T6.8.8.2.m1.1.1.3" xref="S7.T6.8.8.2.m1.1.1.3.cmml"><mi id="S7.T6.8.8.2.m1.1.1.3.2" xref="S7.T6.8.8.2.m1.1.1.3.2.cmml">t</mi><mo id="S7.T6.8.8.2.m1.1.1.3.1" xref="S7.T6.8.8.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S7.T6.8.8.2.m1.1.1.3.3" xref="S7.T6.8.8.2.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S7.T6.8.8.2.m1.1b"><apply id="S7.T6.8.8.2.m1.1.1.cmml" xref="S7.T6.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S7.T6.8.8.2.m1.1.1.1.cmml" xref="S7.T6.8.8.2.m1.1.1">superscript</csymbol><ci id="S7.T6.8.8.2.m1.1.1.2.cmml" xref="S7.T6.8.8.2.m1.1.1.2">𝑘</ci><apply id="S7.T6.8.8.2.m1.1.1.3.cmml" xref="S7.T6.8.8.2.m1.1.1.3"><times id="S7.T6.8.8.2.m1.1.1.3.1.cmml" xref="S7.T6.8.8.2.m1.1.1.3.1"></times><ci id="S7.T6.8.8.2.m1.1.1.3.2.cmml" xref="S7.T6.8.8.2.m1.1.1.3.2">𝑡</ci><ci id="S7.T6.8.8.2.m1.1.1.3.3.cmml" xref="S7.T6.8.8.2.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.8.8.2.m1.1c">k^{th}</annotation><annotation encoding="application/x-llamapun" id="S7.T6.8.8.2.m1.1d">italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> Gaussian</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T6.10.1.1" style="font-size:90%;">Table 6</span>. </span><span class="ltx_text" id="S7.T6.11.2" style="font-size:90%;">Notation Summary of SpAGMM</span></figcaption>
</figure>
<figure class="ltx_table" id="S7.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T7.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T7.10.11.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S7.T7.10.11.1.1">Variable</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T7.10.11.1.2">Quantity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T7.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S7.T7.1.1.1"><math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S7.T7.1.1.1.m1.1"><semantics id="S7.T7.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.T7.1.1.1.m1.1.1" xref="S7.T7.1.1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S7.T7.1.1.1.m1.1b"><ci id="S7.T7.1.1.1.m1.1.1.cmml" xref="S7.T7.1.1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.1.1.1.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S7.T7.1.1.1.m1.1d">caligraphic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T7.1.1.2">set of product candidates</td>
</tr>
<tr class="ltx_tr" id="S7.T7.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.2.2.1"><math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S7.T7.2.2.1.m1.1"><semantics id="S7.T7.2.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.T7.2.2.1.m1.1.1" xref="S7.T7.2.2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S7.T7.2.2.1.m1.1b"><ci id="S7.T7.2.2.1.m1.1.1.cmml" xref="S7.T7.2.2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.2.2.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S7.T7.2.2.1.m1.1d">caligraphic_S</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.2.2.2">set of observed products (state)</td>
</tr>
<tr class="ltx_tr" id="S7.T7.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.3.3.1"><math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S7.T7.3.3.1.m1.1"><semantics id="S7.T7.3.3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.T7.3.3.1.m1.1.1" xref="S7.T7.3.3.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S7.T7.3.3.1.m1.1b"><ci id="S7.T7.3.3.1.m1.1.1.cmml" xref="S7.T7.3.3.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.3.3.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S7.T7.3.3.1.m1.1d">caligraphic_R</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.3.3.2">set of recommended products</td>
</tr>
<tr class="ltx_tr" id="S7.T7.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.4.4.1"><math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S7.T7.4.4.1.m1.1"><semantics id="S7.T7.4.4.1.m1.1a"><mrow id="S7.T7.4.4.1.m1.1.2" xref="S7.T7.4.4.1.m1.1.2.cmml"><mi id="S7.T7.4.4.1.m1.1.2.2" xref="S7.T7.4.4.1.m1.1.2.2.cmml">f</mi><mo id="S7.T7.4.4.1.m1.1.2.1" xref="S7.T7.4.4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S7.T7.4.4.1.m1.1.2.3.2" xref="S7.T7.4.4.1.m1.1.2.cmml"><mo id="S7.T7.4.4.1.m1.1.2.3.2.1" stretchy="false" xref="S7.T7.4.4.1.m1.1.2.cmml">(</mo><mo id="S7.T7.4.4.1.m1.1.1" lspace="0em" rspace="0em" xref="S7.T7.4.4.1.m1.1.1.cmml">⋅</mo><mo id="S7.T7.4.4.1.m1.1.2.3.2.2" stretchy="false" xref="S7.T7.4.4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.T7.4.4.1.m1.1b"><apply id="S7.T7.4.4.1.m1.1.2.cmml" xref="S7.T7.4.4.1.m1.1.2"><times id="S7.T7.4.4.1.m1.1.2.1.cmml" xref="S7.T7.4.4.1.m1.1.2.1"></times><ci id="S7.T7.4.4.1.m1.1.2.2.cmml" xref="S7.T7.4.4.1.m1.1.2.2">𝑓</ci><ci id="S7.T7.4.4.1.m1.1.1.cmml" xref="S7.T7.4.4.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.4.4.1.m1.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S7.T7.4.4.1.m1.1d">italic_f ( ⋅ )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.4.4.2">scoring function</td>
</tr>
<tr class="ltx_tr" id="S7.T7.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.5.5.1"><math alttext="V" class="ltx_Math" display="inline" id="S7.T7.5.5.1.m1.1"><semantics id="S7.T7.5.5.1.m1.1a"><mi id="S7.T7.5.5.1.m1.1.1" xref="S7.T7.5.5.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S7.T7.5.5.1.m1.1b"><ci id="S7.T7.5.5.1.m1.1.1.cmml" xref="S7.T7.5.5.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.5.5.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="S7.T7.5.5.1.m1.1d">italic_V</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.5.5.2">number of product swaps per iteration</td>
</tr>
<tr class="ltx_tr" id="S7.T7.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.6.6.1"><math alttext="T" class="ltx_Math" display="inline" id="S7.T7.6.6.1.m1.1"><semantics id="S7.T7.6.6.1.m1.1a"><mi id="S7.T7.6.6.1.m1.1.1" xref="S7.T7.6.6.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S7.T7.6.6.1.m1.1b"><ci id="S7.T7.6.6.1.m1.1.1.cmml" xref="S7.T7.6.6.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.6.6.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S7.T7.6.6.1.m1.1d">italic_T</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.6.6.2">number of iterations, or time steps</td>
</tr>
<tr class="ltx_tr" id="S7.T7.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.7.7.1"><math alttext="\epsilon" class="ltx_Math" display="inline" id="S7.T7.7.7.1.m1.1"><semantics id="S7.T7.7.7.1.m1.1a"><mi id="S7.T7.7.7.1.m1.1.1" xref="S7.T7.7.7.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S7.T7.7.7.1.m1.1b"><ci id="S7.T7.7.7.1.m1.1.1.cmml" xref="S7.T7.7.7.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.7.7.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S7.T7.7.7.1.m1.1d">italic_ϵ</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.7.7.2">epsilon-greedy parameter</td>
</tr>
<tr class="ltx_tr" id="S7.T7.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.8.8.1"><math alttext="Q_{s}" class="ltx_Math" display="inline" id="S7.T7.8.8.1.m1.1"><semantics id="S7.T7.8.8.1.m1.1a"><msub id="S7.T7.8.8.1.m1.1.1" xref="S7.T7.8.8.1.m1.1.1.cmml"><mi id="S7.T7.8.8.1.m1.1.1.2" xref="S7.T7.8.8.1.m1.1.1.2.cmml">Q</mi><mi id="S7.T7.8.8.1.m1.1.1.3" xref="S7.T7.8.8.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S7.T7.8.8.1.m1.1b"><apply id="S7.T7.8.8.1.m1.1.1.cmml" xref="S7.T7.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T7.8.8.1.m1.1.1.1.cmml" xref="S7.T7.8.8.1.m1.1.1">subscript</csymbol><ci id="S7.T7.8.8.1.m1.1.1.2.cmml" xref="S7.T7.8.8.1.m1.1.1.2">𝑄</ci><ci id="S7.T7.8.8.1.m1.1.1.3.cmml" xref="S7.T7.8.8.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.8.8.1.m1.1c">Q_{s}</annotation><annotation encoding="application/x-llamapun" id="S7.T7.8.8.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.8.8.2">lookup table expressing quantity of each product</td>
</tr>
<tr class="ltx_tr" id="S7.T7.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.9.9.1"><math alttext="B" class="ltx_Math" display="inline" id="S7.T7.9.9.1.m1.1"><semantics id="S7.T7.9.9.1.m1.1a"><mi id="S7.T7.9.9.1.m1.1.1" xref="S7.T7.9.9.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S7.T7.9.9.1.m1.1b"><ci id="S7.T7.9.9.1.m1.1.1.cmml" xref="S7.T7.9.9.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.9.9.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S7.T7.9.9.1.m1.1d">italic_B</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.9.9.2">quantity budget</td>
</tr>
<tr class="ltx_tr" id="S7.T7.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T7.10.10.1"><math alttext="\delta(\cdot)" class="ltx_Math" display="inline" id="S7.T7.10.10.1.m1.1"><semantics id="S7.T7.10.10.1.m1.1a"><mrow id="S7.T7.10.10.1.m1.1.2" xref="S7.T7.10.10.1.m1.1.2.cmml"><mi id="S7.T7.10.10.1.m1.1.2.2" xref="S7.T7.10.10.1.m1.1.2.2.cmml">δ</mi><mo id="S7.T7.10.10.1.m1.1.2.1" xref="S7.T7.10.10.1.m1.1.2.1.cmml">⁢</mo><mrow id="S7.T7.10.10.1.m1.1.2.3.2" xref="S7.T7.10.10.1.m1.1.2.cmml"><mo id="S7.T7.10.10.1.m1.1.2.3.2.1" stretchy="false" xref="S7.T7.10.10.1.m1.1.2.cmml">(</mo><mo id="S7.T7.10.10.1.m1.1.1" lspace="0em" rspace="0em" xref="S7.T7.10.10.1.m1.1.1.cmml">⋅</mo><mo id="S7.T7.10.10.1.m1.1.2.3.2.2" stretchy="false" xref="S7.T7.10.10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.T7.10.10.1.m1.1b"><apply id="S7.T7.10.10.1.m1.1.2.cmml" xref="S7.T7.10.10.1.m1.1.2"><times id="S7.T7.10.10.1.m1.1.2.1.cmml" xref="S7.T7.10.10.1.m1.1.2.1"></times><ci id="S7.T7.10.10.1.m1.1.2.2.cmml" xref="S7.T7.10.10.1.m1.1.2.2">𝛿</ci><ci id="S7.T7.10.10.1.m1.1.1.cmml" xref="S7.T7.10.10.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T7.10.10.1.m1.1c">\delta(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S7.T7.10.10.1.m1.1d">italic_δ ( ⋅ )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S7.T7.10.10.2">decay function</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T7.12.1.1" style="font-size:90%;">Table 7</span>. </span><span class="ltx_text" id="S7.T7.13.2" style="font-size:90%;">Notation Summary of Heuristic Search</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2. </span>SpAGMM Estimation</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.7">We present the full pseudo-code in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#alg1" title="Algorithm 1 ‣ 3.2. Spatial Clustering ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>. We use the Expectation-Maximization (EM) algorithm to learn the SpAGMM clusters. In the expectation step, we assign each tract to the nearest cluster given the current estimates of covariance. The maximization step, performs two functions. First, it returns a weighted probability matrix, <math alttext="\Pi" class="ltx_Math" display="inline" id="S7.SS2.p1.1.m1.1"><semantics id="S7.SS2.p1.1.m1.1a"><mi id="S7.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S7.SS2.p1.1.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.1.m1.1b"><ci id="S7.SS2.p1.1.m1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.1.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.1.m1.1d">roman_Π</annotation></semantics></math>, defining the probability store <math alttext="s_{l}" class="ltx_Math" display="inline" id="S7.SS2.p1.2.m2.1"><semantics id="S7.SS2.p1.2.m2.1a"><msub id="S7.SS2.p1.2.m2.1.1" xref="S7.SS2.p1.2.m2.1.1.cmml"><mi id="S7.SS2.p1.2.m2.1.1.2" xref="S7.SS2.p1.2.m2.1.1.2.cmml">s</mi><mi id="S7.SS2.p1.2.m2.1.1.3" xref="S7.SS2.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.2.m2.1b"><apply id="S7.SS2.p1.2.m2.1.1.cmml" xref="S7.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS2.p1.2.m2.1.1.1.cmml" xref="S7.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S7.SS2.p1.2.m2.1.1.2.cmml" xref="S7.SS2.p1.2.m2.1.1.2">𝑠</ci><ci id="S7.SS2.p1.2.m2.1.1.3.cmml" xref="S7.SS2.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.2.m2.1c">s_{l}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> matches to tract <math alttext="\alpha_{z}" class="ltx_Math" display="inline" id="S7.SS2.p1.3.m3.1"><semantics id="S7.SS2.p1.3.m3.1a"><msub id="S7.SS2.p1.3.m3.1.1" xref="S7.SS2.p1.3.m3.1.1.cmml"><mi id="S7.SS2.p1.3.m3.1.1.2" xref="S7.SS2.p1.3.m3.1.1.2.cmml">α</mi><mi id="S7.SS2.p1.3.m3.1.1.3" xref="S7.SS2.p1.3.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.3.m3.1b"><apply id="S7.SS2.p1.3.m3.1.1.cmml" xref="S7.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS2.p1.3.m3.1.1.1.cmml" xref="S7.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S7.SS2.p1.3.m3.1.1.2.cmml" xref="S7.SS2.p1.3.m3.1.1.2">𝛼</ci><ci id="S7.SS2.p1.3.m3.1.1.3.cmml" xref="S7.SS2.p1.3.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.3.m3.1c">\alpha_{z}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.3.m3.1d">italic_α start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, given <math alttext="\pi" class="ltx_Math" display="inline" id="S7.SS2.p1.4.m4.1"><semantics id="S7.SS2.p1.4.m4.1a"><mi id="S7.SS2.p1.4.m4.1.1" xref="S7.SS2.p1.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.4.m4.1b"><ci id="S7.SS2.p1.4.m4.1.1.cmml" xref="S7.SS2.p1.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.4.m4.1d">italic_π</annotation></semantics></math>. Second, it updates the parameters <math alttext="\Sigma" class="ltx_Math" display="inline" id="S7.SS2.p1.5.m5.1"><semantics id="S7.SS2.p1.5.m5.1a"><mi id="S7.SS2.p1.5.m5.1.1" mathvariant="normal" xref="S7.SS2.p1.5.m5.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.5.m5.1b"><ci id="S7.SS2.p1.5.m5.1.1.cmml" xref="S7.SS2.p1.5.m5.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.5.m5.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.5.m5.1d">roman_Σ</annotation></semantics></math> and <math alttext="\pi" class="ltx_Math" display="inline" id="S7.SS2.p1.6.m6.1"><semantics id="S7.SS2.p1.6.m6.1a"><mi id="S7.SS2.p1.6.m6.1.1" xref="S7.SS2.p1.6.m6.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.6.m6.1b"><ci id="S7.SS2.p1.6.m6.1.1.cmml" xref="S7.SS2.p1.6.m6.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.6.m6.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.6.m6.1d">italic_π</annotation></semantics></math> that maximize <math alttext="E" class="ltx_Math" display="inline" id="S7.SS2.p1.7.m7.1"><semantics id="S7.SS2.p1.7.m7.1a"><mi id="S7.SS2.p1.7.m7.1.1" xref="S7.SS2.p1.7.m7.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.7.m7.1b"><ci id="S7.SS2.p1.7.m7.1.1.cmml" xref="S7.SS2.p1.7.m7.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.7.m7.1c">E</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.7.m7.1d">italic_E</annotation></semantics></math> returned from the expectation step. We use Maximum A Posteriori (MAP) estimation instead of Maximum Likelihood estimation (ML) due to numerical stability. The MLE is likely to overfit, leading to the variance parameter to collapse to 0.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3. </span><span class="ltx_text" id="S7.SS3.1.1">EdgeRec3D</span> parameter settings</h3>
<div class="ltx_para" id="S7.SS3.p1">
<p class="ltx_p" id="S7.SS3.p1.6">During our experiments we set the number of product swaps per iteration, <math alttext="V=2" class="ltx_Math" display="inline" id="S7.SS3.p1.1.m1.1"><semantics id="S7.SS3.p1.1.m1.1a"><mrow id="S7.SS3.p1.1.m1.1.1" xref="S7.SS3.p1.1.m1.1.1.cmml"><mi id="S7.SS3.p1.1.m1.1.1.2" xref="S7.SS3.p1.1.m1.1.1.2.cmml">V</mi><mo id="S7.SS3.p1.1.m1.1.1.1" xref="S7.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS3.p1.1.m1.1.1.3" xref="S7.SS3.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.1.m1.1b"><apply id="S7.SS3.p1.1.m1.1.1.cmml" xref="S7.SS3.p1.1.m1.1.1"><eq id="S7.SS3.p1.1.m1.1.1.1.cmml" xref="S7.SS3.p1.1.m1.1.1.1"></eq><ci id="S7.SS3.p1.1.m1.1.1.2.cmml" xref="S7.SS3.p1.1.m1.1.1.2">𝑉</ci><cn id="S7.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S7.SS3.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.1.m1.1c">V=2</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.1.m1.1d">italic_V = 2</annotation></semantics></math>. At each iteration, we take the lowest <math alttext="V=2" class="ltx_Math" display="inline" id="S7.SS3.p1.2.m2.1"><semantics id="S7.SS3.p1.2.m2.1a"><mrow id="S7.SS3.p1.2.m2.1.1" xref="S7.SS3.p1.2.m2.1.1.cmml"><mi id="S7.SS3.p1.2.m2.1.1.2" xref="S7.SS3.p1.2.m2.1.1.2.cmml">V</mi><mo id="S7.SS3.p1.2.m2.1.1.1" xref="S7.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS3.p1.2.m2.1.1.3" xref="S7.SS3.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.2.m2.1b"><apply id="S7.SS3.p1.2.m2.1.1.cmml" xref="S7.SS3.p1.2.m2.1.1"><eq id="S7.SS3.p1.2.m2.1.1.1.cmml" xref="S7.SS3.p1.2.m2.1.1.1"></eq><ci id="S7.SS3.p1.2.m2.1.1.2.cmml" xref="S7.SS3.p1.2.m2.1.1.2">𝑉</ci><cn id="S7.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S7.SS3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.2.m2.1c">V=2</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.2.m2.1d">italic_V = 2</annotation></semantics></math> products by PEPF and choose 2 higher value product swaps, following an <math alttext="\epsilon" class="ltx_Math" display="inline" id="S7.SS3.p1.3.m3.1"><semantics id="S7.SS3.p1.3.m3.1a"><mi id="S7.SS3.p1.3.m3.1.1" xref="S7.SS3.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.3.m3.1b"><ci id="S7.SS3.p1.3.m3.1.1.cmml" xref="S7.SS3.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.3.m3.1d">italic_ϵ</annotation></semantics></math>-greedy routine. We set the <math alttext="\epsilon" class="ltx_Math" display="inline" id="S7.SS3.p1.4.m4.1"><semantics id="S7.SS3.p1.4.m4.1a"><mi id="S7.SS3.p1.4.m4.1.1" xref="S7.SS3.p1.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.4.m4.1b"><ci id="S7.SS3.p1.4.m4.1.1.cmml" xref="S7.SS3.p1.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.4.m4.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.4.m4.1d">italic_ϵ</annotation></semantics></math>-greedy parameter to <math alttext="\epsilon=0.05" class="ltx_Math" display="inline" id="S7.SS3.p1.5.m5.1"><semantics id="S7.SS3.p1.5.m5.1a"><mrow id="S7.SS3.p1.5.m5.1.1" xref="S7.SS3.p1.5.m5.1.1.cmml"><mi id="S7.SS3.p1.5.m5.1.1.2" xref="S7.SS3.p1.5.m5.1.1.2.cmml">ϵ</mi><mo id="S7.SS3.p1.5.m5.1.1.1" xref="S7.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S7.SS3.p1.5.m5.1.1.3" xref="S7.SS3.p1.5.m5.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.5.m5.1b"><apply id="S7.SS3.p1.5.m5.1.1.cmml" xref="S7.SS3.p1.5.m5.1.1"><eq id="S7.SS3.p1.5.m5.1.1.1.cmml" xref="S7.SS3.p1.5.m5.1.1.1"></eq><ci id="S7.SS3.p1.5.m5.1.1.2.cmml" xref="S7.SS3.p1.5.m5.1.1.2">italic-ϵ</ci><cn id="S7.SS3.p1.5.m5.1.1.3.cmml" type="float" xref="S7.SS3.p1.5.m5.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.5.m5.1c">\epsilon=0.05</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.5.m5.1d">italic_ϵ = 0.05</annotation></semantics></math>. We allow for a two week pre-treatment period to get a baseline for sales, following which we deploy recommendations. We update recommendations on a weekly cadence. Finally, we set the uncertainty coefficient <math alttext="\lambda=1.0" class="ltx_Math" display="inline" id="S7.SS3.p1.6.m6.1"><semantics id="S7.SS3.p1.6.m6.1a"><mrow id="S7.SS3.p1.6.m6.1.1" xref="S7.SS3.p1.6.m6.1.1.cmml"><mi id="S7.SS3.p1.6.m6.1.1.2" xref="S7.SS3.p1.6.m6.1.1.2.cmml">λ</mi><mo id="S7.SS3.p1.6.m6.1.1.1" xref="S7.SS3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S7.SS3.p1.6.m6.1.1.3" xref="S7.SS3.p1.6.m6.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.6.m6.1b"><apply id="S7.SS3.p1.6.m6.1.1.cmml" xref="S7.SS3.p1.6.m6.1.1"><eq id="S7.SS3.p1.6.m6.1.1.1.cmml" xref="S7.SS3.p1.6.m6.1.1.1"></eq><ci id="S7.SS3.p1.6.m6.1.1.2.cmml" xref="S7.SS3.p1.6.m6.1.1.2">𝜆</ci><cn id="S7.SS3.p1.6.m6.1.1.3.cmml" type="float" xref="S7.SS3.p1.6.m6.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.6.m6.1c">\lambda=1.0</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.6.m6.1d">italic_λ = 1.0</annotation></semantics></math></p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4. </span>Complexity Analysis of <span class="ltx_text" id="S7.SS4.1.1">EdgeRec3D</span>
</h3>
<div class="ltx_para" id="S7.SS4.p1">
<p class="ltx_p" id="S7.SS4.p1.6">Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S1.E1" title="Equation 1 ‣ 1. Introduction ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">1</span></a> of the Introduction describes the number of assortment possibilities for <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.p1.1.m1.1"><semantics id="S7.SS4.p1.1.m1.1a"><mi id="S7.SS4.p1.1.m1.1.1" xref="S7.SS4.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.1.m1.1b"><ci id="S7.SS4.p1.1.m1.1.1.cmml" xref="S7.SS4.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.1.m1.1d">italic_p</annotation></semantics></math> products and <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.p1.2.m2.1"><semantics id="S7.SS4.p1.2.m2.1a"><mi id="S7.SS4.p1.2.m2.1.1" xref="S7.SS4.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.2.m2.1b"><ci id="S7.SS4.p1.2.m2.1.1.cmml" xref="S7.SS4.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.2.m2.1d">italic_m</annotation></semantics></math> discrete product locations. Since this equation grows factorially in both <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.p1.3.m3.1"><semantics id="S7.SS4.p1.3.m3.1a"><mi id="S7.SS4.p1.3.m3.1.1" xref="S7.SS4.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.3.m3.1b"><ci id="S7.SS4.p1.3.m3.1.1.cmml" xref="S7.SS4.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.3.m3.1d">italic_p</annotation></semantics></math> and <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.p1.4.m4.1"><semantics id="S7.SS4.p1.4.m4.1a"><mi id="S7.SS4.p1.4.m4.1.1" xref="S7.SS4.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.4.m4.1b"><ci id="S7.SS4.p1.4.m4.1.1.cmml" xref="S7.SS4.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.4.m4.1d">italic_m</annotation></semantics></math>, exploring all assortment possibilities is impossible in finite time for realistic <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.p1.5.m5.1"><semantics id="S7.SS4.p1.5.m5.1a"><mi id="S7.SS4.p1.5.m5.1.1" xref="S7.SS4.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.5.m5.1b"><ci id="S7.SS4.p1.5.m5.1.1.cmml" xref="S7.SS4.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.5.m5.1d">italic_m</annotation></semantics></math> and <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.p1.6.m6.1"><semantics id="S7.SS4.p1.6.m6.1a"><mi id="S7.SS4.p1.6.m6.1.1" xref="S7.SS4.p1.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.p1.6.m6.1b"><ci id="S7.SS4.p1.6.m6.1.1.cmml" xref="S7.SS4.p1.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.p1.6.m6.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.p1.6.m6.1d">italic_p</annotation></semantics></math>. We design <span class="ltx_text" id="S7.SS4.p1.6.1">EdgeRec3D</span> to address this combinatorial explosion through two of its components: 1) candidate generation and 2) heuristic search.</p>
</div>
<section class="ltx_subsubsection" id="S7.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.4.1. </span>Complexity of Candidate Generator</h4>
<div class="ltx_para" id="S7.SS4.SSS1.p1">
<p class="ltx_p" id="S7.SS4.SSS1.p1.1">The candidate generator mines an active database to produce a graph representing the likelihood of product co-occurrences. We then sample from this graph using a “seed” set of products, which are the products observed on the current display state. The complexity of candidate generation is</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S7.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O(n+sp\tau+\tau)" class="ltx_Math" display="block" id="S7.E7.m1.1"><semantics id="S7.E7.m1.1a"><mrow id="S7.E7.m1.1.1" xref="S7.E7.m1.1.1.cmml"><mi id="S7.E7.m1.1.1.3" xref="S7.E7.m1.1.1.3.cmml">O</mi><mo id="S7.E7.m1.1.1.2" xref="S7.E7.m1.1.1.2.cmml">⁢</mo><mrow id="S7.E7.m1.1.1.1.1" xref="S7.E7.m1.1.1.1.1.1.cmml"><mo id="S7.E7.m1.1.1.1.1.2" stretchy="false" xref="S7.E7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E7.m1.1.1.1.1.1" xref="S7.E7.m1.1.1.1.1.1.cmml"><mi id="S7.E7.m1.1.1.1.1.1.2" xref="S7.E7.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S7.E7.m1.1.1.1.1.1.1" xref="S7.E7.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S7.E7.m1.1.1.1.1.1.3" xref="S7.E7.m1.1.1.1.1.1.3.cmml"><mi id="S7.E7.m1.1.1.1.1.1.3.2" xref="S7.E7.m1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S7.E7.m1.1.1.1.1.1.3.1" xref="S7.E7.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S7.E7.m1.1.1.1.1.1.3.3" xref="S7.E7.m1.1.1.1.1.1.3.3.cmml">p</mi><mo id="S7.E7.m1.1.1.1.1.1.3.1a" xref="S7.E7.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S7.E7.m1.1.1.1.1.1.3.4" xref="S7.E7.m1.1.1.1.1.1.3.4.cmml">τ</mi></mrow><mo id="S7.E7.m1.1.1.1.1.1.1a" xref="S7.E7.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S7.E7.m1.1.1.1.1.1.4" xref="S7.E7.m1.1.1.1.1.1.4.cmml">τ</mi></mrow><mo id="S7.E7.m1.1.1.1.1.3" stretchy="false" xref="S7.E7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.E7.m1.1b"><apply id="S7.E7.m1.1.1.cmml" xref="S7.E7.m1.1.1"><times id="S7.E7.m1.1.1.2.cmml" xref="S7.E7.m1.1.1.2"></times><ci id="S7.E7.m1.1.1.3.cmml" xref="S7.E7.m1.1.1.3">𝑂</ci><apply id="S7.E7.m1.1.1.1.1.1.cmml" xref="S7.E7.m1.1.1.1.1"><plus id="S7.E7.m1.1.1.1.1.1.1.cmml" xref="S7.E7.m1.1.1.1.1.1.1"></plus><ci id="S7.E7.m1.1.1.1.1.1.2.cmml" xref="S7.E7.m1.1.1.1.1.1.2">𝑛</ci><apply id="S7.E7.m1.1.1.1.1.1.3.cmml" xref="S7.E7.m1.1.1.1.1.1.3"><times id="S7.E7.m1.1.1.1.1.1.3.1.cmml" xref="S7.E7.m1.1.1.1.1.1.3.1"></times><ci id="S7.E7.m1.1.1.1.1.1.3.2.cmml" xref="S7.E7.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S7.E7.m1.1.1.1.1.1.3.3.cmml" xref="S7.E7.m1.1.1.1.1.1.3.3">𝑝</ci><ci id="S7.E7.m1.1.1.1.1.1.3.4.cmml" xref="S7.E7.m1.1.1.1.1.1.3.4">𝜏</ci></apply><ci id="S7.E7.m1.1.1.1.1.1.4.cmml" xref="S7.E7.m1.1.1.1.1.1.4">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E7.m1.1c">O(n+sp\tau+\tau)</annotation><annotation encoding="application/x-llamapun" id="S7.E7.m1.1d">italic_O ( italic_n + italic_s italic_p italic_τ + italic_τ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS1.p3">
<p class="ltx_p" id="S7.SS4.SSS1.p3.10">for <math alttext="n" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.1.m1.1"><semantics id="S7.SS4.SSS1.p3.1.m1.1a"><mi id="S7.SS4.SSS1.p3.1.m1.1.1" xref="S7.SS4.SSS1.p3.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.1.m1.1b"><ci id="S7.SS4.SSS1.p3.1.m1.1.1.cmml" xref="S7.SS4.SSS1.p3.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.1.m1.1d">italic_n</annotation></semantics></math> user logs, <math alttext="s" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.2.m2.1"><semantics id="S7.SS4.SSS1.p3.2.m2.1a"><mi id="S7.SS4.SSS1.p3.2.m2.1.1" xref="S7.SS4.SSS1.p3.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.2.m2.1b"><ci id="S7.SS4.SSS1.p3.2.m2.1.1.cmml" xref="S7.SS4.SSS1.p3.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.2.m2.1d">italic_s</annotation></semantics></math> size of seed set <math alttext="\tau" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.3.m3.1"><semantics id="S7.SS4.SSS1.p3.3.m3.1a"><mi id="S7.SS4.SSS1.p3.3.m3.1.1" xref="S7.SS4.SSS1.p3.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.3.m3.1b"><ci id="S7.SS4.SSS1.p3.3.m3.1.1.cmml" xref="S7.SS4.SSS1.p3.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.3.m3.1d">italic_τ</annotation></semantics></math> number of samples from the graph. The algorithm steps through each of the <math alttext="n" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.4.m4.1"><semantics id="S7.SS4.SSS1.p3.4.m4.1a"><mi id="S7.SS4.SSS1.p3.4.m4.1.1" xref="S7.SS4.SSS1.p3.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.4.m4.1b"><ci id="S7.SS4.SSS1.p3.4.m4.1.1.cmml" xref="S7.SS4.SSS1.p3.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.4.m4.1d">italic_n</annotation></semantics></math> logs and increments a counter of pairwise-product co-occurence to produce an adjacency list representing the graph. Once this is complete, we sample the graph to produce <math alttext="c" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.5.m5.1"><semantics id="S7.SS4.SSS1.p3.5.m5.1a"><mi id="S7.SS4.SSS1.p3.5.m5.1.1" xref="S7.SS4.SSS1.p3.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.5.m5.1b"><ci id="S7.SS4.SSS1.p3.5.m5.1.1.cmml" xref="S7.SS4.SSS1.p3.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.5.m5.1d">italic_c</annotation></semantics></math> candidates. In the sampling step, for each of the <math alttext="s" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.6.m6.1"><semantics id="S7.SS4.SSS1.p3.6.m6.1a"><mi id="S7.SS4.SSS1.p3.6.m6.1.1" xref="S7.SS4.SSS1.p3.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.6.m6.1b"><ci id="S7.SS4.SSS1.p3.6.m6.1.1.cmml" xref="S7.SS4.SSS1.p3.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.6.m6.1d">italic_s</annotation></semantics></math> products we sample from it’s <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.7.m7.1"><semantics id="S7.SS4.SSS1.p3.7.m7.1a"><mi id="S7.SS4.SSS1.p3.7.m7.1.1" xref="S7.SS4.SSS1.p3.7.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.7.m7.1b"><ci id="S7.SS4.SSS1.p3.7.m7.1.1.cmml" xref="S7.SS4.SSS1.p3.7.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.7.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.7.m7.1d">italic_p</annotation></semantics></math> neighbors <math alttext="\tau" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.8.m8.1"><semantics id="S7.SS4.SSS1.p3.8.m8.1a"><mi id="S7.SS4.SSS1.p3.8.m8.1.1" xref="S7.SS4.SSS1.p3.8.m8.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.8.m8.1b"><ci id="S7.SS4.SSS1.p3.8.m8.1.1.cmml" xref="S7.SS4.SSS1.p3.8.m8.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.8.m8.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.8.m8.1d">italic_τ</annotation></semantics></math> times. In the worst case, the number of adjacent products is <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.9.m9.1"><semantics id="S7.SS4.SSS1.p3.9.m9.1a"><mi id="S7.SS4.SSS1.p3.9.m9.1.1" xref="S7.SS4.SSS1.p3.9.m9.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.9.m9.1b"><ci id="S7.SS4.SSS1.p3.9.m9.1.1.cmml" xref="S7.SS4.SSS1.p3.9.m9.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.9.m9.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.9.m9.1d">italic_p</annotation></semantics></math> although it practice it is usually much less. We then step through each of the <math alttext="\tau" class="ltx_Math" display="inline" id="S7.SS4.SSS1.p3.10.m10.1"><semantics id="S7.SS4.SSS1.p3.10.m10.1a"><mi id="S7.SS4.SSS1.p3.10.m10.1.1" xref="S7.SS4.SSS1.p3.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS1.p3.10.m10.1b"><ci id="S7.SS4.SSS1.p3.10.m10.1.1.cmml" xref="S7.SS4.SSS1.p3.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS1.p3.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS1.p3.10.m10.1d">italic_τ</annotation></semantics></math> candidates in the pruning step.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.4.2. </span>Complexity of Heuristic Search</h4>
<div class="ltx_para" id="S7.SS4.SSS2.p1">
<p class="ltx_p" id="S7.SS4.SSS2.p1.1">The heuristic search module is run each time a new recommendation is generated. It’s complexity is:</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S7.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O(c+s+mv)" class="ltx_Math" display="block" id="S7.E8.m1.1"><semantics id="S7.E8.m1.1a"><mrow id="S7.E8.m1.1.1" xref="S7.E8.m1.1.1.cmml"><mi id="S7.E8.m1.1.1.3" xref="S7.E8.m1.1.1.3.cmml">O</mi><mo id="S7.E8.m1.1.1.2" xref="S7.E8.m1.1.1.2.cmml">⁢</mo><mrow id="S7.E8.m1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.cmml"><mo id="S7.E8.m1.1.1.1.1.2" stretchy="false" xref="S7.E8.m1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E8.m1.1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.cmml"><mi id="S7.E8.m1.1.1.1.1.1.2" xref="S7.E8.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S7.E8.m1.1.1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S7.E8.m1.1.1.1.1.1.3" xref="S7.E8.m1.1.1.1.1.1.3.cmml">s</mi><mo id="S7.E8.m1.1.1.1.1.1.1a" xref="S7.E8.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="S7.E8.m1.1.1.1.1.1.4" xref="S7.E8.m1.1.1.1.1.1.4.cmml"><mi id="S7.E8.m1.1.1.1.1.1.4.2" xref="S7.E8.m1.1.1.1.1.1.4.2.cmml">m</mi><mo id="S7.E8.m1.1.1.1.1.1.4.1" xref="S7.E8.m1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S7.E8.m1.1.1.1.1.1.4.3" xref="S7.E8.m1.1.1.1.1.1.4.3.cmml">v</mi></mrow></mrow><mo id="S7.E8.m1.1.1.1.1.3" stretchy="false" xref="S7.E8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.E8.m1.1b"><apply id="S7.E8.m1.1.1.cmml" xref="S7.E8.m1.1.1"><times id="S7.E8.m1.1.1.2.cmml" xref="S7.E8.m1.1.1.2"></times><ci id="S7.E8.m1.1.1.3.cmml" xref="S7.E8.m1.1.1.3">𝑂</ci><apply id="S7.E8.m1.1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1"><plus id="S7.E8.m1.1.1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1.1.1"></plus><ci id="S7.E8.m1.1.1.1.1.1.2.cmml" xref="S7.E8.m1.1.1.1.1.1.2">𝑐</ci><ci id="S7.E8.m1.1.1.1.1.1.3.cmml" xref="S7.E8.m1.1.1.1.1.1.3">𝑠</ci><apply id="S7.E8.m1.1.1.1.1.1.4.cmml" xref="S7.E8.m1.1.1.1.1.1.4"><times id="S7.E8.m1.1.1.1.1.1.4.1.cmml" xref="S7.E8.m1.1.1.1.1.1.4.1"></times><ci id="S7.E8.m1.1.1.1.1.1.4.2.cmml" xref="S7.E8.m1.1.1.1.1.1.4.2">𝑚</ci><ci id="S7.E8.m1.1.1.1.1.1.4.3.cmml" xref="S7.E8.m1.1.1.1.1.1.4.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E8.m1.1c">O(c+s+mv)</annotation><annotation encoding="application/x-llamapun" id="S7.E8.m1.1d">italic_O ( italic_c + italic_s + italic_m italic_v )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S7.SS4.SSS2.p3">
<p class="ltx_p" id="S7.SS4.SSS2.p3.7">for <math alttext="c" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.1.m1.1"><semantics id="S7.SS4.SSS2.p3.1.m1.1a"><mi id="S7.SS4.SSS2.p3.1.m1.1.1" xref="S7.SS4.SSS2.p3.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.1.m1.1b"><ci id="S7.SS4.SSS2.p3.1.m1.1.1.cmml" xref="S7.SS4.SSS2.p3.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.1.m1.1d">italic_c</annotation></semantics></math> candidates, <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.2.m2.1"><semantics id="S7.SS4.SSS2.p3.2.m2.1a"><mi id="S7.SS4.SSS2.p3.2.m2.1.1" xref="S7.SS4.SSS2.p3.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.2.m2.1b"><ci id="S7.SS4.SSS2.p3.2.m2.1.1.cmml" xref="S7.SS4.SSS2.p3.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.2.m2.1d">italic_m</annotation></semantics></math> product slots and <math alttext="v" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.3.m3.1"><semantics id="S7.SS4.SSS2.p3.3.m3.1a"><mi id="S7.SS4.SSS2.p3.3.m3.1.1" xref="S7.SS4.SSS2.p3.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.3.m3.1b"><ci id="S7.SS4.SSS2.p3.3.m3.1.1.cmml" xref="S7.SS4.SSS2.p3.3.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.3.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.3.m3.1d">italic_v</annotation></semantics></math> product swaps. We first score each of the <math alttext="c" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.4.m4.1"><semantics id="S7.SS4.SSS2.p3.4.m4.1a"><mi id="S7.SS4.SSS2.p3.4.m4.1.1" xref="S7.SS4.SSS2.p3.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.4.m4.1b"><ci id="S7.SS4.SSS2.p3.4.m4.1.1.cmml" xref="S7.SS4.SSS2.p3.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.4.m4.1d">italic_c</annotation></semantics></math> candidates and <math alttext="s" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.5.m5.1"><semantics id="S7.SS4.SSS2.p3.5.m5.1a"><mi id="S7.SS4.SSS2.p3.5.m5.1.1" xref="S7.SS4.SSS2.p3.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.5.m5.1b"><ci id="S7.SS4.SSS2.p3.5.m5.1.1.cmml" xref="S7.SS4.SSS2.p3.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.5.m5.1d">italic_s</annotation></semantics></math> seed products with the RBP value function to produce a PEPF ranking statistic. Upon completion, for each of the available <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.6.m6.1"><semantics id="S7.SS4.SSS2.p3.6.m6.1a"><mi id="S7.SS4.SSS2.p3.6.m6.1.1" xref="S7.SS4.SSS2.p3.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.6.m6.1b"><ci id="S7.SS4.SSS2.p3.6.m6.1.1.cmml" xref="S7.SS4.SSS2.p3.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.6.m6.1d">italic_m</annotation></semantics></math> product slots, we search for <math alttext="v" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p3.7.m7.1"><semantics id="S7.SS4.SSS2.p3.7.m7.1a"><mi id="S7.SS4.SSS2.p3.7.m7.1.1" xref="S7.SS4.SSS2.p3.7.m7.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p3.7.m7.1b"><ci id="S7.SS4.SSS2.p3.7.m7.1.1.cmml" xref="S7.SS4.SSS2.p3.7.m7.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p3.7.m7.1c">v</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p3.7.m7.1d">italic_v</annotation></semantics></math> superior product swaps.</p>
</div>
<div class="ltx_para" id="S7.SS4.SSS2.p4">
<p class="ltx_p" id="S7.SS4.SSS2.p4.2">On the whole, <span class="ltx_text" id="S7.SS4.SSS2.p4.2.1">EdgeRec3D</span> is at worst linear in the number of <math alttext="p" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p4.1.m1.1"><semantics id="S7.SS4.SSS2.p4.1.m1.1a"><mi id="S7.SS4.SSS2.p4.1.m1.1.1" xref="S7.SS4.SSS2.p4.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p4.1.m1.1b"><ci id="S7.SS4.SSS2.p4.1.m1.1.1.cmml" xref="S7.SS4.SSS2.p4.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p4.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p4.1.m1.1d">italic_p</annotation></semantics></math> products and <math alttext="m" class="ltx_Math" display="inline" id="S7.SS4.SSS2.p4.2.m2.1"><semantics id="S7.SS4.SSS2.p4.2.m2.1a"><mi id="S7.SS4.SSS2.p4.2.m2.1.1" xref="S7.SS4.SSS2.p4.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S7.SS4.SSS2.p4.2.m2.1b"><ci id="S7.SS4.SSS2.p4.2.m2.1.1.cmml" xref="S7.SS4.SSS2.p4.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS4.SSS2.p4.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S7.SS4.SSS2.p4.2.m2.1d">italic_m</annotation></semantics></math> product slots. From a complexity perspective, this is far more efficient than the factorial growth of a brute force approach described in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S1.E1" title="Equation 1 ‣ 1. Introduction ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S7.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="359" id="S7.F4.g1" src="extracted/5665233/figs/rbp-dag.png" width="359"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F4.10.5.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S7.F4.8.4" style="font-size:90%;">Representation of the Robust Bayesian Payoff (RBP) model using plate notation. <math alttext="i" class="ltx_Math" display="inline" id="S7.F4.5.1.m1.1"><semantics id="S7.F4.5.1.m1.1b"><mi id="S7.F4.5.1.m1.1.1" xref="S7.F4.5.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.F4.5.1.m1.1c"><ci id="S7.F4.5.1.m1.1.1.cmml" xref="S7.F4.5.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.5.1.m1.1d">i</annotation><annotation encoding="application/x-llamapun" id="S7.F4.5.1.m1.1e">italic_i</annotation></semantics></math> indexes product, <math alttext="k" class="ltx_Math" display="inline" id="S7.F4.6.2.m2.1"><semantics id="S7.F4.6.2.m2.1b"><mi id="S7.F4.6.2.m2.1.1" xref="S7.F4.6.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S7.F4.6.2.m2.1c"><ci id="S7.F4.6.2.m2.1.1.cmml" xref="S7.F4.6.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.6.2.m2.1d">k</annotation><annotation encoding="application/x-llamapun" id="S7.F4.6.2.m2.1e">italic_k</annotation></semantics></math> indexes cluster, and <math alttext="l" class="ltx_Math" display="inline" id="S7.F4.7.3.m3.1"><semantics id="S7.F4.7.3.m3.1b"><mi id="S7.F4.7.3.m3.1.1" xref="S7.F4.7.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S7.F4.7.3.m3.1c"><ci id="S7.F4.7.3.m3.1.1.cmml" xref="S7.F4.7.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.7.3.m3.1d">l</annotation><annotation encoding="application/x-llamapun" id="S7.F4.7.3.m3.1e">italic_l</annotation></semantics></math> indexes store. Circles indicate random variables and squares indicate hyperparameters. The <math alttext="\beta" class="ltx_Math" display="inline" id="S7.F4.8.4.m4.1"><semantics id="S7.F4.8.4.m4.1b"><mi id="S7.F4.8.4.m4.1.1" xref="S7.F4.8.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S7.F4.8.4.m4.1c"><ci id="S7.F4.8.4.m4.1.1.cmml" xref="S7.F4.8.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.8.4.m4.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S7.F4.8.4.m4.1e">italic_β</annotation></semantics></math> parameters describe how expected payoff changes as allocated product quantity increases and have hierarchical structure. This hierarchy facilitates store- and cluster-level preference estimation. The variance parameters are not expected to vary across stores or clusters and are estimated universally for each product.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S7.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.5. </span>Wall-clock time of <span class="ltx_text" id="S7.SS5.1.1">EdgeRec3D</span>
</h3>
<div class="ltx_para" id="S7.SS5.p1">
<p class="ltx_p" id="S7.SS5.p1.1">Figure 2(b) provides a physical architecture diagram of EdgeRec3D. The components that run on the edge layer (i.e., mobile device) return results in real-time. Specifically, the sales capture and state observation are computed with CountNet3D on the Apple Neural Engine and return results in  200ms. Additionally, once the candidates are queried from a remote server, the heuristic search algorithm is run in real-time and returns results in ¡100ms.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.6. </span>Training of Visual Layer</h3>
<div class="ltx_para" id="S7.SS6.p1">
<p class="ltx_p" id="S7.SS6.p1.1">The visual perception layer of <span class="ltx_text" id="S7.SS6.p1.1.1">EdgeRec3D</span> is built on top of CountNet3D <cite class="ltx_cite ltx_citemacro_citep">(Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib27" title="">2023</a>)</cite>, a regression-based neural network that processes images and LiDAR scans to predict finegrained object counts. CountNet3D uses a mature 2D object detector, such as YOLOv5 <cite class="ltx_cite ltx_citemacro_citep">(Jocher et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib29" title="">2022</a>)</cite> to propose 3D regions around known objects. It then uses a PointNet-style architecture <cite class="ltx_cite ltx_citemacro_citep">(Qi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib42" title="">2017</a>)</cite> to count objects to process the point cloud within each region.</p>
</div>
<div class="ltx_para" id="S7.SS6.p2">
<p class="ltx_p" id="S7.SS6.p2.1">CountNet3D is trained in two stages. First, the YOLOv5 model is trained on image data alone to detect finegrained beverage products. This model consists of 567 fine grained classes. Here, fine grained class refers to a very specific product classification such as <span class="ltx_text ltx_font_typewriter" id="S7.SS6.p2.1.1">coca_cola_20oz_bottle</span> or <span class="ltx_text ltx_font_typewriter" id="S7.SS6.p2.1.2">coca_cola_1L_bottle</span>. Detection results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.T8" title="Table 8 ‣ 7.6. Training of Visual Layer ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">8</span></a>. Second, the YOLOv5 weights are fixed and the network processing the point cloud is trained to regress object counts in a focused sub-volume of the scene. The predictions are aggregated across sub-volumes to the class-level to output a count estimate for each product. The object count regression results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.T9" title="Table 9 ‣ 7.6. Training of Visual Layer ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">9</span></a>. Example outputs of our CountNet3D implementation are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S7.F5" title="Figure 5 ‣ 7.6. Training of Visual Layer ‣ 7. Appendix ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S7.SS6.p3">
<p class="ltx_p" id="S7.SS6.p3.1">The visual layer is trained with a proprietary dataset comprised annotated of images and point clouds. Each point cloud is densely labelled; small regions are annotated with the product type and ground truth object counts. The dataset construction is very similar to the open source version in <cite class="ltx_cite ltx_citemacro_citep">(Jenkins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib27" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_table" id="S7.T8">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T8.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T8.2.1.1">
<td class="ltx_td" id="S7.T8.2.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T8.2.1.1.2">mAP50-95</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T8.2.1.1.3">mAP50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T8.2.1.1.4">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T8.2.1.1.5">Recall</th>
</tr>
<tr class="ltx_tr" id="S7.T8.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T8.2.2.2.1">YoloV5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T8.2.2.2.2">0.793</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T8.2.2.2.3">0.927</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T8.2.2.2.4">0.897</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T8.2.2.2.5">0.901</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T8.3.1.1" style="font-size:90%;">Table 8</span>. </span><span class="ltx_text" id="S7.T8.4.2" style="font-size:90%;">YoloV5 training results on 567 finegrained classes.</span></figcaption>
</figure>
<figure class="ltx_table" id="S7.T9">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T9.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T9.2.1.1">
<td class="ltx_td" id="S7.T9.2.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T9.2.1.1.2">MAE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T9.2.1.1.3">MSE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S7.T9.2.1.1.4">MAPE</th>
</tr>
<tr class="ltx_tr" id="S7.T9.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T9.2.2.2.1">CountNet3D</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T9.2.2.2.2">1.280</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T9.2.2.2.3">5.672</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T9.2.2.2.4">0.077</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T9.3.1.1" style="font-size:90%;">Table 9</span>. </span><span class="ltx_text" id="S7.T9.4.2" style="font-size:90%;">Object count regression results from CountNet3D. We report Mean Absolute Error (MAE), Mean Squared Error (MAE) and Median Absolute Percentage Error (MAPE).</span></figcaption>
</figure>
<figure class="ltx_figure" id="S7.F5">
<table class="ltx_tabular ltx_align_middle" id="S7.F5.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.F5.3.3">
<td class="ltx_td ltx_align_center" id="S7.F5.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="349" id="S7.F5.1.1.1.g1" src="x4.png" width="232"/></td>
<td class="ltx_td ltx_align_center" id="S7.F5.2.2.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="349" id="S7.F5.2.2.2.g1" src="x5.png" width="232"/></td>
<td class="ltx_td ltx_align_center" id="S7.F5.3.3.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="349" id="S7.F5.3.3.3.g1" src="x6.png" width="232"/></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.6.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text ltx_font_bold" id="S7.F5.7.2" style="font-size:90%;">Example predictions from CountNet3D on real-world data<span class="ltx_text ltx_font_medium" id="S7.F5.7.2.1">. (Best viewed in color with zoom in). For each scene we show the image, the PointBeam proposals, the ground truth, and the predicted counts. We also display the scene-level MAPE (after rounding). Each beam is given a randomly generated color to highlight the beam regions.</span></span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8. </span>Additional Experiments and Results</h2>
<figure class="ltx_figure" id="S8.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="S8.F6.g1" src="x7.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S8.F6.3.2" style="font-size:90%;">Mean treatment effect as a function of recommendation compliance.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S8.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.1. </span>Details of Offline Experiments</h3>
<section class="ltx_subsubsection" id="S8.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">8.1.1. </span>Dataset Construction</h4>
<div class="ltx_para" id="S8.SS1.SSS1.p1">
<p class="ltx_p" id="S8.SS1.SSS1.p1.1">As discussed in the paper, we use the offline policy evaluator proposed by <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#bib.bib33" title="">2011</a>)</cite> to benchmark different search algorithms against a static dataset. The dataset is collected from user logs taken from the control group in experiment #1. The control group saw no recommendations during the A/B test is therefore unbiased w.r.t the search algorithms benchmarked.</p>
</div>
<div class="ltx_para" id="S8.SS1.SSS1.p2">
<p class="ltx_p" id="S8.SS1.SSS1.p2.1">For all offline and online experiments, we use data collected by our system. The datasets in our offline experiments and online deployment studies are all comprised of longitudinal data describing daily sales for each product on display. The datasets all have the following schema:</p>
</div>
<div class="ltx_para" id="S8.SS1.SSS1.p3">
<ul class="ltx_itemize" id="S8.I1">
<li class="ltx_item" id="S8.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i1.p1">
<p class="ltx_p" id="S8.I1.i1.p1.1">store id: identifier of the store</p>
</div>
</li>
<li class="ltx_item" id="S8.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i2.p1">
<p class="ltx_p" id="S8.I1.i2.p1.1">display id: identifier of the product display</p>
</div>
</li>
<li class="ltx_item" id="S8.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i3.p1">
<p class="ltx_p" id="S8.I1.i3.p1.1">scanned datetime: timestamp of the user’s interaction with the display</p>
</div>
</li>
<li class="ltx_item" id="S8.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i4.p1">
<p class="ltx_p" id="S8.I1.i4.p1.1">product id: identifier of observed product</p>
</div>
</li>
<li class="ltx_item" id="S8.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i5.p1">
<p class="ltx_p" id="S8.I1.i5.p1.1">timedelta: difference (in hours) since previous interaction with the display</p>
</div>
</li>
<li class="ltx_item" id="S8.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S8.I1.i6.p1">
<p class="ltx_p" id="S8.I1.i6.p1.1">sales: estimated numbers of units sales (from CountNet3D)</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S8.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">8.1.2. </span>Benchmarks</h4>
<div class="ltx_para" id="S8.SS1.SSS2.p1">
<p class="ltx_p" id="S8.SS1.SSS2.p1.2">For the <math alttext="\epsilon" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p1.1.m1.1"><semantics id="S8.SS1.SSS2.p1.1.m1.1a"><mi id="S8.SS1.SSS2.p1.1.m1.1.1" xref="S8.SS1.SSS2.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p1.1.m1.1b"><ci id="S8.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S8.SS1.SSS2.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p1.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p1.1.m1.1d">italic_ϵ</annotation></semantics></math>-greedy implementation, we set <math alttext="\epsilon" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p1.2.m2.1"><semantics id="S8.SS1.SSS2.p1.2.m2.1a"><mi id="S8.SS1.SSS2.p1.2.m2.1.1" xref="S8.SS1.SSS2.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p1.2.m2.1b"><ci id="S8.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S8.SS1.SSS2.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p1.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p1.2.m2.1d">italic_ϵ</annotation></semantics></math> = 0.1. For the genetic algorithm we randomly marry 70% of pairs together to form a new configuration, and choose a random action 30% of the time.</p>
</div>
<div class="ltx_para" id="S8.SS1.SSS2.p2">
<p class="ltx_p" id="S8.SS1.SSS2.p2.1">Both Deep Ensembles and MOPO rely on ensembles of neural networks to learn a probabilistic model of the environment. In each case, we train 5 fully connected neural networks with three hidden layers with dimensions <math alttext="[256,256,256]" class="ltx_Math" display="inline" id="S8.SS1.SSS2.p2.1.m1.3"><semantics id="S8.SS1.SSS2.p2.1.m1.3a"><mrow id="S8.SS1.SSS2.p2.1.m1.3.4.2" xref="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml"><mo id="S8.SS1.SSS2.p2.1.m1.3.4.2.1" stretchy="false" xref="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml">[</mo><mn id="S8.SS1.SSS2.p2.1.m1.1.1" xref="S8.SS1.SSS2.p2.1.m1.1.1.cmml">256</mn><mo id="S8.SS1.SSS2.p2.1.m1.3.4.2.2" xref="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml">,</mo><mn id="S8.SS1.SSS2.p2.1.m1.2.2" xref="S8.SS1.SSS2.p2.1.m1.2.2.cmml">256</mn><mo id="S8.SS1.SSS2.p2.1.m1.3.4.2.3" xref="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml">,</mo><mn id="S8.SS1.SSS2.p2.1.m1.3.3" xref="S8.SS1.SSS2.p2.1.m1.3.3.cmml">256</mn><mo id="S8.SS1.SSS2.p2.1.m1.3.4.2.4" stretchy="false" xref="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.SSS2.p2.1.m1.3b"><list id="S8.SS1.SSS2.p2.1.m1.3.4.1.cmml" xref="S8.SS1.SSS2.p2.1.m1.3.4.2"><cn id="S8.SS1.SSS2.p2.1.m1.1.1.cmml" type="integer" xref="S8.SS1.SSS2.p2.1.m1.1.1">256</cn><cn id="S8.SS1.SSS2.p2.1.m1.2.2.cmml" type="integer" xref="S8.SS1.SSS2.p2.1.m1.2.2">256</cn><cn id="S8.SS1.SSS2.p2.1.m1.3.3.cmml" type="integer" xref="S8.SS1.SSS2.p2.1.m1.3.3">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.SSS2.p2.1.m1.3c">[256,256,256]</annotation><annotation encoding="application/x-llamapun" id="S8.SS1.SSS2.p2.1.m1.3d">[ 256 , 256 , 256 ]</annotation></semantics></math> and 135 input features. The input features include a one hot vector for each product, the number of observed product facings, and day of the week features. Each network is randomly initialized and trained for 1000 epochs to minimize Gaussian negative log likelihood loss. In the case of the Deep Ensemble we use the same heuristic search algorithm desribed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#alg2" title="Algorithm 2 ‣ 3.5. Heuristic Search ‣ 3. Method ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">2</span></a>. For MOPO, we perform 5 rollouts with the dynamics ensemble at each step, and update a tabular policy with a buffer of real observations and rollouts.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S8.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.2. </span>Details of Online Experiments</h3>
<section class="ltx_subsubsection" id="S8.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">8.2.1. </span>Users</h4>
<figure class="ltx_table" id="S8.T10">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T10.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S8.T10.1.2.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T10.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S8.T10.1.2.1.2.1">Control</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S8.T10.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S8.T10.1.2.1.3.1">Treatment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T10.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S8.T10.1.2.1.4.1">Treat. - Control</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T10.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T10.1.3.1.1">Pre</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T10.1.3.1.2">5.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S8.T10.1.3.1.3">5.82</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T10.1.3.1.4">0.42</td>
</tr>
<tr class="ltx_tr" id="S8.T10.1.4.2">
<td class="ltx_td ltx_align_center" id="S8.T10.1.4.2.1">Post</td>
<td class="ltx_td ltx_align_center" id="S8.T10.1.4.2.2">4.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T10.1.4.2.3">6.77</td>
<td class="ltx_td ltx_align_center" id="S8.T10.1.4.2.4">2.37</td>
</tr>
<tr class="ltx_tr" id="S8.T10.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T10.1.1.2">Change</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T10.1.1.3">-1.00 (-18.61%)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S8.T10.1.1.4">+0.95 (+16.42%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T10.1.1.1"><math alttext="\textbf{+1.95 (+35.03\%)}^{\ast\ast}" class="ltx_Math" display="inline" id="S8.T10.1.1.1.m1.1"><semantics id="S8.T10.1.1.1.m1.1a"><msup id="S8.T10.1.1.1.m1.1.1" xref="S8.T10.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S8.T10.1.1.1.m1.1.1.2" xref="S8.T10.1.1.1.m1.1.1.2a.cmml">+1.95 (+35.03%)</mtext><mrow id="S8.T10.1.1.1.m1.1.1.3" xref="S8.T10.1.1.1.m1.1.1.3.cmml"><mi id="S8.T10.1.1.1.m1.1.1.3.2" xref="S8.T10.1.1.1.m1.1.1.3.2.cmml"></mi><mo id="S8.T10.1.1.1.m1.1.1.3.1" lspace="0.222em" rspace="0em" xref="S8.T10.1.1.1.m1.1.1.3.1.cmml">∗</mo><mo id="S8.T10.1.1.1.m1.1.1.3.3" lspace="0em" xref="S8.T10.1.1.1.m1.1.1.3.3.cmml">∗</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S8.T10.1.1.1.m1.1b"><apply id="S8.T10.1.1.1.m1.1.1.cmml" xref="S8.T10.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S8.T10.1.1.1.m1.1.1.1.cmml" xref="S8.T10.1.1.1.m1.1.1">superscript</csymbol><ci id="S8.T10.1.1.1.m1.1.1.2a.cmml" xref="S8.T10.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S8.T10.1.1.1.m1.1.1.2.cmml" xref="S8.T10.1.1.1.m1.1.1.2">+1.95 (+35.03%)</mtext></ci><apply id="S8.T10.1.1.1.m1.1.1.3.cmml" xref="S8.T10.1.1.1.m1.1.1.3"><ci id="S8.T10.1.1.1.m1.1.1.3.1.cmml" xref="S8.T10.1.1.1.m1.1.1.3.1">∗</ci><csymbol cd="latexml" id="S8.T10.1.1.1.m1.1.1.3.2.cmml" xref="S8.T10.1.1.1.m1.1.1.3.2">absent</csymbol><ci id="S8.T10.1.1.1.m1.1.1.3.3.cmml" xref="S8.T10.1.1.1.m1.1.1.3.3">∗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T10.1.1.1.m1.1c">\textbf{+1.95 (+35.03\%)}^{\ast\ast}</annotation><annotation encoding="application/x-llamapun" id="S8.T10.1.1.1.m1.1d">+1.95 (+35.03%) start_POSTSUPERSCRIPT ∗ ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S8.T10.8.3.1" style="font-size:90%;">Table 10</span>. </span><span class="ltx_text" id="S8.T10.5.2" style="font-size:90%;">Experiment 1 Difference-in-Difference Results. We present daily average products sold, and their percentage changes. We use <sup class="ltx_sup" id="S8.T10.5.2.1"><span class="ltx_text ltx_font_italic" id="S8.T10.5.2.1.1">∗∗</span></sup> to denote significance at <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S8.T10.5.2.m2.1"><semantics id="S8.T10.5.2.m2.1b"><mrow id="S8.T10.5.2.m2.1.1" xref="S8.T10.5.2.m2.1.1.cmml"><mi id="S8.T10.5.2.m2.1.1.2" xref="S8.T10.5.2.m2.1.1.2.cmml">α</mi><mo id="S8.T10.5.2.m2.1.1.1" xref="S8.T10.5.2.m2.1.1.1.cmml">=</mo><mn id="S8.T10.5.2.m2.1.1.3" xref="S8.T10.5.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T10.5.2.m2.1c"><apply id="S8.T10.5.2.m2.1.1.cmml" xref="S8.T10.5.2.m2.1.1"><eq id="S8.T10.5.2.m2.1.1.1.cmml" xref="S8.T10.5.2.m2.1.1.1"></eq><ci id="S8.T10.5.2.m2.1.1.2.cmml" xref="S8.T10.5.2.m2.1.1.2">𝛼</ci><cn id="S8.T10.5.2.m2.1.1.3.cmml" type="float" xref="S8.T10.5.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T10.5.2.m2.1d">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S8.T10.5.2.m2.1e">italic_α = 0.05</annotation></semantics></math>.</span></figcaption>
</figure>
<div class="ltx_para" id="S8.SS2.SSS1.p1">
<p class="ltx_p" id="S8.SS2.SSS1.p1.1">The core user in our online experiments is referred to in the industry as a merchandiser. His or her primary function is to ensure that shelves are replenished with product. In some cases, they are asked to make decisions about which products to place on shelves to improve sales. However, this process is usually driven by intuition, and most merchandisers lack concrete data to inform their decisions. Typically, the merchandiser surveys and restocks each display in a store on a daily basis.</p>
</div>
<div class="ltx_para" id="S8.SS2.SSS1.p2">
<p class="ltx_p" id="S8.SS2.SSS1.p2.1">Users interact with <span class="ltx_text" id="S8.SS2.SSS1.p2.1.1">EdgeRec3D</span> through a mobile application while they are merchandising a store. As the user replenishes product each day, the merchandiser is instructed to view the mobile app to get suggested, or recommended, product restock decisions. The output of <span class="ltx_text" id="S8.SS2.SSS1.p2.1.2">EdgeRec3D</span> is a set of products and their quantities to put on the shelf. One important aspect of this real-world recommendation problem is that the merchandiser has the option to execute or skip the recommendation. For example, a merchandiser may be rushed to fill a large number of shelves and skip the recommended action all together. This motivates our use of a compliance statistics <math alttext="\rho." class="ltx_Math" display="inline" id="S8.SS2.SSS1.p2.1.m1.1"><semantics id="S8.SS2.SSS1.p2.1.m1.1a"><mrow id="S8.SS2.SSS1.p2.1.m1.1.2.2"><mi id="S8.SS2.SSS1.p2.1.m1.1.1" xref="S8.SS2.SSS1.p2.1.m1.1.1.cmml">ρ</mi><mo id="S8.SS2.SSS1.p2.1.m1.1.2.2.1" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS2.SSS1.p2.1.m1.1b"><ci id="S8.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S8.SS2.SSS1.p2.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.SSS1.p2.1.m1.1c">\rho.</annotation><annotation encoding="application/x-llamapun" id="S8.SS2.SSS1.p2.1.m1.1d">italic_ρ .</annotation></semantics></math></p>
</div>
<figure class="ltx_table" id="S8.T11">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T11.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T11.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S8.T11.1.2.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T11.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S8.T11.1.2.1.2.1">Control</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S8.T11.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S8.T11.1.2.1.3.1">Treatment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T11.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S8.T11.1.2.1.4.1">Treat. - Control</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T11.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T11.1.3.1.1">Pre</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T11.1.3.1.2">12.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S8.T11.1.3.1.3">9.50</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T11.1.3.1.4">-3.24</td>
</tr>
<tr class="ltx_tr" id="S8.T11.1.4.2">
<td class="ltx_td ltx_align_center" id="S8.T11.1.4.2.1">Post</td>
<td class="ltx_td ltx_align_center" id="S8.T11.1.4.2.2">10.86</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S8.T11.1.4.2.3">10.74</td>
<td class="ltx_td ltx_align_center" id="S8.T11.1.4.2.4">-0.12</td>
</tr>
<tr class="ltx_tr" id="S8.T11.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T11.1.1.2">Change</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T11.1.1.3">-1.88 (-14.76%)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S8.T11.1.1.4">+1.24 (+13.02%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T11.1.1.1"><math alttext="\textbf{+3.12 (+27.78\%)}^{\ast\ast}" class="ltx_Math" display="inline" id="S8.T11.1.1.1.m1.1"><semantics id="S8.T11.1.1.1.m1.1a"><msup id="S8.T11.1.1.1.m1.1.1" xref="S8.T11.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S8.T11.1.1.1.m1.1.1.2" xref="S8.T11.1.1.1.m1.1.1.2a.cmml">+3.12 (+27.78%)</mtext><mrow id="S8.T11.1.1.1.m1.1.1.3" xref="S8.T11.1.1.1.m1.1.1.3.cmml"><mi id="S8.T11.1.1.1.m1.1.1.3.2" xref="S8.T11.1.1.1.m1.1.1.3.2.cmml"></mi><mo id="S8.T11.1.1.1.m1.1.1.3.1" lspace="0.222em" rspace="0em" xref="S8.T11.1.1.1.m1.1.1.3.1.cmml">∗</mo><mo id="S8.T11.1.1.1.m1.1.1.3.3" lspace="0em" xref="S8.T11.1.1.1.m1.1.1.3.3.cmml">∗</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S8.T11.1.1.1.m1.1b"><apply id="S8.T11.1.1.1.m1.1.1.cmml" xref="S8.T11.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S8.T11.1.1.1.m1.1.1.1.cmml" xref="S8.T11.1.1.1.m1.1.1">superscript</csymbol><ci id="S8.T11.1.1.1.m1.1.1.2a.cmml" xref="S8.T11.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S8.T11.1.1.1.m1.1.1.2.cmml" xref="S8.T11.1.1.1.m1.1.1.2">+3.12 (+27.78%)</mtext></ci><apply id="S8.T11.1.1.1.m1.1.1.3.cmml" xref="S8.T11.1.1.1.m1.1.1.3"><ci id="S8.T11.1.1.1.m1.1.1.3.1.cmml" xref="S8.T11.1.1.1.m1.1.1.3.1">∗</ci><csymbol cd="latexml" id="S8.T11.1.1.1.m1.1.1.3.2.cmml" xref="S8.T11.1.1.1.m1.1.1.3.2">absent</csymbol><ci id="S8.T11.1.1.1.m1.1.1.3.3.cmml" xref="S8.T11.1.1.1.m1.1.1.3.3">∗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T11.1.1.1.m1.1c">\textbf{+3.12 (+27.78\%)}^{\ast\ast}</annotation><annotation encoding="application/x-llamapun" id="S8.T11.1.1.1.m1.1d">+3.12 (+27.78%) start_POSTSUPERSCRIPT ∗ ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S8.T11.8.3.1" style="font-size:90%;">Table 11</span>. </span><span class="ltx_text" id="S8.T11.5.2" style="font-size:90%;">Experiment 2 Difference-in-Difference Results (High Compliance Group). We present daily average products sold, and their percentage changes. We use <sup class="ltx_sup" id="S8.T11.5.2.1"><span class="ltx_text ltx_font_italic" id="S8.T11.5.2.1.1">∗∗</span></sup> to denote significance at <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S8.T11.5.2.m2.1"><semantics id="S8.T11.5.2.m2.1b"><mrow id="S8.T11.5.2.m2.1.1" xref="S8.T11.5.2.m2.1.1.cmml"><mi id="S8.T11.5.2.m2.1.1.2" xref="S8.T11.5.2.m2.1.1.2.cmml">α</mi><mo id="S8.T11.5.2.m2.1.1.1" xref="S8.T11.5.2.m2.1.1.1.cmml">=</mo><mn id="S8.T11.5.2.m2.1.1.3" xref="S8.T11.5.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T11.5.2.m2.1c"><apply id="S8.T11.5.2.m2.1.1.cmml" xref="S8.T11.5.2.m2.1.1"><eq id="S8.T11.5.2.m2.1.1.1.cmml" xref="S8.T11.5.2.m2.1.1.1"></eq><ci id="S8.T11.5.2.m2.1.1.2.cmml" xref="S8.T11.5.2.m2.1.1.2">𝛼</ci><cn id="S8.T11.5.2.m2.1.1.3.cmml" type="float" xref="S8.T11.5.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T11.5.2.m2.1d">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S8.T11.5.2.m2.1e">italic_α = 0.05</annotation></semantics></math></span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S8.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">8.2.2. </span>User Workflow</h4>
<div class="ltx_para" id="S8.SS2.SSS2.p1">
<p class="ltx_p" id="S8.SS2.SSS2.p1.1">The user workflow is fairly straightforward and integrates into their existing merchandising responsibilities. Prior to restocking the shelf, the user performs the pre-scan to get an updated inventory measurement and capture the current state, <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S8.SS2.SSS2.p1.1.m1.1"><semantics id="S8.SS2.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S8.SS2.SSS2.p1.1.m1.1.1" xref="S8.SS2.SSS2.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.SSS2.p1.1.m1.1b"><ci id="S8.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S8.SS2.SSS2.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.SSS2.p1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S8.SS2.SSS2.p1.1.m1.1d">caligraphic_S</annotation></semantics></math>. The user then views the app, and queries the latest recommendations. At this point the user chooses whether or not to implement the recommendations and restocks the display. Finally the user completes the task by performing a post-scan and setting a baseline inventory.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S8.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.3. </span>RBP Toy Experiments</h3>
<div class="ltx_para" id="S8.SS3.p1">
<p class="ltx_p" id="S8.SS3.p1.1">We claim that RBP has three advantages over non-Bayesian approaches. First, RBP is more robust to outliers and data noise. This is due to the robust, Laplacian priors on the store-level <math alttext="\beta_{i,l,k}" class="ltx_Math" display="inline" id="S8.SS3.p1.1.m1.3"><semantics id="S8.SS3.p1.1.m1.3a"><msub id="S8.SS3.p1.1.m1.3.4" xref="S8.SS3.p1.1.m1.3.4.cmml"><mi id="S8.SS3.p1.1.m1.3.4.2" xref="S8.SS3.p1.1.m1.3.4.2.cmml">β</mi><mrow id="S8.SS3.p1.1.m1.3.3.3.5" xref="S8.SS3.p1.1.m1.3.3.3.4.cmml"><mi id="S8.SS3.p1.1.m1.1.1.1.1" xref="S8.SS3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S8.SS3.p1.1.m1.3.3.3.5.1" xref="S8.SS3.p1.1.m1.3.3.3.4.cmml">,</mo><mi id="S8.SS3.p1.1.m1.2.2.2.2" xref="S8.SS3.p1.1.m1.2.2.2.2.cmml">l</mi><mo id="S8.SS3.p1.1.m1.3.3.3.5.2" xref="S8.SS3.p1.1.m1.3.3.3.4.cmml">,</mo><mi id="S8.SS3.p1.1.m1.3.3.3.3" xref="S8.SS3.p1.1.m1.3.3.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.SS3.p1.1.m1.3b"><apply id="S8.SS3.p1.1.m1.3.4.cmml" xref="S8.SS3.p1.1.m1.3.4"><csymbol cd="ambiguous" id="S8.SS3.p1.1.m1.3.4.1.cmml" xref="S8.SS3.p1.1.m1.3.4">subscript</csymbol><ci id="S8.SS3.p1.1.m1.3.4.2.cmml" xref="S8.SS3.p1.1.m1.3.4.2">𝛽</ci><list id="S8.SS3.p1.1.m1.3.3.3.4.cmml" xref="S8.SS3.p1.1.m1.3.3.3.5"><ci id="S8.SS3.p1.1.m1.1.1.1.1.cmml" xref="S8.SS3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S8.SS3.p1.1.m1.2.2.2.2.cmml" xref="S8.SS3.p1.1.m1.2.2.2.2">𝑙</ci><ci id="S8.SS3.p1.1.m1.3.3.3.3.cmml" xref="S8.SS3.p1.1.m1.3.3.3.3">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p1.1.m1.3c">\beta_{i,l,k}</annotation><annotation encoding="application/x-llamapun" id="S8.SS3.p1.1.m1.3d">italic_β start_POSTSUBSCRIPT italic_i , italic_l , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> parameters. Laplacian priors are known to be more robust to noise and outliers than Gaussian priors. Second, RBP can effectively trade-off information from the cluster and the store through it’s hierarchical structure. As more data is acquired within a store, RBP discounts information from other stores in the cluster. Conversely, linear regression and neural nets equally weight all data, increasing store-level error. Third, posterior uncertainty decreases as more data is acquired. We test these three claims in a toy environment on simulated data where we know the ground truth parameter values and can manipulate observation noise and dataset size. We report our results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F7" title="Figure 7 ‣ 8.3. RBP Toy Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div class="ltx_para" id="S8.SS3.p2">
<p class="ltx_p" id="S8.SS3.p2.2">We see all three claims validated. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F7" title="Figure 7 ‣ 8.3. RBP Toy Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a> (a), we see RBP is more robust as noise is increased. We can also control robustness through the hyperparameter <math alttext="\sigma_{0}" class="ltx_Math" display="inline" id="S8.SS3.p2.1.m1.1"><semantics id="S8.SS3.p2.1.m1.1a"><msub id="S8.SS3.p2.1.m1.1.1" xref="S8.SS3.p2.1.m1.1.1.cmml"><mi id="S8.SS3.p2.1.m1.1.1.2" xref="S8.SS3.p2.1.m1.1.1.2.cmml">σ</mi><mn id="S8.SS3.p2.1.m1.1.1.3" xref="S8.SS3.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S8.SS3.p2.1.m1.1b"><apply id="S8.SS3.p2.1.m1.1.1.cmml" xref="S8.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S8.SS3.p2.1.m1.1.1.1.cmml" xref="S8.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S8.SS3.p2.1.m1.1.1.2.cmml" xref="S8.SS3.p2.1.m1.1.1.2">𝜎</ci><cn id="S8.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S8.SS3.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p2.1.m1.1c">\sigma_{0}</annotation><annotation encoding="application/x-llamapun" id="S8.SS3.p2.1.m1.1d">italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{1}" class="ltx_Math" display="inline" id="S8.SS3.p2.2.m2.1"><semantics id="S8.SS3.p2.2.m2.1a"><msub id="S8.SS3.p2.2.m2.1.1" xref="S8.SS3.p2.2.m2.1.1.cmml"><mi id="S8.SS3.p2.2.m2.1.1.2" xref="S8.SS3.p2.2.m2.1.1.2.cmml">σ</mi><mn id="S8.SS3.p2.2.m2.1.1.3" xref="S8.SS3.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S8.SS3.p2.2.m2.1b"><apply id="S8.SS3.p2.2.m2.1.1.cmml" xref="S8.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S8.SS3.p2.2.m2.1.1.1.cmml" xref="S8.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S8.SS3.p2.2.m2.1.1.2.cmml" xref="S8.SS3.p2.2.m2.1.1.2">𝜎</ci><cn id="S8.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S8.SS3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS3.p2.2.m2.1c">\sigma_{1}</annotation><annotation encoding="application/x-llamapun" id="S8.SS3.p2.2.m2.1d">italic_σ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> parameters. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F7" title="Figure 7 ‣ 8.3. RBP Toy Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a> (b) we see that RBP better learns store-level preferences, and the error decreases as a function of more in-store data. Conversely, linear regression flat lines and cannot weigh store-level data against cluster-level data. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F7" title="Figure 7 ‣ 8.3. RBP Toy Experiments ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">7</span></a> (c), we see the posterior uncertainty decreases as more data is observed.</p>
</div>
<figure class="ltx_figure" id="S8.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S8.F7.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.F7.3.3">
<td class="ltx_td ltx_align_center" id="S8.F7.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="187" id="S8.F7.1.1.1.g1" src="x8.png" width="249"/></td>
<td class="ltx_td ltx_align_center" id="S8.F7.2.2.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="187" id="S8.F7.2.2.2.g1" src="x9.png" width="249"/></td>
<td class="ltx_td ltx_align_center" id="S8.F7.3.3.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="187" id="S8.F7.3.3.3.g1" src="x10.png" width="249"/></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S8.F7.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.F7.7.1.1">
<td class="ltx_td ltx_align_center" id="S8.F7.7.1.1.1" style="padding-left:20.0pt;padding-right:20.0pt;">      <span class="ltx_text" id="S8.F7.7.1.1.1.1" style="font-size:90%;">(a) Robustness to Outliers</span></td>
<td class="ltx_td ltx_align_center" id="S8.F7.7.1.1.2" style="padding-left:20.0pt;padding-right:20.0pt;">      <span class="ltx_text" id="S8.F7.7.1.1.2.1" style="font-size:90%;">(b) Sample size of store-level error</span></td>
<td class="ltx_td ltx_align_center" id="S8.F7.7.1.1.3" style="padding-left:20.0pt;padding-right:20.0pt;">      <span class="ltx_text" id="S8.F7.7.1.1.3.1" style="font-size:90%;">(c) Sample size on Uncertainty</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F7.8.2.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S8.F7.5.1" style="font-size:90%;">Evaluation of the Robust Bayesian Payoff (RBP) model on a toy dataset. We demonstrate that RBP has three attractive properties over non-Bayesian approaches: (a) RBP is more robust to outliers. As the data noise is increased, RBP is more robust than linear regression; robustness increases as the prior strength increases (smaller <math alttext="\sigma" class="ltx_Math" display="inline" id="S8.F7.5.1.m1.1"><semantics id="S8.F7.5.1.m1.1b"><mi id="S8.F7.5.1.m1.1.1" xref="S8.F7.5.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S8.F7.5.1.m1.1c"><ci id="S8.F7.5.1.m1.1.1.cmml" xref="S8.F7.5.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.F7.5.1.m1.1d">\sigma</annotation><annotation encoding="application/x-llamapun" id="S8.F7.5.1.m1.1e">italic_σ</annotation></semantics></math>). (b) As more data is acquired within a store, RBP discounts information from other stores in the cluster. Linear Regression equally weights all data, increasing store-level error. (c) In general, posterior uncertainty decreases as more data is acquired. </span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S8.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.4. </span>Selecting the Number of Clusters</h3>
<div class="ltx_para" id="S8.SS4.p1">
<p class="ltx_p" id="S8.SS4.p1.5">We choose the number of clusters using an auxiliary, 180-day snapshot of store-level sales for 897 different products and 2,548 stores. We start by choosing a proposed number of clusters <math alttext="k" class="ltx_Math" display="inline" id="S8.SS4.p1.1.m1.1"><semantics id="S8.SS4.p1.1.m1.1a"><mi id="S8.SS4.p1.1.m1.1.1" xref="S8.SS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S8.SS4.p1.1.m1.1b"><ci id="S8.SS4.p1.1.m1.1.1.cmml" xref="S8.SS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S8.SS4.p1.1.m1.1d">italic_k</annotation></semantics></math>. We then run SpAGMM + K-means to generate <math alttext="k" class="ltx_Math" display="inline" id="S8.SS4.p1.2.m2.1"><semantics id="S8.SS4.p1.2.m2.1a"><mi id="S8.SS4.p1.2.m2.1.1" xref="S8.SS4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S8.SS4.p1.2.m2.1b"><ci id="S8.SS4.p1.2.m2.1.1.cmml" xref="S8.SS4.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS4.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S8.SS4.p1.2.m2.1d">italic_k</annotation></semantics></math> clusters of stores and group the store-level sales data by cluster. For each product we then perform a simple Analysis of Variance (ANOVA) test to determine if the product preferences vary across clusters. If the difference across groups is statistically meaningful (<math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S8.SS4.p1.3.m3.1"><semantics id="S8.SS4.p1.3.m3.1a"><mrow id="S8.SS4.p1.3.m3.1.1" xref="S8.SS4.p1.3.m3.1.1.cmml"><mi id="S8.SS4.p1.3.m3.1.1.2" xref="S8.SS4.p1.3.m3.1.1.2.cmml">α</mi><mo id="S8.SS4.p1.3.m3.1.1.1" xref="S8.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S8.SS4.p1.3.m3.1.1.3" xref="S8.SS4.p1.3.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS4.p1.3.m3.1b"><apply id="S8.SS4.p1.3.m3.1.1.cmml" xref="S8.SS4.p1.3.m3.1.1"><eq id="S8.SS4.p1.3.m3.1.1.1.cmml" xref="S8.SS4.p1.3.m3.1.1.1"></eq><ci id="S8.SS4.p1.3.m3.1.1.2.cmml" xref="S8.SS4.p1.3.m3.1.1.2">𝛼</ci><cn id="S8.SS4.p1.3.m3.1.1.3.cmml" type="float" xref="S8.SS4.p1.3.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS4.p1.3.m3.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S8.SS4.p1.3.m3.1d">italic_α = 0.05</annotation></semantics></math>) we record <span class="ltx_text ltx_font_typewriter" id="S8.SS4.p1.5.1">true</span>, otherwise we record <span class="ltx_text ltx_font_typewriter" id="S8.SS4.p1.5.2">false</span>. Finally, we compute the proportion of products that recorded <span class="ltx_text ltx_font_typewriter" id="S8.SS4.p1.5.3">true</span> to assess the cluster fit quality. We find <math alttext="K=20" class="ltx_Math" display="inline" id="S8.SS4.p1.4.m4.1"><semantics id="S8.SS4.p1.4.m4.1a"><mrow id="S8.SS4.p1.4.m4.1.1" xref="S8.SS4.p1.4.m4.1.1.cmml"><mi id="S8.SS4.p1.4.m4.1.1.2" xref="S8.SS4.p1.4.m4.1.1.2.cmml">K</mi><mo id="S8.SS4.p1.4.m4.1.1.1" xref="S8.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S8.SS4.p1.4.m4.1.1.3" xref="S8.SS4.p1.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS4.p1.4.m4.1b"><apply id="S8.SS4.p1.4.m4.1.1.cmml" xref="S8.SS4.p1.4.m4.1.1"><eq id="S8.SS4.p1.4.m4.1.1.1.cmml" xref="S8.SS4.p1.4.m4.1.1.1"></eq><ci id="S8.SS4.p1.4.m4.1.1.2.cmml" xref="S8.SS4.p1.4.m4.1.1.2">𝐾</ci><cn id="S8.SS4.p1.4.m4.1.1.3.cmml" type="integer" xref="S8.SS4.p1.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS4.p1.4.m4.1c">K=20</annotation><annotation encoding="application/x-llamapun" id="S8.SS4.p1.4.m4.1d">italic_K = 20</annotation></semantics></math> is a roughly the point where adding another cluster yields a small increase fit, and set <math alttext="K=20" class="ltx_Math" display="inline" id="S8.SS4.p1.5.m5.1"><semantics id="S8.SS4.p1.5.m5.1a"><mrow id="S8.SS4.p1.5.m5.1.1" xref="S8.SS4.p1.5.m5.1.1.cmml"><mi id="S8.SS4.p1.5.m5.1.1.2" xref="S8.SS4.p1.5.m5.1.1.2.cmml">K</mi><mo id="S8.SS4.p1.5.m5.1.1.1" xref="S8.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S8.SS4.p1.5.m5.1.1.3" xref="S8.SS4.p1.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS4.p1.5.m5.1b"><apply id="S8.SS4.p1.5.m5.1.1.cmml" xref="S8.SS4.p1.5.m5.1.1"><eq id="S8.SS4.p1.5.m5.1.1.1.cmml" xref="S8.SS4.p1.5.m5.1.1.1"></eq><ci id="S8.SS4.p1.5.m5.1.1.2.cmml" xref="S8.SS4.p1.5.m5.1.1.2">𝐾</ci><cn id="S8.SS4.p1.5.m5.1.1.3.cmml" type="integer" xref="S8.SS4.p1.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS4.p1.5.m5.1c">K=20</annotation><annotation encoding="application/x-llamapun" id="S8.SS4.p1.5.m5.1d">italic_K = 20</annotation></semantics></math> in our experiments.</p>
</div>
<figure class="ltx_figure" id="S8.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="623" id="S8.F8.sf1.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F8.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S8.F8.sf1.3.2" style="font-size:90%;">SpAGMM Cluster selection</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="437" id="S8.F8.sf2.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F8.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S8.F8.sf2.3.2" style="font-size:90%;">Learned store cluster assignments in Phoenix, Arizona, USA.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F8.4.2.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text" id="S8.F8.2.1" style="font-size:90%;">Diagnostics of our proposed clustering procedure. (a) Using an auxiliary sales dataset, we plot the percentage of product preferences explained by the learned clusters, against the number of clusters. We perform a series of product-level ANOVA tests to calculate the y-axis. We choose <math alttext="K=20" class="ltx_Math" display="inline" id="S8.F8.2.1.m1.1"><semantics id="S8.F8.2.1.m1.1b"><mrow id="S8.F8.2.1.m1.1.1" xref="S8.F8.2.1.m1.1.1.cmml"><mi id="S8.F8.2.1.m1.1.1.2" xref="S8.F8.2.1.m1.1.1.2.cmml">K</mi><mo id="S8.F8.2.1.m1.1.1.1" xref="S8.F8.2.1.m1.1.1.1.cmml">=</mo><mn id="S8.F8.2.1.m1.1.1.3" xref="S8.F8.2.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.F8.2.1.m1.1c"><apply id="S8.F8.2.1.m1.1.1.cmml" xref="S8.F8.2.1.m1.1.1"><eq id="S8.F8.2.1.m1.1.1.1.cmml" xref="S8.F8.2.1.m1.1.1.1"></eq><ci id="S8.F8.2.1.m1.1.1.2.cmml" xref="S8.F8.2.1.m1.1.1.2">𝐾</ci><cn id="S8.F8.2.1.m1.1.1.3.cmml" type="integer" xref="S8.F8.2.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.F8.2.1.m1.1d">K=20</annotation><annotation encoding="application/x-llamapun" id="S8.F8.2.1.m1.1e">italic_K = 20</annotation></semantics></math> as it balances data fit and interpretability. (b) We show learned store-level cluster assignments in Phoenix, AZ. We discover interesting local neighborhoods, typical of urban data.</span></figcaption>
</figure>
<section class="ltx_subsubsection" id="S8.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">8.4.1. </span>Visualization of Clusters</h4>
<div class="ltx_para" id="S8.SS4.SSS1.p1">
<p class="ltx_p" id="S8.SS4.SSS1.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F8.sf2" title="Figure 8(b) ‣ Figure 8 ‣ 8.4. Selecting the Number of Clusters ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">8(b)</span></a> we show a 2D plot of the learned store-level clusters, after applying a TSNE dimensionality reduction. We note that the inter-cluster variance is generally quite low. This indicates that stores within a cluster tend to be demographically similar. Some clusters (i.e, #13) are comprised of nearly identical stores, while others exhibit more variation (i.e., #9). We also note high intra-cluster variance. Meaning, clusters are cleanly separated and don’t overlap. These properties are indicate that the clusters fit the data, and meaningful demographic patterns have been discovered.</p>
</div>
<div class="ltx_para" id="S8.SS4.SSS1.p2">
<p class="ltx_p" id="S8.SS4.SSS1.p2.1">Additionally, Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F8.sf2" title="Figure 8(b) ‣ Figure 8 ‣ 8.4. Selecting the Number of Clusters ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">8(b)</span></a> depicts the store-level cluster assignments of stores in Phoenix, Arizona, along with a high-level summary of various clusters identified by SpAGMM + K-means. First, we observe clear spatial stratification, which is typical of urban data. We note highly educated people living near Mesa and Tempe, home of Arizona State University. Additionally, see a more diverse racial group near downtown, and a higher Hispanic concentration towards Glendale. Our primary conclusion from Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F8.sf2" title="Figure 8(b) ‣ Figure 8 ‣ 8.4. Selecting the Number of Clusters ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">8(b)</span></a> is that we can detect spatial variation in demographic profiles, and that they do explain variation in product preferences.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S8.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.5. </span>Product Case Study</h3>
<div class="ltx_para" id="S8.SS5.p1">
<p class="ltx_p" id="S8.SS5.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.07769v2#S8.F9.sf1" title="Figure 9(a) ‣ Figure 9 ‣ 8.5. Product Case Study ‣ 8. Additional Experiments and Results ‣ Personalized Product Assortment with Real-time 3D Perception and Bayesian Payoff Estimation"><span class="ltx_text ltx_ref_tag">9(a)</span></a> we present an example product display observed in field experiment #2. The top 14 candidates for this display are presented along with the unpenalized (blue) and penalized (gold) reward estimates, or PEPF scores. Products are sorted by unpenalized reward. We also plot the posterior standard deviation of reward with black vertical lines. We set the penalty coefficient, <math alttext="\lambda=2.0" class="ltx_Math" display="inline" id="S8.SS5.p1.1.m1.1"><semantics id="S8.SS5.p1.1.m1.1a"><mrow id="S8.SS5.p1.1.m1.1.1" xref="S8.SS5.p1.1.m1.1.1.cmml"><mi id="S8.SS5.p1.1.m1.1.1.2" xref="S8.SS5.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S8.SS5.p1.1.m1.1.1.1" xref="S8.SS5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S8.SS5.p1.1.m1.1.1.3" xref="S8.SS5.p1.1.m1.1.1.3.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.SS5.p1.1.m1.1b"><apply id="S8.SS5.p1.1.m1.1.1.cmml" xref="S8.SS5.p1.1.m1.1.1"><eq id="S8.SS5.p1.1.m1.1.1.1.cmml" xref="S8.SS5.p1.1.m1.1.1.1"></eq><ci id="S8.SS5.p1.1.m1.1.1.2.cmml" xref="S8.SS5.p1.1.m1.1.1.2">𝜆</ci><cn id="S8.SS5.p1.1.m1.1.1.3.cmml" type="float" xref="S8.SS5.p1.1.m1.1.1.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS5.p1.1.m1.1c">\lambda=2.0</annotation><annotation encoding="application/x-llamapun" id="S8.SS5.p1.1.m1.1d">italic_λ = 2.0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S8.SS5.p2">
<p class="ltx_p" id="S8.SS5.p2.1">From this penalized and unpenalized comparison, we make the following conclusions. First, Many of the products with high expected reward also have high uncertainty. This is consistent with our rationale for proposing RBP. We want to avoid overly optimistic actions, and high reward estimates could in fact be spurious. Second, penalizing by uncertainty changes the product order. For example, <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.1">Sprite Berry</span> and <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.2">Smartwater</span> are two of the top four product by unpenalized PEPF. When we apply the uncertainty penalty, their rank shifts downward. In the case of <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.3">Smartwater</span>, it’s uncertainity is so high, that it becomes the lowest ranked product of the candidate set. In this example, <span class="ltx_text" id="S8.SS5.p2.1.4">EdgeRec3D</span> removes space from the bottom two products <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.5">Coca-cola</span> and <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.6">Dasani</span> and allocates it to <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.7">Dreamworld</span> and <span class="ltx_text ltx_font_typewriter" id="S8.SS5.p2.1.8">Dreamworld Zero</span>, because their penalized rewards estimates are higher.</p>
</div>
<figure class="ltx_figure" id="S8.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="498" id="S8.F9.sf1.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F9.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S8.F9.sf1.3.2" style="font-size:90%;">Product Case Study</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S8.F9.sf2.g1" src="extracted/5665233/figs/tsne.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F9.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S8.F9.sf2.3.2" style="font-size:90%;">TSNE Visualization of Spatial Cluster</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F9.2.1.1" style="font-size:90%;">Figure 9</span>. </span><span class="ltx_text" id="S8.F9.3.2" style="font-size:90%;"> (a) Penalized and unpenalized PEPF statistics from an example display taken from experiment #2. (b) A two dimensional TSNE visualization of the 20 store clusters learned in our experiments. We see clearly delineated, and relatively tight clusters in the 2D space, indicative of good data fit. </span></figcaption>
</figure>
<figure class="ltx_figure" id="S8.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="623" id="S8.F10.sf1.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F10.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S8.F10.sf1.3.2" style="font-size:90%;">Exp 1: DID effect (all Stores)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S8.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="623" id="S8.F10.sf2.g1" src="x15.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F10.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S8.F10.sf2.3.2" style="font-size:90%;">Exp 2: DID effect (high compliance)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S8.F10.2.1.1" style="font-size:90%;">Figure 10</span>. </span><span class="ltx_text" id="S8.F10.3.2" style="font-size:90%;">Summary of our results. (a) The DID treatment effect for experiment 1, with 95% CI; (b) the treatment effect of the high compliance group in experiment 2, with 95% CI (b); (c) the mean treatment effect as a function of recommendation compliance. </span></figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun 13 17:18:07 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
