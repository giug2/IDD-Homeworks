<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>IT3: Idempotent Test-Time Training</title>
<!--Generated on Sat Oct  5 15:23:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04201v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S1" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S2" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S2.SS1" title="In 2 Related Work ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Test-Time Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S2.SS2" title="In 2 Related Work ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Idempotence in Deep Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS1" title="In 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Initial Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS2" title="In 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Test-Time Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS3" title="In 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Online IT<sup class="ltx_sup">3</sup></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS1" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Tabular Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS2" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>CIFAR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS3" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Age Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS4" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Road Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS5" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Aerodynamics Prediction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS5.SSS0.Px1" title="In 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title">Wings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS5.SSS0.Px2" title="In 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title">Cars.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.SS6" title="In 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Online IT<sup class="ltx_sup">3</sup></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S5" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Limitations:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S6" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#A1" title="In IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#A1.SS1" title="In Appendix A Appendix ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Additional Road Segmentation Experiments</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">IT<sup class="ltx_sup" id="id16.id1">3</sup>: Idempotent Test-Time Training</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nikita Durasov 
<br class="ltx_break"/>EPFL, CVLAB 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id17.1.id1">nikita.durasov@epfl.ch</span>
&amp;Assaf Shocher<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>
<br class="ltx_break"/>NVIDIA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id18.2.id2">assafshocher@gmail.com</span>
&amp;Doruk Oner 
<br class="ltx_break"/>NVLab, Bilkent University 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id19.3.id3">doruk.oner@bilkent.edu.tr</span>
&amp;Gal Chechik 
<br class="ltx_break"/>NVIDIA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id20.4.id4">gchechik@nvidia.com</span>
&amp;Alexei A. Efros 
<br class="ltx_break"/>UC Berkeley 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id21.5.id5">efros@eecs.berkeley.edu</span>
&amp;Pascal Fua 
<br class="ltx_break"/>CVLAB, EPFL 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id22.6.id6">pascal.fua@epfl.ch</span>
</span><span class="ltx_author_notes">Equal contribution</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id15.14">This paper introduces <span class="ltx_text ltx_font_italic" id="id15.14.1">Idempotent Test-Time Training</span> (IT<sup class="ltx_sup" id="id15.14.2">3</sup>),
a novel approach to addressing the challenge of distribution shift.
While supervised-learning methods assume matching train and test distributions, this is rarely the case for machine learning systems deployed in the real world.
Test-Time Training (TTT) approaches address this by adapting models during inference, but they are limited by a domain specific auxiliary task. IT<sup class="ltx_sup" id="id15.14.3">3</sup> is based on the universal property of idempotence.
An idempotent operator is one that can be applied sequentially without changing the result beyond the initial application, that is <math alttext="f(f(\mathbf{x}))=f(\mathbf{x})" class="ltx_Math" display="inline" id="id4.3.m3.3"><semantics id="id4.3.m3.3a"><mrow id="id4.3.m3.3.3" xref="id4.3.m3.3.3.cmml"><mrow id="id4.3.m3.3.3.1" xref="id4.3.m3.3.3.1.cmml"><mi id="id4.3.m3.3.3.1.3" xref="id4.3.m3.3.3.1.3.cmml">f</mi><mo id="id4.3.m3.3.3.1.2" xref="id4.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="id4.3.m3.3.3.1.1.1" xref="id4.3.m3.3.3.1.1.1.1.cmml"><mo id="id4.3.m3.3.3.1.1.1.2" stretchy="false" xref="id4.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="id4.3.m3.3.3.1.1.1.1" xref="id4.3.m3.3.3.1.1.1.1.cmml"><mi id="id4.3.m3.3.3.1.1.1.1.2" xref="id4.3.m3.3.3.1.1.1.1.2.cmml">f</mi><mo id="id4.3.m3.3.3.1.1.1.1.1" xref="id4.3.m3.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="id4.3.m3.3.3.1.1.1.1.3.2" xref="id4.3.m3.3.3.1.1.1.1.cmml"><mo id="id4.3.m3.3.3.1.1.1.1.3.2.1" stretchy="false" xref="id4.3.m3.3.3.1.1.1.1.cmml">(</mo><mi id="id4.3.m3.1.1" xref="id4.3.m3.1.1.cmml">𝐱</mi><mo id="id4.3.m3.3.3.1.1.1.1.3.2.2" stretchy="false" xref="id4.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="id4.3.m3.3.3.1.1.1.3" stretchy="false" xref="id4.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="id4.3.m3.3.3.2" xref="id4.3.m3.3.3.2.cmml">=</mo><mrow id="id4.3.m3.3.3.3" xref="id4.3.m3.3.3.3.cmml"><mi id="id4.3.m3.3.3.3.2" xref="id4.3.m3.3.3.3.2.cmml">f</mi><mo id="id4.3.m3.3.3.3.1" xref="id4.3.m3.3.3.3.1.cmml">⁢</mo><mrow id="id4.3.m3.3.3.3.3.2" xref="id4.3.m3.3.3.3.cmml"><mo id="id4.3.m3.3.3.3.3.2.1" stretchy="false" xref="id4.3.m3.3.3.3.cmml">(</mo><mi id="id4.3.m3.2.2" xref="id4.3.m3.2.2.cmml">𝐱</mi><mo id="id4.3.m3.3.3.3.3.2.2" stretchy="false" xref="id4.3.m3.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="id4.3.m3.3b"><apply id="id4.3.m3.3.3.cmml" xref="id4.3.m3.3.3"><eq id="id4.3.m3.3.3.2.cmml" xref="id4.3.m3.3.3.2"></eq><apply id="id4.3.m3.3.3.1.cmml" xref="id4.3.m3.3.3.1"><times id="id4.3.m3.3.3.1.2.cmml" xref="id4.3.m3.3.3.1.2"></times><ci id="id4.3.m3.3.3.1.3.cmml" xref="id4.3.m3.3.3.1.3">𝑓</ci><apply id="id4.3.m3.3.3.1.1.1.1.cmml" xref="id4.3.m3.3.3.1.1.1"><times id="id4.3.m3.3.3.1.1.1.1.1.cmml" xref="id4.3.m3.3.3.1.1.1.1.1"></times><ci id="id4.3.m3.3.3.1.1.1.1.2.cmml" xref="id4.3.m3.3.3.1.1.1.1.2">𝑓</ci><ci id="id4.3.m3.1.1.cmml" xref="id4.3.m3.1.1">𝐱</ci></apply></apply><apply id="id4.3.m3.3.3.3.cmml" xref="id4.3.m3.3.3.3"><times id="id4.3.m3.3.3.3.1.cmml" xref="id4.3.m3.3.3.3.1"></times><ci id="id4.3.m3.3.3.3.2.cmml" xref="id4.3.m3.3.3.3.2">𝑓</ci><ci id="id4.3.m3.2.2.cmml" xref="id4.3.m3.2.2">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.3.m3.3c">f(f(\mathbf{x}))=f(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="id4.3.m3.3d">italic_f ( italic_f ( bold_x ) ) = italic_f ( bold_x )</annotation></semantics></math>.
At training, the model receives an input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="id5.4.m4.1"><semantics id="id5.4.m4.1a"><mi id="id5.4.m4.1.1" xref="id5.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="id5.4.m4.1b"><ci id="id5.4.m4.1.1.cmml" xref="id5.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="id5.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="id5.4.m4.1d">bold_x</annotation></semantics></math> along with another signal that can either be the ground truth label <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="id6.5.m5.1"><semantics id="id6.5.m5.1a"><mi id="id6.5.m5.1.1" xref="id6.5.m5.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="id6.5.m5.1b"><ci id="id6.5.m5.1.1.cmml" xref="id6.5.m5.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="id6.5.m5.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="id6.5.m5.1d">bold_y</annotation></semantics></math> or a neutral ”don’t know” signal <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="id7.6.m6.1"><semantics id="id7.6.m6.1a"><mn id="id7.6.m6.1.1" xref="id7.6.m6.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="id7.6.m6.1b"><cn id="id7.6.m6.1.1.cmml" type="integer" xref="id7.6.m6.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="id7.6.m6.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="id7.6.m6.1d">bold_0</annotation></semantics></math>. At test time, the additional signal can only be <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="id8.7.m7.1"><semantics id="id8.7.m7.1a"><mn id="id8.7.m7.1.1" xref="id8.7.m7.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="id8.7.m7.1b"><cn id="id8.7.m7.1.1.cmml" type="integer" xref="id8.7.m7.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="id8.7.m7.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="id8.7.m7.1d">bold_0</annotation></semantics></math>. When sequentially applying the model, first predicting <math alttext="\mathbf{y}_{0}=f(\mathbf{x},\mathbf{0})" class="ltx_Math" display="inline" id="id9.8.m8.2"><semantics id="id9.8.m8.2a"><mrow id="id9.8.m8.2.3" xref="id9.8.m8.2.3.cmml"><msub id="id9.8.m8.2.3.2" xref="id9.8.m8.2.3.2.cmml"><mi id="id9.8.m8.2.3.2.2" xref="id9.8.m8.2.3.2.2.cmml">𝐲</mi><mn id="id9.8.m8.2.3.2.3" xref="id9.8.m8.2.3.2.3.cmml">0</mn></msub><mo id="id9.8.m8.2.3.1" xref="id9.8.m8.2.3.1.cmml">=</mo><mrow id="id9.8.m8.2.3.3" xref="id9.8.m8.2.3.3.cmml"><mi id="id9.8.m8.2.3.3.2" xref="id9.8.m8.2.3.3.2.cmml">f</mi><mo id="id9.8.m8.2.3.3.1" xref="id9.8.m8.2.3.3.1.cmml">⁢</mo><mrow id="id9.8.m8.2.3.3.3.2" xref="id9.8.m8.2.3.3.3.1.cmml"><mo id="id9.8.m8.2.3.3.3.2.1" stretchy="false" xref="id9.8.m8.2.3.3.3.1.cmml">(</mo><mi id="id9.8.m8.1.1" xref="id9.8.m8.1.1.cmml">𝐱</mi><mo id="id9.8.m8.2.3.3.3.2.2" xref="id9.8.m8.2.3.3.3.1.cmml">,</mo><mn id="id9.8.m8.2.2" xref="id9.8.m8.2.2.cmml">𝟎</mn><mo id="id9.8.m8.2.3.3.3.2.3" stretchy="false" xref="id9.8.m8.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="id9.8.m8.2b"><apply id="id9.8.m8.2.3.cmml" xref="id9.8.m8.2.3"><eq id="id9.8.m8.2.3.1.cmml" xref="id9.8.m8.2.3.1"></eq><apply id="id9.8.m8.2.3.2.cmml" xref="id9.8.m8.2.3.2"><csymbol cd="ambiguous" id="id9.8.m8.2.3.2.1.cmml" xref="id9.8.m8.2.3.2">subscript</csymbol><ci id="id9.8.m8.2.3.2.2.cmml" xref="id9.8.m8.2.3.2.2">𝐲</ci><cn id="id9.8.m8.2.3.2.3.cmml" type="integer" xref="id9.8.m8.2.3.2.3">0</cn></apply><apply id="id9.8.m8.2.3.3.cmml" xref="id9.8.m8.2.3.3"><times id="id9.8.m8.2.3.3.1.cmml" xref="id9.8.m8.2.3.3.1"></times><ci id="id9.8.m8.2.3.3.2.cmml" xref="id9.8.m8.2.3.3.2">𝑓</ci><interval closure="open" id="id9.8.m8.2.3.3.3.1.cmml" xref="id9.8.m8.2.3.3.3.2"><ci id="id9.8.m8.1.1.cmml" xref="id9.8.m8.1.1">𝐱</ci><cn id="id9.8.m8.2.2.cmml" type="integer" xref="id9.8.m8.2.2">0</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id9.8.m8.2c">\mathbf{y}_{0}=f(\mathbf{x},\mathbf{0})</annotation><annotation encoding="application/x-llamapun" id="id9.8.m8.2d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_f ( bold_x , bold_0 )</annotation></semantics></math> and then <math alttext="\mathbf{y}_{1}=f(\mathbf{x},\mathbf{y}_{0})" class="ltx_Math" display="inline" id="id10.9.m9.2"><semantics id="id10.9.m9.2a"><mrow id="id10.9.m9.2.2" xref="id10.9.m9.2.2.cmml"><msub id="id10.9.m9.2.2.3" xref="id10.9.m9.2.2.3.cmml"><mi id="id10.9.m9.2.2.3.2" xref="id10.9.m9.2.2.3.2.cmml">𝐲</mi><mn id="id10.9.m9.2.2.3.3" xref="id10.9.m9.2.2.3.3.cmml">1</mn></msub><mo id="id10.9.m9.2.2.2" xref="id10.9.m9.2.2.2.cmml">=</mo><mrow id="id10.9.m9.2.2.1" xref="id10.9.m9.2.2.1.cmml"><mi id="id10.9.m9.2.2.1.3" xref="id10.9.m9.2.2.1.3.cmml">f</mi><mo id="id10.9.m9.2.2.1.2" xref="id10.9.m9.2.2.1.2.cmml">⁢</mo><mrow id="id10.9.m9.2.2.1.1.1" xref="id10.9.m9.2.2.1.1.2.cmml"><mo id="id10.9.m9.2.2.1.1.1.2" stretchy="false" xref="id10.9.m9.2.2.1.1.2.cmml">(</mo><mi id="id10.9.m9.1.1" xref="id10.9.m9.1.1.cmml">𝐱</mi><mo id="id10.9.m9.2.2.1.1.1.3" xref="id10.9.m9.2.2.1.1.2.cmml">,</mo><msub id="id10.9.m9.2.2.1.1.1.1" xref="id10.9.m9.2.2.1.1.1.1.cmml"><mi id="id10.9.m9.2.2.1.1.1.1.2" xref="id10.9.m9.2.2.1.1.1.1.2.cmml">𝐲</mi><mn id="id10.9.m9.2.2.1.1.1.1.3" xref="id10.9.m9.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="id10.9.m9.2.2.1.1.1.4" stretchy="false" xref="id10.9.m9.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="id10.9.m9.2b"><apply id="id10.9.m9.2.2.cmml" xref="id10.9.m9.2.2"><eq id="id10.9.m9.2.2.2.cmml" xref="id10.9.m9.2.2.2"></eq><apply id="id10.9.m9.2.2.3.cmml" xref="id10.9.m9.2.2.3"><csymbol cd="ambiguous" id="id10.9.m9.2.2.3.1.cmml" xref="id10.9.m9.2.2.3">subscript</csymbol><ci id="id10.9.m9.2.2.3.2.cmml" xref="id10.9.m9.2.2.3.2">𝐲</ci><cn id="id10.9.m9.2.2.3.3.cmml" type="integer" xref="id10.9.m9.2.2.3.3">1</cn></apply><apply id="id10.9.m9.2.2.1.cmml" xref="id10.9.m9.2.2.1"><times id="id10.9.m9.2.2.1.2.cmml" xref="id10.9.m9.2.2.1.2"></times><ci id="id10.9.m9.2.2.1.3.cmml" xref="id10.9.m9.2.2.1.3">𝑓</ci><interval closure="open" id="id10.9.m9.2.2.1.1.2.cmml" xref="id10.9.m9.2.2.1.1.1"><ci id="id10.9.m9.1.1.cmml" xref="id10.9.m9.1.1">𝐱</ci><apply id="id10.9.m9.2.2.1.1.1.1.cmml" xref="id10.9.m9.2.2.1.1.1.1"><csymbol cd="ambiguous" id="id10.9.m9.2.2.1.1.1.1.1.cmml" xref="id10.9.m9.2.2.1.1.1.1">subscript</csymbol><ci id="id10.9.m9.2.2.1.1.1.1.2.cmml" xref="id10.9.m9.2.2.1.1.1.1.2">𝐲</ci><cn id="id10.9.m9.2.2.1.1.1.1.3.cmml" type="integer" xref="id10.9.m9.2.2.1.1.1.1.3">0</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id10.9.m9.2c">\mathbf{y}_{1}=f(\mathbf{x},\mathbf{y}_{0})</annotation><annotation encoding="application/x-llamapun" id="id10.9.m9.2d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_f ( bold_x , bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>, the distance between <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="id11.10.m10.1"><semantics id="id11.10.m10.1a"><msub id="id11.10.m10.1.1" xref="id11.10.m10.1.1.cmml"><mi id="id11.10.m10.1.1.2" xref="id11.10.m10.1.1.2.cmml">𝐲</mi><mn id="id11.10.m10.1.1.3" xref="id11.10.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="id11.10.m10.1b"><apply id="id11.10.m10.1.1.cmml" xref="id11.10.m10.1.1"><csymbol cd="ambiguous" id="id11.10.m10.1.1.1.cmml" xref="id11.10.m10.1.1">subscript</csymbol><ci id="id11.10.m10.1.1.2.cmml" xref="id11.10.m10.1.1.2">𝐲</ci><cn id="id11.10.m10.1.1.3.cmml" type="integer" xref="id11.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id11.10.m10.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="id11.10.m10.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="id12.11.m11.1"><semantics id="id12.11.m11.1a"><msub id="id12.11.m11.1.1" xref="id12.11.m11.1.1.cmml"><mi id="id12.11.m11.1.1.2" xref="id12.11.m11.1.1.2.cmml">𝐲</mi><mn id="id12.11.m11.1.1.3" xref="id12.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="id12.11.m11.1b"><apply id="id12.11.m11.1.1.cmml" xref="id12.11.m11.1.1"><csymbol cd="ambiguous" id="id12.11.m11.1.1.1.cmml" xref="id12.11.m11.1.1">subscript</csymbol><ci id="id12.11.m11.1.1.2.cmml" xref="id12.11.m11.1.1.2">𝐲</ci><cn id="id12.11.m11.1.1.3.cmml" type="integer" xref="id12.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id12.11.m11.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="id12.11.m11.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> measures certainty and indicates out-of-distribution input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="id13.12.m12.1"><semantics id="id13.12.m12.1a"><mi id="id13.12.m12.1.1" xref="id13.12.m12.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="id13.12.m12.1b"><ci id="id13.12.m12.1.1.cmml" xref="id13.12.m12.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="id13.12.m12.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="id13.12.m12.1d">bold_x</annotation></semantics></math> if high.
We use this distance, that can be expressed as <math alttext="||f(\mathbf{x},f(\mathbf{x},\mathbf{0}))-f(x,\mathbf{0})||" class="ltx_Math" display="inline" id="id14.13.m13.6"><semantics id="id14.13.m13.6a"><mrow id="id14.13.m13.6.6.1" xref="id14.13.m13.6.6.2.cmml"><mo id="id14.13.m13.6.6.1.2" stretchy="false" xref="id14.13.m13.6.6.2.1.cmml">‖</mo><mrow id="id14.13.m13.6.6.1.1" xref="id14.13.m13.6.6.1.1.cmml"><mrow id="id14.13.m13.6.6.1.1.1" xref="id14.13.m13.6.6.1.1.1.cmml"><mi id="id14.13.m13.6.6.1.1.1.3" xref="id14.13.m13.6.6.1.1.1.3.cmml">f</mi><mo id="id14.13.m13.6.6.1.1.1.2" xref="id14.13.m13.6.6.1.1.1.2.cmml">⁢</mo><mrow id="id14.13.m13.6.6.1.1.1.1.1" xref="id14.13.m13.6.6.1.1.1.1.2.cmml"><mo id="id14.13.m13.6.6.1.1.1.1.1.2" stretchy="false" xref="id14.13.m13.6.6.1.1.1.1.2.cmml">(</mo><mi id="id14.13.m13.3.3" xref="id14.13.m13.3.3.cmml">𝐱</mi><mo id="id14.13.m13.6.6.1.1.1.1.1.3" xref="id14.13.m13.6.6.1.1.1.1.2.cmml">,</mo><mrow id="id14.13.m13.6.6.1.1.1.1.1.1" xref="id14.13.m13.6.6.1.1.1.1.1.1.cmml"><mi id="id14.13.m13.6.6.1.1.1.1.1.1.2" xref="id14.13.m13.6.6.1.1.1.1.1.1.2.cmml">f</mi><mo id="id14.13.m13.6.6.1.1.1.1.1.1.1" xref="id14.13.m13.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="id14.13.m13.6.6.1.1.1.1.1.1.3.2" xref="id14.13.m13.6.6.1.1.1.1.1.1.3.1.cmml"><mo id="id14.13.m13.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="id14.13.m13.6.6.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="id14.13.m13.1.1" xref="id14.13.m13.1.1.cmml">𝐱</mi><mo id="id14.13.m13.6.6.1.1.1.1.1.1.3.2.2" xref="id14.13.m13.6.6.1.1.1.1.1.1.3.1.cmml">,</mo><mn id="id14.13.m13.2.2" xref="id14.13.m13.2.2.cmml">𝟎</mn><mo id="id14.13.m13.6.6.1.1.1.1.1.1.3.2.3" stretchy="false" xref="id14.13.m13.6.6.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="id14.13.m13.6.6.1.1.1.1.1.4" stretchy="false" xref="id14.13.m13.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="id14.13.m13.6.6.1.1.2" xref="id14.13.m13.6.6.1.1.2.cmml">−</mo><mrow id="id14.13.m13.6.6.1.1.3" xref="id14.13.m13.6.6.1.1.3.cmml"><mi id="id14.13.m13.6.6.1.1.3.2" xref="id14.13.m13.6.6.1.1.3.2.cmml">f</mi><mo id="id14.13.m13.6.6.1.1.3.1" xref="id14.13.m13.6.6.1.1.3.1.cmml">⁢</mo><mrow id="id14.13.m13.6.6.1.1.3.3.2" xref="id14.13.m13.6.6.1.1.3.3.1.cmml"><mo id="id14.13.m13.6.6.1.1.3.3.2.1" stretchy="false" xref="id14.13.m13.6.6.1.1.3.3.1.cmml">(</mo><mi id="id14.13.m13.4.4" xref="id14.13.m13.4.4.cmml">x</mi><mo id="id14.13.m13.6.6.1.1.3.3.2.2" xref="id14.13.m13.6.6.1.1.3.3.1.cmml">,</mo><mn id="id14.13.m13.5.5" xref="id14.13.m13.5.5.cmml">𝟎</mn><mo id="id14.13.m13.6.6.1.1.3.3.2.3" stretchy="false" xref="id14.13.m13.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="id14.13.m13.6.6.1.3" stretchy="false" xref="id14.13.m13.6.6.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="id14.13.m13.6b"><apply id="id14.13.m13.6.6.2.cmml" xref="id14.13.m13.6.6.1"><csymbol cd="latexml" id="id14.13.m13.6.6.2.1.cmml" xref="id14.13.m13.6.6.1.2">norm</csymbol><apply id="id14.13.m13.6.6.1.1.cmml" xref="id14.13.m13.6.6.1.1"><minus id="id14.13.m13.6.6.1.1.2.cmml" xref="id14.13.m13.6.6.1.1.2"></minus><apply id="id14.13.m13.6.6.1.1.1.cmml" xref="id14.13.m13.6.6.1.1.1"><times id="id14.13.m13.6.6.1.1.1.2.cmml" xref="id14.13.m13.6.6.1.1.1.2"></times><ci id="id14.13.m13.6.6.1.1.1.3.cmml" xref="id14.13.m13.6.6.1.1.1.3">𝑓</ci><interval closure="open" id="id14.13.m13.6.6.1.1.1.1.2.cmml" xref="id14.13.m13.6.6.1.1.1.1.1"><ci id="id14.13.m13.3.3.cmml" xref="id14.13.m13.3.3">𝐱</ci><apply id="id14.13.m13.6.6.1.1.1.1.1.1.cmml" xref="id14.13.m13.6.6.1.1.1.1.1.1"><times id="id14.13.m13.6.6.1.1.1.1.1.1.1.cmml" xref="id14.13.m13.6.6.1.1.1.1.1.1.1"></times><ci id="id14.13.m13.6.6.1.1.1.1.1.1.2.cmml" xref="id14.13.m13.6.6.1.1.1.1.1.1.2">𝑓</ci><interval closure="open" id="id14.13.m13.6.6.1.1.1.1.1.1.3.1.cmml" xref="id14.13.m13.6.6.1.1.1.1.1.1.3.2"><ci id="id14.13.m13.1.1.cmml" xref="id14.13.m13.1.1">𝐱</ci><cn id="id14.13.m13.2.2.cmml" type="integer" xref="id14.13.m13.2.2">0</cn></interval></apply></interval></apply><apply id="id14.13.m13.6.6.1.1.3.cmml" xref="id14.13.m13.6.6.1.1.3"><times id="id14.13.m13.6.6.1.1.3.1.cmml" xref="id14.13.m13.6.6.1.1.3.1"></times><ci id="id14.13.m13.6.6.1.1.3.2.cmml" xref="id14.13.m13.6.6.1.1.3.2">𝑓</ci><interval closure="open" id="id14.13.m13.6.6.1.1.3.3.1.cmml" xref="id14.13.m13.6.6.1.1.3.3.2"><ci id="id14.13.m13.4.4.cmml" xref="id14.13.m13.4.4">𝑥</ci><cn id="id14.13.m13.5.5.cmml" type="integer" xref="id14.13.m13.5.5">0</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id14.13.m13.6c">||f(\mathbf{x},f(\mathbf{x},\mathbf{0}))-f(x,\mathbf{0})||</annotation><annotation encoding="application/x-llamapun" id="id14.13.m13.6d">| | italic_f ( bold_x , italic_f ( bold_x , bold_0 ) ) - italic_f ( italic_x , bold_0 ) | |</annotation></semantics></math> as our TTT loss during inference. By carefully optimizing this objective, we effectively train <math alttext="f(\mathbf{x},\cdot)" class="ltx_Math" display="inline" id="id15.14.m14.2"><semantics id="id15.14.m14.2a"><mrow id="id15.14.m14.2.3" xref="id15.14.m14.2.3.cmml"><mi id="id15.14.m14.2.3.2" xref="id15.14.m14.2.3.2.cmml">f</mi><mo id="id15.14.m14.2.3.1" xref="id15.14.m14.2.3.1.cmml">⁢</mo><mrow id="id15.14.m14.2.3.3.2" xref="id15.14.m14.2.3.3.1.cmml"><mo id="id15.14.m14.2.3.3.2.1" stretchy="false" xref="id15.14.m14.2.3.3.1.cmml">(</mo><mi id="id15.14.m14.1.1" xref="id15.14.m14.1.1.cmml">𝐱</mi><mo id="id15.14.m14.2.3.3.2.2" rspace="0em" xref="id15.14.m14.2.3.3.1.cmml">,</mo><mo id="id15.14.m14.2.2" lspace="0em" rspace="0em" xref="id15.14.m14.2.2.cmml">⋅</mo><mo id="id15.14.m14.2.3.3.2.3" stretchy="false" xref="id15.14.m14.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id15.14.m14.2b"><apply id="id15.14.m14.2.3.cmml" xref="id15.14.m14.2.3"><times id="id15.14.m14.2.3.1.cmml" xref="id15.14.m14.2.3.1"></times><ci id="id15.14.m14.2.3.2.cmml" xref="id15.14.m14.2.3.2">𝑓</ci><interval closure="open" id="id15.14.m14.2.3.3.1.cmml" xref="id15.14.m14.2.3.3.2"><ci id="id15.14.m14.1.1.cmml" xref="id15.14.m14.1.1">𝐱</ci><ci id="id15.14.m14.2.2.cmml" xref="id15.14.m14.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="id15.14.m14.2c">f(\mathbf{x},\cdot)</annotation><annotation encoding="application/x-llamapun" id="id15.14.m14.2d">italic_f ( bold_x , ⋅ )</annotation></semantics></math> to be idempotent, projecting the internal representation of the input onto the training distribution.
We demonstrate the versatility of our approach across various tasks,
including corrupted image classification, aerodynamic predictions,
tabular data with missing information, age prediction from face, and large-scale aerial photo segmentation. Moreover, these tasks span different architectures such as MLPs, CNNs, and GNNs.</p>
</div>
<figure class="ltx_figure" id="S0.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S0.F1.g1" src="extracted/5896912/fig/method.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S0.F1.6.1">Idempotent Test-Time Training (IT<sup class="ltx_sup" id="S0.F1.6.1.1"><span class="ltx_text ltx_font_medium" id="S0.F1.6.1.1.1">3</span></sup>) approach.</span> During training (left), the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S0.F1.7.m1.1"><semantics id="S0.F1.7.m1.1b"><msub id="S0.F1.7.m1.1.1" xref="S0.F1.7.m1.1.1.cmml"><mi id="S0.F1.7.m1.1.1.2" xref="S0.F1.7.m1.1.1.2.cmml">f</mi><mi id="S0.F1.7.m1.1.1.3" xref="S0.F1.7.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S0.F1.7.m1.1c"><apply id="S0.F1.7.m1.1.1.cmml" xref="S0.F1.7.m1.1.1"><csymbol cd="ambiguous" id="S0.F1.7.m1.1.1.1.cmml" xref="S0.F1.7.m1.1.1">subscript</csymbol><ci id="S0.F1.7.m1.1.1.2.cmml" xref="S0.F1.7.m1.1.1.2">𝑓</ci><ci id="S0.F1.7.m1.1.1.3.cmml" xref="S0.F1.7.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.F1.7.m1.1d">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S0.F1.7.m1.1e">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is trained to predict the label <math alttext="y" class="ltx_Math" display="inline" id="S0.F1.8.m2.1"><semantics id="S0.F1.8.m2.1b"><mi id="S0.F1.8.m2.1.1" xref="S0.F1.8.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S0.F1.8.m2.1c"><ci id="S0.F1.8.m2.1.1.cmml" xref="S0.F1.8.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S0.F1.8.m2.1d">y</annotation><annotation encoding="application/x-llamapun" id="S0.F1.8.m2.1e">italic_y</annotation></semantics></math> with or without <math alttext="y" class="ltx_Math" display="inline" id="S0.F1.9.m3.1"><semantics id="S0.F1.9.m3.1b"><mi id="S0.F1.9.m3.1.1" xref="S0.F1.9.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S0.F1.9.m3.1c"><ci id="S0.F1.9.m3.1.1.cmml" xref="S0.F1.9.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S0.F1.9.m3.1d">y</annotation><annotation encoding="application/x-llamapun" id="S0.F1.9.m3.1e">italic_y</annotation></semantics></math> given to it as input. At test time (right), when given a corrupted input, the model is sequentially applied. It then briefly trains with the objective of making <math alttext="f_{\theta}(\mathbf{x},\cdot)" class="ltx_Math" display="inline" id="S0.F1.10.m4.2"><semantics id="S0.F1.10.m4.2b"><mrow id="S0.F1.10.m4.2.3" xref="S0.F1.10.m4.2.3.cmml"><msub id="S0.F1.10.m4.2.3.2" xref="S0.F1.10.m4.2.3.2.cmml"><mi id="S0.F1.10.m4.2.3.2.2" xref="S0.F1.10.m4.2.3.2.2.cmml">f</mi><mi id="S0.F1.10.m4.2.3.2.3" xref="S0.F1.10.m4.2.3.2.3.cmml">θ</mi></msub><mo id="S0.F1.10.m4.2.3.1" xref="S0.F1.10.m4.2.3.1.cmml">⁢</mo><mrow id="S0.F1.10.m4.2.3.3.2" xref="S0.F1.10.m4.2.3.3.1.cmml"><mo id="S0.F1.10.m4.2.3.3.2.1" stretchy="false" xref="S0.F1.10.m4.2.3.3.1.cmml">(</mo><mi id="S0.F1.10.m4.1.1" xref="S0.F1.10.m4.1.1.cmml">𝐱</mi><mo id="S0.F1.10.m4.2.3.3.2.2" rspace="0em" xref="S0.F1.10.m4.2.3.3.1.cmml">,</mo><mo id="S0.F1.10.m4.2.2" lspace="0em" rspace="0em" xref="S0.F1.10.m4.2.2.cmml">⋅</mo><mo id="S0.F1.10.m4.2.3.3.2.3" stretchy="false" xref="S0.F1.10.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S0.F1.10.m4.2c"><apply id="S0.F1.10.m4.2.3.cmml" xref="S0.F1.10.m4.2.3"><times id="S0.F1.10.m4.2.3.1.cmml" xref="S0.F1.10.m4.2.3.1"></times><apply id="S0.F1.10.m4.2.3.2.cmml" xref="S0.F1.10.m4.2.3.2"><csymbol cd="ambiguous" id="S0.F1.10.m4.2.3.2.1.cmml" xref="S0.F1.10.m4.2.3.2">subscript</csymbol><ci id="S0.F1.10.m4.2.3.2.2.cmml" xref="S0.F1.10.m4.2.3.2.2">𝑓</ci><ci id="S0.F1.10.m4.2.3.2.3.cmml" xref="S0.F1.10.m4.2.3.2.3">𝜃</ci></apply><interval closure="open" id="S0.F1.10.m4.2.3.3.1.cmml" xref="S0.F1.10.m4.2.3.3.2"><ci id="S0.F1.10.m4.1.1.cmml" xref="S0.F1.10.m4.1.1">𝐱</ci><ci id="S0.F1.10.m4.2.2.cmml" xref="S0.F1.10.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.F1.10.m4.2d">f_{\theta}(\mathbf{x},\cdot)</annotation><annotation encoding="application/x-llamapun" id="S0.F1.10.m4.2e">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , ⋅ )</annotation></semantics></math> to be idempotent using only the current test input.</figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Supervised learning methods, while powerful, typically assume that training and test data come from the same distribution. Unfortunately, this is rarely true in practice. Data encountered by systems operating in the real world often differs substantially from what they were trained on due to data distribution shifts over time or other changes in the environment. This inevitably degrades performance, even in state-of-the-art models <cite class="ltx_cite ltx_citemacro_citep">(Recht et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib32" title="">2018</a>; Hendrycks et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib23" title="">2021</a>; Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib43" title="">2022</a>)</cite>. Modern deployed machine learning systems not only need to adapt to distribution shifts but also must do so on-the-fly using very limited data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The problem setup this work addresses requires adapting to distribution shifts on-the-fly using only the current test instance or batch, without access to any additional labeled or unlabeled data during inference. During training, the model has access solely to the base distribution training data, with no prior knowledge of the test distribution. Adversarial robustness and domain adaptation address related challenges, they typically require additional data either during training or inference, and sometimes rely on specific assumptions about the nature of the shift. While effective in their contexts, they are not designed for immediate, instance-level adaptation and do not solve our problem setup. Test-Time Training (TTT) <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib38" title="">2020</a>)</cite> offers an alternative by adapting the model during inference using an auxiliary self-supervised task on each test sample. This dynamic, on-the-fly adaptation allows the model to handle corrupted and Out-of-Distribution (OOD) data using only the current test instance or batch, without access to any other data. However, TTT employs an auxiliary task specific to the data modality (e.g., orientation prediction or inpainting for imagery data) <cite class="ltx_cite ltx_citemacro_citep">(Gandelsman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib19" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we argue that enforcing <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">idempotence</span> can profitably replace the auxiliary tasks in TTT and results in an approach we dub IT<sup class="ltx_sup" id="S1.p3.1.2">3</sup> that is a versatile and powerful while generalizing well across domains and architectures.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.17">More specifically, an operator <math alttext="f" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_f</annotation></semantics></math> is said to be idempotent if it can be applied sequentially without changing the result beyond the initial application, namely: <math alttext="f(f(\mathbf{x}))=f(\mathbf{x})" class="ltx_Math" display="inline" id="S1.p4.2.m2.3"><semantics id="S1.p4.2.m2.3a"><mrow id="S1.p4.2.m2.3.3" xref="S1.p4.2.m2.3.3.cmml"><mrow id="S1.p4.2.m2.3.3.1" xref="S1.p4.2.m2.3.3.1.cmml"><mi id="S1.p4.2.m2.3.3.1.3" xref="S1.p4.2.m2.3.3.1.3.cmml">f</mi><mo id="S1.p4.2.m2.3.3.1.2" xref="S1.p4.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S1.p4.2.m2.3.3.1.1.1" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml"><mo id="S1.p4.2.m2.3.3.1.1.1.2" stretchy="false" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S1.p4.2.m2.3.3.1.1.1.1" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml"><mi id="S1.p4.2.m2.3.3.1.1.1.1.2" xref="S1.p4.2.m2.3.3.1.1.1.1.2.cmml">f</mi><mo id="S1.p4.2.m2.3.3.1.1.1.1.1" xref="S1.p4.2.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S1.p4.2.m2.3.3.1.1.1.1.3.2" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml"><mo id="S1.p4.2.m2.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">𝐱</mi><mo id="S1.p4.2.m2.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.2.m2.3.3.1.1.1.3" stretchy="false" xref="S1.p4.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.2.m2.3.3.2" xref="S1.p4.2.m2.3.3.2.cmml">=</mo><mrow id="S1.p4.2.m2.3.3.3" xref="S1.p4.2.m2.3.3.3.cmml"><mi id="S1.p4.2.m2.3.3.3.2" xref="S1.p4.2.m2.3.3.3.2.cmml">f</mi><mo id="S1.p4.2.m2.3.3.3.1" xref="S1.p4.2.m2.3.3.3.1.cmml">⁢</mo><mrow id="S1.p4.2.m2.3.3.3.3.2" xref="S1.p4.2.m2.3.3.3.cmml"><mo id="S1.p4.2.m2.3.3.3.3.2.1" stretchy="false" xref="S1.p4.2.m2.3.3.3.cmml">(</mo><mi id="S1.p4.2.m2.2.2" xref="S1.p4.2.m2.2.2.cmml">𝐱</mi><mo id="S1.p4.2.m2.3.3.3.3.2.2" stretchy="false" xref="S1.p4.2.m2.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.3b"><apply id="S1.p4.2.m2.3.3.cmml" xref="S1.p4.2.m2.3.3"><eq id="S1.p4.2.m2.3.3.2.cmml" xref="S1.p4.2.m2.3.3.2"></eq><apply id="S1.p4.2.m2.3.3.1.cmml" xref="S1.p4.2.m2.3.3.1"><times id="S1.p4.2.m2.3.3.1.2.cmml" xref="S1.p4.2.m2.3.3.1.2"></times><ci id="S1.p4.2.m2.3.3.1.3.cmml" xref="S1.p4.2.m2.3.3.1.3">𝑓</ci><apply id="S1.p4.2.m2.3.3.1.1.1.1.cmml" xref="S1.p4.2.m2.3.3.1.1.1"><times id="S1.p4.2.m2.3.3.1.1.1.1.1.cmml" xref="S1.p4.2.m2.3.3.1.1.1.1.1"></times><ci id="S1.p4.2.m2.3.3.1.1.1.1.2.cmml" xref="S1.p4.2.m2.3.3.1.1.1.1.2">𝑓</ci><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝐱</ci></apply></apply><apply id="S1.p4.2.m2.3.3.3.cmml" xref="S1.p4.2.m2.3.3.3"><times id="S1.p4.2.m2.3.3.3.1.cmml" xref="S1.p4.2.m2.3.3.3.1"></times><ci id="S1.p4.2.m2.3.3.3.2.cmml" xref="S1.p4.2.m2.3.3.3.2">𝑓</ci><ci id="S1.p4.2.m2.2.2.cmml" xref="S1.p4.2.m2.2.2">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.3c">f(f(\mathbf{x}))=f(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.3d">italic_f ( italic_f ( bold_x ) ) = italic_f ( bold_x )</annotation></semantics></math>. This can be understood as a generalization of orthogonal projection in linear spaces to non-linear settings. At training, IT<sup class="ltx_sup" id="S1.p4.17.1">3</sup> receives an input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><mi id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><ci id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">bold_x</annotation></semantics></math> along with another signal that can either be the ground truth label <math alttext="y" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><mi id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><ci id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">italic_y</annotation></semantics></math> or a neutral ”don’t know” signal <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><mn id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><cn id="S1.p4.6.m6.1.1.cmml" type="integer" xref="S1.p4.6.m6.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">bold_0</annotation></semantics></math>. <cite class="ltx_cite ltx_citemacro_cite">Durasov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib12" title="">2024a</a>)</cite> sequentially applied a model trained with this policy such that <math alttext="y_{0}=f(\mathbf{x},\mathbf{0})" class="ltx_Math" display="inline" id="S1.p4.7.m7.2"><semantics id="S1.p4.7.m7.2a"><mrow id="S1.p4.7.m7.2.3" xref="S1.p4.7.m7.2.3.cmml"><msub id="S1.p4.7.m7.2.3.2" xref="S1.p4.7.m7.2.3.2.cmml"><mi id="S1.p4.7.m7.2.3.2.2" xref="S1.p4.7.m7.2.3.2.2.cmml">y</mi><mn id="S1.p4.7.m7.2.3.2.3" xref="S1.p4.7.m7.2.3.2.3.cmml">0</mn></msub><mo id="S1.p4.7.m7.2.3.1" xref="S1.p4.7.m7.2.3.1.cmml">=</mo><mrow id="S1.p4.7.m7.2.3.3" xref="S1.p4.7.m7.2.3.3.cmml"><mi id="S1.p4.7.m7.2.3.3.2" xref="S1.p4.7.m7.2.3.3.2.cmml">f</mi><mo id="S1.p4.7.m7.2.3.3.1" xref="S1.p4.7.m7.2.3.3.1.cmml">⁢</mo><mrow id="S1.p4.7.m7.2.3.3.3.2" xref="S1.p4.7.m7.2.3.3.3.1.cmml"><mo id="S1.p4.7.m7.2.3.3.3.2.1" stretchy="false" xref="S1.p4.7.m7.2.3.3.3.1.cmml">(</mo><mi id="S1.p4.7.m7.1.1" xref="S1.p4.7.m7.1.1.cmml">𝐱</mi><mo id="S1.p4.7.m7.2.3.3.3.2.2" xref="S1.p4.7.m7.2.3.3.3.1.cmml">,</mo><mn id="S1.p4.7.m7.2.2" xref="S1.p4.7.m7.2.2.cmml">𝟎</mn><mo id="S1.p4.7.m7.2.3.3.3.2.3" stretchy="false" xref="S1.p4.7.m7.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.7.m7.2b"><apply id="S1.p4.7.m7.2.3.cmml" xref="S1.p4.7.m7.2.3"><eq id="S1.p4.7.m7.2.3.1.cmml" xref="S1.p4.7.m7.2.3.1"></eq><apply id="S1.p4.7.m7.2.3.2.cmml" xref="S1.p4.7.m7.2.3.2"><csymbol cd="ambiguous" id="S1.p4.7.m7.2.3.2.1.cmml" xref="S1.p4.7.m7.2.3.2">subscript</csymbol><ci id="S1.p4.7.m7.2.3.2.2.cmml" xref="S1.p4.7.m7.2.3.2.2">𝑦</ci><cn id="S1.p4.7.m7.2.3.2.3.cmml" type="integer" xref="S1.p4.7.m7.2.3.2.3">0</cn></apply><apply id="S1.p4.7.m7.2.3.3.cmml" xref="S1.p4.7.m7.2.3.3"><times id="S1.p4.7.m7.2.3.3.1.cmml" xref="S1.p4.7.m7.2.3.3.1"></times><ci id="S1.p4.7.m7.2.3.3.2.cmml" xref="S1.p4.7.m7.2.3.3.2">𝑓</ci><interval closure="open" id="S1.p4.7.m7.2.3.3.3.1.cmml" xref="S1.p4.7.m7.2.3.3.3.2"><ci id="S1.p4.7.m7.1.1.cmml" xref="S1.p4.7.m7.1.1">𝐱</ci><cn id="S1.p4.7.m7.2.2.cmml" type="integer" xref="S1.p4.7.m7.2.2">0</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.7.m7.2c">y_{0}=f(\mathbf{x},\mathbf{0})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.7.m7.2d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_f ( bold_x , bold_0 )</annotation></semantics></math> and <math alttext="y_{1}=f(\mathbf{x},y_{0})" class="ltx_Math" display="inline" id="S1.p4.8.m8.2"><semantics id="S1.p4.8.m8.2a"><mrow id="S1.p4.8.m8.2.2" xref="S1.p4.8.m8.2.2.cmml"><msub id="S1.p4.8.m8.2.2.3" xref="S1.p4.8.m8.2.2.3.cmml"><mi id="S1.p4.8.m8.2.2.3.2" xref="S1.p4.8.m8.2.2.3.2.cmml">y</mi><mn id="S1.p4.8.m8.2.2.3.3" xref="S1.p4.8.m8.2.2.3.3.cmml">1</mn></msub><mo id="S1.p4.8.m8.2.2.2" xref="S1.p4.8.m8.2.2.2.cmml">=</mo><mrow id="S1.p4.8.m8.2.2.1" xref="S1.p4.8.m8.2.2.1.cmml"><mi id="S1.p4.8.m8.2.2.1.3" xref="S1.p4.8.m8.2.2.1.3.cmml">f</mi><mo id="S1.p4.8.m8.2.2.1.2" xref="S1.p4.8.m8.2.2.1.2.cmml">⁢</mo><mrow id="S1.p4.8.m8.2.2.1.1.1" xref="S1.p4.8.m8.2.2.1.1.2.cmml"><mo id="S1.p4.8.m8.2.2.1.1.1.2" stretchy="false" xref="S1.p4.8.m8.2.2.1.1.2.cmml">(</mo><mi id="S1.p4.8.m8.1.1" xref="S1.p4.8.m8.1.1.cmml">𝐱</mi><mo id="S1.p4.8.m8.2.2.1.1.1.3" xref="S1.p4.8.m8.2.2.1.1.2.cmml">,</mo><msub id="S1.p4.8.m8.2.2.1.1.1.1" xref="S1.p4.8.m8.2.2.1.1.1.1.cmml"><mi id="S1.p4.8.m8.2.2.1.1.1.1.2" xref="S1.p4.8.m8.2.2.1.1.1.1.2.cmml">y</mi><mn id="S1.p4.8.m8.2.2.1.1.1.1.3" xref="S1.p4.8.m8.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S1.p4.8.m8.2.2.1.1.1.4" stretchy="false" xref="S1.p4.8.m8.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.8.m8.2b"><apply id="S1.p4.8.m8.2.2.cmml" xref="S1.p4.8.m8.2.2"><eq id="S1.p4.8.m8.2.2.2.cmml" xref="S1.p4.8.m8.2.2.2"></eq><apply id="S1.p4.8.m8.2.2.3.cmml" xref="S1.p4.8.m8.2.2.3"><csymbol cd="ambiguous" id="S1.p4.8.m8.2.2.3.1.cmml" xref="S1.p4.8.m8.2.2.3">subscript</csymbol><ci id="S1.p4.8.m8.2.2.3.2.cmml" xref="S1.p4.8.m8.2.2.3.2">𝑦</ci><cn id="S1.p4.8.m8.2.2.3.3.cmml" type="integer" xref="S1.p4.8.m8.2.2.3.3">1</cn></apply><apply id="S1.p4.8.m8.2.2.1.cmml" xref="S1.p4.8.m8.2.2.1"><times id="S1.p4.8.m8.2.2.1.2.cmml" xref="S1.p4.8.m8.2.2.1.2"></times><ci id="S1.p4.8.m8.2.2.1.3.cmml" xref="S1.p4.8.m8.2.2.1.3">𝑓</ci><interval closure="open" id="S1.p4.8.m8.2.2.1.1.2.cmml" xref="S1.p4.8.m8.2.2.1.1.1"><ci id="S1.p4.8.m8.1.1.cmml" xref="S1.p4.8.m8.1.1">𝐱</ci><apply id="S1.p4.8.m8.2.2.1.1.1.1.cmml" xref="S1.p4.8.m8.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p4.8.m8.2.2.1.1.1.1.1.cmml" xref="S1.p4.8.m8.2.2.1.1.1.1">subscript</csymbol><ci id="S1.p4.8.m8.2.2.1.1.1.1.2.cmml" xref="S1.p4.8.m8.2.2.1.1.1.1.2">𝑦</ci><cn id="S1.p4.8.m8.2.2.1.1.1.1.3.cmml" type="integer" xref="S1.p4.8.m8.2.2.1.1.1.1.3">0</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.8.m8.2c">y_{1}=f(\mathbf{x},y_{0})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.8.m8.2d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_f ( bold_x , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. The distance <math alttext="||y_{0}-y_{1}||" class="ltx_Math" display="inline" id="S1.p4.9.m9.1"><semantics id="S1.p4.9.m9.1a"><mrow id="S1.p4.9.m9.1.1.1" xref="S1.p4.9.m9.1.1.2.cmml"><mo id="S1.p4.9.m9.1.1.1.2" stretchy="false" xref="S1.p4.9.m9.1.1.2.1.cmml">‖</mo><mrow id="S1.p4.9.m9.1.1.1.1" xref="S1.p4.9.m9.1.1.1.1.cmml"><msub id="S1.p4.9.m9.1.1.1.1.2" xref="S1.p4.9.m9.1.1.1.1.2.cmml"><mi id="S1.p4.9.m9.1.1.1.1.2.2" xref="S1.p4.9.m9.1.1.1.1.2.2.cmml">y</mi><mn id="S1.p4.9.m9.1.1.1.1.2.3" xref="S1.p4.9.m9.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S1.p4.9.m9.1.1.1.1.1" xref="S1.p4.9.m9.1.1.1.1.1.cmml">−</mo><msub id="S1.p4.9.m9.1.1.1.1.3" xref="S1.p4.9.m9.1.1.1.1.3.cmml"><mi id="S1.p4.9.m9.1.1.1.1.3.2" xref="S1.p4.9.m9.1.1.1.1.3.2.cmml">y</mi><mn id="S1.p4.9.m9.1.1.1.1.3.3" xref="S1.p4.9.m9.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S1.p4.9.m9.1.1.1.3" stretchy="false" xref="S1.p4.9.m9.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.9.m9.1b"><apply id="S1.p4.9.m9.1.1.2.cmml" xref="S1.p4.9.m9.1.1.1"><csymbol cd="latexml" id="S1.p4.9.m9.1.1.2.1.cmml" xref="S1.p4.9.m9.1.1.1.2">norm</csymbol><apply id="S1.p4.9.m9.1.1.1.1.cmml" xref="S1.p4.9.m9.1.1.1.1"><minus id="S1.p4.9.m9.1.1.1.1.1.cmml" xref="S1.p4.9.m9.1.1.1.1.1"></minus><apply id="S1.p4.9.m9.1.1.1.1.2.cmml" xref="S1.p4.9.m9.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.p4.9.m9.1.1.1.1.2.1.cmml" xref="S1.p4.9.m9.1.1.1.1.2">subscript</csymbol><ci id="S1.p4.9.m9.1.1.1.1.2.2.cmml" xref="S1.p4.9.m9.1.1.1.1.2.2">𝑦</ci><cn id="S1.p4.9.m9.1.1.1.1.2.3.cmml" type="integer" xref="S1.p4.9.m9.1.1.1.1.2.3">0</cn></apply><apply id="S1.p4.9.m9.1.1.1.1.3.cmml" xref="S1.p4.9.m9.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.p4.9.m9.1.1.1.1.3.1.cmml" xref="S1.p4.9.m9.1.1.1.1.3">subscript</csymbol><ci id="S1.p4.9.m9.1.1.1.1.3.2.cmml" xref="S1.p4.9.m9.1.1.1.1.3.2">𝑦</ci><cn id="S1.p4.9.m9.1.1.1.1.3.3.cmml" type="integer" xref="S1.p4.9.m9.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.9.m9.1c">||y_{0}-y_{1}||</annotation><annotation encoding="application/x-llamapun" id="S1.p4.9.m9.1d">| | italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | |</annotation></semantics></math> was shown to indicate both the prediction uncertainty and whether <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S1.p4.10.m10.1"><semantics id="S1.p4.10.m10.1a"><mi id="S1.p4.10.m10.1.1" xref="S1.p4.10.m10.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p4.10.m10.1b"><ci id="S1.p4.10.m10.1.1.cmml" xref="S1.p4.10.m10.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.10.m10.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.10.m10.1d">bold_x</annotation></semantics></math> is out-of-distribution (OOD). What if, at test time, we could actively minimize this distance whenever we encounter an instance? Could we “pull it” into the distribution? IT<sup class="ltx_sup" id="S1.p4.17.2">3</sup> uses this this distance as a loss for TTT sessions. When we unfold <math alttext="y_{0}" class="ltx_Math" display="inline" id="S1.p4.12.m12.1"><semantics id="S1.p4.12.m12.1a"><msub id="S1.p4.12.m12.1.1" xref="S1.p4.12.m12.1.1.cmml"><mi id="S1.p4.12.m12.1.1.2" xref="S1.p4.12.m12.1.1.2.cmml">y</mi><mn id="S1.p4.12.m12.1.1.3" xref="S1.p4.12.m12.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.12.m12.1b"><apply id="S1.p4.12.m12.1.1.cmml" xref="S1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S1.p4.12.m12.1.1.1.cmml" xref="S1.p4.12.m12.1.1">subscript</csymbol><ci id="S1.p4.12.m12.1.1.2.cmml" xref="S1.p4.12.m12.1.1.2">𝑦</ci><cn id="S1.p4.12.m12.1.1.3.cmml" type="integer" xref="S1.p4.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.12.m12.1c">y_{0}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.12.m12.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{1}" class="ltx_Math" display="inline" id="S1.p4.13.m13.1"><semantics id="S1.p4.13.m13.1a"><msub id="S1.p4.13.m13.1.1" xref="S1.p4.13.m13.1.1.cmml"><mi id="S1.p4.13.m13.1.1.2" xref="S1.p4.13.m13.1.1.2.cmml">y</mi><mn id="S1.p4.13.m13.1.1.3" xref="S1.p4.13.m13.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.13.m13.1b"><apply id="S1.p4.13.m13.1.1.cmml" xref="S1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S1.p4.13.m13.1.1.1.cmml" xref="S1.p4.13.m13.1.1">subscript</csymbol><ci id="S1.p4.13.m13.1.1.2.cmml" xref="S1.p4.13.m13.1.1.2">𝑦</ci><cn id="S1.p4.13.m13.1.1.3.cmml" type="integer" xref="S1.p4.13.m13.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.13.m13.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.13.m13.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> in such a loss term we obtain: <math alttext="||f(\mathbf{x},f(\mathbf{x},\mathbf{0}))-f(\mathbf{x},\mathbf{0})||" class="ltx_Math" display="inline" id="S1.p4.14.m14.6"><semantics id="S1.p4.14.m14.6a"><mrow id="S1.p4.14.m14.6.6.1" xref="S1.p4.14.m14.6.6.2.cmml"><mo id="S1.p4.14.m14.6.6.1.2" stretchy="false" xref="S1.p4.14.m14.6.6.2.1.cmml">‖</mo><mrow id="S1.p4.14.m14.6.6.1.1" xref="S1.p4.14.m14.6.6.1.1.cmml"><mrow id="S1.p4.14.m14.6.6.1.1.1" xref="S1.p4.14.m14.6.6.1.1.1.cmml"><mi id="S1.p4.14.m14.6.6.1.1.1.3" xref="S1.p4.14.m14.6.6.1.1.1.3.cmml">f</mi><mo id="S1.p4.14.m14.6.6.1.1.1.2" xref="S1.p4.14.m14.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S1.p4.14.m14.6.6.1.1.1.1.1" xref="S1.p4.14.m14.6.6.1.1.1.1.2.cmml"><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.2" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.1.1.2.cmml">(</mo><mi id="S1.p4.14.m14.3.3" xref="S1.p4.14.m14.3.3.cmml">𝐱</mi><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.3" xref="S1.p4.14.m14.6.6.1.1.1.1.2.cmml">,</mo><mrow id="S1.p4.14.m14.6.6.1.1.1.1.1.1" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.cmml"><mi id="S1.p4.14.m14.6.6.1.1.1.1.1.1.2" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.2.cmml">f</mi><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.1.1" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.2" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.1.cmml"><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S1.p4.14.m14.1.1" xref="S1.p4.14.m14.1.1.cmml">𝐱</mi><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.2.2" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.1.cmml">,</mo><mn id="S1.p4.14.m14.2.2" xref="S1.p4.14.m14.2.2.cmml">𝟎</mn><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.14.m14.6.6.1.1.1.1.1.4" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S1.p4.14.m14.6.6.1.1.2" xref="S1.p4.14.m14.6.6.1.1.2.cmml">−</mo><mrow id="S1.p4.14.m14.6.6.1.1.3" xref="S1.p4.14.m14.6.6.1.1.3.cmml"><mi id="S1.p4.14.m14.6.6.1.1.3.2" xref="S1.p4.14.m14.6.6.1.1.3.2.cmml">f</mi><mo id="S1.p4.14.m14.6.6.1.1.3.1" xref="S1.p4.14.m14.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S1.p4.14.m14.6.6.1.1.3.3.2" xref="S1.p4.14.m14.6.6.1.1.3.3.1.cmml"><mo id="S1.p4.14.m14.6.6.1.1.3.3.2.1" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.3.3.1.cmml">(</mo><mi id="S1.p4.14.m14.4.4" xref="S1.p4.14.m14.4.4.cmml">𝐱</mi><mo id="S1.p4.14.m14.6.6.1.1.3.3.2.2" xref="S1.p4.14.m14.6.6.1.1.3.3.1.cmml">,</mo><mn id="S1.p4.14.m14.5.5" xref="S1.p4.14.m14.5.5.cmml">𝟎</mn><mo id="S1.p4.14.m14.6.6.1.1.3.3.2.3" stretchy="false" xref="S1.p4.14.m14.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p4.14.m14.6.6.1.3" stretchy="false" xref="S1.p4.14.m14.6.6.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.14.m14.6b"><apply id="S1.p4.14.m14.6.6.2.cmml" xref="S1.p4.14.m14.6.6.1"><csymbol cd="latexml" id="S1.p4.14.m14.6.6.2.1.cmml" xref="S1.p4.14.m14.6.6.1.2">norm</csymbol><apply id="S1.p4.14.m14.6.6.1.1.cmml" xref="S1.p4.14.m14.6.6.1.1"><minus id="S1.p4.14.m14.6.6.1.1.2.cmml" xref="S1.p4.14.m14.6.6.1.1.2"></minus><apply id="S1.p4.14.m14.6.6.1.1.1.cmml" xref="S1.p4.14.m14.6.6.1.1.1"><times id="S1.p4.14.m14.6.6.1.1.1.2.cmml" xref="S1.p4.14.m14.6.6.1.1.1.2"></times><ci id="S1.p4.14.m14.6.6.1.1.1.3.cmml" xref="S1.p4.14.m14.6.6.1.1.1.3">𝑓</ci><interval closure="open" id="S1.p4.14.m14.6.6.1.1.1.1.2.cmml" xref="S1.p4.14.m14.6.6.1.1.1.1.1"><ci id="S1.p4.14.m14.3.3.cmml" xref="S1.p4.14.m14.3.3">𝐱</ci><apply id="S1.p4.14.m14.6.6.1.1.1.1.1.1.cmml" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1"><times id="S1.p4.14.m14.6.6.1.1.1.1.1.1.1.cmml" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.1"></times><ci id="S1.p4.14.m14.6.6.1.1.1.1.1.1.2.cmml" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.2">𝑓</ci><interval closure="open" id="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.1.cmml" xref="S1.p4.14.m14.6.6.1.1.1.1.1.1.3.2"><ci id="S1.p4.14.m14.1.1.cmml" xref="S1.p4.14.m14.1.1">𝐱</ci><cn id="S1.p4.14.m14.2.2.cmml" type="integer" xref="S1.p4.14.m14.2.2">0</cn></interval></apply></interval></apply><apply id="S1.p4.14.m14.6.6.1.1.3.cmml" xref="S1.p4.14.m14.6.6.1.1.3"><times id="S1.p4.14.m14.6.6.1.1.3.1.cmml" xref="S1.p4.14.m14.6.6.1.1.3.1"></times><ci id="S1.p4.14.m14.6.6.1.1.3.2.cmml" xref="S1.p4.14.m14.6.6.1.1.3.2">𝑓</ci><interval closure="open" id="S1.p4.14.m14.6.6.1.1.3.3.1.cmml" xref="S1.p4.14.m14.6.6.1.1.3.3.2"><ci id="S1.p4.14.m14.4.4.cmml" xref="S1.p4.14.m14.4.4">𝐱</ci><cn id="S1.p4.14.m14.5.5.cmml" type="integer" xref="S1.p4.14.m14.5.5">0</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.14.m14.6c">||f(\mathbf{x},f(\mathbf{x},\mathbf{0}))-f(\mathbf{x},\mathbf{0})||</annotation><annotation encoding="application/x-llamapun" id="S1.p4.14.m14.6d">| | italic_f ( bold_x , italic_f ( bold_x , bold_0 ) ) - italic_f ( bold_x , bold_0 ) | |</annotation></semantics></math>. A more detailed analysis of this term reveals an important insight: the optimization objective effectively guides the model towards making <math alttext="f(\mathbf{x},\cdot)" class="ltx_Math" display="inline" id="S1.p4.15.m15.2"><semantics id="S1.p4.15.m15.2a"><mrow id="S1.p4.15.m15.2.3" xref="S1.p4.15.m15.2.3.cmml"><mi id="S1.p4.15.m15.2.3.2" xref="S1.p4.15.m15.2.3.2.cmml">f</mi><mo id="S1.p4.15.m15.2.3.1" xref="S1.p4.15.m15.2.3.1.cmml">⁢</mo><mrow id="S1.p4.15.m15.2.3.3.2" xref="S1.p4.15.m15.2.3.3.1.cmml"><mo id="S1.p4.15.m15.2.3.3.2.1" stretchy="false" xref="S1.p4.15.m15.2.3.3.1.cmml">(</mo><mi id="S1.p4.15.m15.1.1" xref="S1.p4.15.m15.1.1.cmml">𝐱</mi><mo id="S1.p4.15.m15.2.3.3.2.2" rspace="0em" xref="S1.p4.15.m15.2.3.3.1.cmml">,</mo><mo id="S1.p4.15.m15.2.2" lspace="0em" rspace="0em" xref="S1.p4.15.m15.2.2.cmml">⋅</mo><mo id="S1.p4.15.m15.2.3.3.2.3" stretchy="false" xref="S1.p4.15.m15.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.15.m15.2b"><apply id="S1.p4.15.m15.2.3.cmml" xref="S1.p4.15.m15.2.3"><times id="S1.p4.15.m15.2.3.1.cmml" xref="S1.p4.15.m15.2.3.1"></times><ci id="S1.p4.15.m15.2.3.2.cmml" xref="S1.p4.15.m15.2.3.2">𝑓</ci><interval closure="open" id="S1.p4.15.m15.2.3.3.1.cmml" xref="S1.p4.15.m15.2.3.3.2"><ci id="S1.p4.15.m15.1.1.cmml" xref="S1.p4.15.m15.1.1">𝐱</ci><ci id="S1.p4.15.m15.2.2.cmml" xref="S1.p4.15.m15.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.15.m15.2c">f(\mathbf{x},\cdot)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.15.m15.2d">italic_f ( bold_x , ⋅ )</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="S1.p4.17.3">idempotent</span>. While not trivial, it has been demonstrated that, with appropriate adjustments, training a model to achieve idempotence is feasible <cite class="ltx_cite ltx_citemacro_citep">(Shocher et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib37" title="">2024</a>)</cite>. This ties everything together: idempotence, seen as a generalization of projection, suggests the existence of a subset onto which the model maps the internal representation of the input. In our case, this subset exists in the joint <math alttext="X\times Y" class="ltx_Math" display="inline" id="S1.p4.16.m16.1"><semantics id="S1.p4.16.m16.1a"><mrow id="S1.p4.16.m16.1.1" xref="S1.p4.16.m16.1.1.cmml"><mi id="S1.p4.16.m16.1.1.2" xref="S1.p4.16.m16.1.1.2.cmml">X</mi><mo id="S1.p4.16.m16.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p4.16.m16.1.1.1.cmml">×</mo><mi id="S1.p4.16.m16.1.1.3" xref="S1.p4.16.m16.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.16.m16.1b"><apply id="S1.p4.16.m16.1.1.cmml" xref="S1.p4.16.m16.1.1"><times id="S1.p4.16.m16.1.1.1.cmml" xref="S1.p4.16.m16.1.1.1"></times><ci id="S1.p4.16.m16.1.1.2.cmml" xref="S1.p4.16.m16.1.1.2">𝑋</ci><ci id="S1.p4.16.m16.1.1.3.cmml" xref="S1.p4.16.m16.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.16.m16.1c">X\times Y</annotation><annotation encoding="application/x-llamapun" id="S1.p4.16.m16.1d">italic_X × italic_Y</annotation></semantics></math> space, and corresponds roughly to the distribution of correctly paired <math alttext="\mathbf{x},\mathbf{y}" class="ltx_Math" display="inline" id="S1.p4.17.m17.2"><semantics id="S1.p4.17.m17.2a"><mrow id="S1.p4.17.m17.2.3.2" xref="S1.p4.17.m17.2.3.1.cmml"><mi id="S1.p4.17.m17.1.1" xref="S1.p4.17.m17.1.1.cmml">𝐱</mi><mo id="S1.p4.17.m17.2.3.2.1" xref="S1.p4.17.m17.2.3.1.cmml">,</mo><mi id="S1.p4.17.m17.2.2" xref="S1.p4.17.m17.2.2.cmml">𝐲</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.17.m17.2b"><list id="S1.p4.17.m17.2.3.1.cmml" xref="S1.p4.17.m17.2.3.2"><ci id="S1.p4.17.m17.1.1.cmml" xref="S1.p4.17.m17.1.1">𝐱</ci><ci id="S1.p4.17.m17.2.2.cmml" xref="S1.p4.17.m17.2.2">𝐲</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.17.m17.2c">\mathbf{x},\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.17.m17.2d">bold_x , bold_y</annotation></semantics></math> examples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The result is a global method that does not rely on any specific domain properties. This is in contrast to prior TTT methods that rely on a domain specific auxiliary task. By leveraging the universal property of idempotence, IT<sup class="ltx_sup" id="S1.p5.1.1">3</sup> can adapt OOD test inputs on-the-fly across various domains, tasks and architectures.
This includes image classification with corruptions, aerodynamic predictions for airfoils and cars, tabular data with missing information, age prediction from faces, and large-scale aerial photo segmentation, using MLPs, CNNs, or GNNs.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">IT<sup class="ltx_sup" id="S2.p1.1.1">3</sup> relies on the notion of <span class="ltx_text ltx_font_italic" id="S2.p1.1.2">idempotence</span> to globalize <span class="ltx_text ltx_font_italic" id="S2.p1.1.3">TTT</span>. We briefly review these two fields.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Test-Time Training</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The idea of leveraging test data for model adaptation dates back to methods like transductive learning  <cite class="ltx_cite ltx_citemacro_citep">(Gammerman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib17" title="">1998</a>)</cite>. Early approaches, such as transductive SVMs <cite class="ltx_cite ltx_citemacro_citep">(Collobert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib9" title="">2006</a>)</cite> and local learning <cite class="ltx_cite ltx_citemacro_citep">(Bottou &amp; Vapnik, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib5" title="">1992</a>)</cite>, aimed to adapt predictions for specific test samples rather than generalizing across unseen data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Training neural networks solely on single test instances, without pre-training, has been demonstrated in the ”deep internal learning” line of works, for many image enhancement tasks <cite class="ltx_cite ltx_citemacro_citep">(Shocher et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib35" title="">2018</a>; Gandelsman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib18" title="">2019</a>)</cite> and single image generative models <cite class="ltx_cite ltx_citemacro_citep">(Shocher et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib36" title="">2019</a>; Shaham et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib34" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Test-Time Training (TTT) has emerged as a solution to the problem of generalization under distribution shifts. Using a pre-trained network and at test-time refining on a single instance each time. In the foundational work of <cite class="ltx_cite ltx_citemacro_citet">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib38" title="">2020</a>)</cite>, the model is adjusted in real-time by solving an auxiliary self-supervised task, such as predicting image rotations, on each test sample. This on-the-fly adaptation has proven effective in improving robustness on corrupted and Out-Of-Distribution (OOD) data. As the self-supervised learning methods became more efficient <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib21" title="">2022</a>)</cite>, they could be exploited for TTT <cite class="ltx_cite ltx_citemacro_citep">(Gandelsman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib19" title="">2022</a>)</cite>.
Extensions such as TTT++ <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib29" title="">2021</a>)</cite> assume access to the entire test set. TENT <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib39" title="">2021</a>)</cite> adapts during inference in the batch level, based on the batch entropy, but cannot be applied to single instances or very small batches. Moreover, it relies on updating the model’s normalization layers, making it architecture dependent.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Idempotence in Deep Learning</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Idempotence, a concept rooted in mathematics and functional programming, refers to an operation where repeated application yields the same result as a single application. Mathematically, for a function <math alttext="f" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_f</annotation></semantics></math>, being idempotent means</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(f(x))=f(x),\quad\forall x\;." class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.3.cmml">f</mi><mo id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">f</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">x</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.1.1" xref="S2.E1.m1.3.3.1.1.2.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.2.1.1.2" xref="S2.E1.m1.3.3.1.1.2.1.1.2.cmml">f</mi><mo id="S2.E1.m1.3.3.1.1.2.1.1.1" xref="S2.E1.m1.3.3.1.1.2.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.2.1.1.3.2" xref="S2.E1.m1.3.3.1.1.2.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.2.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.3.3.1.1.2.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.3.2.3" rspace="1.167em" xref="S2.E1.m1.3.3.1.1.3.3.cmml">,</mo><mrow id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml"><mo id="S2.E1.m1.3.3.1.1.3.2.2.1" rspace="0.167em" xref="S2.E1.m1.3.3.1.1.3.2.2.1.cmml">∀</mo><mi id="S2.E1.m1.3.3.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.cmml">x</mi></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4"></eq><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.2"></times><ci id="S2.E1.m1.3.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3">𝑓</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑥</ci></apply></apply><list id="S2.E1.m1.3.3.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><apply id="S2.E1.m1.3.3.1.1.2.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1"><times id="S2.E1.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.1"></times><ci id="S2.E1.m1.3.3.1.1.2.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.1.1.2">𝑓</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.1">for-all</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2">𝑥</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">f(f(x))=f(x),\quad\forall x\;.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">italic_f ( italic_f ( italic_x ) ) = italic_f ( italic_x ) , ∀ italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.6">In other words, applying the function multiple times has no effect beyond the first application.
In the context of linear operators, idempotence corresponds to orthogonal projection. Over <math alttext="\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m1.1"><semantics id="S2.SS2.p1.2.m1.1a"><msup id="S2.SS2.p1.2.m1.1.1" xref="S2.SS2.p1.2.m1.1.1.cmml"><mi id="S2.SS2.p1.2.m1.1.1.2" xref="S2.SS2.p1.2.m1.1.1.2.cmml">ℝ</mi><mi id="S2.SS2.p1.2.m1.1.1.3" xref="S2.SS2.p1.2.m1.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m1.1b"><apply id="S2.SS2.p1.2.m1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m1.1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1">superscript</csymbol><ci id="S2.SS2.p1.2.m1.1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.2">ℝ</ci><ci id="S2.SS2.p1.2.m1.1.1.3.cmml" xref="S2.SS2.p1.2.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m1.1c">\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m1.1d">blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, these are matrices <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m2.1"><semantics id="S2.SS2.p1.3.m2.1a"><mi id="S2.SS2.p1.3.m2.1.1" xref="S2.SS2.p1.3.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m2.1b"><ci id="S2.SS2.p1.3.m2.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m2.1d">italic_A</annotation></semantics></math> that satisfy <math alttext="A^{2}=A" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m3.1"><semantics id="S2.SS2.p1.4.m3.1a"><mrow id="S2.SS2.p1.4.m3.1.1" xref="S2.SS2.p1.4.m3.1.1.cmml"><msup id="S2.SS2.p1.4.m3.1.1.2" xref="S2.SS2.p1.4.m3.1.1.2.cmml"><mi id="S2.SS2.p1.4.m3.1.1.2.2" xref="S2.SS2.p1.4.m3.1.1.2.2.cmml">A</mi><mn id="S2.SS2.p1.4.m3.1.1.2.3" xref="S2.SS2.p1.4.m3.1.1.2.3.cmml">2</mn></msup><mo id="S2.SS2.p1.4.m3.1.1.1" xref="S2.SS2.p1.4.m3.1.1.1.cmml">=</mo><mi id="S2.SS2.p1.4.m3.1.1.3" xref="S2.SS2.p1.4.m3.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m3.1b"><apply id="S2.SS2.p1.4.m3.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1"><eq id="S2.SS2.p1.4.m3.1.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1"></eq><apply id="S2.SS2.p1.4.m3.1.1.2.cmml" xref="S2.SS2.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.2.1.cmml" xref="S2.SS2.p1.4.m3.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.2.2.cmml" xref="S2.SS2.p1.4.m3.1.1.2.2">𝐴</ci><cn id="S2.SS2.p1.4.m3.1.1.2.3.cmml" type="integer" xref="S2.SS2.p1.4.m3.1.1.2.3">2</cn></apply><ci id="S2.SS2.p1.4.m3.1.1.3.cmml" xref="S2.SS2.p1.4.m3.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m3.1c">A^{2}=A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m3.1d">italic_A start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_A</annotation></semantics></math>, with eigenvalues of either 0 or 1; they can be interpreted as geometrically preserving certain components while nullifying others.
This concept was recently applied in generative modeling. Idempotent Generative Network (IGN) <cite class="ltx_cite ltx_citemacro_citep">(Shocher et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib37" title="">2024</a>)</cite> is a generative model that maps data instances to themselves, <math alttext="f(x)=x" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m4.1"><semantics id="S2.SS2.p1.5.m4.1a"><mrow id="S2.SS2.p1.5.m4.1.2" xref="S2.SS2.p1.5.m4.1.2.cmml"><mrow id="S2.SS2.p1.5.m4.1.2.2" xref="S2.SS2.p1.5.m4.1.2.2.cmml"><mi id="S2.SS2.p1.5.m4.1.2.2.2" xref="S2.SS2.p1.5.m4.1.2.2.2.cmml">f</mi><mo id="S2.SS2.p1.5.m4.1.2.2.1" xref="S2.SS2.p1.5.m4.1.2.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.5.m4.1.2.2.3.2" xref="S2.SS2.p1.5.m4.1.2.2.cmml"><mo id="S2.SS2.p1.5.m4.1.2.2.3.2.1" stretchy="false" xref="S2.SS2.p1.5.m4.1.2.2.cmml">(</mo><mi id="S2.SS2.p1.5.m4.1.1" xref="S2.SS2.p1.5.m4.1.1.cmml">x</mi><mo id="S2.SS2.p1.5.m4.1.2.2.3.2.2" stretchy="false" xref="S2.SS2.p1.5.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.5.m4.1.2.1" xref="S2.SS2.p1.5.m4.1.2.1.cmml">=</mo><mi id="S2.SS2.p1.5.m4.1.2.3" xref="S2.SS2.p1.5.m4.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m4.1b"><apply id="S2.SS2.p1.5.m4.1.2.cmml" xref="S2.SS2.p1.5.m4.1.2"><eq id="S2.SS2.p1.5.m4.1.2.1.cmml" xref="S2.SS2.p1.5.m4.1.2.1"></eq><apply id="S2.SS2.p1.5.m4.1.2.2.cmml" xref="S2.SS2.p1.5.m4.1.2.2"><times id="S2.SS2.p1.5.m4.1.2.2.1.cmml" xref="S2.SS2.p1.5.m4.1.2.2.1"></times><ci id="S2.SS2.p1.5.m4.1.2.2.2.cmml" xref="S2.SS2.p1.5.m4.1.2.2.2">𝑓</ci><ci id="S2.SS2.p1.5.m4.1.1.cmml" xref="S2.SS2.p1.5.m4.1.1">𝑥</ci></apply><ci id="S2.SS2.p1.5.m4.1.2.3.cmml" xref="S2.SS2.p1.5.m4.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m4.1c">f(x)=x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m4.1d">italic_f ( italic_x ) = italic_x</annotation></semantics></math>, and maps latents to targets that also map to themselves, <math alttext="f(f(z))=f(z)" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m5.3"><semantics id="S2.SS2.p1.6.m5.3a"><mrow id="S2.SS2.p1.6.m5.3.3" xref="S2.SS2.p1.6.m5.3.3.cmml"><mrow id="S2.SS2.p1.6.m5.3.3.1" xref="S2.SS2.p1.6.m5.3.3.1.cmml"><mi id="S2.SS2.p1.6.m5.3.3.1.3" xref="S2.SS2.p1.6.m5.3.3.1.3.cmml">f</mi><mo id="S2.SS2.p1.6.m5.3.3.1.2" xref="S2.SS2.p1.6.m5.3.3.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.3.3.1.1.1" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml"><mo id="S2.SS2.p1.6.m5.3.3.1.1.1.2" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.6.m5.3.3.1.1.1.1" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m5.3.3.1.1.1.1.2" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.2.cmml">f</mi><mo id="S2.SS2.p1.6.m5.3.3.1.1.1.1.1" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.3.3.1.1.1.1.3.2" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml"><mo id="S2.SS2.p1.6.m5.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml">(</mo><mi id="S2.SS2.p1.6.m5.1.1" xref="S2.SS2.p1.6.m5.1.1.cmml">z</mi><mo id="S2.SS2.p1.6.m5.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.6.m5.3.3.1.1.1.3" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.6.m5.3.3.2" xref="S2.SS2.p1.6.m5.3.3.2.cmml">=</mo><mrow id="S2.SS2.p1.6.m5.3.3.3" xref="S2.SS2.p1.6.m5.3.3.3.cmml"><mi id="S2.SS2.p1.6.m5.3.3.3.2" xref="S2.SS2.p1.6.m5.3.3.3.2.cmml">f</mi><mo id="S2.SS2.p1.6.m5.3.3.3.1" xref="S2.SS2.p1.6.m5.3.3.3.1.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.3.3.3.3.2" xref="S2.SS2.p1.6.m5.3.3.3.cmml"><mo id="S2.SS2.p1.6.m5.3.3.3.3.2.1" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.3.cmml">(</mo><mi id="S2.SS2.p1.6.m5.2.2" xref="S2.SS2.p1.6.m5.2.2.cmml">z</mi><mo id="S2.SS2.p1.6.m5.3.3.3.3.2.2" stretchy="false" xref="S2.SS2.p1.6.m5.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m5.3b"><apply id="S2.SS2.p1.6.m5.3.3.cmml" xref="S2.SS2.p1.6.m5.3.3"><eq id="S2.SS2.p1.6.m5.3.3.2.cmml" xref="S2.SS2.p1.6.m5.3.3.2"></eq><apply id="S2.SS2.p1.6.m5.3.3.1.cmml" xref="S2.SS2.p1.6.m5.3.3.1"><times id="S2.SS2.p1.6.m5.3.3.1.2.cmml" xref="S2.SS2.p1.6.m5.3.3.1.2"></times><ci id="S2.SS2.p1.6.m5.3.3.1.3.cmml" xref="S2.SS2.p1.6.m5.3.3.1.3">𝑓</ci><apply id="S2.SS2.p1.6.m5.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.3.3.1.1.1"><times id="S2.SS2.p1.6.m5.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.1"></times><ci id="S2.SS2.p1.6.m5.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m5.3.3.1.1.1.1.2">𝑓</ci><ci id="S2.SS2.p1.6.m5.1.1.cmml" xref="S2.SS2.p1.6.m5.1.1">𝑧</ci></apply></apply><apply id="S2.SS2.p1.6.m5.3.3.3.cmml" xref="S2.SS2.p1.6.m5.3.3.3"><times id="S2.SS2.p1.6.m5.3.3.3.1.cmml" xref="S2.SS2.p1.6.m5.3.3.3.1"></times><ci id="S2.SS2.p1.6.m5.3.3.3.2.cmml" xref="S2.SS2.p1.6.m5.3.3.3.2">𝑓</ci><ci id="S2.SS2.p1.6.m5.2.2.cmml" xref="S2.SS2.p1.6.m5.2.2">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m5.3c">f(f(z))=f(z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m5.3d">italic_f ( italic_f ( italic_z ) ) = italic_f ( italic_z )</annotation></semantics></math>. It was further shown to ’project’ corrupted images onto the data manifold, effectively removing the corruptions without prior knowledge of the degradation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.7">Energy-Based Models (EBMs; <cite class="ltx_cite ltx_citemacro_cite">Ackley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib1" title="">1985</a>)</cite>) offer a related perspective by defining a function <math alttext="f" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_f</annotation></semantics></math> that assigns energy scores to inputs, with higher energy indicating less desirable or likely examples, and lower energy indicating those that fit the model well. IGN introduces a similar concept but frames it differently: instead of <math alttext="f" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_f</annotation></semantics></math> directly serving as the energy function, the energy is implicitly defined via the difference <math alttext="\delta(y)=D(f(y),y)" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.4"><semantics id="S2.SS2.p2.3.m3.4a"><mrow id="S2.SS2.p2.3.m3.4.4" xref="S2.SS2.p2.3.m3.4.4.cmml"><mrow id="S2.SS2.p2.3.m3.4.4.3" xref="S2.SS2.p2.3.m3.4.4.3.cmml"><mi id="S2.SS2.p2.3.m3.4.4.3.2" xref="S2.SS2.p2.3.m3.4.4.3.2.cmml">δ</mi><mo id="S2.SS2.p2.3.m3.4.4.3.1" xref="S2.SS2.p2.3.m3.4.4.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.4.4.3.3.2" xref="S2.SS2.p2.3.m3.4.4.3.cmml"><mo id="S2.SS2.p2.3.m3.4.4.3.3.2.1" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.3.cmml">(</mo><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">y</mi><mo id="S2.SS2.p2.3.m3.4.4.3.3.2.2" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.3.m3.4.4.2" xref="S2.SS2.p2.3.m3.4.4.2.cmml">=</mo><mrow id="S2.SS2.p2.3.m3.4.4.1" xref="S2.SS2.p2.3.m3.4.4.1.cmml"><mi id="S2.SS2.p2.3.m3.4.4.1.3" xref="S2.SS2.p2.3.m3.4.4.1.3.cmml">D</mi><mo id="S2.SS2.p2.3.m3.4.4.1.2" xref="S2.SS2.p2.3.m3.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.4.4.1.1.1" xref="S2.SS2.p2.3.m3.4.4.1.1.2.cmml"><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.1.1.2.cmml">(</mo><mrow id="S2.SS2.p2.3.m3.4.4.1.1.1.1" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.cmml"><mi id="S2.SS2.p2.3.m3.4.4.1.1.1.1.2" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.2.cmml">f</mi><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.1.1" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.4.4.1.1.1.1.3.2" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.cmml"><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.cmml">(</mo><mi id="S2.SS2.p2.3.m3.2.2" xref="S2.SS2.p2.3.m3.2.2.cmml">y</mi><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.1.3.2.2" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.3" xref="S2.SS2.p2.3.m3.4.4.1.1.2.cmml">,</mo><mi id="S2.SS2.p2.3.m3.3.3" xref="S2.SS2.p2.3.m3.3.3.cmml">y</mi><mo id="S2.SS2.p2.3.m3.4.4.1.1.1.4" stretchy="false" xref="S2.SS2.p2.3.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.4b"><apply id="S2.SS2.p2.3.m3.4.4.cmml" xref="S2.SS2.p2.3.m3.4.4"><eq id="S2.SS2.p2.3.m3.4.4.2.cmml" xref="S2.SS2.p2.3.m3.4.4.2"></eq><apply id="S2.SS2.p2.3.m3.4.4.3.cmml" xref="S2.SS2.p2.3.m3.4.4.3"><times id="S2.SS2.p2.3.m3.4.4.3.1.cmml" xref="S2.SS2.p2.3.m3.4.4.3.1"></times><ci id="S2.SS2.p2.3.m3.4.4.3.2.cmml" xref="S2.SS2.p2.3.m3.4.4.3.2">𝛿</ci><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑦</ci></apply><apply id="S2.SS2.p2.3.m3.4.4.1.cmml" xref="S2.SS2.p2.3.m3.4.4.1"><times id="S2.SS2.p2.3.m3.4.4.1.2.cmml" xref="S2.SS2.p2.3.m3.4.4.1.2"></times><ci id="S2.SS2.p2.3.m3.4.4.1.3.cmml" xref="S2.SS2.p2.3.m3.4.4.1.3">𝐷</ci><interval closure="open" id="S2.SS2.p2.3.m3.4.4.1.1.2.cmml" xref="S2.SS2.p2.3.m3.4.4.1.1.1"><apply id="S2.SS2.p2.3.m3.4.4.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1"><times id="S2.SS2.p2.3.m3.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.1"></times><ci id="S2.SS2.p2.3.m3.4.4.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.4.4.1.1.1.1.2">𝑓</ci><ci id="S2.SS2.p2.3.m3.2.2.cmml" xref="S2.SS2.p2.3.m3.2.2">𝑦</ci></apply><ci id="S2.SS2.p2.3.m3.3.3.cmml" xref="S2.SS2.p2.3.m3.3.3">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.4c">\delta(y)=D(f(y),y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.4d">italic_δ ( italic_y ) = italic_D ( italic_f ( italic_y ) , italic_y )</annotation></semantics></math>, where <math alttext="D" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mi id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_D</annotation></semantics></math> measures the distance between the model’s prediction and its input. In this framework, training <math alttext="f" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_f</annotation></semantics></math> to be idempotent minimizes <math alttext="\delta(f(z))" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.2"><semantics id="S2.SS2.p2.6.m6.2a"><mrow id="S2.SS2.p2.6.m6.2.2" xref="S2.SS2.p2.6.m6.2.2.cmml"><mi id="S2.SS2.p2.6.m6.2.2.3" xref="S2.SS2.p2.6.m6.2.2.3.cmml">δ</mi><mo id="S2.SS2.p2.6.m6.2.2.2" xref="S2.SS2.p2.6.m6.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mo id="S2.SS2.p2.6.m6.2.2.1.1.2" stretchy="false" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.6.m6.2.2.1.1.1.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml">f</mi><mo id="S2.SS2.p2.6.m6.2.2.1.1.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mo id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2.1" stretchy="false" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">(</mo><mi id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">z</mi><mo id="S2.SS2.p2.6.m6.2.2.1.1.1.3.2.2" stretchy="false" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.6.m6.2.2.1.1.3" stretchy="false" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.2b"><apply id="S2.SS2.p2.6.m6.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2"><times id="S2.SS2.p2.6.m6.2.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2"></times><ci id="S2.SS2.p2.6.m6.2.2.3.cmml" xref="S2.SS2.p2.6.m6.2.2.3">𝛿</ci><apply id="S2.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1"><times id="S2.SS2.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.1"></times><ci id="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2">𝑓</ci><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.2c">\delta(f(z))</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.2d">italic_δ ( italic_f ( italic_z ) )</annotation></semantics></math>, pushing the model toward a low-energy configuration where its outputs remain stable under repeated applications. Thus, <math alttext="f" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m7.1"><semantics id="S2.SS2.p2.7.m7.1a"><mi id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.1d">italic_f</annotation></semantics></math> can be interpreted as a transition operator that drives high-energy inputs toward a low-energy, stable domain, reducing the need for separate optimization procedures to find the energy minimum.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">In concurrent work, the ZigZag method has first been proposed and then extended to recursive networks <cite class="ltx_cite ltx_citemacro_citep">(Durasov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib15" title="">2024b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib12" title="">a</a>)</cite>. It introduces idempotence as a means to assess uncertainty in neural network predictions, ZigZag operates by recursively feeding the model’s predictions back as inputs, allowing the model to refine its outputs. The consistency between successive predictions acts as an uncertainty metric, where stable, unchanged outputs indicate higher confidence, while divergent predictions signal uncertainty or out-of-distribution (OOD) data. Unlike popular sampling-based uncertainty estimation methods <cite class="ltx_cite ltx_citemacro_citep">(Gal &amp; Ghahramani, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib16" title="">2016</a>; Lakshminarayanan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib28" title="">2017</a>; Wen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib41" title="">2020</a>; Durasov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib11" title="">2021a</a>)</cite>, ZigZag does not require many forward passes or complex sampling, making it more computationally efficient for real-time applications.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Initial Training</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.6">Let <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> be a generic model that we wish to deploy in an environment where the statistical distribution of the samples it receives may change over time. Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S0.F1" title="Figure 1 ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">1</span></a> depicts the initial training phase, we perform a standard supervised training with a slight modification inspired by the ZigZag method <cite class="ltx_cite ltx_citemacro_cite">Durasov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib15" title="">2024b</a>)</cite>: We modify the first layer of the network implementing <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> so that it can accept a second argument in addition to the data sample <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">bold_x</annotation></semantics></math> that it is normally takes as input. This additional argument can be either <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">bold_y</annotation></semantics></math>, the desired output of the network given input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">bold_x</annotation></semantics></math>, or a neutral ”don’t know” signal <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><cn id="S3.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_0</annotation></semantics></math>. During training, we minimize the supervised loss</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{train}}=\|f_{\theta}(\mathbf{x},\mathbf{y})-%
\mathbf{y}\|+\|f_{\theta}(\mathbf{x},\mathbf{0})-\mathbf{y}\|\;," class="ltx_Math" display="inline" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.4" xref="S3.E2.m1.5.5.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.4.2" xref="S3.E2.m1.5.5.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E2.m1.5.5.1.1.4.3" xref="S3.E2.m1.5.5.1.1.4.3a.cmml">train</mtext></msub><mo id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐱</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝐲</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">𝐲</mi></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.2.3.cmml">+</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml"><mo id="S3.E2.m1.5.5.1.1.2.2.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.2.1.cmml">‖</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.1.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.2.2.1.1.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.cmml"><msub id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.2.cmml">f</mi><mi id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.3.cmml">θ</mi></msub><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.2.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐱</mi><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.2.2" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.1.cmml">,</mo><mn id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">𝟎</mn><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.2.2.1.1.1" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml">−</mo><mi id="S3.E2.m1.5.5.1.1.2.2.1.1.3" xref="S3.E2.m1.5.5.1.1.2.2.1.1.3.cmml">𝐲</mi></mrow><mo id="S3.E2.m1.5.5.1.1.2.2.1.3" rspace="0.280em" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"></eq><apply id="S3.E2.m1.5.5.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.4.1.cmml" xref="S3.E2.m1.5.5.1.1.4">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.4.2.cmml" xref="S3.E2.m1.5.5.1.1.4.2">ℒ</ci><ci id="S3.E2.m1.5.5.1.1.4.3a.cmml" xref="S3.E2.m1.5.5.1.1.4.3"><mtext id="S3.E2.m1.5.5.1.1.4.3.cmml" mathsize="70%" xref="S3.E2.m1.5.5.1.1.4.3">train</mtext></ci></apply><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><plus id="S3.E2.m1.5.5.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3"></plus><apply id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><minus id="S3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3">𝜃</ci></apply><interval closure="open" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐱</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐲</ci></interval></apply><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3">𝐲</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.2">norm</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1"><minus id="S3.E2.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.1"></minus><apply id="S3.E2.m1.5.5.1.1.2.2.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2"><times id="S3.E2.m1.5.5.1.1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.1"></times><apply id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.2">𝑓</ci><ci id="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.2.3">𝜃</ci></apply><interval closure="open" id="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.2.3.2"><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐱</ci><cn id="S3.E2.m1.4.4.cmml" type="integer" xref="S3.E2.m1.4.4">0</cn></interval></apply><ci id="S3.E2.m1.5.5.1.1.2.2.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1.1.3">𝐲</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\displaystyle\mathcal{L}_{\text{train}}=\|f_{\theta}(\mathbf{x},\mathbf{y})-%
\mathbf{y}\|+\|f_{\theta}(\mathbf{x},\mathbf{0})-\mathbf{y}\|\;,</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">caligraphic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT = ∥ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_y ) - bold_y ∥ + ∥ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) - bold_y ∥ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.9">where<math alttext="f(\mathbf{x},\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m1.2"><semantics id="S3.SS1.p1.7.m1.2a"><mrow id="S3.SS1.p1.7.m1.2.3" xref="S3.SS1.p1.7.m1.2.3.cmml"><mi id="S3.SS1.p1.7.m1.2.3.2" xref="S3.SS1.p1.7.m1.2.3.2.cmml">f</mi><mo id="S3.SS1.p1.7.m1.2.3.1" xref="S3.SS1.p1.7.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m1.2.3.3.2" xref="S3.SS1.p1.7.m1.2.3.3.1.cmml"><mo id="S3.SS1.p1.7.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.7.m1.1.1" xref="S3.SS1.p1.7.m1.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.7.m1.2.3.3.2.2" rspace="0em" xref="S3.SS1.p1.7.m1.2.3.3.1.cmml">,</mo><mo id="S3.SS1.p1.7.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.7.m1.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.7.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.7.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.2b"><apply id="S3.SS1.p1.7.m1.2.3.cmml" xref="S3.SS1.p1.7.m1.2.3"><times id="S3.SS1.p1.7.m1.2.3.1.cmml" xref="S3.SS1.p1.7.m1.2.3.1"></times><ci id="S3.SS1.p1.7.m1.2.3.2.cmml" xref="S3.SS1.p1.7.m1.2.3.2">𝑓</ci><interval closure="open" id="S3.SS1.p1.7.m1.2.3.3.1.cmml" xref="S3.SS1.p1.7.m1.2.3.3.2"><ci id="S3.SS1.p1.7.m1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1">𝐱</ci><ci id="S3.SS1.p1.7.m1.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.2c">f(\mathbf{x},\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m1.2d">italic_f ( bold_x , ⋅ )</annotation></semantics></math> is the model’s prediction given input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m2.1"><semantics id="S3.SS1.p1.8.m2.1a"><mi id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><ci id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m2.1d">bold_x</annotation></semantics></math> and the additional input.
when <math alttext="\mathcal{L}_{\text{train}}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m3.1"><semantics id="S3.SS1.p1.9.m3.1a"><msub id="S3.SS1.p1.9.m3.1.1" xref="S3.SS1.p1.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m3.1.1.2" xref="S3.SS1.p1.9.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p1.9.m3.1.1.3" xref="S3.SS1.p1.9.m3.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m3.1b"><apply id="S3.SS1.p1.9.m3.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m3.1.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m3.1.1.2.cmml" xref="S3.SS1.p1.9.m3.1.1.2">ℒ</ci><ci id="S3.SS1.p1.9.m3.1.1.3a.cmml" xref="S3.SS1.p1.9.m3.1.1.3"><mtext id="S3.SS1.p1.9.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.9.m3.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m3.1c">\mathcal{L}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m3.1d">caligraphic_L start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> is minimized, we can write</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}_{0}=f_{\theta}(\mathbf{x},\mathbf{0})\approx\mathbf{y}%
\;,\mathbf{y}_{1}=f_{\theta}(\mathbf{x},\mathbf{y}_{0})\approx f_{\theta}(%
\mathbf{x},\mathbf{y})\approx\mathbf{y}\;\Rightarrow\;f_{\theta}(\mathbf{x},f_%
{\theta}(\mathbf{x},\mathbf{0}))\approx f_{\theta}(\mathbf{x},\mathbf{0})\;." class="ltx_Math" display="inline" id="S3.E3.m1.11"><semantics id="S3.E3.m1.11a"><mrow id="S3.E3.m1.11.11.1"><mrow id="S3.E3.m1.11.11.1.1.2" xref="S3.E3.m1.11.11.1.1.3.cmml"><mrow id="S3.E3.m1.11.11.1.1.1.1" xref="S3.E3.m1.11.11.1.1.1.1.cmml"><msub id="S3.E3.m1.11.11.1.1.1.1.2" xref="S3.E3.m1.11.11.1.1.1.1.2.cmml"><mi id="S3.E3.m1.11.11.1.1.1.1.2.2" xref="S3.E3.m1.11.11.1.1.1.1.2.2.cmml">𝐲</mi><mn id="S3.E3.m1.11.11.1.1.1.1.2.3" xref="S3.E3.m1.11.11.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.11.11.1.1.1.1.3" xref="S3.E3.m1.11.11.1.1.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.11.11.1.1.1.1.4" xref="S3.E3.m1.11.11.1.1.1.1.4.cmml"><msub id="S3.E3.m1.11.11.1.1.1.1.4.2" xref="S3.E3.m1.11.11.1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.11.11.1.1.1.1.4.2.2" xref="S3.E3.m1.11.11.1.1.1.1.4.2.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.1.1.4.2.3" xref="S3.E3.m1.11.11.1.1.1.1.4.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.1.1.4.1" xref="S3.E3.m1.11.11.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.1.1.4.3.2" xref="S3.E3.m1.11.11.1.1.1.1.4.3.1.cmml"><mo id="S3.E3.m1.11.11.1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E3.m1.11.11.1.1.1.1.4.3.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.1.1.4.3.2.2" xref="S3.E3.m1.11.11.1.1.1.1.4.3.1.cmml">,</mo><mn id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝟎</mn><mo id="S3.E3.m1.11.11.1.1.1.1.4.3.2.3" stretchy="false" xref="S3.E3.m1.11.11.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.11.11.1.1.1.1.5" xref="S3.E3.m1.11.11.1.1.1.1.5.cmml">≈</mo><mi id="S3.E3.m1.11.11.1.1.1.1.6" xref="S3.E3.m1.11.11.1.1.1.1.6.cmml">𝐲</mi></mrow><mo id="S3.E3.m1.11.11.1.1.2.3" lspace="0.280em" xref="S3.E3.m1.11.11.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.11.11.1.1.2.2" xref="S3.E3.m1.11.11.1.1.2.2.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.4" xref="S3.E3.m1.11.11.1.1.2.2.4.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.4.2" xref="S3.E3.m1.11.11.1.1.2.2.4.2.cmml">𝐲</mi><mn id="S3.E3.m1.11.11.1.1.2.2.4.3" xref="S3.E3.m1.11.11.1.1.2.2.4.3.cmml">1</mn></msub><mo id="S3.E3.m1.11.11.1.1.2.2.5" xref="S3.E3.m1.11.11.1.1.2.2.5.cmml">=</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.1" xref="S3.E3.m1.11.11.1.1.2.2.1.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.1.3" xref="S3.E3.m1.11.11.1.1.2.2.1.3.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.1.3.2" xref="S3.E3.m1.11.11.1.1.2.2.1.3.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.2.2.1.3.3" xref="S3.E3.m1.11.11.1.1.2.2.1.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.2.2.1.2" xref="S3.E3.m1.11.11.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.1.1.1" xref="S3.E3.m1.11.11.1.1.2.2.1.1.2.cmml"><mo id="S3.E3.m1.11.11.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.1.1.2.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.2.2.1.1.1.3" xref="S3.E3.m1.11.11.1.1.2.2.1.1.2.cmml">,</mo><msub id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.2" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.2.cmml">𝐲</mi><mn id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.3" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E3.m1.11.11.1.1.2.2.1.1.1.4" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.11.11.1.1.2.2.6" xref="S3.E3.m1.11.11.1.1.2.2.6.cmml">≈</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.7" xref="S3.E3.m1.11.11.1.1.2.2.7.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.7.2" xref="S3.E3.m1.11.11.1.1.2.2.7.2.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.7.2.2" xref="S3.E3.m1.11.11.1.1.2.2.7.2.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.2.2.7.2.3" xref="S3.E3.m1.11.11.1.1.2.2.7.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.2.2.7.1" xref="S3.E3.m1.11.11.1.1.2.2.7.1.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.7.3.2" xref="S3.E3.m1.11.11.1.1.2.2.7.3.1.cmml"><mo id="S3.E3.m1.11.11.1.1.2.2.7.3.2.1" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.7.3.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.2.2.7.3.2.2" xref="S3.E3.m1.11.11.1.1.2.2.7.3.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝐲</mi><mo id="S3.E3.m1.11.11.1.1.2.2.7.3.2.3" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.7.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.11.11.1.1.2.2.8" xref="S3.E3.m1.11.11.1.1.2.2.8.cmml">≈</mo><mi id="S3.E3.m1.11.11.1.1.2.2.9" xref="S3.E3.m1.11.11.1.1.2.2.9.cmml">𝐲</mi><mo id="S3.E3.m1.11.11.1.1.2.2.10" lspace="0.558em" rspace="0.558em" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.10.cmml">⇒</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.2" xref="S3.E3.m1.11.11.1.1.2.2.2.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.2.3" xref="S3.E3.m1.11.11.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.2.3.2" xref="S3.E3.m1.11.11.1.1.2.2.2.3.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.2.2.2.3.3" xref="S3.E3.m1.11.11.1.1.2.2.2.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.2.2.2.2" xref="S3.E3.m1.11.11.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.2.1.1" xref="S3.E3.m1.11.11.1.1.2.2.2.1.2.cmml"><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.2.1.2.cmml">(</mo><mi id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.3" xref="S3.E3.m1.11.11.1.1.2.2.2.1.2.cmml">,</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.2" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.3" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.1" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.2" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.1.cmml"><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.2.2" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.1.cmml">,</mo><mn id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">𝟎</mn><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.2.3" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.11.11.1.1.2.2.2.1.1.4" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.11.11.1.1.2.2.11" xref="S3.E3.m1.11.11.1.1.2.2.11.cmml">≈</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.12" xref="S3.E3.m1.11.11.1.1.2.2.12.cmml"><msub id="S3.E3.m1.11.11.1.1.2.2.12.2" xref="S3.E3.m1.11.11.1.1.2.2.12.2.cmml"><mi id="S3.E3.m1.11.11.1.1.2.2.12.2.2" xref="S3.E3.m1.11.11.1.1.2.2.12.2.2.cmml">f</mi><mi id="S3.E3.m1.11.11.1.1.2.2.12.2.3" xref="S3.E3.m1.11.11.1.1.2.2.12.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.11.11.1.1.2.2.12.1" xref="S3.E3.m1.11.11.1.1.2.2.12.1.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.1.1.2.2.12.3.2" xref="S3.E3.m1.11.11.1.1.2.2.12.3.1.cmml"><mo id="S3.E3.m1.11.11.1.1.2.2.12.3.2.1" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.12.3.1.cmml">(</mo><mi id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml">𝐱</mi><mo id="S3.E3.m1.11.11.1.1.2.2.12.3.2.2" xref="S3.E3.m1.11.11.1.1.2.2.12.3.1.cmml">,</mo><mn id="S3.E3.m1.10.10" xref="S3.E3.m1.10.10.cmml">𝟎</mn><mo id="S3.E3.m1.11.11.1.1.2.2.12.3.2.3" stretchy="false" xref="S3.E3.m1.11.11.1.1.2.2.12.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.11.11.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.11b"><apply id="S3.E3.m1.11.11.1.1.3.cmml" xref="S3.E3.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.3a.cmml" xref="S3.E3.m1.11.11.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.11.11.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1"><and id="S3.E3.m1.11.11.1.1.1.1a.cmml" xref="S3.E3.m1.11.11.1.1.1.1"></and><apply id="S3.E3.m1.11.11.1.1.1.1b.cmml" xref="S3.E3.m1.11.11.1.1.1.1"><eq id="S3.E3.m1.11.11.1.1.1.1.3.cmml" xref="S3.E3.m1.11.11.1.1.1.1.3"></eq><apply id="S3.E3.m1.11.11.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.2.2">𝐲</ci><cn id="S3.E3.m1.11.11.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.11.11.1.1.1.1.2.3">0</cn></apply><apply id="S3.E3.m1.11.11.1.1.1.1.4.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4"><times id="S3.E3.m1.11.11.1.1.1.1.4.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.1"></times><apply id="S3.E3.m1.11.11.1.1.1.1.4.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.2.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.2.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.4.3.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐱</ci><cn id="S3.E3.m1.2.2.cmml" type="integer" xref="S3.E3.m1.2.2">0</cn></interval></apply></apply><apply id="S3.E3.m1.11.11.1.1.1.1c.cmml" xref="S3.E3.m1.11.11.1.1.1.1"><approx id="S3.E3.m1.11.11.1.1.1.1.5.cmml" xref="S3.E3.m1.11.11.1.1.1.1.5"></approx><share href="https://arxiv.org/html/2410.04201v1#S3.E3.m1.11.11.1.1.1.1.4.cmml" id="S3.E3.m1.11.11.1.1.1.1d.cmml" xref="S3.E3.m1.11.11.1.1.1.1"></share><ci id="S3.E3.m1.11.11.1.1.1.1.6.cmml" xref="S3.E3.m1.11.11.1.1.1.1.6">𝐲</ci></apply></apply><apply id="S3.E3.m1.11.11.1.1.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><and id="S3.E3.m1.11.11.1.1.2.2a.cmml" xref="S3.E3.m1.11.11.1.1.2.2"></and><apply id="S3.E3.m1.11.11.1.1.2.2b.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><eq id="S3.E3.m1.11.11.1.1.2.2.5.cmml" xref="S3.E3.m1.11.11.1.1.2.2.5"></eq><apply id="S3.E3.m1.11.11.1.1.2.2.4.cmml" xref="S3.E3.m1.11.11.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.4.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.4.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.4.2">𝐲</ci><cn id="S3.E3.m1.11.11.1.1.2.2.4.3.cmml" type="integer" xref="S3.E3.m1.11.11.1.1.2.2.4.3">1</cn></apply><apply id="S3.E3.m1.11.11.1.1.2.2.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1"><times id="S3.E3.m1.11.11.1.1.2.2.1.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.2"></times><apply id="S3.E3.m1.11.11.1.1.2.2.1.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.1.3.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.3">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.1.3.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.3.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.2.2.1.3.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.2.2.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1"><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝐱</ci><apply id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.2">𝐲</ci><cn id="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.11.11.1.1.2.2.1.1.1.1.3">0</cn></apply></interval></apply></apply><apply id="S3.E3.m1.11.11.1.1.2.2c.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><approx id="S3.E3.m1.11.11.1.1.2.2.6.cmml" xref="S3.E3.m1.11.11.1.1.2.2.6"></approx><share href="https://arxiv.org/html/2410.04201v1#S3.E3.m1.11.11.1.1.2.2.1.cmml" id="S3.E3.m1.11.11.1.1.2.2d.cmml" xref="S3.E3.m1.11.11.1.1.2.2"></share><apply id="S3.E3.m1.11.11.1.1.2.2.7.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7"><times id="S3.E3.m1.11.11.1.1.2.2.7.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.1"></times><apply id="S3.E3.m1.11.11.1.1.2.2.7.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.7.2.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.2">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.7.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.2.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.2.2.7.2.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.2.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.2.2.7.3.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.7.3.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝐱</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝐲</ci></interval></apply></apply><apply id="S3.E3.m1.11.11.1.1.2.2e.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><approx id="S3.E3.m1.11.11.1.1.2.2.8.cmml" xref="S3.E3.m1.11.11.1.1.2.2.8"></approx><share href="https://arxiv.org/html/2410.04201v1#S3.E3.m1.11.11.1.1.2.2.7.cmml" id="S3.E3.m1.11.11.1.1.2.2f.cmml" xref="S3.E3.m1.11.11.1.1.2.2"></share><ci id="S3.E3.m1.11.11.1.1.2.2.9.cmml" xref="S3.E3.m1.11.11.1.1.2.2.9">𝐲</ci></apply><apply id="S3.E3.m1.11.11.1.1.2.2g.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><ci id="S3.E3.m1.11.11.1.1.2.2.10.cmml" xref="S3.E3.m1.11.11.1.1.2.2.10">⇒</ci><share href="https://arxiv.org/html/2410.04201v1#S3.E3.m1.11.11.1.1.2.2.9.cmml" id="S3.E3.m1.11.11.1.1.2.2h.cmml" xref="S3.E3.m1.11.11.1.1.2.2"></share><apply id="S3.E3.m1.11.11.1.1.2.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2"><times id="S3.E3.m1.11.11.1.1.2.2.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.2"></times><apply id="S3.E3.m1.11.11.1.1.2.2.2.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.3.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.2.2.2.3.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.2.2.2.1.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1"><ci id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">𝐱</ci><apply id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1"><times id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.1"></times><apply id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.2.1.1.1.3.2"><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝐱</ci><cn id="S3.E3.m1.7.7.cmml" type="integer" xref="S3.E3.m1.7.7">0</cn></interval></apply></interval></apply></apply><apply id="S3.E3.m1.11.11.1.1.2.2i.cmml" xref="S3.E3.m1.11.11.1.1.2.2"><approx id="S3.E3.m1.11.11.1.1.2.2.11.cmml" xref="S3.E3.m1.11.11.1.1.2.2.11"></approx><share href="https://arxiv.org/html/2410.04201v1#S3.E3.m1.11.11.1.1.2.2.2.cmml" id="S3.E3.m1.11.11.1.1.2.2j.cmml" xref="S3.E3.m1.11.11.1.1.2.2"></share><apply id="S3.E3.m1.11.11.1.1.2.2.12.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12"><times id="S3.E3.m1.11.11.1.1.2.2.12.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.1"></times><apply id="S3.E3.m1.11.11.1.1.2.2.12.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.2.2.12.2.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.2">subscript</csymbol><ci id="S3.E3.m1.11.11.1.1.2.2.12.2.2.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.2.2">𝑓</ci><ci id="S3.E3.m1.11.11.1.1.2.2.12.2.3.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.2.3">𝜃</ci></apply><interval closure="open" id="S3.E3.m1.11.11.1.1.2.2.12.3.1.cmml" xref="S3.E3.m1.11.11.1.1.2.2.12.3.2"><ci id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9">𝐱</ci><cn id="S3.E3.m1.10.10.cmml" type="integer" xref="S3.E3.m1.10.10">0</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.11c">\displaystyle\mathbf{y}_{0}=f_{\theta}(\mathbf{x},\mathbf{0})\approx\mathbf{y}%
\;,\mathbf{y}_{1}=f_{\theta}(\mathbf{x},\mathbf{y}_{0})\approx f_{\theta}(%
\mathbf{x},\mathbf{y})\approx\mathbf{y}\;\Rightarrow\;f_{\theta}(\mathbf{x},f_%
{\theta}(\mathbf{x},\mathbf{0}))\approx f_{\theta}(\mathbf{x},\mathbf{0})\;.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.11d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ≈ bold_y , bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ≈ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_y ) ≈ bold_y ⇒ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ) ≈ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.13">Of course, this can only be expected to hold when <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m1.1"><semantics id="S3.SS1.p1.10.m1.1a"><mi id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.1b"><ci id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m1.1d">bold_x</annotation></semantics></math> is within the training distribution. When <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m2.1"><semantics id="S3.SS1.p1.11.m2.1a"><mi id="S3.SS1.p1.11.m2.1.1" xref="S3.SS1.p1.11.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m2.1b"><ci id="S3.SS1.p1.11.m2.1.1.cmml" xref="S3.SS1.p1.11.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m2.1d">bold_x</annotation></semantics></math> is out-of-distribution, <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m3.1"><semantics id="S3.SS1.p1.12.m3.1a"><msub id="S3.SS1.p1.12.m3.1.1" xref="S3.SS1.p1.12.m3.1.1.cmml"><mi id="S3.SS1.p1.12.m3.1.1.2" xref="S3.SS1.p1.12.m3.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p1.12.m3.1.1.3" xref="S3.SS1.p1.12.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m3.1b"><apply id="S3.SS1.p1.12.m3.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m3.1.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m3.1.1.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2">𝐲</ci><cn id="S3.SS1.p1.12.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.12.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m3.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m3.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m4.1"><semantics id="S3.SS1.p1.13.m4.1a"><msub id="S3.SS1.p1.13.m4.1.1" xref="S3.SS1.p1.13.m4.1.1.cmml"><mi id="S3.SS1.p1.13.m4.1.1.2" xref="S3.SS1.p1.13.m4.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p1.13.m4.1.1.3" xref="S3.SS1.p1.13.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m4.1b"><apply id="S3.SS1.p1.13.m4.1.1.cmml" xref="S3.SS1.p1.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m4.1.1.1.cmml" xref="S3.SS1.p1.13.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m4.1.1.2.cmml" xref="S3.SS1.p1.13.m4.1.1.2">𝐲</ci><cn id="S3.SS1.p1.13.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.13.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m4.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m4.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> can be very different. In <cite class="ltx_cite ltx_citemacro_cite">Durasov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib15" title="">2024b</a>)</cite>, this is exploited to estimate uncertainty: the greater the deviation from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.E3" title="In 3.1 Initial Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3</span></a>, the more uncertain the prediction is taken to be. In contrast, in this paper, we use Test-Time Training to enforce the constraint of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.E3" title="In 3.1 Initial Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3</span></a> during inference.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Test-Time Training</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">At test time, IT<sup class="ltx_sup" id="S3.SS2.p1.3.1">3</sup> introduces a dynamic adaptation process
to refine the model’s predictions for new inputs,
particularly those that may be OOD or corrupted.
The goal is to make the model idempotent with respect to its second input, that is, ensuring that <math alttext="f_{\theta}(\mathbf{x},\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.2"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.3" xref="S3.SS2.p1.2.m2.2.3.cmml"><msub id="S3.SS2.p1.2.m2.2.3.2" xref="S3.SS2.p1.2.m2.2.3.2.cmml"><mi id="S3.SS2.p1.2.m2.2.3.2.2" xref="S3.SS2.p1.2.m2.2.3.2.2.cmml">f</mi><mi id="S3.SS2.p1.2.m2.2.3.2.3" xref="S3.SS2.p1.2.m2.2.3.2.3.cmml">θ</mi></msub><mo id="S3.SS2.p1.2.m2.2.3.1" xref="S3.SS2.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.2.3.3.2" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml"><mo id="S3.SS2.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.SS2.p1.2.m2.2.3.3.2.2" rspace="0em" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">,</mo><mo id="S3.SS2.p1.2.m2.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p1.2.m2.2.2.cmml">⋅</mo><mo id="S3.SS2.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3"><times id="S3.SS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.1"></times><apply id="S3.SS2.p1.2.m2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.3.2.1.cmml" xref="S3.SS2.p1.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.3.2.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2.2">𝑓</ci><ci id="S3.SS2.p1.2.m2.2.3.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p1.2.m2.2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.3.2"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐱</ci><ci id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">f_{\theta}(\mathbf{x},\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.2d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , ⋅ )</annotation></semantics></math>
is an idempotent function for a given <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_x</annotation></semantics></math>. A naive way to enforce this would be to minimize the loss function</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{TTT}}=\|f_{\theta}(\mathbf{x},f_{\theta}(%
\mathbf{x},\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;." class="ltx_Math" display="inline" id="S3.E4.m1.6"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6.1" xref="S3.E4.m1.6.6.1.1.cmml"><mrow id="S3.E4.m1.6.6.1.1" xref="S3.E4.m1.6.6.1.1.cmml"><msub id="S3.E4.m1.6.6.1.1.3" xref="S3.E4.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.1.1.3.2" xref="S3.E4.m1.6.6.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.6.6.1.1.3.3" xref="S3.E4.m1.6.6.1.1.3.3a.cmml">TTT</mtext></msub><mo id="S3.E4.m1.6.6.1.1.2" xref="S3.E4.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.6.6.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.2.cmml"><mo id="S3.E4.m1.6.6.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.6.6.1.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.6.6.1.1.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">𝐱</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝐱</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mn id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝟎</mn><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.1.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.1.3.cmml"><msub id="S3.E4.m1.6.6.1.1.1.1.1.3.2" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.1.3.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E4.m1.6.6.1.1.1.1.1.3.2.3" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2.3.cmml">θ</mi></msub><mo id="S3.E4.m1.6.6.1.1.1.1.1.3.1" xref="S3.E4.m1.6.6.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.3.3.2" xref="S3.E4.m1.6.6.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E4.m1.6.6.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">𝐱</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.3.3.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.3.3.1.cmml">,</mo><mn id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">𝟎</mn><mo id="S3.E4.m1.6.6.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.6.6.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.6.6.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S3.E4.m1.6.6.1.2" xref="S3.E4.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.1.1.cmml" xref="S3.E4.m1.6.6.1"><eq id="S3.E4.m1.6.6.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.2"></eq><apply id="S3.E4.m1.6.6.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.3.1.cmml" xref="S3.E4.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.3.2.cmml" xref="S3.E4.m1.6.6.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.6.6.1.1.3.3a.cmml" xref="S3.E4.m1.6.6.1.1.3.3"><mtext id="S3.E4.m1.6.6.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.6.6.1.1.3.3">TTT</mtext></ci></apply><apply id="S3.E4.m1.6.6.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.6.6.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.6.6.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1"><minus id="S3.E4.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2"></minus><apply id="S3.E4.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1"><times id="S3.E4.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝐱</ci><apply id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝐱</ci><cn id="S3.E4.m1.2.2.cmml" type="integer" xref="S3.E4.m1.2.2">0</cn></interval></apply></interval></apply><apply id="S3.E4.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3"><times id="S3.E4.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.1"></times><apply id="S3.E4.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.6.6.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3.3.2"><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝐱</ci><cn id="S3.E4.m1.5.5.cmml" type="integer" xref="S3.E4.m1.5.5">0</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">\displaystyle\mathcal{L}_{\text{TTT}}=\|f_{\theta}(\mathbf{x},f_{\theta}(%
\mathbf{x},\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;.</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.6d">caligraphic_L start_POSTSUBSCRIPT TTT end_POSTSUBSCRIPT = ∥ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ) - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.10">However, directly minimizing this loss can produce undesirable side effects.
For instance, if <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m1.1"><semantics id="S3.SS2.p1.4.m1.1a"><msub id="S3.SS2.p1.4.m1.1.1" xref="S3.SS2.p1.4.m1.1.1.cmml"><mi id="S3.SS2.p1.4.m1.1.1.2" xref="S3.SS2.p1.4.m1.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p1.4.m1.1.1.3" xref="S3.SS2.p1.4.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m1.1b"><apply id="S3.SS2.p1.4.m1.1.1.cmml" xref="S3.SS2.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m1.1.1.1.cmml" xref="S3.SS2.p1.4.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m1.1.1.2.cmml" xref="S3.SS2.p1.4.m1.1.1.2">𝐲</ci><cn id="S3.SS2.p1.4.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m1.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m1.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is an incorrect prediction,
minimizing the distance <math alttext="\|\mathbf{y}_{0}-\mathbf{y}_{1}\|" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m2.1"><semantics id="S3.SS2.p1.5.m2.1a"><mrow id="S3.SS2.p1.5.m2.1.1.1" xref="S3.SS2.p1.5.m2.1.1.2.cmml"><mo id="S3.SS2.p1.5.m2.1.1.1.2" stretchy="false" xref="S3.SS2.p1.5.m2.1.1.2.1.cmml">‖</mo><mrow id="S3.SS2.p1.5.m2.1.1.1.1" xref="S3.SS2.p1.5.m2.1.1.1.1.cmml"><msub id="S3.SS2.p1.5.m2.1.1.1.1.2" xref="S3.SS2.p1.5.m2.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.5.m2.1.1.1.1.2.2" xref="S3.SS2.p1.5.m2.1.1.1.1.2.2.cmml">𝐲</mi><mn id="S3.SS2.p1.5.m2.1.1.1.1.2.3" xref="S3.SS2.p1.5.m2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.p1.5.m2.1.1.1.1.1" xref="S3.SS2.p1.5.m2.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p1.5.m2.1.1.1.1.3" xref="S3.SS2.p1.5.m2.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.5.m2.1.1.1.1.3.2" xref="S3.SS2.p1.5.m2.1.1.1.1.3.2.cmml">𝐲</mi><mn id="S3.SS2.p1.5.m2.1.1.1.1.3.3" xref="S3.SS2.p1.5.m2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p1.5.m2.1.1.1.3" stretchy="false" xref="S3.SS2.p1.5.m2.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m2.1b"><apply id="S3.SS2.p1.5.m2.1.1.2.cmml" xref="S3.SS2.p1.5.m2.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.5.m2.1.1.2.1.cmml" xref="S3.SS2.p1.5.m2.1.1.1.2">norm</csymbol><apply id="S3.SS2.p1.5.m2.1.1.1.1.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1"><minus id="S3.SS2.p1.5.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.1"></minus><apply id="S3.SS2.p1.5.m2.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.5.m2.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.2.2">𝐲</ci><cn id="S3.SS2.p1.5.m2.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p1.5.m2.1.1.1.1.2.3">0</cn></apply><apply id="S3.SS2.p1.5.m2.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m2.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m2.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.5.m2.1.1.1.1.3.2">𝐲</ci><cn id="S3.SS2.p1.5.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m2.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m2.1c">\|\mathbf{y}_{0}-\mathbf{y}_{1}\|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m2.1d">∥ bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥</annotation></semantics></math> may cause <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m3.1"><semantics id="S3.SS2.p1.6.m3.1a"><msub id="S3.SS2.p1.6.m3.1.1" xref="S3.SS2.p1.6.m3.1.1.cmml"><mi id="S3.SS2.p1.6.m3.1.1.2" xref="S3.SS2.p1.6.m3.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p1.6.m3.1.1.3" xref="S3.SS2.p1.6.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m3.1b"><apply id="S3.SS2.p1.6.m3.1.1.cmml" xref="S3.SS2.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m3.1.1.1.cmml" xref="S3.SS2.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m3.1.1.2.cmml" xref="S3.SS2.p1.6.m3.1.1.2">𝐲</ci><cn id="S3.SS2.p1.6.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.6.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m3.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m3.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> to be pulled toward the incorrect <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m4.1"><semantics id="S3.SS2.p1.7.m4.1a"><msub id="S3.SS2.p1.7.m4.1.1" xref="S3.SS2.p1.7.m4.1.1.cmml"><mi id="S3.SS2.p1.7.m4.1.1.2" xref="S3.SS2.p1.7.m4.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p1.7.m4.1.1.3" xref="S3.SS2.p1.7.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m4.1b"><apply id="S3.SS2.p1.7.m4.1.1.cmml" xref="S3.SS2.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m4.1.1.1.cmml" xref="S3.SS2.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m4.1.1.2.cmml" xref="S3.SS2.p1.7.m4.1.1.2">𝐲</ci><cn id="S3.SS2.p1.7.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m4.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m4.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, thereby magnifying the error.
Another potential failure mode is due to the fact that <math alttext="identity" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m5.1"><semantics id="S3.SS2.p1.8.m5.1a"><mrow id="S3.SS2.p1.8.m5.1.1" xref="S3.SS2.p1.8.m5.1.1.cmml"><mi id="S3.SS2.p1.8.m5.1.1.2" xref="S3.SS2.p1.8.m5.1.1.2.cmml">i</mi><mo id="S3.SS2.p1.8.m5.1.1.1" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.3" xref="S3.SS2.p1.8.m5.1.1.3.cmml">d</mi><mo id="S3.SS2.p1.8.m5.1.1.1a" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.4" xref="S3.SS2.p1.8.m5.1.1.4.cmml">e</mi><mo id="S3.SS2.p1.8.m5.1.1.1b" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.5" xref="S3.SS2.p1.8.m5.1.1.5.cmml">n</mi><mo id="S3.SS2.p1.8.m5.1.1.1c" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.6" xref="S3.SS2.p1.8.m5.1.1.6.cmml">t</mi><mo id="S3.SS2.p1.8.m5.1.1.1d" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.7" xref="S3.SS2.p1.8.m5.1.1.7.cmml">i</mi><mo id="S3.SS2.p1.8.m5.1.1.1e" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.8" xref="S3.SS2.p1.8.m5.1.1.8.cmml">t</mi><mo id="S3.SS2.p1.8.m5.1.1.1f" xref="S3.SS2.p1.8.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m5.1.1.9" xref="S3.SS2.p1.8.m5.1.1.9.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m5.1b"><apply id="S3.SS2.p1.8.m5.1.1.cmml" xref="S3.SS2.p1.8.m5.1.1"><times id="S3.SS2.p1.8.m5.1.1.1.cmml" xref="S3.SS2.p1.8.m5.1.1.1"></times><ci id="S3.SS2.p1.8.m5.1.1.2.cmml" xref="S3.SS2.p1.8.m5.1.1.2">𝑖</ci><ci id="S3.SS2.p1.8.m5.1.1.3.cmml" xref="S3.SS2.p1.8.m5.1.1.3">𝑑</ci><ci id="S3.SS2.p1.8.m5.1.1.4.cmml" xref="S3.SS2.p1.8.m5.1.1.4">𝑒</ci><ci id="S3.SS2.p1.8.m5.1.1.5.cmml" xref="S3.SS2.p1.8.m5.1.1.5">𝑛</ci><ci id="S3.SS2.p1.8.m5.1.1.6.cmml" xref="S3.SS2.p1.8.m5.1.1.6">𝑡</ci><ci id="S3.SS2.p1.8.m5.1.1.7.cmml" xref="S3.SS2.p1.8.m5.1.1.7">𝑖</ci><ci id="S3.SS2.p1.8.m5.1.1.8.cmml" xref="S3.SS2.p1.8.m5.1.1.8">𝑡</ci><ci id="S3.SS2.p1.8.m5.1.1.9.cmml" xref="S3.SS2.p1.8.m5.1.1.9">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m5.1c">identity</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m5.1d">italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y</annotation></semantics></math> is idempotent. For <math alttext="f=identity" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m6.1"><semantics id="S3.SS2.p1.9.m6.1a"><mrow id="S3.SS2.p1.9.m6.1.1" xref="S3.SS2.p1.9.m6.1.1.cmml"><mi id="S3.SS2.p1.9.m6.1.1.2" xref="S3.SS2.p1.9.m6.1.1.2.cmml">f</mi><mo id="S3.SS2.p1.9.m6.1.1.1" xref="S3.SS2.p1.9.m6.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.9.m6.1.1.3" xref="S3.SS2.p1.9.m6.1.1.3.cmml"><mi id="S3.SS2.p1.9.m6.1.1.3.2" xref="S3.SS2.p1.9.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.3" xref="S3.SS2.p1.9.m6.1.1.3.3.cmml">d</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1a" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.4" xref="S3.SS2.p1.9.m6.1.1.3.4.cmml">e</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1b" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.5" xref="S3.SS2.p1.9.m6.1.1.3.5.cmml">n</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1c" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.6" xref="S3.SS2.p1.9.m6.1.1.3.6.cmml">t</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1d" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.7" xref="S3.SS2.p1.9.m6.1.1.3.7.cmml">i</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1e" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.8" xref="S3.SS2.p1.9.m6.1.1.3.8.cmml">t</mi><mo id="S3.SS2.p1.9.m6.1.1.3.1f" xref="S3.SS2.p1.9.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m6.1.1.3.9" xref="S3.SS2.p1.9.m6.1.1.3.9.cmml">y</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m6.1b"><apply id="S3.SS2.p1.9.m6.1.1.cmml" xref="S3.SS2.p1.9.m6.1.1"><eq id="S3.SS2.p1.9.m6.1.1.1.cmml" xref="S3.SS2.p1.9.m6.1.1.1"></eq><ci id="S3.SS2.p1.9.m6.1.1.2.cmml" xref="S3.SS2.p1.9.m6.1.1.2">𝑓</ci><apply id="S3.SS2.p1.9.m6.1.1.3.cmml" xref="S3.SS2.p1.9.m6.1.1.3"><times id="S3.SS2.p1.9.m6.1.1.3.1.cmml" xref="S3.SS2.p1.9.m6.1.1.3.1"></times><ci id="S3.SS2.p1.9.m6.1.1.3.2.cmml" xref="S3.SS2.p1.9.m6.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.9.m6.1.1.3.3.cmml" xref="S3.SS2.p1.9.m6.1.1.3.3">𝑑</ci><ci id="S3.SS2.p1.9.m6.1.1.3.4.cmml" xref="S3.SS2.p1.9.m6.1.1.3.4">𝑒</ci><ci id="S3.SS2.p1.9.m6.1.1.3.5.cmml" xref="S3.SS2.p1.9.m6.1.1.3.5">𝑛</ci><ci id="S3.SS2.p1.9.m6.1.1.3.6.cmml" xref="S3.SS2.p1.9.m6.1.1.3.6">𝑡</ci><ci id="S3.SS2.p1.9.m6.1.1.3.7.cmml" xref="S3.SS2.p1.9.m6.1.1.3.7">𝑖</ci><ci id="S3.SS2.p1.9.m6.1.1.3.8.cmml" xref="S3.SS2.p1.9.m6.1.1.3.8">𝑡</ci><ci id="S3.SS2.p1.9.m6.1.1.3.9.cmml" xref="S3.SS2.p1.9.m6.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m6.1c">f=identity</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m6.1d">italic_f = italic_i italic_d italic_e italic_n italic_t italic_i italic_t italic_y</annotation></semantics></math>, we get <math alttext="\mathcal{L}_{\text{TTT}}=0" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m7.1"><semantics id="S3.SS2.p1.10.m7.1a"><mrow id="S3.SS2.p1.10.m7.1.1" xref="S3.SS2.p1.10.m7.1.1.cmml"><msub id="S3.SS2.p1.10.m7.1.1.2" xref="S3.SS2.p1.10.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m7.1.1.2.2" xref="S3.SS2.p1.10.m7.1.1.2.2.cmml">ℒ</mi><mtext id="S3.SS2.p1.10.m7.1.1.2.3" xref="S3.SS2.p1.10.m7.1.1.2.3a.cmml">TTT</mtext></msub><mo id="S3.SS2.p1.10.m7.1.1.1" xref="S3.SS2.p1.10.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.10.m7.1.1.3" xref="S3.SS2.p1.10.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m7.1b"><apply id="S3.SS2.p1.10.m7.1.1.cmml" xref="S3.SS2.p1.10.m7.1.1"><eq id="S3.SS2.p1.10.m7.1.1.1.cmml" xref="S3.SS2.p1.10.m7.1.1.1"></eq><apply id="S3.SS2.p1.10.m7.1.1.2.cmml" xref="S3.SS2.p1.10.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m7.1.1.2.1.cmml" xref="S3.SS2.p1.10.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.10.m7.1.1.2.2.cmml" xref="S3.SS2.p1.10.m7.1.1.2.2">ℒ</ci><ci id="S3.SS2.p1.10.m7.1.1.2.3a.cmml" xref="S3.SS2.p1.10.m7.1.1.2.3"><mtext id="S3.SS2.p1.10.m7.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p1.10.m7.1.1.2.3">TTT</mtext></ci></apply><cn id="S3.SS2.p1.10.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p1.10.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m7.1c">\mathcal{L}_{\text{TTT}}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m7.1d">caligraphic_L start_POSTSUBSCRIPT TTT end_POSTSUBSCRIPT = 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">To prevent such a collapse, we modify the test-time training procedure as depicted in Fig, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S0.F1" title="Figure 1 ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">1</span></a>:
We keep a copy of the model as it was at the end of the training phase, denoted as <math alttext="F=f_{\Theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">F</mi><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">=</mo><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3" mathvariant="normal" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">Θ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></eq><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐹</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">Θ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">F=f_{\Theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_F = italic_f start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p2.2.m2.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">roman_Θ</annotation></semantics></math> are the weights obtained after the initial training of Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS1" title="3.1 Initial Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3.1</span></a>, which will not be updated further.
We then take the test-time loss to be</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{IT}^{3}}=\|F(\mathbf{x},f_{\theta}(\mathbf{x},%
\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;," class="ltx_Math" display="inline" id="S3.E5.m1.6"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1" xref="S3.E5.m1.6.6.1.1.cmml"><msub id="S3.E5.m1.6.6.1.1.3" xref="S3.E5.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.6.1.1.3.2" xref="S3.E5.m1.6.6.1.1.3.2.cmml">ℒ</mi><msup id="S3.E5.m1.6.6.1.1.3.3" xref="S3.E5.m1.6.6.1.1.3.3.cmml"><mtext id="S3.E5.m1.6.6.1.1.3.3.2" xref="S3.E5.m1.6.6.1.1.3.3.2a.cmml">IT</mtext><mn id="S3.E5.m1.6.6.1.1.3.3.3" xref="S3.E5.m1.6.6.1.1.3.3.3.cmml">3</mn></msup></msub><mo id="S3.E5.m1.6.6.1.1.2" xref="S3.E5.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.6.6.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.2.cmml"><mo id="S3.E5.m1.6.6.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">𝐱</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝐱</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mn id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">𝟎</mn><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.6.6.1.1.1.1.1.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.3.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.3.2.3" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2.3.cmml">θ</mi></msub><mo id="S3.E5.m1.6.6.1.1.1.1.1.3.1" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1.3.3.2" xref="S3.E5.m1.6.6.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E5.m1.6.6.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">𝐱</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.6.6.1.1.1.1.1.3.3.1.cmml">,</mo><mn id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">𝟎</mn><mo id="S3.E5.m1.6.6.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.1.1.3" rspace="0.280em" stretchy="false" xref="S3.E5.m1.6.6.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.2" xref="S3.E5.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.1.1.cmml" xref="S3.E5.m1.6.6.1"><eq id="S3.E5.m1.6.6.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2"></eq><apply id="S3.E5.m1.6.6.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.3.2">ℒ</ci><apply id="S3.E5.m1.6.6.1.1.3.3.cmml" xref="S3.E5.m1.6.6.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.3.3.1.cmml" xref="S3.E5.m1.6.6.1.1.3.3">superscript</csymbol><ci id="S3.E5.m1.6.6.1.1.3.3.2a.cmml" xref="S3.E5.m1.6.6.1.1.3.3.2"><mtext id="S3.E5.m1.6.6.1.1.3.3.2.cmml" mathsize="70%" xref="S3.E5.m1.6.6.1.1.3.3.2">IT</mtext></ci><cn id="S3.E5.m1.6.6.1.1.3.3.3.cmml" type="integer" xref="S3.E5.m1.6.6.1.1.3.3.3">3</cn></apply></apply><apply id="S3.E5.m1.6.6.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.1.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.6.6.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1"><minus id="S3.E5.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.2"></minus><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1"><times id="S3.E5.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.3">𝐹</ci><interval closure="open" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝐱</ci><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐱</ci><cn id="S3.E5.m1.2.2.cmml" type="integer" xref="S3.E5.m1.2.2">0</cn></interval></apply></interval></apply><apply id="S3.E5.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3"><times id="S3.E5.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.1"></times><apply id="S3.E5.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.E5.m1.6.6.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.3.3.2"><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝐱</ci><cn id="S3.E5.m1.5.5.cmml" type="integer" xref="S3.E5.m1.5.5">0</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\displaystyle\mathcal{L}_{\text{IT}^{3}}=\|F(\mathbf{x},f_{\theta}(\mathbf{x},%
\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;,</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.6d">caligraphic_L start_POSTSUBSCRIPT IT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = ∥ italic_F ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ) - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ∥ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.14">where <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m1.1"><semantics id="S3.SS2.p2.3.m1.1a"><msub id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is the model being updated at test-time. Here, the first prediction <math alttext="\mathbf{y}_{0}=f_{\theta}(\mathbf{x},\mathbf{0})" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m2.2"><semantics id="S3.SS2.p2.4.m2.2a"><mrow id="S3.SS2.p2.4.m2.2.3" xref="S3.SS2.p2.4.m2.2.3.cmml"><msub id="S3.SS2.p2.4.m2.2.3.2" xref="S3.SS2.p2.4.m2.2.3.2.cmml"><mi id="S3.SS2.p2.4.m2.2.3.2.2" xref="S3.SS2.p2.4.m2.2.3.2.2.cmml">𝐲</mi><mn id="S3.SS2.p2.4.m2.2.3.2.3" xref="S3.SS2.p2.4.m2.2.3.2.3.cmml">0</mn></msub><mo id="S3.SS2.p2.4.m2.2.3.1" xref="S3.SS2.p2.4.m2.2.3.1.cmml">=</mo><mrow id="S3.SS2.p2.4.m2.2.3.3" xref="S3.SS2.p2.4.m2.2.3.3.cmml"><msub id="S3.SS2.p2.4.m2.2.3.3.2" xref="S3.SS2.p2.4.m2.2.3.3.2.cmml"><mi id="S3.SS2.p2.4.m2.2.3.3.2.2" xref="S3.SS2.p2.4.m2.2.3.3.2.2.cmml">f</mi><mi id="S3.SS2.p2.4.m2.2.3.3.2.3" xref="S3.SS2.p2.4.m2.2.3.3.2.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.4.m2.2.3.3.1" xref="S3.SS2.p2.4.m2.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p2.4.m2.2.3.3.3.2" xref="S3.SS2.p2.4.m2.2.3.3.3.1.cmml"><mo id="S3.SS2.p2.4.m2.2.3.3.3.2.1" stretchy="false" xref="S3.SS2.p2.4.m2.2.3.3.3.1.cmml">(</mo><mi id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml">𝐱</mi><mo id="S3.SS2.p2.4.m2.2.3.3.3.2.2" xref="S3.SS2.p2.4.m2.2.3.3.3.1.cmml">,</mo><mn id="S3.SS2.p2.4.m2.2.2" xref="S3.SS2.p2.4.m2.2.2.cmml">𝟎</mn><mo id="S3.SS2.p2.4.m2.2.3.3.3.2.3" stretchy="false" xref="S3.SS2.p2.4.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.2b"><apply id="S3.SS2.p2.4.m2.2.3.cmml" xref="S3.SS2.p2.4.m2.2.3"><eq id="S3.SS2.p2.4.m2.2.3.1.cmml" xref="S3.SS2.p2.4.m2.2.3.1"></eq><apply id="S3.SS2.p2.4.m2.2.3.2.cmml" xref="S3.SS2.p2.4.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.2.3.2.1.cmml" xref="S3.SS2.p2.4.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m2.2.3.2.2.cmml" xref="S3.SS2.p2.4.m2.2.3.2.2">𝐲</ci><cn id="S3.SS2.p2.4.m2.2.3.2.3.cmml" type="integer" xref="S3.SS2.p2.4.m2.2.3.2.3">0</cn></apply><apply id="S3.SS2.p2.4.m2.2.3.3.cmml" xref="S3.SS2.p2.4.m2.2.3.3"><times id="S3.SS2.p2.4.m2.2.3.3.1.cmml" xref="S3.SS2.p2.4.m2.2.3.3.1"></times><apply id="S3.SS2.p2.4.m2.2.3.3.2.cmml" xref="S3.SS2.p2.4.m2.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.2.3.3.2.1.cmml" xref="S3.SS2.p2.4.m2.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m2.2.3.3.2.2.cmml" xref="S3.SS2.p2.4.m2.2.3.3.2.2">𝑓</ci><ci id="S3.SS2.p2.4.m2.2.3.3.2.3.cmml" xref="S3.SS2.p2.4.m2.2.3.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p2.4.m2.2.3.3.3.1.cmml" xref="S3.SS2.p2.4.m2.2.3.3.3.2"><ci id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1">𝐱</ci><cn id="S3.SS2.p2.4.m2.2.2.cmml" type="integer" xref="S3.SS2.p2.4.m2.2.2">0</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.2c">\mathbf{y}_{0}=f_{\theta}(\mathbf{x},\mathbf{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m2.2d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 )</annotation></semantics></math> is computed as before, but the second one, <math alttext="\mathbf{y}_{1}=F(\mathbf{x},f_{\theta}(\mathbf{x},\mathbf{0}))" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m3.4"><semantics id="S3.SS2.p2.5.m3.4a"><mrow id="S3.SS2.p2.5.m3.4.4" xref="S3.SS2.p2.5.m3.4.4.cmml"><msub id="S3.SS2.p2.5.m3.4.4.3" xref="S3.SS2.p2.5.m3.4.4.3.cmml"><mi id="S3.SS2.p2.5.m3.4.4.3.2" xref="S3.SS2.p2.5.m3.4.4.3.2.cmml">𝐲</mi><mn id="S3.SS2.p2.5.m3.4.4.3.3" xref="S3.SS2.p2.5.m3.4.4.3.3.cmml">1</mn></msub><mo id="S3.SS2.p2.5.m3.4.4.2" xref="S3.SS2.p2.5.m3.4.4.2.cmml">=</mo><mrow id="S3.SS2.p2.5.m3.4.4.1" xref="S3.SS2.p2.5.m3.4.4.1.cmml"><mi id="S3.SS2.p2.5.m3.4.4.1.3" xref="S3.SS2.p2.5.m3.4.4.1.3.cmml">F</mi><mo id="S3.SS2.p2.5.m3.4.4.1.2" xref="S3.SS2.p2.5.m3.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m3.4.4.1.1.1" xref="S3.SS2.p2.5.m3.4.4.1.1.2.cmml"><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.2" stretchy="false" xref="S3.SS2.p2.5.m3.4.4.1.1.2.cmml">(</mo><mi id="S3.SS2.p2.5.m3.3.3" xref="S3.SS2.p2.5.m3.3.3.cmml">𝐱</mi><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.3" xref="S3.SS2.p2.5.m3.4.4.1.1.2.cmml">,</mo><mrow id="S3.SS2.p2.5.m3.4.4.1.1.1.1" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.cmml"><msub id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.2" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.3" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.1.1" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.2" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.1.cmml"><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml">𝐱</mi><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.2.2" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.1.cmml">,</mo><mn id="S3.SS2.p2.5.m3.2.2" xref="S3.SS2.p2.5.m3.2.2.cmml">𝟎</mn><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.2.3" stretchy="false" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.5.m3.4.4.1.1.1.4" stretchy="false" xref="S3.SS2.p2.5.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.4b"><apply id="S3.SS2.p2.5.m3.4.4.cmml" xref="S3.SS2.p2.5.m3.4.4"><eq id="S3.SS2.p2.5.m3.4.4.2.cmml" xref="S3.SS2.p2.5.m3.4.4.2"></eq><apply id="S3.SS2.p2.5.m3.4.4.3.cmml" xref="S3.SS2.p2.5.m3.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m3.4.4.3.1.cmml" xref="S3.SS2.p2.5.m3.4.4.3">subscript</csymbol><ci id="S3.SS2.p2.5.m3.4.4.3.2.cmml" xref="S3.SS2.p2.5.m3.4.4.3.2">𝐲</ci><cn id="S3.SS2.p2.5.m3.4.4.3.3.cmml" type="integer" xref="S3.SS2.p2.5.m3.4.4.3.3">1</cn></apply><apply id="S3.SS2.p2.5.m3.4.4.1.cmml" xref="S3.SS2.p2.5.m3.4.4.1"><times id="S3.SS2.p2.5.m3.4.4.1.2.cmml" xref="S3.SS2.p2.5.m3.4.4.1.2"></times><ci id="S3.SS2.p2.5.m3.4.4.1.3.cmml" xref="S3.SS2.p2.5.m3.4.4.1.3">𝐹</ci><interval closure="open" id="S3.SS2.p2.5.m3.4.4.1.1.2.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1"><ci id="S3.SS2.p2.5.m3.3.3.cmml" xref="S3.SS2.p2.5.m3.3.3">𝐱</ci><apply id="S3.SS2.p2.5.m3.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1"><times id="S3.SS2.p2.5.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.1"></times><apply id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.5.m3.4.4.1.1.1.1.3.2"><ci id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1">𝐱</ci><cn id="S3.SS2.p2.5.m3.2.2.cmml" type="integer" xref="S3.SS2.p2.5.m3.2.2">0</cn></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.4c">\mathbf{y}_{1}=F(\mathbf{x},f_{\theta}(\mathbf{x},\mathbf{0}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m3.4d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_F ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) )</annotation></semantics></math>, is made using the frozen model <math alttext="F" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m4.1"><semantics id="S3.SS2.p2.6.m4.1a"><mi id="S3.SS2.p2.6.m4.1.1" xref="S3.SS2.p2.6.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m4.1b"><ci id="S3.SS2.p2.6.m4.1.1.cmml" xref="S3.SS2.p2.6.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m4.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m4.1d">italic_F</annotation></semantics></math>.
By updating only <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m5.1"><semantics id="S3.SS2.p2.7.m5.1a"><msub id="S3.SS2.p2.7.m5.1.1" xref="S3.SS2.p2.7.m5.1.1.cmml"><mi id="S3.SS2.p2.7.m5.1.1.2" xref="S3.SS2.p2.7.m5.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.7.m5.1.1.3" xref="S3.SS2.p2.7.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m5.1b"><apply id="S3.SS2.p2.7.m5.1.1.cmml" xref="S3.SS2.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m5.1.1.1.cmml" xref="S3.SS2.p2.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m5.1.1.2.cmml" xref="S3.SS2.p2.7.m5.1.1.2">𝑓</ci><ci id="S3.SS2.p2.7.m5.1.1.3.cmml" xref="S3.SS2.p2.7.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m5.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m5.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and keeping <math alttext="F" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m6.1"><semantics id="S3.SS2.p2.8.m6.1a"><mi id="S3.SS2.p2.8.m6.1.1" xref="S3.SS2.p2.8.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m6.1b"><ci id="S3.SS2.p2.8.m6.1.1.cmml" xref="S3.SS2.p2.8.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m6.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m6.1d">italic_F</annotation></semantics></math> fixed,
we ensure that <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m7.1"><semantics id="S3.SS2.p2.9.m7.1a"><msub id="S3.SS2.p2.9.m7.1.1" xref="S3.SS2.p2.9.m7.1.1.cmml"><mi id="S3.SS2.p2.9.m7.1.1.2" xref="S3.SS2.p2.9.m7.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p2.9.m7.1.1.3" xref="S3.SS2.p2.9.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m7.1b"><apply id="S3.SS2.p2.9.m7.1.1.cmml" xref="S3.SS2.p2.9.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m7.1.1.1.cmml" xref="S3.SS2.p2.9.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m7.1.1.2.cmml" xref="S3.SS2.p2.9.m7.1.1.2">𝐲</ci><cn id="S3.SS2.p2.9.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p2.9.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m7.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m7.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is adjusted to minimize the discrepancy with <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m8.1"><semantics id="S3.SS2.p2.10.m8.1a"><msub id="S3.SS2.p2.10.m8.1.1" xref="S3.SS2.p2.10.m8.1.1.cmml"><mi id="S3.SS2.p2.10.m8.1.1.2" xref="S3.SS2.p2.10.m8.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p2.10.m8.1.1.3" xref="S3.SS2.p2.10.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m8.1b"><apply id="S3.SS2.p2.10.m8.1.1.cmml" xref="S3.SS2.p2.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m8.1.1.1.cmml" xref="S3.SS2.p2.10.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.10.m8.1.1.2.cmml" xref="S3.SS2.p2.10.m8.1.1.2">𝐲</ci><cn id="S3.SS2.p2.10.m8.1.1.3.cmml" type="integer" xref="S3.SS2.p2.10.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m8.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m8.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,
without pulling <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p2.11.m9.1"><semantics id="S3.SS2.p2.11.m9.1a"><msub id="S3.SS2.p2.11.m9.1.1" xref="S3.SS2.p2.11.m9.1.1.cmml"><mi id="S3.SS2.p2.11.m9.1.1.2" xref="S3.SS2.p2.11.m9.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p2.11.m9.1.1.3" xref="S3.SS2.p2.11.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m9.1b"><apply id="S3.SS2.p2.11.m9.1.1.cmml" xref="S3.SS2.p2.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m9.1.1.1.cmml" xref="S3.SS2.p2.11.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.11.m9.1.1.2.cmml" xref="S3.SS2.p2.11.m9.1.1.2">𝐲</ci><cn id="S3.SS2.p2.11.m9.1.1.3.cmml" type="integer" xref="S3.SS2.p2.11.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m9.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.m9.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> toward an incorrect <math alttext="\mathbf{y}_{0}" class="ltx_Math" display="inline" id="S3.SS2.p2.12.m10.1"><semantics id="S3.SS2.p2.12.m10.1a"><msub id="S3.SS2.p2.12.m10.1.1" xref="S3.SS2.p2.12.m10.1.1.cmml"><mi id="S3.SS2.p2.12.m10.1.1.2" xref="S3.SS2.p2.12.m10.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p2.12.m10.1.1.3" xref="S3.SS2.p2.12.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m10.1b"><apply id="S3.SS2.p2.12.m10.1.1.cmml" xref="S3.SS2.p2.12.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m10.1.1.1.cmml" xref="S3.SS2.p2.12.m10.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m10.1.1.2.cmml" xref="S3.SS2.p2.12.m10.1.1.2">𝐲</ci><cn id="S3.SS2.p2.12.m10.1.1.3.cmml" type="integer" xref="S3.SS2.p2.12.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m10.1c">\mathbf{y}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.12.m10.1d">bold_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. A similar idea was employed in the IGN approach <cite class="ltx_cite ltx_citemacro_citep">(Shocher et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib37" title="">2024</a>)</cite>
meaningful predictions are required. After each TTT optimization iteration, the dynamic model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.13.m11.1"><semantics id="S3.SS2.p2.13.m11.1a"><msub id="S3.SS2.p2.13.m11.1.1" xref="S3.SS2.p2.13.m11.1.1.cmml"><mi id="S3.SS2.p2.13.m11.1.1.2" xref="S3.SS2.p2.13.m11.1.1.2.cmml">f</mi><mi id="S3.SS2.p2.13.m11.1.1.3" xref="S3.SS2.p2.13.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m11.1b"><apply id="S3.SS2.p2.13.m11.1.1.cmml" xref="S3.SS2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m11.1.1.1.cmml" xref="S3.SS2.p2.13.m11.1.1">subscript</csymbol><ci id="S3.SS2.p2.13.m11.1.1.2.cmml" xref="S3.SS2.p2.13.m11.1.1.2">𝑓</ci><ci id="S3.SS2.p2.13.m11.1.1.3.cmml" xref="S3.SS2.p2.13.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m11.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.13.m11.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is initialized with <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.SS2.p2.14.m12.1"><semantics id="S3.SS2.p2.14.m12.1a"><mi id="S3.SS2.p2.14.m12.1.1" mathvariant="normal" xref="S3.SS2.p2.14.m12.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m12.1b"><ci id="S3.SS2.p2.14.m12.1.1.cmml" xref="S3.SS2.p2.14.m12.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m12.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.14.m12.1d">roman_Θ</annotation></semantics></math>, ready for the next input.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Online IT<sup class="ltx_sup" id="S3.SS3.2.1">3</sup>
</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.5">For streaming data scenarios, where the distribution shifts continuously over time, we modify IT<sup class="ltx_sup" id="S3.SS3.p1.5.1">3</sup> to operate in an online mode by not resetting <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> back to <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_F</annotation></semantics></math> after each TTT episode, as we did in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS2" title="3.2 Test-Time Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
We essentially assume that the distribution mostly shifts smoothly and, thus, there is a good reason to believe that the current state of <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is a better
initialization for the next TTT episode than the original <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_F</annotation></semantics></math>. This makes the model evolve over time.
In this scheme, it can happen that the performance of the model on data
from its original training decreases significantly, a phenomenon known as catastrophic
forgetting <cite class="ltx_cite ltx_citemacro_citep">(Kirkpatrick et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib26" title="">2017</a>)</cite>. This is acceptable as the goal is to perform well on data at the present moment, rather than on past examples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.11">Another modification in the online setup is for the second sequential application of the model,
i.e., the <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_F</annotation></semantics></math> in <math alttext="F(\mathbf{x},f_{\theta}(\mathbf{x},\mathbf{0}))" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.4"><semantics id="S3.SS3.p2.2.m2.4a"><mrow id="S3.SS3.p2.2.m2.4.4" xref="S3.SS3.p2.2.m2.4.4.cmml"><mi id="S3.SS3.p2.2.m2.4.4.3" xref="S3.SS3.p2.2.m2.4.4.3.cmml">F</mi><mo id="S3.SS3.p2.2.m2.4.4.2" xref="S3.SS3.p2.2.m2.4.4.2.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.4.4.1.1" xref="S3.SS3.p2.2.m2.4.4.1.2.cmml"><mo id="S3.SS3.p2.2.m2.4.4.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.4.4.1.2.cmml">(</mo><mi id="S3.SS3.p2.2.m2.3.3" xref="S3.SS3.p2.2.m2.3.3.cmml">𝐱</mi><mo id="S3.SS3.p2.2.m2.4.4.1.1.3" xref="S3.SS3.p2.2.m2.4.4.1.2.cmml">,</mo><mrow id="S3.SS3.p2.2.m2.4.4.1.1.1" xref="S3.SS3.p2.2.m2.4.4.1.1.1.cmml"><msub id="S3.SS3.p2.2.m2.4.4.1.1.1.2" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2.cmml"><mi id="S3.SS3.p2.2.m2.4.4.1.1.1.2.2" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2.2.cmml">f</mi><mi id="S3.SS3.p2.2.m2.4.4.1.1.1.2.3" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.SS3.p2.2.m2.4.4.1.1.1.1" xref="S3.SS3.p2.2.m2.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.4.4.1.1.1.3.2" xref="S3.SS3.p2.2.m2.4.4.1.1.1.3.1.cmml"><mo id="S3.SS3.p2.2.m2.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.p2.2.m2.4.4.1.1.1.3.1.cmml">(</mo><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">𝐱</mi><mo id="S3.SS3.p2.2.m2.4.4.1.1.1.3.2.2" xref="S3.SS3.p2.2.m2.4.4.1.1.1.3.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">𝟎</mn><mo id="S3.SS3.p2.2.m2.4.4.1.1.1.3.2.3" stretchy="false" xref="S3.SS3.p2.2.m2.4.4.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.2.m2.4.4.1.1.4" stretchy="false" xref="S3.SS3.p2.2.m2.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.4b"><apply id="S3.SS3.p2.2.m2.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4"><times id="S3.SS3.p2.2.m2.4.4.2.cmml" xref="S3.SS3.p2.2.m2.4.4.2"></times><ci id="S3.SS3.p2.2.m2.4.4.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3">𝐹</ci><interval closure="open" id="S3.SS3.p2.2.m2.4.4.1.2.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1"><ci id="S3.SS3.p2.2.m2.3.3.cmml" xref="S3.SS3.p2.2.m2.3.3">𝐱</ci><apply id="S3.SS3.p2.2.m2.4.4.1.1.1.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1"><times id="S3.SS3.p2.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.1"></times><apply id="S3.SS3.p2.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.4.4.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2.2">𝑓</ci><ci id="S3.SS3.p2.2.m2.4.4.1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.SS3.p2.2.m2.4.4.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.4.4.1.1.1.3.2"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝐱</ci><cn id="S3.SS3.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS3.p2.2.m2.2.2">0</cn></interval></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.4c">F(\mathbf{x},f_{\theta}(\mathbf{x},\mathbf{0}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.4d">italic_F ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) )</annotation></semantics></math>.
Since the data keeps shifting, there is no reason to retain the frozen <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_F</annotation></semantics></math> as an anchor indefinitely.
Over time, <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> may diverge far from <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_F</annotation></semantics></math>, making it irrelevant. Relying on the old state of the model
would prevent the model from evolving efficiently. Replacing it with the current state of <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝑓</ci><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is out of
the question, as it causes collapse. We need an anchor that is influenced by a reasonable amount
of data, yet evolves over time. Our solution is to replace <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_F</annotation></semantics></math> with an Exponential Moving Average (EMA) of the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><msub id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">𝑓</ci><ci id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, denoted as <math alttext="f_{\text{EMA}}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">f</mi><mtext id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3a.cmml">EMA</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑓</ci><ci id="S3.SS3.p2.9.m9.1.1.3a.cmml" xref="S3.SS3.p2.9.m9.1.1.3"><mtext id="S3.SS3.p2.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.9.m9.1.1.3">EMA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">f_{\text{EMA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">italic_f start_POSTSUBSCRIPT EMA end_POSTSUBSCRIPT</annotation></semantics></math>. This means <math alttext="f_{\text{EMA}}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><msub id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">f</mi><mtext id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3a.cmml">EMA</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑓</ci><ci id="S3.SS3.p2.10.m10.1.1.3a.cmml" xref="S3.SS3.p2.10.m10.1.1.3"><mtext id="S3.SS3.p2.10.m10.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.10.m10.1.1.3">EMA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">f_{\text{EMA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">italic_f start_POSTSUBSCRIPT EMA end_POSTSUBSCRIPT</annotation></semantics></math> is a smoothed version of <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><msub id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mi id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">𝑓</ci><ci id="S3.SS3.p2.11.m11.1.1.3.cmml" xref="S3.SS3.p2.11.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> over time.
The test-time loss in the online setting then becomes</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx5">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{online}}=\|f_{\text{EMA}}(\mathbf{x},f_{\theta%
}(\mathbf{x},\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;." class="ltx_Math" display="inline" id="S3.E6.m1.6"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.6.1" xref="S3.E6.m1.6.6.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml"><msub id="S3.E6.m1.6.6.1.1.3" xref="S3.E6.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.6.6.1.1.3.2" xref="S3.E6.m1.6.6.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.6.6.1.1.3.3" xref="S3.E6.m1.6.6.1.1.3.3a.cmml">online</mtext></msub><mo id="S3.E6.m1.6.6.1.1.2" xref="S3.E6.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.6.6.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.2.cmml"><mo id="S3.E6.m1.6.6.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.6.6.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.2.cmml">f</mi><mtext id="S3.E6.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.3a.cmml">EMA</mtext></msub><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐱</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐱</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mn id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝟎</mn><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.6.6.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.6.6.1.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.3.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E6.m1.6.6.1.1.1.1.1.3.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2.3.cmml">θ</mi></msub><mo id="S3.E6.m1.6.6.1.1.1.1.1.3.1" xref="S3.E6.m1.6.6.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.3.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E6.m1.6.6.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">𝐱</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.3.3.1.cmml">,</mo><mn id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">𝟎</mn><mo id="S3.E6.m1.6.6.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.6.6.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S3.E6.m1.6.6.1.2" xref="S3.E6.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1"><eq id="S3.E6.m1.6.6.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2"></eq><apply id="S3.E6.m1.6.6.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.3.2">ℒ</ci><ci id="S3.E6.m1.6.6.1.1.3.3a.cmml" xref="S3.E6.m1.6.6.1.1.3.3"><mtext id="S3.E6.m1.6.6.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.6.6.1.1.3.3">online</mtext></ci></apply><apply id="S3.E6.m1.6.6.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.6.6.1.1.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.6.6.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1"><minus id="S3.E6.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1"><times id="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.3"><mtext id="S3.E6.m1.6.6.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.3">EMA</mtext></ci></apply><interval closure="open" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐱</ci><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><interval closure="open" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐱</ci><cn id="S3.E6.m1.2.2.cmml" type="integer" xref="S3.E6.m1.2.2">0</cn></interval></apply></interval></apply><apply id="S3.E6.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3"><times id="S3.E6.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.1"></times><apply id="S3.E6.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.E6.m1.6.6.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.3.3.2"><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝐱</ci><cn id="S3.E6.m1.5.5.cmml" type="integer" xref="S3.E6.m1.5.5">0</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\displaystyle\mathcal{L}_{\text{online}}=\|f_{\text{EMA}}(\mathbf{x},f_{\theta%
}(\mathbf{x},\mathbf{0}))-f_{\theta}(\mathbf{x},\mathbf{0})\|\;.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.6d">caligraphic_L start_POSTSUBSCRIPT online end_POSTSUBSCRIPT = ∥ italic_f start_POSTSUBSCRIPT EMA end_POSTSUBSCRIPT ( bold_x , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ) - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_x , bold_0 ) ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.14">By updating both <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m1.1"><semantics id="S3.SS3.p2.12.m1.1a"><msub id="S3.SS3.p2.12.m1.1.1" xref="S3.SS3.p2.12.m1.1.1.cmml"><mi id="S3.SS3.p2.12.m1.1.1.2" xref="S3.SS3.p2.12.m1.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.12.m1.1.1.3" xref="S3.SS3.p2.12.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m1.1b"><apply id="S3.SS3.p2.12.m1.1.1.cmml" xref="S3.SS3.p2.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m1.1.1.1.cmml" xref="S3.SS3.p2.12.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.12.m1.1.1.2.cmml" xref="S3.SS3.p2.12.m1.1.1.2">𝑓</ci><ci id="S3.SS3.p2.12.m1.1.1.3.cmml" xref="S3.SS3.p2.12.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{\text{EMA}}" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m2.1"><semantics id="S3.SS3.p2.13.m2.1a"><msub id="S3.SS3.p2.13.m2.1.1" xref="S3.SS3.p2.13.m2.1.1.cmml"><mi id="S3.SS3.p2.13.m2.1.1.2" xref="S3.SS3.p2.13.m2.1.1.2.cmml">f</mi><mtext id="S3.SS3.p2.13.m2.1.1.3" xref="S3.SS3.p2.13.m2.1.1.3a.cmml">EMA</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m2.1b"><apply id="S3.SS3.p2.13.m2.1.1.cmml" xref="S3.SS3.p2.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m2.1.1.1.cmml" xref="S3.SS3.p2.13.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.13.m2.1.1.2.cmml" xref="S3.SS3.p2.13.m2.1.1.2">𝑓</ci><ci id="S3.SS3.p2.13.m2.1.1.3a.cmml" xref="S3.SS3.p2.13.m2.1.1.3"><mtext id="S3.SS3.p2.13.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.13.m2.1.1.3">EMA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m2.1c">f_{\text{EMA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m2.1d">italic_f start_POSTSUBSCRIPT EMA end_POSTSUBSCRIPT</annotation></semantics></math> incrementally,
with <math alttext="f_{\text{EMA}}" class="ltx_Math" display="inline" id="S3.SS3.p2.14.m3.1"><semantics id="S3.SS3.p2.14.m3.1a"><msub id="S3.SS3.p2.14.m3.1.1" xref="S3.SS3.p2.14.m3.1.1.cmml"><mi id="S3.SS3.p2.14.m3.1.1.2" xref="S3.SS3.p2.14.m3.1.1.2.cmml">f</mi><mtext id="S3.SS3.p2.14.m3.1.1.3" xref="S3.SS3.p2.14.m3.1.1.3a.cmml">EMA</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m3.1b"><apply id="S3.SS3.p2.14.m3.1.1.cmml" xref="S3.SS3.p2.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.14.m3.1.1.1.cmml" xref="S3.SS3.p2.14.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.14.m3.1.1.2.cmml" xref="S3.SS3.p2.14.m3.1.1.2">𝑓</ci><ci id="S3.SS3.p2.14.m3.1.1.3a.cmml" xref="S3.SS3.p2.14.m3.1.1.3"><mtext id="S3.SS3.p2.14.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.14.m3.1.1.3">EMA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m3.1c">f_{\text{EMA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.14.m3.1d">italic_f start_POSTSUBSCRIPT EMA end_POSTSUBSCRIPT</annotation></semantics></math> serving as a stable reference that changes more slowly,
the model adapts to gradual shifts without overfitting to noise or temporary anomalies.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We evaluate our approach across a diverse set of data types and tasks, including age prediction, image classification, and road segmentation in the visual domain, as well as aerodynamics prediction using 3D data and tabular data experiments. In all these scenarios, we first train the model using the supervised approach of Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS1" title="3.1 Initial Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3.1</span></a> and then perform the test-time training of Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S3.SS2" title="3.2 Test-Time Training ‣ 3 Method ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">3.2</span></a>. For each task, we design an OOD data subset for evaluation. The OOD data is divided into several levels, with higher levels representing data that is progressively further from the training distribution. In each experiment, we observe how quickly the model’s performance degrades as the level of OOD-ness increases. We have not found test-time adaptation baselines matching the TTT problem setup for any of the tasks except image classification. So we provide the comparative numbers in this case and, for all cases, we compare against the performance of the vanilla non adaptive model. In all cases we used published, common, strong models that are state-of-the-art or close to it. Across all scenarios, our method degrades slower than the vanilla network baseline.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Tabular Data</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Tabular data consists of numerical features and corresponding continuous target values for regression tasks from the UCI tabular datasets <cite class="ltx_cite ltx_citemacro_citep">(Bay et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib3" title="">2000</a>)</cite>. They are widely used in machine learning research for benchmarking regression models. In our case, we use The Boston Housing dataset describes housing prices in the suburbs of Boston, Massachusetts. It includes various features related to socioeconomic and geographical factors that influence housing prices. We take a test set and gradually apply random feature zeroing with increasing probabilities of 5%, 10%, 15%, and 20% (4 mentioned levels of OOD). This random feature dropping simulates out-of-distribution (OOD) data by progressively altering the input features, making the data less similar to the original training distribution. As the probability of feature dropping increases, the data becomes more OOD, which lowers the model’s accuracy. The trained model is a simple Multi-Layer Perceptron (MLP) optimized using the Adam optimizer, and we observe that IT<sup class="ltx_sup" id="S4.SS1.p1.1.1">3</sup> consistently degrades less compared to the vanilla baseline across all OOD levels as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F2" title="Figure 2 ‣ 4.1 Tabular Data ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.1" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="338" id="S4.F2.1.g1" src="x1.png" width="761"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F2.2" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="338" id="S4.F2.2.g1" src="x2.png" width="761"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S4.F2.13.1">UCI Results on OOD inputs</span>: The plots illustrate the performance of IT<sup class="ltx_sup" id="S4.F2.14.2">3</sup> compared to a vanilla model across different OOD levels. <span class="ltx_text ltx_font_bold" id="S4.F2.15.3">Left</span>: The mean absolute error (MAE) shows that ITTT outperforms the vanilla model, retaining performance better as the data shifts further from the training distribution. <span class="ltx_text ltx_font_bold" id="S4.F2.16.4">Right</span>: The box plot for car data shows the distribution of MAE at various OOD levels, where ITTT with different batch sizes ([<span class="ltx_text ltx_font_bold" id="S4.F2.17.5" style="color:#FFDAB9;">batch=1</span>, <span class="ltx_text ltx_font_bold" id="S4.F2.18.6" style="color:#C1BED6;">batch=4</span>, <span class="ltx_text ltx_font_bold" id="S4.F2.19.7" style="color:#EA8E83;">batch=8</span>]) degrades less compared to the <span class="ltx_text ltx_font_bold" id="S4.F2.20.8" style="color:#96CAC1;">Not optimized</span> baseline. Larger batch sizes preserve performance more effectively.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>CIFAR</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="237" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S4.F3.6.1">Test error (%) on CIFAR-10-C with level 5 corruptions.</span> We compare our approaches, <math alttext="IT^{3}" class="ltx_Math" display="inline" id="S4.F3.3.m1.1"><semantics id="S4.F3.3.m1.1b"><mrow id="S4.F3.3.m1.1.1" xref="S4.F3.3.m1.1.1.cmml"><mi id="S4.F3.3.m1.1.1.2" xref="S4.F3.3.m1.1.1.2.cmml">I</mi><mo id="S4.F3.3.m1.1.1.1" xref="S4.F3.3.m1.1.1.1.cmml">⁢</mo><msup id="S4.F3.3.m1.1.1.3" xref="S4.F3.3.m1.1.1.3.cmml"><mi id="S4.F3.3.m1.1.1.3.2" xref="S4.F3.3.m1.1.1.3.2.cmml">T</mi><mn id="S4.F3.3.m1.1.1.3.3" xref="S4.F3.3.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.3.m1.1c"><apply id="S4.F3.3.m1.1.1.cmml" xref="S4.F3.3.m1.1.1"><times id="S4.F3.3.m1.1.1.1.cmml" xref="S4.F3.3.m1.1.1.1"></times><ci id="S4.F3.3.m1.1.1.2.cmml" xref="S4.F3.3.m1.1.1.2">𝐼</ci><apply id="S4.F3.3.m1.1.1.3.cmml" xref="S4.F3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.F3.3.m1.1.1.3.1.cmml" xref="S4.F3.3.m1.1.1.3">superscript</csymbol><ci id="S4.F3.3.m1.1.1.3.2.cmml" xref="S4.F3.3.m1.1.1.3.2">𝑇</ci><cn id="S4.F3.3.m1.1.1.3.3.cmml" type="integer" xref="S4.F3.3.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.3.m1.1d">IT^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.3.m1.1e">italic_I italic_T start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, with object recognition without self-supervision. <math alttext="IT^{3}" class="ltx_Math" display="inline" id="S4.F3.4.m2.1"><semantics id="S4.F3.4.m2.1b"><mrow id="S4.F3.4.m2.1.1" xref="S4.F3.4.m2.1.1.cmml"><mi id="S4.F3.4.m2.1.1.2" xref="S4.F3.4.m2.1.1.2.cmml">I</mi><mo id="S4.F3.4.m2.1.1.1" xref="S4.F3.4.m2.1.1.1.cmml">⁢</mo><msup id="S4.F3.4.m2.1.1.3" xref="S4.F3.4.m2.1.1.3.cmml"><mi id="S4.F3.4.m2.1.1.3.2" xref="S4.F3.4.m2.1.1.3.2.cmml">T</mi><mn id="S4.F3.4.m2.1.1.3.3" xref="S4.F3.4.m2.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.4.m2.1c"><apply id="S4.F3.4.m2.1.1.cmml" xref="S4.F3.4.m2.1.1"><times id="S4.F3.4.m2.1.1.1.cmml" xref="S4.F3.4.m2.1.1.1"></times><ci id="S4.F3.4.m2.1.1.2.cmml" xref="S4.F3.4.m2.1.1.2">𝐼</ci><apply id="S4.F3.4.m2.1.1.3.cmml" xref="S4.F3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S4.F3.4.m2.1.1.3.1.cmml" xref="S4.F3.4.m2.1.1.3">superscript</csymbol><ci id="S4.F3.4.m2.1.1.3.2.cmml" xref="S4.F3.4.m2.1.1.3.2">𝑇</ci><cn id="S4.F3.4.m2.1.1.3.3.cmml" type="integer" xref="S4.F3.4.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m2.1d">IT^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.m2.1e">italic_I italic_T start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> improves over the baseline and higher batch size improves even further.
The comparison with TTT <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib38" title="">2020</a>)</cite> is provided for context, but it is not a direct comparison, as TTT uses a batch size of 1. Augmentations over this single instance create a batch of 32, yet only one instance is accessed at a time.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We conducted similar experiments using the CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib27" title="">2014</a>)</cite> dataset, selecting CIFAR-C <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks &amp; Dietterich, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib22" title="">2019</a>)</cite> as the out-of-distribution (OOD) data. CIFAR-C contains the same images as CIFAR-10 but with various common corruptions, such as Gaussian noise, blur, and contrast variations, simulating real-world conditions. These corruptions are applied at different severity levels, allowing us to evaluate how the model’s performance degrades as the data shifts further from the original CIFAR-10 distribution. For this experiment, we used the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.1">Deep Layer Aggregation</span> (DLA) <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib44" title="">2018</a>)</cite> network, known for its strong performance in image classification and robustness to overfitting. We trained the model according to the guidelines from the original DLA paper to ensure optimal results. Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F2" title="Figure 2 ‣ 4.1 Tabular Data ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">2</span></a> shows the evaluation error on CIFAR-C at severity level 5 for different types of corruptions, following <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib38" title="">2020</a>)</cite>. As shown, IT<sup class="ltx_sup" id="S4.SS2.p1.1.2">3</sup> outperforms the vanilla model, with higher batch sizes yielding the best results.
In our basic setup, batch size of 1 does not work well. We did not explore the possibility of following <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib38" title="">2020</a>)</cite> creating a batch of augmented copies, as this would be a domain specific element, hurting the purity of our general method.
For context, we add TTT results, while fully acknowledging that this is not a fair comparison as they have access to a single instance, making the batch size effectively 1, although augmented to a batch of size 32.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Age Prediction</h3>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F6.33" style="width:166.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_align_middle" id="S4.F6.30.30">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.F6.10.10.10">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F6.1.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.1.1.1.1.g1" src="extracted/5896912/images/age_viz/age_img_test_1.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.2.2.2.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.2.2.2.2.g1" src="extracted/5896912/images/age_viz/age_img_test_3.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.3.3.3.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.3.3.3.3.g1" src="extracted/5896912/images/age_viz/age_img_test_10.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.4.4.4.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.4.4.4.4.g1" src="extracted/5896912/images/age_viz/age_img_test_20.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.5.5.5.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.5.5.5.5.g1" src="extracted/5896912/images/age_viz/age_img_test_51.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.6.6.6.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.6.6.6.6.g1" src="extracted/5896912/images/age_viz/age_img_test_52.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.7.7.7.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.7.7.7.7.g1" src="extracted/5896912/images/age_viz/age_img_test_53.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.8.8.8.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.8.8.8.8.g1" src="extracted/5896912/images/age_viz/age_img_test_54.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.9.9.9.9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.9.9.9.9.g1" src="extracted/5896912/images/age_viz/age_img_test_55.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.10.10.10.10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.10.10.10.10.g1" src="extracted/5896912/images/age_viz/age_img_test_56.png" width="55"/></td>
</tr>
<tr class="ltx_tr" id="S4.F6.20.20.20">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F6.11.11.11.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.11.11.11.1.g1" src="extracted/5896912/images/age_viz/age_img_young_0.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.12.12.12.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.12.12.12.2.g1" src="extracted/5896912/images/age_viz/age_img_young_2.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.13.13.13.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.13.13.13.3.g1" src="extracted/5896912/images/age_viz/age_img_young_4.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.14.14.14.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.14.14.14.4.g1" src="extracted/5896912/images/age_viz/age_img_young_8.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.15.15.15.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.15.15.15.5.g1" src="extracted/5896912/images/age_viz/age_img_young_58.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.16.16.16.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.16.16.16.6.g1" src="extracted/5896912/images/age_viz/age_img_young_59.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.17.17.17.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.17.17.17.7.g1" src="extracted/5896912/images/age_viz/age_img_young_60.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.18.18.18.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.18.18.18.8.g1" src="extracted/5896912/images/age_viz/age_img_young_62.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.19.19.19.9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.19.19.19.9.g1" src="extracted/5896912/images/age_viz/age_img_young_65.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.20.20.20.10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.20.20.20.10.g1" src="extracted/5896912/images/age_viz/age_img_young_66.png" width="55"/></td>
</tr>
<tr class="ltx_tr" id="S4.F6.30.30.30">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.F6.21.21.21.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.21.21.21.1.g1" src="extracted/5896912/images/age_viz/age_img_old_1.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.22.22.22.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.22.22.22.2.g1" src="extracted/5896912/images/age_viz/age_img_old_17.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.23.23.23.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.23.23.23.3.g1" src="extracted/5896912/images/age_viz/age_img_old_12.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.24.24.24.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.24.24.24.4.g1" src="extracted/5896912/images/age_viz/age_img_old_14.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.25.25.25.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.25.25.25.5.g1" src="extracted/5896912/images/age_viz/age_img_old_52.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.26.26.26.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.26.26.26.6.g1" src="extracted/5896912/images/age_viz/age_img_old_54.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.27.27.27.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.27.27.27.7.g1" src="extracted/5896912/images/age_viz/age_img_old_57.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.28.28.28.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.28.28.28.8.g1" src="extracted/5896912/images/age_viz/age_img_old_61.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.29.29.29.9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.29.29.29.9.g1" src="extracted/5896912/images/age_viz/age_img_old_63.png" width="55"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.F6.30.30.30.10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="55" id="S4.F6.30.30.30.10.g1" src="extracted/5896912/images/age_viz/age_img_old_64.png" width="55"/></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S4.F6.33.37.1">Face Samples.</span> The <span class="ltx_text ltx_font_bold" id="S4.F6.33.38.2">(top)</span> row shows training images of middle-aged individuals, while <span class="ltx_text ltx_font_bold" id="S4.F6.33.39.3">(middle)</span> and <span class="ltx_text ltx_font_bold" id="S4.F6.33.40.4">(bottom)</span> display images of older and younger individuals (OOD).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="338" id="S4.F6.31.g1" src="x4.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S4.F6.33.43.1">Age mean results on OOD shapes.</span> The plot compares IT<sup class="ltx_sup" id="S4.F6.33.44.2">3</sup> to a baseline, showing better performance retention as data shifts from the training distribution.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F6.36" style="width:218.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="507" id="S4.F6.34.g1" src="x5.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S4.F6.36.9.1">Age boxplot results on OOD shapes.</span> <span class="ltx_text ltx_font_bold" id="S4.F6.36.10.2" style="color:#96CAC1;">Not optimized</span> corresponds to a single model without TTT applied. IT<sup class="ltx_sup" id="S4.F6.36.11.3">3</sup> with [<span class="ltx_text ltx_font_bold" id="S4.F6.36.12.4" style="color:#FFDAB9;">batch=4</span>, <span class="ltx_text ltx_font_bold" id="S4.F6.36.13.5" style="color:#C1BED6;">batch=8</span>, and <span class="ltx_text ltx_font_bold" id="S4.F6.36.14.6" style="color:#EA8E83;">batch=16</span>] represents our method at different batch sizes. As the data shifts further from the training distribution, our method degrades less, with larger batches preserving performance more effectively.</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To experiment with image-based age prediction from face images, we use the UTKFace dataset <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib45" title="">2017</a>)</cite>, a large-scale collection containing tens of thousands of face images annotated with age information. The model is trained on face images of individuals aged between 20 and 60, while individuals younger or older than this range are considered out-of-distribution (OOD) (Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F6" title="Figure 6 ‣ 4.3 Age Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">6</span></a>). The further the age is from the 20-60 interval, the higher the OOD level we assign to it. We use a ResNet-152 backbone with five additional linear layers and ReLU activations. This architecture delivers strong accuracy, outperforming the popular ordinal regression model CORAL <cite class="ltx_cite ltx_citemacro_citep">(Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib6" title="">2020</a>)</cite> and matching other state-of-the-art methods <cite class="ltx_cite ltx_citemacro_citep">(Berg et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib4" title="">2021</a>)</cite>. We train our model on the UTKFace training set (limited to individuals aged 20-60) and then run inference on faces at different OOD levels. Once again, IT<sup class="ltx_sup" id="S4.SS3.p1.1.1">3</sup> significantly outperforms the non-optimized model, as shown in Figs.<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F6" title="Figure 6 ‣ 4.3 Age Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">6</span></a> and<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F6" title="Figure 6 ‣ 4.3 Age Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Road Segmentation</h3>
<figure class="ltx_figure" id="S4.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F9.4" style="width:166.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="380" id="S4.F9.1.g1" src="x6.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="S4.F9.4.6.1">Road Samples.</span>
RoadTracer dataset <span class="ltx_text ltx_font_bold" id="S4.F9.4.7.2">(left)</span> covers urban areas of six different countries while Massachusetts dataset <span class="ltx_text ltx_font_bold" id="S4.F9.4.8.3">(right)</span> primarily features rural neighborhoods along with some urban areas.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="338" id="S4.F9.2.g2" src="x7.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="S4.F9.4.11.1">Roads mean quality score on OOD images.</span> The plot compares IT<sup class="ltx_sup" id="S4.F9.4.12.2">3</sup> to the vanilla model, showing better performance retention as data shifts from the training distribution.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F9.7" style="width:222.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="634" id="S4.F9.5.g1" src="x8.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="S4.F9.7.9.1">Roads results on OOD images.</span> <span class="ltx_text ltx_font_bold" id="S4.F9.7.10.2" style="color:#96CAC1;">Not optimized</span> corresponds to a single model without TTT applied. IT<sup class="ltx_sup" id="S4.F9.7.11.3">3</sup> with [<span class="ltx_text ltx_font_bold" id="S4.F9.7.12.4" style="color:#FFDAB9;">batch=4</span>, <span class="ltx_text ltx_font_bold" id="S4.F9.7.13.5" style="color:#C1BED6;">batch=8</span>, and <span class="ltx_text ltx_font_bold" id="S4.F9.7.14.6" style="color:#EA8E83;">batch=16</span>] represents our method at different batch sizes. As the data shifts further from the training distribution, our method degrades less, with larger batches preserving performance more effectively.</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="188" id="S4.F10.g1" src="x9.png" width="753"/>
<br class="ltx_break"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="S4.F10.5.1">Qualitative effect of IT<sup class="ltx_sup" id="S4.F10.5.1.1"><span class="ltx_text ltx_font_medium" id="S4.F10.5.1.1.1">3</span></sup> on Road Segmentation.</span> From left to right: (1) Original aerial image, (2) Not optimized output, (3) IT<sup class="ltx_sup" id="S4.F10.12.2">3</sup> output at the 5th iteration, (4) IT<sup class="ltx_sup" id="S4.F10.13.3">3</sup> output at the 15th iteration, and (5) Ground truth label. The segmentation quality improves significantly with IT<sup class="ltx_sup" id="S4.F10.14.4">3</sup> iterations, as observed in the progressively refined outputs at the 5th and 15th iterations.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Our method can be generalized to segmentation tasks as well. To demonstrate this, we consider the problem of road segmentation in aerial imagery using the RoadTracer dataset <cite class="ltx_cite ltx_citemacro_citep">(Bastani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib2" title="">2018</a>)</cite>. We train a DRU-Net <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib40" title="">2019</a>)</cite>, on the RoadTracer dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">We perform OOD experiments using Massachusetts Road dataset <cite class="ltx_cite ltx_citemacro_citep">(Mnih, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib30" title="">2013</a>)</cite> that primarily comprises rural neighborhoods, as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F9" title="Figure 9 ‣ 4.4 Road Segmentation ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">9</span></a>. We sample 450 images, each with dimensions of <math alttext="1500\times 1500" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mn id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">1500</mn><mo id="S4.SS4.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">1500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><times id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></times><cn id="S4.SS4.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS4.p2.1.m1.1.1.2">1500</cn><cn id="S4.SS4.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS4.p2.1.m1.1.1.3">1500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">1500\times 1500</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">1500 × 1500</annotation></semantics></math> pixels and divide them into four groups based on the Mean Squared Error (MSE) of the segmentation outputs, effectively creating different levels of distributional shift within the sampled set. We then further train the network on these OOD subsets using the ZigZag method <cite class="ltx_cite ltx_citemacro_citep">(Durasov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib15" title="">2024b</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">We evaluate road segmentation performance by using <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.1">Correctness</span>, <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.2">Completeness</span> and <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.3">Quality</span> (CCQ) metric <cite class="ltx_cite ltx_citemacro_citep">(Wiedemann et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib42" title="">1998</a>)</cite> which is a popular metric to evaluate delineation performance. The <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.4">Correctness</span>, <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.5">Completeness</span> and <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.6">Quality</span> are equivalent to precision, recall and intersection-over-union, where the definition of a true positive has been relaxed from spatial coincidence of prediction and annotation to co-occurrence within a distance of 5 pixels. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F9" title="Figure 9 ‣ 4.4 Road Segmentation ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F9" title="Figure 9 ‣ 4.4 Road Segmentation ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">9</span></a>, IT<sup class="ltx_sup" id="S4.SS4.p3.1.7">3</sup> significantly improves the performance on OOD images.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Aerodynamics Prediction</h3>
<figure class="ltx_figure" id="S4.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F13.2" style="width:166.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="165" id="S4.F13.1.g1" src="extracted/5896912/images/profiles.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="S4.F13.2.4.1">Airfoil Samples.</span>
Training and testing profiles (<span class="ltx_text ltx_font_bold" id="S4.F13.2.5.2">left</span>) show reasonable aerodynamics, while OOD samples (<span class="ltx_text ltx_font_bold" id="S4.F13.2.6.3">right</span>) feature rare, high lift-to-drag shapes. Black arrows indicate pressure, and red lines show lift and drag.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="338" id="S4.F13.2.g2" src="x10.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span class="ltx_text ltx_font_bold" id="S4.F13.2.8.1">Cars mean error on OOD shapes.</span> The plot compares ITTT to the vanilla model, showing better performance retention as data shifts from the training distribution.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F13.3" style="width:222.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="507" id="S4.F13.3.g1" src="x11.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span class="ltx_text ltx_font_bold" id="S4.F13.3.7.1">Airfoil results on OOD shapes.</span> <span class="ltx_text ltx_font_bold" id="S4.F13.3.8.2" style="color:#96CAC1;">Not optimized</span> corresponds to a single model without TTT applied. <span class="ltx_text ltx_font_bold" id="S4.F13.3.9.3">ITTT</span> with [<span class="ltx_text ltx_font_bold" id="S4.F13.3.10.4" style="color:#FFDAB9;">batch=1</span>, <span class="ltx_text ltx_font_bold" id="S4.F13.3.11.5" style="color:#C1BED6;">batch=4</span>, and <span class="ltx_text ltx_font_bold" id="S4.F13.3.12.6" style="color:#EA8E83;">batch=16</span>] represents our method at different batch sizes. As the data shifts further from the training distribution, our method degrades less, with larger batches preserving performance more effectively.</figcaption>
</figure>
</div>
</div>
</figure>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Wings.</h4>
<div class="ltx_para ltx_noindent" id="S4.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">Our method is versatile and can handle various types of data. To illustrate this, we generated a dataset of 2,000 wing profiles, as depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F13" title="Figure 13 ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">13</span></a>, by sampling the widely used NACA parameters <cite class="ltx_cite ltx_citemacro_citep">(Jacobs &amp; Sherman, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib24" title="">1937</a>)</cite>. We used the XFoil simulator <cite class="ltx_cite ltx_citemacro_citep">(Drela, <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib10" title="">1989</a>)</cite> to compute the pressure distribution along each profile and estimate its lift-to-drag coefficient, a crucial indicator of aerodynamic performance. The resulting dataset consists of wing profiles <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2">𝐱</ci><ci id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.1.m1.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, represented by a set of 2D nodes, and the corresponding scalar lift-to-drag coefficient <math alttext="\mathbf{y}_{i}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝐲</mi><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2">𝐲</ci><ci id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.2.m2.1c">\mathbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="1\leq i\leq 2000" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS5.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml">1</mn><mo id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml">≤</mo><mi id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.4" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.4.cmml">i</mi><mo id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.5" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.5.cmml">≤</mo><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.6" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.6.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><and id="S4.SS5.SSS0.Px1.p1.3.m3.1.1a.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"></and><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1b.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><leq id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3"></leq><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2">1</cn><ci id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.4.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.4">𝑖</ci></apply><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1c.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><leq id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.5.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.5"></leq><share href="https://arxiv.org/html/2410.04201v1#S4.SS5.SSS0.Px1.p1.3.m3.1.1.4.cmml" id="S4.SS5.SSS0.Px1.p1.3.m3.1.1d.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"></share><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.6.cmml" type="integer" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.6">2000</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.3.m3.1c">1\leq i\leq 2000</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.3.m3.1d">1 ≤ italic_i ≤ 2000</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p2.3">We selected the top 5% of shapes, based on their lift-to-drag ratio, as out-of-distribution (OOD) samples. The OOD levels were determined using the ground truth lift-to-drag ratio, where higher OOD levels correspond to more aerodynamically streamlined shapes. The training set includes shapes with lift-to-drag values ranging from 0 to 60, with anything beyond this threshold considered OOD and excluded from training. We then trained a Graph Neural Network (GNN) composed of 25 GMM <cite class="ltx_cite ltx_citemacro_citep">(Monti et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib31" title="">2017</a>)</cite> layers, featuring ELU activations <cite class="ltx_cite ltx_citemacro_citep">(Clevert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib8" title="">2015</a>)</cite> and skip connections <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib20" title="">2016</a>)</cite>, to predict the lift-to-drag coefficient <math alttext="\mathbf{y}_{i}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p2.1.m1.1a"><msub id="S4.SS5.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝐲</mi><mi id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2">𝐲</ci><ci id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.1.m1.1c">\mathbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p2.1.m1.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from the profile <math alttext="\mathbf{x}_{i}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p2.2.m2.1a"><msub id="S4.SS5.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.cmml">𝐱</mi><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2">𝐱</ci><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.2.m2.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, following the approach of <cite class="ltx_cite ltx_citemacro_citep">(Remelli et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib33" title="">2020</a>; Durasov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib15" title="">2024b</a>)</cite>. As with previous experiments, IT<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p2.3.1">3</sup> significantly improves performance on OOD shapes and provides more accurate predictions compared to the vanilla model, as shown in Figs. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F13" title="Figure 13 ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">13</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F13" title="Figure 13 ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">13</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F16.2" style="width:166.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="171" id="S4.F16.1.g1" src="extracted/5896912/images/cars.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span><span class="ltx_text ltx_font_bold" id="S4.F16.2.4.1">Car Samples.</span>
The car dataset comprises many regular vehicles <span class="ltx_text ltx_font_bold" id="S4.F16.2.5.2">(left)</span> and a few streamlined ones <span class="ltx_text ltx_font_bold" id="S4.F16.2.6.3">(right)</span>, which we treat as being out-of-distribution. Red and blue denote high and low pressures respectively.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="338" id="S4.F16.2.g2" src="x12.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span><span class="ltx_text ltx_font_bold" id="S4.F16.2.8.1">Cars mean error on OOD shapes.</span> The plot compares ITTT to the vanilla model, showing better performance retention as data shifts from the training distribution.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F16.3" style="width:222.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="507" id="S4.F16.3.g1" src="x13.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span><span class="ltx_text ltx_font_bold" id="S4.F16.3.7.1">Car results on OOD shapes.</span> <span class="ltx_text ltx_font_bold" id="S4.F16.3.8.2" style="color:#96CAC1;">Not optimized</span> corresponds to a single model without TTT applied. <span class="ltx_text ltx_font_bold" id="S4.F16.3.9.3">ITTT</span> with [<span class="ltx_text ltx_font_bold" id="S4.F16.3.10.4" style="color:#FFDAB9;">batch=1</span>, <span class="ltx_text ltx_font_bold" id="S4.F16.3.11.5" style="color:#C1BED6;">batch=2</span>, and <span class="ltx_text ltx_font_bold" id="S4.F16.3.12.6" style="color:#EA8E83;">batch=4</span>] represents our method at different batch sizes. As the data shifts further from the training distribution, our method degrades less, with larger batches preserving performance more effectively.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Cars.</h4>
<div class="ltx_para ltx_noindent" id="S4.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.1">As for wings, we experimented with 3D car models from a subset of the ShapeNet dataset <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib7" title="">2015</a>)</cite>, which contains car meshes suitable for CFD simulations, as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F16" title="Figure 16 ‣ Wings. ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">16</span></a>. The experimental protocol was the same as for the wing profiles, except we used OpenFOAM <cite class="ltx_cite ltx_citemacro_citep">(Jasak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#bib.bib25" title="">2007</a>)</cite> to estimate drag coefficients and employed a more sophisticated network to predict them from the triangulated 3D car meshes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p2.2">To predict drag associated to a triangulated 3D car, we utilize similar model to airfoil experiments but with increased capacity. Instead of twenty five GMM layers, we use thirty five and also apply skip-connections with ELU activations.
Final model is being trained for 100 epochs with Adam optimizer and <math alttext="10^{-3}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS5.SSS0.Px2.p2.1.m1.1a"><msup id="S4.SS5.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.cmml"><mn id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.2" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.2.cmml">10</mn><mrow id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.cmml"><mo id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3a" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.2" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px2.p2.1.m1.1b"><apply id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1">superscript</csymbol><cn id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.2">10</cn><apply id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3"><minus id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3"></minus><cn id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px2.p2.1.m1.1c">10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px2.p2.1.m1.1d">10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> learning rate. As with airfoils experiments, IT<sup class="ltx_sup" id="S4.SS5.SSS0.Px2.p2.2.1">3</sup> significantly improves performance on OOD shapes and provides more accurate predictions compared to the vanilla model, as shown in Figs. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F16" title="Figure 16 ‣ Wings. ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">16</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.F16" title="Figure 16 ‣ Wings. ‣ 4.5 Aerodynamics Prediction ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">16</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Online IT<sup class="ltx_sup" id="S4.SS6.2.1">3</sup>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.2">We test our proposed online variation on several tasks. Naturally, when the distribution remains constant (although shifted from the training distribution) we expect superior results w.r.t. the offline setup, as our model keeps being trained on the new distribution.
A more effective way to test constant adaptation over time is to use a continuously changing distribution. We test IT<sup class="ltx_sup" id="S4.SS6.p1.2.1">3</sup> on an increasing corruption / OOD level. We see in all cases that the online variation of IT<sup class="ltx_sup" id="S4.SS6.p1.2.2">3</sup> performs significantly better than the basic anchored variation.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S4.T1.5.1">Qualitative result for Online IT<sup class="ltx_sup" id="S4.T1.5.1.1"><span class="ltx_text ltx_font_medium" id="S4.T1.5.1.1.1">3</span></sup>.</span> We report evaluation metrics for the road segmentation task <span class="ltx_text ltx_font_bold" id="S4.T1.52.2">(left)</span>, airfoils lift-to-drag prediction <span class="ltx_text ltx_font_bold" id="S4.T1.53.3">(middle)</span>, and car drag prediction <span class="ltx_text ltx_font_bold" id="S4.T1.54.4">(right)</span>.The results suggest Online IT<sup class="ltx_sup" id="S4.T1.55.5">3</sup> enhances the performance compared to the original model. Additionally, online IT<sup class="ltx_sup" id="S4.T1.56.6">3</sup> significantly outperforms offline IT<sup class="ltx_sup" id="S4.T1.57.7">3</sup>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T1.27.19.19" style="width:188.6pt;">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.27.19.19.20.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.27.19.19.20.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.27.19.19.20.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.27.19.19.20.1.2"><span class="ltx_text ltx_font_italic" id="S4.T1.27.19.19.20.1.2.1">Corr</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.27.19.19.20.1.3"><span class="ltx_text ltx_font_italic" id="S4.T1.27.19.19.20.1.3.1">Comp</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.27.19.19.20.1.4"><span class="ltx_text ltx_font_italic" id="S4.T1.27.19.19.20.1.4.1">Quality</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.11.3.3.3.4"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.11.3.3.3.4.1">Not Optimized</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.9.1.1.1.1"><math alttext="55.7" class="ltx_Math" display="inline" id="S4.T1.9.1.1.1.1.m1.1"><semantics id="S4.T1.9.1.1.1.1.m1.1a"><mn id="S4.T1.9.1.1.1.1.m1.1.1" xref="S4.T1.9.1.1.1.1.m1.1.1.cmml">55.7</mn><annotation-xml encoding="MathML-Content" id="S4.T1.9.1.1.1.1.m1.1b"><cn id="S4.T1.9.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.T1.9.1.1.1.1.m1.1.1">55.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.1.1.1.1.m1.1c">55.7</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.1.1.1.1.m1.1d">55.7</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.10.2.2.2.2"><math alttext="44.3" class="ltx_Math" display="inline" id="S4.T1.10.2.2.2.2.m1.1"><semantics id="S4.T1.10.2.2.2.2.m1.1a"><mn id="S4.T1.10.2.2.2.2.m1.1.1" xref="S4.T1.10.2.2.2.2.m1.1.1.cmml">44.3</mn><annotation-xml encoding="MathML-Content" id="S4.T1.10.2.2.2.2.m1.1b"><cn id="S4.T1.10.2.2.2.2.m1.1.1.cmml" type="float" xref="S4.T1.10.2.2.2.2.m1.1.1">44.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.2.2.2.2.m1.1c">44.3</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.2.2.2.2.m1.1d">44.3</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.11.3.3.3.3"><math alttext="39.5" class="ltx_Math" display="inline" id="S4.T1.11.3.3.3.3.m1.1"><semantics id="S4.T1.11.3.3.3.3.m1.1a"><mn id="S4.T1.11.3.3.3.3.m1.1.1" xref="S4.T1.11.3.3.3.3.m1.1.1.cmml">39.5</mn><annotation-xml encoding="MathML-Content" id="S4.T1.11.3.3.3.3.m1.1b"><cn id="S4.T1.11.3.3.3.3.m1.1.1.cmml" type="float" xref="S4.T1.11.3.3.3.3.m1.1.1">39.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.3.3.3.3.m1.1c">39.5</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.3.3.3.3.m1.1d">39.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.7.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.12.4.4.4.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.12.4.4.4.1.1">IT</span><sup class="ltx_sup" id="S4.T1.12.4.4.4.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.12.4.4.4.1.3"> (batch=4)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.13.5.5.5.2"><math alttext="55.7" class="ltx_Math" display="inline" id="S4.T1.13.5.5.5.2.m1.1"><semantics id="S4.T1.13.5.5.5.2.m1.1a"><mn id="S4.T1.13.5.5.5.2.m1.1.1" xref="S4.T1.13.5.5.5.2.m1.1.1.cmml">55.7</mn><annotation-xml encoding="MathML-Content" id="S4.T1.13.5.5.5.2.m1.1b"><cn id="S4.T1.13.5.5.5.2.m1.1.1.cmml" type="float" xref="S4.T1.13.5.5.5.2.m1.1.1">55.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.5.5.5.2.m1.1c">55.7</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.5.5.5.2.m1.1d">55.7</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.14.6.6.6.3"><math alttext="49.1" class="ltx_Math" display="inline" id="S4.T1.14.6.6.6.3.m1.1"><semantics id="S4.T1.14.6.6.6.3.m1.1a"><mn id="S4.T1.14.6.6.6.3.m1.1.1" xref="S4.T1.14.6.6.6.3.m1.1.1.cmml">49.1</mn><annotation-xml encoding="MathML-Content" id="S4.T1.14.6.6.6.3.m1.1b"><cn id="S4.T1.14.6.6.6.3.m1.1.1.cmml" type="float" xref="S4.T1.14.6.6.6.3.m1.1.1">49.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.6.6.6.3.m1.1c">49.1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.6.6.6.3.m1.1d">49.1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.7.7.7.4"><math alttext="46.4" class="ltx_Math" display="inline" id="S4.T1.15.7.7.7.4.m1.1"><semantics id="S4.T1.15.7.7.7.4.m1.1a"><mn id="S4.T1.15.7.7.7.4.m1.1.1" xref="S4.T1.15.7.7.7.4.m1.1.1.cmml">46.4</mn><annotation-xml encoding="MathML-Content" id="S4.T1.15.7.7.7.4.m1.1b"><cn id="S4.T1.15.7.7.7.4.m1.1.1.cmml" type="float" xref="S4.T1.15.7.7.7.4.m1.1.1">46.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.7.7.7.4.m1.1c">46.4</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.7.7.7.4.m1.1d">46.4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.19.11.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.16.8.8.8.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.16.8.8.8.1.1">IT</span><sup class="ltx_sup" id="S4.T1.16.8.8.8.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.16.8.8.8.1.3"> (batch=8)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.17.9.9.9.2"><math alttext="58.1" class="ltx_Math" display="inline" id="S4.T1.17.9.9.9.2.m1.1"><semantics id="S4.T1.17.9.9.9.2.m1.1a"><mn id="S4.T1.17.9.9.9.2.m1.1.1" xref="S4.T1.17.9.9.9.2.m1.1.1.cmml">58.1</mn><annotation-xml encoding="MathML-Content" id="S4.T1.17.9.9.9.2.m1.1b"><cn id="S4.T1.17.9.9.9.2.m1.1.1.cmml" type="float" xref="S4.T1.17.9.9.9.2.m1.1.1">58.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.9.9.9.2.m1.1c">58.1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.9.9.9.2.m1.1d">58.1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.18.10.10.10.3"><math alttext="52.0" class="ltx_Math" display="inline" id="S4.T1.18.10.10.10.3.m1.1"><semantics id="S4.T1.18.10.10.10.3.m1.1a"><mn id="S4.T1.18.10.10.10.3.m1.1.1" xref="S4.T1.18.10.10.10.3.m1.1.1.cmml">52.0</mn><annotation-xml encoding="MathML-Content" id="S4.T1.18.10.10.10.3.m1.1b"><cn id="S4.T1.18.10.10.10.3.m1.1.1.cmml" type="float" xref="S4.T1.18.10.10.10.3.m1.1.1">52.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.10.10.10.3.m1.1c">52.0</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.10.10.10.3.m1.1d">52.0</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.19.11.11.11.4"><math alttext="48.5" class="ltx_Math" display="inline" id="S4.T1.19.11.11.11.4.m1.1"><semantics id="S4.T1.19.11.11.11.4.m1.1a"><mn id="S4.T1.19.11.11.11.4.m1.1.1" xref="S4.T1.19.11.11.11.4.m1.1.1.cmml">48.5</mn><annotation-xml encoding="MathML-Content" id="S4.T1.19.11.11.11.4.m1.1b"><cn id="S4.T1.19.11.11.11.4.m1.1.1.cmml" type="float" xref="S4.T1.19.11.11.11.4.m1.1.1">48.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.11.11.11.4.m1.1c">48.5</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.11.11.11.4.m1.1d">48.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.23.15.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.20.12.12.12.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.20.12.12.12.1.1">IT</span><sup class="ltx_sup" id="S4.T1.20.12.12.12.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.20.12.12.12.1.3"> (batch=16)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.21.13.13.13.2"><math alttext="57.3" class="ltx_Math" display="inline" id="S4.T1.21.13.13.13.2.m1.1"><semantics id="S4.T1.21.13.13.13.2.m1.1a"><mn id="S4.T1.21.13.13.13.2.m1.1.1" xref="S4.T1.21.13.13.13.2.m1.1.1.cmml">57.3</mn><annotation-xml encoding="MathML-Content" id="S4.T1.21.13.13.13.2.m1.1b"><cn id="S4.T1.21.13.13.13.2.m1.1.1.cmml" type="float" xref="S4.T1.21.13.13.13.2.m1.1.1">57.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.13.13.13.2.m1.1c">57.3</annotation><annotation encoding="application/x-llamapun" id="S4.T1.21.13.13.13.2.m1.1d">57.3</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.22.14.14.14.3"><math alttext="52.7" class="ltx_Math" display="inline" id="S4.T1.22.14.14.14.3.m1.1"><semantics id="S4.T1.22.14.14.14.3.m1.1a"><mn id="S4.T1.22.14.14.14.3.m1.1.1" xref="S4.T1.22.14.14.14.3.m1.1.1.cmml">52.7</mn><annotation-xml encoding="MathML-Content" id="S4.T1.22.14.14.14.3.m1.1b"><cn id="S4.T1.22.14.14.14.3.m1.1.1.cmml" type="float" xref="S4.T1.22.14.14.14.3.m1.1.1">52.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.14.14.14.3.m1.1c">52.7</annotation><annotation encoding="application/x-llamapun" id="S4.T1.22.14.14.14.3.m1.1d">52.7</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.23.15.15.15.4"><math alttext="48.7" class="ltx_Math" display="inline" id="S4.T1.23.15.15.15.4.m1.1"><semantics id="S4.T1.23.15.15.15.4.m1.1a"><mn id="S4.T1.23.15.15.15.4.m1.1.1" xref="S4.T1.23.15.15.15.4.m1.1.1.cmml">48.7</mn><annotation-xml encoding="MathML-Content" id="S4.T1.23.15.15.15.4.m1.1b"><cn id="S4.T1.23.15.15.15.4.m1.1.1.cmml" type="float" xref="S4.T1.23.15.15.15.4.m1.1.1">48.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.15.15.15.4.m1.1c">48.7</annotation><annotation encoding="application/x-llamapun" id="S4.T1.23.15.15.15.4.m1.1d">48.7</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.27.19.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.24.16.16.16.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.24.16.16.16.1.1">IT</span><sup class="ltx_sup" id="S4.T1.24.16.16.16.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.24.16.16.16.1.3"> (online)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.25.17.17.17.2"><span class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_smallcaps" id="S4.T1.25.17.17.17.2.1">77.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.26.18.18.18.3"><span class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_smallcaps" id="S4.T1.26.18.18.18.3.1">79.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.27.19.19.19.4"><span class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_smallcaps" id="S4.T1.27.19.19.19.4.1">69.8</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T1.36.28.9" style="width:108.4pt;">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.36.28.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.36.28.9.10.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.36.28.9.10.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.36.28.9.10.1.2"><span class="ltx_text ltx_font_italic" id="S4.T1.36.28.9.10.1.2.1">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.28.20.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.28.20.1.1.2"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.28.20.1.1.2.1">Not Optimized</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.28.20.1.1.1"><math alttext="38.2" class="ltx_Math" display="inline" id="S4.T1.28.20.1.1.1.m1.1"><semantics id="S4.T1.28.20.1.1.1.m1.1a"><mn id="S4.T1.28.20.1.1.1.m1.1.1" xref="S4.T1.28.20.1.1.1.m1.1.1.cmml">38.2</mn><annotation-xml encoding="MathML-Content" id="S4.T1.28.20.1.1.1.m1.1b"><cn id="S4.T1.28.20.1.1.1.m1.1.1.cmml" type="float" xref="S4.T1.28.20.1.1.1.m1.1.1">38.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.28.20.1.1.1.m1.1c">38.2</annotation><annotation encoding="application/x-llamapun" id="S4.T1.28.20.1.1.1.m1.1d">38.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.30.22.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.29.21.2.2.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.29.21.2.2.1.1">IT</span><sup class="ltx_sup" id="S4.T1.29.21.2.2.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.29.21.2.2.1.3"> (batch=1)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.30.22.3.3.2"><math alttext="37.6" class="ltx_Math" display="inline" id="S4.T1.30.22.3.3.2.m1.1"><semantics id="S4.T1.30.22.3.3.2.m1.1a"><mn id="S4.T1.30.22.3.3.2.m1.1.1" xref="S4.T1.30.22.3.3.2.m1.1.1.cmml">37.6</mn><annotation-xml encoding="MathML-Content" id="S4.T1.30.22.3.3.2.m1.1b"><cn id="S4.T1.30.22.3.3.2.m1.1.1.cmml" type="float" xref="S4.T1.30.22.3.3.2.m1.1.1">37.6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.30.22.3.3.2.m1.1c">37.6</annotation><annotation encoding="application/x-llamapun" id="S4.T1.30.22.3.3.2.m1.1d">37.6</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.32.24.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.31.23.4.4.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.31.23.4.4.1.1">IT</span><sup class="ltx_sup" id="S4.T1.31.23.4.4.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.31.23.4.4.1.3"> (batch=4)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.32.24.5.5.2"><math alttext="37.5" class="ltx_Math" display="inline" id="S4.T1.32.24.5.5.2.m1.1"><semantics id="S4.T1.32.24.5.5.2.m1.1a"><mn id="S4.T1.32.24.5.5.2.m1.1.1" xref="S4.T1.32.24.5.5.2.m1.1.1.cmml">37.5</mn><annotation-xml encoding="MathML-Content" id="S4.T1.32.24.5.5.2.m1.1b"><cn id="S4.T1.32.24.5.5.2.m1.1.1.cmml" type="float" xref="S4.T1.32.24.5.5.2.m1.1.1">37.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.32.24.5.5.2.m1.1c">37.5</annotation><annotation encoding="application/x-llamapun" id="S4.T1.32.24.5.5.2.m1.1d">37.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.34.26.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.33.25.6.6.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.33.25.6.6.1.1">IT</span><sup class="ltx_sup" id="S4.T1.33.25.6.6.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.33.25.6.6.1.3"> (batch=16)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.34.26.7.7.2"><math alttext="37.4" class="ltx_Math" display="inline" id="S4.T1.34.26.7.7.2.m1.1"><semantics id="S4.T1.34.26.7.7.2.m1.1a"><mn id="S4.T1.34.26.7.7.2.m1.1.1" xref="S4.T1.34.26.7.7.2.m1.1.1.cmml">37.4</mn><annotation-xml encoding="MathML-Content" id="S4.T1.34.26.7.7.2.m1.1b"><cn id="S4.T1.34.26.7.7.2.m1.1.1.cmml" type="float" xref="S4.T1.34.26.7.7.2.m1.1.1">37.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.34.26.7.7.2.m1.1c">37.4</annotation><annotation encoding="application/x-llamapun" id="S4.T1.34.26.7.7.2.m1.1d">37.4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.36.28.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.35.27.8.8.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.35.27.8.8.1.1">IT</span><sup class="ltx_sup" id="S4.T1.35.27.8.8.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.35.27.8.8.1.3"> (online)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.36.28.9.9.2"><span class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_smallcaps" id="S4.T1.36.28.9.9.2.1">34.1</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T1.45.37.9" style="width:108.4pt;">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.45.37.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.45.37.9.10.1.1"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.45.37.9.10.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.45.37.9.10.1.2"><span class="ltx_text ltx_font_italic" id="S4.T1.45.37.9.10.1.2.1">MAE</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.37.29.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.37.29.1.1.2"><span class="ltx_text ltx_font_smallcaps" id="S4.T1.37.29.1.1.2.1">Not Optimized</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.37.29.1.1.1"><math alttext="0.501" class="ltx_Math" display="inline" id="S4.T1.37.29.1.1.1.m1.1"><semantics id="S4.T1.37.29.1.1.1.m1.1a"><mn id="S4.T1.37.29.1.1.1.m1.1.1" xref="S4.T1.37.29.1.1.1.m1.1.1.cmml">0.501</mn><annotation-xml encoding="MathML-Content" id="S4.T1.37.29.1.1.1.m1.1b"><cn id="S4.T1.37.29.1.1.1.m1.1.1.cmml" type="float" xref="S4.T1.37.29.1.1.1.m1.1.1">0.501</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.37.29.1.1.1.m1.1c">0.501</annotation><annotation encoding="application/x-llamapun" id="S4.T1.37.29.1.1.1.m1.1d">0.501</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.39.31.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.38.30.2.2.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.38.30.2.2.1.1">IT</span><sup class="ltx_sup" id="S4.T1.38.30.2.2.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.38.30.2.2.1.3"> (batch=1)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.39.31.3.3.2"><math alttext="0.446" class="ltx_Math" display="inline" id="S4.T1.39.31.3.3.2.m1.1"><semantics id="S4.T1.39.31.3.3.2.m1.1a"><mn id="S4.T1.39.31.3.3.2.m1.1.1" xref="S4.T1.39.31.3.3.2.m1.1.1.cmml">0.446</mn><annotation-xml encoding="MathML-Content" id="S4.T1.39.31.3.3.2.m1.1b"><cn id="S4.T1.39.31.3.3.2.m1.1.1.cmml" type="float" xref="S4.T1.39.31.3.3.2.m1.1.1">0.446</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.39.31.3.3.2.m1.1c">0.446</annotation><annotation encoding="application/x-llamapun" id="S4.T1.39.31.3.3.2.m1.1d">0.446</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.41.33.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.40.32.4.4.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.40.32.4.4.1.1">IT</span><sup class="ltx_sup" id="S4.T1.40.32.4.4.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.40.32.4.4.1.3"> (batch=2)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.41.33.5.5.2"><math alttext="0.424" class="ltx_Math" display="inline" id="S4.T1.41.33.5.5.2.m1.1"><semantics id="S4.T1.41.33.5.5.2.m1.1a"><mn id="S4.T1.41.33.5.5.2.m1.1.1" xref="S4.T1.41.33.5.5.2.m1.1.1.cmml">0.424</mn><annotation-xml encoding="MathML-Content" id="S4.T1.41.33.5.5.2.m1.1b"><cn id="S4.T1.41.33.5.5.2.m1.1.1.cmml" type="float" xref="S4.T1.41.33.5.5.2.m1.1.1">0.424</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.41.33.5.5.2.m1.1c">0.424</annotation><annotation encoding="application/x-llamapun" id="S4.T1.41.33.5.5.2.m1.1d">0.424</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.43.35.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.42.34.6.6.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.42.34.6.6.1.1">IT</span><sup class="ltx_sup" id="S4.T1.42.34.6.6.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.42.34.6.6.1.3"> (batch=4)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.43.35.7.7.2"><math alttext="0.412" class="ltx_Math" display="inline" id="S4.T1.43.35.7.7.2.m1.1"><semantics id="S4.T1.43.35.7.7.2.m1.1a"><mn id="S4.T1.43.35.7.7.2.m1.1.1" xref="S4.T1.43.35.7.7.2.m1.1.1.cmml">0.412</mn><annotation-xml encoding="MathML-Content" id="S4.T1.43.35.7.7.2.m1.1b"><cn id="S4.T1.43.35.7.7.2.m1.1.1.cmml" type="float" xref="S4.T1.43.35.7.7.2.m1.1.1">0.412</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.43.35.7.7.2.m1.1c">0.412</annotation><annotation encoding="application/x-llamapun" id="S4.T1.43.35.7.7.2.m1.1d">0.412</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.45.37.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.44.36.8.8.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T1.44.36.8.8.1.1">IT</span><sup class="ltx_sup" id="S4.T1.44.36.8.8.1.2">3</sup><span class="ltx_text ltx_font_smallcaps" id="S4.T1.44.36.8.8.1.3"> (online)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.45.37.9.9.2"><span class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_smallcaps" id="S4.T1.45.37.9.9.2.1">0.385</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS6.p2.2.1">Road segmentation</span>: Building upon our previous road segmentation experiments, we further evaluate the effectiveness of online IT<sup class="ltx_sup" id="S4.SS6.p2.2.2">3</sup>. In the online IT<sup class="ltx_sup" id="S4.SS6.p2.2.3">3</sup> setup, OOD samples are ranked based on their mean squared error (MSE) loss when passed through the vanilla network. We begin by selecting the samples with low MSE loss, as these are closer to the training distribution given the network’s strong performance on them. Gradually, we introduce samples with progressively higher MSE loss, smoothly shifting between distributions and thereby allowing the model to adapt effectively to a range of OOD samples. As in previous experiment, we use DRU-Net trained on the RoadTracer dataset as vanilla model and 890 images are sampled from Massachusetts dataset as OOD images.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p3">
<p class="ltx_p" id="S4.SS6.p3.4">Firstly, the vanilla network is tested on the Massachusetts dataset without any additional fine-tuning. We then apply online IT<sup class="ltx_sup" id="S4.SS6.p3.4.1">3</sup> during inference to adapt the model to the OOD distribution as new data is presented. We evaluate the segmentation performance using the <span class="ltx_text ltx_font_italic" id="S4.SS6.p3.4.2">Correctness</span>, <span class="ltx_text ltx_font_italic" id="S4.SS6.p3.4.3">Completeness</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS6.p3.4.4">Quality</span> metrics, as described previously. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.T1" title="Table 1 ‣ 4.6 Online IT3 ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">1</span></a> (left) summarizes the results. The application of IT<sup class="ltx_sup" id="S4.SS6.p3.4.5">3</sup> improved the performance over the initial network and the online IT<sup class="ltx_sup" id="S4.SS6.p3.4.6">3</sup> method significantly outperforms the offline IT<sup class="ltx_sup" id="S4.SS6.p3.4.7">3</sup>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p4">
<p class="ltx_p" id="S4.SS6.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS6.p4.1.1">Aerodynamics</span>: Similarly, we conducted online experiments for airfoils lift-to-drag prediction and for car drag prediction.
We set the data stream such that OOD shapes appear with increasing aerodynamic properties, modeling a continuous domain shift in the data. As with the segmentation results, the online version significantly outperforms both the offline version and the original network, as shown in Tabs.<a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#S4.T1" title="Table 1 ‣ 4.6 Online IT3 ‣ 4 Experiments ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">1</span></a> (middle and right).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Limitations:</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.2">While global, IT<sup class="ltx_sup" id="S5.p1.2.1">3</sup> lacks domain expertise. Within the domains we experimented with, we are aware only of computer-vision algorithms that adhere to the restrictive problem setup. However, it is likely possible to implement domain specific methods based on self-supervision that can outperform IT<sup class="ltx_sup" id="S5.p1.2.2">3</sup>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">In addition, we found that for some domains it is hard to apply IT<sup class="ltx_sup" id="S5.p2.1.1">3</sup> on single instances without also using additions that require domain expertise or access to training data. This is most common for domains where the information within a single input is limited. The reason for that is that in contrast to self-supervised auxiliary tasks, our TTT objective is based on predictions without independent information on the input data.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We have proposed an approach to test-time-training that relies on enforcing idempotence as new samples are being considered to effectively handle domain shifts. The method is generic and we have demonstrated that it is effective in a wide range of domains without requiring domain-specific knowledge, which sets it apart from other state-of-the-art methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">In future work we plan to pursue the challenge of realistic online continual learning, where there is no pre-training at all and the data arrives in streams, sometimes with labels and sometimes not. We believe IT<sup class="ltx_sup" id="S6.p2.1.1">3</sup> can be adapted to such a setup across many different streaming modalities, which would make it extremely useful in real-world scenarios.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We would like to thank Yossi Gandelsman and Yoad Tewel for their valuable advice and discussions.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ackley et al. (1985)</span>
<span class="ltx_bibblock">
David H Ackley, Geoffrey E Hinton, and Terrence J Sejnowski.

</span>
<span class="ltx_bibblock">A learning algorithm for boltzmann machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Cognitive science</em>, 9(1):147–169, 1985.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bastani et al. (2018)</span>
<span class="ltx_bibblock">
F. Bastani, S. He, M. Alizadeh, H. Balakrishnan, S. Madden, S. Chawla,
S. Abbar, and D. Dewitt.

</span>
<span class="ltx_bibblock">Roadtracer: Automatic Extraction of Road Networks from Aerial
Images.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Conference on Computer Vision and Pattern Recognition</em>,
2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bay et al. (2000)</span>
<span class="ltx_bibblock">
Stephen D Bay, Dennis Kibler, Michael J Pazzani, and Padhraic Smyth.

</span>
<span class="ltx_bibblock">The uci kdd archive of large data sets for data mining research and
experimentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ACM SIGKDD explorations newsletter</em>, 2(2):81–85, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berg et al. (2021)</span>
<span class="ltx_bibblock">
A. Berg, M. Oskarsson, and M. O’Connor.

</span>
<span class="ltx_bibblock">Deep Ordinal Regression with Label Diversity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">International Conference on Pattern Recognition</em>, pp. 2740–2747, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou &amp; Vapnik (1992)</span>
<span class="ltx_bibblock">
Léon Bottou and Vladimir Vapnik.

</span>
<span class="ltx_bibblock">Local learning algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Neural computation</em>, 4(6):888–900, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2020)</span>
<span class="ltx_bibblock">
W. Cao, V. Mirjalili, and S. Raschka.

</span>
<span class="ltx_bibblock">Rank Consistent Ordinal Regression for Neural Networks with
Application to Age Estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Pattern Recognition</em>, 140:325–331, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al. (2015)</span>
<span class="ltx_bibblock">
A. Chang, T. Funkhouser, L. G., P. Hanrahan, Q. Huang, Z. Li, S. Savarese,
M. Savva, S. Song, H. Su, J. Xiao, L. Yi, and F. Yu.

</span>
<span class="ltx_bibblock">Shapenet: An Information-Rich 3D Model Repository.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv Preprint</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et al. (2015)</span>
<span class="ltx_bibblock">
D.-A. Clevert, T. Unterthiner, and S. Hochreiter.

</span>
<span class="ltx_bibblock">Fast and Accurate Deep Network Learning by Exponential Linear Units
(ELUs).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv Preprint</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert et al. (2006)</span>
<span class="ltx_bibblock">
Ronan Collobert, Fabian Sinz, Jason Weston, Léon Bottou, and Thorsten
Joachims.

</span>
<span class="ltx_bibblock">Large scale transductive svms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Journal of Machine Learning Research</em>, 7(8), 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drela (1989)</span>
<span class="ltx_bibblock">
M. Drela.

</span>
<span class="ltx_bibblock">XFOIL: An Analysis and Design System for Low Reynolds Number
Airfoils.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Conference on Low Reynolds Number Aerodynamics</em>, pp. 1–12, 1989.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Durasov et al. (2021a)</span>
<span class="ltx_bibblock">
N. Durasov, T. Bagautdinov, P. Baque, and P. Fua.

</span>
<span class="ltx_bibblock">Masksembles for Uncertainty Estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Conference on Computer Vision and Pattern Recognition</em>,
2021a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Durasov et al. (2024a)</span>
<span class="ltx_bibblock">
N. Durasov, D. Oner, Hi. Le, J. Donier, and P. Fua.

</span>
<span class="ltx_bibblock">Enabling Uncertainty Estimation in Iterative Neural Networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International Conference on Machine Learning</em>,
2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Durasov et al. (2021b)</span>
<span class="ltx_bibblock">
Nikita Durasov, Artem Lukoyanov, Jonathan Donier, and Pascal Fua.

</span>
<span class="ltx_bibblock">Debosh: Deep bayesian shape optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2109.13337</em>, 2021b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Durasov et al. (2022)</span>
<span class="ltx_bibblock">
Nikita Durasov, Nik Dorndorf, and Pascal Fua.

</span>
<span class="ltx_bibblock">Partal: Efficient partial active learning in multi-task visual
settings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2211.11546</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Durasov et al. (2024b)</span>
<span class="ltx_bibblock">
Nikita Durasov, Nik Dorndorf, Hieu Le, and Pascal Fua.

</span>
<span class="ltx_bibblock">ZigZag: Universal Sampling-free Uncertainty Estimation Through
Two-Step Inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Transactions on Machine Learning Research</em>, 2024b.

</span>
<span class="ltx_bibblock">In press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gal &amp; Ghahramani (2016)</span>
<span class="ltx_bibblock">
Y. Gal and Z. Ghahramani.

</span>
<span class="ltx_bibblock">Dropout as a Bayesian Approximation: Representing Model Uncertainty
in Deep Learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Machine Learning</em>, pp. 1050–1059, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gammerman et al. (1998)</span>
<span class="ltx_bibblock">
A Gammerman, V Vovk, and V Vapnik.

</span>
<span class="ltx_bibblock">Learning by transduction, vol uai’98, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gandelsman et al. (2019)</span>
<span class="ltx_bibblock">
Yosef Gandelsman, Assaf Shocher, and Michal Irani.

</span>
<span class="ltx_bibblock">” double-dip”: unsupervised image decomposition via coupled
deep-image-priors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  11026–11035, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gandelsman et al. (2022)</span>
<span class="ltx_bibblock">
Yossi Gandelsman, Yu Sun, Xinlei Chen, and Alexei Efros.

</span>
<span class="ltx_bibblock">Test-time training with masked autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>,
35:29374–29385, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image Recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Conference on Computer Vision and Pattern Recognition</em>, pp. 770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2022)</span>
<span class="ltx_bibblock">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross
Girshick.

</span>
<span class="ltx_bibblock">Masked autoencoders are scalable vision learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  16000–16009, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks &amp; Dietterich (2019)</span>
<span class="ltx_bibblock">
Dan Hendrycks and Thomas Dietterich.

</span>
<span class="ltx_bibblock">Benchmarking neural network robustness to common corruptions and
perturbations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=HJz6tiCqYm" title="">https://openreview.net/forum?id=HJz6tiCqYm</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et al. (2021)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Steven Basart, Norman Mu, Saurav Kadavath, Frank Wang, Evan
Dorundo, Rahul Desai, Tyler Zhu, Samyak Parajuli, Mike Guo, et al.

</span>
<span class="ltx_bibblock">The many faces of robustness: A critical analysis of
out-of-distribution generalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the IEEE/CVF international conference on
computer vision</em>, pp.  8340–8349, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs &amp; Sherman (1937)</span>
<span class="ltx_bibblock">
E. Jacobs and A. Sherman.

</span>
<span class="ltx_bibblock">Airfoil section characteristics as affected by variations of the
reynolds number.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Report-National Advisory Committee for Aeronautics</em>,
227:577–611, 1937.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jasak et al. (2007)</span>
<span class="ltx_bibblock">
Hrvoje Jasak, Aleksandar Jemcov, Zeljko Tukovic, et al.

</span>
<span class="ltx_bibblock">OpenFOAM: A C++ Library for Complex Physics Simulations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International workshop on coupled methods in numerical
dynamics</em>, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. (2017)</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume
Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka
Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2014)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Vinod Nair, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">The CIFAR-10 Dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">online: http://www. cs. toronto. edu/kriz/cifar. html</em>,
55(5), 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lakshminarayanan et al. (2017)</span>
<span class="ltx_bibblock">
B. Lakshminarayanan, A. Pritzel, and C. Blundell.

</span>
<span class="ltx_bibblock">Simple and Scalable Predictive Uncertainty Estimation Using Deep
Ensembles.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Yuejiang Liu, Parth Kothari, Bastien Van Delft, Baptiste Bellot-Gurlet, Taylor
Mordan, and Alexandre Alahi.

</span>
<span class="ltx_bibblock">Ttt++: When does self-supervised test-time training fail or thrive?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>,
34:21808–21820, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih (2013)</span>
<span class="ltx_bibblock">
V. Mnih.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Machine Learning for Aerial Image Labeling</em>.

</span>
<span class="ltx_bibblock">PhD thesis, University of Toronto, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Monti et al. (2017)</span>
<span class="ltx_bibblock">
F. Monti, D. Boscaini, J. Masci, E. Rodolà, J. Svoboda, and M. M.
Bronstein.

</span>
<span class="ltx_bibblock">Geometric Deep Learning on Graphs and Manifolds Using Mixture Model
CNNs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Conference on Computer Vision and Pattern Recognition</em>, pp. 5425–5434, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Recht et al. (2018)</span>
<span class="ltx_bibblock">
Benjamin Recht, Rebecca Roelofs, Ludwig Schmidt, and Vaishaal Shankar.

</span>
<span class="ltx_bibblock">Do cifar-10 classifiers generalize to cifar-10?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:1806.00451</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Remelli et al. (2020)</span>
<span class="ltx_bibblock">
E. Remelli, A. Lukoianov, S. Richter, B. Guillard, T. Bagautdinov, P. Baque,
and P. Fua.

</span>
<span class="ltx_bibblock">Meshsdf: Differentiable Iso-Surface Extraction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shaham et al. (2019)</span>
<span class="ltx_bibblock">
Tamar Rott Shaham, Tali Dekel, and Tomer Michaeli.

</span>
<span class="ltx_bibblock">Singan: Learning a generative model from a single natural image.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the IEEE/CVF international conference on
computer vision</em>, pp.  4570–4580, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shocher et al. (2018)</span>
<span class="ltx_bibblock">
Assaf Shocher, Nadav Cohen, and Michal Irani.

</span>
<span class="ltx_bibblock">“zero-shot” super-resolution using deep internal learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  3118–3126, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shocher et al. (2019)</span>
<span class="ltx_bibblock">
Assaf Shocher, Shai Bagon, Phillip Isola, and Michal Irani.

</span>
<span class="ltx_bibblock">Ingan: Capturing and retargeting the” dna” of a natural image.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the IEEE/CVF international conference on
computer vision</em>, pp.  4492–4501, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shocher et al. (2024)</span>
<span class="ltx_bibblock">
Assaf Shocher, Amil V Dravid, Yossi Gandelsman, Inbar Mosseri, Michael
Rubinstein, and Alexei A Efros.

</span>
<span class="ltx_bibblock">Idempotent generative network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=XIaS66XkNA" title="">https://openreview.net/forum?id=XIaS66XkNA</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2020)</span>
<span class="ltx_bibblock">
Yu Sun, Xiaolong Wang, Zhuang Liu, John Miller, Alexei Efros, and Moritz Hardt.

</span>
<span class="ltx_bibblock">Test-time training with self-supervision for generalization under
distribution shifts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">International conference on machine learning</em>, pp. 9229–9248. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Dequan Wang, Evan Shelhamer, Shaoteng Liu, Bruno Olshausen, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Tent: Fully test-time adaptation by entropy minimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=uXl3bZLkr3c" title="">https://openreview.net/forum?id=uXl3bZLkr3c</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
W. Wang, K. Yu, J. Hugonot, P. Fua, and M. Salzmann.

</span>
<span class="ltx_bibblock">Recurrent U-Net for Resource-Constrained Segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">International Conference on Computer Vision</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2020)</span>
<span class="ltx_bibblock">
Y. Wen, D. Tran, and J. Ba.

</span>
<span class="ltx_bibblock">Batchensemble: An Alternative Approach to Efficient Ensemble and
Lifelong Learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">International Conference on Learning Representations</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wiedemann et al. (1998)</span>
<span class="ltx_bibblock">
C. Wiedemann, C. Heipke, H. Mayer, and O. Jamet.

</span>
<span class="ltx_bibblock">Empirical Evaluation of Automatically Extracted Road Axes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Empirical Evaluation Techniques in Computer Vision</em>, pp. 172–187, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2022)</span>
<span class="ltx_bibblock">
Huaxiu Yao, Caroline Choi, Bochuan Cao, Yoonho Lee, Pang Wei Koh, and Chelsea
Finn.

</span>
<span class="ltx_bibblock">Wild-time: A benchmark of in-the-wild distribution shift over time.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Thirty-sixth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2018)</span>
<span class="ltx_bibblock">
F. Yu, D. Wang, E. Shelhamer, and T. Darrell.

</span>
<span class="ltx_bibblock">Deep Layer Aggregation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Conference on Computer Vision and Pattern Recognition</em>, pp. 2403–2412, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2017)</span>
<span class="ltx_bibblock">
Zhifei Zhang, Yang Song, , and Hairong Qi.

</span>
<span class="ltx_bibblock">Age Progression/regression by Conditional Adversarial Autoencoder.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Conference on Computer Vision and Pattern Recognition</em>,
2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Additional Road Segmentation Experiments</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In order to further evaluate our method, we perform an additional OOD experiments using the test set of the RoadTracer dataset itself. We select cities from the RoadTracer test dataset that are not part of the RoadTracer training set and treat them as OOD samples. We divide the selected set into four groups based on the Mean Squared Error (MSE) of the segmentation outputs, effectively creating different levels of distributional shift within the test set. We then further train the network on these OOD subsets. In line with our other experiments, we demonstrate that applying IT<sup class="ltx_sup" id="A1.SS1.p1.1.1">3</sup> significantly improves segmentation performance on these OOD samples. The quantitative results of this experiment can be seen in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#A1.F19" title="Figure 19 ‣ A.1 Additional Road Segmentation Experiments ‣ Appendix A Appendix ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">19</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.04201v1#A1.F19" title="Figure 19 ‣ A.1 Additional Road Segmentation Experiments ‣ Appendix A Appendix ‣ IT3: Idempotent Test-Time Training"><span class="ltx_text ltx_ref_tag">19</span></a>.</p>
</div>
<figure class="ltx_figure" id="A1.F19">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F19.4" style="width:166.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="380" id="A1.F19.1.g1" src="x14.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span><span class="ltx_text ltx_font_bold" id="A1.F19.4.6.1">Road Samples.</span>
RoadTracer train dataset <span class="ltx_text ltx_font_bold" id="A1.F19.4.7.2">(left)</span> includes urban areas of cities in US. From RoadTracer test dataset, we selected images of cities that are not included in train dataset as OOD samples <span class="ltx_text ltx_font_bold" id="A1.F19.4.8.3">(right)</span>.
</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="338" id="A1.F19.2.g2" src="x15.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span><span class="ltx_text ltx_font_bold" id="A1.F19.4.11.1">Roads mean quality score on OOD images.</span> The plot compares IT<sup class="ltx_sup" id="A1.F19.4.12.2">3</sup> to the vanilla model, showing better performance retention as data shifts from the training distribution.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.F19.7" style="width:222.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="507" id="A1.F19.5.g1" src="x16.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span><span class="ltx_text ltx_font_bold" id="A1.F19.7.9.1">Roads results on OOD images.</span> <span class="ltx_text ltx_font_bold" id="A1.F19.7.10.2" style="color:#96CAC1;">Not optimized</span> corresponds to a single model without TTT applied. IT<sup class="ltx_sup" id="A1.F19.7.11.3">3</sup> with [<span class="ltx_text ltx_font_bold" id="A1.F19.7.12.4" style="color:#FFDAB9;">batch=4</span>, <span class="ltx_text ltx_font_bold" id="A1.F19.7.13.5" style="color:#C1BED6;">batch=8</span>, and <span class="ltx_text ltx_font_bold" id="A1.F19.7.14.6" style="color:#EA8E83;">batch=16</span>] represents our method at different batch sizes. As the data shifts further from the training distribution, our method degrades less, with larger batches preserving performance more effectively.</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A1.F20">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="188" id="A1.F20.g1" src="x17.png" width="753"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="188" id="A1.F20.g2" src="x18.png" width="753"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="188" id="A1.F20.g3" src="x19.png" width="753"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="188" id="A1.F20.g4" src="x20.png" width="753"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="188" id="A1.F20.g5" src="x21.png" width="753"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span><span class="ltx_text ltx_font_bold" id="A1.F20.5.1">Additional qualitative results of IT<sup class="ltx_sup" id="A1.F20.5.1.1"><span class="ltx_text ltx_font_medium" id="A1.F20.5.1.1.1">3</span></sup> on Road Segmentation.</span> From left to right: (1) Original aerial image, (2) Not optimized output, (3) IT<sup class="ltx_sup" id="A1.F20.12.2">3</sup> output at the 5th iteration, (4) IT<sup class="ltx_sup" id="A1.F20.13.3">3</sup> output at the 15th iteration, and (5) Ground truth label. The segmentation quality improves significantly with IT<sup class="ltx_sup" id="A1.F20.14.4">3</sup> iterations, as observed in the progressively refined outputs at the 5th and 15th iterations.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"></p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Oct  5 15:23:24 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
