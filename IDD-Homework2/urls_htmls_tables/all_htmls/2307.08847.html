<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2307.08847] Privacy-preserving patient clustering for personalized federated learning</title><meta property="og:description" content="Federated Learning (FL) is a machine learning framework that enables multiple organizations to train a model without sharing their data with a central server. However, it experiences significant performance degradation…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Privacy-preserving patient clustering for personalized federated learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Privacy-preserving patient clustering for personalized federated learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2307.08847">

<!--Generated on Wed Feb 28 17:37:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\jmlrvolume</span><span id="p1.2" class="ltx_ERROR undefined">\jmlryear</span>
<p id="p1.3" class="ltx_p">2023
<span id="p1.3.1" class="ltx_ERROR undefined">\jmlrworkshop</span>To appear at Machine Learning for Healthcare 2023


</p>
</div>
<h1 class="ltx_title ltx_title_document">Privacy-preserving patient clustering for personalized federated learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id1.1.id1" class="ltx_ERROR undefined">\Name</span>Ahmed Elhussein
<span id="id2.2.id2" class="ltx_ERROR undefined">\Email</span>ae2722@cumc.columbia.edu
<br class="ltx_break"><span id="id3.3.id3" class="ltx_ERROR undefined">\addr</span>Department of Biomedical Informatics
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Columbia University
<br class="ltx_break">New York City
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> NY
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> U.S.A
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id4.1.id1" class="ltx_ERROR undefined">\Name</span>Gamze Gürsoy
<span id="id5.2.id2" class="ltx_ERROR undefined">\Email</span>gamze.gursoy@columbia.edu
<br class="ltx_break"><span id="id6.3.id3" class="ltx_ERROR undefined">\addr</span>Department of Biomedical Informatics
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Columbia University
<br class="ltx_break">New York Genome Center
<br class="ltx_break">New York City
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> NY
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> U.S.A
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">Federated Learning (FL) is a machine learning framework that enables multiple organizations to train a model without sharing their data with a central server. However, it experiences significant performance degradation if the data is non-identically independently distributed (non-IID). This is a problem in medical settings, where variations in the patient population contribute significantly to distribution differences across hospitals. Personalized FL addresses this issue by accounting for site-specific distribution differences. Clustered FL, a Personalized FL variant, was used to address this problem by clustering patients into groups across hospitals and training separate models on each group. However, privacy concerns remained as a challenge as the clustering process requires exchange of patient-level information. This was previously solved by forming clusters using aggregated data, which led to inaccurate groups and performance degradation. In this study, we propose Privacy-preserving Community-Based Federated machine Learning (PCBFL), a novel Clustered FL framework that can cluster patients using patient-level data while protecting privacy. PCBFL uses Secure Multiparty Computation, a cryptographic technique, to securely calculate patient-level similarity scores across hospitals. We then evaluate PCBFL by training a federated mortality prediction model using 20 sites from the eICU dataset. We compare the performance gain from PCBFL against traditional and existing Clustered FL frameworks. Our results show that PCBFL successfully forms clinically meaningful cohorts of low, medium, and high-risk patients. PCBFL outperforms traditional and existing Clustered FL frameworks with an average AUC improvement of 4.3% and AUPRC improvement of 7.8%.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The use of deep learning on Electronic Health Records (EHR) has been widely and successfully implemented for a range of goals such as for disease risk prediction, diagnostic support, and Natural Language Processing (<cite class="ltx_cite ltx_citemacro_cite">Esteva et al. (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>); Gulshan et al. (<a href="#bib.bib12" title="" class="ltx_ref">2016</a>); Miotto et al. (<a href="#bib.bib24" title="" class="ltx_ref">2016</a>); Choi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite>). However, to leverage the predictive ability of deep learning models on the inherently high dimensionality of EHR data, a large number of samples are needed. Undersampled or overspecified models are more likely to overfit on training datasets and generalize poorly when applied to new datasets (<cite class="ltx_cite ltx_citemacro_cite">Hosseini et al. (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>); Miotto et al. (<a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>). This is especially important in rare disease settings where a single institution cannot have enough power to develop predictive models. One solution to enable more sophisticated and accurate models is to increase available training data. While some attempts to build large and diverse cohorts have been successful (<span id="S1.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> All Of Us and UK Biobank), they are largely volunteer based and limited in the number and diversity of patients enrolled, with the majority of patients coming from healthy populations. Another alternative is institutional data-sharing but the regulatory framework (<span id="S1.p1.1.2" class="ltx_text ltx_font_italic">e.g.,</span> HIPAA) and the ethical need to respect patient privacy limit widespread data sharing across institutions. One solution to support collaborative learning across sites while minimizing privacy concerns is Federated learning (FL) (<cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib23" title="" class="ltx_ref">2017</a>); Kaissis et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>). FL is a distributed machine learning approach that enables multiple sites to collaboratively train a model while keeping data local. The process involves sites sharing locally trained model parameters with a central server, which then aggregates these parameters to create a global model. This process is repeated for a number of training rounds until a final global model is obtained. The parameters are aggregated via a commonly used algorithm, Federated Averaging (FedAvg), which uses sample-size weighted averaging to combine model parameters. FL enables model training on larger and more diverse patient groups across many sites while keeping datasets local. Furthermore, it has the benefit of allowing sites with limited training data (<span id="S1.p1.1.3" class="ltx_text ltx_font_italic">e.g.,</span> rural hospitals) to be involved in model building. That is, FL has the potential to improve model performance, generalizability, and fairness (<cite class="ltx_cite ltx_citemacro_cite">Rieke et al. (<a href="#bib.bib29" title="" class="ltx_ref">2020</a>)</cite>). As such, FL has become increasingly popular in healthcare, and has been implemented on a range of tasks including disease risk prediction, diagnosis, and image recognition (<cite class="ltx_cite ltx_citemacro_cite">Rieke et al. (<a href="#bib.bib29" title="" class="ltx_ref">2020</a>); Dayan et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>); Pati et al. (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>).</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">FL still has some limitations. FedAvg underperforms when data is non-identically independently distributed (non-IID) across sites. This is a particular concern for EHRs, where a range of factors can lead to distribution shifts including patient composition, institutional treatment guidelines, and institutional data capture processes (<cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>). Patient composition, <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">i.e.,</span> differences in demographics and clinical presentation is one of the most significant sources of distribution shift (<cite class="ltx_cite ltx_citemacro_cite">Prayitno et al. (<a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>). Personalized FL, which aims to account for distribution shifts across datasets, is a potential solution for training models on non-IID data (<cite class="ltx_cite ltx_citemacro_cite">Fallah et al. (<a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>). Clustered Federated Learning is a variant of personalized FL that has demonstrated success in handling non-IID data when datasets naturally partition into clusters (<span id="S1.p2.1.2" class="ltx_text ltx_font_italic">e.g</span>., clinical groups) (<cite class="ltx_cite ltx_citemacro_cite">Ghosh et al. (<a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>). In this scenario, training separate models for each cluster has been shown to improve performance on downstream tasks. The challenge lies in identifying the clusters and partitioning the datasets accordingly. Recent patient clustering preprocessing using individual patient embeddings demonstrate improvements in downstream task performance in the centralized setting (<cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2020</a>); Zeng et al. (<a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>). This suggests clustering can be a promising avenue for healthcare tasks in a federated setting as well.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Addressing the absence of a privacy-preserving federated approach for clustering using individual patient embeddings is a critical step for personalized FL. Frameworks such as Differential Privacy (DP) have been introduced to address this issue. DP works by adding noise to summary-level data (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">e.g.,</span> model parameters) prior to sharing information with a central server. But in the clinical context, the amount of noise needed to achieve privacy can compromise model performance (<cite class="ltx_cite ltx_citemacro_cite">Ficek et al. (<a href="#bib.bib10" title="" class="ltx_ref">2021</a>); Dwork and Roth (<a href="#bib.bib6" title="" class="ltx_ref">2014</a>)</cite>). One can use cryptographic techniques that provide mathematical privacy guarantees without adding noise and can work with both summary and individual level data. One such technique that is appropriate in a multi-site setting is Secure MultiParty Computation (SMPC). SMPC enables multiple parties to jointly compute a function over their inputs while keeping those inputs secret from each other by using a secret-sharing scheme (<cite class="ltx_cite ltx_citemacro_cite">Evans et al. (<a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>).</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this study, we introduce Privacy-preserving Community-Based Federated machine Learning (PCBFL), a privacy-preserving framework that incorporates a clustering preprocessing step into FL (Clustered FL). Using SMPC, PCBFL securely calculates patient-level embedding similarities across all sites while preserving privacy. We assume an honest-but-curious adversary scenario, in which the computing parties cannot learn the input from the secrets and will not intentionally collude with each other to learn the input (<cite class="ltx_cite ltx_citemacro_cite">Evans et al. (<a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>). By using individual patient embedding similarity scores to cluster patients into groups, we aim to improve downstream task performance. We evaluate PCBFL algorithm against two main federated comparators on a downstream mortality prediction task: Community-Based Federated machine Learning (CBFL) and FedAvg. CBFL, a state-of-the-art method, also employs a clustering preprocessing step, however, unlike PBCFL, CBFL uses aggregate hospital embeddings for patient clustering. FedAvg is the standard algorithm with no preprocessing for non-IID data. Additionally, we assess the performance of non-federated algorithms that conduct only model training: single site training and centralized training. Single site performance serves as a baseline that all federated algorithms should surpass, while centralized performance represents the gold standard against which federated algorithms are compared. We show that our PCBFL approach results in improved performance compared to both standard FedAvg and CBFL on the mortality prediction task. PCBFL also outperforms FedAvg and CBFL in the majority of the individual sites. In addition, our results demonstrate that PCBFL produces clinically meaningful clusters, grouping patients in low, medium, and high-risk cohorts. This suggests that PCBFL has the potential to support other clustering tasks such as federated phenotyping. Future work could explore the utility of our approach in a wider range of clinical applications.</p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Generalizable Insights about Machine Learning in the Context of Healthcare</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p">In healthcare, protecting patient privacy while leveraging data to improve clinical outcomes is a crucial challenge. This challenge is particularly relevant for complex deep learning models that require large sample sizes. Our paper introduces PCBFL, a privacy-preserving framework that uses SMPC to incorporate a clustering preprocessing step into federated learning. Our approach provides a practical solution to protect patient privacy while enabling patient-level calculations across different hospitals. Another key issue in healthcare is dealing with non-IID data, where data from different sites have different distributions. Our clustering-based approach effectively handles non-IID data by partitioning patients into clinically relevant groups. This clustering procedure can be used in various healthcare tasks, including unsupervised patient clustering for phenotyping. Our methodological contributions could be extended to conduct large-scale phenotyping across many sites, enabling more accurate and granular sub-phentoypes to be discovered.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In FL, several works have studied the statistical heterogeneity of users’ data and linked high heterogeneity to performance degradation and poor convergence (<cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>). To address this, researchers have attempted to personalize learning to each user (<cite class="ltx_cite ltx_citemacro_cite">Tan et al. (<a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite>). The proposed solutions typically occur at the preprocessing, learning, or postprocessing stages. Preprocessing solutions include data-augmentation and client partitioning (<cite class="ltx_cite ltx_citemacro_cite">Sattler et al. (<a href="#bib.bib31" title="" class="ltx_ref">2020</a>); Zhao et al. (<a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>). Learning solutions include meta-learning and modifications to the FedAvg algorithm (<span id="S2.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> addition of regularization parameters) (<cite class="ltx_cite ltx_citemacro_cite">Fallah et al. (<a href="#bib.bib9" title="" class="ltx_ref">2020</a>); Deng et al. (<a href="#bib.bib4" title="" class="ltx_ref">2020</a>); Li et al. (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>). Post-processing techniques involve adaptation of the global model by the local site after federated training is complete (<cite class="ltx_cite ltx_citemacro_cite">Hanzely and Richtárik (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>). In healthcare, personalized FL has mostly focused on preprocessing steps. An example is CBFL, which uses embeddings to cluster patients (<cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>). The authors showed clustering improved performance on a downstream mortality prediction task compared to the standard FedAvg technique. However, due to privacy constraints, CBFL’s patient clustering is based on average embeddings per site, <span id="S2.p1.1.2" class="ltx_text ltx_font_italic">i.e.,</span> it does not use individual patient embeddings. This led to patient clusters based on the geography of hospitals and not based on patient characteristics.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Cohort and feature extraction</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We used the eICU collaborative research database, which contains critical care data for 200,859 patients at 208 hospitals across the United States (<cite class="ltx_cite ltx_citemacro_cite">Pollard et al. (<a href="#bib.bib27" title="" class="ltx_ref">2018</a>)</cite>). We followed a similar data-processing step as <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>. The outcome of interest was mortality in the ICU, defined as the unit discharge status (0 for alive and 1 for expired). The independent variables are diagnosis, drugs, and physical exam markers in the first 48 hours of admission. We limited our features to the first 48 hours to ensure consistency on patient follow-up times and clinical relevancy of model predictions.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">For diagnosis and drugs, we used the count of times the feature appears in the dataset for that patient. For physiological markers, we used the first recorded instance. Physical exam markers used include: Glasgow Coma Scale (GCS) Motor, GCS Verbal, GCS Eye, Heart Rate (HR), Systolic Blood pressure (SBP), Respiratory rate (RR) and Oxygen Saturation (O2%), age, admission weight, admission height. Drug and physiologic features were kept as is (1,056 and 7 features in total, respectively). Diagnosis codes were rolled up to 4 digits, <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_italic">i.e.,</span> all 5 digit codes were converted to 4 digit codes resulting in 483 diagnosis codes. Note, compared to <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>, we also added diagnosis and physical exam markers to the features as these have been shown to improve predictive performance in related tasks (<cite class="ltx_cite ltx_citemacro_cite">Sheikhalishahi et al. (<a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite>). All data was 0-1 normalized prior to training by the models.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">We extracted patients from the dataset who had data for all three variable groups and a recorded outcome. This was done to avoid the need for imputation which could introduce bias to the data. Doing so would affect evaluation of the training architectures. We then filtered for sites that had a minimum of 250 patients, resulting in 20 sites and 20,221 patients. We randomly subsample 250 patients from each site, creating a final cohort of 5,000 patients. This subsampling approach was intended to create a more realistic FL scenario, where size of the dataset in each site is limited.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Privacy-preserving CBFL</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">A schematic of the steps involved in PCBFL is presented in Figure 1 and the procedures for each step are detailed in Supplementary Algorithms 1-4 (Appendix E). PCBFL is composed of four procedures: creating patient embeddings, estimating patient similarity securely, clustering patients, and predicting mortality.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2307.08847/assets/schematic_pcbfl.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="354" height="393" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S3.F1.5.1" class="ltx_text ltx_font_bold">(A) Training a denoising autoencoder to create embeddings.</span> A federated autoencoder is trained to obtain latent variables for each feature domain. Latent variables are concatenated to form a patient embedding vector. <span id="S3.F1.6.2" class="ltx_text ltx_font_bold">(B) SMPC protocol to calculate the cosine similarity between vectors.</span> SMPC uses a secret sharing scheme to jointly calculate the dot product between pairs of vectors. <span id="S3.F1.7.3" class="ltx_text ltx_font_bold">(C) Spectral clustering to cluster the patients</span> using similarity matrix generated from pairwise cosine similarities of embeddings. <span id="S3.F1.8.4" class="ltx_text ltx_font_bold">(D) Cluster-based FL training.</span> Each model is separately trained per cluster.
</figcaption>
</figure>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Creating patient embedding</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>, we trained a federated denoising autoencoder made up of 6 layers including a three-layer encoder and an identical three-layer decoder to create patient embeddings. To reduce overfitting, 30% of the features are stochastically corrupted during training, <span id="S3.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_italic">i.e.,</span> 30% features are forced to 0. A separate autoencoder was trained for each feature domain, <span id="S3.SS2.SSS1.p1.1.2" class="ltx_text ltx_font_italic">i.e.,</span> drugs, diagnosis, and physical examination. We used a ReLU activation in the hidden layers, a sigmoid activation in the final output layer, and a Mean Squared Error loss. We used an Adam optimizer with a learning rate of 1<math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="e^{-3}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msup id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">e</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3a" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">−</mo><mn id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝑒</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><minus id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"></minus><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">e^{-3}</annotation></semantics></math> and batch size of 32. Federated models were trained for 20 rounds with 10 epochs per round and centralized models were trained for 200 epochs. For one patient’s embedding, we concatenated the latent variables of each feature domain</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Estimating patient similarity securely</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">We used cosine similarity as the similarity metric as it is invariant to scaling effects and works well with high dimensional vectors compared to euclidean distance (<cite class="ltx_cite ltx_citemacro_cite">Strehl et al. (<a href="#bib.bib33" title="" class="ltx_ref">2000</a>); Li et al. (<a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>). We used SMPC to securely calculate patient embedding similarity across sites while preserving privacy. SMPC is a cryptographic technique that allows parties to jointly compute a function over their inputs while keeping the inputs secret, <span id="S3.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_italic">i.e.,</span> only the output is made available (<cite class="ltx_cite ltx_citemacro_cite">Evans et al. (<a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>). The benefit of SMPC is that it protects privacy against both outside adversaries and other involved parties with mathematical guarantees and allows for exact calculation of cosine similarity across sites. We adapted a protocol from <cite class="ltx_cite ltx_citemacro_cite">Du et al. (<a href="#bib.bib5" title="" class="ltx_ref">2004</a>)</cite> to calculate the dot product across sites (see SMPC protocol) using secret sharing for an honest-but-curious adversary model. This protocol involves the following steps:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.7" class="ltx_p">Create a <math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="dxd" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.1.m1.1.1.1a" xref="S3.I1.i1.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.1.m1.1.1.4" xref="S3.I1.i1.p1.1.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><times id="S3.I1.i1.p1.1.m1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1"></times><ci id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2">𝑑</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3">𝑥</ci><ci id="S3.I1.i1.p1.1.m1.1.1.4.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">dxd</annotation></semantics></math> invertible matrix <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">M</annotation></semantics></math> and send <math id="S3.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.I1.i1.p1.3.m3.1a"><mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">M</annotation></semantics></math> to <math id="S3.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="site_{1}" display="inline"><semantics id="S3.I1.i1.p1.4.m4.1a"><mrow id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.2" xref="S3.I1.i1.p1.4.m4.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.4.m4.1.1.3" xref="S3.I1.i1.p1.4.m4.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1a" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.4.m4.1.1.4" xref="S3.I1.i1.p1.4.m4.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.4.m4.1.1.1b" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">​</mo><msub id="S3.I1.i1.p1.4.m4.1.1.5" xref="S3.I1.i1.p1.4.m4.1.1.5.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.5.2" xref="S3.I1.i1.p1.4.m4.1.1.5.2.cmml">e</mi><mn id="S3.I1.i1.p1.4.m4.1.1.5.3" xref="S3.I1.i1.p1.4.m4.1.1.5.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b"><apply id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1"><times id="S3.I1.i1.p1.4.m4.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1"></times><ci id="S3.I1.i1.p1.4.m4.1.1.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.I1.i1.p1.4.m4.1.1.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.3">𝑖</ci><ci id="S3.I1.i1.p1.4.m4.1.1.4.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4">𝑡</ci><apply id="S3.I1.i1.p1.4.m4.1.1.5.cmml" xref="S3.I1.i1.p1.4.m4.1.1.5"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.1.1.5.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.5">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.1.1.5.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.5.2">𝑒</ci><cn type="integer" id="S3.I1.i1.p1.4.m4.1.1.5.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.5.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">site_{1}</annotation></semantics></math> and <math id="S3.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="M^{-1}" display="inline"><semantics id="S3.I1.i1.p1.5.m5.1a"><msup id="S3.I1.i1.p1.5.m5.1.1" xref="S3.I1.i1.p1.5.m5.1.1.cmml"><mi id="S3.I1.i1.p1.5.m5.1.1.2" xref="S3.I1.i1.p1.5.m5.1.1.2.cmml">M</mi><mrow id="S3.I1.i1.p1.5.m5.1.1.3" xref="S3.I1.i1.p1.5.m5.1.1.3.cmml"><mo id="S3.I1.i1.p1.5.m5.1.1.3a" xref="S3.I1.i1.p1.5.m5.1.1.3.cmml">−</mo><mn id="S3.I1.i1.p1.5.m5.1.1.3.2" xref="S3.I1.i1.p1.5.m5.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.1b"><apply id="S3.I1.i1.p1.5.m5.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.I1.i1.p1.5.m5.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.1.1.2">𝑀</ci><apply id="S3.I1.i1.p1.5.m5.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.1.1.3"><minus id="S3.I1.i1.p1.5.m5.1.1.3.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1.3"></minus><cn type="integer" id="S3.I1.i1.p1.5.m5.1.1.3.2.cmml" xref="S3.I1.i1.p1.5.m5.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.1c">M^{-1}</annotation></semantics></math> to <math id="S3.I1.i1.p1.6.m6.1" class="ltx_Math" alttext="site_{2}" display="inline"><semantics id="S3.I1.i1.p1.6.m6.1a"><mrow id="S3.I1.i1.p1.6.m6.1.1" xref="S3.I1.i1.p1.6.m6.1.1.cmml"><mi id="S3.I1.i1.p1.6.m6.1.1.2" xref="S3.I1.i1.p1.6.m6.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.6.m6.1.1.1" xref="S3.I1.i1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.6.m6.1.1.3" xref="S3.I1.i1.p1.6.m6.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.6.m6.1.1.1a" xref="S3.I1.i1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.I1.i1.p1.6.m6.1.1.4" xref="S3.I1.i1.p1.6.m6.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.I1.i1.p1.6.m6.1.1.1b" xref="S3.I1.i1.p1.6.m6.1.1.1.cmml">​</mo><msub id="S3.I1.i1.p1.6.m6.1.1.5" xref="S3.I1.i1.p1.6.m6.1.1.5.cmml"><mi id="S3.I1.i1.p1.6.m6.1.1.5.2" xref="S3.I1.i1.p1.6.m6.1.1.5.2.cmml">e</mi><mn id="S3.I1.i1.p1.6.m6.1.1.5.3" xref="S3.I1.i1.p1.6.m6.1.1.5.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.6.m6.1b"><apply id="S3.I1.i1.p1.6.m6.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1"><times id="S3.I1.i1.p1.6.m6.1.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.1"></times><ci id="S3.I1.i1.p1.6.m6.1.1.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2">𝑠</ci><ci id="S3.I1.i1.p1.6.m6.1.1.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3">𝑖</ci><ci id="S3.I1.i1.p1.6.m6.1.1.4.cmml" xref="S3.I1.i1.p1.6.m6.1.1.4">𝑡</ci><apply id="S3.I1.i1.p1.6.m6.1.1.5.cmml" xref="S3.I1.i1.p1.6.m6.1.1.5"><csymbol cd="ambiguous" id="S3.I1.i1.p1.6.m6.1.1.5.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.5">subscript</csymbol><ci id="S3.I1.i1.p1.6.m6.1.1.5.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.5.2">𝑒</ci><cn type="integer" id="S3.I1.i1.p1.6.m6.1.1.5.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.5.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.6.m6.1c">site_{2}</annotation></semantics></math> (where <math id="S3.I1.i1.p1.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.I1.i1.p1.7.m7.1a"><mi id="S3.I1.i1.p1.7.m7.1.1" xref="S3.I1.i1.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.7.m7.1b"><ci id="S3.I1.i1.p1.7.m7.1.1.cmml" xref="S3.I1.i1.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.7.m7.1c">d</annotation></semantics></math> is the embedding dimension)</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.2" class="ltx_p">Each site divides their dataset into submatrices and masks them with <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">M</annotation></semantics></math> or <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="M^{-1}" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><msup id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">M</mi><mrow id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml"><mo id="S3.I1.i2.p1.2.m2.1.1.3a" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">−</mo><mn id="S3.I1.i2.p1.2.m2.1.1.3.2" xref="S3.I1.i2.p1.2.m2.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">𝑀</ci><apply id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3"><minus id="S3.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3"></minus><cn type="integer" id="S3.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">M^{-1}</annotation></semantics></math></p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">A limited number of masked submatrices are shared between sites</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">The submatrices are combined to produce the final dot product without revealing any information about the dataset</p>
</div>
</li>
</ol>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<span id="S3.SS2.SSS2.p2.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">SMPC PROTOCOL</h2>

<span id="Sx1.p1" class="ltx_para">
<span id="Sx1.p1.6" class="ltx_p"><math id="Sx1.p1.1.m1.1" class="ltx_Math" alttext="Site_{1}" display="inline"><semantics id="Sx1.p1.1.m1.1a"><mrow id="Sx1.p1.1.m1.1.1" xref="Sx1.p1.1.m1.1.1.cmml"><mi id="Sx1.p1.1.m1.1.1.2" xref="Sx1.p1.1.m1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.1.m1.1.1.1" xref="Sx1.p1.1.m1.1.1.1.cmml">​</mo><mi id="Sx1.p1.1.m1.1.1.3" xref="Sx1.p1.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.1.m1.1.1.1a" xref="Sx1.p1.1.m1.1.1.1.cmml">​</mo><mi id="Sx1.p1.1.m1.1.1.4" xref="Sx1.p1.1.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.1.m1.1.1.1b" xref="Sx1.p1.1.m1.1.1.1.cmml">​</mo><msub id="Sx1.p1.1.m1.1.1.5" xref="Sx1.p1.1.m1.1.1.5.cmml"><mi id="Sx1.p1.1.m1.1.1.5.2" xref="Sx1.p1.1.m1.1.1.5.2.cmml">e</mi><mn id="Sx1.p1.1.m1.1.1.5.3" xref="Sx1.p1.1.m1.1.1.5.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.1.m1.1b"><apply id="Sx1.p1.1.m1.1.1.cmml" xref="Sx1.p1.1.m1.1.1"><times id="Sx1.p1.1.m1.1.1.1.cmml" xref="Sx1.p1.1.m1.1.1.1"></times><ci id="Sx1.p1.1.m1.1.1.2.cmml" xref="Sx1.p1.1.m1.1.1.2">𝑆</ci><ci id="Sx1.p1.1.m1.1.1.3.cmml" xref="Sx1.p1.1.m1.1.1.3">𝑖</ci><ci id="Sx1.p1.1.m1.1.1.4.cmml" xref="Sx1.p1.1.m1.1.1.4">𝑡</ci><apply id="Sx1.p1.1.m1.1.1.5.cmml" xref="Sx1.p1.1.m1.1.1.5"><csymbol cd="ambiguous" id="Sx1.p1.1.m1.1.1.5.1.cmml" xref="Sx1.p1.1.m1.1.1.5">subscript</csymbol><ci id="Sx1.p1.1.m1.1.1.5.2.cmml" xref="Sx1.p1.1.m1.1.1.5.2">𝑒</ci><cn type="integer" id="Sx1.p1.1.m1.1.1.5.3.cmml" xref="Sx1.p1.1.m1.1.1.5.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.1.m1.1c">Site_{1}</annotation></semantics></math> hold dataset A (<math id="Sx1.p1.2.m2.1" class="ltx_Math" alttext="N_{1}\times d" display="inline"><semantics id="Sx1.p1.2.m2.1a"><mrow id="Sx1.p1.2.m2.1.1" xref="Sx1.p1.2.m2.1.1.cmml"><msub id="Sx1.p1.2.m2.1.1.2" xref="Sx1.p1.2.m2.1.1.2.cmml"><mi id="Sx1.p1.2.m2.1.1.2.2" xref="Sx1.p1.2.m2.1.1.2.2.cmml">N</mi><mn id="Sx1.p1.2.m2.1.1.2.3" xref="Sx1.p1.2.m2.1.1.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="Sx1.p1.2.m2.1.1.1" xref="Sx1.p1.2.m2.1.1.1.cmml">×</mo><mi id="Sx1.p1.2.m2.1.1.3" xref="Sx1.p1.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.2.m2.1b"><apply id="Sx1.p1.2.m2.1.1.cmml" xref="Sx1.p1.2.m2.1.1"><times id="Sx1.p1.2.m2.1.1.1.cmml" xref="Sx1.p1.2.m2.1.1.1"></times><apply id="Sx1.p1.2.m2.1.1.2.cmml" xref="Sx1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx1.p1.2.m2.1.1.2.1.cmml" xref="Sx1.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx1.p1.2.m2.1.1.2.2.cmml" xref="Sx1.p1.2.m2.1.1.2.2">𝑁</ci><cn type="integer" id="Sx1.p1.2.m2.1.1.2.3.cmml" xref="Sx1.p1.2.m2.1.1.2.3">1</cn></apply><ci id="Sx1.p1.2.m2.1.1.3.cmml" xref="Sx1.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.2.m2.1c">N_{1}\times d</annotation></semantics></math>), <math id="Sx1.p1.3.m3.1" class="ltx_Math" alttext="Site_{2}" display="inline"><semantics id="Sx1.p1.3.m3.1a"><mrow id="Sx1.p1.3.m3.1.1" xref="Sx1.p1.3.m3.1.1.cmml"><mi id="Sx1.p1.3.m3.1.1.2" xref="Sx1.p1.3.m3.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.3.m3.1.1.1" xref="Sx1.p1.3.m3.1.1.1.cmml">​</mo><mi id="Sx1.p1.3.m3.1.1.3" xref="Sx1.p1.3.m3.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.3.m3.1.1.1a" xref="Sx1.p1.3.m3.1.1.1.cmml">​</mo><mi id="Sx1.p1.3.m3.1.1.4" xref="Sx1.p1.3.m3.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx1.p1.3.m3.1.1.1b" xref="Sx1.p1.3.m3.1.1.1.cmml">​</mo><msub id="Sx1.p1.3.m3.1.1.5" xref="Sx1.p1.3.m3.1.1.5.cmml"><mi id="Sx1.p1.3.m3.1.1.5.2" xref="Sx1.p1.3.m3.1.1.5.2.cmml">e</mi><mn id="Sx1.p1.3.m3.1.1.5.3" xref="Sx1.p1.3.m3.1.1.5.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.3.m3.1b"><apply id="Sx1.p1.3.m3.1.1.cmml" xref="Sx1.p1.3.m3.1.1"><times id="Sx1.p1.3.m3.1.1.1.cmml" xref="Sx1.p1.3.m3.1.1.1"></times><ci id="Sx1.p1.3.m3.1.1.2.cmml" xref="Sx1.p1.3.m3.1.1.2">𝑆</ci><ci id="Sx1.p1.3.m3.1.1.3.cmml" xref="Sx1.p1.3.m3.1.1.3">𝑖</ci><ci id="Sx1.p1.3.m3.1.1.4.cmml" xref="Sx1.p1.3.m3.1.1.4">𝑡</ci><apply id="Sx1.p1.3.m3.1.1.5.cmml" xref="Sx1.p1.3.m3.1.1.5"><csymbol cd="ambiguous" id="Sx1.p1.3.m3.1.1.5.1.cmml" xref="Sx1.p1.3.m3.1.1.5">subscript</csymbol><ci id="Sx1.p1.3.m3.1.1.5.2.cmml" xref="Sx1.p1.3.m3.1.1.5.2">𝑒</ci><cn type="integer" id="Sx1.p1.3.m3.1.1.5.3.cmml" xref="Sx1.p1.3.m3.1.1.5.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.3.m3.1c">Site_{2}</annotation></semantics></math> hold dataset B (<math id="Sx1.p1.4.m4.1" class="ltx_Math" alttext="N_{2}\times d" display="inline"><semantics id="Sx1.p1.4.m4.1a"><mrow id="Sx1.p1.4.m4.1.1" xref="Sx1.p1.4.m4.1.1.cmml"><msub id="Sx1.p1.4.m4.1.1.2" xref="Sx1.p1.4.m4.1.1.2.cmml"><mi id="Sx1.p1.4.m4.1.1.2.2" xref="Sx1.p1.4.m4.1.1.2.2.cmml">N</mi><mn id="Sx1.p1.4.m4.1.1.2.3" xref="Sx1.p1.4.m4.1.1.2.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="Sx1.p1.4.m4.1.1.1" xref="Sx1.p1.4.m4.1.1.1.cmml">×</mo><mi id="Sx1.p1.4.m4.1.1.3" xref="Sx1.p1.4.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.4.m4.1b"><apply id="Sx1.p1.4.m4.1.1.cmml" xref="Sx1.p1.4.m4.1.1"><times id="Sx1.p1.4.m4.1.1.1.cmml" xref="Sx1.p1.4.m4.1.1.1"></times><apply id="Sx1.p1.4.m4.1.1.2.cmml" xref="Sx1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="Sx1.p1.4.m4.1.1.2.1.cmml" xref="Sx1.p1.4.m4.1.1.2">subscript</csymbol><ci id="Sx1.p1.4.m4.1.1.2.2.cmml" xref="Sx1.p1.4.m4.1.1.2.2">𝑁</ci><cn type="integer" id="Sx1.p1.4.m4.1.1.2.3.cmml" xref="Sx1.p1.4.m4.1.1.2.3">2</cn></apply><ci id="Sx1.p1.4.m4.1.1.3.cmml" xref="Sx1.p1.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.4.m4.1c">N_{2}\times d</annotation></semantics></math>) where <math id="Sx1.p1.5.m5.1" class="ltx_Math" alttext="d=" display="inline"><semantics id="Sx1.p1.5.m5.1a"><mrow id="Sx1.p1.5.m5.1.1" xref="Sx1.p1.5.m5.1.1.cmml"><mi id="Sx1.p1.5.m5.1.1.2" xref="Sx1.p1.5.m5.1.1.2.cmml">d</mi><mo id="Sx1.p1.5.m5.1.1.1" xref="Sx1.p1.5.m5.1.1.1.cmml">=</mo><mi id="Sx1.p1.5.m5.1.1.3" xref="Sx1.p1.5.m5.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.5.m5.1b"><apply id="Sx1.p1.5.m5.1.1.cmml" xref="Sx1.p1.5.m5.1.1"><eq id="Sx1.p1.5.m5.1.1.1.cmml" xref="Sx1.p1.5.m5.1.1.1"></eq><ci id="Sx1.p1.5.m5.1.1.2.cmml" xref="Sx1.p1.5.m5.1.1.2">𝑑</ci><csymbol cd="latexml" id="Sx1.p1.5.m5.1.1.3.cmml" xref="Sx1.p1.5.m5.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.5.m5.1c">d=</annotation></semantics></math>embedding dim and <math id="Sx1.p1.6.m6.1" class="ltx_Math" alttext="N_{i}=" display="inline"><semantics id="Sx1.p1.6.m6.1a"><mrow id="Sx1.p1.6.m6.1.1" xref="Sx1.p1.6.m6.1.1.cmml"><msub id="Sx1.p1.6.m6.1.1.2" xref="Sx1.p1.6.m6.1.1.2.cmml"><mi id="Sx1.p1.6.m6.1.1.2.2" xref="Sx1.p1.6.m6.1.1.2.2.cmml">N</mi><mi id="Sx1.p1.6.m6.1.1.2.3" xref="Sx1.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="Sx1.p1.6.m6.1.1.1" xref="Sx1.p1.6.m6.1.1.1.cmml">=</mo><mi id="Sx1.p1.6.m6.1.1.3" xref="Sx1.p1.6.m6.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.6.m6.1b"><apply id="Sx1.p1.6.m6.1.1.cmml" xref="Sx1.p1.6.m6.1.1"><eq id="Sx1.p1.6.m6.1.1.1.cmml" xref="Sx1.p1.6.m6.1.1.1"></eq><apply id="Sx1.p1.6.m6.1.1.2.cmml" xref="Sx1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx1.p1.6.m6.1.1.2.1.cmml" xref="Sx1.p1.6.m6.1.1.2">subscript</csymbol><ci id="Sx1.p1.6.m6.1.1.2.2.cmml" xref="Sx1.p1.6.m6.1.1.2.2">𝑁</ci><ci id="Sx1.p1.6.m6.1.1.2.3.cmml" xref="Sx1.p1.6.m6.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="Sx1.p1.6.m6.1.1.3.cmml" xref="Sx1.p1.6.m6.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.6.m6.1c">N_{i}=</annotation></semantics></math> number of patients.</span>
<span id="Sx1.I2" class="ltx_enumerate">
<span id="Sx1.I2.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span> 
<span id="Sx1.I2.i1.p1" class="ltx_para">
<span id="Sx1.I2.i1.p1.3" class="ltx_p">Server creates a random invertible matrix <math id="Sx1.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="M_{d\times d}" display="inline"><semantics id="Sx1.I2.i1.p1.1.m1.1a"><msub id="Sx1.I2.i1.p1.1.m1.1.1" xref="Sx1.I2.i1.p1.1.m1.1.1.cmml"><mi id="Sx1.I2.i1.p1.1.m1.1.1.2" xref="Sx1.I2.i1.p1.1.m1.1.1.2.cmml">M</mi><mrow id="Sx1.I2.i1.p1.1.m1.1.1.3" xref="Sx1.I2.i1.p1.1.m1.1.1.3.cmml"><mi id="Sx1.I2.i1.p1.1.m1.1.1.3.2" xref="Sx1.I2.i1.p1.1.m1.1.1.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i1.p1.1.m1.1.1.3.1" xref="Sx1.I2.i1.p1.1.m1.1.1.3.1.cmml">×</mo><mi id="Sx1.I2.i1.p1.1.m1.1.1.3.3" xref="Sx1.I2.i1.p1.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx1.I2.i1.p1.1.m1.1b"><apply id="Sx1.I2.i1.p1.1.m1.1.1.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i1.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="Sx1.I2.i1.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1.2">𝑀</ci><apply id="Sx1.I2.i1.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1.3"><times id="Sx1.I2.i1.p1.1.m1.1.1.3.1.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1.3.1"></times><ci id="Sx1.I2.i1.p1.1.m1.1.1.3.2.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1.3.2">𝑑</ci><ci id="Sx1.I2.i1.p1.1.m1.1.1.3.3.cmml" xref="Sx1.I2.i1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i1.p1.1.m1.1c">M_{d\times d}</annotation></semantics></math> using Reed-Hoffman encoding and sends <math id="Sx1.I2.i1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx1.I2.i1.p1.2.m2.1a"><mi id="Sx1.I2.i1.p1.2.m2.1.1" xref="Sx1.I2.i1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx1.I2.i1.p1.2.m2.1b"><ci id="Sx1.I2.i1.p1.2.m2.1.1.cmml" xref="Sx1.I2.i1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i1.p1.2.m2.1c">M</annotation></semantics></math> to Site 1 and <math id="Sx1.I2.i1.p1.3.m3.1" class="ltx_Math" alttext="M^{-1}" display="inline"><semantics id="Sx1.I2.i1.p1.3.m3.1a"><msup id="Sx1.I2.i1.p1.3.m3.1.1" xref="Sx1.I2.i1.p1.3.m3.1.1.cmml"><mi id="Sx1.I2.i1.p1.3.m3.1.1.2" xref="Sx1.I2.i1.p1.3.m3.1.1.2.cmml">M</mi><mrow id="Sx1.I2.i1.p1.3.m3.1.1.3" xref="Sx1.I2.i1.p1.3.m3.1.1.3.cmml"><mo id="Sx1.I2.i1.p1.3.m3.1.1.3a" xref="Sx1.I2.i1.p1.3.m3.1.1.3.cmml">−</mo><mn id="Sx1.I2.i1.p1.3.m3.1.1.3.2" xref="Sx1.I2.i1.p1.3.m3.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx1.I2.i1.p1.3.m3.1b"><apply id="Sx1.I2.i1.p1.3.m3.1.1.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i1.p1.3.m3.1.1.1.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1">superscript</csymbol><ci id="Sx1.I2.i1.p1.3.m3.1.1.2.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1.2">𝑀</ci><apply id="Sx1.I2.i1.p1.3.m3.1.1.3.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1.3"><minus id="Sx1.I2.i1.p1.3.m3.1.1.3.1.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1.3"></minus><cn type="integer" id="Sx1.I2.i1.p1.3.m3.1.1.3.2.cmml" xref="Sx1.I2.i1.p1.3.m3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i1.p1.3.m3.1c">M^{-1}</annotation></semantics></math> to Site 2.</span>
</span></span>
<span id="Sx1.I2.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span> 
<span id="Sx1.I2.i2.p1" class="ltx_para">
<span id="Sx1.I2.i2.p1.3" class="ltx_p">Site 1 computes <math id="Sx1.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="A_{1}=A\times M_{\text{left}}" display="inline"><semantics id="Sx1.I2.i2.p1.1.m1.1a"><mrow id="Sx1.I2.i2.p1.1.m1.1.1" xref="Sx1.I2.i2.p1.1.m1.1.1.cmml"><msub id="Sx1.I2.i2.p1.1.m1.1.1.2" xref="Sx1.I2.i2.p1.1.m1.1.1.2.cmml"><mi id="Sx1.I2.i2.p1.1.m1.1.1.2.2" xref="Sx1.I2.i2.p1.1.m1.1.1.2.2.cmml">A</mi><mn id="Sx1.I2.i2.p1.1.m1.1.1.2.3" xref="Sx1.I2.i2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="Sx1.I2.i2.p1.1.m1.1.1.1" xref="Sx1.I2.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i2.p1.1.m1.1.1.3" xref="Sx1.I2.i2.p1.1.m1.1.1.3.cmml"><mi id="Sx1.I2.i2.p1.1.m1.1.1.3.2" xref="Sx1.I2.i2.p1.1.m1.1.1.3.2.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i2.p1.1.m1.1.1.3.1" xref="Sx1.I2.i2.p1.1.m1.1.1.3.1.cmml">×</mo><msub id="Sx1.I2.i2.p1.1.m1.1.1.3.3" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.cmml"><mi id="Sx1.I2.i2.p1.1.m1.1.1.3.3.2" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.2.cmml">M</mi><mtext id="Sx1.I2.i2.p1.1.m1.1.1.3.3.3" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.3a.cmml">left</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i2.p1.1.m1.1b"><apply id="Sx1.I2.i2.p1.1.m1.1.1.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1"><eq id="Sx1.I2.i2.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.1"></eq><apply id="Sx1.I2.i2.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i2.p1.1.m1.1.1.2.1.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx1.I2.i2.p1.1.m1.1.1.2.2.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.2.2">𝐴</ci><cn type="integer" id="Sx1.I2.i2.p1.1.m1.1.1.2.3.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.2.3">1</cn></apply><apply id="Sx1.I2.i2.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3"><times id="Sx1.I2.i2.p1.1.m1.1.1.3.1.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.1"></times><ci id="Sx1.I2.i2.p1.1.m1.1.1.3.2.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.2">𝐴</ci><apply id="Sx1.I2.i2.p1.1.m1.1.1.3.3.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i2.p1.1.m1.1.1.3.3.1.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i2.p1.1.m1.1.1.3.3.2.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.2">𝑀</ci><ci id="Sx1.I2.i2.p1.1.m1.1.1.3.3.3a.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.3"><mtext mathsize="70%" id="Sx1.I2.i2.p1.1.m1.1.1.3.3.3.cmml" xref="Sx1.I2.i2.p1.1.m1.1.1.3.3.3">left</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i2.p1.1.m1.1c">A_{1}=A\times M_{\text{left}}</annotation></semantics></math>, <math id="Sx1.I2.i2.p1.2.m2.1" class="ltx_Math" alttext="A_{2}=A\times M_{\text{right}}" display="inline"><semantics id="Sx1.I2.i2.p1.2.m2.1a"><mrow id="Sx1.I2.i2.p1.2.m2.1.1" xref="Sx1.I2.i2.p1.2.m2.1.1.cmml"><msub id="Sx1.I2.i2.p1.2.m2.1.1.2" xref="Sx1.I2.i2.p1.2.m2.1.1.2.cmml"><mi id="Sx1.I2.i2.p1.2.m2.1.1.2.2" xref="Sx1.I2.i2.p1.2.m2.1.1.2.2.cmml">A</mi><mn id="Sx1.I2.i2.p1.2.m2.1.1.2.3" xref="Sx1.I2.i2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="Sx1.I2.i2.p1.2.m2.1.1.1" xref="Sx1.I2.i2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i2.p1.2.m2.1.1.3" xref="Sx1.I2.i2.p1.2.m2.1.1.3.cmml"><mi id="Sx1.I2.i2.p1.2.m2.1.1.3.2" xref="Sx1.I2.i2.p1.2.m2.1.1.3.2.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i2.p1.2.m2.1.1.3.1" xref="Sx1.I2.i2.p1.2.m2.1.1.3.1.cmml">×</mo><msub id="Sx1.I2.i2.p1.2.m2.1.1.3.3" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.cmml"><mi id="Sx1.I2.i2.p1.2.m2.1.1.3.3.2" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.2.cmml">M</mi><mtext id="Sx1.I2.i2.p1.2.m2.1.1.3.3.3" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.3a.cmml">right</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i2.p1.2.m2.1b"><apply id="Sx1.I2.i2.p1.2.m2.1.1.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1"><eq id="Sx1.I2.i2.p1.2.m2.1.1.1.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.1"></eq><apply id="Sx1.I2.i2.p1.2.m2.1.1.2.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i2.p1.2.m2.1.1.2.1.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx1.I2.i2.p1.2.m2.1.1.2.2.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.2.2">𝐴</ci><cn type="integer" id="Sx1.I2.i2.p1.2.m2.1.1.2.3.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.2.3">2</cn></apply><apply id="Sx1.I2.i2.p1.2.m2.1.1.3.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3"><times id="Sx1.I2.i2.p1.2.m2.1.1.3.1.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.1"></times><ci id="Sx1.I2.i2.p1.2.m2.1.1.3.2.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.2">𝐴</ci><apply id="Sx1.I2.i2.p1.2.m2.1.1.3.3.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i2.p1.2.m2.1.1.3.3.1.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i2.p1.2.m2.1.1.3.3.2.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.2">𝑀</ci><ci id="Sx1.I2.i2.p1.2.m2.1.1.3.3.3a.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.3"><mtext mathsize="70%" id="Sx1.I2.i2.p1.2.m2.1.1.3.3.3.cmml" xref="Sx1.I2.i2.p1.2.m2.1.1.3.3.3">right</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i2.p1.2.m2.1c">A_{2}=A\times M_{\text{right}}</annotation></semantics></math> and sends <math id="Sx1.I2.i2.p1.3.m3.1" class="ltx_Math" alttext="A_{1}" display="inline"><semantics id="Sx1.I2.i2.p1.3.m3.1a"><msub id="Sx1.I2.i2.p1.3.m3.1.1" xref="Sx1.I2.i2.p1.3.m3.1.1.cmml"><mi id="Sx1.I2.i2.p1.3.m3.1.1.2" xref="Sx1.I2.i2.p1.3.m3.1.1.2.cmml">A</mi><mn id="Sx1.I2.i2.p1.3.m3.1.1.3" xref="Sx1.I2.i2.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.I2.i2.p1.3.m3.1b"><apply id="Sx1.I2.i2.p1.3.m3.1.1.cmml" xref="Sx1.I2.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i2.p1.3.m3.1.1.1.cmml" xref="Sx1.I2.i2.p1.3.m3.1.1">subscript</csymbol><ci id="Sx1.I2.i2.p1.3.m3.1.1.2.cmml" xref="Sx1.I2.i2.p1.3.m3.1.1.2">𝐴</ci><cn type="integer" id="Sx1.I2.i2.p1.3.m3.1.1.3.cmml" xref="Sx1.I2.i2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i2.p1.3.m3.1c">A_{1}</annotation></semantics></math> to the server.</span>
</span></span>
<span id="Sx1.I2.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span> 
<span id="Sx1.I2.i3.p1" class="ltx_para">
<span id="Sx1.I2.i3.p1.3" class="ltx_p">Site 2 computes <math id="Sx1.I2.i3.p1.1.m1.1" class="ltx_Math" alttext="B_{1}=B\times M_{\text{top}}^{-1}" display="inline"><semantics id="Sx1.I2.i3.p1.1.m1.1a"><mrow id="Sx1.I2.i3.p1.1.m1.1.1" xref="Sx1.I2.i3.p1.1.m1.1.1.cmml"><msub id="Sx1.I2.i3.p1.1.m1.1.1.2" xref="Sx1.I2.i3.p1.1.m1.1.1.2.cmml"><mi id="Sx1.I2.i3.p1.1.m1.1.1.2.2" xref="Sx1.I2.i3.p1.1.m1.1.1.2.2.cmml">B</mi><mn id="Sx1.I2.i3.p1.1.m1.1.1.2.3" xref="Sx1.I2.i3.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="Sx1.I2.i3.p1.1.m1.1.1.1" xref="Sx1.I2.i3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i3.p1.1.m1.1.1.3" xref="Sx1.I2.i3.p1.1.m1.1.1.3.cmml"><mi id="Sx1.I2.i3.p1.1.m1.1.1.3.2" xref="Sx1.I2.i3.p1.1.m1.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i3.p1.1.m1.1.1.3.1" xref="Sx1.I2.i3.p1.1.m1.1.1.3.1.cmml">×</mo><msubsup id="Sx1.I2.i3.p1.1.m1.1.1.3.3" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.cmml"><mi id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.2" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.2.cmml">M</mi><mtext id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3a.cmml">top</mtext><mrow id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.cmml"><mo id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3a" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.cmml">−</mo><mn id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.2" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i3.p1.1.m1.1b"><apply id="Sx1.I2.i3.p1.1.m1.1.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1"><eq id="Sx1.I2.i3.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.1"></eq><apply id="Sx1.I2.i3.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.1.m1.1.1.2.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx1.I2.i3.p1.1.m1.1.1.2.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.2.2">𝐵</ci><cn type="integer" id="Sx1.I2.i3.p1.1.m1.1.1.2.3.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.2.3">1</cn></apply><apply id="Sx1.I2.i3.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3"><times id="Sx1.I2.i3.p1.1.m1.1.1.3.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.1"></times><ci id="Sx1.I2.i3.p1.1.m1.1.1.3.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.2">𝐵</ci><apply id="Sx1.I2.i3.p1.1.m1.1.1.3.3.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.1.m1.1.1.3.3.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3">superscript</csymbol><apply id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.2">𝑀</ci><ci id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3a.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3"><mtext mathsize="70%" id="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.2.3">top</mtext></ci></apply><apply id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3"><minus id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.1.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3"></minus><cn type="integer" id="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.2.cmml" xref="Sx1.I2.i3.p1.1.m1.1.1.3.3.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i3.p1.1.m1.1c">B_{1}=B\times M_{\text{top}}^{-1}</annotation></semantics></math>, <math id="Sx1.I2.i3.p1.2.m2.1" class="ltx_Math" alttext="B_{2}=B\times M_{\text{bottom}}^{-1}" display="inline"><semantics id="Sx1.I2.i3.p1.2.m2.1a"><mrow id="Sx1.I2.i3.p1.2.m2.1.1" xref="Sx1.I2.i3.p1.2.m2.1.1.cmml"><msub id="Sx1.I2.i3.p1.2.m2.1.1.2" xref="Sx1.I2.i3.p1.2.m2.1.1.2.cmml"><mi id="Sx1.I2.i3.p1.2.m2.1.1.2.2" xref="Sx1.I2.i3.p1.2.m2.1.1.2.2.cmml">B</mi><mn id="Sx1.I2.i3.p1.2.m2.1.1.2.3" xref="Sx1.I2.i3.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="Sx1.I2.i3.p1.2.m2.1.1.1" xref="Sx1.I2.i3.p1.2.m2.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i3.p1.2.m2.1.1.3" xref="Sx1.I2.i3.p1.2.m2.1.1.3.cmml"><mi id="Sx1.I2.i3.p1.2.m2.1.1.3.2" xref="Sx1.I2.i3.p1.2.m2.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i3.p1.2.m2.1.1.3.1" xref="Sx1.I2.i3.p1.2.m2.1.1.3.1.cmml">×</mo><msubsup id="Sx1.I2.i3.p1.2.m2.1.1.3.3" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.cmml"><mi id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.2" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.2.cmml">M</mi><mtext id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3a.cmml">bottom</mtext><mrow id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.cmml"><mo id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3a" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.cmml">−</mo><mn id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.2" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i3.p1.2.m2.1b"><apply id="Sx1.I2.i3.p1.2.m2.1.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1"><eq id="Sx1.I2.i3.p1.2.m2.1.1.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.1"></eq><apply id="Sx1.I2.i3.p1.2.m2.1.1.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.2.m2.1.1.2.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx1.I2.i3.p1.2.m2.1.1.2.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.2.2">𝐵</ci><cn type="integer" id="Sx1.I2.i3.p1.2.m2.1.1.2.3.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.2.3">2</cn></apply><apply id="Sx1.I2.i3.p1.2.m2.1.1.3.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3"><times id="Sx1.I2.i3.p1.2.m2.1.1.3.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.1"></times><ci id="Sx1.I2.i3.p1.2.m2.1.1.3.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.2">𝐵</ci><apply id="Sx1.I2.i3.p1.2.m2.1.1.3.3.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.2.m2.1.1.3.3.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3">superscript</csymbol><apply id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.2">𝑀</ci><ci id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3a.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3"><mtext mathsize="70%" id="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.2.3">bottom</mtext></ci></apply><apply id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3"><minus id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.1.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3"></minus><cn type="integer" id="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.2.cmml" xref="Sx1.I2.i3.p1.2.m2.1.1.3.3.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i3.p1.2.m2.1c">B_{2}=B\times M_{\text{bottom}}^{-1}</annotation></semantics></math> and sends <math id="Sx1.I2.i3.p1.3.m3.1" class="ltx_Math" alttext="B_{2}" display="inline"><semantics id="Sx1.I2.i3.p1.3.m3.1a"><msub id="Sx1.I2.i3.p1.3.m3.1.1" xref="Sx1.I2.i3.p1.3.m3.1.1.cmml"><mi id="Sx1.I2.i3.p1.3.m3.1.1.2" xref="Sx1.I2.i3.p1.3.m3.1.1.2.cmml">B</mi><mn id="Sx1.I2.i3.p1.3.m3.1.1.3" xref="Sx1.I2.i3.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.I2.i3.p1.3.m3.1b"><apply id="Sx1.I2.i3.p1.3.m3.1.1.cmml" xref="Sx1.I2.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i3.p1.3.m3.1.1.1.cmml" xref="Sx1.I2.i3.p1.3.m3.1.1">subscript</csymbol><ci id="Sx1.I2.i3.p1.3.m3.1.1.2.cmml" xref="Sx1.I2.i3.p1.3.m3.1.1.2">𝐵</ci><cn type="integer" id="Sx1.I2.i3.p1.3.m3.1.1.3.cmml" xref="Sx1.I2.i3.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i3.p1.3.m3.1c">B_{2}</annotation></semantics></math> to the server.</span>
</span></span>
<span id="Sx1.I2.i4" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">4.</span> 
<span id="Sx1.I2.i4.p1" class="ltx_para">
<span id="Sx1.I2.i4.p1.2" class="ltx_p">Server sends <math id="Sx1.I2.i4.p1.1.m1.1" class="ltx_Math" alttext="B_{2}" display="inline"><semantics id="Sx1.I2.i4.p1.1.m1.1a"><msub id="Sx1.I2.i4.p1.1.m1.1.1" xref="Sx1.I2.i4.p1.1.m1.1.1.cmml"><mi id="Sx1.I2.i4.p1.1.m1.1.1.2" xref="Sx1.I2.i4.p1.1.m1.1.1.2.cmml">B</mi><mn id="Sx1.I2.i4.p1.1.m1.1.1.3" xref="Sx1.I2.i4.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.I2.i4.p1.1.m1.1b"><apply id="Sx1.I2.i4.p1.1.m1.1.1.cmml" xref="Sx1.I2.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i4.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i4.p1.1.m1.1.1">subscript</csymbol><ci id="Sx1.I2.i4.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i4.p1.1.m1.1.1.2">𝐵</ci><cn type="integer" id="Sx1.I2.i4.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i4.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i4.p1.1.m1.1c">B_{2}</annotation></semantics></math> to Site 1 and <math id="Sx1.I2.i4.p1.2.m2.1" class="ltx_Math" alttext="A_{1}" display="inline"><semantics id="Sx1.I2.i4.p1.2.m2.1a"><msub id="Sx1.I2.i4.p1.2.m2.1.1" xref="Sx1.I2.i4.p1.2.m2.1.1.cmml"><mi id="Sx1.I2.i4.p1.2.m2.1.1.2" xref="Sx1.I2.i4.p1.2.m2.1.1.2.cmml">A</mi><mn id="Sx1.I2.i4.p1.2.m2.1.1.3" xref="Sx1.I2.i4.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.I2.i4.p1.2.m2.1b"><apply id="Sx1.I2.i4.p1.2.m2.1.1.cmml" xref="Sx1.I2.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx1.I2.i4.p1.2.m2.1.1.1.cmml" xref="Sx1.I2.i4.p1.2.m2.1.1">subscript</csymbol><ci id="Sx1.I2.i4.p1.2.m2.1.1.2.cmml" xref="Sx1.I2.i4.p1.2.m2.1.1.2">𝐴</ci><cn type="integer" id="Sx1.I2.i4.p1.2.m2.1.1.3.cmml" xref="Sx1.I2.i4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i4.p1.2.m2.1c">A_{1}</annotation></semantics></math> to Site 2.</span>
</span></span>
<span id="Sx1.I2.i5" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">5.</span> 
<span id="Sx1.I2.i5.p1" class="ltx_para">
<span id="Sx1.I2.i5.p1.1" class="ltx_p">Site 1 computes <math id="Sx1.I2.i5.p1.1.m1.1" class="ltx_Math" alttext="V_{a}=A_{2}\times B_{2}" display="inline"><semantics id="Sx1.I2.i5.p1.1.m1.1a"><mrow id="Sx1.I2.i5.p1.1.m1.1.1" xref="Sx1.I2.i5.p1.1.m1.1.1.cmml"><msub id="Sx1.I2.i5.p1.1.m1.1.1.2" xref="Sx1.I2.i5.p1.1.m1.1.1.2.cmml"><mi id="Sx1.I2.i5.p1.1.m1.1.1.2.2" xref="Sx1.I2.i5.p1.1.m1.1.1.2.2.cmml">V</mi><mi id="Sx1.I2.i5.p1.1.m1.1.1.2.3" xref="Sx1.I2.i5.p1.1.m1.1.1.2.3.cmml">a</mi></msub><mo id="Sx1.I2.i5.p1.1.m1.1.1.1" xref="Sx1.I2.i5.p1.1.m1.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i5.p1.1.m1.1.1.3" xref="Sx1.I2.i5.p1.1.m1.1.1.3.cmml"><msub id="Sx1.I2.i5.p1.1.m1.1.1.3.2" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2.cmml"><mi id="Sx1.I2.i5.p1.1.m1.1.1.3.2.2" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2.2.cmml">A</mi><mn id="Sx1.I2.i5.p1.1.m1.1.1.3.2.3" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i5.p1.1.m1.1.1.3.1" xref="Sx1.I2.i5.p1.1.m1.1.1.3.1.cmml">×</mo><msub id="Sx1.I2.i5.p1.1.m1.1.1.3.3" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3.cmml"><mi id="Sx1.I2.i5.p1.1.m1.1.1.3.3.2" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3.2.cmml">B</mi><mn id="Sx1.I2.i5.p1.1.m1.1.1.3.3.3" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i5.p1.1.m1.1b"><apply id="Sx1.I2.i5.p1.1.m1.1.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1"><eq id="Sx1.I2.i5.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.1"></eq><apply id="Sx1.I2.i5.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i5.p1.1.m1.1.1.2.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx1.I2.i5.p1.1.m1.1.1.2.2.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.2.2">𝑉</ci><ci id="Sx1.I2.i5.p1.1.m1.1.1.2.3.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.2.3">𝑎</ci></apply><apply id="Sx1.I2.i5.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3"><times id="Sx1.I2.i5.p1.1.m1.1.1.3.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.1"></times><apply id="Sx1.I2.i5.p1.1.m1.1.1.3.2.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx1.I2.i5.p1.1.m1.1.1.3.2.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="Sx1.I2.i5.p1.1.m1.1.1.3.2.2.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2.2">𝐴</ci><cn type="integer" id="Sx1.I2.i5.p1.1.m1.1.1.3.2.3.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.2.3">2</cn></apply><apply id="Sx1.I2.i5.p1.1.m1.1.1.3.3.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i5.p1.1.m1.1.1.3.3.1.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i5.p1.1.m1.1.1.3.3.2.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3.2">𝐵</ci><cn type="integer" id="Sx1.I2.i5.p1.1.m1.1.1.3.3.3.cmml" xref="Sx1.I2.i5.p1.1.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i5.p1.1.m1.1c">V_{a}=A_{2}\times B_{2}</annotation></semantics></math> and sends it to the server.</span>
</span></span>
<span id="Sx1.I2.i6" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">6.</span> 
<span id="Sx1.I2.i6.p1" class="ltx_para">
<span id="Sx1.I2.i6.p1.1" class="ltx_p">Site 2 computes <math id="Sx1.I2.i6.p1.1.m1.1" class="ltx_Math" alttext="V_{b}=A_{1}\times B_{1}" display="inline"><semantics id="Sx1.I2.i6.p1.1.m1.1a"><mrow id="Sx1.I2.i6.p1.1.m1.1.1" xref="Sx1.I2.i6.p1.1.m1.1.1.cmml"><msub id="Sx1.I2.i6.p1.1.m1.1.1.2" xref="Sx1.I2.i6.p1.1.m1.1.1.2.cmml"><mi id="Sx1.I2.i6.p1.1.m1.1.1.2.2" xref="Sx1.I2.i6.p1.1.m1.1.1.2.2.cmml">V</mi><mi id="Sx1.I2.i6.p1.1.m1.1.1.2.3" xref="Sx1.I2.i6.p1.1.m1.1.1.2.3.cmml">b</mi></msub><mo id="Sx1.I2.i6.p1.1.m1.1.1.1" xref="Sx1.I2.i6.p1.1.m1.1.1.1.cmml">=</mo><mrow id="Sx1.I2.i6.p1.1.m1.1.1.3" xref="Sx1.I2.i6.p1.1.m1.1.1.3.cmml"><msub id="Sx1.I2.i6.p1.1.m1.1.1.3.2" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2.cmml"><mi id="Sx1.I2.i6.p1.1.m1.1.1.3.2.2" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2.2.cmml">A</mi><mn id="Sx1.I2.i6.p1.1.m1.1.1.3.2.3" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="Sx1.I2.i6.p1.1.m1.1.1.3.1" xref="Sx1.I2.i6.p1.1.m1.1.1.3.1.cmml">×</mo><msub id="Sx1.I2.i6.p1.1.m1.1.1.3.3" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3.cmml"><mi id="Sx1.I2.i6.p1.1.m1.1.1.3.3.2" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3.2.cmml">B</mi><mn id="Sx1.I2.i6.p1.1.m1.1.1.3.3.3" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.I2.i6.p1.1.m1.1b"><apply id="Sx1.I2.i6.p1.1.m1.1.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1"><eq id="Sx1.I2.i6.p1.1.m1.1.1.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.1"></eq><apply id="Sx1.I2.i6.p1.1.m1.1.1.2.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx1.I2.i6.p1.1.m1.1.1.2.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx1.I2.i6.p1.1.m1.1.1.2.2.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.2.2">𝑉</ci><ci id="Sx1.I2.i6.p1.1.m1.1.1.2.3.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.2.3">𝑏</ci></apply><apply id="Sx1.I2.i6.p1.1.m1.1.1.3.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3"><times id="Sx1.I2.i6.p1.1.m1.1.1.3.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.1"></times><apply id="Sx1.I2.i6.p1.1.m1.1.1.3.2.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx1.I2.i6.p1.1.m1.1.1.3.2.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="Sx1.I2.i6.p1.1.m1.1.1.3.2.2.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2.2">𝐴</ci><cn type="integer" id="Sx1.I2.i6.p1.1.m1.1.1.3.2.3.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.2.3">1</cn></apply><apply id="Sx1.I2.i6.p1.1.m1.1.1.3.3.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx1.I2.i6.p1.1.m1.1.1.3.3.1.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="Sx1.I2.i6.p1.1.m1.1.1.3.3.2.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3.2">𝐵</ci><cn type="integer" id="Sx1.I2.i6.p1.1.m1.1.1.3.3.3.cmml" xref="Sx1.I2.i6.p1.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I2.i6.p1.1.m1.1c">V_{b}=A_{1}\times B_{1}</annotation></semantics></math> and sends it to the server.</span>
</span></span>
</span>
</span>
</section>
</span>
</div>
<div id="S3.SS2.SSS2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.p3.1" class="ltx_p">We have <math id="S3.SS2.SSS2.p3.1.m1.2" class="ltx_Math" alttext="\mathbf{AB}=AMM^{-1}B=\begin{pmatrix}A_{1}&amp;A_{2}\end{pmatrix}\begin{pmatrix}B_{1}\\
B_{2}\end{pmatrix}=V_{a}+V_{b}" display="inline"><semantics id="S3.SS2.SSS2.p3.1.m1.2a"><mrow id="S3.SS2.SSS2.p3.1.m1.2.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.3.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.2.cmml">𝐀𝐁</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.3.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.3.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.3.4" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.3.4.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.1.m1.2.3.4.1" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.1.cmml">​</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.3.4.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.1.m1.2.3.4.1a" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.1.cmml">​</mo><msup id="S3.SS2.SSS2.p3.1.m1.2.3.4.4" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.2.cmml">M</mi><mrow id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3a" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.cmml">−</mo><mn id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.1.m1.2.3.4.1b" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.1.cmml">​</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.3.4.5" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.5.cmml">B</mi></mrow><mo id="S3.SS2.SSS2.p3.1.m1.2.3.5" xref="S3.SS2.SSS2.p3.1.m1.2.3.5.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.3.6" xref="S3.SS2.SSS2.p3.1.m1.2.3.6.cmml"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.1.1.3.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.1.cmml">(</mo><mtable columnspacing="5pt" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml"><mtr id="S3.SS2.SSS2.p3.1.m1.1.1.1.1a" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml"><mtd id="S3.SS2.SSS2.p3.1.m1.1.1.1.1b" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2.cmml">A</mi><mn id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3.cmml">1</mn></msub></mtd><mtd id="S3.SS2.SSS2.p3.1.m1.1.1.1.1c" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.2.cmml">A</mi><mn id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.3.cmml">2</mn></msub></mtd></mtr></mtable><mo id="S3.SS2.SSS2.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.1.m1.2.3.6.1" xref="S3.SS2.SSS2.p3.1.m1.2.3.6.1.cmml">​</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.2.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.2.2.3.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.cmml">(</mo><mtable rowspacing="0pt" id="S3.SS2.SSS2.p3.1.m1.2.2.1.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml"><mtr id="S3.SS2.SSS2.p3.1.m1.2.2.1.1a" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml"><mtd id="S3.SS2.SSS2.p3.1.m1.2.2.1.1b" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.2.cmml">B</mi><mn id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub></mtd></mtr><mtr id="S3.SS2.SSS2.p3.1.m1.2.2.1.1c" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml"><mtd id="S3.SS2.SSS2.p3.1.m1.2.2.1.1d" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.2.cmml">B</mi><mn id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.3.cmml">2</mn></msub></mtd></mtr></mtable><mo id="S3.SS2.SSS2.p3.1.m1.2.2.3.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p3.1.m1.2.3.7" xref="S3.SS2.SSS2.p3.1.m1.2.3.7.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.3.8" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.2.3.8.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2.3.cmml">a</mi></msub><mo id="S3.SS2.SSS2.p3.1.m1.2.3.8.1" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.1.cmml">+</mo><msub id="S3.SS2.SSS2.p3.1.m1.2.3.8.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.2" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3.2.cmml">V</mi><mi id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.3" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3.3.cmml">b</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.2b"><apply id="S3.SS2.SSS2.p3.1.m1.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"><and id="S3.SS2.SSS2.p3.1.m1.2.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"></and><apply id="S3.SS2.SSS2.p3.1.m1.2.3b.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"><eq id="S3.SS2.SSS2.p3.1.m1.2.3.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.3"></eq><ci id="S3.SS2.SSS2.p3.1.m1.2.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.2">𝐀𝐁</ci><apply id="S3.SS2.SSS2.p3.1.m1.2.3.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4"><times id="S3.SS2.SSS2.p3.1.m1.2.3.4.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.1"></times><ci id="S3.SS2.SSS2.p3.1.m1.2.3.4.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.2">𝐴</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.3.4.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.3">𝑀</ci><apply id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.2">𝑀</ci><apply id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3"><minus id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3"></minus><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.4.3.2">1</cn></apply></apply><ci id="S3.SS2.SSS2.p3.1.m1.2.3.4.5.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.4.5">𝐵</ci></apply></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.3c.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"><eq id="S3.SS2.SSS2.p3.1.m1.2.3.5.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.5"></eq><share href="#S3.SS2.SSS2.p3.1.m1.2.3.4.cmml" id="S3.SS2.SSS2.p3.1.m1.2.3d.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"></share><apply id="S3.SS2.SSS2.p3.1.m1.2.3.6.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.6"><times id="S3.SS2.SSS2.p3.1.m1.2.3.6.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.6.1"></times><apply id="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3.1">matrix</csymbol><matrix id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1"><matrixrow id="S3.SS2.SSS2.p3.1.m1.1.1.1.1a.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.2">𝐴</ci><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.2">𝐴</ci><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.1.3">2</cn></apply></matrixrow></matrix></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.3"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.3.1">matrix</csymbol><matrix id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1"><matrixrow id="S3.SS2.SSS2.p3.1.m1.2.2.1.1a.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1"><apply id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.1.1.1.3">1</cn></apply></matrixrow><matrixrow id="S3.SS2.SSS2.p3.1.m1.2.2.1.1b.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1"><apply id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.1.1.2.1.1.3">2</cn></apply></matrixrow></matrix></apply></apply></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.3e.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"><eq id="S3.SS2.SSS2.p3.1.m1.2.3.7.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.7"></eq><share href="#S3.SS2.SSS2.p3.1.m1.2.3.6.cmml" id="S3.SS2.SSS2.p3.1.m1.2.3f.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3"></share><apply id="S3.SS2.SSS2.p3.1.m1.2.3.8.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8"><plus id="S3.SS2.SSS2.p3.1.m1.2.3.8.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.1"></plus><apply id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.3.8.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.2.3">𝑎</ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3.2">𝑉</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.3.8.3.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.3.8.3.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.2c">\mathbf{AB}=AMM^{-1}B=\begin{pmatrix}A_{1}&amp;A_{2}\end{pmatrix}\begin{pmatrix}B_{1}\\
B_{2}\end{pmatrix}=V_{a}+V_{b}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS2.p4" class="ltx_para">
<p id="S3.SS2.SSS2.p4.3" class="ltx_p">Secure calculation is possible as no party has sufficient information to reconstruct the original dataset with only some of the submatrices. More concretely, it can be seen that as long as sites only share half of their encoded matrices (<math id="S3.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="A_{1}" display="inline"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><msub id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml">A</mi><mn id="S3.SS2.SSS2.p4.1.m1.1.1.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><apply id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">𝐴</ci><cn type="integer" id="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">A_{1}</annotation></semantics></math> and <math id="S3.SS2.SSS2.p4.2.m2.1" class="ltx_Math" alttext="B_{2}" display="inline"><semantics id="S3.SS2.SSS2.p4.2.m2.1a"><msub id="S3.SS2.SSS2.p4.2.m2.1.1" xref="S3.SS2.SSS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p4.2.m2.1.1.2" xref="S3.SS2.SSS2.p4.2.m2.1.1.2.cmml">B</mi><mn id="S3.SS2.SSS2.p4.2.m2.1.1.3" xref="S3.SS2.SSS2.p4.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.2.m2.1b"><apply id="S3.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.SSS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.2.m2.1c">B_{2}</annotation></semantics></math>) there remains an infinite number of solutions to the problem. The method relies on the construction of a secure matrix <math id="S3.SS2.SSS2.p4.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.SSS2.p4.3.m3.1a"><mi id="S3.SS2.SSS2.p4.3.m3.1.1" xref="S3.SS2.SSS2.p4.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.3.m3.1b"><ci id="S3.SS2.SSS2.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.3.m3.1c">M</annotation></semantics></math>. This matrix can be generated using maximum distance separable (MDS) codes such as Reed-Solomon codes<cite class="ltx_cite ltx_citemacro_cite">Du et al. (<a href="#bib.bib5" title="" class="ltx_ref">2004</a>)</cite> . MDS codes ensure that any subset of columns are linearly independent of each other making it impossible to recover the original data. For a more detailed introduction on MDS codes please see <cite class="ltx_cite ltx_citemacro_cite">MacWilliams and Sloane (<a href="#bib.bib21" title="" class="ltx_ref">1977</a>)</cite>. Note that all embeddings were first L2-normalized prior to calculating the dot product so this product is equivalent to cosine similarity. In our case, we conduct pairwise calculation of cosine similarity between sites and concatenate these together to construct the final similarity matrix across all patients.</p>
</div>
</section>
<section id="Sx1.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Clustering patients</h4>

<div id="Sx1.SS2.SSS3.p1" class="ltx_para">
<p id="Sx1.SS2.SSS3.p1.1" class="ltx_p">We employed spectral clustering to cluster patients using the cosine similarity matrix. Spectral clustering is suited to this task as it utilizes the similarity matrix’s global structure to capture complex relationships (<cite class="ltx_cite ltx_citemacro_cite">von Luxburg (<a href="#bib.bib35" title="" class="ltx_ref">2007</a>)</cite>). We used the elbow method to determine the optimal number of clusters. For this, we first calculated the Within-Cluster-Sum-of-Squares (WCSS) for clusters 1-10 (see Supplement: Appendix A.1 WCSS). WCSS is a metric to measure the compactness of the clusters. We selected the ‘elbow’ point of the plot after which additional clusters do not lead to substantial improvements in WCSS (<em id="Sx1.SS2.SSS3.p1.1.1" class="ltx_emph ltx_font_italic">i.e.,</em> compactness of the clusters). This is a heuristic that determines the minimum number of clusters necessary to account for the majority of the variance in the dataset (<cite class="ltx_cite ltx_citemacro_cite">Madhulatha (<a href="#bib.bib22" title="" class="ltx_ref">2012</a>)</cite>). A smaller WCSS implies that the data points are more compact, indicating tighter clustering of similar points. We assessed a range of clusters between 1 to 10 and ultimately choose 3 (Supplementary Figure 1).</p>
</div>
</section>
<section id="Sx1.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.4 </span>Predicting mortality</h4>

<div id="Sx1.SS2.SSS4.p1" class="ltx_para">
<p id="Sx1.SS2.SSS4.p1.1" class="ltx_p">We trained a FeedForward neural network with 3 input heads and a classification module. Each input head processes a feature domain into a 5-dimensional representation. These representations are concatenated and fed through the classification module to generate predictions. The multihead structure integrates distinct data domains more effectively by first processing each type separately before combining them for prediction. We followed a similar training algorithm as FedAvg, but we trained a model on each cluster separately. That is, the server initializes a separate model for each cluster and each site trains a cluster model only on the patients in that respective cluster. Weights were aggregated based on each site’s sample size for that cluster (Figure 1D).</p>
</div>
</section>
</section>
<section id="Sx1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Other models</h3>

<div id="Sx1.SS3.p1" class="ltx_para">
<p id="Sx1.SS3.p1.1" class="ltx_p">We evaluated the performance gain from PCBFL against other training methods including: single site, centralized, FedAvg and CBFL. Single site training refers to the average performance of each site if it were to train a model separately. Centralized training refers to the performance of a model trained on all data together as if it were one site. Centralized training performance is the gold-standard benchmark hoped to be achieved by FL. FedAvg refers to standard Federated Averaging procedure, which aggregates model parameters based on sample size in each site. CBFL refers to the community based clustering procedure described by <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite> that uses K-means clustering on average hospital embeddings. The generated clusters were sent to each site to assign a cluster to each patient. Models are then trained separately for each cluster. Note that the major difference between CBFL and PCBFL is in the clustering approach; CBFL uses average site embeddings while PCBFL enables privacy-preserving clustering of patients based on individual patient embeddings.</p>
</div>
</section>
<section id="Sx1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Model training</h3>

<div id="Sx1.SS4.p1" class="ltx_para">
<p id="Sx1.SS4.p1.1" class="ltx_p">We implemented the feedforward models with ReLU activation in the hidden layers and a sigmoid activation in the final output layer. We employed Binary Cross Entropy loss. All feedforward models were trained using the same hyperparameters: an Adam optimizer with a learning rate of 1<math id="Sx1.SS4.p1.1.m1.1" class="ltx_Math" alttext="e^{-3}" display="inline"><semantics id="Sx1.SS4.p1.1.m1.1a"><msup id="Sx1.SS4.p1.1.m1.1.1" xref="Sx1.SS4.p1.1.m1.1.1.cmml"><mi id="Sx1.SS4.p1.1.m1.1.1.2" xref="Sx1.SS4.p1.1.m1.1.1.2.cmml">e</mi><mrow id="Sx1.SS4.p1.1.m1.1.1.3" xref="Sx1.SS4.p1.1.m1.1.1.3.cmml"><mo id="Sx1.SS4.p1.1.m1.1.1.3a" xref="Sx1.SS4.p1.1.m1.1.1.3.cmml">−</mo><mn id="Sx1.SS4.p1.1.m1.1.1.3.2" xref="Sx1.SS4.p1.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx1.SS4.p1.1.m1.1b"><apply id="Sx1.SS4.p1.1.m1.1.1.cmml" xref="Sx1.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx1.SS4.p1.1.m1.1.1.1.cmml" xref="Sx1.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="Sx1.SS4.p1.1.m1.1.1.2.cmml" xref="Sx1.SS4.p1.1.m1.1.1.2">𝑒</ci><apply id="Sx1.SS4.p1.1.m1.1.1.3.cmml" xref="Sx1.SS4.p1.1.m1.1.1.3"><minus id="Sx1.SS4.p1.1.m1.1.1.3.1.cmml" xref="Sx1.SS4.p1.1.m1.1.1.3"></minus><cn type="integer" id="Sx1.SS4.p1.1.m1.1.1.3.2.cmml" xref="Sx1.SS4.p1.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SS4.p1.1.m1.1c">e^{-3}</annotation></semantics></math> for all models and batch size of 32. For all federated training methods, we used 20 training rounds with 10 epochs per round. For all central models, we used 200 epochs. This kept the training epochs consistent across all models.</p>
</div>
</section>
<section id="Sx1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Evaluation</h3>

<section id="Sx1.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1 </span>Cohort analysis for clustered FL algorithms</h4>

<div id="Sx1.SS5.SSS1.p1" class="ltx_para">
<p id="Sx1.SS5.SSS1.p1.1" class="ltx_p">We examined the clusters generated by PCBFL and CBFL by comparing patients’ mortality and feature distributions between clusters. We used one-way ANOVA testing for continuous variables and Negative Binomial testing for count variables to determine statistical significance. We chose Negative Binomial over Poisson to account for the overdispersion in the count data (<cite class="ltx_cite ltx_citemacro_cite">Hilbe (<a href="#bib.bib14" title="" class="ltx_ref">2011</a>)</cite>). A p value of <math id="Sx1.SS5.SSS1.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="Sx1.SS5.SSS1.p1.1.m1.1a"><mo id="Sx1.SS5.SSS1.p1.1.m1.1.1" xref="Sx1.SS5.SSS1.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="Sx1.SS5.SSS1.p1.1.m1.1b"><lt id="Sx1.SS5.SSS1.p1.1.m1.1.1.cmml" xref="Sx1.SS5.SSS1.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SS5.SSS1.p1.1.m1.1c">&lt;</annotation></semantics></math>0.05 with Bonferroni correction was used to determine statistical significant differences between clusters. We also examined whether the clusters generated by PCBFL and CBFL capture the regional distribution of hospitals. We grouped hospitals by region as defined by eICU Collaborative Research Dataset (Midwest, Northeast, South, West) and conducted a chi-squared test examining the relationship between region and cluster distribution.</p>
</div>
</section>
<section id="Sx1.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2 </span>Prediction task</h4>

<div id="Sx1.SS5.SSS2.p1" class="ltx_para">
<p id="Sx1.SS5.SSS2.p1.1" class="ltx_p">Data was randomly split into training and testing datasets in a 70:30 ratio. Since only 20% of the labels were positive, we evaluated performance with both AUC and AUPRC scores. We ran the models for 100 times and calculated the mean scores and bootstrapped estimates (1000 iterations) of the 95% confidence intervals. We calculated the overall performance of a protocol as the weighted average of individual site scores. This weighting accounts for the number of samples used in model development at each site. For the cases of Single Site and FedAvg, where each site trains one model and has the same number of patients, this is a simple average. In the cases of CBFL and PCBFL, where sites train three separate models, the weighting is based on the proportion of patients that belong to the site and cluster (see Supplement: Appendix B. Calculating overall performance). We also compared the performance of the models at each site to determine if there are sites that fail to benefit from FL, or PCBFL in particular. This is important as we wanted to ensure that all sites benefit from FL to incentivize FL collaboration <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>. All code was written in Python 3.9.7 and Pytorch 1.12.1 and is available on GitHub https://github.com/G2Lab/pcfbl.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>PCBFL provides privacy-preserving and accurate patient similarity scores using Secure MultiParty Computation</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">We first evaluated whether the use of SMPC affects the accuracy of the patient similarity scores calculated using cosine similarity. This was done by comparing PCBFL results to the results of a plaintext and centralized calculation (referred to as True). The root mean squared error between the True and privacy-preserving scores was <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><lt id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">&lt;</annotation></semantics></math>5<math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="x10^{-11}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">​</mo><msup id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mn id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml"><mo id="S4.SS1.p1.2.m2.1.1.3.3a" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p1.2.m2.1.1.3.3.2" xref="S4.SS1.p1.2.m2.1.1.3.3.2.cmml">11</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑥</ci><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">10</cn><apply id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3"><minus id="S4.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2">11</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">x10^{-11}</annotation></semantics></math>, indicating that the protocol is highly accurate. Figure 2 displays the comparison of the True cosine similarity scores and privacy-preserving cosine similarity scores, where each point represents a pairwise comparison of two patients. The graph demonstrates that the SMPC protocol accurately calculates the cosine similarity between patients’ embeddings at all ranges.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2307.08847/assets/smpc_acc.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.2.1" class="ltx_text ltx_font_bold">Comparison of cosine similarity scores</span> calculated using PCBFL’s SMPC protocol and a plaintext centralized truth (True). Each point is a cosine similarity score between 2 patient embeddings.
</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>PCBFL provides clinically meaningful clusters</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We examined the clusters determined by PCBFL in terms of their mortality and physical examination scores (Table 1). The resulting three clusters were found to correspond to three distinct levels of severity based on both true mortality rates and physical examination scores.The high risk group was more likely to have higher mortality, lower GCS, higher age and worse vital sign measurements (p <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mo id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><lt id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">&lt;</annotation></semantics></math> 0.005). In contrast, an examination of CBFL did not yield distinct clinical severity groups, with only significant differences in age and RR. Full mortality and physical examination feature distributions of PCBFL and CBFL clusters are shown in Supplementary Tables 2 and 3, respectively (Appendix F).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We also compared the distribution of diagnosis counts across clusters and found that conditions indicative of severe disease are more likely to occur in the high-risk group (Table 2, see Methods 3.5.1 for statistical tests used). Overall, we identified 28 out of 483 diagnoses that were more likely to occur in the high risk group (p<math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mo id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><lt id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">&lt;</annotation></semantics></math>0.0001). These included clinically relevant diagnoses for cardiovascular disease, respiratory disease, renal disease, infectious disease, metabolic disorders, hematological disorders, and nutritional disorders. A similar analysis on CBFL clusters yielded no statistically significant differences in diagnosis counts. Full diagnosis feature distributions of PCBFL and CBFL clusters are shown in Supplementary Tables 4 and 5, respectively (Appendix F).</p>
</div>
<figure id="S4.T1" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Outcome and physical examination distribution for 3 clusters identified by PCBFL</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.T1.8" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.8.9.1" class="ltx_tr">
<th id="S4.T1.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.8.9.1.1.1" class="ltx_text ltx_font_bold">PCBFL clusters:</span></th>
<th id="S4.T1.8.9.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.8.9.1.2.1" class="ltx_text ltx_font_bold">Low</span></th>
<th id="S4.T1.8.9.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.8.9.1.3.1" class="ltx_text ltx_font_bold">Medium</span></th>
<th id="S4.T1.8.9.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.8.9.1.4.1" class="ltx_text ltx_font_bold">High</span></th>
<th id="S4.T1.8.9.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.8.9.1.5.1" class="ltx_text ltx_font_bold">p-value</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.2.1" class="ltx_text ltx_font_bold">Mortality</span></td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_left ltx_border_t">11.7%</td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_align_left ltx_border_t">20.8%</td>
<td id="S4.T1.1.1.5" class="ltx_td ltx_align_left ltx_border_t">26.3%</td>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_t">
<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><lt id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_left"><span id="S4.T1.2.2.2.1" class="ltx_text ltx_font_bold">GCS</span></td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_left">13.1</td>
<td id="S4.T1.2.2.4" class="ltx_td ltx_align_left">12.7</td>
<td id="S4.T1.2.2.5" class="ltx_td ltx_align_left">12.5</td>
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_left">
<math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><mo id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><lt id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_left"><span id="S4.T1.3.3.2.1" class="ltx_text ltx_font_bold">Age</span></td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_left">55.4</td>
<td id="S4.T1.3.3.4" class="ltx_td ltx_align_left">67.8</td>
<td id="S4.T1.3.3.5" class="ltx_td ltx_align_left">69.2</td>
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_left">
<math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><mo id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><lt id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_left"><span id="S4.T1.4.4.2.1" class="ltx_text ltx_font_bold">HR</span></td>
<td id="S4.T1.4.4.3" class="ltx_td ltx_align_left">86.7</td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_left">89.1</td>
<td id="S4.T1.4.4.5" class="ltx_td ltx_align_left">92.6</td>
<td id="S4.T1.4.4.1" class="ltx_td ltx_align_left">
<math id="S4.T1.4.4.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mo id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><lt id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.5.5" class="ltx_tr">
<td id="S4.T1.5.5.2" class="ltx_td ltx_align_left"><span id="S4.T1.5.5.2.1" class="ltx_text ltx_font_bold">SBP</span></td>
<td id="S4.T1.5.5.3" class="ltx_td ltx_align_left">127.0</td>
<td id="S4.T1.5.5.4" class="ltx_td ltx_align_left">118.0</td>
<td id="S4.T1.5.5.5" class="ltx_td ltx_align_left">116.1</td>
<td id="S4.T1.5.5.1" class="ltx_td ltx_align_left">
<math id="S4.T1.5.5.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.5.5.1.m1.1a"><mo id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><lt id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<td id="S4.T1.6.6.2" class="ltx_td ltx_align_left"><span id="S4.T1.6.6.2.1" class="ltx_text ltx_font_bold">RR</span></td>
<td id="S4.T1.6.6.3" class="ltx_td ltx_align_left">20.2</td>
<td id="S4.T1.6.6.4" class="ltx_td ltx_align_left">20.1</td>
<td id="S4.T1.6.6.5" class="ltx_td ltx_align_left">21.4</td>
<td id="S4.T1.6.6.1" class="ltx_td ltx_align_left">
<math id="S4.T1.6.6.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.6.6.1.m1.1a"><mo id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><lt id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
<tr id="S4.T1.8.8" class="ltx_tr">
<td id="S4.T1.7.7.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.7.7.1.1" class="ltx_text ltx_font_bold">O<sub id="S4.T1.7.7.1.1.1" class="ltx_sub"><span id="S4.T1.7.7.1.1.1.1" class="ltx_text ltx_font_medium">2</span></sub>%</span></td>
<td id="S4.T1.8.8.3" class="ltx_td ltx_align_left ltx_border_bb">97.2</td>
<td id="S4.T1.8.8.4" class="ltx_td ltx_align_left ltx_border_bb">96.3</td>
<td id="S4.T1.8.8.5" class="ltx_td ltx_align_left ltx_border_bb">96.1</td>
<td id="S4.T1.8.8.2" class="ltx_td ltx_align_left ltx_border_bb">
<math id="S4.T1.8.8.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.8.8.2.m1.1a"><mo id="S4.T1.8.8.2.m1.1.1" xref="S4.T1.8.8.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.2.m1.1b"><lt id="S4.T1.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.2.m1.1c">&lt;</annotation></semantics></math>0.005*</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.T1.9" class="ltx_p ltx_figure_panel ltx_align_center">* statistically significant</p>
</div>
</div>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">We performed the same comparison for the distribution of medication counts between clusters and found 154 drugs out of 1,056 that differed between clusters. Specifically, 45 and 109 in drugs were more likely to be prescribed in the high and medium risk groups, respectively (p<math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mo id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><lt id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">&lt;</annotation></semantics></math>5<math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="e^{-5}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">e</mi><mrow id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml"><mo id="S4.SS2.p3.2.m2.1.1.3a" xref="S4.SS2.p3.2.m2.1.1.3.cmml">−</mo><mn id="S4.SS2.p3.2.m2.1.1.3.2" xref="S4.SS2.p3.2.m2.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝑒</ci><apply id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3"><minus id="S4.SS2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.3"></minus><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">e^{-5}</annotation></semantics></math>). Same analysis for CBFL clusters resulted in 48 out of 1,056 drugs that differed between clusters. Full medication count distributions of PCBFL and CBFL clusters are shown in Supplementary Tables 6 and 7, respectively (Appendix F). Finally, comparing the distribution of clusters by region showed that PCBFL clusters are not associated with region (p=0.10) but CBFL clusters are (p¡1<math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="e^{-3}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msup id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">e</mi><mrow id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml"><mo id="S4.SS2.p3.3.m3.1.1.3a" xref="S4.SS2.p3.3.m3.1.1.3.cmml">−</mo><mn id="S4.SS2.p3.3.m3.1.1.3.2" xref="S4.SS2.p3.3.m3.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝑒</ci><apply id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3"><minus id="S4.SS2.p3.3.m3.1.1.3.1.cmml" xref="S4.SS2.p3.3.m3.1.1.3"></minus><cn type="integer" id="S4.SS2.p3.3.m3.1.1.3.2.cmml" xref="S4.SS2.p3.3.m3.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">e^{-3}</annotation></semantics></math>). See Supplementary Table 1 (Appendix C) for the full cluster distribution breakdown by region.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Conditions more likely to occur in PCBFL high-risk group</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1" class="ltx_tr">
<th id="S4.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.2.1" class="ltx_text ltx_font_bold">Category</span></th>
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold">Condition more likely to occur (p <math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><lt id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">&lt;</annotation></semantics></math> 0.0001)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<td id="S4.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.2.1.1.1" class="ltx_text ltx_font_bold">Cardiovascular</span></td>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">Atrial Fibrillation and Flutter, Congestive Heart Failure,</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<td id="S4.T2.1.3.2.1" class="ltx_td"></td>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_left">Hypertension, Tachycardia</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<td id="S4.T2.1.4.3.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.4.3.1.1" class="ltx_text ltx_font_bold">Respiratory</span></td>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_left">Asphyxia and Hypoxemia, Obstructive Chronic Bronchitis,</td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<td id="S4.T2.1.5.4.1" class="ltx_td"></td>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_left">Paralysis of Vocal Cords or Larynx</td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<td id="S4.T2.1.6.5.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.6.5.1.1" class="ltx_text ltx_font_bold">Renal</span></td>
<td id="S4.T2.1.6.5.2" class="ltx_td ltx_align_left">Acute Kidney Failure, Chronic Kidney Disease, Cystitis</td>
</tr>
<tr id="S4.T2.1.7.6" class="ltx_tr">
<td id="S4.T2.1.7.6.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.7.6.1.1" class="ltx_text ltx_font_bold">Infectious</span></td>
<td id="S4.T2.1.7.6.2" class="ltx_td ltx_align_left">Septicemia, Fever</td>
</tr>
<tr id="S4.T2.1.8.7" class="ltx_tr">
<td id="S4.T2.1.8.7.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.8.7.1.1" class="ltx_text ltx_font_bold">Metabolic</span></td>
<td id="S4.T2.1.8.7.2" class="ltx_td ltx_align_left">Abnormal Blood Chemistry, Acidosis, Disorders of Magnesium Metabolism,</td>
</tr>
<tr id="S4.T2.1.9.8" class="ltx_tr">
<td id="S4.T2.1.9.8.1" class="ltx_td"></td>
<td id="S4.T2.1.9.8.2" class="ltx_td ltx_align_left">Hyperlipidemia, Hyperpotassemia, Hypothyroidism, Obesity</td>
</tr>
<tr id="S4.T2.1.10.9" class="ltx_tr">
<td id="S4.T2.1.10.9.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.10.9.1.1" class="ltx_text ltx_font_bold">Hematologic</span></td>
<td id="S4.T2.1.10.9.2" class="ltx_td ltx_align_left">Anemia, Coagulation Defects, Disease of White Blood Cells,</td>
</tr>
<tr id="S4.T2.1.11.10" class="ltx_tr">
<td id="S4.T2.1.11.10.1" class="ltx_td"></td>
<td id="S4.T2.1.11.10.2" class="ltx_td ltx_align_left">Thrombocytopenia</td>
</tr>
<tr id="S4.T2.1.12.11" class="ltx_tr">
<td id="S4.T2.1.12.11.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T2.1.12.11.1.1" class="ltx_text ltx_font_bold">Nutritional</span></td>
<td id="S4.T2.1.12.11.2" class="ltx_td ltx_align_left ltx_border_bb">Protein-calorie Malnutrition, Dehydration</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>PCBL increases predictive performance of federated learning </h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Next, we evaluated performance on the mortality prediction task. Table 3 shows the global AUC and AUPRC scores of model training for Single site, Centralized, FedAvg, CBFL and PCBFL. PCBFL achieves statistically significant improvements against Single site, FedAvg and CBFL. Compared to CBFL and FedAvg, PCBFL improves mean AUC by 4.4% (3.0-5.5% at 95% CI) and 4.2% (2.8-5.8% at 95% CI) and AUPRC by 7.3% (3.4-11.6% at 95% CI) and 8.4% (3.4-13.8% at 95% CI) , respectively. Figures 3a and 3b show global AUC and AUPRC scores for each model. Note that we calculated average per site performance for FedAvg and Single site training, while performance was measured as a weighted average of per cluster and site performance for CBFL and PCBFL (see Supplement Appendix B for definitions).</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span id="S4.F3.3" class="ltx_ERROR ltx_figure_panel undefined">\floatconts</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.F3.2" class="ltx_p ltx_figure_panel">fig:example2<span id="S4.F3.2.1" class="ltx_ERROR undefined">\subfigure</span><img src="/html/2307.08847/assets/AUC-1.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="293" height="235" alt="Refer to caption">
 <span id="S4.F3.2.2" class="ltx_ERROR undefined">\subfigure</span><img src="/html/2307.08847/assets/AUPRC-1.png" id="S4.F3.2.g2" class="ltx_graphics ltx_img_landscape" width="293" height="235" alt="Refer to caption"></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.5.1" class="ltx_text ltx_font_bold">Performance by model type</span>, AUC (a) and AUPRC (b) for Single, Centralized, FedAvg, CBFL and PCBFL.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>PCBFL enables better predictive performance at most sites</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Figure 4 shows the number of sites where each model has the highest performance. We compared Single site, FedAvg, CBFL and PCBFL at 20 sites. Centralized training was not compared as there are no per-site results. PCBFL performs best at 12 and 9 sites in terms of AUC and AUPRC, respectively. Figure 5 shows the AUC scores for each site and cluster (see Supplementary Figure 2 for AUPRC). PCBFL outperforms single site training at 16 and 18 sites, FedAvg at 14 and 14 sites, and CBFL at 13 and 13 sites for AUC and AUPRC, respectively.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span id="S4.F4.3" class="ltx_ERROR ltx_figure_panel undefined">\floatconts</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.F4.2" class="ltx_p ltx_figure_panel">fig:example2<span id="S4.F4.2.1" class="ltx_ERROR undefined">\subfigure</span><img src="/html/2307.08847/assets/AUC_site_perf-1.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="293" height="235" alt="Refer to caption">
 <span id="S4.F4.2.2" class="ltx_ERROR undefined">\subfigure</span><img src="/html/2307.08847/assets/AUPRC_site_perf-1.png" id="S4.F4.2.g2" class="ltx_graphics ltx_img_landscape" width="293" height="235" alt="Refer to caption"></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.5.1" class="ltx_text ltx_font_bold">Number of sites where model has highest</span> AUC (a) and AUPRC (b) for Single, Centralized, FedAvg, CBFL and PCBFL.</figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span id="S4.F5.2" class="ltx_ERROR ltx_figure_panel undefined">\floatconts</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.F5.1" class="ltx_p ltx_figure_panel">fig:example2<img src="/html/2307.08847/assets/AUC_site-1.png" id="S4.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="384" alt="Refer to caption"></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.4.1" class="ltx_text ltx_font_bold">Model performance by site</span>, AUC. Results for Single, FedAvg, CBFL and PCBFL.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We present a new personalized FL framework based on privacy-preserving patient clustering (PCBFL). We show that this algorithm enables better performance in a downstream mortality prediction task across 20 ICU datasets when compared to traditional FL and existing Clustered FL techniques. Furthermore, per site analysis shows that PCBFL is most likely to achieve best performance at any given site. PCBFL also generates clinically meaningful clusters categorizing patients into low, medium, and high mortality risk groups based on physical exam, diagnosis, and medication values. Our results show that PCBFL can be used to implement personalized FL, addressing the challenges of non-IID EHR data and patient privacy by securely clustering patients and optimizing model performance on each cluster. The ability to generate clinically meaningful subgroups suggests PCBFL can be extended to other clinical use cases such as phenotyping, risk stratification, and advancing disease understanding.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We demonstrated that PCBFL is able to generate clinically meaningful groups that were categorized mostly based on patient severity. This is in contrast to CBFL, which has been shown to cluster patients based on geographical distribution of the hospitals (<cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>). PCBFL also enables clustering over a very large number of sites and patients and is able to do so without introducing error into the calculation. These findings suggest that PCBFL can be extended to support the discovery of novel subgroups without the need for a prediction task (<span id="S5.p2.1.1" class="ltx_text ltx_font_italic">e.g.,</span> unsupervised phenotyping, risk stratification, disease subtyping, treatment selection, and trial recruitment) (<cite class="ltx_cite ltx_citemacro_cite">Robinson (<a href="#bib.bib30" title="" class="ltx_ref">2012</a>)</cite>). Previous studies have shown success of clustering patients in centralized settings and we believe it can now be extended to the federated settings (<cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2020</a>); Zeng et al. (<a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>). Overall, our study highlights the potential of PCBFL as a powerful tool for collaborative analysis of healthcare data.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">We also found that PCBFL demonstrates a meaningful improvement in global performance compared to traditional FL frameworks (FedAvg) and other personalized FL frameworks (CBFL). We believe this improvement can be attributed to our clustering technique, which is able to divide the federated datasets into more IID cohorts by using patient similarity scores between individual patients. This likely improves the performance of the downstream tasks by reducing the impact of site-specific biases and allowing the model to focus on cohort-specific features necessary for predictions. As a result, it has the potential to improve the generalizability of the models (<cite class="ltx_cite ltx_citemacro_cite">Prayitno et al. (<a href="#bib.bib28" title="" class="ltx_ref">2021</a>); Fallah et al. (<a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>). Moreover, we found that PCBFL has the best per-site performance compared to other methods, which increases motivation for sites to participate in federated learning (<cite class="ltx_cite ltx_citemacro_cite">Cho et al. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>).</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Limitations:</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">PCBFL has some limitations. First, it relies on sufficient sample sizes per cluster, which can be an issue in cases where sites have limited datasets. However, given the improved performance against single site training, in cases where sufficient samples are available, clustering should be preferred. Second, the secure clustering algorithm requires pairwise cosine similarity calculation across all sites. This results in additional communication costs as each pair of hospitals must use their own separate masking matrix and secret sharing protocols. A new secret sharing scheme with central server coordination can be developed that reuses secret shares across multiple calculations, thus reducing the communication cost. In addition, PCBFL requires training of two deep learning models and a clustering algorithm. As such, the communication cost is higher than traditional FL frameworks. However, we feel the trade-off between communication cost and improved model performance is acceptable in the context of healthcare, where higher accuracy is preferred over compute power. Finally, this analysis is limited to eICU dataset and a mortality prediction task. PCBFL should be assessed on a range of clinical prediction tasks and datasets to fully evaluate its performance.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We present a new personalized FL framework based on a novel privacy-preserving patient clustering algorithm (PCBFL) that addresses the challenge of non-IID data and patient privacy in federated settings. Our study demonstrates that PCBFL enables better model performance than existing methods in a mortality prediction task. We showed that the clustering technique used by PCBFL divides the federated datasets into clinically meaningful cohorts suggesting it can be extended to other phenotyping tasks. These findings highlight the potential of PCBFL as a powerful tool for collaborative analysis of healthcare data. In future work, we plan to explore the generalizability of PCBFL to other healthcare datasets and domains.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al. (2022)</span>
<span class="ltx_bibblock">
Y J Cho, D Jhunjhunwala, T Li, V Smith, and others.

</span>
<span class="ltx_bibblock">To federate or not to federate: Incentivizing client participation in
federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv</em>, 2022.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2016)</span>
<span class="ltx_bibblock">
Edward Choi, Mohammad Taha Bahadori, Andy Schuetz, Walter F Stewart, and Jimeng
Sun.

</span>
<span class="ltx_bibblock">Doctor AI: Predicting clinical events via recurrent neural
networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">JMLR Workshop Conf. Proc.</em>, 56:301–318, August 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dayan et al. (2021)</span>
<span class="ltx_bibblock">
Ittai Dayan, Holger R Roth, and Aoxiao et al. Zhong.

</span>
<span class="ltx_bibblock">Federated learning for predicting clinical outcomes in patients with
COVID-19.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Nat. Med.</em>, 27(10):1735–1743, September
2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2004)</span>
<span class="ltx_bibblock">
Wenliang Du, Yunghsiang S Han, and Shigang Chen.

</span>
<span class="ltx_bibblock">Privacy-Preserving multivariate statistical analysis: Linear
regression and classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2004 SIAM International Conference on
Data Mining (SDM)</em>, Proceedings, pages 222–233. Society for Industrial and
Applied Mathematics, April 2004.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork and Roth (2014)</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron Roth.

</span>
<span class="ltx_bibblock">The algorithmic foundations of differential privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Found. Trends Theor. Comput. Sci.</em>, 9(3–4):211–407, 2014.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Esteva et al. (2019)</span>
<span class="ltx_bibblock">
Andre Esteva, Alexandre Robicquet, Bharath Ramsundar, Volodymyr Kuleshov, Mark
DePristo, Katherine Chou, Claire Cui, Greg Corrado, Sebastian Thrun, and Jeff
Dean.

</span>
<span class="ltx_bibblock">A guide to deep learning in healthcare.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Nat. Med.</em>, 25(1):24–29, January 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et al. (2018)</span>
<span class="ltx_bibblock">
David Evans, Vladimir Kolesnikov, and Mike Rosulek.

</span>
<span class="ltx_bibblock">A pragmatic introduction to secure Multi-Party computation.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Privacy and
Security</em>, 2(2-3):70–246, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. (2020)</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning: A meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.07948</em>, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ficek et al. (2021)</span>
<span class="ltx_bibblock">
Joseph Ficek, Wei Wang, Henian Chen, Getachew Dagne, and Ellen Daley.

</span>
<span class="ltx_bibblock">Differential privacy in health research: A scoping review.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">J. Am. Med. Inform. Assoc.</em>, 28(10):2269–2276, September 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. (2020)</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan Chung, Dong Yin, and Kannan Ramchandran.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock">pages 19586–19597, June 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulshan et al. (2016)</span>
<span class="ltx_bibblock">
Varun Gulshan, Lily Peng, and Marc et al. Coram.

</span>
<span class="ltx_bibblock">Development and validation of a deep learning algorithm for detection
of diabetic retinopathy in retinal fundus photographs.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">JAMA</em>, 316(22):2402–2410, December 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely and Richtárik (2020)</span>
<span class="ltx_bibblock">
Filip Hanzely and Peter Richtárik.

</span>
<span class="ltx_bibblock">Federated learning of a mixture of global and local models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hilbe (2011)</span>
<span class="ltx_bibblock">
Joseph M Hilbe.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Negative Binomial Regression</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press, March 2011.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosseini et al. (2020)</span>
<span class="ltx_bibblock">
Mahan Hosseini, Michael Powell, John Collins, Chloe Callahan-Flintoft, William
Jones, Howard Bowman, and Brad Wyble.

</span>
<span class="ltx_bibblock">I tried a bunch of things: The dangers of unexpected overfitting in
classification of brain data.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Neuroscience &amp; Biobehavioral Reviews</em>, 119:456–467,
2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2019)</span>
<span class="ltx_bibblock">
Li Huang, Andrew L Shea, Huining Qian, Aditya Masurkar, Hao Deng, and Dianbo
Liu.

</span>
<span class="ltx_bibblock">Patient clustering improves efficiency of federated machine learning
to predict mortality and hospital stay time using distributed electronic
medical records.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">J. Biomed. Inform.</em>, 99:103291, November 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaissis et al. (2020)</span>
<span class="ltx_bibblock">
Georgios A Kaissis, Marcus R Makowski, Daniel Rückert, and Rickmer F
Braren.

</span>
<span class="ltx_bibblock">Secure, privacy-preserving and federated machine learning in medical
imaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Nature Machine Intelligence</em>, 2(6):305–311, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He.

</span>
<span class="ltx_bibblock">Federated learning on Non-IID data silos: An experimental study.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">2022 IEEE 38th International Conference on Data
Engineering (ICDE)</em>, pages 965–978. ieeexplore.ieee.org, May 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2018)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Maziar Sanjabi, Manzil Zaheer, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">On the convergence of federated optimization in heterogeneous
networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.06127</em>, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">MacWilliams and Sloane (1977)</span>
<span class="ltx_bibblock">
Florence Jessie MacWilliams and Neil James Alexander Sloane.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">The theory of error-correcting codes</em>, volume 16.

</span>
<span class="ltx_bibblock">Elsevier, 1977.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madhulatha (2012)</span>
<span class="ltx_bibblock">
T Soni Madhulatha.

</span>
<span class="ltx_bibblock">An overview on clustering methods.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1205.1117</em>, 2012.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
B McMahan, E Moore, D Ramage, and others.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Artif. Intell.</em>, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miotto et al. (2016)</span>
<span class="ltx_bibblock">
Riccardo Miotto, Li Li, Brian A Kidd, and Joel T Dudley.

</span>
<span class="ltx_bibblock">Deep patient: An unsupervised representation to predict the future of
patients from the electronic health records.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Sci. Rep.</em>, 6:26094, May 2016.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miotto et al. (2018)</span>
<span class="ltx_bibblock">
Riccardo Miotto, Fei Wang, Shuang Wang, Xiaoqian Jiang, and Joel T Dudley.

</span>
<span class="ltx_bibblock">Deep learning for healthcare: review, opportunities and challenges.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Brief. Bioinform.</em>, 19(6):1236–1246,
November 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pati et al. (2022)</span>
<span class="ltx_bibblock">
Sarthak Pati, Ujjwal Baid, and Brandon et al. Edwards.

</span>
<span class="ltx_bibblock">Federated learning enables big data for rare cancer boundary
detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Nat. Commun.</em>, 13(1):7346, December 2022.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pollard et al. (2018)</span>
<span class="ltx_bibblock">
Tom J Pollard, Alistair E W Johnson, Jesse D Raffa, Leo A Celi, Roger G Mark,
and Omar Badawi.

</span>
<span class="ltx_bibblock">The eICU collaborative research database, a freely available
multi-center database for critical care research.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Sci Data</em>, 5:180178, September 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prayitno et al. (2021)</span>
<span class="ltx_bibblock">
Prayitno, Chi-Ren Shyu, Karisma Trinanda Putra, Hsing-Chung Chen, Yuan-Yu
Tsai, K S M Tozammel Hossain, Wei Jiang, and Zon-Yin Shae.

</span>
<span class="ltx_bibblock">A systematic review of federated learning in the healthcare area:
From the perspective of data properties and applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">NATO Adv. Sci. Inst. Ser. E Appl. Sci.</em>, 11(23):11191, November 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rieke et al. (2020)</span>
<span class="ltx_bibblock">
Nicola Rieke, Jonny Hancox, and Wenqi et al. Li.

</span>
<span class="ltx_bibblock">The future of digital health with federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">npj Digital Medicine</em>, 3(1):1–7, September
2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robinson (2012)</span>
<span class="ltx_bibblock">
Peter N Robinson.

</span>
<span class="ltx_bibblock">Deep phenotyping for precision medicine.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Hum. Mutat.</em>, 33(5):777–780, May 2012.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2020)</span>
<span class="ltx_bibblock">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask
optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>,
32(8):3710–3722, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheikhalishahi et al. (2020)</span>
<span class="ltx_bibblock">
Seyedmostafa Sheikhalishahi, Vevake Balaraman, and Venet Osmani.

</span>
<span class="ltx_bibblock">Benchmarking machine learning models on multi-centre eICU critical
care dataset.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">PLoS One</em>, 15(7):e0235424, July 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Strehl et al. (2000)</span>
<span class="ltx_bibblock">
Alexander Strehl, Joydeep Ghosh, and Raymond Mooney.

</span>
<span class="ltx_bibblock">Impact of similarity measures on web-page clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Workshop on artificial intelligence for web search (AAAI
2000)</em>, volume 58, page 64, 2000.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">von Luxburg (2007)</span>
<span class="ltx_bibblock">
Ulrike von Luxburg.

</span>
<span class="ltx_bibblock">A tutorial on spectral clustering.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Stat. Comput.</em>, 17(4):395–416, December
2007.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2020)</span>
<span class="ltx_bibblock">
Zhenxing Xu, Fei Wang, and Prakash et al. Adekkanattu.

</span>
<span class="ltx_bibblock">Subphenotyping depression using machine learning and electronic
health records.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Learn Health Syst</em>, 4(4):e10241, October
2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al. (2021)</span>
<span class="ltx_bibblock">
Xianlong Zeng, Simon Lin, and Chang Liu.

</span>
<span class="ltx_bibblock">Transformer-based unsupervised patient representation learning based
on medical claims for risk stratification and analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 12th ACM Conference on Bioinformatics,
Computational Biology, and Health Informatics</em>, number Article 17 in BCB ’21,
pages 1–9, New York, NY, USA, August 2021. Association for Computing
Machinery.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>

</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Selecting number of clusters</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Within-Cluster-Sum-Of-Squares</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.9" class="ltx_p">Within-Cluster-Sum-Of-Squares (WCSS) is a metric used in clustering to determine the optimal number of clusters. It calculates the total sum of the squared distances between each data point within a cluster and the center of that cluster (centroid). A smaller WCSS implies that the data points are more compact, indicating tighter clustering of similar points. It is defined as:</p>
<table id="A1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E1.m1.1" class="ltx_Math" alttext="\text{WCSS}:=\sum_{k=1}^{K}\sum_{i=1}^{n_{k}}(x_{ki}-\mu_{k})^{2}" display="block"><semantics id="A1.E1.m1.1a"><mrow id="A1.E1.m1.1.1" xref="A1.E1.m1.1.1.cmml"><mtext id="A1.E1.m1.1.1.3" xref="A1.E1.m1.1.1.3a.cmml">WCSS</mtext><mo lspace="0.278em" rspace="0.111em" id="A1.E1.m1.1.1.2" xref="A1.E1.m1.1.1.2.cmml">:=</mo><mrow id="A1.E1.m1.1.1.1" xref="A1.E1.m1.1.1.1.cmml"><munderover id="A1.E1.m1.1.1.1.2" xref="A1.E1.m1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E1.m1.1.1.1.2.2.2" xref="A1.E1.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E1.m1.1.1.1.2.2.3" xref="A1.E1.m1.1.1.1.2.2.3.cmml"><mi id="A1.E1.m1.1.1.1.2.2.3.2" xref="A1.E1.m1.1.1.1.2.2.3.2.cmml">k</mi><mo id="A1.E1.m1.1.1.1.2.2.3.1" xref="A1.E1.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E1.m1.1.1.1.2.2.3.3" xref="A1.E1.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E1.m1.1.1.1.2.3" xref="A1.E1.m1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="A1.E1.m1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.cmml"><munderover id="A1.E1.m1.1.1.1.1.2" xref="A1.E1.m1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E1.m1.1.1.1.1.2.2.2" xref="A1.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E1.m1.1.1.1.1.2.2.3" xref="A1.E1.m1.1.1.1.1.2.2.3.cmml"><mi id="A1.E1.m1.1.1.1.1.2.2.3.2" xref="A1.E1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E1.m1.1.1.1.1.2.2.3.1" xref="A1.E1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E1.m1.1.1.1.1.2.2.3.3" xref="A1.E1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="A1.E1.m1.1.1.1.1.2.3" xref="A1.E1.m1.1.1.1.1.2.3.cmml"><mi id="A1.E1.m1.1.1.1.1.2.3.2" xref="A1.E1.m1.1.1.1.1.2.3.2.cmml">n</mi><mi id="A1.E1.m1.1.1.1.1.2.3.3" xref="A1.E1.m1.1.1.1.1.2.3.3.cmml">k</mi></msub></munderover><msup id="A1.E1.m1.1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.1.cmml"><mrow id="A1.E1.m1.1.1.1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E1.m1.1.1.1.1.1.1.1.2" xref="A1.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.1.1.1.1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E1.m1.1.1.1.1.1.1.1.1.2" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A1.E1.m1.1.1.1.1.1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E1.m1.1.1.1.1.1.1.1.1.3" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="A1.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A1.E1.m1.1.1.1.1.1.1.1.3" xref="A1.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E1.m1.1.1.1.1.1.3" xref="A1.E1.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E1.m1.1b"><apply id="A1.E1.m1.1.1.cmml" xref="A1.E1.m1.1.1"><csymbol cd="latexml" id="A1.E1.m1.1.1.2.cmml" xref="A1.E1.m1.1.1.2">assign</csymbol><ci id="A1.E1.m1.1.1.3a.cmml" xref="A1.E1.m1.1.1.3"><mtext id="A1.E1.m1.1.1.3.cmml" xref="A1.E1.m1.1.1.3">WCSS</mtext></ci><apply id="A1.E1.m1.1.1.1.cmml" xref="A1.E1.m1.1.1.1"><apply id="A1.E1.m1.1.1.1.2.cmml" xref="A1.E1.m1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.2.1.cmml" xref="A1.E1.m1.1.1.1.2">superscript</csymbol><apply id="A1.E1.m1.1.1.1.2.2.cmml" xref="A1.E1.m1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.2.2.1.cmml" xref="A1.E1.m1.1.1.1.2">subscript</csymbol><sum id="A1.E1.m1.1.1.1.2.2.2.cmml" xref="A1.E1.m1.1.1.1.2.2.2"></sum><apply id="A1.E1.m1.1.1.1.2.2.3.cmml" xref="A1.E1.m1.1.1.1.2.2.3"><eq id="A1.E1.m1.1.1.1.2.2.3.1.cmml" xref="A1.E1.m1.1.1.1.2.2.3.1"></eq><ci id="A1.E1.m1.1.1.1.2.2.3.2.cmml" xref="A1.E1.m1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="A1.E1.m1.1.1.1.2.2.3.3.cmml" xref="A1.E1.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E1.m1.1.1.1.2.3.cmml" xref="A1.E1.m1.1.1.1.2.3">𝐾</ci></apply><apply id="A1.E1.m1.1.1.1.1.cmml" xref="A1.E1.m1.1.1.1.1"><apply id="A1.E1.m1.1.1.1.1.2.cmml" xref="A1.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.2.1.cmml" xref="A1.E1.m1.1.1.1.1.2">superscript</csymbol><apply id="A1.E1.m1.1.1.1.1.2.2.cmml" xref="A1.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.2.2.1.cmml" xref="A1.E1.m1.1.1.1.1.2">subscript</csymbol><sum id="A1.E1.m1.1.1.1.1.2.2.2.cmml" xref="A1.E1.m1.1.1.1.1.2.2.2"></sum><apply id="A1.E1.m1.1.1.1.1.2.2.3.cmml" xref="A1.E1.m1.1.1.1.1.2.2.3"><eq id="A1.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="A1.E1.m1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="A1.E1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="A1.E1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E1.m1.1.1.1.1.2.3.cmml" xref="A1.E1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.2.3.1.cmml" xref="A1.E1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E1.m1.1.1.1.1.2.3.2.cmml" xref="A1.E1.m1.1.1.1.1.2.3.2">𝑛</ci><ci id="A1.E1.m1.1.1.1.1.2.3.3.cmml" xref="A1.E1.m1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="A1.E1.m1.1.1.1.1.1.cmml" xref="A1.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.1.2.cmml" xref="A1.E1.m1.1.1.1.1.1">superscript</csymbol><apply id="A1.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1"><minus id="A1.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3"><times id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A1.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="A1.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E1.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><cn type="integer" id="A1.E1.m1.1.1.1.1.1.3.cmml" xref="A1.E1.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E1.m1.1c">\text{WCSS}:=\sum_{k=1}^{K}\sum_{i=1}^{n_{k}}(x_{ki}-\mu_{k})^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.8" class="ltx_p">where cluster <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">k</annotation></semantics></math> ranges from <math id="A1.SS1.p1.2.m2.1" class="ltx_math_unparsed" alttext="1..K" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1b"><mn id="A1.SS1.p1.2.m2.1.1">1</mn><mo lspace="0em" rspace="0.0835em" id="A1.SS1.p1.2.m2.1.2">.</mo><mo lspace="0.0835em" rspace="0.167em" id="A1.SS1.p1.2.m2.1.3">.</mo><mi id="A1.SS1.p1.2.m2.1.4">K</mi></mrow><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">1..K</annotation></semantics></math>m data points, <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="x_{ki}" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><msub id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml"><mi id="A1.SS1.p1.3.m3.1.1.2" xref="A1.SS1.p1.3.m3.1.1.2.cmml">x</mi><mrow id="A1.SS1.p1.3.m3.1.1.3" xref="A1.SS1.p1.3.m3.1.1.3.cmml"><mi id="A1.SS1.p1.3.m3.1.1.3.2" xref="A1.SS1.p1.3.m3.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.m3.1.1.3.1" xref="A1.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="A1.SS1.p1.3.m3.1.1.3.3" xref="A1.SS1.p1.3.m3.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><apply id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.p1.3.m3.1.1.2">𝑥</ci><apply id="A1.SS1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.p1.3.m3.1.1.3"><times id="A1.SS1.p1.3.m3.1.1.3.1.cmml" xref="A1.SS1.p1.3.m3.1.1.3.1"></times><ci id="A1.SS1.p1.3.m3.1.1.3.2.cmml" xref="A1.SS1.p1.3.m3.1.1.3.2">𝑘</ci><ci id="A1.SS1.p1.3.m3.1.1.3.3.cmml" xref="A1.SS1.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">x_{ki}</annotation></semantics></math> in cluster <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">k</annotation></semantics></math> range from <math id="A1.SS1.p1.5.m5.1" class="ltx_math_unparsed" alttext="1..n_{k}" display="inline"><semantics id="A1.SS1.p1.5.m5.1a"><mrow id="A1.SS1.p1.5.m5.1b"><mn id="A1.SS1.p1.5.m5.1.1">1</mn><mo lspace="0em" rspace="0.0835em" id="A1.SS1.p1.5.m5.1.2">.</mo><mo lspace="0.0835em" rspace="0.167em" id="A1.SS1.p1.5.m5.1.3">.</mo><msub id="A1.SS1.p1.5.m5.1.4"><mi id="A1.SS1.p1.5.m5.1.4.2">n</mi><mi id="A1.SS1.p1.5.m5.1.4.3">k</mi></msub></mrow><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">1..n_{k}</annotation></semantics></math>, and <math id="A1.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mu_{k}" display="inline"><semantics id="A1.SS1.p1.6.m6.1a"><msub id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml"><mi id="A1.SS1.p1.6.m6.1.1.2" xref="A1.SS1.p1.6.m6.1.1.2.cmml">μ</mi><mi id="A1.SS1.p1.6.m6.1.1.3" xref="A1.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><apply id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m6.1.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS1.p1.6.m6.1.1.2.cmml" xref="A1.SS1.p1.6.m6.1.1.2">𝜇</ci><ci id="A1.SS1.p1.6.m6.1.1.3.cmml" xref="A1.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">\mu_{k}</annotation></semantics></math> is the mean of the points in cluster <math id="A1.SS1.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">k</annotation></semantics></math> <em id="A1.SS1.p1.8.1" class="ltx_emph ltx_font_italic">i.e.,</em> <math id="A1.SS1.p1.8.m8.1" class="ltx_Math" alttext="\frac{1}{n_{k}}\sum_{i=1}^{n_{k}}x_{ki}" display="inline"><semantics id="A1.SS1.p1.8.m8.1a"><mrow id="A1.SS1.p1.8.m8.1.1" xref="A1.SS1.p1.8.m8.1.1.cmml"><mfrac id="A1.SS1.p1.8.m8.1.1.2" xref="A1.SS1.p1.8.m8.1.1.2.cmml"><mn id="A1.SS1.p1.8.m8.1.1.2.2" xref="A1.SS1.p1.8.m8.1.1.2.2.cmml">1</mn><msub id="A1.SS1.p1.8.m8.1.1.2.3" xref="A1.SS1.p1.8.m8.1.1.2.3.cmml"><mi id="A1.SS1.p1.8.m8.1.1.2.3.2" xref="A1.SS1.p1.8.m8.1.1.2.3.2.cmml">n</mi><mi id="A1.SS1.p1.8.m8.1.1.2.3.3" xref="A1.SS1.p1.8.m8.1.1.2.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="A1.SS1.p1.8.m8.1.1.1" xref="A1.SS1.p1.8.m8.1.1.1.cmml">​</mo><mrow id="A1.SS1.p1.8.m8.1.1.3" xref="A1.SS1.p1.8.m8.1.1.3.cmml"><msubsup id="A1.SS1.p1.8.m8.1.1.3.1" xref="A1.SS1.p1.8.m8.1.1.3.1.cmml"><mo id="A1.SS1.p1.8.m8.1.1.3.1.2.2" xref="A1.SS1.p1.8.m8.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.8.m8.1.1.3.1.2.3" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.cmml"><mi id="A1.SS1.p1.8.m8.1.1.3.1.2.3.2" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.2.cmml">i</mi><mo id="A1.SS1.p1.8.m8.1.1.3.1.2.3.1" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.8.m8.1.1.3.1.2.3.3" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="A1.SS1.p1.8.m8.1.1.3.1.3" xref="A1.SS1.p1.8.m8.1.1.3.1.3.cmml"><mi id="A1.SS1.p1.8.m8.1.1.3.1.3.2" xref="A1.SS1.p1.8.m8.1.1.3.1.3.2.cmml">n</mi><mi id="A1.SS1.p1.8.m8.1.1.3.1.3.3" xref="A1.SS1.p1.8.m8.1.1.3.1.3.3.cmml">k</mi></msub></msubsup><msub id="A1.SS1.p1.8.m8.1.1.3.2" xref="A1.SS1.p1.8.m8.1.1.3.2.cmml"><mi id="A1.SS1.p1.8.m8.1.1.3.2.2" xref="A1.SS1.p1.8.m8.1.1.3.2.2.cmml">x</mi><mrow id="A1.SS1.p1.8.m8.1.1.3.2.3" xref="A1.SS1.p1.8.m8.1.1.3.2.3.cmml"><mi id="A1.SS1.p1.8.m8.1.1.3.2.3.2" xref="A1.SS1.p1.8.m8.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p1.8.m8.1.1.3.2.3.1" xref="A1.SS1.p1.8.m8.1.1.3.2.3.1.cmml">​</mo><mi id="A1.SS1.p1.8.m8.1.1.3.2.3.3" xref="A1.SS1.p1.8.m8.1.1.3.2.3.3.cmml">i</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m8.1b"><apply id="A1.SS1.p1.8.m8.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1"><times id="A1.SS1.p1.8.m8.1.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1.1"></times><apply id="A1.SS1.p1.8.m8.1.1.2.cmml" xref="A1.SS1.p1.8.m8.1.1.2"><divide id="A1.SS1.p1.8.m8.1.1.2.1.cmml" xref="A1.SS1.p1.8.m8.1.1.2"></divide><cn type="integer" id="A1.SS1.p1.8.m8.1.1.2.2.cmml" xref="A1.SS1.p1.8.m8.1.1.2.2">1</cn><apply id="A1.SS1.p1.8.m8.1.1.2.3.cmml" xref="A1.SS1.p1.8.m8.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.2.3.1.cmml" xref="A1.SS1.p1.8.m8.1.1.2.3">subscript</csymbol><ci id="A1.SS1.p1.8.m8.1.1.2.3.2.cmml" xref="A1.SS1.p1.8.m8.1.1.2.3.2">𝑛</ci><ci id="A1.SS1.p1.8.m8.1.1.2.3.3.cmml" xref="A1.SS1.p1.8.m8.1.1.2.3.3">𝑘</ci></apply></apply><apply id="A1.SS1.p1.8.m8.1.1.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3"><apply id="A1.SS1.p1.8.m8.1.1.3.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.3.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1">superscript</csymbol><apply id="A1.SS1.p1.8.m8.1.1.3.1.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.3.1.2.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1">subscript</csymbol><sum id="A1.SS1.p1.8.m8.1.1.3.1.2.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.2.2"></sum><apply id="A1.SS1.p1.8.m8.1.1.3.1.2.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3"><eq id="A1.SS1.p1.8.m8.1.1.3.1.2.3.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.1"></eq><ci id="A1.SS1.p1.8.m8.1.1.3.1.2.3.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="A1.SS1.p1.8.m8.1.1.3.1.2.3.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="A1.SS1.p1.8.m8.1.1.3.1.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.3.1.3.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.3">subscript</csymbol><ci id="A1.SS1.p1.8.m8.1.1.3.1.3.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.3.2">𝑛</ci><ci id="A1.SS1.p1.8.m8.1.1.3.1.3.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.1.3.3">𝑘</ci></apply></apply><apply id="A1.SS1.p1.8.m8.1.1.3.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m8.1.1.3.2.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2">subscript</csymbol><ci id="A1.SS1.p1.8.m8.1.1.3.2.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2.2">𝑥</ci><apply id="A1.SS1.p1.8.m8.1.1.3.2.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2.3"><times id="A1.SS1.p1.8.m8.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2.3.1"></times><ci id="A1.SS1.p1.8.m8.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2.3.2">𝑘</ci><ci id="A1.SS1.p1.8.m8.1.1.3.2.3.3.cmml" xref="A1.SS1.p1.8.m8.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">\frac{1}{n_{k}}\sum_{i=1}^{n_{k}}x_{ki}</annotation></semantics></math></p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Elbow plot</h3>

<figure id="A1.SS2.1" class="ltx_figure"><img src="/html/2307.08847/assets/elbow_method_results-1.png" id="A1.SS2.1.g1" class="ltx_graphics ltx_img_landscape" width="354" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span id="A1.SS2.1.1.1" class="ltx_text ltx_font_bold">Supplementary Figure S1.</span> Number of clusters vs. Within-Cluster-Sum-Of-Squares (WCSS). Dashed red-line indicates WCSS at k=3.</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Calculating overall performance</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Single site and FedAvg</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.6" class="ltx_p">To calculate the overall AUC and AUPRC for Single Site and FedAvg (Global R), we use a simple average (or uniform weighted average). This is because each site trains only one model and has the same number of patients:</p>
<table id="A2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E2.m1.1" class="ltx_Math" alttext="\text{Global R}=\frac{1}{N}\sum_{c=1}^{C}R_{c}n_{c}" display="block"><semantics id="A2.E2.m1.1a"><mrow id="A2.E2.m1.1.1" xref="A2.E2.m1.1.1.cmml"><mtext id="A2.E2.m1.1.1.2" xref="A2.E2.m1.1.1.2a.cmml">Global R</mtext><mo id="A2.E2.m1.1.1.1" xref="A2.E2.m1.1.1.1.cmml">=</mo><mrow id="A2.E2.m1.1.1.3" xref="A2.E2.m1.1.1.3.cmml"><mfrac id="A2.E2.m1.1.1.3.2" xref="A2.E2.m1.1.1.3.2.cmml"><mn id="A2.E2.m1.1.1.3.2.2" xref="A2.E2.m1.1.1.3.2.2.cmml">1</mn><mi id="A2.E2.m1.1.1.3.2.3" xref="A2.E2.m1.1.1.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="A2.E2.m1.1.1.3.1" xref="A2.E2.m1.1.1.3.1.cmml">​</mo><mrow id="A2.E2.m1.1.1.3.3" xref="A2.E2.m1.1.1.3.3.cmml"><munderover id="A2.E2.m1.1.1.3.3.1" xref="A2.E2.m1.1.1.3.3.1.cmml"><mo movablelimits="false" id="A2.E2.m1.1.1.3.3.1.2.2" xref="A2.E2.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="A2.E2.m1.1.1.3.3.1.2.3" xref="A2.E2.m1.1.1.3.3.1.2.3.cmml"><mi id="A2.E2.m1.1.1.3.3.1.2.3.2" xref="A2.E2.m1.1.1.3.3.1.2.3.2.cmml">c</mi><mo id="A2.E2.m1.1.1.3.3.1.2.3.1" xref="A2.E2.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="A2.E2.m1.1.1.3.3.1.2.3.3" xref="A2.E2.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E2.m1.1.1.3.3.1.3" xref="A2.E2.m1.1.1.3.3.1.3.cmml">C</mi></munderover><mrow id="A2.E2.m1.1.1.3.3.2" xref="A2.E2.m1.1.1.3.3.2.cmml"><msub id="A2.E2.m1.1.1.3.3.2.2" xref="A2.E2.m1.1.1.3.3.2.2.cmml"><mi id="A2.E2.m1.1.1.3.3.2.2.2" xref="A2.E2.m1.1.1.3.3.2.2.2.cmml">R</mi><mi id="A2.E2.m1.1.1.3.3.2.2.3" xref="A2.E2.m1.1.1.3.3.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="A2.E2.m1.1.1.3.3.2.1" xref="A2.E2.m1.1.1.3.3.2.1.cmml">​</mo><msub id="A2.E2.m1.1.1.3.3.2.3" xref="A2.E2.m1.1.1.3.3.2.3.cmml"><mi id="A2.E2.m1.1.1.3.3.2.3.2" xref="A2.E2.m1.1.1.3.3.2.3.2.cmml">n</mi><mi id="A2.E2.m1.1.1.3.3.2.3.3" xref="A2.E2.m1.1.1.3.3.2.3.3.cmml">c</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E2.m1.1b"><apply id="A2.E2.m1.1.1.cmml" xref="A2.E2.m1.1.1"><eq id="A2.E2.m1.1.1.1.cmml" xref="A2.E2.m1.1.1.1"></eq><ci id="A2.E2.m1.1.1.2a.cmml" xref="A2.E2.m1.1.1.2"><mtext id="A2.E2.m1.1.1.2.cmml" xref="A2.E2.m1.1.1.2">Global R</mtext></ci><apply id="A2.E2.m1.1.1.3.cmml" xref="A2.E2.m1.1.1.3"><times id="A2.E2.m1.1.1.3.1.cmml" xref="A2.E2.m1.1.1.3.1"></times><apply id="A2.E2.m1.1.1.3.2.cmml" xref="A2.E2.m1.1.1.3.2"><divide id="A2.E2.m1.1.1.3.2.1.cmml" xref="A2.E2.m1.1.1.3.2"></divide><cn type="integer" id="A2.E2.m1.1.1.3.2.2.cmml" xref="A2.E2.m1.1.1.3.2.2">1</cn><ci id="A2.E2.m1.1.1.3.2.3.cmml" xref="A2.E2.m1.1.1.3.2.3">𝑁</ci></apply><apply id="A2.E2.m1.1.1.3.3.cmml" xref="A2.E2.m1.1.1.3.3"><apply id="A2.E2.m1.1.1.3.3.1.cmml" xref="A2.E2.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A2.E2.m1.1.1.3.3.1.1.cmml" xref="A2.E2.m1.1.1.3.3.1">superscript</csymbol><apply id="A2.E2.m1.1.1.3.3.1.2.cmml" xref="A2.E2.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A2.E2.m1.1.1.3.3.1.2.1.cmml" xref="A2.E2.m1.1.1.3.3.1">subscript</csymbol><sum id="A2.E2.m1.1.1.3.3.1.2.2.cmml" xref="A2.E2.m1.1.1.3.3.1.2.2"></sum><apply id="A2.E2.m1.1.1.3.3.1.2.3.cmml" xref="A2.E2.m1.1.1.3.3.1.2.3"><eq id="A2.E2.m1.1.1.3.3.1.2.3.1.cmml" xref="A2.E2.m1.1.1.3.3.1.2.3.1"></eq><ci id="A2.E2.m1.1.1.3.3.1.2.3.2.cmml" xref="A2.E2.m1.1.1.3.3.1.2.3.2">𝑐</ci><cn type="integer" id="A2.E2.m1.1.1.3.3.1.2.3.3.cmml" xref="A2.E2.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="A2.E2.m1.1.1.3.3.1.3.cmml" xref="A2.E2.m1.1.1.3.3.1.3">𝐶</ci></apply><apply id="A2.E2.m1.1.1.3.3.2.cmml" xref="A2.E2.m1.1.1.3.3.2"><times id="A2.E2.m1.1.1.3.3.2.1.cmml" xref="A2.E2.m1.1.1.3.3.2.1"></times><apply id="A2.E2.m1.1.1.3.3.2.2.cmml" xref="A2.E2.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A2.E2.m1.1.1.3.3.2.2.1.cmml" xref="A2.E2.m1.1.1.3.3.2.2">subscript</csymbol><ci id="A2.E2.m1.1.1.3.3.2.2.2.cmml" xref="A2.E2.m1.1.1.3.3.2.2.2">𝑅</ci><ci id="A2.E2.m1.1.1.3.3.2.2.3.cmml" xref="A2.E2.m1.1.1.3.3.2.2.3">𝑐</ci></apply><apply id="A2.E2.m1.1.1.3.3.2.3.cmml" xref="A2.E2.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A2.E2.m1.1.1.3.3.2.3.1.cmml" xref="A2.E2.m1.1.1.3.3.2.3">subscript</csymbol><ci id="A2.E2.m1.1.1.3.3.2.3.2.cmml" xref="A2.E2.m1.1.1.3.3.2.3.2">𝑛</ci><ci id="A2.E2.m1.1.1.3.3.2.3.3.cmml" xref="A2.E2.m1.1.1.3.3.2.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E2.m1.1c">\text{Global R}=\frac{1}{N}\sum_{c=1}^{C}R_{c}n_{c}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="A2.SS1.p1.5" class="ltx_p">where <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="R_{c}" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><msub id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mi id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">R</mi><mi id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.1.2">𝑅</ci><ci id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">R_{c}</annotation></semantics></math> is the result (AUC or AUPRC) for site <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mi id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><ci id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">c</annotation></semantics></math>, <math id="A2.SS1.p1.3.m3.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="A2.SS1.p1.3.m3.1a"><msub id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">n</mi><mi id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="A2.SS1.p1.3.m3.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.2">𝑛</ci><ci id="A2.SS1.p1.3.m3.1.1.3.cmml" xref="A2.SS1.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">n_{c}</annotation></semantics></math> is the sample size for site <math id="A2.SS1.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">c</annotation></semantics></math>, and <math id="A2.SS1.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">N</annotation></semantics></math> is the total number of samples across all sites.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>PCFBL and CBFL</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.8" class="ltx_p">To calculate the overall AUC and AUPRC (Global R) for CBFL and PCBFL, we use a weighted average of results that takes into account the number of patients each site contributes to a cluster. This is necessary as each site trains 3 separate models (1 per cluster) and their sample size contribution to a given cluster varies:</p>
<table id="A2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E3.m1.1" class="ltx_Math" alttext="\text{Global R}=\frac{1}{N}\sum_{c=1}^{C}\sum_{k=1}^{K}R_{ck}n_{ck}" display="block"><semantics id="A2.E3.m1.1a"><mrow id="A2.E3.m1.1.1" xref="A2.E3.m1.1.1.cmml"><mtext id="A2.E3.m1.1.1.2" xref="A2.E3.m1.1.1.2a.cmml">Global R</mtext><mo id="A2.E3.m1.1.1.1" xref="A2.E3.m1.1.1.1.cmml">=</mo><mrow id="A2.E3.m1.1.1.3" xref="A2.E3.m1.1.1.3.cmml"><mfrac id="A2.E3.m1.1.1.3.2" xref="A2.E3.m1.1.1.3.2.cmml"><mn id="A2.E3.m1.1.1.3.2.2" xref="A2.E3.m1.1.1.3.2.2.cmml">1</mn><mi id="A2.E3.m1.1.1.3.2.3" xref="A2.E3.m1.1.1.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="A2.E3.m1.1.1.3.1" xref="A2.E3.m1.1.1.3.1.cmml">​</mo><mrow id="A2.E3.m1.1.1.3.3" xref="A2.E3.m1.1.1.3.3.cmml"><munderover id="A2.E3.m1.1.1.3.3.1" xref="A2.E3.m1.1.1.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="A2.E3.m1.1.1.3.3.1.2.2" xref="A2.E3.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="A2.E3.m1.1.1.3.3.1.2.3" xref="A2.E3.m1.1.1.3.3.1.2.3.cmml"><mi id="A2.E3.m1.1.1.3.3.1.2.3.2" xref="A2.E3.m1.1.1.3.3.1.2.3.2.cmml">c</mi><mo id="A2.E3.m1.1.1.3.3.1.2.3.1" xref="A2.E3.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="A2.E3.m1.1.1.3.3.1.2.3.3" xref="A2.E3.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E3.m1.1.1.3.3.1.3" xref="A2.E3.m1.1.1.3.3.1.3.cmml">C</mi></munderover><mrow id="A2.E3.m1.1.1.3.3.2" xref="A2.E3.m1.1.1.3.3.2.cmml"><munderover id="A2.E3.m1.1.1.3.3.2.1" xref="A2.E3.m1.1.1.3.3.2.1.cmml"><mo movablelimits="false" id="A2.E3.m1.1.1.3.3.2.1.2.2" xref="A2.E3.m1.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="A2.E3.m1.1.1.3.3.2.1.2.3" xref="A2.E3.m1.1.1.3.3.2.1.2.3.cmml"><mi id="A2.E3.m1.1.1.3.3.2.1.2.3.2" xref="A2.E3.m1.1.1.3.3.2.1.2.3.2.cmml">k</mi><mo id="A2.E3.m1.1.1.3.3.2.1.2.3.1" xref="A2.E3.m1.1.1.3.3.2.1.2.3.1.cmml">=</mo><mn id="A2.E3.m1.1.1.3.3.2.1.2.3.3" xref="A2.E3.m1.1.1.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E3.m1.1.1.3.3.2.1.3" xref="A2.E3.m1.1.1.3.3.2.1.3.cmml">K</mi></munderover><mrow id="A2.E3.m1.1.1.3.3.2.2" xref="A2.E3.m1.1.1.3.3.2.2.cmml"><msub id="A2.E3.m1.1.1.3.3.2.2.2" xref="A2.E3.m1.1.1.3.3.2.2.2.cmml"><mi id="A2.E3.m1.1.1.3.3.2.2.2.2" xref="A2.E3.m1.1.1.3.3.2.2.2.2.cmml">R</mi><mrow id="A2.E3.m1.1.1.3.3.2.2.2.3" xref="A2.E3.m1.1.1.3.3.2.2.2.3.cmml"><mi id="A2.E3.m1.1.1.3.3.2.2.2.3.2" xref="A2.E3.m1.1.1.3.3.2.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E3.m1.1.1.3.3.2.2.2.3.1" xref="A2.E3.m1.1.1.3.3.2.2.2.3.1.cmml">​</mo><mi id="A2.E3.m1.1.1.3.3.2.2.2.3.3" xref="A2.E3.m1.1.1.3.3.2.2.2.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A2.E3.m1.1.1.3.3.2.2.1" xref="A2.E3.m1.1.1.3.3.2.2.1.cmml">​</mo><msub id="A2.E3.m1.1.1.3.3.2.2.3" xref="A2.E3.m1.1.1.3.3.2.2.3.cmml"><mi id="A2.E3.m1.1.1.3.3.2.2.3.2" xref="A2.E3.m1.1.1.3.3.2.2.3.2.cmml">n</mi><mrow id="A2.E3.m1.1.1.3.3.2.2.3.3" xref="A2.E3.m1.1.1.3.3.2.2.3.3.cmml"><mi id="A2.E3.m1.1.1.3.3.2.2.3.3.2" xref="A2.E3.m1.1.1.3.3.2.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E3.m1.1.1.3.3.2.2.3.3.1" xref="A2.E3.m1.1.1.3.3.2.2.3.3.1.cmml">​</mo><mi id="A2.E3.m1.1.1.3.3.2.2.3.3.3" xref="A2.E3.m1.1.1.3.3.2.2.3.3.3.cmml">k</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E3.m1.1b"><apply id="A2.E3.m1.1.1.cmml" xref="A2.E3.m1.1.1"><eq id="A2.E3.m1.1.1.1.cmml" xref="A2.E3.m1.1.1.1"></eq><ci id="A2.E3.m1.1.1.2a.cmml" xref="A2.E3.m1.1.1.2"><mtext id="A2.E3.m1.1.1.2.cmml" xref="A2.E3.m1.1.1.2">Global R</mtext></ci><apply id="A2.E3.m1.1.1.3.cmml" xref="A2.E3.m1.1.1.3"><times id="A2.E3.m1.1.1.3.1.cmml" xref="A2.E3.m1.1.1.3.1"></times><apply id="A2.E3.m1.1.1.3.2.cmml" xref="A2.E3.m1.1.1.3.2"><divide id="A2.E3.m1.1.1.3.2.1.cmml" xref="A2.E3.m1.1.1.3.2"></divide><cn type="integer" id="A2.E3.m1.1.1.3.2.2.cmml" xref="A2.E3.m1.1.1.3.2.2">1</cn><ci id="A2.E3.m1.1.1.3.2.3.cmml" xref="A2.E3.m1.1.1.3.2.3">𝑁</ci></apply><apply id="A2.E3.m1.1.1.3.3.cmml" xref="A2.E3.m1.1.1.3.3"><apply id="A2.E3.m1.1.1.3.3.1.cmml" xref="A2.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.1.1.cmml" xref="A2.E3.m1.1.1.3.3.1">superscript</csymbol><apply id="A2.E3.m1.1.1.3.3.1.2.cmml" xref="A2.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.1.2.1.cmml" xref="A2.E3.m1.1.1.3.3.1">subscript</csymbol><sum id="A2.E3.m1.1.1.3.3.1.2.2.cmml" xref="A2.E3.m1.1.1.3.3.1.2.2"></sum><apply id="A2.E3.m1.1.1.3.3.1.2.3.cmml" xref="A2.E3.m1.1.1.3.3.1.2.3"><eq id="A2.E3.m1.1.1.3.3.1.2.3.1.cmml" xref="A2.E3.m1.1.1.3.3.1.2.3.1"></eq><ci id="A2.E3.m1.1.1.3.3.1.2.3.2.cmml" xref="A2.E3.m1.1.1.3.3.1.2.3.2">𝑐</ci><cn type="integer" id="A2.E3.m1.1.1.3.3.1.2.3.3.cmml" xref="A2.E3.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="A2.E3.m1.1.1.3.3.1.3.cmml" xref="A2.E3.m1.1.1.3.3.1.3">𝐶</ci></apply><apply id="A2.E3.m1.1.1.3.3.2.cmml" xref="A2.E3.m1.1.1.3.3.2"><apply id="A2.E3.m1.1.1.3.3.2.1.cmml" xref="A2.E3.m1.1.1.3.3.2.1"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.2.1.1.cmml" xref="A2.E3.m1.1.1.3.3.2.1">superscript</csymbol><apply id="A2.E3.m1.1.1.3.3.2.1.2.cmml" xref="A2.E3.m1.1.1.3.3.2.1"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.2.1.2.1.cmml" xref="A2.E3.m1.1.1.3.3.2.1">subscript</csymbol><sum id="A2.E3.m1.1.1.3.3.2.1.2.2.cmml" xref="A2.E3.m1.1.1.3.3.2.1.2.2"></sum><apply id="A2.E3.m1.1.1.3.3.2.1.2.3.cmml" xref="A2.E3.m1.1.1.3.3.2.1.2.3"><eq id="A2.E3.m1.1.1.3.3.2.1.2.3.1.cmml" xref="A2.E3.m1.1.1.3.3.2.1.2.3.1"></eq><ci id="A2.E3.m1.1.1.3.3.2.1.2.3.2.cmml" xref="A2.E3.m1.1.1.3.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="A2.E3.m1.1.1.3.3.2.1.2.3.3.cmml" xref="A2.E3.m1.1.1.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="A2.E3.m1.1.1.3.3.2.1.3.cmml" xref="A2.E3.m1.1.1.3.3.2.1.3">𝐾</ci></apply><apply id="A2.E3.m1.1.1.3.3.2.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2"><times id="A2.E3.m1.1.1.3.3.2.2.1.cmml" xref="A2.E3.m1.1.1.3.3.2.2.1"></times><apply id="A2.E3.m1.1.1.3.3.2.2.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.2.2.2.1.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2">subscript</csymbol><ci id="A2.E3.m1.1.1.3.3.2.2.2.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2.2">𝑅</ci><apply id="A2.E3.m1.1.1.3.3.2.2.2.3.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2.3"><times id="A2.E3.m1.1.1.3.3.2.2.2.3.1.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2.3.1"></times><ci id="A2.E3.m1.1.1.3.3.2.2.2.3.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2.3.2">𝑐</ci><ci id="A2.E3.m1.1.1.3.3.2.2.2.3.3.cmml" xref="A2.E3.m1.1.1.3.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="A2.E3.m1.1.1.3.3.2.2.3.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="A2.E3.m1.1.1.3.3.2.2.3.1.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3">subscript</csymbol><ci id="A2.E3.m1.1.1.3.3.2.2.3.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3.2">𝑛</ci><apply id="A2.E3.m1.1.1.3.3.2.2.3.3.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3.3"><times id="A2.E3.m1.1.1.3.3.2.2.3.3.1.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3.3.1"></times><ci id="A2.E3.m1.1.1.3.3.2.2.3.3.2.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3.3.2">𝑐</ci><ci id="A2.E3.m1.1.1.3.3.2.2.3.3.3.cmml" xref="A2.E3.m1.1.1.3.3.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E3.m1.1c">\text{Global R}=\frac{1}{N}\sum_{c=1}^{C}\sum_{k=1}^{K}R_{ck}n_{ck}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="A2.SS2.p1.7" class="ltx_p">where <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="R_{ck}" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><msub id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mi id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">R</mi><mrow id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml"><mi id="A2.SS2.p1.1.m1.1.1.3.2" xref="A2.SS2.p1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.SS2.p1.1.m1.1.1.3.1" xref="A2.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A2.SS2.p1.1.m1.1.1.3.3" xref="A2.SS2.p1.1.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.2">𝑅</ci><apply id="A2.SS2.p1.1.m1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3"><times id="A2.SS2.p1.1.m1.1.1.3.1.cmml" xref="A2.SS2.p1.1.m1.1.1.3.1"></times><ci id="A2.SS2.p1.1.m1.1.1.3.2.cmml" xref="A2.SS2.p1.1.m1.1.1.3.2">𝑐</ci><ci id="A2.SS2.p1.1.m1.1.1.3.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">R_{ck}</annotation></semantics></math> is the result (AUC or AUPRC) for site <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mi id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><ci id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">c</annotation></semantics></math> and cluster <math id="A2.SS2.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A2.SS2.p1.3.m3.1a"><mi id="A2.SS2.p1.3.m3.1.1" xref="A2.SS2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.1b"><ci id="A2.SS2.p1.3.m3.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.1c">k</annotation></semantics></math>, <math id="A2.SS2.p1.4.m4.1" class="ltx_Math" alttext="n_{ck}" display="inline"><semantics id="A2.SS2.p1.4.m4.1a"><msub id="A2.SS2.p1.4.m4.1.1" xref="A2.SS2.p1.4.m4.1.1.cmml"><mi id="A2.SS2.p1.4.m4.1.1.2" xref="A2.SS2.p1.4.m4.1.1.2.cmml">n</mi><mrow id="A2.SS2.p1.4.m4.1.1.3" xref="A2.SS2.p1.4.m4.1.1.3.cmml"><mi id="A2.SS2.p1.4.m4.1.1.3.2" xref="A2.SS2.p1.4.m4.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.SS2.p1.4.m4.1.1.3.1" xref="A2.SS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="A2.SS2.p1.4.m4.1.1.3.3" xref="A2.SS2.p1.4.m4.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.4.m4.1b"><apply id="A2.SS2.p1.4.m4.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.4.m4.1.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="A2.SS2.p1.4.m4.1.1.2.cmml" xref="A2.SS2.p1.4.m4.1.1.2">𝑛</ci><apply id="A2.SS2.p1.4.m4.1.1.3.cmml" xref="A2.SS2.p1.4.m4.1.1.3"><times id="A2.SS2.p1.4.m4.1.1.3.1.cmml" xref="A2.SS2.p1.4.m4.1.1.3.1"></times><ci id="A2.SS2.p1.4.m4.1.1.3.2.cmml" xref="A2.SS2.p1.4.m4.1.1.3.2">𝑐</ci><ci id="A2.SS2.p1.4.m4.1.1.3.3.cmml" xref="A2.SS2.p1.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.4.m4.1c">n_{ck}</annotation></semantics></math> is the sample size for site <math id="A2.SS2.p1.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A2.SS2.p1.5.m5.1a"><mi id="A2.SS2.p1.5.m5.1.1" xref="A2.SS2.p1.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.5.m5.1b"><ci id="A2.SS2.p1.5.m5.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.5.m5.1c">c</annotation></semantics></math> and cluster <math id="A2.SS2.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A2.SS2.p1.6.m6.1a"><mi id="A2.SS2.p1.6.m6.1.1" xref="A2.SS2.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.6.m6.1b"><ci id="A2.SS2.p1.6.m6.1.1.cmml" xref="A2.SS2.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.6.m6.1c">k</annotation></semantics></math>, and <math id="A2.SS2.p1.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A2.SS2.p1.7.m7.1a"><mi id="A2.SS2.p1.7.m7.1.1" xref="A2.SS2.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.7.m7.1b"><ci id="A2.SS2.p1.7.m7.1.1.cmml" xref="A2.SS2.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.7.m7.1c">N</annotation></semantics></math> is the total number of samples across all sites.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Cluster regional distribution</h2>

<figure id="A3.tab1" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A3.tab1.1" class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.tab1.1.1.1" class="ltx_tr">
<th id="A3.tab1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_t"><span id="A3.tab1.1.1.1.1.1" class="ltx_text ltx_font_bold">Region</span></th>
<th id="A3.tab1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A3.tab1.1.1.1.2.1" class="ltx_text ltx_font_bold">Cluster</span></th>
<th id="A3.tab1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A3.tab1.1.1.1.3.1" class="ltx_text ltx_font_bold">PCBFL</span></th>
<th id="A3.tab1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A3.tab1.1.1.1.4.1" class="ltx_text ltx_font_bold">CBFL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.tab1.1.2.1" class="ltx_tr">
<td id="A3.tab1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_t" rowspan="3"><span id="A3.tab1.1.2.1.1.1" class="ltx_text ltx_font_bold">Midwest</span></td>
<td id="A3.tab1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">Low</td>
<td id="A3.tab1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">36.7</td>
<td id="A3.tab1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">46.4</td>
</tr>
<tr id="A3.tab1.1.3.2" class="ltx_tr">
<td id="A3.tab1.1.3.2.1" class="ltx_td ltx_align_left">Medium</td>
<td id="A3.tab1.1.3.2.2" class="ltx_td ltx_align_left">19.85</td>
<td id="A3.tab1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_r">48.25</td>
</tr>
<tr id="A3.tab1.1.4.3" class="ltx_tr">
<td id="A3.tab1.1.4.3.1" class="ltx_td ltx_align_left">High</td>
<td id="A3.tab1.1.4.3.2" class="ltx_td ltx_align_left">43.45</td>
<td id="A3.tab1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_r">5.35</td>
</tr>
<tr id="A3.tab1.1.5.4" class="ltx_tr">
<td id="A3.tab1.1.5.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_t" rowspan="3"><span id="A3.tab1.1.5.4.1.1" class="ltx_text ltx_font_bold">Northeast</span></td>
<td id="A3.tab1.1.5.4.2" class="ltx_td ltx_align_left ltx_border_t">Low</td>
<td id="A3.tab1.1.5.4.3" class="ltx_td ltx_align_left ltx_border_t">44.2</td>
<td id="A3.tab1.1.5.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">36</td>
</tr>
<tr id="A3.tab1.1.6.5" class="ltx_tr">
<td id="A3.tab1.1.6.5.1" class="ltx_td ltx_align_left">Medium</td>
<td id="A3.tab1.1.6.5.2" class="ltx_td ltx_align_left">15.6</td>
<td id="A3.tab1.1.6.5.3" class="ltx_td ltx_align_left ltx_border_r">61.2</td>
</tr>
<tr id="A3.tab1.1.7.6" class="ltx_tr">
<td id="A3.tab1.1.7.6.1" class="ltx_td ltx_align_left">High</td>
<td id="A3.tab1.1.7.6.2" class="ltx_td ltx_align_left">40.2</td>
<td id="A3.tab1.1.7.6.3" class="ltx_td ltx_align_left ltx_border_r">2.8</td>
</tr>
<tr id="A3.tab1.1.8.7" class="ltx_tr">
<td id="A3.tab1.1.8.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_t" rowspan="3"><span id="A3.tab1.1.8.7.1.1" class="ltx_text ltx_font_bold">South</span></td>
<td id="A3.tab1.1.8.7.2" class="ltx_td ltx_align_left ltx_border_t">Low</td>
<td id="A3.tab1.1.8.7.3" class="ltx_td ltx_align_left ltx_border_t">39.53</td>
<td id="A3.tab1.1.8.7.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">18.27</td>
</tr>
<tr id="A3.tab1.1.9.8" class="ltx_tr">
<td id="A3.tab1.1.9.8.1" class="ltx_td ltx_align_left">Medium</td>
<td id="A3.tab1.1.9.8.2" class="ltx_td ltx_align_left">16.47</td>
<td id="A3.tab1.1.9.8.3" class="ltx_td ltx_align_left ltx_border_r">81.47</td>
</tr>
<tr id="A3.tab1.1.10.9" class="ltx_tr">
<td id="A3.tab1.1.10.9.1" class="ltx_td ltx_align_left">High</td>
<td id="A3.tab1.1.10.9.2" class="ltx_td ltx_align_left">44</td>
<td id="A3.tab1.1.10.9.3" class="ltx_td ltx_align_left ltx_border_r">0.27</td>
</tr>
<tr id="A3.tab1.1.11.10" class="ltx_tr">
<td id="A3.tab1.1.11.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_t" rowspan="3"><span id="A3.tab1.1.11.10.1.1" class="ltx_text ltx_font_bold">West</span></td>
<td id="A3.tab1.1.11.10.2" class="ltx_td ltx_align_left ltx_border_t">Low</td>
<td id="A3.tab1.1.11.10.3" class="ltx_td ltx_align_left ltx_border_t">51.87</td>
<td id="A3.tab1.1.11.10.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">24.6</td>
</tr>
<tr id="A3.tab1.1.12.11" class="ltx_tr">
<td id="A3.tab1.1.12.11.1" class="ltx_td ltx_align_left">Medium</td>
<td id="A3.tab1.1.12.11.2" class="ltx_td ltx_align_left">22.6</td>
<td id="A3.tab1.1.12.11.3" class="ltx_td ltx_align_left ltx_border_r">10.73</td>
</tr>
<tr id="A3.tab1.1.13.12" class="ltx_tr">
<td id="A3.tab1.1.13.12.1" class="ltx_td ltx_align_left ltx_border_b">High</td>
<td id="A3.tab1.1.13.12.2" class="ltx_td ltx_align_left ltx_border_b">25.53</td>
<td id="A3.tab1.1.13.12.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">64.67</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="A3.tab1.2" class="ltx_p ltx_figure_panel ltx_align_center"><span id="A3.tab1.2.1" class="ltx_text ltx_font_bold">Supp. Table 1.</span> Cluster distribution of each region for PCBFL and CBFL. All values expressed as a % of patients in the region</p>
</div>
</div>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Per site results: AUPRC</h2>

<figure id="A4.1" class="ltx_figure"><img src="/html/2307.08847/assets/AUPRC_site-1.png" id="A4.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="384" alt="Refer to caption">
<figcaption class="ltx_caption"><span id="A4.1.1.1" class="ltx_text ltx_font_bold">Supplementary Figure S1.</span> Model performance by site, AUPRC. Results for Single, FedAvg, CBFL and PCBFL. </figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Pseudocode</h2>

<figure id="algorithm1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.38.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Creating patient embeddings</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm1.39" class="ltx_p ltx_figure_panel"><span id="algorithm1.39.1" class="ltx_text"><span id="algorithm1.39.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>A set of patients across multiple sites, each associated with domains: observation, diagnosis, drug.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm1.1" class="ltx_p ltx_figure_panel"><span id="algorithm1.1.1" class="ltx_text"><span id="algorithm1.1.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>The patient embedding matrix <math id="algorithm1.1.m1.1" class="ltx_Math" alttext="\mathbf{E}" display="inline"><semantics id="algorithm1.1.m1.1a"><mi id="algorithm1.1.m1.1.1" xref="algorithm1.1.m1.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.m1.1b"><ci id="algorithm1.1.m1.1.1.cmml" xref="algorithm1.1.m1.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.m1.1c">\mathbf{E}</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm1.2" class="ltx_p ltx_figure_panel"><span id="algorithm1.2.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.2.1" class="ltx_emph ltx_font_italic">each <math id="algorithm1.2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="algorithm1.2.1.m1.1a"><mi id="algorithm1.2.1.m1.1.1" xref="algorithm1.2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.1.m1.1b"><ci id="algorithm1.2.1.m1.1.1.cmml" xref="algorithm1.2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.1.m1.1c">t</annotation></semantics></math> in domains observation, diagnosis, drug</em> <span id="algorithm1.2.3" class="ltx_text ltx_font_bold">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.40" class="ltx_block ltx_figure_panel">
<div id="algorithm1.7" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Initialize weights, <math id="algorithm1.3.m1.1" class="ltx_Math" alttext="w_{ae}" display="inline"><semantics id="algorithm1.3.m1.1a"><msub id="algorithm1.3.m1.1.1" xref="algorithm1.3.m1.1.1.cmml"><mi id="algorithm1.3.m1.1.1.2" xref="algorithm1.3.m1.1.1.2.cmml">w</mi><mrow id="algorithm1.3.m1.1.1.3" xref="algorithm1.3.m1.1.1.3.cmml"><mi id="algorithm1.3.m1.1.1.3.2" xref="algorithm1.3.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.m1.1.1.3.1" xref="algorithm1.3.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.3.m1.1.1.3.3" xref="algorithm1.3.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.m1.1b"><apply id="algorithm1.3.m1.1.1.cmml" xref="algorithm1.3.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.m1.1.1.1.cmml" xref="algorithm1.3.m1.1.1">subscript</csymbol><ci id="algorithm1.3.m1.1.1.2.cmml" xref="algorithm1.3.m1.1.1.2">𝑤</ci><apply id="algorithm1.3.m1.1.1.3.cmml" xref="algorithm1.3.m1.1.1.3"><times id="algorithm1.3.m1.1.1.3.1.cmml" xref="algorithm1.3.m1.1.1.3.1"></times><ci id="algorithm1.3.m1.1.1.3.2.cmml" xref="algorithm1.3.m1.1.1.3.2">𝑎</ci><ci id="algorithm1.3.m1.1.1.3.3.cmml" xref="algorithm1.3.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.m1.1c">w_{ae}</annotation></semantics></math>, of autoencoder model <math id="algorithm1.4.m2.1" class="ltx_Math" alttext="f_{ae}" display="inline"><semantics id="algorithm1.4.m2.1a"><msub id="algorithm1.4.m2.1.1" xref="algorithm1.4.m2.1.1.cmml"><mi id="algorithm1.4.m2.1.1.2" xref="algorithm1.4.m2.1.1.2.cmml">f</mi><mrow id="algorithm1.4.m2.1.1.3" xref="algorithm1.4.m2.1.1.3.cmml"><mi id="algorithm1.4.m2.1.1.3.2" xref="algorithm1.4.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.4.m2.1.1.3.1" xref="algorithm1.4.m2.1.1.3.1.cmml">​</mo><mi id="algorithm1.4.m2.1.1.3.3" xref="algorithm1.4.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.4.m2.1b"><apply id="algorithm1.4.m2.1.1.cmml" xref="algorithm1.4.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.4.m2.1.1.1.cmml" xref="algorithm1.4.m2.1.1">subscript</csymbol><ci id="algorithm1.4.m2.1.1.2.cmml" xref="algorithm1.4.m2.1.1.2">𝑓</ci><apply id="algorithm1.4.m2.1.1.3.cmml" xref="algorithm1.4.m2.1.1.3"><times id="algorithm1.4.m2.1.1.3.1.cmml" xref="algorithm1.4.m2.1.1.3.1"></times><ci id="algorithm1.4.m2.1.1.3.2.cmml" xref="algorithm1.4.m2.1.1.3.2">𝑎</ci><ci id="algorithm1.4.m2.1.1.3.3.cmml" xref="algorithm1.4.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.m2.1c">f_{ae}</annotation></semantics></math> 
<span id="algorithm1.7.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.7.3" class="ltx_emph ltx_font_italic">each round <math id="algorithm1.5.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.5.1.m1.1a"><mi id="algorithm1.5.1.m1.1.1" xref="algorithm1.5.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.1.m1.1b"><ci id="algorithm1.5.1.m1.1.1.cmml" xref="algorithm1.5.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.1.m1.1c">i</annotation></semantics></math> from <math id="algorithm1.6.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm1.6.2.m2.1a"><mn id="algorithm1.6.2.m2.1.1" xref="algorithm1.6.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm1.6.2.m2.1b"><cn type="integer" id="algorithm1.6.2.m2.1.1.cmml" xref="algorithm1.6.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.2.m2.1c">1</annotation></semantics></math> to <math id="algorithm1.7.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="algorithm1.7.3.m3.1a"><mn id="algorithm1.7.3.m3.1.1" xref="algorithm1.7.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="algorithm1.7.3.m3.1b"><cn type="integer" id="algorithm1.7.3.m3.1.1.cmml" xref="algorithm1.7.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.3.m3.1c">20</annotation></semantics></math></em> <span id="algorithm1.7.5" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.10.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.10.3" class="ltx_emph ltx_font_italic">each site <math id="algorithm1.8.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.8.1.m1.1a"><mi id="algorithm1.8.1.m1.1.1" xref="algorithm1.8.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.1.m1.1b"><ci id="algorithm1.8.1.m1.1.1.cmml" xref="algorithm1.8.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.1.m1.1c">c</annotation></semantics></math> from <math id="algorithm1.9.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm1.9.2.m2.1a"><mn id="algorithm1.9.2.m2.1.1" xref="algorithm1.9.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm1.9.2.m2.1b"><cn type="integer" id="algorithm1.9.2.m2.1.1.cmml" xref="algorithm1.9.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.2.m2.1c">1</annotation></semantics></math> to <math id="algorithm1.10.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.10.3.m3.1a"><mi id="algorithm1.10.3.m3.1.1" xref="algorithm1.10.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.10.3.m3.1b"><ci id="algorithm1.10.3.m3.1.1.cmml" xref="algorithm1.10.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.3.m3.1c">C</annotation></semantics></math> in <span id="algorithm1.10.3.1" class="ltx_text ltx_font_bold">parallel</span></em> <span id="algorithm1.10.5" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.41" class="ltx_block ltx_figure_panel">
<div id="algorithm1.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Train <math id="algorithm1.11.m1.1" class="ltx_Math" alttext="f_{ae}" display="inline"><semantics id="algorithm1.11.m1.1a"><msub id="algorithm1.11.m1.1.1" xref="algorithm1.11.m1.1.1.cmml"><mi id="algorithm1.11.m1.1.1.2" xref="algorithm1.11.m1.1.1.2.cmml">f</mi><mrow id="algorithm1.11.m1.1.1.3" xref="algorithm1.11.m1.1.1.3.cmml"><mi id="algorithm1.11.m1.1.1.3.2" xref="algorithm1.11.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.11.m1.1.1.3.1" xref="algorithm1.11.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.11.m1.1.1.3.3" xref="algorithm1.11.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.11.m1.1b"><apply id="algorithm1.11.m1.1.1.cmml" xref="algorithm1.11.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.m1.1.1.1.cmml" xref="algorithm1.11.m1.1.1">subscript</csymbol><ci id="algorithm1.11.m1.1.1.2.cmml" xref="algorithm1.11.m1.1.1.2">𝑓</ci><apply id="algorithm1.11.m1.1.1.3.cmml" xref="algorithm1.11.m1.1.1.3"><times id="algorithm1.11.m1.1.1.3.1.cmml" xref="algorithm1.11.m1.1.1.3.1"></times><ci id="algorithm1.11.m1.1.1.3.2.cmml" xref="algorithm1.11.m1.1.1.3.2">𝑎</ci><ci id="algorithm1.11.m1.1.1.3.3.cmml" xref="algorithm1.11.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.m1.1c">f_{ae}</annotation></semantics></math> for 20 epochs to obtain <math id="algorithm1.12.m2.2" class="ltx_Math" alttext="w^{c}_{i,ae}" display="inline"><semantics id="algorithm1.12.m2.2a"><msubsup id="algorithm1.12.m2.2.3" xref="algorithm1.12.m2.2.3.cmml"><mi id="algorithm1.12.m2.2.3.2.2" xref="algorithm1.12.m2.2.3.2.2.cmml">w</mi><mrow id="algorithm1.12.m2.2.2.2.2" xref="algorithm1.12.m2.2.2.2.3.cmml"><mi id="algorithm1.12.m2.1.1.1.1" xref="algorithm1.12.m2.1.1.1.1.cmml">i</mi><mo id="algorithm1.12.m2.2.2.2.2.2" xref="algorithm1.12.m2.2.2.2.3.cmml">,</mo><mrow id="algorithm1.12.m2.2.2.2.2.1" xref="algorithm1.12.m2.2.2.2.2.1.cmml"><mi id="algorithm1.12.m2.2.2.2.2.1.2" xref="algorithm1.12.m2.2.2.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.12.m2.2.2.2.2.1.1" xref="algorithm1.12.m2.2.2.2.2.1.1.cmml">​</mo><mi id="algorithm1.12.m2.2.2.2.2.1.3" xref="algorithm1.12.m2.2.2.2.2.1.3.cmml">e</mi></mrow></mrow><mi id="algorithm1.12.m2.2.3.2.3" xref="algorithm1.12.m2.2.3.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.12.m2.2b"><apply id="algorithm1.12.m2.2.3.cmml" xref="algorithm1.12.m2.2.3"><csymbol cd="ambiguous" id="algorithm1.12.m2.2.3.1.cmml" xref="algorithm1.12.m2.2.3">subscript</csymbol><apply id="algorithm1.12.m2.2.3.2.cmml" xref="algorithm1.12.m2.2.3"><csymbol cd="ambiguous" id="algorithm1.12.m2.2.3.2.1.cmml" xref="algorithm1.12.m2.2.3">superscript</csymbol><ci id="algorithm1.12.m2.2.3.2.2.cmml" xref="algorithm1.12.m2.2.3.2.2">𝑤</ci><ci id="algorithm1.12.m2.2.3.2.3.cmml" xref="algorithm1.12.m2.2.3.2.3">𝑐</ci></apply><list id="algorithm1.12.m2.2.2.2.3.cmml" xref="algorithm1.12.m2.2.2.2.2"><ci id="algorithm1.12.m2.1.1.1.1.cmml" xref="algorithm1.12.m2.1.1.1.1">𝑖</ci><apply id="algorithm1.12.m2.2.2.2.2.1.cmml" xref="algorithm1.12.m2.2.2.2.2.1"><times id="algorithm1.12.m2.2.2.2.2.1.1.cmml" xref="algorithm1.12.m2.2.2.2.2.1.1"></times><ci id="algorithm1.12.m2.2.2.2.2.1.2.cmml" xref="algorithm1.12.m2.2.2.2.2.1.2">𝑎</ci><ci id="algorithm1.12.m2.2.2.2.2.1.3.cmml" xref="algorithm1.12.m2.2.2.2.2.1.3">𝑒</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.m2.2c">w^{c}_{i,ae}</annotation></semantics></math> 
<span id="algorithm1.15.2" class="ltx_text ltx_font_typewriter">// </span><math id="algorithm1.13.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.13.m3.1a"><mi id="algorithm1.13.m3.1.1" xref="algorithm1.13.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.m3.1b"><ci id="algorithm1.13.m3.1.1.cmml" xref="algorithm1.13.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.m3.1c">c</annotation></semantics></math><span id="algorithm1.14.1" class="ltx_text ltx_font_typewriter"> is the site index and <math id="algorithm1.14.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.14.1.m1.1a"><mi id="algorithm1.14.1.m1.1.1" xref="algorithm1.14.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.14.1.m1.1b"><ci id="algorithm1.14.1.m1.1.1.cmml" xref="algorithm1.14.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.1.m1.1c">i</annotation></semantics></math> is the training round index </span>
<span id="algorithm1.15.3" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.15.m4.2" class="ltx_Math" alttext="w^{c}_{i,ae}" display="inline"><semantics id="algorithm1.15.m4.2a"><msubsup id="algorithm1.15.m4.2.3" xref="algorithm1.15.m4.2.3.cmml"><mi id="algorithm1.15.m4.2.3.2.2" xref="algorithm1.15.m4.2.3.2.2.cmml">w</mi><mrow id="algorithm1.15.m4.2.2.2.2" xref="algorithm1.15.m4.2.2.2.3.cmml"><mi id="algorithm1.15.m4.1.1.1.1" xref="algorithm1.15.m4.1.1.1.1.cmml">i</mi><mo id="algorithm1.15.m4.2.2.2.2.2" xref="algorithm1.15.m4.2.2.2.3.cmml">,</mo><mrow id="algorithm1.15.m4.2.2.2.2.1" xref="algorithm1.15.m4.2.2.2.2.1.cmml"><mi id="algorithm1.15.m4.2.2.2.2.1.2" xref="algorithm1.15.m4.2.2.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.15.m4.2.2.2.2.1.1" xref="algorithm1.15.m4.2.2.2.2.1.1.cmml">​</mo><mi id="algorithm1.15.m4.2.2.2.2.1.3" xref="algorithm1.15.m4.2.2.2.2.1.3.cmml">e</mi></mrow></mrow><mi id="algorithm1.15.m4.2.3.2.3" xref="algorithm1.15.m4.2.3.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.15.m4.2b"><apply id="algorithm1.15.m4.2.3.cmml" xref="algorithm1.15.m4.2.3"><csymbol cd="ambiguous" id="algorithm1.15.m4.2.3.1.cmml" xref="algorithm1.15.m4.2.3">subscript</csymbol><apply id="algorithm1.15.m4.2.3.2.cmml" xref="algorithm1.15.m4.2.3"><csymbol cd="ambiguous" id="algorithm1.15.m4.2.3.2.1.cmml" xref="algorithm1.15.m4.2.3">superscript</csymbol><ci id="algorithm1.15.m4.2.3.2.2.cmml" xref="algorithm1.15.m4.2.3.2.2">𝑤</ci><ci id="algorithm1.15.m4.2.3.2.3.cmml" xref="algorithm1.15.m4.2.3.2.3">𝑐</ci></apply><list id="algorithm1.15.m4.2.2.2.3.cmml" xref="algorithm1.15.m4.2.2.2.2"><ci id="algorithm1.15.m4.1.1.1.1.cmml" xref="algorithm1.15.m4.1.1.1.1">𝑖</ci><apply id="algorithm1.15.m4.2.2.2.2.1.cmml" xref="algorithm1.15.m4.2.2.2.2.1"><times id="algorithm1.15.m4.2.2.2.2.1.1.cmml" xref="algorithm1.15.m4.2.2.2.2.1.1"></times><ci id="algorithm1.15.m4.2.2.2.2.1.2.cmml" xref="algorithm1.15.m4.2.2.2.2.1.2">𝑎</ci><ci id="algorithm1.15.m4.2.2.2.2.1.3.cmml" xref="algorithm1.15.m4.2.2.2.2.1.3">𝑒</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.m4.2c">w^{c}_{i,ae}</annotation></semantics></math> to server 

</div>
<div id="algorithm1.41.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.42" class="ltx_block ltx_figure_panel">
<div id="algorithm1.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Server updates weights using <math id="algorithm1.16.m1.4" class="ltx_Math" alttext="w_{i+1,ae}\leftarrow\sum^{C}_{c=1}\frac{n^{c}}{N}w^{c}_{i,ae}" display="inline"><semantics id="algorithm1.16.m1.4a"><mrow id="algorithm1.16.m1.4.5" xref="algorithm1.16.m1.4.5.cmml"><msub id="algorithm1.16.m1.4.5.2" xref="algorithm1.16.m1.4.5.2.cmml"><mi id="algorithm1.16.m1.4.5.2.2" xref="algorithm1.16.m1.4.5.2.2.cmml">w</mi><mrow id="algorithm1.16.m1.2.2.2.2" xref="algorithm1.16.m1.2.2.2.3.cmml"><mrow id="algorithm1.16.m1.1.1.1.1.1" xref="algorithm1.16.m1.1.1.1.1.1.cmml"><mi id="algorithm1.16.m1.1.1.1.1.1.2" xref="algorithm1.16.m1.1.1.1.1.1.2.cmml">i</mi><mo id="algorithm1.16.m1.1.1.1.1.1.1" xref="algorithm1.16.m1.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm1.16.m1.1.1.1.1.1.3" xref="algorithm1.16.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm1.16.m1.2.2.2.2.3" xref="algorithm1.16.m1.2.2.2.3.cmml">,</mo><mrow id="algorithm1.16.m1.2.2.2.2.2" xref="algorithm1.16.m1.2.2.2.2.2.cmml"><mi id="algorithm1.16.m1.2.2.2.2.2.2" xref="algorithm1.16.m1.2.2.2.2.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.m1.2.2.2.2.2.1" xref="algorithm1.16.m1.2.2.2.2.2.1.cmml">​</mo><mi id="algorithm1.16.m1.2.2.2.2.2.3" xref="algorithm1.16.m1.2.2.2.2.2.3.cmml">e</mi></mrow></mrow></msub><mo rspace="0.111em" stretchy="false" id="algorithm1.16.m1.4.5.1" xref="algorithm1.16.m1.4.5.1.cmml">←</mo><mrow id="algorithm1.16.m1.4.5.3" xref="algorithm1.16.m1.4.5.3.cmml"><msubsup id="algorithm1.16.m1.4.5.3.1" xref="algorithm1.16.m1.4.5.3.1.cmml"><mo id="algorithm1.16.m1.4.5.3.1.2.2" xref="algorithm1.16.m1.4.5.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.16.m1.4.5.3.1.3" xref="algorithm1.16.m1.4.5.3.1.3.cmml"><mi id="algorithm1.16.m1.4.5.3.1.3.2" xref="algorithm1.16.m1.4.5.3.1.3.2.cmml">c</mi><mo id="algorithm1.16.m1.4.5.3.1.3.1" xref="algorithm1.16.m1.4.5.3.1.3.1.cmml">=</mo><mn id="algorithm1.16.m1.4.5.3.1.3.3" xref="algorithm1.16.m1.4.5.3.1.3.3.cmml">1</mn></mrow><mi id="algorithm1.16.m1.4.5.3.1.2.3" xref="algorithm1.16.m1.4.5.3.1.2.3.cmml">C</mi></msubsup><mrow id="algorithm1.16.m1.4.5.3.2" xref="algorithm1.16.m1.4.5.3.2.cmml"><mfrac id="algorithm1.16.m1.4.5.3.2.2" xref="algorithm1.16.m1.4.5.3.2.2.cmml"><msup id="algorithm1.16.m1.4.5.3.2.2.2" xref="algorithm1.16.m1.4.5.3.2.2.2.cmml"><mi id="algorithm1.16.m1.4.5.3.2.2.2.2" xref="algorithm1.16.m1.4.5.3.2.2.2.2.cmml">n</mi><mi id="algorithm1.16.m1.4.5.3.2.2.2.3" xref="algorithm1.16.m1.4.5.3.2.2.2.3.cmml">c</mi></msup><mi id="algorithm1.16.m1.4.5.3.2.2.3" xref="algorithm1.16.m1.4.5.3.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.16.m1.4.5.3.2.1" xref="algorithm1.16.m1.4.5.3.2.1.cmml">​</mo><msubsup id="algorithm1.16.m1.4.5.3.2.3" xref="algorithm1.16.m1.4.5.3.2.3.cmml"><mi id="algorithm1.16.m1.4.5.3.2.3.2.2" xref="algorithm1.16.m1.4.5.3.2.3.2.2.cmml">w</mi><mrow id="algorithm1.16.m1.4.4.2.2" xref="algorithm1.16.m1.4.4.2.3.cmml"><mi id="algorithm1.16.m1.3.3.1.1" xref="algorithm1.16.m1.3.3.1.1.cmml">i</mi><mo id="algorithm1.16.m1.4.4.2.2.2" xref="algorithm1.16.m1.4.4.2.3.cmml">,</mo><mrow id="algorithm1.16.m1.4.4.2.2.1" xref="algorithm1.16.m1.4.4.2.2.1.cmml"><mi id="algorithm1.16.m1.4.4.2.2.1.2" xref="algorithm1.16.m1.4.4.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.m1.4.4.2.2.1.1" xref="algorithm1.16.m1.4.4.2.2.1.1.cmml">​</mo><mi id="algorithm1.16.m1.4.4.2.2.1.3" xref="algorithm1.16.m1.4.4.2.2.1.3.cmml">e</mi></mrow></mrow><mi id="algorithm1.16.m1.4.5.3.2.3.2.3" xref="algorithm1.16.m1.4.5.3.2.3.2.3.cmml">c</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.m1.4b"><apply id="algorithm1.16.m1.4.5.cmml" xref="algorithm1.16.m1.4.5"><ci id="algorithm1.16.m1.4.5.1.cmml" xref="algorithm1.16.m1.4.5.1">←</ci><apply id="algorithm1.16.m1.4.5.2.cmml" xref="algorithm1.16.m1.4.5.2"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.2.1.cmml" xref="algorithm1.16.m1.4.5.2">subscript</csymbol><ci id="algorithm1.16.m1.4.5.2.2.cmml" xref="algorithm1.16.m1.4.5.2.2">𝑤</ci><list id="algorithm1.16.m1.2.2.2.3.cmml" xref="algorithm1.16.m1.2.2.2.2"><apply id="algorithm1.16.m1.1.1.1.1.1.cmml" xref="algorithm1.16.m1.1.1.1.1.1"><plus id="algorithm1.16.m1.1.1.1.1.1.1.cmml" xref="algorithm1.16.m1.1.1.1.1.1.1"></plus><ci id="algorithm1.16.m1.1.1.1.1.1.2.cmml" xref="algorithm1.16.m1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="algorithm1.16.m1.1.1.1.1.1.3.cmml" xref="algorithm1.16.m1.1.1.1.1.1.3">1</cn></apply><apply id="algorithm1.16.m1.2.2.2.2.2.cmml" xref="algorithm1.16.m1.2.2.2.2.2"><times id="algorithm1.16.m1.2.2.2.2.2.1.cmml" xref="algorithm1.16.m1.2.2.2.2.2.1"></times><ci id="algorithm1.16.m1.2.2.2.2.2.2.cmml" xref="algorithm1.16.m1.2.2.2.2.2.2">𝑎</ci><ci id="algorithm1.16.m1.2.2.2.2.2.3.cmml" xref="algorithm1.16.m1.2.2.2.2.2.3">𝑒</ci></apply></list></apply><apply id="algorithm1.16.m1.4.5.3.cmml" xref="algorithm1.16.m1.4.5.3"><apply id="algorithm1.16.m1.4.5.3.1.cmml" xref="algorithm1.16.m1.4.5.3.1"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.3.1.1.cmml" xref="algorithm1.16.m1.4.5.3.1">subscript</csymbol><apply id="algorithm1.16.m1.4.5.3.1.2.cmml" xref="algorithm1.16.m1.4.5.3.1"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.3.1.2.1.cmml" xref="algorithm1.16.m1.4.5.3.1">superscript</csymbol><sum id="algorithm1.16.m1.4.5.3.1.2.2.cmml" xref="algorithm1.16.m1.4.5.3.1.2.2"></sum><ci id="algorithm1.16.m1.4.5.3.1.2.3.cmml" xref="algorithm1.16.m1.4.5.3.1.2.3">𝐶</ci></apply><apply id="algorithm1.16.m1.4.5.3.1.3.cmml" xref="algorithm1.16.m1.4.5.3.1.3"><eq id="algorithm1.16.m1.4.5.3.1.3.1.cmml" xref="algorithm1.16.m1.4.5.3.1.3.1"></eq><ci id="algorithm1.16.m1.4.5.3.1.3.2.cmml" xref="algorithm1.16.m1.4.5.3.1.3.2">𝑐</ci><cn type="integer" id="algorithm1.16.m1.4.5.3.1.3.3.cmml" xref="algorithm1.16.m1.4.5.3.1.3.3">1</cn></apply></apply><apply id="algorithm1.16.m1.4.5.3.2.cmml" xref="algorithm1.16.m1.4.5.3.2"><times id="algorithm1.16.m1.4.5.3.2.1.cmml" xref="algorithm1.16.m1.4.5.3.2.1"></times><apply id="algorithm1.16.m1.4.5.3.2.2.cmml" xref="algorithm1.16.m1.4.5.3.2.2"><divide id="algorithm1.16.m1.4.5.3.2.2.1.cmml" xref="algorithm1.16.m1.4.5.3.2.2"></divide><apply id="algorithm1.16.m1.4.5.3.2.2.2.cmml" xref="algorithm1.16.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.3.2.2.2.1.cmml" xref="algorithm1.16.m1.4.5.3.2.2.2">superscript</csymbol><ci id="algorithm1.16.m1.4.5.3.2.2.2.2.cmml" xref="algorithm1.16.m1.4.5.3.2.2.2.2">𝑛</ci><ci id="algorithm1.16.m1.4.5.3.2.2.2.3.cmml" xref="algorithm1.16.m1.4.5.3.2.2.2.3">𝑐</ci></apply><ci id="algorithm1.16.m1.4.5.3.2.2.3.cmml" xref="algorithm1.16.m1.4.5.3.2.2.3">𝑁</ci></apply><apply id="algorithm1.16.m1.4.5.3.2.3.cmml" xref="algorithm1.16.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.3.2.3.1.cmml" xref="algorithm1.16.m1.4.5.3.2.3">subscript</csymbol><apply id="algorithm1.16.m1.4.5.3.2.3.2.cmml" xref="algorithm1.16.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="algorithm1.16.m1.4.5.3.2.3.2.1.cmml" xref="algorithm1.16.m1.4.5.3.2.3">superscript</csymbol><ci id="algorithm1.16.m1.4.5.3.2.3.2.2.cmml" xref="algorithm1.16.m1.4.5.3.2.3.2.2">𝑤</ci><ci id="algorithm1.16.m1.4.5.3.2.3.2.3.cmml" xref="algorithm1.16.m1.4.5.3.2.3.2.3">𝑐</ci></apply><list id="algorithm1.16.m1.4.4.2.3.cmml" xref="algorithm1.16.m1.4.4.2.2"><ci id="algorithm1.16.m1.3.3.1.1.cmml" xref="algorithm1.16.m1.3.3.1.1">𝑖</ci><apply id="algorithm1.16.m1.4.4.2.2.1.cmml" xref="algorithm1.16.m1.4.4.2.2.1"><times id="algorithm1.16.m1.4.4.2.2.1.1.cmml" xref="algorithm1.16.m1.4.4.2.2.1.1"></times><ci id="algorithm1.16.m1.4.4.2.2.1.2.cmml" xref="algorithm1.16.m1.4.4.2.2.1.2">𝑎</ci><ci id="algorithm1.16.m1.4.4.2.2.1.3.cmml" xref="algorithm1.16.m1.4.4.2.2.1.3">𝑒</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.m1.4c">w_{i+1,ae}\leftarrow\sum^{C}_{c=1}\frac{n^{c}}{N}w^{c}_{i,ae}</annotation></semantics></math> 
<span id="algorithm1.19.3" class="ltx_text ltx_font_typewriter">// </span><math id="algorithm1.17.m2.1" class="ltx_Math" alttext="n^{c}" display="inline"><semantics id="algorithm1.17.m2.1a"><msup id="algorithm1.17.m2.1.1" xref="algorithm1.17.m2.1.1.cmml"><mi id="algorithm1.17.m2.1.1.2" xref="algorithm1.17.m2.1.1.2.cmml">n</mi><mi id="algorithm1.17.m2.1.1.3" xref="algorithm1.17.m2.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.17.m2.1b"><apply id="algorithm1.17.m2.1.1.cmml" xref="algorithm1.17.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.17.m2.1.1.1.cmml" xref="algorithm1.17.m2.1.1">superscript</csymbol><ci id="algorithm1.17.m2.1.1.2.cmml" xref="algorithm1.17.m2.1.1.2">𝑛</ci><ci id="algorithm1.17.m2.1.1.3.cmml" xref="algorithm1.17.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.m2.1c">n^{c}</annotation></semantics></math><span id="algorithm1.19.2" class="ltx_text ltx_font_typewriter"> is number of patients at site <math id="algorithm1.18.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.18.1.m1.1a"><mi id="algorithm1.18.1.m1.1.1" xref="algorithm1.18.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.18.1.m1.1b"><ci id="algorithm1.18.1.m1.1.1.cmml" xref="algorithm1.18.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.1.m1.1c">c</annotation></semantics></math>, <math id="algorithm1.19.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.19.2.m2.1a"><mi id="algorithm1.19.2.m2.1.1" xref="algorithm1.19.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.19.2.m2.1b"><ci id="algorithm1.19.2.m2.1.1.cmml" xref="algorithm1.19.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.2.m2.1c">N</annotation></semantics></math> is total number of patients </span>

</div>
<div id="algorithm1.42.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.43" class="ltx_block ltx_figure_panel">
<div id="algorithm1.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   set final model <math id="algorithm1.20.m1.1" class="ltx_Math" alttext="f^{g}_{ae}\leftarrow f_{ae}" display="inline"><semantics id="algorithm1.20.m1.1a"><mrow id="algorithm1.20.m1.1.1" xref="algorithm1.20.m1.1.1.cmml"><msubsup id="algorithm1.20.m1.1.1.2" xref="algorithm1.20.m1.1.1.2.cmml"><mi id="algorithm1.20.m1.1.1.2.2.2" xref="algorithm1.20.m1.1.1.2.2.2.cmml">f</mi><mrow id="algorithm1.20.m1.1.1.2.3" xref="algorithm1.20.m1.1.1.2.3.cmml"><mi id="algorithm1.20.m1.1.1.2.3.2" xref="algorithm1.20.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.20.m1.1.1.2.3.1" xref="algorithm1.20.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.20.m1.1.1.2.3.3" xref="algorithm1.20.m1.1.1.2.3.3.cmml">e</mi></mrow><mi id="algorithm1.20.m1.1.1.2.2.3" xref="algorithm1.20.m1.1.1.2.2.3.cmml">g</mi></msubsup><mo stretchy="false" id="algorithm1.20.m1.1.1.1" xref="algorithm1.20.m1.1.1.1.cmml">←</mo><msub id="algorithm1.20.m1.1.1.3" xref="algorithm1.20.m1.1.1.3.cmml"><mi id="algorithm1.20.m1.1.1.3.2" xref="algorithm1.20.m1.1.1.3.2.cmml">f</mi><mrow id="algorithm1.20.m1.1.1.3.3" xref="algorithm1.20.m1.1.1.3.3.cmml"><mi id="algorithm1.20.m1.1.1.3.3.2" xref="algorithm1.20.m1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.20.m1.1.1.3.3.1" xref="algorithm1.20.m1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.20.m1.1.1.3.3.3" xref="algorithm1.20.m1.1.1.3.3.3.cmml">e</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.m1.1b"><apply id="algorithm1.20.m1.1.1.cmml" xref="algorithm1.20.m1.1.1"><ci id="algorithm1.20.m1.1.1.1.cmml" xref="algorithm1.20.m1.1.1.1">←</ci><apply id="algorithm1.20.m1.1.1.2.cmml" xref="algorithm1.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.m1.1.1.2.1.cmml" xref="algorithm1.20.m1.1.1.2">subscript</csymbol><apply id="algorithm1.20.m1.1.1.2.2.cmml" xref="algorithm1.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.m1.1.1.2.2.1.cmml" xref="algorithm1.20.m1.1.1.2">superscript</csymbol><ci id="algorithm1.20.m1.1.1.2.2.2.cmml" xref="algorithm1.20.m1.1.1.2.2.2">𝑓</ci><ci id="algorithm1.20.m1.1.1.2.2.3.cmml" xref="algorithm1.20.m1.1.1.2.2.3">𝑔</ci></apply><apply id="algorithm1.20.m1.1.1.2.3.cmml" xref="algorithm1.20.m1.1.1.2.3"><times id="algorithm1.20.m1.1.1.2.3.1.cmml" xref="algorithm1.20.m1.1.1.2.3.1"></times><ci id="algorithm1.20.m1.1.1.2.3.2.cmml" xref="algorithm1.20.m1.1.1.2.3.2">𝑎</ci><ci id="algorithm1.20.m1.1.1.2.3.3.cmml" xref="algorithm1.20.m1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="algorithm1.20.m1.1.1.3.cmml" xref="algorithm1.20.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.20.m1.1.1.3.1.cmml" xref="algorithm1.20.m1.1.1.3">subscript</csymbol><ci id="algorithm1.20.m1.1.1.3.2.cmml" xref="algorithm1.20.m1.1.1.3.2">𝑓</ci><apply id="algorithm1.20.m1.1.1.3.3.cmml" xref="algorithm1.20.m1.1.1.3.3"><times id="algorithm1.20.m1.1.1.3.3.1.cmml" xref="algorithm1.20.m1.1.1.3.3.1"></times><ci id="algorithm1.20.m1.1.1.3.3.2.cmml" xref="algorithm1.20.m1.1.1.3.3.2">𝑎</ci><ci id="algorithm1.20.m1.1.1.3.3.3.cmml" xref="algorithm1.20.m1.1.1.3.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.m1.1c">f^{g}_{ae}\leftarrow f_{ae}</annotation></semantics></math> 

</div>
<div id="algorithm1.43.1" class="ltx_listingline"> end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.44" class="ltx_block ltx_figure_panel">
<div id="algorithm1.23" class="ltx_listingline">
<span id="algorithm1.23.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.23.3" class="ltx_emph ltx_font_italic">each site <math id="algorithm1.21.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.21.1.m1.1a"><mi id="algorithm1.21.1.m1.1.1" xref="algorithm1.21.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.21.1.m1.1b"><ci id="algorithm1.21.1.m1.1.1.cmml" xref="algorithm1.21.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.1.m1.1c">c</annotation></semantics></math> from <math id="algorithm1.22.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm1.22.2.m2.1a"><mn id="algorithm1.22.2.m2.1.1" xref="algorithm1.22.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm1.22.2.m2.1b"><cn type="integer" id="algorithm1.22.2.m2.1.1.cmml" xref="algorithm1.22.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.2.m2.1c">1</annotation></semantics></math> to <math id="algorithm1.23.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.23.3.m3.1a"><mi id="algorithm1.23.3.m3.1.1" xref="algorithm1.23.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.23.3.m3.1b"><ci id="algorithm1.23.3.m3.1.1.cmml" xref="algorithm1.23.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.3.m3.1c">C</annotation></semantics></math> in <span id="algorithm1.23.3.1" class="ltx_text ltx_font_bold">parallel</span></em> <span id="algorithm1.23.5" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Create embedding matrix <math id="algorithm1.24.m1.1" class="ltx_Math" alttext="\mathbf{E}^{|P_{c}|\times D}" display="inline"><semantics id="algorithm1.24.m1.1a"><msup id="algorithm1.24.m1.1.2" xref="algorithm1.24.m1.1.2.cmml"><mi id="algorithm1.24.m1.1.2.2" xref="algorithm1.24.m1.1.2.2.cmml">𝐄</mi><mrow id="algorithm1.24.m1.1.1.1" xref="algorithm1.24.m1.1.1.1.cmml"><mrow id="algorithm1.24.m1.1.1.1.1.1" xref="algorithm1.24.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.24.m1.1.1.1.1.1.2" xref="algorithm1.24.m1.1.1.1.1.2.1.cmml">|</mo><msub id="algorithm1.24.m1.1.1.1.1.1.1" xref="algorithm1.24.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.24.m1.1.1.1.1.1.1.2" xref="algorithm1.24.m1.1.1.1.1.1.1.2.cmml">P</mi><mi id="algorithm1.24.m1.1.1.1.1.1.1.3" xref="algorithm1.24.m1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo rspace="0.055em" stretchy="false" id="algorithm1.24.m1.1.1.1.1.1.3" xref="algorithm1.24.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="algorithm1.24.m1.1.1.1.2" xref="algorithm1.24.m1.1.1.1.2.cmml">×</mo><mi id="algorithm1.24.m1.1.1.1.3" xref="algorithm1.24.m1.1.1.1.3.cmml">D</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.24.m1.1b"><apply id="algorithm1.24.m1.1.2.cmml" xref="algorithm1.24.m1.1.2"><csymbol cd="ambiguous" id="algorithm1.24.m1.1.2.1.cmml" xref="algorithm1.24.m1.1.2">superscript</csymbol><ci id="algorithm1.24.m1.1.2.2.cmml" xref="algorithm1.24.m1.1.2.2">𝐄</ci><apply id="algorithm1.24.m1.1.1.1.cmml" xref="algorithm1.24.m1.1.1.1"><times id="algorithm1.24.m1.1.1.1.2.cmml" xref="algorithm1.24.m1.1.1.1.2"></times><apply id="algorithm1.24.m1.1.1.1.1.2.cmml" xref="algorithm1.24.m1.1.1.1.1.1"><abs id="algorithm1.24.m1.1.1.1.1.2.1.cmml" xref="algorithm1.24.m1.1.1.1.1.1.2"></abs><apply id="algorithm1.24.m1.1.1.1.1.1.1.cmml" xref="algorithm1.24.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.24.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.24.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.24.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.24.m1.1.1.1.1.1.1.2">𝑃</ci><ci id="algorithm1.24.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.24.m1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><ci id="algorithm1.24.m1.1.1.1.3.cmml" xref="algorithm1.24.m1.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.m1.1c">\mathbf{E}^{|P_{c}|\times D}</annotation></semantics></math> 
<span id="algorithm1.29.5" class="ltx_text ltx_font_typewriter">// </span><math id="algorithm1.25.m2.1" class="ltx_Math" alttext="|P_{c}|" display="inline"><semantics id="algorithm1.25.m2.1a"><mrow id="algorithm1.25.m2.1.1.1" xref="algorithm1.25.m2.1.1.2.cmml"><mo stretchy="false" id="algorithm1.25.m2.1.1.1.2" xref="algorithm1.25.m2.1.1.2.1.cmml">|</mo><msub id="algorithm1.25.m2.1.1.1.1" xref="algorithm1.25.m2.1.1.1.1.cmml"><mi id="algorithm1.25.m2.1.1.1.1.2" xref="algorithm1.25.m2.1.1.1.1.2.cmml">P</mi><mi id="algorithm1.25.m2.1.1.1.1.3" xref="algorithm1.25.m2.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="algorithm1.25.m2.1.1.1.3" xref="algorithm1.25.m2.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.m2.1b"><apply id="algorithm1.25.m2.1.1.2.cmml" xref="algorithm1.25.m2.1.1.1"><abs id="algorithm1.25.m2.1.1.2.1.cmml" xref="algorithm1.25.m2.1.1.1.2"></abs><apply id="algorithm1.25.m2.1.1.1.1.cmml" xref="algorithm1.25.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.25.m2.1.1.1.1.1.cmml" xref="algorithm1.25.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.25.m2.1.1.1.1.2.cmml" xref="algorithm1.25.m2.1.1.1.1.2">𝑃</ci><ci id="algorithm1.25.m2.1.1.1.1.3.cmml" xref="algorithm1.25.m2.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.m2.1c">|P_{c}|</annotation></semantics></math><span id="algorithm1.27.2" class="ltx_text ltx_font_typewriter"> is the number of patients at site <math id="algorithm1.26.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.26.1.m1.1a"><mi id="algorithm1.26.1.m1.1.1" xref="algorithm1.26.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.26.1.m1.1b"><ci id="algorithm1.26.1.m1.1.1.cmml" xref="algorithm1.26.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.1.m1.1c">c</annotation></semantics></math> and <math id="algorithm1.27.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="algorithm1.27.2.m2.1a"><mi id="algorithm1.27.2.m2.1.1" xref="algorithm1.27.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="algorithm1.27.2.m2.1b"><ci id="algorithm1.27.2.m2.1.1.cmml" xref="algorithm1.27.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.2.m2.1c">D</annotation></semantics></math> is the embedding dimension </span>
<span id="algorithm1.29.6" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.29.4" class="ltx_emph ltx_font_italic">each patient <math id="algorithm1.28.3.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="algorithm1.28.3.m1.1a"><mi id="algorithm1.28.3.m1.1.1" xref="algorithm1.28.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="algorithm1.28.3.m1.1b"><ci id="algorithm1.28.3.m1.1.1.cmml" xref="algorithm1.28.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.3.m1.1c">p</annotation></semantics></math> in patient set, <math id="algorithm1.29.4.m2.1" class="ltx_Math" alttext="P_{c}" display="inline"><semantics id="algorithm1.29.4.m2.1a"><msub id="algorithm1.29.4.m2.1.1" xref="algorithm1.29.4.m2.1.1.cmml"><mi id="algorithm1.29.4.m2.1.1.2" xref="algorithm1.29.4.m2.1.1.2.cmml">P</mi><mi id="algorithm1.29.4.m2.1.1.3" xref="algorithm1.29.4.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.29.4.m2.1b"><apply id="algorithm1.29.4.m2.1.1.cmml" xref="algorithm1.29.4.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.29.4.m2.1.1.1.cmml" xref="algorithm1.29.4.m2.1.1">subscript</csymbol><ci id="algorithm1.29.4.m2.1.1.2.cmml" xref="algorithm1.29.4.m2.1.1.2">𝑃</ci><ci id="algorithm1.29.4.m2.1.1.3.cmml" xref="algorithm1.29.4.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.4.m2.1c">P_{c}</annotation></semantics></math></em> <span id="algorithm1.29.7" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.45" class="ltx_block ltx_figure_panel">
<div id="algorithm1.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Create empty patient embedding vector, <math id="algorithm1.30.m1.1" class="ltx_Math" alttext="\mathbf{E}^{1\times D}_{p}" display="inline"><semantics id="algorithm1.30.m1.1a"><msubsup id="algorithm1.30.m1.1.1" xref="algorithm1.30.m1.1.1.cmml"><mi id="algorithm1.30.m1.1.1.2.2" xref="algorithm1.30.m1.1.1.2.2.cmml">𝐄</mi><mi id="algorithm1.30.m1.1.1.3" xref="algorithm1.30.m1.1.1.3.cmml">p</mi><mrow id="algorithm1.30.m1.1.1.2.3" xref="algorithm1.30.m1.1.1.2.3.cmml"><mn id="algorithm1.30.m1.1.1.2.3.2" xref="algorithm1.30.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="algorithm1.30.m1.1.1.2.3.1" xref="algorithm1.30.m1.1.1.2.3.1.cmml">×</mo><mi id="algorithm1.30.m1.1.1.2.3.3" xref="algorithm1.30.m1.1.1.2.3.3.cmml">D</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.30.m1.1b"><apply id="algorithm1.30.m1.1.1.cmml" xref="algorithm1.30.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.30.m1.1.1.1.cmml" xref="algorithm1.30.m1.1.1">subscript</csymbol><apply id="algorithm1.30.m1.1.1.2.cmml" xref="algorithm1.30.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.30.m1.1.1.2.1.cmml" xref="algorithm1.30.m1.1.1">superscript</csymbol><ci id="algorithm1.30.m1.1.1.2.2.cmml" xref="algorithm1.30.m1.1.1.2.2">𝐄</ci><apply id="algorithm1.30.m1.1.1.2.3.cmml" xref="algorithm1.30.m1.1.1.2.3"><times id="algorithm1.30.m1.1.1.2.3.1.cmml" xref="algorithm1.30.m1.1.1.2.3.1"></times><cn type="integer" id="algorithm1.30.m1.1.1.2.3.2.cmml" xref="algorithm1.30.m1.1.1.2.3.2">1</cn><ci id="algorithm1.30.m1.1.1.2.3.3.cmml" xref="algorithm1.30.m1.1.1.2.3.3">𝐷</ci></apply></apply><ci id="algorithm1.30.m1.1.1.3.cmml" xref="algorithm1.30.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.m1.1c">\mathbf{E}^{1\times D}_{p}</annotation></semantics></math> 
<span id="algorithm1.31.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.31.1" class="ltx_emph ltx_font_italic">each <math id="algorithm1.31.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="algorithm1.31.1.m1.1a"><mi id="algorithm1.31.1.m1.1.1" xref="algorithm1.31.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algorithm1.31.1.m1.1b"><ci id="algorithm1.31.1.m1.1.1.cmml" xref="algorithm1.31.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.1.m1.1c">t</annotation></semantics></math> in domains observation, diagnosis, drug</em> <span id="algorithm1.31.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.34" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Create domain patient embedding, <math id="algorithm1.32.m1.1" class="ltx_Math" alttext="\mathbf{E}_{p_{t}}=f^{g}_{ae}(p_{t})" display="inline"><semantics id="algorithm1.32.m1.1a"><mrow id="algorithm1.32.m1.1.1" xref="algorithm1.32.m1.1.1.cmml"><msub id="algorithm1.32.m1.1.1.3" xref="algorithm1.32.m1.1.1.3.cmml"><mi id="algorithm1.32.m1.1.1.3.2" xref="algorithm1.32.m1.1.1.3.2.cmml">𝐄</mi><msub id="algorithm1.32.m1.1.1.3.3" xref="algorithm1.32.m1.1.1.3.3.cmml"><mi id="algorithm1.32.m1.1.1.3.3.2" xref="algorithm1.32.m1.1.1.3.3.2.cmml">p</mi><mi id="algorithm1.32.m1.1.1.3.3.3" xref="algorithm1.32.m1.1.1.3.3.3.cmml">t</mi></msub></msub><mo id="algorithm1.32.m1.1.1.2" xref="algorithm1.32.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.32.m1.1.1.1" xref="algorithm1.32.m1.1.1.1.cmml"><msubsup id="algorithm1.32.m1.1.1.1.3" xref="algorithm1.32.m1.1.1.1.3.cmml"><mi id="algorithm1.32.m1.1.1.1.3.2.2" xref="algorithm1.32.m1.1.1.1.3.2.2.cmml">f</mi><mrow id="algorithm1.32.m1.1.1.1.3.3" xref="algorithm1.32.m1.1.1.1.3.3.cmml"><mi id="algorithm1.32.m1.1.1.1.3.3.2" xref="algorithm1.32.m1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.m1.1.1.1.3.3.1" xref="algorithm1.32.m1.1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.32.m1.1.1.1.3.3.3" xref="algorithm1.32.m1.1.1.1.3.3.3.cmml">e</mi></mrow><mi id="algorithm1.32.m1.1.1.1.3.2.3" xref="algorithm1.32.m1.1.1.1.3.2.3.cmml">g</mi></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.32.m1.1.1.1.2" xref="algorithm1.32.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.32.m1.1.1.1.1.1" xref="algorithm1.32.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.32.m1.1.1.1.1.1.2" xref="algorithm1.32.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.32.m1.1.1.1.1.1.1" xref="algorithm1.32.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.32.m1.1.1.1.1.1.1.2" xref="algorithm1.32.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="algorithm1.32.m1.1.1.1.1.1.1.3" xref="algorithm1.32.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.32.m1.1.1.1.1.1.3" xref="algorithm1.32.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.m1.1b"><apply id="algorithm1.32.m1.1.1.cmml" xref="algorithm1.32.m1.1.1"><eq id="algorithm1.32.m1.1.1.2.cmml" xref="algorithm1.32.m1.1.1.2"></eq><apply id="algorithm1.32.m1.1.1.3.cmml" xref="algorithm1.32.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.32.m1.1.1.3.1.cmml" xref="algorithm1.32.m1.1.1.3">subscript</csymbol><ci id="algorithm1.32.m1.1.1.3.2.cmml" xref="algorithm1.32.m1.1.1.3.2">𝐄</ci><apply id="algorithm1.32.m1.1.1.3.3.cmml" xref="algorithm1.32.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.32.m1.1.1.3.3.1.cmml" xref="algorithm1.32.m1.1.1.3.3">subscript</csymbol><ci id="algorithm1.32.m1.1.1.3.3.2.cmml" xref="algorithm1.32.m1.1.1.3.3.2">𝑝</ci><ci id="algorithm1.32.m1.1.1.3.3.3.cmml" xref="algorithm1.32.m1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="algorithm1.32.m1.1.1.1.cmml" xref="algorithm1.32.m1.1.1.1"><times id="algorithm1.32.m1.1.1.1.2.cmml" xref="algorithm1.32.m1.1.1.1.2"></times><apply id="algorithm1.32.m1.1.1.1.3.cmml" xref="algorithm1.32.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.32.m1.1.1.1.3.1.cmml" xref="algorithm1.32.m1.1.1.1.3">subscript</csymbol><apply id="algorithm1.32.m1.1.1.1.3.2.cmml" xref="algorithm1.32.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.32.m1.1.1.1.3.2.1.cmml" xref="algorithm1.32.m1.1.1.1.3">superscript</csymbol><ci id="algorithm1.32.m1.1.1.1.3.2.2.cmml" xref="algorithm1.32.m1.1.1.1.3.2.2">𝑓</ci><ci id="algorithm1.32.m1.1.1.1.3.2.3.cmml" xref="algorithm1.32.m1.1.1.1.3.2.3">𝑔</ci></apply><apply id="algorithm1.32.m1.1.1.1.3.3.cmml" xref="algorithm1.32.m1.1.1.1.3.3"><times id="algorithm1.32.m1.1.1.1.3.3.1.cmml" xref="algorithm1.32.m1.1.1.1.3.3.1"></times><ci id="algorithm1.32.m1.1.1.1.3.3.2.cmml" xref="algorithm1.32.m1.1.1.1.3.3.2">𝑎</ci><ci id="algorithm1.32.m1.1.1.1.3.3.3.cmml" xref="algorithm1.32.m1.1.1.1.3.3.3">𝑒</ci></apply></apply><apply id="algorithm1.32.m1.1.1.1.1.1.1.cmml" xref="algorithm1.32.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.32.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.32.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.32.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.32.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="algorithm1.32.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.32.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.m1.1c">\mathbf{E}_{p_{t}}=f^{g}_{ae}(p_{t})</annotation></semantics></math> 
Concatenate <math id="algorithm1.33.m2.1" class="ltx_Math" alttext="\mathbf{E}_{p}" display="inline"><semantics id="algorithm1.33.m2.1a"><msub id="algorithm1.33.m2.1.1" xref="algorithm1.33.m2.1.1.cmml"><mi id="algorithm1.33.m2.1.1.2" xref="algorithm1.33.m2.1.1.2.cmml">𝐄</mi><mi id="algorithm1.33.m2.1.1.3" xref="algorithm1.33.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.33.m2.1b"><apply id="algorithm1.33.m2.1.1.cmml" xref="algorithm1.33.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.33.m2.1.1.1.cmml" xref="algorithm1.33.m2.1.1">subscript</csymbol><ci id="algorithm1.33.m2.1.1.2.cmml" xref="algorithm1.33.m2.1.1.2">𝐄</ci><ci id="algorithm1.33.m2.1.1.3.cmml" xref="algorithm1.33.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.m2.1c">\mathbf{E}_{p}</annotation></semantics></math> with <math id="algorithm1.34.m3.1" class="ltx_Math" alttext="\mathbf{E}_{p_{t}}" display="inline"><semantics id="algorithm1.34.m3.1a"><msub id="algorithm1.34.m3.1.1" xref="algorithm1.34.m3.1.1.cmml"><mi id="algorithm1.34.m3.1.1.2" xref="algorithm1.34.m3.1.1.2.cmml">𝐄</mi><msub id="algorithm1.34.m3.1.1.3" xref="algorithm1.34.m3.1.1.3.cmml"><mi id="algorithm1.34.m3.1.1.3.2" xref="algorithm1.34.m3.1.1.3.2.cmml">p</mi><mi id="algorithm1.34.m3.1.1.3.3" xref="algorithm1.34.m3.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="algorithm1.34.m3.1b"><apply id="algorithm1.34.m3.1.1.cmml" xref="algorithm1.34.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.34.m3.1.1.1.cmml" xref="algorithm1.34.m3.1.1">subscript</csymbol><ci id="algorithm1.34.m3.1.1.2.cmml" xref="algorithm1.34.m3.1.1.2">𝐄</ci><apply id="algorithm1.34.m3.1.1.3.cmml" xref="algorithm1.34.m3.1.1.3"><csymbol cd="ambiguous" id="algorithm1.34.m3.1.1.3.1.cmml" xref="algorithm1.34.m3.1.1.3">subscript</csymbol><ci id="algorithm1.34.m3.1.1.3.2.cmml" xref="algorithm1.34.m3.1.1.3.2">𝑝</ci><ci id="algorithm1.34.m3.1.1.3.3.cmml" xref="algorithm1.34.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.m3.1c">\mathbf{E}_{p_{t}}</annotation></semantics></math> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.46" class="ltx_block ltx_figure_panel">
<div id="algorithm1.46.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.35" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.35.m1.1" class="ltx_Math" alttext="\mathbf{E}[p]\leftarrow\mathbf{E}_{p}" display="inline"><semantics id="algorithm1.35.m1.1a"><mrow id="algorithm1.35.m1.1.2" xref="algorithm1.35.m1.1.2.cmml"><mrow id="algorithm1.35.m1.1.2.2" xref="algorithm1.35.m1.1.2.2.cmml"><mi id="algorithm1.35.m1.1.2.2.2" xref="algorithm1.35.m1.1.2.2.2.cmml">𝐄</mi><mo lspace="0em" rspace="0em" id="algorithm1.35.m1.1.2.2.1" xref="algorithm1.35.m1.1.2.2.1.cmml">​</mo><mrow id="algorithm1.35.m1.1.2.2.3.2" xref="algorithm1.35.m1.1.2.2.3.1.cmml"><mo stretchy="false" id="algorithm1.35.m1.1.2.2.3.2.1" xref="algorithm1.35.m1.1.2.2.3.1.1.cmml">[</mo><mi id="algorithm1.35.m1.1.1" xref="algorithm1.35.m1.1.1.cmml">p</mi><mo stretchy="false" id="algorithm1.35.m1.1.2.2.3.2.2" xref="algorithm1.35.m1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="algorithm1.35.m1.1.2.1" xref="algorithm1.35.m1.1.2.1.cmml">←</mo><msub id="algorithm1.35.m1.1.2.3" xref="algorithm1.35.m1.1.2.3.cmml"><mi id="algorithm1.35.m1.1.2.3.2" xref="algorithm1.35.m1.1.2.3.2.cmml">𝐄</mi><mi id="algorithm1.35.m1.1.2.3.3" xref="algorithm1.35.m1.1.2.3.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.35.m1.1b"><apply id="algorithm1.35.m1.1.2.cmml" xref="algorithm1.35.m1.1.2"><ci id="algorithm1.35.m1.1.2.1.cmml" xref="algorithm1.35.m1.1.2.1">←</ci><apply id="algorithm1.35.m1.1.2.2.cmml" xref="algorithm1.35.m1.1.2.2"><times id="algorithm1.35.m1.1.2.2.1.cmml" xref="algorithm1.35.m1.1.2.2.1"></times><ci id="algorithm1.35.m1.1.2.2.2.cmml" xref="algorithm1.35.m1.1.2.2.2">𝐄</ci><apply id="algorithm1.35.m1.1.2.2.3.1.cmml" xref="algorithm1.35.m1.1.2.2.3.2"><csymbol cd="latexml" id="algorithm1.35.m1.1.2.2.3.1.1.cmml" xref="algorithm1.35.m1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="algorithm1.35.m1.1.1.cmml" xref="algorithm1.35.m1.1.1">𝑝</ci></apply></apply><apply id="algorithm1.35.m1.1.2.3.cmml" xref="algorithm1.35.m1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.35.m1.1.2.3.1.cmml" xref="algorithm1.35.m1.1.2.3">subscript</csymbol><ci id="algorithm1.35.m1.1.2.3.2.cmml" xref="algorithm1.35.m1.1.2.3.2">𝐄</ci><ci id="algorithm1.35.m1.1.2.3.3.cmml" xref="algorithm1.35.m1.1.2.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.35.m1.1c">\mathbf{E}[p]\leftarrow\mathbf{E}_{p}</annotation></semantics></math> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.47" class="ltx_block ltx_figure_panel">
<div id="algorithm1.47.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.36" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Return <math id="algorithm1.36.m1.1" class="ltx_Math" alttext="\mathbf{E}" display="inline"><semantics id="algorithm1.36.m1.1a"><mi id="algorithm1.36.m1.1.1" xref="algorithm1.36.m1.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="algorithm1.36.m1.1b"><ci id="algorithm1.36.m1.1.1.cmml" xref="algorithm1.36.m1.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.36.m1.1c">\mathbf{E}</annotation></semantics></math> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm1.48" class="ltx_block ltx_figure_panel">
<div id="algorithm1.48.1" class="ltx_listingline"> end for
</div>
<div id="algorithm1.48.2" class="ltx_listingline">
</div>
</div>
</div>
</div>
</figure>
<figure id="algorithm2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.52.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Estimating patient similarity</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm2.1" class="ltx_p ltx_figure_panel"><span id="algorithm2.1.1" class="ltx_text"><span id="algorithm2.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Patient embeddings across multiple sites, <math id="algorithm2.1.m1.1" class="ltx_Math" alttext="\mathbf{E}_{p}" display="inline"><semantics id="algorithm2.1.m1.1a"><msub id="algorithm2.1.m1.1.1" xref="algorithm2.1.m1.1.1.cmml"><mi id="algorithm2.1.m1.1.1.2" xref="algorithm2.1.m1.1.1.2.cmml">𝐄</mi><mi id="algorithm2.1.m1.1.1.3" xref="algorithm2.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.1.m1.1b"><apply id="algorithm2.1.m1.1.1.cmml" xref="algorithm2.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.1.m1.1.1.1.cmml" xref="algorithm2.1.m1.1.1">subscript</csymbol><ci id="algorithm2.1.m1.1.1.2.cmml" xref="algorithm2.1.m1.1.1.2">𝐄</ci><ci id="algorithm2.1.m1.1.1.3.cmml" xref="algorithm2.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.m1.1c">\mathbf{E}_{p}</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm2.2" class="ltx_p ltx_figure_panel"><span id="algorithm2.2.1" class="ltx_text"><span id="algorithm2.2.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Global similarity matrix <math id="algorithm2.2.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.2.m1.1a"><mi id="algorithm2.2.m1.1.1" xref="algorithm2.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.2.m1.1b"><ci id="algorithm2.2.m1.1.1.cmml" xref="algorithm2.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.m1.1c">S</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm2.8" class="ltx_p ltx_figure_panel">Initialize global similarity matrix, <math id="algorithm2.3.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.3.m1.1a"><mi id="algorithm2.3.m1.1.1" xref="algorithm2.3.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.m1.1b"><ci id="algorithm2.3.m1.1.1.cmml" xref="algorithm2.3.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.m1.1c">S</annotation></semantics></math>, as a <math id="algorithm2.4.m2.1" class="ltx_Math" alttext="P\times P" display="inline"><semantics id="algorithm2.4.m2.1a"><mrow id="algorithm2.4.m2.1.1" xref="algorithm2.4.m2.1.1.cmml"><mi id="algorithm2.4.m2.1.1.2" xref="algorithm2.4.m2.1.1.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.4.m2.1.1.1" xref="algorithm2.4.m2.1.1.1.cmml">×</mo><mi id="algorithm2.4.m2.1.1.3" xref="algorithm2.4.m2.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.4.m2.1b"><apply id="algorithm2.4.m2.1.1.cmml" xref="algorithm2.4.m2.1.1"><times id="algorithm2.4.m2.1.1.1.cmml" xref="algorithm2.4.m2.1.1.1"></times><ci id="algorithm2.4.m2.1.1.2.cmml" xref="algorithm2.4.m2.1.1.2">𝑃</ci><ci id="algorithm2.4.m2.1.1.3.cmml" xref="algorithm2.4.m2.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.m2.1c">P\times P</annotation></semantics></math> zero matrix, where <math id="algorithm2.5.m3.1" class="ltx_Math" alttext="P" display="inline"><semantics id="algorithm2.5.m3.1a"><mi id="algorithm2.5.m3.1.1" xref="algorithm2.5.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.m3.1b"><ci id="algorithm2.5.m3.1.1.cmml" xref="algorithm2.5.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.m3.1c">P</annotation></semantics></math> is the total number of patients 
<span id="algorithm2.8.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.8.3" class="ltx_emph ltx_font_italic">every unique pair of sites <math id="algorithm2.6.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm2.6.1.m1.1a"><mi id="algorithm2.6.1.m1.1.1" xref="algorithm2.6.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm2.6.1.m1.1b"><ci id="algorithm2.6.1.m1.1.1.cmml" xref="algorithm2.6.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.1.m1.1c">c</annotation></semantics></math>, <math id="algorithm2.7.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm2.7.2.m2.1a"><mi id="algorithm2.7.2.m2.1.1" xref="algorithm2.7.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm2.7.2.m2.1b"><ci id="algorithm2.7.2.m2.1.1.cmml" xref="algorithm2.7.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.2.m2.1c">d</annotation></semantics></math> <math id="algorithm2.8.3.m3.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="algorithm2.8.3.m3.1a"><mo id="algorithm2.8.3.m3.1.1" xref="algorithm2.8.3.m3.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="algorithm2.8.3.m3.1b"><in id="algorithm2.8.3.m3.1.1.cmml" xref="algorithm2.8.3.m3.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.3.m3.1c">\in</annotation></semantics></math> sites C in <span id="algorithm2.8.3.1" class="ltx_text ltx_font_bold">parallel</span></em> <span id="algorithm2.8.5" class="ltx_text ltx_font_bold">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="algorithm2.15" class="ltx_listingline ltx_figure_panel">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Construct invertible matrix, <math id="algorithm2.9.m1.1" class="ltx_Math" alttext="M_{f\times f}" display="inline"><semantics id="algorithm2.9.m1.1a"><msub id="algorithm2.9.m1.1.1" xref="algorithm2.9.m1.1.1.cmml"><mi id="algorithm2.9.m1.1.1.2" xref="algorithm2.9.m1.1.1.2.cmml">M</mi><mrow id="algorithm2.9.m1.1.1.3" xref="algorithm2.9.m1.1.1.3.cmml"><mi id="algorithm2.9.m1.1.1.3.2" xref="algorithm2.9.m1.1.1.3.2.cmml">f</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.9.m1.1.1.3.1" xref="algorithm2.9.m1.1.1.3.1.cmml">×</mo><mi id="algorithm2.9.m1.1.1.3.3" xref="algorithm2.9.m1.1.1.3.3.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.9.m1.1b"><apply id="algorithm2.9.m1.1.1.cmml" xref="algorithm2.9.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.9.m1.1.1.1.cmml" xref="algorithm2.9.m1.1.1">subscript</csymbol><ci id="algorithm2.9.m1.1.1.2.cmml" xref="algorithm2.9.m1.1.1.2">𝑀</ci><apply id="algorithm2.9.m1.1.1.3.cmml" xref="algorithm2.9.m1.1.1.3"><times id="algorithm2.9.m1.1.1.3.1.cmml" xref="algorithm2.9.m1.1.1.3.1"></times><ci id="algorithm2.9.m1.1.1.3.2.cmml" xref="algorithm2.9.m1.1.1.3.2">𝑓</ci><ci id="algorithm2.9.m1.1.1.3.3.cmml" xref="algorithm2.9.m1.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.m1.1c">M_{f\times f}</annotation></semantics></math> using Reed-Hoffman encoding with degree <math id="algorithm2.10.m2.1" class="ltx_Math" alttext="f&gt;D" display="inline"><semantics id="algorithm2.10.m2.1a"><mrow id="algorithm2.10.m2.1.1" xref="algorithm2.10.m2.1.1.cmml"><mi id="algorithm2.10.m2.1.1.2" xref="algorithm2.10.m2.1.1.2.cmml">f</mi><mo id="algorithm2.10.m2.1.1.1" xref="algorithm2.10.m2.1.1.1.cmml">&gt;</mo><mi id="algorithm2.10.m2.1.1.3" xref="algorithm2.10.m2.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.10.m2.1b"><apply id="algorithm2.10.m2.1.1.cmml" xref="algorithm2.10.m2.1.1"><gt id="algorithm2.10.m2.1.1.1.cmml" xref="algorithm2.10.m2.1.1.1"></gt><ci id="algorithm2.10.m2.1.1.2.cmml" xref="algorithm2.10.m2.1.1.2">𝑓</ci><ci id="algorithm2.10.m2.1.1.3.cmml" xref="algorithm2.10.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.m2.1c">f&gt;D</annotation></semantics></math> <em id="algorithm2.15.2" class="ltx_emph ltx_font_italic">i.e.,</em> degree greater than embedding dimension 
Send <math id="algorithm2.11.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="algorithm2.11.m3.1a"><mi id="algorithm2.11.m3.1.1" xref="algorithm2.11.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm2.11.m3.1b"><ci id="algorithm2.11.m3.1.1.cmml" xref="algorithm2.11.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.m3.1c">M</annotation></semantics></math> to <math id="algorithm2.12.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm2.12.m4.1a"><mi id="algorithm2.12.m4.1.1" xref="algorithm2.12.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm2.12.m4.1b"><ci id="algorithm2.12.m4.1.1.cmml" xref="algorithm2.12.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.m4.1c">c</annotation></semantics></math> and <math id="algorithm2.13.m5.1" class="ltx_Math" alttext="M^{-1}" display="inline"><semantics id="algorithm2.13.m5.1a"><msup id="algorithm2.13.m5.1.1" xref="algorithm2.13.m5.1.1.cmml"><mi id="algorithm2.13.m5.1.1.2" xref="algorithm2.13.m5.1.1.2.cmml">M</mi><mrow id="algorithm2.13.m5.1.1.3" xref="algorithm2.13.m5.1.1.3.cmml"><mo id="algorithm2.13.m5.1.1.3a" xref="algorithm2.13.m5.1.1.3.cmml">−</mo><mn id="algorithm2.13.m5.1.1.3.2" xref="algorithm2.13.m5.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm2.13.m5.1b"><apply id="algorithm2.13.m5.1.1.cmml" xref="algorithm2.13.m5.1.1"><csymbol cd="ambiguous" id="algorithm2.13.m5.1.1.1.cmml" xref="algorithm2.13.m5.1.1">superscript</csymbol><ci id="algorithm2.13.m5.1.1.2.cmml" xref="algorithm2.13.m5.1.1.2">𝑀</ci><apply id="algorithm2.13.m5.1.1.3.cmml" xref="algorithm2.13.m5.1.1.3"><minus id="algorithm2.13.m5.1.1.3.1.cmml" xref="algorithm2.13.m5.1.1.3"></minus><cn type="integer" id="algorithm2.13.m5.1.1.3.2.cmml" xref="algorithm2.13.m5.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.m5.1c">M^{-1}</annotation></semantics></math> to site <math id="algorithm2.14.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm2.14.m6.1a"><mi id="algorithm2.14.m6.1.1" xref="algorithm2.14.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm2.14.m6.1b"><ci id="algorithm2.14.m6.1.1.cmml" xref="algorithm2.14.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.m6.1c">d</annotation></semantics></math> 
<span id="algorithm2.15.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.15.1" class="ltx_emph ltx_font_italic">site <math id="algorithm2.15.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm2.15.1.m1.1a"><mi id="algorithm2.15.1.m1.1.1" xref="algorithm2.15.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm2.15.1.m1.1b"><ci id="algorithm2.15.1.m1.1.1.cmml" xref="algorithm2.15.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.1.m1.1c">c</annotation></semantics></math></em> <span id="algorithm2.15.4" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.53" class="ltx_block ltx_figure_panel">
<div id="algorithm2.21" class="ltx_listingline ltx_figure_panel">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Set matrix <math id="algorithm2.16.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="algorithm2.16.m1.1a"><mi id="algorithm2.16.m1.1.1" xref="algorithm2.16.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="algorithm2.16.m1.1b"><ci id="algorithm2.16.m1.1.1.cmml" xref="algorithm2.16.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.m1.1c">A</annotation></semantics></math> to hold all patient embeddings <math id="algorithm2.17.m2.1" class="ltx_Math" alttext="\mathbf{E}_{p}" display="inline"><semantics id="algorithm2.17.m2.1a"><msub id="algorithm2.17.m2.1.1" xref="algorithm2.17.m2.1.1.cmml"><mi id="algorithm2.17.m2.1.1.2" xref="algorithm2.17.m2.1.1.2.cmml">𝐄</mi><mi id="algorithm2.17.m2.1.1.3" xref="algorithm2.17.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.17.m2.1b"><apply id="algorithm2.17.m2.1.1.cmml" xref="algorithm2.17.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.17.m2.1.1.1.cmml" xref="algorithm2.17.m2.1.1">subscript</csymbol><ci id="algorithm2.17.m2.1.1.2.cmml" xref="algorithm2.17.m2.1.1.2">𝐄</ci><ci id="algorithm2.17.m2.1.1.3.cmml" xref="algorithm2.17.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.m2.1c">\mathbf{E}_{p}</annotation></semantics></math> within site <math id="algorithm2.18.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm2.18.m3.1a"><mi id="algorithm2.18.m3.1.1" xref="algorithm2.18.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm2.18.m3.1b"><ci id="algorithm2.18.m3.1.1.cmml" xref="algorithm2.18.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.m3.1c">c</annotation></semantics></math> 
Calculate <math id="algorithm2.19.m4.1" class="ltx_Math" alttext="A_{1}=A\times M_{left}" display="inline"><semantics id="algorithm2.19.m4.1a"><mrow id="algorithm2.19.m4.1.1" xref="algorithm2.19.m4.1.1.cmml"><msub id="algorithm2.19.m4.1.1.2" xref="algorithm2.19.m4.1.1.2.cmml"><mi id="algorithm2.19.m4.1.1.2.2" xref="algorithm2.19.m4.1.1.2.2.cmml">A</mi><mn id="algorithm2.19.m4.1.1.2.3" xref="algorithm2.19.m4.1.1.2.3.cmml">1</mn></msub><mo id="algorithm2.19.m4.1.1.1" xref="algorithm2.19.m4.1.1.1.cmml">=</mo><mrow id="algorithm2.19.m4.1.1.3" xref="algorithm2.19.m4.1.1.3.cmml"><mi id="algorithm2.19.m4.1.1.3.2" xref="algorithm2.19.m4.1.1.3.2.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.19.m4.1.1.3.1" xref="algorithm2.19.m4.1.1.3.1.cmml">×</mo><msub id="algorithm2.19.m4.1.1.3.3" xref="algorithm2.19.m4.1.1.3.3.cmml"><mi id="algorithm2.19.m4.1.1.3.3.2" xref="algorithm2.19.m4.1.1.3.3.2.cmml">M</mi><mrow id="algorithm2.19.m4.1.1.3.3.3" xref="algorithm2.19.m4.1.1.3.3.3.cmml"><mi id="algorithm2.19.m4.1.1.3.3.3.2" xref="algorithm2.19.m4.1.1.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.m4.1.1.3.3.3.1" xref="algorithm2.19.m4.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.19.m4.1.1.3.3.3.3" xref="algorithm2.19.m4.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.m4.1.1.3.3.3.1a" xref="algorithm2.19.m4.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.19.m4.1.1.3.3.3.4" xref="algorithm2.19.m4.1.1.3.3.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="algorithm2.19.m4.1.1.3.3.3.1b" xref="algorithm2.19.m4.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.19.m4.1.1.3.3.3.5" xref="algorithm2.19.m4.1.1.3.3.3.5.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.m4.1b"><apply id="algorithm2.19.m4.1.1.cmml" xref="algorithm2.19.m4.1.1"><eq id="algorithm2.19.m4.1.1.1.cmml" xref="algorithm2.19.m4.1.1.1"></eq><apply id="algorithm2.19.m4.1.1.2.cmml" xref="algorithm2.19.m4.1.1.2"><csymbol cd="ambiguous" id="algorithm2.19.m4.1.1.2.1.cmml" xref="algorithm2.19.m4.1.1.2">subscript</csymbol><ci id="algorithm2.19.m4.1.1.2.2.cmml" xref="algorithm2.19.m4.1.1.2.2">𝐴</ci><cn type="integer" id="algorithm2.19.m4.1.1.2.3.cmml" xref="algorithm2.19.m4.1.1.2.3">1</cn></apply><apply id="algorithm2.19.m4.1.1.3.cmml" xref="algorithm2.19.m4.1.1.3"><times id="algorithm2.19.m4.1.1.3.1.cmml" xref="algorithm2.19.m4.1.1.3.1"></times><ci id="algorithm2.19.m4.1.1.3.2.cmml" xref="algorithm2.19.m4.1.1.3.2">𝐴</ci><apply id="algorithm2.19.m4.1.1.3.3.cmml" xref="algorithm2.19.m4.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.19.m4.1.1.3.3.1.cmml" xref="algorithm2.19.m4.1.1.3.3">subscript</csymbol><ci id="algorithm2.19.m4.1.1.3.3.2.cmml" xref="algorithm2.19.m4.1.1.3.3.2">𝑀</ci><apply id="algorithm2.19.m4.1.1.3.3.3.cmml" xref="algorithm2.19.m4.1.1.3.3.3"><times id="algorithm2.19.m4.1.1.3.3.3.1.cmml" xref="algorithm2.19.m4.1.1.3.3.3.1"></times><ci id="algorithm2.19.m4.1.1.3.3.3.2.cmml" xref="algorithm2.19.m4.1.1.3.3.3.2">𝑙</ci><ci id="algorithm2.19.m4.1.1.3.3.3.3.cmml" xref="algorithm2.19.m4.1.1.3.3.3.3">𝑒</ci><ci id="algorithm2.19.m4.1.1.3.3.3.4.cmml" xref="algorithm2.19.m4.1.1.3.3.3.4">𝑓</ci><ci id="algorithm2.19.m4.1.1.3.3.3.5.cmml" xref="algorithm2.19.m4.1.1.3.3.3.5">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.m4.1c">A_{1}=A\times M_{left}</annotation></semantics></math>, <math id="algorithm2.20.m5.1" class="ltx_Math" alttext="A_{2}=A\times M_{right}" display="inline"><semantics id="algorithm2.20.m5.1a"><mrow id="algorithm2.20.m5.1.1" xref="algorithm2.20.m5.1.1.cmml"><msub id="algorithm2.20.m5.1.1.2" xref="algorithm2.20.m5.1.1.2.cmml"><mi id="algorithm2.20.m5.1.1.2.2" xref="algorithm2.20.m5.1.1.2.2.cmml">A</mi><mn id="algorithm2.20.m5.1.1.2.3" xref="algorithm2.20.m5.1.1.2.3.cmml">2</mn></msub><mo id="algorithm2.20.m5.1.1.1" xref="algorithm2.20.m5.1.1.1.cmml">=</mo><mrow id="algorithm2.20.m5.1.1.3" xref="algorithm2.20.m5.1.1.3.cmml"><mi id="algorithm2.20.m5.1.1.3.2" xref="algorithm2.20.m5.1.1.3.2.cmml">A</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.20.m5.1.1.3.1" xref="algorithm2.20.m5.1.1.3.1.cmml">×</mo><msub id="algorithm2.20.m5.1.1.3.3" xref="algorithm2.20.m5.1.1.3.3.cmml"><mi id="algorithm2.20.m5.1.1.3.3.2" xref="algorithm2.20.m5.1.1.3.3.2.cmml">M</mi><mrow id="algorithm2.20.m5.1.1.3.3.3" xref="algorithm2.20.m5.1.1.3.3.3.cmml"><mi id="algorithm2.20.m5.1.1.3.3.3.2" xref="algorithm2.20.m5.1.1.3.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm2.20.m5.1.1.3.3.3.1" xref="algorithm2.20.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.20.m5.1.1.3.3.3.3" xref="algorithm2.20.m5.1.1.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.20.m5.1.1.3.3.3.1a" xref="algorithm2.20.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.20.m5.1.1.3.3.3.4" xref="algorithm2.20.m5.1.1.3.3.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm2.20.m5.1.1.3.3.3.1b" xref="algorithm2.20.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.20.m5.1.1.3.3.3.5" xref="algorithm2.20.m5.1.1.3.3.3.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm2.20.m5.1.1.3.3.3.1c" xref="algorithm2.20.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.20.m5.1.1.3.3.3.6" xref="algorithm2.20.m5.1.1.3.3.3.6.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.20.m5.1b"><apply id="algorithm2.20.m5.1.1.cmml" xref="algorithm2.20.m5.1.1"><eq id="algorithm2.20.m5.1.1.1.cmml" xref="algorithm2.20.m5.1.1.1"></eq><apply id="algorithm2.20.m5.1.1.2.cmml" xref="algorithm2.20.m5.1.1.2"><csymbol cd="ambiguous" id="algorithm2.20.m5.1.1.2.1.cmml" xref="algorithm2.20.m5.1.1.2">subscript</csymbol><ci id="algorithm2.20.m5.1.1.2.2.cmml" xref="algorithm2.20.m5.1.1.2.2">𝐴</ci><cn type="integer" id="algorithm2.20.m5.1.1.2.3.cmml" xref="algorithm2.20.m5.1.1.2.3">2</cn></apply><apply id="algorithm2.20.m5.1.1.3.cmml" xref="algorithm2.20.m5.1.1.3"><times id="algorithm2.20.m5.1.1.3.1.cmml" xref="algorithm2.20.m5.1.1.3.1"></times><ci id="algorithm2.20.m5.1.1.3.2.cmml" xref="algorithm2.20.m5.1.1.3.2">𝐴</ci><apply id="algorithm2.20.m5.1.1.3.3.cmml" xref="algorithm2.20.m5.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.20.m5.1.1.3.3.1.cmml" xref="algorithm2.20.m5.1.1.3.3">subscript</csymbol><ci id="algorithm2.20.m5.1.1.3.3.2.cmml" xref="algorithm2.20.m5.1.1.3.3.2">𝑀</ci><apply id="algorithm2.20.m5.1.1.3.3.3.cmml" xref="algorithm2.20.m5.1.1.3.3.3"><times id="algorithm2.20.m5.1.1.3.3.3.1.cmml" xref="algorithm2.20.m5.1.1.3.3.3.1"></times><ci id="algorithm2.20.m5.1.1.3.3.3.2.cmml" xref="algorithm2.20.m5.1.1.3.3.3.2">𝑟</ci><ci id="algorithm2.20.m5.1.1.3.3.3.3.cmml" xref="algorithm2.20.m5.1.1.3.3.3.3">𝑖</ci><ci id="algorithm2.20.m5.1.1.3.3.3.4.cmml" xref="algorithm2.20.m5.1.1.3.3.3.4">𝑔</ci><ci id="algorithm2.20.m5.1.1.3.3.3.5.cmml" xref="algorithm2.20.m5.1.1.3.3.3.5">ℎ</ci><ci id="algorithm2.20.m5.1.1.3.3.3.6.cmml" xref="algorithm2.20.m5.1.1.3.3.3.6">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.20.m5.1c">A_{2}=A\times M_{right}</annotation></semantics></math> 
Send <math id="algorithm2.21.m6.1" class="ltx_Math" alttext="A_{1}" display="inline"><semantics id="algorithm2.21.m6.1a"><msub id="algorithm2.21.m6.1.1" xref="algorithm2.21.m6.1.1.cmml"><mi id="algorithm2.21.m6.1.1.2" xref="algorithm2.21.m6.1.1.2.cmml">A</mi><mn id="algorithm2.21.m6.1.1.3" xref="algorithm2.21.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.21.m6.1b"><apply id="algorithm2.21.m6.1.1.cmml" xref="algorithm2.21.m6.1.1"><csymbol cd="ambiguous" id="algorithm2.21.m6.1.1.1.cmml" xref="algorithm2.21.m6.1.1">subscript</csymbol><ci id="algorithm2.21.m6.1.1.2.cmml" xref="algorithm2.21.m6.1.1.2">𝐴</ci><cn type="integer" id="algorithm2.21.m6.1.1.3.cmml" xref="algorithm2.21.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.21.m6.1c">A_{1}</annotation></semantics></math> to the server 

</div>
<div id="algorithm2.53.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.54" class="ltx_block ltx_figure_panel">
<div id="algorithm2.22" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm2.22.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.22.1" class="ltx_emph ltx_font_italic">site <math id="algorithm2.22.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm2.22.1.m1.1a"><mi id="algorithm2.22.1.m1.1.1" xref="algorithm2.22.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm2.22.1.m1.1b"><ci id="algorithm2.22.1.m1.1.1.cmml" xref="algorithm2.22.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.22.1.m1.1c">d</annotation></semantics></math></em> <span id="algorithm2.22.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Set matrix <math id="algorithm2.23.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="algorithm2.23.m1.1a"><mi id="algorithm2.23.m1.1.1" xref="algorithm2.23.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algorithm2.23.m1.1b"><ci id="algorithm2.23.m1.1.1.cmml" xref="algorithm2.23.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.23.m1.1c">B</annotation></semantics></math> to hold all patient embeddings <math id="algorithm2.24.m2.1" class="ltx_Math" alttext="\mathbf{E}_{p}" display="inline"><semantics id="algorithm2.24.m2.1a"><msub id="algorithm2.24.m2.1.1" xref="algorithm2.24.m2.1.1.cmml"><mi id="algorithm2.24.m2.1.1.2" xref="algorithm2.24.m2.1.1.2.cmml">𝐄</mi><mi id="algorithm2.24.m2.1.1.3" xref="algorithm2.24.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.24.m2.1b"><apply id="algorithm2.24.m2.1.1.cmml" xref="algorithm2.24.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.24.m2.1.1.1.cmml" xref="algorithm2.24.m2.1.1">subscript</csymbol><ci id="algorithm2.24.m2.1.1.2.cmml" xref="algorithm2.24.m2.1.1.2">𝐄</ci><ci id="algorithm2.24.m2.1.1.3.cmml" xref="algorithm2.24.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.24.m2.1c">\mathbf{E}_{p}</annotation></semantics></math> within site <math id="algorithm2.25.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm2.25.m3.1a"><mi id="algorithm2.25.m3.1.1" xref="algorithm2.25.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm2.25.m3.1b"><ci id="algorithm2.25.m3.1.1.cmml" xref="algorithm2.25.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.25.m3.1c">d</annotation></semantics></math> 
Calculate <math id="algorithm2.26.m4.1" class="ltx_Math" alttext="B_{1}=B\times M^{-1}_{top}" display="inline"><semantics id="algorithm2.26.m4.1a"><mrow id="algorithm2.26.m4.1.1" xref="algorithm2.26.m4.1.1.cmml"><msub id="algorithm2.26.m4.1.1.2" xref="algorithm2.26.m4.1.1.2.cmml"><mi id="algorithm2.26.m4.1.1.2.2" xref="algorithm2.26.m4.1.1.2.2.cmml">B</mi><mn id="algorithm2.26.m4.1.1.2.3" xref="algorithm2.26.m4.1.1.2.3.cmml">1</mn></msub><mo id="algorithm2.26.m4.1.1.1" xref="algorithm2.26.m4.1.1.1.cmml">=</mo><mrow id="algorithm2.26.m4.1.1.3" xref="algorithm2.26.m4.1.1.3.cmml"><mi id="algorithm2.26.m4.1.1.3.2" xref="algorithm2.26.m4.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.26.m4.1.1.3.1" xref="algorithm2.26.m4.1.1.3.1.cmml">×</mo><msubsup id="algorithm2.26.m4.1.1.3.3" xref="algorithm2.26.m4.1.1.3.3.cmml"><mi id="algorithm2.26.m4.1.1.3.3.2.2" xref="algorithm2.26.m4.1.1.3.3.2.2.cmml">M</mi><mrow id="algorithm2.26.m4.1.1.3.3.3" xref="algorithm2.26.m4.1.1.3.3.3.cmml"><mi id="algorithm2.26.m4.1.1.3.3.3.2" xref="algorithm2.26.m4.1.1.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.26.m4.1.1.3.3.3.1" xref="algorithm2.26.m4.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.26.m4.1.1.3.3.3.3" xref="algorithm2.26.m4.1.1.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.26.m4.1.1.3.3.3.1a" xref="algorithm2.26.m4.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.26.m4.1.1.3.3.3.4" xref="algorithm2.26.m4.1.1.3.3.3.4.cmml">p</mi></mrow><mrow id="algorithm2.26.m4.1.1.3.3.2.3" xref="algorithm2.26.m4.1.1.3.3.2.3.cmml"><mo id="algorithm2.26.m4.1.1.3.3.2.3a" xref="algorithm2.26.m4.1.1.3.3.2.3.cmml">−</mo><mn id="algorithm2.26.m4.1.1.3.3.2.3.2" xref="algorithm2.26.m4.1.1.3.3.2.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.26.m4.1b"><apply id="algorithm2.26.m4.1.1.cmml" xref="algorithm2.26.m4.1.1"><eq id="algorithm2.26.m4.1.1.1.cmml" xref="algorithm2.26.m4.1.1.1"></eq><apply id="algorithm2.26.m4.1.1.2.cmml" xref="algorithm2.26.m4.1.1.2"><csymbol cd="ambiguous" id="algorithm2.26.m4.1.1.2.1.cmml" xref="algorithm2.26.m4.1.1.2">subscript</csymbol><ci id="algorithm2.26.m4.1.1.2.2.cmml" xref="algorithm2.26.m4.1.1.2.2">𝐵</ci><cn type="integer" id="algorithm2.26.m4.1.1.2.3.cmml" xref="algorithm2.26.m4.1.1.2.3">1</cn></apply><apply id="algorithm2.26.m4.1.1.3.cmml" xref="algorithm2.26.m4.1.1.3"><times id="algorithm2.26.m4.1.1.3.1.cmml" xref="algorithm2.26.m4.1.1.3.1"></times><ci id="algorithm2.26.m4.1.1.3.2.cmml" xref="algorithm2.26.m4.1.1.3.2">𝐵</ci><apply id="algorithm2.26.m4.1.1.3.3.cmml" xref="algorithm2.26.m4.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.26.m4.1.1.3.3.1.cmml" xref="algorithm2.26.m4.1.1.3.3">subscript</csymbol><apply id="algorithm2.26.m4.1.1.3.3.2.cmml" xref="algorithm2.26.m4.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.26.m4.1.1.3.3.2.1.cmml" xref="algorithm2.26.m4.1.1.3.3">superscript</csymbol><ci id="algorithm2.26.m4.1.1.3.3.2.2.cmml" xref="algorithm2.26.m4.1.1.3.3.2.2">𝑀</ci><apply id="algorithm2.26.m4.1.1.3.3.2.3.cmml" xref="algorithm2.26.m4.1.1.3.3.2.3"><minus id="algorithm2.26.m4.1.1.3.3.2.3.1.cmml" xref="algorithm2.26.m4.1.1.3.3.2.3"></minus><cn type="integer" id="algorithm2.26.m4.1.1.3.3.2.3.2.cmml" xref="algorithm2.26.m4.1.1.3.3.2.3.2">1</cn></apply></apply><apply id="algorithm2.26.m4.1.1.3.3.3.cmml" xref="algorithm2.26.m4.1.1.3.3.3"><times id="algorithm2.26.m4.1.1.3.3.3.1.cmml" xref="algorithm2.26.m4.1.1.3.3.3.1"></times><ci id="algorithm2.26.m4.1.1.3.3.3.2.cmml" xref="algorithm2.26.m4.1.1.3.3.3.2">𝑡</ci><ci id="algorithm2.26.m4.1.1.3.3.3.3.cmml" xref="algorithm2.26.m4.1.1.3.3.3.3">𝑜</ci><ci id="algorithm2.26.m4.1.1.3.3.3.4.cmml" xref="algorithm2.26.m4.1.1.3.3.3.4">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.26.m4.1c">B_{1}=B\times M^{-1}_{top}</annotation></semantics></math>, <math id="algorithm2.27.m5.1" class="ltx_Math" alttext="B_{2}=B\times M^{-1}_{bottom}" display="inline"><semantics id="algorithm2.27.m5.1a"><mrow id="algorithm2.27.m5.1.1" xref="algorithm2.27.m5.1.1.cmml"><msub id="algorithm2.27.m5.1.1.2" xref="algorithm2.27.m5.1.1.2.cmml"><mi id="algorithm2.27.m5.1.1.2.2" xref="algorithm2.27.m5.1.1.2.2.cmml">B</mi><mn id="algorithm2.27.m5.1.1.2.3" xref="algorithm2.27.m5.1.1.2.3.cmml">2</mn></msub><mo id="algorithm2.27.m5.1.1.1" xref="algorithm2.27.m5.1.1.1.cmml">=</mo><mrow id="algorithm2.27.m5.1.1.3" xref="algorithm2.27.m5.1.1.3.cmml"><mi id="algorithm2.27.m5.1.1.3.2" xref="algorithm2.27.m5.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.27.m5.1.1.3.1" xref="algorithm2.27.m5.1.1.3.1.cmml">×</mo><msubsup id="algorithm2.27.m5.1.1.3.3" xref="algorithm2.27.m5.1.1.3.3.cmml"><mi id="algorithm2.27.m5.1.1.3.3.2.2" xref="algorithm2.27.m5.1.1.3.3.2.2.cmml">M</mi><mrow id="algorithm2.27.m5.1.1.3.3.3" xref="algorithm2.27.m5.1.1.3.3.3.cmml"><mi id="algorithm2.27.m5.1.1.3.3.3.2" xref="algorithm2.27.m5.1.1.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.m5.1.1.3.3.3.1" xref="algorithm2.27.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.27.m5.1.1.3.3.3.3" xref="algorithm2.27.m5.1.1.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.m5.1.1.3.3.3.1a" xref="algorithm2.27.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.27.m5.1.1.3.3.3.4" xref="algorithm2.27.m5.1.1.3.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.m5.1.1.3.3.3.1b" xref="algorithm2.27.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.27.m5.1.1.3.3.3.5" xref="algorithm2.27.m5.1.1.3.3.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.m5.1.1.3.3.3.1c" xref="algorithm2.27.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.27.m5.1.1.3.3.3.6" xref="algorithm2.27.m5.1.1.3.3.3.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.m5.1.1.3.3.3.1d" xref="algorithm2.27.m5.1.1.3.3.3.1.cmml">​</mo><mi id="algorithm2.27.m5.1.1.3.3.3.7" xref="algorithm2.27.m5.1.1.3.3.3.7.cmml">m</mi></mrow><mrow id="algorithm2.27.m5.1.1.3.3.2.3" xref="algorithm2.27.m5.1.1.3.3.2.3.cmml"><mo id="algorithm2.27.m5.1.1.3.3.2.3a" xref="algorithm2.27.m5.1.1.3.3.2.3.cmml">−</mo><mn id="algorithm2.27.m5.1.1.3.3.2.3.2" xref="algorithm2.27.m5.1.1.3.3.2.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.27.m5.1b"><apply id="algorithm2.27.m5.1.1.cmml" xref="algorithm2.27.m5.1.1"><eq id="algorithm2.27.m5.1.1.1.cmml" xref="algorithm2.27.m5.1.1.1"></eq><apply id="algorithm2.27.m5.1.1.2.cmml" xref="algorithm2.27.m5.1.1.2"><csymbol cd="ambiguous" id="algorithm2.27.m5.1.1.2.1.cmml" xref="algorithm2.27.m5.1.1.2">subscript</csymbol><ci id="algorithm2.27.m5.1.1.2.2.cmml" xref="algorithm2.27.m5.1.1.2.2">𝐵</ci><cn type="integer" id="algorithm2.27.m5.1.1.2.3.cmml" xref="algorithm2.27.m5.1.1.2.3">2</cn></apply><apply id="algorithm2.27.m5.1.1.3.cmml" xref="algorithm2.27.m5.1.1.3"><times id="algorithm2.27.m5.1.1.3.1.cmml" xref="algorithm2.27.m5.1.1.3.1"></times><ci id="algorithm2.27.m5.1.1.3.2.cmml" xref="algorithm2.27.m5.1.1.3.2">𝐵</ci><apply id="algorithm2.27.m5.1.1.3.3.cmml" xref="algorithm2.27.m5.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.27.m5.1.1.3.3.1.cmml" xref="algorithm2.27.m5.1.1.3.3">subscript</csymbol><apply id="algorithm2.27.m5.1.1.3.3.2.cmml" xref="algorithm2.27.m5.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.27.m5.1.1.3.3.2.1.cmml" xref="algorithm2.27.m5.1.1.3.3">superscript</csymbol><ci id="algorithm2.27.m5.1.1.3.3.2.2.cmml" xref="algorithm2.27.m5.1.1.3.3.2.2">𝑀</ci><apply id="algorithm2.27.m5.1.1.3.3.2.3.cmml" xref="algorithm2.27.m5.1.1.3.3.2.3"><minus id="algorithm2.27.m5.1.1.3.3.2.3.1.cmml" xref="algorithm2.27.m5.1.1.3.3.2.3"></minus><cn type="integer" id="algorithm2.27.m5.1.1.3.3.2.3.2.cmml" xref="algorithm2.27.m5.1.1.3.3.2.3.2">1</cn></apply></apply><apply id="algorithm2.27.m5.1.1.3.3.3.cmml" xref="algorithm2.27.m5.1.1.3.3.3"><times id="algorithm2.27.m5.1.1.3.3.3.1.cmml" xref="algorithm2.27.m5.1.1.3.3.3.1"></times><ci id="algorithm2.27.m5.1.1.3.3.3.2.cmml" xref="algorithm2.27.m5.1.1.3.3.3.2">𝑏</ci><ci id="algorithm2.27.m5.1.1.3.3.3.3.cmml" xref="algorithm2.27.m5.1.1.3.3.3.3">𝑜</ci><ci id="algorithm2.27.m5.1.1.3.3.3.4.cmml" xref="algorithm2.27.m5.1.1.3.3.3.4">𝑡</ci><ci id="algorithm2.27.m5.1.1.3.3.3.5.cmml" xref="algorithm2.27.m5.1.1.3.3.3.5">𝑡</ci><ci id="algorithm2.27.m5.1.1.3.3.3.6.cmml" xref="algorithm2.27.m5.1.1.3.3.3.6">𝑜</ci><ci id="algorithm2.27.m5.1.1.3.3.3.7.cmml" xref="algorithm2.27.m5.1.1.3.3.3.7">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.27.m5.1c">B_{2}=B\times M^{-1}_{bottom}</annotation></semantics></math> 
Send <math id="algorithm2.28.m6.1" class="ltx_Math" alttext="B_{2}" display="inline"><semantics id="algorithm2.28.m6.1a"><msub id="algorithm2.28.m6.1.1" xref="algorithm2.28.m6.1.1.cmml"><mi id="algorithm2.28.m6.1.1.2" xref="algorithm2.28.m6.1.1.2.cmml">B</mi><mn id="algorithm2.28.m6.1.1.3" xref="algorithm2.28.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.28.m6.1b"><apply id="algorithm2.28.m6.1.1.cmml" xref="algorithm2.28.m6.1.1"><csymbol cd="ambiguous" id="algorithm2.28.m6.1.1.1.cmml" xref="algorithm2.28.m6.1.1">subscript</csymbol><ci id="algorithm2.28.m6.1.1.2.cmml" xref="algorithm2.28.m6.1.1.2">𝐵</ci><cn type="integer" id="algorithm2.28.m6.1.1.3.cmml" xref="algorithm2.28.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.28.m6.1c">B_{2}</annotation></semantics></math> to the server 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.55" class="ltx_block ltx_figure_panel">
<div id="algorithm2.55.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm2.29.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.29.1" class="ltx_emph ltx_font_italic">site <math id="algorithm2.29.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm2.29.1.m1.1a"><mi id="algorithm2.29.1.m1.1.1" xref="algorithm2.29.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm2.29.1.m1.1b"><ci id="algorithm2.29.1.m1.1.1.cmml" xref="algorithm2.29.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.29.1.m1.1c">c</annotation></semantics></math></em> <span id="algorithm2.29.3" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.56" class="ltx_block ltx_figure_panel">
<div id="algorithm2.32" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Receive <math id="algorithm2.30.m1.1" class="ltx_Math" alttext="B_{2}" display="inline"><semantics id="algorithm2.30.m1.1a"><msub id="algorithm2.30.m1.1.1" xref="algorithm2.30.m1.1.1.cmml"><mi id="algorithm2.30.m1.1.1.2" xref="algorithm2.30.m1.1.1.2.cmml">B</mi><mn id="algorithm2.30.m1.1.1.3" xref="algorithm2.30.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.30.m1.1b"><apply id="algorithm2.30.m1.1.1.cmml" xref="algorithm2.30.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.30.m1.1.1.1.cmml" xref="algorithm2.30.m1.1.1">subscript</csymbol><ci id="algorithm2.30.m1.1.1.2.cmml" xref="algorithm2.30.m1.1.1.2">𝐵</ci><cn type="integer" id="algorithm2.30.m1.1.1.3.cmml" xref="algorithm2.30.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.30.m1.1c">B_{2}</annotation></semantics></math> from the server 
Calculate <math id="algorithm2.31.m2.1" class="ltx_Math" alttext="V_{2}=A_{2}B_{2}" display="inline"><semantics id="algorithm2.31.m2.1a"><mrow id="algorithm2.31.m2.1.1" xref="algorithm2.31.m2.1.1.cmml"><msub id="algorithm2.31.m2.1.1.2" xref="algorithm2.31.m2.1.1.2.cmml"><mi id="algorithm2.31.m2.1.1.2.2" xref="algorithm2.31.m2.1.1.2.2.cmml">V</mi><mn id="algorithm2.31.m2.1.1.2.3" xref="algorithm2.31.m2.1.1.2.3.cmml">2</mn></msub><mo id="algorithm2.31.m2.1.1.1" xref="algorithm2.31.m2.1.1.1.cmml">=</mo><mrow id="algorithm2.31.m2.1.1.3" xref="algorithm2.31.m2.1.1.3.cmml"><msub id="algorithm2.31.m2.1.1.3.2" xref="algorithm2.31.m2.1.1.3.2.cmml"><mi id="algorithm2.31.m2.1.1.3.2.2" xref="algorithm2.31.m2.1.1.3.2.2.cmml">A</mi><mn id="algorithm2.31.m2.1.1.3.2.3" xref="algorithm2.31.m2.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="algorithm2.31.m2.1.1.3.1" xref="algorithm2.31.m2.1.1.3.1.cmml">​</mo><msub id="algorithm2.31.m2.1.1.3.3" xref="algorithm2.31.m2.1.1.3.3.cmml"><mi id="algorithm2.31.m2.1.1.3.3.2" xref="algorithm2.31.m2.1.1.3.3.2.cmml">B</mi><mn id="algorithm2.31.m2.1.1.3.3.3" xref="algorithm2.31.m2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.31.m2.1b"><apply id="algorithm2.31.m2.1.1.cmml" xref="algorithm2.31.m2.1.1"><eq id="algorithm2.31.m2.1.1.1.cmml" xref="algorithm2.31.m2.1.1.1"></eq><apply id="algorithm2.31.m2.1.1.2.cmml" xref="algorithm2.31.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm2.31.m2.1.1.2.1.cmml" xref="algorithm2.31.m2.1.1.2">subscript</csymbol><ci id="algorithm2.31.m2.1.1.2.2.cmml" xref="algorithm2.31.m2.1.1.2.2">𝑉</ci><cn type="integer" id="algorithm2.31.m2.1.1.2.3.cmml" xref="algorithm2.31.m2.1.1.2.3">2</cn></apply><apply id="algorithm2.31.m2.1.1.3.cmml" xref="algorithm2.31.m2.1.1.3"><times id="algorithm2.31.m2.1.1.3.1.cmml" xref="algorithm2.31.m2.1.1.3.1"></times><apply id="algorithm2.31.m2.1.1.3.2.cmml" xref="algorithm2.31.m2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.31.m2.1.1.3.2.1.cmml" xref="algorithm2.31.m2.1.1.3.2">subscript</csymbol><ci id="algorithm2.31.m2.1.1.3.2.2.cmml" xref="algorithm2.31.m2.1.1.3.2.2">𝐴</ci><cn type="integer" id="algorithm2.31.m2.1.1.3.2.3.cmml" xref="algorithm2.31.m2.1.1.3.2.3">2</cn></apply><apply id="algorithm2.31.m2.1.1.3.3.cmml" xref="algorithm2.31.m2.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.31.m2.1.1.3.3.1.cmml" xref="algorithm2.31.m2.1.1.3.3">subscript</csymbol><ci id="algorithm2.31.m2.1.1.3.3.2.cmml" xref="algorithm2.31.m2.1.1.3.3.2">𝐵</ci><cn type="integer" id="algorithm2.31.m2.1.1.3.3.3.cmml" xref="algorithm2.31.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.31.m2.1c">V_{2}=A_{2}B_{2}</annotation></semantics></math> 
Send <math id="algorithm2.32.m3.1" class="ltx_Math" alttext="V_{2}" display="inline"><semantics id="algorithm2.32.m3.1a"><msub id="algorithm2.32.m3.1.1" xref="algorithm2.32.m3.1.1.cmml"><mi id="algorithm2.32.m3.1.1.2" xref="algorithm2.32.m3.1.1.2.cmml">V</mi><mn id="algorithm2.32.m3.1.1.3" xref="algorithm2.32.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.32.m3.1b"><apply id="algorithm2.32.m3.1.1.cmml" xref="algorithm2.32.m3.1.1"><csymbol cd="ambiguous" id="algorithm2.32.m3.1.1.1.cmml" xref="algorithm2.32.m3.1.1">subscript</csymbol><ci id="algorithm2.32.m3.1.1.2.cmml" xref="algorithm2.32.m3.1.1.2">𝑉</ci><cn type="integer" id="algorithm2.32.m3.1.1.3.cmml" xref="algorithm2.32.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.32.m3.1c">V_{2}</annotation></semantics></math> to the server 

</div>
<div id="algorithm2.56.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.57" class="ltx_block ltx_figure_panel">
<div id="algorithm2.33" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm2.33.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.33.1" class="ltx_emph ltx_font_italic">site <math id="algorithm2.33.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm2.33.1.m1.1a"><mi id="algorithm2.33.1.m1.1.1" xref="algorithm2.33.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm2.33.1.m1.1b"><ci id="algorithm2.33.1.m1.1.1.cmml" xref="algorithm2.33.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.33.1.m1.1c">d</annotation></semantics></math></em> <span id="algorithm2.33.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.36" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Receive <math id="algorithm2.34.m1.1" class="ltx_Math" alttext="A_{1}" display="inline"><semantics id="algorithm2.34.m1.1a"><msub id="algorithm2.34.m1.1.1" xref="algorithm2.34.m1.1.1.cmml"><mi id="algorithm2.34.m1.1.1.2" xref="algorithm2.34.m1.1.1.2.cmml">A</mi><mn id="algorithm2.34.m1.1.1.3" xref="algorithm2.34.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.34.m1.1b"><apply id="algorithm2.34.m1.1.1.cmml" xref="algorithm2.34.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.34.m1.1.1.1.cmml" xref="algorithm2.34.m1.1.1">subscript</csymbol><ci id="algorithm2.34.m1.1.1.2.cmml" xref="algorithm2.34.m1.1.1.2">𝐴</ci><cn type="integer" id="algorithm2.34.m1.1.1.3.cmml" xref="algorithm2.34.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.34.m1.1c">A_{1}</annotation></semantics></math> from the server 
Calculate <math id="algorithm2.35.m2.1" class="ltx_Math" alttext="V_{1}=A_{1}B_{1}" display="inline"><semantics id="algorithm2.35.m2.1a"><mrow id="algorithm2.35.m2.1.1" xref="algorithm2.35.m2.1.1.cmml"><msub id="algorithm2.35.m2.1.1.2" xref="algorithm2.35.m2.1.1.2.cmml"><mi id="algorithm2.35.m2.1.1.2.2" xref="algorithm2.35.m2.1.1.2.2.cmml">V</mi><mn id="algorithm2.35.m2.1.1.2.3" xref="algorithm2.35.m2.1.1.2.3.cmml">1</mn></msub><mo id="algorithm2.35.m2.1.1.1" xref="algorithm2.35.m2.1.1.1.cmml">=</mo><mrow id="algorithm2.35.m2.1.1.3" xref="algorithm2.35.m2.1.1.3.cmml"><msub id="algorithm2.35.m2.1.1.3.2" xref="algorithm2.35.m2.1.1.3.2.cmml"><mi id="algorithm2.35.m2.1.1.3.2.2" xref="algorithm2.35.m2.1.1.3.2.2.cmml">A</mi><mn id="algorithm2.35.m2.1.1.3.2.3" xref="algorithm2.35.m2.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="algorithm2.35.m2.1.1.3.1" xref="algorithm2.35.m2.1.1.3.1.cmml">​</mo><msub id="algorithm2.35.m2.1.1.3.3" xref="algorithm2.35.m2.1.1.3.3.cmml"><mi id="algorithm2.35.m2.1.1.3.3.2" xref="algorithm2.35.m2.1.1.3.3.2.cmml">B</mi><mn id="algorithm2.35.m2.1.1.3.3.3" xref="algorithm2.35.m2.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.35.m2.1b"><apply id="algorithm2.35.m2.1.1.cmml" xref="algorithm2.35.m2.1.1"><eq id="algorithm2.35.m2.1.1.1.cmml" xref="algorithm2.35.m2.1.1.1"></eq><apply id="algorithm2.35.m2.1.1.2.cmml" xref="algorithm2.35.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm2.35.m2.1.1.2.1.cmml" xref="algorithm2.35.m2.1.1.2">subscript</csymbol><ci id="algorithm2.35.m2.1.1.2.2.cmml" xref="algorithm2.35.m2.1.1.2.2">𝑉</ci><cn type="integer" id="algorithm2.35.m2.1.1.2.3.cmml" xref="algorithm2.35.m2.1.1.2.3">1</cn></apply><apply id="algorithm2.35.m2.1.1.3.cmml" xref="algorithm2.35.m2.1.1.3"><times id="algorithm2.35.m2.1.1.3.1.cmml" xref="algorithm2.35.m2.1.1.3.1"></times><apply id="algorithm2.35.m2.1.1.3.2.cmml" xref="algorithm2.35.m2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.35.m2.1.1.3.2.1.cmml" xref="algorithm2.35.m2.1.1.3.2">subscript</csymbol><ci id="algorithm2.35.m2.1.1.3.2.2.cmml" xref="algorithm2.35.m2.1.1.3.2.2">𝐴</ci><cn type="integer" id="algorithm2.35.m2.1.1.3.2.3.cmml" xref="algorithm2.35.m2.1.1.3.2.3">1</cn></apply><apply id="algorithm2.35.m2.1.1.3.3.cmml" xref="algorithm2.35.m2.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.35.m2.1.1.3.3.1.cmml" xref="algorithm2.35.m2.1.1.3.3">subscript</csymbol><ci id="algorithm2.35.m2.1.1.3.3.2.cmml" xref="algorithm2.35.m2.1.1.3.3.2">𝐵</ci><cn type="integer" id="algorithm2.35.m2.1.1.3.3.3.cmml" xref="algorithm2.35.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.35.m2.1c">V_{1}=A_{1}B_{1}</annotation></semantics></math>  
Send <math id="algorithm2.36.m3.1" class="ltx_Math" alttext="V_{1}" display="inline"><semantics id="algorithm2.36.m3.1a"><msub id="algorithm2.36.m3.1.1" xref="algorithm2.36.m3.1.1.cmml"><mi id="algorithm2.36.m3.1.1.2" xref="algorithm2.36.m3.1.1.2.cmml">V</mi><mn id="algorithm2.36.m3.1.1.3" xref="algorithm2.36.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.36.m3.1b"><apply id="algorithm2.36.m3.1.1.cmml" xref="algorithm2.36.m3.1.1"><csymbol cd="ambiguous" id="algorithm2.36.m3.1.1.1.cmml" xref="algorithm2.36.m3.1.1">subscript</csymbol><ci id="algorithm2.36.m3.1.1.2.cmml" xref="algorithm2.36.m3.1.1.2">𝑉</ci><cn type="integer" id="algorithm2.36.m3.1.1.3.cmml" xref="algorithm2.36.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.36.m3.1c">V_{1}</annotation></semantics></math> to the server 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.58" class="ltx_block ltx_figure_panel">
<div id="algorithm2.58.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.41" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Server completes <math id="algorithm2.37.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="algorithm2.37.m1.1a"><mi id="algorithm2.37.m1.1.1" xref="algorithm2.37.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="algorithm2.37.m1.1b"><ci id="algorithm2.37.m1.1.1.cmml" xref="algorithm2.37.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.37.m1.1c">V</annotation></semantics></math>=<math id="algorithm2.38.m2.1" class="ltx_Math" alttext="V_{1}" display="inline"><semantics id="algorithm2.38.m2.1a"><msub id="algorithm2.38.m2.1.1" xref="algorithm2.38.m2.1.1.cmml"><mi id="algorithm2.38.m2.1.1.2" xref="algorithm2.38.m2.1.1.2.cmml">V</mi><mn id="algorithm2.38.m2.1.1.3" xref="algorithm2.38.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.38.m2.1b"><apply id="algorithm2.38.m2.1.1.cmml" xref="algorithm2.38.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.38.m2.1.1.1.cmml" xref="algorithm2.38.m2.1.1">subscript</csymbol><ci id="algorithm2.38.m2.1.1.2.cmml" xref="algorithm2.38.m2.1.1.2">𝑉</ci><cn type="integer" id="algorithm2.38.m2.1.1.3.cmml" xref="algorithm2.38.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.38.m2.1c">V_{1}</annotation></semantics></math>+<math id="algorithm2.39.m3.1" class="ltx_Math" alttext="V_{2}" display="inline"><semantics id="algorithm2.39.m3.1a"><msub id="algorithm2.39.m3.1.1" xref="algorithm2.39.m3.1.1.cmml"><mi id="algorithm2.39.m3.1.1.2" xref="algorithm2.39.m3.1.1.2.cmml">V</mi><mn id="algorithm2.39.m3.1.1.3" xref="algorithm2.39.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.39.m3.1b"><apply id="algorithm2.39.m3.1.1.cmml" xref="algorithm2.39.m3.1.1"><csymbol cd="ambiguous" id="algorithm2.39.m3.1.1.1.cmml" xref="algorithm2.39.m3.1.1">subscript</csymbol><ci id="algorithm2.39.m3.1.1.2.cmml" xref="algorithm2.39.m3.1.1.2">𝑉</ci><cn type="integer" id="algorithm2.39.m3.1.1.3.cmml" xref="algorithm2.39.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.39.m3.1c">V_{2}</annotation></semantics></math> 
<span id="algorithm2.41.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.41.2" class="ltx_emph ltx_font_italic"> <math id="algorithm2.40.1.m1.1" class="ltx_Math" alttext="\forall" display="inline"><semantics id="algorithm2.40.1.m1.1a"><mo id="algorithm2.40.1.m1.1.1" xref="algorithm2.40.1.m1.1.1.cmml">∀</mo><annotation-xml encoding="MathML-Content" id="algorithm2.40.1.m1.1b"><csymbol cd="latexml" id="algorithm2.40.1.m1.1.1.cmml" xref="algorithm2.40.1.m1.1.1">for-all</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.40.1.m1.1c">\forall</annotation></semantics></math> patient <math id="algorithm2.41.2.m2.1" class="ltx_Math" alttext="i\in c" display="inline"><semantics id="algorithm2.41.2.m2.1a"><mrow id="algorithm2.41.2.m2.1.1" xref="algorithm2.41.2.m2.1.1.cmml"><mi id="algorithm2.41.2.m2.1.1.2" xref="algorithm2.41.2.m2.1.1.2.cmml">i</mi><mo id="algorithm2.41.2.m2.1.1.1" xref="algorithm2.41.2.m2.1.1.1.cmml">∈</mo><mi id="algorithm2.41.2.m2.1.1.3" xref="algorithm2.41.2.m2.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.41.2.m2.1b"><apply id="algorithm2.41.2.m2.1.1.cmml" xref="algorithm2.41.2.m2.1.1"><in id="algorithm2.41.2.m2.1.1.1.cmml" xref="algorithm2.41.2.m2.1.1.1"></in><ci id="algorithm2.41.2.m2.1.1.2.cmml" xref="algorithm2.41.2.m2.1.1.2">𝑖</ci><ci id="algorithm2.41.2.m2.1.1.3.cmml" xref="algorithm2.41.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.41.2.m2.1c">i\in c</annotation></semantics></math></em> <span id="algorithm2.41.4" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.59" class="ltx_block ltx_figure_panel">
<div id="algorithm2.43" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.43.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.43.2" class="ltx_emph ltx_font_italic"> <math id="algorithm2.42.1.m1.1" class="ltx_Math" alttext="\forall" display="inline"><semantics id="algorithm2.42.1.m1.1a"><mo id="algorithm2.42.1.m1.1.1" xref="algorithm2.42.1.m1.1.1.cmml">∀</mo><annotation-xml encoding="MathML-Content" id="algorithm2.42.1.m1.1b"><csymbol cd="latexml" id="algorithm2.42.1.m1.1.1.cmml" xref="algorithm2.42.1.m1.1.1">for-all</csymbol></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.42.1.m1.1c">\forall</annotation></semantics></math> patient <math id="algorithm2.43.2.m2.1" class="ltx_Math" alttext="j\in d" display="inline"><semantics id="algorithm2.43.2.m2.1a"><mrow id="algorithm2.43.2.m2.1.1" xref="algorithm2.43.2.m2.1.1.cmml"><mi id="algorithm2.43.2.m2.1.1.2" xref="algorithm2.43.2.m2.1.1.2.cmml">j</mi><mo id="algorithm2.43.2.m2.1.1.1" xref="algorithm2.43.2.m2.1.1.1.cmml">∈</mo><mi id="algorithm2.43.2.m2.1.1.3" xref="algorithm2.43.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.43.2.m2.1b"><apply id="algorithm2.43.2.m2.1.1.cmml" xref="algorithm2.43.2.m2.1.1"><in id="algorithm2.43.2.m2.1.1.1.cmml" xref="algorithm2.43.2.m2.1.1.1"></in><ci id="algorithm2.43.2.m2.1.1.2.cmml" xref="algorithm2.43.2.m2.1.1.2">𝑗</ci><ci id="algorithm2.43.2.m2.1.1.3.cmml" xref="algorithm2.43.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.43.2.m2.1c">j\in d</annotation></semantics></math></em> <span id="algorithm2.43.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.49" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Update similarity matrix <math id="algorithm2.44.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.44.m1.1a"><mi id="algorithm2.44.m1.1.1" xref="algorithm2.44.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.44.m1.1b"><ci id="algorithm2.44.m1.1.1.cmml" xref="algorithm2.44.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.44.m1.1c">S</annotation></semantics></math> with the corresponding value in <math id="algorithm2.45.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="algorithm2.45.m2.1a"><mi id="algorithm2.45.m2.1.1" xref="algorithm2.45.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="algorithm2.45.m2.1b"><ci id="algorithm2.45.m2.1.1.cmml" xref="algorithm2.45.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.45.m2.1c">V</annotation></semantics></math>: <math id="algorithm2.46.m3.2" class="ltx_Math" alttext="S_{c_{i},d_{j}}" display="inline"><semantics id="algorithm2.46.m3.2a"><msub id="algorithm2.46.m3.2.3" xref="algorithm2.46.m3.2.3.cmml"><mi id="algorithm2.46.m3.2.3.2" xref="algorithm2.46.m3.2.3.2.cmml">S</mi><mrow id="algorithm2.46.m3.2.2.2.2" xref="algorithm2.46.m3.2.2.2.3.cmml"><msub id="algorithm2.46.m3.1.1.1.1.1" xref="algorithm2.46.m3.1.1.1.1.1.cmml"><mi id="algorithm2.46.m3.1.1.1.1.1.2" xref="algorithm2.46.m3.1.1.1.1.1.2.cmml">c</mi><mi id="algorithm2.46.m3.1.1.1.1.1.3" xref="algorithm2.46.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm2.46.m3.2.2.2.2.3" xref="algorithm2.46.m3.2.2.2.3.cmml">,</mo><msub id="algorithm2.46.m3.2.2.2.2.2" xref="algorithm2.46.m3.2.2.2.2.2.cmml"><mi id="algorithm2.46.m3.2.2.2.2.2.2" xref="algorithm2.46.m3.2.2.2.2.2.2.cmml">d</mi><mi id="algorithm2.46.m3.2.2.2.2.2.3" xref="algorithm2.46.m3.2.2.2.2.2.3.cmml">j</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.46.m3.2b"><apply id="algorithm2.46.m3.2.3.cmml" xref="algorithm2.46.m3.2.3"><csymbol cd="ambiguous" id="algorithm2.46.m3.2.3.1.cmml" xref="algorithm2.46.m3.2.3">subscript</csymbol><ci id="algorithm2.46.m3.2.3.2.cmml" xref="algorithm2.46.m3.2.3.2">𝑆</ci><list id="algorithm2.46.m3.2.2.2.3.cmml" xref="algorithm2.46.m3.2.2.2.2"><apply id="algorithm2.46.m3.1.1.1.1.1.cmml" xref="algorithm2.46.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.46.m3.1.1.1.1.1.1.cmml" xref="algorithm2.46.m3.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.46.m3.1.1.1.1.1.2.cmml" xref="algorithm2.46.m3.1.1.1.1.1.2">𝑐</ci><ci id="algorithm2.46.m3.1.1.1.1.1.3.cmml" xref="algorithm2.46.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm2.46.m3.2.2.2.2.2.cmml" xref="algorithm2.46.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.46.m3.2.2.2.2.2.1.cmml" xref="algorithm2.46.m3.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.46.m3.2.2.2.2.2.2.cmml" xref="algorithm2.46.m3.2.2.2.2.2.2">𝑑</ci><ci id="algorithm2.46.m3.2.2.2.2.2.3.cmml" xref="algorithm2.46.m3.2.2.2.2.2.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.46.m3.2c">S_{c_{i},d_{j}}</annotation></semantics></math>, <math id="algorithm2.47.m4.2" class="ltx_Math" alttext="S_{d_{j},c_{i}}" display="inline"><semantics id="algorithm2.47.m4.2a"><msub id="algorithm2.47.m4.2.3" xref="algorithm2.47.m4.2.3.cmml"><mi id="algorithm2.47.m4.2.3.2" xref="algorithm2.47.m4.2.3.2.cmml">S</mi><mrow id="algorithm2.47.m4.2.2.2.2" xref="algorithm2.47.m4.2.2.2.3.cmml"><msub id="algorithm2.47.m4.1.1.1.1.1" xref="algorithm2.47.m4.1.1.1.1.1.cmml"><mi id="algorithm2.47.m4.1.1.1.1.1.2" xref="algorithm2.47.m4.1.1.1.1.1.2.cmml">d</mi><mi id="algorithm2.47.m4.1.1.1.1.1.3" xref="algorithm2.47.m4.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm2.47.m4.2.2.2.2.3" xref="algorithm2.47.m4.2.2.2.3.cmml">,</mo><msub id="algorithm2.47.m4.2.2.2.2.2" xref="algorithm2.47.m4.2.2.2.2.2.cmml"><mi id="algorithm2.47.m4.2.2.2.2.2.2" xref="algorithm2.47.m4.2.2.2.2.2.2.cmml">c</mi><mi id="algorithm2.47.m4.2.2.2.2.2.3" xref="algorithm2.47.m4.2.2.2.2.2.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.47.m4.2b"><apply id="algorithm2.47.m4.2.3.cmml" xref="algorithm2.47.m4.2.3"><csymbol cd="ambiguous" id="algorithm2.47.m4.2.3.1.cmml" xref="algorithm2.47.m4.2.3">subscript</csymbol><ci id="algorithm2.47.m4.2.3.2.cmml" xref="algorithm2.47.m4.2.3.2">𝑆</ci><list id="algorithm2.47.m4.2.2.2.3.cmml" xref="algorithm2.47.m4.2.2.2.2"><apply id="algorithm2.47.m4.1.1.1.1.1.cmml" xref="algorithm2.47.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.47.m4.1.1.1.1.1.1.cmml" xref="algorithm2.47.m4.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.47.m4.1.1.1.1.1.2.cmml" xref="algorithm2.47.m4.1.1.1.1.1.2">𝑑</ci><ci id="algorithm2.47.m4.1.1.1.1.1.3.cmml" xref="algorithm2.47.m4.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm2.47.m4.2.2.2.2.2.cmml" xref="algorithm2.47.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.47.m4.2.2.2.2.2.1.cmml" xref="algorithm2.47.m4.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.47.m4.2.2.2.2.2.2.cmml" xref="algorithm2.47.m4.2.2.2.2.2.2">𝑐</ci><ci id="algorithm2.47.m4.2.2.2.2.2.3.cmml" xref="algorithm2.47.m4.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.47.m4.2c">S_{d_{j},c_{i}}</annotation></semantics></math> <math id="algorithm2.48.m5.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm2.48.m5.1a"><mo stretchy="false" id="algorithm2.48.m5.1.1" xref="algorithm2.48.m5.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm2.48.m5.1b"><ci id="algorithm2.48.m5.1.1.cmml" xref="algorithm2.48.m5.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.48.m5.1c">\leftarrow</annotation></semantics></math> <math id="algorithm2.49.m6.2" class="ltx_Math" alttext="V_{i,j}" display="inline"><semantics id="algorithm2.49.m6.2a"><msub id="algorithm2.49.m6.2.3" xref="algorithm2.49.m6.2.3.cmml"><mi id="algorithm2.49.m6.2.3.2" xref="algorithm2.49.m6.2.3.2.cmml">V</mi><mrow id="algorithm2.49.m6.2.2.2.4" xref="algorithm2.49.m6.2.2.2.3.cmml"><mi id="algorithm2.49.m6.1.1.1.1" xref="algorithm2.49.m6.1.1.1.1.cmml">i</mi><mo id="algorithm2.49.m6.2.2.2.4.1" xref="algorithm2.49.m6.2.2.2.3.cmml">,</mo><mi id="algorithm2.49.m6.2.2.2.2" xref="algorithm2.49.m6.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.49.m6.2b"><apply id="algorithm2.49.m6.2.3.cmml" xref="algorithm2.49.m6.2.3"><csymbol cd="ambiguous" id="algorithm2.49.m6.2.3.1.cmml" xref="algorithm2.49.m6.2.3">subscript</csymbol><ci id="algorithm2.49.m6.2.3.2.cmml" xref="algorithm2.49.m6.2.3.2">𝑉</ci><list id="algorithm2.49.m6.2.2.2.3.cmml" xref="algorithm2.49.m6.2.2.2.4"><ci id="algorithm2.49.m6.1.1.1.1.cmml" xref="algorithm2.49.m6.1.1.1.1">𝑖</ci><ci id="algorithm2.49.m6.2.2.2.2.cmml" xref="algorithm2.49.m6.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.49.m6.2c">V_{i,j}</annotation></semantics></math> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.60" class="ltx_block ltx_figure_panel">
<div id="algorithm2.60.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.60.2" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.61" class="ltx_block ltx_figure_panel">
<div id="algorithm2.61.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.61.2" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm2.62" class="ltx_block ltx_figure_panel">
<div id="algorithm2.62.1" class="ltx_listingline"> end for
</div>
<div id="algorithm2.50" class="ltx_listingline">Return Global similarity matrix <math id="algorithm2.50.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm2.50.m1.1a"><mi id="algorithm2.50.m1.1.1" xref="algorithm2.50.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm2.50.m1.1b"><ci id="algorithm2.50.m1.1.1.cmml" xref="algorithm2.50.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.50.m1.1c">S</annotation></semantics></math> 

</div>
</div>
</div>
</div>
</figure>
<figure id="algorithm3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm3.21.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Clustering patients</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm3.1" class="ltx_p ltx_figure_panel"><span id="algorithm3.1.1" class="ltx_text"><span id="algorithm3.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Global similarity matrix <math id="algorithm3.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm3.1.m1.1a"><mi id="algorithm3.1.m1.1.1" xref="algorithm3.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm3.1.m1.1b"><ci id="algorithm3.1.m1.1.1.cmml" xref="algorithm3.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.1.m1.1c">S</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm3.3" class="ltx_p ltx_figure_panel"><span id="algorithm3.3.1" class="ltx_text"><span id="algorithm3.3.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Patient clusters for each site <math id="algorithm3.2.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm3.2.m1.1a"><mi id="algorithm3.2.m1.1.1" xref="algorithm3.2.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm3.2.m1.1b"><ci id="algorithm3.2.m1.1.1.cmml" xref="algorithm3.2.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.2.m1.1c">c</annotation></semantics></math> in site <math id="algorithm3.3.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm3.3.m2.1a"><mi id="algorithm3.3.m2.1.1" xref="algorithm3.3.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm3.3.m2.1b"><ci id="algorithm3.3.m2.1.1.cmml" xref="algorithm3.3.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.3.m2.1c">C</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm3.6" class="ltx_p ltx_figure_panel">Initialize list to hold within-cluster sum of squares (WCSS) for each <math id="algorithm3.4.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm3.4.m1.1a"><mi id="algorithm3.4.m1.1.1" xref="algorithm3.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm3.4.m1.1b"><ci id="algorithm3.4.m1.1.1.cmml" xref="algorithm3.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.4.m1.1c">k</annotation></semantics></math>, denoted as WCSS[] 
<span id="algorithm3.6.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm3.6.2" class="ltx_emph ltx_font_italic">each <math id="algorithm3.5.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm3.5.1.m1.1a"><mi id="algorithm3.5.1.m1.1.1" xref="algorithm3.5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm3.5.1.m1.1b"><ci id="algorithm3.5.1.m1.1.1.cmml" xref="algorithm3.5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.5.1.m1.1c">k</annotation></semantics></math> <math id="algorithm3.6.2.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="algorithm3.6.2.m2.1a"><mo id="algorithm3.6.2.m2.1.1" xref="algorithm3.6.2.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="algorithm3.6.2.m2.1b"><in id="algorithm3.6.2.m2.1.1.cmml" xref="algorithm3.6.2.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.6.2.m2.1c">\in</annotation></semantics></math> 1, 2, …, 10</em> <span id="algorithm3.6.4" class="ltx_text ltx_font_bold">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="algorithm3.12" class="ltx_listingline ltx_figure_panel">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Apply spectral clustering to global similarity matrix <math id="algorithm3.7.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm3.7.m1.1a"><mi id="algorithm3.7.m1.1.1" xref="algorithm3.7.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm3.7.m1.1b"><ci id="algorithm3.7.m1.1.1.cmml" xref="algorithm3.7.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.7.m1.1c">S</annotation></semantics></math> with <math id="algorithm3.8.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm3.8.m2.1a"><mi id="algorithm3.8.m2.1.1" xref="algorithm3.8.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm3.8.m2.1b"><ci id="algorithm3.8.m2.1.1.cmml" xref="algorithm3.8.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.8.m2.1c">k</annotation></semantics></math> clusters 
Compute WCSS for current <math id="algorithm3.9.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm3.9.m3.1a"><mi id="algorithm3.9.m3.1.1" xref="algorithm3.9.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm3.9.m3.1b"><ci id="algorithm3.9.m3.1.1.cmml" xref="algorithm3.9.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.9.m3.1c">k</annotation></semantics></math>, denoted as WCSS<sub id="algorithm3.12.1" class="ltx_sub"><span id="algorithm3.12.1.1" class="ltx_text ltx_font_italic">k</span></sub> 
Store WCSS<sub id="algorithm3.12.2" class="ltx_sub"><span id="algorithm3.12.2.1" class="ltx_text ltx_font_italic">k</span></sub> in WCSS[<math id="algorithm3.12.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm3.12.m6.1a"><mi id="algorithm3.12.m6.1.1" xref="algorithm3.12.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm3.12.m6.1b"><ci id="algorithm3.12.m6.1.1.cmml" xref="algorithm3.12.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.12.m6.1c">k</annotation></semantics></math>] 

</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="algorithm3.22" class="ltx_block ltx_figure_panel">
<div id="algorithm3.22.1" class="ltx_listingline ltx_figure_panel"> end for
</div>
<div id="algorithm3.16" class="ltx_listingline">Determine optimal number of clusters, <math id="algorithm3.13.m1.1" class="ltx_Math" alttext="k_{opt}" display="inline"><semantics id="algorithm3.13.m1.1a"><msub id="algorithm3.13.m1.1.1" xref="algorithm3.13.m1.1.1.cmml"><mi id="algorithm3.13.m1.1.1.2" xref="algorithm3.13.m1.1.1.2.cmml">k</mi><mrow id="algorithm3.13.m1.1.1.3" xref="algorithm3.13.m1.1.1.3.cmml"><mi id="algorithm3.13.m1.1.1.3.2" xref="algorithm3.13.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm3.13.m1.1.1.3.1" xref="algorithm3.13.m1.1.1.3.1.cmml">​</mo><mi id="algorithm3.13.m1.1.1.3.3" xref="algorithm3.13.m1.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm3.13.m1.1.1.3.1a" xref="algorithm3.13.m1.1.1.3.1.cmml">​</mo><mi id="algorithm3.13.m1.1.1.3.4" xref="algorithm3.13.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm3.13.m1.1b"><apply id="algorithm3.13.m1.1.1.cmml" xref="algorithm3.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.13.m1.1.1.1.cmml" xref="algorithm3.13.m1.1.1">subscript</csymbol><ci id="algorithm3.13.m1.1.1.2.cmml" xref="algorithm3.13.m1.1.1.2">𝑘</ci><apply id="algorithm3.13.m1.1.1.3.cmml" xref="algorithm3.13.m1.1.1.3"><times id="algorithm3.13.m1.1.1.3.1.cmml" xref="algorithm3.13.m1.1.1.3.1"></times><ci id="algorithm3.13.m1.1.1.3.2.cmml" xref="algorithm3.13.m1.1.1.3.2">𝑜</ci><ci id="algorithm3.13.m1.1.1.3.3.cmml" xref="algorithm3.13.m1.1.1.3.3">𝑝</ci><ci id="algorithm3.13.m1.1.1.3.4.cmml" xref="algorithm3.13.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.13.m1.1c">k_{opt}</annotation></semantics></math>, using elbow method on WCSS 
<span id="algorithm3.16.4" class="ltx_text ltx_font_bold">for</span> <em id="algorithm3.16.3" class="ltx_emph ltx_font_italic">each <math id="algorithm3.14.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm3.14.1.m1.1a"><mi id="algorithm3.14.1.m1.1.1" xref="algorithm3.14.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm3.14.1.m1.1b"><ci id="algorithm3.14.1.m1.1.1.cmml" xref="algorithm3.14.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.14.1.m1.1c">c</annotation></semantics></math> <math id="algorithm3.15.2.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="algorithm3.15.2.m2.1a"><mo id="algorithm3.15.2.m2.1.1" xref="algorithm3.15.2.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="algorithm3.15.2.m2.1b"><in id="algorithm3.15.2.m2.1.1.cmml" xref="algorithm3.15.2.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.15.2.m2.1c">\in</annotation></semantics></math> site <math id="algorithm3.16.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm3.16.3.m3.1a"><mi id="algorithm3.16.3.m3.1.1" xref="algorithm3.16.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm3.16.3.m3.1b"><ci id="algorithm3.16.3.m3.1.1.cmml" xref="algorithm3.16.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.16.3.m3.1c">C</annotation></semantics></math></em> <span id="algorithm3.16.5" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="algorithm3.23" class="ltx_block ltx_figure_panel">
<div id="algorithm3.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Apply spectral clustering on <math id="algorithm3.17.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm3.17.m1.1a"><mi id="algorithm3.17.m1.1.1" xref="algorithm3.17.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm3.17.m1.1b"><ci id="algorithm3.17.m1.1.1.cmml" xref="algorithm3.17.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.17.m1.1c">S</annotation></semantics></math> using <math id="algorithm3.18.m2.1" class="ltx_Math" alttext="k_{opt}" display="inline"><semantics id="algorithm3.18.m2.1a"><msub id="algorithm3.18.m2.1.1" xref="algorithm3.18.m2.1.1.cmml"><mi id="algorithm3.18.m2.1.1.2" xref="algorithm3.18.m2.1.1.2.cmml">k</mi><mrow id="algorithm3.18.m2.1.1.3" xref="algorithm3.18.m2.1.1.3.cmml"><mi id="algorithm3.18.m2.1.1.3.2" xref="algorithm3.18.m2.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm3.18.m2.1.1.3.1" xref="algorithm3.18.m2.1.1.3.1.cmml">​</mo><mi id="algorithm3.18.m2.1.1.3.3" xref="algorithm3.18.m2.1.1.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm3.18.m2.1.1.3.1a" xref="algorithm3.18.m2.1.1.3.1.cmml">​</mo><mi id="algorithm3.18.m2.1.1.3.4" xref="algorithm3.18.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm3.18.m2.1b"><apply id="algorithm3.18.m2.1.1.cmml" xref="algorithm3.18.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.18.m2.1.1.1.cmml" xref="algorithm3.18.m2.1.1">subscript</csymbol><ci id="algorithm3.18.m2.1.1.2.cmml" xref="algorithm3.18.m2.1.1.2">𝑘</ci><apply id="algorithm3.18.m2.1.1.3.cmml" xref="algorithm3.18.m2.1.1.3"><times id="algorithm3.18.m2.1.1.3.1.cmml" xref="algorithm3.18.m2.1.1.3.1"></times><ci id="algorithm3.18.m2.1.1.3.2.cmml" xref="algorithm3.18.m2.1.1.3.2">𝑜</ci><ci id="algorithm3.18.m2.1.1.3.3.cmml" xref="algorithm3.18.m2.1.1.3.3">𝑝</ci><ci id="algorithm3.18.m2.1.1.3.4.cmml" xref="algorithm3.18.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.18.m2.1c">k_{opt}</annotation></semantics></math> clusters 
Return patient clusters for site <math id="algorithm3.19.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm3.19.m3.1a"><mi id="algorithm3.19.m3.1.1" xref="algorithm3.19.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm3.19.m3.1b"><ci id="algorithm3.19.m3.1.1.cmml" xref="algorithm3.19.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.19.m3.1c">c</annotation></semantics></math> 

</div>
<div id="algorithm3.23.1" class="ltx_listingline"> end for
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="algorithm3.24" class="ltx_listingline ltx_figure_panel">
</div>
</div>
</div>
</figure>
<figure id="algorithm4" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm4.32.1.1" class="ltx_text ltx_font_bold">Algorithm 4</span> </span> Predicting Outcomes</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm4.1" class="ltx_p ltx_figure_panel"><span id="algorithm4.1.1" class="ltx_text"><span id="algorithm4.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Clusters <math id="algorithm4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm4.1.m1.1a"><mi id="algorithm4.1.m1.1.1" xref="algorithm4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm4.1.m1.1b"><ci id="algorithm4.1.m1.1.1.cmml" xref="algorithm4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.1.m1.1c">K</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm4.33" class="ltx_p ltx_figure_panel"><span id="algorithm4.33.1" class="ltx_text"><span id="algorithm4.33.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Global AUC, Global AUPRC</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="algorithm4.3" class="ltx_p ltx_figure_panel"><span id="algorithm4.3.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm4.3.2" class="ltx_emph ltx_font_italic">each cluster <math id="algorithm4.2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm4.2.1.m1.1a"><mi id="algorithm4.2.1.m1.1.1" xref="algorithm4.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm4.2.1.m1.1b"><ci id="algorithm4.2.1.m1.1.1.cmml" xref="algorithm4.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.2.1.m1.1c">k</annotation></semantics></math> <math id="algorithm4.3.2.m2.1" class="ltx_Math" alttext="\in K" display="inline"><semantics id="algorithm4.3.2.m2.1a"><mrow id="algorithm4.3.2.m2.1.1" xref="algorithm4.3.2.m2.1.1.cmml"><mi id="algorithm4.3.2.m2.1.1.2" xref="algorithm4.3.2.m2.1.1.2.cmml"></mi><mo id="algorithm4.3.2.m2.1.1.1" xref="algorithm4.3.2.m2.1.1.1.cmml">∈</mo><mi id="algorithm4.3.2.m2.1.1.3" xref="algorithm4.3.2.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.3.2.m2.1b"><apply id="algorithm4.3.2.m2.1.1.cmml" xref="algorithm4.3.2.m2.1.1"><in id="algorithm4.3.2.m2.1.1.1.cmml" xref="algorithm4.3.2.m2.1.1.1"></in><csymbol cd="latexml" id="algorithm4.3.2.m2.1.1.2.cmml" xref="algorithm4.3.2.m2.1.1.2">absent</csymbol><ci id="algorithm4.3.2.m2.1.1.3.cmml" xref="algorithm4.3.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.3.2.m2.1c">\in K</annotation></semantics></math></em> <span id="algorithm4.3.4" class="ltx_text ltx_font_bold">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.34" class="ltx_block ltx_figure_panel">
<div id="algorithm4.6" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Initialize weights <math id="algorithm4.4.m1.1" class="ltx_Math" alttext="w_{pk}" display="inline"><semantics id="algorithm4.4.m1.1a"><msub id="algorithm4.4.m1.1.1" xref="algorithm4.4.m1.1.1.cmml"><mi id="algorithm4.4.m1.1.1.2" xref="algorithm4.4.m1.1.1.2.cmml">w</mi><mrow id="algorithm4.4.m1.1.1.3" xref="algorithm4.4.m1.1.1.3.cmml"><mi id="algorithm4.4.m1.1.1.3.2" xref="algorithm4.4.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.4.m1.1.1.3.1" xref="algorithm4.4.m1.1.1.3.1.cmml">​</mo><mi id="algorithm4.4.m1.1.1.3.3" xref="algorithm4.4.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm4.4.m1.1b"><apply id="algorithm4.4.m1.1.1.cmml" xref="algorithm4.4.m1.1.1"><csymbol cd="ambiguous" id="algorithm4.4.m1.1.1.1.cmml" xref="algorithm4.4.m1.1.1">subscript</csymbol><ci id="algorithm4.4.m1.1.1.2.cmml" xref="algorithm4.4.m1.1.1.2">𝑤</ci><apply id="algorithm4.4.m1.1.1.3.cmml" xref="algorithm4.4.m1.1.1.3"><times id="algorithm4.4.m1.1.1.3.1.cmml" xref="algorithm4.4.m1.1.1.3.1"></times><ci id="algorithm4.4.m1.1.1.3.2.cmml" xref="algorithm4.4.m1.1.1.3.2">𝑝</ci><ci id="algorithm4.4.m1.1.1.3.3.cmml" xref="algorithm4.4.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.4.m1.1c">w_{pk}</annotation></semantics></math> of prediction model, <math id="algorithm4.5.m2.1" class="ltx_Math" alttext="f_{pk}" display="inline"><semantics id="algorithm4.5.m2.1a"><msub id="algorithm4.5.m2.1.1" xref="algorithm4.5.m2.1.1.cmml"><mi id="algorithm4.5.m2.1.1.2" xref="algorithm4.5.m2.1.1.2.cmml">f</mi><mrow id="algorithm4.5.m2.1.1.3" xref="algorithm4.5.m2.1.1.3.cmml"><mi id="algorithm4.5.m2.1.1.3.2" xref="algorithm4.5.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.5.m2.1.1.3.1" xref="algorithm4.5.m2.1.1.3.1.cmml">​</mo><mi id="algorithm4.5.m2.1.1.3.3" xref="algorithm4.5.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm4.5.m2.1b"><apply id="algorithm4.5.m2.1.1.cmml" xref="algorithm4.5.m2.1.1"><csymbol cd="ambiguous" id="algorithm4.5.m2.1.1.1.cmml" xref="algorithm4.5.m2.1.1">subscript</csymbol><ci id="algorithm4.5.m2.1.1.2.cmml" xref="algorithm4.5.m2.1.1.2">𝑓</ci><apply id="algorithm4.5.m2.1.1.3.cmml" xref="algorithm4.5.m2.1.1.3"><times id="algorithm4.5.m2.1.1.3.1.cmml" xref="algorithm4.5.m2.1.1.3.1"></times><ci id="algorithm4.5.m2.1.1.3.2.cmml" xref="algorithm4.5.m2.1.1.3.2">𝑝</ci><ci id="algorithm4.5.m2.1.1.3.3.cmml" xref="algorithm4.5.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.5.m2.1c">f_{pk}</annotation></semantics></math> 
<span id="algorithm4.6.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm4.6.1" class="ltx_emph ltx_font_italic">each round <math id="algorithm4.6.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm4.6.1.m1.1a"><mi id="algorithm4.6.1.m1.1.1" xref="algorithm4.6.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm4.6.1.m1.1b"><ci id="algorithm4.6.1.m1.1.1.cmml" xref="algorithm4.6.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.6.1.m1.1c">i</annotation></semantics></math> in 1 to 20</em> <span id="algorithm4.6.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm4.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm4.8.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm4.8.2" class="ltx_emph ltx_font_italic">each site <math id="algorithm4.7.1.m1.1" class="ltx_Math" alttext="c\in" display="inline"><semantics id="algorithm4.7.1.m1.1a"><mrow id="algorithm4.7.1.m1.1.1" xref="algorithm4.7.1.m1.1.1.cmml"><mi id="algorithm4.7.1.m1.1.1.2" xref="algorithm4.7.1.m1.1.1.2.cmml">c</mi><mo id="algorithm4.7.1.m1.1.1.1" xref="algorithm4.7.1.m1.1.1.1.cmml">∈</mo><mi id="algorithm4.7.1.m1.1.1.3" xref="algorithm4.7.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.7.1.m1.1b"><apply id="algorithm4.7.1.m1.1.1.cmml" xref="algorithm4.7.1.m1.1.1"><in id="algorithm4.7.1.m1.1.1.1.cmml" xref="algorithm4.7.1.m1.1.1.1"></in><ci id="algorithm4.7.1.m1.1.1.2.cmml" xref="algorithm4.7.1.m1.1.1.2">𝑐</ci><csymbol cd="latexml" id="algorithm4.7.1.m1.1.1.3.cmml" xref="algorithm4.7.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.7.1.m1.1c">c\in</annotation></semantics></math> sites <math id="algorithm4.8.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm4.8.2.m2.1a"><mi id="algorithm4.8.2.m2.1.1" xref="algorithm4.8.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm4.8.2.m2.1b"><ci id="algorithm4.8.2.m2.1.1.cmml" xref="algorithm4.8.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.8.2.m2.1c">C</annotation></semantics></math></em> <span id="algorithm4.8.4" class="ltx_text ltx_font_bold">do</span> 
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.35" class="ltx_block ltx_figure_panel">
<div id="algorithm4.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Train <math id="algorithm4.9.m1.1" class="ltx_Math" alttext="f_{pk}" display="inline"><semantics id="algorithm4.9.m1.1a"><msub id="algorithm4.9.m1.1.1" xref="algorithm4.9.m1.1.1.cmml"><mi id="algorithm4.9.m1.1.1.2" xref="algorithm4.9.m1.1.1.2.cmml">f</mi><mrow id="algorithm4.9.m1.1.1.3" xref="algorithm4.9.m1.1.1.3.cmml"><mi id="algorithm4.9.m1.1.1.3.2" xref="algorithm4.9.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.9.m1.1.1.3.1" xref="algorithm4.9.m1.1.1.3.1.cmml">​</mo><mi id="algorithm4.9.m1.1.1.3.3" xref="algorithm4.9.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm4.9.m1.1b"><apply id="algorithm4.9.m1.1.1.cmml" xref="algorithm4.9.m1.1.1"><csymbol cd="ambiguous" id="algorithm4.9.m1.1.1.1.cmml" xref="algorithm4.9.m1.1.1">subscript</csymbol><ci id="algorithm4.9.m1.1.1.2.cmml" xref="algorithm4.9.m1.1.1.2">𝑓</ci><apply id="algorithm4.9.m1.1.1.3.cmml" xref="algorithm4.9.m1.1.1.3"><times id="algorithm4.9.m1.1.1.3.1.cmml" xref="algorithm4.9.m1.1.1.3.1"></times><ci id="algorithm4.9.m1.1.1.3.2.cmml" xref="algorithm4.9.m1.1.1.3.2">𝑝</ci><ci id="algorithm4.9.m1.1.1.3.3.cmml" xref="algorithm4.9.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.9.m1.1c">f_{pk}</annotation></semantics></math> for 20 epochs to obtain <math id="algorithm4.10.m2.2" class="ltx_Math" alttext="w^{c}_{i,pk}" display="inline"><semantics id="algorithm4.10.m2.2a"><msubsup id="algorithm4.10.m2.2.3" xref="algorithm4.10.m2.2.3.cmml"><mi id="algorithm4.10.m2.2.3.2.2" xref="algorithm4.10.m2.2.3.2.2.cmml">w</mi><mrow id="algorithm4.10.m2.2.2.2.2" xref="algorithm4.10.m2.2.2.2.3.cmml"><mi id="algorithm4.10.m2.1.1.1.1" xref="algorithm4.10.m2.1.1.1.1.cmml">i</mi><mo id="algorithm4.10.m2.2.2.2.2.2" xref="algorithm4.10.m2.2.2.2.3.cmml">,</mo><mrow id="algorithm4.10.m2.2.2.2.2.1" xref="algorithm4.10.m2.2.2.2.2.1.cmml"><mi id="algorithm4.10.m2.2.2.2.2.1.2" xref="algorithm4.10.m2.2.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.10.m2.2.2.2.2.1.1" xref="algorithm4.10.m2.2.2.2.2.1.1.cmml">​</mo><mi id="algorithm4.10.m2.2.2.2.2.1.3" xref="algorithm4.10.m2.2.2.2.2.1.3.cmml">k</mi></mrow></mrow><mi id="algorithm4.10.m2.2.3.2.3" xref="algorithm4.10.m2.2.3.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm4.10.m2.2b"><apply id="algorithm4.10.m2.2.3.cmml" xref="algorithm4.10.m2.2.3"><csymbol cd="ambiguous" id="algorithm4.10.m2.2.3.1.cmml" xref="algorithm4.10.m2.2.3">subscript</csymbol><apply id="algorithm4.10.m2.2.3.2.cmml" xref="algorithm4.10.m2.2.3"><csymbol cd="ambiguous" id="algorithm4.10.m2.2.3.2.1.cmml" xref="algorithm4.10.m2.2.3">superscript</csymbol><ci id="algorithm4.10.m2.2.3.2.2.cmml" xref="algorithm4.10.m2.2.3.2.2">𝑤</ci><ci id="algorithm4.10.m2.2.3.2.3.cmml" xref="algorithm4.10.m2.2.3.2.3">𝑐</ci></apply><list id="algorithm4.10.m2.2.2.2.3.cmml" xref="algorithm4.10.m2.2.2.2.2"><ci id="algorithm4.10.m2.1.1.1.1.cmml" xref="algorithm4.10.m2.1.1.1.1">𝑖</ci><apply id="algorithm4.10.m2.2.2.2.2.1.cmml" xref="algorithm4.10.m2.2.2.2.2.1"><times id="algorithm4.10.m2.2.2.2.2.1.1.cmml" xref="algorithm4.10.m2.2.2.2.2.1.1"></times><ci id="algorithm4.10.m2.2.2.2.2.1.2.cmml" xref="algorithm4.10.m2.2.2.2.2.1.2">𝑝</ci><ci id="algorithm4.10.m2.2.2.2.2.1.3.cmml" xref="algorithm4.10.m2.2.2.2.2.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.10.m2.2c">w^{c}_{i,pk}</annotation></semantics></math>
</div>
<div id="algorithm4.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="algorithm4.13.2" class="ltx_text ltx_font_typewriter">// </span><math id="algorithm4.11.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm4.11.m1.1a"><mi id="algorithm4.11.m1.1.1" xref="algorithm4.11.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm4.11.m1.1b"><ci id="algorithm4.11.m1.1.1.cmml" xref="algorithm4.11.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.11.m1.1c">c</annotation></semantics></math><span id="algorithm4.12.1" class="ltx_text ltx_font_typewriter"> is the site index and <math id="algorithm4.12.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm4.12.1.m1.1a"><mi id="algorithm4.12.1.m1.1.1" xref="algorithm4.12.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm4.12.1.m1.1b"><ci id="algorithm4.12.1.m1.1.1.cmml" xref="algorithm4.12.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.12.1.m1.1c">i</annotation></semantics></math> is the training round index</span>
<span id="algorithm4.13.3" class="ltx_text ltx_font_bold">return</span> <math id="algorithm4.13.m2.2" class="ltx_Math" alttext="w^{c}_{i,pk}" display="inline"><semantics id="algorithm4.13.m2.2a"><msubsup id="algorithm4.13.m2.2.3" xref="algorithm4.13.m2.2.3.cmml"><mi id="algorithm4.13.m2.2.3.2.2" xref="algorithm4.13.m2.2.3.2.2.cmml">w</mi><mrow id="algorithm4.13.m2.2.2.2.2" xref="algorithm4.13.m2.2.2.2.3.cmml"><mi id="algorithm4.13.m2.1.1.1.1" xref="algorithm4.13.m2.1.1.1.1.cmml">i</mi><mo id="algorithm4.13.m2.2.2.2.2.2" xref="algorithm4.13.m2.2.2.2.3.cmml">,</mo><mrow id="algorithm4.13.m2.2.2.2.2.1" xref="algorithm4.13.m2.2.2.2.2.1.cmml"><mi id="algorithm4.13.m2.2.2.2.2.1.2" xref="algorithm4.13.m2.2.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.13.m2.2.2.2.2.1.1" xref="algorithm4.13.m2.2.2.2.2.1.1.cmml">​</mo><mi id="algorithm4.13.m2.2.2.2.2.1.3" xref="algorithm4.13.m2.2.2.2.2.1.3.cmml">k</mi></mrow></mrow><mi id="algorithm4.13.m2.2.3.2.3" xref="algorithm4.13.m2.2.3.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm4.13.m2.2b"><apply id="algorithm4.13.m2.2.3.cmml" xref="algorithm4.13.m2.2.3"><csymbol cd="ambiguous" id="algorithm4.13.m2.2.3.1.cmml" xref="algorithm4.13.m2.2.3">subscript</csymbol><apply id="algorithm4.13.m2.2.3.2.cmml" xref="algorithm4.13.m2.2.3"><csymbol cd="ambiguous" id="algorithm4.13.m2.2.3.2.1.cmml" xref="algorithm4.13.m2.2.3">superscript</csymbol><ci id="algorithm4.13.m2.2.3.2.2.cmml" xref="algorithm4.13.m2.2.3.2.2">𝑤</ci><ci id="algorithm4.13.m2.2.3.2.3.cmml" xref="algorithm4.13.m2.2.3.2.3">𝑐</ci></apply><list id="algorithm4.13.m2.2.2.2.3.cmml" xref="algorithm4.13.m2.2.2.2.2"><ci id="algorithm4.13.m2.1.1.1.1.cmml" xref="algorithm4.13.m2.1.1.1.1">𝑖</ci><apply id="algorithm4.13.m2.2.2.2.2.1.cmml" xref="algorithm4.13.m2.2.2.2.2.1"><times id="algorithm4.13.m2.2.2.2.2.1.1.cmml" xref="algorithm4.13.m2.2.2.2.2.1.1"></times><ci id="algorithm4.13.m2.2.2.2.2.1.2.cmml" xref="algorithm4.13.m2.2.2.2.2.1.2">𝑝</ci><ci id="algorithm4.13.m2.2.2.2.2.1.3.cmml" xref="algorithm4.13.m2.2.2.2.2.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.13.m2.2c">w^{c}_{i,pk}</annotation></semantics></math> to server 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.36" class="ltx_block ltx_figure_panel">
<div id="algorithm4.36.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm4.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Server updates weights <math id="algorithm4.14.m1.2" class="ltx_Math" alttext="w_{i+1,pk}" display="inline"><semantics id="algorithm4.14.m1.2a"><msub id="algorithm4.14.m1.2.3" xref="algorithm4.14.m1.2.3.cmml"><mi id="algorithm4.14.m1.2.3.2" xref="algorithm4.14.m1.2.3.2.cmml">w</mi><mrow id="algorithm4.14.m1.2.2.2.2" xref="algorithm4.14.m1.2.2.2.3.cmml"><mrow id="algorithm4.14.m1.1.1.1.1.1" xref="algorithm4.14.m1.1.1.1.1.1.cmml"><mi id="algorithm4.14.m1.1.1.1.1.1.2" xref="algorithm4.14.m1.1.1.1.1.1.2.cmml">i</mi><mo id="algorithm4.14.m1.1.1.1.1.1.1" xref="algorithm4.14.m1.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm4.14.m1.1.1.1.1.1.3" xref="algorithm4.14.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm4.14.m1.2.2.2.2.3" xref="algorithm4.14.m1.2.2.2.3.cmml">,</mo><mrow id="algorithm4.14.m1.2.2.2.2.2" xref="algorithm4.14.m1.2.2.2.2.2.cmml"><mi id="algorithm4.14.m1.2.2.2.2.2.2" xref="algorithm4.14.m1.2.2.2.2.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.14.m1.2.2.2.2.2.1" xref="algorithm4.14.m1.2.2.2.2.2.1.cmml">​</mo><mi id="algorithm4.14.m1.2.2.2.2.2.3" xref="algorithm4.14.m1.2.2.2.2.2.3.cmml">k</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm4.14.m1.2b"><apply id="algorithm4.14.m1.2.3.cmml" xref="algorithm4.14.m1.2.3"><csymbol cd="ambiguous" id="algorithm4.14.m1.2.3.1.cmml" xref="algorithm4.14.m1.2.3">subscript</csymbol><ci id="algorithm4.14.m1.2.3.2.cmml" xref="algorithm4.14.m1.2.3.2">𝑤</ci><list id="algorithm4.14.m1.2.2.2.3.cmml" xref="algorithm4.14.m1.2.2.2.2"><apply id="algorithm4.14.m1.1.1.1.1.1.cmml" xref="algorithm4.14.m1.1.1.1.1.1"><plus id="algorithm4.14.m1.1.1.1.1.1.1.cmml" xref="algorithm4.14.m1.1.1.1.1.1.1"></plus><ci id="algorithm4.14.m1.1.1.1.1.1.2.cmml" xref="algorithm4.14.m1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="algorithm4.14.m1.1.1.1.1.1.3.cmml" xref="algorithm4.14.m1.1.1.1.1.1.3">1</cn></apply><apply id="algorithm4.14.m1.2.2.2.2.2.cmml" xref="algorithm4.14.m1.2.2.2.2.2"><times id="algorithm4.14.m1.2.2.2.2.2.1.cmml" xref="algorithm4.14.m1.2.2.2.2.2.1"></times><ci id="algorithm4.14.m1.2.2.2.2.2.2.cmml" xref="algorithm4.14.m1.2.2.2.2.2.2">𝑝</ci><ci id="algorithm4.14.m1.2.2.2.2.2.3.cmml" xref="algorithm4.14.m1.2.2.2.2.2.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.14.m1.2c">w_{i+1,pk}</annotation></semantics></math> <math id="algorithm4.15.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm4.15.m2.1a"><mo stretchy="false" id="algorithm4.15.m2.1.1" xref="algorithm4.15.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm4.15.m2.1b"><ci id="algorithm4.15.m2.1.1.cmml" xref="algorithm4.15.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.15.m2.1c">\leftarrow</annotation></semantics></math> <math id="algorithm4.16.m3.2" class="ltx_Math" alttext="\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}w^{c}_{i,pk}" display="inline"><semantics id="algorithm4.16.m3.2a"><mrow id="algorithm4.16.m3.2.3" xref="algorithm4.16.m3.2.3.cmml"><msubsup id="algorithm4.16.m3.2.3.1" xref="algorithm4.16.m3.2.3.1.cmml"><mo id="algorithm4.16.m3.2.3.1.2.2" xref="algorithm4.16.m3.2.3.1.2.2.cmml">∑</mo><mrow id="algorithm4.16.m3.2.3.1.3" xref="algorithm4.16.m3.2.3.1.3.cmml"><mi id="algorithm4.16.m3.2.3.1.3.2" xref="algorithm4.16.m3.2.3.1.3.2.cmml">c</mi><mo id="algorithm4.16.m3.2.3.1.3.1" xref="algorithm4.16.m3.2.3.1.3.1.cmml">=</mo><mn id="algorithm4.16.m3.2.3.1.3.3" xref="algorithm4.16.m3.2.3.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.16.m3.2.3.1.2.3" xref="algorithm4.16.m3.2.3.1.2.3.cmml">C</mi></msubsup><mrow id="algorithm4.16.m3.2.3.2" xref="algorithm4.16.m3.2.3.2.cmml"><msubsup id="algorithm4.16.m3.2.3.2.1" xref="algorithm4.16.m3.2.3.2.1.cmml"><mo lspace="0.167em" id="algorithm4.16.m3.2.3.2.1.2.2" xref="algorithm4.16.m3.2.3.2.1.2.2.cmml">∑</mo><mrow id="algorithm4.16.m3.2.3.2.1.3" xref="algorithm4.16.m3.2.3.2.1.3.cmml"><mi id="algorithm4.16.m3.2.3.2.1.3.2" xref="algorithm4.16.m3.2.3.2.1.3.2.cmml">k</mi><mo id="algorithm4.16.m3.2.3.2.1.3.1" xref="algorithm4.16.m3.2.3.2.1.3.1.cmml">=</mo><mn id="algorithm4.16.m3.2.3.2.1.3.3" xref="algorithm4.16.m3.2.3.2.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.16.m3.2.3.2.1.2.3" xref="algorithm4.16.m3.2.3.2.1.2.3.cmml">K</mi></msubsup><mrow id="algorithm4.16.m3.2.3.2.2" xref="algorithm4.16.m3.2.3.2.2.cmml"><mfrac id="algorithm4.16.m3.2.3.2.2.2" xref="algorithm4.16.m3.2.3.2.2.2.cmml"><msup id="algorithm4.16.m3.2.3.2.2.2.2" xref="algorithm4.16.m3.2.3.2.2.2.2.cmml"><mi id="algorithm4.16.m3.2.3.2.2.2.2.2" xref="algorithm4.16.m3.2.3.2.2.2.2.2.cmml">n</mi><mrow id="algorithm4.16.m3.2.3.2.2.2.2.3" xref="algorithm4.16.m3.2.3.2.2.2.2.3.cmml"><mi id="algorithm4.16.m3.2.3.2.2.2.2.3.2" xref="algorithm4.16.m3.2.3.2.2.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm4.16.m3.2.3.2.2.2.2.3.1" xref="algorithm4.16.m3.2.3.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm4.16.m3.2.3.2.2.2.2.3.3" xref="algorithm4.16.m3.2.3.2.2.2.2.3.3.cmml">k</mi></mrow></msup><msup id="algorithm4.16.m3.2.3.2.2.2.3" xref="algorithm4.16.m3.2.3.2.2.2.3.cmml"><mi id="algorithm4.16.m3.2.3.2.2.2.3.2" xref="algorithm4.16.m3.2.3.2.2.2.3.2.cmml">N</mi><mi id="algorithm4.16.m3.2.3.2.2.2.3.3" xref="algorithm4.16.m3.2.3.2.2.2.3.3.cmml">k</mi></msup></mfrac><mo lspace="0em" rspace="0em" id="algorithm4.16.m3.2.3.2.2.1" xref="algorithm4.16.m3.2.3.2.2.1.cmml">​</mo><msubsup id="algorithm4.16.m3.2.3.2.2.3" xref="algorithm4.16.m3.2.3.2.2.3.cmml"><mi id="algorithm4.16.m3.2.3.2.2.3.2.2" xref="algorithm4.16.m3.2.3.2.2.3.2.2.cmml">w</mi><mrow id="algorithm4.16.m3.2.2.2.2" xref="algorithm4.16.m3.2.2.2.3.cmml"><mi id="algorithm4.16.m3.1.1.1.1" xref="algorithm4.16.m3.1.1.1.1.cmml">i</mi><mo id="algorithm4.16.m3.2.2.2.2.2" xref="algorithm4.16.m3.2.2.2.3.cmml">,</mo><mrow id="algorithm4.16.m3.2.2.2.2.1" xref="algorithm4.16.m3.2.2.2.2.1.cmml"><mi id="algorithm4.16.m3.2.2.2.2.1.2" xref="algorithm4.16.m3.2.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="algorithm4.16.m3.2.2.2.2.1.1" xref="algorithm4.16.m3.2.2.2.2.1.1.cmml">​</mo><mi id="algorithm4.16.m3.2.2.2.2.1.3" xref="algorithm4.16.m3.2.2.2.2.1.3.cmml">k</mi></mrow></mrow><mi id="algorithm4.16.m3.2.3.2.2.3.2.3" xref="algorithm4.16.m3.2.3.2.2.3.2.3.cmml">c</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.16.m3.2b"><apply id="algorithm4.16.m3.2.3.cmml" xref="algorithm4.16.m3.2.3"><apply id="algorithm4.16.m3.2.3.1.cmml" xref="algorithm4.16.m3.2.3.1"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.1.1.cmml" xref="algorithm4.16.m3.2.3.1">subscript</csymbol><apply id="algorithm4.16.m3.2.3.1.2.cmml" xref="algorithm4.16.m3.2.3.1"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.1.2.1.cmml" xref="algorithm4.16.m3.2.3.1">superscript</csymbol><sum id="algorithm4.16.m3.2.3.1.2.2.cmml" xref="algorithm4.16.m3.2.3.1.2.2"></sum><ci id="algorithm4.16.m3.2.3.1.2.3.cmml" xref="algorithm4.16.m3.2.3.1.2.3">𝐶</ci></apply><apply id="algorithm4.16.m3.2.3.1.3.cmml" xref="algorithm4.16.m3.2.3.1.3"><eq id="algorithm4.16.m3.2.3.1.3.1.cmml" xref="algorithm4.16.m3.2.3.1.3.1"></eq><ci id="algorithm4.16.m3.2.3.1.3.2.cmml" xref="algorithm4.16.m3.2.3.1.3.2">𝑐</ci><cn type="integer" id="algorithm4.16.m3.2.3.1.3.3.cmml" xref="algorithm4.16.m3.2.3.1.3.3">1</cn></apply></apply><apply id="algorithm4.16.m3.2.3.2.cmml" xref="algorithm4.16.m3.2.3.2"><apply id="algorithm4.16.m3.2.3.2.1.cmml" xref="algorithm4.16.m3.2.3.2.1"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.1.1.cmml" xref="algorithm4.16.m3.2.3.2.1">subscript</csymbol><apply id="algorithm4.16.m3.2.3.2.1.2.cmml" xref="algorithm4.16.m3.2.3.2.1"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.1.2.1.cmml" xref="algorithm4.16.m3.2.3.2.1">superscript</csymbol><sum id="algorithm4.16.m3.2.3.2.1.2.2.cmml" xref="algorithm4.16.m3.2.3.2.1.2.2"></sum><ci id="algorithm4.16.m3.2.3.2.1.2.3.cmml" xref="algorithm4.16.m3.2.3.2.1.2.3">𝐾</ci></apply><apply id="algorithm4.16.m3.2.3.2.1.3.cmml" xref="algorithm4.16.m3.2.3.2.1.3"><eq id="algorithm4.16.m3.2.3.2.1.3.1.cmml" xref="algorithm4.16.m3.2.3.2.1.3.1"></eq><ci id="algorithm4.16.m3.2.3.2.1.3.2.cmml" xref="algorithm4.16.m3.2.3.2.1.3.2">𝑘</ci><cn type="integer" id="algorithm4.16.m3.2.3.2.1.3.3.cmml" xref="algorithm4.16.m3.2.3.2.1.3.3">1</cn></apply></apply><apply id="algorithm4.16.m3.2.3.2.2.cmml" xref="algorithm4.16.m3.2.3.2.2"><times id="algorithm4.16.m3.2.3.2.2.1.cmml" xref="algorithm4.16.m3.2.3.2.2.1"></times><apply id="algorithm4.16.m3.2.3.2.2.2.cmml" xref="algorithm4.16.m3.2.3.2.2.2"><divide id="algorithm4.16.m3.2.3.2.2.2.1.cmml" xref="algorithm4.16.m3.2.3.2.2.2"></divide><apply id="algorithm4.16.m3.2.3.2.2.2.2.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.2.2.2.1.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2">superscript</csymbol><ci id="algorithm4.16.m3.2.3.2.2.2.2.2.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2.2">𝑛</ci><apply id="algorithm4.16.m3.2.3.2.2.2.2.3.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2.3"><times id="algorithm4.16.m3.2.3.2.2.2.2.3.1.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2.3.1"></times><ci id="algorithm4.16.m3.2.3.2.2.2.2.3.2.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2.3.2">𝑐</ci><ci id="algorithm4.16.m3.2.3.2.2.2.2.3.3.cmml" xref="algorithm4.16.m3.2.3.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="algorithm4.16.m3.2.3.2.2.2.3.cmml" xref="algorithm4.16.m3.2.3.2.2.2.3"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.2.2.3.1.cmml" xref="algorithm4.16.m3.2.3.2.2.2.3">superscript</csymbol><ci id="algorithm4.16.m3.2.3.2.2.2.3.2.cmml" xref="algorithm4.16.m3.2.3.2.2.2.3.2">𝑁</ci><ci id="algorithm4.16.m3.2.3.2.2.2.3.3.cmml" xref="algorithm4.16.m3.2.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="algorithm4.16.m3.2.3.2.2.3.cmml" xref="algorithm4.16.m3.2.3.2.2.3"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.2.3.1.cmml" xref="algorithm4.16.m3.2.3.2.2.3">subscript</csymbol><apply id="algorithm4.16.m3.2.3.2.2.3.2.cmml" xref="algorithm4.16.m3.2.3.2.2.3"><csymbol cd="ambiguous" id="algorithm4.16.m3.2.3.2.2.3.2.1.cmml" xref="algorithm4.16.m3.2.3.2.2.3">superscript</csymbol><ci id="algorithm4.16.m3.2.3.2.2.3.2.2.cmml" xref="algorithm4.16.m3.2.3.2.2.3.2.2">𝑤</ci><ci id="algorithm4.16.m3.2.3.2.2.3.2.3.cmml" xref="algorithm4.16.m3.2.3.2.2.3.2.3">𝑐</ci></apply><list id="algorithm4.16.m3.2.2.2.3.cmml" xref="algorithm4.16.m3.2.2.2.2"><ci id="algorithm4.16.m3.1.1.1.1.cmml" xref="algorithm4.16.m3.1.1.1.1">𝑖</ci><apply id="algorithm4.16.m3.2.2.2.2.1.cmml" xref="algorithm4.16.m3.2.2.2.2.1"><times id="algorithm4.16.m3.2.2.2.2.1.1.cmml" xref="algorithm4.16.m3.2.2.2.2.1.1"></times><ci id="algorithm4.16.m3.2.2.2.2.1.2.cmml" xref="algorithm4.16.m3.2.2.2.2.1.2">𝑝</ci><ci id="algorithm4.16.m3.2.2.2.2.1.3.cmml" xref="algorithm4.16.m3.2.2.2.2.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.16.m3.2c">\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}w^{c}_{i,pk}</annotation></semantics></math>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.37" class="ltx_block ltx_figure_panel">
<div id="algorithm4.22" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="algorithm4.22.6" class="ltx_text ltx_font_typewriter">// </span><math id="algorithm4.17.m1.1" class="ltx_Math" alttext="n^{ck}" display="inline"><semantics id="algorithm4.17.m1.1a"><msup id="algorithm4.17.m1.1.1" xref="algorithm4.17.m1.1.1.cmml"><mi id="algorithm4.17.m1.1.1.2" xref="algorithm4.17.m1.1.1.2.cmml">n</mi><mrow id="algorithm4.17.m1.1.1.3" xref="algorithm4.17.m1.1.1.3.cmml"><mi id="algorithm4.17.m1.1.1.3.2" xref="algorithm4.17.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm4.17.m1.1.1.3.1" xref="algorithm4.17.m1.1.1.3.1.cmml">​</mo><mi id="algorithm4.17.m1.1.1.3.3" xref="algorithm4.17.m1.1.1.3.3.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm4.17.m1.1b"><apply id="algorithm4.17.m1.1.1.cmml" xref="algorithm4.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm4.17.m1.1.1.1.cmml" xref="algorithm4.17.m1.1.1">superscript</csymbol><ci id="algorithm4.17.m1.1.1.2.cmml" xref="algorithm4.17.m1.1.1.2">𝑛</ci><apply id="algorithm4.17.m1.1.1.3.cmml" xref="algorithm4.17.m1.1.1.3"><times id="algorithm4.17.m1.1.1.3.1.cmml" xref="algorithm4.17.m1.1.1.3.1"></times><ci id="algorithm4.17.m1.1.1.3.2.cmml" xref="algorithm4.17.m1.1.1.3.2">𝑐</ci><ci id="algorithm4.17.m1.1.1.3.3.cmml" xref="algorithm4.17.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.17.m1.1c">n^{ck}</annotation></semantics></math><span id="algorithm4.21.4" class="ltx_text ltx_font_typewriter"> is number of patients at site <math id="algorithm4.18.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm4.18.1.m1.1a"><mi id="algorithm4.18.1.m1.1.1" xref="algorithm4.18.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm4.18.1.m1.1b"><ci id="algorithm4.18.1.m1.1.1.cmml" xref="algorithm4.18.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.18.1.m1.1c">c</annotation></semantics></math> in cluster <math id="algorithm4.19.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm4.19.2.m2.1a"><mi id="algorithm4.19.2.m2.1.1" xref="algorithm4.19.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm4.19.2.m2.1b"><ci id="algorithm4.19.2.m2.1.1.cmml" xref="algorithm4.19.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.19.2.m2.1c">k</annotation></semantics></math>, <math id="algorithm4.20.3.m3.1" class="ltx_Math" alttext="N^{k}" display="inline"><semantics id="algorithm4.20.3.m3.1a"><msup id="algorithm4.20.3.m3.1.1" xref="algorithm4.20.3.m3.1.1.cmml"><mi id="algorithm4.20.3.m3.1.1.2" xref="algorithm4.20.3.m3.1.1.2.cmml">N</mi><mi id="algorithm4.20.3.m3.1.1.3" xref="algorithm4.20.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm4.20.3.m3.1b"><apply id="algorithm4.20.3.m3.1.1.cmml" xref="algorithm4.20.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm4.20.3.m3.1.1.1.cmml" xref="algorithm4.20.3.m3.1.1">superscript</csymbol><ci id="algorithm4.20.3.m3.1.1.2.cmml" xref="algorithm4.20.3.m3.1.1.2">𝑁</ci><ci id="algorithm4.20.3.m3.1.1.3.cmml" xref="algorithm4.20.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.20.3.m3.1c">N^{k}</annotation></semantics></math> is total number of patients in cluster <math id="algorithm4.21.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm4.21.4.m4.1a"><mi id="algorithm4.21.4.m4.1.1" xref="algorithm4.21.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm4.21.4.m4.1b"><ci id="algorithm4.21.4.m4.1.1.cmml" xref="algorithm4.21.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.21.4.m4.1c">k</annotation></semantics></math></span>
<span id="algorithm4.22.7" class="ltx_text ltx_font_bold">for</span> <em id="algorithm4.22.5" class="ltx_emph ltx_font_italic">each site <math id="algorithm4.22.5.m1.1" class="ltx_Math" alttext="c\in C" display="inline"><semantics id="algorithm4.22.5.m1.1a"><mrow id="algorithm4.22.5.m1.1.1" xref="algorithm4.22.5.m1.1.1.cmml"><mi id="algorithm4.22.5.m1.1.1.2" xref="algorithm4.22.5.m1.1.1.2.cmml">c</mi><mo id="algorithm4.22.5.m1.1.1.1" xref="algorithm4.22.5.m1.1.1.1.cmml">∈</mo><mi id="algorithm4.22.5.m1.1.1.3" xref="algorithm4.22.5.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.22.5.m1.1b"><apply id="algorithm4.22.5.m1.1.1.cmml" xref="algorithm4.22.5.m1.1.1"><in id="algorithm4.22.5.m1.1.1.1.cmml" xref="algorithm4.22.5.m1.1.1.1"></in><ci id="algorithm4.22.5.m1.1.1.2.cmml" xref="algorithm4.22.5.m1.1.1.2">𝑐</ci><ci id="algorithm4.22.5.m1.1.1.3.cmml" xref="algorithm4.22.5.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.22.5.m1.1c">c\in C</annotation></semantics></math></em> <span id="algorithm4.22.8" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm4.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Measure AUC<sub id="algorithm4.24.1" class="ltx_sub"><span id="algorithm4.24.1.1" class="ltx_text ltx_font_italic">c,k</span></sub> and AUPRC<sub id="algorithm4.24.2" class="ltx_sub"><span id="algorithm4.24.2.1" class="ltx_text ltx_font_italic">c,k</span></sub> in test set and send results 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.38" class="ltx_block ltx_figure_panel">
<div id="algorithm4.38.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm4.38.2" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.39" class="ltx_block ltx_figure_panel">
<div id="algorithm4.39.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm4.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Global AUC <math id="algorithm4.25.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm4.25.m1.1a"><mo stretchy="false" id="algorithm4.25.m1.1.1" xref="algorithm4.25.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm4.25.m1.1b"><ci id="algorithm4.25.m1.1.1.cmml" xref="algorithm4.25.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.25.m1.1c">\leftarrow</annotation></semantics></math> <math id="algorithm4.26.m2.1" class="ltx_Math" alttext="\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}" display="inline"><semantics id="algorithm4.26.m2.1a"><mrow id="algorithm4.26.m2.1.1" xref="algorithm4.26.m2.1.1.cmml"><msubsup id="algorithm4.26.m2.1.1.1" xref="algorithm4.26.m2.1.1.1.cmml"><mo id="algorithm4.26.m2.1.1.1.2.2" xref="algorithm4.26.m2.1.1.1.2.2.cmml">∑</mo><mrow id="algorithm4.26.m2.1.1.1.3" xref="algorithm4.26.m2.1.1.1.3.cmml"><mi id="algorithm4.26.m2.1.1.1.3.2" xref="algorithm4.26.m2.1.1.1.3.2.cmml">c</mi><mo id="algorithm4.26.m2.1.1.1.3.1" xref="algorithm4.26.m2.1.1.1.3.1.cmml">=</mo><mn id="algorithm4.26.m2.1.1.1.3.3" xref="algorithm4.26.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.26.m2.1.1.1.2.3" xref="algorithm4.26.m2.1.1.1.2.3.cmml">C</mi></msubsup><mrow id="algorithm4.26.m2.1.1.2" xref="algorithm4.26.m2.1.1.2.cmml"><msubsup id="algorithm4.26.m2.1.1.2.1" xref="algorithm4.26.m2.1.1.2.1.cmml"><mo lspace="0.167em" id="algorithm4.26.m2.1.1.2.1.2.2" xref="algorithm4.26.m2.1.1.2.1.2.2.cmml">∑</mo><mrow id="algorithm4.26.m2.1.1.2.1.3" xref="algorithm4.26.m2.1.1.2.1.3.cmml"><mi id="algorithm4.26.m2.1.1.2.1.3.2" xref="algorithm4.26.m2.1.1.2.1.3.2.cmml">k</mi><mo id="algorithm4.26.m2.1.1.2.1.3.1" xref="algorithm4.26.m2.1.1.2.1.3.1.cmml">=</mo><mn id="algorithm4.26.m2.1.1.2.1.3.3" xref="algorithm4.26.m2.1.1.2.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.26.m2.1.1.2.1.2.3" xref="algorithm4.26.m2.1.1.2.1.2.3.cmml">K</mi></msubsup><mfrac id="algorithm4.26.m2.1.1.2.2" xref="algorithm4.26.m2.1.1.2.2.cmml"><msup id="algorithm4.26.m2.1.1.2.2.2" xref="algorithm4.26.m2.1.1.2.2.2.cmml"><mi id="algorithm4.26.m2.1.1.2.2.2.2" xref="algorithm4.26.m2.1.1.2.2.2.2.cmml">n</mi><mrow id="algorithm4.26.m2.1.1.2.2.2.3" xref="algorithm4.26.m2.1.1.2.2.2.3.cmml"><mi id="algorithm4.26.m2.1.1.2.2.2.3.2" xref="algorithm4.26.m2.1.1.2.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm4.26.m2.1.1.2.2.2.3.1" xref="algorithm4.26.m2.1.1.2.2.2.3.1.cmml">​</mo><mi id="algorithm4.26.m2.1.1.2.2.2.3.3" xref="algorithm4.26.m2.1.1.2.2.2.3.3.cmml">k</mi></mrow></msup><msup id="algorithm4.26.m2.1.1.2.2.3" xref="algorithm4.26.m2.1.1.2.2.3.cmml"><mi id="algorithm4.26.m2.1.1.2.2.3.2" xref="algorithm4.26.m2.1.1.2.2.3.2.cmml">N</mi><mi id="algorithm4.26.m2.1.1.2.2.3.3" xref="algorithm4.26.m2.1.1.2.2.3.3.cmml">k</mi></msup></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.26.m2.1b"><apply id="algorithm4.26.m2.1.1.cmml" xref="algorithm4.26.m2.1.1"><apply id="algorithm4.26.m2.1.1.1.cmml" xref="algorithm4.26.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.1.1.cmml" xref="algorithm4.26.m2.1.1.1">subscript</csymbol><apply id="algorithm4.26.m2.1.1.1.2.cmml" xref="algorithm4.26.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.1.2.1.cmml" xref="algorithm4.26.m2.1.1.1">superscript</csymbol><sum id="algorithm4.26.m2.1.1.1.2.2.cmml" xref="algorithm4.26.m2.1.1.1.2.2"></sum><ci id="algorithm4.26.m2.1.1.1.2.3.cmml" xref="algorithm4.26.m2.1.1.1.2.3">𝐶</ci></apply><apply id="algorithm4.26.m2.1.1.1.3.cmml" xref="algorithm4.26.m2.1.1.1.3"><eq id="algorithm4.26.m2.1.1.1.3.1.cmml" xref="algorithm4.26.m2.1.1.1.3.1"></eq><ci id="algorithm4.26.m2.1.1.1.3.2.cmml" xref="algorithm4.26.m2.1.1.1.3.2">𝑐</ci><cn type="integer" id="algorithm4.26.m2.1.1.1.3.3.cmml" xref="algorithm4.26.m2.1.1.1.3.3">1</cn></apply></apply><apply id="algorithm4.26.m2.1.1.2.cmml" xref="algorithm4.26.m2.1.1.2"><apply id="algorithm4.26.m2.1.1.2.1.cmml" xref="algorithm4.26.m2.1.1.2.1"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.2.1.1.cmml" xref="algorithm4.26.m2.1.1.2.1">subscript</csymbol><apply id="algorithm4.26.m2.1.1.2.1.2.cmml" xref="algorithm4.26.m2.1.1.2.1"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.2.1.2.1.cmml" xref="algorithm4.26.m2.1.1.2.1">superscript</csymbol><sum id="algorithm4.26.m2.1.1.2.1.2.2.cmml" xref="algorithm4.26.m2.1.1.2.1.2.2"></sum><ci id="algorithm4.26.m2.1.1.2.1.2.3.cmml" xref="algorithm4.26.m2.1.1.2.1.2.3">𝐾</ci></apply><apply id="algorithm4.26.m2.1.1.2.1.3.cmml" xref="algorithm4.26.m2.1.1.2.1.3"><eq id="algorithm4.26.m2.1.1.2.1.3.1.cmml" xref="algorithm4.26.m2.1.1.2.1.3.1"></eq><ci id="algorithm4.26.m2.1.1.2.1.3.2.cmml" xref="algorithm4.26.m2.1.1.2.1.3.2">𝑘</ci><cn type="integer" id="algorithm4.26.m2.1.1.2.1.3.3.cmml" xref="algorithm4.26.m2.1.1.2.1.3.3">1</cn></apply></apply><apply id="algorithm4.26.m2.1.1.2.2.cmml" xref="algorithm4.26.m2.1.1.2.2"><divide id="algorithm4.26.m2.1.1.2.2.1.cmml" xref="algorithm4.26.m2.1.1.2.2"></divide><apply id="algorithm4.26.m2.1.1.2.2.2.cmml" xref="algorithm4.26.m2.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.2.2.2.1.cmml" xref="algorithm4.26.m2.1.1.2.2.2">superscript</csymbol><ci id="algorithm4.26.m2.1.1.2.2.2.2.cmml" xref="algorithm4.26.m2.1.1.2.2.2.2">𝑛</ci><apply id="algorithm4.26.m2.1.1.2.2.2.3.cmml" xref="algorithm4.26.m2.1.1.2.2.2.3"><times id="algorithm4.26.m2.1.1.2.2.2.3.1.cmml" xref="algorithm4.26.m2.1.1.2.2.2.3.1"></times><ci id="algorithm4.26.m2.1.1.2.2.2.3.2.cmml" xref="algorithm4.26.m2.1.1.2.2.2.3.2">𝑐</ci><ci id="algorithm4.26.m2.1.1.2.2.2.3.3.cmml" xref="algorithm4.26.m2.1.1.2.2.2.3.3">𝑘</ci></apply></apply><apply id="algorithm4.26.m2.1.1.2.2.3.cmml" xref="algorithm4.26.m2.1.1.2.2.3"><csymbol cd="ambiguous" id="algorithm4.26.m2.1.1.2.2.3.1.cmml" xref="algorithm4.26.m2.1.1.2.2.3">superscript</csymbol><ci id="algorithm4.26.m2.1.1.2.2.3.2.cmml" xref="algorithm4.26.m2.1.1.2.2.3.2">𝑁</ci><ci id="algorithm4.26.m2.1.1.2.2.3.3.cmml" xref="algorithm4.26.m2.1.1.2.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.26.m2.1c">\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}</annotation></semantics></math> AUC<sub id="algorithm4.30.1" class="ltx_sub"><span id="algorithm4.30.1.1" class="ltx_text ltx_font_italic">c,k</span></sub> 
Global AUPRC <math id="algorithm4.28.m4.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm4.28.m4.1a"><mo stretchy="false" id="algorithm4.28.m4.1.1" xref="algorithm4.28.m4.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm4.28.m4.1b"><ci id="algorithm4.28.m4.1.1.cmml" xref="algorithm4.28.m4.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.28.m4.1c">\leftarrow</annotation></semantics></math> <math id="algorithm4.29.m5.1" class="ltx_Math" alttext="\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}" display="inline"><semantics id="algorithm4.29.m5.1a"><mrow id="algorithm4.29.m5.1.1" xref="algorithm4.29.m5.1.1.cmml"><msubsup id="algorithm4.29.m5.1.1.1" xref="algorithm4.29.m5.1.1.1.cmml"><mo id="algorithm4.29.m5.1.1.1.2.2" xref="algorithm4.29.m5.1.1.1.2.2.cmml">∑</mo><mrow id="algorithm4.29.m5.1.1.1.3" xref="algorithm4.29.m5.1.1.1.3.cmml"><mi id="algorithm4.29.m5.1.1.1.3.2" xref="algorithm4.29.m5.1.1.1.3.2.cmml">c</mi><mo id="algorithm4.29.m5.1.1.1.3.1" xref="algorithm4.29.m5.1.1.1.3.1.cmml">=</mo><mn id="algorithm4.29.m5.1.1.1.3.3" xref="algorithm4.29.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.29.m5.1.1.1.2.3" xref="algorithm4.29.m5.1.1.1.2.3.cmml">C</mi></msubsup><mrow id="algorithm4.29.m5.1.1.2" xref="algorithm4.29.m5.1.1.2.cmml"><msubsup id="algorithm4.29.m5.1.1.2.1" xref="algorithm4.29.m5.1.1.2.1.cmml"><mo lspace="0.167em" id="algorithm4.29.m5.1.1.2.1.2.2" xref="algorithm4.29.m5.1.1.2.1.2.2.cmml">∑</mo><mrow id="algorithm4.29.m5.1.1.2.1.3" xref="algorithm4.29.m5.1.1.2.1.3.cmml"><mi id="algorithm4.29.m5.1.1.2.1.3.2" xref="algorithm4.29.m5.1.1.2.1.3.2.cmml">k</mi><mo id="algorithm4.29.m5.1.1.2.1.3.1" xref="algorithm4.29.m5.1.1.2.1.3.1.cmml">=</mo><mn id="algorithm4.29.m5.1.1.2.1.3.3" xref="algorithm4.29.m5.1.1.2.1.3.3.cmml">1</mn></mrow><mi id="algorithm4.29.m5.1.1.2.1.2.3" xref="algorithm4.29.m5.1.1.2.1.2.3.cmml">K</mi></msubsup><mfrac id="algorithm4.29.m5.1.1.2.2" xref="algorithm4.29.m5.1.1.2.2.cmml"><msup id="algorithm4.29.m5.1.1.2.2.2" xref="algorithm4.29.m5.1.1.2.2.2.cmml"><mi id="algorithm4.29.m5.1.1.2.2.2.2" xref="algorithm4.29.m5.1.1.2.2.2.2.cmml">n</mi><mrow id="algorithm4.29.m5.1.1.2.2.2.3" xref="algorithm4.29.m5.1.1.2.2.2.3.cmml"><mi id="algorithm4.29.m5.1.1.2.2.2.3.2" xref="algorithm4.29.m5.1.1.2.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm4.29.m5.1.1.2.2.2.3.1" xref="algorithm4.29.m5.1.1.2.2.2.3.1.cmml">​</mo><mi id="algorithm4.29.m5.1.1.2.2.2.3.3" xref="algorithm4.29.m5.1.1.2.2.2.3.3.cmml">k</mi></mrow></msup><msup id="algorithm4.29.m5.1.1.2.2.3" xref="algorithm4.29.m5.1.1.2.2.3.cmml"><mi id="algorithm4.29.m5.1.1.2.2.3.2" xref="algorithm4.29.m5.1.1.2.2.3.2.cmml">N</mi><mi id="algorithm4.29.m5.1.1.2.2.3.3" xref="algorithm4.29.m5.1.1.2.2.3.3.cmml">k</mi></msup></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm4.29.m5.1b"><apply id="algorithm4.29.m5.1.1.cmml" xref="algorithm4.29.m5.1.1"><apply id="algorithm4.29.m5.1.1.1.cmml" xref="algorithm4.29.m5.1.1.1"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.1.1.cmml" xref="algorithm4.29.m5.1.1.1">subscript</csymbol><apply id="algorithm4.29.m5.1.1.1.2.cmml" xref="algorithm4.29.m5.1.1.1"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.1.2.1.cmml" xref="algorithm4.29.m5.1.1.1">superscript</csymbol><sum id="algorithm4.29.m5.1.1.1.2.2.cmml" xref="algorithm4.29.m5.1.1.1.2.2"></sum><ci id="algorithm4.29.m5.1.1.1.2.3.cmml" xref="algorithm4.29.m5.1.1.1.2.3">𝐶</ci></apply><apply id="algorithm4.29.m5.1.1.1.3.cmml" xref="algorithm4.29.m5.1.1.1.3"><eq id="algorithm4.29.m5.1.1.1.3.1.cmml" xref="algorithm4.29.m5.1.1.1.3.1"></eq><ci id="algorithm4.29.m5.1.1.1.3.2.cmml" xref="algorithm4.29.m5.1.1.1.3.2">𝑐</ci><cn type="integer" id="algorithm4.29.m5.1.1.1.3.3.cmml" xref="algorithm4.29.m5.1.1.1.3.3">1</cn></apply></apply><apply id="algorithm4.29.m5.1.1.2.cmml" xref="algorithm4.29.m5.1.1.2"><apply id="algorithm4.29.m5.1.1.2.1.cmml" xref="algorithm4.29.m5.1.1.2.1"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.2.1.1.cmml" xref="algorithm4.29.m5.1.1.2.1">subscript</csymbol><apply id="algorithm4.29.m5.1.1.2.1.2.cmml" xref="algorithm4.29.m5.1.1.2.1"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.2.1.2.1.cmml" xref="algorithm4.29.m5.1.1.2.1">superscript</csymbol><sum id="algorithm4.29.m5.1.1.2.1.2.2.cmml" xref="algorithm4.29.m5.1.1.2.1.2.2"></sum><ci id="algorithm4.29.m5.1.1.2.1.2.3.cmml" xref="algorithm4.29.m5.1.1.2.1.2.3">𝐾</ci></apply><apply id="algorithm4.29.m5.1.1.2.1.3.cmml" xref="algorithm4.29.m5.1.1.2.1.3"><eq id="algorithm4.29.m5.1.1.2.1.3.1.cmml" xref="algorithm4.29.m5.1.1.2.1.3.1"></eq><ci id="algorithm4.29.m5.1.1.2.1.3.2.cmml" xref="algorithm4.29.m5.1.1.2.1.3.2">𝑘</ci><cn type="integer" id="algorithm4.29.m5.1.1.2.1.3.3.cmml" xref="algorithm4.29.m5.1.1.2.1.3.3">1</cn></apply></apply><apply id="algorithm4.29.m5.1.1.2.2.cmml" xref="algorithm4.29.m5.1.1.2.2"><divide id="algorithm4.29.m5.1.1.2.2.1.cmml" xref="algorithm4.29.m5.1.1.2.2"></divide><apply id="algorithm4.29.m5.1.1.2.2.2.cmml" xref="algorithm4.29.m5.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.2.2.2.1.cmml" xref="algorithm4.29.m5.1.1.2.2.2">superscript</csymbol><ci id="algorithm4.29.m5.1.1.2.2.2.2.cmml" xref="algorithm4.29.m5.1.1.2.2.2.2">𝑛</ci><apply id="algorithm4.29.m5.1.1.2.2.2.3.cmml" xref="algorithm4.29.m5.1.1.2.2.2.3"><times id="algorithm4.29.m5.1.1.2.2.2.3.1.cmml" xref="algorithm4.29.m5.1.1.2.2.2.3.1"></times><ci id="algorithm4.29.m5.1.1.2.2.2.3.2.cmml" xref="algorithm4.29.m5.1.1.2.2.2.3.2">𝑐</ci><ci id="algorithm4.29.m5.1.1.2.2.2.3.3.cmml" xref="algorithm4.29.m5.1.1.2.2.2.3.3">𝑘</ci></apply></apply><apply id="algorithm4.29.m5.1.1.2.2.3.cmml" xref="algorithm4.29.m5.1.1.2.2.3"><csymbol cd="ambiguous" id="algorithm4.29.m5.1.1.2.2.3.1.cmml" xref="algorithm4.29.m5.1.1.2.2.3">superscript</csymbol><ci id="algorithm4.29.m5.1.1.2.2.3.2.cmml" xref="algorithm4.29.m5.1.1.2.2.3.2">𝑁</ci><ci id="algorithm4.29.m5.1.1.2.2.3.3.cmml" xref="algorithm4.29.m5.1.1.2.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm4.29.m5.1c">\sum^{C}_{c=1}\sum^{K}_{k=1}\frac{n^{ck}}{N^{k}}</annotation></semantics></math> AUPRC<sub id="algorithm4.30.2" class="ltx_sub"><span id="algorithm4.30.2.1" class="ltx_text ltx_font_italic">c,k</span></sub> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="algorithm4.40" class="ltx_block ltx_figure_panel">
<div id="algorithm4.40.1" class="ltx_listingline"> end for
</div>
<div id="algorithm4.40.2" class="ltx_listingline">
<span id="algorithm4.40.2.1" class="ltx_text ltx_font_bold">return</span> Global AUC, Global AUPRC 

</div>
</div>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Feature distributions by cluster</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p"><a target="_blank" href="https://github.com/G2Lab/pcfbl/blob/main/suppl_tables/supp_tables_2_7.pdf" title="" class="ltx_ref ltx_href">Supplementary tables 2-7 can be found here.</a></p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2307.08846" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2307.08847" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2307.08847">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2307.08847" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2307.08849" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 17:37:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
