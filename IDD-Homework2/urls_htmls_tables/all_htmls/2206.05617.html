<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2206.05617] Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology</title><meta property="og:description" content="Early prostate cancer detection and staging from MRI are extremely challenging tasks for both radiologists and deep learning algorithms, but the potential to learn from large and diverse datasets remains a promising av…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2206.05617">

<!--Generated on Mon Mar 11 17:10:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Abhejit Rajagopal
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Ekaterina Redekop
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Anil Kemisetti
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Rushi Kulkarni
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Steven Raman
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Kirti Magudia
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Corey W. Arnold (IEEE Member)
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Peder E. Z. Larson (IEEE Member)
</span><span class="ltx_author_notes">A. Rajagopal, A. Kemisetti, and P.E.Z. Larson are with the Department
of Radiology and Biomedical Imaging, University of California, San Francisco, 94158 USA. E. Redekop, R. Kulkarni, S. Raman, and C. Arnold are with the Department of Radiology, Univeristy of California, Los Angeles, 90024 USA. K. Magudia is with the Department of Radiology, Duke University, Durham, Durham 27705 USA. Correspondence e-mail: abhejit.rajagopal@ucsf.edu.
Funding support of NIH/NIBIB (#F32EB030411), NIH/NCI (#R01CA229354 and #R21CA220352).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Early prostate cancer detection and staging from MRI are extremely challenging tasks for both radiologists and deep learning algorithms, but the potential to learn from large and diverse datasets remains a promising avenue to increase their generalization capability both within- and across clinics. To enable this for prototype-stage algorithms, where the majority of existing research remains, in this paper we introduce a flexible federated learning framework for cross-site training, validation, and evaluation of deep prostate cancer detection algorithms. Our approach utilizes an abstracted representation of the model architecture and data, which allows unpolished prototype deep learning models to be trained without modification using the NVFlare federated learning framework. Our results show increases in prostate cancer detection and classification accuracy using a specialized neural network model and diverse prostate biopsy data collected at two University of California research hospitals, demonstrating the efficacy of our approach in adapting to different datasets and improving MR-biomarker discovery. We open-source our <span id="id1.id1.1" class="ltx_text ltx_font_typewriter">FLtools</span> system, which can be easily adapted to other deep learning projects for medical imaging.</p>
</div>
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">{IEEEkeywords}</span>
<p id="p1.2" class="ltx_p">multi-parametric MRI, prostate cancer, deep learning, weak spatial supervision, federated learning

<span id="p1.2.1" class="ltx_ERROR undefined">\IEEEpeerreviewmaketitle</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<span id="S1.p1.1" class="ltx_ERROR undefined">\IEEEPARstart</span>
<p id="S1.p1.2" class="ltx_p">Prostate cancer is the most prevalent cancer in American men but data shows that it affords a 99% survival rate if the cancer is detected early <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Compared with the low sensitivity of PSA blood tests and the potential complications of invasive biopsy, screening based on magnetic resonance imaging (MRI) offers the potential of a fast, safe (non-invasive), and localized detection of prostate cancer that can aid in both diagnosis and treatment planning  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Unfortunately, the current PIRADSv2 radiological standard for reading MRI has been shown to correlate poorly with the Gleason grade (cancer severity) determined by biopsy and histopathological analysis, with a positive predictive value of just 35% <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. As such, there is great interest in developing data-driven machine learning algorithms to assist and improve radiologists’ capabilities in detecting and staging of clinically-significant prostate cancer (CS-PCa).</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, to-date accurate and early MRI-based detection of prostate cancer has eluded even deep learning algorithms, with most results in the literature either focused on staging of severe disease (Gleason patterns <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="\geq 3+3" display="inline"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml"></mi><mo id="S1.p2.1.m1.1.1.1" xref="S1.p2.1.m1.1.1.1.cmml">≥</mo><mrow id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml"><mn id="S1.p2.1.m1.1.1.3.2" xref="S1.p2.1.m1.1.1.3.2.cmml">3</mn><mo id="S1.p2.1.m1.1.1.3.1" xref="S1.p2.1.m1.1.1.3.1.cmml">+</mo><mn id="S1.p2.1.m1.1.1.3.3" xref="S1.p2.1.m1.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><geq id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1.1"></geq><csymbol cd="latexml" id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">absent</csymbol><apply id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3"><plus id="S1.p2.1.m1.1.1.3.1.cmml" xref="S1.p2.1.m1.1.1.3.1"></plus><cn type="integer" id="S1.p2.1.m1.1.1.3.2.cmml" xref="S1.p2.1.m1.1.1.3.2">3</cn><cn type="integer" id="S1.p2.1.m1.1.1.3.3.cmml" xref="S1.p2.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\geq 3+3</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
or achieving similar accuracy to PIRADS using more-balanced screening populations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
A persistent issue in these works is validating and improving the generalization behavior (i.e. accuracy) of models, both within institutions and across institutions, where MRI protocols, granularity of biopsy data, MRI hardware, and patient populations can vary significantly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
This is especially important for screening populations where prostate cancer is typically less salient in MRI, and single-site training may suffer from inadvertent bias or brittleness that ultimately limits performance even on data collected at the same institution.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2206.05617/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="310" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Federated learning of research prototype algorithms enables cross-site validation that is useful for improving within-site performance.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated learning (FL) is a presents an opportunity here to overcome these barriers, by offering a platform to share models and abundant data for extensive cross-site validation and enhanced model training (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) without the need to share images or other sensitive protected health information (PHI). However, existing FL implementations have many requirements, such as the use of only-standard neural network architectures, freezing of model evaluation code and data pipelines, or restrictions on the format of the data, which creates barriers for inclusion of research sites and specialized approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. This is especially prohibitive for medical imaging problems where patient examination protocols differ by research site, deep learning is still exploratory, and the community has not agreed on an ideal model architecture or data format, as is the case for the assessment of prostate cancer with MRI.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To this end, we introduce a framework for model- and data-agnostic federated learning of research prototype algorithms that enables cross-site validation and joint-training of deep neural networks (DNNs) with <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">zero</span> modifications to existing site-specific model architecture code or local training routines. We achieve this vision by defining data and model abstractions (currently implemented for <span id="S1.p4.1.2" class="ltx_text ltx_font_typewriter">pytorch</span>) that are used jointly by local- and federated-training routines, but can crucially differ across research sites. Our open-source toolkit, <span id="S1.p4.1.3" class="ltx_text ltx_font_typewriter">FLtools</span>, is built on top of the NVidia <span id="S1.p4.1.4" class="ltx_text ltx_font_typewriter">NVFlare</span> framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and also includes a simulation system (<span id="S1.p4.1.5" class="ltx_text ltx_font_typewriter">FLsim</span>) that allows for model debuging and inspection of intermediate tensors while applying the same routines used in the full-scale FL system.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We demonstrate the efficacy of this system on the cross-institution training of a custom deep learning model for multi-parametric MRI-based detection and classification of prostate cancer. For this we use our proposed ”UCNet”, which utilizes a fully-convolutional backbone, but features a 3D region-of-interest (ROI) classification head that enables per-lesion, per-sextant, and ultimately per-exam prediction of prostate cancer severity. The UCNet model achieves this by utilizing a histogram representation of the International Society of Urological Patholog (ISUP) grade group that reflects a common data representation for prostate cancer histopathology across research sites, which may themselves include exams and groundtruth pathology data at various granularities.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Other medical imaging applications that would directly benefit from this approach include classification of less common cancers, e.g. in the brain or in the kidneys, where the ability to utilize data from multiple sites and all sources of histology groundtruth jointly can significantly increase dataset sizes and the potentially boost overall detection accuracy. The presented FL design pattern is especially useful for data-starved deep learning problems that are challenging enough to necessitate the use of non-standard architectures or loss functions, where its desirable to expand dataset size and diversity while retaining model, dataloader, and learning algorithm mutability.</p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Prior Work</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p">Prior work in federated learning includes both problems of theoretical interest (learning strategies under various constraints, such as communication bottlenecks, non-iid data, or privacy concerns) and of practical value; with the latter focusing on the development of tools and frameworks to alleviate various user constraints. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> provides an excellent overview of various available frameworks and research problems. One of the primary practical challenges an FL system faces is making the workflow as straightforward as possible, ideally approaching the ease-of-use achieved by ML systems for local (single computer) training. In this paper we address this by developing a library and design pattern that specifically extends NVidia’s NVFlare toolkit for federated training.</p>
</div>
<div id="S1.SS1.p2" class="ltx_para">
<p id="S1.SS1.p2.1" class="ltx_p">Specifically for prostate cancer detection from MRI, several works have utilized federated learning. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> multi-center federated training improves prostate gland segmentation, an important sub-step in the search for prostate cancer biomarkers. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed a variation-aware federated learning framework where where the variations among clients are minimized by transforming the images (ADC maps) of all clients onto a common image space. Both these works, however, utilize homogeneous annotation <span id="S1.SS1.p2.1.1" class="ltx_text ltx_font_italic">datatypes</span>, which is an important variation both within and across institutions.
Our work addresses this with a model architecture that leverages highly heterogeneous radiological annotation and histopathology. We realize this vision with multi-center federated learning (FL).</p>
</div>
</section>
<section id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2 </span>Contributions</h3>

<div id="S1.SS2.p1" class="ltx_para">
<p id="S1.SS2.p1.1" class="ltx_p">Thus our contributions are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce a model and data abstraction for prostate MRI cancer detection and classification algorithms that supports intra- and inter-site exam heterogeneity.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce a modular design pattern for federated learning (FL) that uses these abstractions to enable synchronous cross-site training with <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">zero</span> modifications to existing research code and minimal engineering overhead.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We demonstrate the utility of this approach by training a custom deep learning model (UCNet) that is well-suited to the format and uncertainties associated with prostate MRI and associated histopathology, using data from two University of California hospitals (1800+ exams total).</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We open-source our code: <a target="_blank" href="https://gitlab.com/abhe/prostate-mpmri/-/tree/FL" title="" class="ltx_ref ltx_href">gitlab.com/abhe/prostate-FL</a></p>
</div>
</li>
</ul>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2206.05617/assets/figures/fig2_variation.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="153" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Intra- and inter-site variations of multiparametric MRI data. (A,B) Natural variation between appearance of ISUP grade group 2 lesions (countoured) in UCLA data. (C,D) Large variation in the apparent MR contrast and size of lesion annotations (bounding boxes) in UCSF data.</figcaption>
</figure>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Dataset and Assumptions</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multi-parametric Magnetic Resonance Imagery</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Multi-parametric magnetic resonance imagery (mp-MRI) prostate exams are composed of T2-weighted imaging, diffusion-weighted imaging (DWI), and dynamic contrast-enhanced (DCE) MRI. T2-weighted MRI provides structural information based on water content and tissue composition, DWI and associated apparent diffusion coefficient (ADC) maps represent the restriction of water movement in tissue that is typically altered due to the increased density of prostate tumors compared to healthy tissue, and DCE provides measurements of vasculature that is altered by tumors. Thus, mp-MRI provides a rich combination of information, but may vary in appearance due to subtle differences in choice of MR pulse sequence, scanner hardware, and physiologic variability in healthy prostate and tumors (Fig. <a href="#S1.F2" title="Figure 2 ‣ 1.2 Contributions ‣ 1 Introduction ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). In this paper, the T2-weighted and DWI as well as the associated ADC maps from mp-MRI series were reconstructed and subsequently registered (downsampled) to the same spatial resolution of [0.66, 0.66, 2.24] mm for x, y, and z axis respectively for all series in datasets from both research sites.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Histopathology Derived from Prostate Biopsy</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Prostate MRIs are typically conducted after an indication of a high prostate-specific antigen (PSA) blood concentration, or age. At both research sites, a board-certified radiologist annotated the mp-MRI series with possible lesions, suggesting areas for prostate biopsy. At UCSF, the prostate biopsy is conducted by transrectal-ultrasound (TRUS) MR-guided biopsy, where a T2 series is fused with the ultrasound to help navigate the needle and target the MR-annotated regions. In addition to targeted biopsy, at UCSF urologists systematically sample the prostate in 6 regions, providing additional confidence to the gland-wise cancer designation. Unfortunately, as the prostate is highly non-rigid, only coarse coordinates are associated with each biopsy core sample. That is, for UCSF data we assume the location of the systematic biopsies based on a geometric division of the prostate into sextants in the registered MR-image space, and we assume the targeted biopsy occurs in a bounding prism around each MR-identified lesion. The groundtruth histopathology for each biopsy sample was determined by a pathologist who observed stained slices of the biopsy core under a microscope and assigned a Gleason pattern to each. We convert this Gleason pattern to the standardized ISUP grade group (1-5, 0 for negative), where a grade group <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\geq 2" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">≥</mo><mn id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><geq id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></geq><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\geq 2</annotation></semantics></math> indicates clinically significant prostate cancer (CS-PCa).</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">At UCLA, a similar targeted TRUS prostate biopsy is conducted, but with additional innovation to identify the location of needle in the joint ultrasound-MRI image space, and enhanced radiologist-defined contouring of each lesion. The histopathology for each biopsy core is determined in a similar fashion as UCSF, resulting in a set of ISUP grade group scores. In this paper however, for data from the UCLA site we assume the highest ISUP grade group in each exam is known, but not to which lesion they correspond. For the UCLA site, we also do not include any systematic biopsy data. This mismatch in available data provides additional consideration for the design and supervision of our chosen deep architecture and supervision system, as will become apparent in Section <a href="#S4" title="4 UCNet for Mixed Histopathology Supervision ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Gland Segmentation and Contrast Normalization</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">As T2 and DWI have arbitrary non-quantitative image amplitudes, we apply interquartile range (IQR)-based intra-image normalization to address the relative nature of MR image intensity values both within and across research sites and to eliminate outlying values created by imaging artifacts. Specifically, each image was normalized to the image-level IQR computed within the 3D prostate gland (annotated by a radiologist or previously developed neural network segmentation model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>) according to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>:</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.6" class="ltx_Math" alttext="\displaystyle I_{norm}=\frac{I-\text{percentile}(I,1)}{\text{percentile}(I,99)-\text{percentile}(I,1)}" display="inline"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.7" xref="S2.E1.m1.6.7.cmml"><msub id="S2.E1.m1.6.7.2" xref="S2.E1.m1.6.7.2.cmml"><mi id="S2.E1.m1.6.7.2.2" xref="S2.E1.m1.6.7.2.2.cmml">I</mi><mrow id="S2.E1.m1.6.7.2.3" xref="S2.E1.m1.6.7.2.3.cmml"><mi id="S2.E1.m1.6.7.2.3.2" xref="S2.E1.m1.6.7.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.7.2.3.1" xref="S2.E1.m1.6.7.2.3.1.cmml">​</mo><mi id="S2.E1.m1.6.7.2.3.3" xref="S2.E1.m1.6.7.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.7.2.3.1a" xref="S2.E1.m1.6.7.2.3.1.cmml">​</mo><mi id="S2.E1.m1.6.7.2.3.4" xref="S2.E1.m1.6.7.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.7.2.3.1b" xref="S2.E1.m1.6.7.2.3.1.cmml">​</mo><mi id="S2.E1.m1.6.7.2.3.5" xref="S2.E1.m1.6.7.2.3.5.cmml">m</mi></mrow></msub><mo id="S2.E1.m1.6.7.1" xref="S2.E1.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml"><mfrac id="S2.E1.m1.6.6a" xref="S2.E1.m1.6.6.cmml"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml">I</mi><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">−</mo><mrow id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml"><mtext id="S2.E1.m1.2.2.2.5.2" xref="S2.E1.m1.2.2.2.5.2a.cmml">percentile</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.5.1" xref="S2.E1.m1.2.2.2.5.1.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.5.3.2" xref="S2.E1.m1.2.2.2.5.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.5.3.2.1" xref="S2.E1.m1.2.2.2.5.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">I</mi><mo id="S2.E1.m1.2.2.2.5.3.2.2" xref="S2.E1.m1.2.2.2.5.3.1.cmml">,</mo><mn id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">1</mn><mo stretchy="false" id="S2.E1.m1.2.2.2.5.3.2.3" xref="S2.E1.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E1.m1.6.6.6" xref="S2.E1.m1.6.6.6.cmml"><mrow id="S2.E1.m1.6.6.6.6" xref="S2.E1.m1.6.6.6.6.cmml"><mtext id="S2.E1.m1.6.6.6.6.2" xref="S2.E1.m1.6.6.6.6.2a.cmml">percentile</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.6.6.1" xref="S2.E1.m1.6.6.6.6.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.6.6.3.2" xref="S2.E1.m1.6.6.6.6.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.6.6.3.2.1" xref="S2.E1.m1.6.6.6.6.3.1.cmml">(</mo><mi id="S2.E1.m1.3.3.3.1" xref="S2.E1.m1.3.3.3.1.cmml">I</mi><mo id="S2.E1.m1.6.6.6.6.3.2.2" xref="S2.E1.m1.6.6.6.6.3.1.cmml">,</mo><mn id="S2.E1.m1.4.4.4.2" xref="S2.E1.m1.4.4.4.2.cmml">99</mn><mo stretchy="false" id="S2.E1.m1.6.6.6.6.3.2.3" xref="S2.E1.m1.6.6.6.6.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.6.5" xref="S2.E1.m1.6.6.6.5.cmml">−</mo><mrow id="S2.E1.m1.6.6.6.7" xref="S2.E1.m1.6.6.6.7.cmml"><mtext id="S2.E1.m1.6.6.6.7.2" xref="S2.E1.m1.6.6.6.7.2a.cmml">percentile</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.6.7.1" xref="S2.E1.m1.6.6.6.7.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.6.7.3.2" xref="S2.E1.m1.6.6.6.7.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.6.7.3.2.1" xref="S2.E1.m1.6.6.6.7.3.1.cmml">(</mo><mi id="S2.E1.m1.5.5.5.3" xref="S2.E1.m1.5.5.5.3.cmml">I</mi><mo id="S2.E1.m1.6.6.6.7.3.2.2" xref="S2.E1.m1.6.6.6.7.3.1.cmml">,</mo><mn id="S2.E1.m1.6.6.6.4" xref="S2.E1.m1.6.6.6.4.cmml">1</mn><mo stretchy="false" id="S2.E1.m1.6.6.6.7.3.2.3" xref="S2.E1.m1.6.6.6.7.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.7.cmml" xref="S2.E1.m1.6.7"><eq id="S2.E1.m1.6.7.1.cmml" xref="S2.E1.m1.6.7.1"></eq><apply id="S2.E1.m1.6.7.2.cmml" xref="S2.E1.m1.6.7.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.7.2.1.cmml" xref="S2.E1.m1.6.7.2">subscript</csymbol><ci id="S2.E1.m1.6.7.2.2.cmml" xref="S2.E1.m1.6.7.2.2">𝐼</ci><apply id="S2.E1.m1.6.7.2.3.cmml" xref="S2.E1.m1.6.7.2.3"><times id="S2.E1.m1.6.7.2.3.1.cmml" xref="S2.E1.m1.6.7.2.3.1"></times><ci id="S2.E1.m1.6.7.2.3.2.cmml" xref="S2.E1.m1.6.7.2.3.2">𝑛</ci><ci id="S2.E1.m1.6.7.2.3.3.cmml" xref="S2.E1.m1.6.7.2.3.3">𝑜</ci><ci id="S2.E1.m1.6.7.2.3.4.cmml" xref="S2.E1.m1.6.7.2.3.4">𝑟</ci><ci id="S2.E1.m1.6.7.2.3.5.cmml" xref="S2.E1.m1.6.7.2.3.5">𝑚</ci></apply></apply><apply id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"><divide id="S2.E1.m1.6.6.7.cmml" xref="S2.E1.m1.6.6"></divide><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><minus id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"></minus><ci id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4">𝐼</ci><apply id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5"><times id="S2.E1.m1.2.2.2.5.1.cmml" xref="S2.E1.m1.2.2.2.5.1"></times><ci id="S2.E1.m1.2.2.2.5.2a.cmml" xref="S2.E1.m1.2.2.2.5.2"><mtext id="S2.E1.m1.2.2.2.5.2.cmml" xref="S2.E1.m1.2.2.2.5.2">percentile</mtext></ci><interval closure="open" id="S2.E1.m1.2.2.2.5.3.1.cmml" xref="S2.E1.m1.2.2.2.5.3.2"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝐼</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="S2.E1.m1.6.6.6.cmml" xref="S2.E1.m1.6.6.6"><minus id="S2.E1.m1.6.6.6.5.cmml" xref="S2.E1.m1.6.6.6.5"></minus><apply id="S2.E1.m1.6.6.6.6.cmml" xref="S2.E1.m1.6.6.6.6"><times id="S2.E1.m1.6.6.6.6.1.cmml" xref="S2.E1.m1.6.6.6.6.1"></times><ci id="S2.E1.m1.6.6.6.6.2a.cmml" xref="S2.E1.m1.6.6.6.6.2"><mtext id="S2.E1.m1.6.6.6.6.2.cmml" xref="S2.E1.m1.6.6.6.6.2">percentile</mtext></ci><interval closure="open" id="S2.E1.m1.6.6.6.6.3.1.cmml" xref="S2.E1.m1.6.6.6.6.3.2"><ci id="S2.E1.m1.3.3.3.1.cmml" xref="S2.E1.m1.3.3.3.1">𝐼</ci><cn type="integer" id="S2.E1.m1.4.4.4.2.cmml" xref="S2.E1.m1.4.4.4.2">99</cn></interval></apply><apply id="S2.E1.m1.6.6.6.7.cmml" xref="S2.E1.m1.6.6.6.7"><times id="S2.E1.m1.6.6.6.7.1.cmml" xref="S2.E1.m1.6.6.6.7.1"></times><ci id="S2.E1.m1.6.6.6.7.2a.cmml" xref="S2.E1.m1.6.6.6.7.2"><mtext id="S2.E1.m1.6.6.6.7.2.cmml" xref="S2.E1.m1.6.6.6.7.2">percentile</mtext></ci><interval closure="open" id="S2.E1.m1.6.6.6.7.3.1.cmml" xref="S2.E1.m1.6.6.6.7.3.2"><ci id="S2.E1.m1.5.5.5.3.cmml" xref="S2.E1.m1.5.5.5.3">𝐼</ci><cn type="integer" id="S2.E1.m1.6.6.6.4.cmml" xref="S2.E1.m1.6.6.6.4">1</cn></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">\displaystyle I_{norm}=\frac{I-\text{percentile}(I,1)}{\text{percentile}(I,99)-\text{percentile}(I,1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Z-score image normalization followed IQR-based normalization to overcome the problem of high variability of intensity distribution between different patients by transforming the intensities to have zero mean and unit variance.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Summary of Datasets at Research Sites</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">Table <a href="#S2.T1" title="Table 1 ‣ 2.4 Summary of Datasets at Research Sites ‣ 2 Dataset and Assumptions ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the distribution of ISUP grade groups in training, validation, and testing exams for both research sites. As evident, our data is highly non-iid with respect to the cancer grade distribution, in addition to subtle differences in the characteristics of the imagery.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<div id="S2.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:105.4pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.6pt,1.8pt) scale(0.966282830282469,0.966282830282469) ;">
<table id="S2.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.1.1.1.1" class="ltx_tr">
<th id="S2.T1.1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S2.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCSF-Train</th>
<th id="S2.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCSF-Val</th>
<th id="S2.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCSF-Test</th>
<th id="S2.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCLA-Train</th>
<th id="S2.T1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCLA-Val</th>
<th id="S2.T1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCLA-Test</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.1.1.2.1" class="ltx_tr">
<th id="S2.T1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">max ISUP 0</th>
<td id="S2.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92</td>
<td id="S2.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17</td>
<td id="S2.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24</td>
<td id="S2.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">196</td>
<td id="S2.T1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">26</td>
<td id="S2.T1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43</td>
</tr>
<tr id="S2.T1.1.1.3.2" class="ltx_tr">
<th id="S2.T1.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">max ISUP 1</th>
<td id="S2.T1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">222</td>
<td id="S2.T1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">27</td>
<td id="S2.T1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">73</td>
<td id="S2.T1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r">172</td>
<td id="S2.T1.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r">24</td>
<td id="S2.T1.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r">31</td>
</tr>
<tr id="S2.T1.1.1.4.3" class="ltx_tr">
<th id="S2.T1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">max ISUP 2</th>
<td id="S2.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">228</td>
<td id="S2.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r">30</td>
<td id="S2.T1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r">61</td>
<td id="S2.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r">197</td>
<td id="S2.T1.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_r">27</td>
<td id="S2.T1.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r">40</td>
</tr>
<tr id="S2.T1.1.1.5.4" class="ltx_tr">
<th id="S2.T1.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">max ISUP 3-5</th>
<td id="S2.T1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">137</td>
<td id="S2.T1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r">22</td>
<td id="S2.T1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r">40</td>
<td id="S2.T1.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r">172</td>
<td id="S2.T1.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_r">24</td>
<td id="S2.T1.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_r">34</td>
</tr>
<tr id="S2.T1.1.1.6.5" class="ltx_tr">
<th id="S2.T1.1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Totals</th>
<td id="S2.T1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">679</td>
<td id="S2.T1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">96</td>
<td id="S2.T1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">198</td>
<td id="S2.T1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">737</td>
<td id="S2.T1.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">101</td>
<td id="S2.T1.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">148</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Number of exams as a function of ISUP grade group.</figcaption>
</figure>
<figure id="S2.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F4.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:164.8pt;"><img src="/html/2206.05617/assets/figures/topology.png" id="S2.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="475" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>FL topology for <span id="S2.F4.1.2.1" class="ltx_text ltx_font_typewriter">FedSGD</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F4.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:264.5pt;">
<div id="S2.F4.3.2" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:151pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-43.1pt,14.9pt) scale(0.834328839134395,0.834328839134395) ;">
<table id="S2.F4.3.2.2" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S2.F4.3.2.2.3.1" class="ltx_tr">
<td id="S2.F4.3.2.2.3.1.1" class="ltx_td ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S2.F4.3.2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">NVFlare 1.0</td>
<td id="S2.F4.3.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">NVFlare 1.0</td>
<td id="S2.F4.3.2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">NVFlare 2.0</td>
<td id="S2.F4.3.2.2.3.1.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">Our System</td>
</tr>
<tr id="S2.F4.2.1.1.1" class="ltx_tr">
<td id="S2.F4.2.1.1.1.2" class="ltx_td ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S2.F4.2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">+ Clara 4.0</td>
<td id="S2.F4.2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">+ BYOT</td>
<td id="S2.F4.2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Custom</td>
<td id="S2.F4.2.1.1.1.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<math id="S2.F4.2.1.1.1.1.m1.1" class="ltx_Math" alttext="(" display="inline"><semantics id="S2.F4.2.1.1.1.1.m1.1a"><mo stretchy="false" id="S2.F4.2.1.1.1.1.m1.1.1" xref="S2.F4.2.1.1.1.1.m1.1.1.cmml">(</mo><annotation-xml encoding="MathML-Content" id="S2.F4.2.1.1.1.1.m1.1b"><ci id="S2.F4.2.1.1.1.1.m1.1.1.cmml" xref="S2.F4.2.1.1.1.1.m1.1.1">(</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.2.1.1.1.1.m1.1c">(</annotation></semantics></math> NVFlare</td>
</tr>
<tr id="S2.F4.3.2.2.2" class="ltx_tr">
<td id="S2.F4.3.2.2.2.2" class="ltx_td ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S2.F4.3.2.2.2.3" class="ltx_td ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S2.F4.3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">+ BYOC</td>
<td id="S2.F4.3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FLComponents</td>
<td id="S2.F4.3.2.2.2.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">+ <span id="S2.F4.3.2.2.2.1.1" class="ltx_text ltx_font_typewriter">FLTools<math id="S2.F4.3.2.2.2.1.1.m1.1" class="ltx_Math" alttext=")" display="inline"><semantics id="S2.F4.3.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S2.F4.3.2.2.2.1.1.m1.1.1" xref="S2.F4.3.2.2.2.1.1.m1.1.1.cmml">)</mo><annotation-xml encoding="MathML-Content" id="S2.F4.3.2.2.2.1.1.m1.1b"><ci id="S2.F4.3.2.2.2.1.1.m1.1.1.cmml" xref="S2.F4.3.2.2.2.1.1.m1.1.1">)</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.3.2.2.2.1.1.m1.1c">)</annotation></semantics></math></span>
</td>
</tr>
<tr id="S2.F4.3.2.2.4.2" class="ltx_tr">
<td id="S2.F4.3.2.2.4.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Use the Clara Models for Training</td>
<td id="S2.F4.3.2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.4.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.5.3" class="ltx_tr">
<td id="S2.F4.3.2.2.5.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Bring your model without code modification</td>
<td id="S2.F4.3.2.2.5.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.5.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.6.4" class="ltx_tr">
<td id="S2.F4.3.2.2.6.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Use custom dataloader</td>
<td id="S2.F4.3.2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.6.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.7.5" class="ltx_tr">
<td id="S2.F4.3.2.2.7.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Check FL loop simulation without NVFlare API</td>
<td id="S2.F4.3.2.2.7.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.7.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.7.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.7.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.8.6" class="ltx_tr">
<td id="S2.F4.3.2.2.8.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Fix training issues using python debugger</td>
<td id="S2.F4.3.2.2.8.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.8.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.8.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✓(poc mode)</td>
<td id="S2.F4.3.2.2.8.6.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.9.7" class="ltx_tr">
<td id="S2.F4.3.2.2.9.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Custom Checkpointing and Transfer Learning</td>
<td id="S2.F4.3.2.2.9.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.9.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.9.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
<td id="S2.F4.3.2.2.9.7.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
<tr id="S2.F4.3.2.2.10.8" class="ltx_tr">
<td id="S2.F4.3.2.2.10.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Using the local logging without modification</td>
<td id="S2.F4.3.2.2.10.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.10.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.10.8.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">✗</td>
<td id="S2.F4.3.2.2.10.8.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">✓</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Comparison of Features in Different Federated Learning Frameworks.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Modular Framework for Federated Learning</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this paper, we are using federated learning (FL) as a way to combine and maximize the use of non-sensitive (anonymized) prostate MRI exams across research sites with minimal impact to research prototype algorithm design and existing validation pipelines.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">In this context, FL involves adapting a “local” training loop into a “federated” training loop, where training is synchronized between the clients and a central server to implement learning algorithms like federated stochastic gradient descent (<span id="S3.p2.1.1" class="ltx_text ltx_font_typewriter">FedSGD</span>) or weight averaging (<span id="S3.p2.1.2" class="ltx_text ltx_font_typewriter">FedAverage</span>). However, this synchronization demands advanced engineering and researchers consequently often rely on FL frameworks to implement the details and help them build federated loops quicker. To achieve this, many frameworks (e.g. NVidia Clara) use programming design patterns like dependency injection to maintain control of the main program logic (e.g. looping structures) while also providing programming hooks for custom code. Although this simplifies the interface and increases adoption for well-calibrated production-ready models in established problem domains, this presents an obstacle for researchers developing new models in problem domains at their infancy (like prostate cancer detection from MRI). This is because the researcher cannot easily develop, debug, and refactor the core model or training logic as a module independent of the FL framework engineering code.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">To address this, we present a design pattern for FL that separates model development and FL implementation code, providing a rich FL development environment medical imaging <span id="S3.p3.1.1" class="ltx_text ltx_font_italic">researchers</span>. Our approach utilizes Nvidia’s NVFlare, an independent python library from Nvidia that allows researchers to collaboratively train deep learning models without sharing patient data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. In addition to “Bring Your Own Trainer” (BYOT) capabilities, NVFlare includes a “Bring Your Own Component” (BYOC) mode that enables users to develop their own FL components, e.g. to extract, aggregate, serialize, and transfer model weights and gradients between clients, using high-level APIs separated from the deep learning model architecture and data-specific code, such as pre-processing or model execution. We develop these components as a lightweight library of modules, <span id="S3.p3.1.2" class="ltx_text ltx_font_typewriter">FLtools</span>, that can be imported into existing research repositories, enabling a separation between local model development and FL deployment. Furthermore, <span id="S3.p3.1.3" class="ltx_text ltx_font_typewriter">FLtools</span> includes a simulation tool <span id="S3.p3.1.4" class="ltx_text ltx_font_typewriter">FLsim</span> that enables researchers to test FL deployment on one or more systems outside of NVidia’s federated environment (Table <a href="#S2.F4" title="Figure 4 ‣ 2.4 Summary of Datasets at Research Sites ‣ 2 Dataset and Assumptions ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>System Design and Components</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">To separate FL deployment from model development, we define a deep learning design pattern composed of 4 elements:</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Model Abstraction</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">We adopt the <span id="S3.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_typewriter">pytorch lightning</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> design pattern for specifying models, which involves defining a class with the key methods:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_typewriter">forward</span> – a function that implements a forward pass or inference given a batch of <span id="S3.I1.i1.p1.1.2" class="ltx_text ltx_font_italic">input</span> data, using the model architecture and weights (defined elsewhere in the class), resulting in a set of tensors as the model’s <span id="S3.I1.i1.p1.1.3" class="ltx_text ltx_font_italic">output</span>.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_typewriter">training_step</span> – a function that accepts a batch of training data (paired <span id="S3.I1.i2.p1.1.2" class="ltx_text ltx_font_italic">input</span> data and <span id="S3.I1.i2.p1.1.3" class="ltx_text ltx_font_italic">groundtruth</span> data), calls <span id="S3.I1.i2.p1.1.4" class="ltx_text ltx_font_typewriter">forward</span> with <span id="S3.I1.i2.p1.1.5" class="ltx_text ltx_font_italic">input</span> data to produce <span id="S3.I1.i2.p1.1.6" class="ltx_text ltx_font_italic">output</span> data, and computes <span id="S3.I1.i2.p1.1.7" class="ltx_text ltx_font_italic">metrics</span> and <span id="S3.I1.i2.p1.1.8" class="ltx_text ltx_font_italic">losses</span> by comparison with the <span id="S3.I1.i2.p1.1.9" class="ltx_text ltx_font_italic">groundtruth</span> to monitor and improve model performance.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_typewriter">validation_step</span> – (optional) a function that performs the same function on <span id="S3.I1.i3.p1.1.2" class="ltx_text ltx_font_typewriter">training_step</span> using a frozen version of the model on a batch of validation data.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p"><span id="S3.I1.i4.p1.1.1" class="ltx_text ltx_font_typewriter">unpack_batch</span> – (optional) a function we define (extending <span id="S3.I1.i4.p1.1.2" class="ltx_text ltx_font_typewriter">pytorch lightning</span>) to accept and unpack a dictionary of collated training or validation data, to enable easy dispatch of <span id="S3.I1.i4.p1.1.3" class="ltx_text ltx_font_typewriter">forward</span> or <span id="S3.I1.i4.p1.1.4" class="ltx_text ltx_font_typewriter">training_step</span> calls.</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i5.p1" class="ltx_para">
<p id="S3.I1.i5.p1.1" class="ltx_p"><span id="S3.I1.i5.p1.1.1" class="ltx_text ltx_font_typewriter">configure_optimizers</span> – a function that returns a neural network optimization function of the user’s choice.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Data Abstraction</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">There are two abstractions we use here, one for the general FL design pattern, and the second for the specific MRI-based prostate cancer detection problem.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.1" class="ltx_p">For the general FL design pattern, we require each client to provide a <span id="S3.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_typewriter">get_objects</span> function that returns the following:</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p"><span id="S3.I2.i1.p1.1.1" class="ltx_text ltx_font_typewriter">model</span> – a python class, defined with the aforementioned member functions and learnable algorithm parameters.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p id="S3.I2.i2.p1.1" class="ltx_p"><span id="S3.I2.i2.p1.1.1" class="ltx_text ltx_font_typewriter">train_dataloader</span> – a python iterable that (when iterated on) returns a collated dictionary of batched training data using client-specific code and data sources.</p>
</div>
</li>
<li id="S3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i3.p1" class="ltx_para">
<p id="S3.I2.i3.p1.1" class="ltx_p"><span id="S3.I2.i3.p1.1.1" class="ltx_text ltx_font_typewriter">val_dataloader</span> – same as <span id="S3.I2.i3.p1.1.2" class="ltx_text ltx_font_typewriter">train_dataloader</span>, but returning a collated dictionary of validation data.</p>
</div>
</li>
</ul>
<p id="S3.SS1.SSS2.p2.2" class="ltx_p">Thus, from the perspective of the FL training loops, data yielded by client-specific dataloaders are fed directly to <span id="S3.SS1.SSS2.p2.2.1" class="ltx_text ltx_font_typewriter">training_step</span>, without additional specification or connector code within the FL environment. This provides flexibility for prototype algorithm developers at each research site to change model and data specifications (e.g DNN toplogy, file loading, pre-processing, augmentation) without modifying the interface. Moreover, each site is free to modify and optimize local implementations of all the aforementioned components (including choice of training objectives and metrics), albeit within constrains of the federated algorithms employed.</p>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para">
<p id="S3.SS1.SSS2.p3.4" class="ltx_p">Specifically, for the MRI-based prostate cancer detection problem, we define the content of the training data using a flexible dictionary interface. Besides imaging data (provided as a registered, multi-channel 3D tensor, <math id="S3.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{3\times X\times Y\times Z}" display="inline"><semantics id="S3.SS1.SSS2.p3.1.m1.1a"><mrow id="S3.SS1.SSS2.p3.1.m1.1.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p3.1.m1.1.1.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS2.p3.1.m1.1.1.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p3.1.m1.1.1.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p3.1.m1.1.1.3.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.cmml"><mn id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1a" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.4" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1b" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.5" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.1.m1.1b"><apply id="S3.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1"><in id="S3.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.1"></in><ci id="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3"><times id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.1"></times><cn type="integer" id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.2">3</cn><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.3">𝑋</ci><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.4">𝑌</ci><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.3.5.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.1.m1.1c">x\in\mathbb{R}^{3\times X\times Y\times Z}</annotation></semantics></math>), we also include 3D binary region masks <math id="S3.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="y\in\mathbb{R}^{R\times X\times Y\times Z}" display="inline"><semantics id="S3.SS1.SSS2.p3.2.m2.1a"><mrow id="S3.SS1.SSS2.p3.2.m2.1.1" xref="S3.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p3.2.m2.1.1.2" xref="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS2.p3.2.m2.1.1.1" xref="S3.SS1.SSS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p3.2.m2.1.1.3" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3.2" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p3.2.m2.1.1.3.3" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.2" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.3" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1a" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.4" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1b" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.5" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.2.m2.1b"><apply id="S3.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1"><in id="S3.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.1"></in><ci id="S3.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.2">𝑦</ci><apply id="S3.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3"><times id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.2">𝑅</ci><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.3">𝑋</ci><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.4.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.4">𝑌</ci><ci id="S3.SS1.SSS2.p3.2.m2.1.1.3.3.5.cmml" xref="S3.SS1.SSS2.p3.2.m2.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.2.m2.1c">y\in\mathbb{R}^{R\times X\times Y\times Z}</annotation></semantics></math> representing each of the <math id="S3.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.SSS2.p3.3.m3.1a"><mi id="S3.SS1.SSS2.p3.3.m3.1.1" xref="S3.SS1.SSS2.p3.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.3.m3.1b"><ci id="S3.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.3.m3.1c">R</annotation></semantics></math> regions where histopathology data is included (lesions and sextants). Crucially, for this work we encode the histopathology data using a <math id="S3.SS1.SSS2.p3.4.m4.1" class="ltx_Math" alttext="z\in\mathbb{Z}^{R\times 2}" display="inline"><semantics id="S3.SS1.SSS2.p3.4.m4.1a"><mrow id="S3.SS1.SSS2.p3.4.m4.1.1" xref="S3.SS1.SSS2.p3.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p3.4.m4.1.1.2" xref="S3.SS1.SSS2.p3.4.m4.1.1.2.cmml">z</mi><mo id="S3.SS1.SSS2.p3.4.m4.1.1.1" xref="S3.SS1.SSS2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p3.4.m4.1.1.3" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS2.p3.4.m4.1.1.3.2" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.2.cmml">ℤ</mi><mrow id="S3.SS1.SSS2.p3.4.m4.1.1.3.3" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.2" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.1" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.3" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.4.m4.1b"><apply id="S3.SS1.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1"><in id="S3.SS1.SSS2.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.1"></in><ci id="S3.SS1.SSS2.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.2">𝑧</ci><apply id="S3.SS1.SSS2.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.2">ℤ</ci><apply id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3"><times id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.SSS2.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p3.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.4.m4.1c">z\in\mathbb{Z}^{R\times 2}</annotation></semantics></math> matrix, representing a <span id="S3.SS1.SSS2.p3.4.1" class="ltx_text ltx_font_italic">supervision signal</span> {0,1,2} and a maximum <span id="S3.SS1.SSS2.p3.4.2" class="ltx_text ltx_font_italic">ISUP grade group</span> (0-negative, 1-5) for each region. The supervision signal is used to dynamically select learning objectives applicable to the type of histopathology groundtruth on a region-by-region basis, enabling large heterogeneity in the types of exams that can be included for training both within and across prostate cancer research sites. This operation is clarified in Section <a href="#S4" title="4 UCNet for Mixed Histopathology Supervision ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Federated Toolkit (<span id="S3.SS1.SSS3.1.1" class="ltx_text ltx_font_typewriter">FLtools</span>)</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.1" class="ltx_p">Our FLtools library includes several components that represent baseline implementations of various NVFlare’s components, but which are crucially reusable across models and FL experiments:</p>
<ul id="S3.I3" class="ltx_itemize">
<li id="S3.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i1.p1" class="ltx_para">
<p id="S3.I3.i1.p1.1" class="ltx_p"><span id="S3.I3.i1.p1.1.1" class="ltx_text ltx_font_typewriter">FLComponents</span> - BYOT &amp; BYOC implementations utilizing the get_objects interface. This decouples the model implementation from NVFlare’s library, enabling reuse across models and experiments.</p>
</div>
</li>
<li id="S3.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i2.p1" class="ltx_para">
<p id="S3.I3.i2.p1.1" class="ltx_p"><span id="S3.I3.i2.p1.1.1" class="ltx_text ltx_font_typewriter">FLTrainer</span> - A reusable module extending the “Trainer” component, which uses the <span id="S3.I3.i2.p1.1.2" class="ltx_text ltx_font_typewriter">get_objects</span> interface to perform the training on the clients.</p>
</div>
</li>
<li id="S3.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i3.p1" class="ltx_para">
<p id="S3.I3.i3.p1.1" class="ltx_p"><span id="S3.I3.i3.p1.1.1" class="ltx_text ltx_font_typewriter">FLAggregator</span> - A reusable module that extends the “Aggregator” component, responsible for (a) validating the gradient contribution from each clients, and (b) aggregating gradient averaging using <span id="S3.I3.i3.p1.1.2" class="ltx_text ltx_font_typewriter">FLUtils</span>.</p>
</div>
</li>
<li id="S3.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i4.p1" class="ltx_para">
<p id="S3.I3.i4.p1.1" class="ltx_p"><span id="S3.I3.i4.p1.1.1" class="ltx_text ltx_font_typewriter">FLSharableGenerator</span> - A reusable module that extends the “Sharable Generator” component and converts a model to a sharable, a dictionary of weights and gradients that can be transmitted between the server and clients.</p>
</div>
</li>
<li id="S3.I3.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i5.p1" class="ltx_para">
<p id="S3.I3.i5.p1.1" class="ltx_p"><span id="S3.I3.i5.p1.1.1" class="ltx_text ltx_font_typewriter">FLModelPersistor</span> - A reusable model that extends ”ModelPersistor”, responsible for saving and loading of the checkpoint file on the server.</p>
</div>
</li>
</ul>
<p id="S3.SS1.SSS3.p1.2" class="ltx_p">Figure <a href="#S3.F5" title="Figure 5 ‣ 3.1.3 Federated Toolkit (FLtools) ‣ 3.1 System Design and Components ‣ 3 Modular Framework for Federated Learning ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> depicts a sequence diagram elucidating the communication between various entities present in the federated topology implemented for <span id="S3.SS1.SSS3.p1.2.1" class="ltx_text ltx_font_typewriter">FedSGD</span> (Fig. <a href="#S2.F4" title="Figure 4 ‣ 2.4 Summary of Datasets at Research Sites ‣ 2 Dataset and Assumptions ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). An important feature of <span id="S3.SS1.SSS3.p1.2.2" class="ltx_text ltx_font_typewriter">FLtools</span> is the clear separation between the engineer’s duties responsible for the machine learning operations (MLOps) team and the researcher developing the model. We found that the autonomy of the respective experts to work in separate areas and integrate via a programming contract fosters an environment of collaboration, conducive to FL success.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2206.05617/assets/x2.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="461" height="652" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Modular federated system architecture</figcaption>
</figure>
<figure id="S3.F6" class="ltx_figure"><img src="/html/2206.05617/assets/figures/sequence2.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="437" height="657" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>FLSim Local Federated Simulation</figcaption>
</figure>
</section>
<section id="S3.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4 </span>Local Simulation (<span id="S3.SS1.SSS4.1.1" class="ltx_text ltx_font_typewriter">FLsim</span>)</h4>

<div id="S3.SS1.SSS4.p1" class="ltx_para">
<p id="S3.SS1.SSS4.p1.1" class="ltx_p">Figure <a href="#S3.F6" title="Figure 6 ‣ 3.1.3 Federated Toolkit (FLtools) ‣ 3.1 System Design and Components ‣ 3 Modular Framework for Federated Learning ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows how <span id="S3.SS1.SSS4.p1.1.1" class="ltx_text ltx_font_typewriter">FLsim</span> simulates the federated loop (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1.3 Federated Toolkit (FLtools) ‣ 3.1 System Design and Components ‣ 3 Modular Framework for Federated Learning ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) on the local machine of the researcher. Since <span id="S3.SS1.SSS4.p1.1.2" class="ltx_text ltx_font_typewriter">FLSim</span> is decoupled from NVflare, the researcher is free to use existing debug tools (e.g. <span id="S3.SS1.SSS4.p1.1.3" class="ltx_text ltx_font_typewriter">pdb</span>) to fine-tune model or computational hyperparameters (e.g. batch size) prior to running the federated training via NVFlare.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Model Training and Implementation Details</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">For the FL experiments in this paper, we host the central server on an Amazon Web Services (AWS) EC2 instance, and two clients that are behind institutional firewalls at UCSF and UCLA, respectively (Fig. <a href="#S2.F4" title="Figure 4 ‣ 2.4 Summary of Datasets at Research Sites ‣ 2 Dataset and Assumptions ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). The central server aggregates gradients from each client and performs a weight update with appropriate momentum terms (we are using the AdamW optimizer with <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_typewriter">FedSGD</span>). Our FL concept involves private data, but also private metrics, so each client has no knowledge of how well the federated model is performing at other research sites. Instead, each institution’s client monitors performance on the institution’s own private validation dataset. Thus, there is no stopping criteria from the perspective of the server, and client can freely choose to select whichever checkpoint they consider to be most performant.</p>
</div>
<figure id="S3.F7" class="ltx_figure"><img src="/html/2206.05617/assets/figures/ucnet_lowres.png" id="S3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="247" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>UCNet Architecture, depicted here with a 3D residual UNet backbone, histopathology-based histogram suppression, and regional classification modules. In this paper, UCNet takes registered 3D mp-MRI as input and produces as output: lesion segmentation maps, 1-hot-encoded cancer grading maps (for classification of clinically-significant prostate cancer, <math id="S3.F7.3.m1.1" class="ltx_Math" alttext="K=2" display="inline"><semantics id="S3.F7.3.m1.1b"><mrow id="S3.F7.3.m1.1.1" xref="S3.F7.3.m1.1.1.cmml"><mi id="S3.F7.3.m1.1.1.2" xref="S3.F7.3.m1.1.1.2.cmml">K</mi><mo id="S3.F7.3.m1.1.1.1" xref="S3.F7.3.m1.1.1.1.cmml">=</mo><mn id="S3.F7.3.m1.1.1.3" xref="S3.F7.3.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F7.3.m1.1c"><apply id="S3.F7.3.m1.1.1.cmml" xref="S3.F7.3.m1.1.1"><eq id="S3.F7.3.m1.1.1.1.cmml" xref="S3.F7.3.m1.1.1.1"></eq><ci id="S3.F7.3.m1.1.1.2.cmml" xref="S3.F7.3.m1.1.1.2">𝐾</ci><cn type="integer" id="S3.F7.3.m1.1.1.3.cmml" xref="S3.F7.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.3.m1.1d">K=2</annotation></semantics></math>), and per-region classifications (<math id="S3.F7.4.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{global}}" display="inline"><semantics id="S3.F7.4.m2.1b"><msub id="S3.F7.4.m2.1.1" xref="S3.F7.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F7.4.m2.1.1.2" xref="S3.F7.4.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.F7.4.m2.1.1.3" xref="S3.F7.4.m2.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F7.4.m2.1c"><apply id="S3.F7.4.m2.1.1.cmml" xref="S3.F7.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F7.4.m2.1.1.1.cmml" xref="S3.F7.4.m2.1.1">subscript</csymbol><ci id="S3.F7.4.m2.1.1.2.cmml" xref="S3.F7.4.m2.1.1.2">ℒ</ci><ci id="S3.F7.4.m2.1.1.3a.cmml" xref="S3.F7.4.m2.1.1.3"><mtext mathsize="70%" id="S3.F7.4.m2.1.1.3.cmml" xref="S3.F7.4.m2.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.4.m2.1d">\mathcal{L}_{\text{global}}</annotation></semantics></math> not trained). </figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>UCNet for Mixed Histopathology Supervision</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">For this problem, we utilize a 3D residual UNet with an additional fully-connected classification output head, an architecture we call “UCNet”. Our UCNet implementation takes 3D mp-MRI as input and predicts 3D lesion segmentation maps, 3D ISUP grade group maps, and region-wise histograms that are used to determine region-wise and exam-wise cancer severity. We believe this architecture is representative of many deep learning tasks in medical imaging, but is particularly suited to handling the variety of groundtruth data available for prostate cancer. Of particular importance here is the dynamically-populated multi-task objective we use to train UCNet using highly heterogenous data within and across institutions.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Spatial Prediction</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Backbone</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.8" class="ltx_p">We use a fully-convolutional 3D residual UNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> as the backbone for UCNet, which in this case accepts a image tensor <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{3\times X\times Y\times Z}" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.3.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.cmml"><mn id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1a" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.4" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1b" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.5" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><in id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1"></in><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">𝑥</ci><apply id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3"><times id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.2">3</cn><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.3">𝑋</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.4.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.4">𝑌</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.5.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">x\in\mathbb{R}^{3\times X\times Y\times Z}</annotation></semantics></math> as input, and produces voxel-wise tanh-activated lesion maps <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\hat{y}_{\text{seg}}\in\mathbb{R}^{1\times X\times Y\times Z}" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mrow id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS1.p1.2.m2.1.1.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2.cmml">y</mi><mo id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1.cmml">^</mo></mover><mtext id="S4.SS1.SSS1.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.3a.cmml">seg</mtext></msub><mo id="S4.SS1.SSS1.p1.2.m2.1.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.2.m2.1.1.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.2.m2.1.1.3.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.cmml"><mn id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1a" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.4" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1b" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.5" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><apply id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1"><in id="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.1"></in><apply id="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1">^</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2">𝑦</ci></apply><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.3a.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.SSS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.3">seg</mtext></ci></apply><apply id="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3"><times id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.2">1</cn><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.3">𝑋</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.4.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.4">𝑌</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.3.5.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">\hat{y}_{\text{seg}}\in\mathbb{R}^{1\times X\times Y\times Z}</annotation></semantics></math> and softmax-activated grade group membership predictions <math id="S4.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\hat{y}_{\text{gg}}\in\mathbb{R}^{K\times X\times Y\times Z}" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><mrow id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml"><msub id="S4.SS1.SSS1.p1.3.m3.1.1.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.2.cmml">y</mi><mo id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.1.cmml">^</mo></mover><mtext id="S4.SS1.SSS1.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.3a.cmml">gg</mtext></msub><mo id="S4.SS1.SSS1.p1.3.m3.1.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.3.m3.1.1.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1a" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.4" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1b" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.5" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><apply id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1"><in id="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.1"></in><apply id="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2">subscript</csymbol><apply id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2"><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.1">^</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.2">𝑦</ci></apply><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.3a.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.3">gg</mtext></ci></apply><apply id="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3"><times id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.2">𝐾</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.3">𝑋</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.4.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.4">𝑌</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.3.5.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">\hat{y}_{\text{gg}}\in\mathbb{R}^{K\times X\times Y\times Z}</annotation></semantics></math>, where <math id="S4.SS1.SSS1.p1.4.m4.2" class="ltx_Math" alttext="K\in\mathbb{Z}_{[0,5]}" display="inline"><semantics id="S4.SS1.SSS1.p1.4.m4.2a"><mrow id="S4.SS1.SSS1.p1.4.m4.2.3" xref="S4.SS1.SSS1.p1.4.m4.2.3.cmml"><mi id="S4.SS1.SSS1.p1.4.m4.2.3.2" xref="S4.SS1.SSS1.p1.4.m4.2.3.2.cmml">K</mi><mo id="S4.SS1.SSS1.p1.4.m4.2.3.1" xref="S4.SS1.SSS1.p1.4.m4.2.3.1.cmml">∈</mo><msub id="S4.SS1.SSS1.p1.4.m4.2.3.3" xref="S4.SS1.SSS1.p1.4.m4.2.3.3.cmml"><mi id="S4.SS1.SSS1.p1.4.m4.2.3.3.2" xref="S4.SS1.SSS1.p1.4.m4.2.3.3.2.cmml">ℤ</mi><mrow id="S4.SS1.SSS1.p1.4.m4.2.2.2.4" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.4.m4.2.2.2.4.1" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.3.cmml">[</mo><mn id="S4.SS1.SSS1.p1.4.m4.1.1.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.1.1.cmml">0</mn><mo id="S4.SS1.SSS1.p1.4.m4.2.2.2.4.2" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS1.p1.4.m4.2.2.2.2" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.2.cmml">5</mn><mo stretchy="false" id="S4.SS1.SSS1.p1.4.m4.2.2.2.4.3" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.3.cmml">]</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.4.m4.2b"><apply id="S4.SS1.SSS1.p1.4.m4.2.3.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3"><in id="S4.SS1.SSS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3.1"></in><ci id="S4.SS1.SSS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3.2">𝐾</ci><apply id="S4.SS1.SSS1.p1.4.m4.2.3.3.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.4.m4.2.3.3.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.4.m4.2.3.3.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.3.3.2">ℤ</ci><interval closure="closed" id="S4.SS1.SSS1.p1.4.m4.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.4"><cn type="integer" id="S4.SS1.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1.1.1">0</cn><cn type="integer" id="S4.SS1.SSS1.p1.4.m4.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.2.2.2.2">5</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.4.m4.2c">K\in\mathbb{Z}_{[0,5]}</annotation></semantics></math> represents the number of unique grade groups chosen for regression. For example, <math id="S4.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="K=2" display="inline"><semantics id="S4.SS1.SSS1.p1.5.m5.1a"><mrow id="S4.SS1.SSS1.p1.5.m5.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.2.cmml">K</mi><mo id="S4.SS1.SSS1.p1.5.m5.1.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.5.m5.1.1.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.5.m5.1b"><apply id="S4.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1"><eq id="S4.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.5.m5.1c">K=2</annotation></semantics></math> in the case of binary detection of CS-PCa (ISUP grade groups <math id="S4.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\geq" display="inline"><semantics id="S4.SS1.SSS1.p1.6.m6.1a"><mo id="S4.SS1.SSS1.p1.6.m6.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.cmml">≥</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.6.m6.1b"><geq id="S4.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1"></geq></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.6.m6.1c">\geq</annotation></semantics></math> 2). <math id="S4.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS1.p1.7.m7.1a"><mi id="S4.SS1.SSS1.p1.7.m7.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.7.m7.1b"><ci id="S4.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.7.m7.1c">K</annotation></semantics></math> is an adjustable hyperparmeter, but we find <math id="S4.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="K=2" display="inline"><semantics id="S4.SS1.SSS1.p1.8.m8.1a"><mrow id="S4.SS1.SSS1.p1.8.m8.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS1.p1.8.m8.1.1.2" xref="S4.SS1.SSS1.p1.8.m8.1.1.2.cmml">K</mi><mo id="S4.SS1.SSS1.p1.8.m8.1.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.8.m8.1.1.3" xref="S4.SS1.SSS1.p1.8.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.8.m8.1b"><apply id="S4.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1"><eq id="S4.SS1.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.8.m8.1c">K=2</annotation></semantics></math> yields slightly higher validation accuracy for detection of CS-PCa compared to multi-class grading approaches.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Strong Supervision of Lesion Segmentation and Grading</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.2" class="ltx_p">We use a combination of dice and weighted binary cross-entropy losses to supervise the radiological lesion segmentation output, <math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\hat{y}_{\text{seg}}" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><msub id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p1.1.m1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.2.cmml">y</mi><mo id="S4.SS1.SSS2.p1.1.m1.1.1.2.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS1.SSS2.p1.1.m1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.2">𝑦</ci></apply><ci id="S4.SS1.SSS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">\hat{y}_{\text{seg}}</annotation></semantics></math>, given the groundtruth segmentations <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="y_{\text{seg}}" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><msub id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml">y</mi><mtext id="S4.SS1.SSS2.p1.2.m2.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3a.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">y_{\text{seg}}</annotation></semantics></math>, since this has been shown to achieve higher accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>:</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{segmentation}}(y_{\text{seg}},\hat{y}_{\text{seg}})=\mathcal{L}_{\text{seg-dice}}+\mathcal{L}_{\text{seg-BCE}}" display="inline"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><msub id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.2.4.2" xref="S4.E2.m1.2.2.2.4.2.cmml">ℒ</mi><mtext id="S4.E2.m1.2.2.2.4.3" xref="S4.E2.m1.2.2.2.4.3a.cmml">segmentation</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E2.m1.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.2.2.2.3" xref="S4.E2.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml">y</mi><mtext id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3a.cmml">seg</mtext></msub><mo id="S4.E2.m1.2.2.2.2.2.4" xref="S4.E2.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E2.m1.2.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S4.E2.m1.2.2.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.E2.m1.2.2.2.2.2.2.2.1" xref="S4.E2.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mtext id="S4.E2.m1.2.2.2.2.2.2.3" xref="S4.E2.m1.2.2.2.2.2.2.3a.cmml">seg</mtext></msub><mo stretchy="false" id="S4.E2.m1.2.2.2.2.2.5" xref="S4.E2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.3" xref="S4.E2.m1.2.2.3.cmml">=</mo><mrow id="S4.E2.m1.2.2.4" xref="S4.E2.m1.2.2.4.cmml"><msub id="S4.E2.m1.2.2.4.2" xref="S4.E2.m1.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.4.2.2" xref="S4.E2.m1.2.2.4.2.2.cmml">ℒ</mi><mtext id="S4.E2.m1.2.2.4.2.3" xref="S4.E2.m1.2.2.4.2.3a.cmml">seg-dice</mtext></msub><mo id="S4.E2.m1.2.2.4.1" xref="S4.E2.m1.2.2.4.1.cmml">+</mo><msub id="S4.E2.m1.2.2.4.3" xref="S4.E2.m1.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.4.3.2" xref="S4.E2.m1.2.2.4.3.2.cmml">ℒ</mi><mtext id="S4.E2.m1.2.2.4.3.3" xref="S4.E2.m1.2.2.4.3.3a.cmml">seg-BCE</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b"><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><eq id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2.3"></eq><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><times id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3"></times><apply id="S4.E2.m1.2.2.2.4.cmml" xref="S4.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.4.1.cmml" xref="S4.E2.m1.2.2.2.4">subscript</csymbol><ci id="S4.E2.m1.2.2.2.4.2.cmml" xref="S4.E2.m1.2.2.2.4.2">ℒ</ci><ci id="S4.E2.m1.2.2.2.4.3a.cmml" xref="S4.E2.m1.2.2.2.4.3"><mtext mathsize="70%" id="S4.E2.m1.2.2.2.4.3.cmml" xref="S4.E2.m1.2.2.2.4.3">segmentation</mtext></ci></apply><interval closure="open" id="S4.E2.m1.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.2.2"><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E2.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3">seg</mtext></ci></apply><apply id="S4.E2.m1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E2.m1.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2"><ci id="S4.E2.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.1">^</ci><ci id="S4.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E2.m1.2.2.2.2.2.2.3a.cmml" xref="S4.E2.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.E2.m1.2.2.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.3">seg</mtext></ci></apply></interval></apply><apply id="S4.E2.m1.2.2.4.cmml" xref="S4.E2.m1.2.2.4"><plus id="S4.E2.m1.2.2.4.1.cmml" xref="S4.E2.m1.2.2.4.1"></plus><apply id="S4.E2.m1.2.2.4.2.cmml" xref="S4.E2.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.4.2.1.cmml" xref="S4.E2.m1.2.2.4.2">subscript</csymbol><ci id="S4.E2.m1.2.2.4.2.2.cmml" xref="S4.E2.m1.2.2.4.2.2">ℒ</ci><ci id="S4.E2.m1.2.2.4.2.3a.cmml" xref="S4.E2.m1.2.2.4.2.3"><mtext mathsize="70%" id="S4.E2.m1.2.2.4.2.3.cmml" xref="S4.E2.m1.2.2.4.2.3">seg-dice</mtext></ci></apply><apply id="S4.E2.m1.2.2.4.3.cmml" xref="S4.E2.m1.2.2.4.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.4.3.1.cmml" xref="S4.E2.m1.2.2.4.3">subscript</csymbol><ci id="S4.E2.m1.2.2.4.3.2.cmml" xref="S4.E2.m1.2.2.4.3.2">ℒ</ci><ci id="S4.E2.m1.2.2.4.3.3a.cmml" xref="S4.E2.m1.2.2.4.3.3"><mtext mathsize="70%" id="S4.E2.m1.2.2.4.3.3.cmml" xref="S4.E2.m1.2.2.4.3.3">seg-BCE</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.2c">\displaystyle\mathcal{L}_{\text{segmentation}}(y_{\text{seg}},\hat{y}_{\text{seg}})=\mathcal{L}_{\text{seg-dice}}+\mathcal{L}_{\text{seg-BCE}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{seg-dice}}(y_{\text{seg}},\hat{y}_{\text{seg}})=1-\frac{y_{\text{seg}}\cdot\hat{y}_{\text{seg}}}{y_{\text{seg}}+\hat{y}_{\text{seg}}+\epsilon}" display="inline"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.2.cmml">ℒ</mi><mtext id="S4.E3.m1.2.2.2.4.3" xref="S4.E3.m1.2.2.2.4.3a.cmml">seg-dice</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml">y</mi><mtext id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3a.cmml">seg</mtext></msub><mo id="S4.E3.m1.2.2.2.2.2.4" xref="S4.E3.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.E3.m1.2.2.2.2.2.2.2.1" xref="S4.E3.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mtext id="S4.E3.m1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.3a.cmml">seg</mtext></msub><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.5" xref="S4.E3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.3" xref="S4.E3.m1.2.2.3.cmml">=</mo><mrow id="S4.E3.m1.2.2.4" xref="S4.E3.m1.2.2.4.cmml"><mn id="S4.E3.m1.2.2.4.2" xref="S4.E3.m1.2.2.4.2.cmml">1</mn><mo id="S4.E3.m1.2.2.4.1" xref="S4.E3.m1.2.2.4.1.cmml">−</mo><mstyle displaystyle="true" id="S4.E3.m1.2.2.4.3" xref="S4.E3.m1.2.2.4.3.cmml"><mfrac id="S4.E3.m1.2.2.4.3a" xref="S4.E3.m1.2.2.4.3.cmml"><mrow id="S4.E3.m1.2.2.4.3.2" xref="S4.E3.m1.2.2.4.3.2.cmml"><msub id="S4.E3.m1.2.2.4.3.2.2" xref="S4.E3.m1.2.2.4.3.2.2.cmml"><mi id="S4.E3.m1.2.2.4.3.2.2.2" xref="S4.E3.m1.2.2.4.3.2.2.2.cmml">y</mi><mtext id="S4.E3.m1.2.2.4.3.2.2.3" xref="S4.E3.m1.2.2.4.3.2.2.3a.cmml">seg</mtext></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.2.2.4.3.2.1" xref="S4.E3.m1.2.2.4.3.2.1.cmml">⋅</mo><msub id="S4.E3.m1.2.2.4.3.2.3" xref="S4.E3.m1.2.2.4.3.2.3.cmml"><mover accent="true" id="S4.E3.m1.2.2.4.3.2.3.2" xref="S4.E3.m1.2.2.4.3.2.3.2.cmml"><mi id="S4.E3.m1.2.2.4.3.2.3.2.2" xref="S4.E3.m1.2.2.4.3.2.3.2.2.cmml">y</mi><mo id="S4.E3.m1.2.2.4.3.2.3.2.1" xref="S4.E3.m1.2.2.4.3.2.3.2.1.cmml">^</mo></mover><mtext id="S4.E3.m1.2.2.4.3.2.3.3" xref="S4.E3.m1.2.2.4.3.2.3.3a.cmml">seg</mtext></msub></mrow><mrow id="S4.E3.m1.2.2.4.3.3" xref="S4.E3.m1.2.2.4.3.3.cmml"><msub id="S4.E3.m1.2.2.4.3.3.2" xref="S4.E3.m1.2.2.4.3.3.2.cmml"><mi id="S4.E3.m1.2.2.4.3.3.2.2" xref="S4.E3.m1.2.2.4.3.3.2.2.cmml">y</mi><mtext id="S4.E3.m1.2.2.4.3.3.2.3" xref="S4.E3.m1.2.2.4.3.3.2.3a.cmml">seg</mtext></msub><mo id="S4.E3.m1.2.2.4.3.3.1" xref="S4.E3.m1.2.2.4.3.3.1.cmml">+</mo><msub id="S4.E3.m1.2.2.4.3.3.3" xref="S4.E3.m1.2.2.4.3.3.3.cmml"><mover accent="true" id="S4.E3.m1.2.2.4.3.3.3.2" xref="S4.E3.m1.2.2.4.3.3.3.2.cmml"><mi id="S4.E3.m1.2.2.4.3.3.3.2.2" xref="S4.E3.m1.2.2.4.3.3.3.2.2.cmml">y</mi><mo id="S4.E3.m1.2.2.4.3.3.3.2.1" xref="S4.E3.m1.2.2.4.3.3.3.2.1.cmml">^</mo></mover><mtext id="S4.E3.m1.2.2.4.3.3.3.3" xref="S4.E3.m1.2.2.4.3.3.3.3a.cmml">seg</mtext></msub><mo id="S4.E3.m1.2.2.4.3.3.1a" xref="S4.E3.m1.2.2.4.3.3.1.cmml">+</mo><mi id="S4.E3.m1.2.2.4.3.3.4" xref="S4.E3.m1.2.2.4.3.3.4.cmml">ϵ</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><eq id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2.3"></eq><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><times id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"></times><apply id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2.4">subscript</csymbol><ci id="S4.E3.m1.2.2.2.4.2.cmml" xref="S4.E3.m1.2.2.2.4.2">ℒ</ci><ci id="S4.E3.m1.2.2.2.4.3a.cmml" xref="S4.E3.m1.2.2.2.4.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.2.4.3.cmml" xref="S4.E3.m1.2.2.2.4.3">seg-dice</mtext></ci></apply><interval closure="open" id="S4.E3.m1.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E3.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">seg</mtext></ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"><ci id="S4.E3.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.1">^</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E3.m1.2.2.2.2.2.2.3a.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3">seg</mtext></ci></apply></interval></apply><apply id="S4.E3.m1.2.2.4.cmml" xref="S4.E3.m1.2.2.4"><minus id="S4.E3.m1.2.2.4.1.cmml" xref="S4.E3.m1.2.2.4.1"></minus><cn type="integer" id="S4.E3.m1.2.2.4.2.cmml" xref="S4.E3.m1.2.2.4.2">1</cn><apply id="S4.E3.m1.2.2.4.3.cmml" xref="S4.E3.m1.2.2.4.3"><divide id="S4.E3.m1.2.2.4.3.1.cmml" xref="S4.E3.m1.2.2.4.3"></divide><apply id="S4.E3.m1.2.2.4.3.2.cmml" xref="S4.E3.m1.2.2.4.3.2"><ci id="S4.E3.m1.2.2.4.3.2.1.cmml" xref="S4.E3.m1.2.2.4.3.2.1">⋅</ci><apply id="S4.E3.m1.2.2.4.3.2.2.cmml" xref="S4.E3.m1.2.2.4.3.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.4.3.2.2.1.cmml" xref="S4.E3.m1.2.2.4.3.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.4.3.2.2.2.cmml" xref="S4.E3.m1.2.2.4.3.2.2.2">𝑦</ci><ci id="S4.E3.m1.2.2.4.3.2.2.3a.cmml" xref="S4.E3.m1.2.2.4.3.2.2.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.4.3.2.2.3.cmml" xref="S4.E3.m1.2.2.4.3.2.2.3">seg</mtext></ci></apply><apply id="S4.E3.m1.2.2.4.3.2.3.cmml" xref="S4.E3.m1.2.2.4.3.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.4.3.2.3.1.cmml" xref="S4.E3.m1.2.2.4.3.2.3">subscript</csymbol><apply id="S4.E3.m1.2.2.4.3.2.3.2.cmml" xref="S4.E3.m1.2.2.4.3.2.3.2"><ci id="S4.E3.m1.2.2.4.3.2.3.2.1.cmml" xref="S4.E3.m1.2.2.4.3.2.3.2.1">^</ci><ci id="S4.E3.m1.2.2.4.3.2.3.2.2.cmml" xref="S4.E3.m1.2.2.4.3.2.3.2.2">𝑦</ci></apply><ci id="S4.E3.m1.2.2.4.3.2.3.3a.cmml" xref="S4.E3.m1.2.2.4.3.2.3.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.4.3.2.3.3.cmml" xref="S4.E3.m1.2.2.4.3.2.3.3">seg</mtext></ci></apply></apply><apply id="S4.E3.m1.2.2.4.3.3.cmml" xref="S4.E3.m1.2.2.4.3.3"><plus id="S4.E3.m1.2.2.4.3.3.1.cmml" xref="S4.E3.m1.2.2.4.3.3.1"></plus><apply id="S4.E3.m1.2.2.4.3.3.2.cmml" xref="S4.E3.m1.2.2.4.3.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.4.3.3.2.1.cmml" xref="S4.E3.m1.2.2.4.3.3.2">subscript</csymbol><ci id="S4.E3.m1.2.2.4.3.3.2.2.cmml" xref="S4.E3.m1.2.2.4.3.3.2.2">𝑦</ci><ci id="S4.E3.m1.2.2.4.3.3.2.3a.cmml" xref="S4.E3.m1.2.2.4.3.3.2.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.4.3.3.2.3.cmml" xref="S4.E3.m1.2.2.4.3.3.2.3">seg</mtext></ci></apply><apply id="S4.E3.m1.2.2.4.3.3.3.cmml" xref="S4.E3.m1.2.2.4.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.4.3.3.3.1.cmml" xref="S4.E3.m1.2.2.4.3.3.3">subscript</csymbol><apply id="S4.E3.m1.2.2.4.3.3.3.2.cmml" xref="S4.E3.m1.2.2.4.3.3.3.2"><ci id="S4.E3.m1.2.2.4.3.3.3.2.1.cmml" xref="S4.E3.m1.2.2.4.3.3.3.2.1">^</ci><ci id="S4.E3.m1.2.2.4.3.3.3.2.2.cmml" xref="S4.E3.m1.2.2.4.3.3.3.2.2">𝑦</ci></apply><ci id="S4.E3.m1.2.2.4.3.3.3.3a.cmml" xref="S4.E3.m1.2.2.4.3.3.3.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.4.3.3.3.3.cmml" xref="S4.E3.m1.2.2.4.3.3.3.3">seg</mtext></ci></apply><ci id="S4.E3.m1.2.2.4.3.3.4.cmml" xref="S4.E3.m1.2.2.4.3.3.4">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\displaystyle\mathcal{L}_{\text{seg-dice}}(y_{\text{seg}},\hat{y}_{\text{seg}})=1-\frac{y_{\text{seg}}\cdot\hat{y}_{\text{seg}}}{y_{\text{seg}}+\hat{y}_{\text{seg}}+\epsilon}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="Sx1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.9" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{seg-BCE}}(y_{\text{seg}},\hat{y}_{\text{seg}})=\sum_{z}\sum_{x,y_{\text{seg}}=z}\frac{\text{BCE}(y_{\text{seg}}(x),\hat{y}_{\text{seg}}(x))}{|z|\cdot n_{z}}" display="inline"><semantics id="S4.E4.m1.9a"><mrow id="S4.E4.m1.9.9" xref="S4.E4.m1.9.9.cmml"><mrow id="S4.E4.m1.9.9.2" xref="S4.E4.m1.9.9.2.cmml"><msub id="S4.E4.m1.9.9.2.4" xref="S4.E4.m1.9.9.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.9.9.2.4.2" xref="S4.E4.m1.9.9.2.4.2.cmml">ℒ</mi><mtext id="S4.E4.m1.9.9.2.4.3" xref="S4.E4.m1.9.9.2.4.3a.cmml">seg-BCE</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.9.9.2.3" xref="S4.E4.m1.9.9.2.3.cmml">​</mo><mrow id="S4.E4.m1.9.9.2.2.2" xref="S4.E4.m1.9.9.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.9.9.2.2.2.3" xref="S4.E4.m1.9.9.2.2.3.cmml">(</mo><msub id="S4.E4.m1.8.8.1.1.1.1" xref="S4.E4.m1.8.8.1.1.1.1.cmml"><mi id="S4.E4.m1.8.8.1.1.1.1.2" xref="S4.E4.m1.8.8.1.1.1.1.2.cmml">y</mi><mtext id="S4.E4.m1.8.8.1.1.1.1.3" xref="S4.E4.m1.8.8.1.1.1.1.3a.cmml">seg</mtext></msub><mo id="S4.E4.m1.9.9.2.2.2.4" xref="S4.E4.m1.9.9.2.2.3.cmml">,</mo><msub id="S4.E4.m1.9.9.2.2.2.2" xref="S4.E4.m1.9.9.2.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.9.9.2.2.2.2.2" xref="S4.E4.m1.9.9.2.2.2.2.2.cmml"><mi id="S4.E4.m1.9.9.2.2.2.2.2.2" xref="S4.E4.m1.9.9.2.2.2.2.2.2.cmml">y</mi><mo id="S4.E4.m1.9.9.2.2.2.2.2.1" xref="S4.E4.m1.9.9.2.2.2.2.2.1.cmml">^</mo></mover><mtext id="S4.E4.m1.9.9.2.2.2.2.3" xref="S4.E4.m1.9.9.2.2.2.2.3a.cmml">seg</mtext></msub><mo stretchy="false" id="S4.E4.m1.9.9.2.2.2.5" xref="S4.E4.m1.9.9.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.9.9.3" xref="S4.E4.m1.9.9.3.cmml">=</mo><mrow id="S4.E4.m1.9.9.4" xref="S4.E4.m1.9.9.4.cmml"><mstyle displaystyle="true" id="S4.E4.m1.9.9.4.1" xref="S4.E4.m1.9.9.4.1.cmml"><munder id="S4.E4.m1.9.9.4.1a" xref="S4.E4.m1.9.9.4.1.cmml"><mo movablelimits="false" id="S4.E4.m1.9.9.4.1.2" xref="S4.E4.m1.9.9.4.1.2.cmml">∑</mo><mi id="S4.E4.m1.9.9.4.1.3" xref="S4.E4.m1.9.9.4.1.3.cmml">z</mi></munder></mstyle><mrow id="S4.E4.m1.9.9.4.2" xref="S4.E4.m1.9.9.4.2.cmml"><mstyle displaystyle="true" id="S4.E4.m1.9.9.4.2.1" xref="S4.E4.m1.9.9.4.2.1.cmml"><munder id="S4.E4.m1.9.9.4.2.1a" xref="S4.E4.m1.9.9.4.2.1.cmml"><mo movablelimits="false" id="S4.E4.m1.9.9.4.2.1.2" xref="S4.E4.m1.9.9.4.2.1.2.cmml">∑</mo><mrow id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.2.cmml"><mrow id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">x</mi><mo id="S4.E4.m1.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.2.cmml">,</mo><msub id="S4.E4.m1.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.1.1.cmml"><mi id="S4.E4.m1.2.2.2.2.1.1.2" xref="S4.E4.m1.2.2.2.2.1.1.2.cmml">y</mi><mtext id="S4.E4.m1.2.2.2.2.1.1.3" xref="S4.E4.m1.2.2.2.2.1.1.3a.cmml">seg</mtext></msub></mrow><mo id="S4.E4.m1.2.2.2.3" xref="S4.E4.m1.2.2.2.3.cmml">=</mo><mi id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.4.cmml">z</mi></mrow></munder></mstyle><mstyle displaystyle="true" id="S4.E4.m1.7.7" xref="S4.E4.m1.7.7.cmml"><mfrac id="S4.E4.m1.7.7a" xref="S4.E4.m1.7.7.cmml"><mrow id="S4.E4.m1.6.6.4" xref="S4.E4.m1.6.6.4.cmml"><mtext id="S4.E4.m1.6.6.4.6" xref="S4.E4.m1.6.6.4.6a.cmml">BCE</mtext><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.4.5" xref="S4.E4.m1.6.6.4.5.cmml">​</mo><mrow id="S4.E4.m1.6.6.4.4.2" xref="S4.E4.m1.6.6.4.4.3.cmml"><mo stretchy="false" id="S4.E4.m1.6.6.4.4.2.3" xref="S4.E4.m1.6.6.4.4.3.cmml">(</mo><mrow id="S4.E4.m1.5.5.3.3.1.1" xref="S4.E4.m1.5.5.3.3.1.1.cmml"><msub id="S4.E4.m1.5.5.3.3.1.1.2" xref="S4.E4.m1.5.5.3.3.1.1.2.cmml"><mi id="S4.E4.m1.5.5.3.3.1.1.2.2" xref="S4.E4.m1.5.5.3.3.1.1.2.2.cmml">y</mi><mtext id="S4.E4.m1.5.5.3.3.1.1.2.3" xref="S4.E4.m1.5.5.3.3.1.1.2.3a.cmml">seg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.5.5.3.3.1.1.1" xref="S4.E4.m1.5.5.3.3.1.1.1.cmml">​</mo><mrow id="S4.E4.m1.5.5.3.3.1.1.3.2" xref="S4.E4.m1.5.5.3.3.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.5.5.3.3.1.1.3.2.1" xref="S4.E4.m1.5.5.3.3.1.1.cmml">(</mo><mi id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.5.5.3.3.1.1.3.2.2" xref="S4.E4.m1.5.5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.6.6.4.4.2.4" xref="S4.E4.m1.6.6.4.4.3.cmml">,</mo><mrow id="S4.E4.m1.6.6.4.4.2.2" xref="S4.E4.m1.6.6.4.4.2.2.cmml"><msub id="S4.E4.m1.6.6.4.4.2.2.2" xref="S4.E4.m1.6.6.4.4.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.6.6.4.4.2.2.2.2" xref="S4.E4.m1.6.6.4.4.2.2.2.2.cmml"><mi id="S4.E4.m1.6.6.4.4.2.2.2.2.2" xref="S4.E4.m1.6.6.4.4.2.2.2.2.2.cmml">y</mi><mo id="S4.E4.m1.6.6.4.4.2.2.2.2.1" xref="S4.E4.m1.6.6.4.4.2.2.2.2.1.cmml">^</mo></mover><mtext id="S4.E4.m1.6.6.4.4.2.2.2.3" xref="S4.E4.m1.6.6.4.4.2.2.2.3a.cmml">seg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.4.4.2.2.1" xref="S4.E4.m1.6.6.4.4.2.2.1.cmml">​</mo><mrow id="S4.E4.m1.6.6.4.4.2.2.3.2" xref="S4.E4.m1.6.6.4.4.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.6.6.4.4.2.2.3.2.1" xref="S4.E4.m1.6.6.4.4.2.2.cmml">(</mo><mi id="S4.E4.m1.4.4.2.2" xref="S4.E4.m1.4.4.2.2.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.6.6.4.4.2.2.3.2.2" xref="S4.E4.m1.6.6.4.4.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.6.6.4.4.2.5" xref="S4.E4.m1.6.6.4.4.3.cmml">)</mo></mrow></mrow><mrow id="S4.E4.m1.7.7.5" xref="S4.E4.m1.7.7.5.cmml"><mrow id="S4.E4.m1.7.7.5.3.2" xref="S4.E4.m1.7.7.5.3.1.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.5.3.2.1" xref="S4.E4.m1.7.7.5.3.1.1.cmml">|</mo><mi id="S4.E4.m1.7.7.5.1" xref="S4.E4.m1.7.7.5.1.cmml">z</mi><mo rspace="0.055em" stretchy="false" id="S4.E4.m1.7.7.5.3.2.2" xref="S4.E4.m1.7.7.5.3.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S4.E4.m1.7.7.5.2" xref="S4.E4.m1.7.7.5.2.cmml">⋅</mo><msub id="S4.E4.m1.7.7.5.4" xref="S4.E4.m1.7.7.5.4.cmml"><mi id="S4.E4.m1.7.7.5.4.2" xref="S4.E4.m1.7.7.5.4.2.cmml">n</mi><mi id="S4.E4.m1.7.7.5.4.3" xref="S4.E4.m1.7.7.5.4.3.cmml">z</mi></msub></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.9b"><apply id="S4.E4.m1.9.9.cmml" xref="S4.E4.m1.9.9"><eq id="S4.E4.m1.9.9.3.cmml" xref="S4.E4.m1.9.9.3"></eq><apply id="S4.E4.m1.9.9.2.cmml" xref="S4.E4.m1.9.9.2"><times id="S4.E4.m1.9.9.2.3.cmml" xref="S4.E4.m1.9.9.2.3"></times><apply id="S4.E4.m1.9.9.2.4.cmml" xref="S4.E4.m1.9.9.2.4"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.2.4.1.cmml" xref="S4.E4.m1.9.9.2.4">subscript</csymbol><ci id="S4.E4.m1.9.9.2.4.2.cmml" xref="S4.E4.m1.9.9.2.4.2">ℒ</ci><ci id="S4.E4.m1.9.9.2.4.3a.cmml" xref="S4.E4.m1.9.9.2.4.3"><mtext mathsize="70%" id="S4.E4.m1.9.9.2.4.3.cmml" xref="S4.E4.m1.9.9.2.4.3">seg-BCE</mtext></ci></apply><interval closure="open" id="S4.E4.m1.9.9.2.2.3.cmml" xref="S4.E4.m1.9.9.2.2.2"><apply id="S4.E4.m1.8.8.1.1.1.1.cmml" xref="S4.E4.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.8.8.1.1.1.1.1.cmml" xref="S4.E4.m1.8.8.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.8.8.1.1.1.1.2.cmml" xref="S4.E4.m1.8.8.1.1.1.1.2">𝑦</ci><ci id="S4.E4.m1.8.8.1.1.1.1.3a.cmml" xref="S4.E4.m1.8.8.1.1.1.1.3"><mtext mathsize="70%" id="S4.E4.m1.8.8.1.1.1.1.3.cmml" xref="S4.E4.m1.8.8.1.1.1.1.3">seg</mtext></ci></apply><apply id="S4.E4.m1.9.9.2.2.2.2.cmml" xref="S4.E4.m1.9.9.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.2.2.2.2.1.cmml" xref="S4.E4.m1.9.9.2.2.2.2">subscript</csymbol><apply id="S4.E4.m1.9.9.2.2.2.2.2.cmml" xref="S4.E4.m1.9.9.2.2.2.2.2"><ci id="S4.E4.m1.9.9.2.2.2.2.2.1.cmml" xref="S4.E4.m1.9.9.2.2.2.2.2.1">^</ci><ci id="S4.E4.m1.9.9.2.2.2.2.2.2.cmml" xref="S4.E4.m1.9.9.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E4.m1.9.9.2.2.2.2.3a.cmml" xref="S4.E4.m1.9.9.2.2.2.2.3"><mtext mathsize="70%" id="S4.E4.m1.9.9.2.2.2.2.3.cmml" xref="S4.E4.m1.9.9.2.2.2.2.3">seg</mtext></ci></apply></interval></apply><apply id="S4.E4.m1.9.9.4.cmml" xref="S4.E4.m1.9.9.4"><apply id="S4.E4.m1.9.9.4.1.cmml" xref="S4.E4.m1.9.9.4.1"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.4.1.1.cmml" xref="S4.E4.m1.9.9.4.1">subscript</csymbol><sum id="S4.E4.m1.9.9.4.1.2.cmml" xref="S4.E4.m1.9.9.4.1.2"></sum><ci id="S4.E4.m1.9.9.4.1.3.cmml" xref="S4.E4.m1.9.9.4.1.3">𝑧</ci></apply><apply id="S4.E4.m1.9.9.4.2.cmml" xref="S4.E4.m1.9.9.4.2"><apply id="S4.E4.m1.9.9.4.2.1.cmml" xref="S4.E4.m1.9.9.4.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.9.9.4.2.1.1.cmml" xref="S4.E4.m1.9.9.4.2.1">subscript</csymbol><sum id="S4.E4.m1.9.9.4.2.1.2.cmml" xref="S4.E4.m1.9.9.4.2.1.2"></sum><apply id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2.2"><eq id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.3"></eq><list id="S4.E4.m1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2.1"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑥</ci><apply id="S4.E4.m1.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S4.E4.m1.2.2.2.2.1.1.3a.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3"><mtext mathsize="50%" id="S4.E4.m1.2.2.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.2.2.1.1.3">seg</mtext></ci></apply></list><ci id="S4.E4.m1.2.2.2.4.cmml" xref="S4.E4.m1.2.2.2.4">𝑧</ci></apply></apply><apply id="S4.E4.m1.7.7.cmml" xref="S4.E4.m1.7.7"><divide id="S4.E4.m1.7.7.6.cmml" xref="S4.E4.m1.7.7"></divide><apply id="S4.E4.m1.6.6.4.cmml" xref="S4.E4.m1.6.6.4"><times id="S4.E4.m1.6.6.4.5.cmml" xref="S4.E4.m1.6.6.4.5"></times><ci id="S4.E4.m1.6.6.4.6a.cmml" xref="S4.E4.m1.6.6.4.6"><mtext id="S4.E4.m1.6.6.4.6.cmml" xref="S4.E4.m1.6.6.4.6">BCE</mtext></ci><interval closure="open" id="S4.E4.m1.6.6.4.4.3.cmml" xref="S4.E4.m1.6.6.4.4.2"><apply id="S4.E4.m1.5.5.3.3.1.1.cmml" xref="S4.E4.m1.5.5.3.3.1.1"><times id="S4.E4.m1.5.5.3.3.1.1.1.cmml" xref="S4.E4.m1.5.5.3.3.1.1.1"></times><apply id="S4.E4.m1.5.5.3.3.1.1.2.cmml" xref="S4.E4.m1.5.5.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.3.3.1.1.2.1.cmml" xref="S4.E4.m1.5.5.3.3.1.1.2">subscript</csymbol><ci id="S4.E4.m1.5.5.3.3.1.1.2.2.cmml" xref="S4.E4.m1.5.5.3.3.1.1.2.2">𝑦</ci><ci id="S4.E4.m1.5.5.3.3.1.1.2.3a.cmml" xref="S4.E4.m1.5.5.3.3.1.1.2.3"><mtext mathsize="70%" id="S4.E4.m1.5.5.3.3.1.1.2.3.cmml" xref="S4.E4.m1.5.5.3.3.1.1.2.3">seg</mtext></ci></apply><ci id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1.1">𝑥</ci></apply><apply id="S4.E4.m1.6.6.4.4.2.2.cmml" xref="S4.E4.m1.6.6.4.4.2.2"><times id="S4.E4.m1.6.6.4.4.2.2.1.cmml" xref="S4.E4.m1.6.6.4.4.2.2.1"></times><apply id="S4.E4.m1.6.6.4.4.2.2.2.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.4.4.2.2.2.1.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2">subscript</csymbol><apply id="S4.E4.m1.6.6.4.4.2.2.2.2.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2.2"><ci id="S4.E4.m1.6.6.4.4.2.2.2.2.1.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2.2.1">^</ci><ci id="S4.E4.m1.6.6.4.4.2.2.2.2.2.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E4.m1.6.6.4.4.2.2.2.3a.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2.3"><mtext mathsize="70%" id="S4.E4.m1.6.6.4.4.2.2.2.3.cmml" xref="S4.E4.m1.6.6.4.4.2.2.2.3">seg</mtext></ci></apply><ci id="S4.E4.m1.4.4.2.2.cmml" xref="S4.E4.m1.4.4.2.2">𝑥</ci></apply></interval></apply><apply id="S4.E4.m1.7.7.5.cmml" xref="S4.E4.m1.7.7.5"><ci id="S4.E4.m1.7.7.5.2.cmml" xref="S4.E4.m1.7.7.5.2">⋅</ci><apply id="S4.E4.m1.7.7.5.3.1.cmml" xref="S4.E4.m1.7.7.5.3.2"><abs id="S4.E4.m1.7.7.5.3.1.1.cmml" xref="S4.E4.m1.7.7.5.3.2.1"></abs><ci id="S4.E4.m1.7.7.5.1.cmml" xref="S4.E4.m1.7.7.5.1">𝑧</ci></apply><apply id="S4.E4.m1.7.7.5.4.cmml" xref="S4.E4.m1.7.7.5.4"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.5.4.1.cmml" xref="S4.E4.m1.7.7.5.4">subscript</csymbol><ci id="S4.E4.m1.7.7.5.4.2.cmml" xref="S4.E4.m1.7.7.5.4.2">𝑛</ci><ci id="S4.E4.m1.7.7.5.4.3.cmml" xref="S4.E4.m1.7.7.5.4.3">𝑧</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.9c">\displaystyle\mathcal{L}_{\text{seg-BCE}}(y_{\text{seg}},\hat{y}_{\text{seg}})=\sum_{z}\sum_{x,y_{\text{seg}}=z}\frac{\text{BCE}(y_{\text{seg}}(x),\hat{y}_{\text{seg}}(x))}{|z|\cdot n_{z}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS2.p1.10" class="ltx_p">where <math id="S4.SS1.SSS2.p1.3.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m1.1a"><mi id="S4.SS1.SSS2.p1.3.m1.1.1" xref="S4.SS1.SSS2.p1.3.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m1.1b"><ci id="S4.SS1.SSS2.p1.3.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m1.1c">\epsilon</annotation></semantics></math> is chosen arbitrarily small to prevent overflow, <span id="S4.SS1.SSS2.p1.10.1" class="ltx_text ltx_markedasmath">BCE</span> represents the binary cross-entropy function, <math id="S4.SS1.SSS2.p1.5.m3.1" class="ltx_Math" alttext="n_{z}" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m3.1a"><msub id="S4.SS1.SSS2.p1.5.m3.1.1" xref="S4.SS1.SSS2.p1.5.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p1.5.m3.1.1.2" xref="S4.SS1.SSS2.p1.5.m3.1.1.2.cmml">n</mi><mi id="S4.SS1.SSS2.p1.5.m3.1.1.3" xref="S4.SS1.SSS2.p1.5.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m3.1b"><apply id="S4.SS1.SSS2.p1.5.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.5.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m3.1.1.2">𝑛</ci><ci id="S4.SS1.SSS2.p1.5.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p1.5.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m3.1c">n_{z}</annotation></semantics></math> represents the number of voxels in class <math id="S4.SS1.SSS2.p1.6.m4.2" class="ltx_Math" alttext="z\in\{0,1\}" display="inline"><semantics id="S4.SS1.SSS2.p1.6.m4.2a"><mrow id="S4.SS1.SSS2.p1.6.m4.2.3" xref="S4.SS1.SSS2.p1.6.m4.2.3.cmml"><mi id="S4.SS1.SSS2.p1.6.m4.2.3.2" xref="S4.SS1.SSS2.p1.6.m4.2.3.2.cmml">z</mi><mo id="S4.SS1.SSS2.p1.6.m4.2.3.1" xref="S4.SS1.SSS2.p1.6.m4.2.3.1.cmml">∈</mo><mrow id="S4.SS1.SSS2.p1.6.m4.2.3.3.2" xref="S4.SS1.SSS2.p1.6.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.6.m4.2.3.3.2.1" xref="S4.SS1.SSS2.p1.6.m4.2.3.3.1.cmml">{</mo><mn id="S4.SS1.SSS2.p1.6.m4.1.1" xref="S4.SS1.SSS2.p1.6.m4.1.1.cmml">0</mn><mo id="S4.SS1.SSS2.p1.6.m4.2.3.3.2.2" xref="S4.SS1.SSS2.p1.6.m4.2.3.3.1.cmml">,</mo><mn id="S4.SS1.SSS2.p1.6.m4.2.2" xref="S4.SS1.SSS2.p1.6.m4.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS2.p1.6.m4.2.3.3.2.3" xref="S4.SS1.SSS2.p1.6.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m4.2b"><apply id="S4.SS1.SSS2.p1.6.m4.2.3.cmml" xref="S4.SS1.SSS2.p1.6.m4.2.3"><in id="S4.SS1.SSS2.p1.6.m4.2.3.1.cmml" xref="S4.SS1.SSS2.p1.6.m4.2.3.1"></in><ci id="S4.SS1.SSS2.p1.6.m4.2.3.2.cmml" xref="S4.SS1.SSS2.p1.6.m4.2.3.2">𝑧</ci><set id="S4.SS1.SSS2.p1.6.m4.2.3.3.1.cmml" xref="S4.SS1.SSS2.p1.6.m4.2.3.3.2"><cn type="integer" id="S4.SS1.SSS2.p1.6.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m4.1.1">0</cn><cn type="integer" id="S4.SS1.SSS2.p1.6.m4.2.2.cmml" xref="S4.SS1.SSS2.p1.6.m4.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m4.2c">z\in\{0,1\}</annotation></semantics></math> and <math id="S4.SS1.SSS2.p1.7.m5.1" class="ltx_Math" alttext="|z|" display="inline"><semantics id="S4.SS1.SSS2.p1.7.m5.1a"><mrow id="S4.SS1.SSS2.p1.7.m5.1.2.2" xref="S4.SS1.SSS2.p1.7.m5.1.2.1.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.7.m5.1.2.2.1" xref="S4.SS1.SSS2.p1.7.m5.1.2.1.1.cmml">|</mo><mi id="S4.SS1.SSS2.p1.7.m5.1.1" xref="S4.SS1.SSS2.p1.7.m5.1.1.cmml">z</mi><mo stretchy="false" id="S4.SS1.SSS2.p1.7.m5.1.2.2.2" xref="S4.SS1.SSS2.p1.7.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.7.m5.1b"><apply id="S4.SS1.SSS2.p1.7.m5.1.2.1.cmml" xref="S4.SS1.SSS2.p1.7.m5.1.2.2"><abs id="S4.SS1.SSS2.p1.7.m5.1.2.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m5.1.2.2.1"></abs><ci id="S4.SS1.SSS2.p1.7.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m5.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.7.m5.1c">|z|</annotation></semantics></math> is the number of classes. Here, <math id="S4.SS1.SSS2.p1.8.m6.1" class="ltx_Math" alttext="y_{\text{seg}}" display="inline"><semantics id="S4.SS1.SSS2.p1.8.m6.1a"><msub id="S4.SS1.SSS2.p1.8.m6.1.1" xref="S4.SS1.SSS2.p1.8.m6.1.1.cmml"><mi id="S4.SS1.SSS2.p1.8.m6.1.1.2" xref="S4.SS1.SSS2.p1.8.m6.1.1.2.cmml">y</mi><mtext id="S4.SS1.SSS2.p1.8.m6.1.1.3" xref="S4.SS1.SSS2.p1.8.m6.1.1.3a.cmml">seg</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.8.m6.1b"><apply id="S4.SS1.SSS2.p1.8.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.8.m6.1.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.8.m6.1.1.2.cmml" xref="S4.SS1.SSS2.p1.8.m6.1.1.2">𝑦</ci><ci id="S4.SS1.SSS2.p1.8.m6.1.1.3a.cmml" xref="S4.SS1.SSS2.p1.8.m6.1.1.3"><mtext mathsize="70%" id="S4.SS1.SSS2.p1.8.m6.1.1.3.cmml" xref="S4.SS1.SSS2.p1.8.m6.1.1.3">seg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.8.m6.1c">y_{\text{seg}}</annotation></semantics></math> is determined from as the voxel-wise max of the region masks <math id="S4.SS1.SSS2.p1.9.m7.1" class="ltx_Math" alttext="y\in\mathbb{R}^{R\times X\times Y\times Z}" display="inline"><semantics id="S4.SS1.SSS2.p1.9.m7.1a"><mrow id="S4.SS1.SSS2.p1.9.m7.1.1" xref="S4.SS1.SSS2.p1.9.m7.1.1.cmml"><mi id="S4.SS1.SSS2.p1.9.m7.1.1.2" xref="S4.SS1.SSS2.p1.9.m7.1.1.2.cmml">y</mi><mo id="S4.SS1.SSS2.p1.9.m7.1.1.1" xref="S4.SS1.SSS2.p1.9.m7.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS2.p1.9.m7.1.1.3" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.cmml"><mi id="S4.SS1.SSS2.p1.9.m7.1.1.3.2" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS2.p1.9.m7.1.1.3.3" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.cmml"><mi id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.2" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.3" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1a" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.4" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1b" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.5" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.9.m7.1b"><apply id="S4.SS1.SSS2.p1.9.m7.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1"><in id="S4.SS1.SSS2.p1.9.m7.1.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.1"></in><ci id="S4.SS1.SSS2.p1.9.m7.1.1.2.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.2">𝑦</ci><apply id="S4.SS1.SSS2.p1.9.m7.1.1.3.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.9.m7.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS2.p1.9.m7.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3"><times id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.1"></times><ci id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.2.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.2">𝑅</ci><ci id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.3.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.3">𝑋</ci><ci id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.4.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.4">𝑌</ci><ci id="S4.SS1.SSS2.p1.9.m7.1.1.3.3.5.cmml" xref="S4.SS1.SSS2.p1.9.m7.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.9.m7.1c">y\in\mathbb{R}^{R\times X\times Y\times Z}</annotation></semantics></math>, over regions where the supervision signal in the first column of the histopathology matrix <math id="S4.SS1.SSS2.p1.10.m8.1" class="ltx_Math" alttext="z\in\mathbb{R}^{R\times 2}" display="inline"><semantics id="S4.SS1.SSS2.p1.10.m8.1a"><mrow id="S4.SS1.SSS2.p1.10.m8.1.1" xref="S4.SS1.SSS2.p1.10.m8.1.1.cmml"><mi id="S4.SS1.SSS2.p1.10.m8.1.1.2" xref="S4.SS1.SSS2.p1.10.m8.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS2.p1.10.m8.1.1.1" xref="S4.SS1.SSS2.p1.10.m8.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS2.p1.10.m8.1.1.3" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.cmml"><mi id="S4.SS1.SSS2.p1.10.m8.1.1.3.2" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS2.p1.10.m8.1.1.3.3" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.cmml"><mi id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.2" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.1" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.3" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.10.m8.1b"><apply id="S4.SS1.SSS2.p1.10.m8.1.1.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1"><in id="S4.SS1.SSS2.p1.10.m8.1.1.1.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.1"></in><ci id="S4.SS1.SSS2.p1.10.m8.1.1.2.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.2">𝑧</ci><apply id="S4.SS1.SSS2.p1.10.m8.1.1.3.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.10.m8.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS2.p1.10.m8.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3"><times id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.1.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.1"></times><ci id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.2.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.2">𝑅</ci><cn type="integer" id="S4.SS1.SSS2.p1.10.m8.1.1.3.3.3.cmml" xref="S4.SS1.SSS2.p1.10.m8.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.10.m8.1c">z\in\mathbb{R}^{R\times 2}</annotation></semantics></math> is 1 to represent MRI-annotated lesions.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.4" class="ltx_p">Similarly, we apply categorical binary cross entropy loss to each voxel of the predicted grade membership maps, <math id="S4.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\hat{y}_{\text{gg}}\in\mathbb{R}^{K\times X\times Y\times Z}" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.1a"><mrow id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml"><msub id="S4.SS1.SSS2.p2.1.m1.1.1.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.1.m1.1.1.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.2.cmml">y</mi><mo id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S4.SS1.SSS2.p2.1.m1.1.1.2.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.3a.cmml">gg</mtext></msub><mo id="S4.SS1.SSS2.p2.1.m1.1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS2.p2.1.m1.1.1.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.3.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1a" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.4" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.4.cmml">Y</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1b" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.5" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.5.cmml">Z</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.1b"><apply id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1"><in id="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.1"></in><apply id="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2">subscript</csymbol><apply id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2"><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.1">^</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.2">𝑦</ci></apply><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.3a.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.3">gg</mtext></ci></apply><apply id="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3"><times id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.2">𝐾</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.3">𝑋</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.4.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.4">𝑌</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.5.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.5">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.1c">\hat{y}_{\text{gg}}\in\mathbb{R}^{K\times X\times Y\times Z}</annotation></semantics></math>, given one-hot encoded groundtruth histopathology data <math id="S4.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="y_{\text{gg}}\in\mathbb{R}^{R\times K}" display="inline"><semantics id="S4.SS1.SSS2.p2.2.m2.1a"><mrow id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml"><msub id="S4.SS1.SSS2.p2.2.m2.1.1.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.2.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.2.cmml">y</mi><mtext id="S4.SS1.SSS2.p2.2.m2.1.1.2.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.3a.cmml">gg</mtext></msub><mo id="S4.SS1.SSS2.p2.2.m2.1.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS2.p2.2.m2.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.1b"><apply id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1"><in id="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.1"></in><apply id="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.2">𝑦</ci><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.3a.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.SSS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.3">gg</mtext></ci></apply><apply id="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3"><times id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.2">𝑅</ci><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.1c">y_{\text{gg}}\in\mathbb{R}^{R\times K}</annotation></semantics></math> from regions <math id="S4.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="R^{+}" display="inline"><semantics id="S4.SS1.SSS2.p2.3.m3.1a"><msup id="S4.SS1.SSS2.p2.3.m3.1.1" xref="S4.SS1.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p2.3.m3.1.1.2" xref="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml">R</mi><mo id="S4.SS1.SSS2.p2.3.m3.1.1.3" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.3.m3.1b"><apply id="S4.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.2">𝑅</ci><plus id="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.3.m3.1c">R^{+}</annotation></semantics></math> where <math id="S4.SS1.SSS2.p2.4.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.SSS2.p2.4.m4.1a"><mi id="S4.SS1.SSS2.p2.4.m4.1.1" xref="S4.SS1.SSS2.p2.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.4.m4.1b"><ci id="S4.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p2.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.4.m4.1c">z</annotation></semantics></math> holds a supervision signal of 1 and a regression grade group that is not NaN. This is an important subtlety that allows supervision of segmentation outputs from the UCLA dataset even when the a grade group is not known for individual lesions. This strong voxel-wise grading or classification loss is then defined as:</p>
<table id="Sx1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{GGmap}}(y,z,y_{\text{gg}},\hat{y}_{\text{gg}})=\frac{1}{|R^{+}|}" display="inline"><semantics id="S4.Ex1.m1.5a"><mrow id="S4.Ex1.m1.5.5" xref="S4.Ex1.m1.5.5.cmml"><mrow id="S4.Ex1.m1.5.5.2" xref="S4.Ex1.m1.5.5.2.cmml"><msub id="S4.Ex1.m1.5.5.2.4" xref="S4.Ex1.m1.5.5.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.5.5.2.4.2" xref="S4.Ex1.m1.5.5.2.4.2.cmml">ℒ</mi><mtext id="S4.Ex1.m1.5.5.2.4.3" xref="S4.Ex1.m1.5.5.2.4.3a.cmml">GGmap</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.5.5.2.3" xref="S4.Ex1.m1.5.5.2.3.cmml">​</mo><mrow id="S4.Ex1.m1.5.5.2.2.2" xref="S4.Ex1.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.5.5.2.2.2.3" xref="S4.Ex1.m1.5.5.2.2.3.cmml">(</mo><mi id="S4.Ex1.m1.2.2" xref="S4.Ex1.m1.2.2.cmml">y</mi><mo id="S4.Ex1.m1.5.5.2.2.2.4" xref="S4.Ex1.m1.5.5.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.3.3" xref="S4.Ex1.m1.3.3.cmml">z</mi><mo id="S4.Ex1.m1.5.5.2.2.2.5" xref="S4.Ex1.m1.5.5.2.2.3.cmml">,</mo><msub id="S4.Ex1.m1.4.4.1.1.1.1" xref="S4.Ex1.m1.4.4.1.1.1.1.cmml"><mi id="S4.Ex1.m1.4.4.1.1.1.1.2" xref="S4.Ex1.m1.4.4.1.1.1.1.2.cmml">y</mi><mtext id="S4.Ex1.m1.4.4.1.1.1.1.3" xref="S4.Ex1.m1.4.4.1.1.1.1.3a.cmml">gg</mtext></msub><mo id="S4.Ex1.m1.5.5.2.2.2.6" xref="S4.Ex1.m1.5.5.2.2.3.cmml">,</mo><msub id="S4.Ex1.m1.5.5.2.2.2.2" xref="S4.Ex1.m1.5.5.2.2.2.2.cmml"><mover accent="true" id="S4.Ex1.m1.5.5.2.2.2.2.2" xref="S4.Ex1.m1.5.5.2.2.2.2.2.cmml"><mi id="S4.Ex1.m1.5.5.2.2.2.2.2.2" xref="S4.Ex1.m1.5.5.2.2.2.2.2.2.cmml">y</mi><mo id="S4.Ex1.m1.5.5.2.2.2.2.2.1" xref="S4.Ex1.m1.5.5.2.2.2.2.2.1.cmml">^</mo></mover><mtext id="S4.Ex1.m1.5.5.2.2.2.2.3" xref="S4.Ex1.m1.5.5.2.2.2.2.3a.cmml">gg</mtext></msub><mo stretchy="false" id="S4.Ex1.m1.5.5.2.2.2.7" xref="S4.Ex1.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.5.5.3" xref="S4.Ex1.m1.5.5.3.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1.cmml"><mfrac id="S4.Ex1.m1.1.1a" xref="S4.Ex1.m1.1.1.cmml"><mn id="S4.Ex1.m1.1.1.3" xref="S4.Ex1.m1.1.1.3.cmml">1</mn><mrow id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.Ex1.m1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.2.cmml">R</mi><mo id="S4.Ex1.m1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.3.cmml">+</mo></msup><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.5b"><apply id="S4.Ex1.m1.5.5.cmml" xref="S4.Ex1.m1.5.5"><eq id="S4.Ex1.m1.5.5.3.cmml" xref="S4.Ex1.m1.5.5.3"></eq><apply id="S4.Ex1.m1.5.5.2.cmml" xref="S4.Ex1.m1.5.5.2"><times id="S4.Ex1.m1.5.5.2.3.cmml" xref="S4.Ex1.m1.5.5.2.3"></times><apply id="S4.Ex1.m1.5.5.2.4.cmml" xref="S4.Ex1.m1.5.5.2.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.2.4.1.cmml" xref="S4.Ex1.m1.5.5.2.4">subscript</csymbol><ci id="S4.Ex1.m1.5.5.2.4.2.cmml" xref="S4.Ex1.m1.5.5.2.4.2">ℒ</ci><ci id="S4.Ex1.m1.5.5.2.4.3a.cmml" xref="S4.Ex1.m1.5.5.2.4.3"><mtext mathsize="70%" id="S4.Ex1.m1.5.5.2.4.3.cmml" xref="S4.Ex1.m1.5.5.2.4.3">GGmap</mtext></ci></apply><vector id="S4.Ex1.m1.5.5.2.2.3.cmml" xref="S4.Ex1.m1.5.5.2.2.2"><ci id="S4.Ex1.m1.2.2.cmml" xref="S4.Ex1.m1.2.2">𝑦</ci><ci id="S4.Ex1.m1.3.3.cmml" xref="S4.Ex1.m1.3.3">𝑧</ci><apply id="S4.Ex1.m1.4.4.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.2">𝑦</ci><ci id="S4.Ex1.m1.4.4.1.1.1.1.3a.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.3"><mtext mathsize="70%" id="S4.Ex1.m1.4.4.1.1.1.1.3.cmml" xref="S4.Ex1.m1.4.4.1.1.1.1.3">gg</mtext></ci></apply><apply id="S4.Ex1.m1.5.5.2.2.2.2.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.2.2.2.2.1.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2">subscript</csymbol><apply id="S4.Ex1.m1.5.5.2.2.2.2.2.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2.2"><ci id="S4.Ex1.m1.5.5.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2.2.1">^</ci><ci id="S4.Ex1.m1.5.5.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.Ex1.m1.5.5.2.2.2.2.3a.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2.3"><mtext mathsize="70%" id="S4.Ex1.m1.5.5.2.2.2.2.3.cmml" xref="S4.Ex1.m1.5.5.2.2.2.2.3">gg</mtext></ci></apply></vector></apply><apply id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1"><divide id="S4.Ex1.m1.1.1.2.cmml" xref="S4.Ex1.m1.1.1"></divide><cn type="integer" id="S4.Ex1.m1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.3">1</cn><apply id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1"><abs id="S4.Ex1.m1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.1.1.1.1.2"></abs><apply id="S4.Ex1.m1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex1.m1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.2">𝑅</ci><plus id="S4.Ex1.m1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.5c">\displaystyle\mathcal{L}_{\text{GGmap}}(y,z,y_{\text{gg}},\hat{y}_{\text{gg}})=\frac{1}{|R^{+}|}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle\sum_{r\in R^{+}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{y}_{\text{gg}}[\mathbb{1}_{r}]_{k}}" display="inline"><semantics id="S4.Ex1.m2.3a"><mrow id="S4.Ex1.m2.3.3" xref="S4.Ex1.m2.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.3.3.2" xref="S4.Ex1.m2.3.3.2.cmml"><munder id="S4.Ex1.m2.3.3.2a" xref="S4.Ex1.m2.3.3.2.cmml"><mo movablelimits="false" id="S4.Ex1.m2.3.3.2.2" xref="S4.Ex1.m2.3.3.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.3.3.2.3" xref="S4.Ex1.m2.3.3.2.3.cmml"><mi id="S4.Ex1.m2.3.3.2.3.2" xref="S4.Ex1.m2.3.3.2.3.2.cmml">r</mi><mo id="S4.Ex1.m2.3.3.2.3.1" xref="S4.Ex1.m2.3.3.2.3.1.cmml">∈</mo><msup id="S4.Ex1.m2.3.3.2.3.3" xref="S4.Ex1.m2.3.3.2.3.3.cmml"><mi id="S4.Ex1.m2.3.3.2.3.3.2" xref="S4.Ex1.m2.3.3.2.3.3.2.cmml">R</mi><mo id="S4.Ex1.m2.3.3.2.3.3.3" xref="S4.Ex1.m2.3.3.2.3.3.3.cmml">+</mo></msup></mrow></munder></mstyle><mrow id="S4.Ex1.m2.3.3.1" xref="S4.Ex1.m2.3.3.1.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.3.3.1.2" xref="S4.Ex1.m2.3.3.1.2.cmml"><munderover id="S4.Ex1.m2.3.3.1.2a" xref="S4.Ex1.m2.3.3.1.2.cmml"><mo movablelimits="false" id="S4.Ex1.m2.3.3.1.2.2.2" xref="S4.Ex1.m2.3.3.1.2.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.3.3.1.2.2.3" xref="S4.Ex1.m2.3.3.1.2.2.3.cmml"><mi id="S4.Ex1.m2.3.3.1.2.2.3.2" xref="S4.Ex1.m2.3.3.1.2.2.3.2.cmml">k</mi><mo id="S4.Ex1.m2.3.3.1.2.2.3.1" xref="S4.Ex1.m2.3.3.1.2.2.3.1.cmml">=</mo><mn id="S4.Ex1.m2.3.3.1.2.2.3.3" xref="S4.Ex1.m2.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m2.3.3.1.2.3" xref="S4.Ex1.m2.3.3.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex1.m2.3.3.1.1" xref="S4.Ex1.m2.3.3.1.1.cmml"><msub id="S4.Ex1.m2.3.3.1.1.3" xref="S4.Ex1.m2.3.3.1.1.3.cmml"><mi id="S4.Ex1.m2.3.3.1.1.3.2" xref="S4.Ex1.m2.3.3.1.1.3.2.cmml">y</mi><mtext id="S4.Ex1.m2.3.3.1.1.3.3" xref="S4.Ex1.m2.3.3.1.1.3.3a.cmml">gg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.3.3.1.1.2" xref="S4.Ex1.m2.3.3.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m2.3.3.1.1.4.2" xref="S4.Ex1.m2.3.3.1.1.4.1.cmml"><mo stretchy="false" id="S4.Ex1.m2.3.3.1.1.4.2.1" xref="S4.Ex1.m2.3.3.1.1.4.1.cmml">[</mo><mi id="S4.Ex1.m2.1.1" xref="S4.Ex1.m2.1.1.cmml">r</mi><mo id="S4.Ex1.m2.3.3.1.1.4.2.2" xref="S4.Ex1.m2.3.3.1.1.4.1.cmml">,</mo><mi id="S4.Ex1.m2.2.2" xref="S4.Ex1.m2.2.2.cmml">k</mi><mo stretchy="false" id="S4.Ex1.m2.3.3.1.1.4.2.3" xref="S4.Ex1.m2.3.3.1.1.4.1.cmml">]</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.Ex1.m2.3.3.1.1.2a" xref="S4.Ex1.m2.3.3.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m2.3.3.1.1.5" xref="S4.Ex1.m2.3.3.1.1.5.cmml"><mi id="S4.Ex1.m2.3.3.1.1.5.1" xref="S4.Ex1.m2.3.3.1.1.5.1.cmml">log</mi><mo lspace="0.167em" id="S4.Ex1.m2.3.3.1.1.5a" xref="S4.Ex1.m2.3.3.1.1.5.cmml">⁡</mo><msub id="S4.Ex1.m2.3.3.1.1.5.2" xref="S4.Ex1.m2.3.3.1.1.5.2.cmml"><mover accent="true" id="S4.Ex1.m2.3.3.1.1.5.2.2" xref="S4.Ex1.m2.3.3.1.1.5.2.2.cmml"><mi id="S4.Ex1.m2.3.3.1.1.5.2.2.2" xref="S4.Ex1.m2.3.3.1.1.5.2.2.2.cmml">y</mi><mo id="S4.Ex1.m2.3.3.1.1.5.2.2.1" xref="S4.Ex1.m2.3.3.1.1.5.2.2.1.cmml">^</mo></mover><mtext id="S4.Ex1.m2.3.3.1.1.5.2.3" xref="S4.Ex1.m2.3.3.1.1.5.2.3a.cmml">gg</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.3.3.1.1.2b" xref="S4.Ex1.m2.3.3.1.1.2.cmml">​</mo><msub id="S4.Ex1.m2.3.3.1.1.1" xref="S4.Ex1.m2.3.3.1.1.1.cmml"><mrow id="S4.Ex1.m2.3.3.1.1.1.1.1" xref="S4.Ex1.m2.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m2.3.3.1.1.1.1.1.2" xref="S4.Ex1.m2.3.3.1.1.1.1.2.1.cmml">[</mo><msub id="S4.Ex1.m2.3.3.1.1.1.1.1.1" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1.cmml"><mn id="S4.Ex1.m2.3.3.1.1.1.1.1.1.2" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1.2.cmml">𝟙</mn><mi id="S4.Ex1.m2.3.3.1.1.1.1.1.1.3" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="S4.Ex1.m2.3.3.1.1.1.1.1.3" xref="S4.Ex1.m2.3.3.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S4.Ex1.m2.3.3.1.1.1.3" xref="S4.Ex1.m2.3.3.1.1.1.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m2.3b"><apply id="S4.Ex1.m2.3.3.cmml" xref="S4.Ex1.m2.3.3"><apply id="S4.Ex1.m2.3.3.2.cmml" xref="S4.Ex1.m2.3.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.2.1.cmml" xref="S4.Ex1.m2.3.3.2">subscript</csymbol><sum id="S4.Ex1.m2.3.3.2.2.cmml" xref="S4.Ex1.m2.3.3.2.2"></sum><apply id="S4.Ex1.m2.3.3.2.3.cmml" xref="S4.Ex1.m2.3.3.2.3"><in id="S4.Ex1.m2.3.3.2.3.1.cmml" xref="S4.Ex1.m2.3.3.2.3.1"></in><ci id="S4.Ex1.m2.3.3.2.3.2.cmml" xref="S4.Ex1.m2.3.3.2.3.2">𝑟</ci><apply id="S4.Ex1.m2.3.3.2.3.3.cmml" xref="S4.Ex1.m2.3.3.2.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.2.3.3.1.cmml" xref="S4.Ex1.m2.3.3.2.3.3">superscript</csymbol><ci id="S4.Ex1.m2.3.3.2.3.3.2.cmml" xref="S4.Ex1.m2.3.3.2.3.3.2">𝑅</ci><plus id="S4.Ex1.m2.3.3.2.3.3.3.cmml" xref="S4.Ex1.m2.3.3.2.3.3.3"></plus></apply></apply></apply><apply id="S4.Ex1.m2.3.3.1.cmml" xref="S4.Ex1.m2.3.3.1"><apply id="S4.Ex1.m2.3.3.1.2.cmml" xref="S4.Ex1.m2.3.3.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.2.1.cmml" xref="S4.Ex1.m2.3.3.1.2">superscript</csymbol><apply id="S4.Ex1.m2.3.3.1.2.2.cmml" xref="S4.Ex1.m2.3.3.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.2.2.1.cmml" xref="S4.Ex1.m2.3.3.1.2">subscript</csymbol><sum id="S4.Ex1.m2.3.3.1.2.2.2.cmml" xref="S4.Ex1.m2.3.3.1.2.2.2"></sum><apply id="S4.Ex1.m2.3.3.1.2.2.3.cmml" xref="S4.Ex1.m2.3.3.1.2.2.3"><eq id="S4.Ex1.m2.3.3.1.2.2.3.1.cmml" xref="S4.Ex1.m2.3.3.1.2.2.3.1"></eq><ci id="S4.Ex1.m2.3.3.1.2.2.3.2.cmml" xref="S4.Ex1.m2.3.3.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.Ex1.m2.3.3.1.2.2.3.3.cmml" xref="S4.Ex1.m2.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex1.m2.3.3.1.2.3.cmml" xref="S4.Ex1.m2.3.3.1.2.3">𝐾</ci></apply><apply id="S4.Ex1.m2.3.3.1.1.cmml" xref="S4.Ex1.m2.3.3.1.1"><times id="S4.Ex1.m2.3.3.1.1.2.cmml" xref="S4.Ex1.m2.3.3.1.1.2"></times><apply id="S4.Ex1.m2.3.3.1.1.3.cmml" xref="S4.Ex1.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.1.3.1.cmml" xref="S4.Ex1.m2.3.3.1.1.3">subscript</csymbol><ci id="S4.Ex1.m2.3.3.1.1.3.2.cmml" xref="S4.Ex1.m2.3.3.1.1.3.2">𝑦</ci><ci id="S4.Ex1.m2.3.3.1.1.3.3a.cmml" xref="S4.Ex1.m2.3.3.1.1.3.3"><mtext mathsize="70%" id="S4.Ex1.m2.3.3.1.1.3.3.cmml" xref="S4.Ex1.m2.3.3.1.1.3.3">gg</mtext></ci></apply><interval closure="closed" id="S4.Ex1.m2.3.3.1.1.4.1.cmml" xref="S4.Ex1.m2.3.3.1.1.4.2"><ci id="S4.Ex1.m2.1.1.cmml" xref="S4.Ex1.m2.1.1">𝑟</ci><ci id="S4.Ex1.m2.2.2.cmml" xref="S4.Ex1.m2.2.2">𝑘</ci></interval><apply id="S4.Ex1.m2.3.3.1.1.5.cmml" xref="S4.Ex1.m2.3.3.1.1.5"><log id="S4.Ex1.m2.3.3.1.1.5.1.cmml" xref="S4.Ex1.m2.3.3.1.1.5.1"></log><apply id="S4.Ex1.m2.3.3.1.1.5.2.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.1.5.2.1.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2">subscript</csymbol><apply id="S4.Ex1.m2.3.3.1.1.5.2.2.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2.2"><ci id="S4.Ex1.m2.3.3.1.1.5.2.2.1.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2.2.1">^</ci><ci id="S4.Ex1.m2.3.3.1.1.5.2.2.2.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2.2.2">𝑦</ci></apply><ci id="S4.Ex1.m2.3.3.1.1.5.2.3a.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2.3"><mtext mathsize="70%" id="S4.Ex1.m2.3.3.1.1.5.2.3.cmml" xref="S4.Ex1.m2.3.3.1.1.5.2.3">gg</mtext></ci></apply></apply><apply id="S4.Ex1.m2.3.3.1.1.1.cmml" xref="S4.Ex1.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.1.1.2.cmml" xref="S4.Ex1.m2.3.3.1.1.1">subscript</csymbol><apply id="S4.Ex1.m2.3.3.1.1.1.1.2.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m2.3.3.1.1.1.1.2.1.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m2.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1">subscript</csymbol><cn type="integer" id="S4.Ex1.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1.2">1</cn><ci id="S4.Ex1.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.3.3.1.1.1.1.1.1.3">𝑟</ci></apply></apply><ci id="S4.Ex1.m2.3.3.1.1.1.3.cmml" xref="S4.Ex1.m2.3.3.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m2.3c">\displaystyle\sum_{r\in R^{+}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{y}_{\text{gg}}[\mathbb{1}_{r}]_{k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.2" class="ltx_p">where <math id="S4.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbb{1}_{r}" display="inline"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><msub id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml"><mn id="S4.SS1.SSS2.p3.1.m1.1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml">𝟙</mn><mi id="S4.SS1.SSS2.p3.1.m1.1.1.3" xref="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1">subscript</csymbol><cn type="integer" id="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2">1</cn><ci id="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">\mathbb{1}_{r}</annotation></semantics></math> represents an indicator (Kronecker delta) function selecting the voxels corresponding spatially to region <math id="S4.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.SSS2.p3.2.m2.1a"><mi id="S4.SS1.SSS2.p3.2.m2.1.1" xref="S4.SS1.SSS2.p3.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.2.m2.1b"><ci id="S4.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.2.m2.1c">r</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Regional Prediction</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Unfortunately, strong voxel-wise supervision signals are not available for all histopathology data types, such as biopsy data. This is because the biopsy core only targets one, small portion of the prostate gland, in either a lesion or a regular tissue. For targeted lesion biopsies, we make the assumption that the biopsy sample is representative of a <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">homogeneous</span> cancer profile within a tumor that is reasonably localized in the MRI coordinate system, enabling use of the aforementioned strong classification objective, <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{strong}}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3a.cmml">strong</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">strong</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{L}_{\text{strong}}</annotation></semantics></math>. Systematic biopsies, however, are neither localized nor representative of the cancer profile in <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">heterogeneous</span> tissue throughout the gland, preventing the use of such strong voxel-wise objectives.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.3" class="ltx_p">To this end, we utilize two weak supervision objectives in regions <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="R^{*}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">R</mi><mo id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑅</ci><times id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">R^{*}</annotation></semantics></math> where the supervision signal in <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">z</annotation></semantics></math> is <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\geq 1" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"></mi><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">≥</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><geq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></geq><csymbol cd="latexml" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">absent</csymbol><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\geq 1</annotation></semantics></math>:</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Histogram Suppression</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.5" class="ltx_p">Rather than regressing by value with a voxel-wise classification loss, we regress <span id="S4.SS2.SSS1.p1.5.1" class="ltx_text ltx_font_italic">by distribution</span> by computing and penalizing a histogram of predicted voxel-wise grade groups for each region of interest. This can be achieved naturally (maintaining model differentiability) by selecting <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">K</annotation></semantics></math>-dimensional voxels of <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\hat{y}_{\text{gg}}" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><msub id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.1.2.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.2.cmml">y</mi><mo id="S4.SS2.SSS1.p1.2.m2.1.1.2.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mtext id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3a.cmml">gg</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S4.SS2.SSS1.p1.2.m2.1.1.3a.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">gg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">\hat{y}_{\text{gg}}</annotation></semantics></math> using the corresponding region masks in <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">y</annotation></semantics></math>, and computing their <math id="S4.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mi id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><ci id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">K</annotation></semantics></math>-dimensional average, resulting in a set of approximate histograms <math id="S4.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\hat{h}\in\mathbb{R}^{R^{*}\times K}" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mrow id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml"><mover accent="true" id="S4.SS2.SSS1.p1.5.m5.1.1.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.2.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.2.cmml">h</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.2.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS2.SSS1.p1.5.m5.1.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p1.5.m5.1.1.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p1.5.m5.1.1.3.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.cmml"><msup id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.2.cmml">R</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.3.cmml">∗</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><apply id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1"><in id="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.1"></in><apply id="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2"><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.1">^</ci><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.2">ℎ</ci></apply><apply id="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3"><times id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1"></times><apply id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2">superscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.2">𝑅</ci><times id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.3"></times></apply><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">\hat{h}\in\mathbb{R}^{R^{*}\times K}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">For regions <math id="S4.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="R^{\alpha}" display="inline"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><msup id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml">R</mi><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml">α</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.2">𝑅</ci><ci id="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">R^{\alpha}</annotation></semantics></math> where the supervision signal is 1 (individual lesions), we assume the biopsy core represents a homogeneous cancer profile, so we penalize non-zero histogram bins that don’t correspond to the groundtruth grade group:</p>
<table id="Sx1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex2.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{hist-strong}}(z,y_{\text{gg}},\hat{h})=\frac{1}{|R^{\alpha}|}" display="inline"><semantics id="S4.Ex2.m1.4a"><mrow id="S4.Ex2.m1.4.4" xref="S4.Ex2.m1.4.4.cmml"><mrow id="S4.Ex2.m1.4.4.1" xref="S4.Ex2.m1.4.4.1.cmml"><msub id="S4.Ex2.m1.4.4.1.3" xref="S4.Ex2.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.4.4.1.3.2" xref="S4.Ex2.m1.4.4.1.3.2.cmml">ℒ</mi><mtext id="S4.Ex2.m1.4.4.1.3.3" xref="S4.Ex2.m1.4.4.1.3.3a.cmml">hist-strong</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.4.4.1.2" xref="S4.Ex2.m1.4.4.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.4.4.1.1.1" xref="S4.Ex2.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.4.4.1.1.1.2" xref="S4.Ex2.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml">z</mi><mo id="S4.Ex2.m1.4.4.1.1.1.3" xref="S4.Ex2.m1.4.4.1.1.2.cmml">,</mo><msub id="S4.Ex2.m1.4.4.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.1.cmml"><mi id="S4.Ex2.m1.4.4.1.1.1.1.2" xref="S4.Ex2.m1.4.4.1.1.1.1.2.cmml">y</mi><mtext id="S4.Ex2.m1.4.4.1.1.1.1.3" xref="S4.Ex2.m1.4.4.1.1.1.1.3a.cmml">gg</mtext></msub><mo id="S4.Ex2.m1.4.4.1.1.1.4" xref="S4.Ex2.m1.4.4.1.1.2.cmml">,</mo><mover accent="true" id="S4.Ex2.m1.3.3" xref="S4.Ex2.m1.3.3.cmml"><mi id="S4.Ex2.m1.3.3.2" xref="S4.Ex2.m1.3.3.2.cmml">h</mi><mo id="S4.Ex2.m1.3.3.1" xref="S4.Ex2.m1.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S4.Ex2.m1.4.4.1.1.1.5" xref="S4.Ex2.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.2" xref="S4.Ex2.m1.4.4.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml"><mfrac id="S4.Ex2.m1.1.1a" xref="S4.Ex2.m1.1.1.cmml"><mn id="S4.Ex2.m1.1.1.3" xref="S4.Ex2.m1.1.1.3.cmml">1</mn><mrow id="S4.Ex2.m1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.Ex2.m1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m1.1.1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.1.1.2.cmml">R</mi><mi id="S4.Ex2.m1.1.1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.1.1.3.cmml">α</mi></msup><mo stretchy="false" id="S4.Ex2.m1.1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.4b"><apply id="S4.Ex2.m1.4.4.cmml" xref="S4.Ex2.m1.4.4"><eq id="S4.Ex2.m1.4.4.2.cmml" xref="S4.Ex2.m1.4.4.2"></eq><apply id="S4.Ex2.m1.4.4.1.cmml" xref="S4.Ex2.m1.4.4.1"><times id="S4.Ex2.m1.4.4.1.2.cmml" xref="S4.Ex2.m1.4.4.1.2"></times><apply id="S4.Ex2.m1.4.4.1.3.cmml" xref="S4.Ex2.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.1.3.1.cmml" xref="S4.Ex2.m1.4.4.1.3">subscript</csymbol><ci id="S4.Ex2.m1.4.4.1.3.2.cmml" xref="S4.Ex2.m1.4.4.1.3.2">ℒ</ci><ci id="S4.Ex2.m1.4.4.1.3.3a.cmml" xref="S4.Ex2.m1.4.4.1.3.3"><mtext mathsize="70%" id="S4.Ex2.m1.4.4.1.3.3.cmml" xref="S4.Ex2.m1.4.4.1.3.3">hist-strong</mtext></ci></apply><vector id="S4.Ex2.m1.4.4.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1"><ci id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2">𝑧</ci><apply id="S4.Ex2.m1.4.4.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.2">𝑦</ci><ci id="S4.Ex2.m1.4.4.1.1.1.1.3a.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.3"><mtext mathsize="70%" id="S4.Ex2.m1.4.4.1.1.1.1.3.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.3">gg</mtext></ci></apply><apply id="S4.Ex2.m1.3.3.cmml" xref="S4.Ex2.m1.3.3"><ci id="S4.Ex2.m1.3.3.1.cmml" xref="S4.Ex2.m1.3.3.1">^</ci><ci id="S4.Ex2.m1.3.3.2.cmml" xref="S4.Ex2.m1.3.3.2">ℎ</ci></apply></vector></apply><apply id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1"><divide id="S4.Ex2.m1.1.1.2.cmml" xref="S4.Ex2.m1.1.1"></divide><cn type="integer" id="S4.Ex2.m1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.3">1</cn><apply id="S4.Ex2.m1.1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.1.1"><abs id="S4.Ex2.m1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.1.1.1.1.2"></abs><apply id="S4.Ex2.m1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex2.m1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.1.1.1.2">𝑅</ci><ci id="S4.Ex2.m1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.1.1.1.3">𝛼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.4c">\displaystyle\mathcal{L}_{\text{hist-strong}}(z,y_{\text{gg}},\hat{h})=\frac{1}{|R^{\alpha}|}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex2.m2.4" class="ltx_Math" alttext="\displaystyle\sum_{r\in R^{\alpha}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{h}[r,k]}" display="inline"><semantics id="S4.Ex2.m2.4a"><mrow id="S4.Ex2.m2.4.5" xref="S4.Ex2.m2.4.5.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.4.5.1" xref="S4.Ex2.m2.4.5.1.cmml"><munder id="S4.Ex2.m2.4.5.1a" xref="S4.Ex2.m2.4.5.1.cmml"><mo movablelimits="false" id="S4.Ex2.m2.4.5.1.2" xref="S4.Ex2.m2.4.5.1.2.cmml">∑</mo><mrow id="S4.Ex2.m2.4.5.1.3" xref="S4.Ex2.m2.4.5.1.3.cmml"><mi id="S4.Ex2.m2.4.5.1.3.2" xref="S4.Ex2.m2.4.5.1.3.2.cmml">r</mi><mo id="S4.Ex2.m2.4.5.1.3.1" xref="S4.Ex2.m2.4.5.1.3.1.cmml">∈</mo><msup id="S4.Ex2.m2.4.5.1.3.3" xref="S4.Ex2.m2.4.5.1.3.3.cmml"><mi id="S4.Ex2.m2.4.5.1.3.3.2" xref="S4.Ex2.m2.4.5.1.3.3.2.cmml">R</mi><mi id="S4.Ex2.m2.4.5.1.3.3.3" xref="S4.Ex2.m2.4.5.1.3.3.3.cmml">α</mi></msup></mrow></munder></mstyle><mrow id="S4.Ex2.m2.4.5.2" xref="S4.Ex2.m2.4.5.2.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.4.5.2.1" xref="S4.Ex2.m2.4.5.2.1.cmml"><munderover id="S4.Ex2.m2.4.5.2.1a" xref="S4.Ex2.m2.4.5.2.1.cmml"><mo movablelimits="false" id="S4.Ex2.m2.4.5.2.1.2.2" xref="S4.Ex2.m2.4.5.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex2.m2.4.5.2.1.2.3" xref="S4.Ex2.m2.4.5.2.1.2.3.cmml"><mi id="S4.Ex2.m2.4.5.2.1.2.3.2" xref="S4.Ex2.m2.4.5.2.1.2.3.2.cmml">k</mi><mo id="S4.Ex2.m2.4.5.2.1.2.3.1" xref="S4.Ex2.m2.4.5.2.1.2.3.1.cmml">=</mo><mn id="S4.Ex2.m2.4.5.2.1.2.3.3" xref="S4.Ex2.m2.4.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex2.m2.4.5.2.1.3" xref="S4.Ex2.m2.4.5.2.1.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex2.m2.4.5.2.2" xref="S4.Ex2.m2.4.5.2.2.cmml"><msub id="S4.Ex2.m2.4.5.2.2.2" xref="S4.Ex2.m2.4.5.2.2.2.cmml"><mi id="S4.Ex2.m2.4.5.2.2.2.2" xref="S4.Ex2.m2.4.5.2.2.2.2.cmml">y</mi><mtext id="S4.Ex2.m2.4.5.2.2.2.3" xref="S4.Ex2.m2.4.5.2.2.2.3a.cmml">gg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex2.m2.4.5.2.2.1" xref="S4.Ex2.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex2.m2.4.5.2.2.3.2" xref="S4.Ex2.m2.4.5.2.2.3.1.cmml"><mo stretchy="false" id="S4.Ex2.m2.4.5.2.2.3.2.1" xref="S4.Ex2.m2.4.5.2.2.3.1.cmml">[</mo><mi id="S4.Ex2.m2.1.1" xref="S4.Ex2.m2.1.1.cmml">r</mi><mo id="S4.Ex2.m2.4.5.2.2.3.2.2" xref="S4.Ex2.m2.4.5.2.2.3.1.cmml">,</mo><mi id="S4.Ex2.m2.2.2" xref="S4.Ex2.m2.2.2.cmml">k</mi><mo stretchy="false" id="S4.Ex2.m2.4.5.2.2.3.2.3" xref="S4.Ex2.m2.4.5.2.2.3.1.cmml">]</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.Ex2.m2.4.5.2.2.1a" xref="S4.Ex2.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex2.m2.4.5.2.2.4" xref="S4.Ex2.m2.4.5.2.2.4.cmml"><mi id="S4.Ex2.m2.4.5.2.2.4.1" xref="S4.Ex2.m2.4.5.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.Ex2.m2.4.5.2.2.4a" xref="S4.Ex2.m2.4.5.2.2.4.cmml">⁡</mo><mover accent="true" id="S4.Ex2.m2.4.5.2.2.4.2" xref="S4.Ex2.m2.4.5.2.2.4.2.cmml"><mi id="S4.Ex2.m2.4.5.2.2.4.2.2" xref="S4.Ex2.m2.4.5.2.2.4.2.2.cmml">h</mi><mo id="S4.Ex2.m2.4.5.2.2.4.2.1" xref="S4.Ex2.m2.4.5.2.2.4.2.1.cmml">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="S4.Ex2.m2.4.5.2.2.1b" xref="S4.Ex2.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex2.m2.4.5.2.2.5.2" xref="S4.Ex2.m2.4.5.2.2.5.1.cmml"><mo stretchy="false" id="S4.Ex2.m2.4.5.2.2.5.2.1" xref="S4.Ex2.m2.4.5.2.2.5.1.cmml">[</mo><mi id="S4.Ex2.m2.3.3" xref="S4.Ex2.m2.3.3.cmml">r</mi><mo id="S4.Ex2.m2.4.5.2.2.5.2.2" xref="S4.Ex2.m2.4.5.2.2.5.1.cmml">,</mo><mi id="S4.Ex2.m2.4.4" xref="S4.Ex2.m2.4.4.cmml">k</mi><mo stretchy="false" id="S4.Ex2.m2.4.5.2.2.5.2.3" xref="S4.Ex2.m2.4.5.2.2.5.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.4b"><apply id="S4.Ex2.m2.4.5.cmml" xref="S4.Ex2.m2.4.5"><apply id="S4.Ex2.m2.4.5.1.cmml" xref="S4.Ex2.m2.4.5.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.1.1.cmml" xref="S4.Ex2.m2.4.5.1">subscript</csymbol><sum id="S4.Ex2.m2.4.5.1.2.cmml" xref="S4.Ex2.m2.4.5.1.2"></sum><apply id="S4.Ex2.m2.4.5.1.3.cmml" xref="S4.Ex2.m2.4.5.1.3"><in id="S4.Ex2.m2.4.5.1.3.1.cmml" xref="S4.Ex2.m2.4.5.1.3.1"></in><ci id="S4.Ex2.m2.4.5.1.3.2.cmml" xref="S4.Ex2.m2.4.5.1.3.2">𝑟</ci><apply id="S4.Ex2.m2.4.5.1.3.3.cmml" xref="S4.Ex2.m2.4.5.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.1.3.3.1.cmml" xref="S4.Ex2.m2.4.5.1.3.3">superscript</csymbol><ci id="S4.Ex2.m2.4.5.1.3.3.2.cmml" xref="S4.Ex2.m2.4.5.1.3.3.2">𝑅</ci><ci id="S4.Ex2.m2.4.5.1.3.3.3.cmml" xref="S4.Ex2.m2.4.5.1.3.3.3">𝛼</ci></apply></apply></apply><apply id="S4.Ex2.m2.4.5.2.cmml" xref="S4.Ex2.m2.4.5.2"><apply id="S4.Ex2.m2.4.5.2.1.cmml" xref="S4.Ex2.m2.4.5.2.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.2.1.1.cmml" xref="S4.Ex2.m2.4.5.2.1">superscript</csymbol><apply id="S4.Ex2.m2.4.5.2.1.2.cmml" xref="S4.Ex2.m2.4.5.2.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.2.1.2.1.cmml" xref="S4.Ex2.m2.4.5.2.1">subscript</csymbol><sum id="S4.Ex2.m2.4.5.2.1.2.2.cmml" xref="S4.Ex2.m2.4.5.2.1.2.2"></sum><apply id="S4.Ex2.m2.4.5.2.1.2.3.cmml" xref="S4.Ex2.m2.4.5.2.1.2.3"><eq id="S4.Ex2.m2.4.5.2.1.2.3.1.cmml" xref="S4.Ex2.m2.4.5.2.1.2.3.1"></eq><ci id="S4.Ex2.m2.4.5.2.1.2.3.2.cmml" xref="S4.Ex2.m2.4.5.2.1.2.3.2">𝑘</ci><cn type="integer" id="S4.Ex2.m2.4.5.2.1.2.3.3.cmml" xref="S4.Ex2.m2.4.5.2.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m2.4.5.2.1.3.cmml" xref="S4.Ex2.m2.4.5.2.1.3">𝐾</ci></apply><apply id="S4.Ex2.m2.4.5.2.2.cmml" xref="S4.Ex2.m2.4.5.2.2"><times id="S4.Ex2.m2.4.5.2.2.1.cmml" xref="S4.Ex2.m2.4.5.2.2.1"></times><apply id="S4.Ex2.m2.4.5.2.2.2.cmml" xref="S4.Ex2.m2.4.5.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.2.2.2.1.cmml" xref="S4.Ex2.m2.4.5.2.2.2">subscript</csymbol><ci id="S4.Ex2.m2.4.5.2.2.2.2.cmml" xref="S4.Ex2.m2.4.5.2.2.2.2">𝑦</ci><ci id="S4.Ex2.m2.4.5.2.2.2.3a.cmml" xref="S4.Ex2.m2.4.5.2.2.2.3"><mtext mathsize="70%" id="S4.Ex2.m2.4.5.2.2.2.3.cmml" xref="S4.Ex2.m2.4.5.2.2.2.3">gg</mtext></ci></apply><interval closure="closed" id="S4.Ex2.m2.4.5.2.2.3.1.cmml" xref="S4.Ex2.m2.4.5.2.2.3.2"><ci id="S4.Ex2.m2.1.1.cmml" xref="S4.Ex2.m2.1.1">𝑟</ci><ci id="S4.Ex2.m2.2.2.cmml" xref="S4.Ex2.m2.2.2">𝑘</ci></interval><apply id="S4.Ex2.m2.4.5.2.2.4.cmml" xref="S4.Ex2.m2.4.5.2.2.4"><log id="S4.Ex2.m2.4.5.2.2.4.1.cmml" xref="S4.Ex2.m2.4.5.2.2.4.1"></log><apply id="S4.Ex2.m2.4.5.2.2.4.2.cmml" xref="S4.Ex2.m2.4.5.2.2.4.2"><ci id="S4.Ex2.m2.4.5.2.2.4.2.1.cmml" xref="S4.Ex2.m2.4.5.2.2.4.2.1">^</ci><ci id="S4.Ex2.m2.4.5.2.2.4.2.2.cmml" xref="S4.Ex2.m2.4.5.2.2.4.2.2">ℎ</ci></apply></apply><interval closure="closed" id="S4.Ex2.m2.4.5.2.2.5.1.cmml" xref="S4.Ex2.m2.4.5.2.2.5.2"><ci id="S4.Ex2.m2.3.3.cmml" xref="S4.Ex2.m2.3.3">𝑟</ci><ci id="S4.Ex2.m2.4.4.cmml" xref="S4.Ex2.m2.4.4">𝑘</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.4c">\displaystyle\sum_{r\in R^{\alpha}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{h}[r,k]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para">
<p id="S4.SS2.SSS1.p3.2" class="ltx_p">For regions <math id="S4.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="R^{\beta}" display="inline"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><msup id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.1.m1.1.1.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.2.cmml">R</mi><mi id="S4.SS2.SSS1.p3.1.m1.1.1.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml">β</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><apply id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.2">𝑅</ci><ci id="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">R^{\beta}</annotation></semantics></math> where the supervision signal is <math id="S4.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="&gt;1" display="inline"><semantics id="S4.SS2.SSS1.p3.2.m2.1a"><mrow id="S4.SS2.SSS1.p3.2.m2.1.1" xref="S4.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p3.2.m2.1.1.2" xref="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml"></mi><mo id="S4.SS2.SSS1.p3.2.m2.1.1.1" xref="S4.SS2.SSS1.p3.2.m2.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.SSS1.p3.2.m2.1.1.3" xref="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.2.m2.1b"><apply id="S4.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1"><gt id="S4.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.1"></gt><csymbol cd="latexml" id="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.2">absent</csymbol><cn type="integer" id="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.2.m2.1c">&gt;1</annotation></semantics></math> (sextants, or exams where only the highest grade is known), we assume the biopsy core represents the highest cancer in a heterogeneous tissue, so we only penalize non-zero histogram bins that represent grade groups <span id="S4.SS2.SSS1.p3.2.1" class="ltx_text ltx_font_italic">higher</span> than the groundtruth regression grade group:</p>
<table id="Sx1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex3.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{hist-high}}(z,y_{\text{gg}},\hat{h})=\frac{1}{|R^{\beta}|}" display="inline"><semantics id="S4.Ex3.m1.4a"><mrow id="S4.Ex3.m1.4.4" xref="S4.Ex3.m1.4.4.cmml"><mrow id="S4.Ex3.m1.4.4.1" xref="S4.Ex3.m1.4.4.1.cmml"><msub id="S4.Ex3.m1.4.4.1.3" xref="S4.Ex3.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.4.4.1.3.2" xref="S4.Ex3.m1.4.4.1.3.2.cmml">ℒ</mi><mtext id="S4.Ex3.m1.4.4.1.3.3" xref="S4.Ex3.m1.4.4.1.3.3a.cmml">hist-high</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.4.4.1.2" xref="S4.Ex3.m1.4.4.1.2.cmml">​</mo><mrow id="S4.Ex3.m1.4.4.1.1.1" xref="S4.Ex3.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.Ex3.m1.4.4.1.1.1.2" xref="S4.Ex3.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.Ex3.m1.2.2" xref="S4.Ex3.m1.2.2.cmml">z</mi><mo id="S4.Ex3.m1.4.4.1.1.1.3" xref="S4.Ex3.m1.4.4.1.1.2.cmml">,</mo><msub id="S4.Ex3.m1.4.4.1.1.1.1" xref="S4.Ex3.m1.4.4.1.1.1.1.cmml"><mi id="S4.Ex3.m1.4.4.1.1.1.1.2" xref="S4.Ex3.m1.4.4.1.1.1.1.2.cmml">y</mi><mtext id="S4.Ex3.m1.4.4.1.1.1.1.3" xref="S4.Ex3.m1.4.4.1.1.1.1.3a.cmml">gg</mtext></msub><mo id="S4.Ex3.m1.4.4.1.1.1.4" xref="S4.Ex3.m1.4.4.1.1.2.cmml">,</mo><mover accent="true" id="S4.Ex3.m1.3.3" xref="S4.Ex3.m1.3.3.cmml"><mi id="S4.Ex3.m1.3.3.2" xref="S4.Ex3.m1.3.3.2.cmml">h</mi><mo id="S4.Ex3.m1.3.3.1" xref="S4.Ex3.m1.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S4.Ex3.m1.4.4.1.1.1.5" xref="S4.Ex3.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.4.4.2" xref="S4.Ex3.m1.4.4.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1.cmml"><mfrac id="S4.Ex3.m1.1.1a" xref="S4.Ex3.m1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.3" xref="S4.Ex3.m1.1.1.3.cmml">1</mn><mrow id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex3.m1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.Ex3.m1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.1.1.2.cmml">R</mi><mi id="S4.Ex3.m1.1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.1.1.3.cmml">β</mi></msup><mo stretchy="false" id="S4.Ex3.m1.1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.4b"><apply id="S4.Ex3.m1.4.4.cmml" xref="S4.Ex3.m1.4.4"><eq id="S4.Ex3.m1.4.4.2.cmml" xref="S4.Ex3.m1.4.4.2"></eq><apply id="S4.Ex3.m1.4.4.1.cmml" xref="S4.Ex3.m1.4.4.1"><times id="S4.Ex3.m1.4.4.1.2.cmml" xref="S4.Ex3.m1.4.4.1.2"></times><apply id="S4.Ex3.m1.4.4.1.3.cmml" xref="S4.Ex3.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.4.4.1.3.1.cmml" xref="S4.Ex3.m1.4.4.1.3">subscript</csymbol><ci id="S4.Ex3.m1.4.4.1.3.2.cmml" xref="S4.Ex3.m1.4.4.1.3.2">ℒ</ci><ci id="S4.Ex3.m1.4.4.1.3.3a.cmml" xref="S4.Ex3.m1.4.4.1.3.3"><mtext mathsize="70%" id="S4.Ex3.m1.4.4.1.3.3.cmml" xref="S4.Ex3.m1.4.4.1.3.3">hist-high</mtext></ci></apply><vector id="S4.Ex3.m1.4.4.1.1.2.cmml" xref="S4.Ex3.m1.4.4.1.1.1"><ci id="S4.Ex3.m1.2.2.cmml" xref="S4.Ex3.m1.2.2">𝑧</ci><apply id="S4.Ex3.m1.4.4.1.1.1.1.cmml" xref="S4.Ex3.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex3.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex3.m1.4.4.1.1.1.1.2">𝑦</ci><ci id="S4.Ex3.m1.4.4.1.1.1.1.3a.cmml" xref="S4.Ex3.m1.4.4.1.1.1.1.3"><mtext mathsize="70%" id="S4.Ex3.m1.4.4.1.1.1.1.3.cmml" xref="S4.Ex3.m1.4.4.1.1.1.1.3">gg</mtext></ci></apply><apply id="S4.Ex3.m1.3.3.cmml" xref="S4.Ex3.m1.3.3"><ci id="S4.Ex3.m1.3.3.1.cmml" xref="S4.Ex3.m1.3.3.1">^</ci><ci id="S4.Ex3.m1.3.3.2.cmml" xref="S4.Ex3.m1.3.3.2">ℎ</ci></apply></vector></apply><apply id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1"><divide id="S4.Ex3.m1.1.1.2.cmml" xref="S4.Ex3.m1.1.1"></divide><cn type="integer" id="S4.Ex3.m1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.3">1</cn><apply id="S4.Ex3.m1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1"><abs id="S4.Ex3.m1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.1.1.1.1.2"></abs><apply id="S4.Ex3.m1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex3.m1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.1.1.1.2">𝑅</ci><ci id="S4.Ex3.m1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.4c">\displaystyle\mathcal{L}_{\text{hist-high}}(z,y_{\text{gg}},\hat{h})=\frac{1}{|R^{\beta}|}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex3.m2.7" class="ltx_Math" alttext="\displaystyle\sum_{r\in R^{\beta}}\quad\sum_{\mathclap{\begin{subarray}{c}k\;&gt;\\
\underset{k}{\mathrm{argmax}}\;y_{\text{gg}}[r]\end{subarray}}}^{K}y_{\text{gg}}[r,k]\log{\hat{h}[r,k]}" display="inline"><semantics id="S4.Ex3.m2.7a"><mrow id="S4.Ex3.m2.7.7.2" xref="S4.Ex3.m2.7.7.3.cmml"><mstyle displaystyle="true" id="S4.Ex3.m2.6.6.1.1" xref="S4.Ex3.m2.6.6.1.1.cmml"><munder id="S4.Ex3.m2.6.6.1.1a" xref="S4.Ex3.m2.6.6.1.1.cmml"><mo movablelimits="false" id="S4.Ex3.m2.6.6.1.1.2" xref="S4.Ex3.m2.6.6.1.1.2.cmml">∑</mo><mrow id="S4.Ex3.m2.6.6.1.1.3" xref="S4.Ex3.m2.6.6.1.1.3.cmml"><mi id="S4.Ex3.m2.6.6.1.1.3.2" xref="S4.Ex3.m2.6.6.1.1.3.2.cmml">r</mi><mo id="S4.Ex3.m2.6.6.1.1.3.1" xref="S4.Ex3.m2.6.6.1.1.3.1.cmml">∈</mo><msup id="S4.Ex3.m2.6.6.1.1.3.3" xref="S4.Ex3.m2.6.6.1.1.3.3.cmml"><mi id="S4.Ex3.m2.6.6.1.1.3.3.2" xref="S4.Ex3.m2.6.6.1.1.3.3.2.cmml">R</mi><mi id="S4.Ex3.m2.6.6.1.1.3.3.3" xref="S4.Ex3.m2.6.6.1.1.3.3.3.cmml">β</mi></msup></mrow></munder></mstyle><mspace width="1em" id="S4.Ex3.m2.7.7.2.3" xref="S4.Ex3.m2.7.7.3.cmml"></mspace><mrow id="S4.Ex3.m2.7.7.2.2" xref="S4.Ex3.m2.7.7.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex3.m2.7.7.2.2.1" xref="S4.Ex3.m2.7.7.2.2.1.cmml"><munderover id="S4.Ex3.m2.7.7.2.2.1a" xref="S4.Ex3.m2.7.7.2.2.1.cmml"><mo movablelimits="false" id="S4.Ex3.m2.7.7.2.2.1.2.2" xref="S4.Ex3.m2.7.7.2.2.1.2.2.cmml">∑</mo><mpadded lspace="-21.8pt" width="0pt" id="S4.Ex3.m2.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mtable rowspacing="0pt" id="S4.Ex3.m2.1.1.1.1.1.1.1a" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mtr id="S4.Ex3.m2.1.1.1.1.1.1.1b" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mtd id="S4.Ex3.m2.1.1.1.1.1.1.1c" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.2.cmml">k</mi><mo lspace="0.558em" id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.1.cmml">&gt;</mo><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.3.cmml"></mi></mrow></mtd></mtr><mtr id="S4.Ex3.m2.1.1.1.1.1.1.1d" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mtd id="S4.Ex3.m2.1.1.1.1.1.1.1e" xref="S4.Ex3.m2.1.1.1a.2.cmml"><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><munder accentunder="true" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">argmax</mi><mo id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">𝑘</mo></munder><mo lspace="0.280em" rspace="0em" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">y</mi><mtext id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3a.cmml">gg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml"><mo stretchy="false" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.2.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.1.1.cmml">[</mo><mi id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.2.2" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.1.1.cmml">]</mo></mrow></mrow></mtd></mtr></mtable></mpadded><mi id="S4.Ex3.m2.7.7.2.2.1.3" xref="S4.Ex3.m2.7.7.2.2.1.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex3.m2.7.7.2.2.2" xref="S4.Ex3.m2.7.7.2.2.2.cmml"><msub id="S4.Ex3.m2.7.7.2.2.2.2" xref="S4.Ex3.m2.7.7.2.2.2.2.cmml"><mi id="S4.Ex3.m2.7.7.2.2.2.2.2" xref="S4.Ex3.m2.7.7.2.2.2.2.2.cmml">y</mi><mtext id="S4.Ex3.m2.7.7.2.2.2.2.3" xref="S4.Ex3.m2.7.7.2.2.2.2.3a.cmml">gg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex3.m2.7.7.2.2.2.1" xref="S4.Ex3.m2.7.7.2.2.2.1.cmml">​</mo><mrow id="S4.Ex3.m2.7.7.2.2.2.3.2" xref="S4.Ex3.m2.7.7.2.2.2.3.1.cmml"><mo stretchy="false" id="S4.Ex3.m2.7.7.2.2.2.3.2.1" xref="S4.Ex3.m2.7.7.2.2.2.3.1.cmml">[</mo><mi id="S4.Ex3.m2.2.2" xref="S4.Ex3.m2.2.2.cmml">r</mi><mo id="S4.Ex3.m2.7.7.2.2.2.3.2.2" xref="S4.Ex3.m2.7.7.2.2.2.3.1.cmml">,</mo><mi id="S4.Ex3.m2.3.3" xref="S4.Ex3.m2.3.3.cmml">k</mi><mo stretchy="false" id="S4.Ex3.m2.7.7.2.2.2.3.2.3" xref="S4.Ex3.m2.7.7.2.2.2.3.1.cmml">]</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.Ex3.m2.7.7.2.2.2.1a" xref="S4.Ex3.m2.7.7.2.2.2.1.cmml">​</mo><mrow id="S4.Ex3.m2.7.7.2.2.2.4" xref="S4.Ex3.m2.7.7.2.2.2.4.cmml"><mi id="S4.Ex3.m2.7.7.2.2.2.4.1" xref="S4.Ex3.m2.7.7.2.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.Ex3.m2.7.7.2.2.2.4a" xref="S4.Ex3.m2.7.7.2.2.2.4.cmml">⁡</mo><mover accent="true" id="S4.Ex3.m2.7.7.2.2.2.4.2" xref="S4.Ex3.m2.7.7.2.2.2.4.2.cmml"><mi id="S4.Ex3.m2.7.7.2.2.2.4.2.2" xref="S4.Ex3.m2.7.7.2.2.2.4.2.2.cmml">h</mi><mo id="S4.Ex3.m2.7.7.2.2.2.4.2.1" xref="S4.Ex3.m2.7.7.2.2.2.4.2.1.cmml">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="S4.Ex3.m2.7.7.2.2.2.1b" xref="S4.Ex3.m2.7.7.2.2.2.1.cmml">​</mo><mrow id="S4.Ex3.m2.7.7.2.2.2.5.2" xref="S4.Ex3.m2.7.7.2.2.2.5.1.cmml"><mo stretchy="false" id="S4.Ex3.m2.7.7.2.2.2.5.2.1" xref="S4.Ex3.m2.7.7.2.2.2.5.1.cmml">[</mo><mi id="S4.Ex3.m2.4.4" xref="S4.Ex3.m2.4.4.cmml">r</mi><mo id="S4.Ex3.m2.7.7.2.2.2.5.2.2" xref="S4.Ex3.m2.7.7.2.2.2.5.1.cmml">,</mo><mi id="S4.Ex3.m2.5.5" xref="S4.Ex3.m2.5.5.cmml">k</mi><mo stretchy="false" id="S4.Ex3.m2.7.7.2.2.2.5.2.3" xref="S4.Ex3.m2.7.7.2.2.2.5.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m2.7b"><list id="S4.Ex3.m2.7.7.3.cmml" xref="S4.Ex3.m2.7.7.2"><apply id="S4.Ex3.m2.6.6.1.1.cmml" xref="S4.Ex3.m2.6.6.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m2.6.6.1.1.1.cmml" xref="S4.Ex3.m2.6.6.1.1">subscript</csymbol><sum id="S4.Ex3.m2.6.6.1.1.2.cmml" xref="S4.Ex3.m2.6.6.1.1.2"></sum><apply id="S4.Ex3.m2.6.6.1.1.3.cmml" xref="S4.Ex3.m2.6.6.1.1.3"><in id="S4.Ex3.m2.6.6.1.1.3.1.cmml" xref="S4.Ex3.m2.6.6.1.1.3.1"></in><ci id="S4.Ex3.m2.6.6.1.1.3.2.cmml" xref="S4.Ex3.m2.6.6.1.1.3.2">𝑟</ci><apply id="S4.Ex3.m2.6.6.1.1.3.3.cmml" xref="S4.Ex3.m2.6.6.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex3.m2.6.6.1.1.3.3.1.cmml" xref="S4.Ex3.m2.6.6.1.1.3.3">superscript</csymbol><ci id="S4.Ex3.m2.6.6.1.1.3.3.2.cmml" xref="S4.Ex3.m2.6.6.1.1.3.3.2">𝑅</ci><ci id="S4.Ex3.m2.6.6.1.1.3.3.3.cmml" xref="S4.Ex3.m2.6.6.1.1.3.3.3">𝛽</ci></apply></apply></apply><apply id="S4.Ex3.m2.7.7.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2"><apply id="S4.Ex3.m2.7.7.2.2.1.cmml" xref="S4.Ex3.m2.7.7.2.2.1"><csymbol cd="ambiguous" id="S4.Ex3.m2.7.7.2.2.1.1.cmml" xref="S4.Ex3.m2.7.7.2.2.1">superscript</csymbol><apply id="S4.Ex3.m2.7.7.2.2.1.2.cmml" xref="S4.Ex3.m2.7.7.2.2.1"><csymbol cd="ambiguous" id="S4.Ex3.m2.7.7.2.2.1.2.1.cmml" xref="S4.Ex3.m2.7.7.2.2.1">subscript</csymbol><sum id="S4.Ex3.m2.7.7.2.2.1.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2.1.2.2"></sum><list id="S4.Ex3.m2.1.1.1a.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1"><matrix id="S4.Ex3.m2.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1"><matrixrow id="S4.Ex3.m2.1.1.1.1.1.1.1a.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1"><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1"><gt id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.1"></gt><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.2">𝑘</ci><csymbol cd="latexml" id="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.2.1.1.3">absent</csymbol></apply></matrixrow><matrixrow id="S4.Ex3.m2.1.1.1.1.1.1.1b.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1"><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.1">𝑘</ci><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.3.2">argmax</ci></apply><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3"><mtext mathsize="50%" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.4.3">gg</mtext></ci></apply><apply id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.2"><csymbol cd="latexml" id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.5.2.1">delimited-[]</csymbol><ci id="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.1.1.1.1.1.1.1.1.1.1.1.1">𝑟</ci></apply></apply></matrixrow></matrix></list></apply><ci id="S4.Ex3.m2.7.7.2.2.1.3.cmml" xref="S4.Ex3.m2.7.7.2.2.1.3">𝐾</ci></apply><apply id="S4.Ex3.m2.7.7.2.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2.2"><times id="S4.Ex3.m2.7.7.2.2.2.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.1"></times><apply id="S4.Ex3.m2.7.7.2.2.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m2.7.7.2.2.2.2.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.2">subscript</csymbol><ci id="S4.Ex3.m2.7.7.2.2.2.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2.2.2.2">𝑦</ci><ci id="S4.Ex3.m2.7.7.2.2.2.2.3a.cmml" xref="S4.Ex3.m2.7.7.2.2.2.2.3"><mtext mathsize="70%" id="S4.Ex3.m2.7.7.2.2.2.2.3.cmml" xref="S4.Ex3.m2.7.7.2.2.2.2.3">gg</mtext></ci></apply><interval closure="closed" id="S4.Ex3.m2.7.7.2.2.2.3.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.3.2"><ci id="S4.Ex3.m2.2.2.cmml" xref="S4.Ex3.m2.2.2">𝑟</ci><ci id="S4.Ex3.m2.3.3.cmml" xref="S4.Ex3.m2.3.3">𝑘</ci></interval><apply id="S4.Ex3.m2.7.7.2.2.2.4.cmml" xref="S4.Ex3.m2.7.7.2.2.2.4"><log id="S4.Ex3.m2.7.7.2.2.2.4.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.4.1"></log><apply id="S4.Ex3.m2.7.7.2.2.2.4.2.cmml" xref="S4.Ex3.m2.7.7.2.2.2.4.2"><ci id="S4.Ex3.m2.7.7.2.2.2.4.2.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.4.2.1">^</ci><ci id="S4.Ex3.m2.7.7.2.2.2.4.2.2.cmml" xref="S4.Ex3.m2.7.7.2.2.2.4.2.2">ℎ</ci></apply></apply><interval closure="closed" id="S4.Ex3.m2.7.7.2.2.2.5.1.cmml" xref="S4.Ex3.m2.7.7.2.2.2.5.2"><ci id="S4.Ex3.m2.4.4.cmml" xref="S4.Ex3.m2.4.4">𝑟</ci><ci id="S4.Ex3.m2.5.5.cmml" xref="S4.Ex3.m2.5.5">𝑘</ci></interval></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m2.7c">\displaystyle\sum_{r\in R^{\beta}}\quad\sum_{\mathclap{\begin{subarray}{c}k\;&gt;\\
\underset{k}{\mathrm{argmax}}\;y_{\text{gg}}[r]\end{subarray}}}^{K}y_{\text{gg}}[r,k]\log{\hat{h}[r,k]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS1.p3.4" class="ltx_p">The net effect of these losses <math id="S4.SS2.SSS1.p3.3.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{GGmap-hist}}=\mathcal{L}_{\text{hist-strong}}+\mathcal{L}_{\text{hist-high}}" display="inline"><semantics id="S4.SS2.SSS1.p3.3.m1.1a"><mrow id="S4.SS2.SSS1.p3.3.m1.1.1" xref="S4.SS2.SSS1.p3.3.m1.1.1.cmml"><msub id="S4.SS2.SSS1.p3.3.m1.1.1.2" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.3.m1.1.1.2.2" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS1.p3.3.m1.1.1.2.3" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.3a.cmml">GGmap-hist</mtext></msub><mo id="S4.SS2.SSS1.p3.3.m1.1.1.1" xref="S4.SS2.SSS1.p3.3.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p3.3.m1.1.1.3" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.cmml"><msub id="S4.SS2.SSS1.p3.3.m1.1.1.3.2" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.2" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3a.cmml">hist-strong</mtext></msub><mo id="S4.SS2.SSS1.p3.3.m1.1.1.3.1" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.1.cmml">+</mo><msub id="S4.SS2.SSS1.p3.3.m1.1.1.3.3" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.2" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3a.cmml">hist-high</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.3.m1.1b"><apply id="S4.SS2.SSS1.p3.3.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1"><eq id="S4.SS2.SSS1.p3.3.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.1"></eq><apply id="S4.SS2.SSS1.p3.3.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.3.m1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS1.p3.3.m1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.2">ℒ</ci><ci id="S4.SS2.SSS1.p3.3.m1.1.1.2.3a.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p3.3.m1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.2.3">GGmap-hist</mtext></ci></apply><apply id="S4.SS2.SSS1.p3.3.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3"><plus id="S4.SS2.SSS1.p3.3.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.1"></plus><apply id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.2.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.2">ℒ</ci><ci id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3a.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.2.3">hist-strong</mtext></ci></apply><apply id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.2">ℒ</ci><ci id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3a.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p3.3.m1.1.1.3.3.3">hist-high</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.3.m1.1c">\mathcal{L}_{\text{GGmap-hist}}=\mathcal{L}_{\text{hist-strong}}+\mathcal{L}_{\text{hist-high}}</annotation></semantics></math> is to suppress the proportion of voxels representing grade groups not supported by the histopathology data and its expected uncertainty. Note that when <math id="S4.SS2.SSS1.p3.4.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{hist-high}}=0" display="inline"><semantics id="S4.SS2.SSS1.p3.4.m2.1a"><mrow id="S4.SS2.SSS1.p3.4.m2.1.1" xref="S4.SS2.SSS1.p3.4.m2.1.1.cmml"><msub id="S4.SS2.SSS1.p3.4.m2.1.1.2" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p3.4.m2.1.1.2.2" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.2.cmml">ℒ</mi><mtext id="S4.SS2.SSS1.p3.4.m2.1.1.2.3" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.3a.cmml">hist-high</mtext></msub><mo id="S4.SS2.SSS1.p3.4.m2.1.1.1" xref="S4.SS2.SSS1.p3.4.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p3.4.m2.1.1.3" xref="S4.SS2.SSS1.p3.4.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.4.m2.1b"><apply id="S4.SS2.SSS1.p3.4.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1"><eq id="S4.SS2.SSS1.p3.4.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.1"></eq><apply id="S4.SS2.SSS1.p3.4.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.m2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS1.p3.4.m2.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.2">ℒ</ci><ci id="S4.SS2.SSS1.p3.4.m2.1.1.2.3a.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.SSS1.p3.4.m2.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.2.3">hist-high</mtext></ci></apply><cn type="integer" id="S4.SS2.SSS1.p3.4.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p3.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.4.m2.1c">\mathcal{L}_{\text{hist-high}}=0</annotation></semantics></math>, the histogram bin corresponding to the groundtruth grade group may not have the highest proportion (as expected for heterogeneous tissue).</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Regional Grading</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.3" class="ltx_p">To provide a clear indication of cancer severity in such cases, without relying on manual interpretation of the histograms, we feed the regional histograms <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\hat{h}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mover accent="true" id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">h</mi><mo id="S4.SS2.SSS2.p1.1.m1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.1">^</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">\hat{h}</annotation></semantics></math> into a small dense network with ReLU activation in the final layer. This results in multi-hot encoded vectors <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\hat{z}^{R^{*}\times K}" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msup id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.2.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml">z</mi><mo id="S4.SS2.SSS2.p1.2.m2.1.1.2.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml"><msup id="S4.SS2.SSS2.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.2.cmml">R</mi><mo id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.3.cmml">∗</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p1.2.m2.1.1.3.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.1.cmml">×</mo><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.3.cmml">K</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.2">𝑧</ci></apply><apply id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3"><times id="S4.SS2.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.1"></times><apply id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2">superscript</csymbol><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.2">𝑅</ci><times id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.3"></times></apply><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">\hat{z}^{R^{*}\times K}</annotation></semantics></math>, indicating the presence of various ISUP grade groups in regions <math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="R^{*}" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><msup id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS2.p1.3.m3.1.1.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml">R</mi><mo id="S4.SS2.SSS2.p1.3.m3.1.1.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><apply id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.2">𝑅</ci><times id="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">R^{*}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.2" class="ltx_p">To maintain the clearest interpretation of <math id="S4.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\hat{h}" display="inline"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><mover accent="true" id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml">h</mi><mo id="S4.SS2.SSS2.p2.1.m1.1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><apply id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><ci id="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.1">^</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">\hat{h}</annotation></semantics></math>, in this paper we use a single-layer ReLU-activated network with tunable bias and weight-matrix frozen as identity <math id="S4.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="I_{K}" display="inline"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><msub id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.1.1.2" xref="S4.SS2.SSS2.p2.2.m2.1.1.2.cmml">I</mi><mi id="S4.SS2.SSS2.p2.2.m2.1.1.3" xref="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.1b"><apply id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.2">𝐼</ci><ci id="S4.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.1c">I_{K}</annotation></semantics></math>. The bias, thereby representing a set of “optimal” thresholds for declaring clinically-significant cancer in given region, is optimized through backpropagation, just as other parameters in the fully-convolutional portion of UCNet, via the loss:</p>
<table id="Sx1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex4.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{region-classifier}}(z,y_{\text{gg}},\hat{z})=\frac{1}{|R^{*}|}" display="inline"><semantics id="S4.Ex4.m1.4a"><mrow id="S4.Ex4.m1.4.4" xref="S4.Ex4.m1.4.4.cmml"><mrow id="S4.Ex4.m1.4.4.1" xref="S4.Ex4.m1.4.4.1.cmml"><msub id="S4.Ex4.m1.4.4.1.3" xref="S4.Ex4.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.4.4.1.3.2" xref="S4.Ex4.m1.4.4.1.3.2.cmml">ℒ</mi><mtext id="S4.Ex4.m1.4.4.1.3.3" xref="S4.Ex4.m1.4.4.1.3.3a.cmml">region-classifier</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.4.4.1.2" xref="S4.Ex4.m1.4.4.1.2.cmml">​</mo><mrow id="S4.Ex4.m1.4.4.1.1.1" xref="S4.Ex4.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.Ex4.m1.4.4.1.1.1.2" xref="S4.Ex4.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.Ex4.m1.2.2" xref="S4.Ex4.m1.2.2.cmml">z</mi><mo id="S4.Ex4.m1.4.4.1.1.1.3" xref="S4.Ex4.m1.4.4.1.1.2.cmml">,</mo><msub id="S4.Ex4.m1.4.4.1.1.1.1" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml"><mi id="S4.Ex4.m1.4.4.1.1.1.1.2" xref="S4.Ex4.m1.4.4.1.1.1.1.2.cmml">y</mi><mtext id="S4.Ex4.m1.4.4.1.1.1.1.3" xref="S4.Ex4.m1.4.4.1.1.1.1.3a.cmml">gg</mtext></msub><mo id="S4.Ex4.m1.4.4.1.1.1.4" xref="S4.Ex4.m1.4.4.1.1.2.cmml">,</mo><mover accent="true" id="S4.Ex4.m1.3.3" xref="S4.Ex4.m1.3.3.cmml"><mi id="S4.Ex4.m1.3.3.2" xref="S4.Ex4.m1.3.3.2.cmml">z</mi><mo id="S4.Ex4.m1.3.3.1" xref="S4.Ex4.m1.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S4.Ex4.m1.4.4.1.1.1.5" xref="S4.Ex4.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m1.4.4.2" xref="S4.Ex4.m1.4.4.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex4.m1.1.1" xref="S4.Ex4.m1.1.1.cmml"><mfrac id="S4.Ex4.m1.1.1a" xref="S4.Ex4.m1.1.1.cmml"><mn id="S4.Ex4.m1.1.1.3" xref="S4.Ex4.m1.1.1.3.cmml">1</mn><mrow id="S4.Ex4.m1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.2.1.cmml">|</mo><msup id="S4.Ex4.m1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.2.cmml">R</mi><mo id="S4.Ex4.m1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.4b"><apply id="S4.Ex4.m1.4.4.cmml" xref="S4.Ex4.m1.4.4"><eq id="S4.Ex4.m1.4.4.2.cmml" xref="S4.Ex4.m1.4.4.2"></eq><apply id="S4.Ex4.m1.4.4.1.cmml" xref="S4.Ex4.m1.4.4.1"><times id="S4.Ex4.m1.4.4.1.2.cmml" xref="S4.Ex4.m1.4.4.1.2"></times><apply id="S4.Ex4.m1.4.4.1.3.cmml" xref="S4.Ex4.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.1.3.1.cmml" xref="S4.Ex4.m1.4.4.1.3">subscript</csymbol><ci id="S4.Ex4.m1.4.4.1.3.2.cmml" xref="S4.Ex4.m1.4.4.1.3.2">ℒ</ci><ci id="S4.Ex4.m1.4.4.1.3.3a.cmml" xref="S4.Ex4.m1.4.4.1.3.3"><mtext mathsize="70%" id="S4.Ex4.m1.4.4.1.3.3.cmml" xref="S4.Ex4.m1.4.4.1.3.3">region-classifier</mtext></ci></apply><vector id="S4.Ex4.m1.4.4.1.1.2.cmml" xref="S4.Ex4.m1.4.4.1.1.1"><ci id="S4.Ex4.m1.2.2.cmml" xref="S4.Ex4.m1.2.2">𝑧</ci><apply id="S4.Ex4.m1.4.4.1.1.1.1.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1.2">𝑦</ci><ci id="S4.Ex4.m1.4.4.1.1.1.1.3a.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1.3"><mtext mathsize="70%" id="S4.Ex4.m1.4.4.1.1.1.1.3.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1.3">gg</mtext></ci></apply><apply id="S4.Ex4.m1.3.3.cmml" xref="S4.Ex4.m1.3.3"><ci id="S4.Ex4.m1.3.3.1.cmml" xref="S4.Ex4.m1.3.3.1">^</ci><ci id="S4.Ex4.m1.3.3.2.cmml" xref="S4.Ex4.m1.3.3.2">𝑧</ci></apply></vector></apply><apply id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1"><divide id="S4.Ex4.m1.1.1.2.cmml" xref="S4.Ex4.m1.1.1"></divide><cn type="integer" id="S4.Ex4.m1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.3">1</cn><apply id="S4.Ex4.m1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.1"><abs id="S4.Ex4.m1.1.1.1.2.1.cmml" xref="S4.Ex4.m1.1.1.1.1.2"></abs><apply id="S4.Ex4.m1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex4.m1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.1.1.2">𝑅</ci><times id="S4.Ex4.m1.1.1.1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.1.1.1.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.4c">\displaystyle\mathcal{L}_{\text{region-classifier}}(z,y_{\text{gg}},\hat{z})=\frac{1}{|R^{*}|}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex4.m2.4" class="ltx_Math" alttext="\displaystyle\sum_{r\in R^{*}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{z}[r,k]}" display="inline"><semantics id="S4.Ex4.m2.4a"><mrow id="S4.Ex4.m2.4.5" xref="S4.Ex4.m2.4.5.cmml"><mstyle displaystyle="true" id="S4.Ex4.m2.4.5.1" xref="S4.Ex4.m2.4.5.1.cmml"><munder id="S4.Ex4.m2.4.5.1a" xref="S4.Ex4.m2.4.5.1.cmml"><mo movablelimits="false" id="S4.Ex4.m2.4.5.1.2" xref="S4.Ex4.m2.4.5.1.2.cmml">∑</mo><mrow id="S4.Ex4.m2.4.5.1.3" xref="S4.Ex4.m2.4.5.1.3.cmml"><mi id="S4.Ex4.m2.4.5.1.3.2" xref="S4.Ex4.m2.4.5.1.3.2.cmml">r</mi><mo id="S4.Ex4.m2.4.5.1.3.1" xref="S4.Ex4.m2.4.5.1.3.1.cmml">∈</mo><msup id="S4.Ex4.m2.4.5.1.3.3" xref="S4.Ex4.m2.4.5.1.3.3.cmml"><mi id="S4.Ex4.m2.4.5.1.3.3.2" xref="S4.Ex4.m2.4.5.1.3.3.2.cmml">R</mi><mo id="S4.Ex4.m2.4.5.1.3.3.3" xref="S4.Ex4.m2.4.5.1.3.3.3.cmml">∗</mo></msup></mrow></munder></mstyle><mrow id="S4.Ex4.m2.4.5.2" xref="S4.Ex4.m2.4.5.2.cmml"><mstyle displaystyle="true" id="S4.Ex4.m2.4.5.2.1" xref="S4.Ex4.m2.4.5.2.1.cmml"><munderover id="S4.Ex4.m2.4.5.2.1a" xref="S4.Ex4.m2.4.5.2.1.cmml"><mo movablelimits="false" id="S4.Ex4.m2.4.5.2.1.2.2" xref="S4.Ex4.m2.4.5.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex4.m2.4.5.2.1.2.3" xref="S4.Ex4.m2.4.5.2.1.2.3.cmml"><mi id="S4.Ex4.m2.4.5.2.1.2.3.2" xref="S4.Ex4.m2.4.5.2.1.2.3.2.cmml">k</mi><mo id="S4.Ex4.m2.4.5.2.1.2.3.1" xref="S4.Ex4.m2.4.5.2.1.2.3.1.cmml">=</mo><mn id="S4.Ex4.m2.4.5.2.1.2.3.3" xref="S4.Ex4.m2.4.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex4.m2.4.5.2.1.3" xref="S4.Ex4.m2.4.5.2.1.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex4.m2.4.5.2.2" xref="S4.Ex4.m2.4.5.2.2.cmml"><msub id="S4.Ex4.m2.4.5.2.2.2" xref="S4.Ex4.m2.4.5.2.2.2.cmml"><mi id="S4.Ex4.m2.4.5.2.2.2.2" xref="S4.Ex4.m2.4.5.2.2.2.2.cmml">y</mi><mtext id="S4.Ex4.m2.4.5.2.2.2.3" xref="S4.Ex4.m2.4.5.2.2.2.3a.cmml">gg</mtext></msub><mo lspace="0em" rspace="0em" id="S4.Ex4.m2.4.5.2.2.1" xref="S4.Ex4.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex4.m2.4.5.2.2.3.2" xref="S4.Ex4.m2.4.5.2.2.3.1.cmml"><mo stretchy="false" id="S4.Ex4.m2.4.5.2.2.3.2.1" xref="S4.Ex4.m2.4.5.2.2.3.1.cmml">[</mo><mi id="S4.Ex4.m2.1.1" xref="S4.Ex4.m2.1.1.cmml">r</mi><mo id="S4.Ex4.m2.4.5.2.2.3.2.2" xref="S4.Ex4.m2.4.5.2.2.3.1.cmml">,</mo><mi id="S4.Ex4.m2.2.2" xref="S4.Ex4.m2.2.2.cmml">k</mi><mo stretchy="false" id="S4.Ex4.m2.4.5.2.2.3.2.3" xref="S4.Ex4.m2.4.5.2.2.3.1.cmml">]</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.Ex4.m2.4.5.2.2.1a" xref="S4.Ex4.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex4.m2.4.5.2.2.4" xref="S4.Ex4.m2.4.5.2.2.4.cmml"><mi id="S4.Ex4.m2.4.5.2.2.4.1" xref="S4.Ex4.m2.4.5.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.Ex4.m2.4.5.2.2.4a" xref="S4.Ex4.m2.4.5.2.2.4.cmml">⁡</mo><mover accent="true" id="S4.Ex4.m2.4.5.2.2.4.2" xref="S4.Ex4.m2.4.5.2.2.4.2.cmml"><mi id="S4.Ex4.m2.4.5.2.2.4.2.2" xref="S4.Ex4.m2.4.5.2.2.4.2.2.cmml">z</mi><mo id="S4.Ex4.m2.4.5.2.2.4.2.1" xref="S4.Ex4.m2.4.5.2.2.4.2.1.cmml">^</mo></mover></mrow><mo lspace="0em" rspace="0em" id="S4.Ex4.m2.4.5.2.2.1b" xref="S4.Ex4.m2.4.5.2.2.1.cmml">​</mo><mrow id="S4.Ex4.m2.4.5.2.2.5.2" xref="S4.Ex4.m2.4.5.2.2.5.1.cmml"><mo stretchy="false" id="S4.Ex4.m2.4.5.2.2.5.2.1" xref="S4.Ex4.m2.4.5.2.2.5.1.cmml">[</mo><mi id="S4.Ex4.m2.3.3" xref="S4.Ex4.m2.3.3.cmml">r</mi><mo id="S4.Ex4.m2.4.5.2.2.5.2.2" xref="S4.Ex4.m2.4.5.2.2.5.1.cmml">,</mo><mi id="S4.Ex4.m2.4.4" xref="S4.Ex4.m2.4.4.cmml">k</mi><mo stretchy="false" id="S4.Ex4.m2.4.5.2.2.5.2.3" xref="S4.Ex4.m2.4.5.2.2.5.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m2.4b"><apply id="S4.Ex4.m2.4.5.cmml" xref="S4.Ex4.m2.4.5"><apply id="S4.Ex4.m2.4.5.1.cmml" xref="S4.Ex4.m2.4.5.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.4.5.1.1.cmml" xref="S4.Ex4.m2.4.5.1">subscript</csymbol><sum id="S4.Ex4.m2.4.5.1.2.cmml" xref="S4.Ex4.m2.4.5.1.2"></sum><apply id="S4.Ex4.m2.4.5.1.3.cmml" xref="S4.Ex4.m2.4.5.1.3"><in id="S4.Ex4.m2.4.5.1.3.1.cmml" xref="S4.Ex4.m2.4.5.1.3.1"></in><ci id="S4.Ex4.m2.4.5.1.3.2.cmml" xref="S4.Ex4.m2.4.5.1.3.2">𝑟</ci><apply id="S4.Ex4.m2.4.5.1.3.3.cmml" xref="S4.Ex4.m2.4.5.1.3.3"><csymbol cd="ambiguous" id="S4.Ex4.m2.4.5.1.3.3.1.cmml" xref="S4.Ex4.m2.4.5.1.3.3">superscript</csymbol><ci id="S4.Ex4.m2.4.5.1.3.3.2.cmml" xref="S4.Ex4.m2.4.5.1.3.3.2">𝑅</ci><times id="S4.Ex4.m2.4.5.1.3.3.3.cmml" xref="S4.Ex4.m2.4.5.1.3.3.3"></times></apply></apply></apply><apply id="S4.Ex4.m2.4.5.2.cmml" xref="S4.Ex4.m2.4.5.2"><apply id="S4.Ex4.m2.4.5.2.1.cmml" xref="S4.Ex4.m2.4.5.2.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.4.5.2.1.1.cmml" xref="S4.Ex4.m2.4.5.2.1">superscript</csymbol><apply id="S4.Ex4.m2.4.5.2.1.2.cmml" xref="S4.Ex4.m2.4.5.2.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.4.5.2.1.2.1.cmml" xref="S4.Ex4.m2.4.5.2.1">subscript</csymbol><sum id="S4.Ex4.m2.4.5.2.1.2.2.cmml" xref="S4.Ex4.m2.4.5.2.1.2.2"></sum><apply id="S4.Ex4.m2.4.5.2.1.2.3.cmml" xref="S4.Ex4.m2.4.5.2.1.2.3"><eq id="S4.Ex4.m2.4.5.2.1.2.3.1.cmml" xref="S4.Ex4.m2.4.5.2.1.2.3.1"></eq><ci id="S4.Ex4.m2.4.5.2.1.2.3.2.cmml" xref="S4.Ex4.m2.4.5.2.1.2.3.2">𝑘</ci><cn type="integer" id="S4.Ex4.m2.4.5.2.1.2.3.3.cmml" xref="S4.Ex4.m2.4.5.2.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex4.m2.4.5.2.1.3.cmml" xref="S4.Ex4.m2.4.5.2.1.3">𝐾</ci></apply><apply id="S4.Ex4.m2.4.5.2.2.cmml" xref="S4.Ex4.m2.4.5.2.2"><times id="S4.Ex4.m2.4.5.2.2.1.cmml" xref="S4.Ex4.m2.4.5.2.2.1"></times><apply id="S4.Ex4.m2.4.5.2.2.2.cmml" xref="S4.Ex4.m2.4.5.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m2.4.5.2.2.2.1.cmml" xref="S4.Ex4.m2.4.5.2.2.2">subscript</csymbol><ci id="S4.Ex4.m2.4.5.2.2.2.2.cmml" xref="S4.Ex4.m2.4.5.2.2.2.2">𝑦</ci><ci id="S4.Ex4.m2.4.5.2.2.2.3a.cmml" xref="S4.Ex4.m2.4.5.2.2.2.3"><mtext mathsize="70%" id="S4.Ex4.m2.4.5.2.2.2.3.cmml" xref="S4.Ex4.m2.4.5.2.2.2.3">gg</mtext></ci></apply><interval closure="closed" id="S4.Ex4.m2.4.5.2.2.3.1.cmml" xref="S4.Ex4.m2.4.5.2.2.3.2"><ci id="S4.Ex4.m2.1.1.cmml" xref="S4.Ex4.m2.1.1">𝑟</ci><ci id="S4.Ex4.m2.2.2.cmml" xref="S4.Ex4.m2.2.2">𝑘</ci></interval><apply id="S4.Ex4.m2.4.5.2.2.4.cmml" xref="S4.Ex4.m2.4.5.2.2.4"><log id="S4.Ex4.m2.4.5.2.2.4.1.cmml" xref="S4.Ex4.m2.4.5.2.2.4.1"></log><apply id="S4.Ex4.m2.4.5.2.2.4.2.cmml" xref="S4.Ex4.m2.4.5.2.2.4.2"><ci id="S4.Ex4.m2.4.5.2.2.4.2.1.cmml" xref="S4.Ex4.m2.4.5.2.2.4.2.1">^</ci><ci id="S4.Ex4.m2.4.5.2.2.4.2.2.cmml" xref="S4.Ex4.m2.4.5.2.2.4.2.2">𝑧</ci></apply></apply><interval closure="closed" id="S4.Ex4.m2.4.5.2.2.5.1.cmml" xref="S4.Ex4.m2.4.5.2.2.5.2"><ci id="S4.Ex4.m2.3.3.cmml" xref="S4.Ex4.m2.3.3">𝑟</ci><ci id="S4.Ex4.m2.4.4.cmml" xref="S4.Ex4.m2.4.4">𝑘</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m2.4c">\displaystyle\sum_{r\in R^{*}}\sum_{k=1}^{K}y_{\text{gg}}[r,k]\log{\hat{z}[r,k]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.2" class="ltx_p">While <math id="S4.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="R^{*}" display="inline"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><msup id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml">R</mi><mo id="S4.SS2.SSS2.p3.1.m1.1.1.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><apply id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2">𝑅</ci><times id="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">R^{*}</annotation></semantics></math> generally includes both segmented sextant and lesion regions, its worth noting that this can differ from the total region count <math id="S4.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS2.SSS2.p3.2.m2.1a"><mi id="S4.SS2.SSS2.p3.2.m2.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.1b"><ci id="S4.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.1c">R</annotation></semantics></math>, e.g. in exams where individual lesion contours are available but the individual scores are not.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Global Prediction</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">The UCNet architecture supports global prediction modules, which can be based either on the spatial map that is rendered by the decoding branch or the fully-encoded features produced by the encoding branch, of the fully-convolutional backbone. We do not use either capability in this paper, and instead focus on lesion-wise cancer classification accuracy.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Multi-task Objective</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.5" class="ltx_p">Then, our multi-task objective is:</p>
<table id="Sx1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}(x,y,y_{\text{gg}},z)=\alpha_{1}\lambda_{1}\mathcal{L}_{\text{region-classifier}}+\alpha_{2}\lambda_{2}\mathcal{L}_{\text{GGmap-hist}}" display="inline"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.1.3" xref="S4.E5.m1.4.4.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E5.m1.4.4.1.1.1" xref="S4.E5.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">x</mi><mo id="S4.E5.m1.4.4.1.1.1.3" xref="S4.E5.m1.4.4.1.1.2.cmml">,</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">y</mi><mo id="S4.E5.m1.4.4.1.1.1.4" xref="S4.E5.m1.4.4.1.1.2.cmml">,</mo><msub id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.2.cmml">y</mi><mtext id="S4.E5.m1.4.4.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.3a.cmml">gg</mtext></msub><mo id="S4.E5.m1.4.4.1.1.1.5" xref="S4.E5.m1.4.4.1.1.2.cmml">,</mo><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">z</mi><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.6" xref="S4.E5.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.4.4.2" xref="S4.E5.m1.4.4.2.cmml">=</mo><mrow id="S4.E5.m1.4.4.3" xref="S4.E5.m1.4.4.3.cmml"><mrow id="S4.E5.m1.4.4.3.2" xref="S4.E5.m1.4.4.3.2.cmml"><msub id="S4.E5.m1.4.4.3.2.2" xref="S4.E5.m1.4.4.3.2.2.cmml"><mi id="S4.E5.m1.4.4.3.2.2.2" xref="S4.E5.m1.4.4.3.2.2.2.cmml">α</mi><mn id="S4.E5.m1.4.4.3.2.2.3" xref="S4.E5.m1.4.4.3.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.2.1" xref="S4.E5.m1.4.4.3.2.1.cmml">​</mo><msub id="S4.E5.m1.4.4.3.2.3" xref="S4.E5.m1.4.4.3.2.3.cmml"><mi id="S4.E5.m1.4.4.3.2.3.2" xref="S4.E5.m1.4.4.3.2.3.2.cmml">λ</mi><mn id="S4.E5.m1.4.4.3.2.3.3" xref="S4.E5.m1.4.4.3.2.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.2.1a" xref="S4.E5.m1.4.4.3.2.1.cmml">​</mo><msub id="S4.E5.m1.4.4.3.2.4" xref="S4.E5.m1.4.4.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.3.2.4.2" xref="S4.E5.m1.4.4.3.2.4.2.cmml">ℒ</mi><mtext id="S4.E5.m1.4.4.3.2.4.3" xref="S4.E5.m1.4.4.3.2.4.3a.cmml">region-classifier</mtext></msub></mrow><mo id="S4.E5.m1.4.4.3.1" xref="S4.E5.m1.4.4.3.1.cmml">+</mo><mrow id="S4.E5.m1.4.4.3.3" xref="S4.E5.m1.4.4.3.3.cmml"><msub id="S4.E5.m1.4.4.3.3.2" xref="S4.E5.m1.4.4.3.3.2.cmml"><mi id="S4.E5.m1.4.4.3.3.2.2" xref="S4.E5.m1.4.4.3.3.2.2.cmml">α</mi><mn id="S4.E5.m1.4.4.3.3.2.3" xref="S4.E5.m1.4.4.3.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.3.1" xref="S4.E5.m1.4.4.3.3.1.cmml">​</mo><msub id="S4.E5.m1.4.4.3.3.3" xref="S4.E5.m1.4.4.3.3.3.cmml"><mi id="S4.E5.m1.4.4.3.3.3.2" xref="S4.E5.m1.4.4.3.3.3.2.cmml">λ</mi><mn id="S4.E5.m1.4.4.3.3.3.3" xref="S4.E5.m1.4.4.3.3.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.3.1a" xref="S4.E5.m1.4.4.3.3.1.cmml">​</mo><msub id="S4.E5.m1.4.4.3.3.4" xref="S4.E5.m1.4.4.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.3.3.4.2" xref="S4.E5.m1.4.4.3.3.4.2.cmml">ℒ</mi><mtext id="S4.E5.m1.4.4.3.3.4.3" xref="S4.E5.m1.4.4.3.3.4.3a.cmml">GGmap-hist</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4"><eq id="S4.E5.m1.4.4.2.cmml" xref="S4.E5.m1.4.4.2"></eq><apply id="S4.E5.m1.4.4.1.cmml" xref="S4.E5.m1.4.4.1"><times id="S4.E5.m1.4.4.1.2.cmml" xref="S4.E5.m1.4.4.1.2"></times><ci id="S4.E5.m1.4.4.1.3.cmml" xref="S4.E5.m1.4.4.1.3">ℒ</ci><vector id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝑥</ci><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝑦</ci><apply id="S4.E5.m1.4.4.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2">𝑦</ci><ci id="S4.E5.m1.4.4.1.1.1.1.3a.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3"><mtext mathsize="70%" id="S4.E5.m1.4.4.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3">gg</mtext></ci></apply><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">𝑧</ci></vector></apply><apply id="S4.E5.m1.4.4.3.cmml" xref="S4.E5.m1.4.4.3"><plus id="S4.E5.m1.4.4.3.1.cmml" xref="S4.E5.m1.4.4.3.1"></plus><apply id="S4.E5.m1.4.4.3.2.cmml" xref="S4.E5.m1.4.4.3.2"><times id="S4.E5.m1.4.4.3.2.1.cmml" xref="S4.E5.m1.4.4.3.2.1"></times><apply id="S4.E5.m1.4.4.3.2.2.cmml" xref="S4.E5.m1.4.4.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.2.2.1.cmml" xref="S4.E5.m1.4.4.3.2.2">subscript</csymbol><ci id="S4.E5.m1.4.4.3.2.2.2.cmml" xref="S4.E5.m1.4.4.3.2.2.2">𝛼</ci><cn type="integer" id="S4.E5.m1.4.4.3.2.2.3.cmml" xref="S4.E5.m1.4.4.3.2.2.3">1</cn></apply><apply id="S4.E5.m1.4.4.3.2.3.cmml" xref="S4.E5.m1.4.4.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.2.3.1.cmml" xref="S4.E5.m1.4.4.3.2.3">subscript</csymbol><ci id="S4.E5.m1.4.4.3.2.3.2.cmml" xref="S4.E5.m1.4.4.3.2.3.2">𝜆</ci><cn type="integer" id="S4.E5.m1.4.4.3.2.3.3.cmml" xref="S4.E5.m1.4.4.3.2.3.3">1</cn></apply><apply id="S4.E5.m1.4.4.3.2.4.cmml" xref="S4.E5.m1.4.4.3.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.2.4.1.cmml" xref="S4.E5.m1.4.4.3.2.4">subscript</csymbol><ci id="S4.E5.m1.4.4.3.2.4.2.cmml" xref="S4.E5.m1.4.4.3.2.4.2">ℒ</ci><ci id="S4.E5.m1.4.4.3.2.4.3a.cmml" xref="S4.E5.m1.4.4.3.2.4.3"><mtext mathsize="70%" id="S4.E5.m1.4.4.3.2.4.3.cmml" xref="S4.E5.m1.4.4.3.2.4.3">region-classifier</mtext></ci></apply></apply><apply id="S4.E5.m1.4.4.3.3.cmml" xref="S4.E5.m1.4.4.3.3"><times id="S4.E5.m1.4.4.3.3.1.cmml" xref="S4.E5.m1.4.4.3.3.1"></times><apply id="S4.E5.m1.4.4.3.3.2.cmml" xref="S4.E5.m1.4.4.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.3.2.1.cmml" xref="S4.E5.m1.4.4.3.3.2">subscript</csymbol><ci id="S4.E5.m1.4.4.3.3.2.2.cmml" xref="S4.E5.m1.4.4.3.3.2.2">𝛼</ci><cn type="integer" id="S4.E5.m1.4.4.3.3.2.3.cmml" xref="S4.E5.m1.4.4.3.3.2.3">2</cn></apply><apply id="S4.E5.m1.4.4.3.3.3.cmml" xref="S4.E5.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.3.3.1.cmml" xref="S4.E5.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.E5.m1.4.4.3.3.3.2.cmml" xref="S4.E5.m1.4.4.3.3.3.2">𝜆</ci><cn type="integer" id="S4.E5.m1.4.4.3.3.3.3.cmml" xref="S4.E5.m1.4.4.3.3.3.3">2</cn></apply><apply id="S4.E5.m1.4.4.3.3.4.cmml" xref="S4.E5.m1.4.4.3.3.4"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.3.4.1.cmml" xref="S4.E5.m1.4.4.3.3.4">subscript</csymbol><ci id="S4.E5.m1.4.4.3.3.4.2.cmml" xref="S4.E5.m1.4.4.3.3.4.2">ℒ</ci><ci id="S4.E5.m1.4.4.3.3.4.3a.cmml" xref="S4.E5.m1.4.4.3.3.4.3"><mtext mathsize="70%" id="S4.E5.m1.4.4.3.3.4.3.cmml" xref="S4.E5.m1.4.4.3.3.4.3">GGmap-hist</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">\displaystyle\mathcal{L}(x,y,y_{\text{gg}},z)=\alpha_{1}\lambda_{1}\mathcal{L}_{\text{region-classifier}}+\alpha_{2}\lambda_{2}\mathcal{L}_{\text{GGmap-hist}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle+\alpha_{3}\lambda_{3}\mathcal{L}_{\text{GGmap}}+\alpha_{4}\lambda_{4}\mathcal{L}_{\text{segmentation}}" display="inline"><semantics id="S4.Ex5.m1.1a"><mrow id="S4.Ex5.m1.1.1" xref="S4.Ex5.m1.1.1.cmml"><mrow id="S4.Ex5.m1.1.1.2" xref="S4.Ex5.m1.1.1.2.cmml"><mo id="S4.Ex5.m1.1.1.2a" xref="S4.Ex5.m1.1.1.2.cmml">+</mo><mrow id="S4.Ex5.m1.1.1.2.2" xref="S4.Ex5.m1.1.1.2.2.cmml"><msub id="S4.Ex5.m1.1.1.2.2.2" xref="S4.Ex5.m1.1.1.2.2.2.cmml"><mi id="S4.Ex5.m1.1.1.2.2.2.2" xref="S4.Ex5.m1.1.1.2.2.2.2.cmml">α</mi><mn id="S4.Ex5.m1.1.1.2.2.2.3" xref="S4.Ex5.m1.1.1.2.2.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.1.1.2.2.1" xref="S4.Ex5.m1.1.1.2.2.1.cmml">​</mo><msub id="S4.Ex5.m1.1.1.2.2.3" xref="S4.Ex5.m1.1.1.2.2.3.cmml"><mi id="S4.Ex5.m1.1.1.2.2.3.2" xref="S4.Ex5.m1.1.1.2.2.3.2.cmml">λ</mi><mn id="S4.Ex5.m1.1.1.2.2.3.3" xref="S4.Ex5.m1.1.1.2.2.3.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.1.1.2.2.1a" xref="S4.Ex5.m1.1.1.2.2.1.cmml">​</mo><msub id="S4.Ex5.m1.1.1.2.2.4" xref="S4.Ex5.m1.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.1.1.2.2.4.2" xref="S4.Ex5.m1.1.1.2.2.4.2.cmml">ℒ</mi><mtext id="S4.Ex5.m1.1.1.2.2.4.3" xref="S4.Ex5.m1.1.1.2.2.4.3a.cmml">GGmap</mtext></msub></mrow></mrow><mo id="S4.Ex5.m1.1.1.1" xref="S4.Ex5.m1.1.1.1.cmml">+</mo><mrow id="S4.Ex5.m1.1.1.3" xref="S4.Ex5.m1.1.1.3.cmml"><msub id="S4.Ex5.m1.1.1.3.2" xref="S4.Ex5.m1.1.1.3.2.cmml"><mi id="S4.Ex5.m1.1.1.3.2.2" xref="S4.Ex5.m1.1.1.3.2.2.cmml">α</mi><mn id="S4.Ex5.m1.1.1.3.2.3" xref="S4.Ex5.m1.1.1.3.2.3.cmml">4</mn></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.1.1.3.1" xref="S4.Ex5.m1.1.1.3.1.cmml">​</mo><msub id="S4.Ex5.m1.1.1.3.3" xref="S4.Ex5.m1.1.1.3.3.cmml"><mi id="S4.Ex5.m1.1.1.3.3.2" xref="S4.Ex5.m1.1.1.3.3.2.cmml">λ</mi><mn id="S4.Ex5.m1.1.1.3.3.3" xref="S4.Ex5.m1.1.1.3.3.3.cmml">4</mn></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.1.1.3.1a" xref="S4.Ex5.m1.1.1.3.1.cmml">​</mo><msub id="S4.Ex5.m1.1.1.3.4" xref="S4.Ex5.m1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.1.1.3.4.2" xref="S4.Ex5.m1.1.1.3.4.2.cmml">ℒ</mi><mtext id="S4.Ex5.m1.1.1.3.4.3" xref="S4.Ex5.m1.1.1.3.4.3a.cmml">segmentation</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.1b"><apply id="S4.Ex5.m1.1.1.cmml" xref="S4.Ex5.m1.1.1"><plus id="S4.Ex5.m1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1"></plus><apply id="S4.Ex5.m1.1.1.2.cmml" xref="S4.Ex5.m1.1.1.2"><plus id="S4.Ex5.m1.1.1.2.1.cmml" xref="S4.Ex5.m1.1.1.2"></plus><apply id="S4.Ex5.m1.1.1.2.2.cmml" xref="S4.Ex5.m1.1.1.2.2"><times id="S4.Ex5.m1.1.1.2.2.1.cmml" xref="S4.Ex5.m1.1.1.2.2.1"></times><apply id="S4.Ex5.m1.1.1.2.2.2.cmml" xref="S4.Ex5.m1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.2.2.2.1.cmml" xref="S4.Ex5.m1.1.1.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.1.1.2.2.2.2.cmml" xref="S4.Ex5.m1.1.1.2.2.2.2">𝛼</ci><cn type="integer" id="S4.Ex5.m1.1.1.2.2.2.3.cmml" xref="S4.Ex5.m1.1.1.2.2.2.3">3</cn></apply><apply id="S4.Ex5.m1.1.1.2.2.3.cmml" xref="S4.Ex5.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.2.2.3.1.cmml" xref="S4.Ex5.m1.1.1.2.2.3">subscript</csymbol><ci id="S4.Ex5.m1.1.1.2.2.3.2.cmml" xref="S4.Ex5.m1.1.1.2.2.3.2">𝜆</ci><cn type="integer" id="S4.Ex5.m1.1.1.2.2.3.3.cmml" xref="S4.Ex5.m1.1.1.2.2.3.3">3</cn></apply><apply id="S4.Ex5.m1.1.1.2.2.4.cmml" xref="S4.Ex5.m1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.2.2.4.1.cmml" xref="S4.Ex5.m1.1.1.2.2.4">subscript</csymbol><ci id="S4.Ex5.m1.1.1.2.2.4.2.cmml" xref="S4.Ex5.m1.1.1.2.2.4.2">ℒ</ci><ci id="S4.Ex5.m1.1.1.2.2.4.3a.cmml" xref="S4.Ex5.m1.1.1.2.2.4.3"><mtext mathsize="70%" id="S4.Ex5.m1.1.1.2.2.4.3.cmml" xref="S4.Ex5.m1.1.1.2.2.4.3">GGmap</mtext></ci></apply></apply></apply><apply id="S4.Ex5.m1.1.1.3.cmml" xref="S4.Ex5.m1.1.1.3"><times id="S4.Ex5.m1.1.1.3.1.cmml" xref="S4.Ex5.m1.1.1.3.1"></times><apply id="S4.Ex5.m1.1.1.3.2.cmml" xref="S4.Ex5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.3.2.1.cmml" xref="S4.Ex5.m1.1.1.3.2">subscript</csymbol><ci id="S4.Ex5.m1.1.1.3.2.2.cmml" xref="S4.Ex5.m1.1.1.3.2.2">𝛼</ci><cn type="integer" id="S4.Ex5.m1.1.1.3.2.3.cmml" xref="S4.Ex5.m1.1.1.3.2.3">4</cn></apply><apply id="S4.Ex5.m1.1.1.3.3.cmml" xref="S4.Ex5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.3.3.1.cmml" xref="S4.Ex5.m1.1.1.3.3">subscript</csymbol><ci id="S4.Ex5.m1.1.1.3.3.2.cmml" xref="S4.Ex5.m1.1.1.3.3.2">𝜆</ci><cn type="integer" id="S4.Ex5.m1.1.1.3.3.3.cmml" xref="S4.Ex5.m1.1.1.3.3.3">4</cn></apply><apply id="S4.Ex5.m1.1.1.3.4.cmml" xref="S4.Ex5.m1.1.1.3.4"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.3.4.1.cmml" xref="S4.Ex5.m1.1.1.3.4">subscript</csymbol><ci id="S4.Ex5.m1.1.1.3.4.2.cmml" xref="S4.Ex5.m1.1.1.3.4.2">ℒ</ci><ci id="S4.Ex5.m1.1.1.3.4.3a.cmml" xref="S4.Ex5.m1.1.1.3.4.3"><mtext mathsize="70%" id="S4.Ex5.m1.1.1.3.4.3.cmml" xref="S4.Ex5.m1.1.1.3.4.3">segmentation</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.1c">\displaystyle+\alpha_{3}\lambda_{3}\mathcal{L}_{\text{GGmap}}+\alpha_{4}\lambda_{4}\mathcal{L}_{\text{segmentation}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS4.p1.4" class="ltx_p">where we empirically choose <math id="S4.SS4.p1.1.m1.4" class="ltx_Math" alttext="\bar{\lambda}=[1.0,0.5,1.0,1.0]" display="inline"><semantics id="S4.SS4.p1.1.m1.4a"><mrow id="S4.SS4.p1.1.m1.4.5" xref="S4.SS4.p1.1.m1.4.5.cmml"><mover accent="true" id="S4.SS4.p1.1.m1.4.5.2" xref="S4.SS4.p1.1.m1.4.5.2.cmml"><mi id="S4.SS4.p1.1.m1.4.5.2.2" xref="S4.SS4.p1.1.m1.4.5.2.2.cmml">λ</mi><mo id="S4.SS4.p1.1.m1.4.5.2.1" xref="S4.SS4.p1.1.m1.4.5.2.1.cmml">¯</mo></mover><mo id="S4.SS4.p1.1.m1.4.5.1" xref="S4.SS4.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S4.SS4.p1.1.m1.4.5.3.2" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.1.m1.4.5.3.2.1" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">[</mo><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">1.0</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.2" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.2.2" xref="S4.SS4.p1.1.m1.2.2.cmml">0.5</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.3" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.3.3" xref="S4.SS4.p1.1.m1.3.3.cmml">1.0</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.4" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.4.4" xref="S4.SS4.p1.1.m1.4.4.cmml">1.0</mn><mo stretchy="false" id="S4.SS4.p1.1.m1.4.5.3.2.5" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.4b"><apply id="S4.SS4.p1.1.m1.4.5.cmml" xref="S4.SS4.p1.1.m1.4.5"><eq id="S4.SS4.p1.1.m1.4.5.1.cmml" xref="S4.SS4.p1.1.m1.4.5.1"></eq><apply id="S4.SS4.p1.1.m1.4.5.2.cmml" xref="S4.SS4.p1.1.m1.4.5.2"><ci id="S4.SS4.p1.1.m1.4.5.2.1.cmml" xref="S4.SS4.p1.1.m1.4.5.2.1">¯</ci><ci id="S4.SS4.p1.1.m1.4.5.2.2.cmml" xref="S4.SS4.p1.1.m1.4.5.2.2">𝜆</ci></apply><list id="S4.SS4.p1.1.m1.4.5.3.1.cmml" xref="S4.SS4.p1.1.m1.4.5.3.2"><cn type="float" id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">1.0</cn><cn type="float" id="S4.SS4.p1.1.m1.2.2.cmml" xref="S4.SS4.p1.1.m1.2.2">0.5</cn><cn type="float" id="S4.SS4.p1.1.m1.3.3.cmml" xref="S4.SS4.p1.1.m1.3.3">1.0</cn><cn type="float" id="S4.SS4.p1.1.m1.4.4.cmml" xref="S4.SS4.p1.1.m1.4.4">1.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.4c">\bar{\lambda}=[1.0,0.5,1.0,1.0]</annotation></semantics></math>, and <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\bar{\alpha}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mover accent="true" id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><ci id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1">¯</ci><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\bar{\alpha}</annotation></semantics></math> is chosen based on the availability of different annotation groundtruth available for each exam in a minibatch, as well as the the type of supervision signals desired in the experiment. In this paper, we choose <math id="S4.SS4.p1.3.m3.4" class="ltx_Math" alttext="\bar{\alpha}=[1.0,1.0,1.0,1.0]" display="inline"><semantics id="S4.SS4.p1.3.m3.4a"><mrow id="S4.SS4.p1.3.m3.4.5" xref="S4.SS4.p1.3.m3.4.5.cmml"><mover accent="true" id="S4.SS4.p1.3.m3.4.5.2" xref="S4.SS4.p1.3.m3.4.5.2.cmml"><mi id="S4.SS4.p1.3.m3.4.5.2.2" xref="S4.SS4.p1.3.m3.4.5.2.2.cmml">α</mi><mo id="S4.SS4.p1.3.m3.4.5.2.1" xref="S4.SS4.p1.3.m3.4.5.2.1.cmml">¯</mo></mover><mo id="S4.SS4.p1.3.m3.4.5.1" xref="S4.SS4.p1.3.m3.4.5.1.cmml">=</mo><mrow id="S4.SS4.p1.3.m3.4.5.3.2" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.3.m3.4.5.3.2.1" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml">[</mo><mn id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">1.0</mn><mo id="S4.SS4.p1.3.m3.4.5.3.2.2" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.3.m3.2.2" xref="S4.SS4.p1.3.m3.2.2.cmml">1.0</mn><mo id="S4.SS4.p1.3.m3.4.5.3.2.3" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.3.m3.3.3" xref="S4.SS4.p1.3.m3.3.3.cmml">1.0</mn><mo id="S4.SS4.p1.3.m3.4.5.3.2.4" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.3.m3.4.4" xref="S4.SS4.p1.3.m3.4.4.cmml">1.0</mn><mo stretchy="false" id="S4.SS4.p1.3.m3.4.5.3.2.5" xref="S4.SS4.p1.3.m3.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.4b"><apply id="S4.SS4.p1.3.m3.4.5.cmml" xref="S4.SS4.p1.3.m3.4.5"><eq id="S4.SS4.p1.3.m3.4.5.1.cmml" xref="S4.SS4.p1.3.m3.4.5.1"></eq><apply id="S4.SS4.p1.3.m3.4.5.2.cmml" xref="S4.SS4.p1.3.m3.4.5.2"><ci id="S4.SS4.p1.3.m3.4.5.2.1.cmml" xref="S4.SS4.p1.3.m3.4.5.2.1">¯</ci><ci id="S4.SS4.p1.3.m3.4.5.2.2.cmml" xref="S4.SS4.p1.3.m3.4.5.2.2">𝛼</ci></apply><list id="S4.SS4.p1.3.m3.4.5.3.1.cmml" xref="S4.SS4.p1.3.m3.4.5.3.2"><cn type="float" id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">1.0</cn><cn type="float" id="S4.SS4.p1.3.m3.2.2.cmml" xref="S4.SS4.p1.3.m3.2.2">1.0</cn><cn type="float" id="S4.SS4.p1.3.m3.3.3.cmml" xref="S4.SS4.p1.3.m3.3.3">1.0</cn><cn type="float" id="S4.SS4.p1.3.m3.4.4.cmml" xref="S4.SS4.p1.3.m3.4.4">1.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.4c">\bar{\alpha}=[1.0,1.0,1.0,1.0]</annotation></semantics></math> to use all described objectives whenever possible. We use the AdamW optimizer, initialized with an initial learning rate of <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="0.0015" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mn id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">0.0015</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><cn type="float" id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">0.0015</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">0.0015</annotation></semantics></math> both locally and during federated training, to optimize the parameters of UCNet with respect to Equation <a href="#S4.E5" title="In 4.4 Multi-task Objective ‣ 4 UCNet for Mixed Histopathology Supervision ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Inference</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Inference is performed in a similar fashion to training, except with all augmentation turned off. Note that, due to the nature of weak histopathology groundtruth, it is not straightforward to train UCNet using volumetric patches. Instead, we feed full (registered and resampled) multi-contrast prostate MRI exams as input to UCNet, producing the collection of predictions for each region over the whole prostate gland.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The federated learning system that we designed was successful in enabling multi-center training of the UCNet model, while avoiding having to share and centralize institutional patient data. Tables <a href="#S5.T3" title="Table 3 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>-<a href="#S5.T3" title="Table 3 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> below compares the test-set performance of various model checkpoints trained locally and using FL, selected at each site by finding the checkpoint with the highest validation performance <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">at each site</span>. This is an important point that leads to two versions of the federated model, as each site may select different checkpoints as “best”.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r">Model</th>
<th id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">UCSF</th>
<th id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">UCLA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.2.1" class="ltx_tr">
<th id="S5.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">UCSF-local</th>
<td id="S5.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.134</td>
<td id="S5.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.0</td>
</tr>
<tr id="S5.T2.1.3.2" class="ltx_tr">
<th id="S5.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UCLA-local</th>
<td id="S5.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">0.000</td>
<td id="S5.T2.1.3.2.3" class="ltx_td ltx_align_center">0.15</td>
</tr>
<tr id="S5.T2.1.4.3" class="ltx_tr">
<th id="S5.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UCSF-FL</th>
<td id="S5.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">0.120</td>
<td id="S5.T2.1.4.3.3" class="ltx_td ltx_align_center">0.1</td>
</tr>
<tr id="S5.T2.1.5.4" class="ltx_tr">
<th id="S5.T2.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UCLA-FL</th>
<td id="S5.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">0.111</td>
<td id="S5.T2.1.5.4.3" class="ltx_td ltx_align_center">0.06</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Lesion Segmentation Intersection-over-Union (IoU)</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.4.5.1" class="ltx_tr">
<td id="S5.T3.4.5.1.1" class="ltx_td ltx_align_center ltx_border_r">Model</td>
<td id="S5.T3.4.5.1.2" class="ltx_td ltx_align_left ltx_border_r">UCSF</td>
<td id="S5.T3.4.5.1.3" class="ltx_td ltx_align_center ltx_border_r">UCLA</td>
</tr>
<tr id="S5.T3.4.6.2" class="ltx_tr">
<td id="S5.T3.4.6.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">UCSF-local</td>
<td id="S5.T3.4.6.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">68.0% [0.74, 0.63]</td>
<td id="S5.T3.4.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.3% [0.85, 0.51]</td>
</tr>
<tr id="S5.T3.4.7.3" class="ltx_tr">
<td id="S5.T3.4.7.3.1" class="ltx_td ltx_align_center ltx_border_r">UCSF-FL</td>
<td id="S5.T3.4.7.3.2" class="ltx_td ltx_align_left ltx_border_r">67.9% [0.76, 0.60]</td>
<td id="S5.T3.4.7.3.3" class="ltx_td ltx_align_center ltx_border_r">62.8% [0.69, 0.57]</td>
</tr>
<tr id="S5.T3.2.2" class="ltx_tr">
<td id="S5.T3.2.2.3" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mo mathcolor="#FFB529" stretchy="false" id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="S5.T3.1.1.1.1" class="ltx_text" style="color:#FFB529;"> 0.01%</span>
</td>
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><mo mathcolor="#00E000" stretchy="false" id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><ci id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">\uparrow</annotation></semantics></math><span id="S5.T3.2.2.2.1" class="ltx_text" style="color:#00E000;"> 9.5%</span>
</td>
</tr>
<tr id="S5.T3.4.8.4" class="ltx_tr">
<td id="S5.T3.4.8.4.1" class="ltx_td ltx_align_center ltx_border_r">UCLA-local</td>
<td id="S5.T3.4.8.4.2" class="ltx_td ltx_align_left ltx_border_r">47.9% [0.93, 0.03]</td>
<td id="S5.T3.4.8.4.3" class="ltx_td ltx_align_center ltx_border_r">69.5% [0.67, 0.73]</td>
</tr>
<tr id="S5.T3.4.9.5" class="ltx_tr">
<td id="S5.T3.4.9.5.1" class="ltx_td ltx_align_center ltx_border_r">UCLA-FL</td>
<td id="S5.T3.4.9.5.2" class="ltx_td ltx_align_left ltx_border_r">62.7% [0.78, 0.47]</td>
<td id="S5.T3.4.9.5.3" class="ltx_td ltx_align_center ltx_border_r">66.8% [0.74, 0.65]</td>
</tr>
<tr id="S5.T3.4.4" class="ltx_tr">
<td id="S5.T3.4.4.3" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S5.T3.3.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<math id="S5.T3.3.3.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.3.3.1.m1.1a"><mo mathcolor="#00E000" stretchy="false" id="S5.T3.3.3.1.m1.1.1" xref="S5.T3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.1.m1.1b"><ci id="S5.T3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.1.m1.1c">\uparrow</annotation></semantics></math><span id="S5.T3.3.3.1.1" class="ltx_text" style="color:#00E000;"> 14.8%</span>
</td>
<td id="S5.T3.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S5.T3.4.4.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T3.4.4.2.m1.1a"><mo mathcolor="#FF0000" stretchy="false" id="S5.T3.4.4.2.m1.1.1" xref="S5.T3.4.4.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.2.m1.1b"><ci id="S5.T3.4.4.2.m1.1.1.cmml" xref="S5.T3.4.4.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.2.m1.1c">\downarrow</annotation></semantics></math><span id="S5.T3.4.4.2.1" class="ltx_text" style="color:#FF0000;"> 2.7%</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Region-wise Lesion Binary Classification Accuracy. Bracketted numbers indicate TNR and TPR, respectively.</figcaption>
</figure>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">From Table <a href="#S5.T3" title="Table 3 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we can see that both local models performed well on their own private test sets, but the performance on the set from the different institution was much lower. UCLA local model showed 47.9% accuracy on UCSF data, which is 30% lower than UCSF local model performance. The result of UCLA model evaluation on UCSF data showed high TNR (0.93) and low TPR (0.03), which means low usability of the model on data in another institution. UCSF local model showed slightly higher accuracy of 53.3% on the UCLA data, which was still 23% lower than UCLA local model result. Although the best FL model was chosen on each site separately based on the local validation performance,both FL models succeeded in generalization. UCLA-FL model increased the UCSF data classification accuracy by 14.8% with subsequent increase in TNR and TPR, which made the model usable in practise by another institution. The same result achieved UCSF-FL model, which increased UCLA local data performance accuracy by 9.5% with increase in TNR and TPR.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">In Figures <a href="#S5.F8" title="Figure 8 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S5.F9" title="Figure 9 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> we show results of local and FL models from both institutions evaluated on UCSF and UCLA test sets, respectively. As mentioned above, UCSF and UCLA local models performed well on data from the same sites, but couldn‘t generalize well, which is clear in Row 2 of Figure <a href="#S5.F8" title="Figure 8 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.A and Figure <a href="#S5.F9" title="Figure 9 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.A. The last two rows of the figures show that FL models are able to reclaim accuracy loss when cross-site evaluation is performed.
Overall FL models evaluated on the same sites resulted in a slight accuracy drop, but still in some cases FL could improve the performance of the local model as shown in Figure <a href="#S5.F8" title="Figure 8 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.B and Figure <a href="#S5.F9" title="Figure 9 ‣ 5 Results ‣ Federated Learning with Research Prototypes for Multi-Center MRI-based Detection of Prostate Cancer with Diverse Histopathology" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.B (Row 1 vs. Rows 3-4).</p>
</div>
<figure id="S5.F8" class="ltx_figure">
<p id="S5.F8.2" class="ltx_p"><span id="S5.F8.2.1" class="ltx_text ltx_font_bold">A: Evaluation of UCNet on UCSF test data, where FL reclaims accuracy lost by cross-site evaluation (Row 2).
<br class="ltx_break"></span>
<img src="/html/2206.05617/assets/figures/10469859_Lesion-0.png" id="S5.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="342" alt="Refer to caption">

<span id="S5.F8.2.2" class="ltx_text ltx_font_bold">B: Evaluation of UCNet on UCSF test data, where FL <span id="S5.F8.2.2.1" class="ltx_text ltx_font_italic">improves</span> accuracy of UCSF-local model (Row 1 vs Rows 3-4).
<br class="ltx_break"></span>
<img src="/html/2206.05617/assets/figures/11915257_Lesion-0.png" id="S5.F8.2.g2" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="342" alt="Refer to caption"></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Evaluation of UCNet on UCSF data from Exp. ID 1111. (A) depicts a transverse slice of an exam where UCLA’s model performs poorly, but federated models (Rows 3-4) achieves the same level of accuracy as UCSF’s local model. (B) depicts a transverse slice of an exam where both local models performs poorly, but federated models perform well. Notably, for both (A-B), federated checkpoint chosen by UCLA stopping criteria (Row 3) performs better than the checkpoint chosen by UCSF (Row 4), highlighting that neither site has sufficient data to generalize well on their own.</figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure">
<p id="S5.F9.2" class="ltx_p"><span id="S5.F9.2.1" class="ltx_text ltx_font_bold">A: Evaluation on UCLA test data, where FL reclaims accuracy lost by cross-site evaluation (Row 2).
<br class="ltx_break"></span>
<img src="/html/2206.05617/assets/figures/2_015_2619712_20160715_Lesion-0.png" id="S5.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="342" alt="Refer to caption">

<span id="S5.F9.2.2" class="ltx_text ltx_font_bold">B: Evaluation on UCLA test data, where FL <span id="S5.F9.2.2.1" class="ltx_text ltx_font_italic">improves</span> accuracy of UCLA-local model (Row 1 vs Rows 3-4).
<br class="ltx_break"></span>
<img src="/html/2206.05617/assets/figures/0_115_1375686_20170228_Lesion-0.png" id="S5.F9.2.g2" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="342" alt="Refer to caption"></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Evaluation of UCNet on UCLA data from Exp. ID 1111.
(A) depicts a transverse slice of an exam where UCSF’s model performs poorly, but federated models (Rows 3-4) achieves the same level of accuracy as UCLA’s local model.
(B) depicts a transverse slice of an exam where both local models performs poorly, but federated models perform well. </figcaption>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work we addressed realistic scenario when highly heterogeneous MRI data, patient distributions, and groundtruth annotations (both within and across institutions) are available for training a deep learning algorithm. Our bespoke architecture, UCNet, was able to handle this task, and resulted in good performance in both local and federated training. The resulting models chosen on each site individually based on the local validation performance, gained the benefit of having learned from each of the private datasets without ever needing to transfer, pool, or homogenize data at a single location. Both FL checkpoints showed desirable generalization performance, and resulted in higher accuracy evaluated on the local datasets from the opposite institutions, while neither site had sufficient data to generalize well on their own.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">However, the stopping criteria (for choosing checkpoints) individually on private institutional validation data should be revisited. We believe a better methodology may be to monitor global validation accuracy since the accuracy on the other institution’s dataset is withheld and may give a better indicator of performance. This is evident from the deviation between within-site performance on validation and test sets, which was especially bad for UCLA with -15.4% classification accuracy and -45% lesion segmentation IoU.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">In terms of federated learning, due to current limitations of the NVFlare framework, the server requires a small GPU to implement the central update. We believe this can be resolved in a future update to <span id="S6.p3.1.1" class="ltx_text ltx_font_typewriter">FLtools</span> by performing aggregation on the central server, but pushing the weight update with all appropriate momentum terms to each client. Note that the presented <span id="S6.p3.1.2" class="ltx_text ltx_font_typewriter">FedSGD</span> technique implemented in <span id="S6.p3.1.3" class="ltx_text ltx_font_typewriter">FLComponents</span> achieves <math id="S6.p3.1.m1.1" class="ltx_Math" alttext="O(1)" display="inline"><semantics id="S6.p3.1.m1.1a"><mrow id="S6.p3.1.m1.1.2" xref="S6.p3.1.m1.1.2.cmml"><mi id="S6.p3.1.m1.1.2.2" xref="S6.p3.1.m1.1.2.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.p3.1.m1.1.2.1" xref="S6.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S6.p3.1.m1.1.2.3.2" xref="S6.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S6.p3.1.m1.1.2.3.2.1" xref="S6.p3.1.m1.1.2.cmml">(</mo><mn id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml">1</mn><mo stretchy="false" id="S6.p3.1.m1.1.2.3.2.2" xref="S6.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.2.cmml" xref="S6.p3.1.m1.1.2"><times id="S6.p3.1.m1.1.2.1.cmml" xref="S6.p3.1.m1.1.2.1"></times><ci id="S6.p3.1.m1.1.2.2.cmml" xref="S6.p3.1.m1.1.2.2">𝑂</ci><cn type="integer" id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">O(1)</annotation></semantics></math> memory complexity with respect to the number of clients, and thus is highly scalable for training with 100’s of research sites.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">However, one practical issue with <span id="S6.p4.1.1" class="ltx_text ltx_font_typewriter">FedSGD</span> is that it has a relatively high time and communication complexity <math id="S6.p4.1.m1.1" class="ltx_Math" alttext="O(n)" display="inline"><semantics id="S6.p4.1.m1.1a"><mrow id="S6.p4.1.m1.1.2" xref="S6.p4.1.m1.1.2.cmml"><mi id="S6.p4.1.m1.1.2.2" xref="S6.p4.1.m1.1.2.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S6.p4.1.m1.1.2.1" xref="S6.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S6.p4.1.m1.1.2.3.2" xref="S6.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S6.p4.1.m1.1.2.3.2.1" xref="S6.p4.1.m1.1.2.cmml">(</mo><mi id="S6.p4.1.m1.1.1" xref="S6.p4.1.m1.1.1.cmml">n</mi><mo stretchy="false" id="S6.p4.1.m1.1.2.3.2.2" xref="S6.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p4.1.m1.1b"><apply id="S6.p4.1.m1.1.2.cmml" xref="S6.p4.1.m1.1.2"><times id="S6.p4.1.m1.1.2.1.cmml" xref="S6.p4.1.m1.1.2.1"></times><ci id="S6.p4.1.m1.1.2.2.cmml" xref="S6.p4.1.m1.1.2.2">𝑂</ci><ci id="S6.p4.1.m1.1.1.cmml" xref="S6.p4.1.m1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.1.m1.1c">O(n)</annotation></semantics></math>, since it must wait until every client responds before updating the global model <span id="S6.p4.1.2" class="ltx_text ltx_font_italic">at every iteration</span>. In this respect, <span id="S6.p4.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span> may be a more desirable aggregation strategy, although the training dynamics have not yet been explored with UCNet and prostate MRI. As such, one option to reduce the complexity constants for <span id="S6.p4.1.4" class="ltx_text ltx_font_typewriter">FedSGD</span> may be to implement asynchronous peer-to-peer distribution of gradients and local update of weights, with the central server only acting to globally update momentum terms. We leave this as future work for <span id="S6.p4.1.5" class="ltx_text ltx_font_typewriter">FLtools</span>.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We develop and open-source a federated learning toolkit <span id="S7.p1.1.1" class="ltx_text ltx_font_typewriter">FLtools</span> that is built on NVFlare and provides extensible and reusable features to researchers with custom deep learning models and workflows, or with heterogeneous datasets that can vary in specification across clients in a federation. We successfully applied this toolkit to a custom UCNet deep learning model we developed to handle diverse prostate MRI and associated radiological and histopathology annotation, demonstrating between 9.50-14.8% improvement in generalization performance. However, within site performance has not yet improved, indicating that the full potential of federated learning has not yet been realized for prostate MRI even with 1800+ exams. This provides motivation for inclusion of even more multi-institution prostate MRI using federated learning.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to thank Dr. Karthik Sarma (UCLA) for providing insight into the radiological problem of prostate cancer classification. We would like to thank NVidia, the UCSF Center for Intelligent Imaging (CI<sup id="Sx1.p1.1.1" class="ltx_sup">2</sup>), and Jed Chan (UCSF), for developing and supporting the network infrastructure and tooling to enable this work.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
H. Sung, J. Ferlay, R. L. Siegel, M. Laversanne, I. Soerjomataram, A. Jemal,
and F. Bray, “Global cancer statistics 2020: Globocan estimates of incidence
and mortality worldwide for 36 cancers in 185 countries,” </span><span id="bib.bib1.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CA: a cancer
journal for clinicians</span><span id="bib.bib1.3.3" class="ltx_text" style="font-size:90%;">, vol. 71, no. 3, pp. 209–249, 2021.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
B. Turkbey and P. L. Choyke, “Multiparametric mri and prostate cancer
diagnosis and risk stratification,” </span><span id="bib.bib2.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Current opinion in urology</span><span id="bib.bib2.3.3" class="ltx_text" style="font-size:90%;">,
vol. 22, no. 4, p. 310, 2012.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
J. I. Epstein, L. Egevad, M. B. Amin, B. Delahunt, J. R. Srigley, and P. A.
Humphrey, “The 2014 international society of urological pathology (isup)
consensus conference on gleason grading of prostatic carcinoma,” </span><span id="bib.bib3.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">The
American journal of surgical pathology</span><span id="bib.bib3.3.3" class="ltx_text" style="font-size:90%;">, vol. 40, no. 2, pp. 244–252, 2016.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
A. C. Westphalen, C. E. McCulloch, J. M. Anaokar, S. Arora, N. S. Barashi,
J. O. Barentsz, T. K. Bathala, L. K. Bittencourt, M. T. Booker, V. G.
Braxton, </span><span id="bib.bib4.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib4.3.3" class="ltx_text" style="font-size:90%;">, “Variability of the positive predictive value of
pi-rads for prostate mri across 26 centers: experience of the society of
abdominal radiology prostate cancer disease-focused panel,” </span><span id="bib.bib4.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Radiology</span><span id="bib.bib4.5.5" class="ltx_text" style="font-size:90%;">,
vol. 296, no. 1, pp. 76–84, 2020.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
R. Cao, A. M. Bajgiran, S. A. Mirak, S. Shakeri, X. Zhong, D. Enzmann,
S. Raman, and K. Sung, “Joint prostate cancer detection and gleason score
prediction in mp-mri via focalnet,” </span><span id="bib.bib5.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE transactions on medical
imaging</span><span id="bib.bib5.3.3" class="ltx_text" style="font-size:90%;">, vol. 38, no. 11, pp. 2496–2506, 2019.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
P. Schelb, S. Kohl, J. P. Radtke, M. Wiesenfarth, P. Kickingereder,
S. Bickelhaupt, T. A. Kuder, A. Stenzinger, M. Hohenfellner, H.-P. Schlemmer,
</span><span id="bib.bib6.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib6.3.3" class="ltx_text" style="font-size:90%;">, “Classification of cancer at prostate mri: deep learning
versus clinical pi-rads assessment,” </span><span id="bib.bib6.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Radiology</span><span id="bib.bib6.5.5" class="ltx_text" style="font-size:90%;">, vol. 293, no. 3,
pp. 607–617, 2019.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
S. Mehralivand, D. Yang, S. A. Harmon, D. Xu, Z. Xu, H. Roth, S. Masoudi,
D. Kesani, N. Lay, M. J. Merino, </span><span id="bib.bib7.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib7.3.3" class="ltx_text" style="font-size:90%;">, “Deep learning-based
artificial intelligence for prostate cancer detection at biparametric mri,”
</span><span id="bib.bib7.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Abdominal Radiology</span><span id="bib.bib7.5.5" class="ltx_text" style="font-size:90%;">, vol. 47, no. 4, pp. 1425–1434, 2022.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
K. V. Sarma, S. Harmon, T. Sanford, H. R. Roth, Z. Xu, J. Tetreault, D. Xu,
M. G. Flores, A. G. Raman, R. Kulkarni, </span><span id="bib.bib8.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib8.3.3" class="ltx_text" style="font-size:90%;">, “Federated learning
improves site performance in multicenter deep learning without data
sharing,” </span><span id="bib.bib8.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of the American Medical Informatics Association</span><span id="bib.bib8.5.5" class="ltx_text" style="font-size:90%;">,
vol. 28, no. 6, pp. 1259–1264, 2021.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
R. S. Antunes, C. A. da Costa, A. Küderle, I. A. Yari, and B. Eskofier,
“Federated learning for healthcare: Systematic review and architecture
proposal,” </span><span id="bib.bib9.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Transactions on Intelligent Systems and Technology
(TIST)</span><span id="bib.bib9.3.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
NVIDIA, “Nvidia federated learning application runtime environment,” </span><span id="bib.bib10.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">https://github.com/NVIDIA/NVFlare</span><span id="bib.bib10.3.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
H. B. McMahan </span><span id="bib.bib11.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib11.3.3" class="ltx_text" style="font-size:90%;">, “Advances and open problems in federated
learning,” </span><span id="bib.bib11.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Foundations and Trends® in Machine
Learning</span><span id="bib.bib11.5.5" class="ltx_text" style="font-size:90%;">, vol. 14, no. 1, 2021.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Z. Yan, J. Wicaksana, Z. Wang, X. Yang, and K.-T. Cheng, “Variation-aware
federated learning with multi-source decentralized medical image data,” </span><span id="bib.bib12.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Journal of Biomedical and Health Informatics</span><span id="bib.bib12.3.3" class="ltx_text" style="font-size:90%;">, vol. 25, no. 7,
pp. 2615–2628, 2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
K. V. Sarma, A. G. Raman, N. J. Dhinagar, A. M. Priester, S. Harmon,
T. Sanford, S. Mehralivand, B. Turkbey, L. S. Marks, S. S. Raman, </span><span id="bib.bib13.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib13.3.3" class="ltx_text" style="font-size:90%;">, “Harnessing clinical annotations to improve deep learning
performance in prostate segmentation,” </span><span id="bib.bib13.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Plos one</span><span id="bib.bib13.5.5" class="ltx_text" style="font-size:90%;">, vol. 16, no. 6,
p. e0253829, 2021.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
O. J. Pellicer-Valero, J. L. Marenco Jiménez, V. Gonzalez-Perez, J. L.
Casanova Ramón-Borja, I. Martín García, M. Barrios Benito,
P. Pelechano Gómez, J. Rubio-Briones, M. J. Rupérez, and J. D.
Martín-Guerrero, “Deep learning for fully automatic detection,
segmentation, and gleason grade estimation of prostate cancer in
multiparametric magnetic resonance images,” </span><span id="bib.bib14.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific reports</span><span id="bib.bib14.3.3" class="ltx_text" style="font-size:90%;">,
vol. 12, no. 1, pp. 1–13, 2022.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
W. Falcon </span><span id="bib.bib15.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">et al.</span><span id="bib.bib15.3.3" class="ltx_text" style="font-size:90%;">, “Pytorch lightning,” </span><span id="bib.bib15.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">GitHub. Note:
https://github. com/PyTorchLightning/pytorch-lightning</span><span id="bib.bib15.5.5" class="ltx_text" style="font-size:90%;">, vol. 3, p. 6, 2019.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
O. Ronneberger, P. Fischer, and T. Brox, “U-net: Convolutional networks for
biomedical image segmentation,” in </span><span id="bib.bib16.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Medical
image computing and computer-assisted intervention</span><span id="bib.bib16.3.3" class="ltx_text" style="font-size:90%;">, pp. 234–241, Springer,
2015.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
A. Rajagopal, V. C. Madala, T. A. Hope, and P. Larson, “Understanding and
Visualizing Generalization in UNets,” in </span><span id="bib.bib17.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Medical Imaging with Deep
Learning</span><span id="bib.bib17.3.3" class="ltx_text" style="font-size:90%;">, pp. 665–681, PMLR, 2021.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2206.05616" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2206.05617" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2206.05617">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2206.05617" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2206.05618" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 17:10:05 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
