<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2204.13399] Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features</title><meta property="og:description" content="Federated learning (FL) provides a privacy-preserving solution for distributed machine learning tasks. One challenging problem that severely damages the performance of FL models is the co-occurrence of data heterogenei…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2204.13399">

<!--Generated on Mon Feb 26 23:55:35 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xinyi Shang<sup id="id7.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yang Lu<sup id="id8.2.id1" class="ltx_sup">1</sup>
</span><span class="ltx_author_notes">Corresponding author: Yang Lu, luyang@xmu.edu.cn</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gang Huang<sup id="id9.5.id1" class="ltx_sup">2</sup>
&amp;Hanzi Wang<sup id="id10.6.id2" class="ltx_sup">1</sup>
<sup id="id11.7.id3" class="ltx_sup">1</sup>Fujian Key Laboratory of Sensing and Computing for Smart Cities, School of Informatics, 
<br class="ltx_break">Xiamen University, Xiamen, China
<br class="ltx_break"><sup id="id12.8.id4" class="ltx_sup">2</sup> Zhejiang Lab, Hangzhou, China
shangxinyi@stu.xmu.edu.cn, luyang@xmu.edu.cn, huanggang@zju.edu.cn, hanzi.wang@xmu.edu.cn
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id13.id1" class="ltx_p">Federated learning (FL) provides a privacy-preserving solution for distributed machine learning tasks. One challenging problem that severely damages the performance of FL models is the co-occurrence of data heterogeneity and long-tail distribution, which frequently appears in real FL applications. In this paper, we reveal an intriguing fact that the biased classifier is the primary factor leading to the poor performance of the global model. Motivated by the above finding, we propose a novel and privacy-preserving FL method for heterogeneous and long-tailed data via Classifier Re-training with Federated Features (CReFF). The classifier re-trained on federated features can produce comparable performance as the one re-trained on real data in a privacy-preserving manner without information leakage of local data or class distribution. Experiments on several benchmark datasets show that the proposed CReFF is an effective solution to obtain a promising FL model under heterogeneous and long-tailed data. Comparative results with the state-of-the-art FL methods also validate the superiority of CReFF. Our code is available at <a target="_blank" href="https://github.com/shangxinyi/CReFF-FL" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="color:#FF00FF;">https://github.com/shangxinyi/CReFF-FL</a><span id="id13.id1.1" class="ltx_text" style="color:#000000;">.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The emergence of federated learning (FL) enables multiple clients to collaboratively learn a powerful global model without transmitting local private data to the server.
Serving as a communication-efficient and privacy-preserving learning framework, FL has shown its potential to facilitate real-world applications in multiple domains, e.g., natural language processing <cite class="ltx_cite ltx_citemacro_cite">Jiang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> and fraudulent credit card detection <cite class="ltx_cite ltx_citemacro_cite">Zheng <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>.
However, during FL model training, one major practical challenge is data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2020a</a>)</cite>. In the FL environment, data generated or collected by different clients may come from various sources, which results in distribution discrepancy between clients.
Moreover, real-world data often exhibits long-tail distribution with heavy class imbalance, where the number of samples in some classes (called head classes) severely outnumbers that in some other classes (called tail classes).
Building an unbiased classification model on data with this kind of distribution is termed long-tail learning, which has been extensively studied in recent years <cite class="ltx_cite ltx_citemacro_cite">Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>.
In the FL scenario, if the training data across clients is long-tailed and heterogeneous at the same time, the joint problem becomes complicated and challenging because each client may hold different tail classes.
For example, medical institutions aim to build a diagnosis model on private patient records, which are held by each institution locally. Each institution has different disease distributions, and different diseases make up long-tail distribution because some diseases are common and others are rare. Adopting FL in this case, local models will poorly perform on different tail classes due to data heterogeneity and long-tail distribution, and the aggregated global model will also be affected.
One straightforward way is to simply adopt existing long-tail learning methods to the joint problem in FL.
However, most of these methods require the information of local or global class distribution as prior knowledge for optimization, which may expose potential privacy issues.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2204.13399/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_img_square" width="461" height="375" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2204.13399/assets/x2.png" id="S1.F1.2.g1" class="ltx_graphics ltx_img_square" width="461" height="375" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">The performance of re-training the classifier of a FedAvg model using the same amount of data but from different sources. Real data is directly collected from clients, and federated features are synthesized by the proposed CReFF.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.6" class="ltx_p">One of the recent advances in long-tail learning is decoupling the training process into representation learning and classifier re-training <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>. That is, with the trained feature extractor fixed, a biased classifier is re-trained using a set of balanced data, which is also called two-stage learning. In the FL framework, an FL model can also be decoupled into two-stage training, where the feature extractor is obtained by aggregating client models and the classifier is re-trained on the server using a set of balanced data.
We conduct a quick experiment on CIFAR-10-LT (the long-tailed version of CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">Cao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>) to show that two-stage learning performs well on heterogeneous and long-tailed data in FL. We use imbalance factors (<span id="S1.p2.6.1" class="ltx_text ltx_markedasmath">IF</span>) and the Dirichlet distribution coefficient <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S1.p2.2.m2.1a"><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">\alpha</annotation></semantics></math> to control the degree of long-tail and heterogeneity, respectively. Higher <span id="S1.p2.6.2" class="ltx_text ltx_markedasmath">IF</span> means a higher degree of imbalance degree, and lower <math id="S1.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S1.p2.4.m4.1a"><mi id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><ci id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">\alpha</annotation></semantics></math> means a higher degree of heterogeneity.
Given a global model pre-trained on heterogeneous and long-tailed data, we fix its feature extractor and re-train its classifier on the server with a small balanced dataset (100 per class) collected from clients.
It can be observed in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> that the strategy is particularly useful and the classification performance is significantly improved.
In particular, re-training classifier achieves the highest performance gain of 18% when <math id="S1.p2.5.m5.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S1.p2.5.m5.1a"><mrow id="S1.p2.5.m5.1.1" xref="S1.p2.5.m5.1.1.cmml"><mtext id="S1.p2.5.m5.1.1.2" xref="S1.p2.5.m5.1.1.2a.cmml">IF</mtext><mo id="S1.p2.5.m5.1.1.1" xref="S1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S1.p2.5.m5.1.1.3" xref="S1.p2.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.5.m5.1b"><apply id="S1.p2.5.m5.1.1.cmml" xref="S1.p2.5.m5.1.1"><eq id="S1.p2.5.m5.1.1.1.cmml" xref="S1.p2.5.m5.1.1.1"></eq><ci id="S1.p2.5.m5.1.1.2a.cmml" xref="S1.p2.5.m5.1.1.2"><mtext id="S1.p2.5.m5.1.1.2.cmml" xref="S1.p2.5.m5.1.1.2">IF</mtext></ci><cn type="integer" id="S1.p2.5.m5.1.1.3.cmml" xref="S1.p2.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">\textrm{IF}=100</annotation></semantics></math> and <math id="S1.p2.6.m6.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S1.p2.6.m6.1a"><mrow id="S1.p2.6.m6.1.1" xref="S1.p2.6.m6.1.1.cmml"><mi id="S1.p2.6.m6.1.1.2" xref="S1.p2.6.m6.1.1.2.cmml">α</mi><mo id="S1.p2.6.m6.1.1.1" xref="S1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S1.p2.6.m6.1.1.3" xref="S1.p2.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.6.m6.1b"><apply id="S1.p2.6.m6.1.1.cmml" xref="S1.p2.6.m6.1.1"><eq id="S1.p2.6.m6.1.1.1.cmml" xref="S1.p2.6.m6.1.1.1"></eq><ci id="S1.p2.6.m6.1.1.2.cmml" xref="S1.p2.6.m6.1.1.2">𝛼</ci><cn type="float" id="S1.p2.6.m6.1.1.3.cmml" xref="S1.p2.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.6.m6.1c">\alpha=0.1</annotation></semantics></math> (the rightmost grey bar in the left subfigure of Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), which is an extremely heterogeneous and long-tailed setting.
However, this prerequisite of using a shared balanced dataset on the server is infeasible for most FL practical scenarios due to privacy concerns.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Motivated by the idea of two-stage learning and the privacy concerns of FL, we propose a novel and privacy-preserving FL method called Classifier Re-training with Federated Features (CReFF) to deal with the joint problem of data heterogeneity and long-tail distribution.
We learn a set of balanced features called <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">federated features</span> because only the classifier needs to be re-trained on the server.
It is based on an intuitive idea that the classifier re-trained on federated features should produce comparable performance as the one re-trained on the real data, which can be achieved by making two classifiers similar.
Therefore, the classifier re-training optimization on federated features should follow the similar path as that of the real data. Specifically, we optimize the federated features to make their gradients close to the gradients of real data.
As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the classifier re-trained on federated features (orange bars) achieves comparable performance as the one re-trained on real data (grey bars). Extensive experiments show that CReFF significantly outperforms the state-of-the-art federated learning methods on image classification tasks with heterogeneous and long-tailed data distribution.
The contributions of this paper can be summarized as follows:
</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We study the joint problem of FL with heterogeneous and long-tailed data distribution, where the local and global class distribution is unknown to the server.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We reveal an intriguing fact that the biased classifier is the primary factor leading to the poor performance of an FL global model on heterogeneous and long-tailed data.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose CReFF, a novel FL algorithm to deal with heterogeneous and long-tailed data by re-training the classifier with learnable federated features on the server. CReFF has no privacy concerns because no real data or information of class distribution is required.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning with Heterogeneous Data</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">A variety of solutions have been proposed to tackle data heterogeneity in FL,
which are mainly from two perspectives: One focuses on optimization strategies to make the diversity between client models and global model limited <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2020b</a>); Huang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite>; the other adopt mechanisms on the server to alleviate the negative influence of data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>); Chen and Chao (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>.
For example, CCVR <cite class="ltx_cite ltx_citemacro_cite">Luo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> deals with data heterogeneity via classifier re-training using virtual features sampled from an approximated Gaussian mixture model.
Although the abovementioned methods solve the data heterogeneity to some extent, they poorly perform on the tail classes due to the lack of consideration of the global long-tail distribution.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Some FL methods are designed for imbalanced data (not specifically long-tailed). One strategy is to adopt client selection to match clients with complementary class distribution <cite class="ltx_cite ltx_citemacro_cite">Duan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>); Yang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>. In this case, all clients are required to upload their local class distributions to the server, which violates the principle of privacy protection of FL.
Ratio loss <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2021a</a>)</cite> utilizes balanced auxiliary data on the server to estimate the global class distribution for better local optimization. However, as we mentioned above, the auxiliary data is not available on the server in real applications. Compared with these related methods, the proposed CReFF has no privacy concerns because no real data or information of class distribution is required.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Long-tail learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Recently, long-tail learning has drawn much interest in deep learning <cite class="ltx_cite ltx_citemacro_cite">Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>. Some methods follow the ideas of imbalance learning to augment the feature space for rare classes <cite class="ltx_cite ltx_citemacro_cite">Kim <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>); Zang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite> or re-weight different classes according to their frequencies <cite class="ltx_cite ltx_citemacro_cite">Cao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>.
Some recent methods decouple the training phase into representation learning and classifier re-training <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, which generate more generalizable representations and achieve strong performance after re-balancing the classifier. Based on decoupling, ensemble-based methods <cite class="ltx_cite ltx_citemacro_cite">Xiang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>); Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2021b</a>)</cite> adopt a multi-expert framework to learn diverse classifiers in parallel, which reduces the model bias towards the tail classes. However, most of them require the global class distribution, as we mentioned above. During FL model training, it is infeasible to gather the information of class distribution of each client to obtain the global class distribution, which makes the vast majority of long-tail learning methods not applicable to FL scenarios.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.22" class="ltx_p"><span id="S3.SS1.p1.22.1" class="ltx_text ltx_font_bold">Settings and Notations.</span> We discuss a typical FL setting with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients holding potentially heterogeneous data partition <math id="S3.SS1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}" display="inline"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4.3" xref="S3.SS1.p1.2.m2.4.4.4.cmml"><msup id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.p1.2.m2.4.4.3.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><msup id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">2</mn></msup><mo id="S3.SS1.p1.2.m2.4.4.3.5" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.3.6" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><msup id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><list id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">superscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝒟</ci><cn type="integer" id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3">superscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}</annotation></semantics></math>, respectively. The goal is to learn a global model over the whole training data <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{k}\mathcal{D}^{k}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">≜</mo><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><msub id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.3.1.2" xref="S3.SS1.p1.3.m3.1.1.3.1.2.cmml">⋃</mo><mi id="S3.SS1.p1.3.m3.1.1.3.1.3" xref="S3.SS1.p1.3.m3.1.1.3.1.3.cmml">k</mi></msub><msup id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.1.1.3.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><ci id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">≜</ci><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒟</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><apply id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1">subscript</csymbol><union id="S3.SS1.p1.3.m3.1.1.3.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1.2"></union><ci id="S3.SS1.p1.3.m3.1.1.3.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{D}\triangleq\bigcup_{k}\mathcal{D}^{k}</annotation></semantics></math> with the help of a central server without data transmitting.
In this paper, we consider the setting when <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{D}</annotation></semantics></math> is drawn from a long-tail distribution <math id="S3.SS1.p1.5.m5.7" class="ltx_Math" alttext="\mathcal{X}=\{\mathbf{x}_{i},y_{i}\}|_{i=1}^{N},y_{i}\in\{1,...,C\}" display="inline"><semantics id="S3.SS1.p1.5.m5.7a"><mrow id="S3.SS1.p1.5.m5.7.7.2" xref="S3.SS1.p1.5.m5.7.7.3.cmml"><mrow id="S3.SS1.p1.5.m5.6.6.1.1" xref="S3.SS1.p1.5.m5.6.6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.6.6.1.1.3" xref="S3.SS1.p1.5.m5.6.6.1.1.3.cmml">𝒳</mi><mo id="S3.SS1.p1.5.m5.6.6.1.1.2" xref="S3.SS1.p1.5.m5.6.6.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.5.m5.6.6.1.1.1.1" xref="S3.SS1.p1.5.m5.6.6.1.1.1.2.cmml"><mrow id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1" xref="S3.SS1.p1.5.m5.6.6.1.1.1.2.cmml"><mrow id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.3.cmml">{</mo><msub id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.5" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.3.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.6.6.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml">i</mi><mo id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.cmml">=</mo><mn id="S3.SS1.p1.5.m5.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.5.m5.2.2.1" xref="S3.SS1.p1.5.m5.2.2.1.cmml">N</mi></msubsup></mrow><mo id="S3.SS1.p1.5.m5.7.7.2.3" xref="S3.SS1.p1.5.m5.7.7.3a.cmml">,</mo><mrow id="S3.SS1.p1.5.m5.7.7.2.2" xref="S3.SS1.p1.5.m5.7.7.2.2.cmml"><msub id="S3.SS1.p1.5.m5.7.7.2.2.2" xref="S3.SS1.p1.5.m5.7.7.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.7.7.2.2.2.2" xref="S3.SS1.p1.5.m5.7.7.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.5.m5.7.7.2.2.2.3" xref="S3.SS1.p1.5.m5.7.7.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.5.m5.7.7.2.2.1" xref="S3.SS1.p1.5.m5.7.7.2.2.1.cmml">∈</mo><mrow id="S3.SS1.p1.5.m5.7.7.2.2.3.2" xref="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.7.7.2.2.3.2.1" xref="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml">{</mo><mn id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml">1</mn><mo id="S3.SS1.p1.5.m5.7.7.2.2.3.2.2" xref="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.4.4" xref="S3.SS1.p1.5.m5.4.4.cmml">…</mi><mo id="S3.SS1.p1.5.m5.7.7.2.2.3.2.3" xref="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.5.m5.5.5" xref="S3.SS1.p1.5.m5.5.5.cmml">C</mi><mo stretchy="false" id="S3.SS1.p1.5.m5.7.7.2.2.3.2.4" xref="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.7b"><apply id="S3.SS1.p1.5.m5.7.7.3.cmml" xref="S3.SS1.p1.5.m5.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.7.7.3a.cmml" xref="S3.SS1.p1.5.m5.7.7.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.5.m5.6.6.1.1.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1"><eq id="S3.SS1.p1.5.m5.6.6.1.1.2.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.2"></eq><ci id="S3.SS1.p1.5.m5.6.6.1.1.3.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.3">𝒳</ci><apply id="S3.SS1.p1.5.m5.6.6.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.6.6.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.2">evaluated-at</csymbol><set id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2"><apply id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.6.6.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"><eq id="S3.SS1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"></eq><ci id="S3.SS1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.5.m5.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.2.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1">𝑁</ci></apply></apply><apply id="S3.SS1.p1.5.m5.7.7.2.2.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2"><in id="S3.SS1.p1.5.m5.7.7.2.2.1.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.1"></in><apply id="S3.SS1.p1.5.m5.7.7.2.2.2.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.7.7.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.7.7.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.5.m5.7.7.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.2.3">𝑖</ci></apply><set id="S3.SS1.p1.5.m5.7.7.2.2.3.1.cmml" xref="S3.SS1.p1.5.m5.7.7.2.2.3.2"><cn type="integer" id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3">1</cn><ci id="S3.SS1.p1.5.m5.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4">…</ci><ci id="S3.SS1.p1.5.m5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5">𝐶</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.7c">\mathcal{X}=\{\mathbf{x}_{i},y_{i}\}|_{i=1}^{N},y_{i}\in\{1,...,C\}</annotation></semantics></math>.
Let <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="n_{c}^{k}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msubsup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">n</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">c</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝑛</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">n_{c}^{k}</annotation></semantics></math> be the number of samples of class <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">c</annotation></semantics></math> on client <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">k</annotation></semantics></math>, and <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="n_{c}=\sum_{k=1}^{K}n_{c}^{k}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><msub id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">n</mi><mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">c</mi></msub><mo rspace="0.111em" id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><msubsup id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml"><mo id="S3.SS1.p1.9.m9.1.1.3.1.2.2" xref="S3.SS1.p1.9.m9.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.9.m9.1.1.3.1.2.3" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.1.2.3.2" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.9.m9.1.1.3.1.2.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.9.m9.1.1.3.1.2.3.3" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.9.m9.1.1.3.1.3" xref="S3.SS1.p1.9.m9.1.1.3.1.3.cmml">K</mi></msubsup><msubsup id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2.2.2" xref="S3.SS1.p1.9.m9.1.1.3.2.2.2.cmml">n</mi><mi id="S3.SS1.p1.9.m9.1.1.3.2.2.3" xref="S3.SS1.p1.9.m9.1.1.3.2.2.3.cmml">c</mi><mi id="S3.SS1.p1.9.m9.1.1.3.2.3" xref="S3.SS1.p1.9.m9.1.1.3.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><eq id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></eq><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">𝑛</ci><ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">𝑐</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><apply id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.3.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p1.9.m9.1.1.3.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.2"></sum><apply id="S3.SS1.p1.9.m9.1.1.3.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3"><eq id="S3.SS1.p1.9.m9.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p1.9.m9.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.9.m9.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.9.m9.1.1.3.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">superscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.2.2">𝑛</ci><ci id="S3.SS1.p1.9.m9.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">n_{c}=\sum_{k=1}^{K}n_{c}^{k}</annotation></semantics></math>.
Without loss of generality, a common assumption in long-tail learning is that the classes are sorted by cardinality in non-increasing order, i.e., if <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="c_{1}&lt;c_{2}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><msub id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.2.2.cmml">c</mi><mn id="S3.SS1.p1.10.m10.1.1.2.3" xref="S3.SS1.p1.10.m10.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">&lt;</mo><msub id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">c</mi><mn id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><lt id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"></lt><apply id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2.2">𝑐</ci><cn type="integer" id="S3.SS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.2.3">1</cn></apply><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑐</ci><cn type="integer" id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">c_{1}&lt;c_{2}</annotation></semantics></math>, we have <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="n_{c_{1}}\geq n_{c_{2}}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">n</mi><msub id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.3.2" xref="S3.SS1.p1.11.m11.1.1.2.3.2.cmml">c</mi><mn id="S3.SS1.p1.11.m11.1.1.2.3.3" xref="S3.SS1.p1.11.m11.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">≥</mo><msub id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">n</mi><msub id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.3.2" xref="S3.SS1.p1.11.m11.1.1.3.3.2.cmml">c</mi><mn id="S3.SS1.p1.11.m11.1.1.3.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><geq id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></geq><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝑛</ci><apply id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.2">𝑐</ci><cn type="integer" id="S3.SS1.p1.11.m11.1.1.2.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">𝑛</ci><apply id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.2">𝑐</ci><cn type="integer" id="S3.SS1.p1.11.m11.1.1.3.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">n_{c_{1}}\geq n_{c_{2}}</annotation></semantics></math> and <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="n_{1}\gg n_{C}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><msub id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2.2" xref="S3.SS1.p1.12.m12.1.1.2.2.cmml">n</mi><mn id="S3.SS1.p1.12.m12.1.1.2.3" xref="S3.SS1.p1.12.m12.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml">≫</mo><msub id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">n</mi><mi id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="latexml" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1">much-greater-than</csymbol><apply id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.2">𝑛</ci><cn type="integer" id="S3.SS1.p1.12.m12.1.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3">1</cn></apply><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">n_{1}\gg n_{C}</annotation></semantics></math>.
For an FL model, we typically consider a neural network <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\phi_{\mathbf{w}}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\phi_{\mathbf{w}}</annotation></semantics></math> with parameters <math id="S3.SS1.p1.14.m14.2" class="ltx_Math" alttext="\mathbf{w}=\{\mathbf{u},\mathbf{v}\}" display="inline"><semantics id="S3.SS1.p1.14.m14.2a"><mrow id="S3.SS1.p1.14.m14.2.3" xref="S3.SS1.p1.14.m14.2.3.cmml"><mi id="S3.SS1.p1.14.m14.2.3.2" xref="S3.SS1.p1.14.m14.2.3.2.cmml">𝐰</mi><mo id="S3.SS1.p1.14.m14.2.3.1" xref="S3.SS1.p1.14.m14.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.14.m14.2.3.3.2" xref="S3.SS1.p1.14.m14.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.2.3.3.2.1" xref="S3.SS1.p1.14.m14.2.3.3.1.cmml">{</mo><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">𝐮</mi><mo id="S3.SS1.p1.14.m14.2.3.3.2.2" xref="S3.SS1.p1.14.m14.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.14.m14.2.2" xref="S3.SS1.p1.14.m14.2.2.cmml">𝐯</mi><mo stretchy="false" id="S3.SS1.p1.14.m14.2.3.3.2.3" xref="S3.SS1.p1.14.m14.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.2b"><apply id="S3.SS1.p1.14.m14.2.3.cmml" xref="S3.SS1.p1.14.m14.2.3"><eq id="S3.SS1.p1.14.m14.2.3.1.cmml" xref="S3.SS1.p1.14.m14.2.3.1"></eq><ci id="S3.SS1.p1.14.m14.2.3.2.cmml" xref="S3.SS1.p1.14.m14.2.3.2">𝐰</ci><set id="S3.SS1.p1.14.m14.2.3.3.1.cmml" xref="S3.SS1.p1.14.m14.2.3.3.2"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝐮</ci><ci id="S3.SS1.p1.14.m14.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2">𝐯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.2c">\mathbf{w}=\{\mathbf{u},\mathbf{v}\}</annotation></semantics></math>. It has two main components: 1) a feature extractor <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="f_{\mathbf{u}}" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">𝐮</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑓</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝐮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">f_{\mathbf{u}}</annotation></semantics></math> with parameters <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">\mathbf{u}</annotation></semantics></math>, mapping each input sample <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><mi id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><ci id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">\mathbf{x}</annotation></semantics></math> to a <math id="S3.SS1.p1.18.m18.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.18.m18.1a"><mi id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><ci id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">d</annotation></semantics></math>-dim feature vector; 2) a classifier <math id="S3.SS1.p1.19.m19.1" class="ltx_Math" alttext="h_{\mathbf{v}}" display="inline"><semantics id="S3.SS1.p1.19.m19.1a"><msub id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml"><mi id="S3.SS1.p1.19.m19.1.1.2" xref="S3.SS1.p1.19.m19.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.19.m19.1.1.3" xref="S3.SS1.p1.19.m19.1.1.3.cmml">𝐯</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><apply id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2">ℎ</ci><ci id="S3.SS1.p1.19.m19.1.1.3.cmml" xref="S3.SS1.p1.19.m19.1.1.3">𝐯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">h_{\mathbf{v}}</annotation></semantics></math> with parameters <math id="S3.SS1.p1.20.m20.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="S3.SS1.p1.20.m20.1a"><mi id="S3.SS1.p1.20.m20.1.1" xref="S3.SS1.p1.20.m20.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.1b"><ci id="S3.SS1.p1.20.m20.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.1c">\mathbf{v}</annotation></semantics></math>, typically being a fully-connected layer which outputs logits to denote class confidence scores. The parameters of the <math id="S3.SS1.p1.21.m21.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.21.m21.1a"><mi id="S3.SS1.p1.21.m21.1.1" xref="S3.SS1.p1.21.m21.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.1b"><ci id="S3.SS1.p1.21.m21.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.1c">k</annotation></semantics></math>th client local model are denoted as <math id="S3.SS1.p1.22.m22.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="S3.SS1.p1.22.m22.1a"><msub id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml"><mi id="S3.SS1.p1.22.m22.1.1.2" xref="S3.SS1.p1.22.m22.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.22.m22.1.1.3" xref="S3.SS1.p1.22.m22.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.1b"><apply id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1">subscript</csymbol><ci id="S3.SS1.p1.22.m22.1.1.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2">𝐰</ci><ci id="S3.SS1.p1.22.m22.1.1.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.1c">\mathbf{w}_{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.4" class="ltx_p"><span id="S3.SS1.p2.4.1" class="ltx_text ltx_font_bold">Basic Algorithm of Federated Learning.</span> FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite> is the fundamental algorithm for FL. In round <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t</annotation></semantics></math>, the server first sends a global model <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{t}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msup id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐰</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{w}^{t}</annotation></semantics></math> to clients. The clients then update the received model on their local data <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathcal{D}^{k}</annotation></semantics></math>, <math id="S3.SS1.p2.4.m4.3" class="ltx_Math" alttext="k=1,...,K" display="inline"><semantics id="S3.SS1.p2.4.m4.3a"><mrow id="S3.SS1.p2.4.m4.3.4" xref="S3.SS1.p2.4.m4.3.4.cmml"><mi id="S3.SS1.p2.4.m4.3.4.2" xref="S3.SS1.p2.4.m4.3.4.2.cmml">k</mi><mo id="S3.SS1.p2.4.m4.3.4.1" xref="S3.SS1.p2.4.m4.3.4.1.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.3.4.3.2" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml"><mn id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.p2.4.m4.3.4.3.2.1" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p2.4.m4.3.4.3.2.2" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.4.m4.3.3" xref="S3.SS1.p2.4.m4.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.3b"><apply id="S3.SS1.p2.4.m4.3.4.cmml" xref="S3.SS1.p2.4.m4.3.4"><eq id="S3.SS1.p2.4.m4.3.4.1.cmml" xref="S3.SS1.p2.4.m4.3.4.1"></eq><ci id="S3.SS1.p2.4.m4.3.4.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2">𝑘</ci><list id="S3.SS1.p2.4.m4.3.4.3.1.cmml" xref="S3.SS1.p2.4.m4.3.4.3.2"><cn type="integer" id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">1</cn><ci id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2">…</ci><ci id="S3.SS1.p2.4.m4.3.3.cmml" xref="S3.SS1.p2.4.m4.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.3c">k=1,...,K</annotation></semantics></math>:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{k}^{t+1}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla_{\mathbf{w}}\ell(\mathbf{w}^{t};\mathcal{D}^{k})." display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.1.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.4.2.3" xref="S3.E1.m1.1.1.1.1.4.2.3.cmml">k</mi><mrow id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml"><mi id="S3.E1.m1.1.1.1.1.4.3.2" xref="S3.E1.m1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.4.3.1" xref="S3.E1.m1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.4.3.3" xref="S3.E1.m1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">←</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.1.1.1.1.2.4.2.2" xref="S3.E1.m1.1.1.1.1.2.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.2.4.2.3" xref="S3.E1.m1.1.1.1.1.2.4.2.3.cmml">k</mi><mi id="S3.E1.m1.1.1.1.1.2.4.3" xref="S3.E1.m1.1.1.1.1.2.4.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.5.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.5.1" xref="S3.E1.m1.1.1.1.1.2.2.5.1.cmml"><mo rspace="0.167em" id="S3.E1.m1.1.1.1.1.2.2.5.1.2" xref="S3.E1.m1.1.1.1.1.2.2.5.1.2.cmml">∇</mo><mi id="S3.E1.m1.1.1.1.1.2.2.5.1.3" xref="S3.E1.m1.1.1.1.1.2.2.5.1.3.cmml">𝐰</mi></msub><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.2.2.5.2" xref="S3.E1.m1.1.1.1.1.2.2.5.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.3a" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msup id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">;</mo><msup id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">←</ci><apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.4.2.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3"><plus id="S3.E1.m1.1.1.1.1.4.3.1.cmml" xref="S3.E1.m1.1.1.1.1.4.3.1"></plus><ci id="S3.E1.m1.1.1.1.1.4.3.2.cmml" xref="S3.E1.m1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.4.3.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><minus id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"></minus><apply id="S3.E1.m1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.2.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"></times><ci id="S3.E1.m1.1.1.1.1.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.2.4">𝜂</ci><apply id="S3.E1.m1.1.1.1.1.2.2.5.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5"><apply id="S3.E1.m1.1.1.1.1.2.2.5.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.5.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.5.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1.2">∇</ci><ci id="S3.E1.m1.1.1.1.1.2.2.5.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1.3">𝐰</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.5.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.2">ℓ</ci></apply><list id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{w}_{k}^{t+1}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla_{\mathbf{w}}\ell(\mathbf{w}^{t};\mathcal{D}^{k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.6" class="ltx_p">After local updating, some clients in the set <math id="S3.SS1.p2.5.m1.1" class="ltx_Math" alttext="\mathcal{A}^{t}" display="inline"><semantics id="S3.SS1.p2.5.m1.1a"><msup id="S3.SS1.p2.5.m1.1.1" xref="S3.SS1.p2.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m1.1.1.2" xref="S3.SS1.p2.5.m1.1.1.2.cmml">𝒜</mi><mi id="S3.SS1.p2.5.m1.1.1.3" xref="S3.SS1.p2.5.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m1.1b"><apply id="S3.SS1.p2.5.m1.1.1.cmml" xref="S3.SS1.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m1.1.1.1.cmml" xref="S3.SS1.p2.5.m1.1.1">superscript</csymbol><ci id="S3.SS1.p2.5.m1.1.1.2.cmml" xref="S3.SS1.p2.5.m1.1.1.2">𝒜</ci><ci id="S3.SS1.p2.5.m1.1.1.3.cmml" xref="S3.SS1.p2.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m1.1c">\mathcal{A}^{t}</annotation></semantics></math> are selected to upload their updated models to the server. Finally, the server performs weighted average to update the global model for round <math id="S3.SS1.p2.6.m2.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS1.p2.6.m2.1a"><mrow id="S3.SS1.p2.6.m2.1.1" xref="S3.SS1.p2.6.m2.1.1.cmml"><mi id="S3.SS1.p2.6.m2.1.1.2" xref="S3.SS1.p2.6.m2.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.6.m2.1.1.1" xref="S3.SS1.p2.6.m2.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.6.m2.1.1.3" xref="S3.SS1.p2.6.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m2.1b"><apply id="S3.SS1.p2.6.m2.1.1.cmml" xref="S3.SS1.p2.6.m2.1.1"><plus id="S3.SS1.p2.6.m2.1.1.1.cmml" xref="S3.SS1.p2.6.m2.1.1.1"></plus><ci id="S3.SS1.p2.6.m2.1.1.2.cmml" xref="S3.SS1.p2.6.m2.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.6.m2.1.1.3.cmml" xref="S3.SS1.p2.6.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m2.1c">t+1</annotation></semantics></math>:</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}^{t+1}" display="inline"><semantics id="S3.E2.m1.1a"><msup id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝐰</mi><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">+</mo><mn id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐰</ci><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><plus id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></plus><ci id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathbf{w}^{t+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{k\in\mathcal{A}^{t}}\frac{|\mathcal{D}^{k}|}{\sum_{k\in\mathcal{A}^{t}}|\mathcal{D}^{k}|}\mathbf{w}_{k}^{t+1}." display="inline"><semantics id="S3.E2.m2.3a"><mrow id="S3.E2.m2.3.3.1" xref="S3.E2.m2.3.3.1.1.cmml"><mrow id="S3.E2.m2.3.3.1.1" xref="S3.E2.m2.3.3.1.1.cmml"><mi id="S3.E2.m2.3.3.1.1.2" xref="S3.E2.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E2.m2.3.3.1.1.1" xref="S3.E2.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m2.3.3.1.1.3" xref="S3.E2.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.m2.3.3.1.1.3.1" xref="S3.E2.m2.3.3.1.1.3.1.cmml"><munder id="S3.E2.m2.3.3.1.1.3.1a" xref="S3.E2.m2.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m2.3.3.1.1.3.1.2" xref="S3.E2.m2.3.3.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E2.m2.3.3.1.1.3.1.3" xref="S3.E2.m2.3.3.1.1.3.1.3.cmml"><mi id="S3.E2.m2.3.3.1.1.3.1.3.2" xref="S3.E2.m2.3.3.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E2.m2.3.3.1.1.3.1.3.1" xref="S3.E2.m2.3.3.1.1.3.1.3.1.cmml">∈</mo><msup id="S3.E2.m2.3.3.1.1.3.1.3.3" xref="S3.E2.m2.3.3.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.3.3.1.1.3.1.3.3.2" xref="S3.E2.m2.3.3.1.1.3.1.3.3.2.cmml">𝒜</mi><mi id="S3.E2.m2.3.3.1.1.3.1.3.3.3" xref="S3.E2.m2.3.3.1.1.3.1.3.3.3.cmml">t</mi></msup></mrow></munder></mstyle><mrow id="S3.E2.m2.3.3.1.1.3.2" xref="S3.E2.m2.3.3.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E2.m2.2.2" xref="S3.E2.m2.2.2.cmml"><mfrac id="S3.E2.m2.2.2a" xref="S3.E2.m2.2.2.cmml"><mrow id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m2.1.1.1.1.2" xref="S3.E2.m2.1.1.1.2.1.cmml">|</mo><msup id="S3.E2.m2.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.1.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m2.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E2.m2.1.1.1.1.3" xref="S3.E2.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m2.2.2.2" xref="S3.E2.m2.2.2.2.cmml"><msub id="S3.E2.m2.2.2.2.2" xref="S3.E2.m2.2.2.2.2.cmml"><mo id="S3.E2.m2.2.2.2.2.2" xref="S3.E2.m2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m2.2.2.2.2.3" xref="S3.E2.m2.2.2.2.2.3.cmml"><mi id="S3.E2.m2.2.2.2.2.3.2" xref="S3.E2.m2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E2.m2.2.2.2.2.3.1" xref="S3.E2.m2.2.2.2.2.3.1.cmml">∈</mo><msup id="S3.E2.m2.2.2.2.2.3.3" xref="S3.E2.m2.2.2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.2.2.2.2.3.3.2" xref="S3.E2.m2.2.2.2.2.3.3.2.cmml">𝒜</mi><mi id="S3.E2.m2.2.2.2.2.3.3.3" xref="S3.E2.m2.2.2.2.2.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="S3.E2.m2.2.2.2.1.1" xref="S3.E2.m2.2.2.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E2.m2.2.2.2.1.1.2" xref="S3.E2.m2.2.2.2.1.2.1.cmml">|</mo><msup id="S3.E2.m2.2.2.2.1.1.1" xref="S3.E2.m2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.2.2.2.1.1.1.2" xref="S3.E2.m2.2.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m2.2.2.2.1.1.1.3" xref="S3.E2.m2.2.2.2.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E2.m2.2.2.2.1.1.3" xref="S3.E2.m2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2.m2.3.3.1.1.3.2.1" xref="S3.E2.m2.3.3.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E2.m2.3.3.1.1.3.2.2" xref="S3.E2.m2.3.3.1.1.3.2.2.cmml"><mi id="S3.E2.m2.3.3.1.1.3.2.2.2.2" xref="S3.E2.m2.3.3.1.1.3.2.2.2.2.cmml">𝐰</mi><mi id="S3.E2.m2.3.3.1.1.3.2.2.2.3" xref="S3.E2.m2.3.3.1.1.3.2.2.2.3.cmml">k</mi><mrow id="S3.E2.m2.3.3.1.1.3.2.2.3" xref="S3.E2.m2.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E2.m2.3.3.1.1.3.2.2.3.2" xref="S3.E2.m2.3.3.1.1.3.2.2.3.2.cmml">t</mi><mo id="S3.E2.m2.3.3.1.1.3.2.2.3.1" xref="S3.E2.m2.3.3.1.1.3.2.2.3.1.cmml">+</mo><mn id="S3.E2.m2.3.3.1.1.3.2.2.3.3" xref="S3.E2.m2.3.3.1.1.3.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m2.3.3.1.2" xref="S3.E2.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.3b"><apply id="S3.E2.m2.3.3.1.1.cmml" xref="S3.E2.m2.3.3.1"><eq id="S3.E2.m2.3.3.1.1.1.cmml" xref="S3.E2.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E2.m2.3.3.1.1.2.cmml" xref="S3.E2.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E2.m2.3.3.1.1.3.cmml" xref="S3.E2.m2.3.3.1.1.3"><apply id="S3.E2.m2.3.3.1.1.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.1.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E2.m2.3.3.1.1.3.1.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2"></sum><apply id="S3.E2.m2.3.3.1.1.3.1.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3"><in id="S3.E2.m2.3.3.1.1.3.1.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.1"></in><ci id="S3.E2.m2.3.3.1.1.3.1.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.2">𝑘</ci><apply id="S3.E2.m2.3.3.1.1.3.1.3.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.1.3.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.3">superscript</csymbol><ci id="S3.E2.m2.3.3.1.1.3.1.3.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.3.2">𝒜</ci><ci id="S3.E2.m2.3.3.1.1.3.1.3.3.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m2.3.3.1.1.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2"><times id="S3.E2.m2.3.3.1.1.3.2.1.cmml" xref="S3.E2.m2.3.3.1.1.3.2.1"></times><apply id="S3.E2.m2.2.2.cmml" xref="S3.E2.m2.2.2"><divide id="S3.E2.m2.2.2.3.cmml" xref="S3.E2.m2.2.2"></divide><apply id="S3.E2.m2.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1"><abs id="S3.E2.m2.1.1.1.2.1.cmml" xref="S3.E2.m2.1.1.1.1.2"></abs><apply id="S3.E2.m2.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S3.E2.m2.1.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E2.m2.2.2.2.cmml" xref="S3.E2.m2.2.2.2"><apply id="S3.E2.m2.2.2.2.2.cmml" xref="S3.E2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.2.2.1.cmml" xref="S3.E2.m2.2.2.2.2">subscript</csymbol><sum id="S3.E2.m2.2.2.2.2.2.cmml" xref="S3.E2.m2.2.2.2.2.2"></sum><apply id="S3.E2.m2.2.2.2.2.3.cmml" xref="S3.E2.m2.2.2.2.2.3"><in id="S3.E2.m2.2.2.2.2.3.1.cmml" xref="S3.E2.m2.2.2.2.2.3.1"></in><ci id="S3.E2.m2.2.2.2.2.3.2.cmml" xref="S3.E2.m2.2.2.2.2.3.2">𝑘</ci><apply id="S3.E2.m2.2.2.2.2.3.3.cmml" xref="S3.E2.m2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.2.2.3.3.1.cmml" xref="S3.E2.m2.2.2.2.2.3.3">superscript</csymbol><ci id="S3.E2.m2.2.2.2.2.3.3.2.cmml" xref="S3.E2.m2.2.2.2.2.3.3.2">𝒜</ci><ci id="S3.E2.m2.2.2.2.2.3.3.3.cmml" xref="S3.E2.m2.2.2.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m2.2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.2.1.1"><abs id="S3.E2.m2.2.2.2.1.2.1.cmml" xref="S3.E2.m2.2.2.2.1.1.2"></abs><apply id="S3.E2.m2.2.2.2.1.1.1.cmml" xref="S3.E2.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.2.1.1.1.1.cmml" xref="S3.E2.m2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.E2.m2.2.2.2.1.1.1.2.cmml" xref="S3.E2.m2.2.2.2.1.1.1.2">𝒟</ci><ci id="S3.E2.m2.2.2.2.1.1.1.3.cmml" xref="S3.E2.m2.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E2.m2.3.3.1.1.3.2.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.2.2.1.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2">superscript</csymbol><apply id="S3.E2.m2.3.3.1.1.3.2.2.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m2.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.2.2">𝐰</ci><ci id="S3.E2.m2.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="S3.E2.m2.3.3.1.1.3.2.2.3.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.3"><plus id="S3.E2.m2.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.3.1"></plus><ci id="S3.E2.m2.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E2.m2.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E2.m2.3.3.1.1.3.2.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.3c">\displaystyle=\sum_{k\in\mathcal{A}^{t}}\frac{|\mathcal{D}^{k}|}{\sum_{k\in\mathcal{A}^{t}}|\mathcal{D}^{k}|}\mathbf{w}_{k}^{t+1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Motivation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Classifier re-training has been shown effective for heterogeneous data <cite class="ltx_cite ltx_citemacro_cite">Luo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> and long-tailed data <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, separately. Now, we empirically show that classifier re-training also works for the joint problem. In other words, the biased classifier is the primary factor leading to the poor performance of the global model trained on heterogeneous and long-tailed data.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">First, we divide a ResNet-8 network into five components, including four blocks<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We regard the first convolutional layer with BN layer as the first block.</span></span></span> and one classifier.
Then, we use a small set of balanced data (100 per class) collected from clients to re-train each component of a FedAvg model while keeping other components fixed. The FedAvg model is pre-trained on CIFAR-10-LT with <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mtext id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2a.cmml">IF</mtext><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></eq><ci id="S3.SS2.p2.1.m1.1.1.2a.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><mtext id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\textrm{IF}=100</annotation></semantics></math> and <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">α</mi><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><eq id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></eq><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝛼</ci><cn type="float" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\alpha=0.5</annotation></semantics></math>.
As shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Motivation ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we can observe that re-training any single component can achieve certain improvement (blue line). Especially, re-training the classifier achieves the highest performance gain (around 15.35%).
Therefore, it can be shown that the biased classifier is the primary factor leading to the poor performance of the global model because other components are less affected.
</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">However, requiring external data on the server is impractical in real FL applications, although the amount of the data is small. Transmitting data from clients violates the key privacy-preserving principle of FL, and the data collected by the server itself may not follow the same distribution as the training data in clients.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2204.13399/assets/x3.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">The performance of re-training each component of a FedAvg model pre-trained on CIFAR-10-LT with <math id="S3.F2.3.1.m1.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S3.F2.3.1.m1.1b"><mrow id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml"><mtext id="S3.F2.3.1.m1.1.1.2" xref="S3.F2.3.1.m1.1.1.2a.cmml">IF</mtext><mo id="S3.F2.3.1.m1.1.1.1" xref="S3.F2.3.1.m1.1.1.1.cmml">=</mo><mn id="S3.F2.3.1.m1.1.1.3" xref="S3.F2.3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><apply id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1"><eq id="S3.F2.3.1.m1.1.1.1.cmml" xref="S3.F2.3.1.m1.1.1.1"></eq><ci id="S3.F2.3.1.m1.1.1.2a.cmml" xref="S3.F2.3.1.m1.1.1.2"><mtext id="S3.F2.3.1.m1.1.1.2.cmml" xref="S3.F2.3.1.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S3.F2.3.1.m1.1.1.3.cmml" xref="S3.F2.3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">\textrm{IF}=100</annotation></semantics></math> and <math id="S3.F2.4.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S3.F2.4.2.m2.1b"><mrow id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml"><mi id="S3.F2.4.2.m2.1.1.2" xref="S3.F2.4.2.m2.1.1.2.cmml">α</mi><mo id="S3.F2.4.2.m2.1.1.1" xref="S3.F2.4.2.m2.1.1.1.cmml">=</mo><mn id="S3.F2.4.2.m2.1.1.3" xref="S3.F2.4.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><apply id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1"><eq id="S3.F2.4.2.m2.1.1.1.cmml" xref="S3.F2.4.2.m2.1.1.1"></eq><ci id="S3.F2.4.2.m2.1.1.2.cmml" xref="S3.F2.4.2.m2.1.1.2">𝛼</ci><cn type="float" id="S3.F2.4.2.m2.1.1.3.cmml" xref="S3.F2.4.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">\alpha=0.5</annotation></semantics></math>.
</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Framework of the proposed CReFF</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2204.13399/assets/x4.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">The framework of CReFF. In each round, clients send updated local models and real feature gradients to the server, and the server sends the aggregated global model and the re-trained model to clients.</span></figcaption>
</figure>
<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Based on the above assumption and corresponding observation, we propose CReFF to deal with the joint problem of data heterogeneity and long-tail distribution. It is designed as a simple and effective approach based on FedAvg by only re-training a new classifier using a small set of learnable features on the server, which is called <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">federated features</span>.
Our goal is to re-train the classifier on federated features such that its performance is comparable with the classifier re-trained on real features, which can be achieved by making two classifiers similar.
Therefore, the classifier re-training optimization on federated features should follow the similar path as that of the real data.
Specifically, we optimize the federated features to make their gradients close to the gradients of real data such that the classifiers trained on real and federated features converge to a similar solution in the parameter space.
In this way, the classifier re-trained on the federated features can be approximated by the one re-trained on the real data in a privacy-preserving manner. As shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Motivation ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, CReFF produces comparable performance as on real data.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.4" class="ltx_p">CReFF consists of two core components: local training on clients and federated features optimization on the server. In round <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">t</annotation></semantics></math>, each client receives two models from the server:
1) a global model <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{t}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝐰</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathbf{w}^{t}</annotation></semantics></math>; 2) a re-trained model <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">𝐰</mi><mo id="S3.SS3.p2.3.m3.1.1.2.1" xref="S3.SS3.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><ci id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">^</ci><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝐰</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\widehat{\mathbf{w}}^{t}</annotation></semantics></math>. The former is used to update local models for global model aggregation, and the latter is used to calculate the real feature gradients for federated features optimization. After local training, some clients are selected to upload their local models and real feature gradients to the server.
Finally, the server updates the global model and the re-trained model for round <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">t</mi><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">+</mo><mn id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><plus id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></plus><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">t+1</annotation></semantics></math>. The architecture of CReFF is illustrated in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.15" class="ltx_p"><span id="S3.SS3.p3.15.1" class="ltx_text ltx_font_bold">Local Training.</span>
In round <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">t</annotation></semantics></math>, the server sends two models to clients. The global model <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{t}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msup id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐰</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathbf{w}^{t}</annotation></semantics></math> is composed of a feature extractor <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{u}^{t}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msup id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">𝐮</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝐮</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbf{u}^{t}</annotation></semantics></math> and a classifier <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{v}^{t}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msup id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">𝐯</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝐯</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\mathbf{v}^{t}</annotation></semantics></math>, and the re-trained model <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msup id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2.cmml">𝐰</mi><mo id="S3.SS3.p3.5.m5.1.1.2.1" xref="S3.SS3.p3.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2"><ci id="S3.SS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2.1">^</ci><ci id="S3.SS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2">𝐰</ci></apply><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\widehat{\mathbf{w}}^{t}</annotation></semantics></math> has a re-trained classifier <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\widehat{\mathbf{v}}^{t}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msup id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.cmml">𝐯</mi><mo id="S3.SS3.p3.6.m6.1.1.2.1" xref="S3.SS3.p3.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">superscript</csymbol><apply id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2"><ci id="S3.SS3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1">^</ci><ci id="S3.SS3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2">𝐯</ci></apply><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\widehat{\mathbf{v}}^{t}</annotation></semantics></math> with the same feature extractor <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{u}^{t}" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><msup id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">𝐮</mi><mi id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">superscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2">𝐮</ci><ci id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">\mathbf{u}^{t}</annotation></semantics></math>. For each received model, the local training consists of a corresponding part. The first part is a typical FedAvg local model update as shown in Equation (<a href="#S3.E1" title="In 3.1 Preliminaries ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
The second part is calculating the real feature gradients for federated features optimization on the server. Client <math id="S3.SS3.p3.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.8.m8.1a"><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">k</annotation></semantics></math> produces <math id="S3.SS3.p3.9.m9.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.p3.9.m9.1a"><mi id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><ci id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">d</annotation></semantics></math>-dim real features <math id="S3.SS3.p3.10.m10.5" class="ltx_Math" alttext="\mathcal{Z}_{c}^{k}=\{\mathbf{z}_{c,i}^{k}\}|_{i=1}^{n_{c}^{k}}" display="inline"><semantics id="S3.SS3.p3.10.m10.5a"><mrow id="S3.SS3.p3.10.m10.5.5" xref="S3.SS3.p3.10.m10.5.5.cmml"><msubsup id="S3.SS3.p3.10.m10.5.5.3" xref="S3.SS3.p3.10.m10.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.10.m10.5.5.3.2.2" xref="S3.SS3.p3.10.m10.5.5.3.2.2.cmml">𝒵</mi><mi id="S3.SS3.p3.10.m10.5.5.3.2.3" xref="S3.SS3.p3.10.m10.5.5.3.2.3.cmml">c</mi><mi id="S3.SS3.p3.10.m10.5.5.3.3" xref="S3.SS3.p3.10.m10.5.5.3.3.cmml">k</mi></msubsup><mo id="S3.SS3.p3.10.m10.5.5.2" xref="S3.SS3.p3.10.m10.5.5.2.cmml">=</mo><msubsup id="S3.SS3.p3.10.m10.5.5.1.1" xref="S3.SS3.p3.10.m10.5.5.1.2.cmml"><mrow id="S3.SS3.p3.10.m10.5.5.1.1.1.1" xref="S3.SS3.p3.10.m10.5.5.1.2.cmml"><mrow id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.2" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S3.SS3.p3.10.m10.2.2.2.4" xref="S3.SS3.p3.10.m10.2.2.2.3.cmml"><mi id="S3.SS3.p3.10.m10.1.1.1.1" xref="S3.SS3.p3.10.m10.1.1.1.1.cmml">c</mi><mo id="S3.SS3.p3.10.m10.2.2.2.4.1" xref="S3.SS3.p3.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p3.10.m10.2.2.2.2" xref="S3.SS3.p3.10.m10.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.3" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS3.p3.10.m10.5.5.1.1.1.1.2" xref="S3.SS3.p3.10.m10.5.5.1.2.1.cmml">|</mo></mrow><mrow id="S3.SS3.p3.10.m10.3.3.1" xref="S3.SS3.p3.10.m10.3.3.1.cmml"><mi id="S3.SS3.p3.10.m10.3.3.1.2" xref="S3.SS3.p3.10.m10.3.3.1.2.cmml">i</mi><mo id="S3.SS3.p3.10.m10.3.3.1.1" xref="S3.SS3.p3.10.m10.3.3.1.1.cmml">=</mo><mn id="S3.SS3.p3.10.m10.3.3.1.3" xref="S3.SS3.p3.10.m10.3.3.1.3.cmml">1</mn></mrow><msubsup id="S3.SS3.p3.10.m10.4.4.1" xref="S3.SS3.p3.10.m10.4.4.1.cmml"><mi id="S3.SS3.p3.10.m10.4.4.1.2.2" xref="S3.SS3.p3.10.m10.4.4.1.2.2.cmml">n</mi><mi id="S3.SS3.p3.10.m10.4.4.1.2.3" xref="S3.SS3.p3.10.m10.4.4.1.2.3.cmml">c</mi><mi id="S3.SS3.p3.10.m10.4.4.1.3" xref="S3.SS3.p3.10.m10.4.4.1.3.cmml">k</mi></msubsup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.5b"><apply id="S3.SS3.p3.10.m10.5.5.cmml" xref="S3.SS3.p3.10.m10.5.5"><eq id="S3.SS3.p3.10.m10.5.5.2.cmml" xref="S3.SS3.p3.10.m10.5.5.2"></eq><apply id="S3.SS3.p3.10.m10.5.5.3.cmml" xref="S3.SS3.p3.10.m10.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.5.5.3.1.cmml" xref="S3.SS3.p3.10.m10.5.5.3">superscript</csymbol><apply id="S3.SS3.p3.10.m10.5.5.3.2.cmml" xref="S3.SS3.p3.10.m10.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.5.5.3.2.1.cmml" xref="S3.SS3.p3.10.m10.5.5.3">subscript</csymbol><ci id="S3.SS3.p3.10.m10.5.5.3.2.2.cmml" xref="S3.SS3.p3.10.m10.5.5.3.2.2">𝒵</ci><ci id="S3.SS3.p3.10.m10.5.5.3.2.3.cmml" xref="S3.SS3.p3.10.m10.5.5.3.2.3">𝑐</ci></apply><ci id="S3.SS3.p3.10.m10.5.5.3.3.cmml" xref="S3.SS3.p3.10.m10.5.5.3.3">𝑘</ci></apply><apply id="S3.SS3.p3.10.m10.5.5.1.2.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1"><csymbol cd="latexml" id="S3.SS3.p3.10.m10.5.5.1.2.1.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.2">evaluated-at</csymbol><set id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1"><apply id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.2.2">𝐳</ci><list id="S3.SS3.p3.10.m10.2.2.2.3.cmml" xref="S3.SS3.p3.10.m10.2.2.2.4"><ci id="S3.SS3.p3.10.m10.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1">𝑐</ci><ci id="S3.SS3.p3.10.m10.2.2.2.2.cmml" xref="S3.SS3.p3.10.m10.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.10.m10.5.5.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS3.p3.10.m10.3.3.1.cmml" xref="S3.SS3.p3.10.m10.3.3.1"><eq id="S3.SS3.p3.10.m10.3.3.1.1.cmml" xref="S3.SS3.p3.10.m10.3.3.1.1"></eq><ci id="S3.SS3.p3.10.m10.3.3.1.2.cmml" xref="S3.SS3.p3.10.m10.3.3.1.2">𝑖</ci><cn type="integer" id="S3.SS3.p3.10.m10.3.3.1.3.cmml" xref="S3.SS3.p3.10.m10.3.3.1.3">1</cn></apply><apply id="S3.SS3.p3.10.m10.4.4.1.cmml" xref="S3.SS3.p3.10.m10.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.4.4.1.1.cmml" xref="S3.SS3.p3.10.m10.4.4.1">superscript</csymbol><apply id="S3.SS3.p3.10.m10.4.4.1.2.cmml" xref="S3.SS3.p3.10.m10.4.4.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.4.4.1.2.1.cmml" xref="S3.SS3.p3.10.m10.4.4.1">subscript</csymbol><ci id="S3.SS3.p3.10.m10.4.4.1.2.2.cmml" xref="S3.SS3.p3.10.m10.4.4.1.2.2">𝑛</ci><ci id="S3.SS3.p3.10.m10.4.4.1.2.3.cmml" xref="S3.SS3.p3.10.m10.4.4.1.2.3">𝑐</ci></apply><ci id="S3.SS3.p3.10.m10.4.4.1.3.cmml" xref="S3.SS3.p3.10.m10.4.4.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.5c">\mathcal{Z}_{c}^{k}=\{\mathbf{z}_{c,i}^{k}\}|_{i=1}^{n_{c}^{k}}</annotation></semantics></math> for class <math id="S3.SS3.p3.11.m11.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p3.11.m11.1a"><mi id="S3.SS3.p3.11.m11.1.1" xref="S3.SS3.p3.11.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m11.1b"><ci id="S3.SS3.p3.11.m11.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m11.1c">c</annotation></semantics></math> through the feature extractor <math id="S3.SS3.p3.12.m12.1" class="ltx_Math" alttext="\mathbf{u}^{t}" display="inline"><semantics id="S3.SS3.p3.12.m12.1a"><msup id="S3.SS3.p3.12.m12.1.1" xref="S3.SS3.p3.12.m12.1.1.cmml"><mi id="S3.SS3.p3.12.m12.1.1.2" xref="S3.SS3.p3.12.m12.1.1.2.cmml">𝐮</mi><mi id="S3.SS3.p3.12.m12.1.1.3" xref="S3.SS3.p3.12.m12.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m12.1b"><apply id="S3.SS3.p3.12.m12.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.1.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1">superscript</csymbol><ci id="S3.SS3.p3.12.m12.1.1.2.cmml" xref="S3.SS3.p3.12.m12.1.1.2">𝐮</ci><ci id="S3.SS3.p3.12.m12.1.1.3.cmml" xref="S3.SS3.p3.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m12.1c">\mathbf{u}^{t}</annotation></semantics></math>. Then, real feature gradients <math id="S3.SS3.p3.13.m13.1" class="ltx_Math" alttext="\mathbf{g}_{c}^{k}\in\mathbb{R}^{C\times d}" display="inline"><semantics id="S3.SS3.p3.13.m13.1a"><mrow id="S3.SS3.p3.13.m13.1.1" xref="S3.SS3.p3.13.m13.1.1.cmml"><msubsup id="S3.SS3.p3.13.m13.1.1.2" xref="S3.SS3.p3.13.m13.1.1.2.cmml"><mi id="S3.SS3.p3.13.m13.1.1.2.2.2" xref="S3.SS3.p3.13.m13.1.1.2.2.2.cmml">𝐠</mi><mi id="S3.SS3.p3.13.m13.1.1.2.2.3" xref="S3.SS3.p3.13.m13.1.1.2.2.3.cmml">c</mi><mi id="S3.SS3.p3.13.m13.1.1.2.3" xref="S3.SS3.p3.13.m13.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS3.p3.13.m13.1.1.1" xref="S3.SS3.p3.13.m13.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.13.m13.1.1.3" xref="S3.SS3.p3.13.m13.1.1.3.cmml"><mi id="S3.SS3.p3.13.m13.1.1.3.2" xref="S3.SS3.p3.13.m13.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.13.m13.1.1.3.3" xref="S3.SS3.p3.13.m13.1.1.3.3.cmml"><mi id="S3.SS3.p3.13.m13.1.1.3.3.2" xref="S3.SS3.p3.13.m13.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.13.m13.1.1.3.3.1" xref="S3.SS3.p3.13.m13.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p3.13.m13.1.1.3.3.3" xref="S3.SS3.p3.13.m13.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m13.1b"><apply id="S3.SS3.p3.13.m13.1.1.cmml" xref="S3.SS3.p3.13.m13.1.1"><in id="S3.SS3.p3.13.m13.1.1.1.cmml" xref="S3.SS3.p3.13.m13.1.1.1"></in><apply id="S3.SS3.p3.13.m13.1.1.2.cmml" xref="S3.SS3.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.13.m13.1.1.2.1.cmml" xref="S3.SS3.p3.13.m13.1.1.2">superscript</csymbol><apply id="S3.SS3.p3.13.m13.1.1.2.2.cmml" xref="S3.SS3.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.13.m13.1.1.2.2.1.cmml" xref="S3.SS3.p3.13.m13.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.13.m13.1.1.2.2.2.cmml" xref="S3.SS3.p3.13.m13.1.1.2.2.2">𝐠</ci><ci id="S3.SS3.p3.13.m13.1.1.2.2.3.cmml" xref="S3.SS3.p3.13.m13.1.1.2.2.3">𝑐</ci></apply><ci id="S3.SS3.p3.13.m13.1.1.2.3.cmml" xref="S3.SS3.p3.13.m13.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p3.13.m13.1.1.3.cmml" xref="S3.SS3.p3.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.13.m13.1.1.3.1.cmml" xref="S3.SS3.p3.13.m13.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.13.m13.1.1.3.2.cmml" xref="S3.SS3.p3.13.m13.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.13.m13.1.1.3.3.cmml" xref="S3.SS3.p3.13.m13.1.1.3.3"><times id="S3.SS3.p3.13.m13.1.1.3.3.1.cmml" xref="S3.SS3.p3.13.m13.1.1.3.3.1"></times><ci id="S3.SS3.p3.13.m13.1.1.3.3.2.cmml" xref="S3.SS3.p3.13.m13.1.1.3.3.2">𝐶</ci><ci id="S3.SS3.p3.13.m13.1.1.3.3.3.cmml" xref="S3.SS3.p3.13.m13.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m13.1c">\mathbf{g}_{c}^{k}\in\mathbb{R}^{C\times d}</annotation></semantics></math> of class <math id="S3.SS3.p3.14.m14.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p3.14.m14.1a"><mi id="S3.SS3.p3.14.m14.1.1" xref="S3.SS3.p3.14.m14.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m14.1b"><ci id="S3.SS3.p3.14.m14.1.1.cmml" xref="S3.SS3.p3.14.m14.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m14.1c">c</annotation></semantics></math> can be computed using <math id="S3.SS3.p3.15.m15.1" class="ltx_Math" alttext="\widehat{\mathbf{v}}^{t}" display="inline"><semantics id="S3.SS3.p3.15.m15.1a"><msup id="S3.SS3.p3.15.m15.1.1" xref="S3.SS3.p3.15.m15.1.1.cmml"><mover accent="true" id="S3.SS3.p3.15.m15.1.1.2" xref="S3.SS3.p3.15.m15.1.1.2.cmml"><mi id="S3.SS3.p3.15.m15.1.1.2.2" xref="S3.SS3.p3.15.m15.1.1.2.2.cmml">𝐯</mi><mo id="S3.SS3.p3.15.m15.1.1.2.1" xref="S3.SS3.p3.15.m15.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.15.m15.1.1.3" xref="S3.SS3.p3.15.m15.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m15.1b"><apply id="S3.SS3.p3.15.m15.1.1.cmml" xref="S3.SS3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m15.1.1.1.cmml" xref="S3.SS3.p3.15.m15.1.1">superscript</csymbol><apply id="S3.SS3.p3.15.m15.1.1.2.cmml" xref="S3.SS3.p3.15.m15.1.1.2"><ci id="S3.SS3.p3.15.m15.1.1.2.1.cmml" xref="S3.SS3.p3.15.m15.1.1.2.1">^</ci><ci id="S3.SS3.p3.15.m15.1.1.2.2.cmml" xref="S3.SS3.p3.15.m15.1.1.2.2">𝐯</ci></apply><ci id="S3.SS3.p3.15.m15.1.1.3.cmml" xref="S3.SS3.p3.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m15.1c">\widehat{\mathbf{v}}^{t}</annotation></semantics></math>:
</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{g}_{c}^{k}" display="inline"><semantics id="S3.E3.m1.1a"><msubsup id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">𝐠</mi><mi id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml">c</mi><mi id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝐠</ci><ci id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\mathbf{g}_{c}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{n_{c}^{k}}\sum_{i=1}^{n_{c}^{k}}\nabla_{\widehat{\mathbf{v}}}\ell(h_{\widehat{\mathbf{v}}^{t}}(\mathbf{z}_{c,i}^{k}),y_{i})." display="inline"><semantics id="S3.E3.m2.3a"><mrow id="S3.E3.m2.3.3.1" xref="S3.E3.m2.3.3.1.1.cmml"><mrow id="S3.E3.m2.3.3.1.1" xref="S3.E3.m2.3.3.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.4" xref="S3.E3.m2.3.3.1.1.4.cmml"></mi><mo id="S3.E3.m2.3.3.1.1.3" xref="S3.E3.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m2.3.3.1.1.2" xref="S3.E3.m2.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E3.m2.3.3.1.1.2.4" xref="S3.E3.m2.3.3.1.1.2.4.cmml"><mfrac id="S3.E3.m2.3.3.1.1.2.4a" xref="S3.E3.m2.3.3.1.1.2.4.cmml"><mn id="S3.E3.m2.3.3.1.1.2.4.2" xref="S3.E3.m2.3.3.1.1.2.4.2.cmml">1</mn><msubsup id="S3.E3.m2.3.3.1.1.2.4.3" xref="S3.E3.m2.3.3.1.1.2.4.3.cmml"><mi id="S3.E3.m2.3.3.1.1.2.4.3.2.2" xref="S3.E3.m2.3.3.1.1.2.4.3.2.2.cmml">n</mi><mi id="S3.E3.m2.3.3.1.1.2.4.3.2.3" xref="S3.E3.m2.3.3.1.1.2.4.3.2.3.cmml">c</mi><mi id="S3.E3.m2.3.3.1.1.2.4.3.3" xref="S3.E3.m2.3.3.1.1.2.4.3.3.cmml">k</mi></msubsup></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3.m2.3.3.1.1.2.3" xref="S3.E3.m2.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m2.3.3.1.1.2.2" xref="S3.E3.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m2.3.3.1.1.2.2.3" xref="S3.E3.m2.3.3.1.1.2.2.3.cmml"><munderover id="S3.E3.m2.3.3.1.1.2.2.3a" xref="S3.E3.m2.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E3.m2.3.3.1.1.2.2.3.2.2" xref="S3.E3.m2.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m2.3.3.1.1.2.2.3.2.3" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.3.2.3.2" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E3.m2.3.3.1.1.2.2.3.2.3.1" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m2.3.3.1.1.2.2.3.2.3.3" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msubsup id="S3.E3.m2.3.3.1.1.2.2.3.3" xref="S3.E3.m2.3.3.1.1.2.2.3.3.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.3.3.2.2" xref="S3.E3.m2.3.3.1.1.2.2.3.3.2.2.cmml">n</mi><mi id="S3.E3.m2.3.3.1.1.2.2.3.3.2.3" xref="S3.E3.m2.3.3.1.1.2.2.3.3.2.3.cmml">c</mi><mi id="S3.E3.m2.3.3.1.1.2.2.3.3.3" xref="S3.E3.m2.3.3.1.1.2.2.3.3.3.cmml">k</mi></msubsup></munderover></mstyle><mrow id="S3.E3.m2.3.3.1.1.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.cmml"><mrow id="S3.E3.m2.3.3.1.1.2.2.2.4" xref="S3.E3.m2.3.3.1.1.2.2.2.4.cmml"><msub id="S3.E3.m2.3.3.1.1.2.2.2.4.1" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="S3.E3.m2.3.3.1.1.2.2.2.4.1.2" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.2.cmml">∇</mo><mover accent="true" id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.2" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.2.cmml">𝐯</mi><mo id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.1" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.1.cmml">^</mo></mover></msub><mi mathvariant="normal" id="S3.E3.m2.3.3.1.1.2.2.2.4.2" xref="S3.E3.m2.3.3.1.1.2.2.2.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m2.3.3.1.1.2.2.2.3" xref="S3.E3.m2.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m2.3.3.1.1.2.2.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E3.m2.3.3.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><msup id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐯</mi><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msup></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S3.E3.m2.2.2.2.4" xref="S3.E3.m2.2.2.2.3.cmml"><mi id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml">c</mi><mo id="S3.E3.m2.2.2.2.4.1" xref="S3.E3.m2.2.2.2.3.cmml">,</mo><mi id="S3.E3.m2.2.2.2.2" xref="S3.E3.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m2.3.3.1.1.2.2.2.2.2.4" xref="S3.E3.m2.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m2.3.3.1.1.2.2.2.2.2.5" xref="S3.E3.m2.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m2.3.3.1.2" xref="S3.E3.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.3b"><apply id="S3.E3.m2.3.3.1.1.cmml" xref="S3.E3.m2.3.3.1"><eq id="S3.E3.m2.3.3.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E3.m2.3.3.1.1.4.cmml" xref="S3.E3.m2.3.3.1.1.4">absent</csymbol><apply id="S3.E3.m2.3.3.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.2"><times id="S3.E3.m2.3.3.1.1.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.3"></times><apply id="S3.E3.m2.3.3.1.1.2.4.cmml" xref="S3.E3.m2.3.3.1.1.2.4"><divide id="S3.E3.m2.3.3.1.1.2.4.1.cmml" xref="S3.E3.m2.3.3.1.1.2.4"></divide><cn type="integer" id="S3.E3.m2.3.3.1.1.2.4.2.cmml" xref="S3.E3.m2.3.3.1.1.2.4.2">1</cn><apply id="S3.E3.m2.3.3.1.1.2.4.3.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.4.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.2.4.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.4.3.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.4.3.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3.2.2">𝑛</ci><ci id="S3.E3.m2.3.3.1.1.2.4.3.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3.2.3">𝑐</ci></apply><ci id="S3.E3.m2.3.3.1.1.2.4.3.3.cmml" xref="S3.E3.m2.3.3.1.1.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2"><apply id="S3.E3.m2.3.3.1.1.2.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E3.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E3.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3"><eq id="S3.E3.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E3.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m2.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.3.3.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.2.3.3.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3.2.2">𝑛</ci><ci id="S3.E3.m2.3.3.1.1.2.2.3.3.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3.2.3">𝑐</ci></apply><ci id="S3.E3.m2.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2"><times id="S3.E3.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.3"></times><apply id="S3.E3.m2.3.3.1.1.2.2.2.4.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4"><apply id="S3.E3.m2.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.2.4.1.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.2.2.4.1.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.2">∇</ci><apply id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3"><ci id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.1">^</ci><ci id="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.1.3.2">𝐯</ci></apply></apply><ci id="S3.E3.m2.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.4.2">ℓ</ci></apply><interval closure="open" id="S3.E3.m2.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2"><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1"><times id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1">^</ci><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2">𝐯</ci></apply><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><list id="S3.E3.m2.2.2.2.3.cmml" xref="S3.E3.m2.2.2.2.4"><ci id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1">𝑐</ci><ci id="S3.E3.m2.2.2.2.2.cmml" xref="S3.E3.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m2.3.3.1.1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.3c">\displaystyle=\frac{1}{n_{c}^{k}}\sum_{i=1}^{n_{c}^{k}}\nabla_{\widehat{\mathbf{v}}}\ell(h_{\widehat{\mathbf{v}}^{t}}(\mathbf{z}_{c,i}^{k}),y_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.21" class="ltx_p">Finally, client <math id="S3.SS3.p3.16.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.16.m1.1a"><mi id="S3.SS3.p3.16.m1.1.1" xref="S3.SS3.p3.16.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.16.m1.1b"><ci id="S3.SS3.p3.16.m1.1.1.cmml" xref="S3.SS3.p3.16.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.16.m1.1c">k</annotation></semantics></math> uploads two parts to the server: 1) the local model <math id="S3.SS3.p3.17.m2.1" class="ltx_Math" alttext="\mathbf{w}_{k}^{t+1}" display="inline"><semantics id="S3.SS3.p3.17.m2.1a"><msubsup id="S3.SS3.p3.17.m2.1.1" xref="S3.SS3.p3.17.m2.1.1.cmml"><mi id="S3.SS3.p3.17.m2.1.1.2.2" xref="S3.SS3.p3.17.m2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS3.p3.17.m2.1.1.2.3" xref="S3.SS3.p3.17.m2.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p3.17.m2.1.1.3" xref="S3.SS3.p3.17.m2.1.1.3.cmml"><mi id="S3.SS3.p3.17.m2.1.1.3.2" xref="S3.SS3.p3.17.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p3.17.m2.1.1.3.1" xref="S3.SS3.p3.17.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p3.17.m2.1.1.3.3" xref="S3.SS3.p3.17.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.17.m2.1b"><apply id="S3.SS3.p3.17.m2.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1">superscript</csymbol><apply id="S3.SS3.p3.17.m2.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.2.1.cmml" xref="S3.SS3.p3.17.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.17.m2.1.1.2.2.cmml" xref="S3.SS3.p3.17.m2.1.1.2.2">𝐰</ci><ci id="S3.SS3.p3.17.m2.1.1.2.3.cmml" xref="S3.SS3.p3.17.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p3.17.m2.1.1.3.cmml" xref="S3.SS3.p3.17.m2.1.1.3"><plus id="S3.SS3.p3.17.m2.1.1.3.1.cmml" xref="S3.SS3.p3.17.m2.1.1.3.1"></plus><ci id="S3.SS3.p3.17.m2.1.1.3.2.cmml" xref="S3.SS3.p3.17.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p3.17.m2.1.1.3.3.cmml" xref="S3.SS3.p3.17.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.17.m2.1c">\mathbf{w}_{k}^{t+1}</annotation></semantics></math> for global model aggregation; 2) the real feature gradients <math id="S3.SS3.p3.18.m3.2" class="ltx_Math" alttext="\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}" display="inline"><semantics id="S3.SS3.p3.18.m3.2a"><mrow id="S3.SS3.p3.18.m3.2.2.2" xref="S3.SS3.p3.18.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.18.m3.2.2.2.3" xref="S3.SS3.p3.18.m3.2.2.3.1.cmml">{</mo><msubsup id="S3.SS3.p3.18.m3.1.1.1.1" xref="S3.SS3.p3.18.m3.1.1.1.1.cmml"><mi id="S3.SS3.p3.18.m3.1.1.1.1.2.2" xref="S3.SS3.p3.18.m3.1.1.1.1.2.2.cmml">𝐠</mi><mi id="S3.SS3.p3.18.m3.1.1.1.1.2.3" xref="S3.SS3.p3.18.m3.1.1.1.1.2.3.cmml">c</mi><mi id="S3.SS3.p3.18.m3.1.1.1.1.3" xref="S3.SS3.p3.18.m3.1.1.1.1.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p3.18.m3.2.2.2.4" xref="S3.SS3.p3.18.m3.2.2.3.1.cmml">|</mo><mrow id="S3.SS3.p3.18.m3.2.2.2.2" xref="S3.SS3.p3.18.m3.2.2.2.2.cmml"><mi id="S3.SS3.p3.18.m3.2.2.2.2.2" xref="S3.SS3.p3.18.m3.2.2.2.2.2.cmml">c</mi><mo id="S3.SS3.p3.18.m3.2.2.2.2.1" xref="S3.SS3.p3.18.m3.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS3.p3.18.m3.2.2.2.2.3" xref="S3.SS3.p3.18.m3.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.18.m3.2.2.2.2.3.2" xref="S3.SS3.p3.18.m3.2.2.2.2.3.2.cmml">𝒞</mi><mi id="S3.SS3.p3.18.m3.2.2.2.2.3.3" xref="S3.SS3.p3.18.m3.2.2.2.2.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="S3.SS3.p3.18.m3.2.2.2.5" xref="S3.SS3.p3.18.m3.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.18.m3.2b"><apply id="S3.SS3.p3.18.m3.2.2.3.cmml" xref="S3.SS3.p3.18.m3.2.2.2"><csymbol cd="latexml" id="S3.SS3.p3.18.m3.2.2.3.1.cmml" xref="S3.SS3.p3.18.m3.2.2.2.3">conditional-set</csymbol><apply id="S3.SS3.p3.18.m3.1.1.1.1.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m3.1.1.1.1.1.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.18.m3.1.1.1.1.2.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m3.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.18.m3.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1.2.2">𝐠</ci><ci id="S3.SS3.p3.18.m3.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS3.p3.18.m3.1.1.1.1.3.cmml" xref="S3.SS3.p3.18.m3.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.p3.18.m3.2.2.2.2.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2"><in id="S3.SS3.p3.18.m3.2.2.2.2.1.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.1"></in><ci id="S3.SS3.p3.18.m3.2.2.2.2.2.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.2">𝑐</ci><apply id="S3.SS3.p3.18.m3.2.2.2.2.3.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m3.2.2.2.2.3.1.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.3">superscript</csymbol><ci id="S3.SS3.p3.18.m3.2.2.2.2.3.2.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.3.2">𝒞</ci><ci id="S3.SS3.p3.18.m3.2.2.2.2.3.3.cmml" xref="S3.SS3.p3.18.m3.2.2.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.18.m3.2c">\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}</annotation></semantics></math> for federated features optimization. Herein, <math id="S3.SS3.p3.19.m4.1" class="ltx_Math" alttext="\mathcal{C}^{k}" display="inline"><semantics id="S3.SS3.p3.19.m4.1a"><msup id="S3.SS3.p3.19.m4.1.1" xref="S3.SS3.p3.19.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.19.m4.1.1.2" xref="S3.SS3.p3.19.m4.1.1.2.cmml">𝒞</mi><mi id="S3.SS3.p3.19.m4.1.1.3" xref="S3.SS3.p3.19.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.19.m4.1b"><apply id="S3.SS3.p3.19.m4.1.1.cmml" xref="S3.SS3.p3.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.19.m4.1.1.1.cmml" xref="S3.SS3.p3.19.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.19.m4.1.1.2.cmml" xref="S3.SS3.p3.19.m4.1.1.2">𝒞</ci><ci id="S3.SS3.p3.19.m4.1.1.3.cmml" xref="S3.SS3.p3.19.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.19.m4.1c">\mathcal{C}^{k}</annotation></semantics></math> denotes the set of classes on client <math id="S3.SS3.p3.20.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.20.m5.1a"><mi id="S3.SS3.p3.20.m5.1.1" xref="S3.SS3.p3.20.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.20.m5.1b"><ci id="S3.SS3.p3.20.m5.1.1.cmml" xref="S3.SS3.p3.20.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.20.m5.1c">k</annotation></semantics></math> because the real feature gradients on client <math id="S3.SS3.p3.21.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.21.m6.1a"><mi id="S3.SS3.p3.21.m6.1.1" xref="S3.SS3.p3.21.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.21.m6.1b"><ci id="S3.SS3.p3.21.m6.1.1.cmml" xref="S3.SS3.p3.21.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.21.m6.1c">k</annotation></semantics></math> may only contain partial classes due to data heterogeneity. It is worth noting that clients only upload the average gradients of each class to the server, which erases the private information of local data to some context because the averaging operation is irreversible.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.9" class="ltx_p"><span id="S3.SS3.p4.9.1" class="ltx_text ltx_font_bold">Federated features optimization.</span>
Once the server receives two parts from the selected clients in <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{A}^{t}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msup id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">𝒜</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝒜</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\mathcal{A}^{t}</annotation></semantics></math>, there are also two corresponding parts to aggregate the client models and optimize federated features for classifier re-training, respectively. The first part is to aggregate the local models by Equation (<a href="#S3.E2" title="In 3.1 Preliminaries ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) to obtain the aggregated global model <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msup id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">𝐰</mi><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝐰</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><plus id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></plus><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\mathbf{w}^{t+1}</annotation></semantics></math>. The second part aims to learn a set of balanced <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">d</annotation></semantics></math>-dim federated features <math id="S3.SS3.p4.4.m4.5" class="ltx_Math" alttext="\mathcal{S}_{c}^{t}=\{\mathbf{s}_{c,i}^{t}\}|_{i=1}^{m}" display="inline"><semantics id="S3.SS3.p4.4.m4.5a"><mrow id="S3.SS3.p4.4.m4.5.5" xref="S3.SS3.p4.4.m4.5.5.cmml"><msubsup id="S3.SS3.p4.4.m4.5.5.3" xref="S3.SS3.p4.4.m4.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.4.m4.5.5.3.2.2" xref="S3.SS3.p4.4.m4.5.5.3.2.2.cmml">𝒮</mi><mi id="S3.SS3.p4.4.m4.5.5.3.2.3" xref="S3.SS3.p4.4.m4.5.5.3.2.3.cmml">c</mi><mi id="S3.SS3.p4.4.m4.5.5.3.3" xref="S3.SS3.p4.4.m4.5.5.3.3.cmml">t</mi></msubsup><mo id="S3.SS3.p4.4.m4.5.5.2" xref="S3.SS3.p4.4.m4.5.5.2.cmml">=</mo><msubsup id="S3.SS3.p4.4.m4.5.5.1.1" xref="S3.SS3.p4.4.m4.5.5.1.2.cmml"><mrow id="S3.SS3.p4.4.m4.5.5.1.1.1.1" xref="S3.SS3.p4.4.m4.5.5.1.2.cmml"><mrow id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.2" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mrow id="S3.SS3.p4.4.m4.2.2.2.4" xref="S3.SS3.p4.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.cmml">c</mi><mo id="S3.SS3.p4.4.m4.2.2.2.4.1" xref="S3.SS3.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.4.m4.2.2.2.2" xref="S3.SS3.p4.4.m4.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.3" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS3.p4.4.m4.5.5.1.1.1.1.2" xref="S3.SS3.p4.4.m4.5.5.1.2.1.cmml">|</mo></mrow><mrow id="S3.SS3.p4.4.m4.3.3.1" xref="S3.SS3.p4.4.m4.3.3.1.cmml"><mi id="S3.SS3.p4.4.m4.3.3.1.2" xref="S3.SS3.p4.4.m4.3.3.1.2.cmml">i</mi><mo id="S3.SS3.p4.4.m4.3.3.1.1" xref="S3.SS3.p4.4.m4.3.3.1.1.cmml">=</mo><mn id="S3.SS3.p4.4.m4.3.3.1.3" xref="S3.SS3.p4.4.m4.3.3.1.3.cmml">1</mn></mrow><mi id="S3.SS3.p4.4.m4.4.4.1" xref="S3.SS3.p4.4.m4.4.4.1.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.5b"><apply id="S3.SS3.p4.4.m4.5.5.cmml" xref="S3.SS3.p4.4.m4.5.5"><eq id="S3.SS3.p4.4.m4.5.5.2.cmml" xref="S3.SS3.p4.4.m4.5.5.2"></eq><apply id="S3.SS3.p4.4.m4.5.5.3.cmml" xref="S3.SS3.p4.4.m4.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.5.5.3.1.cmml" xref="S3.SS3.p4.4.m4.5.5.3">superscript</csymbol><apply id="S3.SS3.p4.4.m4.5.5.3.2.cmml" xref="S3.SS3.p4.4.m4.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.5.5.3.2.1.cmml" xref="S3.SS3.p4.4.m4.5.5.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.5.5.3.2.2.cmml" xref="S3.SS3.p4.4.m4.5.5.3.2.2">𝒮</ci><ci id="S3.SS3.p4.4.m4.5.5.3.2.3.cmml" xref="S3.SS3.p4.4.m4.5.5.3.2.3">𝑐</ci></apply><ci id="S3.SS3.p4.4.m4.5.5.3.3.cmml" xref="S3.SS3.p4.4.m4.5.5.3.3">𝑡</ci></apply><apply id="S3.SS3.p4.4.m4.5.5.1.2.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1"><csymbol cd="latexml" id="S3.SS3.p4.4.m4.5.5.1.2.1.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.2">evaluated-at</csymbol><set id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1"><apply id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.2.2">𝐬</ci><list id="S3.SS3.p4.4.m4.2.2.2.3.cmml" xref="S3.SS3.p4.4.m4.2.2.2.4"><ci id="S3.SS3.p4.4.m4.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1">𝑐</ci><ci id="S3.SS3.p4.4.m4.2.2.2.2.cmml" xref="S3.SS3.p4.4.m4.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.4.m4.5.5.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.SS3.p4.4.m4.3.3.1.cmml" xref="S3.SS3.p4.4.m4.3.3.1"><eq id="S3.SS3.p4.4.m4.3.3.1.1.cmml" xref="S3.SS3.p4.4.m4.3.3.1.1"></eq><ci id="S3.SS3.p4.4.m4.3.3.1.2.cmml" xref="S3.SS3.p4.4.m4.3.3.1.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.4.m4.3.3.1.3.cmml" xref="S3.SS3.p4.4.m4.3.3.1.3">1</cn></apply><ci id="S3.SS3.p4.4.m4.4.4.1.cmml" xref="S3.SS3.p4.4.m4.4.4.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.5c">\mathcal{S}_{c}^{t}=\{\mathbf{s}_{c,i}^{t}\}|_{i=1}^{m}</annotation></semantics></math> for each class <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">c</annotation></semantics></math> in round <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><mi id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><ci id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">t</annotation></semantics></math>, where <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">m</annotation></semantics></math> is the number of federated features of each class.
First, the server aggregates real feature gradients of each class <math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><mi id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><ci id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">c</annotation></semantics></math> by averaging over all selected clients in <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="\mathcal{A}^{t}" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><msup id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.9.m9.1.1.2" xref="S3.SS3.p4.9.m9.1.1.2.cmml">𝒜</mi><mi id="S3.SS3.p4.9.m9.1.1.3" xref="S3.SS3.p4.9.m9.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><apply id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">superscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2">𝒜</ci><ci id="S3.SS3.p4.9.m9.1.1.3.cmml" xref="S3.SS3.p4.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">\mathcal{A}^{t}</annotation></semantics></math>:</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{g}^{agg}_{c}" display="inline"><semantics id="S3.E4.m1.1a"><msubsup id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">𝐠</mi><mi id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">c</mi><mrow id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.2.3.2" xref="S3.E4.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.3.1" xref="S3.E4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.2.3.3" xref="S3.E4.m1.1.1.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.2.3.1a" xref="S3.E4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.2.3.4" xref="S3.E4.m1.1.1.2.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1">subscript</csymbol><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">𝐠</ci><apply id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3"><times id="S3.E4.m1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.2.3.1"></times><ci id="S3.E4.m1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.2.3.2">𝑎</ci><ci id="S3.E4.m1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.2.3.3">𝑔</ci><ci id="S3.E4.m1.1.1.2.3.4.cmml" xref="S3.E4.m1.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\mathbf{g}^{agg}_{c}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{\left|\mathcal{A}_{c}^{t}\right|}\sum_{k=1}^{|\mathcal{A}_{c}^{t}|}\mathbf{g}_{c}^{k}," display="inline"><semantics id="S3.E4.m2.3a"><mrow id="S3.E4.m2.3.3.1" xref="S3.E4.m2.3.3.1.1.cmml"><mrow id="S3.E4.m2.3.3.1.1" xref="S3.E4.m2.3.3.1.1.cmml"><mi id="S3.E4.m2.3.3.1.1.2" xref="S3.E4.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E4.m2.3.3.1.1.1" xref="S3.E4.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E4.m2.3.3.1.1.3" xref="S3.E4.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E4.m2.1.1" xref="S3.E4.m2.1.1.cmml"><mfrac id="S3.E4.m2.1.1a" xref="S3.E4.m2.1.1.cmml"><mn id="S3.E4.m2.1.1.3" xref="S3.E4.m2.1.1.3.cmml">1</mn><mrow id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.2.cmml"><mo id="S3.E4.m2.1.1.1.1.2" xref="S3.E4.m2.1.1.1.2.1.cmml">|</mo><msubsup id="S3.E4.m2.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m2.1.1.1.1.1.2.2" xref="S3.E4.m2.1.1.1.1.1.2.2.cmml">𝒜</mi><mi id="S3.E4.m2.1.1.1.1.1.2.3" xref="S3.E4.m2.1.1.1.1.1.2.3.cmml">c</mi><mi id="S3.E4.m2.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E4.m2.1.1.1.1.3" xref="S3.E4.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E4.m2.3.3.1.1.3.1" xref="S3.E4.m2.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m2.3.3.1.1.3.2" xref="S3.E4.m2.3.3.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E4.m2.3.3.1.1.3.2.1" xref="S3.E4.m2.3.3.1.1.3.2.1.cmml"><munderover id="S3.E4.m2.3.3.1.1.3.2.1a" xref="S3.E4.m2.3.3.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E4.m2.3.3.1.1.3.2.1.2.2" xref="S3.E4.m2.3.3.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E4.m2.3.3.1.1.3.2.1.2.3" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.cmml"><mi id="S3.E4.m2.3.3.1.1.3.2.1.2.3.2" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E4.m2.3.3.1.1.3.2.1.2.3.1" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E4.m2.3.3.1.1.3.2.1.2.3.3" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E4.m2.2.2.1.1" xref="S3.E4.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.2.2.1.1.2" xref="S3.E4.m2.2.2.1.2.1.cmml">|</mo><msubsup id="S3.E4.m2.2.2.1.1.1" xref="S3.E4.m2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m2.2.2.1.1.1.2.2" xref="S3.E4.m2.2.2.1.1.1.2.2.cmml">𝒜</mi><mi id="S3.E4.m2.2.2.1.1.1.2.3" xref="S3.E4.m2.2.2.1.1.1.2.3.cmml">c</mi><mi id="S3.E4.m2.2.2.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E4.m2.2.2.1.1.3" xref="S3.E4.m2.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><msubsup id="S3.E4.m2.3.3.1.1.3.2.2" xref="S3.E4.m2.3.3.1.1.3.2.2.cmml"><mi id="S3.E4.m2.3.3.1.1.3.2.2.2.2" xref="S3.E4.m2.3.3.1.1.3.2.2.2.2.cmml">𝐠</mi><mi id="S3.E4.m2.3.3.1.1.3.2.2.2.3" xref="S3.E4.m2.3.3.1.1.3.2.2.2.3.cmml">c</mi><mi id="S3.E4.m2.3.3.1.1.3.2.2.3" xref="S3.E4.m2.3.3.1.1.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S3.E4.m2.3.3.1.2" xref="S3.E4.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.3b"><apply id="S3.E4.m2.3.3.1.1.cmml" xref="S3.E4.m2.3.3.1"><eq id="S3.E4.m2.3.3.1.1.1.cmml" xref="S3.E4.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E4.m2.3.3.1.1.2.cmml" xref="S3.E4.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E4.m2.3.3.1.1.3.cmml" xref="S3.E4.m2.3.3.1.1.3"><times id="S3.E4.m2.3.3.1.1.3.1.cmml" xref="S3.E4.m2.3.3.1.1.3.1"></times><apply id="S3.E4.m2.1.1.cmml" xref="S3.E4.m2.1.1"><divide id="S3.E4.m2.1.1.2.cmml" xref="S3.E4.m2.1.1"></divide><cn type="integer" id="S3.E4.m2.1.1.3.cmml" xref="S3.E4.m2.1.1.3">1</cn><apply id="S3.E4.m2.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1"><abs id="S3.E4.m2.1.1.1.2.1.cmml" xref="S3.E4.m2.1.1.1.1.2"></abs><apply id="S3.E4.m2.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m2.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.1.1.1.1.1.2.2">𝒜</ci><ci id="S3.E4.m2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E4.m2.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m2.3.3.1.1.3.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2"><apply id="S3.E4.m2.3.3.1.1.3.2.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.3.2.1.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1">superscript</csymbol><apply id="S3.E4.m2.3.3.1.1.3.2.1.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.3.2.1.2.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1">subscript</csymbol><sum id="S3.E4.m2.3.3.1.1.3.2.1.2.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1.2.2"></sum><apply id="S3.E4.m2.3.3.1.1.3.2.1.2.3.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3"><eq id="S3.E4.m2.3.3.1.1.3.2.1.2.3.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.1"></eq><ci id="S3.E4.m2.3.3.1.1.3.2.1.2.3.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m2.3.3.1.1.3.2.1.2.3.3.cmml" xref="S3.E4.m2.3.3.1.1.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m2.2.2.1.2.cmml" xref="S3.E4.m2.2.2.1.1"><abs id="S3.E4.m2.2.2.1.2.1.cmml" xref="S3.E4.m2.2.2.1.1.2"></abs><apply id="S3.E4.m2.2.2.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.E4.m2.2.2.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.2.1.cmml" xref="S3.E4.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.2.2.cmml" xref="S3.E4.m2.2.2.1.1.1.2.2">𝒜</ci><ci id="S3.E4.m2.2.2.1.1.1.2.3.cmml" xref="S3.E4.m2.2.2.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E4.m2.2.2.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m2.3.3.1.1.3.2.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.3.2.2.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2">superscript</csymbol><apply id="S3.E4.m2.3.3.1.1.3.2.2.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m2.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m2.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2.2.2">𝐠</ci><ci id="S3.E4.m2.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2.2.3">𝑐</ci></apply><ci id="S3.E4.m2.3.3.1.1.3.2.2.3.cmml" xref="S3.E4.m2.3.3.1.1.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.3c">\displaystyle=\frac{1}{\left|\mathcal{A}_{c}^{t}\right|}\sum_{k=1}^{|\mathcal{A}_{c}^{t}|}\mathbf{g}_{c}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.16" class="ltx_p">where <math id="S3.SS3.p4.10.m1.1" class="ltx_Math" alttext="\mathcal{A}_{c}^{t}" display="inline"><semantics id="S3.SS3.p4.10.m1.1a"><msubsup id="S3.SS3.p4.10.m1.1.1" xref="S3.SS3.p4.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.10.m1.1.1.2.2" xref="S3.SS3.p4.10.m1.1.1.2.2.cmml">𝒜</mi><mi id="S3.SS3.p4.10.m1.1.1.2.3" xref="S3.SS3.p4.10.m1.1.1.2.3.cmml">c</mi><mi id="S3.SS3.p4.10.m1.1.1.3" xref="S3.SS3.p4.10.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m1.1b"><apply id="S3.SS3.p4.10.m1.1.1.cmml" xref="S3.SS3.p4.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m1.1.1.1.cmml" xref="S3.SS3.p4.10.m1.1.1">superscript</csymbol><apply id="S3.SS3.p4.10.m1.1.1.2.cmml" xref="S3.SS3.p4.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m1.1.1.2.1.cmml" xref="S3.SS3.p4.10.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.10.m1.1.1.2.2.cmml" xref="S3.SS3.p4.10.m1.1.1.2.2">𝒜</ci><ci id="S3.SS3.p4.10.m1.1.1.2.3.cmml" xref="S3.SS3.p4.10.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS3.p4.10.m1.1.1.3.cmml" xref="S3.SS3.p4.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m1.1c">\mathcal{A}_{c}^{t}</annotation></semantics></math> is the subset of clients that hold class <math id="S3.SS3.p4.11.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.11.m2.1a"><mi id="S3.SS3.p4.11.m2.1.1" xref="S3.SS3.p4.11.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m2.1b"><ci id="S3.SS3.p4.11.m2.1.1.cmml" xref="S3.SS3.p4.11.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m2.1c">c</annotation></semantics></math>.
Then, the server computes the federated feature gradients <math id="S3.SS3.p4.12.m3.1" class="ltx_Math" alttext="\mathbf{g}_{c}^{fed}" display="inline"><semantics id="S3.SS3.p4.12.m3.1a"><msubsup id="S3.SS3.p4.12.m3.1.1" xref="S3.SS3.p4.12.m3.1.1.cmml"><mi id="S3.SS3.p4.12.m3.1.1.2.2" xref="S3.SS3.p4.12.m3.1.1.2.2.cmml">𝐠</mi><mi id="S3.SS3.p4.12.m3.1.1.2.3" xref="S3.SS3.p4.12.m3.1.1.2.3.cmml">c</mi><mrow id="S3.SS3.p4.12.m3.1.1.3" xref="S3.SS3.p4.12.m3.1.1.3.cmml"><mi id="S3.SS3.p4.12.m3.1.1.3.2" xref="S3.SS3.p4.12.m3.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.12.m3.1.1.3.1" xref="S3.SS3.p4.12.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.12.m3.1.1.3.3" xref="S3.SS3.p4.12.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.12.m3.1.1.3.1a" xref="S3.SS3.p4.12.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.12.m3.1.1.3.4" xref="S3.SS3.p4.12.m3.1.1.3.4.cmml">d</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m3.1b"><apply id="S3.SS3.p4.12.m3.1.1.cmml" xref="S3.SS3.p4.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m3.1.1.1.cmml" xref="S3.SS3.p4.12.m3.1.1">superscript</csymbol><apply id="S3.SS3.p4.12.m3.1.1.2.cmml" xref="S3.SS3.p4.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m3.1.1.2.1.cmml" xref="S3.SS3.p4.12.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.12.m3.1.1.2.2.cmml" xref="S3.SS3.p4.12.m3.1.1.2.2">𝐠</ci><ci id="S3.SS3.p4.12.m3.1.1.2.3.cmml" xref="S3.SS3.p4.12.m3.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p4.12.m3.1.1.3.cmml" xref="S3.SS3.p4.12.m3.1.1.3"><times id="S3.SS3.p4.12.m3.1.1.3.1.cmml" xref="S3.SS3.p4.12.m3.1.1.3.1"></times><ci id="S3.SS3.p4.12.m3.1.1.3.2.cmml" xref="S3.SS3.p4.12.m3.1.1.3.2">𝑓</ci><ci id="S3.SS3.p4.12.m3.1.1.3.3.cmml" xref="S3.SS3.p4.12.m3.1.1.3.3">𝑒</ci><ci id="S3.SS3.p4.12.m3.1.1.3.4.cmml" xref="S3.SS3.p4.12.m3.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m3.1c">\mathbf{g}_{c}^{fed}</annotation></semantics></math> over federated features <math id="S3.SS3.p4.13.m4.1" class="ltx_Math" alttext="\mathcal{S}^{t}" display="inline"><semantics id="S3.SS3.p4.13.m4.1a"><msup id="S3.SS3.p4.13.m4.1.1" xref="S3.SS3.p4.13.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.13.m4.1.1.2" xref="S3.SS3.p4.13.m4.1.1.2.cmml">𝒮</mi><mi id="S3.SS3.p4.13.m4.1.1.3" xref="S3.SS3.p4.13.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m4.1b"><apply id="S3.SS3.p4.13.m4.1.1.cmml" xref="S3.SS3.p4.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.13.m4.1.1.1.cmml" xref="S3.SS3.p4.13.m4.1.1">superscript</csymbol><ci id="S3.SS3.p4.13.m4.1.1.2.cmml" xref="S3.SS3.p4.13.m4.1.1.2">𝒮</ci><ci id="S3.SS3.p4.13.m4.1.1.3.cmml" xref="S3.SS3.p4.13.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m4.1c">\mathcal{S}^{t}</annotation></semantics></math> of class <math id="S3.SS3.p4.14.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p4.14.m5.1a"><mi id="S3.SS3.p4.14.m5.1.1" xref="S3.SS3.p4.14.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m5.1b"><ci id="S3.SS3.p4.14.m5.1.1.cmml" xref="S3.SS3.p4.14.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m5.1c">c</annotation></semantics></math> by using the same re-trained classifier <math id="S3.SS3.p4.15.m6.1" class="ltx_Math" alttext="\widehat{\mathbf{v}}^{t}" display="inline"><semantics id="S3.SS3.p4.15.m6.1a"><msup id="S3.SS3.p4.15.m6.1.1" xref="S3.SS3.p4.15.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p4.15.m6.1.1.2" xref="S3.SS3.p4.15.m6.1.1.2.cmml"><mi id="S3.SS3.p4.15.m6.1.1.2.2" xref="S3.SS3.p4.15.m6.1.1.2.2.cmml">𝐯</mi><mo id="S3.SS3.p4.15.m6.1.1.2.1" xref="S3.SS3.p4.15.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p4.15.m6.1.1.3" xref="S3.SS3.p4.15.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.15.m6.1b"><apply id="S3.SS3.p4.15.m6.1.1.cmml" xref="S3.SS3.p4.15.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.15.m6.1.1.1.cmml" xref="S3.SS3.p4.15.m6.1.1">superscript</csymbol><apply id="S3.SS3.p4.15.m6.1.1.2.cmml" xref="S3.SS3.p4.15.m6.1.1.2"><ci id="S3.SS3.p4.15.m6.1.1.2.1.cmml" xref="S3.SS3.p4.15.m6.1.1.2.1">^</ci><ci id="S3.SS3.p4.15.m6.1.1.2.2.cmml" xref="S3.SS3.p4.15.m6.1.1.2.2">𝐯</ci></apply><ci id="S3.SS3.p4.15.m6.1.1.3.cmml" xref="S3.SS3.p4.15.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.15.m6.1c">\widehat{\mathbf{v}}^{t}</annotation></semantics></math> as calculating <math id="S3.SS3.p4.16.m7.1" class="ltx_Math" alttext="\mathbf{g}^{agg}_{c}" display="inline"><semantics id="S3.SS3.p4.16.m7.1a"><msubsup id="S3.SS3.p4.16.m7.1.1" xref="S3.SS3.p4.16.m7.1.1.cmml"><mi id="S3.SS3.p4.16.m7.1.1.2.2" xref="S3.SS3.p4.16.m7.1.1.2.2.cmml">𝐠</mi><mi id="S3.SS3.p4.16.m7.1.1.3" xref="S3.SS3.p4.16.m7.1.1.3.cmml">c</mi><mrow id="S3.SS3.p4.16.m7.1.1.2.3" xref="S3.SS3.p4.16.m7.1.1.2.3.cmml"><mi id="S3.SS3.p4.16.m7.1.1.2.3.2" xref="S3.SS3.p4.16.m7.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.16.m7.1.1.2.3.1" xref="S3.SS3.p4.16.m7.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.16.m7.1.1.2.3.3" xref="S3.SS3.p4.16.m7.1.1.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.16.m7.1.1.2.3.1a" xref="S3.SS3.p4.16.m7.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.16.m7.1.1.2.3.4" xref="S3.SS3.p4.16.m7.1.1.2.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.16.m7.1b"><apply id="S3.SS3.p4.16.m7.1.1.cmml" xref="S3.SS3.p4.16.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.16.m7.1.1.1.cmml" xref="S3.SS3.p4.16.m7.1.1">subscript</csymbol><apply id="S3.SS3.p4.16.m7.1.1.2.cmml" xref="S3.SS3.p4.16.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.16.m7.1.1.2.1.cmml" xref="S3.SS3.p4.16.m7.1.1">superscript</csymbol><ci id="S3.SS3.p4.16.m7.1.1.2.2.cmml" xref="S3.SS3.p4.16.m7.1.1.2.2">𝐠</ci><apply id="S3.SS3.p4.16.m7.1.1.2.3.cmml" xref="S3.SS3.p4.16.m7.1.1.2.3"><times id="S3.SS3.p4.16.m7.1.1.2.3.1.cmml" xref="S3.SS3.p4.16.m7.1.1.2.3.1"></times><ci id="S3.SS3.p4.16.m7.1.1.2.3.2.cmml" xref="S3.SS3.p4.16.m7.1.1.2.3.2">𝑎</ci><ci id="S3.SS3.p4.16.m7.1.1.2.3.3.cmml" xref="S3.SS3.p4.16.m7.1.1.2.3.3">𝑔</ci><ci id="S3.SS3.p4.16.m7.1.1.2.3.4.cmml" xref="S3.SS3.p4.16.m7.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS3.p4.16.m7.1.1.3.cmml" xref="S3.SS3.p4.16.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.16.m7.1c">\mathbf{g}^{agg}_{c}</annotation></semantics></math>:</p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{g}_{c}^{fed}" display="inline"><semantics id="S3.E5.m1.1a"><msubsup id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.2.2" xref="S3.E5.m1.1.1.2.2.cmml">𝐠</mi><mi id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml">c</mi><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.1a" xref="S3.E5.m1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.4" xref="S3.E5.m1.1.1.3.4.cmml">d</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2.2">𝐠</ci><ci id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3">𝑐</ci></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><times id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></times><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑓</ci><ci id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3">𝑒</ci><ci id="S3.E5.m1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\mathbf{g}_{c}^{fed}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\nabla_{\widehat{\mathbf{v}}}\ell(h_{\widehat{\mathbf{v}}^{t}}(\mathbf{s}_{c,i}^{t}),y_{i})." display="inline"><semantics id="S3.E5.m2.3a"><mrow id="S3.E5.m2.3.3.1" xref="S3.E5.m2.3.3.1.1.cmml"><mrow id="S3.E5.m2.3.3.1.1" xref="S3.E5.m2.3.3.1.1.cmml"><mi id="S3.E5.m2.3.3.1.1.4" xref="S3.E5.m2.3.3.1.1.4.cmml"></mi><mo id="S3.E5.m2.3.3.1.1.3" xref="S3.E5.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E5.m2.3.3.1.1.2" xref="S3.E5.m2.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E5.m2.3.3.1.1.2.4" xref="S3.E5.m2.3.3.1.1.2.4.cmml"><mfrac id="S3.E5.m2.3.3.1.1.2.4a" xref="S3.E5.m2.3.3.1.1.2.4.cmml"><mn id="S3.E5.m2.3.3.1.1.2.4.2" xref="S3.E5.m2.3.3.1.1.2.4.2.cmml">1</mn><mi id="S3.E5.m2.3.3.1.1.2.4.3" xref="S3.E5.m2.3.3.1.1.2.4.3.cmml">m</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E5.m2.3.3.1.1.2.3" xref="S3.E5.m2.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m2.3.3.1.1.2.2" xref="S3.E5.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E5.m2.3.3.1.1.2.2.3" xref="S3.E5.m2.3.3.1.1.2.2.3.cmml"><munderover id="S3.E5.m2.3.3.1.1.2.2.3a" xref="S3.E5.m2.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E5.m2.3.3.1.1.2.2.3.2.2" xref="S3.E5.m2.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E5.m2.3.3.1.1.2.2.3.2.3" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E5.m2.3.3.1.1.2.2.3.2.3.2" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E5.m2.3.3.1.1.2.2.3.2.3.1" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E5.m2.3.3.1.1.2.2.3.2.3.3" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m2.3.3.1.1.2.2.3.3" xref="S3.E5.m2.3.3.1.1.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E5.m2.3.3.1.1.2.2.2" xref="S3.E5.m2.3.3.1.1.2.2.2.cmml"><mrow id="S3.E5.m2.3.3.1.1.2.2.2.4" xref="S3.E5.m2.3.3.1.1.2.2.2.4.cmml"><msub id="S3.E5.m2.3.3.1.1.2.2.2.4.1" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="S3.E5.m2.3.3.1.1.2.2.2.4.1.2" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.2.cmml">∇</mo><mover accent="true" id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.cmml"><mi id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.2" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.2.cmml">𝐯</mi><mo id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.1" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.1.cmml">^</mo></mover></msub><mi mathvariant="normal" id="S3.E5.m2.3.3.1.1.2.2.2.4.2" xref="S3.E5.m2.3.3.1.1.2.2.2.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m2.3.3.1.1.2.2.2.3" xref="S3.E5.m2.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E5.m2.3.3.1.1.2.2.2.2.2" xref="S3.E5.m2.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E5.m2.3.3.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><msup id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐯</mi><mo id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msup></msub><mo lspace="0em" rspace="0em" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mrow id="S3.E5.m2.2.2.2.4" xref="S3.E5.m2.2.2.2.3.cmml"><mi id="S3.E5.m2.1.1.1.1" xref="S3.E5.m2.1.1.1.1.cmml">c</mi><mo id="S3.E5.m2.2.2.2.4.1" xref="S3.E5.m2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m2.2.2.2.2" xref="S3.E5.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m2.3.3.1.1.2.2.2.2.2.4" xref="S3.E5.m2.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E5.m2.3.3.1.1.2.2.2.2.2.5" xref="S3.E5.m2.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m2.3.3.1.2" xref="S3.E5.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.3b"><apply id="S3.E5.m2.3.3.1.1.cmml" xref="S3.E5.m2.3.3.1"><eq id="S3.E5.m2.3.3.1.1.3.cmml" xref="S3.E5.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S3.E5.m2.3.3.1.1.4.cmml" xref="S3.E5.m2.3.3.1.1.4">absent</csymbol><apply id="S3.E5.m2.3.3.1.1.2.cmml" xref="S3.E5.m2.3.3.1.1.2"><times id="S3.E5.m2.3.3.1.1.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.3"></times><apply id="S3.E5.m2.3.3.1.1.2.4.cmml" xref="S3.E5.m2.3.3.1.1.2.4"><divide id="S3.E5.m2.3.3.1.1.2.4.1.cmml" xref="S3.E5.m2.3.3.1.1.2.4"></divide><cn type="integer" id="S3.E5.m2.3.3.1.1.2.4.2.cmml" xref="S3.E5.m2.3.3.1.1.2.4.2">1</cn><ci id="S3.E5.m2.3.3.1.1.2.4.3.cmml" xref="S3.E5.m2.3.3.1.1.2.4.3">𝑚</ci></apply><apply id="S3.E5.m2.3.3.1.1.2.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2"><apply id="S3.E5.m2.3.3.1.1.2.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E5.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E5.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E5.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3"><eq id="S3.E5.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E5.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m2.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E5.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.3.3">𝑚</ci></apply><apply id="S3.E5.m2.3.3.1.1.2.2.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2"><times id="S3.E5.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.3"></times><apply id="S3.E5.m2.3.3.1.1.2.2.2.4.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4"><apply id="S3.E5.m2.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.2.2.2.4.1.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1">subscript</csymbol><ci id="S3.E5.m2.3.3.1.1.2.2.2.4.1.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.2">∇</ci><apply id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3"><ci id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.1">^</ci><ci id="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.1.3.2">𝐯</ci></apply></apply><ci id="S3.E5.m2.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.4.2">ℓ</ci></apply><interval closure="open" id="S3.E5.m2.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2"><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1"><times id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.1">^</ci><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.2">𝐯</ci></apply><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐬</ci><list id="S3.E5.m2.2.2.2.3.cmml" xref="S3.E5.m2.2.2.2.4"><ci id="S3.E5.m2.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1">𝑐</ci><ci id="S3.E5.m2.2.2.2.2.cmml" xref="S3.E5.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m2.3.3.1.1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.3c">\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\nabla_{\widehat{\mathbf{v}}}\ell(h_{\widehat{\mathbf{v}}^{t}}(\mathbf{s}_{c,i}^{t}),y_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.20" class="ltx_p">Both <math id="S3.SS3.p4.17.m1.1" class="ltx_Math" alttext="\mathbf{g}^{fed}_{c}" display="inline"><semantics id="S3.SS3.p4.17.m1.1a"><msubsup id="S3.SS3.p4.17.m1.1.1" xref="S3.SS3.p4.17.m1.1.1.cmml"><mi id="S3.SS3.p4.17.m1.1.1.2.2" xref="S3.SS3.p4.17.m1.1.1.2.2.cmml">𝐠</mi><mi id="S3.SS3.p4.17.m1.1.1.3" xref="S3.SS3.p4.17.m1.1.1.3.cmml">c</mi><mrow id="S3.SS3.p4.17.m1.1.1.2.3" xref="S3.SS3.p4.17.m1.1.1.2.3.cmml"><mi id="S3.SS3.p4.17.m1.1.1.2.3.2" xref="S3.SS3.p4.17.m1.1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m1.1.1.2.3.1" xref="S3.SS3.p4.17.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.17.m1.1.1.2.3.3" xref="S3.SS3.p4.17.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.17.m1.1.1.2.3.1a" xref="S3.SS3.p4.17.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.17.m1.1.1.2.3.4" xref="S3.SS3.p4.17.m1.1.1.2.3.4.cmml">d</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.17.m1.1b"><apply id="S3.SS3.p4.17.m1.1.1.cmml" xref="S3.SS3.p4.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.1.1.1.cmml" xref="S3.SS3.p4.17.m1.1.1">subscript</csymbol><apply id="S3.SS3.p4.17.m1.1.1.2.cmml" xref="S3.SS3.p4.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.17.m1.1.1.2.1.cmml" xref="S3.SS3.p4.17.m1.1.1">superscript</csymbol><ci id="S3.SS3.p4.17.m1.1.1.2.2.cmml" xref="S3.SS3.p4.17.m1.1.1.2.2">𝐠</ci><apply id="S3.SS3.p4.17.m1.1.1.2.3.cmml" xref="S3.SS3.p4.17.m1.1.1.2.3"><times id="S3.SS3.p4.17.m1.1.1.2.3.1.cmml" xref="S3.SS3.p4.17.m1.1.1.2.3.1"></times><ci id="S3.SS3.p4.17.m1.1.1.2.3.2.cmml" xref="S3.SS3.p4.17.m1.1.1.2.3.2">𝑓</ci><ci id="S3.SS3.p4.17.m1.1.1.2.3.3.cmml" xref="S3.SS3.p4.17.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.p4.17.m1.1.1.2.3.4.cmml" xref="S3.SS3.p4.17.m1.1.1.2.3.4">𝑑</ci></apply></apply><ci id="S3.SS3.p4.17.m1.1.1.3.cmml" xref="S3.SS3.p4.17.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.17.m1.1c">\mathbf{g}^{fed}_{c}</annotation></semantics></math> and <math id="S3.SS3.p4.18.m2.1" class="ltx_Math" alttext="\mathbf{g}_{c}^{agg}" display="inline"><semantics id="S3.SS3.p4.18.m2.1a"><msubsup id="S3.SS3.p4.18.m2.1.1" xref="S3.SS3.p4.18.m2.1.1.cmml"><mi id="S3.SS3.p4.18.m2.1.1.2.2" xref="S3.SS3.p4.18.m2.1.1.2.2.cmml">𝐠</mi><mi id="S3.SS3.p4.18.m2.1.1.2.3" xref="S3.SS3.p4.18.m2.1.1.2.3.cmml">c</mi><mrow id="S3.SS3.p4.18.m2.1.1.3" xref="S3.SS3.p4.18.m2.1.1.3.cmml"><mi id="S3.SS3.p4.18.m2.1.1.3.2" xref="S3.SS3.p4.18.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m2.1.1.3.1" xref="S3.SS3.p4.18.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.18.m2.1.1.3.3" xref="S3.SS3.p4.18.m2.1.1.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.18.m2.1.1.3.1a" xref="S3.SS3.p4.18.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.18.m2.1.1.3.4" xref="S3.SS3.p4.18.m2.1.1.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.18.m2.1b"><apply id="S3.SS3.p4.18.m2.1.1.cmml" xref="S3.SS3.p4.18.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.18.m2.1.1.1.cmml" xref="S3.SS3.p4.18.m2.1.1">superscript</csymbol><apply id="S3.SS3.p4.18.m2.1.1.2.cmml" xref="S3.SS3.p4.18.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.18.m2.1.1.2.1.cmml" xref="S3.SS3.p4.18.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.18.m2.1.1.2.2.cmml" xref="S3.SS3.p4.18.m2.1.1.2.2">𝐠</ci><ci id="S3.SS3.p4.18.m2.1.1.2.3.cmml" xref="S3.SS3.p4.18.m2.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p4.18.m2.1.1.3.cmml" xref="S3.SS3.p4.18.m2.1.1.3"><times id="S3.SS3.p4.18.m2.1.1.3.1.cmml" xref="S3.SS3.p4.18.m2.1.1.3.1"></times><ci id="S3.SS3.p4.18.m2.1.1.3.2.cmml" xref="S3.SS3.p4.18.m2.1.1.3.2">𝑎</ci><ci id="S3.SS3.p4.18.m2.1.1.3.3.cmml" xref="S3.SS3.p4.18.m2.1.1.3.3">𝑔</ci><ci id="S3.SS3.p4.18.m2.1.1.3.4.cmml" xref="S3.SS3.p4.18.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.18.m2.1c">\mathbf{g}_{c}^{agg}</annotation></semantics></math> are gradients of the same re-trained classifier <math id="S3.SS3.p4.19.m3.1" class="ltx_Math" alttext="\widehat{\mathbf{v}}" display="inline"><semantics id="S3.SS3.p4.19.m3.1a"><mover accent="true" id="S3.SS3.p4.19.m3.1.1" xref="S3.SS3.p4.19.m3.1.1.cmml"><mi id="S3.SS3.p4.19.m3.1.1.2" xref="S3.SS3.p4.19.m3.1.1.2.cmml">𝐯</mi><mo id="S3.SS3.p4.19.m3.1.1.1" xref="S3.SS3.p4.19.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.19.m3.1b"><apply id="S3.SS3.p4.19.m3.1.1.cmml" xref="S3.SS3.p4.19.m3.1.1"><ci id="S3.SS3.p4.19.m3.1.1.1.cmml" xref="S3.SS3.p4.19.m3.1.1.1">^</ci><ci id="S3.SS3.p4.19.m3.1.1.2.cmml" xref="S3.SS3.p4.19.m3.1.1.2">𝐯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.19.m3.1c">\widehat{\mathbf{v}}</annotation></semantics></math>, whose dimensions are <math id="S3.SS3.p4.20.m4.1" class="ltx_Math" alttext="C\times d" display="inline"><semantics id="S3.SS3.p4.20.m4.1a"><mrow id="S3.SS3.p4.20.m4.1.1" xref="S3.SS3.p4.20.m4.1.1.cmml"><mi id="S3.SS3.p4.20.m4.1.1.2" xref="S3.SS3.p4.20.m4.1.1.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.20.m4.1.1.1" xref="S3.SS3.p4.20.m4.1.1.1.cmml">×</mo><mi id="S3.SS3.p4.20.m4.1.1.3" xref="S3.SS3.p4.20.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.20.m4.1b"><apply id="S3.SS3.p4.20.m4.1.1.cmml" xref="S3.SS3.p4.20.m4.1.1"><times id="S3.SS3.p4.20.m4.1.1.1.cmml" xref="S3.SS3.p4.20.m4.1.1.1"></times><ci id="S3.SS3.p4.20.m4.1.1.2.cmml" xref="S3.SS3.p4.20.m4.1.1.2">𝐶</ci><ci id="S3.SS3.p4.20.m4.1.1.3.cmml" xref="S3.SS3.p4.20.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.20.m4.1c">C\times d</annotation></semantics></math>. We use the gradient matching loss <cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> to measure the difference between them by averaging the cosine dissimilarity of each part:</p>
<table id="S6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.7" class="ltx_Math" alttext="\displaystyle D(\mathbf{g}^{fed}_{c},\mathbf{g}^{agg}_{c})=\frac{1}{C}\sum_{j=1}^{C}\big{(}1-\frac{\mathbf{g}^{fed}_{c}[j]\cdot\mathbf{g}^{agg}_{c}[j]}{\|\mathbf{g}^{fed}_{c}[j]\|\|\mathbf{g}^{agg}_{c}[j]\|}\big{)}," display="inline"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml"><mi id="S3.E6.m1.7.7.1.1.2.4" xref="S3.E6.m1.7.7.1.1.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.2.3" xref="S3.E6.m1.7.7.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.7.7.1.1.2.2.2" xref="S3.E6.m1.7.7.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.1.1.2.2.2.3" xref="S3.E6.m1.7.7.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E6.m1.7.7.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml">c</mi><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1a" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.4" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.4.cmml">d</mi></mrow></msubsup><mo id="S3.E6.m1.7.7.1.1.2.2.2.4" xref="S3.E6.m1.7.7.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E6.m1.7.7.1.1.2.2.2.2" xref="S3.E6.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.7.7.1.1.2.2.2.2.2.2" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.7.7.1.1.2.2.2.2.3" xref="S3.E6.m1.7.7.1.1.2.2.2.2.3.cmml">c</mi><mrow id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.2" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.3" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1a" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.4" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.4.cmml">g</mi></mrow></msubsup><mo stretchy="false" id="S3.E6.m1.7.7.1.1.2.2.2.5" xref="S3.E6.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.4" xref="S3.E6.m1.7.7.1.1.4.cmml">=</mo><mrow id="S3.E6.m1.7.7.1.1.3" xref="S3.E6.m1.7.7.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E6.m1.7.7.1.1.3.3" xref="S3.E6.m1.7.7.1.1.3.3.cmml"><mfrac id="S3.E6.m1.7.7.1.1.3.3a" xref="S3.E6.m1.7.7.1.1.3.3.cmml"><mn id="S3.E6.m1.7.7.1.1.3.3.2" xref="S3.E6.m1.7.7.1.1.3.3.2.cmml">1</mn><mi id="S3.E6.m1.7.7.1.1.3.3.3" xref="S3.E6.m1.7.7.1.1.3.3.3.cmml">C</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.3.2" xref="S3.E6.m1.7.7.1.1.3.2.cmml">​</mo><mrow id="S3.E6.m1.7.7.1.1.3.1" xref="S3.E6.m1.7.7.1.1.3.1.cmml"><mstyle displaystyle="true" id="S3.E6.m1.7.7.1.1.3.1.2" xref="S3.E6.m1.7.7.1.1.3.1.2.cmml"><munderover id="S3.E6.m1.7.7.1.1.3.1.2a" xref="S3.E6.m1.7.7.1.1.3.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.7.7.1.1.3.1.2.2.2" xref="S3.E6.m1.7.7.1.1.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.7.7.1.1.3.1.2.2.3" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.3.1.2.2.3.2" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.2.cmml">j</mi><mo id="S3.E6.m1.7.7.1.1.3.1.2.2.3.1" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.7.7.1.1.3.1.2.2.3.3" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.7.7.1.1.3.1.2.3" xref="S3.E6.m1.7.7.1.1.3.1.2.3.cmml">C</mi></munderover></mstyle><mrow id="S3.E6.m1.7.7.1.1.3.1.1.1" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S3.E6.m1.7.7.1.1.3.1.1.1.2" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.7.7.1.1.3.1.1.1.1" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.cmml"><mn id="S3.E6.m1.7.7.1.1.3.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.7.7.1.1.3.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><mfrac id="S3.E6.m1.6.6a" xref="S3.E6.m1.6.6.cmml"><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.4.cmml"><mrow id="S3.E6.m1.2.2.2.4.2" xref="S3.E6.m1.2.2.2.4.2.cmml"><msubsup id="S3.E6.m1.2.2.2.4.2.2" xref="S3.E6.m1.2.2.2.4.2.2.cmml"><mi id="S3.E6.m1.2.2.2.4.2.2.2.2" xref="S3.E6.m1.2.2.2.4.2.2.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.2.2.2.4.2.2.3" xref="S3.E6.m1.2.2.2.4.2.2.3.cmml">c</mi><mrow id="S3.E6.m1.2.2.2.4.2.2.2.3" xref="S3.E6.m1.2.2.2.4.2.2.2.3.cmml"><mi id="S3.E6.m1.2.2.2.4.2.2.2.3.2" xref="S3.E6.m1.2.2.2.4.2.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.4.2.2.2.3.1" xref="S3.E6.m1.2.2.2.4.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.4.2.2.2.3.3" xref="S3.E6.m1.2.2.2.4.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.4.2.2.2.3.1a" xref="S3.E6.m1.2.2.2.4.2.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.4.2.2.2.3.4" xref="S3.E6.m1.2.2.2.4.2.2.2.3.4.cmml">d</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.4.2.1" xref="S3.E6.m1.2.2.2.4.2.1.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.4.2.3.2" xref="S3.E6.m1.2.2.2.4.2.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.4.2.3.2.1" xref="S3.E6.m1.2.2.2.4.2.3.1.1.cmml">[</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">j</mi><mo rspace="0.055em" stretchy="false" id="S3.E6.m1.2.2.2.4.2.3.2.2" xref="S3.E6.m1.2.2.2.4.2.3.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.222em" id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.4.1.cmml">⋅</mo><msubsup id="S3.E6.m1.2.2.2.4.3" xref="S3.E6.m1.2.2.2.4.3.cmml"><mi id="S3.E6.m1.2.2.2.4.3.2.2" xref="S3.E6.m1.2.2.2.4.3.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.2.2.2.4.3.3" xref="S3.E6.m1.2.2.2.4.3.3.cmml">c</mi><mrow id="S3.E6.m1.2.2.2.4.3.2.3" xref="S3.E6.m1.2.2.2.4.3.2.3.cmml"><mi id="S3.E6.m1.2.2.2.4.3.2.3.2" xref="S3.E6.m1.2.2.2.4.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.4.3.2.3.1" xref="S3.E6.m1.2.2.2.4.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.4.3.2.3.3" xref="S3.E6.m1.2.2.2.4.3.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.4.3.2.3.1a" xref="S3.E6.m1.2.2.2.4.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.4.3.2.3.4" xref="S3.E6.m1.2.2.2.4.3.2.3.4.cmml">g</mi></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.5.2" xref="S3.E6.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.5.2.1" xref="S3.E6.m1.2.2.2.5.1.1.cmml">[</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.2.2.2.5.2.2" xref="S3.E6.m1.2.2.2.5.1.1.cmml">]</mo></mrow></mrow><mrow id="S3.E6.m1.6.6.6" xref="S3.E6.m1.6.6.6.cmml"><mrow id="S3.E6.m1.5.5.5.3.1" xref="S3.E6.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.2" xref="S3.E6.m1.5.5.5.3.2.1.cmml">‖</mo><mrow id="S3.E6.m1.5.5.5.3.1.1" xref="S3.E6.m1.5.5.5.3.1.1.cmml"><msubsup id="S3.E6.m1.5.5.5.3.1.1.2" xref="S3.E6.m1.5.5.5.3.1.1.2.cmml"><mi id="S3.E6.m1.5.5.5.3.1.1.2.2.2" xref="S3.E6.m1.5.5.5.3.1.1.2.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.5.5.5.3.1.1.2.3" xref="S3.E6.m1.5.5.5.3.1.1.2.3.cmml">c</mi><mrow id="S3.E6.m1.5.5.5.3.1.1.2.2.3" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.cmml"><mi id="S3.E6.m1.5.5.5.3.1.1.2.2.3.2" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.3.1.1.2.2.3.1" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.3.1.1.2.2.3.3" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.3.1.1.2.2.3.1a" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.3.1.1.2.2.3.4" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.4.cmml">d</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.3.1.1.1" xref="S3.E6.m1.5.5.5.3.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.5.5.5.3.1.1.3.2" xref="S3.E6.m1.5.5.5.3.1.1.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.1.3.2.1" xref="S3.E6.m1.5.5.5.3.1.1.3.1.1.cmml">[</mo><mi id="S3.E6.m1.3.3.3.1" xref="S3.E6.m1.3.3.3.1.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.1.3.2.2" xref="S3.E6.m1.5.5.5.3.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.3" xref="S3.E6.m1.5.5.5.3.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.5" xref="S3.E6.m1.6.6.6.5.cmml">​</mo><mrow id="S3.E6.m1.6.6.6.4.1" xref="S3.E6.m1.6.6.6.4.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.6.4.1.2" xref="S3.E6.m1.6.6.6.4.2.1.cmml">‖</mo><mrow id="S3.E6.m1.6.6.6.4.1.1" xref="S3.E6.m1.6.6.6.4.1.1.cmml"><msubsup id="S3.E6.m1.6.6.6.4.1.1.2" xref="S3.E6.m1.6.6.6.4.1.1.2.cmml"><mi id="S3.E6.m1.6.6.6.4.1.1.2.2.2" xref="S3.E6.m1.6.6.6.4.1.1.2.2.2.cmml">𝐠</mi><mi id="S3.E6.m1.6.6.6.4.1.1.2.3" xref="S3.E6.m1.6.6.6.4.1.1.2.3.cmml">c</mi><mrow id="S3.E6.m1.6.6.6.4.1.1.2.2.3" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.cmml"><mi id="S3.E6.m1.6.6.6.4.1.1.2.2.3.2" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.4.1.1.2.2.3.1" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.4.1.1.2.2.3.3" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.4.1.1.2.2.3.1a" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.6.6.6.4.1.1.2.2.3.4" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.4.cmml">g</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.6.4.1.1.1" xref="S3.E6.m1.6.6.6.4.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.6.6.6.4.1.1.3.2" xref="S3.E6.m1.6.6.6.4.1.1.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.6.4.1.1.3.2.1" xref="S3.E6.m1.6.6.6.4.1.1.3.1.1.cmml">[</mo><mi id="S3.E6.m1.4.4.4.2" xref="S3.E6.m1.4.4.4.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.6.6.6.4.1.1.3.2.2" xref="S3.E6.m1.6.6.6.4.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.6.6.6.4.1.3" xref="S3.E6.m1.6.6.6.4.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow><mo maxsize="120%" minsize="120%" id="S3.E6.m1.7.7.1.1.3.1.1.1.3" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.2" xref="S3.E6.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.4.cmml" xref="S3.E6.m1.7.7.1.1.4"></eq><apply id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"><times id="S3.E6.m1.7.7.1.1.2.3.cmml" xref="S3.E6.m1.7.7.1.1.2.3"></times><ci id="S3.E6.m1.7.7.1.1.2.4.cmml" xref="S3.E6.m1.7.7.1.1.2.4">𝐷</ci><interval closure="open" id="S3.E6.m1.7.7.1.1.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2"><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2">𝐠</ci><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3"><times id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.2">𝑓</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.3.4">𝑑</ci></apply></apply><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E6.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.7.7.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.2">𝐠</ci><apply id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3"><times id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.2">𝑎</ci><ci id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.3">𝑔</ci><ci id="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.2.3.4">𝑔</ci></apply></apply><ci id="S3.E6.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2.2.3">𝑐</ci></apply></interval></apply><apply id="S3.E6.m1.7.7.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.3"><times id="S3.E6.m1.7.7.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2"></times><apply id="S3.E6.m1.7.7.1.1.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.3"><divide id="S3.E6.m1.7.7.1.1.3.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.3"></divide><cn type="integer" id="S3.E6.m1.7.7.1.1.3.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.3.2">1</cn><ci id="S3.E6.m1.7.7.1.1.3.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.3.3">𝐶</ci></apply><apply id="S3.E6.m1.7.7.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1"><apply id="S3.E6.m1.7.7.1.1.3.1.2.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2">superscript</csymbol><apply id="S3.E6.m1.7.7.1.1.3.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.1.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2">subscript</csymbol><sum id="S3.E6.m1.7.7.1.1.3.1.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.2.2"></sum><apply id="S3.E6.m1.7.7.1.1.3.1.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3"><eq id="S3.E6.m1.7.7.1.1.3.1.2.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.1"></eq><ci id="S3.E6.m1.7.7.1.1.3.1.2.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E6.m1.7.7.1.1.3.1.2.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.7.7.1.1.3.1.2.3.cmml" xref="S3.E6.m1.7.7.1.1.3.1.2.3">𝐶</ci></apply><apply id="S3.E6.m1.7.7.1.1.3.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1.1.1"><minus id="S3.E6.m1.7.7.1.1.3.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.7.7.1.1.3.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.3.1.1.1.1.2">1</cn><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><divide id="S3.E6.m1.6.6.7.cmml" xref="S3.E6.m1.6.6"></divide><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></times><apply id="S3.E6.m1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4.1">⋅</ci><apply id="S3.E6.m1.2.2.2.4.2.cmml" xref="S3.E6.m1.2.2.2.4.2"><times id="S3.E6.m1.2.2.2.4.2.1.cmml" xref="S3.E6.m1.2.2.2.4.2.1"></times><apply id="S3.E6.m1.2.2.2.4.2.2.cmml" xref="S3.E6.m1.2.2.2.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.2.2.1.cmml" xref="S3.E6.m1.2.2.2.4.2.2">subscript</csymbol><apply id="S3.E6.m1.2.2.2.4.2.2.2.cmml" xref="S3.E6.m1.2.2.2.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.4.2.2">superscript</csymbol><ci id="S3.E6.m1.2.2.2.4.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.2">𝐠</ci><apply id="S3.E6.m1.2.2.2.4.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.3"><times id="S3.E6.m1.2.2.2.4.2.2.2.3.1.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.3.1"></times><ci id="S3.E6.m1.2.2.2.4.2.2.2.3.2.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.3.2">𝑓</ci><ci id="S3.E6.m1.2.2.2.4.2.2.2.3.3.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.3.3">𝑒</ci><ci id="S3.E6.m1.2.2.2.4.2.2.2.3.4.cmml" xref="S3.E6.m1.2.2.2.4.2.2.2.3.4">𝑑</ci></apply></apply><ci id="S3.E6.m1.2.2.2.4.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4.2.2.3">𝑐</ci></apply><apply id="S3.E6.m1.2.2.2.4.2.3.1.cmml" xref="S3.E6.m1.2.2.2.4.2.3.2"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.4.2.3.1.1.cmml" xref="S3.E6.m1.2.2.2.4.2.3.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.E6.m1.2.2.2.4.3.cmml" xref="S3.E6.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.3.1.cmml" xref="S3.E6.m1.2.2.2.4.3">subscript</csymbol><apply id="S3.E6.m1.2.2.2.4.3.2.cmml" xref="S3.E6.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.3.2.1.cmml" xref="S3.E6.m1.2.2.2.4.3">superscript</csymbol><ci id="S3.E6.m1.2.2.2.4.3.2.2.cmml" xref="S3.E6.m1.2.2.2.4.3.2.2">𝐠</ci><apply id="S3.E6.m1.2.2.2.4.3.2.3.cmml" xref="S3.E6.m1.2.2.2.4.3.2.3"><times id="S3.E6.m1.2.2.2.4.3.2.3.1.cmml" xref="S3.E6.m1.2.2.2.4.3.2.3.1"></times><ci id="S3.E6.m1.2.2.2.4.3.2.3.2.cmml" xref="S3.E6.m1.2.2.2.4.3.2.3.2">𝑎</ci><ci id="S3.E6.m1.2.2.2.4.3.2.3.3.cmml" xref="S3.E6.m1.2.2.2.4.3.2.3.3">𝑔</ci><ci id="S3.E6.m1.2.2.2.4.3.2.3.4.cmml" xref="S3.E6.m1.2.2.2.4.3.2.3.4">𝑔</ci></apply></apply><ci id="S3.E6.m1.2.2.2.4.3.3.cmml" xref="S3.E6.m1.2.2.2.4.3.3">𝑐</ci></apply></apply><apply id="S3.E6.m1.2.2.2.5.1.cmml" xref="S3.E6.m1.2.2.2.5.2"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.5.1.1.cmml" xref="S3.E6.m1.2.2.2.5.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑗</ci></apply></apply><apply id="S3.E6.m1.6.6.6.cmml" xref="S3.E6.m1.6.6.6"><times id="S3.E6.m1.6.6.6.5.cmml" xref="S3.E6.m1.6.6.6.5"></times><apply id="S3.E6.m1.5.5.5.3.2.cmml" xref="S3.E6.m1.5.5.5.3.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.5.3.2.1.cmml" xref="S3.E6.m1.5.5.5.3.1.2">norm</csymbol><apply id="S3.E6.m1.5.5.5.3.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1"><times id="S3.E6.m1.5.5.5.3.1.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1"></times><apply id="S3.E6.m1.5.5.5.3.1.1.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.3.1.1.2.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2">subscript</csymbol><apply id="S3.E6.m1.5.5.5.3.1.1.2.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.3.1.1.2.2.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2">superscript</csymbol><ci id="S3.E6.m1.5.5.5.3.1.1.2.2.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.2">𝐠</ci><apply id="S3.E6.m1.5.5.5.3.1.1.2.2.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3"><times id="S3.E6.m1.5.5.5.3.1.1.2.2.3.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.1"></times><ci id="S3.E6.m1.5.5.5.3.1.1.2.2.3.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.2">𝑓</ci><ci id="S3.E6.m1.5.5.5.3.1.1.2.2.3.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.3">𝑒</ci><ci id="S3.E6.m1.5.5.5.3.1.1.2.2.3.4.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.2.3.4">𝑑</ci></apply></apply><ci id="S3.E6.m1.5.5.5.3.1.1.2.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2.3">𝑐</ci></apply><apply id="S3.E6.m1.5.5.5.3.1.1.3.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3.2"><csymbol cd="latexml" id="S3.E6.m1.5.5.5.3.1.1.3.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.1">𝑗</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.6.4.2.cmml" xref="S3.E6.m1.6.6.6.4.1"><csymbol cd="latexml" id="S3.E6.m1.6.6.6.4.2.1.cmml" xref="S3.E6.m1.6.6.6.4.1.2">norm</csymbol><apply id="S3.E6.m1.6.6.6.4.1.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1"><times id="S3.E6.m1.6.6.6.4.1.1.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.1"></times><apply id="S3.E6.m1.6.6.6.4.1.1.2.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.4.1.1.2.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2">subscript</csymbol><apply id="S3.E6.m1.6.6.6.4.1.1.2.2.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.4.1.1.2.2.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2">superscript</csymbol><ci id="S3.E6.m1.6.6.6.4.1.1.2.2.2.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.2">𝐠</ci><apply id="S3.E6.m1.6.6.6.4.1.1.2.2.3.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3"><times id="S3.E6.m1.6.6.6.4.1.1.2.2.3.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.1"></times><ci id="S3.E6.m1.6.6.6.4.1.1.2.2.3.2.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.2">𝑎</ci><ci id="S3.E6.m1.6.6.6.4.1.1.2.2.3.3.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.3">𝑔</ci><ci id="S3.E6.m1.6.6.6.4.1.1.2.2.3.4.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.2.3.4">𝑔</ci></apply></apply><ci id="S3.E6.m1.6.6.6.4.1.1.2.3.cmml" xref="S3.E6.m1.6.6.6.4.1.1.2.3">𝑐</ci></apply><apply id="S3.E6.m1.6.6.6.4.1.1.3.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.3.2"><csymbol cd="latexml" id="S3.E6.m1.6.6.6.4.1.1.3.1.1.cmml" xref="S3.E6.m1.6.6.6.4.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E6.m1.4.4.4.2.cmml" xref="S3.E6.m1.4.4.4.2">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\displaystyle D(\mathbf{g}^{fed}_{c},\mathbf{g}^{agg}_{c})=\frac{1}{C}\sum_{j=1}^{C}\big{(}1-\frac{\mathbf{g}^{fed}_{c}[j]\cdot\mathbf{g}^{agg}_{c}[j]}{\|\mathbf{g}^{fed}_{c}[j]\|\|\mathbf{g}^{agg}_{c}[j]\|}\big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.24" class="ltx_p">where <math id="S3.SS3.p4.21.m1.1" class="ltx_Math" alttext="\mathbf{g}[j]" display="inline"><semantics id="S3.SS3.p4.21.m1.1a"><mrow id="S3.SS3.p4.21.m1.1.2" xref="S3.SS3.p4.21.m1.1.2.cmml"><mi id="S3.SS3.p4.21.m1.1.2.2" xref="S3.SS3.p4.21.m1.1.2.2.cmml">𝐠</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.21.m1.1.2.1" xref="S3.SS3.p4.21.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p4.21.m1.1.2.3.2" xref="S3.SS3.p4.21.m1.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p4.21.m1.1.2.3.2.1" xref="S3.SS3.p4.21.m1.1.2.3.1.1.cmml">[</mo><mi id="S3.SS3.p4.21.m1.1.1" xref="S3.SS3.p4.21.m1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS3.p4.21.m1.1.2.3.2.2" xref="S3.SS3.p4.21.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.21.m1.1b"><apply id="S3.SS3.p4.21.m1.1.2.cmml" xref="S3.SS3.p4.21.m1.1.2"><times id="S3.SS3.p4.21.m1.1.2.1.cmml" xref="S3.SS3.p4.21.m1.1.2.1"></times><ci id="S3.SS3.p4.21.m1.1.2.2.cmml" xref="S3.SS3.p4.21.m1.1.2.2">𝐠</ci><apply id="S3.SS3.p4.21.m1.1.2.3.1.cmml" xref="S3.SS3.p4.21.m1.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.p4.21.m1.1.2.3.1.1.cmml" xref="S3.SS3.p4.21.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p4.21.m1.1.1.cmml" xref="S3.SS3.p4.21.m1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.21.m1.1c">\mathbf{g}[j]</annotation></semantics></math> denotes the <math id="S3.SS3.p4.22.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p4.22.m2.1a"><mi id="S3.SS3.p4.22.m2.1.1" xref="S3.SS3.p4.22.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.22.m2.1b"><ci id="S3.SS3.p4.22.m2.1.1.cmml" xref="S3.SS3.p4.22.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.22.m2.1c">j</annotation></semantics></math>th row of the gradient. After optimizing the federated features <math id="S3.SS3.p4.23.m3.1" class="ltx_Math" alttext="\mathcal{S}^{t}" display="inline"><semantics id="S3.SS3.p4.23.m3.1a"><msup id="S3.SS3.p4.23.m3.1.1" xref="S3.SS3.p4.23.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.23.m3.1.1.2" xref="S3.SS3.p4.23.m3.1.1.2.cmml">𝒮</mi><mi id="S3.SS3.p4.23.m3.1.1.3" xref="S3.SS3.p4.23.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.23.m3.1b"><apply id="S3.SS3.p4.23.m3.1.1.cmml" xref="S3.SS3.p4.23.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.23.m3.1.1.1.cmml" xref="S3.SS3.p4.23.m3.1.1">superscript</csymbol><ci id="S3.SS3.p4.23.m3.1.1.2.cmml" xref="S3.SS3.p4.23.m3.1.1.2">𝒮</ci><ci id="S3.SS3.p4.23.m3.1.1.3.cmml" xref="S3.SS3.p4.23.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.23.m3.1c">\mathcal{S}^{t}</annotation></semantics></math> on this loss, we obtain an updated <math id="S3.SS3.p4.24.m4.1" class="ltx_Math" alttext="\mathcal{S}^{t+1}" display="inline"><semantics id="S3.SS3.p4.24.m4.1a"><msup id="S3.SS3.p4.24.m4.1.1" xref="S3.SS3.p4.24.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.24.m4.1.1.2" xref="S3.SS3.p4.24.m4.1.1.2.cmml">𝒮</mi><mrow id="S3.SS3.p4.24.m4.1.1.3" xref="S3.SS3.p4.24.m4.1.1.3.cmml"><mi id="S3.SS3.p4.24.m4.1.1.3.2" xref="S3.SS3.p4.24.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p4.24.m4.1.1.3.1" xref="S3.SS3.p4.24.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p4.24.m4.1.1.3.3" xref="S3.SS3.p4.24.m4.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.24.m4.1b"><apply id="S3.SS3.p4.24.m4.1.1.cmml" xref="S3.SS3.p4.24.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.24.m4.1.1.1.cmml" xref="S3.SS3.p4.24.m4.1.1">superscript</csymbol><ci id="S3.SS3.p4.24.m4.1.1.2.cmml" xref="S3.SS3.p4.24.m4.1.1.2">𝒮</ci><apply id="S3.SS3.p4.24.m4.1.1.3.cmml" xref="S3.SS3.p4.24.m4.1.1.3"><plus id="S3.SS3.p4.24.m4.1.1.3.1.cmml" xref="S3.SS3.p4.24.m4.1.1.3.1"></plus><ci id="S3.SS3.p4.24.m4.1.1.3.2.cmml" xref="S3.SS3.p4.24.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p4.24.m4.1.1.3.3.cmml" xref="S3.SS3.p4.24.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.24.m4.1c">\mathcal{S}^{t+1}</annotation></semantics></math> for classifier re-training.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Compared with sampling virtual features from the approximated Gaussian mixture for classifier re-training <cite class="ltx_cite ltx_citemacro_cite">Luo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, CReFF learns federated features by optimizing the gradient matching loss.
The advantages are twofold. On the one hand, CReFF can produce nearly the same gradients as the real features to update the classifier, which can not be achieved by CCVR. On the other hand, CCVR requires each client to upload its local class distribution to the server for computing global mean and covariance. In contrast, CReFF does not require the information of local class distribution in a more privacy-preserving manner.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.5" class="ltx_p">The last step of CReFF is to re-train the classifier of the updated global model <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><msup id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">𝐰</mi><mrow id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml"><mi id="S3.SS3.p6.1.m1.1.1.3.2" xref="S3.SS3.p6.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.1.m1.1.1.3.1" xref="S3.SS3.p6.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.1.m1.1.1.3.3" xref="S3.SS3.p6.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝐰</ci><apply id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3"><plus id="S3.SS3.p6.1.m1.1.1.3.1.cmml" xref="S3.SS3.p6.1.m1.1.1.3.1"></plus><ci id="S3.SS3.p6.1.m1.1.1.3.2.cmml" xref="S3.SS3.p6.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.1.m1.1.1.3.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\mathbf{w}^{t+1}</annotation></semantics></math> to obtain the re-trained model <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t+1}" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><msup id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p6.2.m2.1.1.2" xref="S3.SS3.p6.2.m2.1.1.2.cmml"><mi id="S3.SS3.p6.2.m2.1.1.2.2" xref="S3.SS3.p6.2.m2.1.1.2.2.cmml">𝐰</mi><mo id="S3.SS3.p6.2.m2.1.1.2.1" xref="S3.SS3.p6.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p6.2.m2.1.1.3" xref="S3.SS3.p6.2.m2.1.1.3.cmml"><mi id="S3.SS3.p6.2.m2.1.1.3.2" xref="S3.SS3.p6.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.2.m2.1.1.3.1" xref="S3.SS3.p6.2.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.2.m2.1.1.3.3" xref="S3.SS3.p6.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p6.2.m2.1.1.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2"><ci id="S3.SS3.p6.2.m2.1.1.2.1.cmml" xref="S3.SS3.p6.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.p6.2.m2.1.1.2.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2.2">𝐰</ci></apply><apply id="S3.SS3.p6.2.m2.1.1.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3"><plus id="S3.SS3.p6.2.m2.1.1.3.1.cmml" xref="S3.SS3.p6.2.m2.1.1.3.1"></plus><ci id="S3.SS3.p6.2.m2.1.1.3.2.cmml" xref="S3.SS3.p6.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.2.m2.1.1.3.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">\widehat{\mathbf{w}}^{t+1}</annotation></semantics></math>. Initialized as <math id="S3.SS3.p6.3.m3.1" class="ltx_Math" alttext="\widetilde{\mathbf{v}}" display="inline"><semantics id="S3.SS3.p6.3.m3.1a"><mover accent="true" id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml"><mi id="S3.SS3.p6.3.m3.1.1.2" xref="S3.SS3.p6.3.m3.1.1.2.cmml">𝐯</mi><mo id="S3.SS3.p6.3.m3.1.1.1" xref="S3.SS3.p6.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><apply id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1"><ci id="S3.SS3.p6.3.m3.1.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1.1">~</ci><ci id="S3.SS3.p6.3.m3.1.1.2.cmml" xref="S3.SS3.p6.3.m3.1.1.2">𝐯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">\widetilde{\mathbf{v}}</annotation></semantics></math>, a new classifier <math id="S3.SS3.p6.4.m4.1" class="ltx_Math" alttext="\widehat{\mathbf{v}}^{t+1}" display="inline"><semantics id="S3.SS3.p6.4.m4.1a"><msup id="S3.SS3.p6.4.m4.1.1" xref="S3.SS3.p6.4.m4.1.1.cmml"><mover accent="true" id="S3.SS3.p6.4.m4.1.1.2" xref="S3.SS3.p6.4.m4.1.1.2.cmml"><mi id="S3.SS3.p6.4.m4.1.1.2.2" xref="S3.SS3.p6.4.m4.1.1.2.2.cmml">𝐯</mi><mo id="S3.SS3.p6.4.m4.1.1.2.1" xref="S3.SS3.p6.4.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p6.4.m4.1.1.3" xref="S3.SS3.p6.4.m4.1.1.3.cmml"><mi id="S3.SS3.p6.4.m4.1.1.3.2" xref="S3.SS3.p6.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.4.m4.1.1.3.1" xref="S3.SS3.p6.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.4.m4.1.1.3.3" xref="S3.SS3.p6.4.m4.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m4.1b"><apply id="S3.SS3.p6.4.m4.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.4.m4.1.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1">superscript</csymbol><apply id="S3.SS3.p6.4.m4.1.1.2.cmml" xref="S3.SS3.p6.4.m4.1.1.2"><ci id="S3.SS3.p6.4.m4.1.1.2.1.cmml" xref="S3.SS3.p6.4.m4.1.1.2.1">^</ci><ci id="S3.SS3.p6.4.m4.1.1.2.2.cmml" xref="S3.SS3.p6.4.m4.1.1.2.2">𝐯</ci></apply><apply id="S3.SS3.p6.4.m4.1.1.3.cmml" xref="S3.SS3.p6.4.m4.1.1.3"><plus id="S3.SS3.p6.4.m4.1.1.3.1.cmml" xref="S3.SS3.p6.4.m4.1.1.3.1"></plus><ci id="S3.SS3.p6.4.m4.1.1.3.2.cmml" xref="S3.SS3.p6.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.4.m4.1.1.3.3.cmml" xref="S3.SS3.p6.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m4.1c">\widehat{\mathbf{v}}^{t+1}</annotation></semantics></math> is re-trained on the optimized balanced federated features <math id="S3.SS3.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{S}^{t+1}" display="inline"><semantics id="S3.SS3.p6.5.m5.1a"><msup id="S3.SS3.p6.5.m5.1.1" xref="S3.SS3.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.5.m5.1.1.2" xref="S3.SS3.p6.5.m5.1.1.2.cmml">𝒮</mi><mrow id="S3.SS3.p6.5.m5.1.1.3" xref="S3.SS3.p6.5.m5.1.1.3.cmml"><mi id="S3.SS3.p6.5.m5.1.1.3.2" xref="S3.SS3.p6.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.5.m5.1.1.3.1" xref="S3.SS3.p6.5.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.5.m5.1.1.3.3" xref="S3.SS3.p6.5.m5.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m5.1b"><apply id="S3.SS3.p6.5.m5.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.5.m5.1.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.p6.5.m5.1.1.2.cmml" xref="S3.SS3.p6.5.m5.1.1.2">𝒮</ci><apply id="S3.SS3.p6.5.m5.1.1.3.cmml" xref="S3.SS3.p6.5.m5.1.1.3"><plus id="S3.SS3.p6.5.m5.1.1.3.1.cmml" xref="S3.SS3.p6.5.m5.1.1.3.1"></plus><ci id="S3.SS3.p6.5.m5.1.1.3.2.cmml" xref="S3.SS3.p6.5.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.5.m5.1.1.3.3.cmml" xref="S3.SS3.p6.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m5.1c">\mathcal{S}^{t+1}</annotation></semantics></math>:</p>
<table id="S6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\displaystyle\widehat{\mathbf{v}}^{t+1}\leftarrow\widetilde{\mathbf{v}}-\eta\nabla_{\widetilde{\mathbf{v}}}\ell(\widetilde{\mathbf{v}};(\mathbf{s}_{i}^{t},y_{i}))." display="inline"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><msup id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.2.2.1.1.3.2" xref="S3.E7.m1.2.2.1.1.3.2.cmml"><mi id="S3.E7.m1.2.2.1.1.3.2.2" xref="S3.E7.m1.2.2.1.1.3.2.2.cmml">𝐯</mi><mo id="S3.E7.m1.2.2.1.1.3.2.1" xref="S3.E7.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E7.m1.2.2.1.1.3.3" xref="S3.E7.m1.2.2.1.1.3.3.cmml"><mi id="S3.E7.m1.2.2.1.1.3.3.2" xref="S3.E7.m1.2.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E7.m1.2.2.1.1.3.3.1" xref="S3.E7.m1.2.2.1.1.3.3.1.cmml">+</mo><mn id="S3.E7.m1.2.2.1.1.3.3.3" xref="S3.E7.m1.2.2.1.1.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.cmml">←</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.cmml"><mover accent="true" id="S3.E7.m1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.3.2.cmml">𝐯</mi><mo id="S3.E7.m1.2.2.1.1.1.3.1" xref="S3.E7.m1.2.2.1.1.1.3.1.cmml">~</mo></mover><mo id="S3.E7.m1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.4" xref="S3.E7.m1.2.2.1.1.1.1.4.cmml"><msub id="S3.E7.m1.2.2.1.1.1.1.4.1" xref="S3.E7.m1.2.2.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.2.2.1.1.1.1.4.1.2" xref="S3.E7.m1.2.2.1.1.1.1.4.1.2.cmml">∇</mo><mover accent="true" id="S3.E7.m1.2.2.1.1.1.1.4.1.3" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.4.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3.2.cmml">𝐯</mi><mo id="S3.E7.m1.2.2.1.1.1.1.4.1.3.1" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3.1.cmml">~</mo></mover></msub><mi mathvariant="normal" id="S3.E7.m1.2.2.1.1.1.1.4.2" xref="S3.E7.m1.2.2.1.1.1.1.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.2a" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">𝐯</mi><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">~</mo></mover><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.4" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.5" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.4" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1"><ci id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2">←</ci><apply id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.3">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.3.2"><ci id="S3.E7.m1.2.2.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.1.1.3.2.1">^</ci><ci id="S3.E7.m1.2.2.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.3.2.2">𝐯</ci></apply><apply id="S3.E7.m1.2.2.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.3.3"><plus id="S3.E7.m1.2.2.1.1.3.3.1.cmml" xref="S3.E7.m1.2.2.1.1.3.3.1"></plus><ci id="S3.E7.m1.2.2.1.1.3.3.2.cmml" xref="S3.E7.m1.2.2.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.2.2.1.1.3.3.3.cmml" xref="S3.E7.m1.2.2.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E7.m1.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><minus id="S3.E7.m1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.2"></minus><apply id="S3.E7.m1.2.2.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.3"><ci id="S3.E7.m1.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.3.1">~</ci><ci id="S3.E7.m1.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.3.2">𝐯</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><times id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2"></times><ci id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3">𝜂</ci><apply id="S3.E7.m1.2.2.1.1.1.1.4.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4"><apply id="S3.E7.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.4.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.4.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1.2">∇</ci><apply id="S3.E7.m1.2.2.1.1.1.1.4.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3"><ci id="S3.E7.m1.2.2.1.1.1.1.4.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3.1">~</ci><ci id="S3.E7.m1.2.2.1.1.1.1.4.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.1.3.2">𝐯</ci></apply></apply><ci id="S3.E7.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.4.2">ℓ</ci></apply><list id="S3.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><ci id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1">~</ci><ci id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">𝐯</ci></apply><interval closure="open" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2"><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐬</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\displaystyle\widehat{\mathbf{v}}^{t+1}\leftarrow\widetilde{\mathbf{v}}-\eta\nabla_{\widetilde{\mathbf{v}}}\ell(\widetilde{\mathbf{v}};(\mathbf{s}_{i}^{t},y_{i})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p6.8" class="ltx_p">Finally, the updated global model <math id="S3.SS3.p6.6.m1.2" class="ltx_Math" alttext="\mathbf{w}^{t+1}=\{\mathbf{u}^{t+1},\mathbf{v}^{t+1}\}" display="inline"><semantics id="S3.SS3.p6.6.m1.2a"><mrow id="S3.SS3.p6.6.m1.2.2" xref="S3.SS3.p6.6.m1.2.2.cmml"><msup id="S3.SS3.p6.6.m1.2.2.4" xref="S3.SS3.p6.6.m1.2.2.4.cmml"><mi id="S3.SS3.p6.6.m1.2.2.4.2" xref="S3.SS3.p6.6.m1.2.2.4.2.cmml">𝐰</mi><mrow id="S3.SS3.p6.6.m1.2.2.4.3" xref="S3.SS3.p6.6.m1.2.2.4.3.cmml"><mi id="S3.SS3.p6.6.m1.2.2.4.3.2" xref="S3.SS3.p6.6.m1.2.2.4.3.2.cmml">t</mi><mo id="S3.SS3.p6.6.m1.2.2.4.3.1" xref="S3.SS3.p6.6.m1.2.2.4.3.1.cmml">+</mo><mn id="S3.SS3.p6.6.m1.2.2.4.3.3" xref="S3.SS3.p6.6.m1.2.2.4.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.p6.6.m1.2.2.3" xref="S3.SS3.p6.6.m1.2.2.3.cmml">=</mo><mrow id="S3.SS3.p6.6.m1.2.2.2.2" xref="S3.SS3.p6.6.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p6.6.m1.2.2.2.2.3" xref="S3.SS3.p6.6.m1.2.2.2.3.cmml">{</mo><msup id="S3.SS3.p6.6.m1.1.1.1.1.1" xref="S3.SS3.p6.6.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p6.6.m1.1.1.1.1.1.2" xref="S3.SS3.p6.6.m1.1.1.1.1.1.2.cmml">𝐮</mi><mrow id="S3.SS3.p6.6.m1.1.1.1.1.1.3" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p6.6.m1.1.1.1.1.1.3.2" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.6.m1.1.1.1.1.1.3.1" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.6.m1.1.1.1.1.1.3.3" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.p6.6.m1.2.2.2.2.4" xref="S3.SS3.p6.6.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS3.p6.6.m1.2.2.2.2.2" xref="S3.SS3.p6.6.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.p6.6.m1.2.2.2.2.2.2" xref="S3.SS3.p6.6.m1.2.2.2.2.2.2.cmml">𝐯</mi><mrow id="S3.SS3.p6.6.m1.2.2.2.2.2.3" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p6.6.m1.2.2.2.2.2.3.2" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.p6.6.m1.2.2.2.2.2.3.1" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p6.6.m1.2.2.2.2.2.3.3" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.SS3.p6.6.m1.2.2.2.2.5" xref="S3.SS3.p6.6.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.6.m1.2b"><apply id="S3.SS3.p6.6.m1.2.2.cmml" xref="S3.SS3.p6.6.m1.2.2"><eq id="S3.SS3.p6.6.m1.2.2.3.cmml" xref="S3.SS3.p6.6.m1.2.2.3"></eq><apply id="S3.SS3.p6.6.m1.2.2.4.cmml" xref="S3.SS3.p6.6.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p6.6.m1.2.2.4.1.cmml" xref="S3.SS3.p6.6.m1.2.2.4">superscript</csymbol><ci id="S3.SS3.p6.6.m1.2.2.4.2.cmml" xref="S3.SS3.p6.6.m1.2.2.4.2">𝐰</ci><apply id="S3.SS3.p6.6.m1.2.2.4.3.cmml" xref="S3.SS3.p6.6.m1.2.2.4.3"><plus id="S3.SS3.p6.6.m1.2.2.4.3.1.cmml" xref="S3.SS3.p6.6.m1.2.2.4.3.1"></plus><ci id="S3.SS3.p6.6.m1.2.2.4.3.2.cmml" xref="S3.SS3.p6.6.m1.2.2.4.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.6.m1.2.2.4.3.3.cmml" xref="S3.SS3.p6.6.m1.2.2.4.3.3">1</cn></apply></apply><set id="S3.SS3.p6.6.m1.2.2.2.3.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2"><apply id="S3.SS3.p6.6.m1.1.1.1.1.1.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.6.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p6.6.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1.2">𝐮</ci><apply id="S3.SS3.p6.6.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3"><plus id="S3.SS3.p6.6.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.1"></plus><ci id="S3.SS3.p6.6.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.6.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p6.6.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p6.6.m1.2.2.2.2.2.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p6.6.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p6.6.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2.2">𝐯</ci><apply id="S3.SS3.p6.6.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3"><plus id="S3.SS3.p6.6.m1.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.1"></plus><ci id="S3.SS3.p6.6.m1.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.6.m1.2.2.2.2.2.3.3.cmml" xref="S3.SS3.p6.6.m1.2.2.2.2.2.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.6.m1.2c">\mathbf{w}^{t+1}=\{\mathbf{u}^{t+1},\mathbf{v}^{t+1}\}</annotation></semantics></math> and the re-trained model <math id="S3.SS3.p6.7.m2.2" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t+1}=\{\mathbf{u}^{t+1},\widehat{\mathbf{v}}^{t+1}\}" display="inline"><semantics id="S3.SS3.p6.7.m2.2a"><mrow id="S3.SS3.p6.7.m2.2.2" xref="S3.SS3.p6.7.m2.2.2.cmml"><msup id="S3.SS3.p6.7.m2.2.2.4" xref="S3.SS3.p6.7.m2.2.2.4.cmml"><mover accent="true" id="S3.SS3.p6.7.m2.2.2.4.2" xref="S3.SS3.p6.7.m2.2.2.4.2.cmml"><mi id="S3.SS3.p6.7.m2.2.2.4.2.2" xref="S3.SS3.p6.7.m2.2.2.4.2.2.cmml">𝐰</mi><mo id="S3.SS3.p6.7.m2.2.2.4.2.1" xref="S3.SS3.p6.7.m2.2.2.4.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p6.7.m2.2.2.4.3" xref="S3.SS3.p6.7.m2.2.2.4.3.cmml"><mi id="S3.SS3.p6.7.m2.2.2.4.3.2" xref="S3.SS3.p6.7.m2.2.2.4.3.2.cmml">t</mi><mo id="S3.SS3.p6.7.m2.2.2.4.3.1" xref="S3.SS3.p6.7.m2.2.2.4.3.1.cmml">+</mo><mn id="S3.SS3.p6.7.m2.2.2.4.3.3" xref="S3.SS3.p6.7.m2.2.2.4.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.p6.7.m2.2.2.3" xref="S3.SS3.p6.7.m2.2.2.3.cmml">=</mo><mrow id="S3.SS3.p6.7.m2.2.2.2.2" xref="S3.SS3.p6.7.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p6.7.m2.2.2.2.2.3" xref="S3.SS3.p6.7.m2.2.2.2.3.cmml">{</mo><msup id="S3.SS3.p6.7.m2.1.1.1.1.1" xref="S3.SS3.p6.7.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p6.7.m2.1.1.1.1.1.2" xref="S3.SS3.p6.7.m2.1.1.1.1.1.2.cmml">𝐮</mi><mrow id="S3.SS3.p6.7.m2.1.1.1.1.1.3" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p6.7.m2.1.1.1.1.1.3.2" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p6.7.m2.1.1.1.1.1.3.1" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p6.7.m2.1.1.1.1.1.3.3" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.p6.7.m2.2.2.2.2.4" xref="S3.SS3.p6.7.m2.2.2.2.3.cmml">,</mo><msup id="S3.SS3.p6.7.m2.2.2.2.2.2" xref="S3.SS3.p6.7.m2.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.p6.7.m2.2.2.2.2.2.2" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p6.7.m2.2.2.2.2.2.2.2" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2.2.cmml">𝐯</mi><mo id="S3.SS3.p6.7.m2.2.2.2.2.2.2.1" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p6.7.m2.2.2.2.2.2.3" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p6.7.m2.2.2.2.2.2.3.2" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.p6.7.m2.2.2.2.2.2.3.1" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p6.7.m2.2.2.2.2.2.3.3" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.SS3.p6.7.m2.2.2.2.2.5" xref="S3.SS3.p6.7.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.7.m2.2b"><apply id="S3.SS3.p6.7.m2.2.2.cmml" xref="S3.SS3.p6.7.m2.2.2"><eq id="S3.SS3.p6.7.m2.2.2.3.cmml" xref="S3.SS3.p6.7.m2.2.2.3"></eq><apply id="S3.SS3.p6.7.m2.2.2.4.cmml" xref="S3.SS3.p6.7.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m2.2.2.4.1.cmml" xref="S3.SS3.p6.7.m2.2.2.4">superscript</csymbol><apply id="S3.SS3.p6.7.m2.2.2.4.2.cmml" xref="S3.SS3.p6.7.m2.2.2.4.2"><ci id="S3.SS3.p6.7.m2.2.2.4.2.1.cmml" xref="S3.SS3.p6.7.m2.2.2.4.2.1">^</ci><ci id="S3.SS3.p6.7.m2.2.2.4.2.2.cmml" xref="S3.SS3.p6.7.m2.2.2.4.2.2">𝐰</ci></apply><apply id="S3.SS3.p6.7.m2.2.2.4.3.cmml" xref="S3.SS3.p6.7.m2.2.2.4.3"><plus id="S3.SS3.p6.7.m2.2.2.4.3.1.cmml" xref="S3.SS3.p6.7.m2.2.2.4.3.1"></plus><ci id="S3.SS3.p6.7.m2.2.2.4.3.2.cmml" xref="S3.SS3.p6.7.m2.2.2.4.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.7.m2.2.2.4.3.3.cmml" xref="S3.SS3.p6.7.m2.2.2.4.3.3">1</cn></apply></apply><set id="S3.SS3.p6.7.m2.2.2.2.3.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2"><apply id="S3.SS3.p6.7.m2.1.1.1.1.1.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p6.7.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1.2">𝐮</ci><apply id="S3.SS3.p6.7.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3"><plus id="S3.SS3.p6.7.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.1"></plus><ci id="S3.SS3.p6.7.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.7.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p6.7.m2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p6.7.m2.2.2.2.2.2.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p6.7.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2"><ci id="S3.SS3.p6.7.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2.1">^</ci><ci id="S3.SS3.p6.7.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.2.2">𝐯</ci></apply><apply id="S3.SS3.p6.7.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3"><plus id="S3.SS3.p6.7.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.1"></plus><ci id="S3.SS3.p6.7.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.7.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.p6.7.m2.2.2.2.2.2.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.7.m2.2c">\widehat{\mathbf{w}}^{t+1}=\{\mathbf{u}^{t+1},\widehat{\mathbf{v}}^{t+1}\}</annotation></semantics></math> are sent to clients for round <math id="S3.SS3.p6.8.m3.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS3.p6.8.m3.1a"><mrow id="S3.SS3.p6.8.m3.1.1" xref="S3.SS3.p6.8.m3.1.1.cmml"><mi id="S3.SS3.p6.8.m3.1.1.2" xref="S3.SS3.p6.8.m3.1.1.2.cmml">t</mi><mo id="S3.SS3.p6.8.m3.1.1.1" xref="S3.SS3.p6.8.m3.1.1.1.cmml">+</mo><mn id="S3.SS3.p6.8.m3.1.1.3" xref="S3.SS3.p6.8.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.8.m3.1b"><apply id="S3.SS3.p6.8.m3.1.1.cmml" xref="S3.SS3.p6.8.m3.1.1"><plus id="S3.SS3.p6.8.m3.1.1.1.cmml" xref="S3.SS3.p6.8.m3.1.1.1"></plus><ci id="S3.SS3.p6.8.m3.1.1.2.cmml" xref="S3.SS3.p6.8.m3.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p6.8.m3.1.1.3.cmml" xref="S3.SS3.p6.8.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.8.m3.1c">t+1</annotation></semantics></math>. The whole training process of CReFF is shown in Algorithm 1.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.26" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.5.5" class="ltx_listingline">

<span id="algorithm1.5.5.1" class="ltx_text"><span id="algorithm1.5.5.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Initialized global model <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}^{0}" display="inline"><semantics id="algorithm1.1.1.m1.1a"><msup id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">𝐰</mi><mn id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">superscript</csymbol><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝐰</ci><cn type="integer" id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\mathbf{w}^{0}</annotation></semantics></math>, number of steps <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">I</annotation></semantics></math> for federated features optimization, number of steps <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">J</annotation></semantics></math> for classifier re-training, number of federated features per class <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">m</annotation></semantics></math>, number of training rounds <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">T</annotation></semantics></math>
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.1" class="ltx_text"><span id="algorithm1.7.7.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Re-trained model <math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{T}" display="inline"><semantics id="algorithm1.6.6.m1.1a"><msup id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><mover accent="true" id="algorithm1.6.6.m1.1.1.2" xref="algorithm1.6.6.m1.1.1.2.cmml"><mi id="algorithm1.6.6.m1.1.1.2.2" xref="algorithm1.6.6.m1.1.1.2.2.cmml">𝐰</mi><mo id="algorithm1.6.6.m1.1.1.2.1" xref="algorithm1.6.6.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm1.6.6.m1.1.1.3" xref="algorithm1.6.6.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">superscript</csymbol><apply id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2"><ci id="algorithm1.6.6.m1.1.1.2.1.cmml" xref="algorithm1.6.6.m1.1.1.2.1">^</ci><ci id="algorithm1.6.6.m1.1.1.2.2.cmml" xref="algorithm1.6.6.m1.1.1.2.2">𝐰</ci></apply><ci id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\widehat{\mathbf{w}}^{T}</annotation></semantics></math> on round <math id="algorithm1.7.7.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.7.7.m2.1a"><mi id="algorithm1.7.7.m2.1.1" xref="algorithm1.7.7.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m2.1b"><ci id="algorithm1.7.7.m2.1.1.cmml" xref="algorithm1.7.7.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m2.1c">T</annotation></semantics></math> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="algorithm1.9.9.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.9.9.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.8.8.1.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mrow id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml"><mi id="algorithm1.8.8.1.m1.1.1.2" xref="algorithm1.8.8.1.m1.1.1.2.cmml">t</mi><mo id="algorithm1.8.8.1.m1.1.1.1" xref="algorithm1.8.8.1.m1.1.1.1.cmml">=</mo><mn id="algorithm1.8.8.1.m1.1.1.3" xref="algorithm1.8.8.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><apply id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1"><eq id="algorithm1.8.8.1.m1.1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1.1"></eq><ci id="algorithm1.8.8.1.m1.1.1.2.cmml" xref="algorithm1.8.8.1.m1.1.1.2">𝑡</ci><cn type="integer" id="algorithm1.8.8.1.m1.1.1.3.cmml" xref="algorithm1.8.8.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">t=1</annotation></semantics></math> <span id="algorithm1.9.9.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.9.9.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.9.9.2.m2.1a"><mi id="algorithm1.9.9.2.m2.1.1" xref="algorithm1.9.9.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.2.m2.1b"><ci id="algorithm1.9.9.2.m2.1.1.cmml" xref="algorithm1.9.9.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.2.m2.1c">T</annotation></semantics></math></em> <span id="algorithm1.9.9.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Randomly select a set of active clients <math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\mathcal{A}^{t}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><msup id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">𝒜</mi><mi id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝒜</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\mathcal{A}^{t}</annotation></semantics></math>;
</div>
<div id="algorithm1.26.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.26.27.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.26.27.2" class="ltx_text ltx_font_typewriter">Clients execute: </span>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.11.11.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.11.11.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.11.11.1.m1.1" class="ltx_Math" alttext="k\in\mathcal{A}^{t}" display="inline"><semantics id="algorithm1.11.11.1.m1.1a"><mrow id="algorithm1.11.11.1.m1.1.1" xref="algorithm1.11.11.1.m1.1.1.cmml"><mi id="algorithm1.11.11.1.m1.1.1.2" xref="algorithm1.11.11.1.m1.1.1.2.cmml">k</mi><mo id="algorithm1.11.11.1.m1.1.1.1" xref="algorithm1.11.11.1.m1.1.1.1.cmml">∈</mo><msup id="algorithm1.11.11.1.m1.1.1.3" xref="algorithm1.11.11.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.11.11.1.m1.1.1.3.2" xref="algorithm1.11.11.1.m1.1.1.3.2.cmml">𝒜</mi><mi id="algorithm1.11.11.1.m1.1.1.3.3" xref="algorithm1.11.11.1.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.1.m1.1b"><apply id="algorithm1.11.11.1.m1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1"><in id="algorithm1.11.11.1.m1.1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1.1"></in><ci id="algorithm1.11.11.1.m1.1.1.2.cmml" xref="algorithm1.11.11.1.m1.1.1.2">𝑘</ci><apply id="algorithm1.11.11.1.m1.1.1.3.cmml" xref="algorithm1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.1.m1.1.1.3.1.cmml" xref="algorithm1.11.11.1.m1.1.1.3">superscript</csymbol><ci id="algorithm1.11.11.1.m1.1.1.3.2.cmml" xref="algorithm1.11.11.1.m1.1.1.3.2">𝒜</ci><ci id="algorithm1.11.11.1.m1.1.1.3.3.cmml" xref="algorithm1.11.11.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.1.m1.1c">k\in\mathcal{A}^{t}</annotation></semantics></math></em> <span id="algorithm1.11.11.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    Update local model <math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="\mathbf{w}_{k}^{t+1}" display="inline"><semantics id="algorithm1.12.12.m1.1a"><msubsup id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.2.2" xref="algorithm1.12.12.m1.1.1.2.2.cmml">𝐰</mi><mi id="algorithm1.12.12.m1.1.1.2.3" xref="algorithm1.12.12.m1.1.1.2.3.cmml">k</mi><mrow id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml"><mi id="algorithm1.12.12.m1.1.1.3.2" xref="algorithm1.12.12.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.12.12.m1.1.1.3.1" xref="algorithm1.12.12.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.12.12.m1.1.1.3.3" xref="algorithm1.12.12.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">superscript</csymbol><apply id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.2.1.cmml" xref="algorithm1.12.12.m1.1.1">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2">𝐰</ci><ci id="algorithm1.12.12.m1.1.1.2.3.cmml" xref="algorithm1.12.12.m1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3"><plus id="algorithm1.12.12.m1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.1.1.3.1"></plus><ci id="algorithm1.12.12.m1.1.1.3.2.cmml" xref="algorithm1.12.12.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.12.12.m1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\mathbf{w}_{k}^{t+1}</annotation></semantics></math> by Equation (<a href="#S3.E1" title="In 3.1 Preliminaries ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>);
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Compute real feature gradients <math id="algorithm1.13.13.m1.2" class="ltx_Math" alttext="\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}" display="inline"><semantics id="algorithm1.13.13.m1.2a"><mrow id="algorithm1.13.13.m1.2.2.2" xref="algorithm1.13.13.m1.2.2.3.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.2.2.2.3" xref="algorithm1.13.13.m1.2.2.3.1.cmml">{</mo><msubsup id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.2.2" xref="algorithm1.13.13.m1.1.1.1.1.2.2.cmml">𝐠</mi><mi id="algorithm1.13.13.m1.1.1.1.1.2.3" xref="algorithm1.13.13.m1.1.1.1.1.2.3.cmml">c</mi><mi id="algorithm1.13.13.m1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.2.2.2.4" xref="algorithm1.13.13.m1.2.2.3.1.cmml">|</mo><mrow id="algorithm1.13.13.m1.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.cmml"><mi id="algorithm1.13.13.m1.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.cmml">c</mi><mo id="algorithm1.13.13.m1.2.2.2.2.1" xref="algorithm1.13.13.m1.2.2.2.2.1.cmml">∈</mo><msup id="algorithm1.13.13.m1.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.13.13.m1.2.2.2.2.3.2" xref="algorithm1.13.13.m1.2.2.2.2.3.2.cmml">𝒞</mi><mi id="algorithm1.13.13.m1.2.2.2.2.3.3" xref="algorithm1.13.13.m1.2.2.2.2.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="algorithm1.13.13.m1.2.2.2.5" xref="algorithm1.13.13.m1.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.2b"><apply id="algorithm1.13.13.m1.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2"><csymbol cd="latexml" id="algorithm1.13.13.m1.2.2.3.1.cmml" xref="algorithm1.13.13.m1.2.2.2.3">conditional-set</csymbol><apply id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1">superscript</csymbol><apply id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2.2">𝐠</ci><ci id="algorithm1.13.13.m1.1.1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2.3">𝑐</ci></apply><ci id="algorithm1.13.13.m1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3">𝑘</ci></apply><apply id="algorithm1.13.13.m1.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2"><in id="algorithm1.13.13.m1.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1"></in><ci id="algorithm1.13.13.m1.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2">𝑐</ci><apply id="algorithm1.13.13.m1.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.2.2.3.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3">superscript</csymbol><ci id="algorithm1.13.13.m1.2.2.2.2.3.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3.2">𝒞</ci><ci id="algorithm1.13.13.m1.2.2.2.2.3.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.2c">\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}</annotation></semantics></math> by Equation (<a href="#S3.E3" title="In 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>);
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Send <math id="algorithm1.14.14.m1.1" class="ltx_Math" alttext="\mathbf{w}_{k}^{t+1}" display="inline"><semantics id="algorithm1.14.14.m1.1a"><msubsup id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><mi id="algorithm1.14.14.m1.1.1.2.2" xref="algorithm1.14.14.m1.1.1.2.2.cmml">𝐰</mi><mi id="algorithm1.14.14.m1.1.1.2.3" xref="algorithm1.14.14.m1.1.1.2.3.cmml">k</mi><mrow id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml"><mi id="algorithm1.14.14.m1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.14.14.m1.1.1.3.1" xref="algorithm1.14.14.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.14.14.m1.1.1.3.3" xref="algorithm1.14.14.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1">superscript</csymbol><apply id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.1.1">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.1.1.2.2">𝐰</ci><ci id="algorithm1.14.14.m1.1.1.2.3.cmml" xref="algorithm1.14.14.m1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3"><plus id="algorithm1.14.14.m1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3.1"></plus><ci id="algorithm1.14.14.m1.1.1.3.2.cmml" xref="algorithm1.14.14.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.14.14.m1.1.1.3.3.cmml" xref="algorithm1.14.14.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\mathbf{w}_{k}^{t+1}</annotation></semantics></math> and <math id="algorithm1.15.15.m2.2" class="ltx_Math" alttext="\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}" display="inline"><semantics id="algorithm1.15.15.m2.2a"><mrow id="algorithm1.15.15.m2.2.2.2" xref="algorithm1.15.15.m2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.15.15.m2.2.2.2.3" xref="algorithm1.15.15.m2.2.2.3.1.cmml">{</mo><msubsup id="algorithm1.15.15.m2.1.1.1.1" xref="algorithm1.15.15.m2.1.1.1.1.cmml"><mi id="algorithm1.15.15.m2.1.1.1.1.2.2" xref="algorithm1.15.15.m2.1.1.1.1.2.2.cmml">𝐠</mi><mi id="algorithm1.15.15.m2.1.1.1.1.2.3" xref="algorithm1.15.15.m2.1.1.1.1.2.3.cmml">c</mi><mi id="algorithm1.15.15.m2.1.1.1.1.3" xref="algorithm1.15.15.m2.1.1.1.1.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.15.15.m2.2.2.2.4" xref="algorithm1.15.15.m2.2.2.3.1.cmml">|</mo><mrow id="algorithm1.15.15.m2.2.2.2.2" xref="algorithm1.15.15.m2.2.2.2.2.cmml"><mi id="algorithm1.15.15.m2.2.2.2.2.2" xref="algorithm1.15.15.m2.2.2.2.2.2.cmml">c</mi><mo id="algorithm1.15.15.m2.2.2.2.2.1" xref="algorithm1.15.15.m2.2.2.2.2.1.cmml">∈</mo><msup id="algorithm1.15.15.m2.2.2.2.2.3" xref="algorithm1.15.15.m2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.15.15.m2.2.2.2.2.3.2" xref="algorithm1.15.15.m2.2.2.2.2.3.2.cmml">𝒞</mi><mi id="algorithm1.15.15.m2.2.2.2.2.3.3" xref="algorithm1.15.15.m2.2.2.2.2.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="algorithm1.15.15.m2.2.2.2.5" xref="algorithm1.15.15.m2.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m2.2b"><apply id="algorithm1.15.15.m2.2.2.3.cmml" xref="algorithm1.15.15.m2.2.2.2"><csymbol cd="latexml" id="algorithm1.15.15.m2.2.2.3.1.cmml" xref="algorithm1.15.15.m2.2.2.2.3">conditional-set</csymbol><apply id="algorithm1.15.15.m2.1.1.1.1.cmml" xref="algorithm1.15.15.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m2.1.1.1.1.1.cmml" xref="algorithm1.15.15.m2.1.1.1.1">superscript</csymbol><apply id="algorithm1.15.15.m2.1.1.1.1.2.cmml" xref="algorithm1.15.15.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m2.1.1.1.1.2.1.cmml" xref="algorithm1.15.15.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.15.15.m2.1.1.1.1.2.2.cmml" xref="algorithm1.15.15.m2.1.1.1.1.2.2">𝐠</ci><ci id="algorithm1.15.15.m2.1.1.1.1.2.3.cmml" xref="algorithm1.15.15.m2.1.1.1.1.2.3">𝑐</ci></apply><ci id="algorithm1.15.15.m2.1.1.1.1.3.cmml" xref="algorithm1.15.15.m2.1.1.1.1.3">𝑘</ci></apply><apply id="algorithm1.15.15.m2.2.2.2.2.cmml" xref="algorithm1.15.15.m2.2.2.2.2"><in id="algorithm1.15.15.m2.2.2.2.2.1.cmml" xref="algorithm1.15.15.m2.2.2.2.2.1"></in><ci id="algorithm1.15.15.m2.2.2.2.2.2.cmml" xref="algorithm1.15.15.m2.2.2.2.2.2">𝑐</ci><apply id="algorithm1.15.15.m2.2.2.2.2.3.cmml" xref="algorithm1.15.15.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m2.2.2.2.2.3.1.cmml" xref="algorithm1.15.15.m2.2.2.2.2.3">superscript</csymbol><ci id="algorithm1.15.15.m2.2.2.2.2.3.2.cmml" xref="algorithm1.15.15.m2.2.2.2.2.3.2">𝒞</ci><ci id="algorithm1.15.15.m2.2.2.2.2.3.3.cmml" xref="algorithm1.15.15.m2.2.2.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m2.2c">\{\mathbf{g}_{c}^{k}|c\in\mathcal{C}^{k}\}</annotation></semantics></math> to the server;
</div>
<div id="algorithm1.26.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.26.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.26.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.26.30.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.26.30.2" class="ltx_text ltx_font_typewriter">Server executes: </span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Aggregate local models to <math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="algorithm1.16.16.m1.1a"><msup id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><mi id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml">𝐰</mi><mrow id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml"><mi id="algorithm1.16.16.m1.1.1.3.2" xref="algorithm1.16.16.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.16.16.m1.1.1.3.1" xref="algorithm1.16.16.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.16.16.m1.1.1.3.3" xref="algorithm1.16.16.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">superscript</csymbol><ci id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2">𝐰</ci><apply id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3"><plus id="algorithm1.16.16.m1.1.1.3.1.cmml" xref="algorithm1.16.16.m1.1.1.3.1"></plus><ci id="algorithm1.16.16.m1.1.1.3.2.cmml" xref="algorithm1.16.16.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.16.16.m1.1.1.3.3.cmml" xref="algorithm1.16.16.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">\mathbf{w}^{t+1}</annotation></semantics></math> by Equation (<a href="#S3.E2" title="In 3.1 Preliminaries ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>);
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Aggregate real feature gradients to <math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="\mathbf{g}^{agg}_{c}" display="inline"><semantics id="algorithm1.17.17.m1.1a"><msubsup id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><mi id="algorithm1.17.17.m1.1.1.2.2" xref="algorithm1.17.17.m1.1.1.2.2.cmml">𝐠</mi><mi id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml">c</mi><mrow id="algorithm1.17.17.m1.1.1.2.3" xref="algorithm1.17.17.m1.1.1.2.3.cmml"><mi id="algorithm1.17.17.m1.1.1.2.3.2" xref="algorithm1.17.17.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.17.17.m1.1.1.2.3.1" xref="algorithm1.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.17.17.m1.1.1.2.3.3" xref="algorithm1.17.17.m1.1.1.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.17.17.m1.1.1.2.3.1a" xref="algorithm1.17.17.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.17.17.m1.1.1.2.3.4" xref="algorithm1.17.17.m1.1.1.2.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">subscript</csymbol><apply id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.2.1.cmml" xref="algorithm1.17.17.m1.1.1">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.2.2.cmml" xref="algorithm1.17.17.m1.1.1.2.2">𝐠</ci><apply id="algorithm1.17.17.m1.1.1.2.3.cmml" xref="algorithm1.17.17.m1.1.1.2.3"><times id="algorithm1.17.17.m1.1.1.2.3.1.cmml" xref="algorithm1.17.17.m1.1.1.2.3.1"></times><ci id="algorithm1.17.17.m1.1.1.2.3.2.cmml" xref="algorithm1.17.17.m1.1.1.2.3.2">𝑎</ci><ci id="algorithm1.17.17.m1.1.1.2.3.3.cmml" xref="algorithm1.17.17.m1.1.1.2.3.3">𝑔</ci><ci id="algorithm1.17.17.m1.1.1.2.3.4.cmml" xref="algorithm1.17.17.m1.1.1.2.3.4">𝑔</ci></apply></apply><ci id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\mathbf{g}^{agg}_{c}</annotation></semantics></math> by Equation (<a href="#S3.E4" title="In 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>);
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Compute federated feature gradients <math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="\mathbf{g}^{fed}_{c}" display="inline"><semantics id="algorithm1.18.18.m1.1a"><msubsup id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><mi id="algorithm1.18.18.m1.1.1.2.2" xref="algorithm1.18.18.m1.1.1.2.2.cmml">𝐠</mi><mi id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml">c</mi><mrow id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml"><mi id="algorithm1.18.18.m1.1.1.2.3.2" xref="algorithm1.18.18.m1.1.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m1.1.1.2.3.1" xref="algorithm1.18.18.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.18.18.m1.1.1.2.3.3" xref="algorithm1.18.18.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m1.1.1.2.3.1a" xref="algorithm1.18.18.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.18.18.m1.1.1.2.3.4" xref="algorithm1.18.18.m1.1.1.2.3.4.cmml">d</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1">subscript</csymbol><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1">superscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2">𝐠</ci><apply id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3"><times id="algorithm1.18.18.m1.1.1.2.3.1.cmml" xref="algorithm1.18.18.m1.1.1.2.3.1"></times><ci id="algorithm1.18.18.m1.1.1.2.3.2.cmml" xref="algorithm1.18.18.m1.1.1.2.3.2">𝑓</ci><ci id="algorithm1.18.18.m1.1.1.2.3.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3.3">𝑒</ci><ci id="algorithm1.18.18.m1.1.1.2.3.4.cmml" xref="algorithm1.18.18.m1.1.1.2.3.4">𝑑</ci></apply></apply><ci id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">\mathbf{g}^{fed}_{c}</annotation></semantics></math> by Equation (<a href="#S3.E5" title="In 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>);
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Optimize federated features to <math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="\mathcal{S}^{t+1}" display="inline"><semantics id="algorithm1.19.19.m1.1a"><msup id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml">𝒮</mi><mrow id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.2" xref="algorithm1.19.19.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.19.19.m1.1.1.3.1" xref="algorithm1.19.19.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.19.19.m1.1.1.3.3" xref="algorithm1.19.19.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1">superscript</csymbol><ci id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2">𝒮</ci><apply id="algorithm1.19.19.m1.1.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3"><plus id="algorithm1.19.19.m1.1.1.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.1"></plus><ci id="algorithm1.19.19.m1.1.1.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.19.19.m1.1.1.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">\mathcal{S}^{t+1}</annotation></semantics></math> with the loss in Equation (<a href="#S3.E6" title="In 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) for <math id="algorithm1.20.20.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="algorithm1.20.20.m2.1a"><mi id="algorithm1.20.20.m2.1.1" xref="algorithm1.20.20.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m2.1b"><ci id="algorithm1.20.20.m2.1.1.cmml" xref="algorithm1.20.20.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m2.1c">I</annotation></semantics></math> epochs;
</div>
<div id="algorithm1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Re-train the classifier of <math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="algorithm1.21.21.m1.1a"><msup id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml">𝐰</mi><mrow id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml"><mi id="algorithm1.21.21.m1.1.1.3.2" xref="algorithm1.21.21.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.21.21.m1.1.1.3.1" xref="algorithm1.21.21.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.21.21.m1.1.1.3.3" xref="algorithm1.21.21.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">superscript</csymbol><ci id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2">𝐰</ci><apply id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3"><plus id="algorithm1.21.21.m1.1.1.3.1.cmml" xref="algorithm1.21.21.m1.1.1.3.1"></plus><ci id="algorithm1.21.21.m1.1.1.3.2.cmml" xref="algorithm1.21.21.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.1.3.3.cmml" xref="algorithm1.21.21.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">\mathbf{w}^{t+1}</annotation></semantics></math> to <math id="algorithm1.22.22.m2.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t+1}" display="inline"><semantics id="algorithm1.22.22.m2.1a"><msup id="algorithm1.22.22.m2.1.1" xref="algorithm1.22.22.m2.1.1.cmml"><mover accent="true" id="algorithm1.22.22.m2.1.1.2" xref="algorithm1.22.22.m2.1.1.2.cmml"><mi id="algorithm1.22.22.m2.1.1.2.2" xref="algorithm1.22.22.m2.1.1.2.2.cmml">𝐰</mi><mo id="algorithm1.22.22.m2.1.1.2.1" xref="algorithm1.22.22.m2.1.1.2.1.cmml">^</mo></mover><mrow id="algorithm1.22.22.m2.1.1.3" xref="algorithm1.22.22.m2.1.1.3.cmml"><mi id="algorithm1.22.22.m2.1.1.3.2" xref="algorithm1.22.22.m2.1.1.3.2.cmml">t</mi><mo id="algorithm1.22.22.m2.1.1.3.1" xref="algorithm1.22.22.m2.1.1.3.1.cmml">+</mo><mn id="algorithm1.22.22.m2.1.1.3.3" xref="algorithm1.22.22.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m2.1b"><apply id="algorithm1.22.22.m2.1.1.cmml" xref="algorithm1.22.22.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m2.1.1.1.cmml" xref="algorithm1.22.22.m2.1.1">superscript</csymbol><apply id="algorithm1.22.22.m2.1.1.2.cmml" xref="algorithm1.22.22.m2.1.1.2"><ci id="algorithm1.22.22.m2.1.1.2.1.cmml" xref="algorithm1.22.22.m2.1.1.2.1">^</ci><ci id="algorithm1.22.22.m2.1.1.2.2.cmml" xref="algorithm1.22.22.m2.1.1.2.2">𝐰</ci></apply><apply id="algorithm1.22.22.m2.1.1.3.cmml" xref="algorithm1.22.22.m2.1.1.3"><plus id="algorithm1.22.22.m2.1.1.3.1.cmml" xref="algorithm1.22.22.m2.1.1.3.1"></plus><ci id="algorithm1.22.22.m2.1.1.3.2.cmml" xref="algorithm1.22.22.m2.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.22.22.m2.1.1.3.3.cmml" xref="algorithm1.22.22.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m2.1c">\widehat{\mathbf{w}}^{t+1}</annotation></semantics></math> on <math id="algorithm1.23.23.m3.1" class="ltx_Math" alttext="\mathcal{S}^{t+1}" display="inline"><semantics id="algorithm1.23.23.m3.1a"><msup id="algorithm1.23.23.m3.1.1" xref="algorithm1.23.23.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m3.1.1.2" xref="algorithm1.23.23.m3.1.1.2.cmml">𝒮</mi><mrow id="algorithm1.23.23.m3.1.1.3" xref="algorithm1.23.23.m3.1.1.3.cmml"><mi id="algorithm1.23.23.m3.1.1.3.2" xref="algorithm1.23.23.m3.1.1.3.2.cmml">t</mi><mo id="algorithm1.23.23.m3.1.1.3.1" xref="algorithm1.23.23.m3.1.1.3.1.cmml">+</mo><mn id="algorithm1.23.23.m3.1.1.3.3" xref="algorithm1.23.23.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m3.1b"><apply id="algorithm1.23.23.m3.1.1.cmml" xref="algorithm1.23.23.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m3.1.1.1.cmml" xref="algorithm1.23.23.m3.1.1">superscript</csymbol><ci id="algorithm1.23.23.m3.1.1.2.cmml" xref="algorithm1.23.23.m3.1.1.2">𝒮</ci><apply id="algorithm1.23.23.m3.1.1.3.cmml" xref="algorithm1.23.23.m3.1.1.3"><plus id="algorithm1.23.23.m3.1.1.3.1.cmml" xref="algorithm1.23.23.m3.1.1.3.1"></plus><ci id="algorithm1.23.23.m3.1.1.3.2.cmml" xref="algorithm1.23.23.m3.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.23.23.m3.1.1.3.3.cmml" xref="algorithm1.23.23.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m3.1c">\mathcal{S}^{t+1}</annotation></semantics></math> by Equation (<a href="#S3.E7" title="In 3.3 Framework of the proposed CReFF ‣ 3 Proposed Method ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) for <math id="algorithm1.24.24.m4.1" class="ltx_Math" alttext="J" display="inline"><semantics id="algorithm1.24.24.m4.1a"><mi id="algorithm1.24.24.m4.1.1" xref="algorithm1.24.24.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m4.1b"><ci id="algorithm1.24.24.m4.1.1.cmml" xref="algorithm1.24.24.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m4.1c">J</annotation></semantics></math> epochs;
</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Send <math id="algorithm1.25.25.m1.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="algorithm1.25.25.m1.1a"><msup id="algorithm1.25.25.m1.1.1" xref="algorithm1.25.25.m1.1.1.cmml"><mi id="algorithm1.25.25.m1.1.1.2" xref="algorithm1.25.25.m1.1.1.2.cmml">𝐰</mi><mrow id="algorithm1.25.25.m1.1.1.3" xref="algorithm1.25.25.m1.1.1.3.cmml"><mi id="algorithm1.25.25.m1.1.1.3.2" xref="algorithm1.25.25.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.25.25.m1.1.1.3.1" xref="algorithm1.25.25.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.25.25.m1.1.1.3.3" xref="algorithm1.25.25.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m1.1b"><apply id="algorithm1.25.25.m1.1.1.cmml" xref="algorithm1.25.25.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.1.cmml" xref="algorithm1.25.25.m1.1.1">superscript</csymbol><ci id="algorithm1.25.25.m1.1.1.2.cmml" xref="algorithm1.25.25.m1.1.1.2">𝐰</ci><apply id="algorithm1.25.25.m1.1.1.3.cmml" xref="algorithm1.25.25.m1.1.1.3"><plus id="algorithm1.25.25.m1.1.1.3.1.cmml" xref="algorithm1.25.25.m1.1.1.3.1"></plus><ci id="algorithm1.25.25.m1.1.1.3.2.cmml" xref="algorithm1.25.25.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.25.25.m1.1.1.3.3.cmml" xref="algorithm1.25.25.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m1.1c">\mathbf{w}^{t+1}</annotation></semantics></math> and <math id="algorithm1.26.26.m2.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}^{t+1}" display="inline"><semantics id="algorithm1.26.26.m2.1a"><msup id="algorithm1.26.26.m2.1.1" xref="algorithm1.26.26.m2.1.1.cmml"><mover accent="true" id="algorithm1.26.26.m2.1.1.2" xref="algorithm1.26.26.m2.1.1.2.cmml"><mi id="algorithm1.26.26.m2.1.1.2.2" xref="algorithm1.26.26.m2.1.1.2.2.cmml">𝐰</mi><mo id="algorithm1.26.26.m2.1.1.2.1" xref="algorithm1.26.26.m2.1.1.2.1.cmml">^</mo></mover><mrow id="algorithm1.26.26.m2.1.1.3" xref="algorithm1.26.26.m2.1.1.3.cmml"><mi id="algorithm1.26.26.m2.1.1.3.2" xref="algorithm1.26.26.m2.1.1.3.2.cmml">t</mi><mo id="algorithm1.26.26.m2.1.1.3.1" xref="algorithm1.26.26.m2.1.1.3.1.cmml">+</mo><mn id="algorithm1.26.26.m2.1.1.3.3" xref="algorithm1.26.26.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m2.1b"><apply id="algorithm1.26.26.m2.1.1.cmml" xref="algorithm1.26.26.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m2.1.1.1.cmml" xref="algorithm1.26.26.m2.1.1">superscript</csymbol><apply id="algorithm1.26.26.m2.1.1.2.cmml" xref="algorithm1.26.26.m2.1.1.2"><ci id="algorithm1.26.26.m2.1.1.2.1.cmml" xref="algorithm1.26.26.m2.1.1.2.1">^</ci><ci id="algorithm1.26.26.m2.1.1.2.2.cmml" xref="algorithm1.26.26.m2.1.1.2.2">𝐰</ci></apply><apply id="algorithm1.26.26.m2.1.1.3.cmml" xref="algorithm1.26.26.m2.1.1.3"><plus id="algorithm1.26.26.m2.1.1.3.1.cmml" xref="algorithm1.26.26.m2.1.1.3.1"></plus><ci id="algorithm1.26.26.m2.1.1.3.2.cmml" xref="algorithm1.26.26.m2.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.26.26.m2.1.1.3.3.cmml" xref="algorithm1.26.26.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m2.1c">\widehat{\mathbf{w}}^{t+1}</annotation></semantics></math> to clients;
</div>
<div id="algorithm1.26.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.26.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span> end for
</div>
<div id="algorithm1.26.33" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.28.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Training process of CReFF</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first show the ability of CReFF to deal with data heterogeneity and long-tail distribution on several benchmark datasets, compared with the state-of-the-art FL methods. Then, we specifically study the reason of federated features being effective for classifier re-training on the server.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We conduct experiments on the following datasets:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p"><math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mo id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bullet</annotation></semantics></math> CIFAR-10/100-LT <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky and Hinton (<a href="#bib.bib9" title="" class="ltx_ref">2009</a>)</cite>. We follow <cite class="ltx_cite ltx_citemacro_cite">Cao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> to shape the original balanced CIFAR-10/100 into long-tail distribution with <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mtext id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2a.cmml">IF</mtext><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></eq><ci id="S4.SS1.p2.2.m2.1.1.2a.cmml" xref="S4.SS1.p2.2.m2.1.1.2"><mtext id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">IF</mtext></ci><cn type="integer" id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\textrm{IF}=100</annotation></semantics></math>, 50 and 10, respectively. Like previous studies <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, we use Dirichlet distribution to generate the heterogeneous data partition among clients. We set the value of <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\alpha</annotation></semantics></math> at 0.5 on CIFAR-10/100-LT.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p"><math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mo id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\bullet</annotation></semantics></math> ImageNet-LT <cite class="ltx_cite ltx_citemacro_cite">Russakovsky <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite>. It contains 115.8K images from 1,000 categories, with the largest and smallest categories containing 1,280 and 5 images, respectively. We set the value of <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\alpha</annotation></semantics></math> at 0.1 on ImageNet-LT.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.4" class="ltx_p">We use ResNet-8 for CIFAR-10/100-LT, and ResNet-50 for ImageNet-LT as the base model. We implement all compared FL methods with the same model for a fair comparison.
All experiments are run by PyTorch on two NVIDIA GeForce RTX 3080 GPUs. By default, we use standard cross-entropy loss and run 200 communication rounds. We set the number of total clients at 20 and an active client ratio <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="40\%" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">40</mn><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">40\%</annotation></semantics></math> in each round. For local training, the batch size is set at 32. For server-side training, we initialize the federated features as random noise and set the number of them per class at 100, the optimization steps <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">I</annotation></semantics></math> on federated features at 100, the classifier re-training steps <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">J</annotation></semantics></math> at 300. We use SGD with a learning rate <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mn id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><cn type="float" id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">0.1</annotation></semantics></math> as the optimizer for all optimization process.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.7.8.1" class="ltx_tr">
<th id="S4.T1.7.8.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T1.7.8.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S4.T1.7.8.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">CIFAR-10-LT</td>
<td id="S4.T1.7.8.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">CIFAR-100-LT</td>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<th id="S4.T1.6.6.7" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.6.6.7.1" class="ltx_text ltx_font_bold">Family</span></th>
<th id="S4.T1.6.6.8" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.6.6.8.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mtext id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><eq id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1"></eq><ci id="S4.T1.1.1.1.m1.1.1.2a.cmml" xref="S4.T1.1.1.1.m1.1.1.2"><mtext id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\textrm{IF}=100</annotation></semantics></math></td>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.2.2.2.m1.1" class="ltx_Math" alttext="\textrm{IF}=50" display="inline"><semantics id="S4.T1.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.m1.1.1" xref="S4.T1.2.2.2.m1.1.1.cmml"><mtext id="S4.T1.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.2.2.2.m1.1.1.1" xref="S4.T1.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1"><eq id="S4.T1.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1.1"></eq><ci id="S4.T1.2.2.2.m1.1.1.2a.cmml" xref="S4.T1.2.2.2.m1.1.1.2"><mtext id="S4.T1.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">\textrm{IF}=50</annotation></semantics></math></td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.3.3.3.m1.1" class="ltx_Math" alttext="\textrm{IF}=10" display="inline"><semantics id="S4.T1.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.m1.1.1" xref="S4.T1.3.3.3.m1.1.1.cmml"><mtext id="S4.T1.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.3.3.3.m1.1.1.1" xref="S4.T1.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T1.3.3.3.m1.1.1.3" xref="S4.T1.3.3.3.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1"><eq id="S4.T1.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1.1"></eq><ci id="S4.T1.3.3.3.m1.1.1.2a.cmml" xref="S4.T1.3.3.3.m1.1.1.2"><mtext id="S4.T1.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.3.3.3.m1.1.1.3.cmml" xref="S4.T1.3.3.3.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.m1.1c">\textrm{IF}=10</annotation></semantics></math></td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.4.4.4.m1.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.T1.4.4.4.m1.1a"><mrow id="S4.T1.4.4.4.m1.1.1" xref="S4.T1.4.4.4.m1.1.1.cmml"><mtext id="S4.T1.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.4.4.4.m1.1.1.1" xref="S4.T1.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T1.4.4.4.m1.1.1.3" xref="S4.T1.4.4.4.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1"><eq id="S4.T1.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1.1"></eq><ci id="S4.T1.4.4.4.m1.1.1.2a.cmml" xref="S4.T1.4.4.4.m1.1.1.2"><mtext id="S4.T1.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.4.4.4.m1.1.1.3.cmml" xref="S4.T1.4.4.4.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.m1.1c">\textrm{IF}=100</annotation></semantics></math></td>
<td id="S4.T1.5.5.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.5.5.5.m1.1" class="ltx_Math" alttext="\textrm{IF}=50" display="inline"><semantics id="S4.T1.5.5.5.m1.1a"><mrow id="S4.T1.5.5.5.m1.1.1" xref="S4.T1.5.5.5.m1.1.1.cmml"><mtext id="S4.T1.5.5.5.m1.1.1.2" xref="S4.T1.5.5.5.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.5.5.5.m1.1.1.1" xref="S4.T1.5.5.5.m1.1.1.1.cmml">=</mo><mn id="S4.T1.5.5.5.m1.1.1.3" xref="S4.T1.5.5.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.m1.1b"><apply id="S4.T1.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.m1.1.1"><eq id="S4.T1.5.5.5.m1.1.1.1.cmml" xref="S4.T1.5.5.5.m1.1.1.1"></eq><ci id="S4.T1.5.5.5.m1.1.1.2a.cmml" xref="S4.T1.5.5.5.m1.1.1.2"><mtext id="S4.T1.5.5.5.m1.1.1.2.cmml" xref="S4.T1.5.5.5.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.5.5.5.m1.1.1.3.cmml" xref="S4.T1.5.5.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.m1.1c">\textrm{IF}=50</annotation></semantics></math></td>
<td id="S4.T1.6.6.6" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.6.6.6.m1.1" class="ltx_Math" alttext="\textrm{IF}=10" display="inline"><semantics id="S4.T1.6.6.6.m1.1a"><mrow id="S4.T1.6.6.6.m1.1.1" xref="S4.T1.6.6.6.m1.1.1.cmml"><mtext id="S4.T1.6.6.6.m1.1.1.2" xref="S4.T1.6.6.6.m1.1.1.2a.cmml">IF</mtext><mo id="S4.T1.6.6.6.m1.1.1.1" xref="S4.T1.6.6.6.m1.1.1.1.cmml">=</mo><mn id="S4.T1.6.6.6.m1.1.1.3" xref="S4.T1.6.6.6.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.m1.1b"><apply id="S4.T1.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.m1.1.1"><eq id="S4.T1.6.6.6.m1.1.1.1.cmml" xref="S4.T1.6.6.6.m1.1.1.1"></eq><ci id="S4.T1.6.6.6.m1.1.1.2a.cmml" xref="S4.T1.6.6.6.m1.1.1.2"><mtext id="S4.T1.6.6.6.m1.1.1.2.cmml" xref="S4.T1.6.6.6.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.T1.6.6.6.m1.1.1.3.cmml" xref="S4.T1.6.6.6.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.m1.1c">\textrm{IF}=10</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.7.9.2" class="ltx_tr">
<th id="S4.T1.7.9.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S4.T1.7.9.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<td id="S4.T1.7.9.2.3" class="ltx_td ltx_align_center ltx_border_t">56.17</td>
<td id="S4.T1.7.9.2.4" class="ltx_td ltx_align_center ltx_border_t">59.36</td>
<td id="S4.T1.7.9.2.5" class="ltx_td ltx_align_center ltx_border_t">77.45</td>
<td id="S4.T1.7.9.2.6" class="ltx_td ltx_align_center ltx_border_t">30.34</td>
<td id="S4.T1.7.9.2.7" class="ltx_td ltx_align_center ltx_border_t">36.35</td>
<td id="S4.T1.7.9.2.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">45.87</td>
</tr>
<tr id="S4.T1.7.10.3" class="ltx_tr">
<th id="S4.T1.7.10.3.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.10.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</th>
<td id="S4.T1.7.10.3.3" class="ltx_td ltx_align_center">52.03</td>
<td id="S4.T1.7.10.3.4" class="ltx_td ltx_align_center">57.11</td>
<td id="S4.T1.7.10.3.5" class="ltx_td ltx_align_center">70.81</td>
<td id="S4.T1.7.10.3.6" class="ltx_td ltx_align_center">30.80</td>
<td id="S4.T1.7.10.3.7" class="ltx_td ltx_align_center">35.33</td>
<td id="S4.T1.7.10.3.8" class="ltx_td ltx_nopad_r ltx_align_center">44.66</td>
</tr>
<tr id="S4.T1.7.11.4" class="ltx_tr">
<th id="S4.T1.7.11.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.11.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</th>
<td id="S4.T1.7.11.4.3" class="ltx_td ltx_align_center">56.92</td>
<td id="S4.T1.7.11.4.4" class="ltx_td ltx_align_center">60.89</td>
<td id="S4.T1.7.11.4.5" class="ltx_td ltx_align_center">76.53</td>
<td id="S4.T1.7.11.4.6" class="ltx_td ltx_align_center">31.67</td>
<td id="S4.T1.7.11.4.7" class="ltx_td ltx_align_center">36.30</td>
<td id="S4.T1.7.11.4.8" class="ltx_td ltx_nopad_r ltx_align_center">46.10</td>
</tr>
<tr id="S4.T1.7.12.5" class="ltx_tr">
<th id="S4.T1.7.12.5.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.12.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedDF</th>
<td id="S4.T1.7.12.5.3" class="ltx_td ltx_align_center">55.15</td>
<td id="S4.T1.7.12.5.4" class="ltx_td ltx_align_center">58.74</td>
<td id="S4.T1.7.12.5.5" class="ltx_td ltx_align_center">76.51</td>
<td id="S4.T1.7.12.5.6" class="ltx_td ltx_align_center">31.43</td>
<td id="S4.T1.7.12.5.7" class="ltx_td ltx_align_center">36.22</td>
<td id="S4.T1.7.12.5.8" class="ltx_td ltx_nopad_r ltx_align_center">46.19</td>
</tr>
<tr id="S4.T1.7.13.6" class="ltx_tr">
<th id="S4.T1.7.13.6.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.13.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBE</th>
<td id="S4.T1.7.13.6.3" class="ltx_td ltx_align_center">55.79</td>
<td id="S4.T1.7.13.6.4" class="ltx_td ltx_align_center">59.55</td>
<td id="S4.T1.7.13.6.5" class="ltx_td ltx_align_center">77.78</td>
<td id="S4.T1.7.13.6.6" class="ltx_td ltx_align_center">31.97</td>
<td id="S4.T1.7.13.6.7" class="ltx_td ltx_align_center">36.39</td>
<td id="S4.T1.7.13.6.8" class="ltx_td ltx_nopad_r ltx_align_center">46.25</td>
</tr>
<tr id="S4.T1.7.14.7" class="ltx_tr">
<th id="S4.T1.7.14.7.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.14.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">CCVR</th>
<td id="S4.T1.7.14.7.3" class="ltx_td ltx_align_center">69.53</td>
<td id="S4.T1.7.14.7.4" class="ltx_td ltx_align_center">71.89</td>
<td id="S4.T1.7.14.7.5" class="ltx_td ltx_align_center">78.48</td>
<td id="S4.T1.7.14.7.6" class="ltx_td ltx_align_center">33.43</td>
<td id="S4.T1.7.14.7.7" class="ltx_td ltx_align_center">36.98</td>
<td id="S4.T1.7.14.7.8" class="ltx_td ltx_nopad_r ltx_align_center">46.88</td>
</tr>
<tr id="S4.T1.7.15.8" class="ltx_tr">
<th id="S4.T1.7.15.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.7.15.8.1.1" class="ltx_text">
<span id="S4.T1.7.15.8.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.15.8.1.1.1.1" class="ltx_tr">
<span id="S4.T1.7.15.8.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Heterogeneity-oriented</span></span>
<span id="S4.T1.7.15.8.1.1.1.2" class="ltx_tr">
<span id="S4.T1.7.15.8.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">FL methods</span></span>
</span></span></th>
<th id="S4.T1.7.15.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedNova</th>
<td id="S4.T1.7.15.8.3" class="ltx_td ltx_align_center">57.79</td>
<td id="S4.T1.7.15.8.4" class="ltx_td ltx_align_center">63.91</td>
<td id="S4.T1.7.15.8.5" class="ltx_td ltx_align_center">77.79</td>
<td id="S4.T1.7.15.8.6" class="ltx_td ltx_align_center">32.64</td>
<td id="S4.T1.7.15.8.7" class="ltx_td ltx_align_center">36.62</td>
<td id="S4.T1.7.15.8.8" class="ltx_td ltx_nopad_r ltx_align_center">46.75</td>
</tr>
<tr id="S4.T1.7.16.9" class="ltx_tr">
<th id="S4.T1.7.16.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S4.T1.7.16.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Fed-Focal Loss</th>
<td id="S4.T1.7.16.9.3" class="ltx_td ltx_align_center ltx_border_t">53.83</td>
<td id="S4.T1.7.16.9.4" class="ltx_td ltx_align_center ltx_border_t">57.42</td>
<td id="S4.T1.7.16.9.5" class="ltx_td ltx_align_center ltx_border_t">73.74</td>
<td id="S4.T1.7.16.9.6" class="ltx_td ltx_align_center ltx_border_t">30.67</td>
<td id="S4.T1.7.16.9.7" class="ltx_td ltx_align_center ltx_border_t">35.25</td>
<td id="S4.T1.7.16.9.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">45.52</td>
</tr>
<tr id="S4.T1.7.17.10" class="ltx_tr">
<th id="S4.T1.7.17.10.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.7.17.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ratio Loss</th>
<td id="S4.T1.7.17.10.3" class="ltx_td ltx_align_center">59.75</td>
<td id="S4.T1.7.17.10.4" class="ltx_td ltx_align_center">64.77</td>
<td id="S4.T1.7.17.10.5" class="ltx_td ltx_align_center">78.14</td>
<td id="S4.T1.7.17.10.6" class="ltx_td ltx_align_center">32.95</td>
<td id="S4.T1.7.17.10.7" class="ltx_td ltx_align_center">36.88</td>
<td id="S4.T1.7.17.10.8" class="ltx_td ltx_nopad_r ltx_align_center">46.79</td>
</tr>
<tr id="S4.T1.7.7" class="ltx_tr">
<th id="S4.T1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.7.7.2.1" class="ltx_text">
<span id="S4.T1.7.7.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.7.7.2.1.1.1" class="ltx_tr">
<span id="S4.T1.7.7.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Imbalance-oriented</span></span>
<span id="S4.T1.7.7.2.1.1.2" class="ltx_tr">
<span id="S4.T1.7.7.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">FL methods</span></span>
</span></span></th>
<th id="S4.T1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg+<math id="S4.T1.7.7.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.T1.7.7.1.m1.1a"><mi id="S4.T1.7.7.1.m1.1.1" xref="S4.T1.7.7.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.1.m1.1b"><ci id="S4.T1.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">\tau</annotation></semantics></math>-norm</th>
<td id="S4.T1.7.7.3" class="ltx_td ltx_align_center">49.95</td>
<td id="S4.T1.7.7.4" class="ltx_td ltx_align_center">51.41</td>
<td id="S4.T1.7.7.5" class="ltx_td ltx_align_center">72.08</td>
<td id="S4.T1.7.7.6" class="ltx_td ltx_align_center">26.22</td>
<td id="S4.T1.7.7.7" class="ltx_td ltx_align_center">33.71</td>
<td id="S4.T1.7.7.8" class="ltx_td ltx_nopad_r ltx_align_center">43.65</td>
</tr>
<tr id="S4.T1.7.18.11" class="ltx_tr">
<th id="S4.T1.7.18.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><span id="S4.T1.7.18.11.1.1" class="ltx_text">Proposed method</span></th>
<th id="S4.T1.7.18.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.2.1" class="ltx_text" style="background-color:#EFEFEF;">CReFF</span></th>
<td id="S4.T1.7.18.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.3.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">70.55</span></td>
<td id="S4.T1.7.18.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.4.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">73.08</span></td>
<td id="S4.T1.7.18.11.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.5.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">80.71</span></td>
<td id="S4.T1.7.18.11.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.6.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">34.67</span></td>
<td id="S4.T1.7.18.11.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.7.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">37.64</span></td>
<td id="S4.T1.7.18.11.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="background-color:#EFEFEF;"><span id="S4.T1.7.18.11.8.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">47.08</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.14.3.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.11.2" class="ltx_text" style="font-size:90%;">Top-1 test accuracy (<math id="S4.T1.10.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.T1.10.1.m1.1b"><mo id="S4.T1.10.1.m1.1.1" xref="S4.T1.10.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.1.m1.1c"><csymbol cd="latexml" id="S4.T1.10.1.m1.1.1.cmml" xref="S4.T1.10.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.1.m1.1d">\%</annotation></semantics></math>) achieved by compared FL methods and CReFF on CIFAR-10/100-LT with different <span id="S4.T1.11.2.1" class="ltx_text ltx_markedasmath">IF</span>s.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Comparison with the State-of-the-art Methods</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We compare CReFF with several heterogeneity-oriented FL methods, including FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_cite">Hsu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2020b</a>)</cite>, FedDF <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, FedBE <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, CCVR <cite class="ltx_cite ltx_citemacro_cite">Luo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> and FedNova <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. Moreover, we also compare with imbalance-oriented FL methods, including Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Sarkar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>, Ratio Loss <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2021a</a>)</cite> and FedAvg with <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\tau</annotation></semantics></math>-norm <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>. Note that Ratio Loss depends on a balanced auxiliary data, so we fetch the data from clients, although it is infeasible in practice.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="4">ImageNet-LT</th>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"><span id="S4.T2.1.3.2.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T2.1.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">All</th>
<th id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Many</th>
<th id="S4.T2.1.3.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Medium</th>
<th id="S4.T2.1.3.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">Few</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.4.1" class="ltx_tr">
<th id="S4.T2.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<th id="S4.T2.1.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">23.85</th>
<td id="S4.T2.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t">34.92</td>
<td id="S4.T2.1.4.1.4" class="ltx_td ltx_align_center ltx_border_t">19.18</td>
<td id="S4.T2.1.4.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">7.10</td>
</tr>
<tr id="S4.T2.1.5.2" class="ltx_tr">
<th id="S4.T2.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvgM</th>
<th id="S4.T2.1.5.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">22.57</th>
<td id="S4.T2.1.5.2.3" class="ltx_td ltx_align_center">33.93</td>
<td id="S4.T2.1.5.2.4" class="ltx_td ltx_align_center">18.55</td>
<td id="S4.T2.1.5.2.5" class="ltx_td ltx_nopad_r ltx_align_center">6.73</td>
</tr>
<tr id="S4.T2.1.6.3" class="ltx_tr">
<th id="S4.T2.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</th>
<th id="S4.T2.1.6.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">22.99</th>
<td id="S4.T2.1.6.3.3" class="ltx_td ltx_align_center">34.25</td>
<td id="S4.T2.1.6.3.4" class="ltx_td ltx_align_center">17.06</td>
<td id="S4.T2.1.6.3.5" class="ltx_td ltx_nopad_r ltx_align_center">6.37</td>
</tr>
<tr id="S4.T2.1.7.4" class="ltx_tr">
<th id="S4.T2.1.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedDF</th>
<th id="S4.T2.1.7.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">21.63</th>
<td id="S4.T2.1.7.4.3" class="ltx_td ltx_align_center">31.78</td>
<td id="S4.T2.1.7.4.4" class="ltx_td ltx_align_center">15.52</td>
<td id="S4.T2.1.7.4.5" class="ltx_td ltx_nopad_r ltx_align_center">4.48</td>
</tr>
<tr id="S4.T2.1.8.5" class="ltx_tr">
<th id="S4.T2.1.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CCVR</th>
<th id="S4.T2.1.8.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">25.49</th>
<td id="S4.T2.1.8.5.3" class="ltx_td ltx_align_center">36.72</td>
<td id="S4.T2.1.8.5.4" class="ltx_td ltx_align_center">20.24</td>
<td id="S4.T2.1.8.5.5" class="ltx_td ltx_nopad_r ltx_align_center">9.26</td>
</tr>
<tr id="S4.T2.1.9.6" class="ltx_tr">
<th id="S4.T2.1.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal Loss</th>
<th id="S4.T2.1.9.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">21.60</th>
<td id="S4.T2.1.9.6.3" class="ltx_td ltx_align_center">31.74</td>
<td id="S4.T2.1.9.6.4" class="ltx_td ltx_align_center">15.77</td>
<td id="S4.T2.1.9.6.5" class="ltx_td ltx_nopad_r ltx_align_center">5.52</td>
</tr>
<tr id="S4.T2.1.10.7" class="ltx_tr">
<th id="S4.T2.1.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ratio Loss</th>
<th id="S4.T2.1.10.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">24.31</th>
<td id="S4.T2.1.10.7.3" class="ltx_td ltx_align_center">36.33</td>
<td id="S4.T2.1.10.7.4" class="ltx_td ltx_align_center">18.14</td>
<td id="S4.T2.1.10.7.5" class="ltx_td ltx_nopad_r ltx_align_center">7.41</td>
</tr>
<tr id="S4.T2.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg+<math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\tau</annotation></semantics></math>-norm</th>
<th id="S4.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">21.58</th>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center">31.66</td>
<td id="S4.T2.1.1.4" class="ltx_td ltx_align_center">15.76</td>
<td id="S4.T2.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center">4.33</td>
</tr>
<tr id="S4.T2.1.11.8" class="ltx_tr" style="background-color:#EFEFEF;">
<th id="S4.T2.1.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.1.11.8.1.1" class="ltx_text" style="background-color:#EFEFEF;">CReFF</span></th>
<th id="S4.T2.1.11.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.1.11.8.2.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">26.31</span></th>
<td id="S4.T2.1.11.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.1.11.8.3.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">37.44</span></td>
<td id="S4.T2.1.11.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.1.11.8.4.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">21.87</span></td>
<td id="S4.T2.1.11.8.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.1.11.8.5.1" class="ltx_text ltx_font_bold" style="background-color:#EFEFEF;">10.29</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.1" class="ltx_text" style="font-size:90%;">Top-1 test accuracy (<math id="S4.T2.3.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.T2.3.1.m1.1b"><mo id="S4.T2.3.1.m1.1.1" xref="S4.T2.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.m1.1c"><csymbol cd="latexml" id="S4.T2.3.1.m1.1.1.cmml" xref="S4.T2.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.m1.1d">\%</annotation></semantics></math>) achieved by compared FL methods and CReFF on ImageNet-LT.</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.2" class="ltx_p"><span id="S4.SS2.p2.2.1" class="ltx_text ltx_font_bold">Results on CIFAR-10/100-LT.</span>
The results are summarized in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental Setup ‣ 4 Experimental Results ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. CReFF achieves the highest test accuracy on both datasets with different <span id="S4.SS2.p2.2.2" class="ltx_text ltx_markedasmath">IF</span>s. Compared with the baseline FedAvg, the performance gain of CReFF is the highest when <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mtext id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2a.cmml">IF</mtext><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><ci id="S4.SS2.p2.2.m2.1.1.2a.cmml" xref="S4.SS2.p2.2.m2.1.1.2"><mtext id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">IF</mtext></ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\textrm{IF}=100</annotation></semantics></math> (around 14.4% improvement for CIFAR-10-LT and 4.3% improvement for CIFAR-100-LT). It shows the generalization ability of CReFF when the global class distribution is highly long-tailed.
For heterogeneity-oriented methods, most of them (e.g., FedAvgM and FedDF) perform similarly to FedAvg because they only deal with data heterogeneity without taking global class imbalance into account.
For imbalance-oriented methods, some of them, e.g., Ratio Loss, perform well in some cases compared with FedAvg. However, there is still a performance gap compared with CReFF because they aim at dealing with the global imbalance problem but generally ignore the data heterogeneity problem across clients.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Results on ImageNet-LT.</span>
We further evaluate CReFF on ImageNet-LT as reported in Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Comparison with the State-of-the-art Methods ‣ 4 Experimental Results ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. To better examine the performance of classes with different number of training samples, we report the accuracy on three sets of classes: Many-shot (more than 100 samples), medium-shot (20-100 samples), and few-shot (less than 20 samples).
Compared with other FL methods, CReFF achieves the best results on all cases, which shows that the improved overall accuracy by CReFF does not sacrifice the accuracy of many-shot classes.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Model Validation</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">To further validate the effectiveness of CReFF, we study two key research questions.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Why does a classifier re-trained on federated features perform similarly to the one re-trained on real features?</span>
We show the dissimilarity between the federated and the real feature gradients by the gradient matching loss of each class. We group the classes into three sets for CIFAR-10-LT: Many (more than 1500 samples), medium (200-1500 samples) and few (less than 200 samples), and then average the dissimilarities in each group shown by the solid lines in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.3 Model Validation ‣ 4 Experimental Results ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. It can be observed that the dissimilarities decrease to around 0 in a few rounds, which means that optimizing on the gradient matching loss successfully makes the federated feature gradients close to the real feature gradients. Thus, the optimization of classifier re-training on federated features follows a similar path as that of the real features. Moreover, we also show the dissimilarity between the federated and the real features by calculating their cosine dissimilarity in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.3 Model Validation ‣ 4 Experimental Results ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (dotted lines). As training goes on, the dissimilarities between the federated and real features are also decreasing but they are far from 0. It means that the federated features do not have to be similar to the real features although their corresponding gradients are very close. Therefore, the privacy of the real features can be further guaranteed.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.3" class="ltx_p"><span id="S4.SS3.p3.3.1" class="ltx_text ltx_font_bold">How many federated features per class is enough to re-train a good classifier?</span> One important hyperparameter in CReFF is the number of federated features per class. We evaluate its influence by tuning it in the set <math id="S4.SS3.p3.1.m1.8" class="ltx_Math" alttext="\{0,1,5,10,50,100,150,200\}" display="inline"><semantics id="S4.SS3.p3.1.m1.8a"><mrow id="S4.SS3.p3.1.m1.8.9.2" xref="S4.SS3.p3.1.m1.8.9.1.cmml"><mo stretchy="false" id="S4.SS3.p3.1.m1.8.9.2.1" xref="S4.SS3.p3.1.m1.8.9.1.cmml">{</mo><mn id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.p3.1.m1.8.9.2.2" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.2.2" xref="S4.SS3.p3.1.m1.2.2.cmml">1</mn><mo id="S4.SS3.p3.1.m1.8.9.2.3" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.3.3" xref="S4.SS3.p3.1.m1.3.3.cmml">5</mn><mo id="S4.SS3.p3.1.m1.8.9.2.4" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.4.4" xref="S4.SS3.p3.1.m1.4.4.cmml">10</mn><mo id="S4.SS3.p3.1.m1.8.9.2.5" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.5.5" xref="S4.SS3.p3.1.m1.5.5.cmml">50</mn><mo id="S4.SS3.p3.1.m1.8.9.2.6" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.6.6" xref="S4.SS3.p3.1.m1.6.6.cmml">100</mn><mo id="S4.SS3.p3.1.m1.8.9.2.7" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.7.7" xref="S4.SS3.p3.1.m1.7.7.cmml">150</mn><mo id="S4.SS3.p3.1.m1.8.9.2.8" xref="S4.SS3.p3.1.m1.8.9.1.cmml">,</mo><mn id="S4.SS3.p3.1.m1.8.8" xref="S4.SS3.p3.1.m1.8.8.cmml">200</mn><mo stretchy="false" id="S4.SS3.p3.1.m1.8.9.2.9" xref="S4.SS3.p3.1.m1.8.9.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.8b"><set id="S4.SS3.p3.1.m1.8.9.1.cmml" xref="S4.SS3.p3.1.m1.8.9.2"><cn type="integer" id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">0</cn><cn type="integer" id="S4.SS3.p3.1.m1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2">1</cn><cn type="integer" id="S4.SS3.p3.1.m1.3.3.cmml" xref="S4.SS3.p3.1.m1.3.3">5</cn><cn type="integer" id="S4.SS3.p3.1.m1.4.4.cmml" xref="S4.SS3.p3.1.m1.4.4">10</cn><cn type="integer" id="S4.SS3.p3.1.m1.5.5.cmml" xref="S4.SS3.p3.1.m1.5.5">50</cn><cn type="integer" id="S4.SS3.p3.1.m1.6.6.cmml" xref="S4.SS3.p3.1.m1.6.6">100</cn><cn type="integer" id="S4.SS3.p3.1.m1.7.7.cmml" xref="S4.SS3.p3.1.m1.7.7">150</cn><cn type="integer" id="S4.SS3.p3.1.m1.8.8.cmml" xref="S4.SS3.p3.1.m1.8.8">200</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.8c">\{0,1,5,10,50,100,150,200\}</annotation></semantics></math> on CIFAR-10-LT with different <span id="S4.SS3.p3.3.2" class="ltx_text ltx_markedasmath">IF</span>s. When the number of federated features is 0, CReFF is equivalent to FedAvg.
It can be observed from Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Model Validation ‣ 4 Experimental Results ‣ Federated Learning on Heterogeneous and Long-Tailed Data via Classifier Re-Training with Federated Features" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that more federated features produce higher accuracy in general. However, as the number of federated features increases, the improvement gradually becomes stable. This result is anticipated because the information provided by real feature gradients is limited. Meanwhile, a surprising result is that even if only one federated feature is learned for each class, CReFF can still improve 4.21%, 3.74%, and 0.92% for CIFAR-10-LT with <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mtext id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2a.cmml">IF</mtext><mo id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><eq id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"></eq><ci id="S4.SS3.p3.3.m3.1.1.2a.cmml" xref="S4.SS3.p3.3.m3.1.1.2"><mtext id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">IF</mtext></ci><cn type="integer" id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\textrm{IF}=100</annotation></semantics></math>, 50 and 10, respectively.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2204.13399/assets/x5.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="414" height="189" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.4.2" class="ltx_text" style="font-size:90%;">The lines of two dissimilarities on CIFAR-10-LT with <math id="S4.F4.3.1.m1.1" class="ltx_Math" alttext="\textrm{IF}=100" display="inline"><semantics id="S4.F4.3.1.m1.1b"><mrow id="S4.F4.3.1.m1.1.1" xref="S4.F4.3.1.m1.1.1.cmml"><mtext id="S4.F4.3.1.m1.1.1.2" xref="S4.F4.3.1.m1.1.1.2a.cmml">IF</mtext><mo id="S4.F4.3.1.m1.1.1.1" xref="S4.F4.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.F4.3.1.m1.1.1.3" xref="S4.F4.3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.3.1.m1.1c"><apply id="S4.F4.3.1.m1.1.1.cmml" xref="S4.F4.3.1.m1.1.1"><eq id="S4.F4.3.1.m1.1.1.1.cmml" xref="S4.F4.3.1.m1.1.1.1"></eq><ci id="S4.F4.3.1.m1.1.1.2a.cmml" xref="S4.F4.3.1.m1.1.1.2"><mtext id="S4.F4.3.1.m1.1.1.2.cmml" xref="S4.F4.3.1.m1.1.1.2">IF</mtext></ci><cn type="integer" id="S4.F4.3.1.m1.1.1.3.cmml" xref="S4.F4.3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.1.m1.1d">\textrm{IF}=100</annotation></semantics></math> and <math id="S4.F4.4.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F4.4.2.m2.1b"><mrow id="S4.F4.4.2.m2.1.1" xref="S4.F4.4.2.m2.1.1.cmml"><mi id="S4.F4.4.2.m2.1.1.2" xref="S4.F4.4.2.m2.1.1.2.cmml">α</mi><mo id="S4.F4.4.2.m2.1.1.1" xref="S4.F4.4.2.m2.1.1.1.cmml">=</mo><mn id="S4.F4.4.2.m2.1.1.3" xref="S4.F4.4.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.4.2.m2.1c"><apply id="S4.F4.4.2.m2.1.1.cmml" xref="S4.F4.4.2.m2.1.1"><eq id="S4.F4.4.2.m2.1.1.1.cmml" xref="S4.F4.4.2.m2.1.1.1"></eq><ci id="S4.F4.4.2.m2.1.1.2.cmml" xref="S4.F4.4.2.m2.1.1.2">𝛼</ci><cn type="float" id="S4.F4.4.2.m2.1.1.3.cmml" xref="S4.F4.4.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.2.m2.1d">\alpha=0.5</annotation></semantics></math>.
</span></figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2204.13399/assets/x6.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="405" height="187" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.5.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.2.1" class="ltx_text" style="font-size:90%;">The performance of CReFF with the different number of federated features on CIFAR-10-LT with different <span id="S4.F5.2.1.1" class="ltx_text ltx_markedasmath">IF</span>s.
</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we first show that classifier re-training is a straightforward and effective way to deal with the joint problem of data heterogeneity and long-tail distribution in the federated learning framework. Based on this, CReFF is proposed to learn a small set of balanced features called <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">federated features</span> on the server for classifier re-training in a privacy-preserving manner. The classifier re-trained on the federated features can produce comparable performance as the one retrained on the real data.
Experiments have shown that CReFF outperforms the state-of-the-art FL methods in the setting of heterogeneity and long-tail distribution, and the effectiveness CReFF is validated empirically.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgments</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We thank Dr. Fei Chen for his helpful discussion and reviewers of IJCAI-ECAI 2022 for their constructive and helpful feedback. This work was supported in part by the National Natural Science Foundation of China (No. 62002302, U21A20514, 61872307 and 52007173), the Open Research Projects of Zhejiang Lab (No. 2021KB0AB03), the Natural Science Foundation of Fujian Province (No. 2020J01005), and Zhejiang Provincial Natural Science Foundation of China (No. LQ20E070002).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Kaidi Cao, Colin Wei, Adrien Gaidon, Nikos Arechiga, and Tengyu Ma.

</span>
<span class="ltx_bibblock">Learning imbalanced datasets with label-distribution-aware margin
loss.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 1567–1578, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Chao [2021]</span>
<span class="ltx_bibblock">
Hong-You Chen and Wei-Lun Chao.

</span>
<span class="ltx_bibblock">Fedbe: Making bayesian model ensemble applicable to federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Moming Duan, Duo Liu, Xianzhang Chen, Renping Liu, Yujuan Tan, and Liang Liang.

</span>
<span class="ltx_bibblock">Self-balancing federated learning with global imbalanced data in
mobile systems.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</span>,
32(1):59–71, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.06335</span>, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Hua Huang, Fanhua Shang, Yuanyuan Liu, and Hongying Liu.

</span>
<span class="ltx_bibblock">Behavior mimics distribution: Combining individual and group
behaviors for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 2556–2552, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Ziyue Jiang, Yi Ren, Ming Lei, and Zhou Zhao.

</span>
<span class="ltx_bibblock">Fedspeech: Federated text-to-speech with continual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 3829–3835, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Bingyi Kang, Saining Xie, Marcus Rohrbach, Zhicheng Yan, Albert Gordo, Jiashi
Feng, and Yannis Kalantidis.

</span>
<span class="ltx_bibblock">Decoupling representation and classifier for long-tailed recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">ICLR</span>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Jaehyung Kim, Jongheon Jeong, and Jinwoo Shin.

</span>
<span class="ltx_bibblock">M2m: Imbalanced classification via major-to-minor translation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 13896–13905, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky and Hinton [2009]</span>
<span class="ltx_bibblock">
A. Krizhevsky and G. Hinton.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Technical report</span>, pages 32–33. University of Toronto, 2009.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020a]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">IEEE Signal Processing Magazine</span>, 37(3):50–60, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020b]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">MLSys</span>, pages 429–450, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 2351–2363, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, and Jiashi Feng.

</span>
<span class="ltx_bibblock">No fear of heterogeneity: Classifier calibration for federated
learning with non-iid data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">AISTATS</span>, pages 1273–1282, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russakovsky <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang,
A. Karpathy, A. Khosla, and M. Bernstein.

</span>
<span class="ltx_bibblock">Imagenet large scale visual recognition challenge.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">International Journal of Computer Vision</span>, 115(3):211–252,
2015.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarkar <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Dipankar Sarkar, Ankur Narang, and Sumit Rai.

</span>
<span class="ltx_bibblock">Fed-focal loss for imbalanced data classification in federated
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2011.06283</span>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H. Vincent Poor.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 7611–7623, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021a]</span>
<span class="ltx_bibblock">
Lixu Wang, Shichao Xu, Xiao Wang, and Qi Zhu.

</span>
<span class="ltx_bibblock">Addressing class imbalance in federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">AAAI</span>, pages 10165–10173, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021b]</span>
<span class="ltx_bibblock">
Xudong Wang, Long Lian, Zhongqi Miao, Ziwei Liu, and Stella X. Yu.

</span>
<span class="ltx_bibblock">Long-tailed recognition by routing diverse distribution-aware
experts.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">ICLR</span>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiang <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Liuyu Xiang, Guiguang Ding, and Jungong Han.

</span>
<span class="ltx_bibblock">Learning from multiple experts: Self-paced knowledge distillation for
long-tailed classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">ECCV</span>, pages 247–263, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Miao Yang, Akitanoshou Wong, Hongbin Zhu, Haifeng Wang, and Hua Qian.

</span>
<span class="ltx_bibblock">Federated learning with class imbalance reduction.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2011.11266</span>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zang <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yuhang Zang, Chen Huang, and Chen Change Loy.

</span>
<span class="ltx_bibblock">Fasa: Feature augmentation and sampling adaptation for long-tailed
instance segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yifan Zhang, Bingyi Kang, Bryan Hooi, Shuicheng Yan, and Jiashi Feng.

</span>
<span class="ltx_bibblock">Deep long-tailed learning: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.04596</span>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen.

</span>
<span class="ltx_bibblock">Dataset condensation with gradient matching.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">ICLR</span>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Wenbo Zheng, Lan Yan, Chao Gou, and Fei-Yue Wang.

</span>
<span class="ltx_bibblock">Federated meta-learning for fraudulent credit card detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 4654–4660, 2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2204.13398" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2204.13399" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2204.13399">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2204.13399" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2204.13400" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 23:55:35 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
