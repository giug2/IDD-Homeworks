<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2305.03097] Federated Ensemble-Directed Offline Reinforcement Learning</title><meta property="og:description" content="We consider the problem of federated offline reinforcement learning (RL), a scenario under which distributed learning agents must collaboratively learn a high-quality control policy only using small pre-collected datas…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Ensemble-Directed Offline Reinforcement Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Ensemble-Directed Offline Reinforcement Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2305.03097">

<!--Generated on Thu Feb 29 09:48:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">
<span id="id1.id1" class="ltx_text ltx_font_bold">Federated Ensemble-Directed 
<br class="ltx_break">Offline Reinforcement Learning</span> </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Desik Rengarajan, Nitin Ragothaman, Dileep Kalathil, Srinivas Shakkottai 
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text" style="font-size:90%;">Department of Electrical and Computer Engineering, Texas A&amp;M University

<br class="ltx_break"><span id="id2.1.id1.1" class="ltx_text ltx_font_typewriter">{desik,nitinr,dileep.kalathil,sshakkot}@tamu.edu</span></span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p"><span id="id3.id1.1" class="ltx_text">We consider the problem of federated offline reinforcement learning (RL), a scenario under which distributed learning agents must collaboratively learn a high-quality control policy only using small pre-collected datasets generated according to different unknown behavior policies. Naïvely combining a standard offline RL approach with a standard federated learning approach to solve this problem can lead to poorly performing policies. In response, we develop the Federated Ensemble-Directed Offline Reinforcement Learning Algorithm (FEDORA), which distills the collective wisdom of the clients using an ensemble learning approach. We develop the FEDORA codebase to utilize distributed compute resources on a federated learning platform. We show that FEDORA significantly outperforms other approaches, including offline RL over the combined data pool, in various complex continuous control environments and real world datasets. Finally, we demonstrate the performance of FEDORA in the real-world on a mobile robot.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning is an approach wherein clients learn collaboratively by sharing their locally trained models (not their data) with a federating agent, which periodically combines their models and returns the federated model to the clients for further refinement <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. Federated learning has seen much success in supervised learning applications due to its ability to generate well-trained models using small amounts of data at each client while preserving privacy and reducing the usage of communication resources. Recently, there is a growing interest in employing federated learning for <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">online</em> RL problems where each client collects data online by following its own Markovian trajectory, while simultaneously updating the model parameters <cite class="ltx_cite ltx_citemacro_citep">(Khodadadian et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>; Nadiger et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Qi et al., <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>. However, such an online learning approach requires sequential interactions with the environment or the simulator, which may not be feasible in many real-world applications. Instead, each clients may have pre-collected operational data generated according to a client-specific behavior policy. The <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">federated offline reinforcement learning</em> problem is to learn the optimal policy using these heterogeneous offline data sets distributed across the clients and collected by different unknown behavior policies, without sharing the data explicitly.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">The framework of offline reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Levine et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> offers a way to learn the policy only using the offline data collected according a behavior policy, without any direct interactions with the environment. However, naively combining an off-the-shelf offline RL algorithm such as TD3-BC <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto &amp; Gu, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> with an off-the-shelf federated supervised learning approach such as FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> will lead to a poorly performing policy, as we show later (see Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S6.F3" title="Figure 3 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Federated offline RL is significantly more challenging than its supervised learning counterpart and the centralized offline RL because of the following reasons. (i) <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">Ensemble heterogeneity:</em> the client data sets are collected according to different behavior policies with different performance levels. It is vital to capture the collective insight of these policies rather than merely average them. (ii) <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">Pessimistic value computation:</em> popular offline RL algorithms involve a pessimistic term with respect to the offline data for minimizing the distribution shift. However, in a federated setting, it is important capture the information from the data of other clients. (iii) <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">Data heterogeneity:</em> Client drift due to multiple local update is a known problem in federated learning. Moreover, training the offline policies at each client also suffers from the data heterogeneity problem inherent to federated learning.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this work, we propose the federated ensemble-directed offline RL algorithm (FEDORA), which can overcome these challenges to obtain high-quality control policies collaboratively. Our proposed approach recognizes that individual client policies are of varying levels of expertise
and refines the federated policy based on the relative merits of each client policy in an ensemble learning manner. The algorithm combines the insight across critics similarly and ensures optimism across the federated and local critics, thereby setting ambitious targets for training. FEDORA addresses the issue of data heterogeneity by regularizing the client policies with respect to both the federated policy and the local dataset. Finally, FEDORA prunes the influence of irrelevant data by gradually decaying the reliance on a dataset based on the quality of the policy it can generate.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Federated offline RL has not been well studied in the literature, and to the best of our knowledge, no other work presents an approach that addresses the general problem. The primary contribution of this work is to systematically identify the fundamental challenges of this problem and design methods that explicitly tackle each of them. The idea of learning over an ensemble of policies of different qualities to leverage their collective insight is unique to our method.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">We develop a framework for implementing FEDORA on a single system and over distributed compute resources. We evaluate FEDORA on standard MuJoCo environments and real world datasets and show that it outperforms several other approaches, including pooling all the data and performing offline RL centrally. We also demonstrate FEDORA’s excellent performance via real-world experiments on a TurtleBot robot <cite class="ltx_cite ltx_citemacro_citep">(Amsters &amp; Slaets, <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>. We provide the code for our implementation and the videos of the robot experiments at <a target="_blank" href="https://github.com/DesikRengarajan/FEDORA" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/DesikRengarajan/FEDORA</a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Offline RL:</span>
The goal of offline RL is to learn a policy from a fixed dataset generated according to a behavior policy <cite class="ltx_cite ltx_citemacro_citep">(Levine et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. One of the key challenges of the offline RL approach is the distribution shift problem where the state-action visitation distribution of learned policy may be different from that of the behavior policy which generated the offline data. It is known that this distribution shift may lead to poor performance of the learned policy <cite class="ltx_cite ltx_citemacro_citep">(Levine et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. A common method used by the offline RL algorithms to tackle this problem is to learn a policy that is close to the behavior policy that generated the data. This is achieved by using some kind of regularization either on the actor or critic <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto &amp; Gu, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>; Fujimoto et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>; Kumar et al., <a href="#bib.bib16" title="" class="ltx_ref">2020</a>, <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Wu et al., <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>. Some offline RL algorithms perform weighted versions of behavior cloning or imitation learning on either the whole or subset of the dataset <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2018</a>; Peng et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Chen et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>. With the success of large language models, many recent works have framed offline RL as a sequence modeling problem and have used transformers to solve it <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>; Janner et al., <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Federated Learning:</span> <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> introduced FedAvg, a federation strategy where clients collaboratively learn a joint model without sharing data. <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. (<a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> generalized FedAvg by separating the client learning and server learning process. A key problem in federated learning is data heterogeneity where clients have non-identically distributed data which causes unstable and slow convergence <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>; Karimireddy et al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>. To tackle the issue of data heterogeneity, <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> propose FedProx, a variant of FedAvg, where a proximal term is introduced to prevent the local model from deviating too much from the server model. <cite class="ltx_cite ltx_citemacro_citet">Karimireddy et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite> take a different approach to tackle data heterogeneity and the resultant client drift by using control variates.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Federated Reinforcement Learning:</span> Federated learning has been extended to the online RL setting recently. <cite class="ltx_cite ltx_citemacro_citet">Khodadadian et al. (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> analyzed the performance the federated tabular Q-learning. <cite class="ltx_cite ltx_citemacro_citet">Qi et al. (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> combined traditional online RL algorithms with FedAvg for various applications. Some works propose methods to vary the weighting scheme of FedAvg according to performance metrics such as the length of a rally in the game of Pong <cite class="ltx_cite ltx_citemacro_citep">(Nadiger et al., <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite> or average return in the past <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S2.p3.1.m1.1a"><mn id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><cn type="integer" id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">10</annotation></semantics></math> training episodes <cite class="ltx_cite ltx_citemacro_citep">(Lim et al., <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite> to achieve better performance or personalization. <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite> propose a method to compute weights using attention over performance metrics of clients such as average reward, average loss, and hit rate for an edge caching application. <cite class="ltx_cite ltx_citemacro_citet">Hebert et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> use a transformer encoder to learn contextual relationships between agents in the online RL setting. <cite class="ltx_cite ltx_citemacro_citet">Hu et al. (<a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite> propose an alternative approach to federation where reward shaping is used to share information among clients. <cite class="ltx_cite ltx_citemacro_citet">Xie &amp; Song (<a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite> propose a KL divergence-based regularization between the local and global policy to address the issue of data heterogeneity in an online RL setting.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">In the offline RL setting, <cite class="ltx_cite ltx_citemacro_citet">Zhou et al. (<a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite> propose federated dynamic treatment regime algorithm by formulating offline federated learning using a multi-site MDP model constructed using linear MDPs. However, this approach relies on running the local training to completion followed by just one step of federated averaging. Unlike this work, our proposed method does not assume linear MDPs, which is a limiting assumption in many real-world problems. Moreover, we use the standard federated learning philosophy of periodic federation followed by multiple local updates. <em id="S2.p4.1.1" class="ltx_emph ltx_font_italic">To the best of our knowledge, ours is the first work that propose a general federated offline RL algorithm for clients with heterogeneous data.</em></p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.11" class="ltx_p"><span id="S3.p1.11.1" class="ltx_text ltx_font_bold">Federated Learning:</span> The goal of federated learning is to minimize the following objective,</p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\displaystyle F(\theta)=\mathbb{E}_{i\sim\mathcal{P}}\left[F_{i}(\theta)\right]," display="inline"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.3.3.1" xref="S3.E1.m1.3.3.1.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.3.cmml">𝒫</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝐹</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜃</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S3.E1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3.1">similar-to</csymbol><ci id="S3.E1.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3.3">𝒫</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\displaystyle F(\theta)=\mathbb{E}_{i\sim\mathcal{P}}\left[F_{i}(\theta)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.10" class="ltx_p">where <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\theta</annotation></semantics></math> represents the parameter of the federated (server) model, <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">F</mi><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝐹</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">F_{i}</annotation></semantics></math> denotes the local objective function of client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math>, and <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathcal{P}</annotation></semantics></math> is the distribution over the set of clients <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S3.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\mathcal{N}</annotation></semantics></math>. The FedAvg algorithm <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> is a popular method to solve Eq. (<a href="#S3.E1" title="In 3 Preliminaries ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) in a federated way. FedAvg divides the training process into rounds, where at the beginning of each round <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">t</annotation></semantics></math>, the server broadcasts its current model <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="S3.p1.7.m7.1a"><msup id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">θ</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">superscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝜃</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\theta^{t}</annotation></semantics></math> to all the clients, and each client initializes its current local model to the current server model. Clients perform multiple local updates on their own dataset <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p1.8.m8.1a"><msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">𝒟</mi><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝒟</ci><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\mathcal{D}_{i}</annotation></semantics></math> to obtain an updated local model <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="\theta_{i}^{t}" display="inline"><semantics id="S3.p1.9.m9.1a"><msubsup id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2.2" xref="S3.p1.9.m9.1.1.2.2.cmml">θ</mi><mi id="S3.p1.9.m9.1.1.2.3" xref="S3.p1.9.m9.1.1.2.3.cmml">i</mi><mi id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">superscript</csymbol><apply id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.2.1.cmml" xref="S3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.2.2.cmml" xref="S3.p1.9.m9.1.1.2.2">𝜃</ci><ci id="S3.p1.9.m9.1.1.2.3.cmml" xref="S3.p1.9.m9.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\theta_{i}^{t}</annotation></semantics></math>. The server then averages these local models proportional to the size of their local dataset to obtain the server model <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\theta^{t+1}" display="inline"><semantics id="S3.p1.10.m10.1a"><msup id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mi id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml">θ</mi><mrow id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml"><mi id="S3.p1.10.m10.1.1.3.2" xref="S3.p1.10.m10.1.1.3.2.cmml">t</mi><mo id="S3.p1.10.m10.1.1.3.1" xref="S3.p1.10.m10.1.1.3.1.cmml">+</mo><mn id="S3.p1.10.m10.1.1.3.3" xref="S3.p1.10.m10.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1">superscript</csymbol><ci id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2">𝜃</ci><apply id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3"><plus id="S3.p1.10.m10.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.3.1"></plus><ci id="S3.p1.10.m10.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.3.2">𝑡</ci><cn type="integer" id="S3.p1.10.m10.1.1.3.3.cmml" xref="S3.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\theta^{t+1}</annotation></semantics></math> for the next round of federation, as</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.6" class="ltx_Math" alttext="\displaystyle\theta^{t+1}=\sum_{i=1}^{|\mathcal{N}|}w_{i}\theta_{i}^{t},\quad w_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\quad|\mathcal{D}|=\sum_{i=1}^{|\mathcal{N}|}|\mathcal{D}_{i}|." display="inline"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1"><mrow id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.3.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><msup id="S3.E2.m1.6.6.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.E2.m1.6.6.1.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.2.3.2" xref="S3.E2.m1.6.6.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2.3.1" xref="S3.E2.m1.6.6.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E2.m1.6.6.1.1.1.1.2.3.3" xref="S3.E2.m1.6.6.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.1.1.3.1" xref="S3.E2.m1.6.6.1.1.1.1.3.1.cmml"><munderover id="S3.E2.m1.6.6.1.1.1.1.3.1a" xref="S3.E2.m1.6.6.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.1.1.1.1.3.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.2" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.1" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.3" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E2.m1.6.6.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.2.cmml">w</mi><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.3.2.1" xref="S3.E2.m1.6.6.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.6.6.1.1.1.1.3.2.3" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.3" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.3.cmml">i</mi><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.3.3" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E2.m1.6.6.1.1.2.3" xref="S3.E2.m1.6.6.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.6.6.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.3.cmml"><mrow id="S3.E2.m1.6.6.1.1.2.2.1.1" xref="S3.E2.m1.6.6.1.1.2.2.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.2.2.1.1.2" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2.cmml"><mi id="S3.E2.m1.6.6.1.1.2.2.1.1.2.2" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2.2.cmml">w</mi><mi id="S3.E2.m1.6.6.1.1.2.2.1.1.2.3" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.6.6.1.1.2.2.1.1.1" xref="S3.E2.m1.6.6.1.1.2.2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mfrac id="S3.E2.m1.3.3a" xref="S3.E2.m1.3.3.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.3.3.2.3" xref="S3.E2.m1.3.3.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.2.3.1" xref="S3.E2.m1.3.3.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.2.1" xref="S3.E2.m1.3.3.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.3.3.2.3.2" xref="S3.E2.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo rspace="1.167em" id="S3.E2.m1.6.6.1.1.2.2.2.3" xref="S3.E2.m1.6.6.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.6.6.1.1.2.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.cmml"><mrow id="S3.E2.m1.6.6.1.1.2.2.2.2.3.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.2.2.2.2.3.2.1" xref="S3.E2.m1.6.6.1.1.2.2.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.2.2.2.2.3.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.3.1.1.cmml">|</mo></mrow><mo id="S3.E2.m1.6.6.1.1.2.2.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.2.2.2.2.1" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.cmml"><munderover id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2a" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.1" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.3" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.4.4.1.3" xref="S3.E2.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.3.1" xref="S3.E2.m1.4.4.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">𝒩</mi><mo stretchy="false" id="S3.E2.m1.4.4.1.3.2" xref="S3.E2.m1.4.4.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.2.1.cmml">|</mo><msub id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.3" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.6.6.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.3a.cmml" xref="S3.E2.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><eq id="S3.E2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"></eq><apply id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2">superscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2">𝜃</ci><apply id="S3.E2.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3"><plus id="S3.E2.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3.1"></plus><ci id="S3.E2.m1.6.6.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3"><apply id="S3.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.3.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.1.3.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3"><eq id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.3"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.3.1"></abs><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒩</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2"><times id="S3.E2.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.1"></times><apply id="S3.E2.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.2">𝑤</ci><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.2">𝜃</ci><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.3a.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.6.6.1.1.2.2.1.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1"><eq id="S3.E2.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1.1"></eq><apply id="S3.E2.m1.6.6.1.1.2.2.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2.2">𝑤</ci><ci id="S3.E2.m1.6.6.1.1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><divide id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3"></divide><apply id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1"><abs id="S3.E2.m1.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2"></abs><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.3"><abs id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.3.1"></abs><ci id="S3.E2.m1.3.3.2.1.cmml" xref="S3.E2.m1.3.3.2.1">𝒟</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2"><eq id="S3.E2.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.2"></eq><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.3.2"><abs id="S3.E2.m1.6.6.1.1.2.2.2.2.3.1.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.3.2.1"></abs><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝒟</ci></apply><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1"><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3"><eq id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.1.2.cmml" xref="S3.E2.m1.4.4.1.3"><abs id="S3.E2.m1.4.4.1.2.1.cmml" xref="S3.E2.m1.4.4.1.3.1"></abs><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝒩</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1"><abs id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.2"></abs><apply id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\displaystyle\theta^{t+1}=\sum_{i=1}^{|\mathcal{N}|}w_{i}\theta_{i}^{t},\quad w_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\quad|\mathcal{D}|=\sum_{i=1}^{|\mathcal{N}|}|\mathcal{D}_{i}|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.22" class="ltx_p"><span id="S3.p2.22.1" class="ltx_text ltx_font_bold">Reinforcement Learning:</span> We model RL using the Markov Decision Process (MDP) framework denoted as a tuple <math id="S3.p2.1.m1.6" class="ltx_Math" alttext="(\mathcal{S},\mathcal{A},R,P,\gamma,\mu)" display="inline"><semantics id="S3.p2.1.m1.6a"><mrow id="S3.p2.1.m1.6.7.2" xref="S3.p2.1.m1.6.7.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.6.7.2.1" xref="S3.p2.1.m1.6.7.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝒮</mi><mo id="S3.p2.1.m1.6.7.2.2" xref="S3.p2.1.m1.6.7.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml">𝒜</mi><mo id="S3.p2.1.m1.6.7.2.3" xref="S3.p2.1.m1.6.7.1.cmml">,</mo><mi id="S3.p2.1.m1.3.3" xref="S3.p2.1.m1.3.3.cmml">R</mi><mo id="S3.p2.1.m1.6.7.2.4" xref="S3.p2.1.m1.6.7.1.cmml">,</mo><mi id="S3.p2.1.m1.4.4" xref="S3.p2.1.m1.4.4.cmml">P</mi><mo id="S3.p2.1.m1.6.7.2.5" xref="S3.p2.1.m1.6.7.1.cmml">,</mo><mi id="S3.p2.1.m1.5.5" xref="S3.p2.1.m1.5.5.cmml">γ</mi><mo id="S3.p2.1.m1.6.7.2.6" xref="S3.p2.1.m1.6.7.1.cmml">,</mo><mi id="S3.p2.1.m1.6.6" xref="S3.p2.1.m1.6.6.cmml">μ</mi><mo stretchy="false" id="S3.p2.1.m1.6.7.2.7" xref="S3.p2.1.m1.6.7.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.6b"><vector id="S3.p2.1.m1.6.7.1.cmml" xref="S3.p2.1.m1.6.7.2"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝒮</ci><ci id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2">𝒜</ci><ci id="S3.p2.1.m1.3.3.cmml" xref="S3.p2.1.m1.3.3">𝑅</ci><ci id="S3.p2.1.m1.4.4.cmml" xref="S3.p2.1.m1.4.4">𝑃</ci><ci id="S3.p2.1.m1.5.5.cmml" xref="S3.p2.1.m1.5.5">𝛾</ci><ci id="S3.p2.1.m1.6.6.cmml" xref="S3.p2.1.m1.6.6">𝜇</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.6c">(\mathcal{S},\mathcal{A},R,P,\gamma,\mu)</annotation></semantics></math>, where <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathcal{S}</annotation></semantics></math> is the state space, <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathcal{A}</annotation></semantics></math> is the action space, <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="R:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">R</mi><mo lspace="0.278em" rspace="0.278em" id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">:</mo><mrow id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml"><mrow id="S3.p2.4.m4.1.1.3.2" xref="S3.p2.4.m4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1.3.2.2" xref="S3.p2.4.m4.1.1.3.2.2.cmml">𝒮</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.4.m4.1.1.3.2.1" xref="S3.p2.4.m4.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1.3.2.3" xref="S3.p2.4.m4.1.1.3.2.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="S3.p2.4.m4.1.1.3.1" xref="S3.p2.4.m4.1.1.3.1.cmml">→</mo><mi id="S3.p2.4.m4.1.1.3.3" xref="S3.p2.4.m4.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><ci id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1">:</ci><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑅</ci><apply id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3"><ci id="S3.p2.4.m4.1.1.3.1.cmml" xref="S3.p2.4.m4.1.1.3.1">→</ci><apply id="S3.p2.4.m4.1.1.3.2.cmml" xref="S3.p2.4.m4.1.1.3.2"><times id="S3.p2.4.m4.1.1.3.2.1.cmml" xref="S3.p2.4.m4.1.1.3.2.1"></times><ci id="S3.p2.4.m4.1.1.3.2.2.cmml" xref="S3.p2.4.m4.1.1.3.2.2">𝒮</ci><ci id="S3.p2.4.m4.1.1.3.2.3.cmml" xref="S3.p2.4.m4.1.1.3.2.3">𝒜</ci></apply><ci id="S3.p2.4.m4.1.1.3.3.cmml" xref="S3.p2.4.m4.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">R:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}</annotation></semantics></math> is the reward function, and <math id="S3.p2.5.m5.2" class="ltx_Math" alttext="P:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\rightarrow[0,1]" display="inline"><semantics id="S3.p2.5.m5.2a"><mrow id="S3.p2.5.m5.2.3" xref="S3.p2.5.m5.2.3.cmml"><mi id="S3.p2.5.m5.2.3.2" xref="S3.p2.5.m5.2.3.2.cmml">P</mi><mo lspace="0.278em" rspace="0.278em" id="S3.p2.5.m5.2.3.1" xref="S3.p2.5.m5.2.3.1.cmml">:</mo><mrow id="S3.p2.5.m5.2.3.3" xref="S3.p2.5.m5.2.3.3.cmml"><mrow id="S3.p2.5.m5.2.3.3.2" xref="S3.p2.5.m5.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.2.3.3.2.2" xref="S3.p2.5.m5.2.3.3.2.2.cmml">𝒮</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.5.m5.2.3.3.2.1" xref="S3.p2.5.m5.2.3.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.2.3.3.2.3" xref="S3.p2.5.m5.2.3.3.2.3.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.5.m5.2.3.3.2.1a" xref="S3.p2.5.m5.2.3.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.2.3.3.2.4" xref="S3.p2.5.m5.2.3.3.2.4.cmml">𝒮</mi></mrow><mo stretchy="false" id="S3.p2.5.m5.2.3.3.1" xref="S3.p2.5.m5.2.3.3.1.cmml">→</mo><mrow id="S3.p2.5.m5.2.3.3.3.2" xref="S3.p2.5.m5.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.p2.5.m5.2.3.3.3.2.1" xref="S3.p2.5.m5.2.3.3.3.1.cmml">[</mo><mn id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">0</mn><mo id="S3.p2.5.m5.2.3.3.3.2.2" xref="S3.p2.5.m5.2.3.3.3.1.cmml">,</mo><mn id="S3.p2.5.m5.2.2" xref="S3.p2.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.p2.5.m5.2.3.3.3.2.3" xref="S3.p2.5.m5.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.2b"><apply id="S3.p2.5.m5.2.3.cmml" xref="S3.p2.5.m5.2.3"><ci id="S3.p2.5.m5.2.3.1.cmml" xref="S3.p2.5.m5.2.3.1">:</ci><ci id="S3.p2.5.m5.2.3.2.cmml" xref="S3.p2.5.m5.2.3.2">𝑃</ci><apply id="S3.p2.5.m5.2.3.3.cmml" xref="S3.p2.5.m5.2.3.3"><ci id="S3.p2.5.m5.2.3.3.1.cmml" xref="S3.p2.5.m5.2.3.3.1">→</ci><apply id="S3.p2.5.m5.2.3.3.2.cmml" xref="S3.p2.5.m5.2.3.3.2"><times id="S3.p2.5.m5.2.3.3.2.1.cmml" xref="S3.p2.5.m5.2.3.3.2.1"></times><ci id="S3.p2.5.m5.2.3.3.2.2.cmml" xref="S3.p2.5.m5.2.3.3.2.2">𝒮</ci><ci id="S3.p2.5.m5.2.3.3.2.3.cmml" xref="S3.p2.5.m5.2.3.3.2.3">𝒜</ci><ci id="S3.p2.5.m5.2.3.3.2.4.cmml" xref="S3.p2.5.m5.2.3.3.2.4">𝒮</ci></apply><interval closure="closed" id="S3.p2.5.m5.2.3.3.3.1.cmml" xref="S3.p2.5.m5.2.3.3.3.2"><cn type="integer" id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">0</cn><cn type="integer" id="S3.p2.5.m5.2.2.cmml" xref="S3.p2.5.m5.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.2c">P:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\rightarrow[0,1]</annotation></semantics></math> denotes the transition probability function that gives the probability of transitioning to a state <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="s^{\prime}" display="inline"><semantics id="S3.p2.6.m6.1a"><msup id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">s</mi><mo id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝑠</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">s^{\prime}</annotation></semantics></math> by taking action <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.p2.7.m7.1a"><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">a</annotation></semantics></math> in state <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.p2.8.m8.1a"><mi id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><ci id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">s</annotation></semantics></math>, <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">\gamma</annotation></semantics></math> is the discount factor, and <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.p2.10.m10.1a"><mi id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><ci id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">\mu</annotation></semantics></math> is the distribution of the initial state <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="s_{0}" display="inline"><semantics id="S3.p2.11.m11.1a"><msub id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml"><mi id="S3.p2.11.m11.1.1.2" xref="S3.p2.11.m11.1.1.2.cmml">s</mi><mn id="S3.p2.11.m11.1.1.3" xref="S3.p2.11.m11.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><apply id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m11.1.1.1.cmml" xref="S3.p2.11.m11.1.1">subscript</csymbol><ci id="S3.p2.11.m11.1.1.2.cmml" xref="S3.p2.11.m11.1.1.2">𝑠</ci><cn type="integer" id="S3.p2.11.m11.1.1.3.cmml" xref="S3.p2.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">s_{0}</annotation></semantics></math>. A policy <math id="S3.p2.12.m12.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p2.12.m12.1a"><mi id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><ci id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">\pi</annotation></semantics></math> is a function that maps states to actions (deterministic policy) or states to a distribution over actions (stochastic policy). The goal of RL is to maximize the infinite horizon discounted reward of policy <math id="S3.p2.13.m13.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p2.13.m13.1a"><mi id="S3.p2.13.m13.1.1" xref="S3.p2.13.m13.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.13.m13.1b"><ci id="S3.p2.13.m13.1.1.cmml" xref="S3.p2.13.m13.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m13.1c">\pi</annotation></semantics></math>, defined as <math id="S3.p2.14.m14.5" class="ltx_Math" alttext="J(\pi)=\mathbb{E}_{\pi,P,\mu}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})\right]" display="inline"><semantics id="S3.p2.14.m14.5a"><mrow id="S3.p2.14.m14.5.5" xref="S3.p2.14.m14.5.5.cmml"><mrow id="S3.p2.14.m14.5.5.3" xref="S3.p2.14.m14.5.5.3.cmml"><mi id="S3.p2.14.m14.5.5.3.2" xref="S3.p2.14.m14.5.5.3.2.cmml">J</mi><mo lspace="0em" rspace="0em" id="S3.p2.14.m14.5.5.3.1" xref="S3.p2.14.m14.5.5.3.1.cmml">​</mo><mrow id="S3.p2.14.m14.5.5.3.3.2" xref="S3.p2.14.m14.5.5.3.cmml"><mo stretchy="false" id="S3.p2.14.m14.5.5.3.3.2.1" xref="S3.p2.14.m14.5.5.3.cmml">(</mo><mi id="S3.p2.14.m14.4.4" xref="S3.p2.14.m14.4.4.cmml">π</mi><mo stretchy="false" id="S3.p2.14.m14.5.5.3.3.2.2" xref="S3.p2.14.m14.5.5.3.cmml">)</mo></mrow></mrow><mo id="S3.p2.14.m14.5.5.2" xref="S3.p2.14.m14.5.5.2.cmml">=</mo><mrow id="S3.p2.14.m14.5.5.1" xref="S3.p2.14.m14.5.5.1.cmml"><msub id="S3.p2.14.m14.5.5.1.3" xref="S3.p2.14.m14.5.5.1.3.cmml"><mi id="S3.p2.14.m14.5.5.1.3.2" xref="S3.p2.14.m14.5.5.1.3.2.cmml">𝔼</mi><mrow id="S3.p2.14.m14.3.3.3.5" xref="S3.p2.14.m14.3.3.3.4.cmml"><mi id="S3.p2.14.m14.1.1.1.1" xref="S3.p2.14.m14.1.1.1.1.cmml">π</mi><mo id="S3.p2.14.m14.3.3.3.5.1" xref="S3.p2.14.m14.3.3.3.4.cmml">,</mo><mi id="S3.p2.14.m14.2.2.2.2" xref="S3.p2.14.m14.2.2.2.2.cmml">P</mi><mo id="S3.p2.14.m14.3.3.3.5.2" xref="S3.p2.14.m14.3.3.3.4.cmml">,</mo><mi id="S3.p2.14.m14.3.3.3.3" xref="S3.p2.14.m14.3.3.3.3.cmml">μ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.p2.14.m14.5.5.1.2" xref="S3.p2.14.m14.5.5.1.2.cmml">​</mo><mrow id="S3.p2.14.m14.5.5.1.1.1" xref="S3.p2.14.m14.5.5.1.1.2.cmml"><mo id="S3.p2.14.m14.5.5.1.1.1.2" xref="S3.p2.14.m14.5.5.1.1.2.1.cmml">[</mo><mrow id="S3.p2.14.m14.5.5.1.1.1.1" xref="S3.p2.14.m14.5.5.1.1.1.1.cmml"><msubsup id="S3.p2.14.m14.5.5.1.1.1.1.3" xref="S3.p2.14.m14.5.5.1.1.1.1.3.cmml"><mo lspace="0em" id="S3.p2.14.m14.5.5.1.1.1.1.3.2.2" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.cmml"><mi id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.2" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.1" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.3" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi mathvariant="normal" id="S3.p2.14.m14.5.5.1.1.1.1.3.3" xref="S3.p2.14.m14.5.5.1.1.1.1.3.3.cmml">∞</mi></msubsup><mrow id="S3.p2.14.m14.5.5.1.1.1.1.2" xref="S3.p2.14.m14.5.5.1.1.1.1.2.cmml"><msup id="S3.p2.14.m14.5.5.1.1.1.1.2.4" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4.cmml"><mi id="S3.p2.14.m14.5.5.1.1.1.1.2.4.2" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4.2.cmml">γ</mi><mi id="S3.p2.14.m14.5.5.1.1.1.1.2.4.3" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S3.p2.14.m14.5.5.1.1.1.1.2.3" xref="S3.p2.14.m14.5.5.1.1.1.1.2.3.cmml">​</mo><mi id="S3.p2.14.m14.5.5.1.1.1.1.2.5" xref="S3.p2.14.m14.5.5.1.1.1.1.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.p2.14.m14.5.5.1.1.1.1.2.3a" xref="S3.p2.14.m14.5.5.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.3" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.2" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.3" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.4" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.cmml"><mi id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.2" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.3" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.5" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.p2.14.m14.5.5.1.1.1.3" xref="S3.p2.14.m14.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.14.m14.5b"><apply id="S3.p2.14.m14.5.5.cmml" xref="S3.p2.14.m14.5.5"><eq id="S3.p2.14.m14.5.5.2.cmml" xref="S3.p2.14.m14.5.5.2"></eq><apply id="S3.p2.14.m14.5.5.3.cmml" xref="S3.p2.14.m14.5.5.3"><times id="S3.p2.14.m14.5.5.3.1.cmml" xref="S3.p2.14.m14.5.5.3.1"></times><ci id="S3.p2.14.m14.5.5.3.2.cmml" xref="S3.p2.14.m14.5.5.3.2">𝐽</ci><ci id="S3.p2.14.m14.4.4.cmml" xref="S3.p2.14.m14.4.4">𝜋</ci></apply><apply id="S3.p2.14.m14.5.5.1.cmml" xref="S3.p2.14.m14.5.5.1"><times id="S3.p2.14.m14.5.5.1.2.cmml" xref="S3.p2.14.m14.5.5.1.2"></times><apply id="S3.p2.14.m14.5.5.1.3.cmml" xref="S3.p2.14.m14.5.5.1.3"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.3.1.cmml" xref="S3.p2.14.m14.5.5.1.3">subscript</csymbol><ci id="S3.p2.14.m14.5.5.1.3.2.cmml" xref="S3.p2.14.m14.5.5.1.3.2">𝔼</ci><list id="S3.p2.14.m14.3.3.3.4.cmml" xref="S3.p2.14.m14.3.3.3.5"><ci id="S3.p2.14.m14.1.1.1.1.cmml" xref="S3.p2.14.m14.1.1.1.1">𝜋</ci><ci id="S3.p2.14.m14.2.2.2.2.cmml" xref="S3.p2.14.m14.2.2.2.2">𝑃</ci><ci id="S3.p2.14.m14.3.3.3.3.cmml" xref="S3.p2.14.m14.3.3.3.3">𝜇</ci></list></apply><apply id="S3.p2.14.m14.5.5.1.1.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1"><csymbol cd="latexml" id="S3.p2.14.m14.5.5.1.1.2.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.p2.14.m14.5.5.1.1.1.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1"><apply id="S3.p2.14.m14.5.5.1.1.1.1.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.1.1.1.3.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3">superscript</csymbol><apply id="S3.p2.14.m14.5.5.1.1.1.1.3.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.1.1.1.3.2.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3">subscript</csymbol><sum id="S3.p2.14.m14.5.5.1.1.1.1.3.2.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.2"></sum><apply id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3"><eq id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.1"></eq><ci id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S3.p2.14.m14.5.5.1.1.1.1.3.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.3.3"></infinity></apply><apply id="S3.p2.14.m14.5.5.1.1.1.1.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2"><times id="S3.p2.14.m14.5.5.1.1.1.1.2.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.3"></times><apply id="S3.p2.14.m14.5.5.1.1.1.1.2.4.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.1.1.1.2.4.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4">superscript</csymbol><ci id="S3.p2.14.m14.5.5.1.1.1.1.2.4.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4.2">𝛾</ci><ci id="S3.p2.14.m14.5.5.1.1.1.1.2.4.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.4.3">𝑡</ci></apply><ci id="S3.p2.14.m14.5.5.1.1.1.1.2.5.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.5">𝑅</ci><interval closure="open" id="S3.p2.14.m14.5.5.1.1.1.1.2.2.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2"><apply id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.1.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.2.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.3.cmml" xref="S3.p2.14.m14.5.5.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m14.5c">J(\pi)=\mathbb{E}_{\pi,P,\mu}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})\right]</annotation></semantics></math>, which is the expected cumulative discounted reward obtained by executing policy <math id="S3.p2.15.m15.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p2.15.m15.1a"><mi id="S3.p2.15.m15.1.1" xref="S3.p2.15.m15.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.15.m15.1b"><ci id="S3.p2.15.m15.1.1.cmml" xref="S3.p2.15.m15.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m15.1c">\pi</annotation></semantics></math>. The state-action value function (or Q function) of a policy <math id="S3.p2.16.m16.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p2.16.m16.1a"><mi id="S3.p2.16.m16.1.1" xref="S3.p2.16.m16.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.16.m16.1b"><ci id="S3.p2.16.m16.1.1.cmml" xref="S3.p2.16.m16.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m16.1c">\pi</annotation></semantics></math> at state <math id="S3.p2.17.m17.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.p2.17.m17.1a"><mi id="S3.p2.17.m17.1.1" xref="S3.p2.17.m17.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p2.17.m17.1b"><ci id="S3.p2.17.m17.1.1.cmml" xref="S3.p2.17.m17.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m17.1c">s</annotation></semantics></math> and executing action <math id="S3.p2.18.m18.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.p2.18.m18.1a"><mi id="S3.p2.18.m18.1.1" xref="S3.p2.18.m18.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.p2.18.m18.1b"><ci id="S3.p2.18.m18.1.1.cmml" xref="S3.p2.18.m18.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m18.1c">a</annotation></semantics></math> is the expected cumulative discounted reward obtained by taking action <math id="S3.p2.19.m19.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.p2.19.m19.1a"><mi id="S3.p2.19.m19.1.1" xref="S3.p2.19.m19.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.p2.19.m19.1b"><ci id="S3.p2.19.m19.1.1.cmml" xref="S3.p2.19.m19.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.19.m19.1c">a</annotation></semantics></math> in state <math id="S3.p2.20.m20.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.p2.20.m20.1a"><mi id="S3.p2.20.m20.1.1" xref="S3.p2.20.m20.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p2.20.m20.1b"><ci id="S3.p2.20.m20.1.1.cmml" xref="S3.p2.20.m20.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.20.m20.1c">s</annotation></semantics></math> and following policy <math id="S3.p2.21.m21.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p2.21.m21.1a"><mi id="S3.p2.21.m21.1.1" xref="S3.p2.21.m21.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.21.m21.1b"><ci id="S3.p2.21.m21.1.1.cmml" xref="S3.p2.21.m21.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.21.m21.1c">\pi</annotation></semantics></math> thereafter: <math id="S3.p2.22.m22.5" class="ltx_Math" alttext="Q^{\pi}(s,a)=\mathbb{E}_{\pi,P}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})|s_{0}=s,a_{0}=a\right]" display="inline"><semantics id="S3.p2.22.m22.5a"><mrow id="S3.p2.22.m22.5.5" xref="S3.p2.22.m22.5.5.cmml"><mrow id="S3.p2.22.m22.5.5.3" xref="S3.p2.22.m22.5.5.3.cmml"><msup id="S3.p2.22.m22.5.5.3.2" xref="S3.p2.22.m22.5.5.3.2.cmml"><mi id="S3.p2.22.m22.5.5.3.2.2" xref="S3.p2.22.m22.5.5.3.2.2.cmml">Q</mi><mi id="S3.p2.22.m22.5.5.3.2.3" xref="S3.p2.22.m22.5.5.3.2.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S3.p2.22.m22.5.5.3.1" xref="S3.p2.22.m22.5.5.3.1.cmml">​</mo><mrow id="S3.p2.22.m22.5.5.3.3.2" xref="S3.p2.22.m22.5.5.3.3.1.cmml"><mo stretchy="false" id="S3.p2.22.m22.5.5.3.3.2.1" xref="S3.p2.22.m22.5.5.3.3.1.cmml">(</mo><mi id="S3.p2.22.m22.3.3" xref="S3.p2.22.m22.3.3.cmml">s</mi><mo id="S3.p2.22.m22.5.5.3.3.2.2" xref="S3.p2.22.m22.5.5.3.3.1.cmml">,</mo><mi id="S3.p2.22.m22.4.4" xref="S3.p2.22.m22.4.4.cmml">a</mi><mo stretchy="false" id="S3.p2.22.m22.5.5.3.3.2.3" xref="S3.p2.22.m22.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.22.m22.5.5.2" xref="S3.p2.22.m22.5.5.2.cmml">=</mo><mrow id="S3.p2.22.m22.5.5.1" xref="S3.p2.22.m22.5.5.1.cmml"><msub id="S3.p2.22.m22.5.5.1.3" xref="S3.p2.22.m22.5.5.1.3.cmml"><mi id="S3.p2.22.m22.5.5.1.3.2" xref="S3.p2.22.m22.5.5.1.3.2.cmml">𝔼</mi><mrow id="S3.p2.22.m22.2.2.2.4" xref="S3.p2.22.m22.2.2.2.3.cmml"><mi id="S3.p2.22.m22.1.1.1.1" xref="S3.p2.22.m22.1.1.1.1.cmml">π</mi><mo id="S3.p2.22.m22.2.2.2.4.1" xref="S3.p2.22.m22.2.2.2.3.cmml">,</mo><mi id="S3.p2.22.m22.2.2.2.2" xref="S3.p2.22.m22.2.2.2.2.cmml">P</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.p2.22.m22.5.5.1.2" xref="S3.p2.22.m22.5.5.1.2.cmml">​</mo><mrow id="S3.p2.22.m22.5.5.1.1.1" xref="S3.p2.22.m22.5.5.1.1.2.cmml"><mo id="S3.p2.22.m22.5.5.1.1.1.2" xref="S3.p2.22.m22.5.5.1.1.2.1.cmml">[</mo><mrow id="S3.p2.22.m22.5.5.1.1.1.1.2" xref="S3.p2.22.m22.5.5.1.1.1.1.3.cmml"><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.cmml"><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.cmml"><msubsup id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.cmml"><mo lspace="0em" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.3.cmml">0</mn></mrow><mi mathvariant="normal" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.3.cmml">∞</mi></msubsup><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.cmml"><msup id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.2.cmml">γ</mi><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.5" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3a" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.4" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">a</mi><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.5" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo fence="false" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.3.cmml">|</mo><msub id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.2" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.2.cmml">s</mi><mn id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.3.cmml">0</mn></msub></mrow><mo id="S3.p2.22.m22.5.5.1.1.1.1.1.1.3" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.3.cmml">=</mo><mi id="S3.p2.22.m22.5.5.1.1.1.1.1.1.4" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S3.p2.22.m22.5.5.1.1.1.1.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.3a.cmml">,</mo><mrow id="S3.p2.22.m22.5.5.1.1.1.1.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.cmml"><msub id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.cmml"><mi id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.2" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.2.cmml">a</mi><mn id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.3.cmml">0</mn></msub><mo id="S3.p2.22.m22.5.5.1.1.1.1.2.2.1" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.1.cmml">=</mo><mi id="S3.p2.22.m22.5.5.1.1.1.1.2.2.3" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.3.cmml">a</mi></mrow></mrow><mo id="S3.p2.22.m22.5.5.1.1.1.3" xref="S3.p2.22.m22.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.22.m22.5b"><apply id="S3.p2.22.m22.5.5.cmml" xref="S3.p2.22.m22.5.5"><eq id="S3.p2.22.m22.5.5.2.cmml" xref="S3.p2.22.m22.5.5.2"></eq><apply id="S3.p2.22.m22.5.5.3.cmml" xref="S3.p2.22.m22.5.5.3"><times id="S3.p2.22.m22.5.5.3.1.cmml" xref="S3.p2.22.m22.5.5.3.1"></times><apply id="S3.p2.22.m22.5.5.3.2.cmml" xref="S3.p2.22.m22.5.5.3.2"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.3.2.1.cmml" xref="S3.p2.22.m22.5.5.3.2">superscript</csymbol><ci id="S3.p2.22.m22.5.5.3.2.2.cmml" xref="S3.p2.22.m22.5.5.3.2.2">𝑄</ci><ci id="S3.p2.22.m22.5.5.3.2.3.cmml" xref="S3.p2.22.m22.5.5.3.2.3">𝜋</ci></apply><interval closure="open" id="S3.p2.22.m22.5.5.3.3.1.cmml" xref="S3.p2.22.m22.5.5.3.3.2"><ci id="S3.p2.22.m22.3.3.cmml" xref="S3.p2.22.m22.3.3">𝑠</ci><ci id="S3.p2.22.m22.4.4.cmml" xref="S3.p2.22.m22.4.4">𝑎</ci></interval></apply><apply id="S3.p2.22.m22.5.5.1.cmml" xref="S3.p2.22.m22.5.5.1"><times id="S3.p2.22.m22.5.5.1.2.cmml" xref="S3.p2.22.m22.5.5.1.2"></times><apply id="S3.p2.22.m22.5.5.1.3.cmml" xref="S3.p2.22.m22.5.5.1.3"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.3.1.cmml" xref="S3.p2.22.m22.5.5.1.3">subscript</csymbol><ci id="S3.p2.22.m22.5.5.1.3.2.cmml" xref="S3.p2.22.m22.5.5.1.3.2">𝔼</ci><list id="S3.p2.22.m22.2.2.2.3.cmml" xref="S3.p2.22.m22.2.2.2.4"><ci id="S3.p2.22.m22.1.1.1.1.cmml" xref="S3.p2.22.m22.1.1.1.1">𝜋</ci><ci id="S3.p2.22.m22.2.2.2.2.cmml" xref="S3.p2.22.m22.2.2.2.2">𝑃</ci></list></apply><apply id="S3.p2.22.m22.5.5.1.1.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1"><csymbol cd="latexml" id="S3.p2.22.m22.5.5.1.1.2.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.p2.22.m22.5.5.1.1.1.1.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.3a.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1"><eq id="S3.p2.22.m22.5.5.1.1.1.1.1.1.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.3"></eq><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2"><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.2.3.3">0</cn></apply></apply><infinity id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.3.3"></infinity></apply><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2"><times id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.3"></times><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4">superscript</csymbol><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.2">𝛾</ci><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.4.3">𝑡</ci></apply><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.5.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.5">𝑅</ci><interval closure="open" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2"><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.2">𝑎</ci><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.2">𝑠</ci><cn type="integer" id="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.2.4.3">0</cn></apply></apply><ci id="S3.p2.22.m22.5.5.1.1.1.1.1.1.4.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.1.1.4">𝑠</ci></apply><apply id="S3.p2.22.m22.5.5.1.1.1.1.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2"><eq id="S3.p2.22.m22.5.5.1.1.1.1.2.2.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.1"></eq><apply id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.2">𝑎</ci><cn type="integer" id="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.2.3">0</cn></apply><ci id="S3.p2.22.m22.5.5.1.1.1.1.2.2.3.cmml" xref="S3.p2.22.m22.5.5.1.1.1.1.2.2.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.22.m22.5c">Q^{\pi}(s,a)=\mathbb{E}_{\pi,P}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})|s_{0}=s,a_{0}=a\right]</annotation></semantics></math>.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.4" class="ltx_p"><span id="S3.p3.4.1" class="ltx_text ltx_font_bold">Offline Reinforcement Learning:</span> The goal of offline RL is to learn a policy <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\pi</annotation></semantics></math> only using a static dataset <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathcal{D}</annotation></semantics></math> of transitions <math id="S3.p3.3.m3.4" class="ltx_Math" alttext="(s,a,r,s^{\prime})" display="inline"><semantics id="S3.p3.3.m3.4a"><mrow id="S3.p3.3.m3.4.4.1" xref="S3.p3.3.m3.4.4.2.cmml"><mo stretchy="false" id="S3.p3.3.m3.4.4.1.2" xref="S3.p3.3.m3.4.4.2.cmml">(</mo><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">s</mi><mo id="S3.p3.3.m3.4.4.1.3" xref="S3.p3.3.m3.4.4.2.cmml">,</mo><mi id="S3.p3.3.m3.2.2" xref="S3.p3.3.m3.2.2.cmml">a</mi><mo id="S3.p3.3.m3.4.4.1.4" xref="S3.p3.3.m3.4.4.2.cmml">,</mo><mi id="S3.p3.3.m3.3.3" xref="S3.p3.3.m3.3.3.cmml">r</mi><mo id="S3.p3.3.m3.4.4.1.5" xref="S3.p3.3.m3.4.4.2.cmml">,</mo><msup id="S3.p3.3.m3.4.4.1.1" xref="S3.p3.3.m3.4.4.1.1.cmml"><mi id="S3.p3.3.m3.4.4.1.1.2" xref="S3.p3.3.m3.4.4.1.1.2.cmml">s</mi><mo id="S3.p3.3.m3.4.4.1.1.3" xref="S3.p3.3.m3.4.4.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.p3.3.m3.4.4.1.6" xref="S3.p3.3.m3.4.4.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.4b"><vector id="S3.p3.3.m3.4.4.2.cmml" xref="S3.p3.3.m3.4.4.1"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝑠</ci><ci id="S3.p3.3.m3.2.2.cmml" xref="S3.p3.3.m3.2.2">𝑎</ci><ci id="S3.p3.3.m3.3.3.cmml" xref="S3.p3.3.m3.3.3">𝑟</ci><apply id="S3.p3.3.m3.4.4.1.1.cmml" xref="S3.p3.3.m3.4.4.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.4.4.1.1.1.cmml" xref="S3.p3.3.m3.4.4.1.1">superscript</csymbol><ci id="S3.p3.3.m3.4.4.1.1.2.cmml" xref="S3.p3.3.m3.4.4.1.1.2">𝑠</ci><ci id="S3.p3.3.m3.4.4.1.1.3.cmml" xref="S3.p3.3.m3.4.4.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.4c">(s,a,r,s^{\prime})</annotation></semantics></math> collected using a behavior policy <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="\pi_{\mathrm{b}}" display="inline"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">π</mi><mi mathvariant="normal" id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝜋</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">b</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\pi_{\mathrm{b}}</annotation></semantics></math> without any additional interactions with the environment. Offline RL algorithms typically aim to learn a policy that maximizes the value, with some kind of regularization with respect to the behavior policy to ensure that the learned policy does not deviate from the behavior policy. This regularization is done to prevent distribution shift, a significant problem in offline RL, where the difference between the learned policy and behavior policy can lead to erroneous Q-value estimation of state-action pairs not seen in the dataset <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a href="#bib.bib16" title="" class="ltx_ref">2020</a>; Levine et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.2" class="ltx_p">In this work, we use TD3-BC <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto &amp; Gu, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> as our candidate offline RL algorithm for federation. Our choice is motivated by the simplicity of the TD3-BC approach and its superior empirical performance in benchmark problems. The TD3-BC algorithm is a behavior cloning (BC) regularized version of the TD3 algorithm <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto et al., <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>. The policy in TD3-BC is updated using a linear combination of TD3 objective and behavior cloning loss, where the TD3 objective ensures policy improvement and the BC loss prevents distribution shift. More precisely, the TD3-BC objective can be written as</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\pi" display="inline"><semantics id="S3.E3.m1.1a"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\pi</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.2" class="ltx_Math" alttext="\displaystyle=\operatorname*{arg\,max}_{\pi}\leavevmode\nobreak\ U_{\mathcal{D}}(\pi)," display="inline"><semantics id="S3.E3.m2.2a"><mrow id="S3.E3.m2.2.2.1" xref="S3.E3.m2.2.2.1.1.cmml"><mrow id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.cmml"><mi id="S3.E3.m2.2.2.1.1.2" xref="S3.E3.m2.2.2.1.1.2.cmml"></mi><mo id="S3.E3.m2.2.2.1.1.1" xref="S3.E3.m2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3.m2.2.2.1.1.3" xref="S3.E3.m2.2.2.1.1.3.cmml"><mrow id="S3.E3.m2.2.2.1.1.3.2" xref="S3.E3.m2.2.2.1.1.3.2.cmml"><munder id="S3.E3.m2.2.2.1.1.3.2.1" xref="S3.E3.m2.2.2.1.1.3.2.1.cmml"><mrow id="S3.E3.m2.2.2.1.1.3.2.1.2" xref="S3.E3.m2.2.2.1.1.3.2.1.2.cmml"><mi id="S3.E3.m2.2.2.1.1.3.2.1.2.2" xref="S3.E3.m2.2.2.1.1.3.2.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E3.m2.2.2.1.1.3.2.1.2.1" xref="S3.E3.m2.2.2.1.1.3.2.1.2.1.cmml">​</mo><mi id="S3.E3.m2.2.2.1.1.3.2.1.2.3" xref="S3.E3.m2.2.2.1.1.3.2.1.2.3.cmml">max</mi></mrow><mi id="S3.E3.m2.2.2.1.1.3.2.1.3" xref="S3.E3.m2.2.2.1.1.3.2.1.3.cmml">π</mi></munder><mo id="S3.E3.m2.2.2.1.1.3.2a" xref="S3.E3.m2.2.2.1.1.3.2.cmml">⁡</mo><msub id="S3.E3.m2.2.2.1.1.3.2.2" xref="S3.E3.m2.2.2.1.1.3.2.2.cmml"><mi id="S3.E3.m2.2.2.1.1.3.2.2.2" xref="S3.E3.m2.2.2.1.1.3.2.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.2.2.1.1.3.2.2.3" xref="S3.E3.m2.2.2.1.1.3.2.2.3.cmml">𝒟</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.1.3.1" xref="S3.E3.m2.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m2.2.2.1.1.3.3.2" xref="S3.E3.m2.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m2.2.2.1.1.3.3.2.1" xref="S3.E3.m2.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">π</mi><mo stretchy="false" id="S3.E3.m2.2.2.1.1.3.3.2.2" xref="S3.E3.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m2.2.2.1.2" xref="S3.E3.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.2b"><apply id="S3.E3.m2.2.2.1.1.cmml" xref="S3.E3.m2.2.2.1"><eq id="S3.E3.m2.2.2.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S3.E3.m2.2.2.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.2">absent</csymbol><apply id="S3.E3.m2.2.2.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.3"><times id="S3.E3.m2.2.2.1.1.3.1.cmml" xref="S3.E3.m2.2.2.1.1.3.1"></times><apply id="S3.E3.m2.2.2.1.1.3.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2"><apply id="S3.E3.m2.2.2.1.1.3.2.1.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.3.2.1.1.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1">subscript</csymbol><apply id="S3.E3.m2.2.2.1.1.3.2.1.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1.2"><times id="S3.E3.m2.2.2.1.1.3.2.1.2.1.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1.2.1"></times><ci id="S3.E3.m2.2.2.1.1.3.2.1.2.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1.2.2">arg</ci><ci id="S3.E3.m2.2.2.1.1.3.2.1.2.3.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1.2.3">max</ci></apply><ci id="S3.E3.m2.2.2.1.1.3.2.1.3.cmml" xref="S3.E3.m2.2.2.1.1.3.2.1.3">𝜋</ci></apply><apply id="S3.E3.m2.2.2.1.1.3.2.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.3.2.2.1.cmml" xref="S3.E3.m2.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.3.2.2.2.cmml" xref="S3.E3.m2.2.2.1.1.3.2.2.2">𝑈</ci><ci id="S3.E3.m2.2.2.1.1.3.2.2.3.cmml" xref="S3.E3.m2.2.2.1.1.3.2.2.3">𝒟</ci></apply></apply><ci id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1">𝜋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.2c">\displaystyle=\operatorname*{arg\,max}_{\pi}\leavevmode\nobreak\ U_{\mathcal{D}}(\pi),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\displaystyle\text{where}\quad U_{\mathcal{D}}(\pi)" display="inline"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.2.cmml"><mtext id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2a.cmml">where</mtext><mspace width="1em" id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.2.cmml"></mspace><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml">U</mi><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.1" xref="S3.E4.m1.3.3.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">π</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><list id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.1"><ci id="S3.E4.m1.2.2a.cmml" xref="S3.E4.m1.2.2"><mtext id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">where</mtext></ci><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1"><times id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"></times><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2">𝑈</ci><ci id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3">𝒟</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝜋</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\text{where}\quad U_{\mathcal{D}}(\pi)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.6" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{s,a\sim\mathcal{D}}\left[\lambda Q^{\pi}(s,\pi(s))-(\pi(s)-a)^{2}\right]," display="inline"><semantics id="S3.E4.m2.6a"><mrow id="S3.E4.m2.6.6.1" xref="S3.E4.m2.6.6.1.1.cmml"><mrow id="S3.E4.m2.6.6.1.1" xref="S3.E4.m2.6.6.1.1.cmml"><mi id="S3.E4.m2.6.6.1.1.3" xref="S3.E4.m2.6.6.1.1.3.cmml"></mi><mo id="S3.E4.m2.6.6.1.1.2" xref="S3.E4.m2.6.6.1.1.2.cmml">=</mo><mrow id="S3.E4.m2.6.6.1.1.1" xref="S3.E4.m2.6.6.1.1.1.cmml"><msub id="S3.E4.m2.6.6.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.3.cmml"><mi id="S3.E4.m2.6.6.1.1.1.3.2" xref="S3.E4.m2.6.6.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E4.m2.2.2.2" xref="S3.E4.m2.2.2.2.cmml"><mrow id="S3.E4.m2.2.2.2.4.2" xref="S3.E4.m2.2.2.2.4.1.cmml"><mi id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.1.cmml">s</mi><mo id="S3.E4.m2.2.2.2.4.2.1" xref="S3.E4.m2.2.2.2.4.1.cmml">,</mo><mi id="S3.E4.m2.2.2.2.2" xref="S3.E4.m2.2.2.2.2.cmml">a</mi></mrow><mo id="S3.E4.m2.2.2.2.3" xref="S3.E4.m2.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m2.2.2.2.5" xref="S3.E4.m2.2.2.2.5.cmml">𝒟</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m2.6.6.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.2.cmml"><mo id="S3.E4.m2.6.6.1.1.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.2.cmml">Q</mi><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.2a" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m2.4.4" xref="S3.E4.m2.4.4.cmml">s</mi><mo id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m2.3.3" xref="S3.E4.m2.3.3.cmml">s</mi><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m2.6.6.1.1.1.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.3.cmml">−</mo><msup id="S3.E4.m2.6.6.1.1.1.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.cmml"><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.1.cmml">​</mo><mrow id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.3.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.3.2.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.cmml">(</mo><mi id="S3.E4.m2.5.5" xref="S3.E4.m2.5.5.cmml">s</mi><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.3.2.2" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mi id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.3.cmml">a</mi></mrow><mo stretchy="false" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m2.6.6.1.1.1.1.1.1.2.3" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S3.E4.m2.6.6.1.1.1.1.1.3" xref="S3.E4.m2.6.6.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m2.6.6.1.2" xref="S3.E4.m2.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.6b"><apply id="S3.E4.m2.6.6.1.1.cmml" xref="S3.E4.m2.6.6.1"><eq id="S3.E4.m2.6.6.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.2"></eq><csymbol cd="latexml" id="S3.E4.m2.6.6.1.1.3.cmml" xref="S3.E4.m2.6.6.1.1.3">absent</csymbol><apply id="S3.E4.m2.6.6.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1"><times id="S3.E4.m2.6.6.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.2"></times><apply id="S3.E4.m2.6.6.1.1.1.3.cmml" xref="S3.E4.m2.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.6.6.1.1.1.3.1.cmml" xref="S3.E4.m2.6.6.1.1.1.3">subscript</csymbol><ci id="S3.E4.m2.6.6.1.1.1.3.2.cmml" xref="S3.E4.m2.6.6.1.1.1.3.2">𝔼</ci><apply id="S3.E4.m2.2.2.2.cmml" xref="S3.E4.m2.2.2.2"><csymbol cd="latexml" id="S3.E4.m2.2.2.2.3.cmml" xref="S3.E4.m2.2.2.2.3">similar-to</csymbol><list id="S3.E4.m2.2.2.2.4.1.cmml" xref="S3.E4.m2.2.2.2.4.2"><ci id="S3.E4.m2.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1">𝑠</ci><ci id="S3.E4.m2.2.2.2.2.cmml" xref="S3.E4.m2.2.2.2.2">𝑎</ci></list><ci id="S3.E4.m2.2.2.2.5.cmml" xref="S3.E4.m2.2.2.2.5">𝒟</ci></apply></apply><apply id="S3.E4.m2.6.6.1.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m2.6.6.1.1.1.1.2.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1"><minus id="S3.E4.m2.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.3"></minus><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1"><times id="S3.E4.m2.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.3">𝜆</ci><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.2">𝑄</ci><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.4.3">𝜋</ci></apply><interval closure="open" id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1"><ci id="S3.E4.m2.4.4.cmml" xref="S3.E4.m2.4.4">𝑠</ci><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E4.m2.3.3.cmml" xref="S3.E4.m2.3.3">𝑠</ci></apply></interval></apply><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1"><minus id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.1"></minus><apply id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2"><times id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.1"></times><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.2.2">𝜋</ci><ci id="S3.E4.m2.5.5.cmml" xref="S3.E4.m2.5.5">𝑠</ci></apply><ci id="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><cn type="integer" id="S3.E4.m2.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.6.6.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.6c">\displaystyle=\mathbb{E}_{s,a\sim\mathcal{D}}\left[\lambda Q^{\pi}(s,\pi(s))-(\pi(s)-a)^{2}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.1" class="ltx_p">and <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter that determines the relative weight of the BC term.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Federated Offline Reinforcement Learning</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.8" class="ltx_p">In real-world offline RL applications, the data is typically obtained from the operational policies of multiple agents (clients) with different levels of expertise. Often, clients prefer to keep their operational data local without sharing it with others. A federated offline RL algorithm aims to learn the optimal policy for the underlying RL problem using the available offline data without the clients sharing their data with one another or the server. We denote the set of clients as <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\mathcal{N}</annotation></semantics></math>. Each client <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="i\in\mathcal{N}" display="inline"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">i</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><in id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></in><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑖</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">i\in\mathcal{N}</annotation></semantics></math> has the offline dataset <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}=\{(s_{j},a_{j},r_{j},s^{\prime}_{j})^{m_{i}}_{j=1}\}" display="inline"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><msub id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.3.m3.1.1.3.2" xref="S4.p1.3.m3.1.1.3.2.cmml">𝒟</mi><mi id="S4.p1.3.m3.1.1.3.3" xref="S4.p1.3.m3.1.1.3.3.cmml">i</mi></msub><mo id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S4.p1.3.m3.1.1.1.1" xref="S4.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S4.p1.3.m3.1.1.1.1.2" xref="S4.p1.3.m3.1.1.1.2.cmml">{</mo><msubsup id="S4.p1.3.m3.1.1.1.1.1" xref="S4.p1.3.m3.1.1.1.1.1.cmml"><mrow id="S4.p1.3.m3.1.1.1.1.1.4.4.4" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml"><mo stretchy="false" id="S4.p1.3.m3.1.1.1.1.1.4.4.4.5" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml">(</mo><msub id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.p1.3.m3.1.1.1.1.1.4.4.4.6" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.2" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.3" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.p1.3.m3.1.1.1.1.1.4.4.4.7" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.2" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.2.cmml">r</mi><mi id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.3" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.3.cmml">j</mi></msub><mo id="S4.p1.3.m3.1.1.1.1.1.4.4.4.8" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml">,</mo><msubsup id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.2" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.2.cmml">s</mi><mi id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.3" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.3.cmml">j</mi><mo id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.3" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.p1.3.m3.1.1.1.1.1.4.4.4.9" xref="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml">)</mo></mrow><mrow id="S4.p1.3.m3.1.1.1.1.1.6" xref="S4.p1.3.m3.1.1.1.1.1.6.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.6.2" xref="S4.p1.3.m3.1.1.1.1.1.6.2.cmml">j</mi><mo id="S4.p1.3.m3.1.1.1.1.1.6.1" xref="S4.p1.3.m3.1.1.1.1.1.6.1.cmml">=</mo><mn id="S4.p1.3.m3.1.1.1.1.1.6.3" xref="S4.p1.3.m3.1.1.1.1.1.6.3.cmml">1</mn></mrow><msub id="S4.p1.3.m3.1.1.1.1.1.4.6" xref="S4.p1.3.m3.1.1.1.1.1.4.6.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.4.6.2" xref="S4.p1.3.m3.1.1.1.1.1.4.6.2.cmml">m</mi><mi id="S4.p1.3.m3.1.1.1.1.1.4.6.3" xref="S4.p1.3.m3.1.1.1.1.1.4.6.3.cmml">i</mi></msub></msubsup><mo stretchy="false" id="S4.p1.3.m3.1.1.1.1.3" xref="S4.p1.3.m3.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><eq id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2"></eq><apply id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.3.1.cmml" xref="S4.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.p1.3.m3.1.1.3.2.cmml" xref="S4.p1.3.m3.1.1.3.2">𝒟</ci><ci id="S4.p1.3.m3.1.1.3.3.cmml" xref="S4.p1.3.m3.1.1.3.3">𝑖</ci></apply><set id="S4.p1.3.m3.1.1.1.2.cmml" xref="S4.p1.3.m3.1.1.1.1"><apply id="S4.p1.3.m3.1.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.5.cmml" xref="S4.p1.3.m3.1.1.1.1.1">subscript</csymbol><apply id="S4.p1.3.m3.1.1.1.1.1.4.cmml" xref="S4.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.4.5.cmml" xref="S4.p1.3.m3.1.1.1.1.1">superscript</csymbol><vector id="S4.p1.3.m3.1.1.1.1.1.4.4.5.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4"><apply id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply><apply id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.2">𝑟</ci><ci id="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.3.3.3.3.3">𝑗</ci></apply><apply id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4">subscript</csymbol><apply id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4">superscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.2">𝑠</ci><ci id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.2.3">′</ci></apply><ci id="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.4.4.4.3">𝑗</ci></apply></vector><apply id="S4.p1.3.m3.1.1.1.1.1.4.6.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.4.6.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.6">subscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.4.6.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.6.2">𝑚</ci><ci id="S4.p1.3.m3.1.1.1.1.1.4.6.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.4.6.3">𝑖</ci></apply></apply><apply id="S4.p1.3.m3.1.1.1.1.1.6.cmml" xref="S4.p1.3.m3.1.1.1.1.1.6"><eq id="S4.p1.3.m3.1.1.1.1.1.6.1.cmml" xref="S4.p1.3.m3.1.1.1.1.1.6.1"></eq><ci id="S4.p1.3.m3.1.1.1.1.1.6.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.6.2">𝑗</ci><cn type="integer" id="S4.p1.3.m3.1.1.1.1.1.6.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.6.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\mathcal{D}_{i}=\{(s_{j},a_{j},r_{j},s^{\prime}_{j})^{m_{i}}_{j=1}\}</annotation></semantics></math> generated according to a behavior policy <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="\pi^{b}_{i}" display="inline"><semantics id="S4.p1.4.m4.1a"><msubsup id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mi id="S4.p1.4.m4.1.1.2.2" xref="S4.p1.4.m4.1.1.2.2.cmml">π</mi><mi id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">i</mi><mi id="S4.p1.4.m4.1.1.2.3" xref="S4.p1.4.m4.1.1.2.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1">subscript</csymbol><apply id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.2.1.cmml" xref="S4.p1.4.m4.1.1">superscript</csymbol><ci id="S4.p1.4.m4.1.1.2.2.cmml" xref="S4.p1.4.m4.1.1.2.2">𝜋</ci><ci id="S4.p1.4.m4.1.1.2.3.cmml" xref="S4.p1.4.m4.1.1.2.3">𝑏</ci></apply><ci id="S4.p1.4.m4.1.1.3.cmml" xref="S4.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">\pi^{b}_{i}</annotation></semantics></math>. We assume that the underlying MDP model <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S4.p1.5.m5.1a"><mi id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><ci id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">P</annotation></semantics></math> and reward function <math id="S4.p1.6.m6.2" class="ltx_Math" alttext="R(\cdot,\cdot)" display="inline"><semantics id="S4.p1.6.m6.2a"><mrow id="S4.p1.6.m6.2.3" xref="S4.p1.6.m6.2.3.cmml"><mi id="S4.p1.6.m6.2.3.2" xref="S4.p1.6.m6.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.p1.6.m6.2.3.1" xref="S4.p1.6.m6.2.3.1.cmml">​</mo><mrow id="S4.p1.6.m6.2.3.3.2" xref="S4.p1.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S4.p1.6.m6.2.3.3.2.1" xref="S4.p1.6.m6.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.p1.6.m6.2.3.3.2.2" xref="S4.p1.6.m6.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.p1.6.m6.2.2" xref="S4.p1.6.m6.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.p1.6.m6.2.3.3.2.3" xref="S4.p1.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.2b"><apply id="S4.p1.6.m6.2.3.cmml" xref="S4.p1.6.m6.2.3"><times id="S4.p1.6.m6.2.3.1.cmml" xref="S4.p1.6.m6.2.3.1"></times><ci id="S4.p1.6.m6.2.3.2.cmml" xref="S4.p1.6.m6.2.3.2">𝑅</ci><interval closure="open" id="S4.p1.6.m6.2.3.3.1.cmml" xref="S4.p1.6.m6.2.3.3.2"><ci id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1">⋅</ci><ci id="S4.p1.6.m6.2.2.cmml" xref="S4.p1.6.m6.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.2c">R(\cdot,\cdot)</annotation></semantics></math> are identical for all the clients, and the statistical differences between the offline datasets <math id="S4.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S4.p1.7.m7.1a"><msub id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.7.m7.1.1.2" xref="S4.p1.7.m7.1.1.2.cmml">𝒟</mi><mi id="S4.p1.7.m7.1.1.3" xref="S4.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><apply id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p1.7.m7.1.1.1.cmml" xref="S4.p1.7.m7.1.1">subscript</csymbol><ci id="S4.p1.7.m7.1.1.2.cmml" xref="S4.p1.7.m7.1.1.2">𝒟</ci><ci id="S4.p1.7.m7.1.1.3.cmml" xref="S4.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">\mathcal{D}_{i}</annotation></semantics></math> are only due to the difference in behavior policies <math id="S4.p1.8.m8.1" class="ltx_Math" alttext="\pi^{b}_{i}" display="inline"><semantics id="S4.p1.8.m8.1a"><msubsup id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml"><mi id="S4.p1.8.m8.1.1.2.2" xref="S4.p1.8.m8.1.1.2.2.cmml">π</mi><mi id="S4.p1.8.m8.1.1.3" xref="S4.p1.8.m8.1.1.3.cmml">i</mi><mi id="S4.p1.8.m8.1.1.2.3" xref="S4.p1.8.m8.1.1.2.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><apply id="S4.p1.8.m8.1.1.cmml" xref="S4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p1.8.m8.1.1.1.cmml" xref="S4.p1.8.m8.1.1">subscript</csymbol><apply id="S4.p1.8.m8.1.1.2.cmml" xref="S4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p1.8.m8.1.1.2.1.cmml" xref="S4.p1.8.m8.1.1">superscript</csymbol><ci id="S4.p1.8.m8.1.1.2.2.cmml" xref="S4.p1.8.m8.1.1.2.2">𝜋</ci><ci id="S4.p1.8.m8.1.1.2.3.cmml" xref="S4.p1.8.m8.1.1.2.3">𝑏</ci></apply><ci id="S4.p1.8.m8.1.1.3.cmml" xref="S4.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">\pi^{b}_{i}</annotation></semantics></math> used for collecting the data.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.2" class="ltx_p">In a standard federated learning algorithm such as FedAvg, each client performs multiple parameter updates before sending its parameters to the server. It is known that performing multiple local updates in federated learning can reduce the communication cost significantly without compromising on the optimality of the converged solution <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. In federated offline RL, since each client has to perform multiple steps of policy evaluation and policy update using its local offline data <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝒟</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathcal{D}_{i}</annotation></semantics></math>, it is reasonable to consider a client objective function that is consistent with a standard offline RL algorithm objective. We choose the objective function used in the TD3-BC algorithm <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto &amp; Gu, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>, i.e., <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="U_{\mathcal{D}_{i}}" display="inline"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">U</mi><msub id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.2.m2.1.1.3.2" xref="S4.p2.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S4.p2.2.m2.1.1.3.3" xref="S4.p2.2.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑈</ci><apply id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.3.1.cmml" xref="S4.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.p2.2.m2.1.1.3.2.cmml" xref="S4.p2.2.m2.1.1.3.2">𝒟</ci><ci id="S4.p2.2.m2.1.1.3.3.cmml" xref="S4.p2.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">U_{\mathcal{D}_{i}}</annotation></semantics></math> given in Eq. (<a href="#S3.E3" title="In 3 Preliminaries ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), as the client objective function. Our choice is motivated by the simplicity of the TD3-BC objective function and its empirical success in a variety of environments. Similar to the standard federated learning objective given in Eq. (<a href="#S3.E1" title="In 3 Preliminaries ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), we can now define the federated offline RL objective as</p>
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\displaystyle U(\pi_{\text{fed}})=\sum_{i=1}^{|\mathcal{N}|}w_{i}U_{\mathcal{D}_{i}}(\pi_{\text{fed}})," display="inline"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.3.cmml">U</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml">π</mi><mtext id="S4.E5.m1.2.2.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3a.cmml">fed</mtext></msub><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.2.2.1.1.3" xref="S4.E5.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.2.2.1.1.2" xref="S4.E5.m1.2.2.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E5.m1.2.2.1.1.2.2" xref="S4.E5.m1.2.2.1.1.2.2.cmml"><munderover id="S4.E5.m1.2.2.1.1.2.2a" xref="S4.E5.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S4.E5.m1.2.2.1.1.2.2.2.2" xref="S4.E5.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.2.2.1.1.2.2.2.3" xref="S4.E5.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S4.E5.m1.2.2.1.1.2.2.2.3.2" xref="S4.E5.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.E5.m1.2.2.1.1.2.2.2.3.1" xref="S4.E5.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.2.2.1.1.2.2.2.3.3" xref="S4.E5.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E5.m1.2.2.1.1.2.1" xref="S4.E5.m1.2.2.1.1.2.1.cmml"><msub id="S4.E5.m1.2.2.1.1.2.1.3" xref="S4.E5.m1.2.2.1.1.2.1.3.cmml"><mi id="S4.E5.m1.2.2.1.1.2.1.3.2" xref="S4.E5.m1.2.2.1.1.2.1.3.2.cmml">w</mi><mi id="S4.E5.m1.2.2.1.1.2.1.3.3" xref="S4.E5.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.2.1.2" xref="S4.E5.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="S4.E5.m1.2.2.1.1.2.1.4" xref="S4.E5.m1.2.2.1.1.2.1.4.cmml"><mi id="S4.E5.m1.2.2.1.1.2.1.4.2" xref="S4.E5.m1.2.2.1.1.2.1.4.2.cmml">U</mi><msub id="S4.E5.m1.2.2.1.1.2.1.4.3" xref="S4.E5.m1.2.2.1.1.2.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.1.2.1.4.3.2" xref="S4.E5.m1.2.2.1.1.2.1.4.3.2.cmml">𝒟</mi><mi id="S4.E5.m1.2.2.1.1.2.1.4.3.3" xref="S4.E5.m1.2.2.1.1.2.1.4.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.2.1.2a" xref="S4.E5.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.2.cmml">π</mi><mtext id="S4.E5.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.3a.cmml">fed</mtext></msub><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.1.1.cmml" xref="S4.E5.m1.2.2.1"><eq id="S4.E5.m1.2.2.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.3"></eq><apply id="S4.E5.m1.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><times id="S4.E5.m1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.2"></times><ci id="S4.E5.m1.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3">𝑈</ci><apply id="S4.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3">fed</mtext></ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2"><apply id="S4.E5.m1.2.2.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S4.E5.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2.2.2"></sum><apply id="S4.E5.m1.2.2.1.1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.2.3"><eq id="S4.E5.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S4.E5.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.3"><abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.3.1"></abs><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝒩</ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1"><times id="S4.E5.m1.2.2.1.1.2.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.2"></times><apply id="S4.E5.m1.2.2.1.1.2.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.3.2">𝑤</ci><ci id="S4.E5.m1.2.2.1.1.2.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S4.E5.m1.2.2.1.1.2.1.4.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.4.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.1.4.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4.2">𝑈</ci><apply id="S4.E5.m1.2.2.1.1.2.1.4.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.4.3.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.1.4.3.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4.3.2">𝒟</ci><ci id="S4.E5.m1.2.2.1.1.2.1.4.3.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.4.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.2">𝜋</ci><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.3a.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.3"><mtext mathsize="70%" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.3">fed</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle U(\pi_{\text{fed}})=\sum_{i=1}^{|\mathcal{N}|}w_{i}U_{\mathcal{D}_{i}}(\pi_{\text{fed}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.3" class="ltx_p">where <math id="S4.p2.3.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.p2.3.m1.1a"><msub id="S4.p2.3.m1.1.1" xref="S4.p2.3.m1.1.1.cmml"><mi id="S4.p2.3.m1.1.1.2" xref="S4.p2.3.m1.1.1.2.cmml">w</mi><mi id="S4.p2.3.m1.1.1.3" xref="S4.p2.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m1.1b"><apply id="S4.p2.3.m1.1.1.cmml" xref="S4.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m1.1.1.1.cmml" xref="S4.p2.3.m1.1.1">subscript</csymbol><ci id="S4.p2.3.m1.1.1.2.cmml" xref="S4.p2.3.m1.1.1.2">𝑤</ci><ci id="S4.p2.3.m1.1.1.3.cmml" xref="S4.p2.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m1.1c">w_{i}</annotation></semantics></math> are weights to be determined.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p">One approach to leveraging experiences across users without sharing data would be to combine existing federated learning techniques with offline RL algorithms. <em id="S4.p3.1.1" class="ltx_emph ltx_font_italic">Is such a naïve federation strategy sufficient to learn an excellent federated policy collaboratively? Furthermore, is federation even necessary?</em> In this section, we aim to understand the challenges of federated offline RL with the goal of designing an algorithmic framework to address these challenges.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.3" class="ltx_p">We start with an example illustrating the issues in designing a federated offline RL algorithm. We consider the Hopper environment from MuJoCo <cite class="ltx_cite ltx_citemacro_citep">(Todorov et al., <a href="#bib.bib27" title="" class="ltx_ref">2012</a>)</cite>, with <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="|\mathcal{N}|=10" display="inline"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.2" xref="S4.p4.1.m1.1.2.cmml"><mrow id="S4.p4.1.m1.1.2.2.2" xref="S4.p4.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="S4.p4.1.m1.1.2.2.2.1" xref="S4.p4.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S4.p4.1.m1.1.2.2.2.2" xref="S4.p4.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.p4.1.m1.1.2.1" xref="S4.p4.1.m1.1.2.1.cmml">=</mo><mn id="S4.p4.1.m1.1.2.3" xref="S4.p4.1.m1.1.2.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.2.cmml" xref="S4.p4.1.m1.1.2"><eq id="S4.p4.1.m1.1.2.1.cmml" xref="S4.p4.1.m1.1.2.1"></eq><apply id="S4.p4.1.m1.1.2.2.1.cmml" xref="S4.p4.1.m1.1.2.2.2"><abs id="S4.p4.1.m1.1.2.2.1.1.cmml" xref="S4.p4.1.m1.1.2.2.2.1"></abs><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝒩</ci></apply><cn type="integer" id="S4.p4.1.m1.1.2.3.cmml" xref="S4.p4.1.m1.1.2.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">|\mathcal{N}|=10</annotation></semantics></math>, <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="|\mathcal{D}_{i}|=5000" display="inline"><semantics id="S4.p4.2.m2.1a"><mrow id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mrow id="S4.p4.2.m2.1.1.1.1" xref="S4.p4.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.p4.2.m2.1.1.1.1.2" xref="S4.p4.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S4.p4.2.m2.1.1.1.1.1" xref="S4.p4.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.2.m2.1.1.1.1.1.2" xref="S4.p4.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.p4.2.m2.1.1.1.1.1.3" xref="S4.p4.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.p4.2.m2.1.1.1.1.3" xref="S4.p4.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">=</mo><mn id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><eq id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2"></eq><apply id="S4.p4.2.m2.1.1.1.2.cmml" xref="S4.p4.2.m2.1.1.1.1"><abs id="S4.p4.2.m2.1.1.1.2.1.cmml" xref="S4.p4.2.m2.1.1.1.1.2"></abs><apply id="S4.p4.2.m2.1.1.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.p4.2.m2.1.1.1.1.1.2.cmml" xref="S4.p4.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S4.p4.2.m2.1.1.1.1.1.3.cmml" xref="S4.p4.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">|\mathcal{D}_{i}|=5000</annotation></semantics></math>, and we use the data from the D4RL dataset <cite class="ltx_cite ltx_citemacro_citep">(Fu et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>. However, instead of using the data generated by the same policy for all clients, we consider the setting where five clients use the data from the hopper-expert-v2 dataset (which was generated using a completely trained (expert) SAC policy) and five clients use the data from the hopper-medium-v2 dataset (which was generated using a partially trained (medium) policy achieving only a third of the expert performance). The clients and the server are unaware of the quality (expert or medium) of the data. Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the performance comparison of multiple algorithms, where the mean and the standard deviation are calculated over <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.p4.3.m3.1a"><mn id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><cn type="integer" id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">4</annotation></semantics></math> seeds.</p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">Combining All Data (Centralized):</span> Combining the data and learning centrally is the ideal scenario in supervised learning. However, as seen in Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, performing centralized training by combining data generated using different behavior policies in offline RL can be detrimental. Sharing data can exacerbate the distributional shift between the learned policy and the individual datasets, leading to divergence of the learned policy and causing poor performance. We note that such performance deterioration due to combining data from behavior policies with different expertise levels is observed in the offline RL literature <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>; Fujimoto &amp; Gu, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>; Kumar et al., <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<figure id="S4.F1" class="ltx_figure ltx_align_floatright"><img src="/html/2305.03097/assets/x1.png" id="S4.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="272" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.3.2" class="ltx_text" style="font-size:90%;">Performance comparison of federated and centralized offline RL algorithms.</span></figcaption>
</figure>
<div id="S4.p6" class="ltx_para ltx_noindent">
<p id="S4.p6.1" class="ltx_p"><span id="S4.p6.1.1" class="ltx_text ltx_font_bold">Individual Offline RL:</span> Here, agents apply offline RL to their own datasets without collaborating with others. In Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we observe that clients with either expert or medium data do not learn well and exhibit a large standard deviation. This observation may be attributed to no client having sufficient data to learn a good policy.</p>
</div>
<div id="S4.p7" class="ltx_para ltx_noindent">
<p id="S4.p7.1" class="ltx_p"><span id="S4.p7.1.1" class="ltx_text ltx_font_bold">Naïve Federated Offline RL:</span> A simple federation approach is to use the offline RL objective as the local objective and apply FedAvg (Eq. (<a href="#S3.E2" title="In 3 Preliminaries ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)). However, offline RL algorithms typically comprise two components – an actor and a critic. It is unclear a priori which components should be federated, so we conduct experiments where we federate only the actor (Fed-A) or both the actor and the critic (Fed-AC). Surprisingly, these naïve strategies result in federated policies that perform worse than individual offline RL, as witnessed in Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Issues with Federated Offline RL</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">Our example illustrates several fundamental issues that must be addressed while designing viable federated offline RL algorithms, including:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">1. Ensemble Heterogeneity:</span> Performing offline RL over heterogeneous data yields a set of policies of different qualities.
It is crucial to leverage the information contained in these varied policies rather than simply averaging them. However, federation after a single-step local gradient at each client using weights in the manner of FedAvg, <math id="S4.SS1.p2.1.m1.1" class="ltx_math_unparsed" alttext="w_{i}=|\mathcal{D}_{i}|/|\sum_{i=1}^{|\mathcal{N}|}|\mathcal{D}_{i}|" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1b"><msub id="S4.SS1.p2.1.m1.1.2"><mi id="S4.SS1.p2.1.m1.1.2.2">w</mi><mi id="S4.SS1.p2.1.m1.1.2.3">i</mi></msub><mo rspace="0em" id="S4.SS1.p2.1.m1.1.3">=</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS1.p2.1.m1.1.4">|</mo><msub id="S4.SS1.p2.1.m1.1.5"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.5.2">𝒟</mi><mi id="S4.SS1.p2.1.m1.1.5.3">i</mi></msub><mo fence="false" stretchy="false" id="S4.SS1.p2.1.m1.1.6">|</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.7">/</mo><mo fence="false" stretchy="false" id="S4.SS1.p2.1.m1.1.8">|</mo><msubsup id="S4.SS1.p2.1.m1.1.9"><mo rspace="0em" id="S4.SS1.p2.1.m1.1.9.2.2">∑</mo><mrow id="S4.SS1.p2.1.m1.1.9.2.3"><mi id="S4.SS1.p2.1.m1.1.9.2.3.2">i</mi><mo id="S4.SS1.p2.1.m1.1.9.2.3.1">=</mo><mn id="S4.SS1.p2.1.m1.1.9.2.3.3">1</mn></mrow><mrow id="S4.SS1.p2.1.m1.1.1.1.3"><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1.1.1">𝒩</mi><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.3.2">|</mo></mrow></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS1.p2.1.m1.1.10">|</mo><msub id="S4.SS1.p2.1.m1.1.11"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.11.2">𝒟</mi><mi id="S4.SS1.p2.1.m1.1.11.3">i</mi></msub><mo fence="false" stretchy="false" id="S4.SS1.p2.1.m1.1.12">|</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">w_{i}=|\mathcal{D}_{i}|/|\sum_{i=1}^{|\mathcal{N}|}|\mathcal{D}_{i}|</annotation></semantics></math>, is equivalent to solving the offline RL problem using the combined dataset of all clients <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. This approach leads to poor performance due to the resulting distribution shift, as shown in Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. How should we optimally federate the ensemble of policies learned by the clients?</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">2. Pessimistic Value Computation:</span> Most offline RL algorithms involve a pessimistic term with respect to the offline data for minimizing the distribution shift. Training a client critic using only the local data with this pessimistic term could make it pessimistic towards actions poorly represented in its dataset but well represented in other clients’ data. How do we effectively utilize the federated critic along with the locally computed critic to set ambitious targets for offline RL at each client?</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">3. Data Heterogeneity:</span> Federated learning calls for performing multiple local gradient steps at each client before federation to enhance communication efficiency. However, numerous epochs would bias a client’s local model to its dataset. This client drift effect is well known in federated (supervised) learning and could lead to policies that are not globally optimal. In turn, this could cause the federated policy’s performance to be worse than training locally using only the client’s data, as seen in Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. How should we regularize local policies to prevent this?</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>FEDORA Design Approach</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We desire to develop a Federated Ensemble-Directed Offline RL Algorithm (FEDORA) that addresses the issues outlined in Section <a href="#S4" title="4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> in a systematic manner. Three fundamental requirements drive our approach. First, the clients jointly possess an ensemble of local policies of different levels of quality, and the server must leverage the collective knowledge embedded in this ensemble during federation. Second, the quality of these policies must be assessed using an ensemble of critics that depend on local data for policy evaluation. Finally, after each round of federation, clients must update their local policies via offline RL utilizing both their local data and the received federated policy.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.3" class="ltx_p">We begin by considering the objective of ensemble learning at federation. We define <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">p</mi><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝑝</ci><ci id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">p_{i}</annotation></semantics></math> as a measure of the relative priority of the local policy obtained from client <math id="S5.p2.2.m2.1" class="ltx_Math" alttext="i." display="inline"><semantics id="S5.p2.2.m2.1a"><mrow id="S5.p2.2.m2.1.2.2"><mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">i</mi><mo lspace="0em" id="S5.p2.2.m2.1.2.2.1">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">i.</annotation></semantics></math> Then, the weights <math id="S5.p2.3.m3.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S5.p2.3.m3.1a"><msub id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml"><mi id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">w</mi><mi id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1">subscript</csymbol><ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">𝑤</ci><ci id="S5.p2.3.m3.1.1.3.cmml" xref="S5.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">w_{i}</annotation></semantics></math> in the federated offline RL objective (Eq. (<a href="#S4.E5" title="In 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)) can be defined as</p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E6.m1.1" class="ltx_Math" alttext="\displaystyle{w}_{i}" display="inline"><semantics id="S5.E6.m1.1a"><msub id="S5.E6.m1.1.1" xref="S5.E6.m1.1.1.cmml"><mi id="S5.E6.m1.1.1.2" xref="S5.E6.m1.1.1.2.cmml">w</mi><mi id="S5.E6.m1.1.1.3" xref="S5.E6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.E6.m1.1b"><apply id="S5.E6.m1.1.1.cmml" xref="S5.E6.m1.1.1"><csymbol cd="ambiguous" id="S5.E6.m1.1.1.1.cmml" xref="S5.E6.m1.1.1">subscript</csymbol><ci id="S5.E6.m1.1.1.2.cmml" xref="S5.E6.m1.1.1.2">𝑤</ci><ci id="S5.E6.m1.1.1.3.cmml" xref="S5.E6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m1.1c">\displaystyle{w}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E6.m2.5" class="ltx_Math" alttext="\displaystyle=\frac{p_{i}|\mathcal{D}_{i}|}{|\mathcal{D}|},\quad|\mathcal{D}|=\sum_{i=1}^{|\mathcal{N}|}p_{i}|\mathcal{D}_{i}|." display="inline"><semantics id="S5.E6.m2.5a"><mrow id="S5.E6.m2.5.5.1"><mrow id="S5.E6.m2.5.5.1.1.2" xref="S5.E6.m2.5.5.1.1.3.cmml"><mrow id="S5.E6.m2.5.5.1.1.1.1" xref="S5.E6.m2.5.5.1.1.1.1.cmml"><mi id="S5.E6.m2.5.5.1.1.1.1.2" xref="S5.E6.m2.5.5.1.1.1.1.2.cmml"></mi><mo id="S5.E6.m2.5.5.1.1.1.1.1" xref="S5.E6.m2.5.5.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S5.E6.m2.2.2" xref="S5.E6.m2.2.2.cmml"><mfrac id="S5.E6.m2.2.2a" xref="S5.E6.m2.2.2.cmml"><mrow id="S5.E6.m2.1.1.1" xref="S5.E6.m2.1.1.1.cmml"><msub id="S5.E6.m2.1.1.1.3" xref="S5.E6.m2.1.1.1.3.cmml"><mi id="S5.E6.m2.1.1.1.3.2" xref="S5.E6.m2.1.1.1.3.2.cmml">p</mi><mi id="S5.E6.m2.1.1.1.3.3" xref="S5.E6.m2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m2.1.1.1.2" xref="S5.E6.m2.1.1.1.2.cmml">​</mo><mrow id="S5.E6.m2.1.1.1.1.1" xref="S5.E6.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E6.m2.1.1.1.1.1.2" xref="S5.E6.m2.1.1.1.1.2.1.cmml">|</mo><msub id="S5.E6.m2.1.1.1.1.1.1" xref="S5.E6.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m2.1.1.1.1.1.1.2" xref="S5.E6.m2.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.E6.m2.1.1.1.1.1.1.3" xref="S5.E6.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.E6.m2.1.1.1.1.1.3" xref="S5.E6.m2.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mrow id="S5.E6.m2.2.2.2.3" xref="S5.E6.m2.2.2.2.2.cmml"><mo stretchy="false" id="S5.E6.m2.2.2.2.3.1" xref="S5.E6.m2.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E6.m2.2.2.2.1" xref="S5.E6.m2.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S5.E6.m2.2.2.2.3.2" xref="S5.E6.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo rspace="1.167em" id="S5.E6.m2.5.5.1.1.2.3" xref="S5.E6.m2.5.5.1.1.3a.cmml">,</mo><mrow id="S5.E6.m2.5.5.1.1.2.2" xref="S5.E6.m2.5.5.1.1.2.2.cmml"><mrow id="S5.E6.m2.5.5.1.1.2.2.3.2" xref="S5.E6.m2.5.5.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S5.E6.m2.5.5.1.1.2.2.3.2.1" xref="S5.E6.m2.5.5.1.1.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E6.m2.4.4" xref="S5.E6.m2.4.4.cmml">𝒟</mi><mo stretchy="false" id="S5.E6.m2.5.5.1.1.2.2.3.2.2" xref="S5.E6.m2.5.5.1.1.2.2.3.1.1.cmml">|</mo></mrow><mo id="S5.E6.m2.5.5.1.1.2.2.2" xref="S5.E6.m2.5.5.1.1.2.2.2.cmml">=</mo><mrow id="S5.E6.m2.5.5.1.1.2.2.1" xref="S5.E6.m2.5.5.1.1.2.2.1.cmml"><mstyle displaystyle="true" id="S5.E6.m2.5.5.1.1.2.2.1.2" xref="S5.E6.m2.5.5.1.1.2.2.1.2.cmml"><munderover id="S5.E6.m2.5.5.1.1.2.2.1.2a" xref="S5.E6.m2.5.5.1.1.2.2.1.2.cmml"><mo movablelimits="false" id="S5.E6.m2.5.5.1.1.2.2.1.2.2.2" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.cmml"><mi id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.2" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.2.cmml">i</mi><mo id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.1" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.3" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S5.E6.m2.3.3.1.3" xref="S5.E6.m2.3.3.1.2.cmml"><mo stretchy="false" id="S5.E6.m2.3.3.1.3.1" xref="S5.E6.m2.3.3.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E6.m2.3.3.1.1" xref="S5.E6.m2.3.3.1.1.cmml">𝒩</mi><mo stretchy="false" id="S5.E6.m2.3.3.1.3.2" xref="S5.E6.m2.3.3.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S5.E6.m2.5.5.1.1.2.2.1.1" xref="S5.E6.m2.5.5.1.1.2.2.1.1.cmml"><msub id="S5.E6.m2.5.5.1.1.2.2.1.1.3" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3.cmml"><mi id="S5.E6.m2.5.5.1.1.2.2.1.1.3.2" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3.2.cmml">p</mi><mi id="S5.E6.m2.5.5.1.1.2.2.1.1.3.3" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m2.5.5.1.1.2.2.1.1.2" xref="S5.E6.m2.5.5.1.1.2.2.1.1.2.cmml">​</mo><mrow id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.2" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.2.1.cmml">|</mo><msub id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.2" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.3" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.3" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S5.E6.m2.5.5.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E6.m2.5b"><apply id="S5.E6.m2.5.5.1.1.3.cmml" xref="S5.E6.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="S5.E6.m2.5.5.1.1.3a.cmml" xref="S5.E6.m2.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S5.E6.m2.5.5.1.1.1.1.cmml" xref="S5.E6.m2.5.5.1.1.1.1"><eq id="S5.E6.m2.5.5.1.1.1.1.1.cmml" xref="S5.E6.m2.5.5.1.1.1.1.1"></eq><csymbol cd="latexml" id="S5.E6.m2.5.5.1.1.1.1.2.cmml" xref="S5.E6.m2.5.5.1.1.1.1.2">absent</csymbol><apply id="S5.E6.m2.2.2.cmml" xref="S5.E6.m2.2.2"><divide id="S5.E6.m2.2.2.3.cmml" xref="S5.E6.m2.2.2"></divide><apply id="S5.E6.m2.1.1.1.cmml" xref="S5.E6.m2.1.1.1"><times id="S5.E6.m2.1.1.1.2.cmml" xref="S5.E6.m2.1.1.1.2"></times><apply id="S5.E6.m2.1.1.1.3.cmml" xref="S5.E6.m2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E6.m2.1.1.1.3.1.cmml" xref="S5.E6.m2.1.1.1.3">subscript</csymbol><ci id="S5.E6.m2.1.1.1.3.2.cmml" xref="S5.E6.m2.1.1.1.3.2">𝑝</ci><ci id="S5.E6.m2.1.1.1.3.3.cmml" xref="S5.E6.m2.1.1.1.3.3">𝑖</ci></apply><apply id="S5.E6.m2.1.1.1.1.2.cmml" xref="S5.E6.m2.1.1.1.1.1"><abs id="S5.E6.m2.1.1.1.1.2.1.cmml" xref="S5.E6.m2.1.1.1.1.1.2"></abs><apply id="S5.E6.m2.1.1.1.1.1.1.cmml" xref="S5.E6.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E6.m2.1.1.1.1.1.1.1.cmml" xref="S5.E6.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E6.m2.1.1.1.1.1.1.2.cmml" xref="S5.E6.m2.1.1.1.1.1.1.2">𝒟</ci><ci id="S5.E6.m2.1.1.1.1.1.1.3.cmml" xref="S5.E6.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S5.E6.m2.2.2.2.2.cmml" xref="S5.E6.m2.2.2.2.3"><abs id="S5.E6.m2.2.2.2.2.1.cmml" xref="S5.E6.m2.2.2.2.3.1"></abs><ci id="S5.E6.m2.2.2.2.1.cmml" xref="S5.E6.m2.2.2.2.1">𝒟</ci></apply></apply></apply><apply id="S5.E6.m2.5.5.1.1.2.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2"><eq id="S5.E6.m2.5.5.1.1.2.2.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.2"></eq><apply id="S5.E6.m2.5.5.1.1.2.2.3.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.3.2"><abs id="S5.E6.m2.5.5.1.1.2.2.3.1.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.3.2.1"></abs><ci id="S5.E6.m2.4.4.cmml" xref="S5.E6.m2.4.4">𝒟</ci></apply><apply id="S5.E6.m2.5.5.1.1.2.2.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1"><apply id="S5.E6.m2.5.5.1.1.2.2.1.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S5.E6.m2.5.5.1.1.2.2.1.2.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2">superscript</csymbol><apply id="S5.E6.m2.5.5.1.1.2.2.1.2.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S5.E6.m2.5.5.1.1.2.2.1.2.2.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2">subscript</csymbol><sum id="S5.E6.m2.5.5.1.1.2.2.1.2.2.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.2"></sum><apply id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3"><eq id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.1"></eq><ci id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.3.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E6.m2.3.3.1.2.cmml" xref="S5.E6.m2.3.3.1.3"><abs id="S5.E6.m2.3.3.1.2.1.cmml" xref="S5.E6.m2.3.3.1.3.1"></abs><ci id="S5.E6.m2.3.3.1.1.cmml" xref="S5.E6.m2.3.3.1.1">𝒩</ci></apply></apply><apply id="S5.E6.m2.5.5.1.1.2.2.1.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1"><times id="S5.E6.m2.5.5.1.1.2.2.1.1.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.2"></times><apply id="S5.E6.m2.5.5.1.1.2.2.1.1.3.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S5.E6.m2.5.5.1.1.2.2.1.1.3.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3">subscript</csymbol><ci id="S5.E6.m2.5.5.1.1.2.2.1.1.3.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3.2">𝑝</ci><ci id="S5.E6.m2.5.5.1.1.2.2.1.1.3.3.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S5.E6.m2.5.5.1.1.2.2.1.1.1.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1"><abs id="S5.E6.m2.5.5.1.1.2.2.1.1.1.2.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.2"></abs><apply id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.1.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.2.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.2">𝒟</ci><ci id="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.3.cmml" xref="S5.E6.m2.5.5.1.1.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m2.5c">\displaystyle=\frac{p_{i}|\mathcal{D}_{i}|}{|\mathcal{D}|},\quad|\mathcal{D}|=\sum_{i=1}^{|\mathcal{N}|}p_{i}|\mathcal{D}_{i}|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S5.p2.16" class="ltx_p">Based on this objective, we now design FEDORA accounting for each of the three requirements indicated above. In what follows, we will denote the round of federation using a super-script <math id="S5.p2.4.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.p2.4.m1.1a"><mi id="S5.p2.4.m1.1.1" xref="S5.p2.4.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.p2.4.m1.1b"><ci id="S5.p2.4.m1.1.1.cmml" xref="S5.p2.4.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.4.m1.1c">t</annotation></semantics></math> and local update step within a round of federation by the super-script <math id="S5.p2.5.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.p2.5.m2.1a"><mi id="S5.p2.5.m2.1.1" xref="S5.p2.5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.p2.5.m2.1b"><ci id="S5.p2.5.m2.1.1.cmml" xref="S5.p2.5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.5.m2.1c">k</annotation></semantics></math>. More precisely, <math id="S5.p2.6.m3.2" class="ltx_Math" alttext="\pi^{(t,k)}_{i}" display="inline"><semantics id="S5.p2.6.m3.2a"><msubsup id="S5.p2.6.m3.2.3" xref="S5.p2.6.m3.2.3.cmml"><mi id="S5.p2.6.m3.2.3.2.2" xref="S5.p2.6.m3.2.3.2.2.cmml">π</mi><mi id="S5.p2.6.m3.2.3.3" xref="S5.p2.6.m3.2.3.3.cmml">i</mi><mrow id="S5.p2.6.m3.2.2.2.4" xref="S5.p2.6.m3.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.6.m3.2.2.2.4.1" xref="S5.p2.6.m3.2.2.2.3.cmml">(</mo><mi id="S5.p2.6.m3.1.1.1.1" xref="S5.p2.6.m3.1.1.1.1.cmml">t</mi><mo id="S5.p2.6.m3.2.2.2.4.2" xref="S5.p2.6.m3.2.2.2.3.cmml">,</mo><mi id="S5.p2.6.m3.2.2.2.2" xref="S5.p2.6.m3.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.p2.6.m3.2.2.2.4.3" xref="S5.p2.6.m3.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.p2.6.m3.2b"><apply id="S5.p2.6.m3.2.3.cmml" xref="S5.p2.6.m3.2.3"><csymbol cd="ambiguous" id="S5.p2.6.m3.2.3.1.cmml" xref="S5.p2.6.m3.2.3">subscript</csymbol><apply id="S5.p2.6.m3.2.3.2.cmml" xref="S5.p2.6.m3.2.3"><csymbol cd="ambiguous" id="S5.p2.6.m3.2.3.2.1.cmml" xref="S5.p2.6.m3.2.3">superscript</csymbol><ci id="S5.p2.6.m3.2.3.2.2.cmml" xref="S5.p2.6.m3.2.3.2.2">𝜋</ci><interval closure="open" id="S5.p2.6.m3.2.2.2.3.cmml" xref="S5.p2.6.m3.2.2.2.4"><ci id="S5.p2.6.m3.1.1.1.1.cmml" xref="S5.p2.6.m3.1.1.1.1">𝑡</ci><ci id="S5.p2.6.m3.2.2.2.2.cmml" xref="S5.p2.6.m3.2.2.2.2">𝑘</ci></interval></apply><ci id="S5.p2.6.m3.2.3.3.cmml" xref="S5.p2.6.m3.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.6.m3.2c">\pi^{(t,k)}_{i}</annotation></semantics></math> denotes the policy of client <math id="S5.p2.7.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.p2.7.m4.1a"><mi id="S5.p2.7.m4.1.1" xref="S5.p2.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.p2.7.m4.1b"><ci id="S5.p2.7.m4.1.1.cmml" xref="S5.p2.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.7.m4.1c">i</annotation></semantics></math> in round <math id="S5.p2.8.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.p2.8.m5.1a"><mi id="S5.p2.8.m5.1.1" xref="S5.p2.8.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.p2.8.m5.1b"><ci id="S5.p2.8.m5.1.1.cmml" xref="S5.p2.8.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.8.m5.1c">t</annotation></semantics></math> of federation after <math id="S5.p2.9.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.p2.9.m6.1a"><mi id="S5.p2.9.m6.1.1" xref="S5.p2.9.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.p2.9.m6.1b"><ci id="S5.p2.9.m6.1.1.cmml" xref="S5.p2.9.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.9.m6.1c">k</annotation></semantics></math> local policy updates. Since all clients initialize their local policies to the federated policy at the beginning of each round of federation, <math id="S5.p2.10.m7.2" class="ltx_Math" alttext="\pi^{(t,0)}_{i}=\pi_{\text{fed}}^{t}" display="inline"><semantics id="S5.p2.10.m7.2a"><mrow id="S5.p2.10.m7.2.3" xref="S5.p2.10.m7.2.3.cmml"><msubsup id="S5.p2.10.m7.2.3.2" xref="S5.p2.10.m7.2.3.2.cmml"><mi id="S5.p2.10.m7.2.3.2.2.2" xref="S5.p2.10.m7.2.3.2.2.2.cmml">π</mi><mi id="S5.p2.10.m7.2.3.2.3" xref="S5.p2.10.m7.2.3.2.3.cmml">i</mi><mrow id="S5.p2.10.m7.2.2.2.4" xref="S5.p2.10.m7.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.10.m7.2.2.2.4.1" xref="S5.p2.10.m7.2.2.2.3.cmml">(</mo><mi id="S5.p2.10.m7.1.1.1.1" xref="S5.p2.10.m7.1.1.1.1.cmml">t</mi><mo id="S5.p2.10.m7.2.2.2.4.2" xref="S5.p2.10.m7.2.2.2.3.cmml">,</mo><mn id="S5.p2.10.m7.2.2.2.2" xref="S5.p2.10.m7.2.2.2.2.cmml">0</mn><mo stretchy="false" id="S5.p2.10.m7.2.2.2.4.3" xref="S5.p2.10.m7.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S5.p2.10.m7.2.3.1" xref="S5.p2.10.m7.2.3.1.cmml">=</mo><msubsup id="S5.p2.10.m7.2.3.3" xref="S5.p2.10.m7.2.3.3.cmml"><mi id="S5.p2.10.m7.2.3.3.2.2" xref="S5.p2.10.m7.2.3.3.2.2.cmml">π</mi><mtext id="S5.p2.10.m7.2.3.3.2.3" xref="S5.p2.10.m7.2.3.3.2.3a.cmml">fed</mtext><mi id="S5.p2.10.m7.2.3.3.3" xref="S5.p2.10.m7.2.3.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.10.m7.2b"><apply id="S5.p2.10.m7.2.3.cmml" xref="S5.p2.10.m7.2.3"><eq id="S5.p2.10.m7.2.3.1.cmml" xref="S5.p2.10.m7.2.3.1"></eq><apply id="S5.p2.10.m7.2.3.2.cmml" xref="S5.p2.10.m7.2.3.2"><csymbol cd="ambiguous" id="S5.p2.10.m7.2.3.2.1.cmml" xref="S5.p2.10.m7.2.3.2">subscript</csymbol><apply id="S5.p2.10.m7.2.3.2.2.cmml" xref="S5.p2.10.m7.2.3.2"><csymbol cd="ambiguous" id="S5.p2.10.m7.2.3.2.2.1.cmml" xref="S5.p2.10.m7.2.3.2">superscript</csymbol><ci id="S5.p2.10.m7.2.3.2.2.2.cmml" xref="S5.p2.10.m7.2.3.2.2.2">𝜋</ci><interval closure="open" id="S5.p2.10.m7.2.2.2.3.cmml" xref="S5.p2.10.m7.2.2.2.4"><ci id="S5.p2.10.m7.1.1.1.1.cmml" xref="S5.p2.10.m7.1.1.1.1">𝑡</ci><cn type="integer" id="S5.p2.10.m7.2.2.2.2.cmml" xref="S5.p2.10.m7.2.2.2.2">0</cn></interval></apply><ci id="S5.p2.10.m7.2.3.2.3.cmml" xref="S5.p2.10.m7.2.3.2.3">𝑖</ci></apply><apply id="S5.p2.10.m7.2.3.3.cmml" xref="S5.p2.10.m7.2.3.3"><csymbol cd="ambiguous" id="S5.p2.10.m7.2.3.3.1.cmml" xref="S5.p2.10.m7.2.3.3">superscript</csymbol><apply id="S5.p2.10.m7.2.3.3.2.cmml" xref="S5.p2.10.m7.2.3.3"><csymbol cd="ambiguous" id="S5.p2.10.m7.2.3.3.2.1.cmml" xref="S5.p2.10.m7.2.3.3">subscript</csymbol><ci id="S5.p2.10.m7.2.3.3.2.2.cmml" xref="S5.p2.10.m7.2.3.3.2.2">𝜋</ci><ci id="S5.p2.10.m7.2.3.3.2.3a.cmml" xref="S5.p2.10.m7.2.3.3.2.3"><mtext mathsize="70%" id="S5.p2.10.m7.2.3.3.2.3.cmml" xref="S5.p2.10.m7.2.3.3.2.3">fed</mtext></ci></apply><ci id="S5.p2.10.m7.2.3.3.3.cmml" xref="S5.p2.10.m7.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.10.m7.2c">\pi^{(t,0)}_{i}=\pi_{\text{fed}}^{t}</annotation></semantics></math> for each client <math id="S5.p2.11.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.p2.11.m8.1a"><mi id="S5.p2.11.m8.1.1" xref="S5.p2.11.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.p2.11.m8.1b"><ci id="S5.p2.11.m8.1.1.cmml" xref="S5.p2.11.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.11.m8.1c">i</annotation></semantics></math>. We also denote <math id="S5.p2.12.m9.2" class="ltx_Math" alttext="\pi^{t}_{i}=\pi^{(t,K)}_{i}" display="inline"><semantics id="S5.p2.12.m9.2a"><mrow id="S5.p2.12.m9.2.3" xref="S5.p2.12.m9.2.3.cmml"><msubsup id="S5.p2.12.m9.2.3.2" xref="S5.p2.12.m9.2.3.2.cmml"><mi id="S5.p2.12.m9.2.3.2.2.2" xref="S5.p2.12.m9.2.3.2.2.2.cmml">π</mi><mi id="S5.p2.12.m9.2.3.2.3" xref="S5.p2.12.m9.2.3.2.3.cmml">i</mi><mi id="S5.p2.12.m9.2.3.2.2.3" xref="S5.p2.12.m9.2.3.2.2.3.cmml">t</mi></msubsup><mo id="S5.p2.12.m9.2.3.1" xref="S5.p2.12.m9.2.3.1.cmml">=</mo><msubsup id="S5.p2.12.m9.2.3.3" xref="S5.p2.12.m9.2.3.3.cmml"><mi id="S5.p2.12.m9.2.3.3.2.2" xref="S5.p2.12.m9.2.3.3.2.2.cmml">π</mi><mi id="S5.p2.12.m9.2.3.3.3" xref="S5.p2.12.m9.2.3.3.3.cmml">i</mi><mrow id="S5.p2.12.m9.2.2.2.4" xref="S5.p2.12.m9.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.12.m9.2.2.2.4.1" xref="S5.p2.12.m9.2.2.2.3.cmml">(</mo><mi id="S5.p2.12.m9.1.1.1.1" xref="S5.p2.12.m9.1.1.1.1.cmml">t</mi><mo id="S5.p2.12.m9.2.2.2.4.2" xref="S5.p2.12.m9.2.2.2.3.cmml">,</mo><mi id="S5.p2.12.m9.2.2.2.2" xref="S5.p2.12.m9.2.2.2.2.cmml">K</mi><mo stretchy="false" id="S5.p2.12.m9.2.2.2.4.3" xref="S5.p2.12.m9.2.2.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.12.m9.2b"><apply id="S5.p2.12.m9.2.3.cmml" xref="S5.p2.12.m9.2.3"><eq id="S5.p2.12.m9.2.3.1.cmml" xref="S5.p2.12.m9.2.3.1"></eq><apply id="S5.p2.12.m9.2.3.2.cmml" xref="S5.p2.12.m9.2.3.2"><csymbol cd="ambiguous" id="S5.p2.12.m9.2.3.2.1.cmml" xref="S5.p2.12.m9.2.3.2">subscript</csymbol><apply id="S5.p2.12.m9.2.3.2.2.cmml" xref="S5.p2.12.m9.2.3.2"><csymbol cd="ambiguous" id="S5.p2.12.m9.2.3.2.2.1.cmml" xref="S5.p2.12.m9.2.3.2">superscript</csymbol><ci id="S5.p2.12.m9.2.3.2.2.2.cmml" xref="S5.p2.12.m9.2.3.2.2.2">𝜋</ci><ci id="S5.p2.12.m9.2.3.2.2.3.cmml" xref="S5.p2.12.m9.2.3.2.2.3">𝑡</ci></apply><ci id="S5.p2.12.m9.2.3.2.3.cmml" xref="S5.p2.12.m9.2.3.2.3">𝑖</ci></apply><apply id="S5.p2.12.m9.2.3.3.cmml" xref="S5.p2.12.m9.2.3.3"><csymbol cd="ambiguous" id="S5.p2.12.m9.2.3.3.1.cmml" xref="S5.p2.12.m9.2.3.3">subscript</csymbol><apply id="S5.p2.12.m9.2.3.3.2.cmml" xref="S5.p2.12.m9.2.3.3"><csymbol cd="ambiguous" id="S5.p2.12.m9.2.3.3.2.1.cmml" xref="S5.p2.12.m9.2.3.3">superscript</csymbol><ci id="S5.p2.12.m9.2.3.3.2.2.cmml" xref="S5.p2.12.m9.2.3.3.2.2">𝜋</ci><interval closure="open" id="S5.p2.12.m9.2.2.2.3.cmml" xref="S5.p2.12.m9.2.2.2.4"><ci id="S5.p2.12.m9.1.1.1.1.cmml" xref="S5.p2.12.m9.1.1.1.1">𝑡</ci><ci id="S5.p2.12.m9.2.2.2.2.cmml" xref="S5.p2.12.m9.2.2.2.2">𝐾</ci></interval></apply><ci id="S5.p2.12.m9.2.3.3.3.cmml" xref="S5.p2.12.m9.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.12.m9.2c">\pi^{t}_{i}=\pi^{(t,K)}_{i}</annotation></semantics></math>, where <math id="S5.p2.13.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p2.13.m10.1a"><mi id="S5.p2.13.m10.1.1" xref="S5.p2.13.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p2.13.m10.1b"><ci id="S5.p2.13.m10.1.1.cmml" xref="S5.p2.13.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.13.m10.1c">K</annotation></semantics></math> is the maximum number of local updates. Since all clients initialize their local critics to the federated critic, we can similarly define <math id="S5.p2.14.m11.2" class="ltx_Math" alttext="Q^{(t,k)}_{i}" display="inline"><semantics id="S5.p2.14.m11.2a"><msubsup id="S5.p2.14.m11.2.3" xref="S5.p2.14.m11.2.3.cmml"><mi id="S5.p2.14.m11.2.3.2.2" xref="S5.p2.14.m11.2.3.2.2.cmml">Q</mi><mi id="S5.p2.14.m11.2.3.3" xref="S5.p2.14.m11.2.3.3.cmml">i</mi><mrow id="S5.p2.14.m11.2.2.2.4" xref="S5.p2.14.m11.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.14.m11.2.2.2.4.1" xref="S5.p2.14.m11.2.2.2.3.cmml">(</mo><mi id="S5.p2.14.m11.1.1.1.1" xref="S5.p2.14.m11.1.1.1.1.cmml">t</mi><mo id="S5.p2.14.m11.2.2.2.4.2" xref="S5.p2.14.m11.2.2.2.3.cmml">,</mo><mi id="S5.p2.14.m11.2.2.2.2" xref="S5.p2.14.m11.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.p2.14.m11.2.2.2.4.3" xref="S5.p2.14.m11.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.p2.14.m11.2b"><apply id="S5.p2.14.m11.2.3.cmml" xref="S5.p2.14.m11.2.3"><csymbol cd="ambiguous" id="S5.p2.14.m11.2.3.1.cmml" xref="S5.p2.14.m11.2.3">subscript</csymbol><apply id="S5.p2.14.m11.2.3.2.cmml" xref="S5.p2.14.m11.2.3"><csymbol cd="ambiguous" id="S5.p2.14.m11.2.3.2.1.cmml" xref="S5.p2.14.m11.2.3">superscript</csymbol><ci id="S5.p2.14.m11.2.3.2.2.cmml" xref="S5.p2.14.m11.2.3.2.2">𝑄</ci><interval closure="open" id="S5.p2.14.m11.2.2.2.3.cmml" xref="S5.p2.14.m11.2.2.2.4"><ci id="S5.p2.14.m11.1.1.1.1.cmml" xref="S5.p2.14.m11.1.1.1.1">𝑡</ci><ci id="S5.p2.14.m11.2.2.2.2.cmml" xref="S5.p2.14.m11.2.2.2.2">𝑘</ci></interval></apply><ci id="S5.p2.14.m11.2.3.3.cmml" xref="S5.p2.14.m11.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.14.m11.2c">Q^{(t,k)}_{i}</annotation></semantics></math>, <math id="S5.p2.15.m12.2" class="ltx_Math" alttext="Q^{(t,0)}_{i}=Q^{t}_{\text{fed}}" display="inline"><semantics id="S5.p2.15.m12.2a"><mrow id="S5.p2.15.m12.2.3" xref="S5.p2.15.m12.2.3.cmml"><msubsup id="S5.p2.15.m12.2.3.2" xref="S5.p2.15.m12.2.3.2.cmml"><mi id="S5.p2.15.m12.2.3.2.2.2" xref="S5.p2.15.m12.2.3.2.2.2.cmml">Q</mi><mi id="S5.p2.15.m12.2.3.2.3" xref="S5.p2.15.m12.2.3.2.3.cmml">i</mi><mrow id="S5.p2.15.m12.2.2.2.4" xref="S5.p2.15.m12.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.15.m12.2.2.2.4.1" xref="S5.p2.15.m12.2.2.2.3.cmml">(</mo><mi id="S5.p2.15.m12.1.1.1.1" xref="S5.p2.15.m12.1.1.1.1.cmml">t</mi><mo id="S5.p2.15.m12.2.2.2.4.2" xref="S5.p2.15.m12.2.2.2.3.cmml">,</mo><mn id="S5.p2.15.m12.2.2.2.2" xref="S5.p2.15.m12.2.2.2.2.cmml">0</mn><mo stretchy="false" id="S5.p2.15.m12.2.2.2.4.3" xref="S5.p2.15.m12.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S5.p2.15.m12.2.3.1" xref="S5.p2.15.m12.2.3.1.cmml">=</mo><msubsup id="S5.p2.15.m12.2.3.3" xref="S5.p2.15.m12.2.3.3.cmml"><mi id="S5.p2.15.m12.2.3.3.2.2" xref="S5.p2.15.m12.2.3.3.2.2.cmml">Q</mi><mtext id="S5.p2.15.m12.2.3.3.3" xref="S5.p2.15.m12.2.3.3.3a.cmml">fed</mtext><mi id="S5.p2.15.m12.2.3.3.2.3" xref="S5.p2.15.m12.2.3.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.15.m12.2b"><apply id="S5.p2.15.m12.2.3.cmml" xref="S5.p2.15.m12.2.3"><eq id="S5.p2.15.m12.2.3.1.cmml" xref="S5.p2.15.m12.2.3.1"></eq><apply id="S5.p2.15.m12.2.3.2.cmml" xref="S5.p2.15.m12.2.3.2"><csymbol cd="ambiguous" id="S5.p2.15.m12.2.3.2.1.cmml" xref="S5.p2.15.m12.2.3.2">subscript</csymbol><apply id="S5.p2.15.m12.2.3.2.2.cmml" xref="S5.p2.15.m12.2.3.2"><csymbol cd="ambiguous" id="S5.p2.15.m12.2.3.2.2.1.cmml" xref="S5.p2.15.m12.2.3.2">superscript</csymbol><ci id="S5.p2.15.m12.2.3.2.2.2.cmml" xref="S5.p2.15.m12.2.3.2.2.2">𝑄</ci><interval closure="open" id="S5.p2.15.m12.2.2.2.3.cmml" xref="S5.p2.15.m12.2.2.2.4"><ci id="S5.p2.15.m12.1.1.1.1.cmml" xref="S5.p2.15.m12.1.1.1.1">𝑡</ci><cn type="integer" id="S5.p2.15.m12.2.2.2.2.cmml" xref="S5.p2.15.m12.2.2.2.2">0</cn></interval></apply><ci id="S5.p2.15.m12.2.3.2.3.cmml" xref="S5.p2.15.m12.2.3.2.3">𝑖</ci></apply><apply id="S5.p2.15.m12.2.3.3.cmml" xref="S5.p2.15.m12.2.3.3"><csymbol cd="ambiguous" id="S5.p2.15.m12.2.3.3.1.cmml" xref="S5.p2.15.m12.2.3.3">subscript</csymbol><apply id="S5.p2.15.m12.2.3.3.2.cmml" xref="S5.p2.15.m12.2.3.3"><csymbol cd="ambiguous" id="S5.p2.15.m12.2.3.3.2.1.cmml" xref="S5.p2.15.m12.2.3.3">superscript</csymbol><ci id="S5.p2.15.m12.2.3.3.2.2.cmml" xref="S5.p2.15.m12.2.3.3.2.2">𝑄</ci><ci id="S5.p2.15.m12.2.3.3.2.3.cmml" xref="S5.p2.15.m12.2.3.3.2.3">𝑡</ci></apply><ci id="S5.p2.15.m12.2.3.3.3a.cmml" xref="S5.p2.15.m12.2.3.3.3"><mtext mathsize="70%" id="S5.p2.15.m12.2.3.3.3.cmml" xref="S5.p2.15.m12.2.3.3.3">fed</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.15.m12.2c">Q^{(t,0)}_{i}=Q^{t}_{\text{fed}}</annotation></semantics></math>, and <math id="S5.p2.16.m13.2" class="ltx_Math" alttext="Q^{t}_{i}=Q^{(t,K)}_{i}" display="inline"><semantics id="S5.p2.16.m13.2a"><mrow id="S5.p2.16.m13.2.3" xref="S5.p2.16.m13.2.3.cmml"><msubsup id="S5.p2.16.m13.2.3.2" xref="S5.p2.16.m13.2.3.2.cmml"><mi id="S5.p2.16.m13.2.3.2.2.2" xref="S5.p2.16.m13.2.3.2.2.2.cmml">Q</mi><mi id="S5.p2.16.m13.2.3.2.3" xref="S5.p2.16.m13.2.3.2.3.cmml">i</mi><mi id="S5.p2.16.m13.2.3.2.2.3" xref="S5.p2.16.m13.2.3.2.2.3.cmml">t</mi></msubsup><mo id="S5.p2.16.m13.2.3.1" xref="S5.p2.16.m13.2.3.1.cmml">=</mo><msubsup id="S5.p2.16.m13.2.3.3" xref="S5.p2.16.m13.2.3.3.cmml"><mi id="S5.p2.16.m13.2.3.3.2.2" xref="S5.p2.16.m13.2.3.3.2.2.cmml">Q</mi><mi id="S5.p2.16.m13.2.3.3.3" xref="S5.p2.16.m13.2.3.3.3.cmml">i</mi><mrow id="S5.p2.16.m13.2.2.2.4" xref="S5.p2.16.m13.2.2.2.3.cmml"><mo stretchy="false" id="S5.p2.16.m13.2.2.2.4.1" xref="S5.p2.16.m13.2.2.2.3.cmml">(</mo><mi id="S5.p2.16.m13.1.1.1.1" xref="S5.p2.16.m13.1.1.1.1.cmml">t</mi><mo id="S5.p2.16.m13.2.2.2.4.2" xref="S5.p2.16.m13.2.2.2.3.cmml">,</mo><mi id="S5.p2.16.m13.2.2.2.2" xref="S5.p2.16.m13.2.2.2.2.cmml">K</mi><mo stretchy="false" id="S5.p2.16.m13.2.2.2.4.3" xref="S5.p2.16.m13.2.2.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.16.m13.2b"><apply id="S5.p2.16.m13.2.3.cmml" xref="S5.p2.16.m13.2.3"><eq id="S5.p2.16.m13.2.3.1.cmml" xref="S5.p2.16.m13.2.3.1"></eq><apply id="S5.p2.16.m13.2.3.2.cmml" xref="S5.p2.16.m13.2.3.2"><csymbol cd="ambiguous" id="S5.p2.16.m13.2.3.2.1.cmml" xref="S5.p2.16.m13.2.3.2">subscript</csymbol><apply id="S5.p2.16.m13.2.3.2.2.cmml" xref="S5.p2.16.m13.2.3.2"><csymbol cd="ambiguous" id="S5.p2.16.m13.2.3.2.2.1.cmml" xref="S5.p2.16.m13.2.3.2">superscript</csymbol><ci id="S5.p2.16.m13.2.3.2.2.2.cmml" xref="S5.p2.16.m13.2.3.2.2.2">𝑄</ci><ci id="S5.p2.16.m13.2.3.2.2.3.cmml" xref="S5.p2.16.m13.2.3.2.2.3">𝑡</ci></apply><ci id="S5.p2.16.m13.2.3.2.3.cmml" xref="S5.p2.16.m13.2.3.2.3">𝑖</ci></apply><apply id="S5.p2.16.m13.2.3.3.cmml" xref="S5.p2.16.m13.2.3.3"><csymbol cd="ambiguous" id="S5.p2.16.m13.2.3.3.1.cmml" xref="S5.p2.16.m13.2.3.3">subscript</csymbol><apply id="S5.p2.16.m13.2.3.3.2.cmml" xref="S5.p2.16.m13.2.3.3"><csymbol cd="ambiguous" id="S5.p2.16.m13.2.3.3.2.1.cmml" xref="S5.p2.16.m13.2.3.3">superscript</csymbol><ci id="S5.p2.16.m13.2.3.3.2.2.cmml" xref="S5.p2.16.m13.2.3.3.2.2">𝑄</ci><interval closure="open" id="S5.p2.16.m13.2.2.2.3.cmml" xref="S5.p2.16.m13.2.2.2.4"><ci id="S5.p2.16.m13.1.1.1.1.cmml" xref="S5.p2.16.m13.1.1.1.1">𝑡</ci><ci id="S5.p2.16.m13.2.2.2.2.cmml" xref="S5.p2.16.m13.2.2.2.2">𝐾</ci></interval></apply><ci id="S5.p2.16.m13.2.3.3.3.cmml" xref="S5.p2.16.m13.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.16.m13.2c">Q^{t}_{i}=Q^{(t,K)}_{i}</annotation></semantics></math> for the local critic.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Ensemble-Directed Learning over Client Policies</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">As seen in Fig. <a href="#S4.F1" title="Figure 1 ‣ 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, naïvely federating offline RL results in policies that perform worse than learning on aggregated data, which is itself sub-optimal (and not feasible in a federated setting). Furthermore, simply averaging over the clients’ policies without considering their qualities implies that low-quality policies will have the same influence on the federated policy as high-quality ones. Such an averaging technique could lead to a scenario where the federated policy’s performance is worse than training locally using only a client’s data. We desire an ensemble learning approach that continually refines the federated policy based on the relative merits of the client policies over multiple rounds of federation.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.15" class="ltx_p">The figure of merit for a given client <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">i</annotation></semantics></math>’s local policy at round <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">t</annotation></semantics></math>, <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\pi_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><msubsup id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2.2" xref="S5.SS1.p2.3.m3.1.1.2.2.cmml">π</mi><mi id="S5.SS1.p2.3.m3.1.1.2.3" xref="S5.SS1.p2.3.m3.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">superscript</csymbol><apply id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.2.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2.2">𝜋</ci><ci id="S5.SS1.p2.3.m3.1.1.2.3.cmml" xref="S5.SS1.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\pi_{i}^{t}</annotation></semantics></math>, is its infinite horizon discounted reward <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="J\left(\pi_{i}^{t}\right)" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mi id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S5.SS1.p2.4.m4.1.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo id="S5.SS1.p2.4.m4.1.1.1.1.2" xref="S5.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><msubsup id="S5.SS1.p2.4.m4.1.1.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.4.m4.1.1.1.1.1.2.2" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml">π</mi><mi id="S5.SS1.p2.4.m4.1.1.1.1.1.2.3" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.4.m4.1.1.1.1.1.3" xref="S5.SS1.p2.4.m4.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S5.SS1.p2.4.m4.1.1.1.1.3" xref="S5.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><times id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"></times><ci id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">𝐽</ci><apply id="S5.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1">superscript</csymbol><apply id="S5.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2.2">𝜋</ci><ci id="S5.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">J\left(\pi_{i}^{t}\right)</annotation></semantics></math>. However, while obtaining an unbiased estimate of the performance of a policy in the online RL setting is straightforward, it is hard to do so in offline RL since we do not have access to the environment for executing the policy and evaluating its performance. Therefore, we use the offline data to get a proxy estimate <math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="J_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><msubsup id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2.2" xref="S5.SS1.p2.5.m5.1.1.2.2.cmml">J</mi><mi id="S5.SS1.p2.5.m5.1.1.2.3" xref="S5.SS1.p2.5.m5.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.5.m5.1.1.3" xref="S5.SS1.p2.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">superscript</csymbol><apply id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.2.1.cmml" xref="S5.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2.2">𝐽</ci><ci id="S5.SS1.p2.5.m5.1.1.2.3.cmml" xref="S5.SS1.p2.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.5.m5.1.1.3.cmml" xref="S5.SS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">J_{i}^{t}</annotation></semantics></math> for the quality of the final local policy <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="\pi_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><msubsup id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml"><mi id="S5.SS1.p2.6.m6.1.1.2.2" xref="S5.SS1.p2.6.m6.1.1.2.2.cmml">π</mi><mi id="S5.SS1.p2.6.m6.1.1.2.3" xref="S5.SS1.p2.6.m6.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.6.m6.1.1.3" xref="S5.SS1.p2.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><apply id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m6.1.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">superscript</csymbol><apply id="S5.SS1.p2.6.m6.1.1.2.cmml" xref="S5.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m6.1.1.2.1.cmml" xref="S5.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS1.p2.6.m6.1.1.2.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2">𝜋</ci><ci id="S5.SS1.p2.6.m6.1.1.2.3.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.6.m6.1.1.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">\pi_{i}^{t}</annotation></semantics></math> as <math id="S5.SS1.p2.7.m7.3" class="ltx_Math" alttext="J^{t}_{i}=\mathbb{E}_{s\sim\mathcal{D}_{i}}\left[Q^{t}_{i}(s,\pi^{t}_{i}(s))\right]," display="inline"><semantics id="S5.SS1.p2.7.m7.3a"><mrow id="S5.SS1.p2.7.m7.3.3.1" xref="S5.SS1.p2.7.m7.3.3.1.1.cmml"><mrow id="S5.SS1.p2.7.m7.3.3.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.cmml"><msubsup id="S5.SS1.p2.7.m7.3.3.1.1.3" xref="S5.SS1.p2.7.m7.3.3.1.1.3.cmml"><mi id="S5.SS1.p2.7.m7.3.3.1.1.3.2.2" xref="S5.SS1.p2.7.m7.3.3.1.1.3.2.2.cmml">J</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.3.3" xref="S5.SS1.p2.7.m7.3.3.1.1.3.3.cmml">i</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.3.2.3" xref="S5.SS1.p2.7.m7.3.3.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S5.SS1.p2.7.m7.3.3.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.2.cmml">=</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.cmml"><msub id="S5.SS1.p2.7.m7.3.3.1.1.1.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.cmml"><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.3.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.cmml"><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.2.cmml">s</mi><mo id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.1.cmml">∼</mo><msub id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.2.cmml">𝒟</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.SS1.p2.7.m7.3.3.1.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.2.cmml">​</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.2.cmml"><mo id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.cmml"><msubsup id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.cmml"><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.2.cmml">Q</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3.cmml">i</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S5.SS1.p2.7.m7.2.2" xref="S5.SS1.p2.7.m7.2.2.cmml">s</mi><mo id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S5.SS1.p2.7.m7.1.1" xref="S5.SS1.p2.7.m7.1.1.cmml">s</mi><mo stretchy="false" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.4" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.3" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.SS1.p2.7.m7.3.3.1.2" xref="S5.SS1.p2.7.m7.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.3b"><apply id="S5.SS1.p2.7.m7.3.3.1.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1"><eq id="S5.SS1.p2.7.m7.3.3.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.2"></eq><apply id="S5.SS1.p2.7.m7.3.3.1.1.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.3.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3">subscript</csymbol><apply id="S5.SS1.p2.7.m7.3.3.1.1.3.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.3.2.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3">superscript</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.3.2.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3.2.2">𝐽</ci><ci id="S5.SS1.p2.7.m7.3.3.1.1.3.2.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3.2.3">𝑡</ci></apply><ci id="S5.SS1.p2.7.m7.3.3.1.1.3.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.3.3">𝑖</ci></apply><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1"><times id="S5.SS1.p2.7.m7.3.3.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.2"></times><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.3.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3">subscript</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.3.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.2">𝔼</ci><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3"><csymbol cd="latexml" id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.1">similar-to</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.2">𝑠</ci><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3">subscript</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.2">𝒟</ci><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.2.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1"><times id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2"></times><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.2">𝑄</ci><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1"><ci id="S5.SS1.p2.7.m7.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2">𝑠</ci><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1"><times id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.1"></times><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.2">𝜋</ci><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.7.m7.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1">𝑠</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.3c">J^{t}_{i}=\mathbb{E}_{s\sim\mathcal{D}_{i}}\left[Q^{t}_{i}(s,\pi^{t}_{i}(s))\right],</annotation></semantics></math> where <math id="S5.SS1.p2.8.m8.1" class="ltx_Math" alttext="Q_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.8.m8.1a"><msubsup id="S5.SS1.p2.8.m8.1.1" xref="S5.SS1.p2.8.m8.1.1.cmml"><mi id="S5.SS1.p2.8.m8.1.1.2.2" xref="S5.SS1.p2.8.m8.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p2.8.m8.1.1.2.3" xref="S5.SS1.p2.8.m8.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.8.m8.1.1.3" xref="S5.SS1.p2.8.m8.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m8.1b"><apply id="S5.SS1.p2.8.m8.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1">superscript</csymbol><apply id="S5.SS1.p2.8.m8.1.1.2.cmml" xref="S5.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.2.1.cmml" xref="S5.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S5.SS1.p2.8.m8.1.1.2.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2.2">𝑄</ci><ci id="S5.SS1.p2.8.m8.1.1.2.3.cmml" xref="S5.SS1.p2.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.8.m8.1.1.3.cmml" xref="S5.SS1.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m8.1c">Q_{i}^{t}</annotation></semantics></math> is the local critic function at round <math id="S5.SS1.p2.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p2.9.m9.1a"><mi id="S5.SS1.p2.9.m9.1.1" xref="S5.SS1.p2.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.9.m9.1b"><ci id="S5.SS1.p2.9.m9.1.1.cmml" xref="S5.SS1.p2.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.9.m9.1c">t</annotation></semantics></math> after <math id="S5.SS1.p2.10.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p2.10.m10.1a"><mi id="S5.SS1.p2.10.m10.1.1" xref="S5.SS1.p2.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.10.m10.1b"><ci id="S5.SS1.p2.10.m10.1.1.cmml" xref="S5.SS1.p2.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.10.m10.1c">K</annotation></semantics></math> local updates (computation of <math id="S5.SS1.p2.11.m11.1" class="ltx_Math" alttext="Q_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.11.m11.1a"><msubsup id="S5.SS1.p2.11.m11.1.1" xref="S5.SS1.p2.11.m11.1.1.cmml"><mi id="S5.SS1.p2.11.m11.1.1.2.2" xref="S5.SS1.p2.11.m11.1.1.2.2.cmml">Q</mi><mi id="S5.SS1.p2.11.m11.1.1.2.3" xref="S5.SS1.p2.11.m11.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.11.m11.1.1.3" xref="S5.SS1.p2.11.m11.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.11.m11.1b"><apply id="S5.SS1.p2.11.m11.1.1.cmml" xref="S5.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.11.m11.1.1.1.cmml" xref="S5.SS1.p2.11.m11.1.1">superscript</csymbol><apply id="S5.SS1.p2.11.m11.1.1.2.cmml" xref="S5.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.11.m11.1.1.2.1.cmml" xref="S5.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S5.SS1.p2.11.m11.1.1.2.2.cmml" xref="S5.SS1.p2.11.m11.1.1.2.2">𝑄</ci><ci id="S5.SS1.p2.11.m11.1.1.2.3.cmml" xref="S5.SS1.p2.11.m11.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.11.m11.1.1.3.cmml" xref="S5.SS1.p2.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.11.m11.1c">Q_{i}^{t}</annotation></semantics></math> and <math id="S5.SS1.p2.12.m12.1" class="ltx_Math" alttext="\pi^{t}_{i}" display="inline"><semantics id="S5.SS1.p2.12.m12.1a"><msubsup id="S5.SS1.p2.12.m12.1.1" xref="S5.SS1.p2.12.m12.1.1.cmml"><mi id="S5.SS1.p2.12.m12.1.1.2.2" xref="S5.SS1.p2.12.m12.1.1.2.2.cmml">π</mi><mi id="S5.SS1.p2.12.m12.1.1.3" xref="S5.SS1.p2.12.m12.1.1.3.cmml">i</mi><mi id="S5.SS1.p2.12.m12.1.1.2.3" xref="S5.SS1.p2.12.m12.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.12.m12.1b"><apply id="S5.SS1.p2.12.m12.1.1.cmml" xref="S5.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.12.m12.1.1.1.cmml" xref="S5.SS1.p2.12.m12.1.1">subscript</csymbol><apply id="S5.SS1.p2.12.m12.1.1.2.cmml" xref="S5.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.12.m12.1.1.2.1.cmml" xref="S5.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S5.SS1.p2.12.m12.1.1.2.2.cmml" xref="S5.SS1.p2.12.m12.1.1.2.2">𝜋</ci><ci id="S5.SS1.p2.12.m12.1.1.2.3.cmml" xref="S5.SS1.p2.12.m12.1.1.2.3">𝑡</ci></apply><ci id="S5.SS1.p2.12.m12.1.1.3.cmml" xref="S5.SS1.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.12.m12.1c">\pi^{t}_{i}</annotation></semantics></math> are described later). We then compute the relative priority <math id="S5.SS1.p2.13.m13.1" class="ltx_Math" alttext="p_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.13.m13.1a"><msubsup id="S5.SS1.p2.13.m13.1.1" xref="S5.SS1.p2.13.m13.1.1.cmml"><mi id="S5.SS1.p2.13.m13.1.1.2.2" xref="S5.SS1.p2.13.m13.1.1.2.2.cmml">p</mi><mi id="S5.SS1.p2.13.m13.1.1.2.3" xref="S5.SS1.p2.13.m13.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.13.m13.1.1.3" xref="S5.SS1.p2.13.m13.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.13.m13.1b"><apply id="S5.SS1.p2.13.m13.1.1.cmml" xref="S5.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.13.m13.1.1.1.cmml" xref="S5.SS1.p2.13.m13.1.1">superscript</csymbol><apply id="S5.SS1.p2.13.m13.1.1.2.cmml" xref="S5.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.13.m13.1.1.2.1.cmml" xref="S5.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S5.SS1.p2.13.m13.1.1.2.2.cmml" xref="S5.SS1.p2.13.m13.1.1.2.2">𝑝</ci><ci id="S5.SS1.p2.13.m13.1.1.2.3.cmml" xref="S5.SS1.p2.13.m13.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.13.m13.1.1.3.cmml" xref="S5.SS1.p2.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.13.m13.1c">p_{i}^{t}</annotation></semantics></math> of client <math id="S5.SS1.p2.14.m14.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.14.m14.1a"><mi id="S5.SS1.p2.14.m14.1.1" xref="S5.SS1.p2.14.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.14.m14.1b"><ci id="S5.SS1.p2.14.m14.1.1.cmml" xref="S5.SS1.p2.14.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.14.m14.1c">i</annotation></semantics></math> at round <math id="S5.SS1.p2.15.m15.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p2.15.m15.1a"><mi id="S5.SS1.p2.15.m15.1.1" xref="S5.SS1.p2.15.m15.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.15.m15.1b"><ci id="S5.SS1.p2.15.m15.1.1.cmml" xref="S5.SS1.p2.15.m15.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.15.m15.1c">t</annotation></semantics></math> using a soft-max function as</p>
<table id="A4.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E7.m1.1" class="ltx_Math" alttext="\displaystyle p_{i}^{t}" display="inline"><semantics id="S5.E7.m1.1a"><msubsup id="S5.E7.m1.1.1" xref="S5.E7.m1.1.1.cmml"><mi id="S5.E7.m1.1.1.2.2" xref="S5.E7.m1.1.1.2.2.cmml">p</mi><mi id="S5.E7.m1.1.1.2.3" xref="S5.E7.m1.1.1.2.3.cmml">i</mi><mi id="S5.E7.m1.1.1.3" xref="S5.E7.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.E7.m1.1b"><apply id="S5.E7.m1.1.1.cmml" xref="S5.E7.m1.1.1"><csymbol cd="ambiguous" id="S5.E7.m1.1.1.1.cmml" xref="S5.E7.m1.1.1">superscript</csymbol><apply id="S5.E7.m1.1.1.2.cmml" xref="S5.E7.m1.1.1"><csymbol cd="ambiguous" id="S5.E7.m1.1.1.2.1.cmml" xref="S5.E7.m1.1.1">subscript</csymbol><ci id="S5.E7.m1.1.1.2.2.cmml" xref="S5.E7.m1.1.1.2.2">𝑝</ci><ci id="S5.E7.m1.1.1.2.3.cmml" xref="S5.E7.m1.1.1.2.3">𝑖</ci></apply><ci id="S5.E7.m1.1.1.3.cmml" xref="S5.E7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m1.1c">\displaystyle p_{i}^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E7.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{e^{\beta J^{t}_{i}}}{\sum_{i=1}^{|\mathcal{N}|}e^{\beta J^{t}_{i}}}," display="inline"><semantics id="S5.E7.m2.2a"><mrow id="S5.E7.m2.2.2.1" xref="S5.E7.m2.2.2.1.1.cmml"><mrow id="S5.E7.m2.2.2.1.1" xref="S5.E7.m2.2.2.1.1.cmml"><mi id="S5.E7.m2.2.2.1.1.2" xref="S5.E7.m2.2.2.1.1.2.cmml"></mi><mo id="S5.E7.m2.2.2.1.1.1" xref="S5.E7.m2.2.2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S5.E7.m2.1.1" xref="S5.E7.m2.1.1.cmml"><mfrac id="S5.E7.m2.1.1a" xref="S5.E7.m2.1.1.cmml"><msup id="S5.E7.m2.1.1.3" xref="S5.E7.m2.1.1.3.cmml"><mi id="S5.E7.m2.1.1.3.2" xref="S5.E7.m2.1.1.3.2.cmml">e</mi><mrow id="S5.E7.m2.1.1.3.3" xref="S5.E7.m2.1.1.3.3.cmml"><mi id="S5.E7.m2.1.1.3.3.2" xref="S5.E7.m2.1.1.3.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S5.E7.m2.1.1.3.3.1" xref="S5.E7.m2.1.1.3.3.1.cmml">​</mo><msubsup id="S5.E7.m2.1.1.3.3.3" xref="S5.E7.m2.1.1.3.3.3.cmml"><mi id="S5.E7.m2.1.1.3.3.3.2.2" xref="S5.E7.m2.1.1.3.3.3.2.2.cmml">J</mi><mi id="S5.E7.m2.1.1.3.3.3.3" xref="S5.E7.m2.1.1.3.3.3.3.cmml">i</mi><mi id="S5.E7.m2.1.1.3.3.3.2.3" xref="S5.E7.m2.1.1.3.3.3.2.3.cmml">t</mi></msubsup></mrow></msup><mrow id="S5.E7.m2.1.1.1" xref="S5.E7.m2.1.1.1.cmml"><msubsup id="S5.E7.m2.1.1.1.2" xref="S5.E7.m2.1.1.1.2.cmml"><mo id="S5.E7.m2.1.1.1.2.2.2" xref="S5.E7.m2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.E7.m2.1.1.1.2.2.3" xref="S5.E7.m2.1.1.1.2.2.3.cmml"><mi id="S5.E7.m2.1.1.1.2.2.3.2" xref="S5.E7.m2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S5.E7.m2.1.1.1.2.2.3.1" xref="S5.E7.m2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E7.m2.1.1.1.2.2.3.3" xref="S5.E7.m2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S5.E7.m2.1.1.1.1.1.3" xref="S5.E7.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E7.m2.1.1.1.1.1.3.1" xref="S5.E7.m2.1.1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E7.m2.1.1.1.1.1.1" xref="S5.E7.m2.1.1.1.1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S5.E7.m2.1.1.1.1.1.3.2" xref="S5.E7.m2.1.1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><msup id="S5.E7.m2.1.1.1.3" xref="S5.E7.m2.1.1.1.3.cmml"><mi id="S5.E7.m2.1.1.1.3.2" xref="S5.E7.m2.1.1.1.3.2.cmml">e</mi><mrow id="S5.E7.m2.1.1.1.3.3" xref="S5.E7.m2.1.1.1.3.3.cmml"><mi id="S5.E7.m2.1.1.1.3.3.2" xref="S5.E7.m2.1.1.1.3.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S5.E7.m2.1.1.1.3.3.1" xref="S5.E7.m2.1.1.1.3.3.1.cmml">​</mo><msubsup id="S5.E7.m2.1.1.1.3.3.3" xref="S5.E7.m2.1.1.1.3.3.3.cmml"><mi id="S5.E7.m2.1.1.1.3.3.3.2.2" xref="S5.E7.m2.1.1.1.3.3.3.2.2.cmml">J</mi><mi id="S5.E7.m2.1.1.1.3.3.3.3" xref="S5.E7.m2.1.1.1.3.3.3.3.cmml">i</mi><mi id="S5.E7.m2.1.1.1.3.3.3.2.3" xref="S5.E7.m2.1.1.1.3.3.3.2.3.cmml">t</mi></msubsup></mrow></msup></mrow></mfrac></mstyle></mrow><mo id="S5.E7.m2.2.2.1.2" xref="S5.E7.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m2.2b"><apply id="S5.E7.m2.2.2.1.1.cmml" xref="S5.E7.m2.2.2.1"><eq id="S5.E7.m2.2.2.1.1.1.cmml" xref="S5.E7.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S5.E7.m2.2.2.1.1.2.cmml" xref="S5.E7.m2.2.2.1.1.2">absent</csymbol><apply id="S5.E7.m2.1.1.cmml" xref="S5.E7.m2.1.1"><divide id="S5.E7.m2.1.1.2.cmml" xref="S5.E7.m2.1.1"></divide><apply id="S5.E7.m2.1.1.3.cmml" xref="S5.E7.m2.1.1.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.3.1.cmml" xref="S5.E7.m2.1.1.3">superscript</csymbol><ci id="S5.E7.m2.1.1.3.2.cmml" xref="S5.E7.m2.1.1.3.2">𝑒</ci><apply id="S5.E7.m2.1.1.3.3.cmml" xref="S5.E7.m2.1.1.3.3"><times id="S5.E7.m2.1.1.3.3.1.cmml" xref="S5.E7.m2.1.1.3.3.1"></times><ci id="S5.E7.m2.1.1.3.3.2.cmml" xref="S5.E7.m2.1.1.3.3.2">𝛽</ci><apply id="S5.E7.m2.1.1.3.3.3.cmml" xref="S5.E7.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.3.3.3.1.cmml" xref="S5.E7.m2.1.1.3.3.3">subscript</csymbol><apply id="S5.E7.m2.1.1.3.3.3.2.cmml" xref="S5.E7.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.3.3.3.2.1.cmml" xref="S5.E7.m2.1.1.3.3.3">superscript</csymbol><ci id="S5.E7.m2.1.1.3.3.3.2.2.cmml" xref="S5.E7.m2.1.1.3.3.3.2.2">𝐽</ci><ci id="S5.E7.m2.1.1.3.3.3.2.3.cmml" xref="S5.E7.m2.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S5.E7.m2.1.1.3.3.3.3.cmml" xref="S5.E7.m2.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S5.E7.m2.1.1.1.cmml" xref="S5.E7.m2.1.1.1"><apply id="S5.E7.m2.1.1.1.2.cmml" xref="S5.E7.m2.1.1.1.2"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.1.2.1.cmml" xref="S5.E7.m2.1.1.1.2">superscript</csymbol><apply id="S5.E7.m2.1.1.1.2.2.cmml" xref="S5.E7.m2.1.1.1.2"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.1.2.2.1.cmml" xref="S5.E7.m2.1.1.1.2">subscript</csymbol><sum id="S5.E7.m2.1.1.1.2.2.2.cmml" xref="S5.E7.m2.1.1.1.2.2.2"></sum><apply id="S5.E7.m2.1.1.1.2.2.3.cmml" xref="S5.E7.m2.1.1.1.2.2.3"><eq id="S5.E7.m2.1.1.1.2.2.3.1.cmml" xref="S5.E7.m2.1.1.1.2.2.3.1"></eq><ci id="S5.E7.m2.1.1.1.2.2.3.2.cmml" xref="S5.E7.m2.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S5.E7.m2.1.1.1.2.2.3.3.cmml" xref="S5.E7.m2.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E7.m2.1.1.1.1.1.2.cmml" xref="S5.E7.m2.1.1.1.1.1.3"><abs id="S5.E7.m2.1.1.1.1.1.2.1.cmml" xref="S5.E7.m2.1.1.1.1.1.3.1"></abs><ci id="S5.E7.m2.1.1.1.1.1.1.cmml" xref="S5.E7.m2.1.1.1.1.1.1">𝒩</ci></apply></apply><apply id="S5.E7.m2.1.1.1.3.cmml" xref="S5.E7.m2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.1.3.1.cmml" xref="S5.E7.m2.1.1.1.3">superscript</csymbol><ci id="S5.E7.m2.1.1.1.3.2.cmml" xref="S5.E7.m2.1.1.1.3.2">𝑒</ci><apply id="S5.E7.m2.1.1.1.3.3.cmml" xref="S5.E7.m2.1.1.1.3.3"><times id="S5.E7.m2.1.1.1.3.3.1.cmml" xref="S5.E7.m2.1.1.1.3.3.1"></times><ci id="S5.E7.m2.1.1.1.3.3.2.cmml" xref="S5.E7.m2.1.1.1.3.3.2">𝛽</ci><apply id="S5.E7.m2.1.1.1.3.3.3.cmml" xref="S5.E7.m2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.1.3.3.3.1.cmml" xref="S5.E7.m2.1.1.1.3.3.3">subscript</csymbol><apply id="S5.E7.m2.1.1.1.3.3.3.2.cmml" xref="S5.E7.m2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.E7.m2.1.1.1.3.3.3.2.1.cmml" xref="S5.E7.m2.1.1.1.3.3.3">superscript</csymbol><ci id="S5.E7.m2.1.1.1.3.3.3.2.2.cmml" xref="S5.E7.m2.1.1.1.3.3.3.2.2">𝐽</ci><ci id="S5.E7.m2.1.1.1.3.3.3.2.3.cmml" xref="S5.E7.m2.1.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S5.E7.m2.1.1.1.3.3.3.3.cmml" xref="S5.E7.m2.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m2.2c">\displaystyle=\frac{e^{\beta J^{t}_{i}}}{\sum_{i=1}^{|\mathcal{N}|}e^{\beta J^{t}_{i}}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S5.SS1.p2.18" class="ltx_p">where <math id="S5.SS1.p2.16.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.p2.16.m1.1a"><mi id="S5.SS1.p2.16.m1.1.1" xref="S5.SS1.p2.16.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.16.m1.1b"><ci id="S5.SS1.p2.16.m1.1.1.cmml" xref="S5.SS1.p2.16.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.16.m1.1c">\beta</annotation></semantics></math> is a tunable temperature parameter. The weights <math id="S5.SS1.p2.17.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S5.SS1.p2.17.m2.1a"><msub id="S5.SS1.p2.17.m2.1.1" xref="S5.SS1.p2.17.m2.1.1.cmml"><mi id="S5.SS1.p2.17.m2.1.1.2" xref="S5.SS1.p2.17.m2.1.1.2.cmml">w</mi><mi id="S5.SS1.p2.17.m2.1.1.3" xref="S5.SS1.p2.17.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.17.m2.1b"><apply id="S5.SS1.p2.17.m2.1.1.cmml" xref="S5.SS1.p2.17.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.17.m2.1.1.1.cmml" xref="S5.SS1.p2.17.m2.1.1">subscript</csymbol><ci id="S5.SS1.p2.17.m2.1.1.2.cmml" xref="S5.SS1.p2.17.m2.1.1.2">𝑤</ci><ci id="S5.SS1.p2.17.m2.1.1.3.cmml" xref="S5.SS1.p2.17.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.17.m2.1c">w_{i}</annotation></semantics></math>s in the federated offline RL objective (Eq. (<a href="#S4.E5" title="In 4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)) can now be defined as in Eq. (<a href="#S5.E6" title="In 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) using the relative priority <math id="S5.SS1.p2.18.m3.1" class="ltx_Math" alttext="p_{i}^{t}" display="inline"><semantics id="S5.SS1.p2.18.m3.1a"><msubsup id="S5.SS1.p2.18.m3.1.1" xref="S5.SS1.p2.18.m3.1.1.cmml"><mi id="S5.SS1.p2.18.m3.1.1.2.2" xref="S5.SS1.p2.18.m3.1.1.2.2.cmml">p</mi><mi id="S5.SS1.p2.18.m3.1.1.2.3" xref="S5.SS1.p2.18.m3.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.18.m3.1.1.3" xref="S5.SS1.p2.18.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.18.m3.1b"><apply id="S5.SS1.p2.18.m3.1.1.cmml" xref="S5.SS1.p2.18.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.18.m3.1.1.1.cmml" xref="S5.SS1.p2.18.m3.1.1">superscript</csymbol><apply id="S5.SS1.p2.18.m3.1.1.2.cmml" xref="S5.SS1.p2.18.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.18.m3.1.1.2.1.cmml" xref="S5.SS1.p2.18.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.18.m3.1.1.2.2.cmml" xref="S5.SS1.p2.18.m3.1.1.2.2">𝑝</ci><ci id="S5.SS1.p2.18.m3.1.1.2.3.cmml" xref="S5.SS1.p2.18.m3.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.18.m3.1.1.3.cmml" xref="S5.SS1.p2.18.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.18.m3.1c">p_{i}^{t}</annotation></semantics></math>s. Finally, the server updates the federated policy as</p>
<table id="A4.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E8.m1.1" class="ltx_Math" alttext="\displaystyle\pi_{\text{fed}}^{t+1}" display="inline"><semantics id="S5.E8.m1.1a"><msubsup id="S5.E8.m1.1.1" xref="S5.E8.m1.1.1.cmml"><mi id="S5.E8.m1.1.1.2.2" xref="S5.E8.m1.1.1.2.2.cmml">π</mi><mtext id="S5.E8.m1.1.1.2.3" xref="S5.E8.m1.1.1.2.3a.cmml">fed</mtext><mrow id="S5.E8.m1.1.1.3" xref="S5.E8.m1.1.1.3.cmml"><mi id="S5.E8.m1.1.1.3.2" xref="S5.E8.m1.1.1.3.2.cmml">t</mi><mo id="S5.E8.m1.1.1.3.1" xref="S5.E8.m1.1.1.3.1.cmml">+</mo><mn id="S5.E8.m1.1.1.3.3" xref="S5.E8.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.E8.m1.1b"><apply id="S5.E8.m1.1.1.cmml" xref="S5.E8.m1.1.1"><csymbol cd="ambiguous" id="S5.E8.m1.1.1.1.cmml" xref="S5.E8.m1.1.1">superscript</csymbol><apply id="S5.E8.m1.1.1.2.cmml" xref="S5.E8.m1.1.1"><csymbol cd="ambiguous" id="S5.E8.m1.1.1.2.1.cmml" xref="S5.E8.m1.1.1">subscript</csymbol><ci id="S5.E8.m1.1.1.2.2.cmml" xref="S5.E8.m1.1.1.2.2">𝜋</ci><ci id="S5.E8.m1.1.1.2.3a.cmml" xref="S5.E8.m1.1.1.2.3"><mtext mathsize="70%" id="S5.E8.m1.1.1.2.3.cmml" xref="S5.E8.m1.1.1.2.3">fed</mtext></ci></apply><apply id="S5.E8.m1.1.1.3.cmml" xref="S5.E8.m1.1.1.3"><plus id="S5.E8.m1.1.1.3.1.cmml" xref="S5.E8.m1.1.1.3.1"></plus><ci id="S5.E8.m1.1.1.3.2.cmml" xref="S5.E8.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S5.E8.m1.1.1.3.3.cmml" xref="S5.E8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E8.m1.1c">\displaystyle\pi_{\text{fed}}^{t+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E8.m2.2" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{|\mathcal{N}|}w^{t}_{i}\pi_{i}^{t}." display="inline"><semantics id="S5.E8.m2.2a"><mrow id="S5.E8.m2.2.2.1" xref="S5.E8.m2.2.2.1.1.cmml"><mrow id="S5.E8.m2.2.2.1.1" xref="S5.E8.m2.2.2.1.1.cmml"><mi id="S5.E8.m2.2.2.1.1.2" xref="S5.E8.m2.2.2.1.1.2.cmml"></mi><mo id="S5.E8.m2.2.2.1.1.1" xref="S5.E8.m2.2.2.1.1.1.cmml">=</mo><mrow id="S5.E8.m2.2.2.1.1.3" xref="S5.E8.m2.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="S5.E8.m2.2.2.1.1.3.1" xref="S5.E8.m2.2.2.1.1.3.1.cmml"><munderover id="S5.E8.m2.2.2.1.1.3.1a" xref="S5.E8.m2.2.2.1.1.3.1.cmml"><mo movablelimits="false" id="S5.E8.m2.2.2.1.1.3.1.2.2" xref="S5.E8.m2.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S5.E8.m2.2.2.1.1.3.1.2.3" xref="S5.E8.m2.2.2.1.1.3.1.2.3.cmml"><mi id="S5.E8.m2.2.2.1.1.3.1.2.3.2" xref="S5.E8.m2.2.2.1.1.3.1.2.3.2.cmml">i</mi><mo id="S5.E8.m2.2.2.1.1.3.1.2.3.1" xref="S5.E8.m2.2.2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S5.E8.m2.2.2.1.1.3.1.2.3.3" xref="S5.E8.m2.2.2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S5.E8.m2.1.1.1.3" xref="S5.E8.m2.1.1.1.2.cmml"><mo stretchy="false" id="S5.E8.m2.1.1.1.3.1" xref="S5.E8.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E8.m2.1.1.1.1" xref="S5.E8.m2.1.1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S5.E8.m2.1.1.1.3.2" xref="S5.E8.m2.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S5.E8.m2.2.2.1.1.3.2" xref="S5.E8.m2.2.2.1.1.3.2.cmml"><msubsup id="S5.E8.m2.2.2.1.1.3.2.2" xref="S5.E8.m2.2.2.1.1.3.2.2.cmml"><mi id="S5.E8.m2.2.2.1.1.3.2.2.2.2" xref="S5.E8.m2.2.2.1.1.3.2.2.2.2.cmml">w</mi><mi id="S5.E8.m2.2.2.1.1.3.2.2.3" xref="S5.E8.m2.2.2.1.1.3.2.2.3.cmml">i</mi><mi id="S5.E8.m2.2.2.1.1.3.2.2.2.3" xref="S5.E8.m2.2.2.1.1.3.2.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.E8.m2.2.2.1.1.3.2.1" xref="S5.E8.m2.2.2.1.1.3.2.1.cmml">​</mo><msubsup id="S5.E8.m2.2.2.1.1.3.2.3" xref="S5.E8.m2.2.2.1.1.3.2.3.cmml"><mi id="S5.E8.m2.2.2.1.1.3.2.3.2.2" xref="S5.E8.m2.2.2.1.1.3.2.3.2.2.cmml">π</mi><mi id="S5.E8.m2.2.2.1.1.3.2.3.2.3" xref="S5.E8.m2.2.2.1.1.3.2.3.2.3.cmml">i</mi><mi id="S5.E8.m2.2.2.1.1.3.2.3.3" xref="S5.E8.m2.2.2.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S5.E8.m2.2.2.1.2" xref="S5.E8.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E8.m2.2b"><apply id="S5.E8.m2.2.2.1.1.cmml" xref="S5.E8.m2.2.2.1"><eq id="S5.E8.m2.2.2.1.1.1.cmml" xref="S5.E8.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S5.E8.m2.2.2.1.1.2.cmml" xref="S5.E8.m2.2.2.1.1.2">absent</csymbol><apply id="S5.E8.m2.2.2.1.1.3.cmml" xref="S5.E8.m2.2.2.1.1.3"><apply id="S5.E8.m2.2.2.1.1.3.1.cmml" xref="S5.E8.m2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.1.1.cmml" xref="S5.E8.m2.2.2.1.1.3.1">superscript</csymbol><apply id="S5.E8.m2.2.2.1.1.3.1.2.cmml" xref="S5.E8.m2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.1.2.1.cmml" xref="S5.E8.m2.2.2.1.1.3.1">subscript</csymbol><sum id="S5.E8.m2.2.2.1.1.3.1.2.2.cmml" xref="S5.E8.m2.2.2.1.1.3.1.2.2"></sum><apply id="S5.E8.m2.2.2.1.1.3.1.2.3.cmml" xref="S5.E8.m2.2.2.1.1.3.1.2.3"><eq id="S5.E8.m2.2.2.1.1.3.1.2.3.1.cmml" xref="S5.E8.m2.2.2.1.1.3.1.2.3.1"></eq><ci id="S5.E8.m2.2.2.1.1.3.1.2.3.2.cmml" xref="S5.E8.m2.2.2.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S5.E8.m2.2.2.1.1.3.1.2.3.3.cmml" xref="S5.E8.m2.2.2.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E8.m2.1.1.1.2.cmml" xref="S5.E8.m2.1.1.1.3"><abs id="S5.E8.m2.1.1.1.2.1.cmml" xref="S5.E8.m2.1.1.1.3.1"></abs><ci id="S5.E8.m2.1.1.1.1.cmml" xref="S5.E8.m2.1.1.1.1">𝒩</ci></apply></apply><apply id="S5.E8.m2.2.2.1.1.3.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2"><times id="S5.E8.m2.2.2.1.1.3.2.1.cmml" xref="S5.E8.m2.2.2.1.1.3.2.1"></times><apply id="S5.E8.m2.2.2.1.1.3.2.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.2.2.1.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2">subscript</csymbol><apply id="S5.E8.m2.2.2.1.1.3.2.2.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.2.2.2.1.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2">superscript</csymbol><ci id="S5.E8.m2.2.2.1.1.3.2.2.2.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2.2.2">𝑤</ci><ci id="S5.E8.m2.2.2.1.1.3.2.2.2.3.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2.2.3">𝑡</ci></apply><ci id="S5.E8.m2.2.2.1.1.3.2.2.3.cmml" xref="S5.E8.m2.2.2.1.1.3.2.2.3">𝑖</ci></apply><apply id="S5.E8.m2.2.2.1.1.3.2.3.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.2.3.1.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3">superscript</csymbol><apply id="S5.E8.m2.2.2.1.1.3.2.3.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E8.m2.2.2.1.1.3.2.3.2.1.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.E8.m2.2.2.1.1.3.2.3.2.2.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3.2.2">𝜋</ci><ci id="S5.E8.m2.2.2.1.1.3.2.3.2.3.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S5.E8.m2.2.2.1.1.3.2.3.3.cmml" xref="S5.E8.m2.2.2.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E8.m2.2c">\displaystyle=\sum_{i=1}^{|\mathcal{N}|}w^{t}_{i}\pi_{i}^{t}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Federated Optimism for Critic Training</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.3" class="ltx_p">The critic in our algorithm plays two major roles. First, offline RL for policy updates at each client requires policy evaluation using local data. Second, policy evaluation by the critic determines the priority <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="p_{i}^{t}" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><msubsup id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2.2" xref="S5.SS2.p1.1.m1.1.1.2.2.cmml">p</mi><mi id="S5.SS2.p1.1.m1.1.1.2.3" xref="S5.SS2.p1.1.m1.1.1.2.3.cmml">i</mi><mi id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.2.1.cmml" xref="S5.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.1.2.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2.2">𝑝</ci><ci id="S5.SS2.p1.1.m1.1.1.2.3.cmml" xref="S5.SS2.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">p_{i}^{t}</annotation></semantics></math> of the local policy at client <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">i</annotation></semantics></math> for ensemble learning during each round <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">t</annotation></semantics></math> of federation. We desire a local critic at each client that can utilize the knowledge from the ensemble of critics across all clients while also being tuned to the local data used for policy evaluation.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p">A critic based on offline data suffers from extrapolation errors as state-actions pairs not seen in the local dataset will be erroneously estimated, greatly impacting actor-critic style policy updates in federated offline RL. Since the federated policy is derived from the set of local policies, it may take actions not seen in any client’s local dataset. This problem is exacerbated when the local policy at the beginning of each communication round is initialized to the federated policy. We introduce the notion of <span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_italic">federated optimism</span> to train local critics, wherein critics leverage the wisdom of the crowd and are encouraged to be optimistic. We achieve this federated optimism via two steps.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.2" class="ltx_p">First, we use an ensemble-directed federation of the critics, where the local critic of client <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">i</annotation></semantics></math> at round <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">t</annotation></semantics></math> is weighed according to its merit to compute the federated critic as</p>
<table id="A4.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E9.m1.2" class="ltx_Math" alttext="\displaystyle Q_{\text{fed}}^{t+1}=\sum_{i=1}^{|\mathcal{N}|}w^{t}_{i}Q_{i}^{t}." display="inline"><semantics id="S5.E9.m1.2a"><mrow id="S5.E9.m1.2.2.1" xref="S5.E9.m1.2.2.1.1.cmml"><mrow id="S5.E9.m1.2.2.1.1" xref="S5.E9.m1.2.2.1.1.cmml"><msubsup id="S5.E9.m1.2.2.1.1.2" xref="S5.E9.m1.2.2.1.1.2.cmml"><mi id="S5.E9.m1.2.2.1.1.2.2.2" xref="S5.E9.m1.2.2.1.1.2.2.2.cmml">Q</mi><mtext id="S5.E9.m1.2.2.1.1.2.2.3" xref="S5.E9.m1.2.2.1.1.2.2.3a.cmml">fed</mtext><mrow id="S5.E9.m1.2.2.1.1.2.3" xref="S5.E9.m1.2.2.1.1.2.3.cmml"><mi id="S5.E9.m1.2.2.1.1.2.3.2" xref="S5.E9.m1.2.2.1.1.2.3.2.cmml">t</mi><mo id="S5.E9.m1.2.2.1.1.2.3.1" xref="S5.E9.m1.2.2.1.1.2.3.1.cmml">+</mo><mn id="S5.E9.m1.2.2.1.1.2.3.3" xref="S5.E9.m1.2.2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.E9.m1.2.2.1.1.1" xref="S5.E9.m1.2.2.1.1.1.cmml">=</mo><mrow id="S5.E9.m1.2.2.1.1.3" xref="S5.E9.m1.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="S5.E9.m1.2.2.1.1.3.1" xref="S5.E9.m1.2.2.1.1.3.1.cmml"><munderover id="S5.E9.m1.2.2.1.1.3.1a" xref="S5.E9.m1.2.2.1.1.3.1.cmml"><mo movablelimits="false" id="S5.E9.m1.2.2.1.1.3.1.2.2" xref="S5.E9.m1.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S5.E9.m1.2.2.1.1.3.1.2.3" xref="S5.E9.m1.2.2.1.1.3.1.2.3.cmml"><mi id="S5.E9.m1.2.2.1.1.3.1.2.3.2" xref="S5.E9.m1.2.2.1.1.3.1.2.3.2.cmml">i</mi><mo id="S5.E9.m1.2.2.1.1.3.1.2.3.1" xref="S5.E9.m1.2.2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S5.E9.m1.2.2.1.1.3.1.2.3.3" xref="S5.E9.m1.2.2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S5.E9.m1.1.1.1.3" xref="S5.E9.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E9.m1.1.1.1.3.1" xref="S5.E9.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.E9.m1.1.1.1.1" xref="S5.E9.m1.1.1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S5.E9.m1.1.1.1.3.2" xref="S5.E9.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S5.E9.m1.2.2.1.1.3.2" xref="S5.E9.m1.2.2.1.1.3.2.cmml"><msubsup id="S5.E9.m1.2.2.1.1.3.2.2" xref="S5.E9.m1.2.2.1.1.3.2.2.cmml"><mi id="S5.E9.m1.2.2.1.1.3.2.2.2.2" xref="S5.E9.m1.2.2.1.1.3.2.2.2.2.cmml">w</mi><mi id="S5.E9.m1.2.2.1.1.3.2.2.3" xref="S5.E9.m1.2.2.1.1.3.2.2.3.cmml">i</mi><mi id="S5.E9.m1.2.2.1.1.3.2.2.2.3" xref="S5.E9.m1.2.2.1.1.3.2.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.E9.m1.2.2.1.1.3.2.1" xref="S5.E9.m1.2.2.1.1.3.2.1.cmml">​</mo><msubsup id="S5.E9.m1.2.2.1.1.3.2.3" xref="S5.E9.m1.2.2.1.1.3.2.3.cmml"><mi id="S5.E9.m1.2.2.1.1.3.2.3.2.2" xref="S5.E9.m1.2.2.1.1.3.2.3.2.2.cmml">Q</mi><mi id="S5.E9.m1.2.2.1.1.3.2.3.2.3" xref="S5.E9.m1.2.2.1.1.3.2.3.2.3.cmml">i</mi><mi id="S5.E9.m1.2.2.1.1.3.2.3.3" xref="S5.E9.m1.2.2.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S5.E9.m1.2.2.1.2" xref="S5.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E9.m1.2b"><apply id="S5.E9.m1.2.2.1.1.cmml" xref="S5.E9.m1.2.2.1"><eq id="S5.E9.m1.2.2.1.1.1.cmml" xref="S5.E9.m1.2.2.1.1.1"></eq><apply id="S5.E9.m1.2.2.1.1.2.cmml" xref="S5.E9.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.2.1.cmml" xref="S5.E9.m1.2.2.1.1.2">superscript</csymbol><apply id="S5.E9.m1.2.2.1.1.2.2.cmml" xref="S5.E9.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.2.2.1.cmml" xref="S5.E9.m1.2.2.1.1.2">subscript</csymbol><ci id="S5.E9.m1.2.2.1.1.2.2.2.cmml" xref="S5.E9.m1.2.2.1.1.2.2.2">𝑄</ci><ci id="S5.E9.m1.2.2.1.1.2.2.3a.cmml" xref="S5.E9.m1.2.2.1.1.2.2.3"><mtext mathsize="70%" id="S5.E9.m1.2.2.1.1.2.2.3.cmml" xref="S5.E9.m1.2.2.1.1.2.2.3">fed</mtext></ci></apply><apply id="S5.E9.m1.2.2.1.1.2.3.cmml" xref="S5.E9.m1.2.2.1.1.2.3"><plus id="S5.E9.m1.2.2.1.1.2.3.1.cmml" xref="S5.E9.m1.2.2.1.1.2.3.1"></plus><ci id="S5.E9.m1.2.2.1.1.2.3.2.cmml" xref="S5.E9.m1.2.2.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.E9.m1.2.2.1.1.2.3.3.cmml" xref="S5.E9.m1.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S5.E9.m1.2.2.1.1.3.cmml" xref="S5.E9.m1.2.2.1.1.3"><apply id="S5.E9.m1.2.2.1.1.3.1.cmml" xref="S5.E9.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.1.1.cmml" xref="S5.E9.m1.2.2.1.1.3.1">superscript</csymbol><apply id="S5.E9.m1.2.2.1.1.3.1.2.cmml" xref="S5.E9.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.1.2.1.cmml" xref="S5.E9.m1.2.2.1.1.3.1">subscript</csymbol><sum id="S5.E9.m1.2.2.1.1.3.1.2.2.cmml" xref="S5.E9.m1.2.2.1.1.3.1.2.2"></sum><apply id="S5.E9.m1.2.2.1.1.3.1.2.3.cmml" xref="S5.E9.m1.2.2.1.1.3.1.2.3"><eq id="S5.E9.m1.2.2.1.1.3.1.2.3.1.cmml" xref="S5.E9.m1.2.2.1.1.3.1.2.3.1"></eq><ci id="S5.E9.m1.2.2.1.1.3.1.2.3.2.cmml" xref="S5.E9.m1.2.2.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S5.E9.m1.2.2.1.1.3.1.2.3.3.cmml" xref="S5.E9.m1.2.2.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S5.E9.m1.1.1.1.2.cmml" xref="S5.E9.m1.1.1.1.3"><abs id="S5.E9.m1.1.1.1.2.1.cmml" xref="S5.E9.m1.1.1.1.3.1"></abs><ci id="S5.E9.m1.1.1.1.1.cmml" xref="S5.E9.m1.1.1.1.1">𝒩</ci></apply></apply><apply id="S5.E9.m1.2.2.1.1.3.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2"><times id="S5.E9.m1.2.2.1.1.3.2.1.cmml" xref="S5.E9.m1.2.2.1.1.3.2.1"></times><apply id="S5.E9.m1.2.2.1.1.3.2.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.2.2.1.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2">subscript</csymbol><apply id="S5.E9.m1.2.2.1.1.3.2.2.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2">superscript</csymbol><ci id="S5.E9.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2.2.2">𝑤</ci><ci id="S5.E9.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2.2.3">𝑡</ci></apply><ci id="S5.E9.m1.2.2.1.1.3.2.2.3.cmml" xref="S5.E9.m1.2.2.1.1.3.2.2.3">𝑖</ci></apply><apply id="S5.E9.m1.2.2.1.1.3.2.3.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.2.3.1.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3">superscript</csymbol><apply id="S5.E9.m1.2.2.1.1.3.2.3.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E9.m1.2.2.1.1.3.2.3.2.1.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.E9.m1.2.2.1.1.3.2.3.2.2.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3.2.2">𝑄</ci><ci id="S5.E9.m1.2.2.1.1.3.2.3.2.3.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S5.E9.m1.2.2.1.1.3.2.3.3.cmml" xref="S5.E9.m1.2.2.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E9.m1.2c">\displaystyle Q_{\text{fed}}^{t+1}=\sum_{i=1}^{|\mathcal{N}|}w^{t}_{i}Q_{i}^{t}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.p3.3" class="ltx_p">Such a priority-weighted averaging ensures that the critics from clients with good policies significantly influence the federated critic.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.8" class="ltx_p">Second, for the local critic update, we choose the target value as the maximum value between the local critic and the federated critic, given by</p>
<table id="A4.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E10.m1.12" class="ltx_Math" alttext="\displaystyle\tilde{Q}_{i}^{(t,k)}(s,a)=\max\left(Q_{i}^{(t,k)}(s,a),Q_{\text{fed}}^{t}(s,a)\right)," display="inline"><semantics id="S5.E10.m1.12a"><mrow id="S5.E10.m1.12.12.1" xref="S5.E10.m1.12.12.1.1.cmml"><mrow id="S5.E10.m1.12.12.1.1" xref="S5.E10.m1.12.12.1.1.cmml"><mrow id="S5.E10.m1.12.12.1.1.4" xref="S5.E10.m1.12.12.1.1.4.cmml"><msubsup id="S5.E10.m1.12.12.1.1.4.2" xref="S5.E10.m1.12.12.1.1.4.2.cmml"><mover accent="true" id="S5.E10.m1.12.12.1.1.4.2.2.2" xref="S5.E10.m1.12.12.1.1.4.2.2.2.cmml"><mi id="S5.E10.m1.12.12.1.1.4.2.2.2.2" xref="S5.E10.m1.12.12.1.1.4.2.2.2.2.cmml">Q</mi><mo id="S5.E10.m1.12.12.1.1.4.2.2.2.1" xref="S5.E10.m1.12.12.1.1.4.2.2.2.1.cmml">~</mo></mover><mi id="S5.E10.m1.12.12.1.1.4.2.2.3" xref="S5.E10.m1.12.12.1.1.4.2.2.3.cmml">i</mi><mrow id="S5.E10.m1.2.2.2.4" xref="S5.E10.m1.2.2.2.3.cmml"><mo stretchy="false" id="S5.E10.m1.2.2.2.4.1" xref="S5.E10.m1.2.2.2.3.cmml">(</mo><mi id="S5.E10.m1.1.1.1.1" xref="S5.E10.m1.1.1.1.1.cmml">t</mi><mo id="S5.E10.m1.2.2.2.4.2" xref="S5.E10.m1.2.2.2.3.cmml">,</mo><mi id="S5.E10.m1.2.2.2.2" xref="S5.E10.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.E10.m1.2.2.2.4.3" xref="S5.E10.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S5.E10.m1.12.12.1.1.4.1" xref="S5.E10.m1.12.12.1.1.4.1.cmml">​</mo><mrow id="S5.E10.m1.12.12.1.1.4.3.2" xref="S5.E10.m1.12.12.1.1.4.3.1.cmml"><mo stretchy="false" id="S5.E10.m1.12.12.1.1.4.3.2.1" xref="S5.E10.m1.12.12.1.1.4.3.1.cmml">(</mo><mi id="S5.E10.m1.5.5" xref="S5.E10.m1.5.5.cmml">s</mi><mo id="S5.E10.m1.12.12.1.1.4.3.2.2" xref="S5.E10.m1.12.12.1.1.4.3.1.cmml">,</mo><mi id="S5.E10.m1.6.6" xref="S5.E10.m1.6.6.cmml">a</mi><mo stretchy="false" id="S5.E10.m1.12.12.1.1.4.3.2.3" xref="S5.E10.m1.12.12.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.12.12.1.1.3" xref="S5.E10.m1.12.12.1.1.3.cmml">=</mo><mrow id="S5.E10.m1.12.12.1.1.2.2" xref="S5.E10.m1.12.12.1.1.2.3.cmml"><mi id="S5.E10.m1.11.11" xref="S5.E10.m1.11.11.cmml">max</mi><mo id="S5.E10.m1.12.12.1.1.2.2a" xref="S5.E10.m1.12.12.1.1.2.3.cmml">⁡</mo><mrow id="S5.E10.m1.12.12.1.1.2.2.2" xref="S5.E10.m1.12.12.1.1.2.3.cmml"><mo id="S5.E10.m1.12.12.1.1.2.2.2.3" xref="S5.E10.m1.12.12.1.1.2.3.cmml">(</mo><mrow id="S5.E10.m1.12.12.1.1.1.1.1.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.cmml"><msubsup id="S5.E10.m1.12.12.1.1.1.1.1.1.2" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.cmml"><mi id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.2" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.2.cmml">Q</mi><mi id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.3" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S5.E10.m1.4.4.2.4" xref="S5.E10.m1.4.4.2.3.cmml"><mo stretchy="false" id="S5.E10.m1.4.4.2.4.1" xref="S5.E10.m1.4.4.2.3.cmml">(</mo><mi id="S5.E10.m1.3.3.1.1" xref="S5.E10.m1.3.3.1.1.cmml">t</mi><mo id="S5.E10.m1.4.4.2.4.2" xref="S5.E10.m1.4.4.2.3.cmml">,</mo><mi id="S5.E10.m1.4.4.2.2" xref="S5.E10.m1.4.4.2.2.cmml">k</mi><mo stretchy="false" id="S5.E10.m1.4.4.2.4.3" xref="S5.E10.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S5.E10.m1.12.12.1.1.1.1.1.1.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.E10.m1.12.12.1.1.1.1.1.1.3.2" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S5.E10.m1.12.12.1.1.1.1.1.1.3.2.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S5.E10.m1.7.7" xref="S5.E10.m1.7.7.cmml">s</mi><mo id="S5.E10.m1.12.12.1.1.1.1.1.1.3.2.2" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S5.E10.m1.8.8" xref="S5.E10.m1.8.8.cmml">a</mi><mo stretchy="false" id="S5.E10.m1.12.12.1.1.1.1.1.1.3.2.3" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.12.12.1.1.2.2.2.4" xref="S5.E10.m1.12.12.1.1.2.3.cmml">,</mo><mrow id="S5.E10.m1.12.12.1.1.2.2.2.2" xref="S5.E10.m1.12.12.1.1.2.2.2.2.cmml"><msubsup id="S5.E10.m1.12.12.1.1.2.2.2.2.2" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.cmml"><mi id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.2" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.2.cmml">Q</mi><mtext id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3a.cmml">fed</mtext><mi id="S5.E10.m1.12.12.1.1.2.2.2.2.2.3" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.E10.m1.12.12.1.1.2.2.2.2.1" xref="S5.E10.m1.12.12.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S5.E10.m1.12.12.1.1.2.2.2.2.3.2" xref="S5.E10.m1.12.12.1.1.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S5.E10.m1.12.12.1.1.2.2.2.2.3.2.1" xref="S5.E10.m1.12.12.1.1.2.2.2.2.3.1.cmml">(</mo><mi id="S5.E10.m1.9.9" xref="S5.E10.m1.9.9.cmml">s</mi><mo id="S5.E10.m1.12.12.1.1.2.2.2.2.3.2.2" xref="S5.E10.m1.12.12.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S5.E10.m1.10.10" xref="S5.E10.m1.10.10.cmml">a</mi><mo stretchy="false" id="S5.E10.m1.12.12.1.1.2.2.2.2.3.2.3" xref="S5.E10.m1.12.12.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.12.12.1.1.2.2.2.5" xref="S5.E10.m1.12.12.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E10.m1.12.12.1.2" xref="S5.E10.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E10.m1.12b"><apply id="S5.E10.m1.12.12.1.1.cmml" xref="S5.E10.m1.12.12.1"><eq id="S5.E10.m1.12.12.1.1.3.cmml" xref="S5.E10.m1.12.12.1.1.3"></eq><apply id="S5.E10.m1.12.12.1.1.4.cmml" xref="S5.E10.m1.12.12.1.1.4"><times id="S5.E10.m1.12.12.1.1.4.1.cmml" xref="S5.E10.m1.12.12.1.1.4.1"></times><apply id="S5.E10.m1.12.12.1.1.4.2.cmml" xref="S5.E10.m1.12.12.1.1.4.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.4.2.1.cmml" xref="S5.E10.m1.12.12.1.1.4.2">superscript</csymbol><apply id="S5.E10.m1.12.12.1.1.4.2.2.cmml" xref="S5.E10.m1.12.12.1.1.4.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.4.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.4.2">subscript</csymbol><apply id="S5.E10.m1.12.12.1.1.4.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.4.2.2.2"><ci id="S5.E10.m1.12.12.1.1.4.2.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.4.2.2.2.1">~</ci><ci id="S5.E10.m1.12.12.1.1.4.2.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.4.2.2.2.2">𝑄</ci></apply><ci id="S5.E10.m1.12.12.1.1.4.2.2.3.cmml" xref="S5.E10.m1.12.12.1.1.4.2.2.3">𝑖</ci></apply><interval closure="open" id="S5.E10.m1.2.2.2.3.cmml" xref="S5.E10.m1.2.2.2.4"><ci id="S5.E10.m1.1.1.1.1.cmml" xref="S5.E10.m1.1.1.1.1">𝑡</ci><ci id="S5.E10.m1.2.2.2.2.cmml" xref="S5.E10.m1.2.2.2.2">𝑘</ci></interval></apply><interval closure="open" id="S5.E10.m1.12.12.1.1.4.3.1.cmml" xref="S5.E10.m1.12.12.1.1.4.3.2"><ci id="S5.E10.m1.5.5.cmml" xref="S5.E10.m1.5.5">𝑠</ci><ci id="S5.E10.m1.6.6.cmml" xref="S5.E10.m1.6.6">𝑎</ci></interval></apply><apply id="S5.E10.m1.12.12.1.1.2.3.cmml" xref="S5.E10.m1.12.12.1.1.2.2"><max id="S5.E10.m1.11.11.cmml" xref="S5.E10.m1.11.11"></max><apply id="S5.E10.m1.12.12.1.1.1.1.1.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1"><times id="S5.E10.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.1"></times><apply id="S5.E10.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.1.1.1.1.2.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.2">𝑄</ci><ci id="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><interval closure="open" id="S5.E10.m1.4.4.2.3.cmml" xref="S5.E10.m1.4.4.2.4"><ci id="S5.E10.m1.3.3.1.1.cmml" xref="S5.E10.m1.3.3.1.1">𝑡</ci><ci id="S5.E10.m1.4.4.2.2.cmml" xref="S5.E10.m1.4.4.2.2">𝑘</ci></interval></apply><interval closure="open" id="S5.E10.m1.12.12.1.1.1.1.1.1.3.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.2"><ci id="S5.E10.m1.7.7.cmml" xref="S5.E10.m1.7.7">𝑠</ci><ci id="S5.E10.m1.8.8.cmml" xref="S5.E10.m1.8.8">𝑎</ci></interval></apply><apply id="S5.E10.m1.12.12.1.1.2.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2"><times id="S5.E10.m1.12.12.1.1.2.2.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.1"></times><apply id="S5.E10.m1.12.12.1.1.2.2.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.2.2.2.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2">superscript</csymbol><apply id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.1.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2">subscript</csymbol><ci id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.2.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.2">𝑄</ci><ci id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3a.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.2.3">fed</mtext></ci></apply><ci id="S5.E10.m1.12.12.1.1.2.2.2.2.2.3.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.2.3">𝑡</ci></apply><interval closure="open" id="S5.E10.m1.12.12.1.1.2.2.2.2.3.1.cmml" xref="S5.E10.m1.12.12.1.1.2.2.2.2.3.2"><ci id="S5.E10.m1.9.9.cmml" xref="S5.E10.m1.9.9">𝑠</ci><ci id="S5.E10.m1.10.10.cmml" xref="S5.E10.m1.10.10">𝑎</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E10.m1.12c">\displaystyle\tilde{Q}_{i}^{(t,k)}(s,a)=\max\left(Q_{i}^{(t,k)}(s,a),Q_{\text{fed}}^{t}(s,a)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.p4.5" class="ltx_p">where <math id="S5.SS2.p4.1.m1.4" class="ltx_Math" alttext="\tilde{Q}_{i}^{(t,k)}(s,a)" display="inline"><semantics id="S5.SS2.p4.1.m1.4a"><mrow id="S5.SS2.p4.1.m1.4.5" xref="S5.SS2.p4.1.m1.4.5.cmml"><msubsup id="S5.SS2.p4.1.m1.4.5.2" xref="S5.SS2.p4.1.m1.4.5.2.cmml"><mover accent="true" id="S5.SS2.p4.1.m1.4.5.2.2.2" xref="S5.SS2.p4.1.m1.4.5.2.2.2.cmml"><mi id="S5.SS2.p4.1.m1.4.5.2.2.2.2" xref="S5.SS2.p4.1.m1.4.5.2.2.2.2.cmml">Q</mi><mo id="S5.SS2.p4.1.m1.4.5.2.2.2.1" xref="S5.SS2.p4.1.m1.4.5.2.2.2.1.cmml">~</mo></mover><mi id="S5.SS2.p4.1.m1.4.5.2.2.3" xref="S5.SS2.p4.1.m1.4.5.2.2.3.cmml">i</mi><mrow id="S5.SS2.p4.1.m1.2.2.2.4" xref="S5.SS2.p4.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S5.SS2.p4.1.m1.2.2.2.4.1" xref="S5.SS2.p4.1.m1.2.2.2.3.cmml">(</mo><mi id="S5.SS2.p4.1.m1.1.1.1.1" xref="S5.SS2.p4.1.m1.1.1.1.1.cmml">t</mi><mo id="S5.SS2.p4.1.m1.2.2.2.4.2" xref="S5.SS2.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p4.1.m1.2.2.2.2" xref="S5.SS2.p4.1.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.SS2.p4.1.m1.2.2.2.4.3" xref="S5.SS2.p4.1.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S5.SS2.p4.1.m1.4.5.1" xref="S5.SS2.p4.1.m1.4.5.1.cmml">​</mo><mrow id="S5.SS2.p4.1.m1.4.5.3.2" xref="S5.SS2.p4.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS2.p4.1.m1.4.5.3.2.1" xref="S5.SS2.p4.1.m1.4.5.3.1.cmml">(</mo><mi id="S5.SS2.p4.1.m1.3.3" xref="S5.SS2.p4.1.m1.3.3.cmml">s</mi><mo id="S5.SS2.p4.1.m1.4.5.3.2.2" xref="S5.SS2.p4.1.m1.4.5.3.1.cmml">,</mo><mi id="S5.SS2.p4.1.m1.4.4" xref="S5.SS2.p4.1.m1.4.4.cmml">a</mi><mo stretchy="false" id="S5.SS2.p4.1.m1.4.5.3.2.3" xref="S5.SS2.p4.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.4b"><apply id="S5.SS2.p4.1.m1.4.5.cmml" xref="S5.SS2.p4.1.m1.4.5"><times id="S5.SS2.p4.1.m1.4.5.1.cmml" xref="S5.SS2.p4.1.m1.4.5.1"></times><apply id="S5.SS2.p4.1.m1.4.5.2.cmml" xref="S5.SS2.p4.1.m1.4.5.2"><csymbol cd="ambiguous" id="S5.SS2.p4.1.m1.4.5.2.1.cmml" xref="S5.SS2.p4.1.m1.4.5.2">superscript</csymbol><apply id="S5.SS2.p4.1.m1.4.5.2.2.cmml" xref="S5.SS2.p4.1.m1.4.5.2"><csymbol cd="ambiguous" id="S5.SS2.p4.1.m1.4.5.2.2.1.cmml" xref="S5.SS2.p4.1.m1.4.5.2">subscript</csymbol><apply id="S5.SS2.p4.1.m1.4.5.2.2.2.cmml" xref="S5.SS2.p4.1.m1.4.5.2.2.2"><ci id="S5.SS2.p4.1.m1.4.5.2.2.2.1.cmml" xref="S5.SS2.p4.1.m1.4.5.2.2.2.1">~</ci><ci id="S5.SS2.p4.1.m1.4.5.2.2.2.2.cmml" xref="S5.SS2.p4.1.m1.4.5.2.2.2.2">𝑄</ci></apply><ci id="S5.SS2.p4.1.m1.4.5.2.2.3.cmml" xref="S5.SS2.p4.1.m1.4.5.2.2.3">𝑖</ci></apply><interval closure="open" id="S5.SS2.p4.1.m1.2.2.2.3.cmml" xref="S5.SS2.p4.1.m1.2.2.2.4"><ci id="S5.SS2.p4.1.m1.1.1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1.1.1">𝑡</ci><ci id="S5.SS2.p4.1.m1.2.2.2.2.cmml" xref="S5.SS2.p4.1.m1.2.2.2.2">𝑘</ci></interval></apply><interval closure="open" id="S5.SS2.p4.1.m1.4.5.3.1.cmml" xref="S5.SS2.p4.1.m1.4.5.3.2"><ci id="S5.SS2.p4.1.m1.3.3.cmml" xref="S5.SS2.p4.1.m1.3.3">𝑠</ci><ci id="S5.SS2.p4.1.m1.4.4.cmml" xref="S5.SS2.p4.1.m1.4.4">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.4c">\tilde{Q}_{i}^{(t,k)}(s,a)</annotation></semantics></math> is the target value of state <math id="S5.SS2.p4.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S5.SS2.p4.2.m2.1a"><mi id="S5.SS2.p4.2.m2.1.1" xref="S5.SS2.p4.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.2.m2.1b"><ci id="S5.SS2.p4.2.m2.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.2.m2.1c">s</annotation></semantics></math> and action <math id="S5.SS2.p4.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S5.SS2.p4.3.m3.1a"><mi id="S5.SS2.p4.3.m3.1.1" xref="S5.SS2.p4.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.3.m3.1b"><ci id="S5.SS2.p4.3.m3.1.1.cmml" xref="S5.SS2.p4.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.3.m3.1c">a</annotation></semantics></math> at the <math id="S5.SS2.p4.4.m4.1" class="ltx_Math" alttext="t^{\text{th}}" display="inline"><semantics id="S5.SS2.p4.4.m4.1a"><msup id="S5.SS2.p4.4.m4.1.1" xref="S5.SS2.p4.4.m4.1.1.cmml"><mi id="S5.SS2.p4.4.m4.1.1.2" xref="S5.SS2.p4.4.m4.1.1.2.cmml">t</mi><mtext id="S5.SS2.p4.4.m4.1.1.3" xref="S5.SS2.p4.4.m4.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.4.m4.1b"><apply id="S5.SS2.p4.4.m4.1.1.cmml" xref="S5.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.1.1.1.cmml" xref="S5.SS2.p4.4.m4.1.1">superscript</csymbol><ci id="S5.SS2.p4.4.m4.1.1.2.cmml" xref="S5.SS2.p4.4.m4.1.1.2">𝑡</ci><ci id="S5.SS2.p4.4.m4.1.1.3a.cmml" xref="S5.SS2.p4.4.m4.1.1.3"><mtext mathsize="70%" id="S5.SS2.p4.4.m4.1.1.3.cmml" xref="S5.SS2.p4.4.m4.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.4.m4.1c">t^{\text{th}}</annotation></semantics></math> round of federation after <math id="S5.SS2.p4.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS2.p4.5.m5.1a"><mi id="S5.SS2.p4.5.m5.1.1" xref="S5.SS2.p4.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.5.m5.1b"><ci id="S5.SS2.p4.5.m5.1.1.cmml" xref="S5.SS2.p4.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.5.m5.1c">k</annotation></semantics></math> local critic updates. This ensures that the local critic has an optimistic (but likely feasible) target seen by the system. Using this optimistic target in the Bellman error, we update the local critic as</p>
<table id="A4.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E11.m1.6" class="ltx_math_unparsed" alttext="\displaystyle Q^{(t,k+1)}_{i}=\operatorname*{arg\,min}_{Q}\leavevmode\nobreak\ \mathbb{E}_{(s,a,r,s^{\prime})\sim\mathcal{D}_{i}}[(r" display="inline"><semantics id="S5.E11.m1.6a"><mrow id="S5.E11.m1.6b"><msubsup id="S5.E11.m1.6.7"><mi id="S5.E11.m1.6.7.2.2">Q</mi><mi id="S5.E11.m1.6.7.3">i</mi><mrow id="S5.E11.m1.2.2.2.2"><mo stretchy="false" id="S5.E11.m1.2.2.2.2.2">(</mo><mi id="S5.E11.m1.1.1.1.1">t</mi><mo id="S5.E11.m1.2.2.2.2.3">,</mo><mrow id="S5.E11.m1.2.2.2.2.1"><mi id="S5.E11.m1.2.2.2.2.1.2">k</mi><mo id="S5.E11.m1.2.2.2.2.1.1">+</mo><mn id="S5.E11.m1.2.2.2.2.1.3">1</mn></mrow><mo stretchy="false" id="S5.E11.m1.2.2.2.2.4">)</mo></mrow></msubsup><mo id="S5.E11.m1.6.8">=</mo><munder id="S5.E11.m1.6.9"><mrow id="S5.E11.m1.6.9.2"><mi id="S5.E11.m1.6.9.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="S5.E11.m1.6.9.2.1">​</mo><mi id="S5.E11.m1.6.9.2.3">min</mi></mrow><mi id="S5.E11.m1.6.9.3">Q</mi></munder><msub id="S5.E11.m1.6.10"><mi id="S5.E11.m1.6.10.2">𝔼</mi><mrow id="S5.E11.m1.6.6.4"><mrow id="S5.E11.m1.6.6.4.4.1"><mo stretchy="false" id="S5.E11.m1.6.6.4.4.1.2">(</mo><mi id="S5.E11.m1.3.3.1.1">s</mi><mo id="S5.E11.m1.6.6.4.4.1.3">,</mo><mi id="S5.E11.m1.4.4.2.2">a</mi><mo id="S5.E11.m1.6.6.4.4.1.4">,</mo><mi id="S5.E11.m1.5.5.3.3">r</mi><mo id="S5.E11.m1.6.6.4.4.1.5">,</mo><msup id="S5.E11.m1.6.6.4.4.1.1"><mi id="S5.E11.m1.6.6.4.4.1.1.2">s</mi><mo id="S5.E11.m1.6.6.4.4.1.1.3">′</mo></msup><mo stretchy="false" id="S5.E11.m1.6.6.4.4.1.6">)</mo></mrow><mo id="S5.E11.m1.6.6.4.5">∼</mo><msub id="S5.E11.m1.6.6.4.6"><mi class="ltx_font_mathcaligraphic" id="S5.E11.m1.6.6.4.6.2">𝒟</mi><mi id="S5.E11.m1.6.6.4.6.3">i</mi></msub></mrow></msub><mrow id="S5.E11.m1.6.11"><mo stretchy="false" id="S5.E11.m1.6.11.1">[</mo><mrow id="S5.E11.m1.6.11.2"><mo stretchy="false" id="S5.E11.m1.6.11.2.1">(</mo><mi id="S5.E11.m1.6.11.2.2">r</mi></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S5.E11.m1.6c">\displaystyle Q^{(t,k+1)}_{i}=\operatorname*{arg\,min}_{Q}\leavevmode\nobreak\ \mathbb{E}_{(s,a,r,s^{\prime})\sim\mathcal{D}_{i}}[(r</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E11.m2.4" class="ltx_math_unparsed" alttext="\displaystyle+\gamma\tilde{Q}_{i}^{(t,k)}(s^{\prime},a^{\prime})-Q(s,a))^{2}]," display="inline"><semantics id="S5.E11.m2.4a"><mrow id="S5.E11.m2.4b"><msup id="S5.E11.m2.4.5"><mrow id="S5.E11.m2.4.5.2"><mo id="S5.E11.m2.4.5.2.1">+</mo><mi id="S5.E11.m2.4.5.2.2">γ</mi><msubsup id="S5.E11.m2.4.5.2.3"><mover accent="true" id="S5.E11.m2.4.5.2.3.2.2"><mi id="S5.E11.m2.4.5.2.3.2.2.2">Q</mi><mo id="S5.E11.m2.4.5.2.3.2.2.1">~</mo></mover><mi id="S5.E11.m2.4.5.2.3.2.3">i</mi><mrow id="S5.E11.m2.2.2.2.4"><mo stretchy="false" id="S5.E11.m2.2.2.2.4.1">(</mo><mi id="S5.E11.m2.1.1.1.1">t</mi><mo id="S5.E11.m2.2.2.2.4.2">,</mo><mi id="S5.E11.m2.2.2.2.2">k</mi><mo stretchy="false" id="S5.E11.m2.2.2.2.4.3">)</mo></mrow></msubsup><mrow id="S5.E11.m2.4.5.2.4"><mo stretchy="false" id="S5.E11.m2.4.5.2.4.1">(</mo><msup id="S5.E11.m2.4.5.2.4.2"><mi id="S5.E11.m2.4.5.2.4.2.2">s</mi><mo id="S5.E11.m2.4.5.2.4.2.3">′</mo></msup><mo id="S5.E11.m2.4.5.2.4.3">,</mo><msup id="S5.E11.m2.4.5.2.4.4"><mi id="S5.E11.m2.4.5.2.4.4.2">a</mi><mo id="S5.E11.m2.4.5.2.4.4.3">′</mo></msup><mo stretchy="false" id="S5.E11.m2.4.5.2.4.5">)</mo></mrow><mo id="S5.E11.m2.4.5.2.5">−</mo><mi id="S5.E11.m2.4.5.2.6">Q</mi><mrow id="S5.E11.m2.4.5.2.7"><mo stretchy="false" id="S5.E11.m2.4.5.2.7.1">(</mo><mi id="S5.E11.m2.3.3">s</mi><mo id="S5.E11.m2.4.5.2.7.2">,</mo><mi id="S5.E11.m2.4.4">a</mi><mo stretchy="false" id="S5.E11.m2.4.5.2.7.3">)</mo></mrow><mo stretchy="false" id="S5.E11.m2.4.5.2.8">)</mo></mrow><mn id="S5.E11.m2.4.5.3">2</mn></msup><mo stretchy="false" id="S5.E11.m2.4.6">]</mo><mo id="S5.E11.m2.4.7">,</mo></mrow><annotation encoding="application/x-tex" id="S5.E11.m2.4c">\displaystyle+\gamma\tilde{Q}_{i}^{(t,k)}(s^{\prime},a^{\prime})-Q(s,a))^{2}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.p4.7" class="ltx_p">where <math id="S5.SS2.p4.6.m1.2" class="ltx_Math" alttext="a^{\prime}=\pi^{(t,k)}_{i}" display="inline"><semantics id="S5.SS2.p4.6.m1.2a"><mrow id="S5.SS2.p4.6.m1.2.3" xref="S5.SS2.p4.6.m1.2.3.cmml"><msup id="S5.SS2.p4.6.m1.2.3.2" xref="S5.SS2.p4.6.m1.2.3.2.cmml"><mi id="S5.SS2.p4.6.m1.2.3.2.2" xref="S5.SS2.p4.6.m1.2.3.2.2.cmml">a</mi><mo id="S5.SS2.p4.6.m1.2.3.2.3" xref="S5.SS2.p4.6.m1.2.3.2.3.cmml">′</mo></msup><mo id="S5.SS2.p4.6.m1.2.3.1" xref="S5.SS2.p4.6.m1.2.3.1.cmml">=</mo><msubsup id="S5.SS2.p4.6.m1.2.3.3" xref="S5.SS2.p4.6.m1.2.3.3.cmml"><mi id="S5.SS2.p4.6.m1.2.3.3.2.2" xref="S5.SS2.p4.6.m1.2.3.3.2.2.cmml">π</mi><mi id="S5.SS2.p4.6.m1.2.3.3.3" xref="S5.SS2.p4.6.m1.2.3.3.3.cmml">i</mi><mrow id="S5.SS2.p4.6.m1.2.2.2.4" xref="S5.SS2.p4.6.m1.2.2.2.3.cmml"><mo stretchy="false" id="S5.SS2.p4.6.m1.2.2.2.4.1" xref="S5.SS2.p4.6.m1.2.2.2.3.cmml">(</mo><mi id="S5.SS2.p4.6.m1.1.1.1.1" xref="S5.SS2.p4.6.m1.1.1.1.1.cmml">t</mi><mo id="S5.SS2.p4.6.m1.2.2.2.4.2" xref="S5.SS2.p4.6.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p4.6.m1.2.2.2.2" xref="S5.SS2.p4.6.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.SS2.p4.6.m1.2.2.2.4.3" xref="S5.SS2.p4.6.m1.2.2.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.6.m1.2b"><apply id="S5.SS2.p4.6.m1.2.3.cmml" xref="S5.SS2.p4.6.m1.2.3"><eq id="S5.SS2.p4.6.m1.2.3.1.cmml" xref="S5.SS2.p4.6.m1.2.3.1"></eq><apply id="S5.SS2.p4.6.m1.2.3.2.cmml" xref="S5.SS2.p4.6.m1.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p4.6.m1.2.3.2.1.cmml" xref="S5.SS2.p4.6.m1.2.3.2">superscript</csymbol><ci id="S5.SS2.p4.6.m1.2.3.2.2.cmml" xref="S5.SS2.p4.6.m1.2.3.2.2">𝑎</ci><ci id="S5.SS2.p4.6.m1.2.3.2.3.cmml" xref="S5.SS2.p4.6.m1.2.3.2.3">′</ci></apply><apply id="S5.SS2.p4.6.m1.2.3.3.cmml" xref="S5.SS2.p4.6.m1.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p4.6.m1.2.3.3.1.cmml" xref="S5.SS2.p4.6.m1.2.3.3">subscript</csymbol><apply id="S5.SS2.p4.6.m1.2.3.3.2.cmml" xref="S5.SS2.p4.6.m1.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p4.6.m1.2.3.3.2.1.cmml" xref="S5.SS2.p4.6.m1.2.3.3">superscript</csymbol><ci id="S5.SS2.p4.6.m1.2.3.3.2.2.cmml" xref="S5.SS2.p4.6.m1.2.3.3.2.2">𝜋</ci><interval closure="open" id="S5.SS2.p4.6.m1.2.2.2.3.cmml" xref="S5.SS2.p4.6.m1.2.2.2.4"><ci id="S5.SS2.p4.6.m1.1.1.1.1.cmml" xref="S5.SS2.p4.6.m1.1.1.1.1">𝑡</ci><ci id="S5.SS2.p4.6.m1.2.2.2.2.cmml" xref="S5.SS2.p4.6.m1.2.2.2.2">𝑘</ci></interval></apply><ci id="S5.SS2.p4.6.m1.2.3.3.3.cmml" xref="S5.SS2.p4.6.m1.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.6.m1.2c">a^{\prime}=\pi^{(t,k)}_{i}</annotation></semantics></math>.
In practice, instead of solving the entire optimization problem described above, we obtain <math id="S5.SS2.p4.7.m2.2" class="ltx_Math" alttext="Q^{(t,k+1)}_{i}" display="inline"><semantics id="S5.SS2.p4.7.m2.2a"><msubsup id="S5.SS2.p4.7.m2.2.3" xref="S5.SS2.p4.7.m2.2.3.cmml"><mi id="S5.SS2.p4.7.m2.2.3.2.2" xref="S5.SS2.p4.7.m2.2.3.2.2.cmml">Q</mi><mi id="S5.SS2.p4.7.m2.2.3.3" xref="S5.SS2.p4.7.m2.2.3.3.cmml">i</mi><mrow id="S5.SS2.p4.7.m2.2.2.2.2" xref="S5.SS2.p4.7.m2.2.2.2.3.cmml"><mo stretchy="false" id="S5.SS2.p4.7.m2.2.2.2.2.2" xref="S5.SS2.p4.7.m2.2.2.2.3.cmml">(</mo><mi id="S5.SS2.p4.7.m2.1.1.1.1" xref="S5.SS2.p4.7.m2.1.1.1.1.cmml">t</mi><mo id="S5.SS2.p4.7.m2.2.2.2.2.3" xref="S5.SS2.p4.7.m2.2.2.2.3.cmml">,</mo><mrow id="S5.SS2.p4.7.m2.2.2.2.2.1" xref="S5.SS2.p4.7.m2.2.2.2.2.1.cmml"><mi id="S5.SS2.p4.7.m2.2.2.2.2.1.2" xref="S5.SS2.p4.7.m2.2.2.2.2.1.2.cmml">k</mi><mo id="S5.SS2.p4.7.m2.2.2.2.2.1.1" xref="S5.SS2.p4.7.m2.2.2.2.2.1.1.cmml">+</mo><mn id="S5.SS2.p4.7.m2.2.2.2.2.1.3" xref="S5.SS2.p4.7.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S5.SS2.p4.7.m2.2.2.2.2.4" xref="S5.SS2.p4.7.m2.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.7.m2.2b"><apply id="S5.SS2.p4.7.m2.2.3.cmml" xref="S5.SS2.p4.7.m2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p4.7.m2.2.3.1.cmml" xref="S5.SS2.p4.7.m2.2.3">subscript</csymbol><apply id="S5.SS2.p4.7.m2.2.3.2.cmml" xref="S5.SS2.p4.7.m2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p4.7.m2.2.3.2.1.cmml" xref="S5.SS2.p4.7.m2.2.3">superscript</csymbol><ci id="S5.SS2.p4.7.m2.2.3.2.2.cmml" xref="S5.SS2.p4.7.m2.2.3.2.2">𝑄</ci><interval closure="open" id="S5.SS2.p4.7.m2.2.2.2.3.cmml" xref="S5.SS2.p4.7.m2.2.2.2.2"><ci id="S5.SS2.p4.7.m2.1.1.1.1.cmml" xref="S5.SS2.p4.7.m2.1.1.1.1">𝑡</ci><apply id="S5.SS2.p4.7.m2.2.2.2.2.1.cmml" xref="S5.SS2.p4.7.m2.2.2.2.2.1"><plus id="S5.SS2.p4.7.m2.2.2.2.2.1.1.cmml" xref="S5.SS2.p4.7.m2.2.2.2.2.1.1"></plus><ci id="S5.SS2.p4.7.m2.2.2.2.2.1.2.cmml" xref="S5.SS2.p4.7.m2.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="S5.SS2.p4.7.m2.2.2.2.2.1.3.cmml" xref="S5.SS2.p4.7.m2.2.2.2.2.1.3">1</cn></apply></interval></apply><ci id="S5.SS2.p4.7.m2.2.3.3.cmml" xref="S5.SS2.p4.7.m2.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.7.m2.2c">Q^{(t,k+1)}_{i}</annotation></semantics></math> after a single gradient update w.r.t. the objective function.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Proximal Policy Update for Heterogeneous Data</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.2" class="ltx_p">While essential in order to set ambitious estimates, an optimistic critic might erroneously estimate the value of <math id="S5.SS3.p1.1.m1.2" class="ltx_Math" alttext="\tilde{Q}_{i}^{(t,k)}" display="inline"><semantics id="S5.SS3.p1.1.m1.2a"><msubsup id="S5.SS3.p1.1.m1.2.3" xref="S5.SS3.p1.1.m1.2.3.cmml"><mover accent="true" id="S5.SS3.p1.1.m1.2.3.2.2" xref="S5.SS3.p1.1.m1.2.3.2.2.cmml"><mi id="S5.SS3.p1.1.m1.2.3.2.2.2" xref="S5.SS3.p1.1.m1.2.3.2.2.2.cmml">Q</mi><mo id="S5.SS3.p1.1.m1.2.3.2.2.1" xref="S5.SS3.p1.1.m1.2.3.2.2.1.cmml">~</mo></mover><mi id="S5.SS3.p1.1.m1.2.3.2.3" xref="S5.SS3.p1.1.m1.2.3.2.3.cmml">i</mi><mrow id="S5.SS3.p1.1.m1.2.2.2.4" xref="S5.SS3.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S5.SS3.p1.1.m1.2.2.2.4.1" xref="S5.SS3.p1.1.m1.2.2.2.3.cmml">(</mo><mi id="S5.SS3.p1.1.m1.1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.1.cmml">t</mi><mo id="S5.SS3.p1.1.m1.2.2.2.4.2" xref="S5.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS3.p1.1.m1.2.2.2.2" xref="S5.SS3.p1.1.m1.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S5.SS3.p1.1.m1.2.2.2.4.3" xref="S5.SS3.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.2b"><apply id="S5.SS3.p1.1.m1.2.3.cmml" xref="S5.SS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.2.3.1.cmml" xref="S5.SS3.p1.1.m1.2.3">superscript</csymbol><apply id="S5.SS3.p1.1.m1.2.3.2.cmml" xref="S5.SS3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.2.3.2.1.cmml" xref="S5.SS3.p1.1.m1.2.3">subscript</csymbol><apply id="S5.SS3.p1.1.m1.2.3.2.2.cmml" xref="S5.SS3.p1.1.m1.2.3.2.2"><ci id="S5.SS3.p1.1.m1.2.3.2.2.1.cmml" xref="S5.SS3.p1.1.m1.2.3.2.2.1">~</ci><ci id="S5.SS3.p1.1.m1.2.3.2.2.2.cmml" xref="S5.SS3.p1.1.m1.2.3.2.2.2">𝑄</ci></apply><ci id="S5.SS3.p1.1.m1.2.3.2.3.cmml" xref="S5.SS3.p1.1.m1.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S5.SS3.p1.1.m1.2.2.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.2.4"><ci id="S5.SS3.p1.1.m1.1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1">𝑡</ci><ci id="S5.SS3.p1.1.m1.2.2.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.2c">\tilde{Q}_{i}^{(t,k)}</annotation></semantics></math>. Therefore, regularizing the local policy update w.r.t. both the local data and the federated policy is crucial. For regularization w.r.t. to the local offline data, we use the same method as in the TD3-BC algorithm and define the local loss function <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{local}}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3a.cmml">local</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">ℒ</ci><ci id="S5.SS3.p1.2.m2.1.1.3a.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">local</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\mathcal{L}_{\text{local}}</annotation></semantics></math> as</p>
<table id="A4.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E12.m1.9" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{local}}(\pi)=\mathbb{E}_{(s,a)\sim\mathcal{D}_{i}}[-Q_{i}^{(t,k)}(s,\pi(s))+(\pi(s)-a)^{2}]." display="inline"><semantics id="S5.E12.m1.9a"><mrow id="S5.E12.m1.9.9.1" xref="S5.E12.m1.9.9.1.1.cmml"><mrow id="S5.E12.m1.9.9.1.1" xref="S5.E12.m1.9.9.1.1.cmml"><mrow id="S5.E12.m1.9.9.1.1.3" xref="S5.E12.m1.9.9.1.1.3.cmml"><msub id="S5.E12.m1.9.9.1.1.3.2" xref="S5.E12.m1.9.9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E12.m1.9.9.1.1.3.2.2" xref="S5.E12.m1.9.9.1.1.3.2.2.cmml">ℒ</mi><mtext id="S5.E12.m1.9.9.1.1.3.2.3" xref="S5.E12.m1.9.9.1.1.3.2.3a.cmml">local</mtext></msub><mo lspace="0em" rspace="0em" id="S5.E12.m1.9.9.1.1.3.1" xref="S5.E12.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S5.E12.m1.9.9.1.1.3.3.2" xref="S5.E12.m1.9.9.1.1.3.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.3.3.2.1" xref="S5.E12.m1.9.9.1.1.3.cmml">(</mo><mi id="S5.E12.m1.5.5" xref="S5.E12.m1.5.5.cmml">π</mi><mo stretchy="false" id="S5.E12.m1.9.9.1.1.3.3.2.2" xref="S5.E12.m1.9.9.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E12.m1.9.9.1.1.2" xref="S5.E12.m1.9.9.1.1.2.cmml">=</mo><mrow id="S5.E12.m1.9.9.1.1.1" xref="S5.E12.m1.9.9.1.1.1.cmml"><msub id="S5.E12.m1.9.9.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.3.cmml"><mi id="S5.E12.m1.9.9.1.1.1.3.2" xref="S5.E12.m1.9.9.1.1.1.3.2.cmml">𝔼</mi><mrow id="S5.E12.m1.2.2.2" xref="S5.E12.m1.2.2.2.cmml"><mrow id="S5.E12.m1.2.2.2.4.2" xref="S5.E12.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S5.E12.m1.2.2.2.4.2.1" xref="S5.E12.m1.2.2.2.4.1.cmml">(</mo><mi id="S5.E12.m1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.cmml">s</mi><mo id="S5.E12.m1.2.2.2.4.2.2" xref="S5.E12.m1.2.2.2.4.1.cmml">,</mo><mi id="S5.E12.m1.2.2.2.2" xref="S5.E12.m1.2.2.2.2.cmml">a</mi><mo stretchy="false" id="S5.E12.m1.2.2.2.4.2.3" xref="S5.E12.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S5.E12.m1.2.2.2.3" xref="S5.E12.m1.2.2.2.3.cmml">∼</mo><msub id="S5.E12.m1.2.2.2.5" xref="S5.E12.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E12.m1.2.2.2.5.2" xref="S5.E12.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S5.E12.m1.2.2.2.5.3" xref="S5.E12.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E12.m1.9.9.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.2.1.cmml">[</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="S5.E12.m1.9.9.1.1.1.1.1.1.1a" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msubsup id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.2.cmml">Q</mi><mi id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S5.E12.m1.4.4.2.4" xref="S5.E12.m1.4.4.2.3.cmml"><mo stretchy="false" id="S5.E12.m1.4.4.2.4.1" xref="S5.E12.m1.4.4.2.3.cmml">(</mo><mi id="S5.E12.m1.3.3.1.1" xref="S5.E12.m1.3.3.1.1.cmml">t</mi><mo id="S5.E12.m1.4.4.2.4.2" xref="S5.E12.m1.4.4.2.3.cmml">,</mo><mi id="S5.E12.m1.4.4.2.2" xref="S5.E12.m1.4.4.2.2.cmml">k</mi><mo stretchy="false" id="S5.E12.m1.4.4.2.4.3" xref="S5.E12.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S5.E12.m1.7.7" xref="S5.E12.m1.7.7.cmml">s</mi><mo id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E12.m1.6.6" xref="S5.E12.m1.6.6.cmml">s</mi><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.4" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E12.m1.9.9.1.1.1.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.3.cmml">+</mo><msup id="S5.E12.m1.9.9.1.1.1.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.cmml"><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.1.cmml">​</mo><mrow id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.3.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.3.2.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml">(</mo><mi id="S5.E12.m1.8.8" xref="S5.E12.m1.8.8.cmml">s</mi><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.3.2.2" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.1" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mi id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml">a</mi></mrow><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mn id="S5.E12.m1.9.9.1.1.1.1.1.1.2.3" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="S5.E12.m1.9.9.1.1.1.1.1.3" xref="S5.E12.m1.9.9.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S5.E12.m1.9.9.1.2" xref="S5.E12.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E12.m1.9b"><apply id="S5.E12.m1.9.9.1.1.cmml" xref="S5.E12.m1.9.9.1"><eq id="S5.E12.m1.9.9.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.2"></eq><apply id="S5.E12.m1.9.9.1.1.3.cmml" xref="S5.E12.m1.9.9.1.1.3"><times id="S5.E12.m1.9.9.1.1.3.1.cmml" xref="S5.E12.m1.9.9.1.1.3.1"></times><apply id="S5.E12.m1.9.9.1.1.3.2.cmml" xref="S5.E12.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S5.E12.m1.9.9.1.1.3.2.1.cmml" xref="S5.E12.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S5.E12.m1.9.9.1.1.3.2.2.cmml" xref="S5.E12.m1.9.9.1.1.3.2.2">ℒ</ci><ci id="S5.E12.m1.9.9.1.1.3.2.3a.cmml" xref="S5.E12.m1.9.9.1.1.3.2.3"><mtext mathsize="70%" id="S5.E12.m1.9.9.1.1.3.2.3.cmml" xref="S5.E12.m1.9.9.1.1.3.2.3">local</mtext></ci></apply><ci id="S5.E12.m1.5.5.cmml" xref="S5.E12.m1.5.5">𝜋</ci></apply><apply id="S5.E12.m1.9.9.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1"><times id="S5.E12.m1.9.9.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.2"></times><apply id="S5.E12.m1.9.9.1.1.1.3.cmml" xref="S5.E12.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S5.E12.m1.9.9.1.1.1.3.1.cmml" xref="S5.E12.m1.9.9.1.1.1.3">subscript</csymbol><ci id="S5.E12.m1.9.9.1.1.1.3.2.cmml" xref="S5.E12.m1.9.9.1.1.1.3.2">𝔼</ci><apply id="S5.E12.m1.2.2.2.cmml" xref="S5.E12.m1.2.2.2"><csymbol cd="latexml" id="S5.E12.m1.2.2.2.3.cmml" xref="S5.E12.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S5.E12.m1.2.2.2.4.1.cmml" xref="S5.E12.m1.2.2.2.4.2"><ci id="S5.E12.m1.1.1.1.1.cmml" xref="S5.E12.m1.1.1.1.1">𝑠</ci><ci id="S5.E12.m1.2.2.2.2.cmml" xref="S5.E12.m1.2.2.2.2">𝑎</ci></interval><apply id="S5.E12.m1.2.2.2.5.cmml" xref="S5.E12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S5.E12.m1.2.2.2.5.1.cmml" xref="S5.E12.m1.2.2.2.5">subscript</csymbol><ci id="S5.E12.m1.2.2.2.5.2.cmml" xref="S5.E12.m1.2.2.2.5.2">𝒟</ci><ci id="S5.E12.m1.2.2.2.5.3.cmml" xref="S5.E12.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S5.E12.m1.9.9.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S5.E12.m1.9.9.1.1.1.1.2.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1"><plus id="S5.E12.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.3"></plus><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1"><minus id="S5.E12.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1"></minus><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1"><times id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.2"></times><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.2">𝑄</ci><ci id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><interval closure="open" id="S5.E12.m1.4.4.2.3.cmml" xref="S5.E12.m1.4.4.2.4"><ci id="S5.E12.m1.3.3.1.1.cmml" xref="S5.E12.m1.3.3.1.1">𝑡</ci><ci id="S5.E12.m1.4.4.2.2.cmml" xref="S5.E12.m1.4.4.2.2">𝑘</ci></interval></apply><interval closure="open" id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1"><ci id="S5.E12.m1.7.7.cmml" xref="S5.E12.m1.7.7">𝑠</ci><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"><times id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S5.E12.m1.6.6.cmml" xref="S5.E12.m1.6.6">𝑠</ci></apply></interval></apply></apply><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1"><minus id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.1"></minus><apply id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2"><times id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.1"></times><ci id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.2">𝜋</ci><ci id="S5.E12.m1.8.8.cmml" xref="S5.E12.m1.8.8">𝑠</ci></apply><ci id="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><cn type="integer" id="S5.E12.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S5.E12.m1.9.9.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E12.m1.9c">\displaystyle\mathcal{L}_{\text{local}}(\pi)=\mathbb{E}_{(s,a)\sim\mathcal{D}_{i}}[-Q_{i}^{(t,k)}(s,\pi(s))+(\pi(s)-a)^{2}].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S5.SS3.p1.3" class="ltx_p">We then define the actor loss <math id="S5.SS3.p1.3.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{actor}}" display="inline"><semantics id="S5.SS3.p1.3.m1.1a"><msub id="S5.SS3.p1.3.m1.1.1" xref="S5.SS3.p1.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.3.m1.1.1.2" xref="S5.SS3.p1.3.m1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS3.p1.3.m1.1.1.3" xref="S5.SS3.p1.3.m1.1.1.3a.cmml">actor</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m1.1b"><apply id="S5.SS3.p1.3.m1.1.1.cmml" xref="S5.SS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m1.1.1.1.cmml" xref="S5.SS3.p1.3.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.3.m1.1.1.2.cmml" xref="S5.SS3.p1.3.m1.1.1.2">ℒ</ci><ci id="S5.SS3.p1.3.m1.1.1.3a.cmml" xref="S5.SS3.p1.3.m1.1.1.3"><mtext mathsize="70%" id="S5.SS3.p1.3.m1.1.1.3.cmml" xref="S5.SS3.p1.3.m1.1.1.3">actor</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m1.1c">\mathcal{L}_{\text{actor}}</annotation></semantics></math> as</p>
<table id="A4.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E13.m1.7" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\text{actor}}(\pi)=\mathcal{L}_{\text{local}}(\pi)+\mathbb{E}_{(s,a)\sim\mathcal{D}_{i}}[(\pi(s)-\pi^{t}_{\text{fed}}(s))^{2}]," display="inline"><semantics id="S5.E13.m1.7a"><mrow id="S5.E13.m1.7.7.1" xref="S5.E13.m1.7.7.1.1.cmml"><mrow id="S5.E13.m1.7.7.1.1" xref="S5.E13.m1.7.7.1.1.cmml"><mrow id="S5.E13.m1.7.7.1.1.3" xref="S5.E13.m1.7.7.1.1.3.cmml"><msub id="S5.E13.m1.7.7.1.1.3.2" xref="S5.E13.m1.7.7.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E13.m1.7.7.1.1.3.2.2" xref="S5.E13.m1.7.7.1.1.3.2.2.cmml">ℒ</mi><mtext id="S5.E13.m1.7.7.1.1.3.2.3" xref="S5.E13.m1.7.7.1.1.3.2.3a.cmml">actor</mtext></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.7.7.1.1.3.1" xref="S5.E13.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S5.E13.m1.7.7.1.1.3.3.2" xref="S5.E13.m1.7.7.1.1.3.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.3.3.2.1" xref="S5.E13.m1.7.7.1.1.3.cmml">(</mo><mi id="S5.E13.m1.3.3" xref="S5.E13.m1.3.3.cmml">π</mi><mo stretchy="false" id="S5.E13.m1.7.7.1.1.3.3.2.2" xref="S5.E13.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.7.7.1.1.2" xref="S5.E13.m1.7.7.1.1.2.cmml">=</mo><mrow id="S5.E13.m1.7.7.1.1.1" xref="S5.E13.m1.7.7.1.1.1.cmml"><mrow id="S5.E13.m1.7.7.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.3.cmml"><msub id="S5.E13.m1.7.7.1.1.1.3.2" xref="S5.E13.m1.7.7.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E13.m1.7.7.1.1.1.3.2.2" xref="S5.E13.m1.7.7.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S5.E13.m1.7.7.1.1.1.3.2.3" xref="S5.E13.m1.7.7.1.1.1.3.2.3a.cmml">local</mtext></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.7.7.1.1.1.3.1" xref="S5.E13.m1.7.7.1.1.1.3.1.cmml">​</mo><mrow id="S5.E13.m1.7.7.1.1.1.3.3.2" xref="S5.E13.m1.7.7.1.1.1.3.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.3.3.2.1" xref="S5.E13.m1.7.7.1.1.1.3.cmml">(</mo><mi id="S5.E13.m1.4.4" xref="S5.E13.m1.4.4.cmml">π</mi><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.3.3.2.2" xref="S5.E13.m1.7.7.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.7.7.1.1.1.2" xref="S5.E13.m1.7.7.1.1.1.2.cmml">+</mo><mrow id="S5.E13.m1.7.7.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.cmml"><msub id="S5.E13.m1.7.7.1.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.1.3.cmml"><mi id="S5.E13.m1.7.7.1.1.1.1.3.2" xref="S5.E13.m1.7.7.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S5.E13.m1.2.2.2" xref="S5.E13.m1.2.2.2.cmml"><mrow id="S5.E13.m1.2.2.2.4.2" xref="S5.E13.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S5.E13.m1.2.2.2.4.2.1" xref="S5.E13.m1.2.2.2.4.1.cmml">(</mo><mi id="S5.E13.m1.1.1.1.1" xref="S5.E13.m1.1.1.1.1.cmml">s</mi><mo id="S5.E13.m1.2.2.2.4.2.2" xref="S5.E13.m1.2.2.2.4.1.cmml">,</mo><mi id="S5.E13.m1.2.2.2.2" xref="S5.E13.m1.2.2.2.2.cmml">a</mi><mo stretchy="false" id="S5.E13.m1.2.2.2.4.2.3" xref="S5.E13.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S5.E13.m1.2.2.2.3" xref="S5.E13.m1.2.2.2.3.cmml">∼</mo><msub id="S5.E13.m1.2.2.2.5" xref="S5.E13.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E13.m1.2.2.2.5.2" xref="S5.E13.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S5.E13.m1.2.2.2.5.3" xref="S5.E13.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.7.7.1.1.1.1.2" xref="S5.E13.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.2" xref="S5.E13.m1.7.7.1.1.1.1.1.2.1.cmml">[</mo><msup id="S5.E13.m1.7.7.1.1.1.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">π</mi><mo lspace="0em" rspace="0em" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S5.E13.m1.5.5" xref="S5.E13.m1.5.5.cmml">s</mi><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">π</mi><mtext id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">fed</mtext><mi id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.E13.m1.6.6" xref="S5.E13.m1.6.6.cmml">s</mi><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S5.E13.m1.7.7.1.1.1.1.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S5.E13.m1.7.7.1.1.1.1.1.1.3" xref="S5.E13.m1.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S5.E13.m1.7.7.1.2" xref="S5.E13.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E13.m1.7b"><apply id="S5.E13.m1.7.7.1.1.cmml" xref="S5.E13.m1.7.7.1"><eq id="S5.E13.m1.7.7.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.2"></eq><apply id="S5.E13.m1.7.7.1.1.3.cmml" xref="S5.E13.m1.7.7.1.1.3"><times id="S5.E13.m1.7.7.1.1.3.1.cmml" xref="S5.E13.m1.7.7.1.1.3.1"></times><apply id="S5.E13.m1.7.7.1.1.3.2.cmml" xref="S5.E13.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.3.2.1.cmml" xref="S5.E13.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S5.E13.m1.7.7.1.1.3.2.2.cmml" xref="S5.E13.m1.7.7.1.1.3.2.2">ℒ</ci><ci id="S5.E13.m1.7.7.1.1.3.2.3a.cmml" xref="S5.E13.m1.7.7.1.1.3.2.3"><mtext mathsize="70%" id="S5.E13.m1.7.7.1.1.3.2.3.cmml" xref="S5.E13.m1.7.7.1.1.3.2.3">actor</mtext></ci></apply><ci id="S5.E13.m1.3.3.cmml" xref="S5.E13.m1.3.3">𝜋</ci></apply><apply id="S5.E13.m1.7.7.1.1.1.cmml" xref="S5.E13.m1.7.7.1.1.1"><plus id="S5.E13.m1.7.7.1.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.1.2"></plus><apply id="S5.E13.m1.7.7.1.1.1.3.cmml" xref="S5.E13.m1.7.7.1.1.1.3"><times id="S5.E13.m1.7.7.1.1.1.3.1.cmml" xref="S5.E13.m1.7.7.1.1.1.3.1"></times><apply id="S5.E13.m1.7.7.1.1.1.3.2.cmml" xref="S5.E13.m1.7.7.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.1.3.2.1.cmml" xref="S5.E13.m1.7.7.1.1.1.3.2">subscript</csymbol><ci id="S5.E13.m1.7.7.1.1.1.3.2.2.cmml" xref="S5.E13.m1.7.7.1.1.1.3.2.2">ℒ</ci><ci id="S5.E13.m1.7.7.1.1.1.3.2.3a.cmml" xref="S5.E13.m1.7.7.1.1.1.3.2.3"><mtext mathsize="70%" id="S5.E13.m1.7.7.1.1.1.3.2.3.cmml" xref="S5.E13.m1.7.7.1.1.1.3.2.3">local</mtext></ci></apply><ci id="S5.E13.m1.4.4.cmml" xref="S5.E13.m1.4.4">𝜋</ci></apply><apply id="S5.E13.m1.7.7.1.1.1.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1"><times id="S5.E13.m1.7.7.1.1.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.2"></times><apply id="S5.E13.m1.7.7.1.1.1.1.3.cmml" xref="S5.E13.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.1.1.3.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S5.E13.m1.7.7.1.1.1.1.3.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.3.2">𝔼</ci><apply id="S5.E13.m1.2.2.2.cmml" xref="S5.E13.m1.2.2.2"><csymbol cd="latexml" id="S5.E13.m1.2.2.2.3.cmml" xref="S5.E13.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S5.E13.m1.2.2.2.4.1.cmml" xref="S5.E13.m1.2.2.2.4.2"><ci id="S5.E13.m1.1.1.1.1.cmml" xref="S5.E13.m1.1.1.1.1">𝑠</ci><ci id="S5.E13.m1.2.2.2.2.cmml" xref="S5.E13.m1.2.2.2.2">𝑎</ci></interval><apply id="S5.E13.m1.2.2.2.5.cmml" xref="S5.E13.m1.2.2.2.5"><csymbol cd="ambiguous" id="S5.E13.m1.2.2.2.5.1.cmml" xref="S5.E13.m1.2.2.2.5">subscript</csymbol><ci id="S5.E13.m1.2.2.2.5.2.cmml" xref="S5.E13.m1.2.2.2.5.2">𝒟</ci><ci id="S5.E13.m1.2.2.2.5.3.cmml" xref="S5.E13.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S5.E13.m1.7.7.1.1.1.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E13.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1"><minus id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><times id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">𝜋</ci><ci id="S5.E13.m1.5.5.cmml" xref="S5.E13.m1.5.5">𝑠</ci></apply><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><times id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝜋</ci><ci id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3">fed</mtext></ci></apply><ci id="S5.E13.m1.6.6.cmml" xref="S5.E13.m1.6.6">𝑠</ci></apply></apply><cn type="integer" id="S5.E13.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S5.E13.m1.7.7.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E13.m1.7c">\displaystyle\mathcal{L}_{\text{actor}}(\pi)=\mathcal{L}_{\text{local}}(\pi)+\mathbb{E}_{(s,a)\sim\mathcal{D}_{i}}[(\pi(s)-\pi^{t}_{\text{fed}}(s))^{2}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S5.SS3.p1.4" class="ltx_p">where the second term is a regularization w.r.t. to the federated policy. The local policy is updated using <math id="S5.SS3.p1.4.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{actor}}" display="inline"><semantics id="S5.SS3.p1.4.m1.1a"><msub id="S5.SS3.p1.4.m1.1.1" xref="S5.SS3.p1.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.4.m1.1.1.2" xref="S5.SS3.p1.4.m1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS3.p1.4.m1.1.1.3" xref="S5.SS3.p1.4.m1.1.1.3a.cmml">actor</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m1.1b"><apply id="S5.SS3.p1.4.m1.1.1.cmml" xref="S5.SS3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m1.1.1.1.cmml" xref="S5.SS3.p1.4.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.4.m1.1.1.2.cmml" xref="S5.SS3.p1.4.m1.1.1.2">ℒ</ci><ci id="S5.SS3.p1.4.m1.1.1.3a.cmml" xref="S5.SS3.p1.4.m1.1.1.3"><mtext mathsize="70%" id="S5.SS3.p1.4.m1.1.1.3.cmml" xref="S5.SS3.p1.4.m1.1.1.3">actor</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m1.1c">\mathcal{L}_{\text{actor}}</annotation></semantics></math> as</p>
<table id="A4.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E14.m1.4" class="ltx_Math" alttext="\displaystyle\pi^{t,k+1}_{i}=\operatorname*{arg\,min}_{\pi}\leavevmode\nobreak\ \mathcal{L}_{\text{actor}}(\pi)." display="inline"><semantics id="S5.E14.m1.4a"><mrow id="S5.E14.m1.4.4.1" xref="S5.E14.m1.4.4.1.1.cmml"><mrow id="S5.E14.m1.4.4.1.1" xref="S5.E14.m1.4.4.1.1.cmml"><msubsup id="S5.E14.m1.4.4.1.1.2" xref="S5.E14.m1.4.4.1.1.2.cmml"><mi id="S5.E14.m1.4.4.1.1.2.2.2" xref="S5.E14.m1.4.4.1.1.2.2.2.cmml">π</mi><mi id="S5.E14.m1.4.4.1.1.2.3" xref="S5.E14.m1.4.4.1.1.2.3.cmml">i</mi><mrow id="S5.E14.m1.2.2.2.2" xref="S5.E14.m1.2.2.2.3.cmml"><mi id="S5.E14.m1.1.1.1.1" xref="S5.E14.m1.1.1.1.1.cmml">t</mi><mo id="S5.E14.m1.2.2.2.2.2" xref="S5.E14.m1.2.2.2.3.cmml">,</mo><mrow id="S5.E14.m1.2.2.2.2.1" xref="S5.E14.m1.2.2.2.2.1.cmml"><mi id="S5.E14.m1.2.2.2.2.1.2" xref="S5.E14.m1.2.2.2.2.1.2.cmml">k</mi><mo id="S5.E14.m1.2.2.2.2.1.1" xref="S5.E14.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S5.E14.m1.2.2.2.2.1.3" xref="S5.E14.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S5.E14.m1.4.4.1.1.1" xref="S5.E14.m1.4.4.1.1.1.cmml">=</mo><mrow id="S5.E14.m1.4.4.1.1.3" xref="S5.E14.m1.4.4.1.1.3.cmml"><mrow id="S5.E14.m1.4.4.1.1.3.2" xref="S5.E14.m1.4.4.1.1.3.2.cmml"><munder id="S5.E14.m1.4.4.1.1.3.2.1" xref="S5.E14.m1.4.4.1.1.3.2.1.cmml"><mrow id="S5.E14.m1.4.4.1.1.3.2.1.2" xref="S5.E14.m1.4.4.1.1.3.2.1.2.cmml"><mi id="S5.E14.m1.4.4.1.1.3.2.1.2.2" xref="S5.E14.m1.4.4.1.1.3.2.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S5.E14.m1.4.4.1.1.3.2.1.2.1" xref="S5.E14.m1.4.4.1.1.3.2.1.2.1.cmml">​</mo><mi id="S5.E14.m1.4.4.1.1.3.2.1.2.3" xref="S5.E14.m1.4.4.1.1.3.2.1.2.3.cmml">min</mi></mrow><mi id="S5.E14.m1.4.4.1.1.3.2.1.3" xref="S5.E14.m1.4.4.1.1.3.2.1.3.cmml">π</mi></munder><mo id="S5.E14.m1.4.4.1.1.3.2a" xref="S5.E14.m1.4.4.1.1.3.2.cmml">⁡</mo><msub id="S5.E14.m1.4.4.1.1.3.2.2" xref="S5.E14.m1.4.4.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E14.m1.4.4.1.1.3.2.2.2" xref="S5.E14.m1.4.4.1.1.3.2.2.2.cmml">ℒ</mi><mtext id="S5.E14.m1.4.4.1.1.3.2.2.3" xref="S5.E14.m1.4.4.1.1.3.2.2.3a.cmml">actor</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S5.E14.m1.4.4.1.1.3.1" xref="S5.E14.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S5.E14.m1.4.4.1.1.3.3.2" xref="S5.E14.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S5.E14.m1.4.4.1.1.3.3.2.1" xref="S5.E14.m1.4.4.1.1.3.cmml">(</mo><mi id="S5.E14.m1.3.3" xref="S5.E14.m1.3.3.cmml">π</mi><mo stretchy="false" id="S5.E14.m1.4.4.1.1.3.3.2.2" xref="S5.E14.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S5.E14.m1.4.4.1.2" xref="S5.E14.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E14.m1.4b"><apply id="S5.E14.m1.4.4.1.1.cmml" xref="S5.E14.m1.4.4.1"><eq id="S5.E14.m1.4.4.1.1.1.cmml" xref="S5.E14.m1.4.4.1.1.1"></eq><apply id="S5.E14.m1.4.4.1.1.2.cmml" xref="S5.E14.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S5.E14.m1.4.4.1.1.2.1.cmml" xref="S5.E14.m1.4.4.1.1.2">subscript</csymbol><apply id="S5.E14.m1.4.4.1.1.2.2.cmml" xref="S5.E14.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S5.E14.m1.4.4.1.1.2.2.1.cmml" xref="S5.E14.m1.4.4.1.1.2">superscript</csymbol><ci id="S5.E14.m1.4.4.1.1.2.2.2.cmml" xref="S5.E14.m1.4.4.1.1.2.2.2">𝜋</ci><list id="S5.E14.m1.2.2.2.3.cmml" xref="S5.E14.m1.2.2.2.2"><ci id="S5.E14.m1.1.1.1.1.cmml" xref="S5.E14.m1.1.1.1.1">𝑡</ci><apply id="S5.E14.m1.2.2.2.2.1.cmml" xref="S5.E14.m1.2.2.2.2.1"><plus id="S5.E14.m1.2.2.2.2.1.1.cmml" xref="S5.E14.m1.2.2.2.2.1.1"></plus><ci id="S5.E14.m1.2.2.2.2.1.2.cmml" xref="S5.E14.m1.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="S5.E14.m1.2.2.2.2.1.3.cmml" xref="S5.E14.m1.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S5.E14.m1.4.4.1.1.2.3.cmml" xref="S5.E14.m1.4.4.1.1.2.3">𝑖</ci></apply><apply id="S5.E14.m1.4.4.1.1.3.cmml" xref="S5.E14.m1.4.4.1.1.3"><times id="S5.E14.m1.4.4.1.1.3.1.cmml" xref="S5.E14.m1.4.4.1.1.3.1"></times><apply id="S5.E14.m1.4.4.1.1.3.2.cmml" xref="S5.E14.m1.4.4.1.1.3.2"><apply id="S5.E14.m1.4.4.1.1.3.2.1.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S5.E14.m1.4.4.1.1.3.2.1.1.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1">subscript</csymbol><apply id="S5.E14.m1.4.4.1.1.3.2.1.2.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1.2"><times id="S5.E14.m1.4.4.1.1.3.2.1.2.1.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1.2.1"></times><ci id="S5.E14.m1.4.4.1.1.3.2.1.2.2.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1.2.2">arg</ci><ci id="S5.E14.m1.4.4.1.1.3.2.1.2.3.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1.2.3">min</ci></apply><ci id="S5.E14.m1.4.4.1.1.3.2.1.3.cmml" xref="S5.E14.m1.4.4.1.1.3.2.1.3">𝜋</ci></apply><apply id="S5.E14.m1.4.4.1.1.3.2.2.cmml" xref="S5.E14.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E14.m1.4.4.1.1.3.2.2.1.cmml" xref="S5.E14.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S5.E14.m1.4.4.1.1.3.2.2.2.cmml" xref="S5.E14.m1.4.4.1.1.3.2.2.2">ℒ</ci><ci id="S5.E14.m1.4.4.1.1.3.2.2.3a.cmml" xref="S5.E14.m1.4.4.1.1.3.2.2.3"><mtext mathsize="70%" id="S5.E14.m1.4.4.1.1.3.2.2.3.cmml" xref="S5.E14.m1.4.4.1.1.3.2.2.3">actor</mtext></ci></apply></apply><ci id="S5.E14.m1.3.3.cmml" xref="S5.E14.m1.3.3">𝜋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14.m1.4c">\displaystyle\pi^{t,k+1}_{i}=\operatorname*{arg\,min}_{\pi}\leavevmode\nobreak\ \mathcal{L}_{\text{actor}}(\pi).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S5.SS3.p1.6" class="ltx_p">Similar to the local critic update, we perform only one gradient update w.r.t. <math id="S5.SS3.p1.5.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{actor}}" display="inline"><semantics id="S5.SS3.p1.5.m1.1a"><msub id="S5.SS3.p1.5.m1.1.1" xref="S5.SS3.p1.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.5.m1.1.1.2" xref="S5.SS3.p1.5.m1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS3.p1.5.m1.1.1.3" xref="S5.SS3.p1.5.m1.1.1.3a.cmml">actor</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m1.1b"><apply id="S5.SS3.p1.5.m1.1.1.cmml" xref="S5.SS3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.5.m1.1.1.1.cmml" xref="S5.SS3.p1.5.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.5.m1.1.1.2.cmml" xref="S5.SS3.p1.5.m1.1.1.2">ℒ</ci><ci id="S5.SS3.p1.5.m1.1.1.3a.cmml" xref="S5.SS3.p1.5.m1.1.1.3"><mtext mathsize="70%" id="S5.SS3.p1.5.m1.1.1.3.cmml" xref="S5.SS3.p1.5.m1.1.1.3">actor</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m1.1c">\mathcal{L}_{\text{actor}}</annotation></semantics></math> to obtain <math id="S5.SS3.p1.6.m2.2" class="ltx_Math" alttext="\pi^{t,k+1}_{i}" display="inline"><semantics id="S5.SS3.p1.6.m2.2a"><msubsup id="S5.SS3.p1.6.m2.2.3" xref="S5.SS3.p1.6.m2.2.3.cmml"><mi id="S5.SS3.p1.6.m2.2.3.2.2" xref="S5.SS3.p1.6.m2.2.3.2.2.cmml">π</mi><mi id="S5.SS3.p1.6.m2.2.3.3" xref="S5.SS3.p1.6.m2.2.3.3.cmml">i</mi><mrow id="S5.SS3.p1.6.m2.2.2.2.2" xref="S5.SS3.p1.6.m2.2.2.2.3.cmml"><mi id="S5.SS3.p1.6.m2.1.1.1.1" xref="S5.SS3.p1.6.m2.1.1.1.1.cmml">t</mi><mo id="S5.SS3.p1.6.m2.2.2.2.2.2" xref="S5.SS3.p1.6.m2.2.2.2.3.cmml">,</mo><mrow id="S5.SS3.p1.6.m2.2.2.2.2.1" xref="S5.SS3.p1.6.m2.2.2.2.2.1.cmml"><mi id="S5.SS3.p1.6.m2.2.2.2.2.1.2" xref="S5.SS3.p1.6.m2.2.2.2.2.1.2.cmml">k</mi><mo id="S5.SS3.p1.6.m2.2.2.2.2.1.1" xref="S5.SS3.p1.6.m2.2.2.2.2.1.1.cmml">+</mo><mn id="S5.SS3.p1.6.m2.2.2.2.2.1.3" xref="S5.SS3.p1.6.m2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m2.2b"><apply id="S5.SS3.p1.6.m2.2.3.cmml" xref="S5.SS3.p1.6.m2.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m2.2.3.1.cmml" xref="S5.SS3.p1.6.m2.2.3">subscript</csymbol><apply id="S5.SS3.p1.6.m2.2.3.2.cmml" xref="S5.SS3.p1.6.m2.2.3"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m2.2.3.2.1.cmml" xref="S5.SS3.p1.6.m2.2.3">superscript</csymbol><ci id="S5.SS3.p1.6.m2.2.3.2.2.cmml" xref="S5.SS3.p1.6.m2.2.3.2.2">𝜋</ci><list id="S5.SS3.p1.6.m2.2.2.2.3.cmml" xref="S5.SS3.p1.6.m2.2.2.2.2"><ci id="S5.SS3.p1.6.m2.1.1.1.1.cmml" xref="S5.SS3.p1.6.m2.1.1.1.1">𝑡</ci><apply id="S5.SS3.p1.6.m2.2.2.2.2.1.cmml" xref="S5.SS3.p1.6.m2.2.2.2.2.1"><plus id="S5.SS3.p1.6.m2.2.2.2.2.1.1.cmml" xref="S5.SS3.p1.6.m2.2.2.2.2.1.1"></plus><ci id="S5.SS3.p1.6.m2.2.2.2.2.1.2.cmml" xref="S5.SS3.p1.6.m2.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="S5.SS3.p1.6.m2.2.2.2.2.1.3.cmml" xref="S5.SS3.p1.6.m2.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S5.SS3.p1.6.m2.2.3.3.cmml" xref="S5.SS3.p1.6.m2.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m2.2c">\pi^{t,k+1}_{i}</annotation></semantics></math>, instead of solving the complete optimization problem above.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Decaying the Influence of Local Data</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.8" class="ltx_p">FEDORA uses a combination of local data loss and a proximal term for its policy update Eq. (<a href="#S5.E12" title="In 5.3 Proximal Policy Update for Heterogeneous Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>)-(<a href="#S5.E14" title="In 5.3 Proximal Policy Update for Heterogeneous Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>). However, the local data loss might hamper the updated policy’s performance since the local dataset may be generated according to a non-expert behavior policy. Hence, a client must decay the influence of its local data if it is reducing the performance of the updated policy by lowering the influence of <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{local}}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3a.cmml">local</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">ℒ</ci><ci id="S5.SS4.p1.1.m1.1.1.3a.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">local</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\mathcal{L}_{\text{local}}</annotation></semantics></math> in <math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{actor}}" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><msub id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3a.cmml">actor</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">ℒ</ci><ci id="S5.SS4.p1.2.m2.1.1.3a.cmml" xref="S5.SS4.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3">actor</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">\mathcal{L}_{\text{actor}}</annotation></semantics></math>. To do so, we first evaluate the performance of the federated policy using the federated critic and local data at round <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><mi id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">t</annotation></semantics></math>. For this evaluation, we use the proxy estimate <math id="S5.SS4.p1.4.m4.5" class="ltx_Math" alttext="J_{i}^{\text{fed},t}=\mathbb{E}_{s\sim\mathcal{D}_{i}}\left[Q_{\text{fed}}^{t}(s,\pi^{t}_{\text{fed}}(s))\right]" display="inline"><semantics id="S5.SS4.p1.4.m4.5a"><mrow id="S5.SS4.p1.4.m4.5.5" xref="S5.SS4.p1.4.m4.5.5.cmml"><msubsup id="S5.SS4.p1.4.m4.5.5.3" xref="S5.SS4.p1.4.m4.5.5.3.cmml"><mi id="S5.SS4.p1.4.m4.5.5.3.2.2" xref="S5.SS4.p1.4.m4.5.5.3.2.2.cmml">J</mi><mi id="S5.SS4.p1.4.m4.5.5.3.2.3" xref="S5.SS4.p1.4.m4.5.5.3.2.3.cmml">i</mi><mrow id="S5.SS4.p1.4.m4.2.2.2.4" xref="S5.SS4.p1.4.m4.2.2.2.3.cmml"><mtext id="S5.SS4.p1.4.m4.1.1.1.1" xref="S5.SS4.p1.4.m4.1.1.1.1a.cmml">fed</mtext><mo id="S5.SS4.p1.4.m4.2.2.2.4.1" xref="S5.SS4.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S5.SS4.p1.4.m4.2.2.2.2" xref="S5.SS4.p1.4.m4.2.2.2.2.cmml">t</mi></mrow></msubsup><mo id="S5.SS4.p1.4.m4.5.5.2" xref="S5.SS4.p1.4.m4.5.5.2.cmml">=</mo><mrow id="S5.SS4.p1.4.m4.5.5.1" xref="S5.SS4.p1.4.m4.5.5.1.cmml"><msub id="S5.SS4.p1.4.m4.5.5.1.3" xref="S5.SS4.p1.4.m4.5.5.1.3.cmml"><mi id="S5.SS4.p1.4.m4.5.5.1.3.2" xref="S5.SS4.p1.4.m4.5.5.1.3.2.cmml">𝔼</mi><mrow id="S5.SS4.p1.4.m4.5.5.1.3.3" xref="S5.SS4.p1.4.m4.5.5.1.3.3.cmml"><mi id="S5.SS4.p1.4.m4.5.5.1.3.3.2" xref="S5.SS4.p1.4.m4.5.5.1.3.3.2.cmml">s</mi><mo id="S5.SS4.p1.4.m4.5.5.1.3.3.1" xref="S5.SS4.p1.4.m4.5.5.1.3.3.1.cmml">∼</mo><msub id="S5.SS4.p1.4.m4.5.5.1.3.3.3" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.4.m4.5.5.1.3.3.3.2" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3.2.cmml">𝒟</mi><mi id="S5.SS4.p1.4.m4.5.5.1.3.3.3.3" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.SS4.p1.4.m4.5.5.1.2" xref="S5.SS4.p1.4.m4.5.5.1.2.cmml">​</mo><mrow id="S5.SS4.p1.4.m4.5.5.1.1.1" xref="S5.SS4.p1.4.m4.5.5.1.1.2.cmml"><mo id="S5.SS4.p1.4.m4.5.5.1.1.1.2" xref="S5.SS4.p1.4.m4.5.5.1.1.2.1.cmml">[</mo><mrow id="S5.SS4.p1.4.m4.5.5.1.1.1.1" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.cmml"><msubsup id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.cmml"><mi id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.2.cmml">Q</mi><mtext id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3a.cmml">fed</mtext><mi id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S5.SS4.p1.4.m4.4.4" xref="S5.SS4.p1.4.m4.4.4.cmml">s</mi><mo id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.2.cmml">,</mo><mrow id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.cmml"><msubsup id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mtext id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3a.cmml">fed</mtext><mi id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.3" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.1" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.3.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.3.2.1" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S5.SS4.p1.4.m4.3.3" xref="S5.SS4.p1.4.m4.3.3.cmml">s</mi><mo stretchy="false" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.3.2.2" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.4" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.SS4.p1.4.m4.5.5.1.1.1.3" xref="S5.SS4.p1.4.m4.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.5b"><apply id="S5.SS4.p1.4.m4.5.5.cmml" xref="S5.SS4.p1.4.m4.5.5"><eq id="S5.SS4.p1.4.m4.5.5.2.cmml" xref="S5.SS4.p1.4.m4.5.5.2"></eq><apply id="S5.SS4.p1.4.m4.5.5.3.cmml" xref="S5.SS4.p1.4.m4.5.5.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.3.1.cmml" xref="S5.SS4.p1.4.m4.5.5.3">superscript</csymbol><apply id="S5.SS4.p1.4.m4.5.5.3.2.cmml" xref="S5.SS4.p1.4.m4.5.5.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.3.2.1.cmml" xref="S5.SS4.p1.4.m4.5.5.3">subscript</csymbol><ci id="S5.SS4.p1.4.m4.5.5.3.2.2.cmml" xref="S5.SS4.p1.4.m4.5.5.3.2.2">𝐽</ci><ci id="S5.SS4.p1.4.m4.5.5.3.2.3.cmml" xref="S5.SS4.p1.4.m4.5.5.3.2.3">𝑖</ci></apply><list id="S5.SS4.p1.4.m4.2.2.2.3.cmml" xref="S5.SS4.p1.4.m4.2.2.2.4"><ci id="S5.SS4.p1.4.m4.1.1.1.1a.cmml" xref="S5.SS4.p1.4.m4.1.1.1.1"><mtext mathsize="70%" id="S5.SS4.p1.4.m4.1.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1.1.1">fed</mtext></ci><ci id="S5.SS4.p1.4.m4.2.2.2.2.cmml" xref="S5.SS4.p1.4.m4.2.2.2.2">𝑡</ci></list></apply><apply id="S5.SS4.p1.4.m4.5.5.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1"><times id="S5.SS4.p1.4.m4.5.5.1.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.2"></times><apply id="S5.SS4.p1.4.m4.5.5.1.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.3.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3">subscript</csymbol><ci id="S5.SS4.p1.4.m4.5.5.1.3.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.2">𝔼</ci><apply id="S5.SS4.p1.4.m4.5.5.1.3.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3"><csymbol cd="latexml" id="S5.SS4.p1.4.m4.5.5.1.3.3.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.1">similar-to</csymbol><ci id="S5.SS4.p1.4.m4.5.5.1.3.3.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.2">𝑠</ci><apply id="S5.SS4.p1.4.m4.5.5.1.3.3.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.3.3.3.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3">subscript</csymbol><ci id="S5.SS4.p1.4.m4.5.5.1.3.3.3.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3.2">𝒟</ci><ci id="S5.SS4.p1.4.m4.5.5.1.3.3.3.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S5.SS4.p1.4.m4.5.5.1.1.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1"><csymbol cd="latexml" id="S5.SS4.p1.4.m4.5.5.1.1.2.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1"><times id="S5.SS4.p1.4.m4.5.5.1.1.1.1.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.2"></times><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3">superscript</csymbol><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3">subscript</csymbol><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.2">𝑄</ci><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3a.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.2.3">fed</mtext></ci></apply><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.3.3">𝑡</ci></apply><interval closure="open" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1"><ci id="S5.SS4.p1.4.m4.4.4.cmml" xref="S5.SS4.p1.4.m4.4.4">𝑠</ci><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1"><times id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.1"></times><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.2">𝜋</ci><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3a.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S5.SS4.p1.4.m4.5.5.1.1.1.1.1.1.1.2.3">fed</mtext></ci></apply><ci id="S5.SS4.p1.4.m4.3.3.cmml" xref="S5.SS4.p1.4.m4.3.3">𝑠</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.5c">J_{i}^{\text{fed},t}=\mathbb{E}_{s\sim\mathcal{D}_{i}}\left[Q_{\text{fed}}^{t}(s,\pi^{t}_{\text{fed}}(s))\right]</annotation></semantics></math>. We compare this value with the performance of the updated policy, <math id="S5.SS4.p1.5.m5.1" class="ltx_Math" alttext="J_{i}^{t}" display="inline"><semantics id="S5.SS4.p1.5.m5.1a"><msubsup id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml"><mi id="S5.SS4.p1.5.m5.1.1.2.2" xref="S5.SS4.p1.5.m5.1.1.2.2.cmml">J</mi><mi id="S5.SS4.p1.5.m5.1.1.2.3" xref="S5.SS4.p1.5.m5.1.1.2.3.cmml">i</mi><mi id="S5.SS4.p1.5.m5.1.1.3" xref="S5.SS4.p1.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.1b"><apply id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.5.m5.1.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1">superscript</csymbol><apply id="S5.SS4.p1.5.m5.1.1.2.cmml" xref="S5.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.5.m5.1.1.2.1.cmml" xref="S5.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS4.p1.5.m5.1.1.2.2.cmml" xref="S5.SS4.p1.5.m5.1.1.2.2">𝐽</ci><ci id="S5.SS4.p1.5.m5.1.1.2.3.cmml" xref="S5.SS4.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S5.SS4.p1.5.m5.1.1.3.cmml" xref="S5.SS4.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.1c">J_{i}^{t}</annotation></semantics></math>, which is obtained using the updated critic. This difference provides us with an estimate of the improvement the local data provides. We decay the influence of <math id="S5.SS4.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{\text{local}}" display="inline"><semantics id="S5.SS4.p1.6.m6.1a"><msub id="S5.SS4.p1.6.m6.1.1" xref="S5.SS4.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p1.6.m6.1.1.2" xref="S5.SS4.p1.6.m6.1.1.2.cmml">ℒ</mi><mtext id="S5.SS4.p1.6.m6.1.1.3" xref="S5.SS4.p1.6.m6.1.1.3a.cmml">local</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m6.1b"><apply id="S5.SS4.p1.6.m6.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.6.m6.1.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS4.p1.6.m6.1.1.2.cmml" xref="S5.SS4.p1.6.m6.1.1.2">ℒ</ci><ci id="S5.SS4.p1.6.m6.1.1.3a.cmml" xref="S5.SS4.p1.6.m6.1.1.3"><mtext mathsize="70%" id="S5.SS4.p1.6.m6.1.1.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3">local</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m6.1c">\mathcal{L}_{\text{local}}</annotation></semantics></math> by a factor <math id="S5.SS4.p1.7.m7.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S5.SS4.p1.7.m7.1a"><mi id="S5.SS4.p1.7.m7.1.1" xref="S5.SS4.p1.7.m7.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.7.m7.1b"><ci id="S5.SS4.p1.7.m7.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.7.m7.1c">\delta</annotation></semantics></math> if <math id="S5.SS4.p1.8.m8.2" class="ltx_Math" alttext="J_{i}^{\text{fed},t}\geq J^{t}_{i}" display="inline"><semantics id="S5.SS4.p1.8.m8.2a"><mrow id="S5.SS4.p1.8.m8.2.3" xref="S5.SS4.p1.8.m8.2.3.cmml"><msubsup id="S5.SS4.p1.8.m8.2.3.2" xref="S5.SS4.p1.8.m8.2.3.2.cmml"><mi id="S5.SS4.p1.8.m8.2.3.2.2.2" xref="S5.SS4.p1.8.m8.2.3.2.2.2.cmml">J</mi><mi id="S5.SS4.p1.8.m8.2.3.2.2.3" xref="S5.SS4.p1.8.m8.2.3.2.2.3.cmml">i</mi><mrow id="S5.SS4.p1.8.m8.2.2.2.4" xref="S5.SS4.p1.8.m8.2.2.2.3.cmml"><mtext id="S5.SS4.p1.8.m8.1.1.1.1" xref="S5.SS4.p1.8.m8.1.1.1.1a.cmml">fed</mtext><mo id="S5.SS4.p1.8.m8.2.2.2.4.1" xref="S5.SS4.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S5.SS4.p1.8.m8.2.2.2.2" xref="S5.SS4.p1.8.m8.2.2.2.2.cmml">t</mi></mrow></msubsup><mo id="S5.SS4.p1.8.m8.2.3.1" xref="S5.SS4.p1.8.m8.2.3.1.cmml">≥</mo><msubsup id="S5.SS4.p1.8.m8.2.3.3" xref="S5.SS4.p1.8.m8.2.3.3.cmml"><mi id="S5.SS4.p1.8.m8.2.3.3.2.2" xref="S5.SS4.p1.8.m8.2.3.3.2.2.cmml">J</mi><mi id="S5.SS4.p1.8.m8.2.3.3.3" xref="S5.SS4.p1.8.m8.2.3.3.3.cmml">i</mi><mi id="S5.SS4.p1.8.m8.2.3.3.2.3" xref="S5.SS4.p1.8.m8.2.3.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.8.m8.2b"><apply id="S5.SS4.p1.8.m8.2.3.cmml" xref="S5.SS4.p1.8.m8.2.3"><geq id="S5.SS4.p1.8.m8.2.3.1.cmml" xref="S5.SS4.p1.8.m8.2.3.1"></geq><apply id="S5.SS4.p1.8.m8.2.3.2.cmml" xref="S5.SS4.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.2.3.2.1.cmml" xref="S5.SS4.p1.8.m8.2.3.2">superscript</csymbol><apply id="S5.SS4.p1.8.m8.2.3.2.2.cmml" xref="S5.SS4.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.2.3.2.2.1.cmml" xref="S5.SS4.p1.8.m8.2.3.2">subscript</csymbol><ci id="S5.SS4.p1.8.m8.2.3.2.2.2.cmml" xref="S5.SS4.p1.8.m8.2.3.2.2.2">𝐽</ci><ci id="S5.SS4.p1.8.m8.2.3.2.2.3.cmml" xref="S5.SS4.p1.8.m8.2.3.2.2.3">𝑖</ci></apply><list id="S5.SS4.p1.8.m8.2.2.2.3.cmml" xref="S5.SS4.p1.8.m8.2.2.2.4"><ci id="S5.SS4.p1.8.m8.1.1.1.1a.cmml" xref="S5.SS4.p1.8.m8.1.1.1.1"><mtext mathsize="70%" id="S5.SS4.p1.8.m8.1.1.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1.1.1">fed</mtext></ci><ci id="S5.SS4.p1.8.m8.2.2.2.2.cmml" xref="S5.SS4.p1.8.m8.2.2.2.2">𝑡</ci></list></apply><apply id="S5.SS4.p1.8.m8.2.3.3.cmml" xref="S5.SS4.p1.8.m8.2.3.3"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.2.3.3.1.cmml" xref="S5.SS4.p1.8.m8.2.3.3">subscript</csymbol><apply id="S5.SS4.p1.8.m8.2.3.3.2.cmml" xref="S5.SS4.p1.8.m8.2.3.3"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.2.3.3.2.1.cmml" xref="S5.SS4.p1.8.m8.2.3.3">superscript</csymbol><ci id="S5.SS4.p1.8.m8.2.3.3.2.2.cmml" xref="S5.SS4.p1.8.m8.2.3.3.2.2">𝐽</ci><ci id="S5.SS4.p1.8.m8.2.3.3.2.3.cmml" xref="S5.SS4.p1.8.m8.2.3.3.2.3">𝑡</ci></apply><ci id="S5.SS4.p1.8.m8.2.3.3.3.cmml" xref="S5.SS4.p1.8.m8.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.8.m8.2c">J_{i}^{\text{fed},t}\geq J^{t}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p id="S5.SS4.p2.1" class="ltx_p">We summarize FEDORA in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 5.4 Decaying the Influence of Local Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#alg2" title="Algorithm 2 ‣ 5.4 Decaying the Influence of Local Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FEDORA: Outline of Client <math id="alg1.2.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.2.m1.1b"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">i</annotation></semantics></math>’s Algorithm</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">function</span> train_client(<math id="alg1.l1.m1.1" class="ltx_Math" alttext="\pi^{t}_{\text{fed}}" display="inline"><semantics id="alg1.l1.m1.1a"><msubsup id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">π</mi><mtext id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3a.cmml">fed</mtext><mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1">superscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝜋</ci><ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l1.m1.1.1.3a.cmml" xref="alg1.l1.m1.1.1.3"><mtext mathsize="70%" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">fed</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\pi^{t}_{\text{fed}}</annotation></semantics></math>, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="Q^{t}_{\text{fed}}" display="inline"><semantics id="alg1.l1.m2.1a"><msubsup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2.2" xref="alg1.l1.m2.1.1.2.2.cmml">Q</mi><mtext id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3a.cmml">fed</mtext><mi id="alg1.l1.m2.1.1.2.3" xref="alg1.l1.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><apply id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.2.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.2.cmml" xref="alg1.l1.m2.1.1.2.2">𝑄</ci><ci id="alg1.l1.m2.1.1.2.3.cmml" xref="alg1.l1.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l1.m2.1.1.3a.cmml" xref="alg1.l1.m2.1.1.3"><mtext mathsize="70%" id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">fed</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">Q^{t}_{\text{fed}}</annotation></semantics></math>) 



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <math id="alg1.l2.m1.6" class="ltx_Math" alttext="\pi_{i}^{(t,0)}=\pi^{t}_{\text{fed}},\quad Q^{(t,0)}_{i}=Q^{t}_{\text{fed}}" display="inline"><semantics id="alg1.l2.m1.6a"><mrow id="alg1.l2.m1.6.6.2" xref="alg1.l2.m1.6.6.3.cmml"><mrow id="alg1.l2.m1.5.5.1.1" xref="alg1.l2.m1.5.5.1.1.cmml"><msubsup id="alg1.l2.m1.5.5.1.1.2" xref="alg1.l2.m1.5.5.1.1.2.cmml"><mi id="alg1.l2.m1.5.5.1.1.2.2.2" xref="alg1.l2.m1.5.5.1.1.2.2.2.cmml">π</mi><mi id="alg1.l2.m1.5.5.1.1.2.2.3" xref="alg1.l2.m1.5.5.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l2.m1.2.2.2.4" xref="alg1.l2.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.2.4.1" xref="alg1.l2.m1.2.2.2.3.cmml">(</mo><mi id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">t</mi><mo id="alg1.l2.m1.2.2.2.4.2" xref="alg1.l2.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml">0</mn><mo stretchy="false" id="alg1.l2.m1.2.2.2.4.3" xref="alg1.l2.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l2.m1.5.5.1.1.1" xref="alg1.l2.m1.5.5.1.1.1.cmml">=</mo><msubsup id="alg1.l2.m1.5.5.1.1.3" xref="alg1.l2.m1.5.5.1.1.3.cmml"><mi id="alg1.l2.m1.5.5.1.1.3.2.2" xref="alg1.l2.m1.5.5.1.1.3.2.2.cmml">π</mi><mtext id="alg1.l2.m1.5.5.1.1.3.3" xref="alg1.l2.m1.5.5.1.1.3.3a.cmml">fed</mtext><mi id="alg1.l2.m1.5.5.1.1.3.2.3" xref="alg1.l2.m1.5.5.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo rspace="1.167em" id="alg1.l2.m1.6.6.2.3" xref="alg1.l2.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l2.m1.6.6.2.2" xref="alg1.l2.m1.6.6.2.2.cmml"><msubsup id="alg1.l2.m1.6.6.2.2.2" xref="alg1.l2.m1.6.6.2.2.2.cmml"><mi id="alg1.l2.m1.6.6.2.2.2.2.2" xref="alg1.l2.m1.6.6.2.2.2.2.2.cmml">Q</mi><mi id="alg1.l2.m1.6.6.2.2.2.3" xref="alg1.l2.m1.6.6.2.2.2.3.cmml">i</mi><mrow id="alg1.l2.m1.4.4.2.4" xref="alg1.l2.m1.4.4.2.3.cmml"><mo stretchy="false" id="alg1.l2.m1.4.4.2.4.1" xref="alg1.l2.m1.4.4.2.3.cmml">(</mo><mi id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.1.cmml">t</mi><mo id="alg1.l2.m1.4.4.2.4.2" xref="alg1.l2.m1.4.4.2.3.cmml">,</mo><mn id="alg1.l2.m1.4.4.2.2" xref="alg1.l2.m1.4.4.2.2.cmml">0</mn><mo stretchy="false" id="alg1.l2.m1.4.4.2.4.3" xref="alg1.l2.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l2.m1.6.6.2.2.1" xref="alg1.l2.m1.6.6.2.2.1.cmml">=</mo><msubsup id="alg1.l2.m1.6.6.2.2.3" xref="alg1.l2.m1.6.6.2.2.3.cmml"><mi id="alg1.l2.m1.6.6.2.2.3.2.2" xref="alg1.l2.m1.6.6.2.2.3.2.2.cmml">Q</mi><mtext id="alg1.l2.m1.6.6.2.2.3.3" xref="alg1.l2.m1.6.6.2.2.3.3a.cmml">fed</mtext><mi id="alg1.l2.m1.6.6.2.2.3.2.3" xref="alg1.l2.m1.6.6.2.2.3.2.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.6b"><apply id="alg1.l2.m1.6.6.3.cmml" xref="alg1.l2.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.3a.cmml" xref="alg1.l2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l2.m1.5.5.1.1.cmml" xref="alg1.l2.m1.5.5.1.1"><eq id="alg1.l2.m1.5.5.1.1.1.cmml" xref="alg1.l2.m1.5.5.1.1.1"></eq><apply id="alg1.l2.m1.5.5.1.1.2.cmml" xref="alg1.l2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.2">superscript</csymbol><apply id="alg1.l2.m1.5.5.1.1.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.2.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.5.5.1.1.2.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.2.2.2">𝜋</ci><ci id="alg1.l2.m1.5.5.1.1.2.2.3.cmml" xref="alg1.l2.m1.5.5.1.1.2.2.3">𝑖</ci></apply><interval closure="open" id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.4"><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">𝑡</ci><cn type="integer" id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2">0</cn></interval></apply><apply id="alg1.l2.m1.5.5.1.1.3.cmml" xref="alg1.l2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.3.1.cmml" xref="alg1.l2.m1.5.5.1.1.3">subscript</csymbol><apply id="alg1.l2.m1.5.5.1.1.3.2.cmml" xref="alg1.l2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.3.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.3">superscript</csymbol><ci id="alg1.l2.m1.5.5.1.1.3.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.3.2.2">𝜋</ci><ci id="alg1.l2.m1.5.5.1.1.3.2.3.cmml" xref="alg1.l2.m1.5.5.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l2.m1.5.5.1.1.3.3a.cmml" xref="alg1.l2.m1.5.5.1.1.3.3"><mtext mathsize="70%" id="alg1.l2.m1.5.5.1.1.3.3.cmml" xref="alg1.l2.m1.5.5.1.1.3.3">fed</mtext></ci></apply></apply><apply id="alg1.l2.m1.6.6.2.2.cmml" xref="alg1.l2.m1.6.6.2.2"><eq id="alg1.l2.m1.6.6.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.1"></eq><apply id="alg1.l2.m1.6.6.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.2">subscript</csymbol><apply id="alg1.l2.m1.6.6.2.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.2">superscript</csymbol><ci id="alg1.l2.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2.2.2">𝑄</ci><interval closure="open" id="alg1.l2.m1.4.4.2.3.cmml" xref="alg1.l2.m1.4.4.2.4"><ci id="alg1.l2.m1.3.3.1.1.cmml" xref="alg1.l2.m1.3.3.1.1">𝑡</ci><cn type="integer" id="alg1.l2.m1.4.4.2.2.cmml" xref="alg1.l2.m1.4.4.2.2">0</cn></interval></apply><ci id="alg1.l2.m1.6.6.2.2.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.2.3">𝑖</ci></apply><apply id="alg1.l2.m1.6.6.2.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.3.1.cmml" xref="alg1.l2.m1.6.6.2.2.3">subscript</csymbol><apply id="alg1.l2.m1.6.6.2.2.3.2.cmml" xref="alg1.l2.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.3.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.3">superscript</csymbol><ci id="alg1.l2.m1.6.6.2.2.3.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.3.2.2">𝑄</ci><ci id="alg1.l2.m1.6.6.2.2.3.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.3.2.3">𝑡</ci></apply><ci id="alg1.l2.m1.6.6.2.2.3.3a.cmml" xref="alg1.l2.m1.6.6.2.2.3.3"><mtext mathsize="70%" id="alg1.l2.m1.6.6.2.2.3.3.cmml" xref="alg1.l2.m1.6.6.2.2.3.3">fed</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.6c">\pi_{i}^{(t,0)}=\pi^{t}_{\text{fed}},\quad Q^{(t,0)}_{i}=Q^{t}_{\text{fed}}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="1\leq k&lt;K" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mn id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">1</mn><mo id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">≤</mo><mi id="alg1.l3.m1.1.1.4" xref="alg1.l3.m1.1.1.4.cmml">k</mi><mo id="alg1.l3.m1.1.1.5" xref="alg1.l3.m1.1.1.5.cmml">&lt;</mo><mi id="alg1.l3.m1.1.1.6" xref="alg1.l3.m1.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><and id="alg1.l3.m1.1.1a.cmml" xref="alg1.l3.m1.1.1"></and><apply id="alg1.l3.m1.1.1b.cmml" xref="alg1.l3.m1.1.1"><leq id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"></leq><cn type="integer" id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">1</cn><ci id="alg1.l3.m1.1.1.4.cmml" xref="alg1.l3.m1.1.1.4">𝑘</ci></apply><apply id="alg1.l3.m1.1.1c.cmml" xref="alg1.l3.m1.1.1"><lt id="alg1.l3.m1.1.1.5.cmml" xref="alg1.l3.m1.1.1.5"></lt><share href="#alg1.l3.m1.1.1.4.cmml" id="alg1.l3.m1.1.1d.cmml" xref="alg1.l3.m1.1.1"></share><ci id="alg1.l3.m1.1.1.6.cmml" xref="alg1.l3.m1.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">1\leq k&lt;K</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        Update Critic by one gradient step w.r.t. Eq. (<a href="#S5.E11" title="In 5.2 Federated Optimism for Critic Training ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Update Actor by one gradient step w.r.t. Eq. (<a href="#S5.E14" title="In 5.3 Proximal Policy Update for Heterogeneous Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>)

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg1.l6.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     Decay <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{local}}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">ℒ</mi><mtext id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3a.cmml">local</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">ℒ</ci><ci id="alg1.l7.m1.1.1.3a.cmml" xref="alg1.l7.m1.1.1.3"><mtext mathsize="70%" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">local</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathcal{L}_{\text{local}}</annotation></semantics></math> by <math id="alg1.l7.m2.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\delta</annotation></semantics></math> if <math id="alg1.l7.m3.2" class="ltx_Math" alttext="J_{i}^{\text{fed},t}\geq J^{t}_{i}" display="inline"><semantics id="alg1.l7.m3.2a"><mrow id="alg1.l7.m3.2.3" xref="alg1.l7.m3.2.3.cmml"><msubsup id="alg1.l7.m3.2.3.2" xref="alg1.l7.m3.2.3.2.cmml"><mi id="alg1.l7.m3.2.3.2.2.2" xref="alg1.l7.m3.2.3.2.2.2.cmml">J</mi><mi id="alg1.l7.m3.2.3.2.2.3" xref="alg1.l7.m3.2.3.2.2.3.cmml">i</mi><mrow id="alg1.l7.m3.2.2.2.4" xref="alg1.l7.m3.2.2.2.3.cmml"><mtext id="alg1.l7.m3.1.1.1.1" xref="alg1.l7.m3.1.1.1.1a.cmml">fed</mtext><mo id="alg1.l7.m3.2.2.2.4.1" xref="alg1.l7.m3.2.2.2.3.cmml">,</mo><mi id="alg1.l7.m3.2.2.2.2" xref="alg1.l7.m3.2.2.2.2.cmml">t</mi></mrow></msubsup><mo id="alg1.l7.m3.2.3.1" xref="alg1.l7.m3.2.3.1.cmml">≥</mo><msubsup id="alg1.l7.m3.2.3.3" xref="alg1.l7.m3.2.3.3.cmml"><mi id="alg1.l7.m3.2.3.3.2.2" xref="alg1.l7.m3.2.3.3.2.2.cmml">J</mi><mi id="alg1.l7.m3.2.3.3.3" xref="alg1.l7.m3.2.3.3.3.cmml">i</mi><mi id="alg1.l7.m3.2.3.3.2.3" xref="alg1.l7.m3.2.3.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.2b"><apply id="alg1.l7.m3.2.3.cmml" xref="alg1.l7.m3.2.3"><geq id="alg1.l7.m3.2.3.1.cmml" xref="alg1.l7.m3.2.3.1"></geq><apply id="alg1.l7.m3.2.3.2.cmml" xref="alg1.l7.m3.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m3.2.3.2.1.cmml" xref="alg1.l7.m3.2.3.2">superscript</csymbol><apply id="alg1.l7.m3.2.3.2.2.cmml" xref="alg1.l7.m3.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m3.2.3.2.2.1.cmml" xref="alg1.l7.m3.2.3.2">subscript</csymbol><ci id="alg1.l7.m3.2.3.2.2.2.cmml" xref="alg1.l7.m3.2.3.2.2.2">𝐽</ci><ci id="alg1.l7.m3.2.3.2.2.3.cmml" xref="alg1.l7.m3.2.3.2.2.3">𝑖</ci></apply><list id="alg1.l7.m3.2.2.2.3.cmml" xref="alg1.l7.m3.2.2.2.4"><ci id="alg1.l7.m3.1.1.1.1a.cmml" xref="alg1.l7.m3.1.1.1.1"><mtext mathsize="70%" id="alg1.l7.m3.1.1.1.1.cmml" xref="alg1.l7.m3.1.1.1.1">fed</mtext></ci><ci id="alg1.l7.m3.2.2.2.2.cmml" xref="alg1.l7.m3.2.2.2.2">𝑡</ci></list></apply><apply id="alg1.l7.m3.2.3.3.cmml" xref="alg1.l7.m3.2.3.3"><csymbol cd="ambiguous" id="alg1.l7.m3.2.3.3.1.cmml" xref="alg1.l7.m3.2.3.3">subscript</csymbol><apply id="alg1.l7.m3.2.3.3.2.cmml" xref="alg1.l7.m3.2.3.3"><csymbol cd="ambiguous" id="alg1.l7.m3.2.3.3.2.1.cmml" xref="alg1.l7.m3.2.3.3">superscript</csymbol><ci id="alg1.l7.m3.2.3.3.2.2.cmml" xref="alg1.l7.m3.2.3.3.2.2">𝐽</ci><ci id="alg1.l7.m3.2.3.3.2.3.cmml" xref="alg1.l7.m3.2.3.3.2.3">𝑡</ci></apply><ci id="alg1.l7.m3.2.3.3.3.cmml" xref="alg1.l7.m3.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.2c">J_{i}^{\text{fed},t}\geq J^{t}_{i}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FEDORA: Outline of Server Algorithm</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize <math id="alg2.l1.m1.2" class="ltx_Math" alttext="\pi^{1}_{\text{fed}},Q^{1}_{\text{fed}}" display="inline"><semantics id="alg2.l1.m1.2a"><mrow id="alg2.l1.m1.2.2.2" xref="alg2.l1.m1.2.2.3.cmml"><msubsup id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.2.2" xref="alg2.l1.m1.1.1.1.1.2.2.cmml">π</mi><mtext id="alg2.l1.m1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.3a.cmml">fed</mtext><mn id="alg2.l1.m1.1.1.1.1.2.3" xref="alg2.l1.m1.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="alg2.l1.m1.2.2.2.3" xref="alg2.l1.m1.2.2.3.cmml">,</mo><msubsup id="alg2.l1.m1.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.cmml"><mi id="alg2.l1.m1.2.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.2.cmml">Q</mi><mtext id="alg2.l1.m1.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.3a.cmml">fed</mtext><mn id="alg2.l1.m1.2.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.2.3.cmml">1</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.2b"><list id="alg2.l1.m1.2.2.3.cmml" xref="alg2.l1.m1.2.2.2"><apply id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1">subscript</csymbol><apply id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.2.1.cmml" xref="alg2.l1.m1.1.1.1.1">superscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.2.2">𝜋</ci><cn type="integer" id="alg2.l1.m1.1.1.1.1.2.3.cmml" xref="alg2.l1.m1.1.1.1.1.2.3">1</cn></apply><ci id="alg2.l1.m1.1.1.1.1.3a.cmml" xref="alg2.l1.m1.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l1.m1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.3">fed</mtext></ci></apply><apply id="alg2.l1.m1.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.2.2">subscript</csymbol><apply id="alg2.l1.m1.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.2.2">superscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.2">𝑄</ci><cn type="integer" id="alg2.l1.m1.2.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.3">1</cn></apply><ci id="alg2.l1.m1.2.2.2.2.3a.cmml" xref="alg2.l1.m1.2.2.2.2.3"><mtext mathsize="70%" id="alg2.l1.m1.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.3">fed</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.2c">\pi^{1}_{\text{fed}},Q^{1}_{\text{fed}}</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg2.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.1" class="ltx_Math" alttext="t\in 1\dots" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">t</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><mrow id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mn id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.3.1" xref="alg2.l2.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑡</ci><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><times id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3.1"></times><cn type="integer" id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">1</cn><ci id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">…</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">t\in 1\dots</annotation></semantics></math> <span id="alg2.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Send <math id="alg2.l3.m1.1" class="ltx_Math" alttext="\pi^{t}_{\text{fed}}" display="inline"><semantics id="alg2.l3.m1.1a"><msubsup id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">π</mi><mtext id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3a.cmml">fed</mtext><mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝜋</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l3.m1.1.1.3a.cmml" xref="alg2.l3.m1.1.1.3"><mtext mathsize="70%" id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">fed</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\pi^{t}_{\text{fed}}</annotation></semantics></math> and <math id="alg2.l3.m2.1" class="ltx_Math" alttext="Q^{t}_{\text{fed}}" display="inline"><semantics id="alg2.l3.m2.1a"><msubsup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi id="alg2.l3.m2.1.1.2.2" xref="alg2.l3.m2.1.1.2.2.cmml">Q</mi><mtext id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3a.cmml">fed</mtext><mi id="alg2.l3.m2.1.1.2.3" xref="alg2.l3.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">subscript</csymbol><apply id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.2.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.2.2.cmml" xref="alg2.l3.m2.1.1.2.2">𝑄</ci><ci id="alg2.l3.m2.1.1.2.3.cmml" xref="alg2.l3.m2.1.1.2.3">𝑡</ci></apply><ci id="alg2.l3.m2.1.1.3a.cmml" xref="alg2.l3.m2.1.1.3"><mtext mathsize="70%" id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">fed</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">Q^{t}_{\text{fed}}</annotation></semantics></math> to <math id="alg2.l3.m3.1" class="ltx_Math" alttext="i\in\mathcal{N}" display="inline"><semantics id="alg2.l3.m3.1a"><mrow id="alg2.l3.m3.1.1" xref="alg2.l3.m3.1.1.cmml"><mi id="alg2.l3.m3.1.1.2" xref="alg2.l3.m3.1.1.2.cmml">i</mi><mo id="alg2.l3.m3.1.1.1" xref="alg2.l3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m3.1.1.3" xref="alg2.l3.m3.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m3.1b"><apply id="alg2.l3.m3.1.1.cmml" xref="alg2.l3.m3.1.1"><in id="alg2.l3.m3.1.1.1.cmml" xref="alg2.l3.m3.1.1.1"></in><ci id="alg2.l3.m3.1.1.2.cmml" xref="alg2.l3.m3.1.1.2">𝑖</ci><ci id="alg2.l3.m3.1.1.3.cmml" xref="alg2.l3.m3.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m3.1c">i\in\mathcal{N}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Sample <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathcal{N}_{t}\subset\mathcal{N}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msub id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">𝒩</mi><mi id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">𝒩</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><subset id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></subset><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝒩</ci><ci id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝒩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{N}_{t}\subset\mathcal{N}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg2.l5.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg2.l5.m1.1" class="ltx_Math" alttext="i\in\mathcal{N}_{t}" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">i</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">∈</mo><msub id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml">𝒩</mi><mi id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><in id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></in><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑖</ci><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2">𝒩</ci><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">i\in\mathcal{N}_{t}</annotation></semantics></math> <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <math id="alg2.l6.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">i</annotation></semantics></math>.train_client <math id="alg2.l6.m2.2" class="ltx_Math" alttext="(\pi^{t}_{\text{fed}},Q^{t}_{\text{fed}})" display="inline"><semantics id="alg2.l6.m2.2a"><mrow id="alg2.l6.m2.2.2.2" xref="alg2.l6.m2.2.2.3.cmml"><mo stretchy="false" id="alg2.l6.m2.2.2.2.3" xref="alg2.l6.m2.2.2.3.cmml">(</mo><msubsup id="alg2.l6.m2.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.1.2.2" xref="alg2.l6.m2.1.1.1.1.2.2.cmml">π</mi><mtext id="alg2.l6.m2.1.1.1.1.3" xref="alg2.l6.m2.1.1.1.1.3a.cmml">fed</mtext><mi id="alg2.l6.m2.1.1.1.1.2.3" xref="alg2.l6.m2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg2.l6.m2.2.2.2.4" xref="alg2.l6.m2.2.2.3.cmml">,</mo><msubsup id="alg2.l6.m2.2.2.2.2" xref="alg2.l6.m2.2.2.2.2.cmml"><mi id="alg2.l6.m2.2.2.2.2.2.2" xref="alg2.l6.m2.2.2.2.2.2.2.cmml">Q</mi><mtext id="alg2.l6.m2.2.2.2.2.3" xref="alg2.l6.m2.2.2.2.2.3a.cmml">fed</mtext><mi id="alg2.l6.m2.2.2.2.2.2.3" xref="alg2.l6.m2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg2.l6.m2.2.2.2.5" xref="alg2.l6.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.2b"><interval closure="open" id="alg2.l6.m2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2"><apply id="alg2.l6.m2.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1">subscript</csymbol><apply id="alg2.l6.m2.1.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.2.1.cmml" xref="alg2.l6.m2.1.1.1.1">superscript</csymbol><ci id="alg2.l6.m2.1.1.1.1.2.2.cmml" xref="alg2.l6.m2.1.1.1.1.2.2">𝜋</ci><ci id="alg2.l6.m2.1.1.1.1.2.3.cmml" xref="alg2.l6.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l6.m2.1.1.1.1.3a.cmml" xref="alg2.l6.m2.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l6.m2.1.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.1.3">fed</mtext></ci></apply><apply id="alg2.l6.m2.2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m2.2.2.2.2.1.cmml" xref="alg2.l6.m2.2.2.2.2">subscript</csymbol><apply id="alg2.l6.m2.2.2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m2.2.2.2.2.2.1.cmml" xref="alg2.l6.m2.2.2.2.2">superscript</csymbol><ci id="alg2.l6.m2.2.2.2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2.2.2.2">𝑄</ci><ci id="alg2.l6.m2.2.2.2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.l6.m2.2.2.2.2.3a.cmml" xref="alg2.l6.m2.2.2.2.2.3"><mtext mathsize="70%" id="alg2.l6.m2.2.2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2.2.3">fed</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.2c">(\pi^{t}_{\text{fed}},Q^{t}_{\text{fed}})</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg2.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     Compute <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\pi_{\text{fed}}^{t+1}" display="inline"><semantics id="alg2.l8.m1.1a"><msubsup id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2.2" xref="alg2.l8.m1.1.1.2.2.cmml">π</mi><mtext id="alg2.l8.m1.1.1.2.3" xref="alg2.l8.m1.1.1.2.3a.cmml">fed</mtext><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml">t</mi><mo id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">+</mo><mn id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1">superscript</csymbol><apply id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.2.2">𝜋</ci><ci id="alg2.l8.m1.1.1.2.3a.cmml" xref="alg2.l8.m1.1.1.2.3"><mtext mathsize="70%" id="alg2.l8.m1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.2.3">fed</mtext></ci></apply><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><plus id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></plus><ci id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l8.m1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\pi_{\text{fed}}^{t+1}</annotation></semantics></math> and <math id="alg2.l8.m2.1" class="ltx_Math" alttext="Q_{\text{fed}}^{t+1}" display="inline"><semantics id="alg2.l8.m2.1a"><msubsup id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml"><mi id="alg2.l8.m2.1.1.2.2" xref="alg2.l8.m2.1.1.2.2.cmml">Q</mi><mtext id="alg2.l8.m2.1.1.2.3" xref="alg2.l8.m2.1.1.2.3a.cmml">fed</mtext><mrow id="alg2.l8.m2.1.1.3" xref="alg2.l8.m2.1.1.3.cmml"><mi id="alg2.l8.m2.1.1.3.2" xref="alg2.l8.m2.1.1.3.2.cmml">t</mi><mo id="alg2.l8.m2.1.1.3.1" xref="alg2.l8.m2.1.1.3.1.cmml">+</mo><mn id="alg2.l8.m2.1.1.3.3" xref="alg2.l8.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><apply id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1"><csymbol cd="ambiguous" id="alg2.l8.m2.1.1.1.cmml" xref="alg2.l8.m2.1.1">superscript</csymbol><apply id="alg2.l8.m2.1.1.2.cmml" xref="alg2.l8.m2.1.1"><csymbol cd="ambiguous" id="alg2.l8.m2.1.1.2.1.cmml" xref="alg2.l8.m2.1.1">subscript</csymbol><ci id="alg2.l8.m2.1.1.2.2.cmml" xref="alg2.l8.m2.1.1.2.2">𝑄</ci><ci id="alg2.l8.m2.1.1.2.3a.cmml" xref="alg2.l8.m2.1.1.2.3"><mtext mathsize="70%" id="alg2.l8.m2.1.1.2.3.cmml" xref="alg2.l8.m2.1.1.2.3">fed</mtext></ci></apply><apply id="alg2.l8.m2.1.1.3.cmml" xref="alg2.l8.m2.1.1.3"><plus id="alg2.l8.m2.1.1.3.1.cmml" xref="alg2.l8.m2.1.1.3.1"></plus><ci id="alg2.l8.m2.1.1.3.2.cmml" xref="alg2.l8.m2.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l8.m2.1.1.3.3.cmml" xref="alg2.l8.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">Q_{\text{fed}}^{t+1}</annotation></semantics></math> for clients in <math id="alg2.l8.m3.1" class="ltx_Math" alttext="\mathcal{N}_{t}" display="inline"><semantics id="alg2.l8.m3.1a"><msub id="alg2.l8.m3.1.1" xref="alg2.l8.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m3.1.1.2" xref="alg2.l8.m3.1.1.2.cmml">𝒩</mi><mi id="alg2.l8.m3.1.1.3" xref="alg2.l8.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.m3.1b"><apply id="alg2.l8.m3.1.1.cmml" xref="alg2.l8.m3.1.1"><csymbol cd="ambiguous" id="alg2.l8.m3.1.1.1.cmml" xref="alg2.l8.m3.1.1">subscript</csymbol><ci id="alg2.l8.m3.1.1.2.cmml" xref="alg2.l8.m3.1.1.2">𝒩</ci><ci id="alg2.l8.m3.1.1.3.cmml" xref="alg2.l8.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m3.1c">\mathcal{N}_{t}</annotation></semantics></math> using Eq.  (<a href="#S5.E8" title="In 5.1 Ensemble-Directed Learning over Client Policies ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) and  (<a href="#S5.E9" title="In 5.2 Federated Optimism for Critic Training ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) respectively.

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg2.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experimental Evaluation</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We conduct experiments to answer three broad questions: <span id="S6.p1.1.1" class="ltx_text ltx_font_bold">(i) Comparative Performance:</span> How does FEDORA perform compared to other approaches with client data generated by heterogeneous behavior policies?, <span id="S6.p1.1.2" class="ltx_text ltx_font_bold">(ii) Sensitivity to client updates and data quality:</span> How does the performance depend on the number of local gradient steps at clients, the randomness in the available number of agents for federation, and the quality of the data at the clients?, and <span id="S6.p1.1.3" class="ltx_text ltx_font_bold">(iii) Ablation:</span> How does the performance depend on the different components of FEDORA?</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Implementing FEDORA</h3>

<div id="S6.SS1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.p1.1" class="ltx_p">We implement FEDORA over the Flower federated learning platform <cite class="ltx_cite ltx_citemacro_citep">(Beutel et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, which supports learning across devices with heterogeneous software stacks, compute capabilities, and network bandwidths. Flower manages all communication across clients and the server and permits us to implement the custom server-side and client-side algorithms of FEDORA easily. However, since Flower is aimed at supervised learning, it only transmits and receives a single model at each federation round, whereas we desire to federate both policies and critic models. We solve this limitation by simply appending both models together, packing and unpacking them at the server and client sides appropriately.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.p2.1" class="ltx_p">While ‘FEDORA-over-Flower’ is an effective solution for working across distributed compute resources, we also desire a simulation setup that can be executed on a single machine. This approach sequentially executes FEDORA at each selected client, followed by a federation step, thereby allowing us to evaluate the different elements of FEDORA in an idealized federation setup.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Methodology</h3>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS2.p1.1" class="ltx_p"><span id="S6.SS2.p1.1.1" class="ltx_text ltx_font_bold">Baselines:</span> We consider the following baselines. <span id="S6.SS2.p1.1.2" class="ltx_text ltx_font_bold">(i) Fed-A: Naïve Actor Federation:</span> The local objective of all clients follows TD3-BC (Eq. <a href="#S3.E4" title="In 3 Preliminaries ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). The server performs FedAvg over the actor’s parameters, whereas each client learns the critic locally. <span id="S6.SS2.p1.1.3" class="ltx_text ltx_font_bold">(ii) Fed-AC: Naïve Actor-Critic Federation:</span> The local objective of all clients follows TD3-BC and the server performs FedAvg over the parameters of both the actor and the critic. <span id="S6.SS2.p1.1.4" class="ltx_text ltx_font_bold">(iii) Fed-AC-Prox:</span> We add a proximal term to Fed-AC, which has been shown to help in federated supervised learning when clients have heterogeneous data <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>. <span id="S6.SS2.p1.1.5" class="ltx_text ltx_font_bold">(iv) Heterogeneous Data-Aware Federated Learning (HDAFL)</span> We extend HDAFL <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>)</cite> to the offline RL setting by dividing the actor network into generic and client-specific parts and then federating only the generic part during each round. <span id="S6.SS2.p1.1.6" class="ltx_text ltx_font_bold">(v) Centralized:</span> We perform offline RL over the pooled data by combining the data present in all clients and performing TD3-BC.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS2.p2.7" class="ltx_p"><span id="S6.SS2.p2.7.1" class="ltx_text ltx_font_bold">Experimental Setup:</span> We focus on a scenario where clients are collaboratively learning to solve the same task, but the behavior policies used to collect data for each client could differ. We run experiments with the number of clients <math id="S6.SS2.p2.1.m1.2" class="ltx_Math" alttext="|\mathcal{N}|=50," display="inline"><semantics id="S6.SS2.p2.1.m1.2a"><mrow id="S6.SS2.p2.1.m1.2.2.1" xref="S6.SS2.p2.1.m1.2.2.1.1.cmml"><mrow id="S6.SS2.p2.1.m1.2.2.1.1" xref="S6.SS2.p2.1.m1.2.2.1.1.cmml"><mrow id="S6.SS2.p2.1.m1.2.2.1.1.2.2" xref="S6.SS2.p2.1.m1.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S6.SS2.p2.1.m1.2.2.1.1.2.2.1" xref="S6.SS2.p2.1.m1.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">𝒩</mi><mo stretchy="false" id="S6.SS2.p2.1.m1.2.2.1.1.2.2.2" xref="S6.SS2.p2.1.m1.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S6.SS2.p2.1.m1.2.2.1.1.1" xref="S6.SS2.p2.1.m1.2.2.1.1.1.cmml">=</mo><mn id="S6.SS2.p2.1.m1.2.2.1.1.3" xref="S6.SS2.p2.1.m1.2.2.1.1.3.cmml">50</mn></mrow><mo id="S6.SS2.p2.1.m1.2.2.1.2" xref="S6.SS2.p2.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.2b"><apply id="S6.SS2.p2.1.m1.2.2.1.1.cmml" xref="S6.SS2.p2.1.m1.2.2.1"><eq id="S6.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S6.SS2.p2.1.m1.2.2.1.1.1"></eq><apply id="S6.SS2.p2.1.m1.2.2.1.1.2.1.cmml" xref="S6.SS2.p2.1.m1.2.2.1.1.2.2"><abs id="S6.SS2.p2.1.m1.2.2.1.1.2.1.1.cmml" xref="S6.SS2.p2.1.m1.2.2.1.1.2.2.1"></abs><ci id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">𝒩</ci></apply><cn type="integer" id="S6.SS2.p2.1.m1.2.2.1.1.3.cmml" xref="S6.SS2.p2.1.m1.2.2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.2c">|\mathcal{N}|=50,</annotation></semantics></math> with each client having a local dataset of size <math id="S6.SS2.p2.2.m2.1" class="ltx_Math" alttext="|\mathcal{D}_{i}|=5000" display="inline"><semantics id="S6.SS2.p2.2.m2.1a"><mrow id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml"><mrow id="S6.SS2.p2.2.m2.1.1.1.1" xref="S6.SS2.p2.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S6.SS2.p2.2.m2.1.1.1.1.2" xref="S6.SS2.p2.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S6.SS2.p2.2.m2.1.1.1.1.1" xref="S6.SS2.p2.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p2.2.m2.1.1.1.1.1.2" xref="S6.SS2.p2.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S6.SS2.p2.2.m2.1.1.1.1.1.3" xref="S6.SS2.p2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S6.SS2.p2.2.m2.1.1.1.1.3" xref="S6.SS2.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S6.SS2.p2.2.m2.1.1.2" xref="S6.SS2.p2.2.m2.1.1.2.cmml">=</mo><mn id="S6.SS2.p2.2.m2.1.1.3" xref="S6.SS2.p2.2.m2.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><apply id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1"><eq id="S6.SS2.p2.2.m2.1.1.2.cmml" xref="S6.SS2.p2.2.m2.1.1.2"></eq><apply id="S6.SS2.p2.2.m2.1.1.1.2.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1"><abs id="S6.SS2.p2.2.m2.1.1.1.2.1.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1.2"></abs><apply id="S6.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S6.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S6.SS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS2.p2.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S6.SS2.p2.2.m2.1.1.3.cmml" xref="S6.SS2.p2.2.m2.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">|\mathcal{D}_{i}|=5000</annotation></semantics></math>. Of these <math id="S6.SS2.p2.3.m3.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S6.SS2.p2.3.m3.1a"><mn id="S6.SS2.p2.3.m3.1.1" xref="S6.SS2.p2.3.m3.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.3.m3.1b"><cn type="integer" id="S6.SS2.p2.3.m3.1.1.cmml" xref="S6.SS2.p2.3.m3.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.3.m3.1c">50</annotation></semantics></math> clients, <math id="S6.SS2.p2.4.m4.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S6.SS2.p2.4.m4.1a"><mn id="S6.SS2.p2.4.m4.1.1" xref="S6.SS2.p2.4.m4.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.4.m4.1b"><cn type="integer" id="S6.SS2.p2.4.m4.1.1.cmml" xref="S6.SS2.p2.4.m4.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.4.m4.1c">25</annotation></semantics></math> are provided with data from the D4RL <cite class="ltx_cite ltx_citemacro_citep">(Fu et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> expert dataset, while the other <math id="S6.SS2.p2.5.m5.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S6.SS2.p2.5.m5.1a"><mn id="S6.SS2.p2.5.m5.1.1" xref="S6.SS2.p2.5.m5.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.5.m5.1b"><cn type="integer" id="S6.SS2.p2.5.m5.1.1.cmml" xref="S6.SS2.p2.5.m5.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.5.m5.1c">25</annotation></semantics></math> are provided with data from the D4RL medium dataset. The clients (and the server) are unaware of the nature of their datasets. We choose <math id="S6.SS2.p2.6.m6.1" class="ltx_Math" alttext="|\mathcal{N}_{t}|=20" display="inline"><semantics id="S6.SS2.p2.6.m6.1a"><mrow id="S6.SS2.p2.6.m6.1.1" xref="S6.SS2.p2.6.m6.1.1.cmml"><mrow id="S6.SS2.p2.6.m6.1.1.1.1" xref="S6.SS2.p2.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S6.SS2.p2.6.m6.1.1.1.1.2" xref="S6.SS2.p2.6.m6.1.1.1.2.1.cmml">|</mo><msub id="S6.SS2.p2.6.m6.1.1.1.1.1" xref="S6.SS2.p2.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p2.6.m6.1.1.1.1.1.2" xref="S6.SS2.p2.6.m6.1.1.1.1.1.2.cmml">𝒩</mi><mi id="S6.SS2.p2.6.m6.1.1.1.1.1.3" xref="S6.SS2.p2.6.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S6.SS2.p2.6.m6.1.1.1.1.3" xref="S6.SS2.p2.6.m6.1.1.1.2.1.cmml">|</mo></mrow><mo id="S6.SS2.p2.6.m6.1.1.2" xref="S6.SS2.p2.6.m6.1.1.2.cmml">=</mo><mn id="S6.SS2.p2.6.m6.1.1.3" xref="S6.SS2.p2.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.6.m6.1b"><apply id="S6.SS2.p2.6.m6.1.1.cmml" xref="S6.SS2.p2.6.m6.1.1"><eq id="S6.SS2.p2.6.m6.1.1.2.cmml" xref="S6.SS2.p2.6.m6.1.1.2"></eq><apply id="S6.SS2.p2.6.m6.1.1.1.2.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1"><abs id="S6.SS2.p2.6.m6.1.1.1.2.1.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1.2"></abs><apply id="S6.SS2.p2.6.m6.1.1.1.1.1.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S6.SS2.p2.6.m6.1.1.1.1.1.2.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1.1.2">𝒩</ci><ci id="S6.SS2.p2.6.m6.1.1.1.1.1.3.cmml" xref="S6.SS2.p2.6.m6.1.1.1.1.1.3">𝑡</ci></apply></apply><cn type="integer" id="S6.SS2.p2.6.m6.1.1.3.cmml" xref="S6.SS2.p2.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.6.m6.1c">|\mathcal{N}_{t}|=20</annotation></semantics></math> clients at random to participate in each round <math id="S6.SS2.p2.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S6.SS2.p2.7.m7.1a"><mi id="S6.SS2.p2.7.m7.1.1" xref="S6.SS2.p2.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.7.m7.1b"><ci id="S6.SS2.p2.7.m7.1.1.cmml" xref="S6.SS2.p2.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.7.m7.1c">t</annotation></semantics></math> of federation. For each plot, we evaluate the performance with four different seeds. The solid lines or bars in the plots correspond to the mean estimate and the shaded region in the plots shows the estimate’s standard deviation.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para ltx_noindent">
<p id="S6.SS2.p3.2" class="ltx_p">We evaluate the performance of FEDORA and the baselines over three MuJoCo tasks: Hopper, HalfCheetah, and Walker2D. During a round of federation, each client performs <math id="S6.SS2.p3.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S6.SS2.p3.1.m1.1a"><mn id="S6.SS2.p3.1.m1.1.1" xref="S6.SS2.p3.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.1.m1.1b"><cn type="integer" id="S6.SS2.p3.1.m1.1.1.cmml" xref="S6.SS2.p3.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.1.m1.1c">20</annotation></semantics></math> epochs of local training in all algorithms, which is roughly <math id="S6.SS2.p3.2.m2.1" class="ltx_Math" alttext="380" display="inline"><semantics id="S6.SS2.p3.2.m2.1a"><mn id="S6.SS2.p3.2.m2.1.1" xref="S6.SS2.p3.2.m2.1.1.cmml">380</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.2.m2.1b"><cn type="integer" id="S6.SS2.p3.2.m2.1.1.cmml" xref="S6.SS2.p3.2.m2.1.1">380</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.2.m2.1c">380</annotation></semantics></math> local gradient steps in our experimental setup. We also show results on the CityLearn <cite class="ltx_cite ltx_citemacro_citep">(Vázquez-Canteli et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> environment, which aims for urban-scale energy management based on data collected from a collection of residential buildings.
Finally we demonstrate the performance of FEDORA in the real-world using a TurtleBot, a two-wheeled differential drive robot on a obstacle avoidance problem.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Comparative Performance of FEDORA</h3>

<figure id="S6.F2" class="ltx_figure ltx_align_floatright"><img src="/html/2305.03097/assets/x2.png" id="S6.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="265" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S6.F2.3.2" class="ltx_text" style="font-size:90%;">Comparison of FEDORA and centralized training under heterogeneous data. </span></figcaption>
</figure>
<div id="S6.SS3.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.p1.1" class="ltx_p">In Fig. <a href="#S6.F3" title="Figure 3 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we plot the cumulative episodic reward of the server/federated policy during each round of communication/federation. We observe that FEDORA outperforms all federated baselines and achieves performance equivalent to or better than centralized training. Furthermore, the federated baselines fail to learn a good server policy even after training for many communication rounds and plateau at lower levels compared to FEDORA, emphasizing that the presence of heterogeneous data hurts their performance. In the Hopper environment, FEDORA’s performance exceeds the centralized training baseline.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.p2.4" class="ltx_p">To further understand the effect of data coming from multiple behavior policies on centralized training, we consider a scenario where <math id="S6.SS3.p2.1.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S6.SS3.p2.1.m1.1a"><mn id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><cn type="integer" id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">50</annotation></semantics></math> clients with datasets of size <math id="S6.SS3.p2.2.m2.1" class="ltx_Math" alttext="|D_{i}|=5000" display="inline"><semantics id="S6.SS3.p2.2.m2.1a"><mrow id="S6.SS3.p2.2.m2.1.1" xref="S6.SS3.p2.2.m2.1.1.cmml"><mrow id="S6.SS3.p2.2.m2.1.1.1.1" xref="S6.SS3.p2.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S6.SS3.p2.2.m2.1.1.1.1.2" xref="S6.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S6.SS3.p2.2.m2.1.1.1.1.1" xref="S6.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS3.p2.2.m2.1.1.1.1.1.2" xref="S6.SS3.p2.2.m2.1.1.1.1.1.2.cmml">D</mi><mi id="S6.SS3.p2.2.m2.1.1.1.1.1.3" xref="S6.SS3.p2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S6.SS3.p2.2.m2.1.1.1.1.3" xref="S6.SS3.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S6.SS3.p2.2.m2.1.1.2" xref="S6.SS3.p2.2.m2.1.1.2.cmml">=</mo><mn id="S6.SS3.p2.2.m2.1.1.3" xref="S6.SS3.p2.2.m2.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.1b"><apply id="S6.SS3.p2.2.m2.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1"><eq id="S6.SS3.p2.2.m2.1.1.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2"></eq><apply id="S6.SS3.p2.2.m2.1.1.1.2.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1"><abs id="S6.SS3.p2.2.m2.1.1.1.2.1.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1.2"></abs><apply id="S6.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S6.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1.1.2">𝐷</ci><ci id="S6.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS3.p2.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S6.SS3.p2.2.m2.1.1.3.cmml" xref="S6.SS3.p2.2.m2.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.1c">|D_{i}|=5000</annotation></semantics></math> participate in federation, with <math id="S6.SS3.p2.3.m3.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S6.SS3.p2.3.m3.1a"><mn id="S6.SS3.p2.3.m3.1.1" xref="S6.SS3.p2.3.m3.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.m3.1b"><cn type="integer" id="S6.SS3.p2.3.m3.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.m3.1c">25</annotation></semantics></math> clients having expert data and the other <math id="S6.SS3.p2.4.m4.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S6.SS3.p2.4.m4.1a"><mn id="S6.SS3.p2.4.m4.1.1" xref="S6.SS3.p2.4.m4.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.4.m4.1b"><cn type="integer" id="S6.SS3.p2.4.m4.1.1.cmml" xref="S6.SS3.p2.4.m4.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.4.m4.1c">25</annotation></semantics></math> having random data, i.e., data generated from a random policy. We compare the performance of FEDORA with the centralized setting. From Fig. <a href="#S6.F2" title="Figure 2 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we notice that combining data of all clients deteriorates the performance of the centralized policy. This observation highlights the fact that performing centralized training with data collected using multiple behavior policies can be detrimental.</p>
</div>
<figure id="S6.F3" class="ltx_figure"><img src="/html/2305.03097/assets/x3.png" id="S6.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="117" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S6.F3.3.2" class="ltx_text" style="font-size:90%;">Evaluation of algorithms on different MuJoCo environments.</span></figcaption>
</figure>
<figure id="S6.F4" class="ltx_figure"><img src="/html/2305.03097/assets/x4.png" id="S6.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S6.F4.3.2" class="ltx_text" style="font-size:90%;">Effect of varying the number of (a) local gradient steps, (b) participating clients in each round, and (c) expert clients in FEDORA.</span></figcaption>
</figure>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Sensitivity to Client Updates and Data Quality</h3>

<div id="S6.SS4.p1" class="ltx_para ltx_noindent">
<p id="S6.SS4.p1.2" class="ltx_p">Communication efficiency is a crucial aspect of a good federated learning algorithm is its communication efficiency. Ideally, the federated policy should achieve peak performance within a small number of communication rounds. An intriguing question is whether increasing the number of local epochs to further train each client’s policy before federation could improve communication efficiency. However, multiple local epochs can be detrimental in the presence of heterogeneous data, leading to client drift and resulting in a highly heterogeneous set of client policies. To explore this question, we conduct experiments studying the effect of varying the number of local epochs performed in a federation round on the algorithm’s performance in the Hopper environment, as shown in Fig. <a href="#S6.F4" title="Figure 4 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a). We observe that increasing the number of epochs leads to faster learning, and for epochs greater than <math id="S6.SS4.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S6.SS4.p1.1.m1.1a"><mn id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><cn type="integer" id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">5</annotation></semantics></math>, our algorithm learns within <math id="S6.SS4.p1.2.m2.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S6.SS4.p1.2.m2.1a"><mn id="S6.SS4.p1.2.m2.1.1" xref="S6.SS4.p1.2.m2.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.2.m2.1b"><cn type="integer" id="S6.SS4.p1.2.m2.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.2.m2.1c">1000</annotation></semantics></math> communication rounds. This result suggests that FEDORA can effectively extract wisdom from a heterogeneous ensemble of policies.</p>
</div>
<div id="S6.SS4.p2" class="ltx_para ltx_noindent">
<p id="S6.SS4.p2.1" class="ltx_p">Not all clients may participate in every round of federation due to their location on distributed compute that might be intermittently accessible. Participation of only a subset of clients would vary both the quality of the ensemble of policies and the number of model updates available to the federating agent. We evaluate how FEDORA learns under various fractions of clients participating in each round of federation and illustrate the results in Fig. <a href="#S6.F4" title="Figure 4 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b). The plots show that the fraction of clients has only minor effects on the performance of the global policy. This finding leads us to conclude that FEDORA is fairly robust towards variations in the fraction of clients during federation.</p>
</div>
<div id="S6.SS4.p3" class="ltx_para ltx_noindent">
<p id="S6.SS4.p3.1" class="ltx_p">Finally, we consider heterogeneity in the quality of data available to the clients, affecting their ability to learn policies from their local datasets effectively. We conduct experiments where we vary the percentage of clients with expert datasets participating in federation. From the results presented in Fig. <a href="#S6.F4" title="Figure 4 ‣ 6.3 Comparative Performance of FEDORA ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(c), we observe that FEDORA performs well even when only <math id="S6.SS4.p3.1.m1.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S6.SS4.p3.1.m1.1a"><mrow id="S6.SS4.p3.1.m1.1.1" xref="S6.SS4.p3.1.m1.1.1.cmml"><mn id="S6.SS4.p3.1.m1.1.1.2" xref="S6.SS4.p3.1.m1.1.1.2.cmml">20</mn><mo id="S6.SS4.p3.1.m1.1.1.1" xref="S6.SS4.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.1.m1.1b"><apply id="S6.SS4.p3.1.m1.1.1.cmml" xref="S6.SS4.p3.1.m1.1.1"><csymbol cd="latexml" id="S6.SS4.p3.1.m1.1.1.1.cmml" xref="S6.SS4.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S6.SS4.p3.1.m1.1.1.2.cmml" xref="S6.SS4.p3.1.m1.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.1.m1.1c">20\%</annotation></semantics></math> of the total clients have expert-quality data.</p>
</div>
</section>
<section id="S6.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>FEDORA Ablation Study</h3>

<div id="S6.SS5.p1" class="ltx_para ltx_noindent">
<p id="S6.SS5.p1.1" class="ltx_p">We present ablation studies in the appendix due to space constraints. In summary, ensemble learning across the federated policies is the most crucial component of FEDORA, as expected, followed by federated optimism of the critic. Other elements contribute incrementally to FEDORA’s ultimately satisfying performance, as seen in Appendix <a href="#A2" title="Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a> Fig. <a href="#A2.F7" title="Figure 7 ‣ B.1 Importance of Individual Algorithm Component ‣ Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</section>
<section id="S6.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6 </span>Federated Offline RL with CityLearn Data</h3>

<div id="S6.SS6.p1" class="ltx_para ltx_noindent">
<p id="S6.SS6.p1.1" class="ltx_p">Real-world environments often have a large state space and are stochastic in nature. We run federated experiments on CityLearn <cite class="ltx_cite ltx_citemacro_citep">(Vázquez-Canteli et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> to assess the effectiveness of FEDORA on such large-scale systems. The motivation to evaluate on CityLearn and the details of our experiments involving <math id="S6.SS6.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S6.SS6.p1.1.m1.1a"><mn id="S6.SS6.p1.1.m1.1.1" xref="S6.SS6.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S6.SS6.p1.1.m1.1b"><cn type="integer" id="S6.SS6.p1.1.m1.1.1.cmml" xref="S6.SS6.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p1.1.m1.1c">10</annotation></semantics></math> clients are shared in Appendix <a href="#A3" title="Appendix C Federated Offline RL experiments with CityLearn ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>. In Appendix <a href="#A3" title="Appendix C Federated Offline RL experiments with CityLearn ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a> Fig. <a href="#A3.F9" title="Figure 9 ‣ Appendix C Federated Offline RL experiments with CityLearn ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, it can be observed that FEDORA outperforms other federated offline RL algorithms as well as centralized training, which learns using TD3-BC on the data aggregated from every client. These findings indicate that FEDORA can perform well in large-scale stochastic environments.</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2305.03097/assets/Figures/Robot/turtlebot.jpg" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="598" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S6.F5.3.2" class="ltx_text" style="font-size:90%;">TurtleBot3 Burger.</span></figcaption>
</figure>
</section>
<section id="S6.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.7 </span>Real-World Experiments</h3>

<div id="S6.SS7.p1" class="ltx_para ltx_noindent">
<p id="S6.SS7.p1.1" class="ltx_p">We evaluated the performance of FEDORA on TurtleBot <cite class="ltx_cite ltx_citemacro_citep">(Amsters &amp; Slaets, <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>, a two-wheeled differential drive robot shown in Fig. <a href="#S6.F5" title="Figure 5 ‣ 6.6 Federated Offline RL with CityLearn Data ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The goal is to collaboratively learn a control policy to navigate waypoints while avoiding obstacles using offline data distributed across multiple robots (clients). This scenario is relevant to several real-world applications, such as cleaning robots in various houses, which aim to collaboratively learn a control policy to navigate and avoid obstacles using data distributed across different robots. Collaborative learning is essential in this setting because a single robot might not have enough data to learn from or have encountered adequately different scenarios. Additionally, federated learning overcomes the privacy concerns associated with sharing data among the robots.</p>
</div>
<figure id="S6.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2305.03097/assets/x5.png" id="S6.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="496" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S6.F6.sf1.3.2" class="ltx_text" style="font-size:90%;">Trajectories of behavior policies</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2305.03097/assets/x6.png" id="S6.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="501" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S6.F6.sf2.3.2" class="ltx_text" style="font-size:90%;">Trajectories of learned policies</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S6.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2305.03097/assets/x7.png" id="S6.F6.sf3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="407" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S6.F6.sf3.3.2" class="ltx_text" style="font-size:90%;">Comparison of FEDORA with 
<br class="ltx_break">federated baseline algorithms</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S6.F6.3.2" class="ltx_text" style="font-size:90%;">Evaluation of FEDORA and other federated baselines for a mobile robot navigation task in the presence of an obstacle.</span></figcaption>
</figure>
<div id="S6.SS7.p2" class="ltx_para ltx_noindent">
<p id="S6.SS7.p2.4" class="ltx_p">In our setup, <math id="S6.SS7.p2.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S6.SS7.p2.1.m1.1a"><mn id="S6.SS7.p2.1.m1.1.1" xref="S6.SS7.p2.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S6.SS7.p2.1.m1.1b"><cn type="integer" id="S6.SS7.p2.1.m1.1.1.cmml" xref="S6.SS7.p2.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.p2.1.m1.1c">20</annotation></semantics></math> clients participate in the learning process, each with a dataset consisting of <math id="S6.SS7.p2.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S6.SS7.p2.2.m2.1a"><mn id="S6.SS7.p2.2.m2.1.1" xref="S6.SS7.p2.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S6.SS7.p2.2.m2.1b"><cn type="integer" id="S6.SS7.p2.2.m2.1.1.cmml" xref="S6.SS7.p2.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.p2.2.m2.1c">4</annotation></semantics></math> trajectories. We collect data using four behavior policies with varying levels of expertise, as seen in Fig. <a href="#S6.F6" title="Figure 6 ‣ 6.7 Real-World Experiments ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(a), and each robot’s data is obtained from a single behavior policy. The training occurs over <math id="S6.SS7.p2.3.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S6.SS7.p2.3.m3.1a"><mn id="S6.SS7.p2.3.m3.1.1" xref="S6.SS7.p2.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S6.SS7.p2.3.m3.1b"><cn type="integer" id="S6.SS7.p2.3.m3.1.1.cmml" xref="S6.SS7.p2.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.p2.3.m3.1c">100</annotation></semantics></math> communication rounds, each consisting of <math id="S6.SS7.p2.4.m4.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S6.SS7.p2.4.m4.1a"><mn id="S6.SS7.p2.4.m4.1.1" xref="S6.SS7.p2.4.m4.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S6.SS7.p2.4.m4.1b"><cn type="integer" id="S6.SS7.p2.4.m4.1.1.cmml" xref="S6.SS7.p2.4.m4.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS7.p2.4.m4.1c">20</annotation></semantics></math> local epochs. Fig. <a href="#S6.F6" title="Figure 6 ‣ 6.7 Real-World Experiments ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(b) shows the trajectories obtained by the learned policies of different algorithms, and only FEDORA is able to successfully complete the trajectory without colliding with the obstacle. Fig. <a href="#S6.F6" title="Figure 6 ‣ 6.7 Real-World Experiments ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(c) shows the cumulative reward comparison and FEDORA clearly outperforms other baselines.</p>
</div>
<div id="S6.SS7.p3" class="ltx_para ltx_noindent">
<p id="S6.SS7.p3.1" class="ltx_p">We provide more details on this robot experimental setup in Appendix <a href="#A4" title="Appendix D Details of Real-World Robot Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We presented an approach for federated offline RL, accounting for the heterogeneity in the quality of the ensemble of policies that generated the data at the clients. We solved multiple challenging issues by systematically developing an empirically well-performing ensemble-directed approach entitled FEDORA, which extracts the collective wisdom of the policies and critics and discourages excessive reliance on irrelevant local data. We believe that our approach likely has value even in the federated supervised learning context when the data is drawn from sources of variable qualities, which we intend to explore formally in the future.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amsters &amp; Slaets (2020)</span>
<span class="ltx_bibblock">
Amsters, R. and Slaets, P.

</span>
<span class="ltx_bibblock">Turtlebot 3 as a robotics education platform.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Robotics in Education: Current Research and Innovations</em>,
pp.  170–181. Springer, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al. (2020)</span>
<span class="ltx_bibblock">
Beutel, D. J., Topal, T., Mathur, A., Qiu, X., Parcollet, T., and Lane, N. D.

</span>
<span class="ltx_bibblock">Flower: A friendly federated learning research framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.14390</em>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Chen, L., Lu, K., Rajeswaran, A., Lee, K., Grover, A., Laskin, M., Abbeel, P.,
Srinivas, A., and Mordatch, I.

</span>
<span class="ltx_bibblock">Decision transformer: Reinforcement learning via sequence modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
34:15084–15097, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, X., Zhou, Z., Wang, Z., Wang, C., Wu, Y., and Ross, K.

</span>
<span class="ltx_bibblock">Bail: Best-action imitation learning for batch deep reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:18353–18363, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2020)</span>
<span class="ltx_bibblock">
Fu, J., Kumar, A., Nachum, O., Tucker, G., and Levine, S.

</span>
<span class="ltx_bibblock">D4rl: Datasets for deep data-driven reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.07219</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto &amp; Gu (2021)</span>
<span class="ltx_bibblock">
Fujimoto, S. and Gu, S. S.

</span>
<span class="ltx_bibblock">A minimalist approach to offline reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
34:20132–20145, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto et al. (2018)</span>
<span class="ltx_bibblock">
Fujimoto, S., Hoof, H., and Meger, D.

</span>
<span class="ltx_bibblock">Addressing function approximation error in actor-critic methods.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 1587–1596, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto et al. (2019)</span>
<span class="ltx_bibblock">
Fujimoto, S., Meger, D., and Precup, D.

</span>
<span class="ltx_bibblock">Off-policy deep reinforcement learning without exploration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 2052–2062, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hebert et al. (2022)</span>
<span class="ltx_bibblock">
Hebert, L., Golab, L., Poupart, P., and Cohen, R.

</span>
<span class="ltx_bibblock">Fedformer: Contextual federation with attention in reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2205.13697</em>, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Hu, Y., Hua, Y., Liu, W., and Zhu, J.

</span>
<span class="ltx_bibblock">Reward shaping based federated reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, 9:67259–67267, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Janner et al. (2021)</span>
<span class="ltx_bibblock">
Janner, M., Li, Q., and Levine, S.

</span>
<span class="ltx_bibblock">Offline reinforcement learning as one big sequence modeling problem.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
34:1273–1286, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N.,
Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh,
A. T.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5132–5143, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khodadadian et al. (2022)</span>
<span class="ltx_bibblock">
Khodadadian, S., Sharma, P., Joshi, G., and Maguluri, S. T.

</span>
<span class="ltx_bibblock">Federated reinforcement learning: Linear speedup under markovian
sampling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 10997–11057, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2019)</span>
<span class="ltx_bibblock">
Kumar, A., Fu, J., Soh, M., Tucker, G., and Levine, S.

</span>
<span class="ltx_bibblock">Stabilizing off-policy q-learning via bootstrapping error reduction.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2020)</span>
<span class="ltx_bibblock">
Kumar, A., Zhou, A., Tucker, G., and Levine, S.

</span>
<span class="ltx_bibblock">Conservative q-learning for offline reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:1179–1191, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine et al. (2020)</span>
<span class="ltx_bibblock">
Levine, S., Kumar, A., Tucker, G., and Fu, J.

</span>
<span class="ltx_bibblock">Offline reinforcement learning: Tutorial, review, and perspectives on
open problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2005.01643</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim et al. (2021)</span>
<span class="ltx_bibblock">
Lim, H.-K., Kim, J.-B., Ullah, I., Heo, J.-S., and Han, Y.-H.

</span>
<span class="ltx_bibblock">Federated reinforcement learning acceleration method for precise
control of multiple devices.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, 9:76296–76306, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282,
2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nadiger et al. (2019)</span>
<span class="ltx_bibblock">
Nadiger, C., Kumar, A., and Abdelhak, S.

</span>
<span class="ltx_bibblock">Federated reinforcement learning for fast personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Second International Conference on Artificial
Intelligence and Knowledge Engineering (AIKE)</em>, pp.  123–127. IEEE, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2019)</span>
<span class="ltx_bibblock">
Peng, X. B., Kumar, A., Zhang, G., and Levine, S.

</span>
<span class="ltx_bibblock">Advantage-weighted regression: Simple and scalable off-policy
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.00177</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2021)</span>
<span class="ltx_bibblock">
Qi, J., Zhou, Q., Lei, L., and Zheng, K.

</span>
<span class="ltx_bibblock">Federated reinforcement learning: techniques, applications, and open
challenges.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.11887</em>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2021)</span>
<span class="ltx_bibblock">
Qin, R., Gao, S., Zhang, X., Xu, Z., Huang, S., Li, Z., Zhang, W., and Yu, Y.

</span>
<span class="ltx_bibblock">Neorl: A near real-world benchmark for offline reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.00714</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Reddi, S. J., Charles, Z., Zaheer, M., Garrett, Z., Rush, K.,
Konečný, J., Kumar, S., and McMahan, H. B.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2015)</span>
<span class="ltx_bibblock">
Schulman, J., Levine, S., Abbeel, P., Jordan, M., and Moritz, P.

</span>
<span class="ltx_bibblock">Trust region policy optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 32nd International Conference on Machine
Learning</em>, volume 37, pp.  1889–1897, 2015.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Todorov et al. (2012)</span>
<span class="ltx_bibblock">
Todorov, E., Erez, T., and Tassa, Y.

</span>
<span class="ltx_bibblock">Mujoco: A physics engine for model-based control.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE/RSJ international conference on intelligent robots and
systems</em>, pp.  5026–5033, 2012.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vázquez-Canteli et al. (2020)</span>
<span class="ltx_bibblock">
Vázquez-Canteli, J. R., Dey, S., Henze, G., and Nagy, Z.

</span>
<span class="ltx_bibblock">Citylearn: Standardizing research in multi-agent reinforcement
learning for demand response and urban energy management.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.10504</em>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, J., Charles, Z., Xu, Z., Joshi, G., McMahan, H. B., Al-Shedivat, M.,
Andrew, G., Avestimehr, S., Daly, K., Data, D., et al.

</span>
<span class="ltx_bibblock">A field guide to federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.06917</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Wang, Q., Xiong, J., Han, L., Liu, H., Zhang, T., et al.

</span>
<span class="ltx_bibblock">Exponentially weighted imitation learning for batched historical
data.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2018.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, X., Li, R., Wang, C., Li, X., Taleb, T., and Leung, V. C.

</span>
<span class="ltx_bibblock">Attention-weighted federated deep reinforcement learning for
device-to-device assisted heterogeneous collaborative edge caching.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in Communications</em>, 39(1):154–169, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2019)</span>
<span class="ltx_bibblock">
Wu, Y., Tucker, G., and Nachum, O.

</span>
<span class="ltx_bibblock">Behavior regularized offline reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.11361</em>, 2019.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie &amp; Song (2023)</span>
<span class="ltx_bibblock">
Xie, Z. and Song, S.

</span>
<span class="ltx_bibblock">Fedkl: Tackling data heterogeneity in federated reinforcement
learning by penalizing kl divergence.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in Communications</em>, 41(4):1227–1242, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2020)</span>
<span class="ltx_bibblock">
Yang, L., Beliard, C., and Rossi, D.

</span>
<span class="ltx_bibblock">Heterogeneous data-aware federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2011.06393</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021)</span>
<span class="ltx_bibblock">
Yu, T., Kumar, A., Chebotar, Y., Hausman, K., Levine, S., and Finn, C.

</span>
<span class="ltx_bibblock">Conservative data sharing for multi-task offline reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:11501–11516, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022)</span>
<span class="ltx_bibblock">
Zhou, D., Zhang, Y., Sonabend-W, A., Wang, Z., Lu, J., and Cai, T.

</span>
<span class="ltx_bibblock">Federated offline reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.05581</em>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>

<div id="Ax1.p1" class="ltx_para ltx_noindent">
<p id="Ax1.p1.1" class="ltx_p">We present several results in the appendix that illustrates the performance of FEDORA. These include an ablation study to characterize the contributions of the different components of FEDORA, as well as experiments that essentially form a sanity check on whether our ensemble learning approach is picking the correct policies. Finally, we describe our real-world experiments using a TurtleBot.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Setup</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.7" class="ltx_p"><span id="A1.p1.7.1" class="ltx_text ltx_font_bold">Algorithm Implementation:</span> We use the PyTorch framework to program the algorithms in this work, based on a publicly-available TD3-BC implementation. The actor and the critic networks have two hidden layers of size <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A1.p1.1.m1.1a"><mn id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><cn type="integer" id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">256</annotation></semantics></math> with ReLu non-linearities. We use a discount factor of <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="0.99" display="inline"><semantics id="A1.p1.2.m2.1a"><mn id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">0.99</mn><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><cn type="float" id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">0.99</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">0.99</annotation></semantics></math>, and the clients update their networks using the Adam optimizer with a learning rate of <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="3\times 10^{-4}" display="inline"><semantics id="A1.p1.3.m3.1a"><mrow id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mn id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.p1.3.m3.1.1.1" xref="A1.p1.3.m3.1.1.1.cmml">×</mo><msup id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml"><mn id="A1.p1.3.m3.1.1.3.2" xref="A1.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="A1.p1.3.m3.1.1.3.3" xref="A1.p1.3.m3.1.1.3.3.cmml"><mo id="A1.p1.3.m3.1.1.3.3a" xref="A1.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="A1.p1.3.m3.1.1.3.3.2" xref="A1.p1.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><times id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1.1"></times><cn type="integer" id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">3</cn><apply id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.3.1.cmml" xref="A1.p1.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="A1.p1.3.m3.1.1.3.2.cmml" xref="A1.p1.3.m3.1.1.3.2">10</cn><apply id="A1.p1.3.m3.1.1.3.3.cmml" xref="A1.p1.3.m3.1.1.3.3"><minus id="A1.p1.3.m3.1.1.3.3.1.cmml" xref="A1.p1.3.m3.1.1.3.3"></minus><cn type="integer" id="A1.p1.3.m3.1.1.3.3.2.cmml" xref="A1.p1.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">3\times 10^{-4}</annotation></semantics></math>. For training FEDORA, we fixed the decay rate <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="\delta=0.995" display="inline"><semantics id="A1.p1.4.m4.1a"><mrow id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">δ</mi><mo id="A1.p1.4.m4.1.1.1" xref="A1.p1.4.m4.1.1.1.cmml">=</mo><mn id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">0.995</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><eq id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1.1"></eq><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝛿</ci><cn type="float" id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">0.995</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">\delta=0.995</annotation></semantics></math> and the temperature <math id="A1.p1.5.m5.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A1.p1.5.m5.1a"><mrow id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">β</mi><mo id="A1.p1.5.m5.1.1.1" xref="A1.p1.5.m5.1.1.1.cmml">=</mo><mn id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><eq id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1.1"></eq><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">𝛽</ci><cn type="float" id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">\beta=0.1</annotation></semantics></math>. TD3-BC trains for <math id="A1.p1.6.m6.1" class="ltx_Math" alttext="5\times 10^{5}" display="inline"><semantics id="A1.p1.6.m6.1a"><mrow id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml"><mn id="A1.p1.6.m6.1.1.2" xref="A1.p1.6.m6.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="A1.p1.6.m6.1.1.1" xref="A1.p1.6.m6.1.1.1.cmml">×</mo><msup id="A1.p1.6.m6.1.1.3" xref="A1.p1.6.m6.1.1.3.cmml"><mn id="A1.p1.6.m6.1.1.3.2" xref="A1.p1.6.m6.1.1.3.2.cmml">10</mn><mn id="A1.p1.6.m6.1.1.3.3" xref="A1.p1.6.m6.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><apply id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"><times id="A1.p1.6.m6.1.1.1.cmml" xref="A1.p1.6.m6.1.1.1"></times><cn type="integer" id="A1.p1.6.m6.1.1.2.cmml" xref="A1.p1.6.m6.1.1.2">5</cn><apply id="A1.p1.6.m6.1.1.3.cmml" xref="A1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.p1.6.m6.1.1.3.1.cmml" xref="A1.p1.6.m6.1.1.3">superscript</csymbol><cn type="integer" id="A1.p1.6.m6.1.1.3.2.cmml" xref="A1.p1.6.m6.1.1.3.2">10</cn><cn type="integer" id="A1.p1.6.m6.1.1.3.3.cmml" xref="A1.p1.6.m6.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">5\times 10^{5}</annotation></semantics></math> time steps in the centralized setup. The batch size is <math id="A1.p1.7.m7.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A1.p1.7.m7.1a"><mn id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><cn type="integer" id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">256</annotation></semantics></math> in both federated and centralized training.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p"><span id="A1.p2.1.1" class="ltx_text ltx_font_bold">Federation Structure:</span> FEDORA and the other federated baselines used in our experiments are implemented using the Flower library. To implement FEDORA, we modify the FedAvg strategy to include priority weighting at the server.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.1" class="ltx_p">Training federated learning algorithms require the clients and server to be online and engage in training simultaneously, therefore demanding multiple CPU nodes and significant GPU memory. We also implement a federation simulation to enable the simulation of federated offline RL algorithms on a single computer setup. This single-threaded program computes gradient updates of each participating client sequentially. Though all the clients reside in the same memory, the server only has access to their updated models, not the data itself.</p>
</div>
<div id="A1.p4" class="ltx_para ltx_noindent">
<p id="A1.p4.1" class="ltx_p">The training data for clients are composed of trajectories sampled from the D4RL dataset. In situations where only a fraction of the clients partake in a round of federation, we uniformly sample the desired number of clients from the entire set.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experiments</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Importance of Individual Algorithm Component</h3>

<figure id="A2.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2305.03097/assets/x8.png" id="A2.F7.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="296" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F7.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A2.F7.sf1.3.2" class="ltx_text" style="font-size:90%;">Effect of sequentially adding 
<br class="ltx_break">one algorithm component at a time</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2305.03097/assets/x9.png" id="A2.F7.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="462" height="396" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F7.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A2.F7.sf2.3.2" class="ltx_text" style="font-size:90%;">Effect of removing one individual algorithm components from FEDORA</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A2.F7.3.2" class="ltx_text" style="font-size:90%;">Ablation Studies.</span></figcaption>
</figure>
<div id="A2.SS1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.p1.2" class="ltx_p">We perform an ablation study to examine the different components of our algorithm and understand their relative impacts on the performance of the federated policy.
We use the experimental framework with <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><mn id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><cn type="integer" id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">10</annotation></semantics></math> clients and the Hopper environment described in Section <a href="#S4" title="4 Federated Offline Reinforcement Learning ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and plot the performance of the federated policy with mean and standard deviation over <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mn id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><cn type="integer" id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">4</annotation></semantics></math> seeds.
The ablation is performed in two ways: (a) We build up FEDORA starting with Fed-A, the naïve method which federates only the actor, and add one new algorithm component at a time and evaluate its performance. (b) We exclude one component of FEDORA at a time and evaluate the resulting algorithm.</p>
</div>
<div id="A2.SS1.p2" class="ltx_para ltx_noindent">
<p id="A2.SS1.p2.1" class="ltx_p">We observe in Fig. <a href="#A2.F7.sf1" title="In Figure 7 ‣ B.1 Importance of Individual Algorithm Component ‣ Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7(a)</span></a> that using priority-weighted averaging of the client’s policy to compute the federated policy (Eq. (<a href="#S5.E7" title="In 5.1 Ensemble-Directed Learning over Client Policies ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) - (<a href="#S5.E8" title="In 5.1 Ensemble-Directed Learning over Client Policies ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)), and an optimistic critic (Eq. (<a href="#S5.E9" title="In 5.2 Federated Optimism for Critic Training ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) - (<a href="#S5.E10" title="In 5.2 Federated Optimism for Critic Training ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>)) significantly improves the performance of the federated policy. This is consistent with our intuition that the most important aspect is extracting the collective wisdom of the policies and critics available for federation, and ensuring that the critic sets optimistic targets.
The proximal term helps regularize local policy updates (Eq. (<a href="#S5.E13" title="In 5.3 Proximal Policy Update for Heterogeneous Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>)) by choosing actions close to those seen in the local dataset or by the federated policy.
Additionally, decaying the influence of local updates enables the local policy to leverage the federated policy’s vantage by choosing actions not seen in the local dataset.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para ltx_noindent">
<p id="A2.SS1.p3.1" class="ltx_p">From Fig. <a href="#A2.F7.sf2" title="In Figure 7 ‣ B.1 Importance of Individual Algorithm Component ‣ Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7(b)</span></a>, we observe that removing priority-weighted actor from FEDORA causes the steepest drop in performance, followed by the optimistic critic. Again, this is consistent with our intuition on these being the most important effects.
Excluding the proximal term and local decay also results in a reduction in server performance along with a greater standard deviation.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Analysis of Client Performance</h3>

<figure id="A2.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A2.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2305.03097/assets/x10.png" id="A2.F8.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="118" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F8.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A2.F8.sf1.3.2" class="ltx_text" style="font-size:90%;">Client ratio</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A2.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2305.03097/assets/x11.png" id="A2.F8.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="120" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F8.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A2.F8.sf2.3.2" class="ltx_text" style="font-size:90%;">Client decay</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="A2.F8.3.2" class="ltx_text" style="font-size:90%;">Analysis of client performance during federation. The average of the performance metric is computed across expert and medium clients participating in a given round of federation.</span></figcaption>
</figure>
<div id="A2.SS2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.p1.2" class="ltx_p">We train FEDORA on MuJoCo environments using a setup similar to Section <a href="#S6" title="6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> where <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mn id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><cn type="integer" id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">20</annotation></semantics></math> out of the <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mn id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><cn type="integer" id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">50</annotation></semantics></math> clients are randomly chosen to participate in each round of federation. Our goal is to analyze the contribution of clients with expert data and those with medium data to the learning process. As before, the clients and the algorithm are unaware of the data quality.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para ltx_noindent">
<p id="A2.SS2.p2.3" class="ltx_p">We plot the mean weights <math id="A2.SS2.p2.1.m1.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="A2.SS2.p2.1.m1.1a"><msubsup id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml"><mi id="A2.SS2.p2.1.m1.1.1.2.2" xref="A2.SS2.p2.1.m1.1.1.2.2.cmml">w</mi><mi id="A2.SS2.p2.1.m1.1.1.2.3" xref="A2.SS2.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="A2.SS2.p2.1.m1.1.1.3" xref="A2.SS2.p2.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.1b"><apply id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p2.1.m1.1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1">superscript</csymbol><apply id="A2.SS2.p2.1.m1.1.1.2.cmml" xref="A2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p2.1.m1.1.1.2.1.cmml" xref="A2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p2.1.m1.1.1.2.2.cmml" xref="A2.SS2.p2.1.m1.1.1.2.2">𝑤</ci><ci id="A2.SS2.p2.1.m1.1.1.2.3.cmml" xref="A2.SS2.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="A2.SS2.p2.1.m1.1.1.3.cmml" xref="A2.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">w_{i}^{t}</annotation></semantics></math> across the expert and medium dataset clients participating in a given round of federation in Fig. <a href="#A2.F8.sf1" title="In Figure 8 ‣ B.2 Analysis of Client Performance ‣ Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8(a)</span></a>. We observe that the weights of medium clients drop to <math id="A2.SS2.p2.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A2.SS2.p2.2.m2.1a"><mn id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.1b"><cn type="integer" id="A2.SS2.p2.2.m2.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1">0</cn></annotation-xml></semantics></math>, while the weights of expert clients rise to <math id="A2.SS2.p2.3.m3.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A2.SS2.p2.3.m3.1a"><mn id="A2.SS2.p2.3.m3.1.1" xref="A2.SS2.p2.3.m3.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.3.m3.1b"><cn type="float" id="A2.SS2.p2.3.m3.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.3.m3.1c">0.1</annotation></semantics></math>. This finding emphasizes the fact that clients are combined based on their relative merits.</p>
</div>
<div id="A2.SS2.p3" class="ltx_para ltx_noindent">
<p id="A2.SS2.p3.4" class="ltx_p">In Fig. <a href="#A2.F8.sf2" title="In Figure 8 ‣ B.2 Analysis of Client Performance ‣ Appendix B Additional Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8(b)</span></a>, we plot the mean of the decay value associated with <math id="A2.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{local}}" display="inline"><semantics id="A2.SS2.p3.1.m1.1a"><msub id="A2.SS2.p3.1.m1.1.1" xref="A2.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS2.p3.1.m1.1.1.2" xref="A2.SS2.p3.1.m1.1.1.2.cmml">ℒ</mi><mtext id="A2.SS2.p3.1.m1.1.1.3" xref="A2.SS2.p3.1.m1.1.1.3a.cmml">local</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.1.m1.1b"><apply id="A2.SS2.p3.1.m1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.1.m1.1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p3.1.m1.1.1.2.cmml" xref="A2.SS2.p3.1.m1.1.1.2">ℒ</ci><ci id="A2.SS2.p3.1.m1.1.1.3a.cmml" xref="A2.SS2.p3.1.m1.1.1.3"><mtext mathsize="70%" id="A2.SS2.p3.1.m1.1.1.3.cmml" xref="A2.SS2.p3.1.m1.1.1.3">local</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">\mathcal{L}_{\text{local}}</annotation></semantics></math> across participating expert and medium dataset clients (Section <a href="#S5.SS4" title="5.4 Decaying the Influence of Local Data ‣ 5 FEDORA Design Approach ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>). The decay of both sets of clients drops as training progresses. A reduction in decay occurs each time the local estimate of the federated policy’s performance <math id="A2.SS2.p3.2.m2.2" class="ltx_Math" alttext="J_{i}^{\text{fed},t}" display="inline"><semantics id="A2.SS2.p3.2.m2.2a"><msubsup id="A2.SS2.p3.2.m2.2.3" xref="A2.SS2.p3.2.m2.2.3.cmml"><mi id="A2.SS2.p3.2.m2.2.3.2.2" xref="A2.SS2.p3.2.m2.2.3.2.2.cmml">J</mi><mi id="A2.SS2.p3.2.m2.2.3.2.3" xref="A2.SS2.p3.2.m2.2.3.2.3.cmml">i</mi><mrow id="A2.SS2.p3.2.m2.2.2.2.4" xref="A2.SS2.p3.2.m2.2.2.2.3.cmml"><mtext id="A2.SS2.p3.2.m2.1.1.1.1" xref="A2.SS2.p3.2.m2.1.1.1.1a.cmml">fed</mtext><mo id="A2.SS2.p3.2.m2.2.2.2.4.1" xref="A2.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="A2.SS2.p3.2.m2.2.2.2.2" xref="A2.SS2.p3.2.m2.2.2.2.2.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.2.m2.2b"><apply id="A2.SS2.p3.2.m2.2.3.cmml" xref="A2.SS2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="A2.SS2.p3.2.m2.2.3.1.cmml" xref="A2.SS2.p3.2.m2.2.3">superscript</csymbol><apply id="A2.SS2.p3.2.m2.2.3.2.cmml" xref="A2.SS2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="A2.SS2.p3.2.m2.2.3.2.1.cmml" xref="A2.SS2.p3.2.m2.2.3">subscript</csymbol><ci id="A2.SS2.p3.2.m2.2.3.2.2.cmml" xref="A2.SS2.p3.2.m2.2.3.2.2">𝐽</ci><ci id="A2.SS2.p3.2.m2.2.3.2.3.cmml" xref="A2.SS2.p3.2.m2.2.3.2.3">𝑖</ci></apply><list id="A2.SS2.p3.2.m2.2.2.2.3.cmml" xref="A2.SS2.p3.2.m2.2.2.2.4"><ci id="A2.SS2.p3.2.m2.1.1.1.1a.cmml" xref="A2.SS2.p3.2.m2.1.1.1.1"><mtext mathsize="70%" id="A2.SS2.p3.2.m2.1.1.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1.1.1">fed</mtext></ci><ci id="A2.SS2.p3.2.m2.2.2.2.2.cmml" xref="A2.SS2.p3.2.m2.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.2.m2.2c">J_{i}^{\text{fed},t}</annotation></semantics></math> is greater than the estimated performance of the updated local policy <math id="A2.SS2.p3.3.m3.1" class="ltx_Math" alttext="J_{i}^{t}" display="inline"><semantics id="A2.SS2.p3.3.m3.1a"><msubsup id="A2.SS2.p3.3.m3.1.1" xref="A2.SS2.p3.3.m3.1.1.cmml"><mi id="A2.SS2.p3.3.m3.1.1.2.2" xref="A2.SS2.p3.3.m3.1.1.2.2.cmml">J</mi><mi id="A2.SS2.p3.3.m3.1.1.2.3" xref="A2.SS2.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="A2.SS2.p3.3.m3.1.1.3" xref="A2.SS2.p3.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.3.m3.1b"><apply id="A2.SS2.p3.3.m3.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.3.m3.1.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1">superscript</csymbol><apply id="A2.SS2.p3.3.m3.1.1.2.cmml" xref="A2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.3.m3.1.1.2.1.cmml" xref="A2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="A2.SS2.p3.3.m3.1.1.2.2.cmml" xref="A2.SS2.p3.3.m3.1.1.2.2">𝐽</ci><ci id="A2.SS2.p3.3.m3.1.1.2.3.cmml" xref="A2.SS2.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="A2.SS2.p3.3.m3.1.1.3.cmml" xref="A2.SS2.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.3.m3.1c">J_{i}^{t}</annotation></semantics></math>. A decreasing decay implies that the federated policy offers a performance improvement over local policies more often as the rounds <math id="A2.SS2.p3.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A2.SS2.p3.4.m4.1a"><mi id="A2.SS2.p3.4.m4.1.1" xref="A2.SS2.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.4.m4.1b"><ci id="A2.SS2.p3.4.m4.1.1.cmml" xref="A2.SS2.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.4.m4.1c">t</annotation></semantics></math> advance. Thus, training only on local data is detrimental, and participation in federation can help learn a superior policy.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Federated Offline RL experiments with CityLearn</h2>

<figure id="A3.F9" class="ltx_figure ltx_align_floatright"><img src="/html/2305.03097/assets/x12.png" id="A3.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="321" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="A3.F9.3.2" class="ltx_text" style="font-size:90%;">Evaluation of algorithms on CityLearn.</span></figcaption>
</figure>
<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p">CityLearn is an OpenAI Gym environment with the goal of urban-scale energy management and demand response, modeled on data from residential buildings. The goal is to reshape the aggregate energy demand curve by regulating chilled water tanks and domestic hot water, two modes of thermal energy storage in each building. The energy demand of residential buildings changes as communities evolve and the weather varies. Hence, the controller must update its policy periodically to perform efficient energy management. Federated learning would allow utilities that serve communities in close proximity to train a policy collaboratively while preserving user data privacy, motivating the use of FEDORA for this environment.</p>
</div>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.7" class="ltx_p">In our experiments, we have <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A3.p2.1.m1.1a"><mn id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><cn type="integer" id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">10</annotation></semantics></math> clients with <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="5000" display="inline"><semantics id="A3.p2.2.m2.1a"><mn id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml">5000</mn><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><cn type="integer" id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1">5000</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">5000</annotation></semantics></math> training examples such that they all participate in <math id="A3.p2.3.m3.1" class="ltx_Math" alttext="150" display="inline"><semantics id="A3.p2.3.m3.1a"><mn id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><cn type="integer" id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">150</annotation></semantics></math> rounds of federation. The training data for the clients is obtained from NeoRL, an offline RL benchmark <cite class="ltx_cite ltx_citemacro_cite">Qin et al. (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. <math id="A3.p2.4.m4.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A3.p2.4.m4.1a"><mn id="A3.p2.4.m4.1.1" xref="A3.p2.4.m4.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.1b"><cn type="integer" id="A3.p2.4.m4.1.1.cmml" xref="A3.p2.4.m4.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.1c">5</annotation></semantics></math> clients each have data from the CityLearn High and CityLearn Low datasets, which are collected by a SAC policy trained to <math id="A3.p2.5.m5.1" class="ltx_Math" alttext="75\%" display="inline"><semantics id="A3.p2.5.m5.1a"><mrow id="A3.p2.5.m5.1.1" xref="A3.p2.5.m5.1.1.cmml"><mn id="A3.p2.5.m5.1.1.2" xref="A3.p2.5.m5.1.1.2.cmml">75</mn><mo id="A3.p2.5.m5.1.1.1" xref="A3.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.5.m5.1b"><apply id="A3.p2.5.m5.1.1.cmml" xref="A3.p2.5.m5.1.1"><csymbol cd="latexml" id="A3.p2.5.m5.1.1.1.cmml" xref="A3.p2.5.m5.1.1.1">percent</csymbol><cn type="integer" id="A3.p2.5.m5.1.1.2.cmml" xref="A3.p2.5.m5.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m5.1c">75\%</annotation></semantics></math> and <math id="A3.p2.6.m6.1" class="ltx_Math" alttext="25\%" display="inline"><semantics id="A3.p2.6.m6.1a"><mrow id="A3.p2.6.m6.1.1" xref="A3.p2.6.m6.1.1.cmml"><mn id="A3.p2.6.m6.1.1.2" xref="A3.p2.6.m6.1.1.2.cmml">25</mn><mo id="A3.p2.6.m6.1.1.1" xref="A3.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.6.m6.1b"><apply id="A3.p2.6.m6.1.1.cmml" xref="A3.p2.6.m6.1.1"><csymbol cd="latexml" id="A3.p2.6.m6.1.1.1.cmml" xref="A3.p2.6.m6.1.1.1">percent</csymbol><cn type="integer" id="A3.p2.6.m6.1.1.2.cmml" xref="A3.p2.6.m6.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.6.m6.1c">25\%</annotation></semantics></math> of the best performance level, respectively. During each round of federation, each client performs <math id="A3.p2.7.m7.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A3.p2.7.m7.1a"><mn id="A3.p2.7.m7.1.1" xref="A3.p2.7.m7.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A3.p2.7.m7.1b"><cn type="integer" id="A3.p2.7.m7.1.1.cmml" xref="A3.p2.7.m7.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.7.m7.1c">20</annotation></semantics></math> local epochs of training. The server reward at the end of each federation round is evaluated online and shown in Fig. <a href="#A3.F9" title="Figure 9 ‣ Appendix C Federated Offline RL experiments with CityLearn ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. We observe that FEDORA is able to perform well in the CityLearn large-scale stochastic environment.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Details of Real-World Robot Experiments</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Demonstration Data Collection</h3>

<div id="A4.SS1.p1" class="ltx_para ltx_noindent">
<p id="A4.SS1.p1.1" class="ltx_p">We train four behavior policies of varying levels of expertise using TRPO <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a href="#bib.bib26" title="" class="ltx_ref">2015</a>)</cite> on a custom simulator for mobile robots described in section <a href="#A4.SS2" title="D.2 Simulator Design ‣ Appendix D Details of Real-World Robot Experiments ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D.2</span></a>. The first policy is capable of waypoint navigation but collides with obstacles. The second policy can reach waypoints while avoiding obstacles present at one fixed position. The third policy has not fully generalized to avoiding obstacles at various positions. Finally, the fourth policy can navigate to the goal without any collision. We execute the behavior policies in the simulator to gather demonstration data, which we then use to train FEDORA and other baselines. After training, we test the learned policies in the real world on a TurtleBot to ascertain its feasibility. The nature of the behavior policies and the learned polciies can be seen in Fig. <a href="#S6.F6" title="Figure 6 ‣ 6.7 Real-World Experiments ‣ 6 Experimental Evaluation ‣ Federated Ensemble-Directed Offline Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Simulator Design</h3>

<div id="A4.SS2.p1" class="ltx_para ltx_noindent">
<p id="A4.SS2.p1.1" class="ltx_p">We develop a first-order simulator for mobile robots using the OpenAI Gym framework, which enables the training of RL algorithms. The robot’s pose is represented by its X- and Y-coordinates in a 2D space and its orientation with respect to the X-axis, <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><mi id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><ci id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">\theta</annotation></semantics></math>. The pose is updated using differential drive kinematics</p>
<table id="A4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A4.E15.m1.1" class="ltx_Math" alttext="\begin{array}[]{ccl}x_{t+1}&amp;=&amp;x_{t}+\Delta t\;v\cos{\theta_{t}}\\
y_{t+1}&amp;=&amp;y_{t}+\Delta t\;v\sin{\theta_{t}}\\
\theta_{t+1}&amp;=&amp;\theta_{t}+\Delta t\;\omega,\end{array}" display="block"><semantics id="A4.E15.m1.1a"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="A4.E15.m1.1.1" xref="A4.E15.m1.1.1.cmml"><mtr id="A4.E15.m1.1.1a" xref="A4.E15.m1.1.1.cmml"><mtd id="A4.E15.m1.1.1b" xref="A4.E15.m1.1.1.cmml"><msub id="A4.E15.m1.1.1.2.1.1" xref="A4.E15.m1.1.1.2.1.1.cmml"><mi id="A4.E15.m1.1.1.2.1.1.2" xref="A4.E15.m1.1.1.2.1.1.2.cmml">x</mi><mrow id="A4.E15.m1.1.1.2.1.1.3" xref="A4.E15.m1.1.1.2.1.1.3.cmml"><mi id="A4.E15.m1.1.1.2.1.1.3.2" xref="A4.E15.m1.1.1.2.1.1.3.2.cmml">t</mi><mo id="A4.E15.m1.1.1.2.1.1.3.1" xref="A4.E15.m1.1.1.2.1.1.3.1.cmml">+</mo><mn id="A4.E15.m1.1.1.2.1.1.3.3" xref="A4.E15.m1.1.1.2.1.1.3.3.cmml">1</mn></mrow></msub></mtd><mtd id="A4.E15.m1.1.1c" xref="A4.E15.m1.1.1.cmml"><mo id="A4.E15.m1.1.1.2.2.1" xref="A4.E15.m1.1.1.2.2.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E15.m1.1.1d" xref="A4.E15.m1.1.1.cmml"><mrow id="A4.E15.m1.1.1.2.3.1" xref="A4.E15.m1.1.1.2.3.1.cmml"><msub id="A4.E15.m1.1.1.2.3.1.2" xref="A4.E15.m1.1.1.2.3.1.2.cmml"><mi id="A4.E15.m1.1.1.2.3.1.2.2" xref="A4.E15.m1.1.1.2.3.1.2.2.cmml">x</mi><mi id="A4.E15.m1.1.1.2.3.1.2.3" xref="A4.E15.m1.1.1.2.3.1.2.3.cmml">t</mi></msub><mo id="A4.E15.m1.1.1.2.3.1.1" xref="A4.E15.m1.1.1.2.3.1.1.cmml">+</mo><mrow id="A4.E15.m1.1.1.2.3.1.3" xref="A4.E15.m1.1.1.2.3.1.3.cmml"><mi mathvariant="normal" id="A4.E15.m1.1.1.2.3.1.3.2" xref="A4.E15.m1.1.1.2.3.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.2.3.1.3.1" xref="A4.E15.m1.1.1.2.3.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.2.3.1.3.3" xref="A4.E15.m1.1.1.2.3.1.3.3.cmml">t</mi><mo lspace="0.280em" rspace="0em" id="A4.E15.m1.1.1.2.3.1.3.1a" xref="A4.E15.m1.1.1.2.3.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.2.3.1.3.4" xref="A4.E15.m1.1.1.2.3.1.3.4.cmml">v</mi><mo lspace="0.167em" rspace="0em" id="A4.E15.m1.1.1.2.3.1.3.1b" xref="A4.E15.m1.1.1.2.3.1.3.1.cmml">​</mo><mrow id="A4.E15.m1.1.1.2.3.1.3.5" xref="A4.E15.m1.1.1.2.3.1.3.5.cmml"><mi id="A4.E15.m1.1.1.2.3.1.3.5.1" xref="A4.E15.m1.1.1.2.3.1.3.5.1.cmml">cos</mi><mo lspace="0.167em" id="A4.E15.m1.1.1.2.3.1.3.5a" xref="A4.E15.m1.1.1.2.3.1.3.5.cmml">⁡</mo><msub id="A4.E15.m1.1.1.2.3.1.3.5.2" xref="A4.E15.m1.1.1.2.3.1.3.5.2.cmml"><mi id="A4.E15.m1.1.1.2.3.1.3.5.2.2" xref="A4.E15.m1.1.1.2.3.1.3.5.2.2.cmml">θ</mi><mi id="A4.E15.m1.1.1.2.3.1.3.5.2.3" xref="A4.E15.m1.1.1.2.3.1.3.5.2.3.cmml">t</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="A4.E15.m1.1.1e" xref="A4.E15.m1.1.1.cmml"><mtd id="A4.E15.m1.1.1f" xref="A4.E15.m1.1.1.cmml"><msub id="A4.E15.m1.1.1.3.1.1" xref="A4.E15.m1.1.1.3.1.1.cmml"><mi id="A4.E15.m1.1.1.3.1.1.2" xref="A4.E15.m1.1.1.3.1.1.2.cmml">y</mi><mrow id="A4.E15.m1.1.1.3.1.1.3" xref="A4.E15.m1.1.1.3.1.1.3.cmml"><mi id="A4.E15.m1.1.1.3.1.1.3.2" xref="A4.E15.m1.1.1.3.1.1.3.2.cmml">t</mi><mo id="A4.E15.m1.1.1.3.1.1.3.1" xref="A4.E15.m1.1.1.3.1.1.3.1.cmml">+</mo><mn id="A4.E15.m1.1.1.3.1.1.3.3" xref="A4.E15.m1.1.1.3.1.1.3.3.cmml">1</mn></mrow></msub></mtd><mtd id="A4.E15.m1.1.1g" xref="A4.E15.m1.1.1.cmml"><mo id="A4.E15.m1.1.1.3.2.1" xref="A4.E15.m1.1.1.3.2.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E15.m1.1.1h" xref="A4.E15.m1.1.1.cmml"><mrow id="A4.E15.m1.1.1.3.3.1" xref="A4.E15.m1.1.1.3.3.1.cmml"><msub id="A4.E15.m1.1.1.3.3.1.2" xref="A4.E15.m1.1.1.3.3.1.2.cmml"><mi id="A4.E15.m1.1.1.3.3.1.2.2" xref="A4.E15.m1.1.1.3.3.1.2.2.cmml">y</mi><mi id="A4.E15.m1.1.1.3.3.1.2.3" xref="A4.E15.m1.1.1.3.3.1.2.3.cmml">t</mi></msub><mo id="A4.E15.m1.1.1.3.3.1.1" xref="A4.E15.m1.1.1.3.3.1.1.cmml">+</mo><mrow id="A4.E15.m1.1.1.3.3.1.3" xref="A4.E15.m1.1.1.3.3.1.3.cmml"><mi mathvariant="normal" id="A4.E15.m1.1.1.3.3.1.3.2" xref="A4.E15.m1.1.1.3.3.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.3.3.1.3.1" xref="A4.E15.m1.1.1.3.3.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.3.1.3.3" xref="A4.E15.m1.1.1.3.3.1.3.3.cmml">t</mi><mo lspace="0.280em" rspace="0em" id="A4.E15.m1.1.1.3.3.1.3.1a" xref="A4.E15.m1.1.1.3.3.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.3.3.1.3.4" xref="A4.E15.m1.1.1.3.3.1.3.4.cmml">v</mi><mo lspace="0.167em" rspace="0em" id="A4.E15.m1.1.1.3.3.1.3.1b" xref="A4.E15.m1.1.1.3.3.1.3.1.cmml">​</mo><mrow id="A4.E15.m1.1.1.3.3.1.3.5" xref="A4.E15.m1.1.1.3.3.1.3.5.cmml"><mi id="A4.E15.m1.1.1.3.3.1.3.5.1" xref="A4.E15.m1.1.1.3.3.1.3.5.1.cmml">sin</mi><mo lspace="0.167em" id="A4.E15.m1.1.1.3.3.1.3.5a" xref="A4.E15.m1.1.1.3.3.1.3.5.cmml">⁡</mo><msub id="A4.E15.m1.1.1.3.3.1.3.5.2" xref="A4.E15.m1.1.1.3.3.1.3.5.2.cmml"><mi id="A4.E15.m1.1.1.3.3.1.3.5.2.2" xref="A4.E15.m1.1.1.3.3.1.3.5.2.2.cmml">θ</mi><mi id="A4.E15.m1.1.1.3.3.1.3.5.2.3" xref="A4.E15.m1.1.1.3.3.1.3.5.2.3.cmml">t</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="A4.E15.m1.1.1i" xref="A4.E15.m1.1.1.cmml"><mtd id="A4.E15.m1.1.1j" xref="A4.E15.m1.1.1.cmml"><msub id="A4.E15.m1.1.1.1.2.1" xref="A4.E15.m1.1.1.1.2.1.cmml"><mi id="A4.E15.m1.1.1.1.2.1.2" xref="A4.E15.m1.1.1.1.2.1.2.cmml">θ</mi><mrow id="A4.E15.m1.1.1.1.2.1.3" xref="A4.E15.m1.1.1.1.2.1.3.cmml"><mi id="A4.E15.m1.1.1.1.2.1.3.2" xref="A4.E15.m1.1.1.1.2.1.3.2.cmml">t</mi><mo id="A4.E15.m1.1.1.1.2.1.3.1" xref="A4.E15.m1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A4.E15.m1.1.1.1.2.1.3.3" xref="A4.E15.m1.1.1.1.2.1.3.3.cmml">1</mn></mrow></msub></mtd><mtd id="A4.E15.m1.1.1k" xref="A4.E15.m1.1.1.cmml"><mo id="A4.E15.m1.1.1.1.3.1" xref="A4.E15.m1.1.1.1.3.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E15.m1.1.1l" xref="A4.E15.m1.1.1.cmml"><mrow id="A4.E15.m1.1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.1.cmml"><mrow id="A4.E15.m1.1.1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.1.cmml"><msub id="A4.E15.m1.1.1.1.1.1.1.1.2" xref="A4.E15.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.E15.m1.1.1.1.1.1.1.1.2.2" xref="A4.E15.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="A4.E15.m1.1.1.1.1.1.1.1.2.3" xref="A4.E15.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.E15.m1.1.1.1.1.1.1.1.1" xref="A4.E15.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A4.E15.m1.1.1.1.1.1.1.1.3" xref="A4.E15.m1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A4.E15.m1.1.1.1.1.1.1.1.3.2" xref="A4.E15.m1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A4.E15.m1.1.1.1.1.1.1.1.3.1" xref="A4.E15.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.1.1.1.1.1.3.3" xref="A4.E15.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi><mo lspace="0.280em" rspace="0em" id="A4.E15.m1.1.1.1.1.1.1.1.3.1a" xref="A4.E15.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A4.E15.m1.1.1.1.1.1.1.1.3.4" xref="A4.E15.m1.1.1.1.1.1.1.1.3.4.cmml">ω</mi></mrow></mrow><mo id="A4.E15.m1.1.1.1.1.1.1.2" xref="A4.E15.m1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A4.E15.m1.1b"><matrix id="A4.E15.m1.1.1.cmml" xref="A4.E15.m1.1.1"><matrixrow id="A4.E15.m1.1.1a.cmml" xref="A4.E15.m1.1.1"><apply id="A4.E15.m1.1.1.2.1.1.cmml" xref="A4.E15.m1.1.1.2.1.1"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.2.1.1.1.cmml" xref="A4.E15.m1.1.1.2.1.1">subscript</csymbol><ci id="A4.E15.m1.1.1.2.1.1.2.cmml" xref="A4.E15.m1.1.1.2.1.1.2">𝑥</ci><apply id="A4.E15.m1.1.1.2.1.1.3.cmml" xref="A4.E15.m1.1.1.2.1.1.3"><plus id="A4.E15.m1.1.1.2.1.1.3.1.cmml" xref="A4.E15.m1.1.1.2.1.1.3.1"></plus><ci id="A4.E15.m1.1.1.2.1.1.3.2.cmml" xref="A4.E15.m1.1.1.2.1.1.3.2">𝑡</ci><cn type="integer" id="A4.E15.m1.1.1.2.1.1.3.3.cmml" xref="A4.E15.m1.1.1.2.1.1.3.3">1</cn></apply></apply><eq id="A4.E15.m1.1.1.2.2.1.cmml" xref="A4.E15.m1.1.1.2.2.1"></eq><apply id="A4.E15.m1.1.1.2.3.1.cmml" xref="A4.E15.m1.1.1.2.3.1"><plus id="A4.E15.m1.1.1.2.3.1.1.cmml" xref="A4.E15.m1.1.1.2.3.1.1"></plus><apply id="A4.E15.m1.1.1.2.3.1.2.cmml" xref="A4.E15.m1.1.1.2.3.1.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.2.3.1.2.1.cmml" xref="A4.E15.m1.1.1.2.3.1.2">subscript</csymbol><ci id="A4.E15.m1.1.1.2.3.1.2.2.cmml" xref="A4.E15.m1.1.1.2.3.1.2.2">𝑥</ci><ci id="A4.E15.m1.1.1.2.3.1.2.3.cmml" xref="A4.E15.m1.1.1.2.3.1.2.3">𝑡</ci></apply><apply id="A4.E15.m1.1.1.2.3.1.3.cmml" xref="A4.E15.m1.1.1.2.3.1.3"><times id="A4.E15.m1.1.1.2.3.1.3.1.cmml" xref="A4.E15.m1.1.1.2.3.1.3.1"></times><ci id="A4.E15.m1.1.1.2.3.1.3.2.cmml" xref="A4.E15.m1.1.1.2.3.1.3.2">Δ</ci><ci id="A4.E15.m1.1.1.2.3.1.3.3.cmml" xref="A4.E15.m1.1.1.2.3.1.3.3">𝑡</ci><ci id="A4.E15.m1.1.1.2.3.1.3.4.cmml" xref="A4.E15.m1.1.1.2.3.1.3.4">𝑣</ci><apply id="A4.E15.m1.1.1.2.3.1.3.5.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5"><cos id="A4.E15.m1.1.1.2.3.1.3.5.1.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5.1"></cos><apply id="A4.E15.m1.1.1.2.3.1.3.5.2.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.2.3.1.3.5.2.1.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5.2">subscript</csymbol><ci id="A4.E15.m1.1.1.2.3.1.3.5.2.2.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5.2.2">𝜃</ci><ci id="A4.E15.m1.1.1.2.3.1.3.5.2.3.cmml" xref="A4.E15.m1.1.1.2.3.1.3.5.2.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A4.E15.m1.1.1b.cmml" xref="A4.E15.m1.1.1"><apply id="A4.E15.m1.1.1.3.1.1.cmml" xref="A4.E15.m1.1.1.3.1.1"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.3.1.1.1.cmml" xref="A4.E15.m1.1.1.3.1.1">subscript</csymbol><ci id="A4.E15.m1.1.1.3.1.1.2.cmml" xref="A4.E15.m1.1.1.3.1.1.2">𝑦</ci><apply id="A4.E15.m1.1.1.3.1.1.3.cmml" xref="A4.E15.m1.1.1.3.1.1.3"><plus id="A4.E15.m1.1.1.3.1.1.3.1.cmml" xref="A4.E15.m1.1.1.3.1.1.3.1"></plus><ci id="A4.E15.m1.1.1.3.1.1.3.2.cmml" xref="A4.E15.m1.1.1.3.1.1.3.2">𝑡</ci><cn type="integer" id="A4.E15.m1.1.1.3.1.1.3.3.cmml" xref="A4.E15.m1.1.1.3.1.1.3.3">1</cn></apply></apply><eq id="A4.E15.m1.1.1.3.2.1.cmml" xref="A4.E15.m1.1.1.3.2.1"></eq><apply id="A4.E15.m1.1.1.3.3.1.cmml" xref="A4.E15.m1.1.1.3.3.1"><plus id="A4.E15.m1.1.1.3.3.1.1.cmml" xref="A4.E15.m1.1.1.3.3.1.1"></plus><apply id="A4.E15.m1.1.1.3.3.1.2.cmml" xref="A4.E15.m1.1.1.3.3.1.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.3.3.1.2.1.cmml" xref="A4.E15.m1.1.1.3.3.1.2">subscript</csymbol><ci id="A4.E15.m1.1.1.3.3.1.2.2.cmml" xref="A4.E15.m1.1.1.3.3.1.2.2">𝑦</ci><ci id="A4.E15.m1.1.1.3.3.1.2.3.cmml" xref="A4.E15.m1.1.1.3.3.1.2.3">𝑡</ci></apply><apply id="A4.E15.m1.1.1.3.3.1.3.cmml" xref="A4.E15.m1.1.1.3.3.1.3"><times id="A4.E15.m1.1.1.3.3.1.3.1.cmml" xref="A4.E15.m1.1.1.3.3.1.3.1"></times><ci id="A4.E15.m1.1.1.3.3.1.3.2.cmml" xref="A4.E15.m1.1.1.3.3.1.3.2">Δ</ci><ci id="A4.E15.m1.1.1.3.3.1.3.3.cmml" xref="A4.E15.m1.1.1.3.3.1.3.3">𝑡</ci><ci id="A4.E15.m1.1.1.3.3.1.3.4.cmml" xref="A4.E15.m1.1.1.3.3.1.3.4">𝑣</ci><apply id="A4.E15.m1.1.1.3.3.1.3.5.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5"><sin id="A4.E15.m1.1.1.3.3.1.3.5.1.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5.1"></sin><apply id="A4.E15.m1.1.1.3.3.1.3.5.2.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.3.3.1.3.5.2.1.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5.2">subscript</csymbol><ci id="A4.E15.m1.1.1.3.3.1.3.5.2.2.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5.2.2">𝜃</ci><ci id="A4.E15.m1.1.1.3.3.1.3.5.2.3.cmml" xref="A4.E15.m1.1.1.3.3.1.3.5.2.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A4.E15.m1.1.1c.cmml" xref="A4.E15.m1.1.1"><apply id="A4.E15.m1.1.1.1.2.1.cmml" xref="A4.E15.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.1.2.1.1.cmml" xref="A4.E15.m1.1.1.1.2.1">subscript</csymbol><ci id="A4.E15.m1.1.1.1.2.1.2.cmml" xref="A4.E15.m1.1.1.1.2.1.2">𝜃</ci><apply id="A4.E15.m1.1.1.1.2.1.3.cmml" xref="A4.E15.m1.1.1.1.2.1.3"><plus id="A4.E15.m1.1.1.1.2.1.3.1.cmml" xref="A4.E15.m1.1.1.1.2.1.3.1"></plus><ci id="A4.E15.m1.1.1.1.2.1.3.2.cmml" xref="A4.E15.m1.1.1.1.2.1.3.2">𝑡</ci><cn type="integer" id="A4.E15.m1.1.1.1.2.1.3.3.cmml" xref="A4.E15.m1.1.1.1.2.1.3.3">1</cn></apply></apply><eq id="A4.E15.m1.1.1.1.3.1.cmml" xref="A4.E15.m1.1.1.1.3.1"></eq><apply id="A4.E15.m1.1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1"><plus id="A4.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.1"></plus><apply id="A4.E15.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E15.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E15.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="A4.E15.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.E15.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.3"><times id="A4.E15.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.3.1"></times><ci id="A4.E15.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A4.E15.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.3.3">𝑡</ci><ci id="A4.E15.m1.1.1.1.1.1.1.1.3.4.cmml" xref="A4.E15.m1.1.1.1.1.1.1.1.3.4">𝜔</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="A4.E15.m1.1c">\begin{array}[]{ccl}x_{t+1}&amp;=&amp;x_{t}+\Delta t\;v\cos{\theta_{t}}\\
y_{t+1}&amp;=&amp;y_{t}+\Delta t\;v\sin{\theta_{t}}\\
\theta_{t+1}&amp;=&amp;\theta_{t}+\Delta t\;\omega,\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A4.SS2.p1.6" class="ltx_p">where <math id="A4.SS2.p1.2.m1.3" class="ltx_Math" alttext="(x_{t},y_{t},\theta_{t})" display="inline"><semantics id="A4.SS2.p1.2.m1.3a"><mrow id="A4.SS2.p1.2.m1.3.3.3" xref="A4.SS2.p1.2.m1.3.3.4.cmml"><mo stretchy="false" id="A4.SS2.p1.2.m1.3.3.3.4" xref="A4.SS2.p1.2.m1.3.3.4.cmml">(</mo><msub id="A4.SS2.p1.2.m1.1.1.1.1" xref="A4.SS2.p1.2.m1.1.1.1.1.cmml"><mi id="A4.SS2.p1.2.m1.1.1.1.1.2" xref="A4.SS2.p1.2.m1.1.1.1.1.2.cmml">x</mi><mi id="A4.SS2.p1.2.m1.1.1.1.1.3" xref="A4.SS2.p1.2.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.SS2.p1.2.m1.3.3.3.5" xref="A4.SS2.p1.2.m1.3.3.4.cmml">,</mo><msub id="A4.SS2.p1.2.m1.2.2.2.2" xref="A4.SS2.p1.2.m1.2.2.2.2.cmml"><mi id="A4.SS2.p1.2.m1.2.2.2.2.2" xref="A4.SS2.p1.2.m1.2.2.2.2.2.cmml">y</mi><mi id="A4.SS2.p1.2.m1.2.2.2.2.3" xref="A4.SS2.p1.2.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="A4.SS2.p1.2.m1.3.3.3.6" xref="A4.SS2.p1.2.m1.3.3.4.cmml">,</mo><msub id="A4.SS2.p1.2.m1.3.3.3.3" xref="A4.SS2.p1.2.m1.3.3.3.3.cmml"><mi id="A4.SS2.p1.2.m1.3.3.3.3.2" xref="A4.SS2.p1.2.m1.3.3.3.3.2.cmml">θ</mi><mi id="A4.SS2.p1.2.m1.3.3.3.3.3" xref="A4.SS2.p1.2.m1.3.3.3.3.3.cmml">t</mi></msub><mo stretchy="false" id="A4.SS2.p1.2.m1.3.3.3.7" xref="A4.SS2.p1.2.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m1.3b"><vector id="A4.SS2.p1.2.m1.3.3.4.cmml" xref="A4.SS2.p1.2.m1.3.3.3"><apply id="A4.SS2.p1.2.m1.1.1.1.1.cmml" xref="A4.SS2.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.2.m1.1.1.1.1.1.cmml" xref="A4.SS2.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="A4.SS2.p1.2.m1.1.1.1.1.2.cmml" xref="A4.SS2.p1.2.m1.1.1.1.1.2">𝑥</ci><ci id="A4.SS2.p1.2.m1.1.1.1.1.3.cmml" xref="A4.SS2.p1.2.m1.1.1.1.1.3">𝑡</ci></apply><apply id="A4.SS2.p1.2.m1.2.2.2.2.cmml" xref="A4.SS2.p1.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="A4.SS2.p1.2.m1.2.2.2.2.1.cmml" xref="A4.SS2.p1.2.m1.2.2.2.2">subscript</csymbol><ci id="A4.SS2.p1.2.m1.2.2.2.2.2.cmml" xref="A4.SS2.p1.2.m1.2.2.2.2.2">𝑦</ci><ci id="A4.SS2.p1.2.m1.2.2.2.2.3.cmml" xref="A4.SS2.p1.2.m1.2.2.2.2.3">𝑡</ci></apply><apply id="A4.SS2.p1.2.m1.3.3.3.3.cmml" xref="A4.SS2.p1.2.m1.3.3.3.3"><csymbol cd="ambiguous" id="A4.SS2.p1.2.m1.3.3.3.3.1.cmml" xref="A4.SS2.p1.2.m1.3.3.3.3">subscript</csymbol><ci id="A4.SS2.p1.2.m1.3.3.3.3.2.cmml" xref="A4.SS2.p1.2.m1.3.3.3.3.2">𝜃</ci><ci id="A4.SS2.p1.2.m1.3.3.3.3.3.cmml" xref="A4.SS2.p1.2.m1.3.3.3.3.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m1.3c">(x_{t},y_{t},\theta_{t})</annotation></semantics></math> is the pose at time <math id="A4.SS2.p1.3.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS2.p1.3.m2.1a"><mi id="A4.SS2.p1.3.m2.1.1" xref="A4.SS2.p1.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m2.1b"><ci id="A4.SS2.p1.3.m2.1.1.cmml" xref="A4.SS2.p1.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m2.1c">t</annotation></semantics></math>, <math id="A4.SS2.p1.4.m3.1" class="ltx_Math" alttext="v" display="inline"><semantics id="A4.SS2.p1.4.m3.1a"><mi id="A4.SS2.p1.4.m3.1.1" xref="A4.SS2.p1.4.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m3.1b"><ci id="A4.SS2.p1.4.m3.1.1.cmml" xref="A4.SS2.p1.4.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m3.1c">v</annotation></semantics></math> and <math id="A4.SS2.p1.5.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="A4.SS2.p1.5.m4.1a"><mi id="A4.SS2.p1.5.m4.1.1" xref="A4.SS2.p1.5.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.5.m4.1b"><ci id="A4.SS2.p1.5.m4.1.1.cmml" xref="A4.SS2.p1.5.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.5.m4.1c">w</annotation></semantics></math> are the linear and angular velocity of the robot respectively, and <math id="A4.SS2.p1.6.m5.1" class="ltx_Math" alttext="\Delta t" display="inline"><semantics id="A4.SS2.p1.6.m5.1a"><mrow id="A4.SS2.p1.6.m5.1.1" xref="A4.SS2.p1.6.m5.1.1.cmml"><mi mathvariant="normal" id="A4.SS2.p1.6.m5.1.1.2" xref="A4.SS2.p1.6.m5.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.6.m5.1.1.1" xref="A4.SS2.p1.6.m5.1.1.1.cmml">​</mo><mi id="A4.SS2.p1.6.m5.1.1.3" xref="A4.SS2.p1.6.m5.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.6.m5.1b"><apply id="A4.SS2.p1.6.m5.1.1.cmml" xref="A4.SS2.p1.6.m5.1.1"><times id="A4.SS2.p1.6.m5.1.1.1.cmml" xref="A4.SS2.p1.6.m5.1.1.1"></times><ci id="A4.SS2.p1.6.m5.1.1.2.cmml" xref="A4.SS2.p1.6.m5.1.1.2">Δ</ci><ci id="A4.SS2.p1.6.m5.1.1.3.cmml" xref="A4.SS2.p1.6.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.6.m5.1c">\Delta t</annotation></semantics></math> is time discretization of the system.</p>
</div>
<div id="A4.SS2.p2" class="ltx_para ltx_noindent">
<p id="A4.SS2.p2.1" class="ltx_p">The simulator uses a functional LIDAR to detect the presence of obstacles. We simulate the LIDAR using a discrete representation of the robot and obstacles in its immediate environment. For each scanning direction around the LIDAR, we use Bresenham’s line algorithm to generate a path comprising of discrete points. The simulator determines LIDAR measurements by counting the number of points along each path, starting from the robot and continuing until it encounters and obstacle or reaches the maximum range.</p>
</div>
<div id="A4.SS2.p3" class="ltx_para ltx_noindent">
<p id="A4.SS2.p3.3" class="ltx_p">The reward function is designed to encourage effective waypoint navigation while preventing collisions. We define a boundary grid that extends for <math id="A4.SS2.p3.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A4.SS2.p3.1.m1.1a"><mn id="A4.SS2.p3.1.m1.1.1" xref="A4.SS2.p3.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.1.m1.1b"><cn type="integer" id="A4.SS2.p3.1.m1.1.1.cmml" xref="A4.SS2.p3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.1.m1.1c">1</annotation></semantics></math>m beyond the start and the goal positions in all directions. The reward function at time <math id="A4.SS2.p3.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS2.p3.2.m2.1a"><mi id="A4.SS2.p3.2.m2.1.1" xref="A4.SS2.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.2.m2.1b"><ci id="A4.SS2.p3.2.m2.1.1.cmml" xref="A4.SS2.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.2.m2.1c">t</annotation></semantics></math> for navigating to the goal position <math id="A4.SS2.p3.3.m3.2" class="ltx_Math" alttext="(x_{g},y_{g})" display="inline"><semantics id="A4.SS2.p3.3.m3.2a"><mrow id="A4.SS2.p3.3.m3.2.2.2" xref="A4.SS2.p3.3.m3.2.2.3.cmml"><mo stretchy="false" id="A4.SS2.p3.3.m3.2.2.2.3" xref="A4.SS2.p3.3.m3.2.2.3.cmml">(</mo><msub id="A4.SS2.p3.3.m3.1.1.1.1" xref="A4.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="A4.SS2.p3.3.m3.1.1.1.1.2" xref="A4.SS2.p3.3.m3.1.1.1.1.2.cmml">x</mi><mi id="A4.SS2.p3.3.m3.1.1.1.1.3" xref="A4.SS2.p3.3.m3.1.1.1.1.3.cmml">g</mi></msub><mo id="A4.SS2.p3.3.m3.2.2.2.4" xref="A4.SS2.p3.3.m3.2.2.3.cmml">,</mo><msub id="A4.SS2.p3.3.m3.2.2.2.2" xref="A4.SS2.p3.3.m3.2.2.2.2.cmml"><mi id="A4.SS2.p3.3.m3.2.2.2.2.2" xref="A4.SS2.p3.3.m3.2.2.2.2.2.cmml">y</mi><mi id="A4.SS2.p3.3.m3.2.2.2.2.3" xref="A4.SS2.p3.3.m3.2.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="A4.SS2.p3.3.m3.2.2.2.5" xref="A4.SS2.p3.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.3.m3.2b"><interval closure="open" id="A4.SS2.p3.3.m3.2.2.3.cmml" xref="A4.SS2.p3.3.m3.2.2.2"><apply id="A4.SS2.p3.3.m3.1.1.1.1.cmml" xref="A4.SS2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="A4.SS2.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="A4.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="A4.SS2.p3.3.m3.1.1.1.1.2">𝑥</ci><ci id="A4.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="A4.SS2.p3.3.m3.1.1.1.1.3">𝑔</ci></apply><apply id="A4.SS2.p3.3.m3.2.2.2.2.cmml" xref="A4.SS2.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="A4.SS2.p3.3.m3.2.2.2.2.1.cmml" xref="A4.SS2.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="A4.SS2.p3.3.m3.2.2.2.2.2.cmml" xref="A4.SS2.p3.3.m3.2.2.2.2.2">𝑦</ci><ci id="A4.SS2.p3.3.m3.2.2.2.2.3.cmml" xref="A4.SS2.p3.3.m3.2.2.2.2.3">𝑔</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.3.m3.2c">(x_{g},y_{g})</annotation></semantics></math> is chosen to be</p>
<table id="A4.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E16.m1.8" class="ltx_math_unparsed" alttext="\displaystyle R_{t}=\begin{cases}+100,&amp;\text{if }|x_{t}-x_{g}|\leq thresh\;\mathtt{and}\;|y_{t}-y_{g}|\leq thresh\\
-10,&amp;\text{if robot outside boundary}\\
-100,&amp;\text{if robot collides}\\
-(\mathtt{c.t.e}_{t}^{2}+\mathtt{a.t.e}_{t}+\mathtt{h.e}_{t})+\sum\mathtt{lidar}_{t},&amp;\text{otherwise}\end{cases}" display="inline"><semantics id="A4.E16.m1.8a"><mrow id="A4.E16.m1.8.9"><msub id="A4.E16.m1.8.9.2"><mi id="A4.E16.m1.8.9.2.2">R</mi><mi id="A4.E16.m1.8.9.2.3">t</mi></msub><mo id="A4.E16.m1.8.9.1">=</mo><mrow id="A4.E16.m1.8.8a"><mo id="A4.E16.m1.8.8a.9">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="A4.E16.m1.8.8.8a"><mtr id="A4.E16.m1.8.8.8aa"><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ab"><mrow id="A4.E16.m1.1.1.1.1.1.1.1"><mrow id="A4.E16.m1.1.1.1.1.1.1.1.1"><mo id="A4.E16.m1.1.1.1.1.1.1.1.1a">+</mo><mn id="A4.E16.m1.1.1.1.1.1.1.1.1.2">100</mn></mrow><mo id="A4.E16.m1.1.1.1.1.1.1.1.2">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ac"><mrow id="A4.E16.m1.2.2.2.2.2.1"><mrow id="A4.E16.m1.2.2.2.2.2.1.1"><mtext id="A4.E16.m1.2.2.2.2.2.1.1.3">if </mtext><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.1.2">​</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.1.1.1"><mo stretchy="false" id="A4.E16.m1.2.2.2.2.2.1.1.1.1.2">|</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1"><msub id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.2"><mi id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.2.2">x</mi><mi id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.2.3">t</mi></msub><mo id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.1">−</mo><msub id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.3"><mi id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.3.2">x</mi><mi id="A4.E16.m1.2.2.2.2.2.1.1.1.1.1.3.3">g</mi></msub></mrow><mo stretchy="false" id="A4.E16.m1.2.2.2.2.2.1.1.1.1.3">|</mo></mrow></mrow><mo id="A4.E16.m1.2.2.2.2.2.1.4">≤</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.2"><mi id="A4.E16.m1.2.2.2.2.2.1.2.3">t</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.4">h</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2a">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.5">r</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2b">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.6">e</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2c">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.7">s</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2d">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.8">h</mi><mo lspace="0.280em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2e">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.2.9">𝚊𝚗𝚍</mi><mo lspace="0.280em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.2.2f">​</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.2.1.1"><mo stretchy="false" id="A4.E16.m1.2.2.2.2.2.1.2.1.1.2">|</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1"><msub id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.2"><mi id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.2.2">y</mi><mi id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.2.3">t</mi></msub><mo id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.1">−</mo><msub id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.3"><mi id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.3.2">y</mi><mi id="A4.E16.m1.2.2.2.2.2.1.2.1.1.1.3.3">g</mi></msub></mrow><mo stretchy="false" id="A4.E16.m1.2.2.2.2.2.1.2.1.1.3">|</mo></mrow></mrow><mo id="A4.E16.m1.2.2.2.2.2.1.5">≤</mo><mrow id="A4.E16.m1.2.2.2.2.2.1.6"><mi id="A4.E16.m1.2.2.2.2.2.1.6.2">t</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.6.1">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.6.3">h</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.6.1a">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.6.4">r</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.6.1b">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.6.5">e</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.6.1c">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.6.6">s</mi><mo lspace="0em" rspace="0em" id="A4.E16.m1.2.2.2.2.2.1.6.1d">​</mo><mi id="A4.E16.m1.2.2.2.2.2.1.6.7">h</mi></mrow></mrow></mtd></mtr><mtr id="A4.E16.m1.8.8.8ad"><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ae"><mrow id="A4.E16.m1.3.3.3.3.1.1.1"><mrow id="A4.E16.m1.3.3.3.3.1.1.1.1"><mo id="A4.E16.m1.3.3.3.3.1.1.1.1a">−</mo><mn id="A4.E16.m1.3.3.3.3.1.1.1.1.2">10</mn></mrow><mo id="A4.E16.m1.3.3.3.3.1.1.1.2">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8af"><mtext id="A4.E16.m1.4.4.4.4.2.1">if robot outside boundary</mtext></mtd></mtr><mtr id="A4.E16.m1.8.8.8ag"><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ah"><mrow id="A4.E16.m1.5.5.5.5.1.1.1"><mrow id="A4.E16.m1.5.5.5.5.1.1.1.1"><mo id="A4.E16.m1.5.5.5.5.1.1.1.1a">−</mo><mn id="A4.E16.m1.5.5.5.5.1.1.1.1.2">100</mn></mrow><mo id="A4.E16.m1.5.5.5.5.1.1.1.2">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ai"><mtext id="A4.E16.m1.6.6.6.6.2.1">if robot collides</mtext></mtd></mtr><mtr id="A4.E16.m1.8.8.8aj"><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8ak"><mrow id="A4.E16.m1.7.7.7.7.1.1"><mo id="A4.E16.m1.7.7.7.7.1.1.1">−</mo><mrow id="A4.E16.m1.7.7.7.7.1.1.2"><mo stretchy="false" id="A4.E16.m1.7.7.7.7.1.1.2.1">(</mo><mi id="A4.E16.m1.7.7.7.7.1.1.2.2">𝚌</mi><mo lspace="0em" rspace="0.167em" id="A4.E16.m1.7.7.7.7.1.1.2.3">.</mo><mi id="A4.E16.m1.7.7.7.7.1.1.2.4">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.E16.m1.7.7.7.7.1.1.2.5">.</mo><msubsup id="A4.E16.m1.7.7.7.7.1.1.2.6"><mi id="A4.E16.m1.7.7.7.7.1.1.2.6.2.2">𝚎</mi><mi id="A4.E16.m1.7.7.7.7.1.1.2.6.2.3">t</mi><mn id="A4.E16.m1.7.7.7.7.1.1.2.6.3">2</mn></msubsup><mo id="A4.E16.m1.7.7.7.7.1.1.2.7">+</mo><mi id="A4.E16.m1.7.7.7.7.1.1.2.8">𝚊</mi><mo lspace="0em" rspace="0.167em" id="A4.E16.m1.7.7.7.7.1.1.2.9">.</mo><mi id="A4.E16.m1.7.7.7.7.1.1.2.10">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.E16.m1.7.7.7.7.1.1.2.11">.</mo><msub id="A4.E16.m1.7.7.7.7.1.1.2.12"><mi id="A4.E16.m1.7.7.7.7.1.1.2.12.2">𝚎</mi><mi id="A4.E16.m1.7.7.7.7.1.1.2.12.3">t</mi></msub><mo id="A4.E16.m1.7.7.7.7.1.1.2.13">+</mo><mi id="A4.E16.m1.7.7.7.7.1.1.2.14">𝚑</mi><mo lspace="0em" rspace="0.167em" id="A4.E16.m1.7.7.7.7.1.1.2.15">.</mo><msub id="A4.E16.m1.7.7.7.7.1.1.2.16"><mi id="A4.E16.m1.7.7.7.7.1.1.2.16.2">𝚎</mi><mi id="A4.E16.m1.7.7.7.7.1.1.2.16.3">t</mi></msub><mo stretchy="false" id="A4.E16.m1.7.7.7.7.1.1.2.17">)</mo></mrow><mo rspace="0.055em" id="A4.E16.m1.7.7.7.7.1.1.3">+</mo><mo id="A4.E16.m1.7.7.7.7.1.1.4">∑</mo><msub id="A4.E16.m1.7.7.7.7.1.1.5"><mi id="A4.E16.m1.7.7.7.7.1.1.5.2">𝚕𝚒𝚍𝚊𝚛</mi><mi id="A4.E16.m1.7.7.7.7.1.1.5.3">t</mi></msub><mo id="A4.E16.m1.7.7.7.7.1.1.6">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E16.m1.8.8.8al"><mtext id="A4.E16.m1.8.8.8.8.2.1">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="A4.E16.m1.8b">\displaystyle R_{t}=\begin{cases}+100,&amp;\text{if }|x_{t}-x_{g}|\leq thresh\;\mathtt{and}\;|y_{t}-y_{g}|\leq thresh\\
-10,&amp;\text{if robot outside boundary}\\
-100,&amp;\text{if robot collides}\\
-(\mathtt{c.t.e}_{t}^{2}+\mathtt{a.t.e}_{t}+\mathtt{h.e}_{t})+\sum\mathtt{lidar}_{t},&amp;\text{otherwise}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="A4.SS2.p3.13" class="ltx_p">where <math id="A4.SS2.p3.4.m1.3" class="ltx_Math" alttext="\mathtt{c.t.e}_{t}" display="inline"><semantics id="A4.SS2.p3.4.m1.3a"><mrow id="A4.SS2.p3.4.m1.3.3.1" xref="A4.SS2.p3.4.m1.3.3.2.cmml"><mi id="A4.SS2.p3.4.m1.1.1" xref="A4.SS2.p3.4.m1.1.1.cmml">𝚌</mi><mo lspace="0em" rspace="0.167em" id="A4.SS2.p3.4.m1.3.3.1.2" xref="A4.SS2.p3.4.m1.3.3.2a.cmml">.</mo><mi id="A4.SS2.p3.4.m1.2.2" xref="A4.SS2.p3.4.m1.2.2.cmml">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.SS2.p3.4.m1.3.3.1.3" xref="A4.SS2.p3.4.m1.3.3.2a.cmml">.</mo><msub id="A4.SS2.p3.4.m1.3.3.1.1" xref="A4.SS2.p3.4.m1.3.3.1.1.cmml"><mi id="A4.SS2.p3.4.m1.3.3.1.1.2" xref="A4.SS2.p3.4.m1.3.3.1.1.2.cmml">𝚎</mi><mi id="A4.SS2.p3.4.m1.3.3.1.1.3" xref="A4.SS2.p3.4.m1.3.3.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.4.m1.3b"><apply id="A4.SS2.p3.4.m1.3.3.2.cmml" xref="A4.SS2.p3.4.m1.3.3.1"><csymbol cd="ambiguous" id="A4.SS2.p3.4.m1.3.3.2a.cmml" xref="A4.SS2.p3.4.m1.3.3.1.2">formulae-sequence</csymbol><ci id="A4.SS2.p3.4.m1.1.1.cmml" xref="A4.SS2.p3.4.m1.1.1">𝚌</ci><ci id="A4.SS2.p3.4.m1.2.2.cmml" xref="A4.SS2.p3.4.m1.2.2">𝚝</ci><apply id="A4.SS2.p3.4.m1.3.3.1.1.cmml" xref="A4.SS2.p3.4.m1.3.3.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.4.m1.3.3.1.1.1.cmml" xref="A4.SS2.p3.4.m1.3.3.1.1">subscript</csymbol><ci id="A4.SS2.p3.4.m1.3.3.1.1.2.cmml" xref="A4.SS2.p3.4.m1.3.3.1.1.2">𝚎</ci><ci id="A4.SS2.p3.4.m1.3.3.1.1.3.cmml" xref="A4.SS2.p3.4.m1.3.3.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.4.m1.3c">\mathtt{c.t.e}_{t}</annotation></semantics></math> is the cross-track error, <math id="A4.SS2.p3.5.m2.3" class="ltx_Math" alttext="\mathtt{a.t.e}_{t}" display="inline"><semantics id="A4.SS2.p3.5.m2.3a"><mrow id="A4.SS2.p3.5.m2.3.3.1" xref="A4.SS2.p3.5.m2.3.3.2.cmml"><mi id="A4.SS2.p3.5.m2.1.1" xref="A4.SS2.p3.5.m2.1.1.cmml">𝚊</mi><mo lspace="0em" rspace="0.167em" id="A4.SS2.p3.5.m2.3.3.1.2" xref="A4.SS2.p3.5.m2.3.3.2a.cmml">.</mo><mi id="A4.SS2.p3.5.m2.2.2" xref="A4.SS2.p3.5.m2.2.2.cmml">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.SS2.p3.5.m2.3.3.1.3" xref="A4.SS2.p3.5.m2.3.3.2a.cmml">.</mo><msub id="A4.SS2.p3.5.m2.3.3.1.1" xref="A4.SS2.p3.5.m2.3.3.1.1.cmml"><mi id="A4.SS2.p3.5.m2.3.3.1.1.2" xref="A4.SS2.p3.5.m2.3.3.1.1.2.cmml">𝚎</mi><mi id="A4.SS2.p3.5.m2.3.3.1.1.3" xref="A4.SS2.p3.5.m2.3.3.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.5.m2.3b"><apply id="A4.SS2.p3.5.m2.3.3.2.cmml" xref="A4.SS2.p3.5.m2.3.3.1"><csymbol cd="ambiguous" id="A4.SS2.p3.5.m2.3.3.2a.cmml" xref="A4.SS2.p3.5.m2.3.3.1.2">formulae-sequence</csymbol><ci id="A4.SS2.p3.5.m2.1.1.cmml" xref="A4.SS2.p3.5.m2.1.1">𝚊</ci><ci id="A4.SS2.p3.5.m2.2.2.cmml" xref="A4.SS2.p3.5.m2.2.2">𝚝</ci><apply id="A4.SS2.p3.5.m2.3.3.1.1.cmml" xref="A4.SS2.p3.5.m2.3.3.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.5.m2.3.3.1.1.1.cmml" xref="A4.SS2.p3.5.m2.3.3.1.1">subscript</csymbol><ci id="A4.SS2.p3.5.m2.3.3.1.1.2.cmml" xref="A4.SS2.p3.5.m2.3.3.1.1.2">𝚎</ci><ci id="A4.SS2.p3.5.m2.3.3.1.1.3.cmml" xref="A4.SS2.p3.5.m2.3.3.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.5.m2.3c">\mathtt{a.t.e}_{t}</annotation></semantics></math> is the along-track error, <math id="A4.SS2.p3.6.m3.2" class="ltx_Math" alttext="\mathtt{h.e}_{t}" display="inline"><semantics id="A4.SS2.p3.6.m3.2a"><mrow id="A4.SS2.p3.6.m3.2.2.1" xref="A4.SS2.p3.6.m3.2.2.2.cmml"><mi id="A4.SS2.p3.6.m3.1.1" xref="A4.SS2.p3.6.m3.1.1.cmml">𝚑</mi><mo lspace="0em" rspace="0.167em" id="A4.SS2.p3.6.m3.2.2.1.2" xref="A4.SS2.p3.6.m3.2.2.2a.cmml">.</mo><msub id="A4.SS2.p3.6.m3.2.2.1.1" xref="A4.SS2.p3.6.m3.2.2.1.1.cmml"><mi id="A4.SS2.p3.6.m3.2.2.1.1.2" xref="A4.SS2.p3.6.m3.2.2.1.1.2.cmml">𝚎</mi><mi id="A4.SS2.p3.6.m3.2.2.1.1.3" xref="A4.SS2.p3.6.m3.2.2.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.6.m3.2b"><apply id="A4.SS2.p3.6.m3.2.2.2.cmml" xref="A4.SS2.p3.6.m3.2.2.1"><csymbol cd="ambiguous" id="A4.SS2.p3.6.m3.2.2.2a.cmml" xref="A4.SS2.p3.6.m3.2.2.1.2">formulae-sequence</csymbol><ci id="A4.SS2.p3.6.m3.1.1.cmml" xref="A4.SS2.p3.6.m3.1.1">𝚑</ci><apply id="A4.SS2.p3.6.m3.2.2.1.1.cmml" xref="A4.SS2.p3.6.m3.2.2.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.6.m3.2.2.1.1.1.cmml" xref="A4.SS2.p3.6.m3.2.2.1.1">subscript</csymbol><ci id="A4.SS2.p3.6.m3.2.2.1.1.2.cmml" xref="A4.SS2.p3.6.m3.2.2.1.1.2">𝚎</ci><ci id="A4.SS2.p3.6.m3.2.2.1.1.3.cmml" xref="A4.SS2.p3.6.m3.2.2.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.6.m3.2c">\mathtt{h.e}_{t}</annotation></semantics></math> is the heading error, <math id="A4.SS2.p3.7.m4.1" class="ltx_Math" alttext="\mathtt{lidar}_{t}" display="inline"><semantics id="A4.SS2.p3.7.m4.1a"><msub id="A4.SS2.p3.7.m4.1.1" xref="A4.SS2.p3.7.m4.1.1.cmml"><mi id="A4.SS2.p3.7.m4.1.1.2" xref="A4.SS2.p3.7.m4.1.1.2.cmml">𝚕𝚒𝚍𝚊𝚛</mi><mi id="A4.SS2.p3.7.m4.1.1.3" xref="A4.SS2.p3.7.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.7.m4.1b"><apply id="A4.SS2.p3.7.m4.1.1.cmml" xref="A4.SS2.p3.7.m4.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.7.m4.1.1.1.cmml" xref="A4.SS2.p3.7.m4.1.1">subscript</csymbol><ci id="A4.SS2.p3.7.m4.1.1.2.cmml" xref="A4.SS2.p3.7.m4.1.1.2">𝚕𝚒𝚍𝚊𝚛</ci><ci id="A4.SS2.p3.7.m4.1.1.3.cmml" xref="A4.SS2.p3.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.7.m4.1c">\mathtt{lidar}_{t}</annotation></semantics></math> is the array of LIDAR measurements at time <math id="A4.SS2.p3.8.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS2.p3.8.m5.1a"><mi id="A4.SS2.p3.8.m5.1.1" xref="A4.SS2.p3.8.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.8.m5.1b"><ci id="A4.SS2.p3.8.m5.1.1.cmml" xref="A4.SS2.p3.8.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.8.m5.1c">t</annotation></semantics></math>, and <math id="A4.SS2.p3.9.m6.1" class="ltx_Math" alttext="thresh" display="inline"><semantics id="A4.SS2.p3.9.m6.1a"><mrow id="A4.SS2.p3.9.m6.1.1" xref="A4.SS2.p3.9.m6.1.1.cmml"><mi id="A4.SS2.p3.9.m6.1.1.2" xref="A4.SS2.p3.9.m6.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p3.9.m6.1.1.1" xref="A4.SS2.p3.9.m6.1.1.1.cmml">​</mo><mi id="A4.SS2.p3.9.m6.1.1.3" xref="A4.SS2.p3.9.m6.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p3.9.m6.1.1.1a" xref="A4.SS2.p3.9.m6.1.1.1.cmml">​</mo><mi id="A4.SS2.p3.9.m6.1.1.4" xref="A4.SS2.p3.9.m6.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p3.9.m6.1.1.1b" xref="A4.SS2.p3.9.m6.1.1.1.cmml">​</mo><mi id="A4.SS2.p3.9.m6.1.1.5" xref="A4.SS2.p3.9.m6.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p3.9.m6.1.1.1c" xref="A4.SS2.p3.9.m6.1.1.1.cmml">​</mo><mi id="A4.SS2.p3.9.m6.1.1.6" xref="A4.SS2.p3.9.m6.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p3.9.m6.1.1.1d" xref="A4.SS2.p3.9.m6.1.1.1.cmml">​</mo><mi id="A4.SS2.p3.9.m6.1.1.7" xref="A4.SS2.p3.9.m6.1.1.7.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.9.m6.1b"><apply id="A4.SS2.p3.9.m6.1.1.cmml" xref="A4.SS2.p3.9.m6.1.1"><times id="A4.SS2.p3.9.m6.1.1.1.cmml" xref="A4.SS2.p3.9.m6.1.1.1"></times><ci id="A4.SS2.p3.9.m6.1.1.2.cmml" xref="A4.SS2.p3.9.m6.1.1.2">𝑡</ci><ci id="A4.SS2.p3.9.m6.1.1.3.cmml" xref="A4.SS2.p3.9.m6.1.1.3">ℎ</ci><ci id="A4.SS2.p3.9.m6.1.1.4.cmml" xref="A4.SS2.p3.9.m6.1.1.4">𝑟</ci><ci id="A4.SS2.p3.9.m6.1.1.5.cmml" xref="A4.SS2.p3.9.m6.1.1.5">𝑒</ci><ci id="A4.SS2.p3.9.m6.1.1.6.cmml" xref="A4.SS2.p3.9.m6.1.1.6">𝑠</ci><ci id="A4.SS2.p3.9.m6.1.1.7.cmml" xref="A4.SS2.p3.9.m6.1.1.7">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.9.m6.1c">thresh</annotation></semantics></math> is the threshold error in distance, chosen as <math id="A4.SS2.p3.10.m7.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A4.SS2.p3.10.m7.1a"><mn id="A4.SS2.p3.10.m7.1.1" xref="A4.SS2.p3.10.m7.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.10.m7.1b"><cn type="float" id="A4.SS2.p3.10.m7.1.1.cmml" xref="A4.SS2.p3.10.m7.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.10.m7.1c">0.1</annotation></semantics></math>m. Let the L-2 distance to the goal and the heading to the goal at time <math id="A4.SS2.p3.11.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A4.SS2.p3.11.m8.1a"><mi id="A4.SS2.p3.11.m8.1.1" xref="A4.SS2.p3.11.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.11.m8.1b"><ci id="A4.SS2.p3.11.m8.1.1.cmml" xref="A4.SS2.p3.11.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.11.m8.1c">t</annotation></semantics></math> be <math id="A4.SS2.p3.12.m9.1" class="ltx_Math" alttext="d^{g}_{t}" display="inline"><semantics id="A4.SS2.p3.12.m9.1a"><msubsup id="A4.SS2.p3.12.m9.1.1" xref="A4.SS2.p3.12.m9.1.1.cmml"><mi id="A4.SS2.p3.12.m9.1.1.2.2" xref="A4.SS2.p3.12.m9.1.1.2.2.cmml">d</mi><mi id="A4.SS2.p3.12.m9.1.1.3" xref="A4.SS2.p3.12.m9.1.1.3.cmml">t</mi><mi id="A4.SS2.p3.12.m9.1.1.2.3" xref="A4.SS2.p3.12.m9.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.12.m9.1b"><apply id="A4.SS2.p3.12.m9.1.1.cmml" xref="A4.SS2.p3.12.m9.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.12.m9.1.1.1.cmml" xref="A4.SS2.p3.12.m9.1.1">subscript</csymbol><apply id="A4.SS2.p3.12.m9.1.1.2.cmml" xref="A4.SS2.p3.12.m9.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.12.m9.1.1.2.1.cmml" xref="A4.SS2.p3.12.m9.1.1">superscript</csymbol><ci id="A4.SS2.p3.12.m9.1.1.2.2.cmml" xref="A4.SS2.p3.12.m9.1.1.2.2">𝑑</ci><ci id="A4.SS2.p3.12.m9.1.1.2.3.cmml" xref="A4.SS2.p3.12.m9.1.1.2.3">𝑔</ci></apply><ci id="A4.SS2.p3.12.m9.1.1.3.cmml" xref="A4.SS2.p3.12.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.12.m9.1c">d^{g}_{t}</annotation></semantics></math> and <math id="A4.SS2.p3.13.m10.1" class="ltx_Math" alttext="\theta^{g}_{t}" display="inline"><semantics id="A4.SS2.p3.13.m10.1a"><msubsup id="A4.SS2.p3.13.m10.1.1" xref="A4.SS2.p3.13.m10.1.1.cmml"><mi id="A4.SS2.p3.13.m10.1.1.2.2" xref="A4.SS2.p3.13.m10.1.1.2.2.cmml">θ</mi><mi id="A4.SS2.p3.13.m10.1.1.3" xref="A4.SS2.p3.13.m10.1.1.3.cmml">t</mi><mi id="A4.SS2.p3.13.m10.1.1.2.3" xref="A4.SS2.p3.13.m10.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS2.p3.13.m10.1b"><apply id="A4.SS2.p3.13.m10.1.1.cmml" xref="A4.SS2.p3.13.m10.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.13.m10.1.1.1.cmml" xref="A4.SS2.p3.13.m10.1.1">subscript</csymbol><apply id="A4.SS2.p3.13.m10.1.1.2.cmml" xref="A4.SS2.p3.13.m10.1.1"><csymbol cd="ambiguous" id="A4.SS2.p3.13.m10.1.1.2.1.cmml" xref="A4.SS2.p3.13.m10.1.1">superscript</csymbol><ci id="A4.SS2.p3.13.m10.1.1.2.2.cmml" xref="A4.SS2.p3.13.m10.1.1.2.2">𝜃</ci><ci id="A4.SS2.p3.13.m10.1.1.2.3.cmml" xref="A4.SS2.p3.13.m10.1.1.2.3">𝑔</ci></apply><ci id="A4.SS2.p3.13.m10.1.1.3.cmml" xref="A4.SS2.p3.13.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p3.13.m10.1c">\theta^{g}_{t}</annotation></semantics></math> respectively. Then, we have</p>
<table id="A4.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A4.E17.m1.16" class="ltx_Math" alttext="\begin{array}[]{ccl}d^{g}_{t}&amp;=&amp;\sqrt{(x_{g}-x_{t})^{2}+(y_{g}-y_{t})^{2}},\\
\theta^{g}_{t}&amp;=&amp;\tan^{-1}\left(\frac{y_{g}-y_{t}}{x_{g}-x_{t}}\right),\\
\mathtt{c.t.e}_{t}&amp;=&amp;d^{g}_{t}\sin(\theta_{g}-\theta_{t}),\\
\mathtt{a.t.e}_{t}&amp;=&amp;|x_{g}-x_{t}|+|y_{g}-y_{t}|,\\
\mathtt{h.e}_{t}&amp;=&amp;\theta^{g}_{t}-\theta_{t}.\end{array}" display="block"><semantics id="A4.E17.m1.16a"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="A4.E17.m1.16.16" xref="A4.E17.m1.16.16.cmml"><mtr id="A4.E17.m1.16.16a" xref="A4.E17.m1.16.16.cmml"><mtd id="A4.E17.m1.16.16b" xref="A4.E17.m1.16.16.cmml"><msubsup id="A4.E17.m1.2.2.2.3.1" xref="A4.E17.m1.2.2.2.3.1.cmml"><mi id="A4.E17.m1.2.2.2.3.1.2.2" xref="A4.E17.m1.2.2.2.3.1.2.2.cmml">d</mi><mi id="A4.E17.m1.2.2.2.3.1.3" xref="A4.E17.m1.2.2.2.3.1.3.cmml">t</mi><mi id="A4.E17.m1.2.2.2.3.1.2.3" xref="A4.E17.m1.2.2.2.3.1.2.3.cmml">g</mi></msubsup></mtd><mtd id="A4.E17.m1.16.16c" xref="A4.E17.m1.16.16.cmml"><mo id="A4.E17.m1.2.2.2.4.1" xref="A4.E17.m1.2.2.2.4.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E17.m1.16.16d" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.2.2.2.2.2.4" xref="A4.E17.m1.2.2.2.2.2.2.cmml"><msqrt id="A4.E17.m1.2.2.2.2.2.2" xref="A4.E17.m1.2.2.2.2.2.2.cmml"><mrow id="A4.E17.m1.2.2.2.2.2.2.2" xref="A4.E17.m1.2.2.2.2.2.2.2.cmml"><msup id="A4.E17.m1.1.1.1.1.1.1.1.1" xref="A4.E17.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A4.E17.m1.1.1.1.1.1.1.1.1.3" xref="A4.E17.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A4.E17.m1.2.2.2.2.2.2.2.3" xref="A4.E17.m1.2.2.2.2.2.2.2.3.cmml">+</mo><msup id="A4.E17.m1.2.2.2.2.2.2.2.2" xref="A4.E17.m1.2.2.2.2.2.2.2.2.cmml"><mrow id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.2" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.cmml"><msub id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.cmml"><mi id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.2" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml">y</mi><mi id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.3" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.1" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.2" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.2.cmml">y</mi><mi id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.3" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.3" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mn id="A4.E17.m1.2.2.2.2.2.2.2.2.3" xref="A4.E17.m1.2.2.2.2.2.2.2.2.3.cmml">2</mn></msup></mrow></msqrt><mo id="A4.E17.m1.2.2.2.2.2.4.1" xref="A4.E17.m1.2.2.2.2.2.2.cmml">,</mo></mrow></mtd></mtr><mtr id="A4.E17.m1.16.16e" xref="A4.E17.m1.16.16.cmml"><mtd id="A4.E17.m1.16.16f" xref="A4.E17.m1.16.16.cmml"><msubsup id="A4.E17.m1.4.4.4.3.1" xref="A4.E17.m1.4.4.4.3.1.cmml"><mi id="A4.E17.m1.4.4.4.3.1.2.2" xref="A4.E17.m1.4.4.4.3.1.2.2.cmml">θ</mi><mi id="A4.E17.m1.4.4.4.3.1.3" xref="A4.E17.m1.4.4.4.3.1.3.cmml">t</mi><mi id="A4.E17.m1.4.4.4.3.1.2.3" xref="A4.E17.m1.4.4.4.3.1.2.3.cmml">g</mi></msubsup></mtd><mtd id="A4.E17.m1.16.16g" xref="A4.E17.m1.16.16.cmml"><mo id="A4.E17.m1.4.4.4.4.1" xref="A4.E17.m1.4.4.4.4.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E17.m1.16.16h" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.4.4.4.2.2.2" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.4.4.4.2.2.2.1.1" xref="A4.E17.m1.4.4.4.2.2.2.1.2.cmml"><msup id="A4.E17.m1.4.4.4.2.2.2.1.1.1" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.cmml"><mi id="A4.E17.m1.4.4.4.2.2.2.1.1.1.2" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.2.cmml">tan</mi><mrow id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.cmml"><mo id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3a" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.cmml">−</mo><mn id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.2" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="A4.E17.m1.4.4.4.2.2.2.1.1a" xref="A4.E17.m1.4.4.4.2.2.2.1.2.cmml">⁡</mo><mrow id="A4.E17.m1.4.4.4.2.2.2.1.1.2" xref="A4.E17.m1.4.4.4.2.2.2.1.2.cmml"><mo id="A4.E17.m1.4.4.4.2.2.2.1.1.2.1" xref="A4.E17.m1.4.4.4.2.2.2.1.2.cmml">(</mo><mstyle displaystyle="false" id="A4.E17.m1.3.3.3.1.1.1" xref="A4.E17.m1.3.3.3.1.1.1.cmml"><mfrac id="A4.E17.m1.3.3.3.1.1.1a" xref="A4.E17.m1.3.3.3.1.1.1.cmml"><mrow id="A4.E17.m1.3.3.3.1.1.1.2" xref="A4.E17.m1.3.3.3.1.1.1.2.cmml"><msub id="A4.E17.m1.3.3.3.1.1.1.2.2" xref="A4.E17.m1.3.3.3.1.1.1.2.2.cmml"><mi id="A4.E17.m1.3.3.3.1.1.1.2.2.2" xref="A4.E17.m1.3.3.3.1.1.1.2.2.2.cmml">y</mi><mi id="A4.E17.m1.3.3.3.1.1.1.2.2.3" xref="A4.E17.m1.3.3.3.1.1.1.2.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.3.3.3.1.1.1.2.1" xref="A4.E17.m1.3.3.3.1.1.1.2.1.cmml">−</mo><msub id="A4.E17.m1.3.3.3.1.1.1.2.3" xref="A4.E17.m1.3.3.3.1.1.1.2.3.cmml"><mi id="A4.E17.m1.3.3.3.1.1.1.2.3.2" xref="A4.E17.m1.3.3.3.1.1.1.2.3.2.cmml">y</mi><mi id="A4.E17.m1.3.3.3.1.1.1.2.3.3" xref="A4.E17.m1.3.3.3.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mrow id="A4.E17.m1.3.3.3.1.1.1.3" xref="A4.E17.m1.3.3.3.1.1.1.3.cmml"><msub id="A4.E17.m1.3.3.3.1.1.1.3.2" xref="A4.E17.m1.3.3.3.1.1.1.3.2.cmml"><mi id="A4.E17.m1.3.3.3.1.1.1.3.2.2" xref="A4.E17.m1.3.3.3.1.1.1.3.2.2.cmml">x</mi><mi id="A4.E17.m1.3.3.3.1.1.1.3.2.3" xref="A4.E17.m1.3.3.3.1.1.1.3.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.3.3.3.1.1.1.3.1" xref="A4.E17.m1.3.3.3.1.1.1.3.1.cmml">−</mo><msub id="A4.E17.m1.3.3.3.1.1.1.3.3" xref="A4.E17.m1.3.3.3.1.1.1.3.3.cmml"><mi id="A4.E17.m1.3.3.3.1.1.1.3.3.2" xref="A4.E17.m1.3.3.3.1.1.1.3.3.2.cmml">x</mi><mi id="A4.E17.m1.3.3.3.1.1.1.3.3.3" xref="A4.E17.m1.3.3.3.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mfrac></mstyle><mo id="A4.E17.m1.4.4.4.2.2.2.1.1.2.2" xref="A4.E17.m1.4.4.4.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E17.m1.4.4.4.2.2.2.2" xref="A4.E17.m1.16.16.cmml">,</mo></mrow></mtd></mtr><mtr id="A4.E17.m1.16.16i" xref="A4.E17.m1.16.16.cmml"><mtd id="A4.E17.m1.16.16j" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.7.7.7.3.3.3" xref="A4.E17.m1.7.7.7.3.3.4.cmml"><mi id="A4.E17.m1.5.5.5.1.1.1" xref="A4.E17.m1.5.5.5.1.1.1.cmml">𝚌</mi><mo lspace="0em" rspace="0.167em" id="A4.E17.m1.7.7.7.3.3.3.2" xref="A4.E17.m1.7.7.7.3.3.4a.cmml">.</mo><mi id="A4.E17.m1.6.6.6.2.2.2" xref="A4.E17.m1.6.6.6.2.2.2.cmml">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.E17.m1.7.7.7.3.3.3.3" xref="A4.E17.m1.7.7.7.3.3.4a.cmml">.</mo><msub id="A4.E17.m1.7.7.7.3.3.3.1" xref="A4.E17.m1.7.7.7.3.3.3.1.cmml"><mi id="A4.E17.m1.7.7.7.3.3.3.1.2" xref="A4.E17.m1.7.7.7.3.3.3.1.2.cmml">𝚎</mi><mi id="A4.E17.m1.7.7.7.3.3.3.1.3" xref="A4.E17.m1.7.7.7.3.3.3.1.3.cmml">t</mi></msub></mrow></mtd><mtd id="A4.E17.m1.16.16k" xref="A4.E17.m1.16.16.cmml"><mo id="A4.E17.m1.9.9.9.6.1" xref="A4.E17.m1.9.9.9.6.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E17.m1.16.16l" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.9.9.9.5.2.2" xref="A4.E17.m1.9.9.9.5.2.2.1.cmml"><mrow id="A4.E17.m1.9.9.9.5.2.2.1" xref="A4.E17.m1.9.9.9.5.2.2.1.cmml"><msubsup id="A4.E17.m1.9.9.9.5.2.2.1.3" xref="A4.E17.m1.9.9.9.5.2.2.1.3.cmml"><mi id="A4.E17.m1.9.9.9.5.2.2.1.3.2.2" xref="A4.E17.m1.9.9.9.5.2.2.1.3.2.2.cmml">d</mi><mi id="A4.E17.m1.9.9.9.5.2.2.1.3.3" xref="A4.E17.m1.9.9.9.5.2.2.1.3.3.cmml">t</mi><mi id="A4.E17.m1.9.9.9.5.2.2.1.3.2.3" xref="A4.E17.m1.9.9.9.5.2.2.1.3.2.3.cmml">g</mi></msubsup><mo lspace="0.167em" rspace="0em" id="A4.E17.m1.9.9.9.5.2.2.1.2" xref="A4.E17.m1.9.9.9.5.2.2.1.2.cmml">​</mo><mrow id="A4.E17.m1.9.9.9.5.2.2.1.1.1" xref="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml"><mi id="A4.E17.m1.8.8.8.4.1.1" xref="A4.E17.m1.8.8.8.4.1.1.cmml">sin</mi><mo id="A4.E17.m1.9.9.9.5.2.2.1.1.1a" xref="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml">⁡</mo><mrow id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1" xref="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml"><mo stretchy="false" id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.2" xref="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml">(</mo><mrow id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.cmml"><msub id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.cmml"><mi id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.2" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.2.cmml">θ</mi><mi id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.3" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.1" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.cmml"><mi id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.2" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.2.cmml">θ</mi><mi id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.3" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.3" xref="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A4.E17.m1.9.9.9.5.2.2.2" xref="A4.E17.m1.9.9.9.5.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="A4.E17.m1.16.16m" xref="A4.E17.m1.16.16.cmml"><mtd id="A4.E17.m1.16.16n" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.12.12.12.3.3.3" xref="A4.E17.m1.12.12.12.3.3.4.cmml"><mi id="A4.E17.m1.10.10.10.1.1.1" xref="A4.E17.m1.10.10.10.1.1.1.cmml">𝚊</mi><mo lspace="0em" rspace="0.167em" id="A4.E17.m1.12.12.12.3.3.3.2" xref="A4.E17.m1.12.12.12.3.3.4a.cmml">.</mo><mi id="A4.E17.m1.11.11.11.2.2.2" xref="A4.E17.m1.11.11.11.2.2.2.cmml">𝚝</mi><mo lspace="0em" rspace="0.167em" id="A4.E17.m1.12.12.12.3.3.3.3" xref="A4.E17.m1.12.12.12.3.3.4a.cmml">.</mo><msub id="A4.E17.m1.12.12.12.3.3.3.1" xref="A4.E17.m1.12.12.12.3.3.3.1.cmml"><mi id="A4.E17.m1.12.12.12.3.3.3.1.2" xref="A4.E17.m1.12.12.12.3.3.3.1.2.cmml">𝚎</mi><mi id="A4.E17.m1.12.12.12.3.3.3.1.3" xref="A4.E17.m1.12.12.12.3.3.3.1.3.cmml">t</mi></msub></mrow></mtd><mtd id="A4.E17.m1.16.16o" xref="A4.E17.m1.16.16.cmml"><mo id="A4.E17.m1.13.13.13.5.1" xref="A4.E17.m1.13.13.13.5.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E17.m1.16.16p" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.13.13.13.4.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.cmml"><mrow id="A4.E17.m1.13.13.13.4.1.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.cmml"><mrow id="A4.E17.m1.13.13.13.4.1.1.1.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.1.2.cmml"><mo stretchy="false" id="A4.E17.m1.13.13.13.4.1.1.1.1.1.2" xref="A4.E17.m1.13.13.13.4.1.1.1.1.2.1.cmml">|</mo><mrow id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.cmml"><msub id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.cmml"><mi id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.2" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.3" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.cmml"><mi id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.2" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.3" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A4.E17.m1.13.13.13.4.1.1.1.1.1.3" xref="A4.E17.m1.13.13.13.4.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A4.E17.m1.13.13.13.4.1.1.1.3" xref="A4.E17.m1.13.13.13.4.1.1.1.3.cmml">+</mo><mrow id="A4.E17.m1.13.13.13.4.1.1.1.2.1" xref="A4.E17.m1.13.13.13.4.1.1.1.2.2.cmml"><mo stretchy="false" id="A4.E17.m1.13.13.13.4.1.1.1.2.1.2" xref="A4.E17.m1.13.13.13.4.1.1.1.2.2.1.cmml">|</mo><mrow id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.cmml"><msub id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.cmml"><mi id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.2" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.2.cmml">y</mi><mi id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.3" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.3.cmml">g</mi></msub><mo id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.1" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.1.cmml">−</mo><msub id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.cmml"><mi id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.2" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.2.cmml">y</mi><mi id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.3" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A4.E17.m1.13.13.13.4.1.1.1.2.1.3" xref="A4.E17.m1.13.13.13.4.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo id="A4.E17.m1.13.13.13.4.1.1.2" xref="A4.E17.m1.13.13.13.4.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="A4.E17.m1.16.16q" xref="A4.E17.m1.16.16.cmml"><mtd id="A4.E17.m1.16.16r" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.15.15.15.2.2.2" xref="A4.E17.m1.15.15.15.2.2.3.cmml"><mi id="A4.E17.m1.14.14.14.1.1.1" xref="A4.E17.m1.14.14.14.1.1.1.cmml">𝚑</mi><mo lspace="0em" rspace="0.167em" id="A4.E17.m1.15.15.15.2.2.2.2" xref="A4.E17.m1.15.15.15.2.2.3a.cmml">.</mo><msub id="A4.E17.m1.15.15.15.2.2.2.1" xref="A4.E17.m1.15.15.15.2.2.2.1.cmml"><mi id="A4.E17.m1.15.15.15.2.2.2.1.2" xref="A4.E17.m1.15.15.15.2.2.2.1.2.cmml">𝚎</mi><mi id="A4.E17.m1.15.15.15.2.2.2.1.3" xref="A4.E17.m1.15.15.15.2.2.2.1.3.cmml">t</mi></msub></mrow></mtd><mtd id="A4.E17.m1.16.16s" xref="A4.E17.m1.16.16.cmml"><mo id="A4.E17.m1.16.16.16.4.1" xref="A4.E17.m1.16.16.16.4.1.cmml">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="A4.E17.m1.16.16t" xref="A4.E17.m1.16.16.cmml"><mrow id="A4.E17.m1.16.16.16.3.1.1" xref="A4.E17.m1.16.16.16.3.1.1.1.cmml"><mrow id="A4.E17.m1.16.16.16.3.1.1.1" xref="A4.E17.m1.16.16.16.3.1.1.1.cmml"><msubsup id="A4.E17.m1.16.16.16.3.1.1.1.2" xref="A4.E17.m1.16.16.16.3.1.1.1.2.cmml"><mi id="A4.E17.m1.16.16.16.3.1.1.1.2.2.2" xref="A4.E17.m1.16.16.16.3.1.1.1.2.2.2.cmml">θ</mi><mi id="A4.E17.m1.16.16.16.3.1.1.1.2.3" xref="A4.E17.m1.16.16.16.3.1.1.1.2.3.cmml">t</mi><mi id="A4.E17.m1.16.16.16.3.1.1.1.2.2.3" xref="A4.E17.m1.16.16.16.3.1.1.1.2.2.3.cmml">g</mi></msubsup><mo id="A4.E17.m1.16.16.16.3.1.1.1.1" xref="A4.E17.m1.16.16.16.3.1.1.1.1.cmml">−</mo><msub id="A4.E17.m1.16.16.16.3.1.1.1.3" xref="A4.E17.m1.16.16.16.3.1.1.1.3.cmml"><mi id="A4.E17.m1.16.16.16.3.1.1.1.3.2" xref="A4.E17.m1.16.16.16.3.1.1.1.3.2.cmml">θ</mi><mi id="A4.E17.m1.16.16.16.3.1.1.1.3.3" xref="A4.E17.m1.16.16.16.3.1.1.1.3.3.cmml">t</mi></msub></mrow><mo lspace="0em" id="A4.E17.m1.16.16.16.3.1.1.2" xref="A4.E17.m1.16.16.16.3.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A4.E17.m1.16b"><matrix id="A4.E17.m1.16.16.cmml" xref="A4.E17.m1.16.16"><matrixrow id="A4.E17.m1.16.16a.cmml" xref="A4.E17.m1.16.16"><apply id="A4.E17.m1.2.2.2.3.1.cmml" xref="A4.E17.m1.2.2.2.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.2.2.2.3.1.1.cmml" xref="A4.E17.m1.2.2.2.3.1">subscript</csymbol><apply id="A4.E17.m1.2.2.2.3.1.2.cmml" xref="A4.E17.m1.2.2.2.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.2.2.2.3.1.2.1.cmml" xref="A4.E17.m1.2.2.2.3.1">superscript</csymbol><ci id="A4.E17.m1.2.2.2.3.1.2.2.cmml" xref="A4.E17.m1.2.2.2.3.1.2.2">𝑑</ci><ci id="A4.E17.m1.2.2.2.3.1.2.3.cmml" xref="A4.E17.m1.2.2.2.3.1.2.3">𝑔</ci></apply><ci id="A4.E17.m1.2.2.2.3.1.3.cmml" xref="A4.E17.m1.2.2.2.3.1.3">𝑡</ci></apply><eq id="A4.E17.m1.2.2.2.4.1.cmml" xref="A4.E17.m1.2.2.2.4.1"></eq><apply id="A4.E17.m1.2.2.2.2.2.2.cmml" xref="A4.E17.m1.2.2.2.2.2.4"><root id="A4.E17.m1.2.2.2.2.2.2a.cmml" xref="A4.E17.m1.2.2.2.2.2.4"></root><apply id="A4.E17.m1.2.2.2.2.2.2.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2"><plus id="A4.E17.m1.2.2.2.2.2.2.2.3.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.3"></plus><apply id="A4.E17.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1"><minus id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><cn type="integer" id="A4.E17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E17.m1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="A4.E17.m1.2.2.2.2.2.2.2.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A4.E17.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1"><minus id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.1"></minus><apply id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.2">𝑦</ci><ci id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.2.3">𝑔</ci></apply><apply id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.2">𝑦</ci><ci id="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.3.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply><cn type="integer" id="A4.E17.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A4.E17.m1.2.2.2.2.2.2.2.2.3">2</cn></apply></apply></apply></matrixrow><matrixrow id="A4.E17.m1.16.16b.cmml" xref="A4.E17.m1.16.16"><apply id="A4.E17.m1.4.4.4.3.1.cmml" xref="A4.E17.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.4.4.4.3.1.1.cmml" xref="A4.E17.m1.4.4.4.3.1">subscript</csymbol><apply id="A4.E17.m1.4.4.4.3.1.2.cmml" xref="A4.E17.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.4.4.4.3.1.2.1.cmml" xref="A4.E17.m1.4.4.4.3.1">superscript</csymbol><ci id="A4.E17.m1.4.4.4.3.1.2.2.cmml" xref="A4.E17.m1.4.4.4.3.1.2.2">𝜃</ci><ci id="A4.E17.m1.4.4.4.3.1.2.3.cmml" xref="A4.E17.m1.4.4.4.3.1.2.3">𝑔</ci></apply><ci id="A4.E17.m1.4.4.4.3.1.3.cmml" xref="A4.E17.m1.4.4.4.3.1.3">𝑡</ci></apply><eq id="A4.E17.m1.4.4.4.4.1.cmml" xref="A4.E17.m1.4.4.4.4.1"></eq><apply id="A4.E17.m1.4.4.4.2.2.2.1.2.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1"><apply id="A4.E17.m1.4.4.4.2.2.2.1.1.1.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.E17.m1.4.4.4.2.2.2.1.1.1.1.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1">superscript</csymbol><tan id="A4.E17.m1.4.4.4.2.2.2.1.1.1.2.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.2"></tan><apply id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3"><minus id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.1.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3"></minus><cn type="integer" id="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.2.cmml" xref="A4.E17.m1.4.4.4.2.2.2.1.1.1.3.2">1</cn></apply></apply><apply id="A4.E17.m1.3.3.3.1.1.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1"><divide id="A4.E17.m1.3.3.3.1.1.1.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1"></divide><apply id="A4.E17.m1.3.3.3.1.1.1.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2"><minus id="A4.E17.m1.3.3.3.1.1.1.2.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.1"></minus><apply id="A4.E17.m1.3.3.3.1.1.1.2.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="A4.E17.m1.3.3.3.1.1.1.2.2.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.2">subscript</csymbol><ci id="A4.E17.m1.3.3.3.1.1.1.2.2.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.2.2">𝑦</ci><ci id="A4.E17.m1.3.3.3.1.1.1.2.2.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.2.3">𝑔</ci></apply><apply id="A4.E17.m1.3.3.3.1.1.1.2.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.E17.m1.3.3.3.1.1.1.2.3.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.3">subscript</csymbol><ci id="A4.E17.m1.3.3.3.1.1.1.2.3.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.3.2">𝑦</ci><ci id="A4.E17.m1.3.3.3.1.1.1.2.3.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="A4.E17.m1.3.3.3.1.1.1.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3"><minus id="A4.E17.m1.3.3.3.1.1.1.3.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.1"></minus><apply id="A4.E17.m1.3.3.3.1.1.1.3.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.E17.m1.3.3.3.1.1.1.3.2.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.2">subscript</csymbol><ci id="A4.E17.m1.3.3.3.1.1.1.3.2.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.2.2">𝑥</ci><ci id="A4.E17.m1.3.3.3.1.1.1.3.2.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.2.3">𝑔</ci></apply><apply id="A4.E17.m1.3.3.3.1.1.1.3.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.E17.m1.3.3.3.1.1.1.3.3.1.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="A4.E17.m1.3.3.3.1.1.1.3.3.2.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.3.2">𝑥</ci><ci id="A4.E17.m1.3.3.3.1.1.1.3.3.3.cmml" xref="A4.E17.m1.3.3.3.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A4.E17.m1.16.16c.cmml" xref="A4.E17.m1.16.16"><apply id="A4.E17.m1.7.7.7.3.3.4.cmml" xref="A4.E17.m1.7.7.7.3.3.3"><csymbol cd="ambiguous" id="A4.E17.m1.7.7.7.3.3.4a.cmml" xref="A4.E17.m1.7.7.7.3.3.3.2">formulae-sequence</csymbol><ci id="A4.E17.m1.5.5.5.1.1.1.cmml" xref="A4.E17.m1.5.5.5.1.1.1">𝚌</ci><ci id="A4.E17.m1.6.6.6.2.2.2.cmml" xref="A4.E17.m1.6.6.6.2.2.2">𝚝</ci><apply id="A4.E17.m1.7.7.7.3.3.3.1.cmml" xref="A4.E17.m1.7.7.7.3.3.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.7.7.7.3.3.3.1.1.cmml" xref="A4.E17.m1.7.7.7.3.3.3.1">subscript</csymbol><ci id="A4.E17.m1.7.7.7.3.3.3.1.2.cmml" xref="A4.E17.m1.7.7.7.3.3.3.1.2">𝚎</ci><ci id="A4.E17.m1.7.7.7.3.3.3.1.3.cmml" xref="A4.E17.m1.7.7.7.3.3.3.1.3">𝑡</ci></apply></apply><eq id="A4.E17.m1.9.9.9.6.1.cmml" xref="A4.E17.m1.9.9.9.6.1"></eq><apply id="A4.E17.m1.9.9.9.5.2.2.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2"><times id="A4.E17.m1.9.9.9.5.2.2.1.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.2"></times><apply id="A4.E17.m1.9.9.9.5.2.2.1.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.9.9.9.5.2.2.1.3.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3">subscript</csymbol><apply id="A4.E17.m1.9.9.9.5.2.2.1.3.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.9.9.9.5.2.2.1.3.2.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3">superscript</csymbol><ci id="A4.E17.m1.9.9.9.5.2.2.1.3.2.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3.2.2">𝑑</ci><ci id="A4.E17.m1.9.9.9.5.2.2.1.3.2.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3.2.3">𝑔</ci></apply><ci id="A4.E17.m1.9.9.9.5.2.2.1.3.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.3.3">𝑡</ci></apply><apply id="A4.E17.m1.9.9.9.5.2.2.1.1.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1"><sin id="A4.E17.m1.8.8.8.4.1.1.cmml" xref="A4.E17.m1.8.8.8.4.1.1"></sin><apply id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1"><minus id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.1"></minus><apply id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.2">𝜃</ci><ci id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.1.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.2.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.2">𝜃</ci><ci id="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.3.cmml" xref="A4.E17.m1.9.9.9.5.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A4.E17.m1.16.16d.cmml" xref="A4.E17.m1.16.16"><apply id="A4.E17.m1.12.12.12.3.3.4.cmml" xref="A4.E17.m1.12.12.12.3.3.3"><csymbol cd="ambiguous" id="A4.E17.m1.12.12.12.3.3.4a.cmml" xref="A4.E17.m1.12.12.12.3.3.3.2">formulae-sequence</csymbol><ci id="A4.E17.m1.10.10.10.1.1.1.cmml" xref="A4.E17.m1.10.10.10.1.1.1">𝚊</ci><ci id="A4.E17.m1.11.11.11.2.2.2.cmml" xref="A4.E17.m1.11.11.11.2.2.2">𝚝</ci><apply id="A4.E17.m1.12.12.12.3.3.3.1.cmml" xref="A4.E17.m1.12.12.12.3.3.3.1"><csymbol cd="ambiguous" id="A4.E17.m1.12.12.12.3.3.3.1.1.cmml" xref="A4.E17.m1.12.12.12.3.3.3.1">subscript</csymbol><ci id="A4.E17.m1.12.12.12.3.3.3.1.2.cmml" xref="A4.E17.m1.12.12.12.3.3.3.1.2">𝚎</ci><ci id="A4.E17.m1.12.12.12.3.3.3.1.3.cmml" xref="A4.E17.m1.12.12.12.3.3.3.1.3">𝑡</ci></apply></apply><eq id="A4.E17.m1.13.13.13.5.1.cmml" xref="A4.E17.m1.13.13.13.5.1"></eq><apply id="A4.E17.m1.13.13.13.4.1.1.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1"><plus id="A4.E17.m1.13.13.13.4.1.1.1.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.3"></plus><apply id="A4.E17.m1.13.13.13.4.1.1.1.1.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1"><abs id="A4.E17.m1.13.13.13.4.1.1.1.1.2.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.2"></abs><apply id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1"><minus id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.1"></minus><apply id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.2">𝑥</ci><ci id="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="A4.E17.m1.13.13.13.4.1.1.1.2.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1"><abs id="A4.E17.m1.13.13.13.4.1.1.1.2.2.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.2"></abs><apply id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1"><minus id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.1"></minus><apply id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2">subscript</csymbol><ci id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.2">𝑦</ci><ci id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.2.3">𝑔</ci></apply><apply id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.1.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3">subscript</csymbol><ci id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.2.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.2">𝑦</ci><ci id="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.3.cmml" xref="A4.E17.m1.13.13.13.4.1.1.1.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A4.E17.m1.16.16e.cmml" xref="A4.E17.m1.16.16"><apply id="A4.E17.m1.15.15.15.2.2.3.cmml" xref="A4.E17.m1.15.15.15.2.2.2"><csymbol cd="ambiguous" id="A4.E17.m1.15.15.15.2.2.3a.cmml" xref="A4.E17.m1.15.15.15.2.2.2.2">formulae-sequence</csymbol><ci id="A4.E17.m1.14.14.14.1.1.1.cmml" xref="A4.E17.m1.14.14.14.1.1.1">𝚑</ci><apply id="A4.E17.m1.15.15.15.2.2.2.1.cmml" xref="A4.E17.m1.15.15.15.2.2.2.1"><csymbol cd="ambiguous" id="A4.E17.m1.15.15.15.2.2.2.1.1.cmml" xref="A4.E17.m1.15.15.15.2.2.2.1">subscript</csymbol><ci id="A4.E17.m1.15.15.15.2.2.2.1.2.cmml" xref="A4.E17.m1.15.15.15.2.2.2.1.2">𝚎</ci><ci id="A4.E17.m1.15.15.15.2.2.2.1.3.cmml" xref="A4.E17.m1.15.15.15.2.2.2.1.3">𝑡</ci></apply></apply><eq id="A4.E17.m1.16.16.16.4.1.cmml" xref="A4.E17.m1.16.16.16.4.1"></eq><apply id="A4.E17.m1.16.16.16.3.1.1.1.cmml" xref="A4.E17.m1.16.16.16.3.1.1"><minus id="A4.E17.m1.16.16.16.3.1.1.1.1.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.1"></minus><apply id="A4.E17.m1.16.16.16.3.1.1.1.2.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.16.16.16.3.1.1.1.2.1.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2">subscript</csymbol><apply id="A4.E17.m1.16.16.16.3.1.1.1.2.2.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2"><csymbol cd="ambiguous" id="A4.E17.m1.16.16.16.3.1.1.1.2.2.1.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2">superscript</csymbol><ci id="A4.E17.m1.16.16.16.3.1.1.1.2.2.2.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2.2.2">𝜃</ci><ci id="A4.E17.m1.16.16.16.3.1.1.1.2.2.3.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2.2.3">𝑔</ci></apply><ci id="A4.E17.m1.16.16.16.3.1.1.1.2.3.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.2.3">𝑡</ci></apply><apply id="A4.E17.m1.16.16.16.3.1.1.1.3.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.3"><csymbol cd="ambiguous" id="A4.E17.m1.16.16.16.3.1.1.1.3.1.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.3">subscript</csymbol><ci id="A4.E17.m1.16.16.16.3.1.1.1.3.2.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.3.2">𝜃</ci><ci id="A4.E17.m1.16.16.16.3.1.1.1.3.3.cmml" xref="A4.E17.m1.16.16.16.3.1.1.1.3.3">𝑡</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="A4.E17.m1.16c">\begin{array}[]{ccl}d^{g}_{t}&amp;=&amp;\sqrt{(x_{g}-x_{t})^{2}+(y_{g}-y_{t})^{2}},\\
\theta^{g}_{t}&amp;=&amp;\tan^{-1}\left(\frac{y_{g}-y_{t}}{x_{g}-x_{t}}\right),\\
\mathtt{c.t.e}_{t}&amp;=&amp;d^{g}_{t}\sin(\theta_{g}-\theta_{t}),\\
\mathtt{a.t.e}_{t}&amp;=&amp;|x_{g}-x_{t}|+|y_{g}-y_{t}|,\\
\mathtt{h.e}_{t}&amp;=&amp;\theta^{g}_{t}-\theta_{t}.\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Mobile Robot Platform</h3>

<div id="A4.SS3.p1" class="ltx_para ltx_noindent">
<p id="A4.SS3.p1.1" class="ltx_p">We evaluate the trained algorithms on a Robotis TurtleBot3 Burger mobile robot, an open-source differential drive robot. The robot has a wheel encoder-based pose estimation system and is equipped with an RPLIDAR-A1 LIDAR for obstacle detection. We use ROS as the middleware to set up communication. The robot transmits its state (pose and LIDAR information) over a wireless network to a computer, which then transmits back the corresponding action suggested by the policy being executed.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2305.03096" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2305.03097" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2305.03097">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2305.03097" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2305.03098" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 09:48:17 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
