<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting</title>
<!--Generated on Fri Oct 11 08:10:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.08612v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S1" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S2" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S2.SS1" title="In 2 Related Work ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Underwater Sonar image analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S2.SS2" title="In 2 Related Work ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Synthetic Data Generation via Generative AI</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S2.SS3" title="In 2 Related Work ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Vision-Language Models (VLMs) and Their Application in the Sonar Domain</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS1" title="In 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Phase-1: Data Acquisition</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS1.SSS1" title="In 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Style Injection on Generated Images</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS2" title="In 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Phase-2: Train and Generate sonar Images via DDPM and GPT-prompting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS3" title="In 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Phase-3: Tune &amp; Generalize DDPM for Fine-Grained sonar Image Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS1" title="In 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS1.SSS1" title="In 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Publicly Available Sonar Images</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS1.SSS2" title="In 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>S3 Simulator Images</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS2" title="In 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS3" title="In 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS1" title="In 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Phase-1: Style-Injection Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS1.SSS1" title="In 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Style-Injection Quantitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS1.SSS2" title="In 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Style-Injection Qualitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS1.SSS3" title="In 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Sonar Image Classification Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS2" title="In 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Phase-2 &amp; 3: Fine-Tuning Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS3" title="In 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS3.SSS1" title="In 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>Phase-1: Style-Injection (Image-to-Image)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS3.SSS2" title="In 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Phase-2 &amp; 3: Fine-Tuning (Text-to–Image)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS4" title="In 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>State-of-the-art Comparison</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S6" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S7" title="In Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Acknowledgements</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document"> Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism
<br class="ltx_break"/>via Dual Diffusion Models and GPT Prompting </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Purushothaman Natarajan<sup class="ltx_sup" id="id1.1.id1">*</sup>, Kamal Basha, Athira Nambiar
<br class="ltx_break"/>Department of Computational Intelligence,
<br class="ltx_break"/>SRM Institute of Science and Technology,
<br class="ltx_break"/>Kattankulathur, Tamil Nadu, 603203, India
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2" style="font-size:90%;">c30945@srmist.edu.in, c58527@srmist.edu.in, athiram@srmist.edu.in
<br class="ltx_break"/></span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">Sonar image synthesis is crucial for advancing applications in underwater exploration, marine biology, and defence. Traditional methods often rely on extensive and costly data collection using sonar sensors, jeopardizing data quality and diversity. To overcome these limitations, this study proposes a new sonar image synthesis framework, “Synth-SONAR" leveraging diffusion models and GPT prompting. The key novelties of Synth-SONAR are threefold: First, by integrating Generative AI-based style injection techniques along with publicly available real/ simulated data, thereby producing one of the largest sonar data corpus for sonar research. Second, a dual text-conditioning sonar diffusion model hierarchy synthesizes coarse and fine-grained sonar images with enhanced quality and diversity. Third, high-level (coarse) and low-level (detailed) text-based sonar generation methods leverage advanced semantic information available in visual language models (VLMs) and GPT-prompting. During inference, the method generates diverse and realistic sonar images from textual prompts, bridging the gap between textual descriptions and sonar image generation. This marks the application of GPT-prompting in sonar imagery for the first time to the best of our knowledge. Synth-SONAR achieves state-of-the-art results in producing high-quality synthetic sonar datasets, significantly enhancing their diversity and realism.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sound Navigation and Ranging (SONAR) technology is an essential component of underwater exploration and object detection, with extensive applications in areas such as anti-submarine warfare, mine detection, submarine navigation, and torpedo guidance. It serves both civilian and military purposes, playing a crucial role in ensuring safety and operational efficiency in challenging underwater environments. Sonar operates by emitting sound waves that travel through water, reflect off objects, and are analyzed upon return to determine the location, size, and shape of underwater objects <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib46" title="">46</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Sonar images are complex, consisting of the target, target shadow, and reverberation background regions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib25" title="">25</a>]</cite>. Further, the underwater environment adds challenges like turbulence, noise, and low resolution, making underwater image analysis practically difficult <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib1" title="">1</a>]</cite>. Publicly available sonar datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib53" title="">53</a>]</cite>
often face challenges like low resolution, poor feature representation, and limited object diversity. Their scarcity is worsened by the need for expert labeling, security issues, and data sensitivity. To overcome these limitations, simulation-based studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib21" title="">21</a>]</cite> have been explored in the literature. However, these approaches still face limitations, including time-consuming manual modeling, the complexity of integrating various tools, and insufficient diversity in generated sonar data.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To this end, machine learning (ML)/ deep learning (DL) techniques have been employed for efficient sonar image synthesis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib18" title="">18</a>]</cite> in the recent years. Building on the success of generative AI (GenAI) in various fields e.g. medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib29" title="">29</a>]</cite>, autonomous vehicles <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib51" title="">51</a>]</cite> etc. similar approaches such as Generative Adversarial Networks (GANs)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib10" title="">10</a>]</cite>, style transfer  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib9" title="">9</a>]</cite> and Denoising Diffusion Probabilistic Models (DDPMs)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib13" title="">13</a>]</cite> have been adopted in sonar image synthesis to tackle data scarcity and improve model accuracy. Nonetheless, significant challenges remain, including insufficient object diversity, poor fine-grained feature preservation, complexities such as target shadows and reverberation effects, and high computational demands for real-time sonar image synthesis. Additionally, there exists a semantic gap between domain experts and machine learning models in interpreting and explaining the sonar characteristics in a human-compliant way.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose a novel sonar image synthesis framework i.e. <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">Synth-SONAR</span> to overcome the aforementioned limitations. Synth-SONAR generates high-quality, realistic sonar images by dint of advanced GenAI techniques i.e. text-conditioned diffusion models and GPT promting. The workflow of Synth-SONAR consists of three phases. In the first phase, a large-scale, diverse corpus of sonar data by integrating publicly available sonar images, S3 Simulator <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib37" title="">37</a>]</cite>, and style-injected sonar images captioned using CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib34" title="">34</a>]</cite> based vision-language models to capture high-level semantic features is generated. The next phase involves training a Denoising Diffusion Probabilistic Model (DDPM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib13" title="">13</a>]</cite>, fine-tuned with LoRA (Low-Rank Adaptation) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib14" title="">14</a>]</cite> and integrated with GPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib4" title="">4</a>]</cite> based prompts to generate coarse-level sonar images. Finally, in the final phase, the coarse images are refined into fine-grained outputs using domain-specific language instructions processed through a Vision-Language Model (VLM), further enhanced with LoRA fine-tuning and GPT for content precision. Our approach achieves a high degree of diversity and realism, as demonstrated through extensive qualitative and quantitative analysis, via metrics such as Fréchet Inception Distance (FID), Peak Signal-to-Noise Ratio (PSNR), Structural Similarity Index (SSIM), and Inception Score (IS). The key contributions of the paper are as follows:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">A novel GenAI framework i.e.“Synth-SONAR" for sonar image synthesis, incorporating dual-stage text-conditioned diffusion models for high-quality, multi-resolution image generation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">One of the most extensive and diverse sonar image datasets through the integration of multiple sources (real, simulated, and GenAI) and detailed annotations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">An innovative approach that enhances image generation techniques by utilizing Denoising Diffusion Probabilistic Models (DDPM) combined with LoRA and GPT-based prompts for controlled and high-quality realistic sonar image synthesis, thus making our approach interpretable.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Underwater Sonar image analysis</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Earlier sonar image analysis used traditional Machine learning (ML) techniques such as the Markov random field (MRF) model with the scale causal multigrid (SCM) algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib26" title="">26</a>]</cite> and undecimated discrete wavelet transform (UDWT) combined with PCA and k-means clustering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib6" title="">6</a>]</cite>. Advancements in deep learning (DL) introduced methods like FS-UTNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib44" title="">44</a>]</cite>, a framework for underwater target detection using few-shot learning. Further, techniques such as RotNet, Denoising Autoencoders, and Jigsaw <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib33" title="">33</a>]</cite> facilitated learning representations for sonar image classification without large labeled datasets. EsonarNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib12" title="">12</a>]</cite>, a lightweight vision transformer network, is designed for efficient segmentation. The Global Context External-Attention Network (GCEANet) provides zero-shot classification in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib3" title="">3</a>]</cite>. YOLOv7 improves high-precision object detection by integrating Swin-Transformer and Convolutional Block Attention Module (CBAM)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib45" title="">45</a>]</cite>. EfficientNet is used as a backbone for feature extraction in  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib2" title="">2</a>]</cite>, which uses dual-channel attention mechanisms (SE and ECA) and a modified BiFPN for multi-scale feature fusion. Additionally, DSA-Net for underwater object detection  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib23" title="">23</a>]</cite> used a dual spatial attention network (DSAM), and Generalized Focal Loss (GFL) for optimized object detection. To enhance interpretability, LIME and SP-LIME have been employed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib27" title="">27</a>]</cite> to make sonar image classification more transparent and understandable.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="378" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Overall Architecture of the proposed “Synth-SONAR" sonar image synthesis framework.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Synthetic Data Generation via Generative AI</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Synthetic data generation via GenAI addresses data scarcity using generative AI techniques like diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib5" title="">5</a>]</cite>, GANs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib11" title="">11</a>]</cite>, and VAEs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib19" title="">19</a>]</cite>. CAD-based methods include using Unreal Engine (UE) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib40" title="">40</a>]</cite> to create sonar images with diverse seabed conditions and objects, and the S3Simulator dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib37" title="">37</a>]</cite>, which leverages advanced simulation techniques, Segment Anything Model (SAM), and tools like SelfCAD and Gazebo for 3D modeling. Augmentation techniques feature the Seg2Sonar network <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib15" title="">15</a>]</cite>, which uses spatially adaptive denormalization (SPADE), Skip-Layer channel-wise Excitation (SLE), and weight adjustment (WA) modules. GAN-based methods include an enhanced CycleGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib54" title="">54</a>]</cite> model that improves underwater image contrast through a depth-oriented attention mechanism, the CBL-sinGAN network <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib32" title="">32</a>]</cite> which combines sinGAN with Convolutional Block Attention Module (CBAM) for target image augmentation. Further, SIGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib31" title="">31</a>]</cite> used a multi-scale GAN for super-resolution of sonar images. Diffusion-based approaches are exemplified by a method that uses diffusion models for synthetic image generation and augmentation in  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib49" title="">49</a>]</cite> and an enhanced YOLOv7 model that integrates a denoising-diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib45" title="">45</a>]</cite>, Vision Transformer (ViT) for high-precision object detection in side-scan sonar images.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Vision-Language Models (VLMs) and Their Application in the Sonar Domain</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Vision-Language Models (VLMs) represent a significant advancement in the field of artificial intelligence by bridging the gap between visual and textual data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib52" title="">52</a>]</cite>.
Multimodels like CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib34" title="">34</a>]</cite>, DALL-E <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib35" title="">35</a>]</cite>, BLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib22" title="">22</a>]</cite>, FLAVA  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib42" title="">42</a>]</cite>, and GIT  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib30" title="">30</a>]</cite> represent significant advancements by integrating visual and textual data, enhancing image generation and understanding through multimodal learning. While VLMs have made strides in various domains, their application to sonar data is still in its nascent stage, with only very few works in the sonar domain e.g. VALE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib28" title="">28</a>]</cite>, which combines VLM techniques with sonar data for improved underwater environment analysis.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we provide a detailed description of the proposed Synth-SONAR framework for generating sonar images. The overall architecture of the model is depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S2.F1" title="Figure 1 ‣ 2.1 Underwater Sonar image analysis ‣ 2 Related Work ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">1</span></a>, which consists of three key phases. Phase 1 is the <span class="ltx_text ltx_font_bold" id="S3.p1.1.1">Data Acquisition Phase</span>, as explained in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS1" title="3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3.1</span></a>. It entails the collection of real-world, CAD-simulated, and Gen-AI-generated images. Phases 2 and 3 utilize <span class="ltx_text ltx_font_bold" id="S3.p1.1.2">text-conditioned dual diffusion models and GPT-based prompting</span> to synthesize both “coarse" and “fine" grained sonar images. In particular, Phase-2 customizes pre-trained diffusion models for generating sonar images as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS2" title="3.2 Phase-2: Train and Generate sonar Images via DDPM and GPT-prompting ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Whereas, Phase-3 fine-tunes and generalizes the diffusion models for generating “fine"-grained sonar images as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS3" title="3.3 Phase-3: Tune &amp; Generalize DDPM for Fine-Grained sonar Image Generation ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Phase-1: Data Acquisition</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Underwater sonar imagery is a critical domain, wherein the data collection and processing of such a large training dataset is both expensive and challenging. Some of the common ways are to leverage the publicly available datasets e.g. Seabed Objects KLSG dataset, SCTD (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS1.SSS1" title="4.1.1 Publicly Available Sonar Images ‣ 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>) or the CAD-based simulated dataset such as S3 simulator data (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.SS1.SSS2" title="4.1.2 S3 Simulator Images ‣ 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>). Further, we advance the sonar image synthesis via Generative AI techniques such as style injection (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.SS1.SSS1" title="3.1.1 Style Injection on Generated Images ‣ 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>), as explained in the forthcoming section.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Style Injection on Generated Images</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">Style injection is a technique in computer vision’s image-to-image tasks, that combines content and style features to generate a new image, where the objective is to transform the content image (in our case, it is generated by the prompts from GPT) by infusing it with the stylistic elements of another image while preserving the original structure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib7" title="">7</a>]</cite>. In this work, style injection is utilized to add more diversity to the real sonar data and to increase the availability of sonar data. Refering to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.F2" title="Figure 2 ‣ 3.1.1 Style Injection on Generated Images ‣ 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">2</span></a>, we leverage the generative capability of a pre-trained large-scale model to generate content images and transfer sonar style information to the generated content images using a pre-trained stable diffusion model, thereby resolving the issue of the traditional data-collection process.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="613" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Style Injection for sonar Image Synthesis.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.7">We employ Latent Diffusion Model (LDM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib36" title="">36</a>]</cite> to perform image synthesis by operating within a low-dimensional latent space. This approach significantly reduces computational costs while maintaining a focus on the semantic content of the data. For a given image <math alttext="x\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mrow id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS1.p2.1.m1.1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS1.p2.1.m1.1.1.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.4" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><apply id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1"><in id="S3.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.2">𝑥</ci><apply id="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3"><times id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.3">𝑊</ci><cn id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.4.cmml" type="integer" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">x\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.1.m1.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, the encoder <math alttext="E" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.2.m2.1"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mi id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><ci id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.2.m2.1d">italic_E</annotation></semantics></math> encodes the image into a latent representation <math alttext="z\in\mathbb{R}^{h\times w\times c}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.3.m3.1"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><mrow id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml">z</mi><mo id="S3.SS1.SSS1.p2.3.m3.1.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS1.p2.3.m3.1.1.3" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS1.p2.3.m3.1.1.3.3" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml">h</mi><mo id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.3" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml">w</mi><mo id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.4" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><apply id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1"><in id="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.1"></in><ci id="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.2">𝑧</ci><apply id="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3"><times id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.2">ℎ</ci><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.3">𝑤</ci><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">z\in\mathbb{R}^{h\times w\times c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.3.m3.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w × italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>, and the decoder reconstructs the image from this latent representation. The diffusion model is trained on the latent space <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.4.m4.1"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><mi id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><ci id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.4.m4.1d">italic_z</annotation></semantics></math>, where the task is to predict noise <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.5.m5.1"><semantics id="S3.SS1.SSS1.p2.5.m5.1a"><mi id="S3.SS1.SSS1.p2.5.m5.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m5.1b"><ci id="S3.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m5.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.5.m5.1d">italic_ϵ</annotation></semantics></math> from the noised latent representation <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.6.m6.1"><semantics id="S3.SS1.SSS1.p2.6.m6.1a"><msub id="S3.SS1.SSS1.p2.6.m6.1.1" xref="S3.SS1.SSS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS1.p2.6.m6.1.1.2" xref="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml">z</mi><mi id="S3.SS1.SSS1.p2.6.m6.1.1.3" xref="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.6.m6.1b"><apply id="S3.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.2">𝑧</ci><ci id="S3.SS1.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.6.m6.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.6.m6.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at a given time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.7.m7.1"><semantics id="S3.SS1.SSS1.p2.7.m7.1a"><mi id="S3.SS1.SSS1.p2.7.m7.1.1" xref="S3.SS1.SSS1.p2.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.7.m7.1b"><ci id="S3.SS1.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p2.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.7.m7.1d">italic_t</annotation></semantics></math>. The corresponding training objective is:</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{LDM}=\mathbb{E}_{z,\epsilon,t}\left[\|\epsilon-\epsilon_{\theta}(z_{t},t,y)%
\|_{2}^{2}\right]" class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><msub id="S3.E1.m1.6.6.3" xref="S3.E1.m1.6.6.3.cmml"><mi id="S3.E1.m1.6.6.3.2" xref="S3.E1.m1.6.6.3.2.cmml">L</mi><mrow id="S3.E1.m1.6.6.3.3" xref="S3.E1.m1.6.6.3.3.cmml"><mi id="S3.E1.m1.6.6.3.3.2" xref="S3.E1.m1.6.6.3.3.2.cmml">L</mi><mo id="S3.E1.m1.6.6.3.3.1" xref="S3.E1.m1.6.6.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.3.3.3" xref="S3.E1.m1.6.6.3.3.3.cmml">D</mi><mo id="S3.E1.m1.6.6.3.3.1a" xref="S3.E1.m1.6.6.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.3.3.4" xref="S3.E1.m1.6.6.3.3.4.cmml">M</mi></mrow></msub><mo id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.2.cmml">=</mo><mrow id="S3.E1.m1.6.6.1" xref="S3.E1.m1.6.6.1.cmml"><msub id="S3.E1.m1.6.6.1.3" xref="S3.E1.m1.6.6.1.3.cmml"><mi id="S3.E1.m1.6.6.1.3.2" xref="S3.E1.m1.6.6.1.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.3.3.3.5" xref="S3.E1.m1.3.3.3.4.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">z</mi><mo id="S3.E1.m1.3.3.3.5.1" xref="S3.E1.m1.3.3.3.4.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">ϵ</mi><mo id="S3.E1.m1.3.3.3.5.2" xref="S3.E1.m1.3.3.3.4.cmml">,</mo><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.6.6.1.2" xref="S3.E1.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.1" xref="S3.E1.m1.6.6.1.1.2.cmml"><mo id="S3.E1.m1.6.6.1.1.1.2" xref="S3.E1.m1.6.6.1.1.2.1.cmml">[</mo><msubsup id="S3.E1.m1.6.6.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">t</mi><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">y</mi><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.5" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.6.6.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.6.6.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E1.m1.6.6.1.1.1.3" xref="S3.E1.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.2.cmml" xref="S3.E1.m1.6.6.2"></eq><apply id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.3.1.cmml" xref="S3.E1.m1.6.6.3">subscript</csymbol><ci id="S3.E1.m1.6.6.3.2.cmml" xref="S3.E1.m1.6.6.3.2">𝐿</ci><apply id="S3.E1.m1.6.6.3.3.cmml" xref="S3.E1.m1.6.6.3.3"><times id="S3.E1.m1.6.6.3.3.1.cmml" xref="S3.E1.m1.6.6.3.3.1"></times><ci id="S3.E1.m1.6.6.3.3.2.cmml" xref="S3.E1.m1.6.6.3.3.2">𝐿</ci><ci id="S3.E1.m1.6.6.3.3.3.cmml" xref="S3.E1.m1.6.6.3.3.3">𝐷</ci><ci id="S3.E1.m1.6.6.3.3.4.cmml" xref="S3.E1.m1.6.6.3.3.4">𝑀</ci></apply></apply><apply id="S3.E1.m1.6.6.1.cmml" xref="S3.E1.m1.6.6.1"><times id="S3.E1.m1.6.6.1.2.cmml" xref="S3.E1.m1.6.6.1.2"></times><apply id="S3.E1.m1.6.6.1.3.cmml" xref="S3.E1.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.3.1.cmml" xref="S3.E1.m1.6.6.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.1.3.2.cmml" xref="S3.E1.m1.6.6.1.3.2">𝔼</ci><list id="S3.E1.m1.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.5"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑧</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">italic-ϵ</ci><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">𝑡</ci></list></apply><apply id="S3.E1.m1.6.6.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.6.6.1.1.2.1.cmml" xref="S3.E1.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.6.6.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.6.6.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.2"></minus><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.3">italic-ϵ</ci><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><vector id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑡</ci><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝑦</ci></vector></apply></apply></apply><cn id="S3.E1.m1.6.6.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.6.6.1.1.1.1.1.3">2</cn></apply><cn id="S3.E1.m1.6.6.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.6.6.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">L_{LDM}=\mathbb{E}_{z,\epsilon,t}\left[\|\epsilon-\epsilon_{\theta}(z_{t},t,y)%
\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">italic_L start_POSTSUBSCRIPT italic_L italic_D italic_M end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_z , italic_ϵ , italic_t end_POSTSUBSCRIPT [ ∥ italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , italic_y ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p4">
<p class="ltx_p" id="S3.SS1.SSS1.p4.6">where <math alttext="\epsilon\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.1.m1.2"><semantics id="S3.SS1.SSS1.p4.1.m1.2a"><mrow id="S3.SS1.SSS1.p4.1.m1.2.3" xref="S3.SS1.SSS1.p4.1.m1.2.3.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.2.3.2" xref="S3.SS1.SSS1.p4.1.m1.2.3.2.cmml">ϵ</mi><mo id="S3.SS1.SSS1.p4.1.m1.2.3.1" xref="S3.SS1.SSS1.p4.1.m1.2.3.1.cmml">∼</mo><mrow id="S3.SS1.SSS1.p4.1.m1.2.3.3" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p4.1.m1.2.3.3.2" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS1.SSS1.p4.1.m1.2.3.3.1" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.SSS1.p4.1.m1.2.3.3.3.2" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.3.1.cmml"><mo id="S3.SS1.SSS1.p4.1.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.SSS1.p4.1.m1.1.1" xref="S3.SS1.SSS1.p4.1.m1.1.1.cmml">0</mn><mo id="S3.SS1.SSS1.p4.1.m1.2.3.3.3.2.2" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.3.1.cmml">,</mo><mn id="S3.SS1.SSS1.p4.1.m1.2.2" xref="S3.SS1.SSS1.p4.1.m1.2.2.cmml">1</mn><mo id="S3.SS1.SSS1.p4.1.m1.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.1.m1.2b"><apply id="S3.SS1.SSS1.p4.1.m1.2.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3"><csymbol cd="latexml" id="S3.SS1.SSS1.p4.1.m1.2.3.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.1">similar-to</csymbol><ci id="S3.SS1.SSS1.p4.1.m1.2.3.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.2">italic-ϵ</ci><apply id="S3.SS1.SSS1.p4.1.m1.2.3.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.3"><times id="S3.SS1.SSS1.p4.1.m1.2.3.3.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.1"></times><ci id="S3.SS1.SSS1.p4.1.m1.2.3.3.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS1.SSS1.p4.1.m1.2.3.3.3.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.3.3.3.2"><cn id="S3.SS1.SSS1.p4.1.m1.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p4.1.m1.1.1">0</cn><cn id="S3.SS1.SSS1.p4.1.m1.2.2.cmml" type="integer" xref="S3.SS1.SSS1.p4.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math> is the noise, <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.2.m2.1"><semantics id="S3.SS1.SSS1.p4.2.m2.1a"><mi id="S3.SS1.SSS1.p4.2.m2.1.1" xref="S3.SS1.SSS1.p4.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.2.m2.1b"><ci id="S3.SS1.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p4.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.2.m2.1d">italic_t</annotation></semantics></math> is uniformly sampled from <math alttext="\{1,\ldots,T\}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.3.m3.3"><semantics id="S3.SS1.SSS1.p4.3.m3.3a"><mrow id="S3.SS1.SSS1.p4.3.m3.3.4.2" xref="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml"><mo id="S3.SS1.SSS1.p4.3.m3.3.4.2.1" stretchy="false" xref="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml">{</mo><mn id="S3.SS1.SSS1.p4.3.m3.1.1" xref="S3.SS1.SSS1.p4.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.SSS1.p4.3.m3.3.4.2.2" xref="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS1.p4.3.m3.2.2" mathvariant="normal" xref="S3.SS1.SSS1.p4.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.SSS1.p4.3.m3.3.4.2.3" xref="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS1.p4.3.m3.3.3" xref="S3.SS1.SSS1.p4.3.m3.3.3.cmml">T</mi><mo id="S3.SS1.SSS1.p4.3.m3.3.4.2.4" stretchy="false" xref="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.3.m3.3b"><set id="S3.SS1.SSS1.p4.3.m3.3.4.1.cmml" xref="S3.SS1.SSS1.p4.3.m3.3.4.2"><cn id="S3.SS1.SSS1.p4.3.m3.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p4.3.m3.1.1">1</cn><ci id="S3.SS1.SSS1.p4.3.m3.2.2.cmml" xref="S3.SS1.SSS1.p4.3.m3.2.2">…</ci><ci id="S3.SS1.SSS1.p4.3.m3.3.3.cmml" xref="S3.SS1.SSS1.p4.3.m3.3.3">𝑇</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.3.m3.3c">\{1,\ldots,T\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.3.m3.3d">{ 1 , … , italic_T }</annotation></semantics></math>, <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.4.m4.1"><semantics id="S3.SS1.SSS1.p4.4.m4.1a"><mi id="S3.SS1.SSS1.p4.4.m4.1.1" xref="S3.SS1.SSS1.p4.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.4.m4.1b"><ci id="S3.SS1.SSS1.p4.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p4.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.4.m4.1d">italic_y</annotation></semantics></math> is the conditioning variable (which could be a style reference or text prompt), and <math alttext="\epsilon_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.5.m5.1"><semantics id="S3.SS1.SSS1.p4.5.m5.1a"><msub id="S3.SS1.SSS1.p4.5.m5.1.1" xref="S3.SS1.SSS1.p4.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p4.5.m5.1.1.2" xref="S3.SS1.SSS1.p4.5.m5.1.1.2.cmml">ϵ</mi><mi id="S3.SS1.SSS1.p4.5.m5.1.1.3" xref="S3.SS1.SSS1.p4.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.5.m5.1b"><apply id="S3.SS1.SSS1.p4.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p4.5.m5.1.1.2">italic-ϵ</ci><ci id="S3.SS1.SSS1.p4.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p4.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.5.m5.1c">\epsilon_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.5.m5.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is a neural network predicting the noise added to <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p4.6.m6.1"><semantics id="S3.SS1.SSS1.p4.6.m6.1a"><mi id="S3.SS1.SSS1.p4.6.m6.1.1" xref="S3.SS1.SSS1.p4.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.6.m6.1b"><ci id="S3.SS1.SSS1.p4.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p4.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p4.6.m6.1d">italic_z</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p5">
<p class="ltx_p" id="S3.SS1.SSS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p5.1.1">Generic Attention Mechanism:</span>
In Latent Diffusion Models (LDM), the attention mechanism is fundamental to both style injection in image-to-image tasks and text-to-image generation. The attention mechanism can be generically expressed as:</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q=W_{Q}(\phi),\quad K=W_{K}(\psi),\quad V=W_{V}(\psi)" class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.3.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">Q</mi><mo id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><msub id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2.2" xref="S3.E2.m1.4.4.1.1.3.2.2.cmml">W</mi><mi id="S3.E2.m1.4.4.1.1.3.2.3" xref="S3.E2.m1.4.4.1.1.3.2.3.cmml">Q</mi></msub><mo id="S3.E2.m1.4.4.1.1.3.1" xref="S3.E2.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.3.cmml"><mo id="S3.E2.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">ϕ</mi><mo id="S3.E2.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.2.3" rspace="1.167em" xref="S3.E2.m1.5.5.3a.cmml">,</mo><mrow id="S3.E2.m1.5.5.2.2.2" xref="S3.E2.m1.5.5.2.2.3.cmml"><mrow id="S3.E2.m1.5.5.2.2.1.1" xref="S3.E2.m1.5.5.2.2.1.1.cmml"><mi id="S3.E2.m1.5.5.2.2.1.1.2" xref="S3.E2.m1.5.5.2.2.1.1.2.cmml">K</mi><mo id="S3.E2.m1.5.5.2.2.1.1.1" xref="S3.E2.m1.5.5.2.2.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.2.2.1.1.3" xref="S3.E2.m1.5.5.2.2.1.1.3.cmml"><msub id="S3.E2.m1.5.5.2.2.1.1.3.2" xref="S3.E2.m1.5.5.2.2.1.1.3.2.cmml"><mi id="S3.E2.m1.5.5.2.2.1.1.3.2.2" xref="S3.E2.m1.5.5.2.2.1.1.3.2.2.cmml">W</mi><mi id="S3.E2.m1.5.5.2.2.1.1.3.2.3" xref="S3.E2.m1.5.5.2.2.1.1.3.2.3.cmml">K</mi></msub><mo id="S3.E2.m1.5.5.2.2.1.1.3.1" xref="S3.E2.m1.5.5.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.2.2.1.1.3.3.2" xref="S3.E2.m1.5.5.2.2.1.1.3.cmml"><mo id="S3.E2.m1.5.5.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.2.2.1.1.3.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">ψ</mi><mo id="S3.E2.m1.5.5.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.5.5.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.2.2.2.3" rspace="1.167em" xref="S3.E2.m1.5.5.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.5.5.2.2.2.2" xref="S3.E2.m1.5.5.2.2.2.2.cmml"><mi id="S3.E2.m1.5.5.2.2.2.2.2" xref="S3.E2.m1.5.5.2.2.2.2.2.cmml">V</mi><mo id="S3.E2.m1.5.5.2.2.2.2.1" xref="S3.E2.m1.5.5.2.2.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.2.2.2.2.3" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml"><msub id="S3.E2.m1.5.5.2.2.2.2.3.2" xref="S3.E2.m1.5.5.2.2.2.2.3.2.cmml"><mi id="S3.E2.m1.5.5.2.2.2.2.3.2.2" xref="S3.E2.m1.5.5.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.E2.m1.5.5.2.2.2.2.3.2.3" xref="S3.E2.m1.5.5.2.2.2.2.3.2.3.cmml">V</mi></msub><mo id="S3.E2.m1.5.5.2.2.2.2.3.1" xref="S3.E2.m1.5.5.2.2.2.2.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.2.2.2.2.3.3.2" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml"><mo id="S3.E2.m1.5.5.2.2.2.2.3.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">ψ</mi><mo id="S3.E2.m1.5.5.2.2.2.2.3.3.2.2" stretchy="false" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3a.cmml" xref="S3.E2.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1"><eq id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"></eq><ci id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2">𝑄</ci><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><times id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.1"></times><apply id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.2">𝑊</ci><ci id="S3.E2.m1.4.4.1.1.3.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.2.3">𝑄</ci></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">italic-ϕ</ci></apply></apply><apply id="S3.E2.m1.5.5.2.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.3a.cmml" xref="S3.E2.m1.5.5.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.5.5.2.2.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1"><eq id="S3.E2.m1.5.5.2.2.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1"></eq><ci id="S3.E2.m1.5.5.2.2.1.1.2.cmml" xref="S3.E2.m1.5.5.2.2.1.1.2">𝐾</ci><apply id="S3.E2.m1.5.5.2.2.1.1.3.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3"><times id="S3.E2.m1.5.5.2.2.1.1.3.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3.1"></times><apply id="S3.E2.m1.5.5.2.2.1.1.3.2.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.5.5.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3.2.2">𝑊</ci><ci id="S3.E2.m1.5.5.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.5.5.2.2.1.1.3.2.3">𝐾</ci></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝜓</ci></apply></apply><apply id="S3.E2.m1.5.5.2.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2"><eq id="S3.E2.m1.5.5.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1"></eq><ci id="S3.E2.m1.5.5.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.2">𝑉</ci><apply id="S3.E2.m1.5.5.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3"><times id="S3.E2.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.1"></times><apply id="S3.E2.m1.5.5.2.2.2.2.3.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.5.5.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.E2.m1.5.5.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.2.3">𝑉</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">Q=W_{Q}(\phi),\quad K=W_{K}(\psi),\quad V=W_{V}(\psi)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">italic_Q = italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( italic_ϕ ) , italic_K = italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ( italic_ψ ) , italic_V = italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ( italic_ψ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi_{out}=\text{Attn}(Q,K,V)=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d}}%
\right)\cdot V" class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.5" xref="S3.E3.m1.4.5.cmml"><msub id="S3.E3.m1.4.5.2" xref="S3.E3.m1.4.5.2.cmml"><mi id="S3.E3.m1.4.5.2.2" xref="S3.E3.m1.4.5.2.2.cmml">ϕ</mi><mrow id="S3.E3.m1.4.5.2.3" xref="S3.E3.m1.4.5.2.3.cmml"><mi id="S3.E3.m1.4.5.2.3.2" xref="S3.E3.m1.4.5.2.3.2.cmml">o</mi><mo id="S3.E3.m1.4.5.2.3.1" xref="S3.E3.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.5.2.3.3" xref="S3.E3.m1.4.5.2.3.3.cmml">u</mi><mo id="S3.E3.m1.4.5.2.3.1a" xref="S3.E3.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.5.2.3.4" xref="S3.E3.m1.4.5.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E3.m1.4.5.3" xref="S3.E3.m1.4.5.3.cmml">=</mo><mrow id="S3.E3.m1.4.5.4" xref="S3.E3.m1.4.5.4.cmml"><mtext id="S3.E3.m1.4.5.4.2" xref="S3.E3.m1.4.5.4.2a.cmml">Attn</mtext><mo id="S3.E3.m1.4.5.4.1" xref="S3.E3.m1.4.5.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.5.4.3.2" xref="S3.E3.m1.4.5.4.3.1.cmml"><mo id="S3.E3.m1.4.5.4.3.2.1" stretchy="false" xref="S3.E3.m1.4.5.4.3.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">Q</mi><mo id="S3.E3.m1.4.5.4.3.2.2" xref="S3.E3.m1.4.5.4.3.1.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">K</mi><mo id="S3.E3.m1.4.5.4.3.2.3" xref="S3.E3.m1.4.5.4.3.1.cmml">,</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">V</mi><mo id="S3.E3.m1.4.5.4.3.2.4" stretchy="false" xref="S3.E3.m1.4.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.5.5" xref="S3.E3.m1.4.5.5.cmml">=</mo><mrow id="S3.E3.m1.4.5.6" xref="S3.E3.m1.4.5.6.cmml"><mrow id="S3.E3.m1.4.5.6.2" xref="S3.E3.m1.4.5.6.2.cmml"><mtext id="S3.E3.m1.4.5.6.2.2" xref="S3.E3.m1.4.5.6.2.2a.cmml">softmax</mtext><mo id="S3.E3.m1.4.5.6.2.1" xref="S3.E3.m1.4.5.6.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.5.6.2.3.2" xref="S3.E3.m1.4.4.cmml"><mo id="S3.E3.m1.4.5.6.2.3.2.1" xref="S3.E3.m1.4.4.cmml">(</mo><mfrac id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml"><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">Q</mi><mo id="S3.E3.m1.4.4.2.1" xref="S3.E3.m1.4.4.2.1.cmml">⁢</mo><msup id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.4.4.2.3.2" xref="S3.E3.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.E3.m1.4.4.2.3.3" xref="S3.E3.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml"><mi id="S3.E3.m1.4.4.3.2" xref="S3.E3.m1.4.4.3.2.cmml">d</mi></msqrt></mfrac><mo id="S3.E3.m1.4.5.6.2.3.2.2" rspace="0.055em" xref="S3.E3.m1.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.5.6.1" rspace="0.222em" xref="S3.E3.m1.4.5.6.1.cmml">⋅</mo><mi id="S3.E3.m1.4.5.6.3" xref="S3.E3.m1.4.5.6.3.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.5.cmml" xref="S3.E3.m1.4.5"><and id="S3.E3.m1.4.5a.cmml" xref="S3.E3.m1.4.5"></and><apply id="S3.E3.m1.4.5b.cmml" xref="S3.E3.m1.4.5"><eq id="S3.E3.m1.4.5.3.cmml" xref="S3.E3.m1.4.5.3"></eq><apply id="S3.E3.m1.4.5.2.cmml" xref="S3.E3.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.5.2.1.cmml" xref="S3.E3.m1.4.5.2">subscript</csymbol><ci id="S3.E3.m1.4.5.2.2.cmml" xref="S3.E3.m1.4.5.2.2">italic-ϕ</ci><apply id="S3.E3.m1.4.5.2.3.cmml" xref="S3.E3.m1.4.5.2.3"><times id="S3.E3.m1.4.5.2.3.1.cmml" xref="S3.E3.m1.4.5.2.3.1"></times><ci id="S3.E3.m1.4.5.2.3.2.cmml" xref="S3.E3.m1.4.5.2.3.2">𝑜</ci><ci id="S3.E3.m1.4.5.2.3.3.cmml" xref="S3.E3.m1.4.5.2.3.3">𝑢</ci><ci id="S3.E3.m1.4.5.2.3.4.cmml" xref="S3.E3.m1.4.5.2.3.4">𝑡</ci></apply></apply><apply id="S3.E3.m1.4.5.4.cmml" xref="S3.E3.m1.4.5.4"><times id="S3.E3.m1.4.5.4.1.cmml" xref="S3.E3.m1.4.5.4.1"></times><ci id="S3.E3.m1.4.5.4.2a.cmml" xref="S3.E3.m1.4.5.4.2"><mtext id="S3.E3.m1.4.5.4.2.cmml" xref="S3.E3.m1.4.5.4.2">Attn</mtext></ci><vector id="S3.E3.m1.4.5.4.3.1.cmml" xref="S3.E3.m1.4.5.4.3.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑄</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐾</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑉</ci></vector></apply></apply><apply id="S3.E3.m1.4.5c.cmml" xref="S3.E3.m1.4.5"><eq id="S3.E3.m1.4.5.5.cmml" xref="S3.E3.m1.4.5.5"></eq><share href="https://arxiv.org/html/2410.08612v1#S3.E3.m1.4.5.4.cmml" id="S3.E3.m1.4.5d.cmml" xref="S3.E3.m1.4.5"></share><apply id="S3.E3.m1.4.5.6.cmml" xref="S3.E3.m1.4.5.6"><ci id="S3.E3.m1.4.5.6.1.cmml" xref="S3.E3.m1.4.5.6.1">⋅</ci><apply id="S3.E3.m1.4.5.6.2.cmml" xref="S3.E3.m1.4.5.6.2"><times id="S3.E3.m1.4.5.6.2.1.cmml" xref="S3.E3.m1.4.5.6.2.1"></times><ci id="S3.E3.m1.4.5.6.2.2a.cmml" xref="S3.E3.m1.4.5.6.2.2"><mtext id="S3.E3.m1.4.5.6.2.2.cmml" xref="S3.E3.m1.4.5.6.2.2">softmax</mtext></ci><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.5.6.2.3.2"><divide id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.5.6.2.3.2"></divide><apply id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"><times id="S3.E3.m1.4.4.2.1.cmml" xref="S3.E3.m1.4.4.2.1"></times><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑄</ci><apply id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.3.1.cmml" xref="S3.E3.m1.4.4.2.3">superscript</csymbol><ci id="S3.E3.m1.4.4.2.3.2.cmml" xref="S3.E3.m1.4.4.2.3.2">𝐾</ci><ci id="S3.E3.m1.4.4.2.3.3.cmml" xref="S3.E3.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"><root id="S3.E3.m1.4.4.3a.cmml" xref="S3.E3.m1.4.4.3"></root><ci id="S3.E3.m1.4.4.3.2.cmml" xref="S3.E3.m1.4.4.3.2">𝑑</ci></apply></apply></apply><ci id="S3.E3.m1.4.5.6.3.cmml" xref="S3.E3.m1.4.5.6.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\phi_{out}=\text{Attn}(Q,K,V)=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d}}%
\right)\cdot V</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">italic_ϕ start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT = Attn ( italic_Q , italic_K , italic_V ) = softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) ⋅ italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p8">
<p class="ltx_p" id="S3.SS1.SSS1.p8.11">where, query <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.1.m1.1"><semantics id="S3.SS1.SSS1.p8.1.m1.1a"><mi id="S3.SS1.SSS1.p8.1.m1.1.1" xref="S3.SS1.SSS1.p8.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.1.m1.1b"><ci id="S3.SS1.SSS1.p8.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p8.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.1.m1.1d">italic_Q</annotation></semantics></math>, key <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.2.m2.1"><semantics id="S3.SS1.SSS1.p8.2.m2.1a"><mi id="S3.SS1.SSS1.p8.2.m2.1.1" xref="S3.SS1.SSS1.p8.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.2.m2.1b"><ci id="S3.SS1.SSS1.p8.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p8.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.2.m2.1d">italic_K</annotation></semantics></math>, and value <math alttext="V" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.3.m3.1"><semantics id="S3.SS1.SSS1.p8.3.m3.1a"><mi id="S3.SS1.SSS1.p8.3.m3.1.1" xref="S3.SS1.SSS1.p8.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.3.m3.1b"><ci id="S3.SS1.SSS1.p8.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p8.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.3.m3.1d">italic_V</annotation></semantics></math> are the result of learned linear transformations via the projection layers <math alttext="W_{Q}(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.4.m4.1"><semantics id="S3.SS1.SSS1.p8.4.m4.1a"><mrow id="S3.SS1.SSS1.p8.4.m4.1.2" xref="S3.SS1.SSS1.p8.4.m4.1.2.cmml"><msub id="S3.SS1.SSS1.p8.4.m4.1.2.2" xref="S3.SS1.SSS1.p8.4.m4.1.2.2.cmml"><mi id="S3.SS1.SSS1.p8.4.m4.1.2.2.2" xref="S3.SS1.SSS1.p8.4.m4.1.2.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.p8.4.m4.1.2.2.3" xref="S3.SS1.SSS1.p8.4.m4.1.2.2.3.cmml">Q</mi></msub><mo id="S3.SS1.SSS1.p8.4.m4.1.2.1" xref="S3.SS1.SSS1.p8.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS1.p8.4.m4.1.2.3.2" xref="S3.SS1.SSS1.p8.4.m4.1.2.cmml"><mo id="S3.SS1.SSS1.p8.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS1.p8.4.m4.1.2.cmml">(</mo><mo id="S3.SS1.SSS1.p8.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS1.p8.4.m4.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS1.p8.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS1.p8.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.4.m4.1b"><apply id="S3.SS1.SSS1.p8.4.m4.1.2.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2"><times id="S3.SS1.SSS1.p8.4.m4.1.2.1.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2.1"></times><apply id="S3.SS1.SSS1.p8.4.m4.1.2.2.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p8.4.m4.1.2.2.1.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p8.4.m4.1.2.2.2.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2.2.2">𝑊</ci><ci id="S3.SS1.SSS1.p8.4.m4.1.2.2.3.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.2.2.3">𝑄</ci></apply><ci id="S3.SS1.SSS1.p8.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p8.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.4.m4.1c">W_{Q}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.4.m4.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, <math alttext="W_{K}(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.5.m5.1"><semantics id="S3.SS1.SSS1.p8.5.m5.1a"><mrow id="S3.SS1.SSS1.p8.5.m5.1.2" xref="S3.SS1.SSS1.p8.5.m5.1.2.cmml"><msub id="S3.SS1.SSS1.p8.5.m5.1.2.2" xref="S3.SS1.SSS1.p8.5.m5.1.2.2.cmml"><mi id="S3.SS1.SSS1.p8.5.m5.1.2.2.2" xref="S3.SS1.SSS1.p8.5.m5.1.2.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.p8.5.m5.1.2.2.3" xref="S3.SS1.SSS1.p8.5.m5.1.2.2.3.cmml">K</mi></msub><mo id="S3.SS1.SSS1.p8.5.m5.1.2.1" xref="S3.SS1.SSS1.p8.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS1.p8.5.m5.1.2.3.2" xref="S3.SS1.SSS1.p8.5.m5.1.2.cmml"><mo id="S3.SS1.SSS1.p8.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS1.p8.5.m5.1.2.cmml">(</mo><mo id="S3.SS1.SSS1.p8.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS1.p8.5.m5.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS1.p8.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS1.p8.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.5.m5.1b"><apply id="S3.SS1.SSS1.p8.5.m5.1.2.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2"><times id="S3.SS1.SSS1.p8.5.m5.1.2.1.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2.1"></times><apply id="S3.SS1.SSS1.p8.5.m5.1.2.2.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p8.5.m5.1.2.2.1.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p8.5.m5.1.2.2.2.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2.2.2">𝑊</ci><ci id="S3.SS1.SSS1.p8.5.m5.1.2.2.3.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.2.2.3">𝐾</ci></apply><ci id="S3.SS1.SSS1.p8.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p8.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.5.m5.1c">W_{K}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, and <math alttext="W_{V}(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.6.m6.1"><semantics id="S3.SS1.SSS1.p8.6.m6.1a"><mrow id="S3.SS1.SSS1.p8.6.m6.1.2" xref="S3.SS1.SSS1.p8.6.m6.1.2.cmml"><msub id="S3.SS1.SSS1.p8.6.m6.1.2.2" xref="S3.SS1.SSS1.p8.6.m6.1.2.2.cmml"><mi id="S3.SS1.SSS1.p8.6.m6.1.2.2.2" xref="S3.SS1.SSS1.p8.6.m6.1.2.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.p8.6.m6.1.2.2.3" xref="S3.SS1.SSS1.p8.6.m6.1.2.2.3.cmml">V</mi></msub><mo id="S3.SS1.SSS1.p8.6.m6.1.2.1" xref="S3.SS1.SSS1.p8.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS1.p8.6.m6.1.2.3.2" xref="S3.SS1.SSS1.p8.6.m6.1.2.cmml"><mo id="S3.SS1.SSS1.p8.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS1.p8.6.m6.1.2.cmml">(</mo><mo id="S3.SS1.SSS1.p8.6.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS1.p8.6.m6.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS1.p8.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS1.p8.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.6.m6.1b"><apply id="S3.SS1.SSS1.p8.6.m6.1.2.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2"><times id="S3.SS1.SSS1.p8.6.m6.1.2.1.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2.1"></times><apply id="S3.SS1.SSS1.p8.6.m6.1.2.2.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p8.6.m6.1.2.2.1.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p8.6.m6.1.2.2.2.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2.2.2">𝑊</ci><ci id="S3.SS1.SSS1.p8.6.m6.1.2.2.3.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.2.2.3">𝑉</ci></apply><ci id="S3.SS1.SSS1.p8.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p8.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.6.m6.1c">W_{V}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, respectively. The dimensionality of these projections is denoted by <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.7.m7.1"><semantics id="S3.SS1.SSS1.p8.7.m7.1a"><mi id="S3.SS1.SSS1.p8.7.m7.1.1" xref="S3.SS1.SSS1.p8.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.7.m7.1b"><ci id="S3.SS1.SSS1.p8.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p8.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.7.m7.1d">italic_d</annotation></semantics></math>, which is used in scaling the dot product between <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.8.m8.1"><semantics id="S3.SS1.SSS1.p8.8.m8.1a"><mi id="S3.SS1.SSS1.p8.8.m8.1.1" xref="S3.SS1.SSS1.p8.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.8.m8.1b"><ci id="S3.SS1.SSS1.p8.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p8.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.8.m8.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.8.m8.1d">italic_Q</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.9.m9.1"><semantics id="S3.SS1.SSS1.p8.9.m9.1a"><mi id="S3.SS1.SSS1.p8.9.m9.1.1" xref="S3.SS1.SSS1.p8.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.9.m9.1b"><ci id="S3.SS1.SSS1.p8.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p8.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.9.m9.1d">italic_K</annotation></semantics></math> in the attention mechanism. Also,
<math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.10.m10.1"><semantics id="S3.SS1.SSS1.p8.10.m10.1a"><mi id="S3.SS1.SSS1.p8.10.m10.1.1" xref="S3.SS1.SSS1.p8.10.m10.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.10.m10.1b"><ci id="S3.SS1.SSS1.p8.10.m10.1.1.cmml" xref="S3.SS1.SSS1.p8.10.m10.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.10.m10.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.10.m10.1d">italic_ϕ</annotation></semantics></math> represents the feature output from the residual block, while <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p8.11.m11.1"><semantics id="S3.SS1.SSS1.p8.11.m11.1a"><mi id="S3.SS1.SSS1.p8.11.m11.1.1" xref="S3.SS1.SSS1.p8.11.m11.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p8.11.m11.1b"><ci id="S3.SS1.SSS1.p8.11.m11.1.1.cmml" xref="S3.SS1.SSS1.p8.11.m11.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p8.11.m11.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p8.11.m11.1d">italic_ψ</annotation></semantics></math> is the conditioning variable, which can be the style features for image-to-image tasks or the text features for text-to-image tasks.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p9">
<p class="ltx_p" id="S3.SS1.SSS1.p9.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p9.1.1">Style Injection in Image-to-Image Tasks:</span>
For Style Injection, the conditioning variable <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p9.1.m1.1"><semantics id="S3.SS1.SSS1.p9.1.m1.1a"><mi id="S3.SS1.SSS1.p9.1.m1.1.1" xref="S3.SS1.SSS1.p9.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p9.1.m1.1b"><ci id="S3.SS1.SSS1.p9.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p9.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p9.1.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p9.1.m1.1d">italic_ψ</annotation></semantics></math> corresponds to the style features extracted from a reference image. The goal of style injection is to blend the style features with the content features of the original image, transferring the style while maintaining the content’s structure. The content features are represented as:</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p10">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{c}=W_{Q}(\phi)" class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><msub id="S3.E4.m1.1.2.2" xref="S3.E4.m1.1.2.2.cmml"><mi id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml">Q</mi><mi id="S3.E4.m1.1.2.2.3" xref="S3.E4.m1.1.2.2.3.cmml">c</mi></msub><mo id="S3.E4.m1.1.2.1" xref="S3.E4.m1.1.2.1.cmml">=</mo><mrow id="S3.E4.m1.1.2.3" xref="S3.E4.m1.1.2.3.cmml"><msub id="S3.E4.m1.1.2.3.2" xref="S3.E4.m1.1.2.3.2.cmml"><mi id="S3.E4.m1.1.2.3.2.2" xref="S3.E4.m1.1.2.3.2.2.cmml">W</mi><mi id="S3.E4.m1.1.2.3.2.3" xref="S3.E4.m1.1.2.3.2.3.cmml">Q</mi></msub><mo id="S3.E4.m1.1.2.3.1" xref="S3.E4.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.2.3.3.2" xref="S3.E4.m1.1.2.3.cmml"><mo id="S3.E4.m1.1.2.3.3.2.1" stretchy="false" xref="S3.E4.m1.1.2.3.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">ϕ</mi><mo id="S3.E4.m1.1.2.3.3.2.2" stretchy="false" xref="S3.E4.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><eq id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2.1"></eq><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2">𝑄</ci><ci id="S3.E4.m1.1.2.2.3.cmml" xref="S3.E4.m1.1.2.2.3">𝑐</ci></apply><apply id="S3.E4.m1.1.2.3.cmml" xref="S3.E4.m1.1.2.3"><times id="S3.E4.m1.1.2.3.1.cmml" xref="S3.E4.m1.1.2.3.1"></times><apply id="S3.E4.m1.1.2.3.2.cmml" xref="S3.E4.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.3.2.1.cmml" xref="S3.E4.m1.1.2.3.2">subscript</csymbol><ci id="S3.E4.m1.1.2.3.2.2.cmml" xref="S3.E4.m1.1.2.3.2.2">𝑊</ci><ci id="S3.E4.m1.1.2.3.2.3.cmml" xref="S3.E4.m1.1.2.3.2.3">𝑄</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">Q_{c}=W_{Q}(\phi)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( italic_ϕ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p11">
<p class="ltx_p" id="S3.SS1.SSS1.p11.1">where <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p11.1.m1.1"><semantics id="S3.SS1.SSS1.p11.1.m1.1a"><mi id="S3.SS1.SSS1.p11.1.m1.1.1" xref="S3.SS1.SSS1.p11.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p11.1.m1.1b"><ci id="S3.SS1.SSS1.p11.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p11.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p11.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p11.1.m1.1d">italic_ϕ</annotation></semantics></math> denotes the content features extracted from the image. The style features are extracted from the style image and projected into key and value pairs:</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p12">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K_{s}=W_{K}(\phi_{s}),\quad V_{s}=W_{V}(\phi_{s})" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.3.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">K</mi><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E5.m1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.3.3.cmml">K</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.2.3" rspace="1.167em" xref="S3.E5.m1.2.2.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><msub id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.3.2.cmml">V</mi><mi id="S3.E5.m1.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.3.3.cmml">s</mi></msub><mo id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><msub id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.2.2.1.3.2" xref="S3.E5.m1.2.2.2.2.1.3.2.cmml">W</mi><mi id="S3.E5.m1.2.2.2.2.1.3.3" xref="S3.E5.m1.2.2.2.2.1.3.3.cmml">V</mi></msub><mo id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.2.2.2.2.1.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E5.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></eq><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2">𝐾</ci><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑠</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E5.m1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><eq id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"></eq><apply id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2">𝑉</ci><ci id="S3.E5.m1.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.3.3">𝑠</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><times id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2"></times><apply id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.2.2.1.3.2">𝑊</ci><ci id="S3.E5.m1.2.2.2.2.1.3.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3.3">𝑉</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">K_{s}=W_{K}(\phi_{s}),\quad V_{s}=W_{V}(\phi_{s})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ( italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) , italic_V start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ( italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p13">
<p class="ltx_p" id="S3.SS1.SSS1.p13.1">where <math alttext="\phi_{s}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p13.1.m1.1"><semantics id="S3.SS1.SSS1.p13.1.m1.1a"><msub id="S3.SS1.SSS1.p13.1.m1.1.1" xref="S3.SS1.SSS1.p13.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p13.1.m1.1.1.2" xref="S3.SS1.SSS1.p13.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.SSS1.p13.1.m1.1.1.3" xref="S3.SS1.SSS1.p13.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p13.1.m1.1b"><apply id="S3.SS1.SSS1.p13.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p13.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p13.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p13.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p13.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.SS1.SSS1.p13.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p13.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p13.1.m1.1c">\phi_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p13.1.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> represents the style features from the reference image. The attention mechanism used for injecting the style features into the content is given by:</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p14">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{Q}^{cs}_{t}=\gamma\times Q^{c}_{t}+(1-\gamma)\times Q^{cs}_{t}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2.2" xref="S3.E6.m1.1.1.3.2.2.2.cmml">Q</mi><mo id="S3.E6.m1.1.1.3.2.2.1" xref="S3.E6.m1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">t</mi><mrow id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.3.2.3.2.cmml">c</mi><mo id="S3.E6.m1.1.1.3.2.3.1" xref="S3.E6.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.3.2.3.3.cmml">s</mi></mrow></msubsup><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">γ</mi><mo id="S3.E6.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.1.3.1.cmml">×</mo><msubsup id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.3.3.2.2.cmml">Q</mi><mi id="S3.E6.m1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.3.3.3.cmml">t</mi><mi id="S3.E6.m1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.3.3.2.3.cmml">c</mi></msubsup></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E6.m1.1.1.1.1.2.cmml">×</mo><msubsup id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.3.2.2.cmml">Q</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">t</mi><mrow id="S3.E6.m1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.1.1.3.2.3.2.cmml">c</mi><mo id="S3.E6.m1.1.1.1.1.3.2.3.1" xref="S3.E6.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.1.1.3.2.3.3.cmml">s</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2"><ci id="S3.E6.m1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.3.2.2.1">~</ci><ci id="S3.E6.m1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2.2">𝑄</ci></apply><apply id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3"><times id="S3.E6.m1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E6.m1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.3.2.3.3">𝑠</ci></apply></apply><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><plus id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></plus><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><times id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3.1"></times><ci id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3.2">𝛾</ci><apply id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.3.3.2.2">𝑄</ci><ci id="S3.E6.m1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.3.3.2.3">𝑐</ci></apply><ci id="S3.E6.m1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2.2">𝑄</ci><apply id="S3.E6.m1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3"><times id="S3.E6.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E6.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3.3">𝑠</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\tilde{Q}^{cs}_{t}=\gamma\times Q^{c}_{t}+(1-\gamma)\times Q^{cs}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">over~ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_γ × italic_Q start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ( 1 - italic_γ ) × italic_Q start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p15">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi^{cs}_{out}=\text{Attn}(\tilde{Q}^{cs}_{t},K^{s}_{t},V^{s}_{t})" class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><msubsup id="S3.E7.m1.3.3.5" xref="S3.E7.m1.3.3.5.cmml"><mi id="S3.E7.m1.3.3.5.2.2" xref="S3.E7.m1.3.3.5.2.2.cmml">ϕ</mi><mrow id="S3.E7.m1.3.3.5.3" xref="S3.E7.m1.3.3.5.3.cmml"><mi id="S3.E7.m1.3.3.5.3.2" xref="S3.E7.m1.3.3.5.3.2.cmml">o</mi><mo id="S3.E7.m1.3.3.5.3.1" xref="S3.E7.m1.3.3.5.3.1.cmml">⁢</mo><mi id="S3.E7.m1.3.3.5.3.3" xref="S3.E7.m1.3.3.5.3.3.cmml">u</mi><mo id="S3.E7.m1.3.3.5.3.1a" xref="S3.E7.m1.3.3.5.3.1.cmml">⁢</mo><mi id="S3.E7.m1.3.3.5.3.4" xref="S3.E7.m1.3.3.5.3.4.cmml">t</mi></mrow><mrow id="S3.E7.m1.3.3.5.2.3" xref="S3.E7.m1.3.3.5.2.3.cmml"><mi id="S3.E7.m1.3.3.5.2.3.2" xref="S3.E7.m1.3.3.5.2.3.2.cmml">c</mi><mo id="S3.E7.m1.3.3.5.2.3.1" xref="S3.E7.m1.3.3.5.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.3.3.5.2.3.3" xref="S3.E7.m1.3.3.5.2.3.3.cmml">s</mi></mrow></msubsup><mo id="S3.E7.m1.3.3.4" xref="S3.E7.m1.3.3.4.cmml">=</mo><mrow id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml"><mtext id="S3.E7.m1.3.3.3.5" xref="S3.E7.m1.3.3.3.5a.cmml">Attn</mtext><mo id="S3.E7.m1.3.3.3.4" xref="S3.E7.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.4.cmml"><mo id="S3.E7.m1.3.3.3.3.3.4" stretchy="false" xref="S3.E7.m1.3.3.3.3.4.cmml">(</mo><msubsup id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.2.2.2.cmml">Q</mi><mo id="S3.E7.m1.1.1.1.1.1.1.2.2.1" xref="S3.E7.m1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml">t</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.2.3.2.cmml">c</mi><mo id="S3.E7.m1.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.2.3.3.cmml">s</mi></mrow></msubsup><mo id="S3.E7.m1.3.3.3.3.3.5" xref="S3.E7.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.2.cmml">K</mi><mi id="S3.E7.m1.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">t</mi><mi id="S3.E7.m1.2.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S3.E7.m1.3.3.3.3.3.6" xref="S3.E7.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml"><mi id="S3.E7.m1.3.3.3.3.3.3.2.2" xref="S3.E7.m1.3.3.3.3.3.3.2.2.cmml">V</mi><mi id="S3.E7.m1.3.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.3.cmml">t</mi><mi id="S3.E7.m1.3.3.3.3.3.3.2.3" xref="S3.E7.m1.3.3.3.3.3.3.2.3.cmml">s</mi></msubsup><mo id="S3.E7.m1.3.3.3.3.3.7" stretchy="false" xref="S3.E7.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.4.cmml" xref="S3.E7.m1.3.3.4"></eq><apply id="S3.E7.m1.3.3.5.cmml" xref="S3.E7.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.5.1.cmml" xref="S3.E7.m1.3.3.5">subscript</csymbol><apply id="S3.E7.m1.3.3.5.2.cmml" xref="S3.E7.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.5.2.1.cmml" xref="S3.E7.m1.3.3.5">superscript</csymbol><ci id="S3.E7.m1.3.3.5.2.2.cmml" xref="S3.E7.m1.3.3.5.2.2">italic-ϕ</ci><apply id="S3.E7.m1.3.3.5.2.3.cmml" xref="S3.E7.m1.3.3.5.2.3"><times id="S3.E7.m1.3.3.5.2.3.1.cmml" xref="S3.E7.m1.3.3.5.2.3.1"></times><ci id="S3.E7.m1.3.3.5.2.3.2.cmml" xref="S3.E7.m1.3.3.5.2.3.2">𝑐</ci><ci id="S3.E7.m1.3.3.5.2.3.3.cmml" xref="S3.E7.m1.3.3.5.2.3.3">𝑠</ci></apply></apply><apply id="S3.E7.m1.3.3.5.3.cmml" xref="S3.E7.m1.3.3.5.3"><times id="S3.E7.m1.3.3.5.3.1.cmml" xref="S3.E7.m1.3.3.5.3.1"></times><ci id="S3.E7.m1.3.3.5.3.2.cmml" xref="S3.E7.m1.3.3.5.3.2">𝑜</ci><ci id="S3.E7.m1.3.3.5.3.3.cmml" xref="S3.E7.m1.3.3.5.3.3">𝑢</ci><ci id="S3.E7.m1.3.3.5.3.4.cmml" xref="S3.E7.m1.3.3.5.3.4">𝑡</ci></apply></apply><apply id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"><times id="S3.E7.m1.3.3.3.4.cmml" xref="S3.E7.m1.3.3.3.4"></times><ci id="S3.E7.m1.3.3.3.5a.cmml" xref="S3.E7.m1.3.3.3.5"><mtext id="S3.E7.m1.3.3.3.5.cmml" xref="S3.E7.m1.3.3.3.5">Attn</mtext></ci><vector id="S3.E7.m1.3.3.3.3.4.cmml" xref="S3.E7.m1.3.3.3.3.3"><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.2"><ci id="S3.E7.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.2.2">𝑄</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3"><times id="S3.E7.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3.2">𝑐</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3.3">𝑠</ci></apply></apply><ci id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2">𝐾</ci><ci id="S3.E7.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.3">𝑠</ci></apply><ci id="S3.E7.m1.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.3.3.3.1.cmml" xref="S3.E7.m1.3.3.3.3.3.3">subscript</csymbol><apply id="S3.E7.m1.3.3.3.3.3.3.2.cmml" xref="S3.E7.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E7.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E7.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.E7.m1.3.3.3.3.3.3.2.2">𝑉</ci><ci id="S3.E7.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3.2.3">𝑠</ci></apply><ci id="S3.E7.m1.3.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\phi^{cs}_{out}=\text{Attn}(\tilde{Q}^{cs}_{t},K^{s}_{t},V^{s}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_ϕ start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT = Attn ( over~ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_K start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_V start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p16">
<p class="ltx_p" id="S3.SS1.SSS1.p16.15">where <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.1.m1.1"><semantics id="S3.SS1.SSS1.p16.1.m1.1a"><mi id="S3.SS1.SSS1.p16.1.m1.1.1" xref="S3.SS1.SSS1.p16.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.1.m1.1b"><ci id="S3.SS1.SSS1.p16.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p16.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.1.m1.1d">italic_γ</annotation></semantics></math> is a blending ratio that controls the amount of style injected. For sonar-specific style injection, referring to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.F2" title="Figure 2 ‣ 3.1.1 Style Injection on Generated Images ‣ 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">2</span></a>, the latent noise representations of the content and style images are denoted by <math alttext="z^{c}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.2.m2.1"><semantics id="S3.SS1.SSS1.p16.2.m2.1a"><msup id="S3.SS1.SSS1.p16.2.m2.1.1" xref="S3.SS1.SSS1.p16.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p16.2.m2.1.1.2" xref="S3.SS1.SSS1.p16.2.m2.1.1.2.cmml">z</mi><mi id="S3.SS1.SSS1.p16.2.m2.1.1.3" xref="S3.SS1.SSS1.p16.2.m2.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.2.m2.1b"><apply id="S3.SS1.SSS1.p16.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p16.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p16.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p16.2.m2.1.1.2">𝑧</ci><ci id="S3.SS1.SSS1.p16.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p16.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.2.m2.1c">z^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.2.m2.1d">italic_z start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="z^{s}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.3.m3.1"><semantics id="S3.SS1.SSS1.p16.3.m3.1a"><msup id="S3.SS1.SSS1.p16.3.m3.1.1" xref="S3.SS1.SSS1.p16.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p16.3.m3.1.1.2" xref="S3.SS1.SSS1.p16.3.m3.1.1.2.cmml">z</mi><mi id="S3.SS1.SSS1.p16.3.m3.1.1.3" xref="S3.SS1.SSS1.p16.3.m3.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.3.m3.1b"><apply id="S3.SS1.SSS1.p16.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p16.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p16.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p16.3.m3.1.1.2">𝑧</ci><ci id="S3.SS1.SSS1.p16.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p16.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.3.m3.1c">z^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.3.m3.1d">italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively. These representations are obtained through the DDIM inversion process, which reconstructs both the content and style images into Gaussian noise at time step <math alttext="t=T" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.4.m4.1"><semantics id="S3.SS1.SSS1.p16.4.m4.1a"><mrow id="S3.SS1.SSS1.p16.4.m4.1.1" xref="S3.SS1.SSS1.p16.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p16.4.m4.1.1.2" xref="S3.SS1.SSS1.p16.4.m4.1.1.2.cmml">t</mi><mo id="S3.SS1.SSS1.p16.4.m4.1.1.1" xref="S3.SS1.SSS1.p16.4.m4.1.1.1.cmml">=</mo><mi id="S3.SS1.SSS1.p16.4.m4.1.1.3" xref="S3.SS1.SSS1.p16.4.m4.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.4.m4.1b"><apply id="S3.SS1.SSS1.p16.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p16.4.m4.1.1"><eq id="S3.SS1.SSS1.p16.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p16.4.m4.1.1.1"></eq><ci id="S3.SS1.SSS1.p16.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p16.4.m4.1.1.2">𝑡</ci><ci id="S3.SS1.SSS1.p16.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p16.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.4.m4.1c">t=T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.4.m4.1d">italic_t = italic_T</annotation></semantics></math>. During the DDIM inversion process, we collect the query features <math alttext="Q^{c}_{t}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.5.m5.1"><semantics id="S3.SS1.SSS1.p16.5.m5.1a"><msubsup id="S3.SS1.SSS1.p16.5.m5.1.1" xref="S3.SS1.SSS1.p16.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p16.5.m5.1.1.2.2" xref="S3.SS1.SSS1.p16.5.m5.1.1.2.2.cmml">Q</mi><mi id="S3.SS1.SSS1.p16.5.m5.1.1.3" xref="S3.SS1.SSS1.p16.5.m5.1.1.3.cmml">t</mi><mi id="S3.SS1.SSS1.p16.5.m5.1.1.2.3" xref="S3.SS1.SSS1.p16.5.m5.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.5.m5.1b"><apply id="S3.SS1.SSS1.p16.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1.2.2">𝑄</ci><ci id="S3.SS1.SSS1.p16.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.SSS1.p16.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p16.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.5.m5.1c">Q^{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.5.m5.1d">italic_Q start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from the content and the key-value pairs <math alttext="K^{s}_{t}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.6.m6.1"><semantics id="S3.SS1.SSS1.p16.6.m6.1a"><msubsup id="S3.SS1.SSS1.p16.6.m6.1.1" xref="S3.SS1.SSS1.p16.6.m6.1.1.cmml"><mi id="S3.SS1.SSS1.p16.6.m6.1.1.2.2" xref="S3.SS1.SSS1.p16.6.m6.1.1.2.2.cmml">K</mi><mi id="S3.SS1.SSS1.p16.6.m6.1.1.3" xref="S3.SS1.SSS1.p16.6.m6.1.1.3.cmml">t</mi><mi id="S3.SS1.SSS1.p16.6.m6.1.1.2.3" xref="S3.SS1.SSS1.p16.6.m6.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.6.m6.1b"><apply id="S3.SS1.SSS1.p16.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1.2.2">𝐾</ci><ci id="S3.SS1.SSS1.p16.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.SSS1.p16.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p16.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.6.m6.1c">K^{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.6.m6.1d">italic_K start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="V^{s}_{t}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.7.m7.1"><semantics id="S3.SS1.SSS1.p16.7.m7.1a"><msubsup id="S3.SS1.SSS1.p16.7.m7.1.1" xref="S3.SS1.SSS1.p16.7.m7.1.1.cmml"><mi id="S3.SS1.SSS1.p16.7.m7.1.1.2.2" xref="S3.SS1.SSS1.p16.7.m7.1.1.2.2.cmml">V</mi><mi id="S3.SS1.SSS1.p16.7.m7.1.1.3" xref="S3.SS1.SSS1.p16.7.m7.1.1.3.cmml">t</mi><mi id="S3.SS1.SSS1.p16.7.m7.1.1.2.3" xref="S3.SS1.SSS1.p16.7.m7.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.7.m7.1b"><apply id="S3.SS1.SSS1.p16.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.7.m7.1.1.1.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.7.m7.1.1.2.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.7.m7.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.7.m7.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1.2.2">𝑉</ci><ci id="S3.SS1.SSS1.p16.7.m7.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.SSS1.p16.7.m7.1.1.3.cmml" xref="S3.SS1.SSS1.p16.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.7.m7.1c">V^{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.7.m7.1d">italic_V start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from the style at each time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.8.m8.1"><semantics id="S3.SS1.SSS1.p16.8.m8.1a"><mi id="S3.SS1.SSS1.p16.8.m8.1.1" xref="S3.SS1.SSS1.p16.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.8.m8.1b"><ci id="S3.SS1.SSS1.p16.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p16.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.8.m8.1d">italic_t</annotation></semantics></math>. Once the inversion is completed, we initialize the stylized latent noise <math alttext="z^{cs}_{T}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.9.m9.1"><semantics id="S3.SS1.SSS1.p16.9.m9.1a"><msubsup id="S3.SS1.SSS1.p16.9.m9.1.1" xref="S3.SS1.SSS1.p16.9.m9.1.1.cmml"><mi id="S3.SS1.SSS1.p16.9.m9.1.1.2.2" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.2.cmml">z</mi><mi id="S3.SS1.SSS1.p16.9.m9.1.1.3" xref="S3.SS1.SSS1.p16.9.m9.1.1.3.cmml">T</mi><mrow id="S3.SS1.SSS1.p16.9.m9.1.1.2.3" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.2" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.2.cmml">c</mi><mo id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.1" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.3" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.3.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.9.m9.1b"><apply id="S3.SS1.SSS1.p16.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.9.m9.1.1.1.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.9.m9.1.1.2.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.9.m9.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.9.m9.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.2">𝑧</ci><apply id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3"><times id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.2">𝑐</ci><ci id="S3.SS1.SSS1.p16.9.m9.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.2.3.3">𝑠</ci></apply></apply><ci id="S3.SS1.SSS1.p16.9.m9.1.1.3.cmml" xref="S3.SS1.SSS1.p16.9.m9.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.9.m9.1c">z^{cs}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.9.m9.1d">italic_z start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> by copying the content latent noise <math alttext="z^{c}_{T}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.10.m10.1"><semantics id="S3.SS1.SSS1.p16.10.m10.1a"><msubsup id="S3.SS1.SSS1.p16.10.m10.1.1" xref="S3.SS1.SSS1.p16.10.m10.1.1.cmml"><mi id="S3.SS1.SSS1.p16.10.m10.1.1.2.2" xref="S3.SS1.SSS1.p16.10.m10.1.1.2.2.cmml">z</mi><mi id="S3.SS1.SSS1.p16.10.m10.1.1.3" xref="S3.SS1.SSS1.p16.10.m10.1.1.3.cmml">T</mi><mi id="S3.SS1.SSS1.p16.10.m10.1.1.2.3" xref="S3.SS1.SSS1.p16.10.m10.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.10.m10.1b"><apply id="S3.SS1.SSS1.p16.10.m10.1.1.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.10.m10.1.1.1.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.10.m10.1.1.2.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.10.m10.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p16.10.m10.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1.2.2">𝑧</ci><ci id="S3.SS1.SSS1.p16.10.m10.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.SSS1.p16.10.m10.1.1.3.cmml" xref="S3.SS1.SSS1.p16.10.m10.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.10.m10.1c">z^{c}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.10.m10.1d">italic_z start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>. To inject the style into the content, we blend the content and stylized queries using a blending ratio <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.11.m11.1"><semantics id="S3.SS1.SSS1.p16.11.m11.1a"><mi id="S3.SS1.SSS1.p16.11.m11.1.1" xref="S3.SS1.SSS1.p16.11.m11.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.11.m11.1b"><ci id="S3.SS1.SSS1.p16.11.m11.1.1.cmml" xref="S3.SS1.SSS1.p16.11.m11.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.11.m11.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.11.m11.1d">italic_γ</annotation></semantics></math> from equation <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.E6" title="In 3.1.1 Style Injection on Generated Images ‣ 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">6</span></a>. The blended query <math alttext="\tilde{Q}^{cs}_{t}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.12.m12.1"><semantics id="S3.SS1.SSS1.p16.12.m12.1a"><msubsup id="S3.SS1.SSS1.p16.12.m12.1.1" xref="S3.SS1.SSS1.p16.12.m12.1.1.cmml"><mover accent="true" id="S3.SS1.SSS1.p16.12.m12.1.1.2.2" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2.cmml"><mi id="S3.SS1.SSS1.p16.12.m12.1.1.2.2.2" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2.2.cmml">Q</mi><mo id="S3.SS1.SSS1.p16.12.m12.1.1.2.2.1" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS1.SSS1.p16.12.m12.1.1.3" xref="S3.SS1.SSS1.p16.12.m12.1.1.3.cmml">t</mi><mrow id="S3.SS1.SSS1.p16.12.m12.1.1.2.3" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.2" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.2.cmml">c</mi><mo id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.1" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.3" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.3.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.12.m12.1b"><apply id="S3.SS1.SSS1.p16.12.m12.1.1.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.12.m12.1.1.1.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1">subscript</csymbol><apply id="S3.SS1.SSS1.p16.12.m12.1.1.2.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p16.12.m12.1.1.2.1.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p16.12.m12.1.1.2.2.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2"><ci id="S3.SS1.SSS1.p16.12.m12.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2.1">~</ci><ci id="S3.SS1.SSS1.p16.12.m12.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.2.2">𝑄</ci></apply><apply id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3"><times id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.2">𝑐</ci><ci id="S3.SS1.SSS1.p16.12.m12.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.2.3.3">𝑠</ci></apply></apply><ci id="S3.SS1.SSS1.p16.12.m12.1.1.3.cmml" xref="S3.SS1.SSS1.p16.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.12.m12.1c">\tilde{Q}^{cs}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.12.m12.1d">over~ start_ARG italic_Q end_ARG start_POSTSUPERSCRIPT italic_c italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is then passed through the attention mechanism along with the style’s key and value features. By adjusting <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.13.m13.1"><semantics id="S3.SS1.SSS1.p16.13.m13.1a"><mi id="S3.SS1.SSS1.p16.13.m13.1.1" xref="S3.SS1.SSS1.p16.13.m13.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.13.m13.1b"><ci id="S3.SS1.SSS1.p16.13.m13.1.1.cmml" xref="S3.SS1.SSS1.p16.13.m13.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.13.m13.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.13.m13.1d">italic_γ</annotation></semantics></math>, we control the degree of style transfer, where a higher <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.14.m14.1"><semantics id="S3.SS1.SSS1.p16.14.m14.1a"><mi id="S3.SS1.SSS1.p16.14.m14.1.1" xref="S3.SS1.SSS1.p16.14.m14.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.14.m14.1b"><ci id="S3.SS1.SSS1.p16.14.m14.1.1.cmml" xref="S3.SS1.SSS1.p16.14.m14.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.14.m14.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.14.m14.1d">italic_γ</annotation></semantics></math> retains more of the original content features, and a lower <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p16.15.m15.1"><semantics id="S3.SS1.SSS1.p16.15.m15.1a"><mi id="S3.SS1.SSS1.p16.15.m15.1.1" xref="S3.SS1.SSS1.p16.15.m15.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p16.15.m15.1b"><ci id="S3.SS1.SSS1.p16.15.m15.1.1.cmml" xref="S3.SS1.SSS1.p16.15.m15.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p16.15.m15.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p16.15.m15.1d">italic_γ</annotation></semantics></math> strengthens the influence of the style features. This approach allows for precise control over the stylistic outcome, ensuring a smooth transition between content preservation and style injection.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Phase-2: Train and Generate sonar Images via DDPM and GPT-prompting</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Our objective is to generate a sequence of sonar images that correspond to the given text conditioning. In the case of text-to-image generation, referring to the equation <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S3.E2" title="In 3.1.1 Style Injection on Generated Images ‣ 3.1 Phase-1: Data Acquisition ‣ 3 Methodology ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">2</span></a>, the conditioning variable <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_ψ</annotation></semantics></math> corresponds to the text features. The cross-attention mechanism aligns the textual description with the visual features to generate an image that matches the text prompt.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6"><math alttext="Q_{2}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">Q</mi><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑄</ci><cn id="S3.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">Q_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">K</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐾</ci><cn id="S3.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="V_{2}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">V</mi><mn id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑉</ci><cn id="S3.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">V_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are analogous to the query, key, and value in the diffusion model explained earlier but are specific to <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.6.1">Phase 2</span>. In Phase 2, these components represent the following: <math alttext="Q_{2}=W_{Q}(\phi)" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.2" xref="S3.SS2.p2.4.m4.1.2.cmml"><msub id="S3.SS2.p2.4.m4.1.2.2" xref="S3.SS2.p2.4.m4.1.2.2.cmml"><mi id="S3.SS2.p2.4.m4.1.2.2.2" xref="S3.SS2.p2.4.m4.1.2.2.2.cmml">Q</mi><mn id="S3.SS2.p2.4.m4.1.2.2.3" xref="S3.SS2.p2.4.m4.1.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.4.m4.1.2.1" xref="S3.SS2.p2.4.m4.1.2.1.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.1.2.3" xref="S3.SS2.p2.4.m4.1.2.3.cmml"><msub id="S3.SS2.p2.4.m4.1.2.3.2" xref="S3.SS2.p2.4.m4.1.2.3.2.cmml"><mi id="S3.SS2.p2.4.m4.1.2.3.2.2" xref="S3.SS2.p2.4.m4.1.2.3.2.2.cmml">W</mi><mi id="S3.SS2.p2.4.m4.1.2.3.2.3" xref="S3.SS2.p2.4.m4.1.2.3.2.3.cmml">Q</mi></msub><mo id="S3.SS2.p2.4.m4.1.2.3.1" xref="S3.SS2.p2.4.m4.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p2.4.m4.1.2.3.3.2" xref="S3.SS2.p2.4.m4.1.2.3.cmml"><mo id="S3.SS2.p2.4.m4.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.4.m4.1.2.3.cmml">(</mo><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">ϕ</mi><mo id="S3.SS2.p2.4.m4.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p2.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.2.cmml" xref="S3.SS2.p2.4.m4.1.2"><eq id="S3.SS2.p2.4.m4.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.2.1"></eq><apply id="S3.SS2.p2.4.m4.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.2.2.2">𝑄</ci><cn id="S3.SS2.p2.4.m4.1.2.2.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.1.2.2.3">2</cn></apply><apply id="S3.SS2.p2.4.m4.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.2.3"><times id="S3.SS2.p2.4.m4.1.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.2.3.1"></times><apply id="S3.SS2.p2.4.m4.1.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.2.3.2.1.cmml" xref="S3.SS2.p2.4.m4.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.2.3.2.2.cmml" xref="S3.SS2.p2.4.m4.1.2.3.2.2">𝑊</ci><ci id="S3.SS2.p2.4.m4.1.2.3.2.3.cmml" xref="S3.SS2.p2.4.m4.1.2.3.2.3">𝑄</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">Q_{2}=W_{Q}(\phi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( italic_ϕ )</annotation></semantics></math> represents the <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.6.2">image features</span>, <math alttext="K_{2}=W_{K}(\text{Text})" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><msub id="S3.SS2.p2.5.m5.1.2.2" xref="S3.SS2.p2.5.m5.1.2.2.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2.2" xref="S3.SS2.p2.5.m5.1.2.2.2.cmml">K</mi><mn id="S3.SS2.p2.5.m5.1.2.2.3" xref="S3.SS2.p2.5.m5.1.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.5.m5.1.2.1" xref="S3.SS2.p2.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS2.p2.5.m5.1.2.3" xref="S3.SS2.p2.5.m5.1.2.3.cmml"><msub id="S3.SS2.p2.5.m5.1.2.3.2" xref="S3.SS2.p2.5.m5.1.2.3.2.cmml"><mi id="S3.SS2.p2.5.m5.1.2.3.2.2" xref="S3.SS2.p2.5.m5.1.2.3.2.2.cmml">W</mi><mi id="S3.SS2.p2.5.m5.1.2.3.2.3" xref="S3.SS2.p2.5.m5.1.2.3.2.3.cmml">K</mi></msub><mo id="S3.SS2.p2.5.m5.1.2.3.1" xref="S3.SS2.p2.5.m5.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.1.2.3.3.2" xref="S3.SS2.p2.5.m5.1.1a.cmml"><mo id="S3.SS2.p2.5.m5.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.1.1a.cmml">(</mo><mtext id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">Text</mtext><mo id="S3.SS2.p2.5.m5.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p2.5.m5.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><eq id="S3.SS2.p2.5.m5.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.1"></eq><apply id="S3.SS2.p2.5.m5.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.2.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2">𝐾</ci><cn id="S3.SS2.p2.5.m5.1.2.2.3.cmml" type="integer" xref="S3.SS2.p2.5.m5.1.2.2.3">2</cn></apply><apply id="S3.SS2.p2.5.m5.1.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.3"><times id="S3.SS2.p2.5.m5.1.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.2.3.1"></times><apply id="S3.SS2.p2.5.m5.1.2.3.2.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.3.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.2.3.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2.2">𝑊</ci><ci id="S3.SS2.p2.5.m5.1.2.3.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2.3">𝐾</ci></apply><ci id="S3.SS2.p2.5.m5.1.1a.cmml" xref="S3.SS2.p2.5.m5.1.2.3.3.2"><mtext id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">Text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">K_{2}=W_{K}(\text{Text})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ( Text )</annotation></semantics></math>, and <math alttext="V_{2}=W_{V}(\text{Text})" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mrow id="S3.SS2.p2.6.m6.1.2" xref="S3.SS2.p2.6.m6.1.2.cmml"><msub id="S3.SS2.p2.6.m6.1.2.2" xref="S3.SS2.p2.6.m6.1.2.2.cmml"><mi id="S3.SS2.p2.6.m6.1.2.2.2" xref="S3.SS2.p2.6.m6.1.2.2.2.cmml">V</mi><mn id="S3.SS2.p2.6.m6.1.2.2.3" xref="S3.SS2.p2.6.m6.1.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.6.m6.1.2.1" xref="S3.SS2.p2.6.m6.1.2.1.cmml">=</mo><mrow id="S3.SS2.p2.6.m6.1.2.3" xref="S3.SS2.p2.6.m6.1.2.3.cmml"><msub id="S3.SS2.p2.6.m6.1.2.3.2" xref="S3.SS2.p2.6.m6.1.2.3.2.cmml"><mi id="S3.SS2.p2.6.m6.1.2.3.2.2" xref="S3.SS2.p2.6.m6.1.2.3.2.2.cmml">W</mi><mi id="S3.SS2.p2.6.m6.1.2.3.2.3" xref="S3.SS2.p2.6.m6.1.2.3.2.3.cmml">V</mi></msub><mo id="S3.SS2.p2.6.m6.1.2.3.1" xref="S3.SS2.p2.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p2.6.m6.1.2.3.3.2" xref="S3.SS2.p2.6.m6.1.1a.cmml"><mo id="S3.SS2.p2.6.m6.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.6.m6.1.1a.cmml">(</mo><mtext id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">Text</mtext><mo id="S3.SS2.p2.6.m6.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p2.6.m6.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.2.cmml" xref="S3.SS2.p2.6.m6.1.2"><eq id="S3.SS2.p2.6.m6.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.2.1"></eq><apply id="S3.SS2.p2.6.m6.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.2.2.1.cmml" xref="S3.SS2.p2.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.2.2.2.cmml" xref="S3.SS2.p2.6.m6.1.2.2.2">𝑉</ci><cn id="S3.SS2.p2.6.m6.1.2.2.3.cmml" type="integer" xref="S3.SS2.p2.6.m6.1.2.2.3">2</cn></apply><apply id="S3.SS2.p2.6.m6.1.2.3.cmml" xref="S3.SS2.p2.6.m6.1.2.3"><times id="S3.SS2.p2.6.m6.1.2.3.1.cmml" xref="S3.SS2.p2.6.m6.1.2.3.1"></times><apply id="S3.SS2.p2.6.m6.1.2.3.2.cmml" xref="S3.SS2.p2.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.2.3.2.1.cmml" xref="S3.SS2.p2.6.m6.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.2.3.2.2.cmml" xref="S3.SS2.p2.6.m6.1.2.3.2.2">𝑊</ci><ci id="S3.SS2.p2.6.m6.1.2.3.2.3.cmml" xref="S3.SS2.p2.6.m6.1.2.3.2.3">𝑉</ci></apply><ci id="S3.SS2.p2.6.m6.1.1a.cmml" xref="S3.SS2.p2.6.m6.1.2.3.3.2"><mtext id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">Text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">V_{2}=W_{V}(\text{Text})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ( Text )</annotation></semantics></math> represent the <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.6.3">text features</span>. The attention mechanism for text-to-image generation is given by:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi^{out}=\text{Attn}(Q_{2},K_{2},V_{2})=\text{softmax}\left(\frac{Q_{2}K_{2}%
^{T}}{\sqrt{d}}\right)\cdot V_{2}" class="ltx_Math" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><msup id="S3.E8.m1.4.4.5" xref="S3.E8.m1.4.4.5.cmml"><mi id="S3.E8.m1.4.4.5.2" xref="S3.E8.m1.4.4.5.2.cmml">ϕ</mi><mrow id="S3.E8.m1.4.4.5.3" xref="S3.E8.m1.4.4.5.3.cmml"><mi id="S3.E8.m1.4.4.5.3.2" xref="S3.E8.m1.4.4.5.3.2.cmml">o</mi><mo id="S3.E8.m1.4.4.5.3.1" xref="S3.E8.m1.4.4.5.3.1.cmml">⁢</mo><mi id="S3.E8.m1.4.4.5.3.3" xref="S3.E8.m1.4.4.5.3.3.cmml">u</mi><mo id="S3.E8.m1.4.4.5.3.1a" xref="S3.E8.m1.4.4.5.3.1.cmml">⁢</mo><mi id="S3.E8.m1.4.4.5.3.4" xref="S3.E8.m1.4.4.5.3.4.cmml">t</mi></mrow></msup><mo id="S3.E8.m1.4.4.6" xref="S3.E8.m1.4.4.6.cmml">=</mo><mrow id="S3.E8.m1.4.4.3" xref="S3.E8.m1.4.4.3.cmml"><mtext id="S3.E8.m1.4.4.3.5" xref="S3.E8.m1.4.4.3.5a.cmml">Attn</mtext><mo id="S3.E8.m1.4.4.3.4" xref="S3.E8.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.3.3.3" xref="S3.E8.m1.4.4.3.3.4.cmml"><mo id="S3.E8.m1.4.4.3.3.3.4" stretchy="false" xref="S3.E8.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">Q</mi><mn id="S3.E8.m1.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E8.m1.4.4.3.3.3.5" xref="S3.E8.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.E8.m1.3.3.2.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.2.cmml">K</mi><mn id="S3.E8.m1.3.3.2.2.2.2.3" xref="S3.E8.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E8.m1.4.4.3.3.3.6" xref="S3.E8.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.E8.m1.4.4.3.3.3.3" xref="S3.E8.m1.4.4.3.3.3.3.cmml"><mi id="S3.E8.m1.4.4.3.3.3.3.2" xref="S3.E8.m1.4.4.3.3.3.3.2.cmml">V</mi><mn id="S3.E8.m1.4.4.3.3.3.3.3" xref="S3.E8.m1.4.4.3.3.3.3.3.cmml">2</mn></msub><mo id="S3.E8.m1.4.4.3.3.3.7" stretchy="false" xref="S3.E8.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.7" xref="S3.E8.m1.4.4.7.cmml">=</mo><mrow id="S3.E8.m1.4.4.8" xref="S3.E8.m1.4.4.8.cmml"><mrow id="S3.E8.m1.4.4.8.2" xref="S3.E8.m1.4.4.8.2.cmml"><mtext id="S3.E8.m1.4.4.8.2.2" xref="S3.E8.m1.4.4.8.2.2a.cmml">softmax</mtext><mo id="S3.E8.m1.4.4.8.2.1" xref="S3.E8.m1.4.4.8.2.1.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.8.2.3.2" xref="S3.E8.m1.1.1.cmml"><mo id="S3.E8.m1.4.4.8.2.3.2.1" xref="S3.E8.m1.1.1.cmml">(</mo><mfrac id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><msub id="S3.E8.m1.1.1.2.2" xref="S3.E8.m1.1.1.2.2.cmml"><mi id="S3.E8.m1.1.1.2.2.2" xref="S3.E8.m1.1.1.2.2.2.cmml">Q</mi><mn id="S3.E8.m1.1.1.2.2.3" xref="S3.E8.m1.1.1.2.2.3.cmml">2</mn></msub><mo id="S3.E8.m1.1.1.2.1" xref="S3.E8.m1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.2.3.2.2" xref="S3.E8.m1.1.1.2.3.2.2.cmml">K</mi><mn id="S3.E8.m1.1.1.2.3.2.3" xref="S3.E8.m1.1.1.2.3.2.3.cmml">2</mn><mi id="S3.E8.m1.1.1.2.3.3" xref="S3.E8.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">d</mi></msqrt></mfrac><mo id="S3.E8.m1.4.4.8.2.3.2.2" rspace="0.055em" xref="S3.E8.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.8.1" rspace="0.222em" xref="S3.E8.m1.4.4.8.1.cmml">⋅</mo><msub id="S3.E8.m1.4.4.8.3" xref="S3.E8.m1.4.4.8.3.cmml"><mi id="S3.E8.m1.4.4.8.3.2" xref="S3.E8.m1.4.4.8.3.2.cmml">V</mi><mn id="S3.E8.m1.4.4.8.3.3" xref="S3.E8.m1.4.4.8.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><and id="S3.E8.m1.4.4a.cmml" xref="S3.E8.m1.4.4"></and><apply id="S3.E8.m1.4.4b.cmml" xref="S3.E8.m1.4.4"><eq id="S3.E8.m1.4.4.6.cmml" xref="S3.E8.m1.4.4.6"></eq><apply id="S3.E8.m1.4.4.5.cmml" xref="S3.E8.m1.4.4.5"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.5.1.cmml" xref="S3.E8.m1.4.4.5">superscript</csymbol><ci id="S3.E8.m1.4.4.5.2.cmml" xref="S3.E8.m1.4.4.5.2">italic-ϕ</ci><apply id="S3.E8.m1.4.4.5.3.cmml" xref="S3.E8.m1.4.4.5.3"><times id="S3.E8.m1.4.4.5.3.1.cmml" xref="S3.E8.m1.4.4.5.3.1"></times><ci id="S3.E8.m1.4.4.5.3.2.cmml" xref="S3.E8.m1.4.4.5.3.2">𝑜</ci><ci id="S3.E8.m1.4.4.5.3.3.cmml" xref="S3.E8.m1.4.4.5.3.3">𝑢</ci><ci id="S3.E8.m1.4.4.5.3.4.cmml" xref="S3.E8.m1.4.4.5.3.4">𝑡</ci></apply></apply><apply id="S3.E8.m1.4.4.3.cmml" xref="S3.E8.m1.4.4.3"><times id="S3.E8.m1.4.4.3.4.cmml" xref="S3.E8.m1.4.4.3.4"></times><ci id="S3.E8.m1.4.4.3.5a.cmml" xref="S3.E8.m1.4.4.3.5"><mtext id="S3.E8.m1.4.4.3.5.cmml" xref="S3.E8.m1.4.4.3.5">Attn</mtext></ci><vector id="S3.E8.m1.4.4.3.3.4.cmml" xref="S3.E8.m1.4.4.3.3.3"><apply id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.2">𝑄</ci><cn id="S3.E8.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.3">2</cn></apply><apply id="S3.E8.m1.3.3.2.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.3.3.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.2">𝐾</ci><cn id="S3.E8.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.E8.m1.3.3.2.2.2.2.3">2</cn></apply><apply id="S3.E8.m1.4.4.3.3.3.3.cmml" xref="S3.E8.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.3.3.3.3.1.cmml" xref="S3.E8.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.4.4.3.3.3.3.2.cmml" xref="S3.E8.m1.4.4.3.3.3.3.2">𝑉</ci><cn id="S3.E8.m1.4.4.3.3.3.3.3.cmml" type="integer" xref="S3.E8.m1.4.4.3.3.3.3.3">2</cn></apply></vector></apply></apply><apply id="S3.E8.m1.4.4c.cmml" xref="S3.E8.m1.4.4"><eq id="S3.E8.m1.4.4.7.cmml" xref="S3.E8.m1.4.4.7"></eq><share href="https://arxiv.org/html/2410.08612v1#S3.E8.m1.4.4.3.cmml" id="S3.E8.m1.4.4d.cmml" xref="S3.E8.m1.4.4"></share><apply id="S3.E8.m1.4.4.8.cmml" xref="S3.E8.m1.4.4.8"><ci id="S3.E8.m1.4.4.8.1.cmml" xref="S3.E8.m1.4.4.8.1">⋅</ci><apply id="S3.E8.m1.4.4.8.2.cmml" xref="S3.E8.m1.4.4.8.2"><times id="S3.E8.m1.4.4.8.2.1.cmml" xref="S3.E8.m1.4.4.8.2.1"></times><ci id="S3.E8.m1.4.4.8.2.2a.cmml" xref="S3.E8.m1.4.4.8.2.2"><mtext id="S3.E8.m1.4.4.8.2.2.cmml" xref="S3.E8.m1.4.4.8.2.2">softmax</mtext></ci><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.4.4.8.2.3.2"><divide id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.4.4.8.2.3.2"></divide><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><times id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2.1"></times><apply id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.2.2.2">𝑄</ci><cn id="S3.E8.m1.1.1.2.2.3.cmml" type="integer" xref="S3.E8.m1.1.1.2.2.3">2</cn></apply><apply id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.2.3">superscript</csymbol><apply id="S3.E8.m1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.3.2.1.cmml" xref="S3.E8.m1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.2.3.2.2.cmml" xref="S3.E8.m1.1.1.2.3.2.2">𝐾</ci><cn id="S3.E8.m1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E8.m1.1.1.2.3.2.3">2</cn></apply><ci id="S3.E8.m1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><root id="S3.E8.m1.1.1.3a.cmml" xref="S3.E8.m1.1.1.3"></root><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑑</ci></apply></apply></apply><apply id="S3.E8.m1.4.4.8.3.cmml" xref="S3.E8.m1.4.4.8.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.8.3.1.cmml" xref="S3.E8.m1.4.4.8.3">subscript</csymbol><ci id="S3.E8.m1.4.4.8.3.2.cmml" xref="S3.E8.m1.4.4.8.3.2">𝑉</ci><cn id="S3.E8.m1.4.4.8.3.3.cmml" type="integer" xref="S3.E8.m1.4.4.8.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\phi^{out}=\text{Attn}(Q_{2},K_{2},V_{2})=\text{softmax}\left(\frac{Q_{2}K_{2}%
^{T}}{\sqrt{d}}\right)\cdot V_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4d">italic_ϕ start_POSTSUPERSCRIPT italic_o italic_u italic_t end_POSTSUPERSCRIPT = Attn ( italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) = softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) ⋅ italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">where <math alttext="\phi^{out}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msup id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">ϕ</mi><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">o</mi><mo id="S3.SS2.p4.1.m1.1.1.3.1" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">u</mi><mo id="S3.SS2.p4.1.m1.1.1.3.1a" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.1.1.3.4" xref="S3.SS2.p4.1.m1.1.1.3.4.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">italic-ϕ</ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><times id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1"></times><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">𝑜</ci><ci id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS2.p4.1.m1.1.1.3.4.cmml" xref="S3.SS2.p4.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\phi^{out}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_ϕ start_POSTSUPERSCRIPT italic_o italic_u italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> represents the output of the cross-attention layer, combining the image features with the text features. This interaction between the image and text features enables the generation of images conditioned on the provided text prompt.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.4">To train a diffusion model from scratch, enormous computation and a vast amount of training data are required. To mitigate the challenges of data scarcity and computation, we adopted LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib14" title="">14</a>]</cite> for fine-tuning. LoRA (Low-Rank Adaptation) applies to text-to-image tasks by efficiently fine-tuning models. Mathematically, LoRA updates the model’s weight matrices by adding a low-rank decomposition <math alttext="\Delta W=A\cdot B" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mrow id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2.2" mathvariant="normal" xref="S3.SS2.p5.1.m1.1.1.2.2.cmml">Δ</mi><mo id="S3.SS2.p5.1.m1.1.1.2.1" xref="S3.SS2.p5.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.2.3" xref="S3.SS2.p5.1.m1.1.1.2.3.cmml">W</mi></mrow><mo id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.2.cmml">A</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⋅</mo><mi id="S3.SS2.p5.1.m1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><eq id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1"></eq><apply id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2"><times id="S3.SS2.p5.1.m1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.2.1"></times><ci id="S3.SS2.p5.1.m1.1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2.2">Δ</ci><ci id="S3.SS2.p5.1.m1.1.1.2.3.cmml" xref="S3.SS2.p5.1.m1.1.1.2.3">𝑊</ci></apply><apply id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><ci id="S3.SS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.1">⋅</ci><ci id="S3.SS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2">𝐴</ci><ci id="S3.SS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\Delta W=A\cdot B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">roman_Δ italic_W = italic_A ⋅ italic_B</annotation></semantics></math>, where <math alttext="A\in\mathbb{R}^{m\times r}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">A</mi><mo id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.3.2" xref="S3.SS2.p5.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S3.SS2.p5.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p5.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><in id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1"></in><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝐴</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3"><times id="S3.SS2.p5.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2">𝑚</ci><ci id="S3.SS2.p5.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">A\in\mathbb{R}^{m\times r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="B\in\mathbb{R}^{r\times n}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><mrow id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">B</mi><mo id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.3.2" xref="S3.SS2.p5.3.m3.1.1.3.3.2.cmml">r</mi><mo id="S3.SS2.p5.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p5.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><in id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></in><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝐵</ci><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3"><times id="S3.SS2.p5.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.2">𝑟</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">B\in\mathbb{R}^{r\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> are low-rank matrices, where <math alttext="r" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><mi id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><ci id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">italic_r</annotation></semantics></math> is the rank.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">LoRA updates the query, key, and value matrices in the following manner:</p>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{2}^{\prime}=Q_{2}+\alpha\cdot\Delta W_{Q_{2}}" class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><msubsup id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.2.2.2" xref="S3.E9.m1.1.1.2.2.2.cmml">Q</mi><mn id="S3.E9.m1.1.1.2.2.3" xref="S3.E9.m1.1.1.2.2.3.cmml">2</mn><mo id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><msub id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.3.2.2" xref="S3.E9.m1.1.1.3.2.2.cmml">Q</mi><mn id="S3.E9.m1.1.1.3.2.3" xref="S3.E9.m1.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.E9.m1.1.1.3.1" xref="S3.E9.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml"><mrow id="S3.E9.m1.1.1.3.3.2" xref="S3.E9.m1.1.1.3.3.2.cmml"><mi id="S3.E9.m1.1.1.3.3.2.2" xref="S3.E9.m1.1.1.3.3.2.2.cmml">α</mi><mo id="S3.E9.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.1.1.3.3.2.1.cmml">⋅</mo><mi id="S3.E9.m1.1.1.3.3.2.3" mathvariant="normal" xref="S3.E9.m1.1.1.3.3.2.3.cmml">Δ</mi></mrow><mo id="S3.E9.m1.1.1.3.3.1" xref="S3.E9.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E9.m1.1.1.3.3.3" xref="S3.E9.m1.1.1.3.3.3.cmml"><mi id="S3.E9.m1.1.1.3.3.3.2" xref="S3.E9.m1.1.1.3.3.3.2.cmml">W</mi><msub id="S3.E9.m1.1.1.3.3.3.3" xref="S3.E9.m1.1.1.3.3.3.3.cmml"><mi id="S3.E9.m1.1.1.3.3.3.3.2" xref="S3.E9.m1.1.1.3.3.3.3.2.cmml">Q</mi><mn id="S3.E9.m1.1.1.3.3.3.3.3" xref="S3.E9.m1.1.1.3.3.3.3.3.cmml">2</mn></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"></eq><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.2.1.cmml" xref="S3.E9.m1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.1.2.2.2.cmml" xref="S3.E9.m1.1.1.2.2.2">𝑄</ci><cn id="S3.E9.m1.1.1.2.2.3.cmml" type="integer" xref="S3.E9.m1.1.1.2.2.3">2</cn></apply><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">′</ci></apply><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><plus id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3.1"></plus><apply id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.3.2.2">𝑄</ci><cn id="S3.E9.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E9.m1.1.1.3.2.3">2</cn></apply><apply id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3"><times id="S3.E9.m1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.1"></times><apply id="S3.E9.m1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.2"><ci id="S3.E9.m1.1.1.3.3.2.1.cmml" xref="S3.E9.m1.1.1.3.3.2.1">⋅</ci><ci id="S3.E9.m1.1.1.3.3.2.2.cmml" xref="S3.E9.m1.1.1.3.3.2.2">𝛼</ci><ci id="S3.E9.m1.1.1.3.3.2.3.cmml" xref="S3.E9.m1.1.1.3.3.2.3">Δ</ci></apply><apply id="S3.E9.m1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.3.2">𝑊</ci><apply id="S3.E9.m1.1.1.3.3.3.3.cmml" xref="S3.E9.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.3.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.3.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.3.3.2">𝑄</ci><cn id="S3.E9.m1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">Q_{2}^{\prime}=Q_{2}+\alpha\cdot\Delta W_{Q_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_α ⋅ roman_Δ italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K_{2}^{\prime}=K_{2}+\alpha\cdot\Delta W_{K_{2}}" class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.2.2.2" xref="S3.E10.m1.1.1.2.2.2.cmml">K</mi><mn id="S3.E10.m1.1.1.2.2.3" xref="S3.E10.m1.1.1.2.2.3.cmml">2</mn><mo id="S3.E10.m1.1.1.2.3" xref="S3.E10.m1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><msub id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml"><mi id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml">K</mi><mn id="S3.E10.m1.1.1.3.2.3" xref="S3.E10.m1.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.E10.m1.1.1.3.1" xref="S3.E10.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml"><mrow id="S3.E10.m1.1.1.3.3.2" xref="S3.E10.m1.1.1.3.3.2.cmml"><mi id="S3.E10.m1.1.1.3.3.2.2" xref="S3.E10.m1.1.1.3.3.2.2.cmml">α</mi><mo id="S3.E10.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E10.m1.1.1.3.3.2.1.cmml">⋅</mo><mi id="S3.E10.m1.1.1.3.3.2.3" mathvariant="normal" xref="S3.E10.m1.1.1.3.3.2.3.cmml">Δ</mi></mrow><mo id="S3.E10.m1.1.1.3.3.1" xref="S3.E10.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E10.m1.1.1.3.3.3" xref="S3.E10.m1.1.1.3.3.3.cmml"><mi id="S3.E10.m1.1.1.3.3.3.2" xref="S3.E10.m1.1.1.3.3.3.2.cmml">W</mi><msub id="S3.E10.m1.1.1.3.3.3.3" xref="S3.E10.m1.1.1.3.3.3.3.cmml"><mi id="S3.E10.m1.1.1.3.3.3.3.2" xref="S3.E10.m1.1.1.3.3.3.3.2.cmml">K</mi><mn id="S3.E10.m1.1.1.3.3.3.3.3" xref="S3.E10.m1.1.1.3.3.3.3.3.cmml">2</mn></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"></eq><apply id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.2.2.2">𝐾</ci><cn id="S3.E10.m1.1.1.2.2.3.cmml" type="integer" xref="S3.E10.m1.1.1.2.2.3">2</cn></apply><ci id="S3.E10.m1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.2.3">′</ci></apply><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><plus id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1"></plus><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2">𝐾</ci><cn id="S3.E10.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E10.m1.1.1.3.2.3">2</cn></apply><apply id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3"><times id="S3.E10.m1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.3.3.1"></times><apply id="S3.E10.m1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.3.3.2"><ci id="S3.E10.m1.1.1.3.3.2.1.cmml" xref="S3.E10.m1.1.1.3.3.2.1">⋅</ci><ci id="S3.E10.m1.1.1.3.3.2.2.cmml" xref="S3.E10.m1.1.1.3.3.2.2">𝛼</ci><ci id="S3.E10.m1.1.1.3.3.2.3.cmml" xref="S3.E10.m1.1.1.3.3.2.3">Δ</ci></apply><apply id="S3.E10.m1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.3.3.1.cmml" xref="S3.E10.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E10.m1.1.1.3.3.3.2.cmml" xref="S3.E10.m1.1.1.3.3.3.2">𝑊</ci><apply id="S3.E10.m1.1.1.3.3.3.3.cmml" xref="S3.E10.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.3.3.3.1.cmml" xref="S3.E10.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E10.m1.1.1.3.3.3.3.2.cmml" xref="S3.E10.m1.1.1.3.3.3.3.2">𝐾</ci><cn id="S3.E10.m1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E10.m1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">K_{2}^{\prime}=K_{2}+\alpha\cdot\Delta W_{K_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_α ⋅ roman_Δ italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="V_{2}^{\prime}=V_{2}+\alpha\cdot\Delta W_{V_{2}}" class="ltx_Math" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><msubsup id="S3.E11.m1.1.1.2" xref="S3.E11.m1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.2.2.2" xref="S3.E11.m1.1.1.2.2.2.cmml">V</mi><mn id="S3.E11.m1.1.1.2.2.3" xref="S3.E11.m1.1.1.2.2.3.cmml">2</mn><mo id="S3.E11.m1.1.1.2.3" xref="S3.E11.m1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml">=</mo><mrow id="S3.E11.m1.1.1.3" xref="S3.E11.m1.1.1.3.cmml"><msub id="S3.E11.m1.1.1.3.2" xref="S3.E11.m1.1.1.3.2.cmml"><mi id="S3.E11.m1.1.1.3.2.2" xref="S3.E11.m1.1.1.3.2.2.cmml">V</mi><mn id="S3.E11.m1.1.1.3.2.3" xref="S3.E11.m1.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.E11.m1.1.1.3.1" xref="S3.E11.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E11.m1.1.1.3.3" xref="S3.E11.m1.1.1.3.3.cmml"><mrow id="S3.E11.m1.1.1.3.3.2" xref="S3.E11.m1.1.1.3.3.2.cmml"><mi id="S3.E11.m1.1.1.3.3.2.2" xref="S3.E11.m1.1.1.3.3.2.2.cmml">α</mi><mo id="S3.E11.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E11.m1.1.1.3.3.2.1.cmml">⋅</mo><mi id="S3.E11.m1.1.1.3.3.2.3" mathvariant="normal" xref="S3.E11.m1.1.1.3.3.2.3.cmml">Δ</mi></mrow><mo id="S3.E11.m1.1.1.3.3.1" xref="S3.E11.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E11.m1.1.1.3.3.3" xref="S3.E11.m1.1.1.3.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.3.2" xref="S3.E11.m1.1.1.3.3.3.2.cmml">W</mi><msub id="S3.E11.m1.1.1.3.3.3.3" xref="S3.E11.m1.1.1.3.3.3.3.cmml"><mi id="S3.E11.m1.1.1.3.3.3.3.2" xref="S3.E11.m1.1.1.3.3.3.3.2.cmml">V</mi><mn id="S3.E11.m1.1.1.3.3.3.3.3" xref="S3.E11.m1.1.1.3.3.3.3.3.cmml">2</mn></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><eq id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"></eq><apply id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.2">superscript</csymbol><apply id="S3.E11.m1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.2.2.1.cmml" xref="S3.E11.m1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.1.2.2.2.cmml" xref="S3.E11.m1.1.1.2.2.2">𝑉</ci><cn id="S3.E11.m1.1.1.2.2.3.cmml" type="integer" xref="S3.E11.m1.1.1.2.2.3">2</cn></apply><ci id="S3.E11.m1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.2.3">′</ci></apply><apply id="S3.E11.m1.1.1.3.cmml" xref="S3.E11.m1.1.1.3"><plus id="S3.E11.m1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.3.1"></plus><apply id="S3.E11.m1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.2.1.cmml" xref="S3.E11.m1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.1.1.3.2.2.cmml" xref="S3.E11.m1.1.1.3.2.2">𝑉</ci><cn id="S3.E11.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E11.m1.1.1.3.2.3">2</cn></apply><apply id="S3.E11.m1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.3.3"><times id="S3.E11.m1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3.1"></times><apply id="S3.E11.m1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.2"><ci id="S3.E11.m1.1.1.3.3.2.1.cmml" xref="S3.E11.m1.1.1.3.3.2.1">⋅</ci><ci id="S3.E11.m1.1.1.3.3.2.2.cmml" xref="S3.E11.m1.1.1.3.3.2.2">𝛼</ci><ci id="S3.E11.m1.1.1.3.3.2.3.cmml" xref="S3.E11.m1.1.1.3.3.2.3">Δ</ci></apply><apply id="S3.E11.m1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.3.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.3.2">𝑊</ci><apply id="S3.E11.m1.1.1.3.3.3.3.cmml" xref="S3.E11.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.3.3.3.3.1.cmml" xref="S3.E11.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.3.3.3.3.2.cmml" xref="S3.E11.m1.1.1.3.3.3.3.2">𝑉</ci><cn id="S3.E11.m1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E11.m1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">V_{2}^{\prime}=V_{2}+\alpha\cdot\Delta W_{V_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_α ⋅ roman_Δ italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p10">
<p class="ltx_p" id="S3.SS2.p10.6">where, <math alttext="Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p10.1.m1.3"><semantics id="S3.SS2.p10.1.m1.3a"><mrow id="S3.SS2.p10.1.m1.3.3.3" xref="S3.SS2.p10.1.m1.3.3.4.cmml"><msubsup id="S3.SS2.p10.1.m1.1.1.1.1" xref="S3.SS2.p10.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.p10.1.m1.1.1.1.1.2.2" xref="S3.SS2.p10.1.m1.1.1.1.1.2.2.cmml">Q</mi><mn id="S3.SS2.p10.1.m1.1.1.1.1.2.3" xref="S3.SS2.p10.1.m1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.SS2.p10.1.m1.1.1.1.1.3" xref="S3.SS2.p10.1.m1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS2.p10.1.m1.3.3.3.4" xref="S3.SS2.p10.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS2.p10.1.m1.2.2.2.2" xref="S3.SS2.p10.1.m1.2.2.2.2.cmml"><mi id="S3.SS2.p10.1.m1.2.2.2.2.2.2" xref="S3.SS2.p10.1.m1.2.2.2.2.2.2.cmml">K</mi><mn id="S3.SS2.p10.1.m1.2.2.2.2.2.3" xref="S3.SS2.p10.1.m1.2.2.2.2.2.3.cmml">2</mn><mo id="S3.SS2.p10.1.m1.2.2.2.2.3" xref="S3.SS2.p10.1.m1.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.p10.1.m1.3.3.3.5" xref="S3.SS2.p10.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS2.p10.1.m1.3.3.3.3" xref="S3.SS2.p10.1.m1.3.3.3.3.cmml"><mi id="S3.SS2.p10.1.m1.3.3.3.3.2.2" xref="S3.SS2.p10.1.m1.3.3.3.3.2.2.cmml">V</mi><mn id="S3.SS2.p10.1.m1.3.3.3.3.2.3" xref="S3.SS2.p10.1.m1.3.3.3.3.2.3.cmml">2</mn><mo id="S3.SS2.p10.1.m1.3.3.3.3.3" xref="S3.SS2.p10.1.m1.3.3.3.3.3.cmml">′</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.3b"><list id="S3.SS2.p10.1.m1.3.3.4.cmml" xref="S3.SS2.p10.1.m1.3.3.3"><apply id="S3.SS2.p10.1.m1.1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p10.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p10.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1.2.2">𝑄</ci><cn id="S3.SS2.p10.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p10.1.m1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS2.p10.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p10.1.m1.1.1.1.1.3">′</ci></apply><apply id="S3.SS2.p10.1.m1.2.2.2.2.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p10.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p10.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2.2.2">𝐾</ci><cn id="S3.SS2.p10.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p10.1.m1.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.p10.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.p10.1.m1.2.2.2.2.3">′</ci></apply><apply id="S3.SS2.p10.1.m1.3.3.3.3.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.3.3.3.3.1.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3">superscript</csymbol><apply id="S3.SS2.p10.1.m1.3.3.3.3.2.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.3.3.3.3.2.1.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p10.1.m1.3.3.3.3.2.2.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3.2.2">𝑉</ci><cn id="S3.SS2.p10.1.m1.3.3.3.3.2.3.cmml" type="integer" xref="S3.SS2.p10.1.m1.3.3.3.3.2.3">2</cn></apply><ci id="S3.SS2.p10.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p10.1.m1.3.3.3.3.3">′</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.3c">Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.1.m1.3d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> represent the LoRA-enhanced <span class="ltx_text ltx_font_bold" id="S3.SS2.p10.6.1">queries</span>, <span class="ltx_text ltx_font_bold" id="S3.SS2.p10.6.2">keys</span>, and <span class="ltx_text ltx_font_bold" id="S3.SS2.p10.6.3">values</span>, where the original <math alttext="Q_{2}" class="ltx_Math" display="inline" id="S3.SS2.p10.2.m2.1"><semantics id="S3.SS2.p10.2.m2.1a"><msub id="S3.SS2.p10.2.m2.1.1" xref="S3.SS2.p10.2.m2.1.1.cmml"><mi id="S3.SS2.p10.2.m2.1.1.2" xref="S3.SS2.p10.2.m2.1.1.2.cmml">Q</mi><mn id="S3.SS2.p10.2.m2.1.1.3" xref="S3.SS2.p10.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m2.1b"><apply id="S3.SS2.p10.2.m2.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.2.m2.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p10.2.m2.1.1.2.cmml" xref="S3.SS2.p10.2.m2.1.1.2">𝑄</ci><cn id="S3.SS2.p10.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p10.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m2.1c">Q_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.2.m2.1d">italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS2.p10.3.m3.1"><semantics id="S3.SS2.p10.3.m3.1a"><msub id="S3.SS2.p10.3.m3.1.1" xref="S3.SS2.p10.3.m3.1.1.cmml"><mi id="S3.SS2.p10.3.m3.1.1.2" xref="S3.SS2.p10.3.m3.1.1.2.cmml">K</mi><mn id="S3.SS2.p10.3.m3.1.1.3" xref="S3.SS2.p10.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m3.1b"><apply id="S3.SS2.p10.3.m3.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.3.m3.1.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p10.3.m3.1.1.2.cmml" xref="S3.SS2.p10.3.m3.1.1.2">𝐾</ci><cn id="S3.SS2.p10.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p10.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m3.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.3.m3.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="V_{2}" class="ltx_Math" display="inline" id="S3.SS2.p10.4.m4.1"><semantics id="S3.SS2.p10.4.m4.1a"><msub id="S3.SS2.p10.4.m4.1.1" xref="S3.SS2.p10.4.m4.1.1.cmml"><mi id="S3.SS2.p10.4.m4.1.1.2" xref="S3.SS2.p10.4.m4.1.1.2.cmml">V</mi><mn id="S3.SS2.p10.4.m4.1.1.3" xref="S3.SS2.p10.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.4.m4.1b"><apply id="S3.SS2.p10.4.m4.1.1.cmml" xref="S3.SS2.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.4.m4.1.1.1.cmml" xref="S3.SS2.p10.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p10.4.m4.1.1.2.cmml" xref="S3.SS2.p10.4.m4.1.1.2">𝑉</ci><cn id="S3.SS2.p10.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p10.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.4.m4.1c">V_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.4.m4.1d">italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are adjusted by adding the LoRA updates <math alttext="\Delta W_{Q_{2}},\Delta W_{K_{2}},\Delta W_{V_{2}}" class="ltx_Math" display="inline" id="S3.SS2.p10.5.m5.3"><semantics id="S3.SS2.p10.5.m5.3a"><mrow id="S3.SS2.p10.5.m5.3.3.3" xref="S3.SS2.p10.5.m5.3.3.4.cmml"><mrow id="S3.SS2.p10.5.m5.1.1.1.1" xref="S3.SS2.p10.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.p10.5.m5.1.1.1.1.2" mathvariant="normal" xref="S3.SS2.p10.5.m5.1.1.1.1.2.cmml">Δ</mi><mo id="S3.SS2.p10.5.m5.1.1.1.1.1" xref="S3.SS2.p10.5.m5.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p10.5.m5.1.1.1.1.3" xref="S3.SS2.p10.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS2.p10.5.m5.1.1.1.1.3.2" xref="S3.SS2.p10.5.m5.1.1.1.1.3.2.cmml">W</mi><msub id="S3.SS2.p10.5.m5.1.1.1.1.3.3" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3.cmml"><mi id="S3.SS2.p10.5.m5.1.1.1.1.3.3.2" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3.2.cmml">Q</mi><mn id="S3.SS2.p10.5.m5.1.1.1.1.3.3.3" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.SS2.p10.5.m5.3.3.3.4" xref="S3.SS2.p10.5.m5.3.3.4.cmml">,</mo><mrow id="S3.SS2.p10.5.m5.2.2.2.2" xref="S3.SS2.p10.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.p10.5.m5.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.p10.5.m5.2.2.2.2.2.cmml">Δ</mi><mo id="S3.SS2.p10.5.m5.2.2.2.2.1" xref="S3.SS2.p10.5.m5.2.2.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p10.5.m5.2.2.2.2.3" xref="S3.SS2.p10.5.m5.2.2.2.2.3.cmml"><mi id="S3.SS2.p10.5.m5.2.2.2.2.3.2" xref="S3.SS2.p10.5.m5.2.2.2.2.3.2.cmml">W</mi><msub id="S3.SS2.p10.5.m5.2.2.2.2.3.3" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3.cmml"><mi id="S3.SS2.p10.5.m5.2.2.2.2.3.3.2" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3.2.cmml">K</mi><mn id="S3.SS2.p10.5.m5.2.2.2.2.3.3.3" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.SS2.p10.5.m5.3.3.3.5" xref="S3.SS2.p10.5.m5.3.3.4.cmml">,</mo><mrow id="S3.SS2.p10.5.m5.3.3.3.3" xref="S3.SS2.p10.5.m5.3.3.3.3.cmml"><mi id="S3.SS2.p10.5.m5.3.3.3.3.2" mathvariant="normal" xref="S3.SS2.p10.5.m5.3.3.3.3.2.cmml">Δ</mi><mo id="S3.SS2.p10.5.m5.3.3.3.3.1" xref="S3.SS2.p10.5.m5.3.3.3.3.1.cmml">⁢</mo><msub id="S3.SS2.p10.5.m5.3.3.3.3.3" xref="S3.SS2.p10.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS2.p10.5.m5.3.3.3.3.3.2" xref="S3.SS2.p10.5.m5.3.3.3.3.3.2.cmml">W</mi><msub id="S3.SS2.p10.5.m5.3.3.3.3.3.3" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3.cmml"><mi id="S3.SS2.p10.5.m5.3.3.3.3.3.3.2" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3.2.cmml">V</mi><mn id="S3.SS2.p10.5.m5.3.3.3.3.3.3.3" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3.3.cmml">2</mn></msub></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.5.m5.3b"><list id="S3.SS2.p10.5.m5.3.3.4.cmml" xref="S3.SS2.p10.5.m5.3.3.3"><apply id="S3.SS2.p10.5.m5.1.1.1.1.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1"><times id="S3.SS2.p10.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.1"></times><ci id="S3.SS2.p10.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.2">Δ</ci><apply id="S3.SS2.p10.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3.2">𝑊</ci><apply id="S3.SS2.p10.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.1.1.1.1.3.3.2.cmml" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3.2">𝑄</ci><cn id="S3.SS2.p10.5.m5.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p10.5.m5.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S3.SS2.p10.5.m5.2.2.2.2.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2"><times id="S3.SS2.p10.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.1"></times><ci id="S3.SS2.p10.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.2">Δ</ci><apply id="S3.SS2.p10.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.2.2.2.2.3.2.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3.2">𝑊</ci><apply id="S3.SS2.p10.5.m5.2.2.2.2.3.3.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.2.2.2.2.3.3.1.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.2.2.2.2.3.3.2.cmml" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3.2">𝐾</ci><cn id="S3.SS2.p10.5.m5.2.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS2.p10.5.m5.2.2.2.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.SS2.p10.5.m5.3.3.3.3.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3"><times id="S3.SS2.p10.5.m5.3.3.3.3.1.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.1"></times><ci id="S3.SS2.p10.5.m5.3.3.3.3.2.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.2">Δ</ci><apply id="S3.SS2.p10.5.m5.3.3.3.3.3.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3.2">𝑊</ci><apply id="S3.SS2.p10.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.3.3.3.3.3.3.1.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p10.5.m5.3.3.3.3.3.3.2.cmml" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3.2">𝑉</ci><cn id="S3.SS2.p10.5.m5.3.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.p10.5.m5.3.3.3.3.3.3.3">2</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.5.m5.3c">\Delta W_{Q_{2}},\Delta W_{K_{2}},\Delta W_{V_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.5.m5.3d">roman_Δ italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , roman_Δ italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , roman_Δ italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, scaled by a factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.p10.6.m6.1"><semantics id="S3.SS2.p10.6.m6.1a"><mi id="S3.SS2.p10.6.m6.1.1" xref="S3.SS2.p10.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.6.m6.1b"><ci id="S3.SS2.p10.6.m6.1.1.cmml" xref="S3.SS2.p10.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.6.m6.1d">italic_α</annotation></semantics></math>. The enhanced attention mechanism with LoRA is given by:</p>
</div>
<div class="ltx_para" id="S3.SS2.p11">
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi^{c}_{out}=\text{Attn}(Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime})=\text%
{softmax}\left(\frac{Q_{2}^{\prime}\cdot K_{2}^{\prime T}}{\sqrt{d_{2}}}\right%
)\cdot V_{2}^{\prime}" class="ltx_Math" display="block" id="S3.E12.m1.5"><semantics id="S3.E12.m1.5a"><mrow id="S3.E12.m1.5.5" xref="S3.E12.m1.5.5.cmml"><msubsup id="S3.E12.m1.5.5.5" xref="S3.E12.m1.5.5.5.cmml"><mi id="S3.E12.m1.5.5.5.2.2" xref="S3.E12.m1.5.5.5.2.2.cmml">ϕ</mi><mrow id="S3.E12.m1.5.5.5.3" xref="S3.E12.m1.5.5.5.3.cmml"><mi id="S3.E12.m1.5.5.5.3.2" xref="S3.E12.m1.5.5.5.3.2.cmml">o</mi><mo id="S3.E12.m1.5.5.5.3.1" xref="S3.E12.m1.5.5.5.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.5.3.3" xref="S3.E12.m1.5.5.5.3.3.cmml">u</mi><mo id="S3.E12.m1.5.5.5.3.1a" xref="S3.E12.m1.5.5.5.3.1.cmml">⁢</mo><mi id="S3.E12.m1.5.5.5.3.4" xref="S3.E12.m1.5.5.5.3.4.cmml">t</mi></mrow><mi id="S3.E12.m1.5.5.5.2.3" xref="S3.E12.m1.5.5.5.2.3.cmml">c</mi></msubsup><mo id="S3.E12.m1.5.5.6" xref="S3.E12.m1.5.5.6.cmml">=</mo><mrow id="S3.E12.m1.5.5.3" xref="S3.E12.m1.5.5.3.cmml"><mtext id="S3.E12.m1.5.5.3.5" xref="S3.E12.m1.5.5.3.5a.cmml">Attn</mtext><mo id="S3.E12.m1.5.5.3.4" xref="S3.E12.m1.5.5.3.4.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.3.3.3" xref="S3.E12.m1.5.5.3.3.4.cmml"><mo id="S3.E12.m1.5.5.3.3.3.4" stretchy="false" xref="S3.E12.m1.5.5.3.3.4.cmml">(</mo><msubsup id="S3.E12.m1.3.3.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.1.1.2.2.cmml">Q</mi><mn id="S3.E12.m1.3.3.1.1.1.1.2.3" xref="S3.E12.m1.3.3.1.1.1.1.2.3.cmml">2</mn><mo id="S3.E12.m1.3.3.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.5.5.3.3.3.5" xref="S3.E12.m1.5.5.3.3.4.cmml">,</mo><msubsup id="S3.E12.m1.4.4.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.2.cmml"><mi id="S3.E12.m1.4.4.2.2.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.2.2.2.cmml">K</mi><mn id="S3.E12.m1.4.4.2.2.2.2.2.3" xref="S3.E12.m1.4.4.2.2.2.2.2.3.cmml">2</mn><mo id="S3.E12.m1.4.4.2.2.2.2.3" xref="S3.E12.m1.4.4.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.5.5.3.3.3.6" xref="S3.E12.m1.5.5.3.3.4.cmml">,</mo><msubsup id="S3.E12.m1.5.5.3.3.3.3" xref="S3.E12.m1.5.5.3.3.3.3.cmml"><mi id="S3.E12.m1.5.5.3.3.3.3.2.2" xref="S3.E12.m1.5.5.3.3.3.3.2.2.cmml">V</mi><mn id="S3.E12.m1.5.5.3.3.3.3.2.3" xref="S3.E12.m1.5.5.3.3.3.3.2.3.cmml">2</mn><mo id="S3.E12.m1.5.5.3.3.3.3.3" xref="S3.E12.m1.5.5.3.3.3.3.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.5.5.3.3.3.7" stretchy="false" xref="S3.E12.m1.5.5.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.7" xref="S3.E12.m1.5.5.7.cmml">=</mo><mrow id="S3.E12.m1.5.5.8" xref="S3.E12.m1.5.5.8.cmml"><mrow id="S3.E12.m1.5.5.8.2" xref="S3.E12.m1.5.5.8.2.cmml"><mtext id="S3.E12.m1.5.5.8.2.2" xref="S3.E12.m1.5.5.8.2.2a.cmml">softmax</mtext><mo id="S3.E12.m1.5.5.8.2.1" xref="S3.E12.m1.5.5.8.2.1.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.8.2.3.2" xref="S3.E12.m1.2.2.cmml"><mo id="S3.E12.m1.5.5.8.2.3.2.1" xref="S3.E12.m1.2.2.cmml">(</mo><mfrac id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml"><mrow id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml"><msubsup id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.4.cmml"><mi id="S3.E12.m1.2.2.2.4.2.2" xref="S3.E12.m1.2.2.2.4.2.2.cmml">Q</mi><mn id="S3.E12.m1.2.2.2.4.2.3" xref="S3.E12.m1.2.2.2.4.2.3.cmml">2</mn><mo id="S3.E12.m1.2.2.2.4.3" xref="S3.E12.m1.2.2.2.4.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.2.2.2.3" lspace="0.222em" rspace="0.222em" xref="S3.E12.m1.2.2.2.3.cmml">⋅</mo><msubsup id="S3.E12.m1.2.2.2.5" xref="S3.E12.m1.2.2.2.5.cmml"><mi id="S3.E12.m1.2.2.2.5.2.2" xref="S3.E12.m1.2.2.2.5.2.2.cmml">K</mi><mn id="S3.E12.m1.2.2.2.5.2.3" xref="S3.E12.m1.2.2.2.5.2.3.cmml">2</mn><mrow id="S3.E12.m1.2.2.2.2.2.2" xref="S3.E12.m1.2.2.2.2.2.3.cmml"><mo id="S3.E12.m1.2.2.2.2.2.2.1" mathsize="142%" xref="S3.E12.m1.2.2.2.2.2.2.1.cmml">′</mo><mo id="S3.E12.m1.2.2.2.2.2.2.2" lspace="0em" xref="S3.E12.m1.2.2.2.2.2.3.cmml">⁣</mo><mi id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml">T</mi></mrow></msubsup></mrow><msqrt id="S3.E12.m1.2.2.4" xref="S3.E12.m1.2.2.4.cmml"><msub id="S3.E12.m1.2.2.4.2" xref="S3.E12.m1.2.2.4.2.cmml"><mi id="S3.E12.m1.2.2.4.2.2" xref="S3.E12.m1.2.2.4.2.2.cmml">d</mi><mn id="S3.E12.m1.2.2.4.2.3" xref="S3.E12.m1.2.2.4.2.3.cmml">2</mn></msub></msqrt></mfrac><mo id="S3.E12.m1.5.5.8.2.3.2.2" rspace="0.055em" xref="S3.E12.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.8.1" rspace="0.222em" xref="S3.E12.m1.5.5.8.1.cmml">⋅</mo><msubsup id="S3.E12.m1.5.5.8.3" xref="S3.E12.m1.5.5.8.3.cmml"><mi id="S3.E12.m1.5.5.8.3.2.2" xref="S3.E12.m1.5.5.8.3.2.2.cmml">V</mi><mn id="S3.E12.m1.5.5.8.3.2.3" xref="S3.E12.m1.5.5.8.3.2.3.cmml">2</mn><mo id="S3.E12.m1.5.5.8.3.3" xref="S3.E12.m1.5.5.8.3.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.5b"><apply id="S3.E12.m1.5.5.cmml" xref="S3.E12.m1.5.5"><and id="S3.E12.m1.5.5a.cmml" xref="S3.E12.m1.5.5"></and><apply id="S3.E12.m1.5.5b.cmml" xref="S3.E12.m1.5.5"><eq id="S3.E12.m1.5.5.6.cmml" xref="S3.E12.m1.5.5.6"></eq><apply id="S3.E12.m1.5.5.5.cmml" xref="S3.E12.m1.5.5.5"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.1.cmml" xref="S3.E12.m1.5.5.5">subscript</csymbol><apply id="S3.E12.m1.5.5.5.2.cmml" xref="S3.E12.m1.5.5.5"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.2.1.cmml" xref="S3.E12.m1.5.5.5">superscript</csymbol><ci id="S3.E12.m1.5.5.5.2.2.cmml" xref="S3.E12.m1.5.5.5.2.2">italic-ϕ</ci><ci id="S3.E12.m1.5.5.5.2.3.cmml" xref="S3.E12.m1.5.5.5.2.3">𝑐</ci></apply><apply id="S3.E12.m1.5.5.5.3.cmml" xref="S3.E12.m1.5.5.5.3"><times id="S3.E12.m1.5.5.5.3.1.cmml" xref="S3.E12.m1.5.5.5.3.1"></times><ci id="S3.E12.m1.5.5.5.3.2.cmml" xref="S3.E12.m1.5.5.5.3.2">𝑜</ci><ci id="S3.E12.m1.5.5.5.3.3.cmml" xref="S3.E12.m1.5.5.5.3.3">𝑢</ci><ci id="S3.E12.m1.5.5.5.3.4.cmml" xref="S3.E12.m1.5.5.5.3.4">𝑡</ci></apply></apply><apply id="S3.E12.m1.5.5.3.cmml" xref="S3.E12.m1.5.5.3"><times id="S3.E12.m1.5.5.3.4.cmml" xref="S3.E12.m1.5.5.3.4"></times><ci id="S3.E12.m1.5.5.3.5a.cmml" xref="S3.E12.m1.5.5.3.5"><mtext id="S3.E12.m1.5.5.3.5.cmml" xref="S3.E12.m1.5.5.3.5">Attn</mtext></ci><vector id="S3.E12.m1.5.5.3.3.4.cmml" xref="S3.E12.m1.5.5.3.3.3"><apply id="S3.E12.m1.3.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.2.2">𝑄</ci><cn id="S3.E12.m1.3.3.1.1.1.1.2.3.cmml" type="integer" xref="S3.E12.m1.3.3.1.1.1.1.2.3">2</cn></apply><ci id="S3.E12.m1.3.3.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3">′</ci></apply><apply id="S3.E12.m1.4.4.2.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2">superscript</csymbol><apply id="S3.E12.m1.4.4.2.2.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2.2.2">𝐾</ci><cn id="S3.E12.m1.4.4.2.2.2.2.2.3.cmml" type="integer" xref="S3.E12.m1.4.4.2.2.2.2.2.3">2</cn></apply><ci id="S3.E12.m1.4.4.2.2.2.2.3.cmml" xref="S3.E12.m1.4.4.2.2.2.2.3">′</ci></apply><apply id="S3.E12.m1.5.5.3.3.3.3.cmml" xref="S3.E12.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.3.3.3.3.1.cmml" xref="S3.E12.m1.5.5.3.3.3.3">superscript</csymbol><apply id="S3.E12.m1.5.5.3.3.3.3.2.cmml" xref="S3.E12.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.3.3.3.3.2.1.cmml" xref="S3.E12.m1.5.5.3.3.3.3">subscript</csymbol><ci id="S3.E12.m1.5.5.3.3.3.3.2.2.cmml" xref="S3.E12.m1.5.5.3.3.3.3.2.2">𝑉</ci><cn id="S3.E12.m1.5.5.3.3.3.3.2.3.cmml" type="integer" xref="S3.E12.m1.5.5.3.3.3.3.2.3">2</cn></apply><ci id="S3.E12.m1.5.5.3.3.3.3.3.cmml" xref="S3.E12.m1.5.5.3.3.3.3.3">′</ci></apply></vector></apply></apply><apply id="S3.E12.m1.5.5c.cmml" xref="S3.E12.m1.5.5"><eq id="S3.E12.m1.5.5.7.cmml" xref="S3.E12.m1.5.5.7"></eq><share href="https://arxiv.org/html/2410.08612v1#S3.E12.m1.5.5.3.cmml" id="S3.E12.m1.5.5d.cmml" xref="S3.E12.m1.5.5"></share><apply id="S3.E12.m1.5.5.8.cmml" xref="S3.E12.m1.5.5.8"><ci id="S3.E12.m1.5.5.8.1.cmml" xref="S3.E12.m1.5.5.8.1">⋅</ci><apply id="S3.E12.m1.5.5.8.2.cmml" xref="S3.E12.m1.5.5.8.2"><times id="S3.E12.m1.5.5.8.2.1.cmml" xref="S3.E12.m1.5.5.8.2.1"></times><ci id="S3.E12.m1.5.5.8.2.2a.cmml" xref="S3.E12.m1.5.5.8.2.2"><mtext id="S3.E12.m1.5.5.8.2.2.cmml" xref="S3.E12.m1.5.5.8.2.2">softmax</mtext></ci><apply id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.5.5.8.2.3.2"><divide id="S3.E12.m1.2.2.3.cmml" xref="S3.E12.m1.5.5.8.2.3.2"></divide><apply id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"><ci id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.3">⋅</ci><apply id="S3.E12.m1.2.2.2.4.cmml" xref="S3.E12.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.4.1.cmml" xref="S3.E12.m1.2.2.2.4">superscript</csymbol><apply id="S3.E12.m1.2.2.2.4.2.cmml" xref="S3.E12.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.4.2.1.cmml" xref="S3.E12.m1.2.2.2.4">subscript</csymbol><ci id="S3.E12.m1.2.2.2.4.2.2.cmml" xref="S3.E12.m1.2.2.2.4.2.2">𝑄</ci><cn id="S3.E12.m1.2.2.2.4.2.3.cmml" type="integer" xref="S3.E12.m1.2.2.2.4.2.3">2</cn></apply><ci id="S3.E12.m1.2.2.2.4.3.cmml" xref="S3.E12.m1.2.2.2.4.3">′</ci></apply><apply id="S3.E12.m1.2.2.2.5.cmml" xref="S3.E12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.5.1.cmml" xref="S3.E12.m1.2.2.2.5">superscript</csymbol><apply id="S3.E12.m1.2.2.2.5.2.cmml" xref="S3.E12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.5.2.1.cmml" xref="S3.E12.m1.2.2.2.5">subscript</csymbol><ci id="S3.E12.m1.2.2.2.5.2.2.cmml" xref="S3.E12.m1.2.2.2.5.2.2">𝐾</ci><cn id="S3.E12.m1.2.2.2.5.2.3.cmml" type="integer" xref="S3.E12.m1.2.2.2.5.2.3">2</cn></apply><list id="S3.E12.m1.2.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.2.2"><ci id="S3.E12.m1.2.2.2.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.2.2.1">′</ci><ci id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1">𝑇</ci></list></apply></apply><apply id="S3.E12.m1.2.2.4.cmml" xref="S3.E12.m1.2.2.4"><root id="S3.E12.m1.2.2.4a.cmml" xref="S3.E12.m1.2.2.4"></root><apply id="S3.E12.m1.2.2.4.2.cmml" xref="S3.E12.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.4.2.1.cmml" xref="S3.E12.m1.2.2.4.2">subscript</csymbol><ci id="S3.E12.m1.2.2.4.2.2.cmml" xref="S3.E12.m1.2.2.4.2.2">𝑑</ci><cn id="S3.E12.m1.2.2.4.2.3.cmml" type="integer" xref="S3.E12.m1.2.2.4.2.3">2</cn></apply></apply></apply></apply><apply id="S3.E12.m1.5.5.8.3.cmml" xref="S3.E12.m1.5.5.8.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.8.3.1.cmml" xref="S3.E12.m1.5.5.8.3">superscript</csymbol><apply id="S3.E12.m1.5.5.8.3.2.cmml" xref="S3.E12.m1.5.5.8.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.8.3.2.1.cmml" xref="S3.E12.m1.5.5.8.3">subscript</csymbol><ci id="S3.E12.m1.5.5.8.3.2.2.cmml" xref="S3.E12.m1.5.5.8.3.2.2">𝑉</ci><cn id="S3.E12.m1.5.5.8.3.2.3.cmml" type="integer" xref="S3.E12.m1.5.5.8.3.2.3">2</cn></apply><ci id="S3.E12.m1.5.5.8.3.3.cmml" xref="S3.E12.m1.5.5.8.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.5c">\phi^{c}_{out}=\text{Attn}(Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime})=\text%
{softmax}\left(\frac{Q_{2}^{\prime}\cdot K_{2}^{\prime T}}{\sqrt{d_{2}}}\right%
)\cdot V_{2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.5d">italic_ϕ start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT = Attn ( italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⋅ italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG end_ARG ) ⋅ italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p12">
<p class="ltx_p" id="S3.SS2.p12.2">The attention mechanism, <math alttext="\text{Attn}(Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.p12.1.m1.3"><semantics id="S3.SS2.p12.1.m1.3a"><mrow id="S3.SS2.p12.1.m1.3.3" xref="S3.SS2.p12.1.m1.3.3.cmml"><mtext id="S3.SS2.p12.1.m1.3.3.5" xref="S3.SS2.p12.1.m1.3.3.5a.cmml">Attn</mtext><mo id="S3.SS2.p12.1.m1.3.3.4" xref="S3.SS2.p12.1.m1.3.3.4.cmml">⁢</mo><mrow id="S3.SS2.p12.1.m1.3.3.3.3" xref="S3.SS2.p12.1.m1.3.3.3.4.cmml"><mo id="S3.SS2.p12.1.m1.3.3.3.3.4" stretchy="false" xref="S3.SS2.p12.1.m1.3.3.3.4.cmml">(</mo><msubsup id="S3.SS2.p12.1.m1.1.1.1.1.1" xref="S3.SS2.p12.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p12.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.p12.1.m1.1.1.1.1.1.2.2.cmml">Q</mi><mn id="S3.SS2.p12.1.m1.1.1.1.1.1.2.3" xref="S3.SS2.p12.1.m1.1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.SS2.p12.1.m1.1.1.1.1.1.3" xref="S3.SS2.p12.1.m1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS2.p12.1.m1.3.3.3.3.5" xref="S3.SS2.p12.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.p12.1.m1.2.2.2.2.2" xref="S3.SS2.p12.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p12.1.m1.2.2.2.2.2.2.2" xref="S3.SS2.p12.1.m1.2.2.2.2.2.2.2.cmml">K</mi><mn id="S3.SS2.p12.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.p12.1.m1.2.2.2.2.2.2.3.cmml">2</mn><mo id="S3.SS2.p12.1.m1.2.2.2.2.2.3" xref="S3.SS2.p12.1.m1.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.p12.1.m1.3.3.3.3.6" xref="S3.SS2.p12.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.p12.1.m1.3.3.3.3.3" xref="S3.SS2.p12.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS2.p12.1.m1.3.3.3.3.3.2.2" xref="S3.SS2.p12.1.m1.3.3.3.3.3.2.2.cmml">V</mi><mn id="S3.SS2.p12.1.m1.3.3.3.3.3.2.3" xref="S3.SS2.p12.1.m1.3.3.3.3.3.2.3.cmml">2</mn><mo id="S3.SS2.p12.1.m1.3.3.3.3.3.3" xref="S3.SS2.p12.1.m1.3.3.3.3.3.3.cmml">′</mo></msubsup><mo id="S3.SS2.p12.1.m1.3.3.3.3.7" stretchy="false" xref="S3.SS2.p12.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.1.m1.3b"><apply id="S3.SS2.p12.1.m1.3.3.cmml" xref="S3.SS2.p12.1.m1.3.3"><times id="S3.SS2.p12.1.m1.3.3.4.cmml" xref="S3.SS2.p12.1.m1.3.3.4"></times><ci id="S3.SS2.p12.1.m1.3.3.5a.cmml" xref="S3.SS2.p12.1.m1.3.3.5"><mtext id="S3.SS2.p12.1.m1.3.3.5.cmml" xref="S3.SS2.p12.1.m1.3.3.5">Attn</mtext></ci><vector id="S3.SS2.p12.1.m1.3.3.3.4.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3"><apply id="S3.SS2.p12.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p12.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p12.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1.2.2">𝑄</ci><cn id="S3.SS2.p12.1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p12.1.m1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS2.p12.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p12.1.m1.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS2.p12.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p12.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p12.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2.2.2">𝐾</ci><cn id="S3.SS2.p12.1.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p12.1.m1.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.p12.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p12.1.m1.2.2.2.2.2.3">′</ci></apply><apply id="S3.SS2.p12.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3">superscript</csymbol><apply id="S3.SS2.p12.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p12.1.m1.3.3.3.3.3.2.1.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p12.1.m1.3.3.3.3.3.2.2.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3.2.2">𝑉</ci><cn id="S3.SS2.p12.1.m1.3.3.3.3.3.2.3.cmml" type="integer" xref="S3.SS2.p12.1.m1.3.3.3.3.3.2.3">2</cn></apply><ci id="S3.SS2.p12.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS2.p12.1.m1.3.3.3.3.3.3">′</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.1.m1.3c">\text{Attn}(Q_{2}^{\prime},K_{2}^{\prime},V_{2}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p12.1.m1.3d">Attn ( italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, now uses the LoRA-enhanced queries, keys, and values to generate the final output <math alttext="\phi^{c}_{out}" class="ltx_Math" display="inline" id="S3.SS2.p12.2.m2.1"><semantics id="S3.SS2.p12.2.m2.1a"><msubsup id="S3.SS2.p12.2.m2.1.1" xref="S3.SS2.p12.2.m2.1.1.cmml"><mi id="S3.SS2.p12.2.m2.1.1.2.2" xref="S3.SS2.p12.2.m2.1.1.2.2.cmml">ϕ</mi><mrow id="S3.SS2.p12.2.m2.1.1.3" xref="S3.SS2.p12.2.m2.1.1.3.cmml"><mi id="S3.SS2.p12.2.m2.1.1.3.2" xref="S3.SS2.p12.2.m2.1.1.3.2.cmml">o</mi><mo id="S3.SS2.p12.2.m2.1.1.3.1" xref="S3.SS2.p12.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p12.2.m2.1.1.3.3" xref="S3.SS2.p12.2.m2.1.1.3.3.cmml">u</mi><mo id="S3.SS2.p12.2.m2.1.1.3.1a" xref="S3.SS2.p12.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p12.2.m2.1.1.3.4" xref="S3.SS2.p12.2.m2.1.1.3.4.cmml">t</mi></mrow><mi id="S3.SS2.p12.2.m2.1.1.2.3" xref="S3.SS2.p12.2.m2.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.2.m2.1b"><apply id="S3.SS2.p12.2.m2.1.1.cmml" xref="S3.SS2.p12.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p12.2.m2.1.1.1.cmml" xref="S3.SS2.p12.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p12.2.m2.1.1.2.cmml" xref="S3.SS2.p12.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p12.2.m2.1.1.2.1.cmml" xref="S3.SS2.p12.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p12.2.m2.1.1.2.2.cmml" xref="S3.SS2.p12.2.m2.1.1.2.2">italic-ϕ</ci><ci id="S3.SS2.p12.2.m2.1.1.2.3.cmml" xref="S3.SS2.p12.2.m2.1.1.2.3">𝑐</ci></apply><apply id="S3.SS2.p12.2.m2.1.1.3.cmml" xref="S3.SS2.p12.2.m2.1.1.3"><times id="S3.SS2.p12.2.m2.1.1.3.1.cmml" xref="S3.SS2.p12.2.m2.1.1.3.1"></times><ci id="S3.SS2.p12.2.m2.1.1.3.2.cmml" xref="S3.SS2.p12.2.m2.1.1.3.2">𝑜</ci><ci id="S3.SS2.p12.2.m2.1.1.3.3.cmml" xref="S3.SS2.p12.2.m2.1.1.3.3">𝑢</ci><ci id="S3.SS2.p12.2.m2.1.1.3.4.cmml" xref="S3.SS2.p12.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.2.m2.1c">\phi^{c}_{out}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p12.2.m2.1d">italic_ϕ start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in text-to-image tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Phase-3: Tune &amp; Generalize DDPM for Fine-Grained sonar Image Generation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The fine-tuned model from Phase 2 can generate images only when the user provides a custom object tag given during training. If the user fails to provide this tag, the model generates regular images instead of SONAR-specific images. To mitigate this limitation and generalize the model for generating fine-grained sonar images, we further train the model using the existing corpus of sonar images.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">In this phase, we generate images from the Phase 2 model using a series of prompts obtained from GPT. These generated images, combined with domain-specific language instructions, are processed through a Visual Language Model (VLM) to obtain <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">low-level descriptions</span>. These low-level descriptions are then fed back into GPT to generate <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.2">high-level descriptions</span>. The images and their corresponding low-level + high-level descriptions are subsequently used to fine-tune the stable diffusion model. The fine-tuning process involves optimizing the loss function for the diffusion model, where the loss is conditioned on both the image data and the text prompt:</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{fine-tune}}=\mathbb{E}_{x,t,\epsilon}\left[\left\|\epsilon-%
\epsilon_{\theta}(x_{t},t|\text{prompt})\right\|^{2}\right]" class="ltx_math_unparsed" display="block" id="S3.E13.m1.4"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4b"><msub id="S3.E13.m1.4.5"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.4.5.2">ℒ</mi><mtext id="S3.E13.m1.4.5.3">fine-tune</mtext></msub><mo id="S3.E13.m1.4.6">=</mo><msub id="S3.E13.m1.4.7"><mi id="S3.E13.m1.4.7.2">𝔼</mi><mrow id="S3.E13.m1.3.3.3.5"><mi id="S3.E13.m1.1.1.1.1">x</mi><mo id="S3.E13.m1.3.3.3.5.1">,</mo><mi id="S3.E13.m1.2.2.2.2">t</mi><mo id="S3.E13.m1.3.3.3.5.2">,</mo><mi id="S3.E13.m1.3.3.3.3">ϵ</mi></mrow></msub><mrow id="S3.E13.m1.4.8"><mo id="S3.E13.m1.4.8.1">[</mo><mo id="S3.E13.m1.4.8.2" lspace="0em" rspace="0.167em" stretchy="true">∥</mo><mi id="S3.E13.m1.4.8.3">ϵ</mi><mo id="S3.E13.m1.4.8.4">−</mo><msub id="S3.E13.m1.4.8.5"><mi id="S3.E13.m1.4.8.5.2">ϵ</mi><mi id="S3.E13.m1.4.8.5.3">θ</mi></msub><mrow id="S3.E13.m1.4.8.6"><mo id="S3.E13.m1.4.8.6.1" stretchy="false">(</mo><msub id="S3.E13.m1.4.8.6.2"><mi id="S3.E13.m1.4.8.6.2.2">x</mi><mi id="S3.E13.m1.4.8.6.2.3">t</mi></msub><mo id="S3.E13.m1.4.8.6.3">,</mo><mi id="S3.E13.m1.4.4">t</mi><mo fence="false" id="S3.E13.m1.4.8.6.4" rspace="0.167em" stretchy="false">|</mo><mtext id="S3.E13.m1.4.8.6.5">prompt</mtext><mo id="S3.E13.m1.4.8.6.6" stretchy="false">)</mo></mrow><msup id="S3.E13.m1.4.8.7"><mo id="S3.E13.m1.4.8.7.2" lspace="0em" rspace="0.167em" stretchy="true">∥</mo><mn id="S3.E13.m1.4.8.7.3">2</mn></msup><mo id="S3.E13.m1.4.8.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E13.m1.4c">\mathcal{L}_{\text{fine-tune}}=\mathbb{E}_{x,t,\epsilon}\left[\left\|\epsilon-%
\epsilon_{\theta}(x_{t},t|\text{prompt})\right\|^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.4d">caligraphic_L start_POSTSUBSCRIPT fine-tune end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_x , italic_t , italic_ϵ end_POSTSUBSCRIPT [ ∥ italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t | prompt ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.2">Here, <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the generated images, <math alttext="\epsilon_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">ϵ</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">italic-ϵ</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\epsilon_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is the noise predictor, and the fine-tuning process incorporates both the image data and sonar domain-specific textual instructions. This enhances the model’s ability to generate fine-grained sonar images based on more generalized prompts.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Setup</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Publicly Available Sonar Images</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">In this work, publicly available datasets, specifically the Seabed Objects KLSG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib16" title="">16</a>]</cite> and the sonar Common Target Detection Dataset (SCTD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib53" title="">53</a>]</cite>, are utilized. The Seabed Objects KLSG dataset  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib16" title="">16</a>]</cite> includes 1,190 side-scan sonar images, featuring 385 shipwrecks, 36 drowning victims, 62 planes, 129 mines, and 578 seafloor images. Collected over ten years with the help of commercial sonar suppliers like Lcocean, Klein Martin, and EdgeTech, a subset of 1,171 images (excluding mines) is publicly available for academic research. The sonar Common Target Detection Dataset (SCTD) 1.0  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib53" title="">53</a>]</cite>, developed by multiple universities, contains 596 images across 3 classes. Some sample images of the publicly available data are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.F3" title="Figure 3 ‣ 4.1.1 Publicly Available Sonar Images ‣ 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.6" style="width:47.7pt;"><span class="ltx_text" id="S4.F3.6.1">Seafloor</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.7" style="width:47.7pt;">
<p class="ltx_p ltx_align_center" id="S4.F3.7.1"><span class="ltx_text" id="S4.F3.7.1.1">Plane</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.8" style="width:47.7pt;"><span class="ltx_text" id="S4.F3.8.1">Ship</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.9" style="width:47.7pt;"><span class="ltx_text" id="S4.F3.9.1">Human</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.1" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F3.1.g1" src="extracted/5918985/Images/Publicly_Available_Images/image_12.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.2" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F3.2.g1" src="extracted/5918985/Images/Publicly_Available_Images/image_101.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.3" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F3.3.g1" src="extracted/5918985/Images/Publicly_Available_Images/image_104.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.4" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S4.F3.4.g1" src="extracted/5918985/Images/Publicly_Available_Images/image_199.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.10.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.11.2" style="font-size:90%;">Samples from publicly available sonar images</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>S3 Simulator Images</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">The S3Simulator <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib37" title="">37</a>]</cite> dataset is a novel benchmark of simulated side-scan sonar images designed to overcome challenges in acquiring high-quality sonar data. Using advanced simulation techniques, the dataset accurately replicates underwater conditions and produces diverse synthetic sonar images, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S4.F4" title="Figure 4 ‣ 4.1.2 S3 Simulator Images ‣ 4.1 Dataset ‣ 4 Experimental Setup ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">4</span></a>. Tools like the Segment Anything Model (SAM) and Gazebo are utilized for optimal object segmentation and visualization, enhancing the quality of data for AI model training in underwater object classification.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.6" style="width:43.4pt;"><span class="ltx_text" id="S4.F4.6.1">Ship</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.7" style="width:43.4pt;"><span class="ltx_text" id="S4.F4.7.1">Plane</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.8" style="width:43.4pt;">
<p class="ltx_p ltx_align_center" id="S4.F4.8.1"><span class="ltx_text" id="S4.F4.8.1.1">Manta Mine</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.9" style="width:43.4pt;"><span class="ltx_text" id="S4.F4.9.1">Cylindrical Mine</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.1" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F4.1.g1" src="extracted/5918985/Images/S3_Simulator_Dataset/Mines/selcted/ship_gray.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.2" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F4.2.g1" src="extracted/5918985/Images/S3_Simulator_Dataset/Mines/selcted/gold_air_processed_Screenshot.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.3" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F4.3.g1" src="extracted/5918985/Images/S3_Simulator_Dataset/Mines/selcted/truncated_cone_mine.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.4" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F4.4.g1" src="extracted/5918985/Images/S3_Simulator_Dataset/Mines/selcted/Cylenderical_mine_papr.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.10.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.11.2" style="font-size:90%;">Samples from S3 Simulator Dataset</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We use Frechet Inception Distance (FID), Structural Similarity Index (SSIM), Peak Signal-to-Noise Ratio (PSNR), and Inception Score (IS) to evaluate the image-to-image generation task.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FID}(x,g)=||\mu_{x}-\mu_{g}||^{2}+\text{Tr}(\Sigma_{x}+\Sigma_{g}-2(%
\Sigma_{x}\Sigma_{g})^{1/2})" class="ltx_Math" display="block" id="S4.E14.m1.4"><semantics id="S4.E14.m1.4a"><mrow id="S4.E14.m1.4.4" xref="S4.E14.m1.4.4.cmml"><mrow id="S4.E14.m1.4.4.4" xref="S4.E14.m1.4.4.4.cmml"><mtext id="S4.E14.m1.4.4.4.2" xref="S4.E14.m1.4.4.4.2a.cmml">FID</mtext><mo id="S4.E14.m1.4.4.4.1" xref="S4.E14.m1.4.4.4.1.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.4.3.2" xref="S4.E14.m1.4.4.4.3.1.cmml"><mo id="S4.E14.m1.4.4.4.3.2.1" stretchy="false" xref="S4.E14.m1.4.4.4.3.1.cmml">(</mo><mi id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml">x</mi><mo id="S4.E14.m1.4.4.4.3.2.2" xref="S4.E14.m1.4.4.4.3.1.cmml">,</mo><mi id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml">g</mi><mo id="S4.E14.m1.4.4.4.3.2.3" stretchy="false" xref="S4.E14.m1.4.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.4.4.3" xref="S4.E14.m1.4.4.3.cmml">=</mo><mrow id="S4.E14.m1.4.4.2" xref="S4.E14.m1.4.4.2.cmml"><msup id="S4.E14.m1.3.3.1.1" xref="S4.E14.m1.3.3.1.1.cmml"><mrow id="S4.E14.m1.3.3.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.2.cmml"><mo id="S4.E14.m1.3.3.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E14.m1.3.3.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.1.1.cmml"><msub id="S4.E14.m1.3.3.1.1.1.1.1.2" xref="S4.E14.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.3.3.1.1.1.1.1.2.2" xref="S4.E14.m1.3.3.1.1.1.1.1.2.2.cmml">μ</mi><mi id="S4.E14.m1.3.3.1.1.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.1.1.1.2.3.cmml">x</mi></msub><mo id="S4.E14.m1.3.3.1.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E14.m1.3.3.1.1.1.1.1.3" xref="S4.E14.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.3.3.1.1.1.1.1.3.2" xref="S4.E14.m1.3.3.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S4.E14.m1.3.3.1.1.1.1.1.3.3" xref="S4.E14.m1.3.3.1.1.1.1.1.3.3.cmml">g</mi></msub></mrow><mo id="S4.E14.m1.3.3.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E14.m1.3.3.1.1.3" xref="S4.E14.m1.3.3.1.1.3.cmml">2</mn></msup><mo id="S4.E14.m1.4.4.2.3" xref="S4.E14.m1.4.4.2.3.cmml">+</mo><mrow id="S4.E14.m1.4.4.2.2" xref="S4.E14.m1.4.4.2.2.cmml"><mtext id="S4.E14.m1.4.4.2.2.3" xref="S4.E14.m1.4.4.2.2.3a.cmml">Tr</mtext><mo id="S4.E14.m1.4.4.2.2.2" xref="S4.E14.m1.4.4.2.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.4.4.2.2.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.cmml"><mo id="S4.E14.m1.4.4.2.2.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.2.2.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.4.4.2.2.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.cmml"><mrow id="S4.E14.m1.4.4.2.2.1.1.1.3" xref="S4.E14.m1.4.4.2.2.1.1.1.3.cmml"><msub id="S4.E14.m1.4.4.2.2.1.1.1.3.2" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2.cmml"><mi id="S4.E14.m1.4.4.2.2.1.1.1.3.2.2" mathvariant="normal" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2.2.cmml">Σ</mi><mi id="S4.E14.m1.4.4.2.2.1.1.1.3.2.3" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2.3.cmml">x</mi></msub><mo id="S4.E14.m1.4.4.2.2.1.1.1.3.1" xref="S4.E14.m1.4.4.2.2.1.1.1.3.1.cmml">+</mo><msub id="S4.E14.m1.4.4.2.2.1.1.1.3.3" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3.cmml"><mi id="S4.E14.m1.4.4.2.2.1.1.1.3.3.2" mathvariant="normal" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3.2.cmml">Σ</mi><mi id="S4.E14.m1.4.4.2.2.1.1.1.3.3.3" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3.3.cmml">g</mi></msub></mrow><mo id="S4.E14.m1.4.4.2.2.1.1.1.2" xref="S4.E14.m1.4.4.2.2.1.1.1.2.cmml">−</mo><mrow id="S4.E14.m1.4.4.2.2.1.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.cmml"><mn id="S4.E14.m1.4.4.2.2.1.1.1.1.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.3.cmml">2</mn><mo id="S4.E14.m1.4.4.2.2.1.1.1.1.2" xref="S4.E14.m1.4.4.2.2.1.1.1.1.2.cmml">⁢</mo><msup id="S4.E14.m1.4.4.2.2.1.1.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.cmml"><mrow id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.2" mathvariant="normal" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.2.cmml">Σ</mi><mi id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.3.cmml">x</mi></msub><mo id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.2.cmml">Σ</mi><mi id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.3.cmml">g</mi></msub></mrow><mo id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.cmml"><mn id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.2" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.2.cmml">1</mn><mo id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.1" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.1.cmml">/</mo><mn id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.3" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.3.cmml">2</mn></mrow></msup></mrow></mrow><mo id="S4.E14.m1.4.4.2.2.1.1.3" stretchy="false" xref="S4.E14.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.4b"><apply id="S4.E14.m1.4.4.cmml" xref="S4.E14.m1.4.4"><eq id="S4.E14.m1.4.4.3.cmml" xref="S4.E14.m1.4.4.3"></eq><apply id="S4.E14.m1.4.4.4.cmml" xref="S4.E14.m1.4.4.4"><times id="S4.E14.m1.4.4.4.1.cmml" xref="S4.E14.m1.4.4.4.1"></times><ci id="S4.E14.m1.4.4.4.2a.cmml" xref="S4.E14.m1.4.4.4.2"><mtext id="S4.E14.m1.4.4.4.2.cmml" xref="S4.E14.m1.4.4.4.2">FID</mtext></ci><interval closure="open" id="S4.E14.m1.4.4.4.3.1.cmml" xref="S4.E14.m1.4.4.4.3.2"><ci id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1">𝑥</ci><ci id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2">𝑔</ci></interval></apply><apply id="S4.E14.m1.4.4.2.cmml" xref="S4.E14.m1.4.4.2"><plus id="S4.E14.m1.4.4.2.3.cmml" xref="S4.E14.m1.4.4.2.3"></plus><apply id="S4.E14.m1.3.3.1.1.cmml" xref="S4.E14.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E14.m1.3.3.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="S4.E14.m1.3.3.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1"><minus id="S4.E14.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.1"></minus><apply id="S4.E14.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.2.2">𝜇</ci><ci id="S4.E14.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S4.E14.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.3.2">𝜇</ci><ci id="S4.E14.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply><cn id="S4.E14.m1.3.3.1.1.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3">2</cn></apply><apply id="S4.E14.m1.4.4.2.2.cmml" xref="S4.E14.m1.4.4.2.2"><times id="S4.E14.m1.4.4.2.2.2.cmml" xref="S4.E14.m1.4.4.2.2.2"></times><ci id="S4.E14.m1.4.4.2.2.3a.cmml" xref="S4.E14.m1.4.4.2.2.3"><mtext id="S4.E14.m1.4.4.2.2.3.cmml" xref="S4.E14.m1.4.4.2.2.3">Tr</mtext></ci><apply id="S4.E14.m1.4.4.2.2.1.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1"><minus id="S4.E14.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.2"></minus><apply id="S4.E14.m1.4.4.2.2.1.1.1.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3"><plus id="S4.E14.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.1"></plus><apply id="S4.E14.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.1.3.2.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E14.m1.4.4.2.2.1.1.1.3.2.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2.2">Σ</ci><ci id="S4.E14.m1.4.4.2.2.1.1.1.3.2.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.2.3">𝑥</ci></apply><apply id="S4.E14.m1.4.4.2.2.1.1.1.3.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.1.3.3.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E14.m1.4.4.2.2.1.1.1.3.3.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3.2">Σ</ci><ci id="S4.E14.m1.4.4.2.2.1.1.1.3.3.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.3.3.3">𝑔</ci></apply></apply><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1"><times id="S4.E14.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.2"></times><cn id="S4.E14.m1.4.4.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.4.4.2.2.1.1.1.1.3">2</cn><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1"><times id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.2">Σ</ci><ci id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.2">Σ</ci><ci id="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.1.1.1.3.3">𝑔</ci></apply></apply><apply id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3"><divide id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.1"></divide><cn id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.2">1</cn><cn id="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E14.m1.4.4.2.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.4c">\text{FID}(x,g)=||\mu_{x}-\mu_{g}||^{2}+\text{Tr}(\Sigma_{x}+\Sigma_{g}-2(%
\Sigma_{x}\Sigma_{g})^{1/2})</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.4d">FID ( italic_x , italic_g ) = | | italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + Tr ( roman_Σ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT + roman_Σ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT - 2 ( roman_Σ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.7">where <math alttext="\mu_{x}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">μ</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝜇</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\mu_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mu_{g}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">μ</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝜇</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mu_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> are the means, and <math alttext="\Sigma_{x}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" mathvariant="normal" xref="S4.SS2.p3.3.m3.1.1.2.cmml">Σ</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">Σ</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\Sigma_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">roman_Σ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Sigma_{g}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><msub id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" mathvariant="normal" xref="S4.SS2.p3.4.m4.1.1.2.cmml">Σ</mi><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">Σ</ci><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\Sigma_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">roman_Σ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> are the covariance matrices of the real images <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_x</annotation></semantics></math> and the generated images <math alttext="g" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1"><semantics id="S4.SS2.p3.6.m6.1a"><mi id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><ci id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.1d">italic_g</annotation></semantics></math>. The term <span class="ltx_text ltx_markedasmath" id="S4.SS2.p3.7.1">Tr</span> denotes the trace of the matrix. FID measures the distance between the distributions of real and generated images in the feature space of a pre-trained Inception model.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SSIM}(x,y)=\frac{(2\mu_{x}\mu_{y}+c_{1})(2\sigma_{xy}+c_{2})}{(\mu_{x}^{%
2}+\mu_{y}^{2}+c_{1})(\sigma_{x}^{2}+\sigma_{y}^{2}+c_{2})}" class="ltx_Math" display="block" id="S4.E15.m1.6"><semantics id="S4.E15.m1.6a"><mrow id="S4.E15.m1.6.7" xref="S4.E15.m1.6.7.cmml"><mrow id="S4.E15.m1.6.7.2" xref="S4.E15.m1.6.7.2.cmml"><mtext id="S4.E15.m1.6.7.2.2" xref="S4.E15.m1.6.7.2.2a.cmml">SSIM</mtext><mo id="S4.E15.m1.6.7.2.1" xref="S4.E15.m1.6.7.2.1.cmml">⁢</mo><mrow id="S4.E15.m1.6.7.2.3.2" xref="S4.E15.m1.6.7.2.3.1.cmml"><mo id="S4.E15.m1.6.7.2.3.2.1" stretchy="false" xref="S4.E15.m1.6.7.2.3.1.cmml">(</mo><mi id="S4.E15.m1.5.5" xref="S4.E15.m1.5.5.cmml">x</mi><mo id="S4.E15.m1.6.7.2.3.2.2" xref="S4.E15.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.E15.m1.6.6" xref="S4.E15.m1.6.6.cmml">y</mi><mo id="S4.E15.m1.6.7.2.3.2.3" stretchy="false" xref="S4.E15.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.6.7.1" xref="S4.E15.m1.6.7.1.cmml">=</mo><mfrac id="S4.E15.m1.4.4" xref="S4.E15.m1.4.4.cmml"><mrow id="S4.E15.m1.2.2.2" xref="S4.E15.m1.2.2.2.cmml"><mrow id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.2.cmml"><mn id="S4.E15.m1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S4.E15.m1.1.1.1.1.1.1.2.1" xref="S4.E15.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E15.m1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.2.3.2" xref="S4.E15.m1.1.1.1.1.1.1.2.3.2.cmml">μ</mi><mi id="S4.E15.m1.1.1.1.1.1.1.2.3.3" xref="S4.E15.m1.1.1.1.1.1.1.2.3.3.cmml">x</mi></msub><mo id="S4.E15.m1.1.1.1.1.1.1.2.1a" xref="S4.E15.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E15.m1.1.1.1.1.1.1.2.4" xref="S4.E15.m1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.2.4.2" xref="S4.E15.m1.1.1.1.1.1.1.2.4.2.cmml">μ</mi><mi id="S4.E15.m1.1.1.1.1.1.1.2.4.3" xref="S4.E15.m1.1.1.1.1.1.1.2.4.3.cmml">y</mi></msub></mrow><mo id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.3.2.cmml">c</mi><mn id="S4.E15.m1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S4.E15.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E15.m1.2.2.2.3" xref="S4.E15.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E15.m1.2.2.2.2.1" xref="S4.E15.m1.2.2.2.2.1.1.cmml"><mo id="S4.E15.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E15.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.E15.m1.2.2.2.2.1.1" xref="S4.E15.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E15.m1.2.2.2.2.1.1.2" xref="S4.E15.m1.2.2.2.2.1.1.2.cmml"><mn id="S4.E15.m1.2.2.2.2.1.1.2.2" xref="S4.E15.m1.2.2.2.2.1.1.2.2.cmml">2</mn><mo id="S4.E15.m1.2.2.2.2.1.1.2.1" xref="S4.E15.m1.2.2.2.2.1.1.2.1.cmml">⁢</mo><msub id="S4.E15.m1.2.2.2.2.1.1.2.3" xref="S4.E15.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S4.E15.m1.2.2.2.2.1.1.2.3.2" xref="S4.E15.m1.2.2.2.2.1.1.2.3.2.cmml">σ</mi><mrow id="S4.E15.m1.2.2.2.2.1.1.2.3.3" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.cmml"><mi id="S4.E15.m1.2.2.2.2.1.1.2.3.3.2" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.2.cmml">x</mi><mo id="S4.E15.m1.2.2.2.2.1.1.2.3.3.1" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E15.m1.2.2.2.2.1.1.2.3.3.3" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.3.cmml">y</mi></mrow></msub></mrow><mo id="S4.E15.m1.2.2.2.2.1.1.1" xref="S4.E15.m1.2.2.2.2.1.1.1.cmml">+</mo><msub id="S4.E15.m1.2.2.2.2.1.1.3" xref="S4.E15.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E15.m1.2.2.2.2.1.1.3.2" xref="S4.E15.m1.2.2.2.2.1.1.3.2.cmml">c</mi><mn id="S4.E15.m1.2.2.2.2.1.1.3.3" xref="S4.E15.m1.2.2.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S4.E15.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E15.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E15.m1.4.4.4" xref="S4.E15.m1.4.4.4.cmml"><mrow id="S4.E15.m1.3.3.3.1.1" xref="S4.E15.m1.3.3.3.1.1.1.cmml"><mo id="S4.E15.m1.3.3.3.1.1.2" stretchy="false" xref="S4.E15.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.3.3.3.1.1.1" xref="S4.E15.m1.3.3.3.1.1.1.cmml"><msubsup id="S4.E15.m1.3.3.3.1.1.1.2" xref="S4.E15.m1.3.3.3.1.1.1.2.cmml"><mi id="S4.E15.m1.3.3.3.1.1.1.2.2.2" xref="S4.E15.m1.3.3.3.1.1.1.2.2.2.cmml">μ</mi><mi id="S4.E15.m1.3.3.3.1.1.1.2.2.3" xref="S4.E15.m1.3.3.3.1.1.1.2.2.3.cmml">x</mi><mn id="S4.E15.m1.3.3.3.1.1.1.2.3" xref="S4.E15.m1.3.3.3.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.3.3.3.1.1.1.1" xref="S4.E15.m1.3.3.3.1.1.1.1.cmml">+</mo><msubsup id="S4.E15.m1.3.3.3.1.1.1.3" xref="S4.E15.m1.3.3.3.1.1.1.3.cmml"><mi id="S4.E15.m1.3.3.3.1.1.1.3.2.2" xref="S4.E15.m1.3.3.3.1.1.1.3.2.2.cmml">μ</mi><mi id="S4.E15.m1.3.3.3.1.1.1.3.2.3" xref="S4.E15.m1.3.3.3.1.1.1.3.2.3.cmml">y</mi><mn id="S4.E15.m1.3.3.3.1.1.1.3.3" xref="S4.E15.m1.3.3.3.1.1.1.3.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.3.3.3.1.1.1.1a" xref="S4.E15.m1.3.3.3.1.1.1.1.cmml">+</mo><msub id="S4.E15.m1.3.3.3.1.1.1.4" xref="S4.E15.m1.3.3.3.1.1.1.4.cmml"><mi id="S4.E15.m1.3.3.3.1.1.1.4.2" xref="S4.E15.m1.3.3.3.1.1.1.4.2.cmml">c</mi><mn id="S4.E15.m1.3.3.3.1.1.1.4.3" xref="S4.E15.m1.3.3.3.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S4.E15.m1.3.3.3.1.1.3" stretchy="false" xref="S4.E15.m1.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.E15.m1.4.4.4.3" xref="S4.E15.m1.4.4.4.3.cmml">⁢</mo><mrow id="S4.E15.m1.4.4.4.2.1" xref="S4.E15.m1.4.4.4.2.1.1.cmml"><mo id="S4.E15.m1.4.4.4.2.1.2" stretchy="false" xref="S4.E15.m1.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.E15.m1.4.4.4.2.1.1" xref="S4.E15.m1.4.4.4.2.1.1.cmml"><msubsup id="S4.E15.m1.4.4.4.2.1.1.2" xref="S4.E15.m1.4.4.4.2.1.1.2.cmml"><mi id="S4.E15.m1.4.4.4.2.1.1.2.2.2" xref="S4.E15.m1.4.4.4.2.1.1.2.2.2.cmml">σ</mi><mi id="S4.E15.m1.4.4.4.2.1.1.2.2.3" xref="S4.E15.m1.4.4.4.2.1.1.2.2.3.cmml">x</mi><mn id="S4.E15.m1.4.4.4.2.1.1.2.3" xref="S4.E15.m1.4.4.4.2.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.4.4.4.2.1.1.1" xref="S4.E15.m1.4.4.4.2.1.1.1.cmml">+</mo><msubsup id="S4.E15.m1.4.4.4.2.1.1.3" xref="S4.E15.m1.4.4.4.2.1.1.3.cmml"><mi id="S4.E15.m1.4.4.4.2.1.1.3.2.2" xref="S4.E15.m1.4.4.4.2.1.1.3.2.2.cmml">σ</mi><mi id="S4.E15.m1.4.4.4.2.1.1.3.2.3" xref="S4.E15.m1.4.4.4.2.1.1.3.2.3.cmml">y</mi><mn id="S4.E15.m1.4.4.4.2.1.1.3.3" xref="S4.E15.m1.4.4.4.2.1.1.3.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.4.4.4.2.1.1.1a" xref="S4.E15.m1.4.4.4.2.1.1.1.cmml">+</mo><msub id="S4.E15.m1.4.4.4.2.1.1.4" xref="S4.E15.m1.4.4.4.2.1.1.4.cmml"><mi id="S4.E15.m1.4.4.4.2.1.1.4.2" xref="S4.E15.m1.4.4.4.2.1.1.4.2.cmml">c</mi><mn id="S4.E15.m1.4.4.4.2.1.1.4.3" xref="S4.E15.m1.4.4.4.2.1.1.4.3.cmml">2</mn></msub></mrow><mo id="S4.E15.m1.4.4.4.2.1.3" stretchy="false" xref="S4.E15.m1.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.6b"><apply id="S4.E15.m1.6.7.cmml" xref="S4.E15.m1.6.7"><eq id="S4.E15.m1.6.7.1.cmml" xref="S4.E15.m1.6.7.1"></eq><apply id="S4.E15.m1.6.7.2.cmml" xref="S4.E15.m1.6.7.2"><times id="S4.E15.m1.6.7.2.1.cmml" xref="S4.E15.m1.6.7.2.1"></times><ci id="S4.E15.m1.6.7.2.2a.cmml" xref="S4.E15.m1.6.7.2.2"><mtext id="S4.E15.m1.6.7.2.2.cmml" xref="S4.E15.m1.6.7.2.2">SSIM</mtext></ci><interval closure="open" id="S4.E15.m1.6.7.2.3.1.cmml" xref="S4.E15.m1.6.7.2.3.2"><ci id="S4.E15.m1.5.5.cmml" xref="S4.E15.m1.5.5">𝑥</ci><ci id="S4.E15.m1.6.6.cmml" xref="S4.E15.m1.6.6">𝑦</ci></interval></apply><apply id="S4.E15.m1.4.4.cmml" xref="S4.E15.m1.4.4"><divide id="S4.E15.m1.4.4.5.cmml" xref="S4.E15.m1.4.4"></divide><apply id="S4.E15.m1.2.2.2.cmml" xref="S4.E15.m1.2.2.2"><times id="S4.E15.m1.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.3"></times><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><plus id="S4.E15.m1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1"></plus><apply id="S4.E15.m1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2"><times id="S4.E15.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.1"></times><cn id="S4.E15.m1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.1.1.2.2">2</cn><apply id="S4.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3.2">𝜇</ci><ci id="S4.E15.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3.3">𝑥</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.2.4.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.4.2">𝜇</ci><ci id="S4.E15.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.4.3">𝑦</ci></apply></apply><apply id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.2">𝑐</ci><cn id="S4.E15.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E15.m1.2.2.2.2.1.1.cmml" xref="S4.E15.m1.2.2.2.2.1"><plus id="S4.E15.m1.2.2.2.2.1.1.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1"></plus><apply id="S4.E15.m1.2.2.2.2.1.1.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2"><times id="S4.E15.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.1"></times><cn id="S4.E15.m1.2.2.2.2.1.1.2.2.cmml" type="integer" xref="S4.E15.m1.2.2.2.2.1.1.2.2">2</cn><apply id="S4.E15.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3.2">𝜎</ci><apply id="S4.E15.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3"><times id="S4.E15.m1.2.2.2.2.1.1.2.3.3.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.1"></times><ci id="S4.E15.m1.2.2.2.2.1.1.2.3.3.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.2">𝑥</ci><ci id="S4.E15.m1.2.2.2.2.1.1.2.3.3.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3.3.3">𝑦</ci></apply></apply></apply><apply id="S4.E15.m1.2.2.2.2.1.1.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.3.2">𝑐</ci><cn id="S4.E15.m1.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S4.E15.m1.2.2.2.2.1.1.3.3">2</cn></apply></apply></apply><apply id="S4.E15.m1.4.4.4.cmml" xref="S4.E15.m1.4.4.4"><times id="S4.E15.m1.4.4.4.3.cmml" xref="S4.E15.m1.4.4.4.3"></times><apply id="S4.E15.m1.3.3.3.1.1.1.cmml" xref="S4.E15.m1.3.3.3.1.1"><plus id="S4.E15.m1.3.3.3.1.1.1.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.1"></plus><apply id="S4.E15.m1.3.3.3.1.1.1.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.1.1.2.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2">superscript</csymbol><apply id="S4.E15.m1.3.3.3.1.1.1.2.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.1.1.2.2.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S4.E15.m1.3.3.3.1.1.1.2.2.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2.2.2">𝜇</ci><ci id="S4.E15.m1.3.3.3.1.1.1.2.2.3.cmml" xref="S4.E15.m1.3.3.3.1.1.1.2.2.3">𝑥</ci></apply><cn id="S4.E15.m1.3.3.3.1.1.1.2.3.cmml" type="integer" xref="S4.E15.m1.3.3.3.1.1.1.2.3">2</cn></apply><apply id="S4.E15.m1.3.3.3.1.1.1.3.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.1.1.3.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3">superscript</csymbol><apply id="S4.E15.m1.3.3.3.1.1.1.3.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.1.1.3.2.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.3.3.3.1.1.1.3.2.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3.2.2">𝜇</ci><ci id="S4.E15.m1.3.3.3.1.1.1.3.2.3.cmml" xref="S4.E15.m1.3.3.3.1.1.1.3.2.3">𝑦</ci></apply><cn id="S4.E15.m1.3.3.3.1.1.1.3.3.cmml" type="integer" xref="S4.E15.m1.3.3.3.1.1.1.3.3">2</cn></apply><apply id="S4.E15.m1.3.3.3.1.1.1.4.cmml" xref="S4.E15.m1.3.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.1.1.4.1.cmml" xref="S4.E15.m1.3.3.3.1.1.1.4">subscript</csymbol><ci id="S4.E15.m1.3.3.3.1.1.1.4.2.cmml" xref="S4.E15.m1.3.3.3.1.1.1.4.2">𝑐</ci><cn id="S4.E15.m1.3.3.3.1.1.1.4.3.cmml" type="integer" xref="S4.E15.m1.3.3.3.1.1.1.4.3">1</cn></apply></apply><apply id="S4.E15.m1.4.4.4.2.1.1.cmml" xref="S4.E15.m1.4.4.4.2.1"><plus id="S4.E15.m1.4.4.4.2.1.1.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1"></plus><apply id="S4.E15.m1.4.4.4.2.1.1.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2">superscript</csymbol><apply id="S4.E15.m1.4.4.4.2.1.1.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.2.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S4.E15.m1.4.4.4.2.1.1.2.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2.2.2">𝜎</ci><ci id="S4.E15.m1.4.4.4.2.1.1.2.2.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.2.2.3">𝑥</ci></apply><cn id="S4.E15.m1.4.4.4.2.1.1.2.3.cmml" type="integer" xref="S4.E15.m1.4.4.4.2.1.1.2.3">2</cn></apply><apply id="S4.E15.m1.4.4.4.2.1.1.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.3.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3">superscript</csymbol><apply id="S4.E15.m1.4.4.4.2.1.1.3.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.3.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S4.E15.m1.4.4.4.2.1.1.3.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3.2.2">𝜎</ci><ci id="S4.E15.m1.4.4.4.2.1.1.3.2.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.3.2.3">𝑦</ci></apply><cn id="S4.E15.m1.4.4.4.2.1.1.3.3.cmml" type="integer" xref="S4.E15.m1.4.4.4.2.1.1.3.3">2</cn></apply><apply id="S4.E15.m1.4.4.4.2.1.1.4.cmml" xref="S4.E15.m1.4.4.4.2.1.1.4"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.4.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.4">subscript</csymbol><ci id="S4.E15.m1.4.4.4.2.1.1.4.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.4.2">𝑐</ci><cn id="S4.E15.m1.4.4.4.2.1.1.4.3.cmml" type="integer" xref="S4.E15.m1.4.4.4.2.1.1.4.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.6c">\text{SSIM}(x,y)=\frac{(2\mu_{x}\mu_{y}+c_{1})(2\sigma_{xy}+c_{2})}{(\mu_{x}^{%
2}+\mu_{y}^{2}+c_{1})(\sigma_{x}^{2}+\sigma_{y}^{2}+c_{2})}</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.6d">SSIM ( italic_x , italic_y ) = divide start_ARG ( 2 italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT italic_μ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT + italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ( 2 italic_σ start_POSTSUBSCRIPT italic_x italic_y end_POSTSUBSCRIPT + italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG start_ARG ( italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_μ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ( italic_σ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_σ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.9">where <math alttext="\mu_{x}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">μ</mi><mi id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝜇</ci><ci id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\mu_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mu_{y}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">μ</mi><mi id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝜇</ci><ci id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mu_{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> represent the means of images <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><mi id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><ci id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">italic_y</annotation></semantics></math>, <math alttext="\sigma_{x}^{2}" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m5.1"><semantics id="S4.SS2.p5.5.m5.1a"><msubsup id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml"><mi id="S4.SS2.p5.5.m5.1.1.2.2" xref="S4.SS2.p5.5.m5.1.1.2.2.cmml">σ</mi><mi id="S4.SS2.p5.5.m5.1.1.2.3" xref="S4.SS2.p5.5.m5.1.1.2.3.cmml">x</mi><mn id="S4.SS2.p5.5.m5.1.1.3" xref="S4.SS2.p5.5.m5.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><apply id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.1.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">superscript</csymbol><apply id="S4.SS2.p5.5.m5.1.1.2.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.1.1.2.1.cmml" xref="S4.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p5.5.m5.1.1.2.2.cmml" xref="S4.SS2.p5.5.m5.1.1.2.2">𝜎</ci><ci id="S4.SS2.p5.5.m5.1.1.2.3.cmml" xref="S4.SS2.p5.5.m5.1.1.2.3">𝑥</ci></apply><cn id="S4.SS2.p5.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p5.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">\sigma_{x}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m5.1d">italic_σ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\sigma_{y}^{2}" class="ltx_Math" display="inline" id="S4.SS2.p5.6.m6.1"><semantics id="S4.SS2.p5.6.m6.1a"><msubsup id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml"><mi id="S4.SS2.p5.6.m6.1.1.2.2" xref="S4.SS2.p5.6.m6.1.1.2.2.cmml">σ</mi><mi id="S4.SS2.p5.6.m6.1.1.2.3" xref="S4.SS2.p5.6.m6.1.1.2.3.cmml">y</mi><mn id="S4.SS2.p5.6.m6.1.1.3" xref="S4.SS2.p5.6.m6.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.p5.6.m6.1.1.2.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.2.1.cmml" xref="S4.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p5.6.m6.1.1.2.2.cmml" xref="S4.SS2.p5.6.m6.1.1.2.2">𝜎</ci><ci id="S4.SS2.p5.6.m6.1.1.2.3.cmml" xref="S4.SS2.p5.6.m6.1.1.2.3">𝑦</ci></apply><cn id="S4.SS2.p5.6.m6.1.1.3.cmml" type="integer" xref="S4.SS2.p5.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">\sigma_{y}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.6.m6.1d">italic_σ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> are their variances, and <math alttext="\sigma_{xy}" class="ltx_Math" display="inline" id="S4.SS2.p5.7.m7.1"><semantics id="S4.SS2.p5.7.m7.1a"><msub id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml"><mi id="S4.SS2.p5.7.m7.1.1.2" xref="S4.SS2.p5.7.m7.1.1.2.cmml">σ</mi><mrow id="S4.SS2.p5.7.m7.1.1.3" xref="S4.SS2.p5.7.m7.1.1.3.cmml"><mi id="S4.SS2.p5.7.m7.1.1.3.2" xref="S4.SS2.p5.7.m7.1.1.3.2.cmml">x</mi><mo id="S4.SS2.p5.7.m7.1.1.3.1" xref="S4.SS2.p5.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.7.m7.1.1.3.3" xref="S4.SS2.p5.7.m7.1.1.3.3.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><apply id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m7.1.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p5.7.m7.1.1.2.cmml" xref="S4.SS2.p5.7.m7.1.1.2">𝜎</ci><apply id="S4.SS2.p5.7.m7.1.1.3.cmml" xref="S4.SS2.p5.7.m7.1.1.3"><times id="S4.SS2.p5.7.m7.1.1.3.1.cmml" xref="S4.SS2.p5.7.m7.1.1.3.1"></times><ci id="S4.SS2.p5.7.m7.1.1.3.2.cmml" xref="S4.SS2.p5.7.m7.1.1.3.2">𝑥</ci><ci id="S4.SS2.p5.7.m7.1.1.3.3.cmml" xref="S4.SS2.p5.7.m7.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">\sigma_{xy}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.7.m7.1d">italic_σ start_POSTSUBSCRIPT italic_x italic_y end_POSTSUBSCRIPT</annotation></semantics></math> is the covariance between the two images. Constants <math alttext="c_{1}" class="ltx_Math" display="inline" id="S4.SS2.p5.8.m8.1"><semantics id="S4.SS2.p5.8.m8.1a"><msub id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml"><mi id="S4.SS2.p5.8.m8.1.1.2" xref="S4.SS2.p5.8.m8.1.1.2.cmml">c</mi><mn id="S4.SS2.p5.8.m8.1.1.3" xref="S4.SS2.p5.8.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><apply id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.2.cmml" xref="S4.SS2.p5.8.m8.1.1.2">𝑐</ci><cn id="S4.SS2.p5.8.m8.1.1.3.cmml" type="integer" xref="S4.SS2.p5.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">c_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.8.m8.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="c_{2}" class="ltx_Math" display="inline" id="S4.SS2.p5.9.m9.1"><semantics id="S4.SS2.p5.9.m9.1a"><msub id="S4.SS2.p5.9.m9.1.1" xref="S4.SS2.p5.9.m9.1.1.cmml"><mi id="S4.SS2.p5.9.m9.1.1.2" xref="S4.SS2.p5.9.m9.1.1.2.cmml">c</mi><mn id="S4.SS2.p5.9.m9.1.1.3" xref="S4.SS2.p5.9.m9.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><apply id="S4.SS2.p5.9.m9.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.9.m9.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p5.9.m9.1.1.2.cmml" xref="S4.SS2.p5.9.m9.1.1.2">𝑐</ci><cn id="S4.SS2.p5.9.m9.1.1.3.cmml" type="integer" xref="S4.SS2.p5.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">c_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.9.m9.1d">italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are used to avoid instability when the denominator is close to zero. SSIM assesses the perceived quality of images based on luminance, contrast, and structure.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<table class="ltx_equation ltx_eqn_table" id="S4.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{PSNR}(x,y)=10\cdot\log_{10}\left(\frac{\text{MAX}^{2}}{\text{MSE}(x,y)}\right)" class="ltx_Math" display="block" id="S4.E16.m1.5"><semantics id="S4.E16.m1.5a"><mrow id="S4.E16.m1.5.5" xref="S4.E16.m1.5.5.cmml"><mrow id="S4.E16.m1.5.5.3" xref="S4.E16.m1.5.5.3.cmml"><mtext id="S4.E16.m1.5.5.3.2" xref="S4.E16.m1.5.5.3.2a.cmml">PSNR</mtext><mo id="S4.E16.m1.5.5.3.1" xref="S4.E16.m1.5.5.3.1.cmml">⁢</mo><mrow id="S4.E16.m1.5.5.3.3.2" xref="S4.E16.m1.5.5.3.3.1.cmml"><mo id="S4.E16.m1.5.5.3.3.2.1" stretchy="false" xref="S4.E16.m1.5.5.3.3.1.cmml">(</mo><mi id="S4.E16.m1.3.3" xref="S4.E16.m1.3.3.cmml">x</mi><mo id="S4.E16.m1.5.5.3.3.2.2" xref="S4.E16.m1.5.5.3.3.1.cmml">,</mo><mi id="S4.E16.m1.4.4" xref="S4.E16.m1.4.4.cmml">y</mi><mo id="S4.E16.m1.5.5.3.3.2.3" stretchy="false" xref="S4.E16.m1.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.5.5.2" xref="S4.E16.m1.5.5.2.cmml">=</mo><mrow id="S4.E16.m1.5.5.1" xref="S4.E16.m1.5.5.1.cmml"><mn id="S4.E16.m1.5.5.1.3" xref="S4.E16.m1.5.5.1.3.cmml">10</mn><mo id="S4.E16.m1.5.5.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E16.m1.5.5.1.2.cmml">⋅</mo><mrow id="S4.E16.m1.5.5.1.1.1" xref="S4.E16.m1.5.5.1.1.2.cmml"><msub id="S4.E16.m1.5.5.1.1.1.1" xref="S4.E16.m1.5.5.1.1.1.1.cmml"><mi id="S4.E16.m1.5.5.1.1.1.1.2" xref="S4.E16.m1.5.5.1.1.1.1.2.cmml">log</mi><mn id="S4.E16.m1.5.5.1.1.1.1.3" xref="S4.E16.m1.5.5.1.1.1.1.3.cmml">10</mn></msub><mo id="S4.E16.m1.5.5.1.1.1a" xref="S4.E16.m1.5.5.1.1.2.cmml">⁡</mo><mrow id="S4.E16.m1.5.5.1.1.1.2" xref="S4.E16.m1.5.5.1.1.2.cmml"><mo id="S4.E16.m1.5.5.1.1.1.2.1" xref="S4.E16.m1.5.5.1.1.2.cmml">(</mo><mfrac id="S4.E16.m1.2.2" xref="S4.E16.m1.2.2.cmml"><msup id="S4.E16.m1.2.2.4" xref="S4.E16.m1.2.2.4.cmml"><mtext id="S4.E16.m1.2.2.4.2" xref="S4.E16.m1.2.2.4.2a.cmml">MAX</mtext><mn id="S4.E16.m1.2.2.4.3" xref="S4.E16.m1.2.2.4.3.cmml">2</mn></msup><mrow id="S4.E16.m1.2.2.2" xref="S4.E16.m1.2.2.2.cmml"><mtext id="S4.E16.m1.2.2.2.4" xref="S4.E16.m1.2.2.2.4a.cmml">MSE</mtext><mo id="S4.E16.m1.2.2.2.3" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E16.m1.2.2.2.5.2" xref="S4.E16.m1.2.2.2.5.1.cmml"><mo id="S4.E16.m1.2.2.2.5.2.1" stretchy="false" xref="S4.E16.m1.2.2.2.5.1.cmml">(</mo><mi id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml">x</mi><mo id="S4.E16.m1.2.2.2.5.2.2" xref="S4.E16.m1.2.2.2.5.1.cmml">,</mo><mi id="S4.E16.m1.2.2.2.2" xref="S4.E16.m1.2.2.2.2.cmml">y</mi><mo id="S4.E16.m1.2.2.2.5.2.3" stretchy="false" xref="S4.E16.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E16.m1.5.5.1.1.1.2.2" xref="S4.E16.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.5b"><apply id="S4.E16.m1.5.5.cmml" xref="S4.E16.m1.5.5"><eq id="S4.E16.m1.5.5.2.cmml" xref="S4.E16.m1.5.5.2"></eq><apply id="S4.E16.m1.5.5.3.cmml" xref="S4.E16.m1.5.5.3"><times id="S4.E16.m1.5.5.3.1.cmml" xref="S4.E16.m1.5.5.3.1"></times><ci id="S4.E16.m1.5.5.3.2a.cmml" xref="S4.E16.m1.5.5.3.2"><mtext id="S4.E16.m1.5.5.3.2.cmml" xref="S4.E16.m1.5.5.3.2">PSNR</mtext></ci><interval closure="open" id="S4.E16.m1.5.5.3.3.1.cmml" xref="S4.E16.m1.5.5.3.3.2"><ci id="S4.E16.m1.3.3.cmml" xref="S4.E16.m1.3.3">𝑥</ci><ci id="S4.E16.m1.4.4.cmml" xref="S4.E16.m1.4.4">𝑦</ci></interval></apply><apply id="S4.E16.m1.5.5.1.cmml" xref="S4.E16.m1.5.5.1"><ci id="S4.E16.m1.5.5.1.2.cmml" xref="S4.E16.m1.5.5.1.2">⋅</ci><cn id="S4.E16.m1.5.5.1.3.cmml" type="integer" xref="S4.E16.m1.5.5.1.3">10</cn><apply id="S4.E16.m1.5.5.1.1.2.cmml" xref="S4.E16.m1.5.5.1.1.1"><apply id="S4.E16.m1.5.5.1.1.1.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1">subscript</csymbol><log id="S4.E16.m1.5.5.1.1.1.1.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2"></log><cn id="S4.E16.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S4.E16.m1.5.5.1.1.1.1.3">10</cn></apply><apply id="S4.E16.m1.2.2.cmml" xref="S4.E16.m1.2.2"><divide id="S4.E16.m1.2.2.3.cmml" xref="S4.E16.m1.2.2"></divide><apply id="S4.E16.m1.2.2.4.cmml" xref="S4.E16.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.4.1.cmml" xref="S4.E16.m1.2.2.4">superscript</csymbol><ci id="S4.E16.m1.2.2.4.2a.cmml" xref="S4.E16.m1.2.2.4.2"><mtext id="S4.E16.m1.2.2.4.2.cmml" xref="S4.E16.m1.2.2.4.2">MAX</mtext></ci><cn id="S4.E16.m1.2.2.4.3.cmml" type="integer" xref="S4.E16.m1.2.2.4.3">2</cn></apply><apply id="S4.E16.m1.2.2.2.cmml" xref="S4.E16.m1.2.2.2"><times id="S4.E16.m1.2.2.2.3.cmml" xref="S4.E16.m1.2.2.2.3"></times><ci id="S4.E16.m1.2.2.2.4a.cmml" xref="S4.E16.m1.2.2.2.4"><mtext id="S4.E16.m1.2.2.2.4.cmml" xref="S4.E16.m1.2.2.2.4">MSE</mtext></ci><interval closure="open" id="S4.E16.m1.2.2.2.5.1.cmml" xref="S4.E16.m1.2.2.2.5.2"><ci id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1">𝑥</ci><ci id="S4.E16.m1.2.2.2.2.cmml" xref="S4.E16.m1.2.2.2.2">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.5c">\text{PSNR}(x,y)=10\cdot\log_{10}\left(\frac{\text{MAX}^{2}}{\text{MSE}(x,y)}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.5d">PSNR ( italic_x , italic_y ) = 10 ⋅ roman_log start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ( divide start_ARG MAX start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG MSE ( italic_x , italic_y ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.4">where <span class="ltx_text ltx_markedasmath" id="S4.SS2.p7.4.1">MAX</span> is the maximum possible pixel value of the image (e.g., 255 for an 8-bit image) and <math alttext="\text{MSE}(x,y)" class="ltx_Math" display="inline" id="S4.SS2.p7.2.m2.2"><semantics id="S4.SS2.p7.2.m2.2a"><mrow id="S4.SS2.p7.2.m2.2.3" xref="S4.SS2.p7.2.m2.2.3.cmml"><mtext id="S4.SS2.p7.2.m2.2.3.2" xref="S4.SS2.p7.2.m2.2.3.2a.cmml">MSE</mtext><mo id="S4.SS2.p7.2.m2.2.3.1" xref="S4.SS2.p7.2.m2.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p7.2.m2.2.3.3.2" xref="S4.SS2.p7.2.m2.2.3.3.1.cmml"><mo id="S4.SS2.p7.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS2.p7.2.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS2.p7.2.m2.1.1" xref="S4.SS2.p7.2.m2.1.1.cmml">x</mi><mo id="S4.SS2.p7.2.m2.2.3.3.2.2" xref="S4.SS2.p7.2.m2.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p7.2.m2.2.2" xref="S4.SS2.p7.2.m2.2.2.cmml">y</mi><mo id="S4.SS2.p7.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS2.p7.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m2.2b"><apply id="S4.SS2.p7.2.m2.2.3.cmml" xref="S4.SS2.p7.2.m2.2.3"><times id="S4.SS2.p7.2.m2.2.3.1.cmml" xref="S4.SS2.p7.2.m2.2.3.1"></times><ci id="S4.SS2.p7.2.m2.2.3.2a.cmml" xref="S4.SS2.p7.2.m2.2.3.2"><mtext id="S4.SS2.p7.2.m2.2.3.2.cmml" xref="S4.SS2.p7.2.m2.2.3.2">MSE</mtext></ci><interval closure="open" id="S4.SS2.p7.2.m2.2.3.3.1.cmml" xref="S4.SS2.p7.2.m2.2.3.3.2"><ci id="S4.SS2.p7.2.m2.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1">𝑥</ci><ci id="S4.SS2.p7.2.m2.2.2.cmml" xref="S4.SS2.p7.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m2.2c">\text{MSE}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.2.m2.2d">MSE ( italic_x , italic_y )</annotation></semantics></math> is the mean squared error between the images <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p7.3.m3.1"><semantics id="S4.SS2.p7.3.m3.1a"><mi id="S4.SS2.p7.3.m3.1.1" xref="S4.SS2.p7.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m3.1b"><ci id="S4.SS2.p7.3.m3.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.3.m3.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S4.SS2.p7.4.m4.1"><semantics id="S4.SS2.p7.4.m4.1a"><mi id="S4.SS2.p7.4.m4.1.1" xref="S4.SS2.p7.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.4.m4.1b"><ci id="S4.SS2.p7.4.m4.1.1.cmml" xref="S4.SS2.p7.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.4.m4.1d">italic_y</annotation></semantics></math>. PSNR is commonly used to measure the quality of reconstruction in image compression.</p>
</div>
<div class="ltx_para" id="S4.SS2.p8">
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{IS}(x)=\exp\left(\mathbb{E}_{x}D_{\text{KL}}(p(y|x)||p(y))\right)" class="ltx_math_unparsed" display="block" id="S4.E17.m1.2"><semantics id="S4.E17.m1.2a"><mrow id="S4.E17.m1.2b"><mtext id="S4.E17.m1.2.3">IS</mtext><mrow id="S4.E17.m1.2.4"><mo id="S4.E17.m1.2.4.1" stretchy="false">(</mo><mi id="S4.E17.m1.1.1">x</mi><mo id="S4.E17.m1.2.4.2" stretchy="false">)</mo></mrow><mo id="S4.E17.m1.2.5">=</mo><mi id="S4.E17.m1.2.6">exp</mi><mrow id="S4.E17.m1.2.7"><mo id="S4.E17.m1.2.7.1">(</mo><msub id="S4.E17.m1.2.7.2"><mi id="S4.E17.m1.2.7.2.2">𝔼</mi><mi id="S4.E17.m1.2.7.2.3">x</mi></msub><msub id="S4.E17.m1.2.7.3"><mi id="S4.E17.m1.2.7.3.2">D</mi><mtext id="S4.E17.m1.2.7.3.3">KL</mtext></msub><mrow id="S4.E17.m1.2.7.4"><mo id="S4.E17.m1.2.7.4.1" stretchy="false">(</mo><mi id="S4.E17.m1.2.7.4.2">p</mi><mrow id="S4.E17.m1.2.7.4.3"><mo id="S4.E17.m1.2.7.4.3.1" stretchy="false">(</mo><mi id="S4.E17.m1.2.7.4.3.2">y</mi><mo fence="false" id="S4.E17.m1.2.7.4.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E17.m1.2.7.4.3.4">x</mi><mo id="S4.E17.m1.2.7.4.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="S4.E17.m1.2.7.4.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E17.m1.2.7.4.5" rspace="0.167em" stretchy="false">|</mo><mi id="S4.E17.m1.2.7.4.6">p</mi><mrow id="S4.E17.m1.2.7.4.7"><mo id="S4.E17.m1.2.7.4.7.1" stretchy="false">(</mo><mi id="S4.E17.m1.2.2">y</mi><mo id="S4.E17.m1.2.7.4.7.2" stretchy="false">)</mo></mrow><mo id="S4.E17.m1.2.7.4.8" stretchy="false">)</mo></mrow><mo id="S4.E17.m1.2.7.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E17.m1.2c">\text{IS}(x)=\exp\left(\mathbb{E}_{x}D_{\text{KL}}(p(y|x)||p(y))\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.2d">IS ( italic_x ) = roman_exp ( blackboard_E start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_p ( italic_y | italic_x ) | | italic_p ( italic_y ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p9">
<p class="ltx_p" id="S4.SS2.p9.4">where <math alttext="p(y|x)" class="ltx_Math" display="inline" id="S4.SS2.p9.1.m1.1"><semantics id="S4.SS2.p9.1.m1.1a"><mrow id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml"><mi id="S4.SS2.p9.1.m1.1.1.3" xref="S4.SS2.p9.1.m1.1.1.3.cmml">p</mi><mo id="S4.SS2.p9.1.m1.1.1.2" xref="S4.SS2.p9.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p9.1.m1.1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.p9.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p9.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p9.1.m1.1.1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p9.1.m1.1.1.1.1.1.2" xref="S4.SS2.p9.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p9.1.m1.1.1.1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p9.1.m1.1.1.1.1.1.3" xref="S4.SS2.p9.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS2.p9.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p9.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1"><times id="S4.SS2.p9.1.m1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1.2"></times><ci id="S4.SS2.p9.1.m1.1.1.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3">𝑝</ci><apply id="S4.SS2.p9.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p9.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p9.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p9.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p9.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">p(y|x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.1.m1.1d">italic_p ( italic_y | italic_x )</annotation></semantics></math> is the conditional label distribution given an image <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p9.2.m2.1"><semantics id="S4.SS2.p9.2.m2.1a"><mi id="S4.SS2.p9.2.m2.1.1" xref="S4.SS2.p9.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><ci id="S4.SS2.p9.2.m2.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.2.m2.1d">italic_x</annotation></semantics></math>, and <math alttext="p(y)" class="ltx_Math" display="inline" id="S4.SS2.p9.3.m3.1"><semantics id="S4.SS2.p9.3.m3.1a"><mrow id="S4.SS2.p9.3.m3.1.2" xref="S4.SS2.p9.3.m3.1.2.cmml"><mi id="S4.SS2.p9.3.m3.1.2.2" xref="S4.SS2.p9.3.m3.1.2.2.cmml">p</mi><mo id="S4.SS2.p9.3.m3.1.2.1" xref="S4.SS2.p9.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p9.3.m3.1.2.3.2" xref="S4.SS2.p9.3.m3.1.2.cmml"><mo id="S4.SS2.p9.3.m3.1.2.3.2.1" stretchy="false" xref="S4.SS2.p9.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p9.3.m3.1.1" xref="S4.SS2.p9.3.m3.1.1.cmml">y</mi><mo id="S4.SS2.p9.3.m3.1.2.3.2.2" stretchy="false" xref="S4.SS2.p9.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m3.1b"><apply id="S4.SS2.p9.3.m3.1.2.cmml" xref="S4.SS2.p9.3.m3.1.2"><times id="S4.SS2.p9.3.m3.1.2.1.cmml" xref="S4.SS2.p9.3.m3.1.2.1"></times><ci id="S4.SS2.p9.3.m3.1.2.2.cmml" xref="S4.SS2.p9.3.m3.1.2.2">𝑝</ci><ci id="S4.SS2.p9.3.m3.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m3.1c">p(y)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.3.m3.1d">italic_p ( italic_y )</annotation></semantics></math> is the marginal label distribution. <math alttext="D_{\text{KL}}" class="ltx_Math" display="inline" id="S4.SS2.p9.4.m4.1"><semantics id="S4.SS2.p9.4.m4.1a"><msub id="S4.SS2.p9.4.m4.1.1" xref="S4.SS2.p9.4.m4.1.1.cmml"><mi id="S4.SS2.p9.4.m4.1.1.2" xref="S4.SS2.p9.4.m4.1.1.2.cmml">D</mi><mtext id="S4.SS2.p9.4.m4.1.1.3" xref="S4.SS2.p9.4.m4.1.1.3a.cmml">KL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m4.1b"><apply id="S4.SS2.p9.4.m4.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p9.4.m4.1.1.2.cmml" xref="S4.SS2.p9.4.m4.1.1.2">𝐷</ci><ci id="S4.SS2.p9.4.m4.1.1.3a.cmml" xref="S4.SS2.p9.4.m4.1.1.3"><mtext id="S4.SS2.p9.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p9.4.m4.1.1.3">KL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m4.1c">D_{\text{KL}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.4.m4.1d">italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT</annotation></semantics></math> represents the Kullback-Leibler divergence. IS evaluates the quality and diversity of generated images based on how well they are classified by a pre-trained classifier.</p>
</div>
<div class="ltx_para" id="S4.SS2.p10">
<p class="ltx_p" id="S4.SS2.p10.1">To evaluate the performance of the text-to-image generation task, R-Precision, Multimodal Distance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib43" title="">43</a>]</cite>, and Diversity can be used. However, since the sonar dataset lacks ground truth, the text-to-image sonar image generation model cannot be evaluated quantitatively; instead, qualitative analysis is facilitated.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Implementation Details</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We train, develop, and experiment the proposed framework in stable diffusion 1.4 pre-trained on the LAION <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib38" title="">38</a>]</cite> dataset using a NVIDIA RTX4000 with a 20GB GPU, fine-tuned with sonar-specific images to tailor the synthesis to the target sonar domain. The diffusion model generates high-quality synthetic sonar images by conditioning on sonar-specific attribute styles in the case of image-to-image and domain-specific prompts in the case of text-to-image. The domain-specific prompts (low-level and high-level descriptions) are enhanced using GPT 3.5 Turbo at phase-2 and in phase-3 VLM-LLaVA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib24" title="">24</a>]</cite> and GPT-3.5 Turbo for improving the control over sonar image synthesis. For the classification task, we leverage transfer learning with several backbone models, including VGG16, ResNet50, DenseNet121, MobileNetV2, Xception, and InceptionResNetV2. The models pre-trained on large-scale ImageNet dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib8" title="">8</a>]</cite> are adapted for sonar image classification with real dataset, synthetic dataset and a combination of real and synthetic dataset.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Results</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Phase-1: Style-Injection Results</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Style-Injection Quantitative Results</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">The objective of style injection is to improve the quality and diversity of generated sonar images through style injection, ensuring that the generated images better reflect the unique characteristics of the dataset. To achieve this, style images are selected not randomly but via K-Means clustering on the real sonar dataset. One to three images from each cluster are chosen for style injection, which enhances the relevance and consistency of the stylized outputs.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T1.2">
<tr class="ltx_tr" id="S5.T1.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.2.1.1.1">Class</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.2.1.2.1">FID</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.2.1.3.1">SSIM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.1.4"><span class="ltx_text ltx_font_bold" id="S5.T1.2.1.4.1">PSNR</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.1.5"><span class="ltx_text ltx_font_bold" id="S5.T1.2.1.5.1">IS</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.2.2.1">Plane</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.2.2">4.13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.2.3">0.300</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.2.4">15.022</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.2.2.5">1.05</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.2.3.1">Ship</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.3.2">6.15</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.3.3">0.392</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.3.4">10.759</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.3.5">1.04</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T1.2.4.1">Seafloor</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.4.2">1.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.4.3">0.452</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.4.4">12.410</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.2.4.5">1.12</td>
</tr>
<tr class="ltx_tr" id="S5.T1.2.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.2.5.1">Average</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.2.5.2">3.8</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.2.5.3">0.381</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.2.5.4">12.730</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.2.5.5">1.07</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.3.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.4.2" style="font-size:90%;">Image-to-Image Quantitative Metrics</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<p class="ltx_p" id="S5.SS1.SSS1.p2.1">The generated images from Phase-1: Style Injection (Section 5.1.2) are quantitatively evaluated using FID, SSIM, PSNR, and IS scores, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.T1" title="Table 1 ‣ 5.1.1 Style-Injection Quantitative Results ‣ 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">1</span></a>. Lower FID scores and higher SSIM and PSNR values indicate that the style injection method successfully maintains image quality, while the IS scores reflect the diversity of the generated images. From the results, the FID score is lowest for the Seafloor class (1.12), indicating the highest fidelity to the real data, while the Plane class has the lowest PSNR (15.022), suggesting relatively lower noise in image reconstruction. The SSIM values show that structural similarity is strongest for the Seafloor class (0.452), and the average across all classes indicates that the style injection improves both image quality and consistency. The IS scores across all classes are fairly similar, but they still indicate a moderate level of diversity in the generated images. These results suggest that improvements in both image quality and diversity are due to effective style injection, which introduces stylistic variations while preserving key structural elements.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T2.1">
<tr class="ltx_tr" id="S5.T2.1.2">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.2.1" style="width:59.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.2.1.1">
<span class="ltx_p" id="S5.T2.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.2.1.1.1.1">Image</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="S5.T2.1.2.2" style="width:173.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.2.2.1">
<span class="ltx_p" id="S5.T2.1.2.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.2.2.1.1.1">Prompt</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="S5.T2.1.2.3" style="width:99.4pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.2.3.1">
<span class="ltx_p" id="S5.T2.1.2.3.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.2.3.1.1.1">Low-Level Description</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="S5.T2.1.2.4" style="width:99.4pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.2.4.1">
<span class="ltx_p" id="S5.T2.1.2.4.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.2.4.1.1.1">High-Level Description</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.1.1" style="width:59.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="87" id="S5.T2.1.1.1.1.g1" src="extracted/5918985/Images/Text_to_Image_Phase_3/image_of_SH33_on_the_AP637.jpg" width="87"/>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.1.1.2" style="width:173.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.1.2.1">
<span class="ltx_p" id="S5.T2.1.1.2.1.1"><span class="ltx_text" id="S5.T2.1.1.2.1.1.1" style="font-size:50%;">Given the side scan sonar image and the caption: "image of SH__* on the AP__*", where PL__*, SH__*, CYM*, ASF*, TCM* represent the objects in the image, and AS__*, AP__*, SEF* represent the background. The numbers following these abbreviations can range from one to five digits. Provide the following descriptions:
A low-level description focusing on simple details and objects visible in the image.
A high-level description interpreting the scene or conveying a broader understanding based on the image and the given caption.</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.1.1.3" style="width:99.4pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.1.3.1">
<span class="ltx_p" id="S5.T2.1.1.3.1.1"><span class="ltx_text" id="S5.T2.1.1.3.1.1.1" style="font-size:50%;">The image shows an old shipwreck that has sunk into water near land, with the tail end pointing upwards. The sides are positioned halfway along the ship’s body, with the structure slightly off-center both horizontally and vertically. However, the ship is still identifiable as a specific model type due to the SH33* designation.</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.1.1.4" style="width:99.4pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T2.1.1.4.1">
<span class="ltx_p" id="S5.T2.1.1.4.1.1"><span class="ltx_text" id="S5.T2.1.1.4.1.1.1" style="font-size:50%;">The image likely depicts a shipwreck, designated SH33*, resting on a seabed with the AP637* terrain as the background. The tail of the ship sticks out, indicating a wreck.</span></span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.4.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.5.2" style="font-size:90%;color:#000000;">Descriptions generated by the GPT in Phase 3. In this phase, images produced from Phase 2 are described using a domain-specific prompt. The table includes four columns: (1) <span class="ltx_text ltx_font_bold" id="S5.T2.5.2.1">Image</span>: the generated image from Phase 2, (2) <span class="ltx_text ltx_font_bold" id="S5.T2.5.2.2">Prompt</span>: the domain-specific prompt used to generate the descriptions, (3) <span class="ltx_text ltx_font_bold" id="S5.T2.5.2.3">Low-Level Description</span>: a detailed description focusing on simple, observable details and objects in the image, and (4) <span class="ltx_text ltx_font_bold" id="S5.T2.5.2.4">High-Level Description</span>: an interpretive description providing a broader understanding of the scene depicted in the image. The abbreviations used in the prompt (e.g., PL__*, SH__*, CYM*, ASF*, TCM*, AS__*, AP__*, SEF*) represent various objects and background elements in the image, with numbers indicating different instances.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Style-Injection Qualitative Results</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">The images generated using the style injection are depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F5" title="Figure 5 ‣ 5.1.2 Style-Injection Qualitative Results ‣ 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">5</span></a>. The content image is generated from the prompt developed using GPT, the actual image is from a real sonar dataset, and the output is the stylized image from the proposed framework with the value of <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mi id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><ci id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">italic_γ</annotation></semantics></math> set to 0.5. The stylized output images retain the core structural elements necessary for accurate sonar image interpretation, such as the clear depiction of object boundaries and the representation of noise patterns that are characteristic of underwater acoustic imaging. This ensures that the model does not over-stylize the content, but instead enhances the aesthetic appeal while preserving the scientific accuracy of the generated outputs. Moreover,
the generated images show clearer details and better feature separation, indicating that style injection with an attention mechanism helps the diffusion model distinguish foreground objects from background noise. This makes the images more similar to real sonar data while adding subtle artistic variations that enhance diversity.</p>
</div>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.20" style="width:54.2pt;"><span class="ltx_text ltx_font_bold" id="S5.F5.20.1">CONTENT</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.21" style="width:54.2pt;"><span class="ltx_text ltx_font_bold" id="S5.F5.21.1">STYLE</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.22" style="width:54.2pt;"><span class="ltx_text ltx_font_bold" id="S5.F5.22.1">OUTPUT</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.1" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.1.g1" src="extracted/5918985/Images/Style_Injection/image_47.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.2" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.2.g1" src="extracted/5918985/Images/Style_Injection/ship__315.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.3" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.3.g1" src="extracted/5918985/Images/Style_Injection/image_47_stylized_ship__315.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.4" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.4.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/content/ship_28.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.5" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.5.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/Style/ship__530.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.6" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.6.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/ship_28_stylized_ship__530.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.7" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.7.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/content/ship_28.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.8" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.8.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/Style/ship__637.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.9" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.9.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/ship_29_stylized_ship__637.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.10" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.10.g1" src="extracted/5918985/Images/Style_Injection/image_7.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.11" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.11.g1" src="extracted/5918985/Images/Style_Injection/plane__52.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.12" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.12.g1" src="extracted/5918985/Images/Style_Injection/image_7_stylized_plane__52.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.13" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.13.g1" src="extracted/5918985/Images/Style_Injection/image_91.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.14" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F5.14.g1" src="extracted/5918985/Images/Style_Injection/ship__703.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.15" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.15.g1" src="extracted/5918985/Images/Style_Injection/image_91_stylized_ship__703.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.16" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.16.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/content/plane_43.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.17" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.17.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/Style/ship__227.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F5.18" style="width:54.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F5.18.g1" src="extracted/5918985/Images/Supplementary_Style_Injection_Outputs/plane_43_stylized_ship__227.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.23.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.24.2" style="font-size:90%;">The Contents, Styles, and Stylized sonar Images (Outputs) in the style injection process</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Sonar Image Classification Model</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">To support the quantitative measure of sonar image synthesis, a classification task is carried out using the generated synthetic data. In particular, we developed classification models leveraging transfer learning on backbone models such as VGG16, ResNet50, DenseNet121, MobileNetV2, Xception, and InceptionResNetV2 With the real, synthetic, and real + synthetic dataset and the performance of the developed image classification model is assessed with real sonar dataset. Refer to Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.T3" title="Table 3 ‣ 5.1.3 Sonar Image Classification Model ‣ 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">3</span></a> for the test accuracies of various models on real dataset. The model developed with fully synthetic dataset gave a maximum accuracy of 79%, using the MobileNetV2 as base model. When using only real data, the DenseNet121 model reached the highest accuracy of 96%, and when using the real + synthetic dataset, DenseNet121 again achieved the best performance with 97%. This demonstrates that our approach can generate high-quality synthetic sonar data, and the inclusion of synthetic data slightly improves model performance on real datasets.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T3.2">
<tr class="ltx_tr" id="S5.T3.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T3.2.1.1.1" style="font-size:80%;">Backbone Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.2.1.2.1" style="font-size:80%;">Real</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.2.1.3.1" style="font-size:80%;">Synthetic</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.2.1.4.1" style="font-size:80%;">Real + Synthetic</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.2.2.1"><span class="ltx_text" id="S5.T3.2.2.1.1" style="font-size:80%;">VGG16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.2.2"><span class="ltx_text" id="S5.T3.2.2.2.1" style="font-size:80%;">95%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.2.3"><span class="ltx_text" id="S5.T3.2.2.3.1" style="font-size:80%;">58%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.2.2.4"><span class="ltx_text" id="S5.T3.2.2.4.1" style="font-size:80%;">94%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.2.3.1"><span class="ltx_text" id="S5.T3.2.3.1.1" style="font-size:80%;">ResNet50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.3.2"><span class="ltx_text" id="S5.T3.2.3.2.1" style="font-size:80%;">90%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.3.3"><span class="ltx_text" id="S5.T3.2.3.3.1" style="font-size:80%;">29%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.3.4"><span class="ltx_text" id="S5.T3.2.3.4.1" style="font-size:80%;">82%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.2.4.1"><span class="ltx_text" id="S5.T3.2.4.1.1" style="font-size:80%;">DenseNet121</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.4.2"><span class="ltx_text ltx_font_bold" id="S5.T3.2.4.2.1" style="font-size:80%;">96%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.4.3"><span class="ltx_text" id="S5.T3.2.4.3.1" style="font-size:80%;">75%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.4.4"><span class="ltx_text ltx_font_bold" id="S5.T3.2.4.4.1" style="font-size:80%;">97%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.2.5.1"><span class="ltx_text" id="S5.T3.2.5.1.1" style="font-size:80%;">MobileNetV2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.5.2"><span class="ltx_text" id="S5.T3.2.5.2.1" style="font-size:80%;">92%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.5.3"><span class="ltx_text ltx_font_bold" id="S5.T3.2.5.3.1" style="font-size:80%;">79%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.5.4"><span class="ltx_text" id="S5.T3.2.5.4.1" style="font-size:80%;">95%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T3.2.6.1"><span class="ltx_text" id="S5.T3.2.6.1.1" style="font-size:80%;">Xception</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.6.2"><span class="ltx_text" id="S5.T3.2.6.2.1" style="font-size:80%;">95%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.6.3"><span class="ltx_text" id="S5.T3.2.6.3.1" style="font-size:80%;">68%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.2.6.4"><span class="ltx_text" id="S5.T3.2.6.4.1" style="font-size:80%;">95%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S5.T3.2.7.1"><span class="ltx_text" id="S5.T3.2.7.1.1" style="font-size:80%;">InceptionResNetV2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.2.7.2"><span class="ltx_text" id="S5.T3.2.7.2.1" style="font-size:80%;">95%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.2.7.3"><span class="ltx_text" id="S5.T3.2.7.3.1" style="font-size:80%;">48%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.2.7.4"><span class="ltx_text" id="S5.T3.2.7.4.1" style="font-size:80%;">94%</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.5.1.1" style="font-size:113%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.6.2" style="font-size:113%;">Test Accuracy on Real Dataset</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Phase-2 &amp; 3: Fine-Tuning Results</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Training or fine-tuning stable diffusion models typically demands extensive computational resources and large amounts of annotated data. However, due to computational constraints and limited access to experts for annotating generated images, we evaluated our framework as a pilot study, utilizing a dataset of 30 images per label. In total, the dataset consists of six different objects with 18 object variations across six seafloor environments used for model training.</p>
</div>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.6" style="width:47.7pt;"><span class="ltx_text" id="S5.F6.6.1">Seafloor</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.7" style="width:47.7pt;"><span class="ltx_text" id="S5.F6.7.1">Mine</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.8" style="width:47.7pt;"><span class="ltx_text" id="S5.F6.8.1">Plane</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.9" style="width:47.7pt;">
<p class="ltx_p ltx_align_center" id="S5.F6.9.1"><span class="ltx_text" id="S5.F6.9.1.1">Ship</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.1" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F6.1.g1" src="extracted/5918985/Images/Text_to_Image_Phase_2/Lora/SEFstar_image.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.2" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F6.2.g1" src="extracted/5918985/Images/Text_to_Image_Phase_2/Lora/Image_of_Ball_shaped_BM_mine_on_the_lower_ASB109_seabed,_positioned_on_its_left.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.3" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F6.3.g1" src="extracted/5918985/Images/Text_to_Image_Phase_2/Lora/PL2_PLANE_in_AP206_ufine_3500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F6.4" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F6.4.g1" src="extracted/5918985/Images/Text_to_Image_Phase_2/Lora/image_of_SH34_ship_on_AP238_2500_cropped.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.10.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.11.2" style="font-size:90%;">Generated Samples from the fine-tuned model</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">We qualitatively evaluated the performance of our model, with the generated images shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F6" title="Figure 6 ‣ 5.2 Phase-2 &amp; 3: Fine-Tuning Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">6</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F7" title="Figure 7 ‣ 5.2 Phase-2 &amp; 3: Fine-Tuning Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">7</span></a>. The model is trained using a dual diffusion framework, comprising coarse and fine image generation phases. In the coarse phase (Phase-2), the model produces images, outlining the basic structure of the sonar scene using detailed and pre-determined prompts. As the training progresses into the fine phase (Phase-3), the model generates higher-resolution images using generic prompts and even multiple objects where applicable.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.22" style="width:47.2pt;">
<p class="ltx_p ltx_align_center" id="S5.F7.22.1"><span class="ltx_text" id="S5.F7.22.1.1">500</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.23" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.23.1">1000</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.24" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.24.1">1500</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.25" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.25.1">3000</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.26" style="width:47.2pt;">
<p class="ltx_p ltx_align_center" id="S5.F7.26.1"><span class="ltx_text" id="S5.F7.26.1.1">5000</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.27" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.27.1">6500</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.28" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.28.1">7500</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.29" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.29.1">10000</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.30" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.30.1">12500</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.31" style="width:47.2pt;"><span class="ltx_text" id="S5.F7.31.1">15000</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.1" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.1.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.2" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.2.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_1000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.3" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.3.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_1500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.4" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.4.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_3000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.5" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.5.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_5000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.6" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.6.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_6500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.7" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F7.7.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_7500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.8" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.8.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_10000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.9" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.9.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_12500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F7.10" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.10.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/image_of_SH34_ship_on_AP238_seabed_15000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.11" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.11.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.12" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.12.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_1000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.13" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.13.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_1500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.14" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.14.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_3000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.15" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.15.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_5000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.16" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.16.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_6500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.17" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.17.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_7500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.18" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.18.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_10000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.19" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.19.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_12500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F7.20" style="width:47.2pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F7.20.g1" src="extracted/5918985/Images/Ablation_Study_Phase_2/Image_of_a_PL71_plane_in_a_sandy_AS25_seabed,_with_a_broken_tail_and_shadow_extending_to_the_front_and_left_15000.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.32.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S5.F7.33.2" style="font-size:90%;">Generated Images w.r.t training steps (Row-1: Number of Training steps, Row-2: Ship generated using the prompt ‘image of SH34* ship on AP238* seabed’, Row-3: Plane generated using the prompt ‘Image of a PL71* plane in a sandy AS25* seabed, with a broken tail and shadow extending to the front and left’)</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">The proposed hierarchical framework incorporates a Visual Language Model (VLM) to generate descriptions that enhance the image generation process. As detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.T2" title="Table 2 ‣ 5.1.1 Style-Injection Quantitative Results ‣ 5.1 Phase-1: Style-Injection Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">2</span></a>, the VLM supports GPT to provide both low-level descriptions (e.g., shape, size, texture of objects) and high-level descriptions (e.g., object relationships and interactions with the environment) to refine the stable diffusion model.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation study</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We conducted an in-depth analysis to regulate the results generated by the trained model. The style-injection ablation study is extensively discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS3.SSS1" title="5.3.1 Phase-1: Style-Injection (Image-to-Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">5.3.1</span></a>, while the fine-tuning ablation study is detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.SS3.SSS2" title="5.3.2 Phase-2 &amp; 3: Fine-Tuning (Text-to–Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">5.3.2</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1 </span>Phase-1: Style-Injection (Image-to-Image)</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.1">The blending ratio of content and style is controlled by the parameter <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p1.1.m1.1"><semantics id="S5.SS3.SSS1.p1.1.m1.1a"><mi id="S5.SS3.SSS1.p1.1.m1.1.1" xref="S5.SS3.SSS1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p1.1.m1.1b"><ci id="S5.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p1.1.m1.1d">italic_γ</annotation></semantics></math>. We conducted a comparative study to examine how it impacts the quality of the image produced through style injection, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F8" title="Figure 8 ‣ 5.3.1 Phase-1: Style-Injection (Image-to-Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.1.1" style="width:47.7pt;"><span class="ltx_text" id="S5.F8.1.1.1"><math alttext="\gamma=0.9" class="ltx_Math" display="inline" id="S5.F8.1.1.1.m1.1"><semantics id="S5.F8.1.1.1.m1.1a"><mrow id="S5.F8.1.1.1.m1.1.1" xref="S5.F8.1.1.1.m1.1.1.cmml"><mi id="S5.F8.1.1.1.m1.1.1.2" xref="S5.F8.1.1.1.m1.1.1.2.cmml">γ</mi><mo id="S5.F8.1.1.1.m1.1.1.1" xref="S5.F8.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F8.1.1.1.m1.1.1.3" xref="S5.F8.1.1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.1.1.1.m1.1b"><apply id="S5.F8.1.1.1.m1.1.1.cmml" xref="S5.F8.1.1.1.m1.1.1"><eq id="S5.F8.1.1.1.m1.1.1.1.cmml" xref="S5.F8.1.1.1.m1.1.1.1"></eq><ci id="S5.F8.1.1.1.m1.1.1.2.cmml" xref="S5.F8.1.1.1.m1.1.1.2">𝛾</ci><cn id="S5.F8.1.1.1.m1.1.1.3.cmml" type="float" xref="S5.F8.1.1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.1.1.1.m1.1c">\gamma=0.9</annotation><annotation encoding="application/x-llamapun" id="S5.F8.1.1.1.m1.1d">italic_γ = 0.9</annotation></semantics></math></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.2.1" style="width:47.7pt;"><span class="ltx_text" id="S5.F8.2.1.1"><math alttext="\gamma=0.75" class="ltx_Math" display="inline" id="S5.F8.2.1.1.m1.1"><semantics id="S5.F8.2.1.1.m1.1a"><mrow id="S5.F8.2.1.1.m1.1.1" xref="S5.F8.2.1.1.m1.1.1.cmml"><mi id="S5.F8.2.1.1.m1.1.1.2" xref="S5.F8.2.1.1.m1.1.1.2.cmml">γ</mi><mo id="S5.F8.2.1.1.m1.1.1.1" xref="S5.F8.2.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F8.2.1.1.m1.1.1.3" xref="S5.F8.2.1.1.m1.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.2.1.1.m1.1b"><apply id="S5.F8.2.1.1.m1.1.1.cmml" xref="S5.F8.2.1.1.m1.1.1"><eq id="S5.F8.2.1.1.m1.1.1.1.cmml" xref="S5.F8.2.1.1.m1.1.1.1"></eq><ci id="S5.F8.2.1.1.m1.1.1.2.cmml" xref="S5.F8.2.1.1.m1.1.1.2">𝛾</ci><cn id="S5.F8.2.1.1.m1.1.1.3.cmml" type="float" xref="S5.F8.2.1.1.m1.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.2.1.1.m1.1c">\gamma=0.75</annotation><annotation encoding="application/x-llamapun" id="S5.F8.2.1.1.m1.1d">italic_γ = 0.75</annotation></semantics></math></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.3.1" style="width:47.7pt;"><span class="ltx_text" id="S5.F8.3.1.1"><math alttext="\gamma=0.5" class="ltx_Math" display="inline" id="S5.F8.3.1.1.m1.1"><semantics id="S5.F8.3.1.1.m1.1a"><mrow id="S5.F8.3.1.1.m1.1.1" xref="S5.F8.3.1.1.m1.1.1.cmml"><mi id="S5.F8.3.1.1.m1.1.1.2" xref="S5.F8.3.1.1.m1.1.1.2.cmml">γ</mi><mo id="S5.F8.3.1.1.m1.1.1.1" xref="S5.F8.3.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F8.3.1.1.m1.1.1.3" xref="S5.F8.3.1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.3.1.1.m1.1b"><apply id="S5.F8.3.1.1.m1.1.1.cmml" xref="S5.F8.3.1.1.m1.1.1"><eq id="S5.F8.3.1.1.m1.1.1.1.cmml" xref="S5.F8.3.1.1.m1.1.1.1"></eq><ci id="S5.F8.3.1.1.m1.1.1.2.cmml" xref="S5.F8.3.1.1.m1.1.1.2">𝛾</ci><cn id="S5.F8.3.1.1.m1.1.1.3.cmml" type="float" xref="S5.F8.3.1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.3.1.1.m1.1c">\gamma=0.5</annotation><annotation encoding="application/x-llamapun" id="S5.F8.3.1.1.m1.1d">italic_γ = 0.5</annotation></semantics></math></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.4.1" style="width:47.7pt;"><span class="ltx_text" id="S5.F8.4.1.1"><math alttext="\gamma=0.3" class="ltx_Math" display="inline" id="S5.F8.4.1.1.m1.1"><semantics id="S5.F8.4.1.1.m1.1a"><mrow id="S5.F8.4.1.1.m1.1.1" xref="S5.F8.4.1.1.m1.1.1.cmml"><mi id="S5.F8.4.1.1.m1.1.1.2" xref="S5.F8.4.1.1.m1.1.1.2.cmml">γ</mi><mo id="S5.F8.4.1.1.m1.1.1.1" xref="S5.F8.4.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F8.4.1.1.m1.1.1.3" xref="S5.F8.4.1.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.4.1.1.m1.1b"><apply id="S5.F8.4.1.1.m1.1.1.cmml" xref="S5.F8.4.1.1.m1.1.1"><eq id="S5.F8.4.1.1.m1.1.1.1.cmml" xref="S5.F8.4.1.1.m1.1.1.1"></eq><ci id="S5.F8.4.1.1.m1.1.1.2.cmml" xref="S5.F8.4.1.1.m1.1.1.2">𝛾</ci><cn id="S5.F8.4.1.1.m1.1.1.3.cmml" type="float" xref="S5.F8.4.1.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.4.1.1.m1.1c">\gamma=0.3</annotation><annotation encoding="application/x-llamapun" id="S5.F8.4.1.1.m1.1d">italic_γ = 0.3</annotation></semantics></math></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.5" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.5.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.9_image_18_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.6" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.6.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.75_image_18_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.7" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.7.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.5_image_18_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.F8.8" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.8.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.3_image_18_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F8.9" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.9.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.9_image_58_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F8.10" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.10.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.75_image_58_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F8.11" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.11.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.5_image_58_stylized_ship_247.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F8.12" style="width:43.4pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F8.12.g1" src="extracted/5918985/Images/Ablation_Study_Style_Injection/0.3_image_58_stylized_ship_247.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.16.2.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S5.F8.14.1" style="font-size:90%;">Style and Content Fidelity (<math alttext="\gamma" class="ltx_Math" display="inline" id="S5.F8.14.1.m1.1"><semantics id="S5.F8.14.1.m1.1b"><mi id="S5.F8.14.1.m1.1.1" xref="S5.F8.14.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.F8.14.1.m1.1c"><ci id="S5.F8.14.1.m1.1.1.cmml" xref="S5.F8.14.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.14.1.m1.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.F8.14.1.m1.1e">italic_γ</annotation></semantics></math>); Lower values improve style fidelity but may reduce content fidelity.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.SSS1.p2">
<p class="ltx_p" id="S5.SS3.SSS1.p2.3">The generated images appear to be similar to each other. However, qualitative metrics such as SSIM and PSNR (refer to Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.T4" title="Table 4 ‣ 5.3.1 Phase-1: Style-Injection (Image-to-Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">4</span></a>) were computed for images generated with <math alttext="\gamma=\{0.9,0.75,0.5,0.3\}" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.1.m1.4"><semantics id="S5.SS3.SSS1.p2.1.m1.4a"><mrow id="S5.SS3.SSS1.p2.1.m1.4.5" xref="S5.SS3.SSS1.p2.1.m1.4.5.cmml"><mi id="S5.SS3.SSS1.p2.1.m1.4.5.2" xref="S5.SS3.SSS1.p2.1.m1.4.5.2.cmml">γ</mi><mo id="S5.SS3.SSS1.p2.1.m1.4.5.1" xref="S5.SS3.SSS1.p2.1.m1.4.5.1.cmml">=</mo><mrow id="S5.SS3.SSS1.p2.1.m1.4.5.3.2" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml"><mo id="S5.SS3.SSS1.p2.1.m1.4.5.3.2.1" stretchy="false" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml">{</mo><mn id="S5.SS3.SSS1.p2.1.m1.1.1" xref="S5.SS3.SSS1.p2.1.m1.1.1.cmml">0.9</mn><mo id="S5.SS3.SSS1.p2.1.m1.4.5.3.2.2" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS3.SSS1.p2.1.m1.2.2" xref="S5.SS3.SSS1.p2.1.m1.2.2.cmml">0.75</mn><mo id="S5.SS3.SSS1.p2.1.m1.4.5.3.2.3" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS3.SSS1.p2.1.m1.3.3" xref="S5.SS3.SSS1.p2.1.m1.3.3.cmml">0.5</mn><mo id="S5.SS3.SSS1.p2.1.m1.4.5.3.2.4" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS3.SSS1.p2.1.m1.4.4" xref="S5.SS3.SSS1.p2.1.m1.4.4.cmml">0.3</mn><mo id="S5.SS3.SSS1.p2.1.m1.4.5.3.2.5" stretchy="false" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.1.m1.4b"><apply id="S5.SS3.SSS1.p2.1.m1.4.5.cmml" xref="S5.SS3.SSS1.p2.1.m1.4.5"><eq id="S5.SS3.SSS1.p2.1.m1.4.5.1.cmml" xref="S5.SS3.SSS1.p2.1.m1.4.5.1"></eq><ci id="S5.SS3.SSS1.p2.1.m1.4.5.2.cmml" xref="S5.SS3.SSS1.p2.1.m1.4.5.2">𝛾</ci><set id="S5.SS3.SSS1.p2.1.m1.4.5.3.1.cmml" xref="S5.SS3.SSS1.p2.1.m1.4.5.3.2"><cn id="S5.SS3.SSS1.p2.1.m1.1.1.cmml" type="float" xref="S5.SS3.SSS1.p2.1.m1.1.1">0.9</cn><cn id="S5.SS3.SSS1.p2.1.m1.2.2.cmml" type="float" xref="S5.SS3.SSS1.p2.1.m1.2.2">0.75</cn><cn id="S5.SS3.SSS1.p2.1.m1.3.3.cmml" type="float" xref="S5.SS3.SSS1.p2.1.m1.3.3">0.5</cn><cn id="S5.SS3.SSS1.p2.1.m1.4.4.cmml" type="float" xref="S5.SS3.SSS1.p2.1.m1.4.4">0.3</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.1.m1.4c">\gamma=\{0.9,0.75,0.5,0.3\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.1.m1.4d">italic_γ = { 0.9 , 0.75 , 0.5 , 0.3 }</annotation></semantics></math> and found that as <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.2.m2.1"><semantics id="S5.SS3.SSS1.p2.2.m2.1a"><mi id="S5.SS3.SSS1.p2.2.m2.1.1" xref="S5.SS3.SSS1.p2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.2.m2.1b"><ci id="S5.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S5.SS3.SSS1.p2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.2.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.2.m2.1d">italic_γ</annotation></semantics></math> decreases, there is a noticeable improvement in both SSIM and PSNR, indicating a gradual enhancement in visual quality and fidelity. For our main model, we set <math alttext="\gamma=0.5" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p2.3.m3.1"><semantics id="S5.SS3.SSS1.p2.3.m3.1a"><mrow id="S5.SS3.SSS1.p2.3.m3.1.1" xref="S5.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S5.SS3.SSS1.p2.3.m3.1.1.2" xref="S5.SS3.SSS1.p2.3.m3.1.1.2.cmml">γ</mi><mo id="S5.SS3.SSS1.p2.3.m3.1.1.1" xref="S5.SS3.SSS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.SSS1.p2.3.m3.1.1.3" xref="S5.SS3.SSS1.p2.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p2.3.m3.1b"><apply id="S5.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S5.SS3.SSS1.p2.3.m3.1.1"><eq id="S5.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S5.SS3.SSS1.p2.3.m3.1.1.1"></eq><ci id="S5.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S5.SS3.SSS1.p2.3.m3.1.1.2">𝛾</ci><cn id="S5.SS3.SSS1.p2.3.m3.1.1.3.cmml" type="float" xref="S5.SS3.SSS1.p2.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p2.3.m3.1c">\gamma=0.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p2.3.m3.1d">italic_γ = 0.5</annotation></semantics></math> as the default value, striking a balance between preserving content and injecting stylistic information while avoiding excessive distortion or loss of essential content features.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T4.1">
<tr class="ltx_tr" id="S5.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.1.1.1"><math alttext="\gamma" class="ltx_Math" display="inline" id="S5.T4.1.1.1.m1.1"><semantics id="S5.T4.1.1.1.m1.1a"><mi id="S5.T4.1.1.1.m1.1.1" xref="S5.T4.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.m1.1d">italic_γ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.2.1">SSIM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.3.1">PSNR</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T4.1.2.1">0.9</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.2">0.2360</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.3">11.1372</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T4.1.3.1">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.2">0.2535</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.3">11.3949</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S5.T4.1.4.1">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.2">0.2696</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.3">11.5774</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S5.T4.1.5.1">0.3</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T4.1.5.2">0.2761</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T4.1.5.3">11.6498</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.5.2.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.3.1" style="font-size:90%;">SSIM &amp; PSNR w.r.t. fidelity (<math alttext="\gamma" class="ltx_Math" display="inline" id="S5.T4.3.1.m1.1"><semantics id="S5.T4.3.1.m1.1b"><mi id="S5.T4.3.1.m1.1.1" xref="S5.T4.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.T4.3.1.m1.1c"><ci id="S5.T4.3.1.m1.1.1.cmml" xref="S5.T4.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.1.m1.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.1.m1.1e">italic_γ</annotation></semantics></math>) for the images in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F8" title="Figure 8 ‣ 5.3.1 Phase-1: Style-Injection (Image-to-Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">8</span></a></span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2 </span>Phase-2 &amp; 3: Fine-Tuning (Text-to–Image)</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">The number of training steps significantly impacts the quality of the generated images. To verify the same, a qualitative study on the outputs of the trained model (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F7" title="Figure 7 ‣ 5.2 Phase-2 &amp; 3: Fine-Tuning Results ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">7</span></a>) is carried out. It is observed that at lower step counts, the images tend to be coarse, with artifacts or incomplete object representations. Increasing the number of steps leads to sharper images with clearer object boundaries and better textures, allowing for more accurate and realistic depictions of underwater scenes.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.1">For the ship category, the model started generating sonar images only after 3000 training steps. Between 5000 and 10000 training steps, the quality of the generated images was good. However, after 10000 training steps, the model failed to produce the expected output and instead generated multiple ships. In the context of planes, the given prompt “Image of a PL71* plane in a sandy AS25* seabed, with a broken tail and shadow extending to the front and left" is relatively intricate. The model started generating sonar images after 1500 training iterations and consistently produced satisfactory outcomes until 5000 training iterations. However, after 6500 training iterations, the model yielded unsatisfactory outputs with multiple aircraft.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p3">
<p class="ltx_p" id="S5.SS3.SSS2.p3.1">In this setting, the output is influenced by the quality of the input dataset and the training stages. Due to computational constraints, advanced models like Stable Diffusion 2 and 3 were not explored in this study. The developed model has the capability to generate sonar images. However, it is uncertain how consistent the results are. In the experiments, it successfully produced images in 6 out of 10 trials, but sometimes the model hallucinates and leads to inaccurate responses. Some of such failure cases are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.F9" title="Figure 9 ‣ 5.3.2 Phase-2 &amp; 3: Fine-Tuning (Text-to–Image) ‣ 5.3 Ablation study ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">9</span></a>. Hence, in this pilot study, we develop a proof of concept rather than a comprehensive model.</p>
</div>
<figure class="ltx_figure" id="S5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.1" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.1.g1" src="extracted/5918985/Images/Failed_cases/Image_of_a_DP1_plane_in_a_sandy_SEF_seabed_3000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.2" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.2.g1" src="extracted/5918985/Images/Failed_cases/image_of_SH33_ship_on_AP156_2500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.3" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.3.g1" src="extracted/5918985/Images/Failed_cases/PL2_PLANE_in_AP206_3500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.4" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.4.g1" src="extracted/5918985/Images/Failed_cases/PL2_PLANE_in_AP206_lora_3500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.5" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.5.g1" src="extracted/5918985/Images/Fails/DP97_plane_in_SEF_10000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.6" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.6.g1" src="extracted/5918985/Images/Fails/PL0_PLANE_in_AP529_2000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.7" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.7.g1" src="extracted/5918985/Images/Fails/BM_In_the_left_side_of_the_ASB48.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.8" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.8.g1" src="extracted/5918985/Images/Fails/Photo_of_Ball_shaped_BM_mine_on_the_left_side_of_the_ASB121.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.9" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.9.g1" src="extracted/5918985/Images/Fails/PL2_PLANE_in_AP526_lora_3500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.10" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.10.g1" src="extracted/5918985/Images/Fails/photo_of_Truncated_cone_mine_TCM_mine_in_the_middle_of_the_ASB72_seabed,_shadow_extending_north_6500.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.11" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.11.g1" src="extracted/5918985/Images/Fails/Image_of_a_DP1_plane_in_a_sandy_SEF_2000.jpg" width="598"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.12" style="width:47.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S5.F9.12.g1" src="extracted/5918985/Images/Fails/DP97_plane_with_shadow_on_its_left_in_SEF_5000.jpg" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F9.14.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S5.F9.15.2" style="font-size:90%;">Failures from the trained model</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>State-of-the-art Comparison</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To the best of our knowledge, our work is the first work in text-conditioned image generation for underwatersonarimagery, and it lacks benchmark datasets, thereby hindering our ability to fully assess the model’s performance. However, to showcase the efficacy of the proposed architecture, we compared our work with existing similar image-to-image synthesis work and tabulated the results in the Table. <a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#S5.T5" title="Table 5 ‣ 5.4 State-of-the-art Comparison ‣ 5 Experimental Results ‣ Synth-SONAR: Sonar Image Synthesis with Enhanced Diversity and Realism via Dual Diffusion Models and GPT Prompting"><span class="ltx_text ltx_ref_tag">5</span></a>. Our model outperforms the state-of-the-art models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib50" title="">50</a>]</cite>,
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib45" title="">45</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib48" title="">48</a>]</cite> in terms of image quality, with high SSIM &amp; PSNR values and low FID value.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T5.2">
<tr class="ltx_tr" id="S5.T5.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T5.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T5.2.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.1.2"><span class="ltx_text ltx_font_bold" id="S5.T5.2.1.2.1">FID</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T5.2.1.3.1">SSIM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.1.4"><span class="ltx_text ltx_font_bold" id="S5.T5.2.1.4.1">PSNR</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T5.2.2.1">Zhiwei et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib50" title="">50</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.2.2">138.56</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.2.3">0.2512</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.2.4">11.1764</td>
</tr>
<tr class="ltx_tr" id="S5.T5.2.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T5.2.3.1">Wen et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.3.2">0.2527</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.3.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.3.4">-</td>
</tr>
<tr class="ltx_tr" id="S5.T5.2.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T5.2.4.1">Yang et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08612v1#bib.bib48" title="">48</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.4.2">147.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.4.3">0.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.2.4.4">16.3</td>
</tr>
<tr class="ltx_tr" id="S5.T5.2.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T5.2.5.1">Synth-SONAR (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.2.5.2">3.8</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.2.5.3">0.381</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.2.5.4">12.730</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T5.4.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S5.T5.5.2" style="font-size:90%;color:#000000;">State-of-the-art Comparison</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we present “Synth-SONAR", a novel framework for sonar image synthesis that leverages dual diffusion models and GPT prompting. Synth-SONAR overcomes traditional data collection challenges by creating a large, diverse, and high-quality sonar dataset. The framework uniquely integrates Generative AI-based style injection with real and simulated data and utilizes a dual text-conditioning diffusion model to generate synthetic sonar images from both high-level (coarse) and low-level (detailed) prompts. This approach bridges the gap between textual descriptions and sonar image generation, achieving state-of-the-art performance in enhancing image diversity and realism. Future work could focus on expanding Synth-SONAR across different underwater research applications.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgements</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">This work was partially supported by the Naval Research Board (NRB), DRDO, Government of India under grant number: NRB/505/SG/22-23.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.1.1" style="font-size:90%;">
Omar Almutiry, Khalid Iqbal, Shariq Hussain, Awais Mahmood, and Habib Dhahri.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.2.1" style="font-size:90%;">Underwater images contrast enhancement and its challenges: a survey.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.3.1" style="font-size:90%;">Multimedia Tools and Applications</span><span class="ltx_text" id="bib.bib1.4.2" style="font-size:90%;">, pages 1–26, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.1.1" style="font-size:90%;">
PA Arjun, S Suryanarayan, RS Viswamanav, S Abhishek, and T Anjali.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.2.1" style="font-size:90%;">Unveiling underwater structures: Mobilenet vs. efficientnet in sonar image detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.3.1" style="font-size:90%;">Procedia Computer Science</span><span class="ltx_text" id="bib.bib2.4.2" style="font-size:90%;">, 233:518–527, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.1.1" style="font-size:90%;">
Zhongyu Bai, Hongli Xu, Qichuan Ding, and Xiangyue Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.2.1" style="font-size:90%;">Side-scan sonar image classification with zero-shot and style transfer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.3.1" style="font-size:90%;">IEEE Transactions on Instrumentation and Measurement</span><span class="ltx_text" id="bib.bib3.4.2" style="font-size:90%;">, 73:1–15, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.1.1" style="font-size:90%;">
Tom B Brown.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.2.1" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.3.1" style="font-size:90%;">arXiv preprint arXiv:2005.14165</span><span class="ltx_text" id="bib.bib4.4.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.1.1" style="font-size:90%;">
Hanqun Cao, Cheng Tan, Zhangyang Gao, Yilun Xu, Guangyong Chen, Pheng-Ann Heng, and Stan Z Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.2.1" style="font-size:90%;">A survey on generative diffusion models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.3.1" style="font-size:90%;">IEEE Transactions on Knowledge and Data Engineering</span><span class="ltx_text" id="bib.bib5.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.1.1" style="font-size:90%;">
Turgay Celik and Tardi Tjahjadi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.2.1" style="font-size:90%;">A novel method for sidescan sonar image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.3.1" style="font-size:90%;">IEEE Journal of Oceanic Engineering</span><span class="ltx_text" id="bib.bib6.4.2" style="font-size:90%;">, 36(2):186–194, 2011.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.1.1" style="font-size:90%;">
Jiwoo Chung, Sangeek Hyun, and Jae-Pil Heo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.2.1" style="font-size:90%;">Style injection in diffusion: A training-free approach for adapting large-scale diffusion models for style transfer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib7.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib7.5.3" style="font-size:90%;">, pages 8795–8805, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.1.1" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.2.1" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib8.4.2" style="font-size:90%;">2009 IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib8.5.3" style="font-size:90%;">, pages 248–255. Ieee, 2009.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.1.1" style="font-size:90%;">
Leon A Gatys.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.2.1" style="font-size:90%;">A neural algorithm of artistic style.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.3.1" style="font-size:90%;">arXiv preprint arXiv:1508.06576</span><span class="ltx_text" id="bib.bib9.4.2" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.1.1" style="font-size:90%;">
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.2.1" style="font-size:90%;">Generative adversarial nets.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib10.4.2" style="font-size:90%;">, 27, 2014.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.1.1" style="font-size:90%;">
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.2.1" style="font-size:90%;">Generative adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.3.1" style="font-size:90%;">Communications of the ACM</span><span class="ltx_text" id="bib.bib11.4.2" style="font-size:90%;">, 63(11):139–144, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.1.1" style="font-size:90%;">
Ju He, Hu Xu, Shaohong Li, and Yang Yu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.2.1" style="font-size:90%;">Efficient sonarnet: Lightweight cnn grafted vision transformer embedding network for forward-looking sonar image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.3.1" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</span><span class="ltx_text" id="bib.bib12.4.2" style="font-size:90%;">, pages 1–1, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.1.1" style="font-size:90%;">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.2.1" style="font-size:90%;">Denoising diffusion probabilistic models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib13.4.2" style="font-size:90%;">, 33:6840–6851, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.1.1" style="font-size:90%;">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.2.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.3.1" style="font-size:90%;">arXiv preprint arXiv:2106.09685</span><span class="ltx_text" id="bib.bib14.4.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.1.1" style="font-size:90%;">
Chao Huang, Jianhu Zhao, Hongmei Zhang, and Yongcan Yu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.2.1" style="font-size:90%;">Seg2sonar: A full-class sample synthesis method applied to underwater sonar image target detection, recognition, and segmentation tasks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.3.1" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</span><span class="ltx_text" id="bib.bib15.4.2" style="font-size:90%;">, 62:1–19, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.1.1" style="font-size:90%;">
Guanying Huo, Ziyin Wu, and Jiabiao Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.2.1" style="font-size:90%;">Underwater object classification in sidescan sonar images using deep transfer learning and semisynthetic training data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.3.1" style="font-size:90%;">IEEE access</span><span class="ltx_text" id="bib.bib16.4.2" style="font-size:90%;">, 8:47407–47418, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.1.1" style="font-size:90%;">
Marija Jegorova, Antti Ilari Karjalainen, Jose Vazquez, and Timothy Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.2.1" style="font-size:90%;">Full-scale continuous synthetic sonar data generation with markov conditional generative adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib17.4.2" style="font-size:90%;">2020 IEEE International Conference on Robotics and Automation (ICRA)</span><span class="ltx_text" id="bib.bib17.5.3" style="font-size:90%;">, pages 3168–3174. IEEE, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.1.1" style="font-size:90%;">
Yifan Jiang, Bonhwa Ku, Wanjin Kim, and Hanseok Ko.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.2.1" style="font-size:90%;">Side-scan sonar image synthesis based on generative adversarial network for images in multiple frequencies.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.3.1" style="font-size:90%;">IEEE Geoscience and Remote Sensing Letters</span><span class="ltx_text" id="bib.bib18.4.2" style="font-size:90%;">, 18(9):1505–1509, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.1.1" style="font-size:90%;">
Diederik P Kingma.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.2.1" style="font-size:90%;">Auto-encoding variational bayes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.3.1" style="font-size:90%;">arXiv preprint arXiv:1312.6114</span><span class="ltx_text" id="bib.bib19.4.2" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.1.1" style="font-size:90%;">
Sunmo Koo, Sangpil Youm, and Jane Shin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.2.1" style="font-size:90%;">Cycle-gan-based synthetic sonar image generation for improved underwater classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib20.4.2" style="font-size:90%;">Ocean Sensing and Monitoring XVI</span><span class="ltx_text" id="bib.bib20.5.3" style="font-size:90%;">, volume 13061, pages 69–83. SPIE, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.1.1" style="font-size:90%;">
Sejin Lee, Byungjae Park, and Ayoung Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.2.1" style="font-size:90%;">Deep learning from shallow dives: Sonar image generation and training for underwater object detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.3.1" style="font-size:90%;">arXiv preprint arXiv:1810.07990</span><span class="ltx_text" id="bib.bib21.4.2" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.1.1" style="font-size:90%;">
Junnan Li, Dongxu Li, Caiming Xiong, and Steven Hoi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.2.1" style="font-size:90%;">Blip: Bootstrapping language-image pre-training for unified vision-language understanding and generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib22.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib22.5.3" style="font-size:90%;">, pages 12888–12900. PMLR, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.1.1" style="font-size:90%;">
Zikang Li, Zhuojun Xie, Puhong Duan, Xudong Kang, and Shutao Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.2.1" style="font-size:90%;">Dual spatial attention network for underwater object detection with sonar imagery.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.3.1" style="font-size:90%;">IEEE Sensors Journal</span><span class="ltx_text" id="bib.bib23.4.2" style="font-size:90%;">, 24(5):6998–7008, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.1.1" style="font-size:90%;">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.2.1" style="font-size:90%;">Visual instruction tuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib24.4.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.1.1" style="font-size:90%;">
Max Mignotte, Christophe Collet, Patrick Pérez, and Patrick Bouthemy.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.2.1" style="font-size:90%;">Three-class markovian segmentation of high-resolution sonar images.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.3.1" style="font-size:90%;">Computer Vision and Image Understanding</span><span class="ltx_text" id="bib.bib25.4.2" style="font-size:90%;">, 76(3):191–204, 1999.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.1.1" style="font-size:90%;">
M. Mignotte, C. Collet, P. Perez, and P. Bouthemy.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.2.1" style="font-size:90%;">Sonar image segmentation using an unsupervised hierarchical mrf model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.3.1" style="font-size:90%;">IEEE Transactions on Image Processing</span><span class="ltx_text" id="bib.bib26.4.2" style="font-size:90%;">, 9(7):1216–1231, 2000.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.1.1" style="font-size:90%;">
Purushothaman Natarajan and Athira Nambiar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.2.1" style="font-size:90%;">Underwater sonar image classification and analysis using lime-based explainable artificial intelligence.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.3.1" style="font-size:90%;">arXiv preprint arXiv:2408.12837</span><span class="ltx_text" id="bib.bib27.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.1.1" style="font-size:90%;">
Purushothaman Natarajan and Athira Nambiar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.2.1" style="font-size:90%;">Vale: A multimodal visual and language explanation framework for image classifiers using explainable ai and language models, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.1.1" style="font-size:90%;">
Dong Nie, Roger Trullo, Jun Lian, Caroline Petitjean, Su Ruan, Qian Wang, and Dinggang Shen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.2.1" style="font-size:90%;">Medical image synthesis with context-aware generative adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib29.4.2" style="font-size:90%;">Medical Image Computing and Computer Assisted Intervention- MICCAI 2017: 20th International Conference, Quebec City, QC, Canada, September 11-13, 2017, Proceedings, Part III 20</span><span class="ltx_text" id="bib.bib29.5.3" style="font-size:90%;">, pages 417–425. Springer, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.1.1" style="font-size:90%;">
Niki Parmar, Ashish Vaswani, Jakob Uszkoreit, Lukasz Kaiser, Noam Shazeer, Alexander Ku, and Dustin Tran.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.2.1" style="font-size:90%;">Image transformer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib30.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib30.5.3" style="font-size:90%;">, pages 4055–4064. PMLR, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.1.1" style="font-size:90%;">
Chengyang Peng, Shaohua Jin, Gang Bian, and Yang Cui.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.2.1" style="font-size:90%;">Sigan: A multi-scale generative adversarial network for underwater sonar image super-resolution.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.3.1" style="font-size:90%;">Journal of Marine Science and Engineering</span><span class="ltx_text" id="bib.bib31.4.2" style="font-size:90%;">, 12(7):1057, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.1.1" style="font-size:90%;">
Chengyang Peng, Shaohua Jin, Gang Bian, Yang Cui, and Meina Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.2.1" style="font-size:90%;">Sample augmentation method for side-scan sonar underwater target images based on cbl-singan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.3.1" style="font-size:90%;">Journal of Marine Science and Engineering</span><span class="ltx_text" id="bib.bib32.4.2" style="font-size:90%;">, 12(3):467, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.1.1" style="font-size:90%;">
Alan Preciado-Grijalva, Bilal Wehbe, Miguel Bande Firvida, and Matias Valdenegro-Toro.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.2.1" style="font-size:90%;">Self-supervised learning for sonar image classification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib33.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops</span><span class="ltx_text" id="bib.bib33.5.3" style="font-size:90%;">, pages 1499–1508, June 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.1.1" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.2.1" style="font-size:90%;">Learning transferable visual models from natural language supervision.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib34.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib34.5.3" style="font-size:90%;">, pages 8748–8763. PMLR, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.1.1" style="font-size:90%;">
Aditya Ramesh, Mikhail Pavlov, Gabriel Goh, Scott Gray, Chelsea Voss, Alec Radford, Mark Chen, and Ilya Sutskever.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.2.1" style="font-size:90%;">Zero-shot text-to-image generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.3.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib35.4.2" style="font-size:90%;">, abs/2102.12092, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.1.1" style="font-size:90%;">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.2.1" style="font-size:90%;">High-resolution image synthesis with latent diffusion models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib36.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib36.5.3" style="font-size:90%;">, pages 10684–10695, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.1.1" style="font-size:90%;">
Kamal Basha S and Athira Nambiar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.2.1" style="font-size:90%;">S3simulator: A benchmarking side scan sonar simulator dataset for underwater image analysis, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.1.1" style="font-size:90%;">
Christoph Schuhmann, Romain Beaumont, Richard Vencu, Cade Gordon, Ross Wightman, Mehdi Cherti, Theo Coombes, Aarush Katta, Clayton Mullis, Mitchell Wortsman, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.2.1" style="font-size:90%;">Laion-5b: An open large-scale dataset for training next generation image-text models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib38.4.2" style="font-size:90%;">, 35:25278–25294, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.1.1" style="font-size:90%;">
Advaith V Sethuraman, Anja Sheppard, Onur Bagoren, Christopher Pinnow, Jamey Anderson, Timothy C Havens, and Katherine A Skinner.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.2.1" style="font-size:90%;">Machine learning for shipwreck segmentation from side scan sonar imagery: Dataset and benchmark.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib39.3.1" style="font-size:90%;">The International Journal of Robotics Research</span><span class="ltx_text" id="bib.bib39.4.2" style="font-size:90%;">, page 02783649241266853, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.1.1" style="font-size:90%;">
Jane Shin, Shi Chang, Matthew J Bays, Joshua Weaver, Thomas A Wettergren, and Silvia Ferrari.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.2.1" style="font-size:90%;">Synthetic sonar image simulation with various seabed conditions for automatic target recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib40.4.2" style="font-size:90%;">OCEANS 2022, Hampton Roads</span><span class="ltx_text" id="bib.bib40.5.3" style="font-size:90%;">, pages 1–8. IEEE, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.1.1" style="font-size:90%;">
Yasin Shokrollahi, Sahar Yarmohammadtoosky, Matthew M Nikahd, Pengfei Dong, Xianqi Li, and Linxia Gu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.2.1" style="font-size:90%;">A comprehensive review of generative ai in healthcare.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.3.1" style="font-size:90%;">arXiv preprint arXiv:2310.00795</span><span class="ltx_text" id="bib.bib41.4.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.1.1" style="font-size:90%;">
Amanpreet Singh, Ronghang Hu, Vedanuj Goswami, Guillaume Couairon, Wojciech Galuba, Marcus Rohrbach, and Douwe Kiela.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.2.1" style="font-size:90%;">Flava: A foundational language and vision alignment model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib42.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib42.5.3" style="font-size:90%;">, pages 15638–15650, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.1.1" style="font-size:90%;">
Nitish Srivastava and Russ R Salakhutdinov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.2.1" style="font-size:90%;">Multimodal learning with deep boltzmann machines.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib43.4.2" style="font-size:90%;">, 25, 2012.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.1.1" style="font-size:90%;">
Qi Wang, YiXiao Zhang, Huanjin Wang, and Bo He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.2.1" style="font-size:90%;">Multi-level feature representation framework with adaptive margin loss for few-shot sonar images classification of auvs.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib44.3.1" style="font-size:90%;">IEEE Transactions on Intelligent Vehicles</span><span class="ltx_text" id="bib.bib44.4.2" style="font-size:90%;">, pages 1–13, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.1.1" style="font-size:90%;">
Xin Wen, Feihu Zhang, Chensheng Cheng, Xujia Hou, and Guang Pan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.2.1" style="font-size:90%;">Side-scan sonar underwater target detection: Combining the diffusion model with an improved yolov7 model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.3.1" style="font-size:90%;">IEEE Journal of Oceanic Engineering</span><span class="ltx_text" id="bib.bib45.4.2" style="font-size:90%;">, 49(3):976–991, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.1.1" style="font-size:90%;">
Haesang Yang, Sung-Hoon Byun, Keunhwa Lee, Youngmin Choo, and Kookhyun Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.2.1" style="font-size:90%;">Underwater acoustic research trends with machine learning: Active sonar applications.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.3.1" style="font-size:90%;">Journal of Ocean Engineering and Technology</span><span class="ltx_text" id="bib.bib46.4.2" style="font-size:90%;">, 34(4):277–284, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.1.1" style="font-size:90%;">
Zhiwei Yang, Jianhu Zhao, Yongcan Yu, and Chao Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.2.1" style="font-size:90%;">A sample augmentation method for side-scan sonar full-class images that can be used for detection and segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib47.3.1" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</span><span class="ltx_text" id="bib.bib47.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.1.1" style="font-size:90%;">
Zhiwei Yang, Jianhu Zhao, Yongcan Yu, and Chao Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.2.1" style="font-size:90%;">A sample augmentation method for side-scan sonar full-class images that can be used for detection and segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.3.1" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</span><span class="ltx_text" id="bib.bib48.4.2" style="font-size:90%;">, 62:1–11, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.1.1" style="font-size:90%;">
Zhiwei Yang, Jianhu Zhao, Hongmei Zhang, Yongcan Yu, and Chao Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.2.1" style="font-size:90%;">A side-scan sonar image synthesis method based on a diffusion model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.3.1" style="font-size:90%;">Journal of Marine Science and Engineering</span><span class="ltx_text" id="bib.bib49.4.2" style="font-size:90%;">, 11(6):1103, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.1.1" style="font-size:90%;">
Zhiwei Yang, Jianhu Zhao, Hongmei Zhang, Yongcan Yu, and Chao Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.2.1" style="font-size:90%;">A side-scan sonar image synthesis method based on a diffusion model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.3.1" style="font-size:90%;">Journal of Marine Science and Engineering</span><span class="ltx_text" id="bib.bib50.4.2" style="font-size:90%;">, 11(6), 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.1.1" style="font-size:90%;">
Handi Yu and Xin Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.2.1" style="font-size:90%;">Intelligent corner synthesis via cycle-consistent generative adversarial networks for efficient validation of autonomous driving systems.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib51.4.2" style="font-size:90%;">2018 23rd Asia and South Pacific design automation conference (ASP-DAC)</span><span class="ltx_text" id="bib.bib51.5.3" style="font-size:90%;">, pages 9–15. IEEE, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.1.1" style="font-size:90%;">
Jingyi Zhang, Jiaxing Huang, Sheng Jin, and Shijian Lu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.2.1" style="font-size:90%;">Vision-language models for vision tasks: A survey.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib52.3.1" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</span><span class="ltx_text" id="bib.bib52.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.1.1" style="font-size:90%;">
Peng Zhang, Jinsong Tang, Heping Zhong, Mingqiang Ning, Dandan Liu, and Ke Wu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.2.1" style="font-size:90%;">Self-trained target detection of radar and sonar images using automatic deep learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib53.3.1" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</span><span class="ltx_text" id="bib.bib53.4.2" style="font-size:90%;">, 60:1–14, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.1.1" style="font-size:90%;">
Jianqun Zhou, Yang Li, Hongmao Qin, Pengwen Dai, Zilong Zhao, and Manjiang Hu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.2.1" style="font-size:90%;">Sonar image generation by mfa-cyclegan for boosting underwater object detection of auvs.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.3.1" style="font-size:90%;">IEEE Journal of Oceanic Engineering</span><span class="ltx_text" id="bib.bib54.4.2" style="font-size:90%;">, 49(3):905–919, 2024.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct 11 08:10:54 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
