<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems</title>
<!--Generated on Mon Sep 23 03:11:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.14682v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S1" title="In Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S2" title="In Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S2.SS1" title="In 2. Background ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Graph-Aware Embedding-based Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S2.SS2" title="In 2. Background ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Multitask Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3" title="In Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Self-Supervised Multitask Learning for EBR</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS1" title="In 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Self-Supervised Learning Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS2" title="In 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS2.SSS1" title="In 3.2. Experimental Setup ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Problem Breakdown</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS2.SSS2" title="In 3.2. Experimental Setup ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Retrieval Baseline</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS2.SSS3" title="In 3.2. Experimental Setup ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>SSMTL Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.SS3" title="In 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S4" title="In Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Matthew Kolodner, Mingxuan Ju, Zihao Fan, Tong Zhao, Elham Ghazizadeh, Yan Wu, Neil Shah, Yozen Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Snap, Inc.</span><span class="ltx_text ltx_affiliation_streetaddress" id="id4.2.id2">2772 Donald Douglas Loop N</span><span class="ltx_text ltx_affiliation_city" id="id5.3.id3">Santa Monica</span><span class="ltx_text ltx_affiliation_state" id="id6.4.id4">CA</span><span class="ltx_text ltx_affiliation_country" id="id7.5.id5">USA</span><span class="ltx_text ltx_affiliation_postcode" id="id8.6.id6">90405</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:mkolodner,%20mju,%20zfan3,%20tong,%20eghazizadeh,%20ywu,%20nshah,%20yliu2@snap.com">mkolodner, mju, zfan3, tong, eghazizadeh, ywu, nshah, yliu2@snap.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id2.2">Improving recommendation systems (RS) can greatly enhance the user experience across many domains, such as social media. Many RS utilize embedding-based retrieval (EBR) approaches to retrieve candidates for recommendation. In an EBR system, the embedding quality is key. According to recent literature, self-supervised multitask learning (SSMTL) has showed strong performance on academic benchmarks in embedding learning and resulted in an overall improvement in multiple downstream tasks, demonstrating a larger resilience to the adverse conditions between each downstream task and thereby increased robustness and task generalization ability through the training objective. However, whether or not the success of SSMTL in academia as a robust training objectives translates to large-scale (i.e., over hundreds of million users and interactions in-between) industrial RS still requires verification. Simply adopting academic setups in industrial RS might entail two issues. Firstly, many self-supervised objectives require data augmentations (e.g., embedding masking/corruption) over a large portion of users and items, which is prohibitively expensive in industrial RS. Furthermore, some self-supervised objectives might not align with the recommendation task, which might lead to redundant computational overheads or negative transfer. In light of these two challenges, we evaluate using a robust training objective, specifically SSMTL, through a large-scale friend recommendation system on a social media platform in the tech sector, identifying whether this increase in robustness can work at scale in enhancing retrieval in the production setting. Through online A/B testing with SSMTL-based EBR, we observe statistically significant increases in key metrics in the friend recommendations, with up to <span class="ltx_text ltx_framed ltx_framed_underline" id="id1.1.1"><math alttext="\mathbf{5.45}\%" class="ltx_Math" display="inline" id="id1.1.1.m1.1"><semantics id="id1.1.1.m1.1a"><mrow id="id1.1.1.m1.1.1" xref="id1.1.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="id1.1.1.m1.1.1.2" mathvariant="bold" xref="id1.1.1.m1.1.1.2.cmml">5.45</mn><mo id="id1.1.1.m1.1.1.1" xref="id1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.1b"><apply id="id1.1.1.m1.1.1.cmml" xref="id1.1.1.m1.1.1"><csymbol cd="latexml" id="id1.1.1.m1.1.1.1.cmml" xref="id1.1.1.m1.1.1.1">percent</csymbol><cn id="id1.1.1.m1.1.1.2.cmml" type="float" xref="id1.1.1.m1.1.1.2">5.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">\mathbf{5.45}\%</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.m1.1d">bold_5.45 %</annotation></semantics></math></span> improvements in new friends made and <span class="ltx_text ltx_framed ltx_framed_underline" id="id2.2.2"><math alttext="\mathbf{1.91}\%" class="ltx_Math" display="inline" id="id2.2.2.m1.1"><semantics id="id2.2.2.m1.1a"><mrow id="id2.2.2.m1.1.1" xref="id2.2.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="id2.2.2.m1.1.1.2" mathvariant="bold" xref="id2.2.2.m1.1.1.2.cmml">1.91</mn><mo id="id2.2.2.m1.1.1.1" xref="id2.2.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id2.2.2.m1.1b"><apply id="id2.2.2.m1.1.1.cmml" xref="id2.2.2.m1.1.1"><csymbol cd="latexml" id="id2.2.2.m1.1.1.1.cmml" xref="id2.2.2.m1.1.1.1">percent</csymbol><cn id="id2.2.2.m1.1.1.2.cmml" type="float" xref="id2.2.2.m1.1.1.2">1.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.2.m1.1c">\mathbf{1.91}\%</annotation><annotation encoding="application/x-llamapun" id="id2.2.2.m1.1d">bold_1.91 %</annotation></semantics></math></span> improvements in new friends made with cold-start users. Besides, with a dedicated case study, the benefits of robust training objectives are demonstrated through SSMTL on large-scale graphs with gains in both retrieval and end-to-end friend recommendation.</p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>RobustRecsys workshop at RecSys; Oct. 14–18,
2024; Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>RobustRecsys workshop at the 18th ACM Conference on Recommender Systems (RecSys ’24), October 14–18, 2024, Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems (RS) have become a crucial component for user experience
 <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib1" title="">li2023recent, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib2" title="">sun2024survey, </a>)</cite>.
Most industrial RS explore a two-stage process <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib3" title="">10.1145/2959100.2959190, </a>)</cite>.
During the first stage (i.e., the <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">retrieval</span> phase), among hundreds of millions of candidate users/items, the RS usually utilizes several models optimized for recall to select a small set of candidate users/items (e.g., 1,000 candidates).
Whereas during the second stage (i.e., the <span class="ltx_text ltx_font_italic" id="S1.p1.1.2">ranking</span> phase), within the candidate subset, the RS can explore complicated expensive models that are optimized for precision to select top <math alttext="K" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">italic_K</annotation></semantics></math> candidates for the final recommendation.
Such two-stage process enables recommendation over large quantities of possible users/items and allows for greater flexibility towards key recommendation metrics.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In this two-stage scheme, the retrieval stage is especially important, as it acts as the bottleneck for possible candidates provided to the ranker in the second stage.
One common approach <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib4" title="">DBLP:journals/corr/abs-2006-11632, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib5" title="">gan2023binary, </a>)</cite> for the retrieval step is to leverage embedding-based retrieval (EBR).
Specifically, EBR learns embeddings for all users and items as vectors in a low-dimensional latent space.
These embeddings are learned in a way such that the distance between them is reflective of their similarity, with more similar items being closer together in the latent space.
As a result, candidates can be retrieved through a nearest-neighbor search across the latent space. In practice, this is done using an approximate nearest neighbor methods optimized for large-scale retrieval, such as FAISS <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib6" title="">DBLP:journals/corr/JohnsonDJ17, </a>)</cite> and HNSW <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib7" title="">DBLP:journals/corr/MalkovY16, </a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Many methods <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib8" title="">zhang2023divide, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib9" title="">1167344, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib10" title="">jha2023unified, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib11" title="">peng2023embeddingbased, </a>)</cite> have been proposed for generating high-quality embeddings for EBR, which lead to more relevant candidates and improved metrics after the end-to-end recommendation.
In this work, we specifically focus on the friend recommendation EBR setting, where vast amounts of topological information relating users are readily available.
Recent works <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib12" title="">10.1145/3539618.3591848, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib13" title="">DBLP:journals/corr/abs-1806-01973, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib14" title="">kung2024improving, </a>)</cite> have shown that including this relational information can improve the embedding quality. The relational information is commonly modeled with graph neural networks (GNNs), producing embeddings that leverage neighbor information in graphs, such as co-friend relationships.
For graph-aware EBR in particular, link prediction has seen success for generating high-quality embeddings <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib15" title="">LI2021516, </a>)</cite>, where we look to predict the presence of an edge between a query node and set of candidate nodes.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">While link prediction is effective in learning nuanced similarities and distinctions between candidates, there are several other self-supervised graph learning philosophies that can provide high-quality embeddings, such as mutual information maximization <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib16" title="">oord2018representation, </a>)</cite>, generative reconstruction <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib17" title="">he2022masked, </a>)</cite>, or whitening decorrelation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib18" title="">ermolov2021whitening, </a>)</cite>. Based on these general philosophies, many graph-based approaches have been proposed and used to learning embeddings directly, achieving desirable properties of embeddings without requiring explicit labels. Recently, Ju et al. <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib19" title="">ju2023multitask, </a>)</cite> evaluated combining these self-supervised learning approaches with link prediction in a multitask (MTL) setting, demonstrating a larger resilience to the adverse conditions between each downstream task and thereby increased robustness and generalization ability through the training objective</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">However, whether or not using SSMTL in academia as a robust training objective translates to large-scale (i.e., over hundreds of millions of users and interactions in-between) industrial RSs still requires verification.
Simply adopting academic setups in industrial RSs might result in several issues.
Firstly, many self-supervised objectives require data augmentations (e.g., embedding masking/corruption) over a large portion of users and items, which is prohibitively expensive in industrial RSs.
Furthermore, some self-supervised objectives might not align with the recommendation task, which might lead to redundant computational overheads or negative transfer  <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib20" title="">TorreyShavlik2010, </a>)</cite>, a phenomenon where performance can worsen as a result of the complexity and potentially opposing nature of the various tasks.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In this work, we investigate whether robust SSMTL training objectives are able to improve the link prediction retrieval performance on large-scale graphs with over hundreds of millions of nodes and edges.
Specifically, we look to find what combination of SSL approaches can improve overall robustness and thereby augment retrieval through complementary yet disjoint information.
In our experiments, we find two SSL approaches, based on philosophies from whitening decorrelation (e.g., Canonical Correlation Analysis <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib21" title="">DBLP:journals/corr/abs-2106-12484, </a>)</cite>) and generative reconstruction (e.g., Masked Autoencoders <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib22" title="">hou2022graphmae, </a>)</cite>), that are able to augment the performance of link prediction without negative transfer.
We deploy the proposed framework on an industrial large-scale friend recommendation system to a community of hundreds of millions of users.
In the online A/B testing, we observe significant improvements in key metrics like new friends made, especially with cold-start users on the platform. Our contributions are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We demonstrate the effectiveness of robust training objectives such as SSMTL in a large-scale industrial recommendation system.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.2">We conduct an online study of SSMTL on a massive real-world recommendation system, and observe a statistically significant increase in key metrics, with up to <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i2.p1.1.1"><math alttext="\mathbf{5.45}\%" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.1.m1.1"><semantics id="S1.I1.i2.p1.1.1.m1.1a"><mrow id="S1.I1.i2.p1.1.1.m1.1.1" xref="S1.I1.i2.p1.1.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S1.I1.i2.p1.1.1.m1.1.1.2" mathvariant="bold" xref="S1.I1.i2.p1.1.1.m1.1.1.2.cmml">5.45</mn><mo id="S1.I1.i2.p1.1.1.m1.1.1.1" xref="S1.I1.i2.p1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.1.m1.1b"><apply id="S1.I1.i2.p1.1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1"><csymbol cd="latexml" id="S1.I1.i2.p1.1.1.m1.1.1.1.cmml" xref="S1.I1.i2.p1.1.1.m1.1.1.1">percent</csymbol><cn id="S1.I1.i2.p1.1.1.m1.1.1.2.cmml" type="float" xref="S1.I1.i2.p1.1.1.m1.1.1.2">5.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.1.m1.1c">\mathbf{5.45}\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.1.m1.1d">bold_5.45 %</annotation></semantics></math></span> improvements in new friends made and <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.I1.i2.p1.2.2"><math alttext="\mathbf{1.91}\%" class="ltx_Math" display="inline" id="S1.I1.i2.p1.2.2.m1.1"><semantics id="S1.I1.i2.p1.2.2.m1.1a"><mrow id="S1.I1.i2.p1.2.2.m1.1.1" xref="S1.I1.i2.p1.2.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S1.I1.i2.p1.2.2.m1.1.1.2" mathvariant="bold" xref="S1.I1.i2.p1.2.2.m1.1.1.2.cmml">1.91</mn><mo id="S1.I1.i2.p1.2.2.m1.1.1.1" xref="S1.I1.i2.p1.2.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.2.2.m1.1b"><apply id="S1.I1.i2.p1.2.2.m1.1.1.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1"><csymbol cd="latexml" id="S1.I1.i2.p1.2.2.m1.1.1.1.cmml" xref="S1.I1.i2.p1.2.2.m1.1.1.1">percent</csymbol><cn id="S1.I1.i2.p1.2.2.m1.1.1.2.cmml" type="float" xref="S1.I1.i2.p1.2.2.m1.1.1.2">1.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.2.2.m1.1c">\mathbf{1.91}\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.2.2.m1.1d">bold_1.91 %</annotation></semantics></math></span> improvements in new friends made with cold-start users.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="268" id="S1.F1.g1" src="extracted/5872156/SSMTL.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>In our proposed SSMTL framework, we combine the <span class="ltx_text" id="S1.F1.5.1" style="color:#B6D7A8;">CCA</span> and <span class="ltx_text" id="S1.F1.6.2" style="color:#EA9999;">MAE</span> SSL methods with the retrieval task in our embedding generation scheme for EBR. <span class="ltx_text" id="S1.F1.7.3" style="color:#B6D7A8;">CCA</span> looks to maximize the correlation of two augmented views of the input subgraph while decorrelating features of a single view. <span class="ltx_text" id="S1.F1.8.4" style="color:#EA9999;">MAE</span> seeks to reconstruct the query user nodes after being propagated through the GNN encoder backbone. Finally, the retrieval task seeks to predict which candidates share a link with the query user using a categorical cross entropy loss. The loss of each subtask is weighted and summed to measure the final loss. Embeddings can be generated through the GNN encoder for EBR.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Graph-Aware Embedding-based Retrieval</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In a two-stage recommendation system with a retrieval then ranking phase, the retrieval phase plays an important role filtering out the most relevant candidates to lighten the load of the ranker. Since the ranking result is largely dependent on items retrieved in the retrieval phase, a good quality retrieval model can drastically improve the final ranking. Embedding based retrieval (EBR) is a method that’s recently adopted and deployed in many content, product, and friend recommendation systems<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib4" title="">DBLP:journals/corr/abs-2006-11632, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib23" title="">45530, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib24" title="">TK:2021, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib12" title="">10.1145/3539618.3591848, </a>)</cite>, and proved to achieve superior results. EBR transform users and items into embeddings, changing the retrieval problem into a nearest-neighbor search problem in a low-dimensional latent space. These embeddings can be determined in advance and indexed using an approximate nearest neighbor search such as FAISS <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib6" title="">DBLP:journals/corr/JohnsonDJ17, </a>)</cite> and HNSW <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib7" title="">DBLP:journals/corr/MalkovY16, </a>)</cite> in order to retrieve the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_k</annotation></semantics></math> most relevant items efficiently at serving.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">When applying EBR to RS problems, the quality of embeddings is of upmost importance. In this paper, we use a friend recommendation system as our subject. In scenarios like friend recommendation where vast amounts of topological information relating users and items is readily available, these embeddings can be augmented with GNNs. Previous work showed that EBR for friend recommendation systems see benefits leveraging graph-aware embeddings<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib12" title="">10.1145/3539618.3591848, </a>)</cite>. In this setting, nodes would contain individual user features while edges map to user-user interactions. This approach compliments commonly used graph traversal approaches (eg. friend-of-friend (FoF) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib25" title="">Newman_2001, </a>)</cite>), allowing for retrieval of candidates from any number of hops away from the target.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.11">Here we describe GNNs for generating graph-aware embeddings for EBR.
GNNs have demonstrated state-of-the-art performance in many problems containing rich topological information within the graph data <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib26" title="">DBLP:journals/corr/abs-1812-08434, </a>)</cite>, such as recommendation and forecasting. Formally, we define <math alttext="G=(\mathcal{V},\mathcal{E},X)" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.3"><semantics id="S2.SS1.p3.1.m1.3a"><mrow id="S2.SS1.p3.1.m1.3.4" xref="S2.SS1.p3.1.m1.3.4.cmml"><mi id="S2.SS1.p3.1.m1.3.4.2" xref="S2.SS1.p3.1.m1.3.4.2.cmml">G</mi><mo id="S2.SS1.p3.1.m1.3.4.1" xref="S2.SS1.p3.1.m1.3.4.1.cmml">=</mo><mrow id="S2.SS1.p3.1.m1.3.4.3.2" xref="S2.SS1.p3.1.m1.3.4.3.1.cmml"><mo id="S2.SS1.p3.1.m1.3.4.3.2.1" stretchy="false" xref="S2.SS1.p3.1.m1.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">𝒱</mi><mo id="S2.SS1.p3.1.m1.3.4.3.2.2" xref="S2.SS1.p3.1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.2.2" xref="S2.SS1.p3.1.m1.2.2.cmml">ℰ</mi><mo id="S2.SS1.p3.1.m1.3.4.3.2.3" xref="S2.SS1.p3.1.m1.3.4.3.1.cmml">,</mo><mi id="S2.SS1.p3.1.m1.3.3" xref="S2.SS1.p3.1.m1.3.3.cmml">X</mi><mo id="S2.SS1.p3.1.m1.3.4.3.2.4" stretchy="false" xref="S2.SS1.p3.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.3b"><apply id="S2.SS1.p3.1.m1.3.4.cmml" xref="S2.SS1.p3.1.m1.3.4"><eq id="S2.SS1.p3.1.m1.3.4.1.cmml" xref="S2.SS1.p3.1.m1.3.4.1"></eq><ci id="S2.SS1.p3.1.m1.3.4.2.cmml" xref="S2.SS1.p3.1.m1.3.4.2">𝐺</ci><vector id="S2.SS1.p3.1.m1.3.4.3.1.cmml" xref="S2.SS1.p3.1.m1.3.4.3.2"><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝒱</ci><ci id="S2.SS1.p3.1.m1.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2">ℰ</ci><ci id="S2.SS1.p3.1.m1.3.3.cmml" xref="S2.SS1.p3.1.m1.3.3">𝑋</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.3c">G=(\mathcal{V},\mathcal{E},X)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.3d">italic_G = ( caligraphic_V , caligraphic_E , italic_X )</annotation></semantics></math>, where <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">caligraphic_V</annotation></semantics></math> is the set of <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><mi id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><ci id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">italic_n</annotation></semantics></math> nodes (<math alttext="|\mathcal{V}|=n)" class="ltx_math_unparsed" display="inline" id="S2.SS1.p3.4.m4.1"><semantics id="S2.SS1.p3.4.m4.1a"><mrow id="S2.SS1.p3.4.m4.1b"><mo fence="false" id="S2.SS1.p3.4.m4.1.2" rspace="0.167em" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.4.m4.1.1">𝒱</mi><mo fence="false" id="S2.SS1.p3.4.m4.1.3" stretchy="false">|</mo><mo id="S2.SS1.p3.4.m4.1.4" lspace="0.167em">=</mo><mi id="S2.SS1.p3.4.m4.1.5">n</mi><mo id="S2.SS1.p3.4.m4.1.6" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">|\mathcal{V}|=n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">| caligraphic_V | = italic_n )</annotation></semantics></math>, <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><ci id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">caligraphic_E</annotation></semantics></math> is the set of edges (<math alttext="\mathcal{E}\in\mathcal{V}\subseteq\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.1"><semantics id="S2.SS1.p3.6.m6.1a"><mrow id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.6.m6.1.1.2" xref="S2.SS1.p3.6.m6.1.1.2.cmml">ℰ</mi><mo id="S2.SS1.p3.6.m6.1.1.3" xref="S2.SS1.p3.6.m6.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.6.m6.1.1.4" xref="S2.SS1.p3.6.m6.1.1.4.cmml">𝒱</mi><mo id="S2.SS1.p3.6.m6.1.1.5" xref="S2.SS1.p3.6.m6.1.1.5.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.6.m6.1.1.6" xref="S2.SS1.p3.6.m6.1.1.6.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><apply id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1"><and id="S2.SS1.p3.6.m6.1.1a.cmml" xref="S2.SS1.p3.6.m6.1.1"></and><apply id="S2.SS1.p3.6.m6.1.1b.cmml" xref="S2.SS1.p3.6.m6.1.1"><in id="S2.SS1.p3.6.m6.1.1.3.cmml" xref="S2.SS1.p3.6.m6.1.1.3"></in><ci id="S2.SS1.p3.6.m6.1.1.2.cmml" xref="S2.SS1.p3.6.m6.1.1.2">ℰ</ci><ci id="S2.SS1.p3.6.m6.1.1.4.cmml" xref="S2.SS1.p3.6.m6.1.1.4">𝒱</ci></apply><apply id="S2.SS1.p3.6.m6.1.1c.cmml" xref="S2.SS1.p3.6.m6.1.1"><subset id="S2.SS1.p3.6.m6.1.1.5.cmml" xref="S2.SS1.p3.6.m6.1.1.5"></subset><share href="https://arxiv.org/html/2409.14682v1#S2.SS1.p3.6.m6.1.1.4.cmml" id="S2.SS1.p3.6.m6.1.1d.cmml" xref="S2.SS1.p3.6.m6.1.1"></share><ci id="S2.SS1.p3.6.m6.1.1.6.cmml" xref="S2.SS1.p3.6.m6.1.1.6">𝒱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">\mathcal{E}\in\mathcal{V}\subseteq\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">caligraphic_E ∈ caligraphic_V ⊆ caligraphic_V</annotation></semantics></math>), and <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m7.1"><semantics id="S2.SS1.p3.7.m7.1a"><mi id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><ci id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m7.1d">italic_X</annotation></semantics></math> is a feature matrix of dimension <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p3.8.m8.1"><semantics id="S2.SS1.p3.8.m8.1a"><mi id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><ci id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.8.m8.1d">italic_d</annotation></semantics></math> where <math alttext="X\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S2.SS1.p3.9.m9.1"><semantics id="S2.SS1.p3.9.m9.1a"><mrow id="S2.SS1.p3.9.m9.1.1" xref="S2.SS1.p3.9.m9.1.1.cmml"><mi id="S2.SS1.p3.9.m9.1.1.2" xref="S2.SS1.p3.9.m9.1.1.2.cmml">X</mi><mo id="S2.SS1.p3.9.m9.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.cmml">∈</mo><msup id="S2.SS1.p3.9.m9.1.1.3" xref="S2.SS1.p3.9.m9.1.1.3.cmml"><mi id="S2.SS1.p3.9.m9.1.1.3.2" xref="S2.SS1.p3.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p3.9.m9.1.1.3.3" xref="S2.SS1.p3.9.m9.1.1.3.3.cmml"><mi id="S2.SS1.p3.9.m9.1.1.3.3.2" xref="S2.SS1.p3.9.m9.1.1.3.3.2.cmml">n</mi><mo id="S2.SS1.p3.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p3.9.m9.1.1.3.3.3" xref="S2.SS1.p3.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m9.1b"><apply id="S2.SS1.p3.9.m9.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1"><in id="S2.SS1.p3.9.m9.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1"></in><ci id="S2.SS1.p3.9.m9.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1.2">𝑋</ci><apply id="S2.SS1.p3.9.m9.1.1.3.cmml" xref="S2.SS1.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.9.m9.1.1.3.1.cmml" xref="S2.SS1.p3.9.m9.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.9.m9.1.1.3.2.cmml" xref="S2.SS1.p3.9.m9.1.1.3.2">ℝ</ci><apply id="S2.SS1.p3.9.m9.1.1.3.3.cmml" xref="S2.SS1.p3.9.m9.1.1.3.3"><times id="S2.SS1.p3.9.m9.1.1.3.3.1.cmml" xref="S2.SS1.p3.9.m9.1.1.3.3.1"></times><ci id="S2.SS1.p3.9.m9.1.1.3.3.2.cmml" xref="S2.SS1.p3.9.m9.1.1.3.3.2">𝑛</ci><ci id="S2.SS1.p3.9.m9.1.1.3.3.3.cmml" xref="S2.SS1.p3.9.m9.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m9.1c">X\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.9.m9.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Many modern GNNs also employ a message-passing structure, consisting of an aggregation (AGG) and update (UPD) function. The goal of this paradigm is for nodes to receive information from their neighbors, collecting messages using its AGG function before updating their own messages with the UPD function, both of which are learnable and permutation-invariant. For some node <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p3.10.m10.1"><semantics id="S2.SS1.p3.10.m10.1a"><mi id="S2.SS1.p3.10.m10.1.1" xref="S2.SS1.p3.10.m10.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m10.1b"><ci id="S2.SS1.p3.10.m10.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.10.m10.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.10.m10.1d">italic_u</annotation></semantics></math> at layer <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.p3.11.m11.1"><semantics id="S2.SS1.p3.11.m11.1a"><mi id="S2.SS1.p3.11.m11.1.1" xref="S2.SS1.p3.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m11.1b"><ci id="S2.SS1.p3.11.m11.1.1.cmml" xref="S2.SS1.p3.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.11.m11.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.11.m11.1d">italic_k</annotation></semantics></math>, the next message-passing layer can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{h}_{u}^{(k+1)}=\text{UPD}^{(k)}\left(\mathbf{h}_{u}^{(k)},\text{AGG}^{%
(k)}\left(\{\mathbf{h}_{v}^{(k)},\forall v\in\mathcal{N}(u)\}\right)\right)" class="ltx_Math" display="block" id="S2.E1.m1.8"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml"><msubsup id="S2.E1.m1.8.8.4" xref="S2.E1.m1.8.8.4.cmml"><mi id="S2.E1.m1.8.8.4.2.2" xref="S2.E1.m1.8.8.4.2.2.cmml">𝐡</mi><mi id="S2.E1.m1.8.8.4.2.3" xref="S2.E1.m1.8.8.4.2.3.cmml">u</mi><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">k</mi><mo id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E1.m1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.8.8.3" xref="S2.E1.m1.8.8.3.cmml">=</mo><mrow id="S2.E1.m1.8.8.2" xref="S2.E1.m1.8.8.2.cmml"><msup id="S2.E1.m1.8.8.2.4" xref="S2.E1.m1.8.8.2.4.cmml"><mtext id="S2.E1.m1.8.8.2.4.2" xref="S2.E1.m1.8.8.2.4.2a.cmml">UPD</mtext><mrow id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.8.8.2.4.cmml"><mo id="S2.E1.m1.2.2.1.3.1" stretchy="false" xref="S2.E1.m1.8.8.2.4.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">k</mi><mo id="S2.E1.m1.2.2.1.3.2" stretchy="false" xref="S2.E1.m1.8.8.2.4.cmml">)</mo></mrow></msup><mo id="S2.E1.m1.8.8.2.3" xref="S2.E1.m1.8.8.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.2" xref="S2.E1.m1.8.8.2.2.3.cmml"><mo id="S2.E1.m1.8.8.2.2.2.3" xref="S2.E1.m1.8.8.2.2.3.cmml">(</mo><msubsup id="S2.E1.m1.7.7.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.2.2" xref="S2.E1.m1.7.7.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E1.m1.7.7.1.1.1.1.2.3" xref="S2.E1.m1.7.7.1.1.1.1.2.3.cmml">u</mi><mrow id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.7.7.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.3.1" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">k</mi><mo id="S2.E1.m1.3.3.1.3.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.8.8.2.2.2.4" xref="S2.E1.m1.8.8.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.8.8.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.cmml"><msup id="S2.E1.m1.8.8.2.2.2.2.3" xref="S2.E1.m1.8.8.2.2.2.2.3.cmml"><mtext id="S2.E1.m1.8.8.2.2.2.2.3.2" xref="S2.E1.m1.8.8.2.2.2.2.3.2a.cmml">AGG</mtext><mrow id="S2.E1.m1.4.4.1.3" xref="S2.E1.m1.8.8.2.2.2.2.3.cmml"><mo id="S2.E1.m1.4.4.1.3.1" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.3.cmml">(</mo><mi id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml">k</mi><mo id="S2.E1.m1.4.4.1.3.2" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.3.cmml">)</mo></mrow></msup><mo id="S2.E1.m1.8.8.2.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1" xref="S2.E1.m1.8.8.2.2.2.2.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.2" xref="S2.E1.m1.8.8.2.2.2.2.cmml">(</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.2.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.2.cmml">{</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.3.cmml"><msubsup id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml">v</mi><mrow id="S2.E1.m1.5.5.1.3" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.5.5.1.3.1" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml">k</mi><mo id="S2.E1.m1.5.5.1.3.2" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.3" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.1" rspace="0.167em" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.2.cmml">v</mi></mrow></mrow><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.3" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.3.cmml">∈</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.2.cmml">𝒩</mi><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.1" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.3.2" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.3.2.1" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.cmml">(</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">u</mi><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.3.2.2" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.2.cmml">}</mo></mrow><mo id="S2.E1.m1.8.8.2.2.2.2.1.1.3" xref="S2.E1.m1.8.8.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.2.2.2.5" xref="S2.E1.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8"><eq id="S2.E1.m1.8.8.3.cmml" xref="S2.E1.m1.8.8.3"></eq><apply id="S2.E1.m1.8.8.4.cmml" xref="S2.E1.m1.8.8.4"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.4.1.cmml" xref="S2.E1.m1.8.8.4">superscript</csymbol><apply id="S2.E1.m1.8.8.4.2.cmml" xref="S2.E1.m1.8.8.4"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.4.2.1.cmml" xref="S2.E1.m1.8.8.4">subscript</csymbol><ci id="S2.E1.m1.8.8.4.2.2.cmml" xref="S2.E1.m1.8.8.4.2.2">𝐡</ci><ci id="S2.E1.m1.8.8.4.2.3.cmml" xref="S2.E1.m1.8.8.4.2.3">𝑢</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><plus id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"></plus><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">𝑘</ci><cn id="S2.E1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E1.m1.8.8.2.cmml" xref="S2.E1.m1.8.8.2"><times id="S2.E1.m1.8.8.2.3.cmml" xref="S2.E1.m1.8.8.2.3"></times><apply id="S2.E1.m1.8.8.2.4.cmml" xref="S2.E1.m1.8.8.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.4.1.cmml" xref="S2.E1.m1.8.8.2.4">superscript</csymbol><ci id="S2.E1.m1.8.8.2.4.2a.cmml" xref="S2.E1.m1.8.8.2.4.2"><mtext id="S2.E1.m1.8.8.2.4.2.cmml" xref="S2.E1.m1.8.8.2.4.2">UPD</mtext></ci><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑘</ci></apply><interval closure="open" id="S2.E1.m1.8.8.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2"><apply id="S2.E1.m1.7.7.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.7.7.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.1.1.2.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.2.2">𝐡</ci><ci id="S2.E1.m1.7.7.1.1.1.1.2.3.cmml" xref="S2.E1.m1.7.7.1.1.1.1.2.3">𝑢</ci></apply><ci id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1">𝑘</ci></apply><apply id="S2.E1.m1.8.8.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2"><times id="S2.E1.m1.8.8.2.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2"></times><apply id="S2.E1.m1.8.8.2.2.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.2.2.3.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.3">superscript</csymbol><ci id="S2.E1.m1.8.8.2.2.2.2.3.2a.cmml" xref="S2.E1.m1.8.8.2.2.2.2.3.2"><mtext id="S2.E1.m1.8.8.2.2.2.2.3.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.3.2">AGG</mtext></ci><ci id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1">𝑘</ci></apply><set id="S2.E1.m1.8.8.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1"><apply id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1"><in id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.3"></in><list id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2"><apply id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1.1">𝑘</ci></apply><apply id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.2.2.2.2">𝑣</ci></apply></list><apply id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4"><times id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.1"></times><ci id="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.1.1.1.1.1.4.2">𝒩</ci><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑢</ci></apply></apply></set></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">\mathbf{h}_{u}^{(k+1)}=\text{UPD}^{(k)}\left(\mathbf{h}_{u}^{(k)},\text{AGG}^{%
(k)}\left(\{\mathbf{h}_{v}^{(k)},\forall v\in\mathcal{N}(u)\}\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.8d">bold_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k + 1 ) end_POSTSUPERSCRIPT = UPD start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( bold_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT , AGG start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( { bold_h start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT , ∀ italic_v ∈ caligraphic_N ( italic_u ) } ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.4">where <math alttext="\mathcal{N}(u)" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.1.m1.1.2.2" xref="S2.SS1.p4.1.m1.1.2.2.cmml">𝒩</mi><mo id="S2.SS1.p4.1.m1.1.2.1" xref="S2.SS1.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.1.2.3.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mo id="S2.SS1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">u</mi><mo id="S2.SS1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.2"><times id="S2.SS1.p4.1.m1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.1.2.1"></times><ci id="S2.SS1.p4.1.m1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.1.2.2">𝒩</ci><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\mathcal{N}(u)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">caligraphic_N ( italic_u )</annotation></semantics></math> is the neighborhood nodes of node <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">italic_u</annotation></semantics></math>. Different message-passing GNN models use different combinations of AGG and UPD functions. An example of a more complex GNN, Graph-attention networks (GATs) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib27" title="">veličković2018graph, </a>)</cite>, use an attention mechanism for each pair of nodes <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mi id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><ci id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">italic_j</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{ij}=\text{softmax}_{j}\left(f_{\text{att}}\left(\mathbf{W}h_{i},%
\mathbf{W}h_{j}\right)\right)" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">α</mi><mrow id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.3.3.2" xref="S2.E2.m1.1.1.3.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.3.3.1" xref="S2.E2.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.3.3" xref="S2.E2.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mtext id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.3.2a.cmml">softmax</mtext><mi id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.1.1.4.2.cmml">f</mi><mtext id="S2.E2.m1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.1.1.4.3a.cmml">att</mtext></msub><mo id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.1" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.2.cmml">h</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.5" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝛼</ci><apply id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3"><times id="S2.E2.m1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.3.3.2">𝑖</ci><ci id="S2.E2.m1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2a.cmml" xref="S2.E2.m1.1.1.1.3.2"><mtext id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3.2">softmax</mtext></ci><ci id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3">𝑗</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"></times><apply id="S2.E2.m1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2">𝑓</ci><ci id="S2.E2.m1.1.1.1.1.1.1.4.3a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.3"><mtext id="S2.E2.m1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E2.m1.1.1.1.1.1.1.4.3">att</mtext></ci></apply><interval closure="open" id="S2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">𝐖</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2"><times id="S2.E2.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2">𝐖</ci><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.2">ℎ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\alpha_{ij}=\text{softmax}_{j}\left(f_{\text{att}}\left(\mathbf{W}h_{i},%
\mathbf{W}h_{j}\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = softmax start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT att end_POSTSUBSCRIPT ( bold_W italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_W italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p5.3">where <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">bold_W</annotation></semantics></math> is a linear transformation applied to every node and <math alttext="f_{\text{att}}" class="ltx_Math" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><msub id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml"><mi id="S2.SS1.p5.2.m2.1.1.2" xref="S2.SS1.p5.2.m2.1.1.2.cmml">f</mi><mtext id="S2.SS1.p5.2.m2.1.1.3" xref="S2.SS1.p5.2.m2.1.1.3a.cmml">att</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><apply id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p5.2.m2.1.1.2.cmml" xref="S2.SS1.p5.2.m2.1.1.2">𝑓</ci><ci id="S2.SS1.p5.2.m2.1.1.3a.cmml" xref="S2.SS1.p5.2.m2.1.1.3"><mtext id="S2.SS1.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p5.2.m2.1.1.3">att</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">f_{\text{att}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">italic_f start_POSTSUBSCRIPT att end_POSTSUBSCRIPT</annotation></semantics></math> is the attention function parameterized by a weight vector and a non-linearity function. The AGG function is then a attention-weighted sum of its neighbors features while the UPD function is implicitly defined in <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.SS1.p5.3.m3.1"><semantics id="S2.SS1.p5.3.m3.1a"><mi id="S2.SS1.p5.3.m3.1.1" xref="S2.SS1.p5.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.1b"><ci id="S2.SS1.p5.3.m3.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.3.m3.1d">bold_W</annotation></semantics></math> and the non-linearity function.
Typically, to generate graph-aware embeddings from GNNs, a margin based ranking loss<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib13" title="">DBLP:journals/corr/abs-1806-01973, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib12" title="">10.1145/3539618.3591848, </a>)</cite> or contrastive<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib28" title="">DBLP:journals/corr/abs-2101-01317, </a>)</cite> loss can be used, to encourage items that are closer in the graph to be closer in the embedding space.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Multitask Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Multitask learning (MTL) is an approach in machine learning where a model is trained simultaneously on several tasks. MTL has been extensively explored in recommendation as a way to improve key metrics <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib29" title="">inproceedings1, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib30" title="">10.1145/3219819.3220007, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib31" title="">ma2018entire, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib32" title="">10.1145/3383313.3412236, </a>)</cite>. Thus, the core idea behind multitask learning is to improve the robustness of the model by leveraging the domain-specific information contained in the training signals of related tasks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib33" title="">NIPS2006_0afa92fc, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib34" title="">Caruana1997MultitaskLearning, </a>)</cite>. Hard parameter sharing, one of the most fundamental forms of MTL, uses a shared representation which then branches into multiple heads capable of learning task-specific information <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib35" title="">guo2020learning, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib36" title="">DBLP:journals/corr/abs-1911-12423, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib37" title="">vandenhende2020branched, </a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">For graph-aware EBR in particular, self-supervised multitask learning (SSMTL) has been proposed as a new approach to MTL, optimizing the embeddings directly to achieve desirable embedding properties without the use of positive or negative labels. In this setting, we combine several self-supervised learning (SSL) methods with a downstream retrieval task to learn both direct and indirect embedding features. Recent work <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib19" title="">ju2023multitask, </a>)</cite> has shown that SSMTL can lead to improved task generalization and embedding quality on several academic benchmarks through the increasingly robust training objective. However, many of the SSL approaches used are constrained to the assumption that global graph information can be inferred within the graph structure. This is not valid in the large-scale recommendation setting, where graphs are constrained to some <math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_K</annotation></semantics></math>-hop around a query user in order to fit in memory. As a result, many of these SSL methods may lead to negative transfer due to SSL task conflict with the target link prediction task, and there remains work to be done to investigate which methods perform best in this large-scale setting.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Self-Supervised Multitask Learning for EBR</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In the following sections, we describe details of the SSL methods used in our SSMTL approach, our experiment set up and results, highlighting the benefits and impact of including SSMTL based embedding in EBR for large-scale industrial recommendation systems.
</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Self-Supervised Learning Methods</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We identify two self-supervised learning approaches that are scalable and lead to improvements in the large-scale recommendation setting through a more robust training objective. 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.8"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.8.1">Canonical Correlation Analysis.</span>
Based on work from <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib21" title="">DBLP:journals/corr/abs-2106-12484, </a>)</cite>, Canonical Correlation Analysis (CCA) deploys a non-contrastive, non-discriminitive SSL method to train the GNN. The self-supervised training objective is described in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.E3" title="In 3.1. Self-Supervised Learning Methods ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_tag">3</span></a>. First, given a subgraph with <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_n</annotation></semantics></math> nodes, two augmented views of the subgraph are created and fed through the GNN, producing <math alttext="\mathbf{Z_{A}}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝐙</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐙</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{Z_{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_Z start_POSTSUBSCRIPT bold_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{Z_{B}}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝐙</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">𝐁</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐙</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝐁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{Z_{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_Z start_POSTSUBSCRIPT bold_B end_POSTSUBSCRIPT</annotation></semantics></math> where <math alttext="\mathbf{Z_{A}},\mathbf{Z_{B}}\in\mathbb{R}^{n\times k}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.2"><semantics id="S3.SS1.p2.4.m4.2a"><mrow id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml"><mrow id="S3.SS1.p2.4.m4.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml"><msub id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">𝐙</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">𝐀</mi></msub><mo id="S3.SS1.p2.4.m4.2.2.2.2.3" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.4.m4.2.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.4.m4.2.2.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2.cmml">𝐙</mi><mi id="S3.SS1.p2.4.m4.2.2.2.2.2.3" xref="S3.SS1.p2.4.m4.2.2.2.2.2.3.cmml">𝐁</mi></msub></mrow><mo id="S3.SS1.p2.4.m4.2.2.3" xref="S3.SS1.p2.4.m4.2.2.3.cmml">∈</mo><msup id="S3.SS1.p2.4.m4.2.2.4" xref="S3.SS1.p2.4.m4.2.2.4.cmml"><mi id="S3.SS1.p2.4.m4.2.2.4.2" xref="S3.SS1.p2.4.m4.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.4.m4.2.2.4.3" xref="S3.SS1.p2.4.m4.2.2.4.3.cmml"><mi id="S3.SS1.p2.4.m4.2.2.4.3.2" xref="S3.SS1.p2.4.m4.2.2.4.3.2.cmml">n</mi><mo id="S3.SS1.p2.4.m4.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.2.2.4.3.1.cmml">×</mo><mi id="S3.SS1.p2.4.m4.2.2.4.3.3" xref="S3.SS1.p2.4.m4.2.2.4.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.2b"><apply id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2"><in id="S3.SS1.p2.4.m4.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.3"></in><list id="S3.SS1.p2.4.m4.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2"><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝐙</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">𝐀</ci></apply><apply id="S3.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2">𝐙</ci><ci id="S3.SS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2.3">𝐁</ci></apply></list><apply id="S3.SS1.p2.4.m4.2.2.4.cmml" xref="S3.SS1.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.4.1.cmml" xref="S3.SS1.p2.4.m4.2.2.4">superscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.4.2.cmml" xref="S3.SS1.p2.4.m4.2.2.4.2">ℝ</ci><apply id="S3.SS1.p2.4.m4.2.2.4.3.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3"><times id="S3.SS1.p2.4.m4.2.2.4.3.1.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3.1"></times><ci id="S3.SS1.p2.4.m4.2.2.4.3.2.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3.2">𝑛</ci><ci id="S3.SS1.p2.4.m4.2.2.4.3.3.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.2c">\mathbf{Z_{A}},\mathbf{Z_{B}}\in\mathbb{R}^{n\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.2d">bold_Z start_POSTSUBSCRIPT bold_A end_POSTSUBSCRIPT , bold_Z start_POSTSUBSCRIPT bold_B end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>. Each of these embeddings are fed through a task-specific head, and then are normalized so that each feature has <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mn id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><cn id="S3.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1">0</cn></annotation-xml></semantics></math> mean and <math alttext="\frac{1}{\sqrt{n}}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mfrac id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mn id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">1</mn><msqrt id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml">n</mi></msqrt></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><divide id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"></divide><cn id="S3.SS1.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS1.p2.6.m6.1.1.2">1</cn><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><root id="S3.SS1.p2.6.m6.1.1.3a.cmml" xref="S3.SS1.p2.6.m6.1.1.3"></root><ci id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\frac{1}{\sqrt{n}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_n end_ARG end_ARG</annotation></semantics></math> standard deviation, resulting in <math alttext="\mathbf{\tilde{Z}_{A}}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mover accent="true" id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2.2" xref="S3.SS1.p2.7.m7.1.1.2.2.cmml">𝐙</mi><mo id="S3.SS1.p2.7.m7.1.1.2.1" xref="S3.SS1.p2.7.m7.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2"><ci id="S3.SS1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1.2.1">~</ci><ci id="S3.SS1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2.2">𝐙</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\mathbf{\tilde{Z}_{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT bold_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{\tilde{Z}_{B}}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mover accent="true" id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">𝐙</mi><mo id="S3.SS1.p2.8.m8.1.1.2.1" xref="S3.SS1.p2.8.m8.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">𝐁</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><ci id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2.1">~</ci><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝐙</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝐁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\mathbf{\tilde{Z}_{B}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT bold_B end_POSTSUBSCRIPT</annotation></semantics></math>. The loss is then computed from Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.E3" title="In 3.1. Self-Supervised Learning Methods ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_tag">3</span></a>. The first term in the equation seeks to minimize the distance of the same nodes between the two views. The second term enforces that the feature-wise covariance of all nodes is equal to the identity matrix.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{\text{CCA}}}=\left\|\tilde{\mathbf{Z}}_{A}-\tilde{\mathbf{Z}}_{B}%
\right\|_{F}^{2}+\lambda\left(\left\|\tilde{\mathbf{Z}}_{A}^{T}\tilde{\mathbf{%
Z}}_{A}-\mathbf{I}\right\|_{F}^{2}+\left\|\tilde{\mathbf{Z}}_{B}^{T}\tilde{%
\mathbf{Z}}_{B}-\mathbf{I}\right\|_{F}^{2}\right)" class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.4.2" xref="S3.E3.m1.2.2.4.2.cmml">ℒ</mi><mtext id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3a.cmml">CCA</mtext></msub><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">B</mi></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">F</mi><mn id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">+</mo><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.3.cmml">λ</mi><mo id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">A</mi><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mover accent="true" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">A</mi></msub></mrow><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">𝐈</mi></mrow><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.3.cmml">F</mi><mn id="S3.E3.m1.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E3.m1.2.2.2.2.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.3.cmml">+</mo><msubsup id="S3.E3.m1.2.2.2.2.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.2.cmml"><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.cmml"><msubsup id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.3.cmml">B</mi><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.cmml"><mover accent="true" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.2.cmml">𝐙</mi><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.3.cmml">B</mi></msub></mrow><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.3.cmml">𝐈</mi></mrow><mo id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E3.m1.2.2.2.2.1.1.1.2.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.3.cmml">F</mi><mn id="S3.E3.m1.2.2.2.2.1.1.1.2.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E3.m1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"></eq><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4.2">ℒ</ci><ci id="S3.E3.m1.2.2.4.3a.cmml" xref="S3.E3.m1.2.2.4.3"><mtext id="S3.E3.m1.2.2.4.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.4.3">CCA</mtext></ci></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><plus id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></plus><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.2">𝐙</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3">𝐴</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2">𝐙</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3">𝐵</ci></apply></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝐹</ci></apply><cn id="S3.E3.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.3">2</cn></apply><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"><times id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"></times><ci id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3">𝜆</ci><apply id="S3.E3.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><plus id="S3.E3.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.3"></plus><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1">~</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐙</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3">𝐴</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.1">~</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.2.2">𝐙</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.3">𝐴</ci></apply></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">𝐈</ci></apply></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.3">𝐹</ci></apply><cn id="S3.E3.m1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.1.1.1.1.3">2</cn></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1"><minus id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.1"></minus><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2"><times id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.1"></times><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2"><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.1">~</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.2.2">𝐙</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.2.3">𝐵</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2"><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.1">~</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.2.2">𝐙</ci></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.2.3.3">𝐵</ci></apply></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.1.1.1.3">𝐈</ci></apply></apply><ci id="S3.E3.m1.2.2.2.2.1.1.1.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.2.1.3">𝐹</ci></apply><cn id="S3.E3.m1.2.2.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.1.1.1.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathcal{L_{\text{CCA}}}=\left\|\tilde{\mathbf{Z}}_{A}-\tilde{\mathbf{Z}}_{B}%
\right\|_{F}^{2}+\lambda\left(\left\|\tilde{\mathbf{Z}}_{A}^{T}\tilde{\mathbf{%
Z}}_{A}-\mathbf{I}\right\|_{F}^{2}+\left\|\tilde{\mathbf{Z}}_{B}^{T}\tilde{%
\mathbf{Z}}_{B}-\mathbf{I}\right\|_{F}^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">caligraphic_L start_POSTSUBSCRIPT CCA end_POSTSUBSCRIPT = ∥ over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT - over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_λ ( ∥ over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT - bold_I ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT over~ start_ARG bold_Z end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT - bold_I ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.3"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.3.1">Masked Autoencoders.</span>
Based on work from <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#bib.bib22" title="">hou2022graphmae, </a>)</cite>, this approach leverages a graph masked autoencoder (MAE) that focuses on feature reconstruction. First, an augmented view of the subgraph is created and the features of the query users are masked out. This augmented graph is then fed through the GNN and a task-specific head. The features of the query users are then re-masked and passed through a graph convolution layer. As described in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.E4" title="In 3.1. Self-Supervised Learning Methods ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_tag">4</span></a>, for all masked nodes <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">caligraphic_V</annotation></semantics></math>, the final loss is equal to the average of the scaled cosine error between the original features <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_X</annotation></semantics></math> and generated features <math alttext="\mathbf{Z}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">bold_Z</annotation></semantics></math>. This approach only relies on the local neighborhood surrounding the query node, making it a good option for large-scale SSMTL.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{MAE}}=\frac{1}{|\mathcal{V}|}\sum_{v_{i}\in\mathcal{V}}%
\left(1-\frac{\mathbf{x}_{i}^{T}\mathbf{z}_{i}}{\|\mathbf{x}_{i}\|\cdot\|%
\mathbf{z}_{i}\|}\right)^{y},\quad y\geq 1" class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.3.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><msub id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.4.4.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.3a.cmml">MAE</mtext></msub><mo id="S3.E4.m1.4.4.1.1.2" xref="S3.E4.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒱</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><munder id="S3.E4.m1.4.4.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.4.4.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.cmml"><msub id="S3.E4.m1.4.4.1.1.1.1.2.3.2" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.2.3.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2.2.cmml">v</mi><mi id="S3.E4.m1.4.4.1.1.1.1.2.3.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.1.1.1.1.2.3.1" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.1.1.1.1.2.3.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.3.cmml">𝒱</mi></mrow></munder><msup id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mrow id="S3.E4.m1.3.3.4" xref="S3.E4.m1.3.3.4.cmml"><msubsup id="S3.E4.m1.3.3.4.2" xref="S3.E4.m1.3.3.4.2.cmml"><mi id="S3.E4.m1.3.3.4.2.2.2" xref="S3.E4.m1.3.3.4.2.2.2.cmml">𝐱</mi><mi id="S3.E4.m1.3.3.4.2.2.3" xref="S3.E4.m1.3.3.4.2.2.3.cmml">i</mi><mi id="S3.E4.m1.3.3.4.2.3" xref="S3.E4.m1.3.3.4.2.3.cmml">T</mi></msubsup><mo id="S3.E4.m1.3.3.4.1" xref="S3.E4.m1.3.3.4.1.cmml">⁢</mo><msub id="S3.E4.m1.3.3.4.3" xref="S3.E4.m1.3.3.4.3.cmml"><mi id="S3.E4.m1.3.3.4.3.2" xref="S3.E4.m1.3.3.4.3.2.cmml">𝐳</mi><mi id="S3.E4.m1.3.3.4.3.3" xref="S3.E4.m1.3.3.4.3.3.cmml">i</mi></msub></mrow><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.cmml">‖</mo><msub id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E4.m1.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E4.m1.3.3.2.3" rspace="0.222em" xref="S3.E4.m1.3.3.2.3.cmml">⋅</mo><mrow id="S3.E4.m1.3.3.2.2.1" xref="S3.E4.m1.3.3.2.2.2.cmml"><mo id="S3.E4.m1.3.3.2.2.1.2" stretchy="false" xref="S3.E4.m1.3.3.2.2.2.1.cmml">‖</mo><msub id="S3.E4.m1.3.3.2.2.1.1" xref="S3.E4.m1.3.3.2.2.1.1.cmml"><mi id="S3.E4.m1.3.3.2.2.1.1.2" xref="S3.E4.m1.3.3.2.2.1.1.2.cmml">𝐳</mi><mi id="S3.E4.m1.3.3.2.2.1.1.3" xref="S3.E4.m1.3.3.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.3.3.2.2.1.3" stretchy="false" xref="S3.E4.m1.3.3.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.3.cmml">y</mi></msup></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.2.3" rspace="1.167em" xref="S3.E4.m1.5.5.3a.cmml">,</mo><mrow id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml"><mi id="S3.E4.m1.5.5.2.2.2" xref="S3.E4.m1.5.5.2.2.2.cmml">y</mi><mo id="S3.E4.m1.5.5.2.2.1" xref="S3.E4.m1.5.5.2.2.1.cmml">≥</mo><mn id="S3.E4.m1.5.5.2.2.3" xref="S3.E4.m1.5.5.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3a.cmml" xref="S3.E4.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1"><eq id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2"></eq><apply id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.4.4.1.1.3.3a.cmml" xref="S3.E4.m1.4.4.1.1.3.3"><mtext id="S3.E4.m1.4.4.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.4.4.1.1.3.3">MAE</mtext></ci></apply><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn id="S3.E4.m1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></abs><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒱</ci></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1"><apply id="S3.E4.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2"></sum><apply id="S3.E4.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3"><in id="S3.E4.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.1"></in><apply id="S3.E4.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2.2">𝑣</ci><ci id="S3.E4.m1.4.4.1.1.1.1.2.3.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.3.3">𝒱</ci></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><divide id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3"></divide><apply id="S3.E4.m1.3.3.4.cmml" xref="S3.E4.m1.3.3.4"><times id="S3.E4.m1.3.3.4.1.cmml" xref="S3.E4.m1.3.3.4.1"></times><apply id="S3.E4.m1.3.3.4.2.cmml" xref="S3.E4.m1.3.3.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.2.1.cmml" xref="S3.E4.m1.3.3.4.2">superscript</csymbol><apply id="S3.E4.m1.3.3.4.2.2.cmml" xref="S3.E4.m1.3.3.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.2.2.1.cmml" xref="S3.E4.m1.3.3.4.2">subscript</csymbol><ci id="S3.E4.m1.3.3.4.2.2.2.cmml" xref="S3.E4.m1.3.3.4.2.2.2">𝐱</ci><ci id="S3.E4.m1.3.3.4.2.2.3.cmml" xref="S3.E4.m1.3.3.4.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.3.3.4.2.3.cmml" xref="S3.E4.m1.3.3.4.2.3">𝑇</ci></apply><apply id="S3.E4.m1.3.3.4.3.cmml" xref="S3.E4.m1.3.3.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.3.1.cmml" xref="S3.E4.m1.3.3.4.3">subscript</csymbol><ci id="S3.E4.m1.3.3.4.3.2.cmml" xref="S3.E4.m1.3.3.4.3.2">𝐳</ci><ci id="S3.E4.m1.3.3.4.3.3.cmml" xref="S3.E4.m1.3.3.4.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><ci id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3">⋅</ci><apply id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2">𝐱</ci><ci id="S3.E4.m1.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.1.2">norm</csymbol><apply id="S3.E4.m1.3.3.2.2.1.1.cmml" xref="S3.E4.m1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.1.1.2.cmml" xref="S3.E4.m1.3.3.2.2.1.1.2">𝐳</ci><ci id="S3.E4.m1.3.3.2.2.1.1.3.cmml" xref="S3.E4.m1.3.3.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><ci id="S3.E4.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.3">𝑦</ci></apply></apply></apply></apply><apply id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2"><geq id="S3.E4.m1.5.5.2.2.1.cmml" xref="S3.E4.m1.5.5.2.2.1"></geq><ci id="S3.E4.m1.5.5.2.2.2.cmml" xref="S3.E4.m1.5.5.2.2.2">𝑦</ci><cn id="S3.E4.m1.5.5.2.2.3.cmml" type="integer" xref="S3.E4.m1.5.5.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\mathcal{L}_{\text{MAE}}=\frac{1}{|\mathcal{V}|}\sum_{v_{i}\in\mathcal{V}}%
\left(1-\frac{\mathbf{x}_{i}^{T}\mathbf{z}_{i}}{\|\mathbf{x}_{i}\|\cdot\|%
\mathbf{z}_{i}\|}\right)^{y},\quad y\geq 1</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">caligraphic_L start_POSTSUBSCRIPT MAE end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | caligraphic_V | end_ARG ∑ start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_V end_POSTSUBSCRIPT ( 1 - divide start_ARG bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ ⋅ ∥ bold_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ end_ARG ) start_POSTSUPERSCRIPT italic_y end_POSTSUPERSCRIPT , italic_y ≥ 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.4">We note that these two approaches both utilize non-contrastive methods. While experimenting with different SSL tasks, we find that contrastive SSL approaches do not perform very well in the production setting due to their assumption that global information is readily available in the original and augmented graphs. This is not necessarily true for large-scale recommendation, where subgraphs are constrained to the K-hop neighborhood surrounding each query node.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Problem Breakdown</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">We evaluate the SSMTL as a robust training objective on an industrial friend recommendation system with hundreds of millions of users and connections. To handle this scale of training, we sample subgraphs containing the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_k</annotation></semantics></math>-hop neighborhood around each query user. Following training, the embeddings for EBR can be via propagation through the encoder backbone.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Retrieval Baseline</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.4">The baseline model uses a supervised single-task setup for embedding-based retrieval. We use a GAT as the GNN encoder backbone to obtain embeddings for the query user and each candidate, producing a candidate embedding matrix <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">bold_z</annotation></semantics></math>. We can then compute the dot product between the query user and each candidate and apply Softmax to generate the logits. We then calculate the Categorical Cross Entropy Loss with the true labels <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">bold_y</annotation></semantics></math> across the <math alttext="N=2" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">N</mi><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><eq id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1"></eq><ci id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">𝑁</ci><cn id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">N=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_N = 2</annotation></semantics></math> classes and <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">italic_M</annotation></semantics></math> candidates, outlined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.14682v1#S3.E5" title="In 3.2.2. Retrieval Baseline ‣ 3.2. Experimental Setup ‣ 3. Self-Supervised Multitask Learning for EBR ‣ Robust Training Objectives Improve Embedding-based Retrieval in Industrial Recommendation Systems"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{retrieval}}=-\sum_{i=1}^{N}\sum_{j=1}^{M}y_{ij}\log\left(%
\frac{e^{z_{ij}}}{\sum_{k=1}^{M}e^{z_{ik}}}\right)" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.3" xref="S3.E5.m1.2.3.cmml"><msub id="S3.E5.m1.2.3.2" xref="S3.E5.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.3.2.2" xref="S3.E5.m1.2.3.2.2.cmml">ℒ</mi><mtext id="S3.E5.m1.2.3.2.3" xref="S3.E5.m1.2.3.2.3a.cmml">retrieval</mtext></msub><mo id="S3.E5.m1.2.3.1" xref="S3.E5.m1.2.3.1.cmml">=</mo><mrow id="S3.E5.m1.2.3.3" xref="S3.E5.m1.2.3.3.cmml"><mo id="S3.E5.m1.2.3.3a" xref="S3.E5.m1.2.3.3.cmml">−</mo><mrow id="S3.E5.m1.2.3.3.2" xref="S3.E5.m1.2.3.3.2.cmml"><munderover id="S3.E5.m1.2.3.3.2.1" xref="S3.E5.m1.2.3.3.2.1.cmml"><mo id="S3.E5.m1.2.3.3.2.1.2.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.2.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.3.3.2.1.2.3" xref="S3.E5.m1.2.3.3.2.1.2.3.cmml"><mi id="S3.E5.m1.2.3.3.2.1.2.3.2" xref="S3.E5.m1.2.3.3.2.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.2.3.3.2.1.2.3.1" xref="S3.E5.m1.2.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.3.3.2.1.2.3.3" xref="S3.E5.m1.2.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.3.3.2.1.3" xref="S3.E5.m1.2.3.3.2.1.3.cmml">N</mi></munderover><mrow id="S3.E5.m1.2.3.3.2.2" xref="S3.E5.m1.2.3.3.2.2.cmml"><munderover id="S3.E5.m1.2.3.3.2.2.1" xref="S3.E5.m1.2.3.3.2.2.1.cmml"><mo id="S3.E5.m1.2.3.3.2.2.1.2.2" movablelimits="false" xref="S3.E5.m1.2.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.3.3.2.2.1.2.3" xref="S3.E5.m1.2.3.3.2.2.1.2.3.cmml"><mi id="S3.E5.m1.2.3.3.2.2.1.2.3.2" xref="S3.E5.m1.2.3.3.2.2.1.2.3.2.cmml">j</mi><mo id="S3.E5.m1.2.3.3.2.2.1.2.3.1" xref="S3.E5.m1.2.3.3.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.3.3.2.2.1.2.3.3" xref="S3.E5.m1.2.3.3.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.3.3.2.2.1.3" xref="S3.E5.m1.2.3.3.2.2.1.3.cmml">M</mi></munderover><mrow id="S3.E5.m1.2.3.3.2.2.2" xref="S3.E5.m1.2.3.3.2.2.2.cmml"><msub id="S3.E5.m1.2.3.3.2.2.2.2" xref="S3.E5.m1.2.3.3.2.2.2.2.cmml"><mi id="S3.E5.m1.2.3.3.2.2.2.2.2" xref="S3.E5.m1.2.3.3.2.2.2.2.2.cmml">y</mi><mrow id="S3.E5.m1.2.3.3.2.2.2.2.3" xref="S3.E5.m1.2.3.3.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.3.3.2.2.2.2.3.2" xref="S3.E5.m1.2.3.3.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E5.m1.2.3.3.2.2.2.2.3.1" xref="S3.E5.m1.2.3.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.3.3.2.2.2.2.3.3" xref="S3.E5.m1.2.3.3.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E5.m1.2.3.3.2.2.2.1" lspace="0.167em" xref="S3.E5.m1.2.3.3.2.2.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.2.3.3.2.2.2.3.2" xref="S3.E5.m1.2.3.3.2.2.2.3.1.cmml"><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">log</mi><mo id="S3.E5.m1.2.3.3.2.2.2.3.2a" xref="S3.E5.m1.2.3.3.2.2.2.3.1.cmml">⁡</mo><mrow id="S3.E5.m1.2.3.3.2.2.2.3.2.1" xref="S3.E5.m1.2.3.3.2.2.2.3.1.cmml"><mo id="S3.E5.m1.2.3.3.2.2.2.3.2.1.1" xref="S3.E5.m1.2.3.3.2.2.2.3.1.cmml">(</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msup id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">e</mi><msub id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.3.2" xref="S3.E5.m1.2.2.2.3.2.cmml">z</mi><mrow id="S3.E5.m1.2.2.2.3.3" xref="S3.E5.m1.2.2.2.3.3.cmml"><mi id="S3.E5.m1.2.2.2.3.3.2" xref="S3.E5.m1.2.2.2.3.3.2.cmml">i</mi><mo id="S3.E5.m1.2.2.2.3.3.1" xref="S3.E5.m1.2.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.2.3.3.3" xref="S3.E5.m1.2.2.2.3.3.3.cmml">j</mi></mrow></msub></msup><mrow id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><msubsup id="S3.E5.m1.2.2.3.1" xref="S3.E5.m1.2.2.3.1.cmml"><mo id="S3.E5.m1.2.2.3.1.2.2" xref="S3.E5.m1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.3.1.2.3" xref="S3.E5.m1.2.2.3.1.2.3.cmml"><mi id="S3.E5.m1.2.2.3.1.2.3.2" xref="S3.E5.m1.2.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E5.m1.2.2.3.1.2.3.1" xref="S3.E5.m1.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.2.3.1.2.3.3" xref="S3.E5.m1.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.2.3.1.3" xref="S3.E5.m1.2.2.3.1.3.cmml">M</mi></msubsup><msup id="S3.E5.m1.2.2.3.2" xref="S3.E5.m1.2.2.3.2.cmml"><mi id="S3.E5.m1.2.2.3.2.2" xref="S3.E5.m1.2.2.3.2.2.cmml">e</mi><msub id="S3.E5.m1.2.2.3.2.3" xref="S3.E5.m1.2.2.3.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2.3.2" xref="S3.E5.m1.2.2.3.2.3.2.cmml">z</mi><mrow id="S3.E5.m1.2.2.3.2.3.3" xref="S3.E5.m1.2.2.3.2.3.3.cmml"><mi id="S3.E5.m1.2.2.3.2.3.3.2" xref="S3.E5.m1.2.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E5.m1.2.2.3.2.3.3.1" xref="S3.E5.m1.2.2.3.2.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.3.2.3.3.3" xref="S3.E5.m1.2.2.3.2.3.3.3.cmml">k</mi></mrow></msub></msup></mrow></mfrac><mo id="S3.E5.m1.2.3.3.2.2.2.3.2.1.2" xref="S3.E5.m1.2.3.3.2.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.3.cmml" xref="S3.E5.m1.2.3"><eq id="S3.E5.m1.2.3.1.cmml" xref="S3.E5.m1.2.3.1"></eq><apply id="S3.E5.m1.2.3.2.cmml" xref="S3.E5.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.2.1.cmml" xref="S3.E5.m1.2.3.2">subscript</csymbol><ci id="S3.E5.m1.2.3.2.2.cmml" xref="S3.E5.m1.2.3.2.2">ℒ</ci><ci id="S3.E5.m1.2.3.2.3a.cmml" xref="S3.E5.m1.2.3.2.3"><mtext id="S3.E5.m1.2.3.2.3.cmml" mathsize="70%" xref="S3.E5.m1.2.3.2.3">retrieval</mtext></ci></apply><apply id="S3.E5.m1.2.3.3.cmml" xref="S3.E5.m1.2.3.3"><minus id="S3.E5.m1.2.3.3.1.cmml" xref="S3.E5.m1.2.3.3"></minus><apply id="S3.E5.m1.2.3.3.2.cmml" xref="S3.E5.m1.2.3.3.2"><apply id="S3.E5.m1.2.3.3.2.1.cmml" xref="S3.E5.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.3.2.1.1.cmml" xref="S3.E5.m1.2.3.3.2.1">superscript</csymbol><apply id="S3.E5.m1.2.3.3.2.1.2.cmml" xref="S3.E5.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.3.2.1.2.1.cmml" xref="S3.E5.m1.2.3.3.2.1">subscript</csymbol><sum id="S3.E5.m1.2.3.3.2.1.2.2.cmml" xref="S3.E5.m1.2.3.3.2.1.2.2"></sum><apply id="S3.E5.m1.2.3.3.2.1.2.3.cmml" xref="S3.E5.m1.2.3.3.2.1.2.3"><eq id="S3.E5.m1.2.3.3.2.1.2.3.1.cmml" xref="S3.E5.m1.2.3.3.2.1.2.3.1"></eq><ci id="S3.E5.m1.2.3.3.2.1.2.3.2.cmml" xref="S3.E5.m1.2.3.3.2.1.2.3.2">𝑖</ci><cn id="S3.E5.m1.2.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.3.3.2.1.3.cmml" xref="S3.E5.m1.2.3.3.2.1.3">𝑁</ci></apply><apply id="S3.E5.m1.2.3.3.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2"><apply id="S3.E5.m1.2.3.3.2.2.1.cmml" xref="S3.E5.m1.2.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.3.2.2.1.1.cmml" xref="S3.E5.m1.2.3.3.2.2.1">superscript</csymbol><apply id="S3.E5.m1.2.3.3.2.2.1.2.cmml" xref="S3.E5.m1.2.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.3.2.2.1.2.1.cmml" xref="S3.E5.m1.2.3.3.2.2.1">subscript</csymbol><sum id="S3.E5.m1.2.3.3.2.2.1.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2.1.2.2"></sum><apply id="S3.E5.m1.2.3.3.2.2.1.2.3.cmml" xref="S3.E5.m1.2.3.3.2.2.1.2.3"><eq id="S3.E5.m1.2.3.3.2.2.1.2.3.1.cmml" xref="S3.E5.m1.2.3.3.2.2.1.2.3.1"></eq><ci id="S3.E5.m1.2.3.3.2.2.1.2.3.2.cmml" xref="S3.E5.m1.2.3.3.2.2.1.2.3.2">𝑗</ci><cn id="S3.E5.m1.2.3.3.2.2.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.3.3.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.3.3.2.2.1.3.cmml" xref="S3.E5.m1.2.3.3.2.2.1.3">𝑀</ci></apply><apply id="S3.E5.m1.2.3.3.2.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2.2"><times id="S3.E5.m1.2.3.3.2.2.2.1.cmml" xref="S3.E5.m1.2.3.3.2.2.2.1"></times><apply id="S3.E5.m1.2.3.3.2.2.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.3.3.2.2.2.2.1.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.3.3.2.2.2.2.2.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2.2">𝑦</ci><apply id="S3.E5.m1.2.3.3.2.2.2.2.3.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2.3"><times id="S3.E5.m1.2.3.3.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2.3.1"></times><ci id="S3.E5.m1.2.3.3.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2.3.2">𝑖</ci><ci id="S3.E5.m1.2.3.3.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.3.3.2.2.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.2.3.3.2.2.2.3.1.cmml" xref="S3.E5.m1.2.3.3.2.2.2.3.2"><log id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"></log><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2">superscript</csymbol><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑒</ci><apply id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.3.2">𝑧</ci><apply id="S3.E5.m1.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.3.3"><times id="S3.E5.m1.2.2.2.3.3.1.cmml" xref="S3.E5.m1.2.2.2.3.3.1"></times><ci id="S3.E5.m1.2.2.2.3.3.2.cmml" xref="S3.E5.m1.2.2.2.3.3.2">𝑖</ci><ci id="S3.E5.m1.2.2.2.3.3.3.cmml" xref="S3.E5.m1.2.2.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><apply id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.1.cmml" xref="S3.E5.m1.2.2.3.1">superscript</csymbol><apply id="S3.E5.m1.2.2.3.1.2.cmml" xref="S3.E5.m1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.2.1.cmml" xref="S3.E5.m1.2.2.3.1">subscript</csymbol><sum id="S3.E5.m1.2.2.3.1.2.2.cmml" xref="S3.E5.m1.2.2.3.1.2.2"></sum><apply id="S3.E5.m1.2.2.3.1.2.3.cmml" xref="S3.E5.m1.2.2.3.1.2.3"><eq id="S3.E5.m1.2.2.3.1.2.3.1.cmml" xref="S3.E5.m1.2.2.3.1.2.3.1"></eq><ci id="S3.E5.m1.2.2.3.1.2.3.2.cmml" xref="S3.E5.m1.2.2.3.1.2.3.2">𝑘</ci><cn id="S3.E5.m1.2.2.3.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.2.3.1.3.cmml" xref="S3.E5.m1.2.2.3.1.3">𝑀</ci></apply><apply id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.3.2">superscript</csymbol><ci id="S3.E5.m1.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.3.2.2">𝑒</ci><apply id="S3.E5.m1.2.2.3.2.3.cmml" xref="S3.E5.m1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.2.3.1.cmml" xref="S3.E5.m1.2.2.3.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2.3.2">𝑧</ci><apply id="S3.E5.m1.2.2.3.2.3.3.cmml" xref="S3.E5.m1.2.2.3.2.3.3"><times id="S3.E5.m1.2.2.3.2.3.3.1.cmml" xref="S3.E5.m1.2.2.3.2.3.3.1"></times><ci id="S3.E5.m1.2.2.3.2.3.3.2.cmml" xref="S3.E5.m1.2.2.3.2.3.3.2">𝑖</ci><ci id="S3.E5.m1.2.2.3.2.3.3.3.cmml" xref="S3.E5.m1.2.2.3.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\mathcal{L}_{\text{retrieval}}=-\sum_{i=1}^{N}\sum_{j=1}^{M}y_{ij}\log\left(%
\frac{e^{z_{ij}}}{\sum_{k=1}^{M}e^{z_{ik}}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">caligraphic_L start_POSTSUBSCRIPT retrieval end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT roman_log ( divide start_ARG italic_e start_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3. </span>SSMTL Implementation Details</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.1">In our SSMTL approach, we use both CCA and MAE in combination with the retrieval baseline as the training objectives. All three methods share the same GAT GNN backbone. The augmented views for CCA and MAE occur separately, with CCA performing edge and feature drop augmentations while MAE performs edge drop and query node masking. The task-specific head for CCA is a Linear-ReLU-Linear block while the task-specific head for MAE is one linear layer. The final loss with SSMTL is a weighted sum of the losses.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{\text{combined}}}=\alpha\mathcal{L}_{\text{retrieval}}+\beta%
\mathcal{L}_{\text{CCA}}+\gamma\mathcal{L}_{\text{MAE}}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3a.cmml">combined</mtext></msub><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mrow id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">α</mi><mo id="S3.E6.m1.1.1.3.2.1" xref="S3.E6.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.3.2.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.3.2.3.3a.cmml">retrieval</mtext></msub></mrow><mo id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.2" xref="S3.E6.m1.1.1.3.3.2.cmml">β</mi><mo id="S3.E6.m1.1.1.3.3.1" xref="S3.E6.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.3.3.3" xref="S3.E6.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.3.3.3.3a.cmml">CCA</mtext></msub></mrow><mo id="S3.E6.m1.1.1.3.1a" xref="S3.E6.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.3.4" xref="S3.E6.m1.1.1.3.4.cmml"><mi id="S3.E6.m1.1.1.3.4.2" xref="S3.E6.m1.1.1.3.4.2.cmml">γ</mi><mo id="S3.E6.m1.1.1.3.4.1" xref="S3.E6.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.3.4.3" xref="S3.E6.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.4.3.2" xref="S3.E6.m1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.3.4.3.3" xref="S3.E6.m1.1.1.3.4.3.3a.cmml">MAE</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">ℒ</ci><ci id="S3.E6.m1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.2.3"><mtext id="S3.E6.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.2.3">combined</mtext></ci></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><plus id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><times id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.1"></times><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">𝛼</ci><apply id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.3.2.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.3.2.3.3a.cmml" xref="S3.E6.m1.1.1.3.2.3.3"><mtext id="S3.E6.m1.1.1.3.2.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.3.2.3.3">retrieval</mtext></ci></apply></apply><apply id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"><times id="S3.E6.m1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.2">𝛽</ci><apply id="S3.E6.m1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.3.3.3.3a.cmml" xref="S3.E6.m1.1.1.3.3.3.3"><mtext id="S3.E6.m1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.3.3.3.3">CCA</mtext></ci></apply></apply><apply id="S3.E6.m1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.3.4"><times id="S3.E6.m1.1.1.3.4.1.cmml" xref="S3.E6.m1.1.1.3.4.1"></times><ci id="S3.E6.m1.1.1.3.4.2.cmml" xref="S3.E6.m1.1.1.3.4.2">𝛾</ci><apply id="S3.E6.m1.1.1.3.4.3.cmml" xref="S3.E6.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.4.3.1.cmml" xref="S3.E6.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.4.3.2.cmml" xref="S3.E6.m1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.3.4.3.3a.cmml" xref="S3.E6.m1.1.1.3.4.3.3"><mtext id="S3.E6.m1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.3.4.3.3">MAE</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{L_{\text{combined}}}=\alpha\mathcal{L}_{\text{retrieval}}+\beta%
\mathcal{L}_{\text{CCA}}+\gamma\mathcal{L}_{\text{MAE}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT combined end_POSTSUBSCRIPT = italic_α caligraphic_L start_POSTSUBSCRIPT retrieval end_POSTSUBSCRIPT + italic_β caligraphic_L start_POSTSUBSCRIPT CCA end_POSTSUBSCRIPT + italic_γ caligraphic_L start_POSTSUBSCRIPT MAE end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p2.3">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.1.m1.1"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mi id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><ci id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.1.m1.1d">italic_α</annotation></semantics></math> is the weight for the retrieval loss, <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.2.m2.1"><semantics id="S3.SS2.SSS3.p2.2.m2.1a"><mi id="S3.SS2.SSS3.p2.2.m2.1.1" xref="S3.SS2.SSS3.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.2.m2.1b"><ci id="S3.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.2.m2.1d">italic_β</annotation></semantics></math> is the weight of the CCA loss, and <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.3.m3.1"><semantics id="S3.SS2.SSS3.p2.3.m3.1a"><mi id="S3.SS2.SSS3.p2.3.m3.1.1" xref="S3.SS2.SSS3.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.3.m3.1b"><ci id="S3.SS2.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.3.m3.1d">italic_γ</annotation></semantics></math> is the weight of the MAE loss. In practice, we observed best performance when the retrieval weight was several orders of magnitude larger than the other loss weights.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Results</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We evaluated the effectiveness of SSMTL for end-to-end friend recommendation with online A/B testing. The control group used candidates retrieved from the production model trained with retrieval baseline, while the treatment group instead used candidates retrieved with the new robust training objective in the SSMTL setting, specifically combining the previous retrieval loss with whitening decorrelation and generative reconstruction objectives.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">In the A/B experimental results, we saw statistically significant improvements across several friend recommendation metrics. Specifically, we observed up to <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS3.p2.1.1">5.45%</span> improvements in new friends made and <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS3.p2.1.2">+1.91%</span> new friends made with low-degree users in various markets. Overall, from these results, we see that SSMTL is able to provide improved recommendation compared with the single-task setting, in particular helping with candidate generation for low-degree users.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Conclusion</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this paper, we evaluate the effectiveness of a robust self-supervised multitask learning objective in embedding-based retrieval. Through online evaluation, we demonstrate that self-supervised methods used in a multi task setting are able to augment the performance of the underlying retrieval task on the scale of over 800 million nodes and edges, providing complementary yet disjoint information to enhance the embedding quality. We observe statistically significant gains in the number of friendships made for both high and low degree users.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Yang Li, Kangbo Liu, Ranjan Satapathy, Suhang Wang, and Erik Cambria.

</span>
<span class="ltx_bibblock">Recent developments in recommender systems: A survey, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Anchen Sun and Yuanzhe Peng.

</span>
<span class="ltx_bibblock">A survey on modern recommendation system based on big data, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 10th ACM Conference on Recommender Systems</span>, RecSys ’16, page 191–198, New York, NY, USA, 2016. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jui-Ting Huang, Ashish Sharma, Shuying Sun, Li Xia, David Zhang, Philip Pronin, Janani Padmanabhan, Giuseppe Ottaviano, and Linjun Yang.

</span>
<span class="ltx_bibblock">Embedding-based retrieval in facebook search.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">CoRR</span>, abs/2006.11632, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yukang Gan, Yixiao Ge, Chang Zhou, Shupeng Su, Zhouchuan Xu, Xuyuan Xu, Quanchao Hui, Xiang Chen, Yexin Wang, and Ying Shan.

</span>
<span class="ltx_bibblock">Binary embedding-based retrieval at tencent, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jeff Johnson, Matthijs Douze, and Hervé Jégou.

</span>
<span class="ltx_bibblock">Billion-scale similarity search with gpus.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">CoRR</span>, abs/1702.08734, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yury A. Malkov and Dmitry A. Yashunin.

</span>
<span class="ltx_bibblock">Efficient and robust approximate nearest neighbor search using hierarchical navigable small world graphs.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">CoRR</span>, abs/1603.09320, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Yuan Zhang, Xue Dong, Weijie Ding, Biao Li, Peng Jiang, and Kun Gai.

</span>
<span class="ltx_bibblock">Divide and conquer: Towards better embedding-based retrieval for recommender systems from a multi-task perspective, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
G. Linden, B. Smith, and J. York.

</span>
<span class="ltx_bibblock">Amazon.com recommendations: item-to-item collaborative filtering.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">IEEE Internet Computing</span>, 7(1):76–80, 2003.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Rishikesh Jha, Siddharth Subramaniyam, Ethan Benjamin, and Thrivikrama Taula.

</span>
<span class="ltx_bibblock">Unified embedding based personalized retrieval in etsy search, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ruoling Peng, Kang Liu, Po Yang, Zhipeng Yuan, and Shunbao Li.

</span>
<span class="ltx_bibblock">Embedding-based retrieval with llm for effective agriculture information extracting from unstructured data, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Jiahui Shi, Vivek Chaurasiya, Yozen Liu, Shubham Vij, Yan Wu, Satya Kanduri, Neil Shah, Peicheng Yu, Nik Srivastava, Lei Shi, Ganesh Venkataraman, and Jun Yu.

</span>
<span class="ltx_bibblock">Embedding based retrieval in friend recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, SIGIR ’23, page 3330–3334, New York, NY, USA, 2023. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L. Hamilton, and Jure Leskovec.

</span>
<span class="ltx_bibblock">Graph convolutional neural networks for web-scale recommender systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">CoRR</span>, abs/1806.01973, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Pau Perng-Hwa Kung, Zihao Fan, Tong Zhao, Yozen Liu, Zhixin Lai, Jiahui Shi, Yan Wu, Jun Yu, Neil Shah, and Ganesh Venkataraman.

</span>
<span class="ltx_bibblock">Improving embedding-based retrieval in friend recommendation with ann query expansion.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, pages 2930–2934, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Chen Li, Xutan Peng, Yuhang Niu, Shanghang Zhang, Hao Peng, Chuan Zhou, and Jianxin Li.

</span>
<span class="ltx_bibblock">Learning graph attention-aware knowledge graph embedding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Neurocomputing</span>, 461:516–529, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1807.03748</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross Girshick.

</span>
<span class="ltx_bibblock">Masked autoencoders are scalable vision learners.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>, pages 16000–16009, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Aleksandr Ermolov, Aliaksandr Siarohin, Enver Sangineto, and Nicu Sebe.

</span>
<span class="ltx_bibblock">Whitening for self-supervised representation learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">International Conference on Machine Learning</span>, pages 3015–3024. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Mingxuan Ju, Tong Zhao, Qianlong Wen, Wenhao Yu, Neil Shah, Yanfang Ye, and Chuxu Zhang.

</span>
<span class="ltx_bibblock">Multi-task self-supervised graph neural networks enable stronger task generalization.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">The Eleventh International Conference on Learning Representations</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Lisa Torrey and Jude Shavlik.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Transfer Learning</span>, pages 242–264.

</span>
<span class="ltx_bibblock">IGI Global, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Hengrui Zhang, Qitian Wu, Junchi Yan, David Wipf, and Philip S. Yu.

</span>
<span class="ltx_bibblock">From canonical correlation analysis to self-supervised graph neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">CoRR</span>, abs/2106.12484, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Zhenyu Hou, Xiao Liu, Yukuo Cen, Yuxiao Dong, Hongxia Yang, Chunjie Wang, and Jie Tang.

</span>
<span class="ltx_bibblock">Graphmae: Self-supervised masked graph autoencoders, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 10th ACM Conference on Recommender Systems</span>, New York, NY, USA, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Tim Koh, George Wu, , and Michael Mi.

</span>
<span class="ltx_bibblock">Manas hnsw realtime: Powering realtime embedding-based retrieval, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. E. J. Newman.

</span>
<span class="ltx_bibblock">Clustering and preferential attachment in growing networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Physical Review E</span>, 64(2), July 2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Jie Zhou, Ganqu Cui, Zhengyan Zhang, Cheng Yang, Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Graph neural networks: A review of methods and applications.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">CoRR</span>, abs/1812.08434, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Liò, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Graph attention networks, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Zhuang Liu, Yunpu Ma, Yuanxin Ouyang, and Zhang Xiong.

</span>
<span class="ltx_bibblock">Contrastive learning for recommender system.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">CoRR</span>, abs/2101.01317, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yichao Lu, Ruihai Dong, and Barry Smyth.

</span>
<span class="ltx_bibblock">Why i like it: multi-task learning for recommendation and explanation.

</span>
<span class="ltx_bibblock">pages 4–12, 09 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H. Chi.

</span>
<span class="ltx_bibblock">Modeling task relationships in multi-task learning with multi-gate mixture-of-experts.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span>, KDD ’18, page 1930–1939, New York, NY, USA, 2018. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Xiao Ma, Liqin Zhao, Guan Huang, Zhi Wang, Zelin Hu, Xiaoqiang Zhu, and Kun Gai.

</span>
<span class="ltx_bibblock">Entire space multi-task model: An effective approach for estimating post-click conversion rate, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Hongyan Tang, Junning Liu, Ming Zhao, and Xudong Gong.

</span>
<span class="ltx_bibblock">Progressive layered extraction (ple): A novel multi-task learning (mtl) model for personalized recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 14th ACM Conference on Recommender Systems</span>, RecSys ’20, page 269–278, New York, NY, USA, 2020. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Andreas Argyriou, Theodoros Evgeniou, and Massimiliano Pontil.

</span>
<span class="ltx_bibblock">Multi-task feature learning.

</span>
<span class="ltx_bibblock">In B. Schölkopf, J. Platt, and T. Hoffman, editors, <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</span>, volume 19. MIT Press, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Rich Caruana.

</span>
<span class="ltx_bibblock">Multitask learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Machine Learning</span>, 28:41–75, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Pengsheng Guo, Chen-Yu Lee, and Daniel Ulbricht.

</span>
<span class="ltx_bibblock">Learning to branch for multi-task learning, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Ximeng Sun, Rameswar Panda, and Rogério Schmidt Feris.

</span>
<span class="ltx_bibblock">Adashare: Learning what to share for efficient deep multi-task learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">CoRR</span>, abs/1911.12423, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Simon Vandenhende, Stamatios Georgoulis, Bert De Brabandere, and Luc Van Gool.

</span>
<span class="ltx_bibblock">Branched multi-task networks: Deciding what layers to share, 2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 23 03:11:43 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
