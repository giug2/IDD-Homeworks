<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>End-to-End Learnable Item Tokenization for Generative Recommendation</title>
<!--Generated on Mon Sep  9 12:08:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Generative Recommendation,  Item Tokenization" lang="en" name="keywords"/>
<base href="/html/2409.05546v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S1" title="In End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2" title="In End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS1" title="In 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS2" title="In 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Dual Encoder-Decoder Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS2.SSS1" title="In 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Item Tokenizer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS2.SSS2" title="In 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Generative Recommender</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS3" title="In 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Recommendation-oriented Alignment</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS3.SSS1" title="In 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Sequence-Item Alignment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS3.SSS2" title="In 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Preference-Semantic Alignment</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS4" title="In 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Alternating Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS5" title="In 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3" title="In End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS1" title="In 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experiment Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS1.SSS1" title="In 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS1.SSS2" title="In 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Baseline Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS1.SSS3" title="In 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Evaluation Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS1.SSS4" title="In 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS2" title="In 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS3" title="In 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS4" title="In 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Further Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS4.SSS1" title="In 3.4. Further Analysis ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Generalizability Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS4.SSS2" title="In 3.4. Further Analysis ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Hyper-Parameter Analysis</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S4" title="In End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S5" title="In End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">End-to-End Learnable Item Tokenization for Generative Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Enze Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0007-8344-4780" title="ORCID identifier">0009-0007-8344-4780</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:enzeeleo@gmail.com">enzeeleo@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bowen Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0002-3010-7899" title="ORCID identifier">0009-0002-3010-7899</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:bwzheng0324@ruc.edu.cn">bwzheng0324@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cheng Ling
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Kuaishou Inc.</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lingcheng@kuaishou.com">lingcheng@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lantao Hu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Kuaishou Inc.</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hulantao@gmail.com">hulantao@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Han Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Kuaishou Inc.</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lihan08@kuaishou.com">lihan08@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wayne Xin Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-8333-6196" title="ORCID identifier">0000-0002-8333-6196</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:batmanfly@gmail.com">batmanfly@gmail.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id19.id1">Recently, generative recommendation has emerged as a promising new paradigm that directly generates item identifiers for recommendation. However, a key challenge lies in how to effectively construct item identifiers that are suitable for recommender systems. Existing methods typically decouple item tokenization from subsequent generative recommendation training, likely resulting in suboptimal performance. To address this limitation, we propose <span class="ltx_text ltx_font_bold" id="id19.id1.1">ETEGRec</span>, a novel <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.2">E</span>nd-<span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.3">T</span>o-<span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.4">E</span>nd <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.5">G</span>enerative <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.6">Rec</span>ommender by
seamlessly integrating item tokenization and generative recommendation.
Our framework is developed based on the dual encoder-decoder architecture, which consists of an item tokenizer and a generative recommender.
In order to achieve mutual enhancement between the two components, we propose a recommendation-oriented alignment approach by devising two specific optimization objectives: sequence-item alignment and preference-semantic alignment.
These two alignment objectives can effectively couple the learning of item tokenizer and generative recommender, thereby fostering the mutual enhancement between the two components.
Finally, we further devise an alternating optimization method, to facilitate stable and effective end-to-end learning of the entire framework. Extensive experiments demonstrate the effectiveness of our proposed framework compared to a series of traditional sequential recommendation models and generative recommendation baselines.</p>
</div>
<div class="ltx_keywords">Generative Recommendation, Item Tokenization
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct conference title from your rights confirmation email; June 03–05, 2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Woodstock ’18: ACM Symposium on Neural Gaze Detection, June 03–05, 2018, Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>0000000.0000000</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommendation systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recommender systems, it is essential to model the sequential patterns of user behaviors, so as to effectively predict the future interactions for target users. Such task setting is typically formulated as <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">sequential recommendation</em> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib8" title="">2016</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>; Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib21" title="">2010</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib27" title="">2018</a>)</cite>, which has attracted increasing research attention.
Traditional sequential recommenders <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib23" title="">2019</a>; Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib8" title="">2016</a>)</cite> are often developed based on sequence models (<em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">e.g.,</em> RNN, CNN, and Transformer) and make the predictions in a <em class="ltx_emph ltx_font_italic" id="S1.p1.1.3">discriminative</em> way, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.4">i.e.,</em> evaluating the similarity between the observed past sequence and candidate items, then selecting the most similar item(s) for recommendation.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, drawing from the promising potential of generative language models <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib24" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib36" title="">2023</a>)</cite>, several studies have emerged to apply the generative paradigm in recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib25" title="">2024</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>.
Different from discriminative methods, the generative approach formulates the sequential recommendation task as a sequence-to-sequence problem and autoregressively generates the identifiers of target items.
Specifically, it generally involves two main aspects, namely <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">item tokenization</em> and <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">autoregressive generation</em>, for developing the entire recommendation framework.
For item tokenization, it basically refers to assigning a list of meaningful IDs for indexing or representing an item.
Existing efforts include parameter-free methods based on the co-occurrence matrix <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite>, text feature identifier <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib13" title="">2023b</a>; Di Palma, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib3" title="">2023</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib25" title="">2024</a>)</cite>, hierarchical clustering <cite class="ltx_cite ltx_citemacro_citep">(Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>)</cite>, and multi-level vector quantization (VQ) <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib18" title="">2024</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib14" title="">2024b</a>)</cite>.
Furthermore, several recent studies attempt to improve the quality of item identifiers by introducing collaborative signals <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>, diversified regularization <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>, or multi-behavior information <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib15" title="">2024a</a>)</cite>.
For autoregressive generation, the encoder-decoder architecture (<em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">e.g.,</em> T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib19" title="">2020</a>)</cite>) is the most widely used backbone due to its excellent capabilities in sequence modeling and generation.
In addition, there are also some studies that aim to improve performance by adjusting the backbone architecture <cite class="ltx_cite ltx_citemacro_citep">(Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>)</cite> or the learning objectives <cite class="ltx_cite ltx_citemacro_citep">(Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite these advancements, existing approaches typically consider item tokenization as a pre-processing step for subsequent generative recommendation.
This results in a <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">complete decoupling</em> of the item tokenization and autoregressive generation during model optimization, which likely hinders the potential of generative recommendation due to two major reasons.
Firstly, the item tokenizer is essentially unaware of the optimization objectives for recommendation or simply not the best match for the recommender.
Secondly, the generative recommender cannot deeply fuse or further refine the prior knowledge implicitly encoded in item representations from the item tokenizer.
In light of these concerns, we aim to develop an end-to-end generative recommendation framework that seamlessly integrates item tokenization and autoregressive generation.
To realize this seamless integration of tokenization and generation, we highlight two primary challenges:
(1) How to integrate the item tokenizer and generative recommender into a unified recommendation framework;
(2) How to achieve mutual enhancement between the item tokenizer and generative recommender for end-to-end optimization.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To this end, in this paper, we propose <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">ETEGRec</span>, an <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.2">E</span>nd-<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.3">T</span>o-<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.4">E</span>nd <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.5">G</span>enerative <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.6">Rec</span>ommender that seamlessly integrates item tokenization and autoregressive generation.
Our framework adopts a dual encoder-decoder architecture, where the item tokenizer adopts Residual Quantization Variational Autoencoder (RQ-VAE), and the generative recommender is a Transformer model similar to T5.
The key novelty of our approach lies in that the item tokenizer can be jointly optimized with the generative recommender, which significantly differs from prior studies that use heuristic or pre-learned item tokenizers.
In order to achieve mutual enhancement between these two components, we design two recommendation-oriented alignment strategies, which include <em class="ltx_emph ltx_font_italic" id="S1.p4.1.7">sequence-item alignment</em> and <em class="ltx_emph ltx_font_italic" id="S1.p4.1.8">preference-semantic alignment</em>.
Specifically, sequence-item alignment requires that the quantized token distributions from the encoder’s sequential states and the collaborative embedding of the target item should be similar,
and preference-semantic alignment employs contrastive learning to align the user preference captured by the Transformer decoder with the target item semantics reconstructed by RQ-VAE.
Generally, our objective is to seamlessly integrate the tokenizer with the recommender through a well-crafted alignment approach, thereby fostering the mutual enhancement between the two components.
Finally, to ensure stable and effective end-to-end learning, we further devise an alternating optimization method for joint training.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In summary, our main contributions are as follows:</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mo id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">∙</annotation></semantics></math> We propose a novel end-to-end generative recommender that achieves mutual enhancement and joint optimization of item tokenization and autoregressive generation.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p7.1.m1.1"><semantics id="S1.p7.1.m1.1a"><mo id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><ci id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p7.1.m1.1d">∙</annotation></semantics></math> We design a recommendation-oriented alignment approach that mutually enhances the item tokenizer and the generative recommender through sequence-item alignment and preference-semantic alignment.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p8.1.m1.1"><semantics id="S1.p8.1.m1.1a"><mo id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><ci id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p8.1.m1.1d">∙</annotation></semantics></math> We conduct extensive experiments on three recommendation benchmarks, demonstrating the superiority of our proposed framework compared with both traditional sequential recommendation models and generative recommendation baselines.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="359" id="S1.F1.g1" src="x1.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The overall framework of ETEGRec. ETEGRec consists of two main components, the item tokenizer and the generative recommender. Sequence-Item Alignment (SIA) and Preference-Semantic Alignment (PSA) achieve their alignment from two different perspectives for mutual enhancement.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Methodology</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we elaborate on ETEGRec, which develops a joint optimization framework for item tokenization and generative recommendation.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS1" title="2.1. Problem Formulation ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2.1</span></a>, we formally define the generative recommendation task.
Then we present the dual encoder-decoder architecture of our framework in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS2" title="2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2.2</span></a>, comprising an item tokenizer and a generative recommender.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS3" title="2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2.3</span></a>, we introduce the recommendation-oriented alignment including two alignment objectives, <em class="ltx_emph ltx_font_italic" id="S2.p1.1.1">i.e.,</em> sequence-item alignment and preference-semantic alignment, to align the two components from two different perspectives.
Finally, we describe in detail the alternating optimization approach in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS4" title="2.4. Alternating Optimization ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2.4</span></a>. An illustration of our proposed framework is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.5">As the task setting, following prior studies <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib23" title="">2019</a>)</cite>, we consider a typical sequential recommendation scenario.
Given the item set <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">caligraphic_I</annotation></semantics></math> and an interaction sequence <math alttext="S=[i_{1},i_{2},\dots,i_{t}]" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.4"><semantics id="S2.SS1.p1.2.m2.4a"><mrow id="S2.SS1.p1.2.m2.4.4" xref="S2.SS1.p1.2.m2.4.4.cmml"><mi id="S2.SS1.p1.2.m2.4.4.5" xref="S2.SS1.p1.2.m2.4.4.5.cmml">S</mi><mo id="S2.SS1.p1.2.m2.4.4.4" xref="S2.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.4.4.3.3" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S2.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">[</mo><msub id="S2.SS1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.5" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S2.SS1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.6" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.4.4.3.3.7" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml">i</mi><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.4b"><apply id="S2.SS1.p1.2.m2.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4"><eq id="S2.SS1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4.4"></eq><ci id="S2.SS1.p1.2.m2.4.4.5.cmml" xref="S2.SS1.p1.2.m2.4.4.5">𝑆</ci><list id="S2.SS1.p1.2.m2.4.4.3.4.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3"><apply id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2">𝑖</ci><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.4c">S=[i_{1},i_{2},\dots,i_{t}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.4d">italic_S = [ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> from a target user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_u</annotation></semantics></math>, sequential recommendation aims to predict the next item <math alttext="i_{t+1}\in\mathcal{I}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><msub id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2.2" xref="S2.SS1.p1.4.m4.1.1.2.2.cmml">i</mi><mrow id="S2.SS1.p1.4.m4.1.1.2.3" xref="S2.SS1.p1.4.m4.1.1.2.3.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2.3.2" xref="S2.SS1.p1.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S2.SS1.p1.4.m4.1.1.2.3.1" xref="S2.SS1.p1.4.m4.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.4.m4.1.1.2.3.3" xref="S2.SS1.p1.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><in id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></in><apply id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.2">𝑖</ci><apply id="S2.SS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3"><plus id="S2.SS1.p1.4.m4.1.1.2.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3.1"></plus><ci id="S2.SS1.p1.4.m4.1.1.2.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3.2">𝑡</ci><cn id="S2.SS1.p1.4.m4.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">i_{t+1}\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∈ caligraphic_I</annotation></semantics></math> that user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_u</annotation></semantics></math> is likely to interact with.
To approach this task, we take the generative paradigm by casting sequential recommendation as <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.5.1">token sequence generation</em> <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite>: each item is indexed or represented by some ID identifier, and the task aims to generate the ID identifier of the future interacted item.
As a straightforward approach, we can represent each item with its original item ID (<em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.5.2">e.g.,</em> a unique product number or a randomly assigned number). However, such an approach cannot effectively share similar semantics among different items, while often leading to a large item vocabulary.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.13">In a more generic way, each item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_i</annotation></semantics></math> is represented by multiple tokens <math alttext="[c_{1},\dots,c_{L}]" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.3"><semantics id="S2.SS1.p2.2.m2.3a"><mrow id="S2.SS1.p2.2.m2.3.3.2" xref="S2.SS1.p2.2.m2.3.3.3.cmml"><mo id="S2.SS1.p2.2.m2.3.3.2.3" stretchy="false" xref="S2.SS1.p2.2.m2.3.3.3.cmml">[</mo><msub id="S2.SS1.p2.2.m2.2.2.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml">c</mi><mn id="S2.SS1.p2.2.m2.2.2.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.2.m2.3.3.2.4" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><mi id="S2.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p2.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p2.2.m2.3.3.2.5" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS1.p2.2.m2.3.3.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS1.p2.2.m2.3.3.2.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.2.cmml">c</mi><mi id="S2.SS1.p2.2.m2.3.3.2.2.3" xref="S2.SS1.p2.2.m2.3.3.2.2.3.cmml">L</mi></msub><mo id="S2.SS1.p2.2.m2.3.3.2.6" stretchy="false" xref="S2.SS1.p2.2.m2.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.3b"><list id="S2.SS1.p2.2.m2.3.3.3.cmml" xref="S2.SS1.p2.2.m2.3.3.2"><apply id="S2.SS1.p2.2.m2.2.2.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.2">𝑐</ci><cn id="S2.SS1.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">…</ci><apply id="S2.SS1.p2.2.m2.3.3.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.3.3.2.2.1.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2">𝑐</ci><ci id="S2.SS1.p2.2.m2.3.3.2.2.3.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.3c">[c_{1},\dots,c_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.3d">[ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_L</annotation></semantics></math> denotes the identifier length.
In practice, <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_L</annotation></semantics></math> can vary for different items, while we follow RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib38" title="">2022</a>)</cite> to use the same identifier length for all the items, to reduce the potential length bias in item prediction <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>; Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>)</cite>.
Following the convention in natural language processing <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib19" title="">2020</a>)</cite>, we refer to the process of mapping an item into multiple tokens as <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.13.1">item tokenization</em>.
In this representation scheme,
the input interaction sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_S</annotation></semantics></math> can be first tokenized into the token sequence <math alttext="X=[c^{1}_{1},c^{1}_{2},\dots,c^{t}_{L-1},c^{t}_{L}]" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.5"><semantics id="S2.SS1.p2.6.m6.5a"><mrow id="S2.SS1.p2.6.m6.5.5" xref="S2.SS1.p2.6.m6.5.5.cmml"><mi id="S2.SS1.p2.6.m6.5.5.6" xref="S2.SS1.p2.6.m6.5.5.6.cmml">X</mi><mo id="S2.SS1.p2.6.m6.5.5.5" xref="S2.SS1.p2.6.m6.5.5.5.cmml">=</mo><mrow id="S2.SS1.p2.6.m6.5.5.4.4" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml"><mo id="S2.SS1.p2.6.m6.5.5.4.4.5" stretchy="false" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">[</mo><msubsup id="S2.SS1.p2.6.m6.2.2.1.1.1" xref="S2.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.6.m6.2.2.1.1.1.2.2" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml">c</mi><mn id="S2.SS1.p2.6.m6.2.2.1.1.1.3" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml">1</mn><mn id="S2.SS1.p2.6.m6.2.2.1.1.1.2.3" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.SS1.p2.6.m6.5.5.4.4.6" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">,</mo><msubsup id="S2.SS1.p2.6.m6.3.3.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.6.m6.3.3.2.2.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.2.cmml">c</mi><mn id="S2.SS1.p2.6.m6.3.3.2.2.2.3" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml">2</mn><mn id="S2.SS1.p2.6.m6.3.3.2.2.2.2.3" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S2.SS1.p2.6.m6.5.5.4.4.7" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">,</mo><mi id="S2.SS1.p2.6.m6.1.1" mathvariant="normal" xref="S2.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S2.SS1.p2.6.m6.5.5.4.4.8" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">,</mo><msubsup id="S2.SS1.p2.6.m6.4.4.3.3.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.6.m6.4.4.3.3.3.2.2" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2.2.cmml">c</mi><mrow id="S2.SS1.p2.6.m6.4.4.3.3.3.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.cmml"><mi id="S2.SS1.p2.6.m6.4.4.3.3.3.3.2" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.2.cmml">L</mi><mo id="S2.SS1.p2.6.m6.4.4.3.3.3.3.1" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.1.cmml">−</mo><mn id="S2.SS1.p2.6.m6.4.4.3.3.3.3.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p2.6.m6.4.4.3.3.3.2.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2.3.cmml">t</mi></msubsup><mo id="S2.SS1.p2.6.m6.5.5.4.4.9" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">,</mo><msubsup id="S2.SS1.p2.6.m6.5.5.4.4.4" xref="S2.SS1.p2.6.m6.5.5.4.4.4.cmml"><mi id="S2.SS1.p2.6.m6.5.5.4.4.4.2.2" xref="S2.SS1.p2.6.m6.5.5.4.4.4.2.2.cmml">c</mi><mi id="S2.SS1.p2.6.m6.5.5.4.4.4.3" xref="S2.SS1.p2.6.m6.5.5.4.4.4.3.cmml">L</mi><mi id="S2.SS1.p2.6.m6.5.5.4.4.4.2.3" xref="S2.SS1.p2.6.m6.5.5.4.4.4.2.3.cmml">t</mi></msubsup><mo id="S2.SS1.p2.6.m6.5.5.4.4.10" stretchy="false" xref="S2.SS1.p2.6.m6.5.5.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.5b"><apply id="S2.SS1.p2.6.m6.5.5.cmml" xref="S2.SS1.p2.6.m6.5.5"><eq id="S2.SS1.p2.6.m6.5.5.5.cmml" xref="S2.SS1.p2.6.m6.5.5.5"></eq><ci id="S2.SS1.p2.6.m6.5.5.6.cmml" xref="S2.SS1.p2.6.m6.5.5.6">𝑋</ci><list id="S2.SS1.p2.6.m6.5.5.4.5.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4"><apply id="S2.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S2.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.2">𝑐</ci><cn id="S2.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.3">1</cn></apply><cn id="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S2.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.3.3.2.2.2.2.1.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S2.SS1.p2.6.m6.3.3.2.2.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.2">𝑐</ci><cn id="S2.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.3">1</cn></apply><cn id="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">…</ci><apply id="S2.SS1.p2.6.m6.4.4.3.3.3.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3">subscript</csymbol><apply id="S2.SS1.p2.6.m6.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.4.4.3.3.3.2.1.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3">superscript</csymbol><ci id="S2.SS1.p2.6.m6.4.4.3.3.3.2.2.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2.2">𝑐</ci><ci id="S2.SS1.p2.6.m6.4.4.3.3.3.2.3.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2.3">𝑡</ci></apply><apply id="S2.SS1.p2.6.m6.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3"><minus id="S2.SS1.p2.6.m6.4.4.3.3.3.3.1.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.1"></minus><ci id="S2.SS1.p2.6.m6.4.4.3.3.3.3.2.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.2">𝐿</ci><cn id="S2.SS1.p2.6.m6.4.4.3.3.3.3.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.6.m6.5.5.4.4.4.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.5.5.4.4.4.1.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4">subscript</csymbol><apply id="S2.SS1.p2.6.m6.5.5.4.4.4.2.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.5.5.4.4.4.2.1.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4">superscript</csymbol><ci id="S2.SS1.p2.6.m6.5.5.4.4.4.2.2.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4.2.2">𝑐</ci><ci id="S2.SS1.p2.6.m6.5.5.4.4.4.2.3.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4.2.3">𝑡</ci></apply><ci id="S2.SS1.p2.6.m6.5.5.4.4.4.3.cmml" xref="S2.SS1.p2.6.m6.5.5.4.4.4.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.5c">X=[c^{1}_{1},c^{1}_{2},\dots,c^{t}_{L-1},c^{t}_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.5d">italic_X = [ italic_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L - 1 end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math>, where each item in <math alttext="S" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mi id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">italic_S</annotation></semantics></math> is represented by its identifier (<em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.13.2">i.e.,</em> <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><mi id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><ci id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">italic_L</annotation></semantics></math> tokens) and <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m9.1"><semantics id="S2.SS1.p2.9.m9.1a"><mi id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><ci id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m9.1d">italic_t</annotation></semantics></math> is the original item index in the interaction sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m10.1"><semantics id="S2.SS1.p2.10.m10.1a"><mi id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><ci id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m10.1d">italic_S</annotation></semantics></math>.
To obtain the item identifiers, previous studies either adopt the heuristic method <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib13" title="">2023b</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib4" title="">2022</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite> or employ a pre-learned tokenizer <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite> for item tokenization.
In this work, we consider devising an end-to-end approach for learning both the item tokenizer and the recommender backbone.
The objective of generative recommendation is to first derive the token sequence <math alttext="X" class="ltx_Math" display="inline" id="S2.SS1.p2.11.m11.1"><semantics id="S2.SS1.p2.11.m11.1a"><mi id="S2.SS1.p2.11.m11.1.1" xref="S2.SS1.p2.11.m11.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m11.1b"><ci id="S2.SS1.p2.11.m11.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m11.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.11.m11.1d">italic_X</annotation></semantics></math> and then generate the corresponding identifier of the target item <math alttext="Y=[c^{t+1}_{1},\dots,c^{t+1}_{L}]" class="ltx_Math" display="inline" id="S2.SS1.p2.12.m12.3"><semantics id="S2.SS1.p2.12.m12.3a"><mrow id="S2.SS1.p2.12.m12.3.3" xref="S2.SS1.p2.12.m12.3.3.cmml"><mi id="S2.SS1.p2.12.m12.3.3.4" xref="S2.SS1.p2.12.m12.3.3.4.cmml">Y</mi><mo id="S2.SS1.p2.12.m12.3.3.3" xref="S2.SS1.p2.12.m12.3.3.3.cmml">=</mo><mrow id="S2.SS1.p2.12.m12.3.3.2.2" xref="S2.SS1.p2.12.m12.3.3.2.3.cmml"><mo id="S2.SS1.p2.12.m12.3.3.2.2.3" stretchy="false" xref="S2.SS1.p2.12.m12.3.3.2.3.cmml">[</mo><msubsup id="S2.SS1.p2.12.m12.2.2.1.1.1" xref="S2.SS1.p2.12.m12.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.12.m12.2.2.1.1.1.2.2" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.2.cmml">c</mi><mn id="S2.SS1.p2.12.m12.2.2.1.1.1.3" xref="S2.SS1.p2.12.m12.2.2.1.1.1.3.cmml">1</mn><mrow id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.cmml"><mi id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.2" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.1" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.3" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p2.12.m12.3.3.2.2.4" xref="S2.SS1.p2.12.m12.3.3.2.3.cmml">,</mo><mi id="S2.SS1.p2.12.m12.1.1" mathvariant="normal" xref="S2.SS1.p2.12.m12.1.1.cmml">…</mi><mo id="S2.SS1.p2.12.m12.3.3.2.2.5" xref="S2.SS1.p2.12.m12.3.3.2.3.cmml">,</mo><msubsup id="S2.SS1.p2.12.m12.3.3.2.2.2" xref="S2.SS1.p2.12.m12.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.12.m12.3.3.2.2.2.2.2" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.2.cmml">c</mi><mi id="S2.SS1.p2.12.m12.3.3.2.2.2.3" xref="S2.SS1.p2.12.m12.3.3.2.2.2.3.cmml">L</mi><mrow id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.cmml"><mi id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.2" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.2.cmml">t</mi><mo id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.1" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.1.cmml">+</mo><mn id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.3" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p2.12.m12.3.3.2.2.6" stretchy="false" xref="S2.SS1.p2.12.m12.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m12.3b"><apply id="S2.SS1.p2.12.m12.3.3.cmml" xref="S2.SS1.p2.12.m12.3.3"><eq id="S2.SS1.p2.12.m12.3.3.3.cmml" xref="S2.SS1.p2.12.m12.3.3.3"></eq><ci id="S2.SS1.p2.12.m12.3.3.4.cmml" xref="S2.SS1.p2.12.m12.3.3.4">𝑌</ci><list id="S2.SS1.p2.12.m12.3.3.2.3.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2"><apply id="S2.SS1.p2.12.m12.2.2.1.1.1.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.12.m12.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.2.2.1.1.1.2.1.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1">superscript</csymbol><ci id="S2.SS1.p2.12.m12.2.2.1.1.1.2.2.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.2">𝑐</ci><apply id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3"><plus id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.1.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.1"></plus><ci id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.2.cmml" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p2.12.m12.2.2.1.1.1.2.3.3">1</cn></apply></apply><cn id="S2.SS1.p2.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.12.m12.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS1.p2.12.m12.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1">…</ci><apply id="S2.SS1.p2.12.m12.3.3.2.2.2.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2">subscript</csymbol><apply id="S2.SS1.p2.12.m12.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.3.3.2.2.2.2.1.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2">superscript</csymbol><ci id="S2.SS1.p2.12.m12.3.3.2.2.2.2.2.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.2">𝑐</ci><apply id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3"><plus id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.1.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.1"></plus><ci id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.2.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.2">𝑡</ci><cn id="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p2.12.m12.3.3.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p2.12.m12.3.3.2.2.2.3.cmml" xref="S2.SS1.p2.12.m12.3.3.2.2.2.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m12.3c">Y=[c^{t+1}_{1},\dots,c^{t+1}_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.12.m12.3d">italic_Y = [ italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math> at the <math alttext="(t+1)" class="ltx_Math" display="inline" id="S2.SS1.p2.13.m13.1"><semantics id="S2.SS1.p2.13.m13.1a"><mrow id="S2.SS1.p2.13.m13.1.1.1" xref="S2.SS1.p2.13.m13.1.1.1.1.cmml"><mo id="S2.SS1.p2.13.m13.1.1.1.2" stretchy="false" xref="S2.SS1.p2.13.m13.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.13.m13.1.1.1.1" xref="S2.SS1.p2.13.m13.1.1.1.1.cmml"><mi id="S2.SS1.p2.13.m13.1.1.1.1.2" xref="S2.SS1.p2.13.m13.1.1.1.1.2.cmml">t</mi><mo id="S2.SS1.p2.13.m13.1.1.1.1.1" xref="S2.SS1.p2.13.m13.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.13.m13.1.1.1.1.3" xref="S2.SS1.p2.13.m13.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p2.13.m13.1.1.1.3" stretchy="false" xref="S2.SS1.p2.13.m13.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.13.m13.1b"><apply id="S2.SS1.p2.13.m13.1.1.1.1.cmml" xref="S2.SS1.p2.13.m13.1.1.1"><plus id="S2.SS1.p2.13.m13.1.1.1.1.1.cmml" xref="S2.SS1.p2.13.m13.1.1.1.1.1"></plus><ci id="S2.SS1.p2.13.m13.1.1.1.1.2.cmml" xref="S2.SS1.p2.13.m13.1.1.1.1.2">𝑡</ci><cn id="S2.SS1.p2.13.m13.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.13.m13.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.13.m13.1c">(t+1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.13.m13.1d">( italic_t + 1 )</annotation></semantics></math>-th step.
Formally, this task can be formulated into a typical sequence-to-sequence learning problem as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(Y|X)=\prod_{l=1}^{L}P(c^{t+1}_{l}|X,c^{t+1}_{1},..,c^{t+1}_{l-1})." class="ltx_math_unparsed" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1b"><mi id="S2.E1.m1.1.2">P</mi><mrow id="S2.E1.m1.1.3"><mo id="S2.E1.m1.1.3.1" stretchy="false">(</mo><mi id="S2.E1.m1.1.3.2">Y</mi><mo fence="false" id="S2.E1.m1.1.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E1.m1.1.3.4">X</mi><mo id="S2.E1.m1.1.3.5" stretchy="false">)</mo></mrow><mo id="S2.E1.m1.1.4" rspace="0.111em">=</mo><munderover id="S2.E1.m1.1.5"><mo id="S2.E1.m1.1.5.2.2" movablelimits="false">∏</mo><mrow id="S2.E1.m1.1.5.2.3"><mi id="S2.E1.m1.1.5.2.3.2">l</mi><mo id="S2.E1.m1.1.5.2.3.1">=</mo><mn id="S2.E1.m1.1.5.2.3.3">1</mn></mrow><mi id="S2.E1.m1.1.5.3">L</mi></munderover><mi id="S2.E1.m1.1.6">P</mi><mrow id="S2.E1.m1.1.7"><mo id="S2.E1.m1.1.7.1" stretchy="false">(</mo><msubsup id="S2.E1.m1.1.7.2"><mi id="S2.E1.m1.1.7.2.2.2">c</mi><mi id="S2.E1.m1.1.7.2.3">l</mi><mrow id="S2.E1.m1.1.7.2.2.3"><mi id="S2.E1.m1.1.7.2.2.3.2">t</mi><mo id="S2.E1.m1.1.7.2.2.3.1">+</mo><mn id="S2.E1.m1.1.7.2.2.3.3">1</mn></mrow></msubsup><mo fence="false" id="S2.E1.m1.1.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E1.m1.1.1">X</mi><mo id="S2.E1.m1.1.7.4">,</mo><msubsup id="S2.E1.m1.1.7.5"><mi id="S2.E1.m1.1.7.5.2.2">c</mi><mn id="S2.E1.m1.1.7.5.3">1</mn><mrow id="S2.E1.m1.1.7.5.2.3"><mi id="S2.E1.m1.1.7.5.2.3.2">t</mi><mo id="S2.E1.m1.1.7.5.2.3.1">+</mo><mn id="S2.E1.m1.1.7.5.2.3.3">1</mn></mrow></msubsup><mo id="S2.E1.m1.1.7.6">,</mo><mo id="S2.E1.m1.1.7.7" lspace="0em" rspace="0.0835em">.</mo><mo id="S2.E1.m1.1.7.8" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S2.E1.m1.1.7.9">,</mo><msubsup id="S2.E1.m1.1.7.10"><mi id="S2.E1.m1.1.7.10.2.2">c</mi><mrow id="S2.E1.m1.1.7.10.3"><mi id="S2.E1.m1.1.7.10.3.2">l</mi><mo id="S2.E1.m1.1.7.10.3.1">−</mo><mn id="S2.E1.m1.1.7.10.3.3">1</mn></mrow><mrow id="S2.E1.m1.1.7.10.2.3"><mi id="S2.E1.m1.1.7.10.2.3.2">t</mi><mo id="S2.E1.m1.1.7.10.2.3.1">+</mo><mn id="S2.E1.m1.1.7.10.2.3.3">1</mn></mrow></msubsup><mo id="S2.E1.m1.1.7.11" stretchy="false">)</mo></mrow><mo id="S2.E1.m1.1.8" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.1c">P(Y|X)=\prod_{l=1}^{L}P(c^{t+1}_{l}|X,c^{t+1}_{1},..,c^{t+1}_{l-1}).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_P ( italic_Y | italic_X ) = ∏ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_P ( italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_X , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , . . , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Dual Encoder-Decoder Architecture</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">Our proposed framework consists of two main components, namely the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.2.1">item tokenizer</em> <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_T</annotation></semantics></math> and <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.2.2">generative recommender</em> <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">caligraphic_R</annotation></semantics></math>, both taking the encoder-decoder architecture.
The input item-level interaction sequence is first mapped into the token sequence by the item tokenizer before being fed into the recommender.
Then the generative recommender models the token sequence and autoregressively generates the item tokens for recommendation.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1. </span>Item Tokenizer</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.2">As introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.SS1" title="2.1. Problem Formulation ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2.1</span></a>, we adopt a <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_L</annotation></semantics></math>-level hierarchical representation scheme for item tokenization, in which each item is indexed by <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.1"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">italic_L</annotation></semantics></math> token IDs.
By taking a hierarchical scheme, we essentially organize the items in a tree-structured way, which is particularly suitable for generative tasks.
Another merit is that the collaborative semantics among items can be shared by the same prefix tokens.
Based on the above general idea, we next introduce the details for instanting the item tokenizer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p2">
<p class="ltx_p" id="S2.SS2.SSS1.p2.4"><span class="ltx_text ltx_font_bold" id="S2.SS2.SSS1.p2.4.1">Token Generation as Residual Quantization</span>.
We implement the item tokenizer as a RQ-VAE, which constructs multi-level tokens via residual quantization.
For each item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.1.m1.1"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><mi id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><ci id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.1.m1.1d">italic_i</annotation></semantics></math>, the item tokenizer <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.2.m2.1"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><ci id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.2.m2.1d">caligraphic_T</annotation></semantics></math> takes as input its contextual or collaborative semantic embedding <math alttext="\bm{z}\in\mathbb{R}^{d_{s}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.3.m3.1"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><mrow id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.1.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml">𝒛</mi><mo id="S2.SS2.SSS1.p2.3.m3.1.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS2.SSS1.p2.3.m3.1.1.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.1.3.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><msub id="S2.SS2.SSS1.p2.3.m3.1.1.3.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3.2.cmml">d</mi><mi id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3.3.cmml">s</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><apply id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1"><in id="S2.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.1"></in><ci id="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.2">𝒛</ci><apply id="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3.2">𝑑</ci><ci id="S2.SS2.SSS1.p2.3.m3.1.1.3.3.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">\bm{z}\in\mathbb{R}^{d_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.3.m3.1d">bold_italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>To obtain the semantic embeddings <math alttext="\bm{z}" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">bold_italic_z</annotation></semantics></math>, we can run conventional recommendation algorithms (<em class="ltx_emph ltx_font_italic" id="footnote1.1">e.g.,</em> SASRec) over the interaction data.</span></span></span>, where <math alttext="d_{s}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.4.m4.1"><semantics id="S2.SS2.SSS1.p2.4.m4.1a"><msub id="S2.SS2.SSS1.p2.4.m4.1.1" xref="S2.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S2.SS2.SSS1.p2.4.m4.1.1.2" xref="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml">d</mi><mi id="S2.SS2.SSS1.p2.4.m4.1.1.3" xref="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.4.m4.1b"><apply id="S2.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.2">𝑑</ci><ci id="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.4.m4.1c">d_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the dimension of the semantic embedding.
The output is its quantized tokens at each level, denoted as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[c_{1},\dots,c_{L}]=\mathcal{T}(\bm{z})," class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.2.2" xref="S2.E2.m1.3.3.1.1.2.3.cmml"><mo id="S2.E2.m1.3.3.1.1.2.2.3" stretchy="false" xref="S2.E2.m1.3.3.1.1.2.3.cmml">[</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.2.cmml">c</mi><mn id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E2.m1.3.3.1.1.2.2.4" xref="S2.E2.m1.3.3.1.1.2.3.cmml">,</mo><mi id="S2.E2.m1.1.1" mathvariant="normal" xref="S2.E2.m1.1.1.cmml">…</mi><mo id="S2.E2.m1.3.3.1.1.2.2.5" xref="S2.E2.m1.3.3.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.3.3.1.1.2.2.2" xref="S2.E2.m1.3.3.1.1.2.2.2.cmml"><mi id="S2.E2.m1.3.3.1.1.2.2.2.2" xref="S2.E2.m1.3.3.1.1.2.2.2.2.cmml">c</mi><mi id="S2.E2.m1.3.3.1.1.2.2.2.3" xref="S2.E2.m1.3.3.1.1.2.2.2.3.cmml">L</mi></msub><mo id="S2.E2.m1.3.3.1.1.2.2.6" stretchy="false" xref="S2.E2.m1.3.3.1.1.2.3.cmml">]</mo></mrow><mo id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.4" xref="S2.E2.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.1.1.4.2" xref="S2.E2.m1.3.3.1.1.4.2.cmml">𝒯</mi><mo id="S2.E2.m1.3.3.1.1.4.1" xref="S2.E2.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.4.3.2" xref="S2.E2.m1.3.3.1.1.4.cmml"><mo id="S2.E2.m1.3.3.1.1.4.3.2.1" stretchy="false" xref="S2.E2.m1.3.3.1.1.4.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">𝒛</mi><mo id="S2.E2.m1.3.3.1.1.4.3.2.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"></eq><list id="S2.E2.m1.3.3.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.2"><apply id="S2.E2.m1.3.3.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.2">𝑐</ci><cn id="S2.E2.m1.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.3.3.1.1.1.1.1.3">1</cn></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">…</ci><apply id="S2.E2.m1.3.3.1.1.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.2.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.2">𝑐</ci><ci id="S2.E2.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.3">𝐿</ci></apply></list><apply id="S2.E2.m1.3.3.1.1.4.cmml" xref="S2.E2.m1.3.3.1.1.4"><times id="S2.E2.m1.3.3.1.1.4.1.cmml" xref="S2.E2.m1.3.3.1.1.4.1"></times><ci id="S2.E2.m1.3.3.1.1.4.2.cmml" xref="S2.E2.m1.3.3.1.1.4.2">𝒯</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">[c_{1},\dots,c_{L}]=\mathcal{T}(\bm{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">[ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ] = caligraphic_T ( bold_italic_z ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p2.8">where <math alttext="c_{l}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.5.m1.1"><semantics id="S2.SS2.SSS1.p2.5.m1.1a"><msub id="S2.SS2.SSS1.p2.5.m1.1.1" xref="S2.SS2.SSS1.p2.5.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.5.m1.1.1.2" xref="S2.SS2.SSS1.p2.5.m1.1.1.2.cmml">c</mi><mi id="S2.SS2.SSS1.p2.5.m1.1.1.3" xref="S2.SS2.SSS1.p2.5.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.5.m1.1b"><apply id="S2.SS2.SSS1.p2.5.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.5.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.5.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.1.2">𝑐</ci><ci id="S2.SS2.SSS1.p2.5.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.5.m1.1c">c_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.5.m1.1d">italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> denotes the corresponding token of <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.6.m2.1"><semantics id="S2.SS2.SSS1.p2.6.m2.1a"><mi id="S2.SS2.SSS1.p2.6.m2.1.1" xref="S2.SS2.SSS1.p2.6.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.6.m2.1b"><ci id="S2.SS2.SSS1.p2.6.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.6.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.6.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.6.m2.1d">italic_i</annotation></semantics></math> at the <math alttext="l" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.7.m3.1"><semantics id="S2.SS2.SSS1.p2.7.m3.1a"><mi id="S2.SS2.SSS1.p2.7.m3.1.1" xref="S2.SS2.SSS1.p2.7.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.7.m3.1b"><ci id="S2.SS2.SSS1.p2.7.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.7.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.7.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.7.m3.1d">italic_l</annotation></semantics></math>-th level.
Specifically, we first encode <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.8.m4.1"><semantics id="S2.SS2.SSS1.p2.8.m4.1a"><mi id="S2.SS2.SSS1.p2.8.m4.1.1" xref="S2.SS2.SSS1.p2.8.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.8.m4.1b"><ci id="S2.SS2.SSS1.p2.8.m4.1.1.cmml" xref="S2.SS2.SSS1.p2.8.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.8.m4.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.8.m4.1d">bold_italic_z</annotation></semantics></math> into a latent representation via a multilayer perceptron network (MLP) based encoder:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{r}=\operatorname{Encoder}_{T}(\bm{z})." class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml">𝒓</mi><mo id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.2.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.2.cmml">Encoder</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.1a" xref="S2.E3.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.2.1" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.2.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">𝒛</mi><mo id="S2.E3.m1.2.2.1.1.1.1.2.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2" lspace="0em" xref="S2.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><eq id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"></eq><ci id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3">𝒓</ci><apply id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><apply id="S2.E3.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.2">Encoder</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3">𝑇</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\bm{r}=\operatorname{Encoder}_{T}(\bm{z}).</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">bold_italic_r = roman_Encoder start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ( bold_italic_z ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p2.14">Then, the latent representation <math alttext="\bm{r}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.9.m1.1"><semantics id="S2.SS2.SSS1.p2.9.m1.1a"><mi id="S2.SS2.SSS1.p2.9.m1.1.1" xref="S2.SS2.SSS1.p2.9.m1.1.1.cmml">𝒓</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.9.m1.1b"><ci id="S2.SS2.SSS1.p2.9.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.9.m1.1.1">𝒓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.9.m1.1c">\bm{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.9.m1.1d">bold_italic_r</annotation></semantics></math> is quantized into serialized codes (called <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS1.p2.14.1">tokens</em>) by looking up <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.10.m2.1"><semantics id="S2.SS2.SSS1.p2.10.m2.1a"><mi id="S2.SS2.SSS1.p2.10.m2.1.1" xref="S2.SS2.SSS1.p2.10.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.10.m2.1b"><ci id="S2.SS2.SSS1.p2.10.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.10.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.10.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.10.m2.1d">italic_L</annotation></semantics></math>-level codebooks, where <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.11.m3.1"><semantics id="S2.SS2.SSS1.p2.11.m3.1a"><mi id="S2.SS2.SSS1.p2.11.m3.1.1" xref="S2.SS2.SSS1.p2.11.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.11.m3.1b"><ci id="S2.SS2.SSS1.p2.11.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.11.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.11.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.11.m3.1d">italic_L</annotation></semantics></math> is the token length of each item.
At each level <math alttext="l\in\{1,\dots,L\}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.12.m4.3"><semantics id="S2.SS2.SSS1.p2.12.m4.3a"><mrow id="S2.SS2.SSS1.p2.12.m4.3.4" xref="S2.SS2.SSS1.p2.12.m4.3.4.cmml"><mi id="S2.SS2.SSS1.p2.12.m4.3.4.2" xref="S2.SS2.SSS1.p2.12.m4.3.4.2.cmml">l</mi><mo id="S2.SS2.SSS1.p2.12.m4.3.4.1" xref="S2.SS2.SSS1.p2.12.m4.3.4.1.cmml">∈</mo><mrow id="S2.SS2.SSS1.p2.12.m4.3.4.3.2" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml"><mo id="S2.SS2.SSS1.p2.12.m4.3.4.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml">{</mo><mn id="S2.SS2.SSS1.p2.12.m4.1.1" xref="S2.SS2.SSS1.p2.12.m4.1.1.cmml">1</mn><mo id="S2.SS2.SSS1.p2.12.m4.3.4.3.2.2" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml">,</mo><mi id="S2.SS2.SSS1.p2.12.m4.2.2" mathvariant="normal" xref="S2.SS2.SSS1.p2.12.m4.2.2.cmml">…</mi><mo id="S2.SS2.SSS1.p2.12.m4.3.4.3.2.3" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml">,</mo><mi id="S2.SS2.SSS1.p2.12.m4.3.3" xref="S2.SS2.SSS1.p2.12.m4.3.3.cmml">L</mi><mo id="S2.SS2.SSS1.p2.12.m4.3.4.3.2.4" stretchy="false" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.12.m4.3b"><apply id="S2.SS2.SSS1.p2.12.m4.3.4.cmml" xref="S2.SS2.SSS1.p2.12.m4.3.4"><in id="S2.SS2.SSS1.p2.12.m4.3.4.1.cmml" xref="S2.SS2.SSS1.p2.12.m4.3.4.1"></in><ci id="S2.SS2.SSS1.p2.12.m4.3.4.2.cmml" xref="S2.SS2.SSS1.p2.12.m4.3.4.2">𝑙</ci><set id="S2.SS2.SSS1.p2.12.m4.3.4.3.1.cmml" xref="S2.SS2.SSS1.p2.12.m4.3.4.3.2"><cn id="S2.SS2.SSS1.p2.12.m4.1.1.cmml" type="integer" xref="S2.SS2.SSS1.p2.12.m4.1.1">1</cn><ci id="S2.SS2.SSS1.p2.12.m4.2.2.cmml" xref="S2.SS2.SSS1.p2.12.m4.2.2">…</ci><ci id="S2.SS2.SSS1.p2.12.m4.3.3.cmml" xref="S2.SS2.SSS1.p2.12.m4.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.12.m4.3c">l\in\{1,\dots,L\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.12.m4.3d">italic_l ∈ { 1 , … , italic_L }</annotation></semantics></math>, we have a codebook <math alttext="\mathcal{C}_{l}=\{\bm{e}^{l}_{k}\}_{k=1}^{K},\bm{e}^{l}_{k}\in\mathbb{R}^{d_{c}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.13.m5.2"><semantics id="S2.SS2.SSS1.p2.13.m5.2a"><mrow id="S2.SS2.SSS1.p2.13.m5.2.2.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.3.cmml"><mrow id="S2.SS2.SSS1.p2.13.m5.1.1.1.1" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.cmml"><msub id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.2" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.2.cmml">𝒞</mi><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.2" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.2.cmml">=</mo><msubsup id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.cmml"><mrow id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.2.cmml"><mo id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒆</mi><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.2" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.1" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.3" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.3.cmml">K</mi></msubsup></mrow><mo id="S2.SS2.SSS1.p2.13.m5.2.2.2.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.3a.cmml">,</mo><mrow id="S2.SS2.SSS1.p2.13.m5.2.2.2.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.cmml"><msubsup id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.2.cmml">𝒆</mi><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.3.cmml">k</mi><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.1" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.cmml"><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.2.cmml">ℝ</mi><msub id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.cmml"><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.2" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.2.cmml">d</mi><mi id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.3" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.3.cmml">c</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.13.m5.2b"><apply id="S2.SS2.SSS1.p2.13.m5.2.2.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.2.2.3a.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1"><eq id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.2"></eq><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.2">𝒞</ci><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.3.3">𝑙</ci></apply><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1">subscript</csymbol><set id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1"><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.2">𝒆</ci><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3"><eq id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.1"></eq><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.1.1.1.1.1.3">𝐾</ci></apply></apply><apply id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2"><in id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.1"></in><apply id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2">subscript</csymbol><apply id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.2">𝒆</ci><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3">superscript</csymbol><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.1.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.2.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.2">𝑑</ci><ci id="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.3.cmml" xref="S2.SS2.SSS1.p2.13.m5.2.2.2.2.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.13.m5.2c">\mathcal{C}_{l}=\{\bm{e}^{l}_{k}\}_{k=1}^{K},\bm{e}^{l}_{k}\in\mathbb{R}^{d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.13.m5.2d">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = { bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.14.m6.1"><semantics id="S2.SS2.SSS1.p2.14.m6.1a"><mi id="S2.SS2.SSS1.p2.14.m6.1.1" xref="S2.SS2.SSS1.p2.14.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.14.m6.1b"><ci id="S2.SS2.SSS1.p2.14.m6.1.1.cmml" xref="S2.SS2.SSS1.p2.14.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.14.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.14.m6.1d">italic_K</annotation></semantics></math> is the codebook size.
Subsequently, the residual quantization can be conducted as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c_{l}" class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><msub id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">c</mi><mi id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑐</ci><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle c_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\arg\max_{k}P(k|\bm{v}_{l})," class="ltx_Math" display="inline" id="S2.E4.m2.1"><semantics id="S2.E4.m2.1a"><mrow id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E4.m2.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.1.3.1.cmml">arg</mi><mo id="S2.E4.m2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E4.m2.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S2.E4.m2.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.3.2.cmml"><munder id="S2.E4.m2.1.1.1.1.1.3.2.1" xref="S2.E4.m2.1.1.1.1.1.3.2.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.3.2.1.2" xref="S2.E4.m2.1.1.1.1.1.3.2.1.2.cmml">max</mi><mi id="S2.E4.m2.1.1.1.1.1.3.2.1.3" xref="S2.E4.m2.1.1.1.1.1.3.2.1.3.cmml">k</mi></munder><mo id="S2.E4.m2.1.1.1.1.1.3.2a" lspace="0.167em" xref="S2.E4.m2.1.1.1.1.1.3.2.cmml">⁡</mo><mi id="S2.E4.m2.1.1.1.1.1.3.2.2" xref="S2.E4.m2.1.1.1.1.1.3.2.2.cmml">P</mi></mrow></mrow><mo id="S2.E4.m2.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m2.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo fence="false" id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E4.m2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝒗</mi><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S2.E4.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m2.1.1.1.2" xref="S2.E4.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.1b"><apply id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1"><eq id="S2.E4.m2.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E4.m2.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"><times id="S2.E4.m2.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.2"></times><apply id="S2.E4.m2.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.3"><arg id="S2.E4.m2.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.3.1"></arg><apply id="S2.E4.m2.1.1.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2"><apply id="S2.E4.m2.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.3.2.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2.1">subscript</csymbol><max id="S2.E4.m2.1.1.1.1.1.3.2.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2.1.2"></max><ci id="S2.E4.m2.1.1.1.1.1.3.2.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2.1.3">𝑘</ci></apply><ci id="S2.E4.m2.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2.2">𝑃</ci></apply></apply><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2">𝑘</ci><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.2">𝒗</ci><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.1c">\displaystyle=\arg\max_{k}P(k|\bm{v}_{l}),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.1d">= roman_arg roman_max start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_P ( italic_k | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{v}_{l}" class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><msub id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mi id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">𝒗</mi><mi id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2">𝒗</ci><ci id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\bm{v}_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{v}_{l-1}-\bm{e}^{l}_{c_{l-1}}." class="ltx_Math" display="inline" id="S2.E5.m2.1"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml"><msub id="S2.E5.m2.1.1.1.1.3.2" xref="S2.E5.m2.1.1.1.1.3.2.cmml"><mi id="S2.E5.m2.1.1.1.1.3.2.2" xref="S2.E5.m2.1.1.1.1.3.2.2.cmml">𝒗</mi><mrow id="S2.E5.m2.1.1.1.1.3.2.3" xref="S2.E5.m2.1.1.1.1.3.2.3.cmml"><mi id="S2.E5.m2.1.1.1.1.3.2.3.2" xref="S2.E5.m2.1.1.1.1.3.2.3.2.cmml">l</mi><mo id="S2.E5.m2.1.1.1.1.3.2.3.1" xref="S2.E5.m2.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S2.E5.m2.1.1.1.1.3.2.3.3" xref="S2.E5.m2.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E5.m2.1.1.1.1.3.1" xref="S2.E5.m2.1.1.1.1.3.1.cmml">−</mo><msubsup id="S2.E5.m2.1.1.1.1.3.3" xref="S2.E5.m2.1.1.1.1.3.3.cmml"><mi id="S2.E5.m2.1.1.1.1.3.3.2.2" xref="S2.E5.m2.1.1.1.1.3.3.2.2.cmml">𝒆</mi><msub id="S2.E5.m2.1.1.1.1.3.3.3" xref="S2.E5.m2.1.1.1.1.3.3.3.cmml"><mi id="S2.E5.m2.1.1.1.1.3.3.3.2" xref="S2.E5.m2.1.1.1.1.3.3.3.2.cmml">c</mi><mrow id="S2.E5.m2.1.1.1.1.3.3.3.3" xref="S2.E5.m2.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E5.m2.1.1.1.1.3.3.3.3.2" xref="S2.E5.m2.1.1.1.1.3.3.3.3.2.cmml">l</mi><mo id="S2.E5.m2.1.1.1.1.3.3.3.3.1" xref="S2.E5.m2.1.1.1.1.3.3.3.3.1.cmml">−</mo><mn id="S2.E5.m2.1.1.1.1.3.3.3.3.3" xref="S2.E5.m2.1.1.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub><mi id="S2.E5.m2.1.1.1.1.3.3.2.3" xref="S2.E5.m2.1.1.1.1.3.3.2.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" lspace="0em" xref="S2.E5.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"><minus id="S2.E5.m2.1.1.1.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.1"></minus><apply id="S2.E5.m2.1.1.1.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2">𝒗</ci><apply id="S2.E5.m2.1.1.1.1.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.3.2.3"><minus id="S2.E5.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.2.3.1"></minus><ci id="S2.E5.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2.3.2">𝑙</ci><cn id="S2.E5.m2.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E5.m2.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S2.E5.m2.1.1.1.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E5.m2.1.1.1.1.3.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E5.m2.1.1.1.1.3.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3.2.2">𝒆</ci><ci id="S2.E5.m2.1.1.1.1.3.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3.2.3">𝑙</ci></apply><apply id="S2.E5.m2.1.1.1.1.3.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.3.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.3.3.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3.2">𝑐</ci><apply id="S2.E5.m2.1.1.1.1.3.3.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3.3"><minus id="S2.E5.m2.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3.3.1"></minus><ci id="S2.E5.m2.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3.3.2">𝑙</ci><cn id="S2.E5.m2.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="S2.E5.m2.1.1.1.1.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\bm{v}_{l-1}-\bm{e}^{l}_{c_{l-1}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.1d">= bold_italic_v start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT - bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p2.22">where <math alttext="c_{l}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.15.m1.1"><semantics id="S2.SS2.SSS1.p2.15.m1.1a"><msub id="S2.SS2.SSS1.p2.15.m1.1.1" xref="S2.SS2.SSS1.p2.15.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.15.m1.1.1.2" xref="S2.SS2.SSS1.p2.15.m1.1.1.2.cmml">c</mi><mi id="S2.SS2.SSS1.p2.15.m1.1.1.3" xref="S2.SS2.SSS1.p2.15.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.15.m1.1b"><apply id="S2.SS2.SSS1.p2.15.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.15.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.15.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.15.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.15.m1.1.1.2">𝑐</ci><ci id="S2.SS2.SSS1.p2.15.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.15.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.15.m1.1c">c_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.15.m1.1d">italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="l" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.16.m2.1"><semantics id="S2.SS2.SSS1.p2.16.m2.1a"><mi id="S2.SS2.SSS1.p2.16.m2.1.1" xref="S2.SS2.SSS1.p2.16.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.16.m2.1b"><ci id="S2.SS2.SSS1.p2.16.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.16.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.16.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.16.m2.1d">italic_l</annotation></semantics></math>-th assigned token, <math alttext="\bm{v}_{l}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.17.m3.1"><semantics id="S2.SS2.SSS1.p2.17.m3.1a"><msub id="S2.SS2.SSS1.p2.17.m3.1.1" xref="S2.SS2.SSS1.p2.17.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p2.17.m3.1.1.2" xref="S2.SS2.SSS1.p2.17.m3.1.1.2.cmml">𝒗</mi><mi id="S2.SS2.SSS1.p2.17.m3.1.1.3" xref="S2.SS2.SSS1.p2.17.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.17.m3.1b"><apply id="S2.SS2.SSS1.p2.17.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.17.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.17.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p2.17.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.17.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p2.17.m3.1.1.2">𝒗</ci><ci id="S2.SS2.SSS1.p2.17.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p2.17.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.17.m3.1c">\bm{v}_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.17.m3.1d">bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is the residual vector at the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.18.m4.1"><semantics id="S2.SS2.SSS1.p2.18.m4.1a"><mi id="S2.SS2.SSS1.p2.18.m4.1.1" xref="S2.SS2.SSS1.p2.18.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.18.m4.1b"><ci id="S2.SS2.SSS1.p2.18.m4.1.1.cmml" xref="S2.SS2.SSS1.p2.18.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.18.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.18.m4.1d">italic_i</annotation></semantics></math>-th level, and we set <math alttext="\bm{v}_{1}=\bm{r}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.19.m5.1"><semantics id="S2.SS2.SSS1.p2.19.m5.1a"><mrow id="S2.SS2.SSS1.p2.19.m5.1.1" xref="S2.SS2.SSS1.p2.19.m5.1.1.cmml"><msub id="S2.SS2.SSS1.p2.19.m5.1.1.2" xref="S2.SS2.SSS1.p2.19.m5.1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.19.m5.1.1.2.2" xref="S2.SS2.SSS1.p2.19.m5.1.1.2.2.cmml">𝒗</mi><mn id="S2.SS2.SSS1.p2.19.m5.1.1.2.3" xref="S2.SS2.SSS1.p2.19.m5.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS2.SSS1.p2.19.m5.1.1.1" xref="S2.SS2.SSS1.p2.19.m5.1.1.1.cmml">=</mo><mi id="S2.SS2.SSS1.p2.19.m5.1.1.3" xref="S2.SS2.SSS1.p2.19.m5.1.1.3.cmml">𝒓</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.19.m5.1b"><apply id="S2.SS2.SSS1.p2.19.m5.1.1.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1"><eq id="S2.SS2.SSS1.p2.19.m5.1.1.1.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1.1"></eq><apply id="S2.SS2.SSS1.p2.19.m5.1.1.2.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.19.m5.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.19.m5.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1.2.2">𝒗</ci><cn id="S2.SS2.SSS1.p2.19.m5.1.1.2.3.cmml" type="integer" xref="S2.SS2.SSS1.p2.19.m5.1.1.2.3">1</cn></apply><ci id="S2.SS2.SSS1.p2.19.m5.1.1.3.cmml" xref="S2.SS2.SSS1.p2.19.m5.1.1.3">𝒓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.19.m5.1c">\bm{v}_{1}=\bm{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.19.m5.1d">bold_italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_italic_r</annotation></semantics></math>.
In the above equation, <math alttext="P(c_{l}=k|\bm{v}_{l})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.20.m6.1"><semantics id="S2.SS2.SSS1.p2.20.m6.1a"><mrow id="S2.SS2.SSS1.p2.20.m6.1.1" xref="S2.SS2.SSS1.p2.20.m6.1.1.cmml"><mi id="S2.SS2.SSS1.p2.20.m6.1.1.3" xref="S2.SS2.SSS1.p2.20.m6.1.1.3.cmml">P</mi><mo id="S2.SS2.SSS1.p2.20.m6.1.1.2" xref="S2.SS2.SSS1.p2.20.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p2.20.m6.1.1.1.1" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.cmml"><msub id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.2.cmml">c</mi><mi id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.1" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.2" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.2.cmml">k</mi><mo fence="false" id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.1" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.1.cmml">|</mo><msub id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.2" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.2.cmml">𝒗</mi><mi id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.3" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow><mo id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.3" stretchy="false" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.20.m6.1b"><apply id="S2.SS2.SSS1.p2.20.m6.1.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1"><times id="S2.SS2.SSS1.p2.20.m6.1.1.2.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.2"></times><ci id="S2.SS2.SSS1.p2.20.m6.1.1.3.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.3">𝑃</ci><apply id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1"><eq id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.1"></eq><apply id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.1">conditional</csymbol><ci id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.2">𝑘</ci><apply id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.2">𝒗</ci><ci id="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.SSS1.p2.20.m6.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.20.m6.1c">P(c_{l}=k|\bm{v}_{l})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.20.m6.1d">italic_P ( italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_k | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> represents the likelihood that the residual is quantized to token <math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.21.m7.1"><semantics id="S2.SS2.SSS1.p2.21.m7.1a"><mi id="S2.SS2.SSS1.p2.21.m7.1.1" xref="S2.SS2.SSS1.p2.21.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.21.m7.1b"><ci id="S2.SS2.SSS1.p2.21.m7.1.1.cmml" xref="S2.SS2.SSS1.p2.21.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.21.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.21.m7.1d">italic_k</annotation></semantics></math>, which is measured by the distance between <math alttext="\bm{v}_{l}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.22.m8.1"><semantics id="S2.SS2.SSS1.p2.22.m8.1a"><msub id="S2.SS2.SSS1.p2.22.m8.1.1" xref="S2.SS2.SSS1.p2.22.m8.1.1.cmml"><mi id="S2.SS2.SSS1.p2.22.m8.1.1.2" xref="S2.SS2.SSS1.p2.22.m8.1.1.2.cmml">𝒗</mi><mi id="S2.SS2.SSS1.p2.22.m8.1.1.3" xref="S2.SS2.SSS1.p2.22.m8.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.22.m8.1b"><apply id="S2.SS2.SSS1.p2.22.m8.1.1.cmml" xref="S2.SS2.SSS1.p2.22.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.22.m8.1.1.1.cmml" xref="S2.SS2.SSS1.p2.22.m8.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.22.m8.1.1.2.cmml" xref="S2.SS2.SSS1.p2.22.m8.1.1.2">𝒗</ci><ci id="S2.SS2.SSS1.p2.22.m8.1.1.3.cmml" xref="S2.SS2.SSS1.p2.22.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.22.m8.1c">\bm{v}_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.22.m8.1d">bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and different codebook vectors.
This probability can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(k|\bm{v}_{l})=\frac{\exp(-||\bm{v}_{l}-\bm{e}^{l}_{k}||^{2})}{\sum^{K}_{j=1}%
\exp(-||\bm{v}_{l}-\bm{e}^{l}_{j}||^{2})}." class="ltx_Math" display="block" id="S2.E6.m1.5"><semantics id="S2.E6.m1.5a"><mrow id="S2.E6.m1.5.5.1" xref="S2.E6.m1.5.5.1.1.cmml"><mrow id="S2.E6.m1.5.5.1.1" xref="S2.E6.m1.5.5.1.1.cmml"><mrow id="S2.E6.m1.5.5.1.1.1" xref="S2.E6.m1.5.5.1.1.1.cmml"><mi id="S2.E6.m1.5.5.1.1.1.3" xref="S2.E6.m1.5.5.1.1.1.3.cmml">P</mi><mo id="S2.E6.m1.5.5.1.1.1.2" xref="S2.E6.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.5.5.1.1.1.1.1" xref="S2.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.5.5.1.1.1.1.1.1" xref="S2.E6.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.5.5.1.1.1.1.1.1.2" xref="S2.E6.m1.5.5.1.1.1.1.1.1.2.cmml">k</mi><mo fence="false" id="S2.E6.m1.5.5.1.1.1.1.1.1.1" xref="S2.E6.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E6.m1.5.5.1.1.1.1.1.1.3" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3.2.cmml">𝒗</mi><mi id="S2.E6.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S2.E6.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.5.5.1.1.2" xref="S2.E6.m1.5.5.1.1.2.cmml">=</mo><mfrac id="S2.E6.m1.4.4" xref="S2.E6.m1.4.4.cmml"><mrow id="S2.E6.m1.2.2.2.2" xref="S2.E6.m1.2.2.2.3.cmml"><mi id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E6.m1.2.2.2.2a" xref="S2.E6.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E6.m1.2.2.2.2.1" xref="S2.E6.m1.2.2.2.3.cmml"><mo id="S2.E6.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E6.m1.2.2.2.3.cmml">(</mo><mrow id="S2.E6.m1.2.2.2.2.1.1" xref="S2.E6.m1.2.2.2.2.1.1.cmml"><mo id="S2.E6.m1.2.2.2.2.1.1a" xref="S2.E6.m1.2.2.2.2.1.1.cmml">−</mo><msup id="S2.E6.m1.2.2.2.2.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.cmml"><mrow id="S2.E6.m1.2.2.2.2.1.1.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.1.2.cmml"><mo id="S2.E6.m1.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">𝒗</mi><mi id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.2" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml">𝒆</mi><mi id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">k</mi><mi id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.3" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S2.E6.m1.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E6.m1.2.2.2.2.1.1.1.3" xref="S2.E6.m1.2.2.2.2.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E6.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E6.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E6.m1.4.4.4" xref="S2.E6.m1.4.4.4.cmml"><msubsup id="S2.E6.m1.4.4.4.3" xref="S2.E6.m1.4.4.4.3.cmml"><mo id="S2.E6.m1.4.4.4.3.2.2" xref="S2.E6.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E6.m1.4.4.4.3.3" xref="S2.E6.m1.4.4.4.3.3.cmml"><mi id="S2.E6.m1.4.4.4.3.3.2" xref="S2.E6.m1.4.4.4.3.3.2.cmml">j</mi><mo id="S2.E6.m1.4.4.4.3.3.1" xref="S2.E6.m1.4.4.4.3.3.1.cmml">=</mo><mn id="S2.E6.m1.4.4.4.3.3.3" xref="S2.E6.m1.4.4.4.3.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.4.4.4.3.2.3" xref="S2.E6.m1.4.4.4.3.2.3.cmml">K</mi></msubsup><mrow id="S2.E6.m1.4.4.4.2.1" xref="S2.E6.m1.4.4.4.2.2.cmml"><mi id="S2.E6.m1.3.3.3.1" xref="S2.E6.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E6.m1.4.4.4.2.1a" xref="S2.E6.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E6.m1.4.4.4.2.1.1" xref="S2.E6.m1.4.4.4.2.2.cmml"><mo id="S2.E6.m1.4.4.4.2.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.4.2.2.cmml">(</mo><mrow id="S2.E6.m1.4.4.4.2.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.cmml"><mo id="S2.E6.m1.4.4.4.2.1.1.1a" xref="S2.E6.m1.4.4.4.2.1.1.1.cmml">−</mo><msup id="S2.E6.m1.4.4.4.2.1.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.1.cmml"><mrow id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.2.cmml"><mo id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">𝒗</mi><mi id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.2" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.2.cmml">𝒆</mi><mi id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.3" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.3.cmml">j</mi><mi id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.3" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E6.m1.4.4.4.2.1.1.1.1.3" xref="S2.E6.m1.4.4.4.2.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E6.m1.4.4.4.2.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E6.m1.5.5.1.2" lspace="0em" xref="S2.E6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.5b"><apply id="S2.E6.m1.5.5.1.1.cmml" xref="S2.E6.m1.5.5.1"><eq id="S2.E6.m1.5.5.1.1.2.cmml" xref="S2.E6.m1.5.5.1.1.2"></eq><apply id="S2.E6.m1.5.5.1.1.1.cmml" xref="S2.E6.m1.5.5.1.1.1"><times id="S2.E6.m1.5.5.1.1.1.2.cmml" xref="S2.E6.m1.5.5.1.1.1.2"></times><ci id="S2.E6.m1.5.5.1.1.1.3.cmml" xref="S2.E6.m1.5.5.1.1.1.3">𝑃</ci><apply id="S2.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.2">𝑘</ci><apply id="S2.E6.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3.2">𝒗</ci><ci id="S2.E6.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.5.5.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S2.E6.m1.4.4.cmml" xref="S2.E6.m1.4.4"><divide id="S2.E6.m1.4.4.5.cmml" xref="S2.E6.m1.4.4"></divide><apply id="S2.E6.m1.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.2"><exp id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1"></exp><apply id="S2.E6.m1.2.2.2.2.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1"><minus id="S2.E6.m1.2.2.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1"></minus><apply id="S2.E6.m1.2.2.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E6.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1"><minus id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.1"></minus><apply id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝒗</ci><ci id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.2">𝒆</ci><ci id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.2.2.2.2.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S2.E6.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.2.2.2.2.1.1.1.3">2</cn></apply></apply></apply><apply id="S2.E6.m1.4.4.4.cmml" xref="S2.E6.m1.4.4.4"><apply id="S2.E6.m1.4.4.4.3.cmml" xref="S2.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.3.1.cmml" xref="S2.E6.m1.4.4.4.3">subscript</csymbol><apply id="S2.E6.m1.4.4.4.3.2.cmml" xref="S2.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.3.2.1.cmml" xref="S2.E6.m1.4.4.4.3">superscript</csymbol><sum id="S2.E6.m1.4.4.4.3.2.2.cmml" xref="S2.E6.m1.4.4.4.3.2.2"></sum><ci id="S2.E6.m1.4.4.4.3.2.3.cmml" xref="S2.E6.m1.4.4.4.3.2.3">𝐾</ci></apply><apply id="S2.E6.m1.4.4.4.3.3.cmml" xref="S2.E6.m1.4.4.4.3.3"><eq id="S2.E6.m1.4.4.4.3.3.1.cmml" xref="S2.E6.m1.4.4.4.3.3.1"></eq><ci id="S2.E6.m1.4.4.4.3.3.2.cmml" xref="S2.E6.m1.4.4.4.3.3.2">𝑗</ci><cn id="S2.E6.m1.4.4.4.3.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.4.3.3.3">1</cn></apply></apply><apply id="S2.E6.m1.4.4.4.2.2.cmml" xref="S2.E6.m1.4.4.4.2.1"><exp id="S2.E6.m1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.3.1"></exp><apply id="S2.E6.m1.4.4.4.2.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1"><minus id="S2.E6.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1"></minus><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.4.4.4.2.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1"><minus id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.1"></minus><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝒗</ci><ci id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.2">𝒆</ci><ci id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn id="S2.E6.m1.4.4.4.2.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.4.4.4.2.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.5c">P(k|\bm{v}_{l})=\frac{\exp(-||\bm{v}_{l}-\bm{e}^{l}_{k}||^{2})}{\sum^{K}_{j=1}%
\exp(-||\bm{v}_{l}-\bm{e}^{l}_{j}||^{2})}.</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.5d">italic_P ( italic_k | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( - | | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT - bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG ∑ start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT roman_exp ( - | | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT - bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p3">
<p class="ltx_p" id="S2.SS2.SSS1.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS2.SSS1.p3.3.1">Reconstruction Loss</span>.
Through the above process, RQ-VAE quantifies the initial semantic embedding into different levels of tokens from a coarse-to-fine granularity <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib38" title="">2022</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite>.
After that, we can obtain the item tokens <math alttext="[c_{1},\dots,c_{L}]" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.1.m1.3"><semantics id="S2.SS2.SSS1.p3.1.m1.3a"><mrow id="S2.SS2.SSS1.p3.1.m1.3.3.2" xref="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml"><mo id="S2.SS2.SSS1.p3.1.m1.3.3.2.3" stretchy="false" xref="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml">[</mo><msub id="S2.SS2.SSS1.p3.1.m1.2.2.1.1" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.cmml"><mi id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.2.cmml">c</mi><mn id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.SSS1.p3.1.m1.3.3.2.4" xref="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml">,</mo><mi id="S2.SS2.SSS1.p3.1.m1.1.1" mathvariant="normal" xref="S2.SS2.SSS1.p3.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.SSS1.p3.1.m1.3.3.2.5" xref="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml">,</mo><msub id="S2.SS2.SSS1.p3.1.m1.3.3.2.2" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2.cmml"><mi id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.2" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2.2.cmml">c</mi><mi id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.3" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2.3.cmml">L</mi></msub><mo id="S2.SS2.SSS1.p3.1.m1.3.3.2.6" stretchy="false" xref="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.1.m1.3b"><list id="S2.SS2.SSS1.p3.1.m1.3.3.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.3.3.2"><apply id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.2">𝑐</ci><cn id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.1">…</ci><apply id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2.2">𝑐</ci><ci id="S2.SS2.SSS1.p3.1.m1.3.3.2.2.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.3.3.2.2.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.1.m1.3c">[c_{1},\dots,c_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.1.m1.3d">[ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math> and the quantized representation <math alttext="\tilde{\bm{r}}=\sum_{l=1}^{L}\bm{e}^{l}_{c_{l}}\in\mathbb{R}^{d_{c}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.2.m2.1"><semantics id="S2.SS2.SSS1.p3.2.m2.1a"><mrow id="S2.SS2.SSS1.p3.2.m2.1.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p3.2.m2.1.1.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.2.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.2.cmml">𝒓</mi><mo id="S2.SS2.SSS1.p3.2.m2.1.1.2.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="S2.SS2.SSS1.p3.2.m2.1.1.3" rspace="0.111em" xref="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml">=</mo><mrow id="S2.SS2.SSS1.p3.2.m2.1.1.4" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.cmml"><msubsup id="S2.SS2.SSS1.p3.2.m2.1.1.4.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.cmml"><mo id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.2.cmml">∑</mo><mrow id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.2.cmml">l</mi><mo id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.1.cmml">=</mo><mn id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.3.cmml">L</mi></msubsup><msubsup id="S2.SS2.SSS1.p3.2.m2.1.1.4.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.2.cmml">𝒆</mi><msub id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.2.cmml">c</mi><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.3.cmml">l</mi></msub><mi id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.3.cmml">l</mi></msubsup></mrow><mo id="S2.SS2.SSS1.p3.2.m2.1.1.5" xref="S2.SS2.SSS1.p3.2.m2.1.1.5.cmml">∈</mo><msup id="S2.SS2.SSS1.p3.2.m2.1.1.6" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.6.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.2.cmml">ℝ</mi><msub id="S2.SS2.SSS1.p3.2.m2.1.1.6.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3.2.cmml">d</mi><mi id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3.3.cmml">c</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.2.m2.1b"><apply id="S2.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"><and id="S2.SS2.SSS1.p3.2.m2.1.1a.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"></and><apply id="S2.SS2.SSS1.p3.2.m2.1.1b.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"><eq id="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.3"></eq><apply id="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.2"><ci id="S2.SS2.SSS1.p3.2.m2.1.1.2.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.1">~</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.2.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.2">𝒓</ci></apply><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4"><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1">superscript</csymbol><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1">subscript</csymbol><sum id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.2"></sum><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3"><eq id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.1"></eq><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.2">𝑙</ci><cn id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.3.cmml" type="integer" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.1.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.1.3">𝐿</ci></apply><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2">subscript</csymbol><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2">superscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.2">𝒆</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.2.3">𝑙</ci></apply><apply id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3">subscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.2">𝑐</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.4.2.3.3">𝑙</ci></apply></apply></apply></apply><apply id="S2.SS2.SSS1.p3.2.m2.1.1c.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"><in id="S2.SS2.SSS1.p3.2.m2.1.1.5.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.5"></in><share href="https://arxiv.org/html/2409.05546v1#S2.SS2.SSS1.p3.2.m2.1.1.4.cmml" id="S2.SS2.SSS1.p3.2.m2.1.1d.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"></share><apply id="S2.SS2.SSS1.p3.2.m2.1.1.6.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.6.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6">superscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.6.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.2">ℝ</ci><apply id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3">subscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3.2">𝑑</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.6.3.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.6.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.2.m2.1c">\tilde{\bm{r}}=\sum_{l=1}^{L}\bm{e}^{l}_{c_{l}}\in\mathbb{R}^{d_{c}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.2.m2.1d">over~ start_ARG bold_italic_r end_ARG = ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Subsequently, <math alttext="\tilde{\bm{r}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.3.m3.1"><semantics id="S2.SS2.SSS1.p3.3.m3.1a"><mover accent="true" id="S2.SS2.SSS1.p3.3.m3.1.1" xref="S2.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p3.3.m3.1.1.2" xref="S2.SS2.SSS1.p3.3.m3.1.1.2.cmml">𝒓</mi><mo id="S2.SS2.SSS1.p3.3.m3.1.1.1" xref="S2.SS2.SSS1.p3.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.3.m3.1b"><apply id="S2.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1"><ci id="S2.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1.1">~</ci><ci id="S2.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1.2">𝒓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.3.m3.1c">\tilde{\bm{r}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.3.m3.1d">over~ start_ARG bold_italic_r end_ARG</annotation></semantics></math> is fed into a MLP based decoder to reconstruct the item semantic embedding:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\bm{z}}=\operatorname{Decoder}_{T}(\tilde{\bm{r}})." class="ltx_Math" display="block" id="S2.E7.m1.2"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2.1" xref="S2.E7.m1.2.2.1.1.cmml"><mrow id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.1.cmml"><mover accent="true" id="S2.E7.m1.2.2.1.1.3" xref="S2.E7.m1.2.2.1.1.3.cmml"><mi id="S2.E7.m1.2.2.1.1.3.2" xref="S2.E7.m1.2.2.1.1.3.2.cmml">𝒛</mi><mo id="S2.E7.m1.2.2.1.1.3.1" xref="S2.E7.m1.2.2.1.1.3.1.cmml">~</mo></mover><mo id="S2.E7.m1.2.2.1.1.2" xref="S2.E7.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.2.2.1.1.1.1" xref="S2.E7.m1.2.2.1.1.1.2.cmml"><msub id="S2.E7.m1.2.2.1.1.1.1.1" xref="S2.E7.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E7.m1.2.2.1.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.1.1.2.cmml">Decoder</mi><mi id="S2.E7.m1.2.2.1.1.1.1.1.3" xref="S2.E7.m1.2.2.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S2.E7.m1.2.2.1.1.1.1a" xref="S2.E7.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.E7.m1.2.2.1.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.2.cmml"><mo id="S2.E7.m1.2.2.1.1.1.1.2.1" stretchy="false" xref="S2.E7.m1.2.2.1.1.1.2.cmml">(</mo><mover accent="true" id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mi id="S2.E7.m1.1.1.2" xref="S2.E7.m1.1.1.2.cmml">𝒓</mi><mo id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml">~</mo></mover><mo id="S2.E7.m1.2.2.1.1.1.1.2.2" stretchy="false" xref="S2.E7.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.2.2.1.2" lspace="0em" xref="S2.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.1.1.cmml" xref="S2.E7.m1.2.2.1"><eq id="S2.E7.m1.2.2.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2"></eq><apply id="S2.E7.m1.2.2.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.3"><ci id="S2.E7.m1.2.2.1.1.3.1.cmml" xref="S2.E7.m1.2.2.1.1.3.1">~</ci><ci id="S2.E7.m1.2.2.1.1.3.2.cmml" xref="S2.E7.m1.2.2.1.1.3.2">𝒛</ci></apply><apply id="S2.E7.m1.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.1.1"><apply id="S2.E7.m1.2.2.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.2">Decoder</ci><ci id="S2.E7.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.1.1.1.3">𝑇</ci></apply><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><ci id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1">~</ci><ci id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2">𝒓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">\tilde{\bm{z}}=\operatorname{Decoder}_{T}(\tilde{\bm{r}}).</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.2d">over~ start_ARG bold_italic_z end_ARG = roman_Decoder start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ( over~ start_ARG bold_italic_r end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p3.8">The semantic quantization loss for learning the item tokenizer is formulated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx2">
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{SQ}}" class="ltx_Math" display="inline" id="S2.E8.m1.1"><semantics id="S2.E8.m1.1a"><msub id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.1.1.2" xref="S2.E8.m1.1.1.2.cmml">ℒ</mi><mi id="S2.E8.m1.1.1.3" xref="S2.E8.m1.1.1.3.cmml">SQ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.cmml" xref="S2.E8.m1.1.1">subscript</csymbol><ci id="S2.E8.m1.1.1.2.cmml" xref="S2.E8.m1.1.1.2">ℒ</ci><ci id="S2.E8.m1.1.1.3.cmml" xref="S2.E8.m1.1.1.3">SQ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\displaystyle\mathcal{L}_{\operatorname{SQ}}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SQ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{L}_{\operatorname{RECON}}+\mathcal{L}_{\operatorname{RQ%
}}," class="ltx_Math" display="inline" id="S2.E8.m2.1"><semantics id="S2.E8.m2.1a"><mrow id="S2.E8.m2.1.1.1" xref="S2.E8.m2.1.1.1.1.cmml"><mrow id="S2.E8.m2.1.1.1.1" xref="S2.E8.m2.1.1.1.1.cmml"><mi id="S2.E8.m2.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E8.m2.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E8.m2.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.3.cmml"><msub id="S2.E8.m2.1.1.1.1.3.2" xref="S2.E8.m2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m2.1.1.1.1.3.2.2" xref="S2.E8.m2.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S2.E8.m2.1.1.1.1.3.2.3" xref="S2.E8.m2.1.1.1.1.3.2.3.cmml">RECON</mi></msub><mo id="S2.E8.m2.1.1.1.1.3.1" xref="S2.E8.m2.1.1.1.1.3.1.cmml">+</mo><msub id="S2.E8.m2.1.1.1.1.3.3" xref="S2.E8.m2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m2.1.1.1.1.3.3.2" xref="S2.E8.m2.1.1.1.1.3.3.2.cmml">ℒ</mi><mi id="S2.E8.m2.1.1.1.1.3.3.3" xref="S2.E8.m2.1.1.1.1.3.3.3.cmml">RQ</mi></msub></mrow></mrow><mo id="S2.E8.m2.1.1.1.2" xref="S2.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m2.1b"><apply id="S2.E8.m2.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1"><eq id="S2.E8.m2.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E8.m2.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E8.m2.1.1.1.1.3.cmml" xref="S2.E8.m2.1.1.1.1.3"><plus id="S2.E8.m2.1.1.1.1.3.1.cmml" xref="S2.E8.m2.1.1.1.1.3.1"></plus><apply id="S2.E8.m2.1.1.1.1.3.2.cmml" xref="S2.E8.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.3.2.1.cmml" xref="S2.E8.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.3.2.2.cmml" xref="S2.E8.m2.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.E8.m2.1.1.1.1.3.2.3.cmml" xref="S2.E8.m2.1.1.1.1.3.2.3">RECON</ci></apply><apply id="S2.E8.m2.1.1.1.1.3.3.cmml" xref="S2.E8.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E8.m2.1.1.1.1.3.3.1.cmml" xref="S2.E8.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E8.m2.1.1.1.1.3.3.2.cmml" xref="S2.E8.m2.1.1.1.1.3.3.2">ℒ</ci><ci id="S2.E8.m2.1.1.1.1.3.3.3.cmml" xref="S2.E8.m2.1.1.1.1.3.3.3">RQ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m2.1c">\displaystyle=\mathcal{L}_{\operatorname{RECON}}+\mathcal{L}_{\operatorname{RQ%
}},</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m2.1d">= caligraphic_L start_POSTSUBSCRIPT roman_RECON end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT roman_RQ end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{RECON}}" class="ltx_Math" display="inline" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><msub id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.1.1.2" xref="S2.E9.m1.1.1.2.cmml">ℒ</mi><mi id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml">RECON</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1">subscript</csymbol><ci id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1.2">ℒ</ci><ci id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3">RECON</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">\displaystyle\mathcal{L}_{\operatorname{RECON}}</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_RECON end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=||\bm{z}-\tilde{\bm{z}}||^{2}," class="ltx_Math" display="inline" id="S2.E9.m2.1"><semantics id="S2.E9.m2.1a"><mrow id="S2.E9.m2.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mi id="S2.E9.m2.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E9.m2.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.2.cmml">=</mo><msup id="S2.E9.m2.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.2.cmml"><mo id="S2.E9.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E9.m2.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E9.m2.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mo id="S2.E9.m2.1.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.E9.m2.1.1.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mo id="S2.E9.m2.1.1.1.1.1.1.1.1.3.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3.1.cmml">~</mo></mover></mrow><mo id="S2.E9.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E9.m2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E9.m2.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E9.m2.1.1.1.2" xref="S2.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m2.1b"><apply id="S2.E9.m2.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1"><eq id="S2.E9.m2.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E9.m2.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E9.m2.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E9.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1"><minus id="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.2">𝒛</ci><apply id="S2.E9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3"><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3.1">~</ci><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.3.2">𝒛</ci></apply></apply></apply><cn id="S2.E9.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.E9.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m2.1c">\displaystyle=||\bm{z}-\tilde{\bm{z}}||^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m2.1d">= | | bold_italic_z - over~ start_ARG bold_italic_z end_ARG | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{RQ}}" class="ltx_Math" display="inline" id="S2.E10.m1.1"><semantics id="S2.E10.m1.1a"><msub id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.2" xref="S2.E10.m1.1.1.2.cmml">ℒ</mi><mi id="S2.E10.m1.1.1.3" xref="S2.E10.m1.1.1.3.cmml">RQ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.cmml" xref="S2.E10.m1.1.1">subscript</csymbol><ci id="S2.E10.m1.1.1.2.cmml" xref="S2.E10.m1.1.1.2">ℒ</ci><ci id="S2.E10.m1.1.1.3.cmml" xref="S2.E10.m1.1.1.3">RQ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">\displaystyle\mathcal{L}_{\operatorname{RQ}}</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_RQ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{L}||\operatorname{sg}[\bm{v}_{l}]-\bm{e}^{l}_{c_{l}}%
||^{2}+\beta||\bm{v}_{l}-\operatorname{sg}[\bm{e}^{l}_{c_{l}}]||^{2}," class="ltx_Math" display="inline" id="S2.E10.m2.3"><semantics id="S2.E10.m2.3a"><mrow id="S2.E10.m2.3.3.1" xref="S2.E10.m2.3.3.1.1.cmml"><mrow id="S2.E10.m2.3.3.1.1" xref="S2.E10.m2.3.3.1.1.cmml"><mi id="S2.E10.m2.3.3.1.1.4" xref="S2.E10.m2.3.3.1.1.4.cmml"></mi><mo id="S2.E10.m2.3.3.1.1.3" xref="S2.E10.m2.3.3.1.1.3.cmml">=</mo><mrow id="S2.E10.m2.3.3.1.1.2" xref="S2.E10.m2.3.3.1.1.2.cmml"><mrow id="S2.E10.m2.3.3.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E10.m2.3.3.1.1.1.1.2" xref="S2.E10.m2.3.3.1.1.1.1.2.cmml"><munderover id="S2.E10.m2.3.3.1.1.1.1.2a" xref="S2.E10.m2.3.3.1.1.1.1.2.cmml"><mo id="S2.E10.m2.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E10.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E10.m2.3.3.1.1.1.1.2.2.3" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S2.E10.m2.3.3.1.1.1.1.2.2.3.2" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E10.m2.3.3.1.1.1.1.2.2.3.1" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E10.m2.3.3.1.1.1.1.2.2.3.3" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E10.m2.3.3.1.1.1.1.2.3" xref="S2.E10.m2.3.3.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><msup id="S2.E10.m2.3.3.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.cmml"><mrow id="S2.E10.m2.3.3.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.1.2.cmml"><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m2.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E10.m2.1.1" xref="S2.E10.m2.1.1.cmml">sg</mi><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1a" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">[</mo><msub id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒆</mi><msub id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msub><mi id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup></mrow><mo id="S2.E10.m2.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m2.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E10.m2.3.3.1.1.1.1.1.3" xref="S2.E10.m2.3.3.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S2.E10.m2.3.3.1.1.2.3" xref="S2.E10.m2.3.3.1.1.2.3.cmml">+</mo><mrow id="S2.E10.m2.3.3.1.1.2.2" xref="S2.E10.m2.3.3.1.1.2.2.cmml"><mi id="S2.E10.m2.3.3.1.1.2.2.3" xref="S2.E10.m2.3.3.1.1.2.2.3.cmml">β</mi><mo id="S2.E10.m2.3.3.1.1.2.2.2" xref="S2.E10.m2.3.3.1.1.2.2.2.cmml">⁢</mo><msup id="S2.E10.m2.3.3.1.1.2.2.1" xref="S2.E10.m2.3.3.1.1.2.2.1.cmml"><mrow id="S2.E10.m2.3.3.1.1.2.2.1.1.1" xref="S2.E10.m2.3.3.1.1.2.2.1.1.2.cmml"><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.2" stretchy="false" xref="S2.E10.m2.3.3.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.cmml"><msub id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.cmml"><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.2" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.2.cmml">𝒗</mi><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.3" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.2" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.2.cmml">−</mo><mrow id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S2.E10.m2.2.2" xref="S2.E10.m2.2.2.cmml">sg</mi><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1a" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml"><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml">[</mo><msubsup id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒆</mi><msub id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub><mi id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E10.m2.3.3.1.1.2.2.1.1.1.3" stretchy="false" xref="S2.E10.m2.3.3.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E10.m2.3.3.1.1.2.2.1.3" xref="S2.E10.m2.3.3.1.1.2.2.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S2.E10.m2.3.3.1.2" xref="S2.E10.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m2.3b"><apply id="S2.E10.m2.3.3.1.1.cmml" xref="S2.E10.m2.3.3.1"><eq id="S2.E10.m2.3.3.1.1.3.cmml" xref="S2.E10.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="S2.E10.m2.3.3.1.1.4.cmml" xref="S2.E10.m2.3.3.1.1.4">absent</csymbol><apply id="S2.E10.m2.3.3.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2"><plus id="S2.E10.m2.3.3.1.1.2.3.cmml" xref="S2.E10.m2.3.3.1.1.2.3"></plus><apply id="S2.E10.m2.3.3.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1"><apply id="S2.E10.m2.3.3.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.2.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E10.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E10.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S2.E10.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3"><eq id="S2.E10.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S2.E10.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E10.m2.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E10.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E10.m2.3.3.1.1.1.1.2.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.2.3">𝐿</ci></apply><apply id="S2.E10.m2.3.3.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E10.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1"><minus id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E10.m2.1.1.cmml" xref="S2.E10.m2.1.1">sg</ci><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.2">𝒆</ci><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply><cn id="S2.E10.m2.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S2.E10.m2.3.3.1.1.1.1.1.3">2</cn></apply></apply><apply id="S2.E10.m2.3.3.1.1.2.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2"><times id="S2.E10.m2.3.3.1.1.2.2.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.2"></times><ci id="S2.E10.m2.3.3.1.1.2.2.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.3">𝛽</ci><apply id="S2.E10.m2.3.3.1.1.2.2.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.2.2.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1">superscript</csymbol><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E10.m2.3.3.1.1.2.2.1.1.2.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1"><minus id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.2"></minus><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.2">𝒗</ci><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.3.3">𝑙</ci></apply><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1"><ci id="S2.E10.m2.2.2.cmml" xref="S2.E10.m2.2.2">sg</ci><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.2">𝒆</ci><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply><cn id="S2.E10.m2.3.3.1.1.2.2.1.3.cmml" type="integer" xref="S2.E10.m2.3.3.1.1.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m2.3c">\displaystyle=\sum_{i=1}^{L}||\operatorname{sg}[\bm{v}_{l}]-\bm{e}^{l}_{c_{l}}%
||^{2}+\beta||\bm{v}_{l}-\operatorname{sg}[\bm{e}^{l}_{c_{l}}]||^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m2.3d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT | | roman_sg [ bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] - bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_β | | bold_italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT - roman_sg [ bold_italic_e start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS1.p3.7">where <math alttext="\operatorname{sg}[\cdot]" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.4.m1.2"><semantics id="S2.SS2.SSS1.p3.4.m1.2a"><mrow id="S2.SS2.SSS1.p3.4.m1.2.3.2" xref="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml"><mi id="S2.SS2.SSS1.p3.4.m1.1.1" xref="S2.SS2.SSS1.p3.4.m1.1.1.cmml">sg</mi><mo id="S2.SS2.SSS1.p3.4.m1.2.3.2a" xref="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml">⁡</mo><mrow id="S2.SS2.SSS1.p3.4.m1.2.3.2.1" xref="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml"><mo id="S2.SS2.SSS1.p3.4.m1.2.3.2.1.1" stretchy="false" xref="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml">[</mo><mo id="S2.SS2.SSS1.p3.4.m1.2.2" lspace="0em" rspace="0em" xref="S2.SS2.SSS1.p3.4.m1.2.2.cmml">⋅</mo><mo id="S2.SS2.SSS1.p3.4.m1.2.3.2.1.2" stretchy="false" xref="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.4.m1.2b"><apply id="S2.SS2.SSS1.p3.4.m1.2.3.1.cmml" xref="S2.SS2.SSS1.p3.4.m1.2.3.2"><ci id="S2.SS2.SSS1.p3.4.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.4.m1.1.1">sg</ci><ci id="S2.SS2.SSS1.p3.4.m1.2.2.cmml" xref="S2.SS2.SSS1.p3.4.m1.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.4.m1.2c">\operatorname{sg}[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.4.m1.2d">roman_sg [ ⋅ ]</annotation></semantics></math> denotes the stop-gradient operation <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib28" title="">2017</a>)</cite>, and
<math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.5.m2.1"><semantics id="S2.SS2.SSS1.p3.5.m2.1a"><mi id="S2.SS2.SSS1.p3.5.m2.1.1" xref="S2.SS2.SSS1.p3.5.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.5.m2.1b"><ci id="S2.SS2.SSS1.p3.5.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.5.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.5.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.5.m2.1d">italic_β</annotation></semantics></math> is the coefficient that balances the optimization between the encoder and codebooks, typically set to 0.25.
<math alttext="\mathcal{L}_{\operatorname{RECON}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.6.m3.1"><semantics id="S2.SS2.SSS1.p3.6.m3.1a"><msub id="S2.SS2.SSS1.p3.6.m3.1.1" xref="S2.SS2.SSS1.p3.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p3.6.m3.1.1.2" xref="S2.SS2.SSS1.p3.6.m3.1.1.2.cmml">ℒ</mi><mi id="S2.SS2.SSS1.p3.6.m3.1.1.3" xref="S2.SS2.SSS1.p3.6.m3.1.1.3.cmml">RECON</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.6.m3.1b"><apply id="S2.SS2.SSS1.p3.6.m3.1.1.cmml" xref="S2.SS2.SSS1.p3.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.6.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p3.6.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.6.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p3.6.m3.1.1.2">ℒ</ci><ci id="S2.SS2.SSS1.p3.6.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p3.6.m3.1.1.3">RECON</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.6.m3.1c">\mathcal{L}_{\operatorname{RECON}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.6.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_RECON end_POSTSUBSCRIPT</annotation></semantics></math> is the reconstruction loss to guarantee that the reconstructed semantic embedding closely matches the original embedding,
while <math alttext="\mathcal{L}_{\operatorname{RQ}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.7.m4.1"><semantics id="S2.SS2.SSS1.p3.7.m4.1a"><msub id="S2.SS2.SSS1.p3.7.m4.1.1" xref="S2.SS2.SSS1.p3.7.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p3.7.m4.1.1.2" xref="S2.SS2.SSS1.p3.7.m4.1.1.2.cmml">ℒ</mi><mi id="S2.SS2.SSS1.p3.7.m4.1.1.3" xref="S2.SS2.SSS1.p3.7.m4.1.1.3.cmml">RQ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.7.m4.1b"><apply id="S2.SS2.SSS1.p3.7.m4.1.1.cmml" xref="S2.SS2.SSS1.p3.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.7.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p3.7.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.7.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p3.7.m4.1.1.2">ℒ</ci><ci id="S2.SS2.SSS1.p3.7.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p3.7.m4.1.1.3">RQ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.7.m4.1c">\mathcal{L}_{\operatorname{RQ}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.7.m4.1d">caligraphic_L start_POSTSUBSCRIPT roman_RQ end_POSTSUBSCRIPT</annotation></semantics></math> is the RQ loss that works to minimize the distance between codebook vectors and residual vectors.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2. </span>Generative Recommender</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.1">For the generative recommender, we utilize a Transformer-based encoder-decoder architecture similar to T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib19" title="">2020</a>)</cite> for sequential behavior modeling, as it has shown effectiveness in generative recommendation studies <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib4" title="">2022</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS2.p2">
<p class="ltx_p" id="S2.SS2.SSS2.p2.7"><span class="ltx_text ltx_font_bold" id="S2.SS2.SSS2.p2.7.1">Token-level Seq2Seq Formulation</span>. During training, the item-level user interaction sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.1.m1.1"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><mi id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><ci id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.1.m1.1d">italic_S</annotation></semantics></math> and the target item <math alttext="i_{t+1}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.2.m2.1"><semantics id="S2.SS2.SSS2.p2.2.m2.1a"><msub id="S2.SS2.SSS2.p2.2.m2.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.1.1.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml">i</mi><mrow id="S2.SS2.SSS2.p2.2.m2.1.1.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.1.1.3.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p2.2.m2.1.1.3.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.2.m2.1.1.3.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.2.m2.1b"><apply id="S2.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.2">𝑖</ci><apply id="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3"><plus id="S2.SS2.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.1"></plus><ci id="S2.SS2.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.2">𝑡</ci><cn id="S2.SS2.SSS2.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.2.m2.1c">i_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> are first tokenized into the token-level sequence <math alttext="X=[c^{1}_{1},c^{1}_{2},\dots,c^{t}_{1},c^{t}_{L}]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.3.m3.5"><semantics id="S2.SS2.SSS2.p2.3.m3.5a"><mrow id="S2.SS2.SSS2.p2.3.m3.5.5" xref="S2.SS2.SSS2.p2.3.m3.5.5.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.5.5.6" xref="S2.SS2.SSS2.p2.3.m3.5.5.6.cmml">X</mi><mo id="S2.SS2.SSS2.p2.3.m3.5.5.5" xref="S2.SS2.SSS2.p2.3.m3.5.5.5.cmml">=</mo><mrow id="S2.SS2.SSS2.p2.3.m3.5.5.4.4" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml"><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.5" stretchy="false" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">[</mo><msubsup id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.2" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.2.cmml">c</mi><mn id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.3" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.3.cmml">1</mn><mn id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.3" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.6" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.2" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.2.cmml">c</mi><mn id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.3" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.3.cmml">2</mn><mn id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.3" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.7" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">,</mo><mi id="S2.SS2.SSS2.p2.3.m3.1.1" mathvariant="normal" xref="S2.SS2.SSS2.p2.3.m3.1.1.cmml">…</mi><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.8" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.2" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.2.cmml">c</mi><mn id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.3" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.3.cmml">1</mn><mi id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.3" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.9" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.2" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.2.cmml">c</mi><mi id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.3" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.3.cmml">L</mi><mi id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.3" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.10" stretchy="false" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.3.m3.5b"><apply id="S2.SS2.SSS2.p2.3.m3.5.5.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5"><eq id="S2.SS2.SSS2.p2.3.m3.5.5.5.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.5"></eq><ci id="S2.SS2.SSS2.p2.3.m3.5.5.6.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.6">𝑋</ci><list id="S2.SS2.SSS2.p2.3.m3.5.5.4.5.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4"><apply id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.2">𝑐</ci><cn id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.2.3">1</cn></apply><cn id="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2">subscript</csymbol><apply id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.2">𝑐</ci><cn id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.2.3">1</cn></apply><cn id="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1">…</ci><apply id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3">subscript</csymbol><apply id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3">superscript</csymbol><ci id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.2">𝑐</ci><ci id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.3.cmml" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.2.3">𝑡</ci></apply><cn id="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.3.m3.4.4.3.3.3.3">1</cn></apply><apply id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4">subscript</csymbol><apply id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4">superscript</csymbol><ci id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.2">𝑐</ci><ci id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.3.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.2.3">𝑡</ci></apply><ci id="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.3.cmml" xref="S2.SS2.SSS2.p2.3.m3.5.5.4.4.4.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.3.m3.5c">X=[c^{1}_{1},c^{1}_{2},\dots,c^{t}_{1},c^{t}_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.3.m3.5d">italic_X = [ italic_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math> and <math alttext="Y=[c^{t+1}_{1},\dots,c^{t+1}_{L}]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.4.m4.3"><semantics id="S2.SS2.SSS2.p2.4.m4.3a"><mrow id="S2.SS2.SSS2.p2.4.m4.3.3" xref="S2.SS2.SSS2.p2.4.m4.3.3.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.3.3.4" xref="S2.SS2.SSS2.p2.4.m4.3.3.4.cmml">Y</mi><mo id="S2.SS2.SSS2.p2.4.m4.3.3.3" xref="S2.SS2.SSS2.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.SSS2.p2.4.m4.3.3.2.2" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml"><mo id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.3" stretchy="false" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml">[</mo><msubsup id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.2" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.2.cmml">c</mi><mn id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.3" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.3.cmml">1</mn><mrow id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.2" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.1" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.3" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.4" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p2.4.m4.1.1" mathvariant="normal" xref="S2.SS2.SSS2.p2.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.5" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.2" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.2.cmml">c</mi><mi id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.3" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.3.cmml">L</mi><mrow id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.2" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.1" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.3" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.6" stretchy="false" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.4.m4.3b"><apply id="S2.SS2.SSS2.p2.4.m4.3.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3"><eq id="S2.SS2.SSS2.p2.4.m4.3.3.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.3"></eq><ci id="S2.SS2.SSS2.p2.4.m4.3.3.4.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.4">𝑌</ci><list id="S2.SS2.SSS2.p2.4.m4.3.3.2.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2"><apply id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.2">𝑐</ci><apply id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3"><plus id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.1"></plus><ci id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.2.3.3">1</cn></apply></apply><cn id="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1">…</ci><apply id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2">subscript</csymbol><apply id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.2">𝑐</ci><apply id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3"><plus id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.1"></plus><ci id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.2">𝑡</ci><cn id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.3.3.2.2.2.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.4.m4.3c">Y=[c^{t+1}_{1},\dots,c^{t+1}_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.4.m4.3d">italic_Y = [ italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math> by <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.5.m5.1"><semantics id="S2.SS2.SSS2.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p2.5.m5.1.1" xref="S2.SS2.SSS2.p2.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.5.m5.1b"><ci id="S2.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.5.m5.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.5.m5.1d">caligraphic_T</annotation></semantics></math>.
Then the corresponding token embeddings <math alttext="\bm{E}^{X}\in\mathbb{R}^{|X|\times d_{h}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.6.m6.1"><semantics id="S2.SS2.SSS2.p2.6.m6.1a"><mrow id="S2.SS2.SSS2.p2.6.m6.1.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.cmml"><msup id="S2.SS2.SSS2.p2.6.m6.1.2.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.cmml"><mi id="S2.SS2.SSS2.p2.6.m6.1.2.2.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.2.cmml">𝑬</mi><mi id="S2.SS2.SSS2.p2.6.m6.1.2.2.3" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.3.cmml">X</mi></msup><mo id="S2.SS2.SSS2.p2.6.m6.1.2.1" xref="S2.SS2.SSS2.p2.6.m6.1.2.1.cmml">∈</mo><msup id="S2.SS2.SSS2.p2.6.m6.1.2.3" xref="S2.SS2.SSS2.p2.6.m6.1.2.3.cmml"><mi id="S2.SS2.SSS2.p2.6.m6.1.2.3.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.SSS2.p2.6.m6.1.1.1" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p2.6.m6.1.1.1.3.2" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.3.1.cmml"><mo id="S2.SS2.SSS2.p2.6.m6.1.1.1.3.2.1" stretchy="false" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.3.1.1.cmml">|</mo><mi id="S2.SS2.SSS2.p2.6.m6.1.1.1.1" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.1.cmml">X</mi><mo id="S2.SS2.SSS2.p2.6.m6.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS2.SSS2.p2.6.m6.1.1.1.2" rspace="0.222em" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.2.cmml">×</mo><msub id="S2.SS2.SSS2.p2.6.m6.1.1.1.4" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4.cmml"><mi id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.2" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4.2.cmml">d</mi><mi id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.3" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.6.m6.1b"><apply id="S2.SS2.SSS2.p2.6.m6.1.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2"><in id="S2.SS2.SSS2.p2.6.m6.1.2.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.1"></in><apply id="S2.SS2.SSS2.p2.6.m6.1.2.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m6.1.2.2.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.6.m6.1.2.2.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.2">𝑬</ci><ci id="S2.SS2.SSS2.p2.6.m6.1.2.2.3.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.3">𝑋</ci></apply><apply id="S2.SS2.SSS2.p2.6.m6.1.2.3.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m6.1.2.3.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.3">superscript</csymbol><ci id="S2.SS2.SSS2.p2.6.m6.1.2.3.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.3.2">ℝ</ci><apply id="S2.SS2.SSS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1"><times id="S2.SS2.SSS2.p2.6.m6.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.2"></times><apply id="S2.SS2.SSS2.p2.6.m6.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.3.2"><abs id="S2.SS2.SSS2.p2.6.m6.1.1.1.3.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.3.2.1"></abs><ci id="S2.SS2.SSS2.p2.6.m6.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.1">𝑋</ci></apply><apply id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4">subscript</csymbol><ci id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.2.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4.2">𝑑</ci><ci id="S2.SS2.SSS2.p2.6.m6.1.1.1.4.3.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1.1.4.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.6.m6.1c">\bm{E}^{X}\in\mathbb{R}^{|X|\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.6.m6.1d">bold_italic_E start_POSTSUPERSCRIPT italic_X end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | italic_X | × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are fed into the generative recommender for user preference modeling, where <math alttext="d_{h}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.7.m7.1"><semantics id="S2.SS2.SSS2.p2.7.m7.1a"><msub id="S2.SS2.SSS2.p2.7.m7.1.1" xref="S2.SS2.SSS2.p2.7.m7.1.1.cmml"><mi id="S2.SS2.SSS2.p2.7.m7.1.1.2" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.cmml">d</mi><mi id="S2.SS2.SSS2.p2.7.m7.1.1.3" xref="S2.SS2.SSS2.p2.7.m7.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.7.m7.1b"><apply id="S2.SS2.SSS2.p2.7.m7.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1.2">𝑑</ci><ci id="S2.SS2.SSS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.7.m7.1c">d_{h}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the hidden size of the recommender.
Formally, we begin with token sequence encoding:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx3">
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{H}^{E}=\operatorname{Encoder}_{R}(\bm{E}^{X})," class="ltx_Math" display="inline" id="S2.E11.m1.1"><semantics id="S2.E11.m1.1a"><mrow id="S2.E11.m1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml"><mrow id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml"><msup id="S2.E11.m1.1.1.1.1.4" xref="S2.E11.m1.1.1.1.1.4.cmml"><mi id="S2.E11.m1.1.1.1.1.4.2" xref="S2.E11.m1.1.1.1.1.4.2.cmml">𝑯</mi><mi id="S2.E11.m1.1.1.1.1.4.3" xref="S2.E11.m1.1.1.1.1.4.3.cmml">E</mi></msup><mo id="S2.E11.m1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E11.m1.1.1.1.1.2.2" xref="S2.E11.m1.1.1.1.1.2.3.cmml"><msub id="S2.E11.m1.1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.1.1.1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.1.1.1.2.cmml">Encoder</mi><mi id="S2.E11.m1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.1.1.3.cmml">R</mi></msub><mo id="S2.E11.m1.1.1.1.1.2.2a" xref="S2.E11.m1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.E11.m1.1.1.1.1.2.2.2" xref="S2.E11.m1.1.1.1.1.2.3.cmml"><mo id="S2.E11.m1.1.1.1.1.2.2.2.2" stretchy="false" xref="S2.E11.m1.1.1.1.1.2.3.cmml">(</mo><msup id="S2.E11.m1.1.1.1.1.2.2.2.1" xref="S2.E11.m1.1.1.1.1.2.2.2.1.cmml"><mi id="S2.E11.m1.1.1.1.1.2.2.2.1.2" xref="S2.E11.m1.1.1.1.1.2.2.2.1.2.cmml">𝑬</mi><mi id="S2.E11.m1.1.1.1.1.2.2.2.1.3" xref="S2.E11.m1.1.1.1.1.2.2.2.1.3.cmml">X</mi></msup><mo id="S2.E11.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E11.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E11.m1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1"><eq id="S2.E11.m1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.3"></eq><apply id="S2.E11.m1.1.1.1.1.4.cmml" xref="S2.E11.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.4.1.cmml" xref="S2.E11.m1.1.1.1.1.4">superscript</csymbol><ci id="S2.E11.m1.1.1.1.1.4.2.cmml" xref="S2.E11.m1.1.1.1.1.4.2">𝑯</ci><ci id="S2.E11.m1.1.1.1.1.4.3.cmml" xref="S2.E11.m1.1.1.1.1.4.3">𝐸</ci></apply><apply id="S2.E11.m1.1.1.1.1.2.3.cmml" xref="S2.E11.m1.1.1.1.1.2.2"><apply id="S2.E11.m1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.2">Encoder</ci><ci id="S2.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.3">𝑅</ci></apply><apply id="S2.E11.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.1">superscript</csymbol><ci id="S2.E11.m1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.1.2">𝑬</ci><ci id="S2.E11.m1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.1.3">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle\bm{H}^{E}=\operatorname{Encoder}_{R}(\bm{E}^{X}),</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT = roman_Encoder start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( bold_italic_E start_POSTSUPERSCRIPT italic_X end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p2.13">where <math alttext="\bm{H}^{E}\in\mathbb{R}^{|X|\times d_{h}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.8.m1.1"><semantics id="S2.SS2.SSS2.p2.8.m1.1a"><mrow id="S2.SS2.SSS2.p2.8.m1.1.2" xref="S2.SS2.SSS2.p2.8.m1.1.2.cmml"><msup id="S2.SS2.SSS2.p2.8.m1.1.2.2" xref="S2.SS2.SSS2.p2.8.m1.1.2.2.cmml"><mi id="S2.SS2.SSS2.p2.8.m1.1.2.2.2" xref="S2.SS2.SSS2.p2.8.m1.1.2.2.2.cmml">𝑯</mi><mi id="S2.SS2.SSS2.p2.8.m1.1.2.2.3" xref="S2.SS2.SSS2.p2.8.m1.1.2.2.3.cmml">E</mi></msup><mo id="S2.SS2.SSS2.p2.8.m1.1.2.1" xref="S2.SS2.SSS2.p2.8.m1.1.2.1.cmml">∈</mo><msup id="S2.SS2.SSS2.p2.8.m1.1.2.3" xref="S2.SS2.SSS2.p2.8.m1.1.2.3.cmml"><mi id="S2.SS2.SSS2.p2.8.m1.1.2.3.2" xref="S2.SS2.SSS2.p2.8.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.SSS2.p2.8.m1.1.1.1" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p2.8.m1.1.1.1.3.2" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.3.1.cmml"><mo id="S2.SS2.SSS2.p2.8.m1.1.1.1.3.2.1" stretchy="false" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.3.1.1.cmml">|</mo><mi id="S2.SS2.SSS2.p2.8.m1.1.1.1.1" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.1.cmml">X</mi><mo id="S2.SS2.SSS2.p2.8.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS2.SSS2.p2.8.m1.1.1.1.2" rspace="0.222em" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.2.cmml">×</mo><msub id="S2.SS2.SSS2.p2.8.m1.1.1.1.4" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4.cmml"><mi id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.2" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4.2.cmml">d</mi><mi id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.3" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.8.m1.1b"><apply id="S2.SS2.SSS2.p2.8.m1.1.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2"><in id="S2.SS2.SSS2.p2.8.m1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.1"></in><apply id="S2.SS2.SSS2.p2.8.m1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.8.m1.1.2.2.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.8.m1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.2.2">𝑯</ci><ci id="S2.SS2.SSS2.p2.8.m1.1.2.2.3.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.2.3">𝐸</ci></apply><apply id="S2.SS2.SSS2.p2.8.m1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.8.m1.1.2.3.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.3">superscript</csymbol><ci id="S2.SS2.SSS2.p2.8.m1.1.2.3.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.2.3.2">ℝ</ci><apply id="S2.SS2.SSS2.p2.8.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1"><times id="S2.SS2.SSS2.p2.8.m1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.2"></times><apply id="S2.SS2.SSS2.p2.8.m1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.3.2"><abs id="S2.SS2.SSS2.p2.8.m1.1.1.1.3.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.3.2.1"></abs><ci id="S2.SS2.SSS2.p2.8.m1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.1">𝑋</ci></apply><apply id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.1.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.2.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4.2">𝑑</ci><ci id="S2.SS2.SSS2.p2.8.m1.1.1.1.4.3.cmml" xref="S2.SS2.SSS2.p2.8.m1.1.1.1.4.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.8.m1.1c">\bm{H}^{E}\in\mathbb{R}^{|X|\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.8.m1.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | italic_X | × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the encoded sequence representation.
For decoding, we add a special start token “<math alttext="\operatorname{[BOS]}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.9.m2.1"><semantics id="S2.SS2.SSS2.p2.9.m2.1a"><mrow id="S2.SS2.SSS2.p2.9.m2.1.1.3" xref="S2.SS2.SSS2.p2.9.m2.1.1.2.cmml"><mo id="S2.SS2.SSS2.p2.9.m2.1.1.3.1" stretchy="false" xref="S2.SS2.SSS2.p2.9.m2.1.1.2.1.cmml">[</mo><mi id="S2.SS2.SSS2.p2.9.m2.1.1.1" xref="S2.SS2.SSS2.p2.9.m2.1.1.1.cmml">BOS</mi><mo id="S2.SS2.SSS2.p2.9.m2.1.1.3.2" stretchy="false" xref="S2.SS2.SSS2.p2.9.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.9.m2.1b"><apply id="S2.SS2.SSS2.p2.9.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.9.m2.1.1.3"><csymbol cd="latexml" id="S2.SS2.SSS2.p2.9.m2.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.9.m2.1.1.3.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p2.9.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.9.m2.1.1.1">BOS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.9.m2.1c">\operatorname{[BOS]}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.9.m2.1d">[ roman_BOS ]</annotation></semantics></math>” at the beginning of <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.10.m3.1"><semantics id="S2.SS2.SSS2.p2.10.m3.1a"><mi id="S2.SS2.SSS2.p2.10.m3.1.1" xref="S2.SS2.SSS2.p2.10.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.10.m3.1b"><ci id="S2.SS2.SSS2.p2.10.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.10.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.10.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.10.m3.1d">italic_Y</annotation></semantics></math> to construct the decoder input <math alttext="\tilde{Y}=[\operatorname{[BOS]},c^{t+1}_{1},\dots,c^{t+1}_{L}]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.11.m4.4"><semantics id="S2.SS2.SSS2.p2.11.m4.4a"><mrow id="S2.SS2.SSS2.p2.11.m4.4.4" xref="S2.SS2.SSS2.p2.11.m4.4.4.cmml"><mover accent="true" id="S2.SS2.SSS2.p2.11.m4.4.4.4" xref="S2.SS2.SSS2.p2.11.m4.4.4.4.cmml"><mi id="S2.SS2.SSS2.p2.11.m4.4.4.4.2" xref="S2.SS2.SSS2.p2.11.m4.4.4.4.2.cmml">Y</mi><mo id="S2.SS2.SSS2.p2.11.m4.4.4.4.1" xref="S2.SS2.SSS2.p2.11.m4.4.4.4.1.cmml">~</mo></mover><mo id="S2.SS2.SSS2.p2.11.m4.4.4.3" xref="S2.SS2.SSS2.p2.11.m4.4.4.3.cmml">=</mo><mrow id="S2.SS2.SSS2.p2.11.m4.4.4.2.2" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml"><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.3" stretchy="false" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml">[</mo><mrow id="S2.SS2.SSS2.p2.11.m4.1.1.3" xref="S2.SS2.SSS2.p2.11.m4.1.1.2.cmml"><mo id="S2.SS2.SSS2.p2.11.m4.1.1.3.1" stretchy="false" xref="S2.SS2.SSS2.p2.11.m4.1.1.2.1.cmml">[</mo><mi id="S2.SS2.SSS2.p2.11.m4.1.1.1" xref="S2.SS2.SSS2.p2.11.m4.1.1.1.cmml">BOS</mi><mo id="S2.SS2.SSS2.p2.11.m4.1.1.3.2" stretchy="false" xref="S2.SS2.SSS2.p2.11.m4.1.1.2.1.cmml">]</mo></mrow><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.4" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.2" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.2.cmml">c</mi><mn id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.3" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.3.cmml">1</mn><mrow id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.cmml"><mi id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.2" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.1" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.3" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.5" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p2.11.m4.2.2" mathvariant="normal" xref="S2.SS2.SSS2.p2.11.m4.2.2.cmml">…</mi><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.6" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.cmml"><mi id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.2" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.2.cmml">c</mi><mi id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.3" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.3.cmml">L</mi><mrow id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.2" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.1" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.3" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.7" stretchy="false" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.11.m4.4b"><apply id="S2.SS2.SSS2.p2.11.m4.4.4.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4"><eq id="S2.SS2.SSS2.p2.11.m4.4.4.3.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.3"></eq><apply id="S2.SS2.SSS2.p2.11.m4.4.4.4.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.4"><ci id="S2.SS2.SSS2.p2.11.m4.4.4.4.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.4.1">~</ci><ci id="S2.SS2.SSS2.p2.11.m4.4.4.4.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.4.2">𝑌</ci></apply><list id="S2.SS2.SSS2.p2.11.m4.4.4.2.3.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2"><apply id="S2.SS2.SSS2.p2.11.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.1.1.3"><csymbol cd="latexml" id="S2.SS2.SSS2.p2.11.m4.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.1.1.3.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p2.11.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.1.1.1">BOS</ci></apply><apply id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.2">𝑐</ci><apply id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3"><plus id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.1"></plus><ci id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.2.3.3">1</cn></apply></apply><cn id="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.11.m4.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS2.SSS2.p2.11.m4.2.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.2.2">…</ci><apply id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2">subscript</csymbol><apply id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.2">𝑐</ci><apply id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3"><plus id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.1.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.1"></plus><ci id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.2.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.2">𝑡</ci><cn id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.3.cmml" xref="S2.SS2.SSS2.p2.11.m4.4.4.2.2.2.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.11.m4.4c">\tilde{Y}=[\operatorname{[BOS]},c^{t+1}_{1},\dots,c^{t+1}_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.11.m4.4d">over~ start_ARG italic_Y end_ARG = [ start_OPFUNCTION [ roman_BOS ] end_OPFUNCTION , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math>.
Then, <math alttext="\bm{H}^{E}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.12.m5.1"><semantics id="S2.SS2.SSS2.p2.12.m5.1a"><msup id="S2.SS2.SSS2.p2.12.m5.1.1" xref="S2.SS2.SSS2.p2.12.m5.1.1.cmml"><mi id="S2.SS2.SSS2.p2.12.m5.1.1.2" xref="S2.SS2.SSS2.p2.12.m5.1.1.2.cmml">𝑯</mi><mi id="S2.SS2.SSS2.p2.12.m5.1.1.3" xref="S2.SS2.SSS2.p2.12.m5.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.12.m5.1b"><apply id="S2.SS2.SSS2.p2.12.m5.1.1.cmml" xref="S2.SS2.SSS2.p2.12.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.12.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p2.12.m5.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.12.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p2.12.m5.1.1.2">𝑯</ci><ci id="S2.SS2.SSS2.p2.12.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p2.12.m5.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.12.m5.1c">\bm{H}^{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.12.m5.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT</annotation></semantics></math> along with <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.13.m6.1"><semantics id="S2.SS2.SSS2.p2.13.m6.1a"><mover accent="true" id="S2.SS2.SSS2.p2.13.m6.1.1" xref="S2.SS2.SSS2.p2.13.m6.1.1.cmml"><mi id="S2.SS2.SSS2.p2.13.m6.1.1.2" xref="S2.SS2.SSS2.p2.13.m6.1.1.2.cmml">Y</mi><mo id="S2.SS2.SSS2.p2.13.m6.1.1.1" xref="S2.SS2.SSS2.p2.13.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.13.m6.1b"><apply id="S2.SS2.SSS2.p2.13.m6.1.1.cmml" xref="S2.SS2.SSS2.p2.13.m6.1.1"><ci id="S2.SS2.SSS2.p2.13.m6.1.1.1.cmml" xref="S2.SS2.SSS2.p2.13.m6.1.1.1">~</ci><ci id="S2.SS2.SSS2.p2.13.m6.1.1.2.cmml" xref="S2.SS2.SSS2.p2.13.m6.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.13.m6.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.13.m6.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math> are fed into the decoder to extract user preference representation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx4">
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{H}^{D}=\operatorname{Decoder}_{R}(\bm{H}^{E},\tilde{Y})," class="ltx_Math" display="inline" id="S2.E12.m1.2"><semantics id="S2.E12.m1.2a"><mrow id="S2.E12.m1.2.2.1" xref="S2.E12.m1.2.2.1.1.cmml"><mrow id="S2.E12.m1.2.2.1.1" xref="S2.E12.m1.2.2.1.1.cmml"><msup id="S2.E12.m1.2.2.1.1.4" xref="S2.E12.m1.2.2.1.1.4.cmml"><mi id="S2.E12.m1.2.2.1.1.4.2" xref="S2.E12.m1.2.2.1.1.4.2.cmml">𝑯</mi><mi id="S2.E12.m1.2.2.1.1.4.3" xref="S2.E12.m1.2.2.1.1.4.3.cmml">D</mi></msup><mo id="S2.E12.m1.2.2.1.1.3" xref="S2.E12.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E12.m1.2.2.1.1.2.2" xref="S2.E12.m1.2.2.1.1.2.3.cmml"><msub id="S2.E12.m1.2.2.1.1.1.1.1" xref="S2.E12.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E12.m1.2.2.1.1.1.1.1.2" xref="S2.E12.m1.2.2.1.1.1.1.1.2.cmml">Decoder</mi><mi id="S2.E12.m1.2.2.1.1.1.1.1.3" xref="S2.E12.m1.2.2.1.1.1.1.1.3.cmml">R</mi></msub><mo id="S2.E12.m1.2.2.1.1.2.2a" xref="S2.E12.m1.2.2.1.1.2.3.cmml">⁡</mo><mrow id="S2.E12.m1.2.2.1.1.2.2.2" xref="S2.E12.m1.2.2.1.1.2.3.cmml"><mo id="S2.E12.m1.2.2.1.1.2.2.2.2" stretchy="false" xref="S2.E12.m1.2.2.1.1.2.3.cmml">(</mo><msup id="S2.E12.m1.2.2.1.1.2.2.2.1" xref="S2.E12.m1.2.2.1.1.2.2.2.1.cmml"><mi id="S2.E12.m1.2.2.1.1.2.2.2.1.2" xref="S2.E12.m1.2.2.1.1.2.2.2.1.2.cmml">𝑯</mi><mi id="S2.E12.m1.2.2.1.1.2.2.2.1.3" xref="S2.E12.m1.2.2.1.1.2.2.2.1.3.cmml">E</mi></msup><mo id="S2.E12.m1.2.2.1.1.2.2.2.3" xref="S2.E12.m1.2.2.1.1.2.3.cmml">,</mo><mover accent="true" id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml"><mi id="S2.E12.m1.1.1.2" xref="S2.E12.m1.1.1.2.cmml">Y</mi><mo id="S2.E12.m1.1.1.1" xref="S2.E12.m1.1.1.1.cmml">~</mo></mover><mo id="S2.E12.m1.2.2.1.1.2.2.2.4" stretchy="false" xref="S2.E12.m1.2.2.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E12.m1.2.2.1.2" xref="S2.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.2b"><apply id="S2.E12.m1.2.2.1.1.cmml" xref="S2.E12.m1.2.2.1"><eq id="S2.E12.m1.2.2.1.1.3.cmml" xref="S2.E12.m1.2.2.1.1.3"></eq><apply id="S2.E12.m1.2.2.1.1.4.cmml" xref="S2.E12.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E12.m1.2.2.1.1.4.1.cmml" xref="S2.E12.m1.2.2.1.1.4">superscript</csymbol><ci id="S2.E12.m1.2.2.1.1.4.2.cmml" xref="S2.E12.m1.2.2.1.1.4.2">𝑯</ci><ci id="S2.E12.m1.2.2.1.1.4.3.cmml" xref="S2.E12.m1.2.2.1.1.4.3">𝐷</ci></apply><apply id="S2.E12.m1.2.2.1.1.2.3.cmml" xref="S2.E12.m1.2.2.1.1.2.2"><apply id="S2.E12.m1.2.2.1.1.1.1.1.cmml" xref="S2.E12.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E12.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E12.m1.2.2.1.1.1.1.1.2">Decoder</ci><ci id="S2.E12.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E12.m1.2.2.1.1.1.1.1.3">𝑅</ci></apply><apply id="S2.E12.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E12.m1.2.2.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E12.m1.2.2.1.1.2.2.2.1.1.cmml" xref="S2.E12.m1.2.2.1.1.2.2.2.1">superscript</csymbol><ci id="S2.E12.m1.2.2.1.1.2.2.2.1.2.cmml" xref="S2.E12.m1.2.2.1.1.2.2.2.1.2">𝑯</ci><ci id="S2.E12.m1.2.2.1.1.2.2.2.1.3.cmml" xref="S2.E12.m1.2.2.1.1.2.2.2.1.3">𝐸</ci></apply><apply id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1"><ci id="S2.E12.m1.1.1.1.cmml" xref="S2.E12.m1.1.1.1">~</ci><ci id="S2.E12.m1.1.1.2.cmml" xref="S2.E12.m1.1.1.2">𝑌</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.2c">\displaystyle\bm{H}^{D}=\operatorname{Decoder}_{R}(\bm{H}^{E},\tilde{Y}),</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.2d">bold_italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT = roman_Decoder start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT , over~ start_ARG italic_Y end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p2.14">where <math alttext="\bm{H}^{D}\in\mathbb{R}^{(L+1)\times d_{h}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.14.m1.1"><semantics id="S2.SS2.SSS2.p2.14.m1.1a"><mrow id="S2.SS2.SSS2.p2.14.m1.1.2" xref="S2.SS2.SSS2.p2.14.m1.1.2.cmml"><msup id="S2.SS2.SSS2.p2.14.m1.1.2.2" xref="S2.SS2.SSS2.p2.14.m1.1.2.2.cmml"><mi id="S2.SS2.SSS2.p2.14.m1.1.2.2.2" xref="S2.SS2.SSS2.p2.14.m1.1.2.2.2.cmml">𝑯</mi><mi id="S2.SS2.SSS2.p2.14.m1.1.2.2.3" xref="S2.SS2.SSS2.p2.14.m1.1.2.2.3.cmml">D</mi></msup><mo id="S2.SS2.SSS2.p2.14.m1.1.2.1" xref="S2.SS2.SSS2.p2.14.m1.1.2.1.cmml">∈</mo><msup id="S2.SS2.SSS2.p2.14.m1.1.2.3" xref="S2.SS2.SSS2.p2.14.m1.1.2.3.cmml"><mi id="S2.SS2.SSS2.p2.14.m1.1.2.3.2" xref="S2.SS2.SSS2.p2.14.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.SSS2.p2.14.m1.1.1.1" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.SSS2.p2.14.m1.1.1.1.2" rspace="0.222em" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.2.cmml">×</mo><msub id="S2.SS2.SSS2.p2.14.m1.1.1.1.3" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.2" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3.2.cmml">d</mi><mi id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.3" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.14.m1.1b"><apply id="S2.SS2.SSS2.p2.14.m1.1.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2"><in id="S2.SS2.SSS2.p2.14.m1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.1"></in><apply id="S2.SS2.SSS2.p2.14.m1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.14.m1.1.2.2.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p2.14.m1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.2.2">𝑯</ci><ci id="S2.SS2.SSS2.p2.14.m1.1.2.2.3.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.2.3">𝐷</ci></apply><apply id="S2.SS2.SSS2.p2.14.m1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.14.m1.1.2.3.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.3">superscript</csymbol><ci id="S2.SS2.SSS2.p2.14.m1.1.2.3.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.2.3.2">ℝ</ci><apply id="S2.SS2.SSS2.p2.14.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1"><times id="S2.SS2.SSS2.p2.14.m1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.2"></times><apply id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1"><plus id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.1"></plus><ci id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.2">𝐿</ci><cn id="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3.2">𝑑</ci><ci id="S2.SS2.SSS2.p2.14.m1.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p2.14.m1.1.1.1.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.14.m1.1c">\bm{H}^{D}\in\mathbb{R}^{(L+1)\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.14.m1.1d">bold_italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_L + 1 ) × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is decoder hidden states that imply user preferences over the items.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS2.p3">
<p class="ltx_p" id="S2.SS2.SSS2.p3.2"><span class="ltx_text ltx_font_bold" id="S2.SS2.SSS2.p3.2.1">Recommendation Loss</span>. By performing inner product with the vocabulary embedding matrix <math alttext="\bm{E}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.1.m1.1"><semantics id="S2.SS2.SSS2.p3.1.m1.1a"><mi id="S2.SS2.SSS2.p3.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.cmml">𝑬</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.m1.1b"><ci id="S2.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1">𝑬</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.m1.1c">\bm{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.1.m1.1d">bold_italic_E</annotation></semantics></math>, <math alttext="\bm{H}^{D}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.2.m2.1"><semantics id="S2.SS2.SSS2.p3.2.m2.1a"><msup id="S2.SS2.SSS2.p3.2.m2.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p3.2.m2.1.1.2" xref="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml">𝑯</mi><mi id="S2.SS2.SSS2.p3.2.m2.1.1.3" xref="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.2.m2.1b"><apply id="S2.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.2">𝑯</ci><ci id="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.2.m2.1c">\bm{H}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.2.m2.1d">bold_italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is further employed to predict the target item token at each step.
Specifically, we optimize the negative log-likelihood of target tokens based on the sequence-to-sequence paradigm:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx5">
<tbody id="S2.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{REC}}=-\sum_{j=1}^{L}\log P(Y_{j}|X,Y_%
{&lt;j})," class="ltx_Math" display="inline" id="S2.E13.m1.2"><semantics id="S2.E13.m1.2a"><mrow id="S2.E13.m1.2.2.1" xref="S2.E13.m1.2.2.1.1.cmml"><mrow id="S2.E13.m1.2.2.1.1" xref="S2.E13.m1.2.2.1.1.cmml"><msub id="S2.E13.m1.2.2.1.1.3" xref="S2.E13.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.2.2.1.1.3.2" xref="S2.E13.m1.2.2.1.1.3.2.cmml">ℒ</mi><mi id="S2.E13.m1.2.2.1.1.3.3" xref="S2.E13.m1.2.2.1.1.3.3.cmml">REC</mi></msub><mo id="S2.E13.m1.2.2.1.1.2" xref="S2.E13.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E13.m1.2.2.1.1.1" xref="S2.E13.m1.2.2.1.1.1.cmml"><mo id="S2.E13.m1.2.2.1.1.1a" xref="S2.E13.m1.2.2.1.1.1.cmml">−</mo><mrow id="S2.E13.m1.2.2.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E13.m1.2.2.1.1.1.1.2" xref="S2.E13.m1.2.2.1.1.1.1.2.cmml"><munderover id="S2.E13.m1.2.2.1.1.1.1.2a" xref="S2.E13.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E13.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E13.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E13.m1.2.2.1.1.1.1.2.2.3" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S2.E13.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S2.E13.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E13.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E13.m1.2.2.1.1.1.1.2.3" xref="S2.E13.m1.2.2.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><mrow id="S2.E13.m1.2.2.1.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.1.cmml"><mrow id="S2.E13.m1.2.2.1.1.1.1.1.3" xref="S2.E13.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.2.2.1.1.1.1.1.3.1" xref="S2.E13.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E13.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E13.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E13.m1.2.2.1.1.1.1.1.3.2" xref="S2.E13.m1.2.2.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S2.E13.m1.2.2.1.1.1.1.1.2" xref="S2.E13.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.2.2.1.1.1.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E13.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">Y</mi><mi id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo fence="false" id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E13.m1.1.1" xref="S2.E13.m1.1.1.cmml">X</mi><mo id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">Y</mi><mrow id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.E13.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E13.m1.2.2.1.2" xref="S2.E13.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.2b"><apply id="S2.E13.m1.2.2.1.1.cmml" xref="S2.E13.m1.2.2.1"><eq id="S2.E13.m1.2.2.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.2"></eq><apply id="S2.E13.m1.2.2.1.1.3.cmml" xref="S2.E13.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.1.1.3.1.cmml" xref="S2.E13.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E13.m1.2.2.1.1.3.2.cmml" xref="S2.E13.m1.2.2.1.1.3.2">ℒ</ci><ci id="S2.E13.m1.2.2.1.1.3.3.cmml" xref="S2.E13.m1.2.2.1.1.3.3">REC</ci></apply><apply id="S2.E13.m1.2.2.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1"><minus id="S2.E13.m1.2.2.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1"></minus><apply id="S2.E13.m1.2.2.1.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1"><apply id="S2.E13.m1.2.2.1.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E13.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E13.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E13.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E13.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E13.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S2.E13.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E13.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E13.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.2.3">𝐿</ci></apply><apply id="S2.E13.m1.2.2.1.1.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1"><times id="S2.E13.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.E13.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.3"><log id="S2.E13.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.3.1"></log><ci id="S2.E13.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑌</ci><ci id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply><list id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E13.m1.1.1.cmml" xref="S2.E13.m1.1.1">𝑋</ci><apply id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑌</ci><apply id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.2c">\displaystyle\mathcal{L}_{\operatorname{REC}}=-\sum_{j=1}^{L}\log P(Y_{j}|X,Y_%
{&lt;j}),</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.2d">caligraphic_L start_POSTSUBSCRIPT roman_REC end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT roman_log italic_P ( italic_Y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_X , italic_Y start_POSTSUBSCRIPT &lt; italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p3.6">where <math alttext="Y_{j}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.3.m1.1"><semantics id="S2.SS2.SSS2.p3.3.m1.1a"><msub id="S2.SS2.SSS2.p3.3.m1.1.1" xref="S2.SS2.SSS2.p3.3.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p3.3.m1.1.1.2" xref="S2.SS2.SSS2.p3.3.m1.1.1.2.cmml">Y</mi><mi id="S2.SS2.SSS2.p3.3.m1.1.1.3" xref="S2.SS2.SSS2.p3.3.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.3.m1.1b"><apply id="S2.SS2.SSS2.p3.3.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.3.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.3.m1.1.1.2">𝑌</ci><ci id="S2.SS2.SSS2.p3.3.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.3.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.3.m1.1c">Y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.3.m1.1d">italic_Y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.4.m2.1"><semantics id="S2.SS2.SSS2.p3.4.m2.1a"><mi id="S2.SS2.SSS2.p3.4.m2.1.1" xref="S2.SS2.SSS2.p3.4.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.4.m2.1b"><ci id="S2.SS2.SSS2.p3.4.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.4.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.4.m2.1d">italic_j</annotation></semantics></math>-th token of target tokens, and <math alttext="Y_{&lt;j}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.5.m3.1"><semantics id="S2.SS2.SSS2.p3.5.m3.1a"><msub id="S2.SS2.SSS2.p3.5.m3.1.1" xref="S2.SS2.SSS2.p3.5.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p3.5.m3.1.1.2" xref="S2.SS2.SSS2.p3.5.m3.1.1.2.cmml">Y</mi><mrow id="S2.SS2.SSS2.p3.5.m3.1.1.3" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.cmml"><mi id="S2.SS2.SSS2.p3.5.m3.1.1.3.2" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.2.cmml"></mi><mo id="S2.SS2.SSS2.p3.5.m3.1.1.3.1" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS2.SSS2.p3.5.m3.1.1.3.3" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.5.m3.1b"><apply id="S2.SS2.SSS2.p3.5.m3.1.1.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.5.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.5.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.2">𝑌</ci><apply id="S2.SS2.SSS2.p3.5.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.3"><lt id="S2.SS2.SSS2.p3.5.m3.1.1.3.1.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS2.SSS2.p3.5.m3.1.1.3.2.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.2">absent</csymbol><ci id="S2.SS2.SSS2.p3.5.m3.1.1.3.3.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.5.m3.1c">Y_{&lt;j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.5.m3.1d">italic_Y start_POSTSUBSCRIPT &lt; italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the tokens before <math alttext="Y_{j}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.6.m4.1"><semantics id="S2.SS2.SSS2.p3.6.m4.1a"><msub id="S2.SS2.SSS2.p3.6.m4.1.1" xref="S2.SS2.SSS2.p3.6.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p3.6.m4.1.1.2" xref="S2.SS2.SSS2.p3.6.m4.1.1.2.cmml">Y</mi><mi id="S2.SS2.SSS2.p3.6.m4.1.1.3" xref="S2.SS2.SSS2.p3.6.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.6.m4.1b"><apply id="S2.SS2.SSS2.p3.6.m4.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.6.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p3.6.m4.1.1.2">𝑌</ci><ci id="S2.SS2.SSS2.p3.6.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p3.6.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.6.m4.1c">Y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.6.m4.1d">italic_Y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
In this way, the tokens of a target item will be generated autoregressively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Recommendation-oriented Alignment</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In previous work <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>; Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>, the item tokenizer and the generative recommender are treated as two separate components: the tokenizer is often trained in the preprocessing stage to generate tokens for each item but is subsequently fixed during recommender training.
Such an approach neglects the effect of item tokenization on the generative recommendation, which cannot adaptively learn more suitable tokenizers for the corresponding recommender.
To address this limitation, an ideal approach is to jointly learn both the item tokenizer and the generative recommender for mutual enhancement between the two components.
For this purpose, we devise two new training strategies for aligning the two components, namely <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">sequence-item alignment</em> and <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.2">preference-semantic alignment</em>.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1. </span>Sequence-Item Alignment</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">We first introduce the training strategy for sequence-item alignment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p2">
<p class="ltx_p" id="S2.SS3.SSS1.p2.4"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS1.p2.4.1">Alignment Hypothesis</span>.
To align the two components, we consider the item tokenizer as an optimizable component when training the recommender.
We employ it to obtain the corresponding token distributions for the target item based on different inputs (See Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E6" title="In 2.2.1. Item Tokenizer ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>)), and generate supervision signals based on the idea that two associated inputs should produce similar token distributions via the tokenizer.
In this way, we can utilize the derived supervision signals to optimize the involved two components.
In our approach, we adopt an encoder-decoder architecture, and assume that the hidden states <math alttext="\bm{H}^{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.1.m1.1"><semantics id="S2.SS3.SSS1.p2.1.m1.1a"><msup id="S2.SS3.SSS1.p2.1.m1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.1.1.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.2.cmml">𝑯</mi><mi id="S2.SS3.SSS1.p2.1.m1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.1.m1.1b"><apply id="S2.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.2">𝑯</ci><ci id="S2.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.1.m1.1c">\bm{H}^{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.1.m1.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT</annotation></semantics></math> (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E11" title="In 2.2.2. Generative Recommender ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a>)) from the encoder should be highly related to the collaborative embedding <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.2.m2.1"><semantics id="S2.SS3.SSS1.p2.2.m2.1a"><mi id="S2.SS3.SSS1.p2.2.m2.1.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.2.m2.1b"><ci id="S2.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.2.m2.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.2.m2.1d">bold_italic_z</annotation></semantics></math>.
The former <math alttext="\bm{H}^{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.3.m3.1"><semantics id="S2.SS3.SSS1.p2.3.m3.1a"><msup id="S2.SS3.SSS1.p2.3.m3.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS3.SSS1.p2.3.m3.1.1.2" xref="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml">𝑯</mi><mi id="S2.SS3.SSS1.p2.3.m3.1.1.3" xref="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.3.m3.1b"><apply id="S2.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.2">𝑯</ci><ci id="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.3.m3.1c">\bm{H}^{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.3.m3.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT</annotation></semantics></math> encodes the entire information of the past interaction sequence, while the latter <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.4.m4.1"><semantics id="S2.SS3.SSS1.p2.4.m4.1a"><mi id="S2.SS3.SSS1.p2.4.m4.1.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.4.m4.1b"><ci id="S2.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.4.m4.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.4.m4.1d">bold_italic_z</annotation></semantics></math> captures the characteristics of the target item.
When we feed both kinds of representations into the tokenizer, they should yield similar tokenization results. Thus, we refer to such an association relation as <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS1.p2.4.2">sequence-item alignment</em>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p3">
<p class="ltx_p" id="S2.SS3.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS1.p3.1.1">Alignment Loss</span>.
Based on the above alignment hypothesis, we next formulate the corresponding loss for joint optimization. Specially, we first linearize the hidden state <math alttext="\bm{H}^{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.1.m1.1"><semantics id="S2.SS3.SSS1.p3.1.m1.1a"><msup id="S2.SS3.SSS1.p3.1.m1.1.1" xref="S2.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S2.SS3.SSS1.p3.1.m1.1.1.2" xref="S2.SS3.SSS1.p3.1.m1.1.1.2.cmml">𝑯</mi><mi id="S2.SS3.SSS1.p3.1.m1.1.1.3" xref="S2.SS3.SSS1.p3.1.m1.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.1.m1.1b"><apply id="S2.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p3.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p3.1.m1.1.1.2">𝑯</ci><ci id="S2.SS3.SSS1.p3.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p3.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.1.m1.1c">\bm{H}^{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.1.m1.1d">bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT</annotation></semantics></math> by applying a mean pooling operation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx6">
<tbody id="S2.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\bm{z}^{E}=\text{MLP}(\operatorname{mean\_pool}(\bm{H}^{E}))," class="ltx_Math" display="inline" id="S2.E14.m1.2"><semantics id="S2.E14.m1.2a"><mrow id="S2.E14.m1.2.2.1" xref="S2.E14.m1.2.2.1.1.cmml"><mrow id="S2.E14.m1.2.2.1.1" xref="S2.E14.m1.2.2.1.1.cmml"><msup id="S2.E14.m1.2.2.1.1.3" xref="S2.E14.m1.2.2.1.1.3.cmml"><mi id="S2.E14.m1.2.2.1.1.3.2" xref="S2.E14.m1.2.2.1.1.3.2.cmml">𝒛</mi><mi id="S2.E14.m1.2.2.1.1.3.3" xref="S2.E14.m1.2.2.1.1.3.3.cmml">E</mi></msup><mo id="S2.E14.m1.2.2.1.1.2" xref="S2.E14.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E14.m1.2.2.1.1.1" xref="S2.E14.m1.2.2.1.1.1.cmml"><mtext id="S2.E14.m1.2.2.1.1.1.3" xref="S2.E14.m1.2.2.1.1.1.3a.cmml">MLP</mtext><mo id="S2.E14.m1.2.2.1.1.1.2" xref="S2.E14.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E14.m1.2.2.1.1.1.1.1" xref="S2.E14.m1.2.2.1.1.1.cmml"><mo id="S2.E14.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E14.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E14.m1.2.2.1.1.1.1.1.1.1" xref="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="S2.E14.m1.1.1" xref="S2.E14.m1.1.1.cmml"><mi id="S2.E14.m1.1.1.2" xref="S2.E14.m1.1.1.2.cmml">mean</mi><mo id="S2.E14.m1.1.1.1" xref="S2.E14.m1.1.1.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.3" mathvariant="normal" xref="S2.E14.m1.1.1.3.cmml">_</mi><mo id="S2.E14.m1.1.1.1a" xref="S2.E14.m1.1.1.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.4" xref="S2.E14.m1.1.1.4.cmml">pool</mi></mrow><mo id="S2.E14.m1.2.2.1.1.1.1.1.1.1a" xref="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><msup id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝑯</mi><mi id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">E</mi></msup><mo id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E14.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E14.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E14.m1.2.2.1.2" xref="S2.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m1.2b"><apply id="S2.E14.m1.2.2.1.1.cmml" xref="S2.E14.m1.2.2.1"><eq id="S2.E14.m1.2.2.1.1.2.cmml" xref="S2.E14.m1.2.2.1.1.2"></eq><apply id="S2.E14.m1.2.2.1.1.3.cmml" xref="S2.E14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.1.1.3.1.cmml" xref="S2.E14.m1.2.2.1.1.3">superscript</csymbol><ci id="S2.E14.m1.2.2.1.1.3.2.cmml" xref="S2.E14.m1.2.2.1.1.3.2">𝒛</ci><ci id="S2.E14.m1.2.2.1.1.3.3.cmml" xref="S2.E14.m1.2.2.1.1.3.3">𝐸</ci></apply><apply id="S2.E14.m1.2.2.1.1.1.cmml" xref="S2.E14.m1.2.2.1.1.1"><times id="S2.E14.m1.2.2.1.1.1.2.cmml" xref="S2.E14.m1.2.2.1.1.1.2"></times><ci id="S2.E14.m1.2.2.1.1.1.3a.cmml" xref="S2.E14.m1.2.2.1.1.1.3"><mtext id="S2.E14.m1.2.2.1.1.1.3.cmml" xref="S2.E14.m1.2.2.1.1.1.3">MLP</mtext></ci><apply id="S2.E14.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1"><apply id="S2.E14.m1.1.1.cmml" xref="S2.E14.m1.1.1"><times id="S2.E14.m1.1.1.1.cmml" xref="S2.E14.m1.1.1.1"></times><ci id="S2.E14.m1.1.1.2.cmml" xref="S2.E14.m1.1.1.2">mean</ci><ci id="S2.E14.m1.1.1.3.cmml" xref="S2.E14.m1.1.1.3">_</ci><ci id="S2.E14.m1.1.1.4.cmml" xref="S2.E14.m1.1.1.4">pool</ci></apply><apply id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑯</ci><ci id="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E14.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.2c">\displaystyle\bm{z}^{E}=\text{MLP}(\operatorname{mean\_pool}(\bm{H}^{E})),</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.2d">bold_italic_z start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT = MLP ( start_OPFUNCTION roman_mean _ roman_pool end_OPFUNCTION ( bold_italic_H start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p3.6">where an additional MLP layer is further applied for semantic space transformation.
Subsequently, we employ the item tokenizer to generate the token distribution for each level (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E6" title="In 2.2.1. Item Tokenizer ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>)), and let <math alttext="P_{\bm{z}}^{l}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.2.m1.1"><semantics id="S2.SS3.SSS1.p3.2.m1.1a"><msubsup id="S2.SS3.SSS1.p3.2.m1.1.1" xref="S2.SS3.SSS1.p3.2.m1.1.1.cmml"><mi id="S2.SS3.SSS1.p3.2.m1.1.1.2.2" xref="S2.SS3.SSS1.p3.2.m1.1.1.2.2.cmml">P</mi><mi id="S2.SS3.SSS1.p3.2.m1.1.1.2.3" xref="S2.SS3.SSS1.p3.2.m1.1.1.2.3.cmml">𝒛</mi><mi id="S2.SS3.SSS1.p3.2.m1.1.1.3" xref="S2.SS3.SSS1.p3.2.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.2.m1.1b"><apply id="S2.SS3.SSS1.p3.2.m1.1.1.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.2.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1">superscript</csymbol><apply id="S2.SS3.SSS1.p3.2.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.2.m1.1.1.2.1.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p3.2.m1.1.1.2.2.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1.2.2">𝑃</ci><ci id="S2.SS3.SSS1.p3.2.m1.1.1.2.3.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1.2.3">𝒛</ci></apply><ci id="S2.SS3.SSS1.p3.2.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p3.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.2.m1.1c">P_{\bm{z}}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.2.m1.1d">italic_P start_POSTSUBSCRIPT bold_italic_z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="P_{\bm{z}^{E}}^{l}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.3.m2.1"><semantics id="S2.SS3.SSS1.p3.3.m2.1a"><msubsup id="S2.SS3.SSS1.p3.3.m2.1.1" xref="S2.SS3.SSS1.p3.3.m2.1.1.cmml"><mi id="S2.SS3.SSS1.p3.3.m2.1.1.2.2" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.2.cmml">P</mi><msup id="S2.SS3.SSS1.p3.3.m2.1.1.2.3" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3.cmml"><mi id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.2" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3.2.cmml">𝒛</mi><mi id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.3" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3.3.cmml">E</mi></msup><mi id="S2.SS3.SSS1.p3.3.m2.1.1.3" xref="S2.SS3.SSS1.p3.3.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.3.m2.1b"><apply id="S2.SS3.SSS1.p3.3.m2.1.1.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.3.m2.1.1.1.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1">superscript</csymbol><apply id="S2.SS3.SSS1.p3.3.m2.1.1.2.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.3.m2.1.1.2.1.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p3.3.m2.1.1.2.2.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.2">𝑃</ci><apply id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.1.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3">superscript</csymbol><ci id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.2.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3.2">𝒛</ci><ci id="S2.SS3.SSS1.p3.3.m2.1.1.2.3.3.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.2.3.3">𝐸</ci></apply></apply><ci id="S2.SS3.SSS1.p3.3.m2.1.1.3.cmml" xref="S2.SS3.SSS1.p3.3.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.3.m2.1c">P_{\bm{z}^{E}}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.3.m2.1d">italic_P start_POSTSUBSCRIPT bold_italic_z start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> denote
the token distributions at the <math alttext="l" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.4.m3.1"><semantics id="S2.SS3.SSS1.p3.4.m3.1a"><mi id="S2.SS3.SSS1.p3.4.m3.1.1" xref="S2.SS3.SSS1.p3.4.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.4.m3.1b"><ci id="S2.SS3.SSS1.p3.4.m3.1.1.cmml" xref="S2.SS3.SSS1.p3.4.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.4.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.4.m3.1d">italic_l</annotation></semantics></math>-th level for inputs of <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.5.m4.1"><semantics id="S2.SS3.SSS1.p3.5.m4.1a"><mi id="S2.SS3.SSS1.p3.5.m4.1.1" xref="S2.SS3.SSS1.p3.5.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.5.m4.1b"><ci id="S2.SS3.SSS1.p3.5.m4.1.1.cmml" xref="S2.SS3.SSS1.p3.5.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.5.m4.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.5.m4.1d">bold_italic_z</annotation></semantics></math> (<em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS1.p3.6.1">collaborative item embedding</em>) and <math alttext="\bm{z}^{E}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.6.m5.1"><semantics id="S2.SS3.SSS1.p3.6.m5.1a"><msup id="S2.SS3.SSS1.p3.6.m5.1.1" xref="S2.SS3.SSS1.p3.6.m5.1.1.cmml"><mi id="S2.SS3.SSS1.p3.6.m5.1.1.2" xref="S2.SS3.SSS1.p3.6.m5.1.1.2.cmml">𝒛</mi><mi id="S2.SS3.SSS1.p3.6.m5.1.1.3" xref="S2.SS3.SSS1.p3.6.m5.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.6.m5.1b"><apply id="S2.SS3.SSS1.p3.6.m5.1.1.cmml" xref="S2.SS3.SSS1.p3.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.6.m5.1.1.1.cmml" xref="S2.SS3.SSS1.p3.6.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p3.6.m5.1.1.2.cmml" xref="S2.SS3.SSS1.p3.6.m5.1.1.2">𝒛</ci><ci id="S2.SS3.SSS1.p3.6.m5.1.1.3.cmml" xref="S2.SS3.SSS1.p3.6.m5.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.6.m5.1c">\bm{z}^{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.6.m5.1d">bold_italic_z start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT</annotation></semantics></math> (<em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS1.p3.6.2">encoder’s sequence state</em>), respectively.
Our objective is to enforce the two distributions to be similar, since the past sequence state should be highly informative for predicting the future interaction.
Formally, we introduce the symmetric Kullback-Leibler divergence loss is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\operatorname{SIA}}=-\sum_{l=1}^{L}\left(D_{KL}\big{(}P_{\bm{z}}^%
{l}||P_{\bm{z}^{E}}^{l})\big{)}+D_{KL}\big{(}P_{\bm{z}^{E}}^{l}||P_{\bm{z}}^{l%
})\big{)}\right)," class="ltx_math_unparsed" display="block" id="S2.E15.m1.1"><semantics id="S2.E15.m1.1a"><mrow id="S2.E15.m1.1b"><mrow id="S2.E15.m1.1.1"><msub id="S2.E15.m1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.1.1.1.2">ℒ</mi><mi id="S2.E15.m1.1.1.1.3">SIA</mi></msub><mo id="S2.E15.m1.1.1.2" rspace="0em">=</mo><mo id="S2.E15.m1.1.1.3" lspace="0em" rspace="0.055em">−</mo><munderover id="S2.E15.m1.1.1.4"><mo id="S2.E15.m1.1.1.4.2.2" movablelimits="false" rspace="0em">∑</mo><mrow id="S2.E15.m1.1.1.4.2.3"><mi id="S2.E15.m1.1.1.4.2.3.2">l</mi><mo id="S2.E15.m1.1.1.4.2.3.1">=</mo><mn id="S2.E15.m1.1.1.4.2.3.3">1</mn></mrow><mi id="S2.E15.m1.1.1.4.3">L</mi></munderover><mrow id="S2.E15.m1.1.1.5"><mo id="S2.E15.m1.1.1.5.1">(</mo><msub id="S2.E15.m1.1.1.5.2"><mi id="S2.E15.m1.1.1.5.2.2">D</mi><mrow id="S2.E15.m1.1.1.5.2.3"><mi id="S2.E15.m1.1.1.5.2.3.2">K</mi><mo id="S2.E15.m1.1.1.5.2.3.1">⁢</mo><mi id="S2.E15.m1.1.1.5.2.3.3">L</mi></mrow></msub><mrow id="S2.E15.m1.1.1.5.3"><mo id="S2.E15.m1.1.1.5.3.1" maxsize="120%" minsize="120%">(</mo><msubsup id="S2.E15.m1.1.1.5.3.2"><mi id="S2.E15.m1.1.1.5.3.2.2.2">P</mi><mi id="S2.E15.m1.1.1.5.3.2.2.3">𝒛</mi><mi id="S2.E15.m1.1.1.5.3.2.3">l</mi></msubsup><mo fence="false" id="S2.E15.m1.1.1.5.3.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S2.E15.m1.1.1.5.3.4" rspace="0.167em" stretchy="false">|</mo><msubsup id="S2.E15.m1.1.1.5.3.5"><mi id="S2.E15.m1.1.1.5.3.5.2.2">P</mi><msup id="S2.E15.m1.1.1.5.3.5.2.3"><mi id="S2.E15.m1.1.1.5.3.5.2.3.2">𝒛</mi><mi id="S2.E15.m1.1.1.5.3.5.2.3.3">E</mi></msup><mi id="S2.E15.m1.1.1.5.3.5.3">l</mi></msubsup><mo id="S2.E15.m1.1.1.5.3.6" stretchy="false">)</mo></mrow><mo id="S2.E15.m1.1.1.5.4" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S2.E15.m1.1.1.6">+</mo><msub id="S2.E15.m1.1.1.7"><mi id="S2.E15.m1.1.1.7.2">D</mi><mrow id="S2.E15.m1.1.1.7.3"><mi id="S2.E15.m1.1.1.7.3.2">K</mi><mo id="S2.E15.m1.1.1.7.3.1">⁢</mo><mi id="S2.E15.m1.1.1.7.3.3">L</mi></mrow></msub><mrow id="S2.E15.m1.1.1.8"><mo id="S2.E15.m1.1.1.8.1" maxsize="120%" minsize="120%">(</mo><msubsup id="S2.E15.m1.1.1.8.2"><mi id="S2.E15.m1.1.1.8.2.2.2">P</mi><msup id="S2.E15.m1.1.1.8.2.2.3"><mi id="S2.E15.m1.1.1.8.2.2.3.2">𝒛</mi><mi id="S2.E15.m1.1.1.8.2.2.3.3">E</mi></msup><mi id="S2.E15.m1.1.1.8.2.3">l</mi></msubsup><mo fence="false" id="S2.E15.m1.1.1.8.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S2.E15.m1.1.1.8.4" rspace="0.167em" stretchy="false">|</mo><msubsup id="S2.E15.m1.1.1.8.5"><mi id="S2.E15.m1.1.1.8.5.2.2">P</mi><mi id="S2.E15.m1.1.1.8.5.2.3">𝒛</mi><mi id="S2.E15.m1.1.1.8.5.3">l</mi></msubsup><mo id="S2.E15.m1.1.1.8.6" stretchy="false">)</mo></mrow><mo id="S2.E15.m1.1.1.9" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S2.E15.m1.1.2">)</mo><mo id="S2.E15.m1.1.3">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E15.m1.1c">\mathcal{L}_{\operatorname{SIA}}=-\sum_{l=1}^{L}\left(D_{KL}\big{(}P_{\bm{z}}^%
{l}||P_{\bm{z}^{E}}^{l})\big{)}+D_{KL}\big{(}P_{\bm{z}^{E}}^{l}||P_{\bm{z}}^{l%
})\big{)}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ( italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_P start_POSTSUBSCRIPT bold_italic_z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT | | italic_P start_POSTSUBSCRIPT bold_italic_z start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_P start_POSTSUBSCRIPT bold_italic_z start_POSTSUPERSCRIPT italic_E end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT | | italic_P start_POSTSUBSCRIPT bold_italic_z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p3.7">where <math alttext="D_{KL}(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p3.7.m1.1"><semantics id="S2.SS3.SSS1.p3.7.m1.1a"><mrow id="S2.SS3.SSS1.p3.7.m1.1.2" xref="S2.SS3.SSS1.p3.7.m1.1.2.cmml"><msub id="S2.SS3.SSS1.p3.7.m1.1.2.2" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.cmml"><mi id="S2.SS3.SSS1.p3.7.m1.1.2.2.2" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.2.cmml">D</mi><mrow id="S2.SS3.SSS1.p3.7.m1.1.2.2.3" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.cmml"><mi id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.2" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.2.cmml">K</mi><mo id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.1" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.3" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.3.cmml">L</mi></mrow></msub><mo id="S2.SS3.SSS1.p3.7.m1.1.2.1" xref="S2.SS3.SSS1.p3.7.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS1.p3.7.m1.1.2.3.2" xref="S2.SS3.SSS1.p3.7.m1.1.2.cmml"><mo id="S2.SS3.SSS1.p3.7.m1.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS1.p3.7.m1.1.2.cmml">(</mo><mo id="S2.SS3.SSS1.p3.7.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS1.p3.7.m1.1.1.cmml">⋅</mo><mo id="S2.SS3.SSS1.p3.7.m1.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS1.p3.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p3.7.m1.1b"><apply id="S2.SS3.SSS1.p3.7.m1.1.2.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2"><times id="S2.SS3.SSS1.p3.7.m1.1.2.1.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.1"></times><apply id="S2.SS3.SSS1.p3.7.m1.1.2.2.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p3.7.m1.1.2.2.1.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p3.7.m1.1.2.2.2.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.2">𝐷</ci><apply id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3"><times id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.1.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.1"></times><ci id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.2.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.2">𝐾</ci><ci id="S2.SS3.SSS1.p3.7.m1.1.2.2.3.3.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.2.2.3.3">𝐿</ci></apply></apply><ci id="S2.SS3.SSS1.p3.7.m1.1.1.cmml" xref="S2.SS3.SSS1.p3.7.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p3.7.m1.1c">D_{KL}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p3.7.m1.1d">italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> is the Kullback-Leibler divergence between two probablity distributions.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS1.p4">
<p class="ltx_p" id="S2.SS3.SSS1.p4.1">In addition to component fusion, another merit of this alignment loss is that it can enhance the representative capacity of the encoder. It has been found that the decoder might bypass the encoder (<em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS1.p4.1.1">i.e.,</em> seldom using the information from the encoder) to fulfill the generation task <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib12" title="">2023a</a>)</cite>, so that the encoder could not be well trained in this case. Our alignment loss can alleviate this issue and improve the overall sequence representations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2. </span>Preference-Semantic Alignment</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.1">Next, we introduce the second alignment loss.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS2.p2">
<p class="ltx_p" id="S2.SS3.SSS2.p2.6"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS2.p2.6.1">Alignment Hypothesis.</span>
Specifically, we aim to leverage the connection between the decoder’s first hidden state <math alttext="\bm{h}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.1.m1.1"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><msup id="S2.SS3.SSS2.p2.1.m1.1.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p2.1.m1.1.1.2" xref="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml">𝒉</mi><mi id="S2.SS3.SSS2.p2.1.m1.1.1.3" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><apply id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.2">𝒉</ci><ci id="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">\bm{h}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.1.m1.1d">bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> (the first column in <math alttext="\bm{H}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.2.m2.1"><semantics id="S2.SS3.SSS2.p2.2.m2.1a"><msup id="S2.SS3.SSS2.p2.2.m2.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml">𝑯</mi><mi id="S2.SS3.SSS2.p2.2.m2.1.1.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.2.m2.1b"><apply id="S2.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.2">𝑯</ci><ci id="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.2.m2.1c">\bm{H}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.2.m2.1d">bold_italic_H start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> from Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E12" title="In 2.2.2. Generative Recommender ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">12</span></a>)) and the reconstructed semantic embedding <math alttext="\tilde{\bm{z}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.3.m3.1"><semantics id="S2.SS3.SSS2.p2.3.m3.1a"><mover accent="true" id="S2.SS3.SSS2.p2.3.m3.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p2.3.m3.1.1.2" xref="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml">𝒛</mi><mo id="S2.SS3.SSS2.p2.3.m3.1.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.3.m3.1b"><apply id="S2.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1"><ci id="S2.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.1">~</ci><ci id="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.3.m3.1c">\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.3.m3.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math> (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E7" title="In 2.2.1. Item Tokenizer ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>)).
The former <math alttext="\bm{h}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.4.m4.1"><semantics id="S2.SS3.SSS2.p2.4.m4.1a"><msup id="S2.SS3.SSS2.p2.4.m4.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml">𝒉</mi><mi id="S2.SS3.SSS2.p2.4.m4.1.1.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.4.m4.1b"><apply id="S2.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2">𝒉</ci><ci id="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.4.m4.1c">\bm{h}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.4.m4.1d">bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is learned by modeling the interaction sequence and reflects the sequential user preference, while the latter <math alttext="\tilde{\bm{z}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.5.m5.1"><semantics id="S2.SS3.SSS2.p2.5.m5.1a"><mover accent="true" id="S2.SS3.SSS2.p2.5.m5.1.1" xref="S2.SS3.SSS2.p2.5.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p2.5.m5.1.1.2" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.cmml">𝒛</mi><mo id="S2.SS3.SSS2.p2.5.m5.1.1.1" xref="S2.SS3.SSS2.p2.5.m5.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.5.m5.1b"><apply id="S2.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1"><ci id="S2.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.1">~</ci><ci id="S2.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.5.m5.1c">\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.5.m5.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math> encodes the collaborative semantics of the target item.
Therefore, we refer to such an association relation as <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS2.p2.6.2">preference-semantic alignment</em>. Note that different from the recommendation loss, we use the reconstructed embedding <math alttext="\tilde{\bm{z}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.6.m6.1"><semantics id="S2.SS3.SSS2.p2.6.m6.1a"><mover accent="true" id="S2.SS3.SSS2.p2.6.m6.1.1" xref="S2.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p2.6.m6.1.1.2" xref="S2.SS3.SSS2.p2.6.m6.1.1.2.cmml">𝒛</mi><mo id="S2.SS3.SSS2.p2.6.m6.1.1.1" xref="S2.SS3.SSS2.p2.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.6.m6.1b"><apply id="S2.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1"><ci id="S2.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.1">~</ci><ci id="S2.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.6.m6.1c">\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.6.m6.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math>, so that it naturally involves the tokenizer component in the optimization process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS2.p3">
<p class="ltx_p" id="S2.SS3.SSS2.p3.2"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS2.p3.2.1">Alignment Loss.</span> Next we employ InfoNCE <cite class="ltx_cite ltx_citemacro_citep">(Gutmann and Hyvärinen, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib5" title="">2010</a>)</cite> with in-batch negatives to align <math alttext="\bm{h}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.1.m1.1"><semantics id="S2.SS3.SSS2.p3.1.m1.1a"><msup id="S2.SS3.SSS2.p3.1.m1.1.1" xref="S2.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p3.1.m1.1.1.2" xref="S2.SS3.SSS2.p3.1.m1.1.1.2.cmml">𝒉</mi><mi id="S2.SS3.SSS2.p3.1.m1.1.1.3" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.cmml">D</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.1.m1.1b"><apply id="S2.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.2">𝒉</ci><ci id="S2.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.1.m1.1c">\bm{h}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.1.m1.1d">bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> (also with MLP transformation) and <math alttext="\tilde{\bm{z}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.2.m2.1"><semantics id="S2.SS3.SSS2.p3.2.m2.1a"><mover accent="true" id="S2.SS3.SSS2.p3.2.m2.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p3.2.m2.1.1.2" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.cmml">𝒛</mi><mo id="S2.SS3.SSS2.p3.2.m2.1.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.2.m2.1b"><apply id="S2.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1"><ci id="S2.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.1">~</ci><ci id="S2.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.2.m2.1c">\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.2.m2.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math>, the preference-semantic alignment loss is defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx7">
<tbody id="S2.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{PSA}}=-\left(\log\frac{\exp{(%
\operatorname{s}(\tilde{\bm{z}}},\bm{h}^{D})/\tau)}{\sum_{\hat{\bm{h}}\in%
\mathcal{B}}\exp{(\operatorname{s}(\tilde{\bm{z}}},\hat{\bm{h}})/\tau)}+\log%
\frac{\exp{(\operatorname{s}(\bm{h}^{D},\tilde{\bm{z}}})/\tau)}{\sum_{\hat{\bm%
{z}}\in\mathcal{B}}\exp{(\operatorname{s}(\bm{h}^{D},\hat{\bm{z}}})/\tau)}%
\right)," class="ltx_Math" display="inline" id="S2.E16.m1.18"><semantics id="S2.E16.m1.18a"><mrow id="S2.E16.m1.18.18.1" xref="S2.E16.m1.18.18.1.1.cmml"><mrow id="S2.E16.m1.18.18.1.1" xref="S2.E16.m1.18.18.1.1.cmml"><msub id="S2.E16.m1.18.18.1.1.3" xref="S2.E16.m1.18.18.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.18.18.1.1.3.2" xref="S2.E16.m1.18.18.1.1.3.2.cmml">ℒ</mi><mi id="S2.E16.m1.18.18.1.1.3.3" xref="S2.E16.m1.18.18.1.1.3.3.cmml">PSA</mi></msub><mo id="S2.E16.m1.18.18.1.1.2" xref="S2.E16.m1.18.18.1.1.2.cmml">=</mo><mrow id="S2.E16.m1.18.18.1.1.1" xref="S2.E16.m1.18.18.1.1.1.cmml"><mo id="S2.E16.m1.18.18.1.1.1a" xref="S2.E16.m1.18.18.1.1.1.cmml">−</mo><mrow id="S2.E16.m1.18.18.1.1.1.1.1" xref="S2.E16.m1.18.18.1.1.1.1.1.1.cmml"><mo id="S2.E16.m1.18.18.1.1.1.1.1.2" xref="S2.E16.m1.18.18.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.18.18.1.1.1.1.1.1" xref="S2.E16.m1.18.18.1.1.1.1.1.1.cmml"><mrow id="S2.E16.m1.18.18.1.1.1.1.1.1.2" xref="S2.E16.m1.18.18.1.1.1.1.1.1.2.cmml"><mi id="S2.E16.m1.18.18.1.1.1.1.1.1.2.1" xref="S2.E16.m1.18.18.1.1.1.1.1.1.2.1.cmml">log</mi><mo id="S2.E16.m1.18.18.1.1.1.1.1.1.2a" lspace="0.167em" xref="S2.E16.m1.18.18.1.1.1.1.1.1.2.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E16.m1.9.9" xref="S2.E16.m1.9.9.cmml"><mfrac id="S2.E16.m1.9.9a" xref="S2.E16.m1.9.9.cmml"><mrow id="S2.E16.m1.4.4.4.4" xref="S2.E16.m1.4.4.4.5.cmml"><mi id="S2.E16.m1.3.3.3.3" xref="S2.E16.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E16.m1.4.4.4.4a" xref="S2.E16.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E16.m1.4.4.4.4.1" xref="S2.E16.m1.4.4.4.5.cmml"><mo id="S2.E16.m1.4.4.4.4.1.2" stretchy="false" xref="S2.E16.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E16.m1.4.4.4.4.1.1" xref="S2.E16.m1.4.4.4.4.1.1.cmml"><mrow id="S2.E16.m1.4.4.4.4.1.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml"><mi id="S2.E16.m1.1.1.1.1" mathvariant="normal" xref="S2.E16.m1.1.1.1.1.cmml">s</mi><mo id="S2.E16.m1.4.4.4.4.1.1.1.1a" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S2.E16.m1.4.4.4.4.1.1.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml"><mo id="S2.E16.m1.4.4.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml">(</mo><mover accent="true" id="S2.E16.m1.2.2.2.2" xref="S2.E16.m1.2.2.2.2.cmml"><mi id="S2.E16.m1.2.2.2.2.2" xref="S2.E16.m1.2.2.2.2.2.cmml">𝒛</mi><mo id="S2.E16.m1.2.2.2.2.1" xref="S2.E16.m1.2.2.2.2.1.cmml">~</mo></mover><mo id="S2.E16.m1.4.4.4.4.1.1.1.1.1.3" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml">,</mo><msup id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.2" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.3" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.3.cmml">D</mi></msup><mo id="S2.E16.m1.4.4.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.E16.m1.4.4.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E16.m1.4.4.4.4.1.1.2" xref="S2.E16.m1.4.4.4.4.1.1.2.cmml">/</mo><mi id="S2.E16.m1.4.4.4.4.1.1.3" xref="S2.E16.m1.4.4.4.4.1.1.3.cmml">τ</mi></mrow><mo id="S2.E16.m1.4.4.4.4.1.3" stretchy="false" xref="S2.E16.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E16.m1.9.9.9" xref="S2.E16.m1.9.9.9.cmml"><msub id="S2.E16.m1.9.9.9.6" xref="S2.E16.m1.9.9.9.6.cmml"><mo id="S2.E16.m1.9.9.9.6.2" xref="S2.E16.m1.9.9.9.6.2.cmml">∑</mo><mrow id="S2.E16.m1.9.9.9.6.3" xref="S2.E16.m1.9.9.9.6.3.cmml"><mover accent="true" id="S2.E16.m1.9.9.9.6.3.2" xref="S2.E16.m1.9.9.9.6.3.2.cmml"><mi id="S2.E16.m1.9.9.9.6.3.2.2" xref="S2.E16.m1.9.9.9.6.3.2.2.cmml">𝒉</mi><mo id="S2.E16.m1.9.9.9.6.3.2.1" xref="S2.E16.m1.9.9.9.6.3.2.1.cmml">^</mo></mover><mo id="S2.E16.m1.9.9.9.6.3.1" xref="S2.E16.m1.9.9.9.6.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.9.9.9.6.3.3" xref="S2.E16.m1.9.9.9.6.3.3.cmml">ℬ</mi></mrow></msub><mrow id="S2.E16.m1.9.9.9.5.1" xref="S2.E16.m1.9.9.9.5.2.cmml"><mi id="S2.E16.m1.8.8.8.4" xref="S2.E16.m1.8.8.8.4.cmml">exp</mi><mo id="S2.E16.m1.9.9.9.5.1a" xref="S2.E16.m1.9.9.9.5.2.cmml">⁡</mo><mrow id="S2.E16.m1.9.9.9.5.1.1" xref="S2.E16.m1.9.9.9.5.2.cmml"><mo id="S2.E16.m1.9.9.9.5.1.1.2" stretchy="false" xref="S2.E16.m1.9.9.9.5.2.cmml">(</mo><mrow id="S2.E16.m1.9.9.9.5.1.1.1" xref="S2.E16.m1.9.9.9.5.1.1.1.cmml"><mrow id="S2.E16.m1.9.9.9.5.1.1.1.2.2" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml"><mi id="S2.E16.m1.5.5.5.1" mathvariant="normal" xref="S2.E16.m1.5.5.5.1.cmml">s</mi><mo id="S2.E16.m1.9.9.9.5.1.1.1.2.2a" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml">⁡</mo><mrow id="S2.E16.m1.9.9.9.5.1.1.1.2.2.1" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml"><mo id="S2.E16.m1.9.9.9.5.1.1.1.2.2.1.1" stretchy="false" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml">(</mo><mover accent="true" id="S2.E16.m1.6.6.6.2" xref="S2.E16.m1.6.6.6.2.cmml"><mi id="S2.E16.m1.6.6.6.2.2" xref="S2.E16.m1.6.6.6.2.2.cmml">𝒛</mi><mo id="S2.E16.m1.6.6.6.2.1" xref="S2.E16.m1.6.6.6.2.1.cmml">~</mo></mover><mo id="S2.E16.m1.9.9.9.5.1.1.1.2.2.1.2" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml">,</mo><mover accent="true" id="S2.E16.m1.7.7.7.3" xref="S2.E16.m1.7.7.7.3.cmml"><mi id="S2.E16.m1.7.7.7.3.2" xref="S2.E16.m1.7.7.7.3.2.cmml">𝒉</mi><mo id="S2.E16.m1.7.7.7.3.1" xref="S2.E16.m1.7.7.7.3.1.cmml">^</mo></mover><mo id="S2.E16.m1.9.9.9.5.1.1.1.2.2.1.3" stretchy="false" xref="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E16.m1.9.9.9.5.1.1.1.1" xref="S2.E16.m1.9.9.9.5.1.1.1.1.cmml">/</mo><mi id="S2.E16.m1.9.9.9.5.1.1.1.3" xref="S2.E16.m1.9.9.9.5.1.1.1.3.cmml">τ</mi></mrow><mo id="S2.E16.m1.9.9.9.5.1.1.3" stretchy="false" xref="S2.E16.m1.9.9.9.5.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S2.E16.m1.18.18.1.1.1.1.1.1.1" xref="S2.E16.m1.18.18.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E16.m1.18.18.1.1.1.1.1.1.3" xref="S2.E16.m1.18.18.1.1.1.1.1.1.3.cmml"><mi id="S2.E16.m1.18.18.1.1.1.1.1.1.3.1" xref="S2.E16.m1.18.18.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E16.m1.18.18.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E16.m1.18.18.1.1.1.1.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E16.m1.17.17" xref="S2.E16.m1.17.17.cmml"><mfrac id="S2.E16.m1.17.17a" xref="S2.E16.m1.17.17.cmml"><mrow id="S2.E16.m1.13.13.4.4" xref="S2.E16.m1.13.13.4.5.cmml"><mi id="S2.E16.m1.12.12.3.3" xref="S2.E16.m1.12.12.3.3.cmml">exp</mi><mo id="S2.E16.m1.13.13.4.4a" xref="S2.E16.m1.13.13.4.5.cmml">⁡</mo><mrow id="S2.E16.m1.13.13.4.4.1" xref="S2.E16.m1.13.13.4.5.cmml"><mo id="S2.E16.m1.13.13.4.4.1.2" stretchy="false" xref="S2.E16.m1.13.13.4.5.cmml">(</mo><mrow id="S2.E16.m1.13.13.4.4.1.1" xref="S2.E16.m1.13.13.4.4.1.1.cmml"><mrow id="S2.E16.m1.13.13.4.4.1.1.1.1" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml"><mi id="S2.E16.m1.10.10.1.1" mathvariant="normal" xref="S2.E16.m1.10.10.1.1.cmml">s</mi><mo id="S2.E16.m1.13.13.4.4.1.1.1.1a" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S2.E16.m1.13.13.4.4.1.1.1.1.1" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml"><mo id="S2.E16.m1.13.13.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml">(</mo><msup id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.2" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.3" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.3.cmml">D</mi></msup><mo id="S2.E16.m1.13.13.4.4.1.1.1.1.1.3" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml">,</mo><mover accent="true" id="S2.E16.m1.11.11.2.2" xref="S2.E16.m1.11.11.2.2.cmml"><mi id="S2.E16.m1.11.11.2.2.2" xref="S2.E16.m1.11.11.2.2.2.cmml">𝒛</mi><mo id="S2.E16.m1.11.11.2.2.1" xref="S2.E16.m1.11.11.2.2.1.cmml">~</mo></mover><mo id="S2.E16.m1.13.13.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.E16.m1.13.13.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E16.m1.13.13.4.4.1.1.2" xref="S2.E16.m1.13.13.4.4.1.1.2.cmml">/</mo><mi id="S2.E16.m1.13.13.4.4.1.1.3" xref="S2.E16.m1.13.13.4.4.1.1.3.cmml">τ</mi></mrow><mo id="S2.E16.m1.13.13.4.4.1.3" stretchy="false" xref="S2.E16.m1.13.13.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E16.m1.17.17.8" xref="S2.E16.m1.17.17.8.cmml"><msub id="S2.E16.m1.17.17.8.5" xref="S2.E16.m1.17.17.8.5.cmml"><mo id="S2.E16.m1.17.17.8.5.2" xref="S2.E16.m1.17.17.8.5.2.cmml">∑</mo><mrow id="S2.E16.m1.17.17.8.5.3" xref="S2.E16.m1.17.17.8.5.3.cmml"><mover accent="true" id="S2.E16.m1.17.17.8.5.3.2" xref="S2.E16.m1.17.17.8.5.3.2.cmml"><mi id="S2.E16.m1.17.17.8.5.3.2.2" xref="S2.E16.m1.17.17.8.5.3.2.2.cmml">𝒛</mi><mo id="S2.E16.m1.17.17.8.5.3.2.1" xref="S2.E16.m1.17.17.8.5.3.2.1.cmml">^</mo></mover><mo id="S2.E16.m1.17.17.8.5.3.1" xref="S2.E16.m1.17.17.8.5.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E16.m1.17.17.8.5.3.3" xref="S2.E16.m1.17.17.8.5.3.3.cmml">ℬ</mi></mrow></msub><mrow id="S2.E16.m1.17.17.8.4.1" xref="S2.E16.m1.17.17.8.4.2.cmml"><mi id="S2.E16.m1.16.16.7.3" xref="S2.E16.m1.16.16.7.3.cmml">exp</mi><mo id="S2.E16.m1.17.17.8.4.1a" xref="S2.E16.m1.17.17.8.4.2.cmml">⁡</mo><mrow id="S2.E16.m1.17.17.8.4.1.1" xref="S2.E16.m1.17.17.8.4.2.cmml"><mo id="S2.E16.m1.17.17.8.4.1.1.2" stretchy="false" xref="S2.E16.m1.17.17.8.4.2.cmml">(</mo><mrow id="S2.E16.m1.17.17.8.4.1.1.1" xref="S2.E16.m1.17.17.8.4.1.1.1.cmml"><mrow id="S2.E16.m1.17.17.8.4.1.1.1.1.1" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml"><mi id="S2.E16.m1.14.14.5.1" mathvariant="normal" xref="S2.E16.m1.14.14.5.1.cmml">s</mi><mo id="S2.E16.m1.17.17.8.4.1.1.1.1.1a" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml"><mo id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.2" stretchy="false" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml">(</mo><msup id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.2" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.3" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.3.cmml">D</mi></msup><mo id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.3" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S2.E16.m1.15.15.6.2" xref="S2.E16.m1.15.15.6.2.cmml"><mi id="S2.E16.m1.15.15.6.2.2" xref="S2.E16.m1.15.15.6.2.2.cmml">𝒛</mi><mo id="S2.E16.m1.15.15.6.2.1" xref="S2.E16.m1.15.15.6.2.1.cmml">^</mo></mover><mo id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.4" stretchy="false" xref="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E16.m1.17.17.8.4.1.1.1.2" xref="S2.E16.m1.17.17.8.4.1.1.1.2.cmml">/</mo><mi id="S2.E16.m1.17.17.8.4.1.1.1.3" xref="S2.E16.m1.17.17.8.4.1.1.1.3.cmml">τ</mi></mrow><mo id="S2.E16.m1.17.17.8.4.1.1.3" stretchy="false" xref="S2.E16.m1.17.17.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="S2.E16.m1.18.18.1.1.1.1.1.3" xref="S2.E16.m1.18.18.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E16.m1.18.18.1.2" xref="S2.E16.m1.18.18.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.18b"><apply id="S2.E16.m1.18.18.1.1.cmml" xref="S2.E16.m1.18.18.1"><eq id="S2.E16.m1.18.18.1.1.2.cmml" xref="S2.E16.m1.18.18.1.1.2"></eq><apply id="S2.E16.m1.18.18.1.1.3.cmml" xref="S2.E16.m1.18.18.1.1.3"><csymbol cd="ambiguous" id="S2.E16.m1.18.18.1.1.3.1.cmml" xref="S2.E16.m1.18.18.1.1.3">subscript</csymbol><ci id="S2.E16.m1.18.18.1.1.3.2.cmml" xref="S2.E16.m1.18.18.1.1.3.2">ℒ</ci><ci id="S2.E16.m1.18.18.1.1.3.3.cmml" xref="S2.E16.m1.18.18.1.1.3.3">PSA</ci></apply><apply id="S2.E16.m1.18.18.1.1.1.cmml" xref="S2.E16.m1.18.18.1.1.1"><minus id="S2.E16.m1.18.18.1.1.1.2.cmml" xref="S2.E16.m1.18.18.1.1.1"></minus><apply id="S2.E16.m1.18.18.1.1.1.1.1.1.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1"><plus id="S2.E16.m1.18.18.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1.1.1"></plus><apply id="S2.E16.m1.18.18.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1.1.2"><log id="S2.E16.m1.18.18.1.1.1.1.1.1.2.1.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1.1.2.1"></log><apply id="S2.E16.m1.9.9.cmml" xref="S2.E16.m1.9.9"><divide id="S2.E16.m1.9.9.10.cmml" xref="S2.E16.m1.9.9"></divide><apply id="S2.E16.m1.4.4.4.5.cmml" xref="S2.E16.m1.4.4.4.4"><exp id="S2.E16.m1.3.3.3.3.cmml" xref="S2.E16.m1.3.3.3.3"></exp><apply id="S2.E16.m1.4.4.4.4.1.1.cmml" xref="S2.E16.m1.4.4.4.4.1.1"><divide id="S2.E16.m1.4.4.4.4.1.1.2.cmml" xref="S2.E16.m1.4.4.4.4.1.1.2"></divide><apply id="S2.E16.m1.4.4.4.4.1.1.1.2.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1"><ci id="S2.E16.m1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1.1">s</ci><apply id="S2.E16.m1.2.2.2.2.cmml" xref="S2.E16.m1.2.2.2.2"><ci id="S2.E16.m1.2.2.2.2.1.cmml" xref="S2.E16.m1.2.2.2.2.1">~</ci><ci id="S2.E16.m1.2.2.2.2.2.cmml" xref="S2.E16.m1.2.2.2.2.2">𝒛</ci></apply><apply id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.2">𝒉</ci><ci id="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.4.4.4.4.1.1.1.1.1.1.3">𝐷</ci></apply></apply><ci id="S2.E16.m1.4.4.4.4.1.1.3.cmml" xref="S2.E16.m1.4.4.4.4.1.1.3">𝜏</ci></apply></apply><apply id="S2.E16.m1.9.9.9.cmml" xref="S2.E16.m1.9.9.9"><apply id="S2.E16.m1.9.9.9.6.cmml" xref="S2.E16.m1.9.9.9.6"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.9.6.1.cmml" xref="S2.E16.m1.9.9.9.6">subscript</csymbol><sum id="S2.E16.m1.9.9.9.6.2.cmml" xref="S2.E16.m1.9.9.9.6.2"></sum><apply id="S2.E16.m1.9.9.9.6.3.cmml" xref="S2.E16.m1.9.9.9.6.3"><in id="S2.E16.m1.9.9.9.6.3.1.cmml" xref="S2.E16.m1.9.9.9.6.3.1"></in><apply id="S2.E16.m1.9.9.9.6.3.2.cmml" xref="S2.E16.m1.9.9.9.6.3.2"><ci id="S2.E16.m1.9.9.9.6.3.2.1.cmml" xref="S2.E16.m1.9.9.9.6.3.2.1">^</ci><ci id="S2.E16.m1.9.9.9.6.3.2.2.cmml" xref="S2.E16.m1.9.9.9.6.3.2.2">𝒉</ci></apply><ci id="S2.E16.m1.9.9.9.6.3.3.cmml" xref="S2.E16.m1.9.9.9.6.3.3">ℬ</ci></apply></apply><apply id="S2.E16.m1.9.9.9.5.2.cmml" xref="S2.E16.m1.9.9.9.5.1"><exp id="S2.E16.m1.8.8.8.4.cmml" xref="S2.E16.m1.8.8.8.4"></exp><apply id="S2.E16.m1.9.9.9.5.1.1.1.cmml" xref="S2.E16.m1.9.9.9.5.1.1.1"><divide id="S2.E16.m1.9.9.9.5.1.1.1.1.cmml" xref="S2.E16.m1.9.9.9.5.1.1.1.1"></divide><apply id="S2.E16.m1.9.9.9.5.1.1.1.2.1.cmml" xref="S2.E16.m1.9.9.9.5.1.1.1.2.2"><ci id="S2.E16.m1.5.5.5.1.cmml" xref="S2.E16.m1.5.5.5.1">s</ci><apply id="S2.E16.m1.6.6.6.2.cmml" xref="S2.E16.m1.6.6.6.2"><ci id="S2.E16.m1.6.6.6.2.1.cmml" xref="S2.E16.m1.6.6.6.2.1">~</ci><ci id="S2.E16.m1.6.6.6.2.2.cmml" xref="S2.E16.m1.6.6.6.2.2">𝒛</ci></apply><apply id="S2.E16.m1.7.7.7.3.cmml" xref="S2.E16.m1.7.7.7.3"><ci id="S2.E16.m1.7.7.7.3.1.cmml" xref="S2.E16.m1.7.7.7.3.1">^</ci><ci id="S2.E16.m1.7.7.7.3.2.cmml" xref="S2.E16.m1.7.7.7.3.2">𝒉</ci></apply></apply><ci id="S2.E16.m1.9.9.9.5.1.1.1.3.cmml" xref="S2.E16.m1.9.9.9.5.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply><apply id="S2.E16.m1.18.18.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1.1.3"><log id="S2.E16.m1.18.18.1.1.1.1.1.1.3.1.cmml" xref="S2.E16.m1.18.18.1.1.1.1.1.1.3.1"></log><apply id="S2.E16.m1.17.17.cmml" xref="S2.E16.m1.17.17"><divide id="S2.E16.m1.17.17.9.cmml" xref="S2.E16.m1.17.17"></divide><apply id="S2.E16.m1.13.13.4.5.cmml" xref="S2.E16.m1.13.13.4.4"><exp id="S2.E16.m1.12.12.3.3.cmml" xref="S2.E16.m1.12.12.3.3"></exp><apply id="S2.E16.m1.13.13.4.4.1.1.cmml" xref="S2.E16.m1.13.13.4.4.1.1"><divide id="S2.E16.m1.13.13.4.4.1.1.2.cmml" xref="S2.E16.m1.13.13.4.4.1.1.2"></divide><apply id="S2.E16.m1.13.13.4.4.1.1.1.2.cmml" xref="S2.E16.m1.13.13.4.4.1.1.1.1"><ci id="S2.E16.m1.10.10.1.1.cmml" xref="S2.E16.m1.10.10.1.1">s</ci><apply id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.cmml" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.2">𝒉</ci><ci id="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.13.13.4.4.1.1.1.1.1.1.3">𝐷</ci></apply><apply id="S2.E16.m1.11.11.2.2.cmml" xref="S2.E16.m1.11.11.2.2"><ci id="S2.E16.m1.11.11.2.2.1.cmml" xref="S2.E16.m1.11.11.2.2.1">~</ci><ci id="S2.E16.m1.11.11.2.2.2.cmml" xref="S2.E16.m1.11.11.2.2.2">𝒛</ci></apply></apply><ci id="S2.E16.m1.13.13.4.4.1.1.3.cmml" xref="S2.E16.m1.13.13.4.4.1.1.3">𝜏</ci></apply></apply><apply id="S2.E16.m1.17.17.8.cmml" xref="S2.E16.m1.17.17.8"><apply id="S2.E16.m1.17.17.8.5.cmml" xref="S2.E16.m1.17.17.8.5"><csymbol cd="ambiguous" id="S2.E16.m1.17.17.8.5.1.cmml" xref="S2.E16.m1.17.17.8.5">subscript</csymbol><sum id="S2.E16.m1.17.17.8.5.2.cmml" xref="S2.E16.m1.17.17.8.5.2"></sum><apply id="S2.E16.m1.17.17.8.5.3.cmml" xref="S2.E16.m1.17.17.8.5.3"><in id="S2.E16.m1.17.17.8.5.3.1.cmml" xref="S2.E16.m1.17.17.8.5.3.1"></in><apply id="S2.E16.m1.17.17.8.5.3.2.cmml" xref="S2.E16.m1.17.17.8.5.3.2"><ci id="S2.E16.m1.17.17.8.5.3.2.1.cmml" xref="S2.E16.m1.17.17.8.5.3.2.1">^</ci><ci id="S2.E16.m1.17.17.8.5.3.2.2.cmml" xref="S2.E16.m1.17.17.8.5.3.2.2">𝒛</ci></apply><ci id="S2.E16.m1.17.17.8.5.3.3.cmml" xref="S2.E16.m1.17.17.8.5.3.3">ℬ</ci></apply></apply><apply id="S2.E16.m1.17.17.8.4.2.cmml" xref="S2.E16.m1.17.17.8.4.1"><exp id="S2.E16.m1.16.16.7.3.cmml" xref="S2.E16.m1.16.16.7.3"></exp><apply id="S2.E16.m1.17.17.8.4.1.1.1.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1"><divide id="S2.E16.m1.17.17.8.4.1.1.1.2.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.2"></divide><apply id="S2.E16.m1.17.17.8.4.1.1.1.1.2.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1"><ci id="S2.E16.m1.14.14.5.1.cmml" xref="S2.E16.m1.14.14.5.1">s</ci><apply id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.2">𝒉</ci><ci id="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.1.1.1.1.3">𝐷</ci></apply><apply id="S2.E16.m1.15.15.6.2.cmml" xref="S2.E16.m1.15.15.6.2"><ci id="S2.E16.m1.15.15.6.2.1.cmml" xref="S2.E16.m1.15.15.6.2.1">^</ci><ci id="S2.E16.m1.15.15.6.2.2.cmml" xref="S2.E16.m1.15.15.6.2.2">𝒛</ci></apply></apply><ci id="S2.E16.m1.17.17.8.4.1.1.1.3.cmml" xref="S2.E16.m1.17.17.8.4.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.18c">\displaystyle\mathcal{L}_{\operatorname{PSA}}=-\left(\log\frac{\exp{(%
\operatorname{s}(\tilde{\bm{z}}},\bm{h}^{D})/\tau)}{\sum_{\hat{\bm{h}}\in%
\mathcal{B}}\exp{(\operatorname{s}(\tilde{\bm{z}}},\hat{\bm{h}})/\tau)}+\log%
\frac{\exp{(\operatorname{s}(\bm{h}^{D},\tilde{\bm{z}}})/\tau)}{\sum_{\hat{\bm%
{z}}\in\mathcal{B}}\exp{(\operatorname{s}(\bm{h}^{D},\hat{\bm{z}}})/\tau)}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.18d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT = - ( roman_log divide start_ARG roman_exp ( roman_s ( over~ start_ARG bold_italic_z end_ARG , bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT over^ start_ARG bold_italic_h end_ARG ∈ caligraphic_B end_POSTSUBSCRIPT roman_exp ( roman_s ( over~ start_ARG bold_italic_z end_ARG , over^ start_ARG bold_italic_h end_ARG ) / italic_τ ) end_ARG + roman_log divide start_ARG roman_exp ( roman_s ( bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT , over~ start_ARG bold_italic_z end_ARG ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT over^ start_ARG bold_italic_z end_ARG ∈ caligraphic_B end_POSTSUBSCRIPT roman_exp ( roman_s ( bold_italic_h start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT , over^ start_ARG bold_italic_z end_ARG ) / italic_τ ) end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p3.5">where <math alttext="s(\cdot,\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.3.m1.2"><semantics id="S2.SS3.SSS2.p3.3.m1.2a"><mrow id="S2.SS3.SSS2.p3.3.m1.2.3" xref="S2.SS3.SSS2.p3.3.m1.2.3.cmml"><mi id="S2.SS3.SSS2.p3.3.m1.2.3.2" xref="S2.SS3.SSS2.p3.3.m1.2.3.2.cmml">s</mi><mo id="S2.SS3.SSS2.p3.3.m1.2.3.1" xref="S2.SS3.SSS2.p3.3.m1.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.SSS2.p3.3.m1.2.3.3.2" xref="S2.SS3.SSS2.p3.3.m1.2.3.3.1.cmml"><mo id="S2.SS3.SSS2.p3.3.m1.2.3.3.2.1" stretchy="false" xref="S2.SS3.SSS2.p3.3.m1.2.3.3.1.cmml">(</mo><mo id="S2.SS3.SSS2.p3.3.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS2.p3.3.m1.1.1.cmml">⋅</mo><mo id="S2.SS3.SSS2.p3.3.m1.2.3.3.2.2" rspace="0em" xref="S2.SS3.SSS2.p3.3.m1.2.3.3.1.cmml">,</mo><mo id="S2.SS3.SSS2.p3.3.m1.2.2" lspace="0em" rspace="0em" xref="S2.SS3.SSS2.p3.3.m1.2.2.cmml">⋅</mo><mo id="S2.SS3.SSS2.p3.3.m1.2.3.3.2.3" stretchy="false" xref="S2.SS3.SSS2.p3.3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.3.m1.2b"><apply id="S2.SS3.SSS2.p3.3.m1.2.3.cmml" xref="S2.SS3.SSS2.p3.3.m1.2.3"><times id="S2.SS3.SSS2.p3.3.m1.2.3.1.cmml" xref="S2.SS3.SSS2.p3.3.m1.2.3.1"></times><ci id="S2.SS3.SSS2.p3.3.m1.2.3.2.cmml" xref="S2.SS3.SSS2.p3.3.m1.2.3.2">𝑠</ci><interval closure="open" id="S2.SS3.SSS2.p3.3.m1.2.3.3.1.cmml" xref="S2.SS3.SSS2.p3.3.m1.2.3.3.2"><ci id="S2.SS3.SSS2.p3.3.m1.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m1.1.1">⋅</ci><ci id="S2.SS3.SSS2.p3.3.m1.2.2.cmml" xref="S2.SS3.SSS2.p3.3.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.3.m1.2c">s(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.3.m1.2d">italic_s ( ⋅ , ⋅ )</annotation></semantics></math> is the cosine similarity function, <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.4.m2.1"><semantics id="S2.SS3.SSS2.p3.4.m2.1a"><mi id="S2.SS3.SSS2.p3.4.m2.1.1" xref="S2.SS3.SSS2.p3.4.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.4.m2.1b"><ci id="S2.SS3.SSS2.p3.4.m2.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.4.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.4.m2.1d">italic_τ</annotation></semantics></math> is a temperature coefficient and <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.5.m3.1"><semantics id="S2.SS3.SSS2.p3.5.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p3.5.m3.1.1" xref="S2.SS3.SSS2.p3.5.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.5.m3.1b"><ci id="S2.SS3.SSS2.p3.5.m3.1.1.cmml" xref="S2.SS3.SSS2.p3.5.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.5.m3.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.5.m3.1d">caligraphic_B</annotation></semantics></math> denotes a batch of training instances.
This loss can also be considered as an additional enhancement of the recommendation loss (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E13" title="In 2.2.2. Generative Recommender ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">13</span></a>)), which uses the tokens of target items.
By incorporating the reconstructed collaborative embedding, this loss involves the tokenizer component during training, which can enhance mutual optimization.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p4">
<p class="ltx_p" id="S2.SS3.SSS2.p4.1">Through the above two alignment strategies, we can effectively enhance the associations between the two components during model optimization and thus can facilitate mutual enhancement by making necessary adaptations to each other.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>Alternating Optimization</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Based on the dual encoder-decoder architecture and recommendation-oriented alignment, a straightforward approach is to jointly optimize the objectives of the item tokenizer and generative recommender as well as the alignment losses.
In order to improve the training stability, we propose an alternating optimization strategy to mutually train the item tokenizer and the generative recommender.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.3"><span class="ltx_text ltx_font_bold" id="S2.SS4.p2.3.1">Item Tokenizer Optimization.</span>
The item tokenizer is optimized by jointly considering the semantic quantization loss <math alttext="\mathcal{L}_{\operatorname{SQ}}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><msub id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml">SQ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">ℒ</ci><ci id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3">SQ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\mathcal{L}_{\operatorname{SQ}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SQ end_POSTSUBSCRIPT</annotation></semantics></math> (Equation (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E8" title="In 2.2.1. Item Tokenizer ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>)), sequence-item alignment loss <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><msub id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.2.m2.1.1.2" xref="S2.SS4.p2.2.m2.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p2.2.m2.1.1.3" xref="S2.SS4.p2.2.m2.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><apply id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.1.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p2.2.m2.1.1.2.cmml" xref="S2.SS4.p2.2.m2.1.1.2">ℒ</ci><ci id="S2.SS4.p2.2.m2.1.1.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math> (Equation (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E15" title="In 2.3.1. Sequence-Item Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">15</span></a>)) and preference-semantic alignment loss <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S2.SS4.p2.3.m3.1"><semantics id="S2.SS4.p2.3.m3.1a"><msub id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.3.m3.1.1.2" xref="S2.SS4.p2.3.m3.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p2.3.m3.1.1.3" xref="S2.SS4.p2.3.m3.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><apply id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.3.m3.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p2.3.m3.1.1.2.cmml" xref="S2.SS4.p2.3.m3.1.1.2">ℒ</ci><ci id="S2.SS4.p2.3.m3.1.1.3.cmml" xref="S2.SS4.p2.3.m3.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math> (Equation (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E16" title="In 2.3.2. Preference-Semantic Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">16</span></a>)), while keeping all parameters of the generative recommender fixed.
The overall loss can be denoted as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx8">
<tbody id="S2.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{IT}}=\mathcal{L}_{\operatorname{SQ}}+%
\mu\mathcal{L}_{\operatorname{SIA}}+\lambda\mathcal{L}_{\operatorname{PSA}}," class="ltx_Math" display="inline" id="S2.E17.m1.1"><semantics id="S2.E17.m1.1a"><mrow id="S2.E17.m1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml"><mrow id="S2.E17.m1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml"><msub id="S2.E17.m1.1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1.2.2" xref="S2.E17.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S2.E17.m1.1.1.1.1.2.3" xref="S2.E17.m1.1.1.1.1.2.3.cmml">IT</mi></msub><mo id="S2.E17.m1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E17.m1.1.1.1.1.3" xref="S2.E17.m1.1.1.1.1.3.cmml"><msub id="S2.E17.m1.1.1.1.1.3.2" xref="S2.E17.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1.3.2.2" xref="S2.E17.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S2.E17.m1.1.1.1.1.3.2.3" xref="S2.E17.m1.1.1.1.1.3.2.3.cmml">SQ</mi></msub><mo id="S2.E17.m1.1.1.1.1.3.1" xref="S2.E17.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E17.m1.1.1.1.1.3.3" xref="S2.E17.m1.1.1.1.1.3.3.cmml"><mi id="S2.E17.m1.1.1.1.1.3.3.2" xref="S2.E17.m1.1.1.1.1.3.3.2.cmml">μ</mi><mo id="S2.E17.m1.1.1.1.1.3.3.1" xref="S2.E17.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E17.m1.1.1.1.1.3.3.3" xref="S2.E17.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1.3.3.3.2" xref="S2.E17.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S2.E17.m1.1.1.1.1.3.3.3.3" xref="S2.E17.m1.1.1.1.1.3.3.3.3.cmml">SIA</mi></msub></mrow><mo id="S2.E17.m1.1.1.1.1.3.1a" xref="S2.E17.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E17.m1.1.1.1.1.3.4" xref="S2.E17.m1.1.1.1.1.3.4.cmml"><mi id="S2.E17.m1.1.1.1.1.3.4.2" xref="S2.E17.m1.1.1.1.1.3.4.2.cmml">λ</mi><mo id="S2.E17.m1.1.1.1.1.3.4.1" xref="S2.E17.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S2.E17.m1.1.1.1.1.3.4.3" xref="S2.E17.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.1.1.1.1.3.4.3.2" xref="S2.E17.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S2.E17.m1.1.1.1.1.3.4.3.3" xref="S2.E17.m1.1.1.1.1.3.4.3.3.cmml">PSA</mi></msub></mrow></mrow></mrow><mo id="S2.E17.m1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.1b"><apply id="S2.E17.m1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1"><eq id="S2.E17.m1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1"></eq><apply id="S2.E17.m1.1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.2.1.cmml" xref="S2.E17.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.2.2.cmml" xref="S2.E17.m1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E17.m1.1.1.1.1.2.3.cmml" xref="S2.E17.m1.1.1.1.1.2.3">IT</ci></apply><apply id="S2.E17.m1.1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.1.3"><plus id="S2.E17.m1.1.1.1.1.3.1.cmml" xref="S2.E17.m1.1.1.1.1.3.1"></plus><apply id="S2.E17.m1.1.1.1.1.3.2.cmml" xref="S2.E17.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.3.2.1.cmml" xref="S2.E17.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.3.2.2.cmml" xref="S2.E17.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.E17.m1.1.1.1.1.3.2.3.cmml" xref="S2.E17.m1.1.1.1.1.3.2.3">SQ</ci></apply><apply id="S2.E17.m1.1.1.1.1.3.3.cmml" xref="S2.E17.m1.1.1.1.1.3.3"><times id="S2.E17.m1.1.1.1.1.3.3.1.cmml" xref="S2.E17.m1.1.1.1.1.3.3.1"></times><ci id="S2.E17.m1.1.1.1.1.3.3.2.cmml" xref="S2.E17.m1.1.1.1.1.3.3.2">𝜇</ci><apply id="S2.E17.m1.1.1.1.1.3.3.3.cmml" xref="S2.E17.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E17.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E17.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S2.E17.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E17.m1.1.1.1.1.3.3.3.3">SIA</ci></apply></apply><apply id="S2.E17.m1.1.1.1.1.3.4.cmml" xref="S2.E17.m1.1.1.1.1.3.4"><times id="S2.E17.m1.1.1.1.1.3.4.1.cmml" xref="S2.E17.m1.1.1.1.1.3.4.1"></times><ci id="S2.E17.m1.1.1.1.1.3.4.2.cmml" xref="S2.E17.m1.1.1.1.1.3.4.2">𝜆</ci><apply id="S2.E17.m1.1.1.1.1.3.4.3.cmml" xref="S2.E17.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.3.4.3.1.cmml" xref="S2.E17.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.3.4.3.2.cmml" xref="S2.E17.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S2.E17.m1.1.1.1.1.3.4.3.3.cmml" xref="S2.E17.m1.1.1.1.1.3.4.3.3">PSA</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.1c">\displaystyle\mathcal{L}_{\operatorname{IT}}=\mathcal{L}_{\operatorname{SQ}}+%
\mu\mathcal{L}_{\operatorname{SIA}}+\lambda\mathcal{L}_{\operatorname{PSA}},</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_IT end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_SQ end_POSTSUBSCRIPT + italic_μ caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT + italic_λ caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p2.5">where <math alttext="\mu" class="ltx_Math" display="inline" id="S2.SS4.p2.4.m1.1"><semantics id="S2.SS4.p2.4.m1.1a"><mi id="S2.SS4.p2.4.m1.1.1" xref="S2.SS4.p2.4.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m1.1b"><ci id="S2.SS4.p2.4.m1.1.1.cmml" xref="S2.SS4.p2.4.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.4.m1.1d">italic_μ</annotation></semantics></math> and <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS4.p2.5.m2.1"><semantics id="S2.SS4.p2.5.m2.1a"><mi id="S2.SS4.p2.5.m2.1.1" xref="S2.SS4.p2.5.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.5.m2.1b"><ci id="S2.SS4.p2.5.m2.1.1.cmml" xref="S2.SS4.p2.5.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.5.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.5.m2.1d">italic_λ</annotation></semantics></math> are hyperparameters for the trade-off of the alignment losses.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS4.p3.3.1">Generative Recommender Optimization.</span>
As for the generative recommender, we optimize it through the generative recommendation loss <math alttext="\mathcal{L}_{\operatorname{REC}}" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><msub id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3.cmml">REC</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2">ℒ</ci><ci id="S2.SS4.p3.1.m1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3">REC</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">\mathcal{L}_{\operatorname{REC}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_REC end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E13" title="In 2.2.2. Generative Recommender ‣ 2.2. Dual Encoder-Decoder Architecture ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">13</span></a>)), the above two alignment losses <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><msub id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p3.2.m2.1.1.2" xref="S2.SS4.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p3.2.m2.1.1.3" xref="S2.SS4.p3.2.m2.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><apply id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.2.m2.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p3.2.m2.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2">ℒ</ci><ci id="S2.SS4.p3.2.m2.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E15" title="In 2.3.1. Sequence-Item Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">15</span></a>)) and <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S2.SS4.p3.3.m3.1"><semantics id="S2.SS4.p3.3.m3.1a"><msub id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p3.3.m3.1.1.2" xref="S2.SS4.p3.3.m3.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p3.3.m3.1.1.3" xref="S2.SS4.p3.3.m3.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><apply id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.3.m3.1.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p3.3.m3.1.1.2.cmml" xref="S2.SS4.p3.3.m3.1.1.2">ℒ</ci><ci id="S2.SS4.p3.3.m3.1.1.3.cmml" xref="S2.SS4.p3.3.m3.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math> (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E16" title="In 2.3.2. Preference-Semantic Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">16</span></a>)), while freezing all parameters of the item tokenizer.
The optimization objective is:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx9">
<tbody id="S2.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\operatorname{GR}}=\mathcal{L}_{\operatorname{REC}}+%
\mu\mathcal{L}_{\operatorname{SIA}}+\lambda\mathcal{L}_{\operatorname{PSA}}." class="ltx_Math" display="inline" id="S2.E18.m1.1"><semantics id="S2.E18.m1.1a"><mrow id="S2.E18.m1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml"><mrow id="S2.E18.m1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml"><msub id="S2.E18.m1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.1.1.1.1.2.2" xref="S2.E18.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S2.E18.m1.1.1.1.1.2.3" xref="S2.E18.m1.1.1.1.1.2.3.cmml">GR</mi></msub><mo id="S2.E18.m1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E18.m1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.3.cmml"><msub id="S2.E18.m1.1.1.1.1.3.2" xref="S2.E18.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.1.1.1.1.3.2.2" xref="S2.E18.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S2.E18.m1.1.1.1.1.3.2.3" xref="S2.E18.m1.1.1.1.1.3.2.3.cmml">REC</mi></msub><mo id="S2.E18.m1.1.1.1.1.3.1" xref="S2.E18.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E18.m1.1.1.1.1.3.3" xref="S2.E18.m1.1.1.1.1.3.3.cmml"><mi id="S2.E18.m1.1.1.1.1.3.3.2" xref="S2.E18.m1.1.1.1.1.3.3.2.cmml">μ</mi><mo id="S2.E18.m1.1.1.1.1.3.3.1" xref="S2.E18.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E18.m1.1.1.1.1.3.3.3" xref="S2.E18.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.1.1.1.1.3.3.3.2" xref="S2.E18.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S2.E18.m1.1.1.1.1.3.3.3.3" xref="S2.E18.m1.1.1.1.1.3.3.3.3.cmml">SIA</mi></msub></mrow><mo id="S2.E18.m1.1.1.1.1.3.1a" xref="S2.E18.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E18.m1.1.1.1.1.3.4" xref="S2.E18.m1.1.1.1.1.3.4.cmml"><mi id="S2.E18.m1.1.1.1.1.3.4.2" xref="S2.E18.m1.1.1.1.1.3.4.2.cmml">λ</mi><mo id="S2.E18.m1.1.1.1.1.3.4.1" xref="S2.E18.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S2.E18.m1.1.1.1.1.3.4.3" xref="S2.E18.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.1.1.1.1.3.4.3.2" xref="S2.E18.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S2.E18.m1.1.1.1.1.3.4.3.3" xref="S2.E18.m1.1.1.1.1.3.4.3.3.cmml">PSA</mi></msub></mrow></mrow></mrow><mo id="S2.E18.m1.1.1.1.2" lspace="0em" xref="S2.E18.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m1.1b"><apply id="S2.E18.m1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1"><eq id="S2.E18.m1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1"></eq><apply id="S2.E18.m1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.2.1.cmml" xref="S2.E18.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.2.2.cmml" xref="S2.E18.m1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E18.m1.1.1.1.1.2.3.cmml" xref="S2.E18.m1.1.1.1.1.2.3">GR</ci></apply><apply id="S2.E18.m1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.3"><plus id="S2.E18.m1.1.1.1.1.3.1.cmml" xref="S2.E18.m1.1.1.1.1.3.1"></plus><apply id="S2.E18.m1.1.1.1.1.3.2.cmml" xref="S2.E18.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.3.2.1.cmml" xref="S2.E18.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.3.2.2.cmml" xref="S2.E18.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.E18.m1.1.1.1.1.3.2.3.cmml" xref="S2.E18.m1.1.1.1.1.3.2.3">REC</ci></apply><apply id="S2.E18.m1.1.1.1.1.3.3.cmml" xref="S2.E18.m1.1.1.1.1.3.3"><times id="S2.E18.m1.1.1.1.1.3.3.1.cmml" xref="S2.E18.m1.1.1.1.1.3.3.1"></times><ci id="S2.E18.m1.1.1.1.1.3.3.2.cmml" xref="S2.E18.m1.1.1.1.1.3.3.2">𝜇</ci><apply id="S2.E18.m1.1.1.1.1.3.3.3.cmml" xref="S2.E18.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E18.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E18.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S2.E18.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E18.m1.1.1.1.1.3.3.3.3">SIA</ci></apply></apply><apply id="S2.E18.m1.1.1.1.1.3.4.cmml" xref="S2.E18.m1.1.1.1.1.3.4"><times id="S2.E18.m1.1.1.1.1.3.4.1.cmml" xref="S2.E18.m1.1.1.1.1.3.4.1"></times><ci id="S2.E18.m1.1.1.1.1.3.4.2.cmml" xref="S2.E18.m1.1.1.1.1.3.4.2">𝜆</ci><apply id="S2.E18.m1.1.1.1.1.3.4.3.cmml" xref="S2.E18.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.3.4.3.1.cmml" xref="S2.E18.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.3.4.3.2.cmml" xref="S2.E18.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S2.E18.m1.1.1.1.1.3.4.3.3.cmml" xref="S2.E18.m1.1.1.1.1.3.4.3.3">PSA</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.1c">\displaystyle\mathcal{L}_{\operatorname{GR}}=\mathcal{L}_{\operatorname{REC}}+%
\mu\mathcal{L}_{\operatorname{SIA}}+\lambda\mathcal{L}_{\operatorname{PSA}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_GR end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_REC end_POSTSUBSCRIPT + italic_μ caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT + italic_λ caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.1">In general, we divide the training process into multiple cycles, each consisting of a fixed number of epochs.
In the first epoch of each cycle, we optimize the item tokenizer based on Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E17" title="In 2.4. Alternating Optimization ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">17</span></a>) to improve the quality of item representations by the generative recommender.
As for the rest epochs of each cycle, the item tokenizer is frozen and item tokens remain fixed during the generative recommender training process. This approach ensures stable optimization when conducting the recommendation-oriented alignment.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5. </span>Discussion</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">Recently, there have been notable advancements in generative recommendation models.
To highlight the innovations and distinctions of our proposed approach, we conduct a comparative analysis between ETEGRec and several typical generative recommendation models from two perspectives: item tokenization and generative recommendation, as presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.T1" title="Table 1 ‣ 2.5. Discussion ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S2.SS5.p2.1.1">Item tokenization</span> in current generative recommendation models can be broadly classified into two categories: heuristic methods and pre-learned methods <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>.
Heuristic methods, such as GPTRec <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>)</cite> and P5-CID <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite>, employ manually constructed user-item interaction matrix or item co-occurrence matrix to estimate similarity between items.
Although these methods are straightforward and efficient, they often fail to capture the profound semantic relevance between items.
As for pre-learned methods like TIGER and LETTER, they pre-learn a deep neural network as the item tokenizer (<em class="ltx_emph ltx_font_italic" id="S2.SS5.p2.1.2">e.g.,</em> autoencoder) to derive identifiers with implicit semantics.
However, these methods treat item tokenization as a preprocessing step, resulting in a <em class="ltx_emph ltx_font_italic" id="S2.SS5.p2.1.3">complete decoupling</em> of item tokenizer and generative recommender during model optimization.
In contrast, ETEGRec <em class="ltx_emph ltx_font_italic" id="S2.SS5.p2.1.4">integrates the tokenizer and recommender into an end-to-end framework</em> to address this decoupling problem and achieves mutual enhancement between the two components by proposing a recommendation-oriented alignment approach.
Furthermore, from the interaction-aware perspective, only GPTRec introduces interaction awareness through the user-item interaction matrix.
Different from them, ETEGRec aligns the past user interaction sequence and the target item from two different perspectives, thereby incorporating the preference information within user behaviors into the item tokenizer.</p>
</div>
<div class="ltx_para" id="S2.SS5.p3">
<p class="ltx_p" id="S2.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS5.p3.1.1">Generative recommendation</span> in existing methods typically processes user interaction sequences into corresponding token sequences in advance.
Such constant data suffer from <em class="ltx_emph ltx_font_italic" id="S2.SS5.p3.1.2">monotonous</em> sequence patterns, which brings the risk of overfitting.
In contrast, ETEGRec jointly optimizes the item tokenizer during model learning, resulting in <em class="ltx_emph ltx_font_italic" id="S2.SS5.p3.1.3">diverse</em> token sequences and <em class="ltx_emph ltx_font_italic" id="S2.SS5.p3.1.4">gradually refined</em> semantics.
The ablation experiment in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.SS3" title="3.3. Ablation Study ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a> confirmed that the continuous enhancement of token sequences significantly contributes to the performance.
Moreover, unlike existing methods that isolate the item tokenizer in generative recommendation, our approach further integrates and refines the prior knowledge implicit in item semantic embeddings from the item tokenizer.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>
Comparison of ETEGRec with several related studies on item Tokenization and generative recommendation.
“EL” means the length of item identifiers are equal. “IA” denotes interaction-aware. “TI” denotes tokenization integration.
</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S2.T1.1" style="width:433.6pt;height:100.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-54.6pt,12.7pt) scale(0.798689796315513,0.798689796315513) ;">
<table class="ltx_tabular ltx_align_middle" id="S2.T1.1.1">
<tr class="ltx_tr" id="S2.T1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S2.T1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S2.T1.1.1.1.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S2.T1.1.1.1.2">Item Tokenization</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S2.T1.1.1.1.3">Generative Recommendation</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.2.1">Learning</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.2.2">EL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.2.3">IA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.2.4">Token Sequence</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.2.5">TI</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.1.1.3.1">GPTRec <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.2">Heuristic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.3">✔</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.4">✔</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.5">Pre-processed</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.4">
<td class="ltx_td ltx_align_left" id="S2.T1.1.1.4.1">P5-CID <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.2">Heuristic</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.3">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.4">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.5">Pre-processed</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.5">
<td class="ltx_td ltx_align_left" id="S2.T1.1.1.5.1">TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.2">Pre-learned</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.3">✔</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.4">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.5">Pre-processed</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.6">
<td class="ltx_td ltx_align_left" id="S2.T1.1.1.6.1">LETTER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.2">Pre-learned</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.3">✔</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.4">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.5">Pre-processed</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S2.T1.1.1.7.1">ETEGRec</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.7.2">End-to-end</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.7.3">✔</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.7.4">✔</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.7.5">Gradually Refined</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.7.6">✔</td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experiments</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we begin with the detailed experiment setup and then present overall performance and in-depth analysis of our proposed approach.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Experiment Setup</h3>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Dataset</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">We conduct experiments on three subsets of the most recent Amazon 2023 review data <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib9" title="">2024</a>)</cite> to evaluate our approach, including “<em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.1">Musical Instruments</em>”, “<em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.2">Video Games</em>”, and “<em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.3">Baby Products</em>”.
All these datasets comprise user review data from May 1996 to September 2023.
Following previous works <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib41" title="">2020</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib40" title="">2023</a>)</cite>, we apply the 5-core filter to exclude unpopular users and items with less than five interaction records.
Then, we construct user behavior sequences according to the chronological order and uniformly set the maximum item sequence length to 50.
The statistics of preprocessed datasets are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.T2" title="Table 2 ‣ 3.1.1. Dataset ‣ 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Statistics of the Datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tr class="ltx_tr" id="S3.T2.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.2">#Users</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.3">#Items</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.4">#Interactions</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.5">Density</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1">Instrument</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2">57,439</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.3">24,587</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.4">511,836</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.5">0.00036</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3">
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.1">Game</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.2">94,762</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3">25,612</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.4">814,586</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.5">0.00034</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.1">Baby</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.2">150,777</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.3">36,013</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.4">1,241,083</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.4.5">0.00023</td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>The overall performance comparisons between the baselines and ETEGRec. The best and second-best results are highlighted in bold and underlined font, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.1" style="width:433.6pt;height:94.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-424.8pt,92.2pt) scale(0.337900669446584,0.337900669446584) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T3.1.1">
<tr class="ltx_tr" id="S3.T3.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T3.1.1.2.1" rowspan="2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.2.1.1" style="font-size:207%;">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S3.T3.1.1.2.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.2.2.1" style="font-size:207%;">Instrument</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S3.T3.1.1.2.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.2.3.1" style="font-size:207%;">Baby</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T3.1.1.2.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.2.4.1" style="font-size:207%;">Game</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.1.1" style="font-size:207%;">Recall@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.2.1" style="font-size:207%;">Recall@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.3.1" style="font-size:207%;">NDCG@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.3.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.4.1" style="font-size:207%;">NDCG@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.5.1" style="font-size:207%;">Recall@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.6.1" style="font-size:207%;">Recall@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.7.1" style="font-size:207%;">NDCG@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.3.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.8.1" style="font-size:207%;">NDCG@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.9.1" style="font-size:207%;">Recall@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.10.1" style="font-size:207%;">Recall@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.11.1" style="font-size:207%;">NDCG@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.3.12.1" style="font-size:207%;">NDCG@10</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T3.1.1.4.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.1.1" style="font-size:207%;">Caser</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.2.1" style="font-size:207%;">0.0242</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.3.1" style="font-size:207%;">0.0392</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.4.1" style="font-size:207%;">0.0154</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.4.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.5.1" style="font-size:207%;">0.0202</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.6.1" style="font-size:207%;">0.0144</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.7.1" style="font-size:207%;">0.0254</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.8.1" style="font-size:207%;">0.0090</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.4.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.9.1" style="font-size:207%;">0.0125</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.10.1" style="font-size:207%;">0.0346</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.11.1" style="font-size:207%;">0.0567</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.12.1" style="font-size:207%;">0.0221</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.4.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.4.13.1" style="font-size:207%;">0.0291</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.5.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.1.1" style="font-size:207%;">GRU4Rec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.2.1" style="font-size:207%;">0.0345</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.3.1" style="font-size:207%;">0.0537</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.4.1" style="font-size:207%;">0.0220</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.5.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.5.1" style="font-size:207%;">0.0281</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.6.1" style="font-size:207%;">0.0219</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.7.1" style="font-size:207%;">0.0350</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.8.1" style="font-size:207%;">0.0142</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.5.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.9.1" style="font-size:207%;">0.0184</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.10.1" style="font-size:207%;">0.0522</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.11.1" style="font-size:207%;">0.0831</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.12.1" style="font-size:207%;">0.0337</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.5.13.1" style="font-size:207%;">0.0436</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.6.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.1.1" style="font-size:207%;">HGN</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.2.1" style="font-size:207%;">0.0319</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.3.1" style="font-size:207%;">0.0515</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.4.1" style="font-size:207%;">0.0202</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.6.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.5.1" style="font-size:207%;">0.0265</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.6.1" style="font-size:207%;">0.0181</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.7.1" style="font-size:207%;">0.0302</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.8.1" style="font-size:207%;">0.0117</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.6.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.9.1" style="font-size:207%;">0.0155</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.10.1" style="font-size:207%;">0.0423</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.11.1" style="font-size:207%;">0.0694</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.12.1" style="font-size:207%;">0.0266</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.6.13.1" style="font-size:207%;">0.0353</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.7.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.1.1" style="font-size:207%;">SASRec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.2.1" style="font-size:207%;">0.0341</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.3.1" style="font-size:207%;">0.0530</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.4.1" style="font-size:207%;">0.0217</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.7.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.5.1" style="font-size:207%;">0.0277</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.6.1" style="font-size:207%;">0.0218</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.7.1" style="font-size:207%;">0.0352</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.8.1" style="font-size:207%;">0.0135</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.7.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.9.1" style="font-size:207%;">0.0178</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.10.1" style="font-size:207%;">0.0517</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.11.1" style="font-size:207%;">0.0821</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.12.1" style="font-size:207%;">0.0329</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.7.13.1" style="font-size:207%;">0.0426</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.8.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.1.1" style="font-size:207%;">BERT4Rec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.2.1" style="font-size:207%;">0.0305</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.3.1" style="font-size:207%;">0.0483</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.4.1" style="font-size:207%;">0.0196</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.8.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.5.1" style="font-size:207%;">0.0253</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.6.1" style="font-size:207%;">0.0176</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.7.1" style="font-size:207%;">0.0289</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.8.1" style="font-size:207%;">0.0113</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.8.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.9.1" style="font-size:207%;">0.0149</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.10.1" style="font-size:207%;">0.0453</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.11.1" style="font-size:207%;">0.0716</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.12.1" style="font-size:207%;">0.0294</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.8.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.8.13.1" style="font-size:207%;">0.0378</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.9.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.1.1" style="font-size:207%;">FMLP-Rec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.2.1" style="font-size:207%;">0.0328</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.3.1" style="font-size:207%;">0.0529</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.4.1" style="font-size:207%;">0.0206</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.9.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.5.1" style="font-size:207%;">0.0271</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.6.1" style="font-size:207%;">0.0221</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.7.1" style="font-size:207%;">0.0353</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.8.1" style="font-size:207%;">0.0144</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.9.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.9.1" style="font-size:207%;">0.0186</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.10.1" style="font-size:207%;">0.0535</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.11.1" style="font-size:207%;">0.086</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.12.1" style="font-size:207%;">0.0331</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.9.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.9.13.1" style="font-size:207%;">0.0435</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.10.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.1.1" style="font-size:207%;">FDSA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.2.1" style="font-size:207%;">0.0364</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.3.1" style="font-size:207%;">0.0557</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.4.1" style="font-size:207%;">0.0233</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.10.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.5.1" style="font-size:207%;">0.0295</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.6.1" style="font-size:207%;">0.0217</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.7.1" style="font-size:207%;">0.0347</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.8.1" style="font-size:207%;">0.0141</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.10.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.9.1" style="font-size:207%;">0.0183</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.10.1" style="font-size:207%;">0.0548</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.11.1" style="font-size:207%;">0.0857</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.12.1" style="font-size:207%;">0.0353</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.10.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.10.13.1" style="font-size:207%;">0.0453</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.1.1" style="padding:2.05pt 2.3pt;">
<span class="ltx_text" id="S3.T3.1.1.1.1.1" style="font-size:207%;">S</span><sup class="ltx_sup" id="S3.T3.1.1.1.1.2"><span class="ltx_text" id="S3.T3.1.1.1.1.2.1" style="font-size:207%;">3</span></sup><span class="ltx_text" id="S3.T3.1.1.1.1.3" style="font-size:207%;">Rec</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.2.1" style="font-size:207%;">0.0298</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.3.1" style="font-size:207%;">0.0471</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.4.1" style="font-size:207%;">0.0189</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.1.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.5.1" style="font-size:207%;">0.0245</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.6.1" style="font-size:207%;">0.0204</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.7.1" style="font-size:207%;">0.0339</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.8.1" style="font-size:207%;">0.0133</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.1.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.9.1" style="font-size:207%;">0.0176</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.10.1" style="font-size:207%;">0.0533</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.11.1" style="font-size:207%;">0.0823</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.12.1" style="font-size:207%;">0.0351</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.1.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.1.13.1" style="font-size:207%;">0.0444</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T3.1.1.11.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.1.1" style="font-size:207%;">P5-CID</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.2.1" style="font-size:207%;">0.0352</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.3.1" style="font-size:207%;">0.0507</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.11.4.1" style="font-size:207%;">0.0234</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.11.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.5.1" style="font-size:207%;">0.0285</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.6.1" style="font-size:207%;">0.0216</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.7.1" style="font-size:207%;">0.0345</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.8.1" style="font-size:207%;">0.0141</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.11.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.9.1" style="font-size:207%;">0.0182</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.10.1" style="font-size:207%;">0.0554</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.11.1" style="font-size:207%;">0.0871</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.12.1" style="font-size:207%;">0.0355</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.11.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.11.13.1" style="font-size:207%;">0.0457</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.12.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.1.1" style="font-size:207%;">TIGER</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.2.1" style="font-size:207%;">0.0363</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.3.1" style="font-size:207%;">0.0565</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.12.4.1" style="font-size:207%;">0.0234</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.12.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.5.1" style="font-size:207%;">0.0299</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.6.1" style="font-size:207%;">0.0218</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.7.1" style="font-size:207%;">0.0349</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.8.1" style="font-size:207%;">0.0144</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.12.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.9.1" style="font-size:207%;">0.0186</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.10.1" style="font-size:207%;">0.0514</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.11.1" style="font-size:207%;">0.0809</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.12.1" style="font-size:207%;">0.0328</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.12.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.12.13.1" style="font-size:207%;">0.0422</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T3.1.1.13.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.13.1.1" style="font-size:207%;">TIGER-SAS</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.2.1" style="font-size:207%;">0.0364</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.3.1" style="font-size:207%;">0.0580</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.13.4.1" style="font-size:207%;">0.0233</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.13.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.5.1" style="font-size:207%;">0.0303</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.6.1" style="font-size:207%;">0.0233</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.7.1" style="font-size:207%;">0.0373</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.8.1" style="font-size:207%;">0.0149</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.13.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.9.1" style="font-size:207%;">0.0193</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.10.1" style="font-size:207%;">0.0558</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.11.1" style="font-size:207%;">0.0882</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.12.1" style="font-size:207%;">0.0357</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.13.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.13.13.1" style="font-size:207%;">0.0461</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.14">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.1.14.1" style="padding:2.05pt 2.3pt;"><span class="ltx_text" id="S3.T3.1.1.14.1.1" style="font-size:207%;">ETEGRec</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.2" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.2.1" style="font-size:207%;">0.0385</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.3" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.3.1" style="font-size:207%;">0.0606</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.4" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.4.1" style="font-size:207%;">0.0249</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.1.14.5" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.5.1" style="font-size:207%;">0.0321</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.6" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.6.1" style="font-size:207%;">0.0244</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.7" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.7.1" style="font-size:207%;">0.0389</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.8" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.8.1" style="font-size:207%;">0.0157</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.1.14.9" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.9.1" style="font-size:207%;">0.0204</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.10" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.10.1" style="font-size:207%;">0.0561</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.11" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.11.1" style="font-size:207%;">0.0891</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.12" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.12.1" style="font-size:207%;">0.0365</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.1.14.13" style="padding:2.05pt 2.3pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.14.13.1" style="font-size:207%;">0.0470</span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Baseline Models</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">The baseline models we adopt for comparison include the following two categories:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS2.p2">
<p class="ltx_p" id="S3.SS1.SSS2.p2.1">(1) <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS2.p2.1.1">Traditional sequential recommendation models</em>:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Caser</span> <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib27" title="">2018</a>)</cite> utilizes horizontal and vertical convolutional filters to model user behavior sequences.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">HGN</span> <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib16" title="">2019</a>)</cite> employs hierarchical gating networks to capture both long-term and short-term user interests from item sequences.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib8" title="">2016</a>)</cite> is an RNN-based sequential recommender that uses GRU for user behavior modeling.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib23" title="">2019</a>)</cite> introduces bidirectional Transformer and mask prediction tasks into sequential recommendation for user preference modeling.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i5.p1">
<p class="ltx_p" id="S3.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i5.p1.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>)</cite> adopts the unidirectional Transformer to model user behaviors and predict the next item.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i6.p1">
<p class="ltx_p" id="S3.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i6.p1.1.1">FMLP-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib42" title="">2022</a>)</cite> proposes an all-MLP sequential recommender with learnable filters, which can effectively reduce user behavior noise.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i7.p1">
<p class="ltx_p" id="S3.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i7.p1.1.1">FDSA</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib39" title="">2019</a>)</cite> emphasizes the transformation patterns between item features by separately modeling both item-level and feature-level sequences using self-attention networks.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i8.p1">
<p class="ltx_p" id="S3.I1.i8.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i8.p1.1.1">S<sup class="ltx_sup" id="S3.I1.i8.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="S3.I1.i8.p1.1.1.1.1">3</span></sup>-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib41" title="">2020</a>)</cite> incorporates mutual information maximization into sequential recommendation for model pre-training, learning the correlation between items and attributes to improve recommendation performance.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS1.SSS2.p2.2">(2) <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS2.p2.2.1">Generative recommendation models</em>:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">P5-CID</span> <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite> integrates collaborative knowledge into LLM-based generative recommender by generating item identifiers through spectral clustering on item co-occurrence graphs.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">TIGER</span> <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite> leverages text embedding to construct semantic IDs for items and adopts the generative retrieval paradigm for sequential recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.1.1">TIGER-SAS</span> <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite> uses the item embeddings from trained SASRec instead of text embeddings to construct semantic IDs, which enables item identifiers to imply collaborative prior knowledge.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span>Evaluation Settings</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.3">To evaluate the performance of various methods in sequential recommendation, we employ two widely used metrics: top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.1.m1.1"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.1.m1.1d">italic_K</annotation></semantics></math> Hit Ratio (HR) and top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.2.m2.1"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mi id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.2.m2.1d">italic_K</annotation></semantics></math> Normalized Discounted Cumulative Gain (NDCG), where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.3.m3.1"><semantics id="S3.SS1.SSS3.p1.3.m3.1a"><mi id="S3.SS1.SSS3.p1.3.m3.1.1" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.1b"><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.3.m3.1d">italic_K</annotation></semantics></math> is set to 5, and 10.
Following prior studies <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib41" title="">2020</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite>, we employ the <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS3.p1.3.1">leave-one-out</em> strategy to split training, validation, and test sets.
Specifically, for each user, the latest interaction is used as testing data, the second most recent interaction is validation data, and all other interaction records are used for training.
We conduct the full ranking evaluation over the entire item set to avoid bias introduced by sampling.
The beam size is uniformly set to 20 for all generative recommendation models.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span>Implementation Details</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.4">We obtain the 256-dimensional item collaborative semantic embeddings from a trained SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>)</cite>.
For the item tokenizer, the codebook number <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.1.m1.1"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.1.m1.1d">italic_L</annotation></semantics></math> is set to 4 and each codebook has <math alttext="K=256" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.2.m2.1"><semantics id="S3.SS1.SSS4.p1.2.m2.1a"><mrow id="S3.SS1.SSS4.p1.2.m2.1.1" xref="S3.SS1.SSS4.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS4.p1.2.m2.1.1.2" xref="S3.SS1.SSS4.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.SS1.SSS4.p1.2.m2.1.1.1" xref="S3.SS1.SSS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS4.p1.2.m2.1.1.3" xref="S3.SS1.SSS4.p1.2.m2.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.2.m2.1b"><apply id="S3.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1"><eq id="S3.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1.1"></eq><ci id="S3.SS1.SSS4.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1.2">𝐾</ci><cn id="S3.SS1.SSS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS4.p1.2.m2.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.2.m2.1c">K=256</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.2.m2.1d">italic_K = 256</annotation></semantics></math> code embeddings of dimension 256. For our generative recommender, we employ T5 with 4 encoder and decoder layers as the backbone, the hidden size and the dimension of FFN are set to 256 and 1536, respectively. Each layer has 6 self-attention heads of dimension 64. We use pre-trained RQ-VAE to initialize our item tokenizer and employ the AdamW optimizer with a learning rate of 5e-4 to train the entire framework. We begin by training the item tokenizer for 1 epoch, followed by training the generative recommender for 3 epochs, and repeat it until convergence based on the validation performance. The weight decay is tuned in {1e-3,1e-4}. The hyper-parameters <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.3.m3.1"><semantics id="S3.SS1.SSS4.p1.3.m3.1a"><mi id="S3.SS1.SSS4.p1.3.m3.1.1" xref="S3.SS1.SSS4.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.3.m3.1b"><ci id="S3.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS4.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.3.m3.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.3.m3.1d">italic_μ</annotation></semantics></math> is tuned in {5e-3,1e-3,5e-4,3e-4,1e-4} and <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.4.m4.1"><semantics id="S3.SS1.SSS4.p1.4.m4.1a"><mi id="S3.SS1.SSS4.p1.4.m4.1.1" xref="S3.SS1.SSS4.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.4.m4.1b"><ci id="S3.SS1.SSS4.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS4.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.4.m4.1d">italic_λ</annotation></semantics></math> is tuned in {1e-3,5e-4,3e-4,1e-4,5e-5}.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Overall Performance</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We evaluate ETEGRec on three public recommendation benchmarks. The overall results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.T3" title="Table 3 ‣ 3.1.1. Dataset ‣ 3.1. Experiment Setup ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, from which we have the following observations:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mo id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">∙</annotation></semantics></math> Among traditional sequential recommendation models, FDSA exhibits superior performance compared with others across three datasets, which is attributed to the utilization of additional textual feature embeddings. FMLP-Rec achieves comparable performance as SASRec and BERT4Rec which suggests that all-MLP architectures can also model the behavior sequence effectively.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mo id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">∙</annotation></semantics></math> For generative recommendation models, TIGER and TIGER-SAS consistently outperform P5-CID on three datasets, although P5-CID adopts the pretrained T5 model with more parameters. This is due to the different item tokenization methods of them.
P5-CID utilizes a heuristic tokenizer based on the item co-occurrence graph to construct item identifiers that can not capture the similarity between items effectively.
Instead, TIGER and TIGER-SAS learn hierarchical textual or collaborative semantics from coarse to fine via RQ-VAE, which is beneficial for recommendation.
TIGER-SAS performs better than TIGER on all datasets, suggesting that collaborative semantics is more important in the recommendation domain.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mo id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">∙</annotation></semantics></math> ETEGRec consistently achieves the best results on all datasets compared to the baseline methods, which demonstrates its effectiveness. We attribute the improvements to the mutual enhancement between the item tokenizer and the generative recommender through the recommendation-oriented alignment.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Ablation Study</h3>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Ablation study of ETEGRec. We assess the proposed two alignment objectives and the alternating training strategy.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.4" style="width:390.3pt;height:104.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.7pt,19.9pt) scale(0.723274460055545,0.723274460055545) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T4.4.4">
<tr class="ltx_tr" id="S3.T4.4.4.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.4.4.5.1" rowspan="2"><span class="ltx_text" id="S3.T4.4.4.5.1.1">Variants</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S3.T4.4.4.5.2">Instrument</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T4.4.4.5.3">Baby</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.1">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.2">Recall@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.3">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.4.4.6.4">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.5">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.6">Recall@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.7">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.6.8">NDCG@10</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.4.4.7.1">ETEGRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.2"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.2.1">0.0385</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.3"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.3.1">0.0606</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.4"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.4.1">0.0249</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.4.4.7.5"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.5.1">0.0321</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.6"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.6.1">0.0244</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.7"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.7.1">0.0389</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.8"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.8.1">0.0157</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.4.7.9"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.9.1">0.0204</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.1.1.1.1">    <em class="ltx_emph ltx_font_italic" id="S3.T4.1.1.1.1.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S3.T4.1.1.1.1.m1.1"><semantics id="S3.T4.1.1.1.1.m1.1a"><msub id="S3.T4.1.1.1.1.m1.1.1" xref="S3.T4.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T4.1.1.1.1.m1.1.1.2" xref="S3.T4.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T4.1.1.1.1.m1.1.1.3" xref="S3.T4.1.1.1.1.m1.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.1.m1.1b"><apply id="S3.T4.1.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.1.1.1.1.m1.1.1.1.cmml" xref="S3.T4.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T4.1.1.1.1.m1.1.1.2.cmml" xref="S3.T4.1.1.1.1.m1.1.1.2">ℒ</ci><ci id="S3.T4.1.1.1.1.m1.1.1.3.cmml" xref="S3.T4.1.1.1.1.m1.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.1.m1.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.1.1.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.2">0.0383</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.3">0.0602</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.4">0.0247</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.1.5">0.0318</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.6">0.0239</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.7">0.0380</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.8">0.0154</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.1.9">0.0200</td>
</tr>
<tr class="ltx_tr" id="S3.T4.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.2.2.2.1">    <em class="ltx_emph ltx_font_italic" id="S3.T4.2.2.2.1.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S3.T4.2.2.2.1.m1.1"><semantics id="S3.T4.2.2.2.1.m1.1a"><msub id="S3.T4.2.2.2.1.m1.1.1" xref="S3.T4.2.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T4.2.2.2.1.m1.1.1.2" xref="S3.T4.2.2.2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T4.2.2.2.1.m1.1.1.3" xref="S3.T4.2.2.2.1.m1.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T4.2.2.2.1.m1.1b"><apply id="S3.T4.2.2.2.1.m1.1.1.cmml" xref="S3.T4.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.2.2.2.1.m1.1.1.1.cmml" xref="S3.T4.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T4.2.2.2.1.m1.1.1.2.cmml" xref="S3.T4.2.2.2.1.m1.1.1.2">ℒ</ci><ci id="S3.T4.2.2.2.1.m1.1.1.3.cmml" xref="S3.T4.2.2.2.1.m1.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.2.2.1.m1.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.2.2.2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.2">0.0377</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.3">0.0596</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.4">0.0244</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.2.2.2.5">0.0315</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.6">0.0240</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.7">0.0383</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.8">0.0155</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.2.9">0.0202</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.4.4.4.2">    <em class="ltx_emph ltx_font_italic" id="S3.T4.4.4.4.2.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S3.T4.3.3.3.1.m1.1"><semantics id="S3.T4.3.3.3.1.m1.1a"><msub id="S3.T4.3.3.3.1.m1.1.1" xref="S3.T4.3.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T4.3.3.3.1.m1.1.1.2" xref="S3.T4.3.3.3.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T4.3.3.3.1.m1.1.1.3" xref="S3.T4.3.3.3.1.m1.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T4.3.3.3.1.m1.1b"><apply id="S3.T4.3.3.3.1.m1.1.1.cmml" xref="S3.T4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.3.3.3.1.m1.1.1.1.cmml" xref="S3.T4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T4.3.3.3.1.m1.1.1.2.cmml" xref="S3.T4.3.3.3.1.m1.1.1.2">ℒ</ci><ci id="S3.T4.3.3.3.1.m1.1.1.3.cmml" xref="S3.T4.3.3.3.1.m1.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.3.3.1.m1.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.3.3.3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math> &amp; <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S3.T4.4.4.4.2.m2.1"><semantics id="S3.T4.4.4.4.2.m2.1a"><msub id="S3.T4.4.4.4.2.m2.1.1" xref="S3.T4.4.4.4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T4.4.4.4.2.m2.1.1.2" xref="S3.T4.4.4.4.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.T4.4.4.4.2.m2.1.1.3" xref="S3.T4.4.4.4.2.m2.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T4.4.4.4.2.m2.1b"><apply id="S3.T4.4.4.4.2.m2.1.1.cmml" xref="S3.T4.4.4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T4.4.4.4.2.m2.1.1.1.cmml" xref="S3.T4.4.4.4.2.m2.1.1">subscript</csymbol><ci id="S3.T4.4.4.4.2.m2.1.1.2.cmml" xref="S3.T4.4.4.4.2.m2.1.1.2">ℒ</ci><ci id="S3.T4.4.4.4.2.m2.1.1.3.cmml" xref="S3.T4.4.4.4.2.m2.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.4.4.4.2.m2.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.4.4.4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.3">0.0370</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.4">0.0584</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.5">0.0240</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.4.4.4.6">0.0307</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.7">0.0237</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.8">0.0378</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.9">0.0152</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.10">0.0198</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.4.4.8.1">    <em class="ltx_emph ltx_font_italic" id="S3.T4.4.4.8.1.1">w/o</em> AT</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.2">0.0317</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.3">0.0456</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.4">0.0205</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.4.4.8.5">0.0250</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.6">0.0165</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.7">0.0299</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.8">0.0083</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8.9">0.0141</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.9">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T4.4.4.9.1">    <em class="ltx_emph ltx_font_italic" id="S3.T4.4.4.9.1.1">w/o</em> ETE</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.2">0.0372</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.3">0.0582</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.4">0.0238</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.4.4.9.5">0.0305</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.6">0.0233</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.7">0.0380</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.8">0.0150</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.4.4.9.9">0.0197</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In order to evaluate the impact of the proposed techniques in ETEGRec, we conduct an ablation study on Instrument and Baby datasets. The performance of the four variants is depicted in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.T4" title="Table 4 ‣ 3.3. Ablation Study ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.2"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mo id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.p2.2.1"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.2.1.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.1.m1.1"><semantics id="S3.SS3.p2.2.1.m1.1a"><msub id="S3.SS3.p2.2.1.m1.1.1" xref="S3.SS3.p2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.1.m1.1.1.2" xref="S3.SS3.p2.2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p2.2.1.m1.1.1.3" xref="S3.SS3.p2.2.1.m1.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.1.m1.1b"><apply id="S3.SS3.p2.2.1.m1.1.1.cmml" xref="S3.SS3.p2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS3.p2.2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.2.1.m1.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.1.m1.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math></span> without the sequence-item alignment (SIA) (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E15" title="In 2.3.1. Sequence-Item Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">15</span></a>)). We can see that this variant performs worse than ETEGRec across all datasets, which indicates that alignment between sequence representation and item representation in the codebook space is beneficial for generative recommendation.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.2"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mo id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.p3.2.1"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p3.2.1.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.1.m1.1"><semantics id="S3.SS3.p3.2.1.m1.1a"><msub id="S3.SS3.p3.2.1.m1.1.1" xref="S3.SS3.p3.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.1.m1.1.1.2" xref="S3.SS3.p3.2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p3.2.1.m1.1.1.3" xref="S3.SS3.p3.2.1.m1.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.1.m1.1b"><apply id="S3.SS3.p3.2.1.m1.1.1.cmml" xref="S3.SS3.p3.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.1.m1.1.1.1.cmml" xref="S3.SS3.p3.2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.1.m1.1.1.2.cmml" xref="S3.SS3.p3.2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS3.p3.2.1.m1.1.1.3.cmml" xref="S3.SS3.p3.2.1.m1.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.1.m1.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math></span> removes the preference-semantic alignment (PSA) (Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S2.E16" title="In 2.3.2. Preference-Semantic Alignment ‣ 2.3. Recommendation-oriented Alignment ‣ 2. Methodology ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">16</span></a>)), which also brings a performance degrade.
The phenomenon demonstrates the effectiveness of the proposed PSA loss, which can enhance user preference modeling.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.5"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mo id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.p4.3.2"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p4.3.2.1">w/o</em> <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.1.m1.1"><semantics id="S3.SS3.p4.2.1.m1.1a"><msub id="S3.SS3.p4.2.1.m1.1.1" xref="S3.SS3.p4.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.2.1.m1.1.1.2" xref="S3.SS3.p4.2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p4.2.1.m1.1.1.3" xref="S3.SS3.p4.2.1.m1.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.1.m1.1b"><apply id="S3.SS3.p4.2.1.m1.1.1.cmml" xref="S3.SS3.p4.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.1.m1.1.1.1.cmml" xref="S3.SS3.p4.2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.1.m1.1.1.2.cmml" xref="S3.SS3.p4.2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS3.p4.2.1.m1.1.1.3.cmml" xref="S3.SS3.p4.2.1.m1.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.1.m1.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math> &amp; <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S3.SS3.p4.3.2.m2.1"><semantics id="S3.SS3.p4.3.2.m2.1a"><msub id="S3.SS3.p4.3.2.m2.1.1" xref="S3.SS3.p4.3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.3.2.m2.1.1.2" xref="S3.SS3.p4.3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p4.3.2.m2.1.1.3" xref="S3.SS3.p4.3.2.m2.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.2.m2.1b"><apply id="S3.SS3.p4.3.2.m2.1.1.cmml" xref="S3.SS3.p4.3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.2.m2.1.1.1.cmml" xref="S3.SS3.p4.3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.3.2.m2.1.1.2.cmml" xref="S3.SS3.p4.3.2.m2.1.1.2">ℒ</ci><ci id="S3.SS3.p4.3.2.m2.1.1.3.cmml" xref="S3.SS3.p4.3.2.m2.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.2.m2.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math></span> without both <math alttext="\mathcal{L}_{\operatorname{SIA}}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m2.1"><semantics id="S3.SS3.p4.4.m2.1a"><msub id="S3.SS3.p4.4.m2.1.1" xref="S3.SS3.p4.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.4.m2.1.1.2" xref="S3.SS3.p4.4.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p4.4.m2.1.1.3" xref="S3.SS3.p4.4.m2.1.1.3.cmml">SIA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m2.1b"><apply id="S3.SS3.p4.4.m2.1.1.cmml" xref="S3.SS3.p4.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m2.1.1.1.cmml" xref="S3.SS3.p4.4.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m2.1.1.2.cmml" xref="S3.SS3.p4.4.m2.1.1.2">ℒ</ci><ci id="S3.SS3.p4.4.m2.1.1.3.cmml" xref="S3.SS3.p4.4.m2.1.1.3">SIA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m2.1c">\mathcal{L}_{\operatorname{SIA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m2.1d">caligraphic_L start_POSTSUBSCRIPT roman_SIA end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\operatorname{PSA}}" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m3.1"><semantics id="S3.SS3.p4.5.m3.1a"><msub id="S3.SS3.p4.5.m3.1.1" xref="S3.SS3.p4.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.5.m3.1.1.2" xref="S3.SS3.p4.5.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p4.5.m3.1.1.3" xref="S3.SS3.p4.5.m3.1.1.3.cmml">PSA</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m3.1b"><apply id="S3.SS3.p4.5.m3.1.1.cmml" xref="S3.SS3.p4.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m3.1.1.1.cmml" xref="S3.SS3.p4.5.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m3.1.1.2.cmml" xref="S3.SS3.p4.5.m3.1.1.2">ℒ</ci><ci id="S3.SS3.p4.5.m3.1.1.3.cmml" xref="S3.SS3.p4.5.m3.1.1.3">PSA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m3.1c">\mathcal{L}_{\operatorname{PSA}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m3.1d">caligraphic_L start_POSTSUBSCRIPT roman_PSA end_POSTSUBSCRIPT</annotation></semantics></math>.
The variant lacking both alignments performs worse than removing just one. These results show that both sequence-item alignment and preference-semantic alignment positively contribute to generative recommendation, with their combination leading to improved performance.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mo id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.p5.1.1"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p5.1.1.1">w/o</em> AT</span> directly jointly learns all involved optimization objectives in our framework.
We can find that omitting the alternating training strategy from ETEGRec leads to a significant performance decline.
This result suggests that frequent updates to the item tokenizer during training adversely affect the recommender’s training.
By employing alternating training, we achieve stable and effective training for both components while maintaining collaborative alignment within them.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><mo id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.p6.1.1"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p6.1.1.1">w/o</em> ETE</span> bypasses the end-to-end optimization process and instead leverages the final item tokens obtained by our ETEGRec to retrain a generative recommender.
From the results, it can be seen that the improvement of ETEGRec is not only due to superior item identifiers but also attributed to the integration of prior knowledge encoded in the item tokenizer with the generative recommender.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Further Analysis</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="361" id="S3.F2.g1" src="x2.png" width="805"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Performance comparison on seen and unseen users.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1. </span>Generalizability Evaluation</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.1">To assess the generalizability of ETEGRec, we evaluate its recommendation performance on new users who are unseen during training.
We construct a new training set by removing the interaction sequences of some users from the training set, and obtain a test set containing both seen and unseen users.
Specifically, we select the 5% of users with the least interaction history on Instrument and Baby datasets treated as new users, and then evaluate the recommendation performance for both seen and unseen users.
From Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.F2" title="Figure 2 ‣ 3.4. Further Analysis ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, it is evident that ETEGRec outperforms TIGER-SAS and TIGER on both seen and unseen users.
This indicates that ETEGRec processes a more robust ability to model users’ preferences through the alignment between item tokenizer and generative recommender.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="324" id="S3.F3.g1" src="x3.png" width="789"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="324" id="S3.F3.g2" src="x4.png" width="789"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Performance comparison of different alignment loss coefficients.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2. </span>Hyper-Parameter Analysis</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.10">For sequence-item alignment, we investigate it by varying the coefficient <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.1.m1.1"><semantics id="S3.SS4.SSS2.p1.1.m1.1a"><mi id="S3.SS4.SSS2.p1.1.m1.1.1" xref="S3.SS4.SSS2.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.1.m1.1b"><ci id="S3.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.1.m1.1d">italic_μ</annotation></semantics></math> from 1e-4 to 5e-3.
As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.F3" title="Figure 3 ‣ 3.4.1. Generalizability Evaluation ‣ 3.4. Further Analysis ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, increasing <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.2.m2.1"><semantics id="S3.SS4.SSS2.p1.2.m2.1a"><mi id="S3.SS4.SSS2.p1.2.m2.1.1" xref="S3.SS4.SSS2.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.2.m2.1b"><ci id="S3.SS4.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.2.m2.1d">italic_μ</annotation></semantics></math> beyond this optimal range could interfere with model learning and adversely affect performance. The optimal results are achieved with <math alttext="\mu=\text{3e-4}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.3.m3.1"><semantics id="S3.SS4.SSS2.p1.3.m3.1a"><mrow id="S3.SS4.SSS2.p1.3.m3.1.1" xref="S3.SS4.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS2.p1.3.m3.1.1.2" xref="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml">μ</mi><mo id="S3.SS4.SSS2.p1.3.m3.1.1.1" xref="S3.SS4.SSS2.p1.3.m3.1.1.1.cmml">=</mo><mtext id="S3.SS4.SSS2.p1.3.m3.1.1.3" xref="S3.SS4.SSS2.p1.3.m3.1.1.3a.cmml">3e-4</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.3.m3.1b"><apply id="S3.SS4.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"><eq id="S3.SS4.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.2">𝜇</ci><ci id="S3.SS4.SSS2.p1.3.m3.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.3"><mtext id="S3.SS4.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.3">3e-4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.3.m3.1c">\mu=\text{3e-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.3.m3.1d">italic_μ = 3e-4</annotation></semantics></math> for the Instrument dataset and <math alttext="\mu=\text{3e-4}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.4.m4.1"><semantics id="S3.SS4.SSS2.p1.4.m4.1a"><mrow id="S3.SS4.SSS2.p1.4.m4.1.1" xref="S3.SS4.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS4.SSS2.p1.4.m4.1.1.2" xref="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml">μ</mi><mo id="S3.SS4.SSS2.p1.4.m4.1.1.1" xref="S3.SS4.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mtext id="S3.SS4.SSS2.p1.4.m4.1.1.3" xref="S3.SS4.SSS2.p1.4.m4.1.1.3a.cmml">3e-4</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.4.m4.1b"><apply id="S3.SS4.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1"><eq id="S3.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.2">𝜇</ci><ci id="S3.SS4.SSS2.p1.4.m4.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3"><mtext id="S3.SS4.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3">3e-4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.4.m4.1c">\mu=\text{3e-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.4.m4.1d">italic_μ = 3e-4</annotation></semantics></math> for the Baby dataset.
To explore the influence of preference-semantic alignment, we tune <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.5.m5.1"><semantics id="S3.SS4.SSS2.p1.5.m5.1a"><mi id="S3.SS4.SSS2.p1.5.m5.1.1" xref="S3.SS4.SSS2.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.5.m5.1b"><ci id="S3.SS4.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.5.m5.1d">italic_λ</annotation></semantics></math> within the range {5e-5, 1e-4, 3e-4, 5e-4, 1e-3} and observe similar trends to those seen with <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.6.m6.1"><semantics id="S3.SS4.SSS2.p1.6.m6.1a"><mi id="S3.SS4.SSS2.p1.6.m6.1.1" xref="S3.SS4.SSS2.p1.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.6.m6.1b"><ci id="S3.SS4.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS2.p1.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.6.m6.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.6.m6.1d">italic_μ</annotation></semantics></math>, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#S3.F3" title="Figure 3 ‣ 3.4.1. Generalizability Evaluation ‣ 3.4. Further Analysis ‣ 3. Experiments ‣ End-to-End Learnable Item Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.
ETEGRec yields suboptimal performance at too large <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.7.m7.1"><semantics id="S3.SS4.SSS2.p1.7.m7.1a"><mi id="S3.SS4.SSS2.p1.7.m7.1.1" xref="S3.SS4.SSS2.p1.7.m7.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.7.m7.1b"><ci id="S3.SS4.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m7.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.7.m7.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.7.m7.1d">italic_λ</annotation></semantics></math>. In contrast, very small values of <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.8.m8.1"><semantics id="S3.SS4.SSS2.p1.8.m8.1a"><mi id="S3.SS4.SSS2.p1.8.m8.1.1" xref="S3.SS4.SSS2.p1.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.8.m8.1b"><ci id="S3.SS4.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.8.m8.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.8.m8.1d">italic_λ</annotation></semantics></math> lead to limited improvements due to insufficient alignment.
ETEGRec performs best on Instrument when <math alttext="\lambda=\text{1e-4}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.9.m9.1"><semantics id="S3.SS4.SSS2.p1.9.m9.1a"><mrow id="S3.SS4.SSS2.p1.9.m9.1.1" xref="S3.SS4.SSS2.p1.9.m9.1.1.cmml"><mi id="S3.SS4.SSS2.p1.9.m9.1.1.2" xref="S3.SS4.SSS2.p1.9.m9.1.1.2.cmml">λ</mi><mo id="S3.SS4.SSS2.p1.9.m9.1.1.1" xref="S3.SS4.SSS2.p1.9.m9.1.1.1.cmml">=</mo><mtext id="S3.SS4.SSS2.p1.9.m9.1.1.3" xref="S3.SS4.SSS2.p1.9.m9.1.1.3a.cmml">1e-4</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.9.m9.1b"><apply id="S3.SS4.SSS2.p1.9.m9.1.1.cmml" xref="S3.SS4.SSS2.p1.9.m9.1.1"><eq id="S3.SS4.SSS2.p1.9.m9.1.1.1.cmml" xref="S3.SS4.SSS2.p1.9.m9.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.9.m9.1.1.2.cmml" xref="S3.SS4.SSS2.p1.9.m9.1.1.2">𝜆</ci><ci id="S3.SS4.SSS2.p1.9.m9.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.9.m9.1.1.3"><mtext id="S3.SS4.SSS2.p1.9.m9.1.1.3.cmml" xref="S3.SS4.SSS2.p1.9.m9.1.1.3">1e-4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.9.m9.1c">\lambda=\text{1e-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.9.m9.1d">italic_λ = 1e-4</annotation></semantics></math> and on Baby when <math alttext="\lambda=\text{5e-5}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.10.m10.1"><semantics id="S3.SS4.SSS2.p1.10.m10.1a"><mrow id="S3.SS4.SSS2.p1.10.m10.1.1" xref="S3.SS4.SSS2.p1.10.m10.1.1.cmml"><mi id="S3.SS4.SSS2.p1.10.m10.1.1.2" xref="S3.SS4.SSS2.p1.10.m10.1.1.2.cmml">λ</mi><mo id="S3.SS4.SSS2.p1.10.m10.1.1.1" xref="S3.SS4.SSS2.p1.10.m10.1.1.1.cmml">=</mo><mtext id="S3.SS4.SSS2.p1.10.m10.1.1.3" xref="S3.SS4.SSS2.p1.10.m10.1.1.3a.cmml">5e-5</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.10.m10.1b"><apply id="S3.SS4.SSS2.p1.10.m10.1.1.cmml" xref="S3.SS4.SSS2.p1.10.m10.1.1"><eq id="S3.SS4.SSS2.p1.10.m10.1.1.1.cmml" xref="S3.SS4.SSS2.p1.10.m10.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.10.m10.1.1.2.cmml" xref="S3.SS4.SSS2.p1.10.m10.1.1.2">𝜆</ci><ci id="S3.SS4.SSS2.p1.10.m10.1.1.3a.cmml" xref="S3.SS4.SSS2.p1.10.m10.1.1.3"><mtext id="S3.SS4.SSS2.p1.10.m10.1.1.3.cmml" xref="S3.SS4.SSS2.p1.10.m10.1.1.3">5e-5</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.10.m10.1c">\lambda=\text{5e-5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.10.m10.1d">italic_λ = 5e-5</annotation></semantics></math>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Related Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this paper, we review the related work in two major aspects.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Sequential Recommendation.</span>
Sequential recommendation aims to predict the next item a user may interact with based on the user’s historical behavior sequences.
Early studies <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib21" title="">2010</a>)</cite> primarily adhere to the Markov Chain assumption and focus on estimating the transition matrix.
With the development of neural networks, various model architectures, such as Recurrent Neural Networks (RNN) <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib8" title="">2016</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib26" title="">2016</a>)</cite>, Convolutional Neural Networks (CNN) <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib27" title="">2018</a>)</cite> and Graph Neural Networks (GNN) <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib2" title="">2021</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib34" title="">2019</a>)</cite>, are applied for sequential recommendation.
Recently, Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib29" title="">2017</a>)</cite>-based recommendation models <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib23" title="">2019</a>; Hao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib6" title="">2023</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib41" title="">2020</a>)</cite> have achieved great success for effective sequential user modeling. SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib11" title="">2018</a>)</cite> utilizes Transformer decoder with unidirectional self-attention to capture user preference.
BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib23" title="">2019</a>)</cite> proposes to encode the sequence by bidirectional attention and adopts the mask prediction task for training.
S<sup class="ltx_sup" id="S4.p2.1.2">3</sup>Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib41" title="">2020</a>)</cite> explores using the intrinsic data correlation as supervised signals to pre-train the sequential model for better user and item representations.
Furthermore, several works exploit the abundant textual features of users and items to  <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib39" title="">2019</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib35" title="">2022</a>)</cite> enrich the user and item representations. In this work, we focus on exploring the generative paradigm for sequential recommendation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Generative Recommendation</span>.
Nowadays, generative recommendation has emerged as a next-generation paradigm for recommendation systems.
In such a generative paradigm, the item sequence is tokenized into a token sequence and then fed into generative models to predict the tokens of the target item autoregressively.
Generally, the generative paradigm can be considered as two main processes, <em class="ltx_emph ltx_font_italic" id="S4.p3.1.2">i.e.,</em> item tokenization and generative recommendation.
Existing approaches for item tokenization can be broadly categorized into parameter-free methods <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>; Yue et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib37" title="">2023</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib25" title="">2024</a>; Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>)</cite>, and deep learning methods based on multi-level vector quantization (VQ) <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib32" title="">2024c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib31" title="">b</a>; Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib18" title="">2024</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite>.
For parameter-free methods, some studies, <em class="ltx_emph ltx_font_italic" id="S4.p3.1.3">e.g.,</em> P5-CID <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib10" title="">2023</a>)</cite> and GPTRec <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib17" title="">2023</a>)</cite>, apply matrix factorization to the co-occurrence matrix to derive item identifiers.
Other works like SEATER <cite class="ltx_cite ltx_citemacro_citep">(Si et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib22" title="">2023</a>)</cite> and EAGER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib33" title="">2024d</a>)</cite> employ clustering of item embeddings to construct identifiers hierarchically. In addition, there are also some attempts <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib13" title="">2023b</a>; Di Palma, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib3" title="">2023</a>; Harte et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib7" title="">2023</a>; Yue et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib37" title="">2023</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib25" title="">2024</a>)</cite> to use the textual metadata attached to items, <em class="ltx_emph ltx_font_italic" id="S4.p3.1.4">e.g.,</em> titles and descriptions, as identifiers. While these non-parametric methods are highly efficient, they often suffer from length bias and fail to capture deeper collaborative relationships among items. Deep learning methods based on multi-level VQ instead develop more expressive item identifiers with equal length via the Deep Neural Networks (DNN). For instance, TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib20" title="">2023</a>)</cite> uses RQ-VAE to learn the codebooks. LETTER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.05546v1#bib.bib30" title="">2024a</a>)</cite> proposes to align quantized embeddings in RQ-VAE with collaborative embeddings to leverage both collaborative and semantic information.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">Reviewing the existing works on generative recommendation, we found that most of them treat item tokenization and generative recommendation as two independent stages which may not be optimal for generative recommendation. In contrast, in this work, we achieved integration between item tokenization and generative recommendation via a recommendation-oriented alignment for superior recommendation performance.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we proposed ETEGRec, a novel end-to-end generative recommender with recommendation-oriented alignment. Different from previous methods decoupling item tokenization and generative recommendation, ETEGRec seamlessly integrated the item tokenizer and the generative recommender to build a fully end-to-end generative recommendation framework. We further designed a recommendation-oriented alignment approach, comprising <em class="ltx_emph ltx_font_italic" id="S5.p1.1.1">sequence-item alignment</em> and <em class="ltx_emph ltx_font_italic" id="S5.p1.1.2">preference-semantic alignment</em>, to achieve mutual enhancement of the two components from two different perspectives. To enable effective end-to-end learning, we further proposed an alternating optimization strategy for joint component learning. Extensive experiments and in-depth analysis on three benchmarks have demonstrated the superiority of our proposed framework, ETEGRec, compared to both traditional sequential recommendation models and generative recommendation baselines. In future work, we will transfer the joint tokenization method to other generative recommendation architectures, and also explore the scaling effect when increasing the model parameters.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chen Gao,
Yu Zheng, Yiqun Hui,
Yanan Niu, Yang Song,
Depeng Jin, and Yong Li.
2021.

</span>
<span class="ltx_bibblock">Sequential Recommendation with Graph Neural
Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">SIGIR ’21: The 44th International
ACM SIGIR Conference on Research and Development in Information
Retrieval, Virtual Event, Canada, July 11-15, 2021</em>,
Fernando Diaz, Chirag
Shah, Torsten Suel, Pablo Castells,
Rosie Jones, and Tetsuya Sakai (Eds.).
ACM, 378–387.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3404835.3462968" title="">https://doi.org/10.1145/3404835.3462968</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Di Palma (2023)</span>
<span class="ltx_bibblock">
Dario Di Palma.
2023.

</span>
<span class="ltx_bibblock">Retrieval-augmented Recommender System: Enhancing
Recommender Systems with Large Language Models. In
<em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 17th ACM Conference on
Recommender Systems, RecSys 2023, Singapore, Singapore, September 18-22,
2023</em>, Jie Zhang,
Li Chen, Shlomo Berkovsky,
Min Zhang, Tommaso Di Noia,
Justin Basilico, Luiz Pizzato, and
Yang Song (Eds.). ACM,
1369–1373.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3608889" title="">https://doi.org/10.1145/3604915.3608889</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang
Liu, Zuohui Fu, Yingqiang Ge, and
Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as Language Processing (RLP): A
Unified Pretrain, Personalized Prompt &amp; Predict Paradigm (P5). In
<em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">RecSys ’22: Sixteenth ACM Conference on
Recommender Systems, Seattle, WA, USA, September 18 - 23, 2022</em>,
Jennifer Golbeck,
F. Maxwell Harper, Vanessa Murdock,
Michael D. Ekstrand, Bracha Shapira,
Justin Basilico, Keld T. Lundgaard, and
Even Oldridge (Eds.). ACM,
299–315.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3523227.3546767" title="">https://doi.org/10.1145/3523227.3546767</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gutmann and Hyvärinen (2010)</span>
<span class="ltx_bibblock">
Michael Gutmann and Aapo
Hyvärinen. 2010.

</span>
<span class="ltx_bibblock">Noise-contrastive estimation: A new estimation
principle for unnormalized statistical models. In
<em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the Thirteenth International
Conference on Artificial Intelligence and Statistics, AISTATS 2010, Chia
Laguna Resort, Sardinia, Italy, May 13-15, 2010</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib5.2.2">(JMLR Proceedings, Vol. 9)</em>,
Yee Whye Teh and
D. Mike Titterington (Eds.).
JMLR.org, 297–304.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v9/gutmann10a.html" title="">http://proceedings.mlr.press/v9/gutmann10a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yongjing Hao, Tingting
Zhang, Pengpeng Zhao, Yanchi Liu,
Victor S. Sheng, Jiajie Xu,
Guanfeng Liu, and Xiaofang Zhou.
2023.

</span>
<span class="ltx_bibblock">Feature-Level Deeper Self-Attention Network With
Contrastive Learning for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">IEEE Trans. Knowl. Data Eng.</em>
35, 10 (2023),
10112–10124.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TKDE.2023.3250463" title="">https://doi.org/10.1109/TKDE.2023.3250463</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harte et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jesse Harte, Wouter
Zorgdrager, Panos Louridas, Asterios
Katsifodimos, Dietmar Jannach, and
Marios Fragkoulis. 2023.

</span>
<span class="ltx_bibblock">Leveraging Large Language Models for Sequential
Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 17th ACM
Conference on Recommender Systems, RecSys 2023, Singapore, Singapore,
September 18-22, 2023</em>, Jie Zhang,
Li Chen, Shlomo Berkovsky,
Min Zhang, Tommaso Di Noia,
Justin Basilico, Luiz Pizzato, and
Yang Song (Eds.). ACM,
1096–1102.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3610639" title="">https://doi.org/10.1145/3604915.3610639</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Balázs Hidasi,
Alexandros Karatzoglou, Linas Baltrunas,
and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural
Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">4th International Conference on
Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016,
Conference Track Proceedings</em>, Yoshua
Bengio and Yann LeCun (Eds.).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1511.06939" title="">http://arxiv.org/abs/1511.06939</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Jiacheng Li,
Zhankui He, An Yan,
Xiusi Chen, and Julian J. McAuley.
2024.

</span>
<span class="ltx_bibblock">Bridging Language and Items for Retrieval and
Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">CoRR</em> abs/2403.03952
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2403.03952" title="">https://doi.org/10.48550/ARXIV.2403.03952</a>
arXiv:2403.03952

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Shuyuan Xu,
Yingqiang Ge, and Yongfeng Zhang.
2023.

</span>
<span class="ltx_bibblock">How to Index Item IDs for Recommendation Foundation
Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Annual International ACM SIGIR
Conference on Research and Development in Information Retrieval in the Asia
Pacific Region, SIGIR-AP 2023, Beijing, China, November 26-28, 2023</em>,
Qingyao Ai, Yiqin Liu,
Alistair Moffat, Xuanjing Huang,
Tetsuya Sakai, and Justin Zobel
(Eds.). ACM, 195–204.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3624918.3625339" title="">https://doi.org/10.1145/3624918.3625339</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and
Julian J. McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IEEE International Conference on Data Mining,
ICDM 2018, Singapore, November 17-20, 2018</em>. IEEE
Computer Society, 197–206.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICDM.2018.00035" title="">https://doi.org/10.1109/ICDM.2018.00035</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Juntao Li, Zecheng Tang,
Yuyang Ding, Pinzheng Wang,
Pei Guo, Wangjie You,
Dan Qiao, Wenliang Chen,
Guohong Fu, Qiaoming Zhu,
Guodong Zhou, and Min Zhang.
2023a.

</span>
<span class="ltx_bibblock">OpenBA: An Open-sourced 15B Bilingual Asymmetric
seq2seq Model Pre-trained from Scratch.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">CoRR</em> abs/2309.10706
(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2309.10706" title="">https://doi.org/10.48550/ARXIV.2309.10706</a>
arXiv:2309.10706

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Jinming Li, Wentao Zhang,
Tian Wang, Guanglei Xiong,
Alan Lu, and Gerard Medioni.
2023b.

</span>
<span class="ltx_bibblock">GPT4Rec: A Generative Framework for Personalized
Recommendation and User Interests Interpretation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 2023 SIGIR Workshop on
eCommerce co-located with the 46th International ACM SIGIR Conference on
Research and Development in Information Retrieval (SIGIR 2023), Taipei,
Taiwan, July 27, 2023</em> <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.2">(CEUR Workshop Proceedings,
Vol. 3589)</em>, Surya
Kallumadi, Yubin Kim, Tracy Holloway
King, Shervin Malmasi, Maarten de Rijke,
and Jacopo Tagliabue (Eds.).
CEUR-WS.org.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ceur-ws.org/Vol-3589/paper_2.pdf" title="">https://ceur-ws.org/Vol-3589/paper_2.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Han Liu, Yinwei Wei,
Xuemeng Song, Weili Guan,
Yuan-Fang Li, and Liqiang Nie.
2024b.

</span>
<span class="ltx_bibblock">MMGRec: Multimodal Generative Recommendation with
Transformer Model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">CoRR</em> abs/2404.16555
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2404.16555" title="">https://doi.org/10.48550/ARXIV.2404.16555</a>
arXiv:2404.16555

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Zihan Liu, Yupeng Hou,
and Julian J. McAuley. 2024a.

</span>
<span class="ltx_bibblock">Multi-Behavior Generative Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">CoRR</em> abs/2405.16871
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2405.16871" title="">https://doi.org/10.48550/ARXIV.2405.16871</a>
arXiv:2405.16871

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chen Ma, Peng Kang, and
Xue Liu. 2019.

</span>
<span class="ltx_bibblock">Hierarchical Gating Networks for Sequential
Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 25th ACM
SIGKDD International Conference on Knowledge Discovery &amp; Data Mining,
KDD 2019, Anchorage, AK, USA, August 4-8, 2019</em>,
Ankur Teredesai, Vipin
Kumar, Ying Li, Rómer Rosales,
Evimaria Terzi, and George Karypis
(Eds.). ACM, 825–833.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3292500.3330984" title="">https://doi.org/10.1145/3292500.3330984</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2023)</span>
<span class="ltx_bibblock">
Aleksandr V. Petrov and
Craig Macdonald. 2023.

</span>
<span class="ltx_bibblock">Generative Sequential Recommendation with GPTRec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">CoRR</em> abs/2306.11114
(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2306.11114" title="">https://doi.org/10.48550/ARXIV.2306.11114</a>
arXiv:2306.11114

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Haohao Qu, Wenqi Fan,
Zihuai Zhao, and Qing Li.
2024.

</span>
<span class="ltx_bibblock">TokenRec: Learning to Tokenize ID for LLM-based
Generative Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">CoRR</em> abs/2406.10450
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2406.10450" title="">https://doi.org/10.48550/ARXIV.2406.10450</a>
arXiv:2406.10450

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam
Shazeer, Adam Roberts, Katherine Lee,
Sharan Narang, Michael Matena,
Yanqi Zhou, Wei Li, and
Peter J. Liu. 2020.

</span>
<span class="ltx_bibblock">Exploring the Limits of Transfer Learning with a
Unified Text-to-Text Transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">J. Mach. Learn. Res.</em> 21
(2020), 140:1–140:67.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v21/20-074.html" title="">http://jmlr.org/papers/v21/20-074.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil
Mehta, Anima Singh, Raghunandan Hulikal
Keshavan, Trung Vu, Lukasz Heldt,
Lichan Hong, Yi Tay,
Vinh Q. Tran, Jonah Samost,
Maciej Kula, Ed H. Chi, and
Mahesh Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Recommender Systems with Generative Retrieval. In
<em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Advances in Neural Information Processing Systems
36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS
2023, New Orleans, LA, USA, December 10 - 16, 2023</em>,
Alice Oh, Tristan
Naumann, Amir Globerson, Kate Saenko,
Moritz Hardt, and Sergey Levine
(Eds.).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2023/hash/20dcab0f14046a5c6b02b61da9f13229-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2023/hash/20dcab0f14046a5c6b02b61da9f13229-Abstract-Conference.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph
Freudenthaler, and Lars Schmidt-Thieme.
2010.

</span>
<span class="ltx_bibblock">Factorizing personalized Markov chains for
next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the
19th International Conference on World Wide Web, WWW 2010, Raleigh, North
Carolina, USA, April 26-30, 2010</em>,
Michael Rappa, Paul
Jones, Juliana Freire, and Soumen
Chakrabarti (Eds.). ACM, 811–820.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1772690.1772773" title="">https://doi.org/10.1145/1772690.1772773</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Si et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zihua Si, Zhongxiang Sun,
Jiale Chen, Guozhang Chen,
Xiaoxue Zang, Kai Zheng,
Yang Song, Xiao Zhang, and
Jun Xu. 2023.

</span>
<span class="ltx_bibblock">Generative Retrieval with Semantic Tree-Structured
Item Identifiers via Contrastive Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">CoRR</em> abs/2309.13375
(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2309.13375" title="">https://doi.org/10.48550/ARXIV.2309.13375</a>
arXiv:2309.13375

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu,
Jian Wu, Changhua Pei,
Xiao Lin, Wenwu Ou, and
Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with
Bidirectional Encoder Representations from Transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 28th ACM International
Conference on Information and Knowledge Management, CIKM 2019, Beijing,
China, November 3-7, 2019</em>, Wenwu Zhu,
Dacheng Tao, Xueqi Cheng,
Peng Cui, Elke A. Rundensteiner,
David Carmel, Qi He, and
Jeffrey Xu Yu (Eds.). ACM,
1441–1450.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3357384.3357895" title="">https://doi.org/10.1145/3357384.3357895</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Weiwei Sun, Lingyong Yan,
Zheng Chen, Shuaiqiang Wang,
Haichao Zhu, Pengjie Ren,
Zhumin Chen, Dawei Yin,
Maarten de Rijke, and Zhaochun Ren.
2023.

</span>
<span class="ltx_bibblock">Learning to Tokenize for Generative Retrieval. In
<em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Advances in Neural Information Processing Systems
36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS
2023, New Orleans, LA, USA, December 10 - 16, 2023</em>,
Alice Oh, Tristan
Naumann, Amir Globerson, Kate Saenko,
Moritz Hardt, and Sergey Levine
(Eds.).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2023/hash/91228b942a4528cdae031c1b68b127e8-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2023/hash/91228b942a4528cdae031c1b68b127e8-Abstract-Conference.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Juntao Tan, Shuyuan Xu,
Wenyue Hua, Yingqiang Ge,
Zelong Li, and Yongfeng Zhang.
2024.

</span>
<span class="ltx_bibblock">IDGenRec: LLM-RecSys Alignment with Textual ID
Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 47th International
ACM SIGIR Conference on Research and Development in Information
Retrieval, SIGIR 2024, Washington DC, USA, July 14-18, 2024</em>,
Grace Hui Yang, Hongning
Wang, Sam Han, Claudia Hauff,
Guido Zuccon, and Yi Zhang (Eds.).
ACM, 355–364.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3626772.3657821" title="">https://doi.org/10.1145/3626772.3657821</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yong Kiam Tan, Xinxing
Xu, and Yong Liu. 2016.

</span>
<span class="ltx_bibblock">Improved Recurrent Neural Networks for
Session-based Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of
the 1st Workshop on Deep Learning for Recommender Systems, DLRS@RecSys 2016,
Boston, MA, USA, September 15, 2016</em>,
Alexandros Karatzoglou,
Balázs Hidasi, Domonkos Tikk,
Oren Sar Shalom, Haggai Roitman,
Bracha Shapira, and Lior Rokach
(Eds.). ACM, 17–22.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2988450.2988452" title="">https://doi.org/10.1145/2988450.2988452</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke
Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via
Convolutional Sequence Embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings
of the Eleventh ACM International Conference on Web Search and Data Mining,
WSDM 2018, Marina Del Rey, CA, USA, February 5-9, 2018</em>,
Yi Chang, Chengxiang
Zhai, Yan Liu, and Yoelle Maarek
(Eds.). ACM, 565–573.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3159652.3159656" title="">https://doi.org/10.1145/3159652.3159656</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Aäron van den Oord,
Oriol Vinyals, and Koray Kavukcuoglu.
2017.

</span>
<span class="ltx_bibblock">Neural Discrete Representation Learning. In
<em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Advances in Neural Information Processing Systems
30: Annual Conference on Neural Information Processing Systems 2017, December
4-9, 2017, Long Beach, CA, USA</em>,
Isabelle Guyon, Ulrike
von Luxburg, Samy Bengio, Hanna M.
Wallach, Rob Fergus, S. V. N.
Vishwanathan, and Roman Garnett (Eds.).
6306–6315.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2017/hash/7a98af17e63a0ac09ce2e96d03992fbc-Abstract.html" title="">https://proceedings.neurips.cc/paper/2017/hash/7a98af17e63a0ac09ce2e96d03992fbc-Abstract.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N. Gomez,
Lukasz Kaiser, and Illia Polosukhin.
2017.

</span>
<span class="ltx_bibblock">Attention is All you Need. In
<em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Advances in Neural Information Processing Systems
30: Annual Conference on Neural Information Processing Systems 2017, December
4-9, 2017, Long Beach, CA, USA</em>,
Isabelle Guyon, Ulrike
von Luxburg, Samy Bengio, Hanna M.
Wallach, Rob Fergus, S. V. N.
Vishwanathan, and Roman Garnett (Eds.).
5998–6008.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="">https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Wenjie Wang, Honghui Bao,
Xilin Chen, Jizhi Zhang,
Yongqi Li, Fuli Feng,
See-Kiong Ng, and Tat-Seng Chua.
2024a.

</span>
<span class="ltx_bibblock">Learnable Tokenizer for LLM-based Generative
Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">CoRR</em> abs/2405.07314
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2405.07314" title="">https://doi.org/10.48550/ARXIV.2405.07314</a>
arXiv:2405.07314

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Wenjie Wang, Honghui Bao,
Xilin Chen, Jizhi Zhang,
Yongqi Li, Fuli Feng,
See-Kiong Ng, and Tat-Seng Chua.
2024b.

</span>
<span class="ltx_bibblock">Learnable Tokenizer for LLM-based Generative
Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">CoRR</em> abs/2405.07314
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2405.07314" title="">https://doi.org/10.48550/ARXIV.2405.07314</a>
arXiv:2405.07314

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2024c)</span>
<span class="ltx_bibblock">
Yidan Wang, Zhaochun Ren,
Weiwei Sun, Jiyuan Yang,
Zhixiang Liang, Xin Chen,
Ruobing Xie, Su Yan, Xu
Zhang, Pengjie Ren, Zhumin Chen, and
Xin Xin. 2024c.

</span>
<span class="ltx_bibblock">Enhanced Generative Recommendation via Content and
Collaboration Integration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">CoRR</em> abs/2403.18480
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2403.18480" title="">https://doi.org/10.48550/ARXIV.2403.18480</a>
arXiv:2403.18480

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2024d)</span>
<span class="ltx_bibblock">
Ye Wang, Jiahao Xun,
Mingjie Hong, Jieming Zhu,
Tao Jin, Wang Lin,
Haoyuan Li, Linjun Li,
Yan Xia, Zhou Zhao, and
Zhenhua Dong. 2024d.

</span>
<span class="ltx_bibblock">EAGER: Two-Stream Generative Recommender with
Behavior-Semantic Collaboration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">CoRR</em> abs/2406.14017
(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2406.14017" title="">https://doi.org/10.48550/ARXIV.2406.14017</a>
arXiv:2406.14017

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang,
Yanqiao Zhu, Liang Wang,
Xing Xie, and Tieniu Tan.
2019.

</span>
<span class="ltx_bibblock">Session-Based Recommendation with Graph Neural
Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">The Thirty-Third AAAI Conference on
Artificial Intelligence, AAAI 2019, The Thirty-First Innovative
Applications of Artificial Intelligence Conference, IAAI 2019, The Ninth
AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI
2019, Honolulu, Hawaii, USA, January 27 - February 1, 2019</em>.
AAAI Press, 346–353.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1609/AAAI.V33I01.3301346" title="">https://doi.org/10.1609/AAAI.V33I01.3301346</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yueqi Xie, Peilin Zhou,
and Sunghun Kim. 2022.

</span>
<span class="ltx_bibblock">Decoupled Side Information Fusion for Sequential
Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">SIGIR ’22: The 45th
International ACM SIGIR Conference on Research and Development in
Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>,
Enrique Amigó,
Pablo Castells, Julio Gonzalo,
Ben Carterette, J. Shane Culpepper, and
Gabriella Kazai (Eds.). ACM,
1611–1621.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3477495.3531963" title="">https://doi.org/10.1145/3477495.3531963</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Tianchi Yang, Minghui
Song, Zihan Zhang, Haizhen Huang,
Weiwei Deng, Feng Sun, and
Qi Zhang. 2023.

</span>
<span class="ltx_bibblock">Auto Search Indexer for End-to-End Document
Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Findings of the Association for
Computational Linguistics: EMNLP 2023, Singapore, December 6-10, 2023</em>,
Houda Bouamor, Juan
Pino, and Kalika Bali (Eds.).
Association for Computational Linguistics,
6955–6970.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/V1/2023.FINDINGS-EMNLP.464" title="">https://doi.org/10.18653/V1/2023.FINDINGS-EMNLP.464</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Sara Rabhi,
Gabriel de Souza Pereira Moreira, Dong
Wang, and Even Oldridge.
2023.

</span>
<span class="ltx_bibblock">LlamaRec: Two-Stage Recommendation using Large
Language Models for Ranking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">CoRR</em> abs/2311.02089
(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2311.02089" title="">https://doi.org/10.48550/ARXIV.2311.02089</a>
arXiv:2311.02089

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro
Luebs, Ahmed Omran, Jan Skoglund, and
Marco Tagliasacchi. 2022.

</span>
<span class="ltx_bibblock">SoundStream: An End-to-End Neural Audio Codec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">IEEE ACM Trans. Audio Speech Lang.
Process.</em> 30 (2022),
495–507.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TASLP.2021.3129994" title="">https://doi.org/10.1109/TASLP.2021.3129994</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tingting Zhang, Pengpeng
Zhao, Yanchi Liu, Victor S. Sheng,
Jiajie Xu, Deqing Wang,
Guanfeng Liu, and Xiaofang Zhou.
2019.

</span>
<span class="ltx_bibblock">Feature-level Deeper Self-Attention Network for
Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the
Twenty-Eighth International Joint Conference on Artificial Intelligence,
IJCAI 2019, Macao, China, August 10-16, 2019</em>,
Sarit Kraus (Ed.).
ijcai.org, 4320–4326.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.24963/IJCAI.2019/600" title="">https://doi.org/10.24963/IJCAI.2019/600</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou,
Hongyu Lu, Yu Chen,
Wayne Xin Zhao, Ming Chen, and
Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">Adapting Large Language Models by Integrating
Collaborative Semantics for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">CoRR</em> abs/2311.09049
(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/ARXIV.2311.09049" title="">https://doi.org/10.48550/ARXIV.2311.09049</a>
arXiv:2311.09049

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang,
Wayne Xin Zhao, Yutao Zhu,
Sirui Wang, Fuzheng Zhang,
Zhongyuan Wang, and Ji-Rong Wen.
2020.

</span>
<span class="ltx_bibblock">S3-Rec: Self-Supervised Learning for Sequential
Recommendation with Mutual Information Maximization. In
<em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">CIKM ’20: The 29th ACM International Conference
on Information and Knowledge Management, Virtual Event, Ireland, October
19-23, 2020</em>, Mathieu d’Aquin,
Stefan Dietze, Claudia Hauff,
Edward Curry, and Philippe
Cudré-Mauroux (Eds.). ACM,
1893–1902.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340531.3411954" title="">https://doi.org/10.1145/3340531.3411954</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu,
Wayne Xin Zhao, and Ji-Rong Wen.
2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is All You Need for
Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">WWW ’22: The ACM
Web Conference 2022, Virtual Event, Lyon, France, April 25 - 29, 2022</em>,
Frédérique Laforest,
Raphaël Troncy, Elena Simperl,
Deepak Agarwal, Aristides Gionis,
Ivan Herman, and Lionel Médini
(Eds.). ACM, 2388–2399.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3485447.3512111" title="">https://doi.org/10.1145/3485447.3512111</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  9 12:08:23 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
