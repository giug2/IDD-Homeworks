<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.19988] Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning</title><meta property="og:description" content="In this paper, we propose a novel method for enhancing security in privacy-preserving federated learning using the Vision Transformer. In federated learning, learning is performed by collecting updated information with…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.19988">

<!--Generated on Sat Oct  5 18:12:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Enhancing Security Using Random Binary Weights
<br class="ltx_break">in Privacy-Preserving Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.id1" class="ltx_ERROR undefined">\authorblockN</span>
Hiroto Sawada<span id="id2.2.id2" class="ltx_ERROR undefined">\authorrefmark</span>1,
Shoko Imaizumi<span id="id3.3.id3" class="ltx_ERROR undefined">\authorrefmark</span>2, and
Hitoshi Kiya<span id="id4.4.id4" class="ltx_ERROR undefined">\authorrefmark</span>3

<span id="id5.5.id5" class="ltx_ERROR undefined">\authorblockA</span>
<span id="id6.6.id6" class="ltx_ERROR undefined">\authorrefmark</span>1
Graduate School of Science and Engineering, Chiba University, Chiba, Japan
E-mail: 24wm3202@student.gs.chiba-u.jp 
<span id="id7.7.id7" class="ltx_ERROR undefined">\authorblockA</span>
<span id="id8.8.id8" class="ltx_ERROR undefined">\authorrefmark</span>2
Graduate School of Engineering, Chiba University, Chiba, Japan
E-mail: imaizumi@chiba-u.jp 
<span id="id9.9.id9" class="ltx_ERROR undefined">\authorblockA</span>
<span id="id10.10.id10" class="ltx_ERROR undefined">\authorrefmark</span>3
Faculty of System Design, Tokyo Metropolitan University, Tokyo, Japan
E-mail: kiya@tmu.ac.jp
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">In this paper, we propose a novel method for enhancing security in privacy-preserving federated learning using the Vision Transformer. In federated learning, learning is performed by collecting updated information without collecting raw data from each client. However, the problem is that this raw data may be inferred from the updated information.
Conventional data-guessing countermeasures (security enhancement methods) for addressing this issue have a trade-off relationship between privacy protection strength and learning efficiency, and they generally degrade model performance. In this paper, we propose a novel method of federated learning that does not degrade model performance and that is robust against data-guessing attacks on updated information. In the proposed method, each client independently prepares a sequence of binary (0 or 1) random numbers, multiplies it by the updated information, and sends it to a server for model learning. In experiments, the effectiveness of the proposed method is confirmed in terms of model performance and resistance to the APRIL (Attention PRIvacy Leakage) restoration attack.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The rapid development of AI technology has accelerated the growth of businesses and services that use deep learning.
However, training a model with many parameters requires a large amount of training data, and preparing this training data takes a lot of time and effort.
Additionally, we have to take into account the privacy information contained in the training data.
In addressing this issue, federated learning, which is a distributed learning method, has attracted much attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In federated learning, multiple parties cooperate for deep learning, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Here, we define a server as a party that provides a model and clients as parties that have training data.
Each client independently trains the model shared by the server using its own training data.
The clients send their updated information obtained through the training to the server, and the server integrates all the information to update the model.
As described above, federated learning can efficiently train high-performance models with a large number of parameters.
However, attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> have been proposed to infer training data on the basis of such updated information.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">For this reason, security enhancement methods have been actively researched to protect privacy against such attacks.
One method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> can compute in the encryption domain by using homomorphic cryptography <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> and retain accuracy; however, it is computationally expensive.
In another method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, updated information is concealed by combining model subsampling, model shuffling, and blanket noise.
The method is, however, vulnerable to collusion between a server and a party shuffling the model.
Consequently, this approach causes a reduction in accuracy.
There is a different type of method based on differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
In this type, each client adds a random number sequence following a specific distribution to the updated information.
To enhance security, however, the variance in the distribution has to be enlarged.
Thus, the model performance tends to decrease.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">There also exists research on the use of the Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> for federated learning.
ViT is an image classification model known for its high performance.
However, a gradient leakage attack called Attention Privacy Leakage (APRIL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, which attempts to recover training images on the basis of updated information for ViT, has become a serious problem.
Against APRIL, Aso et al. proposed an effective model encryption method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
This method maintains accuracy but does not possess resistance against attacks from internal parties such as clients.
Lu et al. locked the positional embedding layer of ViT to prevent it from being updated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
Although this method is robust against internal attacks, the performance is degraded when using a model without pre-training.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To tackle the above issue, we propose a novel security enhancement method for ViT-based federated learning without performance deterioration.
In the proposed method, each gradient of ViT is multiplied by random binary weights, and all parameters including those in the positional embedding layer can be updated.
Simulation results show the effectiveness of our method through an evaluation on the classification accuracy and resistance against APRIL.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2409.19988/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="248" height="118" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Overview of federated learning</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preparation</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We enhance security for federated learning with ViT, assuming APRIL as a gradient leakage attack.
In this section, we first give brief explanations of ViT and APRIL, and we then summarize several previous methods that have resistance against gradient leakage attacks.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Vision Transformer</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">ViT with self-attention mechanisms has attracted much attention for its high performance in the field of image recognition and classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
On the other hand, in the federated learning field, there have been studies on attacks targeting ViT, and a powerful restoration attack called APRIL has been proposed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.12" class="ltx_p">Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a><a href="#S2.F2" title="Figure 2 ‣ 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the procedure for ViT.
ViT first divides an input image <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="x\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">x</mi><mo id="S2.SS1.p2.1.m1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml"><mi id="S2.SS1.p2.1.m1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.1.m1.1.1.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.p2.1.m1.1.1.3.3.2" xref="S2.SS1.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p2.1.m1.1.1.3.3.1" xref="S2.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p2.1.m1.1.1.3.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p2.1.m1.1.1.3.3.1a" xref="S2.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p2.1.m1.1.1.3.3.4" xref="S2.SS1.p2.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><in id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1"></in><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝑥</ci><apply id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3"><times id="S2.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S2.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S2.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.3">𝑊</ci><ci id="S2.SS1.p2.1.m1.1.1.3.3.4.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">x\in\mathbb{R}^{H\times W\times C}</annotation></semantics></math> into patches <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="x_{p}^{s}\in\mathbb{R}^{P^{2}\times C}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><msubsup id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2.2.2" xref="S2.SS1.p2.2.m2.1.1.2.2.2.cmml">x</mi><mi id="S2.SS1.p2.2.m2.1.1.2.2.3" xref="S2.SS1.p2.2.m2.1.1.2.2.3.cmml">p</mi><mi id="S2.SS1.p2.2.m2.1.1.2.3" xref="S2.SS1.p2.2.m2.1.1.2.3.cmml">s</mi></msubsup><mo id="S2.SS1.p2.2.m2.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml"><mi id="S2.SS1.p2.2.m2.1.1.3.2" xref="S2.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.2.m2.1.1.3.3" xref="S2.SS1.p2.2.m2.1.1.3.3.cmml"><msup id="S2.SS1.p2.2.m2.1.1.3.3.2" xref="S2.SS1.p2.2.m2.1.1.3.3.2.cmml"><mi id="S2.SS1.p2.2.m2.1.1.3.3.2.2" xref="S2.SS1.p2.2.m2.1.1.3.3.2.2.cmml">P</mi><mn id="S2.SS1.p2.2.m2.1.1.3.3.2.3" xref="S2.SS1.p2.2.m2.1.1.3.3.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p2.2.m2.1.1.3.3.1" xref="S2.SS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p2.2.m2.1.1.3.3.3" xref="S2.SS1.p2.2.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><in id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1"></in><apply id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.2">superscript</csymbol><apply id="S2.SS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.2.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2.2.2">𝑥</ci><ci id="S2.SS1.p2.2.m2.1.1.2.2.3.cmml" xref="S2.SS1.p2.2.m2.1.1.2.2.3">𝑝</ci></apply><ci id="S2.SS1.p2.2.m2.1.1.2.3.cmml" xref="S2.SS1.p2.2.m2.1.1.2.3">𝑠</ci></apply><apply id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3"><times id="S2.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.1"></times><apply id="S2.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.2">superscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.2.2">𝑃</ci><cn type="integer" id="S2.SS1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.2.3">2</cn></apply><ci id="S2.SS1.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">x_{p}^{s}\in\mathbb{R}^{P^{2}\times C}</annotation></semantics></math>, where <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">H</annotation></semantics></math>, <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">W</annotation></semantics></math>, and <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">C</annotation></semantics></math> are the height, width, and number of channels.
<math id="S2.SS1.p2.6.m6.6" class="ltx_Math" alttext="S,s\in\{1,2,\cdots,S\}" display="inline"><semantics id="S2.SS1.p2.6.m6.6a"><mrow id="S2.SS1.p2.6.m6.6.7" xref="S2.SS1.p2.6.m6.6.7.cmml"><mrow id="S2.SS1.p2.6.m6.6.7.2.2" xref="S2.SS1.p2.6.m6.6.7.2.1.cmml"><mi id="S2.SS1.p2.6.m6.5.5" xref="S2.SS1.p2.6.m6.5.5.cmml">S</mi><mo id="S2.SS1.p2.6.m6.6.7.2.2.1" xref="S2.SS1.p2.6.m6.6.7.2.1.cmml">,</mo><mi id="S2.SS1.p2.6.m6.6.6" xref="S2.SS1.p2.6.m6.6.6.cmml">s</mi></mrow><mo id="S2.SS1.p2.6.m6.6.7.1" xref="S2.SS1.p2.6.m6.6.7.1.cmml">∈</mo><mrow id="S2.SS1.p2.6.m6.6.7.3.2" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml"><mo stretchy="false" id="S2.SS1.p2.6.m6.6.7.3.2.1" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml">{</mo><mn id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">1</mn><mo id="S2.SS1.p2.6.m6.6.7.3.2.2" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml">,</mo><mn id="S2.SS1.p2.6.m6.2.2" xref="S2.SS1.p2.6.m6.2.2.cmml">2</mn><mo id="S2.SS1.p2.6.m6.6.7.3.2.3" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p2.6.m6.3.3" xref="S2.SS1.p2.6.m6.3.3.cmml">⋯</mi><mo id="S2.SS1.p2.6.m6.6.7.3.2.4" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml">,</mo><mi id="S2.SS1.p2.6.m6.4.4" xref="S2.SS1.p2.6.m6.4.4.cmml">S</mi><mo stretchy="false" id="S2.SS1.p2.6.m6.6.7.3.2.5" xref="S2.SS1.p2.6.m6.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.6b"><apply id="S2.SS1.p2.6.m6.6.7.cmml" xref="S2.SS1.p2.6.m6.6.7"><in id="S2.SS1.p2.6.m6.6.7.1.cmml" xref="S2.SS1.p2.6.m6.6.7.1"></in><list id="S2.SS1.p2.6.m6.6.7.2.1.cmml" xref="S2.SS1.p2.6.m6.6.7.2.2"><ci id="S2.SS1.p2.6.m6.5.5.cmml" xref="S2.SS1.p2.6.m6.5.5">𝑆</ci><ci id="S2.SS1.p2.6.m6.6.6.cmml" xref="S2.SS1.p2.6.m6.6.6">𝑠</ci></list><set id="S2.SS1.p2.6.m6.6.7.3.1.cmml" xref="S2.SS1.p2.6.m6.6.7.3.2"><cn type="integer" id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">1</cn><cn type="integer" id="S2.SS1.p2.6.m6.2.2.cmml" xref="S2.SS1.p2.6.m6.2.2">2</cn><ci id="S2.SS1.p2.6.m6.3.3.cmml" xref="S2.SS1.p2.6.m6.3.3">⋯</ci><ci id="S2.SS1.p2.6.m6.4.4.cmml" xref="S2.SS1.p2.6.m6.4.4">𝑆</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.6c">S,s\in\{1,2,\cdots,S\}</annotation></semantics></math> and <math id="S2.SS1.p2.7.m7.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S2.SS1.p2.7.m7.1a"><mi id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">P</annotation></semantics></math> are the number of patches, the number assigned to a patch, and the height and width of a patch, respectively.
A linear layer <math id="S2.SS1.p2.8.m8.1" class="ltx_Math" alttext="E\in\mathbb{R}^{(P^{2}\times C)\times D}" display="inline"><semantics id="S2.SS1.p2.8.m8.1a"><mrow id="S2.SS1.p2.8.m8.1.2" xref="S2.SS1.p2.8.m8.1.2.cmml"><mi id="S2.SS1.p2.8.m8.1.2.2" xref="S2.SS1.p2.8.m8.1.2.2.cmml">E</mi><mo id="S2.SS1.p2.8.m8.1.2.1" xref="S2.SS1.p2.8.m8.1.2.1.cmml">∈</mo><msup id="S2.SS1.p2.8.m8.1.2.3" xref="S2.SS1.p2.8.m8.1.2.3.cmml"><mi id="S2.SS1.p2.8.m8.1.2.3.2" xref="S2.SS1.p2.8.m8.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.8.m8.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.cmml"><mrow id="S2.SS1.p2.8.m8.1.1.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.8.m8.1.1.1.1.1.2" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.8.m8.1.1.1.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.cmml"><msup id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.2" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.3" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p2.8.m8.1.1.1.1.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.1.cmml">×</mo><mi id="S2.SS1.p2.8.m8.1.1.1.1.1.1.3" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS1.p2.8.m8.1.1.1.1.1.3" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS1.p2.8.m8.1.1.1.2" xref="S2.SS1.p2.8.m8.1.1.1.2.cmml">×</mo><mi id="S2.SS1.p2.8.m8.1.1.1.3" xref="S2.SS1.p2.8.m8.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.2.cmml" xref="S2.SS1.p2.8.m8.1.2"><in id="S2.SS1.p2.8.m8.1.2.1.cmml" xref="S2.SS1.p2.8.m8.1.2.1"></in><ci id="S2.SS1.p2.8.m8.1.2.2.cmml" xref="S2.SS1.p2.8.m8.1.2.2">𝐸</ci><apply id="S2.SS1.p2.8.m8.1.2.3.cmml" xref="S2.SS1.p2.8.m8.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.2.3.1.cmml" xref="S2.SS1.p2.8.m8.1.2.3">superscript</csymbol><ci id="S2.SS1.p2.8.m8.1.2.3.2.cmml" xref="S2.SS1.p2.8.m8.1.2.3.2">ℝ</ci><apply id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1"><times id="S2.SS1.p2.8.m8.1.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.1.2"></times><apply id="S2.SS1.p2.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1"><times id="S2.SS1.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.1"></times><apply id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.2">𝑃</ci><cn type="integer" id="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S2.SS1.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.1.1.1.1.3">𝐶</ci></apply><ci id="S2.SS1.p2.8.m8.1.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">E\in\mathbb{R}^{(P^{2}\times C)\times D}</annotation></semantics></math> then dimensionally transforms each patch to be adequate for the Transformer encoder layer.
Note that <math id="S2.SS1.p2.9.m9.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS1.p2.9.m9.1a"><mi id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><ci id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">D</annotation></semantics></math> represents the vector length after embedding.
In addition, a class token <math id="S2.SS1.p2.10.m10.1" class="ltx_Math" alttext="x_{class}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS1.p2.10.m10.1a"><mrow id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml"><msub id="S2.SS1.p2.10.m10.1.1.2" xref="S2.SS1.p2.10.m10.1.1.2.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2.2" xref="S2.SS1.p2.10.m10.1.1.2.2.cmml">x</mi><mrow id="S2.SS1.p2.10.m10.1.1.2.3" xref="S2.SS1.p2.10.m10.1.1.2.3.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2.3.2" xref="S2.SS1.p2.10.m10.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.1.1.2.3.1" xref="S2.SS1.p2.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.1.1.2.3.3" xref="S2.SS1.p2.10.m10.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.1.1.2.3.1a" xref="S2.SS1.p2.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.1.1.2.3.4" xref="S2.SS1.p2.10.m10.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.1.1.2.3.1b" xref="S2.SS1.p2.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.1.1.2.3.5" xref="S2.SS1.p2.10.m10.1.1.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.1.1.2.3.1c" xref="S2.SS1.p2.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.1.1.2.3.6" xref="S2.SS1.p2.10.m10.1.1.2.3.6.cmml">s</mi></mrow></msub><mo id="S2.SS1.p2.10.m10.1.1.1" xref="S2.SS1.p2.10.m10.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.10.m10.1.1.3" xref="S2.SS1.p2.10.m10.1.1.3.cmml"><mi id="S2.SS1.p2.10.m10.1.1.3.2" xref="S2.SS1.p2.10.m10.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p2.10.m10.1.1.3.3" xref="S2.SS1.p2.10.m10.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><apply id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1"><in id="S2.SS1.p2.10.m10.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1.1"></in><apply id="S2.SS1.p2.10.m10.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.2.1.cmml" xref="S2.SS1.p2.10.m10.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.2.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2.2">𝑥</ci><apply id="S2.SS1.p2.10.m10.1.1.2.3.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3"><times id="S2.SS1.p2.10.m10.1.1.2.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.1"></times><ci id="S2.SS1.p2.10.m10.1.1.2.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.2">𝑐</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.3">𝑙</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.4.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.4">𝑎</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.5.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.5">𝑠</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.6.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3.6">𝑠</ci></apply></apply><apply id="S2.SS1.p2.10.m10.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.3.1.cmml" xref="S2.SS1.p2.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.3.2.cmml" xref="S2.SS1.p2.10.m10.1.1.3.2">ℝ</ci><ci id="S2.SS1.p2.10.m10.1.1.3.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">x_{class}\in\mathbb{R}^{D}</annotation></semantics></math> is set at the beginning of the patches to represent the features of the entire image.
Next, the positional embedding layer <math id="S2.SS1.p2.11.m11.1" class="ltx_Math" alttext="E_{pos}\in\mathbb{R}^{(S+1)\times D}" display="inline"><semantics id="S2.SS1.p2.11.m11.1a"><mrow id="S2.SS1.p2.11.m11.1.2" xref="S2.SS1.p2.11.m11.1.2.cmml"><msub id="S2.SS1.p2.11.m11.1.2.2" xref="S2.SS1.p2.11.m11.1.2.2.cmml"><mi id="S2.SS1.p2.11.m11.1.2.2.2" xref="S2.SS1.p2.11.m11.1.2.2.2.cmml">E</mi><mrow id="S2.SS1.p2.11.m11.1.2.2.3" xref="S2.SS1.p2.11.m11.1.2.2.3.cmml"><mi id="S2.SS1.p2.11.m11.1.2.2.3.2" xref="S2.SS1.p2.11.m11.1.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.11.m11.1.2.2.3.1" xref="S2.SS1.p2.11.m11.1.2.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.11.m11.1.2.2.3.3" xref="S2.SS1.p2.11.m11.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.11.m11.1.2.2.3.1a" xref="S2.SS1.p2.11.m11.1.2.2.3.1.cmml">​</mo><mi id="S2.SS1.p2.11.m11.1.2.2.3.4" xref="S2.SS1.p2.11.m11.1.2.2.3.4.cmml">s</mi></mrow></msub><mo id="S2.SS1.p2.11.m11.1.2.1" xref="S2.SS1.p2.11.m11.1.2.1.cmml">∈</mo><msup id="S2.SS1.p2.11.m11.1.2.3" xref="S2.SS1.p2.11.m11.1.2.3.cmml"><mi id="S2.SS1.p2.11.m11.1.2.3.2" xref="S2.SS1.p2.11.m11.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.11.m11.1.1.1" xref="S2.SS1.p2.11.m11.1.1.1.cmml"><mrow id="S2.SS1.p2.11.m11.1.1.1.1.1" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.11.m11.1.1.1.1.1.2" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.11.m11.1.1.1.1.1.1" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.11.m11.1.1.1.1.1.1.2" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.2.cmml">S</mi><mo id="S2.SS1.p2.11.m11.1.1.1.1.1.1.1" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.11.m11.1.1.1.1.1.1.3" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS1.p2.11.m11.1.1.1.1.1.3" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS1.p2.11.m11.1.1.1.2" xref="S2.SS1.p2.11.m11.1.1.1.2.cmml">×</mo><mi id="S2.SS1.p2.11.m11.1.1.1.3" xref="S2.SS1.p2.11.m11.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m11.1b"><apply id="S2.SS1.p2.11.m11.1.2.cmml" xref="S2.SS1.p2.11.m11.1.2"><in id="S2.SS1.p2.11.m11.1.2.1.cmml" xref="S2.SS1.p2.11.m11.1.2.1"></in><apply id="S2.SS1.p2.11.m11.1.2.2.cmml" xref="S2.SS1.p2.11.m11.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.1.2.2.1.cmml" xref="S2.SS1.p2.11.m11.1.2.2">subscript</csymbol><ci id="S2.SS1.p2.11.m11.1.2.2.2.cmml" xref="S2.SS1.p2.11.m11.1.2.2.2">𝐸</ci><apply id="S2.SS1.p2.11.m11.1.2.2.3.cmml" xref="S2.SS1.p2.11.m11.1.2.2.3"><times id="S2.SS1.p2.11.m11.1.2.2.3.1.cmml" xref="S2.SS1.p2.11.m11.1.2.2.3.1"></times><ci id="S2.SS1.p2.11.m11.1.2.2.3.2.cmml" xref="S2.SS1.p2.11.m11.1.2.2.3.2">𝑝</ci><ci id="S2.SS1.p2.11.m11.1.2.2.3.3.cmml" xref="S2.SS1.p2.11.m11.1.2.2.3.3">𝑜</ci><ci id="S2.SS1.p2.11.m11.1.2.2.3.4.cmml" xref="S2.SS1.p2.11.m11.1.2.2.3.4">𝑠</ci></apply></apply><apply id="S2.SS1.p2.11.m11.1.2.3.cmml" xref="S2.SS1.p2.11.m11.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.1.2.3.1.cmml" xref="S2.SS1.p2.11.m11.1.2.3">superscript</csymbol><ci id="S2.SS1.p2.11.m11.1.2.3.2.cmml" xref="S2.SS1.p2.11.m11.1.2.3.2">ℝ</ci><apply id="S2.SS1.p2.11.m11.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1.1"><times id="S2.SS1.p2.11.m11.1.1.1.2.cmml" xref="S2.SS1.p2.11.m11.1.1.1.2"></times><apply id="S2.SS1.p2.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1.1.1.1"><plus id="S2.SS1.p2.11.m11.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.p2.11.m11.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.2">𝑆</ci><cn type="integer" id="S2.SS1.p2.11.m11.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.11.m11.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p2.11.m11.1.1.1.3.cmml" xref="S2.SS1.p2.11.m11.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m11.1c">E_{pos}\in\mathbb{R}^{(S+1)\times D}</annotation></semantics></math> embeds information on the location relationship among class tokens and patches.
The calculation result <math id="S2.SS1.p2.12.m12.1" class="ltx_Math" alttext="z_{0}\in\mathbb{R}^{(S+1)\times D}" display="inline"><semantics id="S2.SS1.p2.12.m12.1a"><mrow id="S2.SS1.p2.12.m12.1.2" xref="S2.SS1.p2.12.m12.1.2.cmml"><msub id="S2.SS1.p2.12.m12.1.2.2" xref="S2.SS1.p2.12.m12.1.2.2.cmml"><mi id="S2.SS1.p2.12.m12.1.2.2.2" xref="S2.SS1.p2.12.m12.1.2.2.2.cmml">z</mi><mn id="S2.SS1.p2.12.m12.1.2.2.3" xref="S2.SS1.p2.12.m12.1.2.2.3.cmml">0</mn></msub><mo id="S2.SS1.p2.12.m12.1.2.1" xref="S2.SS1.p2.12.m12.1.2.1.cmml">∈</mo><msup id="S2.SS1.p2.12.m12.1.2.3" xref="S2.SS1.p2.12.m12.1.2.3.cmml"><mi id="S2.SS1.p2.12.m12.1.2.3.2" xref="S2.SS1.p2.12.m12.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.12.m12.1.1.1" xref="S2.SS1.p2.12.m12.1.1.1.cmml"><mrow id="S2.SS1.p2.12.m12.1.1.1.1.1" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.12.m12.1.1.1.1.1.2" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.12.m12.1.1.1.1.1.1" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.12.m12.1.1.1.1.1.1.2" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.2.cmml">S</mi><mo id="S2.SS1.p2.12.m12.1.1.1.1.1.1.1" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.12.m12.1.1.1.1.1.1.3" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS1.p2.12.m12.1.1.1.1.1.3" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS1.p2.12.m12.1.1.1.2" xref="S2.SS1.p2.12.m12.1.1.1.2.cmml">×</mo><mi id="S2.SS1.p2.12.m12.1.1.1.3" xref="S2.SS1.p2.12.m12.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m12.1b"><apply id="S2.SS1.p2.12.m12.1.2.cmml" xref="S2.SS1.p2.12.m12.1.2"><in id="S2.SS1.p2.12.m12.1.2.1.cmml" xref="S2.SS1.p2.12.m12.1.2.1"></in><apply id="S2.SS1.p2.12.m12.1.2.2.cmml" xref="S2.SS1.p2.12.m12.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.1.2.2.1.cmml" xref="S2.SS1.p2.12.m12.1.2.2">subscript</csymbol><ci id="S2.SS1.p2.12.m12.1.2.2.2.cmml" xref="S2.SS1.p2.12.m12.1.2.2.2">𝑧</ci><cn type="integer" id="S2.SS1.p2.12.m12.1.2.2.3.cmml" xref="S2.SS1.p2.12.m12.1.2.2.3">0</cn></apply><apply id="S2.SS1.p2.12.m12.1.2.3.cmml" xref="S2.SS1.p2.12.m12.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.12.m12.1.2.3.1.cmml" xref="S2.SS1.p2.12.m12.1.2.3">superscript</csymbol><ci id="S2.SS1.p2.12.m12.1.2.3.2.cmml" xref="S2.SS1.p2.12.m12.1.2.3.2">ℝ</ci><apply id="S2.SS1.p2.12.m12.1.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1.1"><times id="S2.SS1.p2.12.m12.1.1.1.2.cmml" xref="S2.SS1.p2.12.m12.1.1.1.2"></times><apply id="S2.SS1.p2.12.m12.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1.1.1.1"><plus id="S2.SS1.p2.12.m12.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.p2.12.m12.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.2">𝑆</ci><cn type="integer" id="S2.SS1.p2.12.m12.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.12.m12.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p2.12.m12.1.1.1.3.cmml" xref="S2.SS1.p2.12.m12.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m12.1c">z_{0}\in\mathbb{R}^{(S+1)\times D}</annotation></semantics></math> is given by</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="z_{0}=[x_{class};x^{1}_{P}E;x^{2}_{P}E;\cdots;x^{S}_{P}E]+E_{pos}," display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><msub id="S2.E1.m1.2.2.1.1.6" xref="S2.E1.m1.2.2.1.1.6.cmml"><mi id="S2.E1.m1.2.2.1.1.6.2" xref="S2.E1.m1.2.2.1.1.6.2.cmml">z</mi><mn id="S2.E1.m1.2.2.1.1.6.3" xref="S2.E1.m1.2.2.1.1.6.3.cmml">0</mn></msub><mo id="S2.E1.m1.2.2.1.1.5" xref="S2.E1.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.4" xref="S2.E1.m1.2.2.1.1.4.cmml"><mrow id="S2.E1.m1.2.2.1.1.4.4.4" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.4.4.4.5" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">[</mo><msub id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.1a" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3.4" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.1b" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3.5" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.1c" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3.6" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.6.cmml">s</mi></mrow></msub><mo id="S2.E1.m1.2.2.1.1.4.4.4.6" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">;</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.cmml"><msubsup id="S2.E1.m1.2.2.1.1.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml">P</mi><mn id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">1</mn></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.2.2.2.1" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml">E</mi></mrow><mo id="S2.E1.m1.2.2.1.1.4.4.4.7" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">;</mo><mrow id="S2.E1.m1.2.2.1.1.3.3.3.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.cmml"><msubsup id="S2.E1.m1.2.2.1.1.3.3.3.3.2" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.cmml"><mi id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.2" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.3.3.3.3.2.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.3.cmml">P</mi><mn id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.3.3.3.3.1" xref="S2.E1.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.3.3.3.3.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.3.cmml">E</mi></mrow><mo id="S2.E1.m1.2.2.1.1.4.4.4.8" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">;</mo><mi mathvariant="normal" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">⋯</mi><mo id="S2.E1.m1.2.2.1.1.4.4.4.9" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">;</mo><mrow id="S2.E1.m1.2.2.1.1.4.4.4.4" xref="S2.E1.m1.2.2.1.1.4.4.4.4.cmml"><msubsup id="S2.E1.m1.2.2.1.1.4.4.4.4.2" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.cmml"><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.2" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.2.cmml">x</mi><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.2.3" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.3.cmml">P</mi><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.3" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.3.cmml">S</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.4.4.4.4.1" xref="S2.E1.m1.2.2.1.1.4.4.4.4.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.3" xref="S2.E1.m1.2.2.1.1.4.4.4.4.3.cmml">E</mi></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.4.4.4.10" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">]</mo></mrow><mo id="S2.E1.m1.2.2.1.1.4.5" xref="S2.E1.m1.2.2.1.1.4.5.cmml">+</mo><msub id="S2.E1.m1.2.2.1.1.4.6" xref="S2.E1.m1.2.2.1.1.4.6.cmml"><mi id="S2.E1.m1.2.2.1.1.4.6.2" xref="S2.E1.m1.2.2.1.1.4.6.2.cmml">E</mi><mrow id="S2.E1.m1.2.2.1.1.4.6.3" xref="S2.E1.m1.2.2.1.1.4.6.3.cmml"><mi id="S2.E1.m1.2.2.1.1.4.6.3.2" xref="S2.E1.m1.2.2.1.1.4.6.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.4.6.3.1" xref="S2.E1.m1.2.2.1.1.4.6.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.4.6.3.3" xref="S2.E1.m1.2.2.1.1.4.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.4.6.3.1a" xref="S2.E1.m1.2.2.1.1.4.6.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.4.6.3.4" xref="S2.E1.m1.2.2.1.1.4.6.3.4.cmml">s</mi></mrow></msub></mrow></mrow><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.5.cmml" xref="S2.E1.m1.2.2.1.1.5"></eq><apply id="S2.E1.m1.2.2.1.1.6.cmml" xref="S2.E1.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.1.cmml" xref="S2.E1.m1.2.2.1.1.6">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.6.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2">𝑧</ci><cn type="integer" id="S2.E1.m1.2.2.1.1.6.3.cmml" xref="S2.E1.m1.2.2.1.1.6.3">0</cn></apply><apply id="S2.E1.m1.2.2.1.1.4.cmml" xref="S2.E1.m1.2.2.1.1.4"><plus id="S2.E1.m1.2.2.1.1.4.5.cmml" xref="S2.E1.m1.2.2.1.1.4.5"></plus><list id="S2.E1.m1.2.2.1.1.4.4.5.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3"><times id="S2.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.3">𝑙</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.4">𝑎</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.5.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.5">𝑠</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.6.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.6">𝑠</ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2"><times id="S2.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1"></times><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3">1</cn></apply><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.3">𝑃</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3">𝐸</ci></apply><apply id="S2.E1.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3"><times id="S2.E1.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.1"></times><apply id="S2.E1.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.3.3.3.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.2">𝑥</ci><cn type="integer" id="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.2.3">2</cn></apply><ci id="S2.E1.m1.2.2.1.1.3.3.3.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.3">𝑃</ci></apply><ci id="S2.E1.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.3">𝐸</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">⋯</ci><apply id="S2.E1.m1.2.2.1.1.4.4.4.4.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4"><times id="S2.E1.m1.2.2.1.1.4.4.4.4.1.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.1"></times><apply id="S2.E1.m1.2.2.1.1.4.4.4.4.2.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.4.4.4.2.1.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2">superscript</csymbol><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.2">𝑥</ci><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.2.3">𝑆</ci></apply><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.2.3.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.3">𝑃</ci></apply><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.3.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.3">𝐸</ci></apply></list><apply id="S2.E1.m1.2.2.1.1.4.6.cmml" xref="S2.E1.m1.2.2.1.1.4.6"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.6.1.cmml" xref="S2.E1.m1.2.2.1.1.4.6">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.4.6.2.cmml" xref="S2.E1.m1.2.2.1.1.4.6.2">𝐸</ci><apply id="S2.E1.m1.2.2.1.1.4.6.3.cmml" xref="S2.E1.m1.2.2.1.1.4.6.3"><times id="S2.E1.m1.2.2.1.1.4.6.3.1.cmml" xref="S2.E1.m1.2.2.1.1.4.6.3.1"></times><ci id="S2.E1.m1.2.2.1.1.4.6.3.2.cmml" xref="S2.E1.m1.2.2.1.1.4.6.3.2">𝑝</ci><ci id="S2.E1.m1.2.2.1.1.4.6.3.3.cmml" xref="S2.E1.m1.2.2.1.1.4.6.3.3">𝑜</ci><ci id="S2.E1.m1.2.2.1.1.4.6.3.4.cmml" xref="S2.E1.m1.2.2.1.1.4.6.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">z_{0}=[x_{class};x^{1}_{P}E;x^{2}_{P}E;\cdots;x^{S}_{P}E]+E_{pos},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.13" class="ltx_p">and it is input to the Transformer encoder layer.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.8" class="ltx_p">As shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a><a href="#S2.F2" title="Figure 2 ‣ 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the Transformer encoder layer is further decomposed into three layers: layer normalization (Norm), multi-head self-attention (MSA), and multi-layer perceptron (MLP).
Let <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="z_{l-1}" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><msub id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml"><mi id="S2.SS1.p3.1.m1.1.1.3.2" xref="S2.SS1.p3.1.m1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.1.m1.1.1.3.1" xref="S2.SS1.p3.1.m1.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.1.m1.1.1.3.3" xref="S2.SS1.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">𝑧</ci><apply id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3"><minus id="S2.SS1.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.p3.1.m1.1.1.3.1"></minus><ci id="S2.SS1.p3.1.m1.1.1.3.2.cmml" xref="S2.SS1.p3.1.m1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.1.m1.1.1.3.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">z_{l-1}</annotation></semantics></math> be the input and <math id="S2.SS1.p3.2.m2.1" class="ltx_Math" alttext="z_{l}" display="inline"><semantics id="S2.SS1.p3.2.m2.1a"><msub id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">z</mi><mi id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝑧</ci><ci id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">z_{l}</annotation></semantics></math> be the output in the Transformer encoder layer in the <math id="S2.SS1.p3.3.m3.4" class="ltx_Math" alttext="l\in\{1,2,\cdots,L\}" display="inline"><semantics id="S2.SS1.p3.3.m3.4a"><mrow id="S2.SS1.p3.3.m3.4.5" xref="S2.SS1.p3.3.m3.4.5.cmml"><mi id="S2.SS1.p3.3.m3.4.5.2" xref="S2.SS1.p3.3.m3.4.5.2.cmml">l</mi><mo id="S2.SS1.p3.3.m3.4.5.1" xref="S2.SS1.p3.3.m3.4.5.1.cmml">∈</mo><mrow id="S2.SS1.p3.3.m3.4.5.3.2" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S2.SS1.p3.3.m3.4.5.3.2.1" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml">{</mo><mn id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">1</mn><mo id="S2.SS1.p3.3.m3.4.5.3.2.2" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml">,</mo><mn id="S2.SS1.p3.3.m3.2.2" xref="S2.SS1.p3.3.m3.2.2.cmml">2</mn><mo id="S2.SS1.p3.3.m3.4.5.3.2.3" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p3.3.m3.3.3" xref="S2.SS1.p3.3.m3.3.3.cmml">⋯</mi><mo id="S2.SS1.p3.3.m3.4.5.3.2.4" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml">,</mo><mi id="S2.SS1.p3.3.m3.4.4" xref="S2.SS1.p3.3.m3.4.4.cmml">L</mi><mo stretchy="false" id="S2.SS1.p3.3.m3.4.5.3.2.5" xref="S2.SS1.p3.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.4b"><apply id="S2.SS1.p3.3.m3.4.5.cmml" xref="S2.SS1.p3.3.m3.4.5"><in id="S2.SS1.p3.3.m3.4.5.1.cmml" xref="S2.SS1.p3.3.m3.4.5.1"></in><ci id="S2.SS1.p3.3.m3.4.5.2.cmml" xref="S2.SS1.p3.3.m3.4.5.2">𝑙</ci><set id="S2.SS1.p3.3.m3.4.5.3.1.cmml" xref="S2.SS1.p3.3.m3.4.5.3.2"><cn type="integer" id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">1</cn><cn type="integer" id="S2.SS1.p3.3.m3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2">2</cn><ci id="S2.SS1.p3.3.m3.3.3.cmml" xref="S2.SS1.p3.3.m3.3.3">⋯</ci><ci id="S2.SS1.p3.3.m3.4.4.cmml" xref="S2.SS1.p3.3.m3.4.4">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.4c">l\in\{1,2,\cdots,L\}</annotation></semantics></math>-th layer.
We explain the calculation process for obtaining <math id="S2.SS1.p3.4.m4.1" class="ltx_Math" alttext="z_{l}" display="inline"><semantics id="S2.SS1.p3.4.m4.1a"><msub id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.2" xref="S2.SS1.p3.4.m4.1.1.2.cmml">z</mi><mi id="S2.SS1.p3.4.m4.1.1.3" xref="S2.SS1.p3.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><apply id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.2">𝑧</ci><ci id="S2.SS1.p3.4.m4.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">z_{l}</annotation></semantics></math> from <math id="S2.SS1.p3.5.m5.1" class="ltx_Math" alttext="z_{l-1}" display="inline"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml"><mi id="S2.SS1.p3.5.m5.1.1.3.2" xref="S2.SS1.p3.5.m5.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.5.m5.1.1.3.1" xref="S2.SS1.p3.5.m5.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.5.m5.1.1.3.3" xref="S2.SS1.p3.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑧</ci><apply id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3"><minus id="S2.SS1.p3.5.m5.1.1.3.1.cmml" xref="S2.SS1.p3.5.m5.1.1.3.1"></minus><ci id="S2.SS1.p3.5.m5.1.1.3.2.cmml" xref="S2.SS1.p3.5.m5.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.5.m5.1.1.3.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">z_{l-1}</annotation></semantics></math> in the <math id="S2.SS1.p3.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS1.p3.6.m6.1a"><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">l</annotation></semantics></math>-th Transformer encoder layer.
First, <math id="S2.SS1.p3.7.m7.1" class="ltx_Math" alttext="z_{l-1}" display="inline"><semantics id="S2.SS1.p3.7.m7.1a"><msub id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.2" xref="S2.SS1.p3.7.m7.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.7.m7.1.1.3" xref="S2.SS1.p3.7.m7.1.1.3.cmml"><mi id="S2.SS1.p3.7.m7.1.1.3.2" xref="S2.SS1.p3.7.m7.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.7.m7.1.1.3.1" xref="S2.SS1.p3.7.m7.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.7.m7.1.1.3.3" xref="S2.SS1.p3.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.2">𝑧</ci><apply id="S2.SS1.p3.7.m7.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3"><minus id="S2.SS1.p3.7.m7.1.1.3.1.cmml" xref="S2.SS1.p3.7.m7.1.1.3.1"></minus><ci id="S2.SS1.p3.7.m7.1.1.3.2.cmml" xref="S2.SS1.p3.7.m7.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.7.m7.1.1.3.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">z_{l-1}</annotation></semantics></math> is normalized by LN.
In LN, the output <math id="S2.SS1.p3.8.m8.1" class="ltx_Math" alttext="LN(z_{l-1})" display="inline"><semantics id="S2.SS1.p3.8.m8.1a"><mrow id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml"><mi id="S2.SS1.p3.8.m8.1.1.3" xref="S2.SS1.p3.8.m8.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.8.m8.1.1.2" xref="S2.SS1.p3.8.m8.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.8.m8.1.1.4" xref="S2.SS1.p3.8.m8.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.8.m8.1.1.2a" xref="S2.SS1.p3.8.m8.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.8.m8.1.1.1.1" xref="S2.SS1.p3.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.8.m8.1.1.1.1.2" xref="S2.SS1.p3.8.m8.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.8.m8.1.1.1.1.1" xref="S2.SS1.p3.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.8.m8.1.1.1.1.1.2" xref="S2.SS1.p3.8.m8.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.8.m8.1.1.1.1.1.3" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.8.m8.1.1.1.1.1.3.2" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.8.m8.1.1.1.1.1.3.1" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.8.m8.1.1.1.1.1.3.3" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS1.p3.8.m8.1.1.1.1.3" xref="S2.SS1.p3.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><apply id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1"><times id="S2.SS1.p3.8.m8.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.2"></times><ci id="S2.SS1.p3.8.m8.1.1.3.cmml" xref="S2.SS1.p3.8.m8.1.1.3">𝐿</ci><ci id="S2.SS1.p3.8.m8.1.1.4.cmml" xref="S2.SS1.p3.8.m8.1.1.4">𝑁</ci><apply id="S2.SS1.p3.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS1.p3.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3"><minus id="S2.SS1.p3.8.m8.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.1"></minus><ci id="S2.SS1.p3.8.m8.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.8.m8.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">LN(z_{l-1})</annotation></semantics></math> is obtained by</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="LN(z_{l-1})=\gamma\frac{z_{l-1}-E[z_{l-1}]}{\sqrt{Var[z_{l-1}]+\epsilon}}+\beta," display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.3.3.1.1.1.4" xref="S2.E2.m1.3.3.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2a" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.3.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.3.2.1" xref="S2.E2.m1.3.3.1.1.3.2.1.cmml">​</mo><mfrac id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.3.2.cmml">z</mi><mrow id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.3.3.2.cmml">l</mi><mo id="S2.E2.m1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><msqrt id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mrow id="S2.E2.m1.2.2.2.1.1" xref="S2.E2.m1.2.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.3.cmml">V</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.1.1.1.2" xref="S2.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.2.2.2.1.1.1.4" xref="S2.E2.m1.2.2.2.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.1.1.1.2a" xref="S2.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.2.2.2.1.1.1.5" xref="S2.E2.m1.2.2.2.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.1.1.1.2b" xref="S2.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.2.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.2.1.1.1.1.2.1.cmml">[</mo><msub id="S2.E2.m1.2.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.2" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.1" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2.m1.2.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.1.1.2.cmml">+</mo><mi id="S2.E2.m1.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.1.1.3.cmml">ϵ</mi></mrow></msqrt></mfrac></mrow><mo id="S2.E2.m1.3.3.1.1.3.1" xref="S2.E2.m1.3.3.1.1.3.1.cmml">+</mo><mi id="S2.E2.m1.3.3.1.1.3.3" xref="S2.E2.m1.3.3.1.1.3.3.cmml">β</mi></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></eq><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><ci id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3">𝐿</ci><ci id="S2.E2.m1.3.3.1.1.1.4.cmml" xref="S2.E2.m1.3.3.1.1.1.4">𝑁</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.1"></minus><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><plus id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.1"></plus><apply id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2"><times id="S2.E2.m1.3.3.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.3.2.1"></times><ci id="S2.E2.m1.3.3.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2.2">𝛾</ci><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><divide id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2"></divide><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><minus id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></minus><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3.2">𝑧</ci><apply id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3"><minus id="S2.E2.m1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.3.3.1"></minus><ci id="S2.E2.m1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S2.E2.m1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3">𝐸</ci><apply id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3"><minus id="S2.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><root id="S2.E2.m1.2.2.2a.cmml" xref="S2.E2.m1.2.2.2"></root><apply id="S2.E2.m1.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1"><plus id="S2.E2.m1.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.2"></plus><apply id="S2.E2.m1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1"><times id="S2.E2.m1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.2"></times><ci id="S2.E2.m1.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3">𝑉</ci><ci id="S2.E2.m1.2.2.2.1.1.1.4.cmml" xref="S2.E2.m1.2.2.2.1.1.1.4">𝑎</ci><ci id="S2.E2.m1.2.2.2.1.1.1.5.cmml" xref="S2.E2.m1.2.2.2.1.1.1.5">𝑟</ci><apply id="S2.E2.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3"><minus id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.1"></minus><ci id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><ci id="S2.E2.m1.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.3">italic-ϵ</ci></apply></apply></apply></apply><ci id="S2.E2.m1.3.3.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.3.3">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">LN(z_{l-1})=\gamma\frac{z_{l-1}-E[z_{l-1}]}{\sqrt{Var[z_{l-1}]+\epsilon}}+\beta,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.12" class="ltx_p">where <math id="S2.SS1.p3.9.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S2.SS1.p3.9.m1.1a"><mi id="S2.SS1.p3.9.m1.1.1" xref="S2.SS1.p3.9.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m1.1b"><ci id="S2.SS1.p3.9.m1.1.1.cmml" xref="S2.SS1.p3.9.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m1.1c">\gamma</annotation></semantics></math> and <math id="S2.SS1.p3.10.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS1.p3.10.m2.1a"><mi id="S2.SS1.p3.10.m2.1.1" xref="S2.SS1.p3.10.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m2.1b"><ci id="S2.SS1.p3.10.m2.1.1.cmml" xref="S2.SS1.p3.10.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.10.m2.1c">\beta</annotation></semantics></math> are learnable parameters, and <math id="S2.SS1.p3.11.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S2.SS1.p3.11.m3.1a"><mi id="S2.SS1.p3.11.m3.1.1" xref="S2.SS1.p3.11.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m3.1b"><ci id="S2.SS1.p3.11.m3.1.1.cmml" xref="S2.SS1.p3.11.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.11.m3.1c">\epsilon</annotation></semantics></math> is a small constant for ensuring that the denominator never takes zero.
Next, MSA carries out computation to obtain the output <math id="S2.SS1.p3.12.m4.1" class="ltx_Math" alttext="SA(LN(z_{l-1}))" display="inline"><semantics id="S2.SS1.p3.12.m4.1a"><mrow id="S2.SS1.p3.12.m4.1.1" xref="S2.SS1.p3.12.m4.1.1.cmml"><mi id="S2.SS1.p3.12.m4.1.1.3" xref="S2.SS1.p3.12.m4.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.12.m4.1.1.2" xref="S2.SS1.p3.12.m4.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.12.m4.1.1.4" xref="S2.SS1.p3.12.m4.1.1.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.12.m4.1.1.2a" xref="S2.SS1.p3.12.m4.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.12.m4.1.1.1.1" xref="S2.SS1.p3.12.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.12.m4.1.1.1.1.2" xref="S2.SS1.p3.12.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.12.m4.1.1.1.1.1" xref="S2.SS1.p3.12.m4.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.12.m4.1.1.1.1.1.3" xref="S2.SS1.p3.12.m4.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.12.m4.1.1.1.1.1.2" xref="S2.SS1.p3.12.m4.1.1.1.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.12.m4.1.1.1.1.1.4" xref="S2.SS1.p3.12.m4.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.12.m4.1.1.1.1.1.2a" xref="S2.SS1.p3.12.m4.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS1.p3.12.m4.1.1.1.1.3" xref="S2.SS1.p3.12.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.12.m4.1b"><apply id="S2.SS1.p3.12.m4.1.1.cmml" xref="S2.SS1.p3.12.m4.1.1"><times id="S2.SS1.p3.12.m4.1.1.2.cmml" xref="S2.SS1.p3.12.m4.1.1.2"></times><ci id="S2.SS1.p3.12.m4.1.1.3.cmml" xref="S2.SS1.p3.12.m4.1.1.3">𝑆</ci><ci id="S2.SS1.p3.12.m4.1.1.4.cmml" xref="S2.SS1.p3.12.m4.1.1.4">𝐴</ci><apply id="S2.SS1.p3.12.m4.1.1.1.1.1.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1"><times id="S2.SS1.p3.12.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.2"></times><ci id="S2.SS1.p3.12.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.3">𝐿</ci><ci id="S2.SS1.p3.12.m4.1.1.1.1.1.4.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.4">𝑁</ci><apply id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3"><minus id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.12.m4.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.12.m4.1c">SA(LN(z_{l-1}))</annotation></semantics></math> by using multiple self-attentions (SAs):</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.2" class="ltx_Math" alttext="SA(LN(z_{l-1}))=softmax\left(\frac{q_{l}k_{l}^{T}}{\sqrt{D_{h}}}\right)v_{l}." display="block"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.4" xref="S2.E3.m1.2.2.1.1.1.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.2a" xref="S2.E3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.1.1.2a" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.3" xref="S2.E3.m1.2.2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1a" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.4" xref="S2.E3.m1.2.2.1.1.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1b" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.5" xref="S2.E3.m1.2.2.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1c" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.6" xref="S2.E3.m1.2.2.1.1.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1d" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.7" xref="S2.E3.m1.2.2.1.1.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1e" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.3.8" xref="S2.E3.m1.2.2.1.1.3.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1f" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.3.9.2" xref="S2.E3.m1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.3.9.2.1" xref="S2.E3.m1.1.1.cmml">(</mo><mfrac id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mrow id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><msub id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml"><mi id="S2.E3.m1.1.1.2.2.2" xref="S2.E3.m1.1.1.2.2.2.cmml">q</mi><mi id="S2.E3.m1.1.1.2.2.3" xref="S2.E3.m1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.2.1" xref="S2.E3.m1.1.1.2.1.cmml">​</mo><msubsup id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2.2" xref="S2.E3.m1.1.1.2.3.2.2.cmml">k</mi><mi id="S2.E3.m1.1.1.2.3.2.3" xref="S2.E3.m1.1.1.2.3.2.3.cmml">l</mi><mi id="S2.E3.m1.1.1.2.3.3" xref="S2.E3.m1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><msub id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.3.2.2" xref="S2.E3.m1.1.1.3.2.2.cmml">D</mi><mi id="S2.E3.m1.1.1.3.2.3" xref="S2.E3.m1.1.1.3.2.3.cmml">h</mi></msub></msqrt></mfrac><mo id="S2.E3.m1.2.2.1.1.3.9.2.2" xref="S2.E3.m1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.3.1g" xref="S2.E3.m1.2.2.1.1.3.1.cmml">​</mo><msub id="S2.E3.m1.2.2.1.1.3.10" xref="S2.E3.m1.2.2.1.1.3.10.cmml"><mi id="S2.E3.m1.2.2.1.1.3.10.2" xref="S2.E3.m1.2.2.1.1.3.10.2.cmml">v</mi><mi id="S2.E3.m1.2.2.1.1.3.10.3" xref="S2.E3.m1.2.2.1.1.3.10.3.cmml">l</mi></msub></mrow></mrow><mo lspace="0em" id="S2.E3.m1.2.2.1.2" xref="S2.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><eq id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"></eq><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"></times><ci id="S2.E3.m1.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3">𝑆</ci><ci id="S2.E3.m1.2.2.1.1.1.4.cmml" xref="S2.E3.m1.2.2.1.1.1.4">𝐴</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.3">𝐿</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.4">𝑁</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"><times id="S2.E3.m1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.3.1"></times><ci id="S2.E3.m1.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.3.2">𝑠</ci><ci id="S2.E3.m1.2.2.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.3.3">𝑜</ci><ci id="S2.E3.m1.2.2.1.1.3.4.cmml" xref="S2.E3.m1.2.2.1.1.3.4">𝑓</ci><ci id="S2.E3.m1.2.2.1.1.3.5.cmml" xref="S2.E3.m1.2.2.1.1.3.5">𝑡</ci><ci id="S2.E3.m1.2.2.1.1.3.6.cmml" xref="S2.E3.m1.2.2.1.1.3.6">𝑚</ci><ci id="S2.E3.m1.2.2.1.1.3.7.cmml" xref="S2.E3.m1.2.2.1.1.3.7">𝑎</ci><ci id="S2.E3.m1.2.2.1.1.3.8.cmml" xref="S2.E3.m1.2.2.1.1.3.8">𝑥</ci><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.3.9.2"><divide id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.3.9.2"></divide><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><times id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2.1"></times><apply id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2">𝑞</ci><ci id="S2.E3.m1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.3">𝑙</ci></apply><apply id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3">superscript</csymbol><apply id="S2.E3.m1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.2.1.cmml" xref="S2.E3.m1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.2.3.2.2.cmml" xref="S2.E3.m1.1.1.2.3.2.2">𝑘</ci><ci id="S2.E3.m1.1.1.2.3.2.3.cmml" xref="S2.E3.m1.1.1.2.3.2.3">𝑙</ci></apply><ci id="S2.E3.m1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><root id="S2.E3.m1.1.1.3a.cmml" xref="S2.E3.m1.1.1.3"></root><apply id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2">𝐷</ci><ci id="S2.E3.m1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.3.2.3">ℎ</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.3.10.cmml" xref="S2.E3.m1.2.2.1.1.3.10"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.3.10.1.cmml" xref="S2.E3.m1.2.2.1.1.3.10">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.3.10.2.cmml" xref="S2.E3.m1.2.2.1.1.3.10.2">𝑣</ci><ci id="S2.E3.m1.2.2.1.1.3.10.3.cmml" xref="S2.E3.m1.2.2.1.1.3.10.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">SA(LN(z_{l-1}))=softmax\left(\frac{q_{l}k_{l}^{T}}{\sqrt{D_{h}}}\right)v_{l}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.14" class="ltx_p">In the computation of SA, <math id="S2.SS1.p3.13.m1.3" class="ltx_Math" alttext="\left(q_{l},k_{l},v_{l}\right)" display="inline"><semantics id="S2.SS1.p3.13.m1.3a"><mrow id="S2.SS1.p3.13.m1.3.3.3" xref="S2.SS1.p3.13.m1.3.3.4.cmml"><mo id="S2.SS1.p3.13.m1.3.3.3.4" xref="S2.SS1.p3.13.m1.3.3.4.cmml">(</mo><msub id="S2.SS1.p3.13.m1.1.1.1.1" xref="S2.SS1.p3.13.m1.1.1.1.1.cmml"><mi id="S2.SS1.p3.13.m1.1.1.1.1.2" xref="S2.SS1.p3.13.m1.1.1.1.1.2.cmml">q</mi><mi id="S2.SS1.p3.13.m1.1.1.1.1.3" xref="S2.SS1.p3.13.m1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.SS1.p3.13.m1.3.3.3.5" xref="S2.SS1.p3.13.m1.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.13.m1.2.2.2.2" xref="S2.SS1.p3.13.m1.2.2.2.2.cmml"><mi id="S2.SS1.p3.13.m1.2.2.2.2.2" xref="S2.SS1.p3.13.m1.2.2.2.2.2.cmml">k</mi><mi id="S2.SS1.p3.13.m1.2.2.2.2.3" xref="S2.SS1.p3.13.m1.2.2.2.2.3.cmml">l</mi></msub><mo id="S2.SS1.p3.13.m1.3.3.3.6" xref="S2.SS1.p3.13.m1.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.13.m1.3.3.3.3" xref="S2.SS1.p3.13.m1.3.3.3.3.cmml"><mi id="S2.SS1.p3.13.m1.3.3.3.3.2" xref="S2.SS1.p3.13.m1.3.3.3.3.2.cmml">v</mi><mi id="S2.SS1.p3.13.m1.3.3.3.3.3" xref="S2.SS1.p3.13.m1.3.3.3.3.3.cmml">l</mi></msub><mo id="S2.SS1.p3.13.m1.3.3.3.7" xref="S2.SS1.p3.13.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.13.m1.3b"><vector id="S2.SS1.p3.13.m1.3.3.4.cmml" xref="S2.SS1.p3.13.m1.3.3.3"><apply id="S2.SS1.p3.13.m1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.13.m1.1.1.1.1.2.cmml" xref="S2.SS1.p3.13.m1.1.1.1.1.2">𝑞</ci><ci id="S2.SS1.p3.13.m1.1.1.1.1.3.cmml" xref="S2.SS1.p3.13.m1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.SS1.p3.13.m1.2.2.2.2.cmml" xref="S2.SS1.p3.13.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m1.2.2.2.2.1.cmml" xref="S2.SS1.p3.13.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.13.m1.2.2.2.2.2.cmml" xref="S2.SS1.p3.13.m1.2.2.2.2.2">𝑘</ci><ci id="S2.SS1.p3.13.m1.2.2.2.2.3.cmml" xref="S2.SS1.p3.13.m1.2.2.2.2.3">𝑙</ci></apply><apply id="S2.SS1.p3.13.m1.3.3.3.3.cmml" xref="S2.SS1.p3.13.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m1.3.3.3.3.1.cmml" xref="S2.SS1.p3.13.m1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p3.13.m1.3.3.3.3.2.cmml" xref="S2.SS1.p3.13.m1.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.p3.13.m1.3.3.3.3.3.cmml" xref="S2.SS1.p3.13.m1.3.3.3.3.3">𝑙</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.13.m1.3c">\left(q_{l},k_{l},v_{l}\right)</annotation></semantics></math> for the input <math id="S2.SS1.p3.14.m2.1" class="ltx_Math" alttext="LN(z_{l-1})" display="inline"><semantics id="S2.SS1.p3.14.m2.1a"><mrow id="S2.SS1.p3.14.m2.1.1" xref="S2.SS1.p3.14.m2.1.1.cmml"><mi id="S2.SS1.p3.14.m2.1.1.3" xref="S2.SS1.p3.14.m2.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.14.m2.1.1.2" xref="S2.SS1.p3.14.m2.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.14.m2.1.1.4" xref="S2.SS1.p3.14.m2.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.14.m2.1.1.2a" xref="S2.SS1.p3.14.m2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.14.m2.1.1.1.1" xref="S2.SS1.p3.14.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.14.m2.1.1.1.1.2" xref="S2.SS1.p3.14.m2.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.14.m2.1.1.1.1.1" xref="S2.SS1.p3.14.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.14.m2.1.1.1.1.1.2" xref="S2.SS1.p3.14.m2.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.14.m2.1.1.1.1.1.3" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.14.m2.1.1.1.1.1.3.2" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.14.m2.1.1.1.1.1.3.1" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.14.m2.1.1.1.1.1.3.3" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS1.p3.14.m2.1.1.1.1.3" xref="S2.SS1.p3.14.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.14.m2.1b"><apply id="S2.SS1.p3.14.m2.1.1.cmml" xref="S2.SS1.p3.14.m2.1.1"><times id="S2.SS1.p3.14.m2.1.1.2.cmml" xref="S2.SS1.p3.14.m2.1.1.2"></times><ci id="S2.SS1.p3.14.m2.1.1.3.cmml" xref="S2.SS1.p3.14.m2.1.1.3">𝐿</ci><ci id="S2.SS1.p3.14.m2.1.1.4.cmml" xref="S2.SS1.p3.14.m2.1.1.4">𝑁</ci><apply id="S2.SS1.p3.14.m2.1.1.1.1.1.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.14.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.14.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS1.p3.14.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3"><minus id="S2.SS1.p3.14.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.1"></minus><ci id="S2.SS1.p3.14.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.14.m2.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.14.m2.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.14.m2.1c">LN(z_{l-1})</annotation></semantics></math> are determined by</p>
<table id="S2.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\begin{cases}q_{l}=LN(z_{l-1})U_{ql},\\
k_{l}=LN(z_{l-1})U_{kl},\\
v_{l}=LN(z_{l-1})U_{vl}.\end{cases}" display="inline"><semantics id="S2.E4X.2.1.1.m1.1a"><mrow id="S2.E4.m1.3.3.3.3.3.3a" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mo id="S2.E4.m1.3.3.3.3.3.3a.4" xref="S2.E4X.2.1.1.m1.1.1.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S2.E4.m1.3.3.3.3.3.3.3a" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mtr id="S2.E4.m1.3.3.3.3.3.3.3aa" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.3.3.3.3.3.3.3ab" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.2.cmml">q</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.3.cmml">l</mi></msub><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">​</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.4" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2a" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2b" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">​</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.2.cmml">U</mi><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.1.cmml">​</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.3.cmml">l</mi></mrow></msub></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.cmml">,</mo></mrow></mtd><mtd id="S2.E4.m1.3.3.3.3.3.3.3ac" xref="S2.E4X.2.1.1.m1.1.1.1.1.cmml"></mtd></mtr><mtr id="S2.E4.m1.3.3.3.3.3.3.3ad" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.3.3.3.3.3.3.3ae" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.cmml"><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.cmml"><msub id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.2.cmml">k</mi><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.3.cmml">l</mi></msub><mo id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml">​</mo><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.4" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2a" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2b" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml">​</mo><msub id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.2.cmml">U</mi><mrow id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.cmml"><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.1" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.1.cmml">​</mo><mi id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.3" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.3.cmml">l</mi></mrow></msub></mrow></mrow><mo id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.2" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.cmml">,</mo></mrow></mtd><mtd id="S2.E4.m1.3.3.3.3.3.3.3af" xref="S2.E4X.2.1.1.m1.1.1.1.1.cmml"></mtd></mtr><mtr id="S2.E4.m1.3.3.3.3.3.3.3ag" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.3.3.3.3.3.3.3ah" xref="S2.E4X.2.1.1.m1.1.1.1.cmml"><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.cmml"><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.cmml"><msub id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.2.cmml">v</mi><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.3.cmml">l</mi></msub><mo id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml">​</mo><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.4" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2a" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2b" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml">​</mo><msub id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.2.cmml">U</mi><mrow id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.cmml"><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.1" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.1.cmml">​</mo><mi id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.3" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.3.cmml">l</mi></mrow></msub></mrow></mrow><mo lspace="0em" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.2" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.cmml">.</mo></mrow></mtd><mtd id="S2.E4.m1.3.3.3.3.3.3.3ai" xref="S2.E4X.2.1.1.m1.1.1.1.1.cmml"></mtd></mtr></mtable></mrow><annotation-xml encoding="MathML-Content" id="S2.E4X.2.1.1.m1.1b"><apply id="S2.E4X.2.1.1.m1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3a"><csymbol cd="latexml" id="S2.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3a.4">cases</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1"><eq id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.2"></eq><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.2">𝑞</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.3.3">𝑙</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2"></times><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.3">𝐿</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.4">𝑁</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3"><minus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.1"></minus><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.2">𝑈</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.1"></times><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.2">𝑞</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.5.3.3">𝑙</ci></apply></apply></apply></apply><ci id="S2.E4X.2.1.1.m1.1.1.1.3a.cmml" xref="S2.E4.m1.3.3.3.3.3.3a"><mtext class="ltx_mathvariant_italic" id="S2.E4X.2.1.1.m1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3a.4">otherwise</mtext></ci><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1"><eq id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.2"></eq><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.2">𝑘</ci><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.3.3">𝑙</ci></apply><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1"><times id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.2"></times><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.3">𝐿</ci><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.4.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.4">𝑁</ci><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3"><minus id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.1"></minus><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.2">𝑈</ci><apply id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3"><times id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.1.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.1"></times><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.2">𝑘</ci><ci id="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.3.cmml" xref="S2.E4.m1.2.2.2.2.2.2.2.2.1.1.mf.1.1.1.5.3.3">𝑙</ci></apply></apply></apply></apply><ci id="S2.E4X.2.1.1.m1.1.1.1.5a.cmml" xref="S2.E4.m1.3.3.3.3.3.3a"><mtext class="ltx_mathvariant_italic" id="S2.E4X.2.1.1.m1.1.1.1.5.cmml" xref="S2.E4.m1.3.3.3.3.3.3a.4">otherwise</mtext></ci><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1"><eq id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.2"></eq><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3">subscript</csymbol><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.2">𝑣</ci><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.3.3">𝑙</ci></apply><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1"><times id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.2"></times><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.3">𝐿</ci><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.4.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.4">𝑁</ci><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3"><minus id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.1"></minus><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5">subscript</csymbol><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.2">𝑈</ci><apply id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3"><times id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.1.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.1"></times><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.2.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.2">𝑣</ci><ci id="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3.3.3.1.1.mf.1.1.1.5.3.3">𝑙</ci></apply></apply></apply></apply><ci id="S2.E4X.2.1.1.m1.1.1.1.7a.cmml" xref="S2.E4.m1.3.3.3.3.3.3a"><mtext class="ltx_mathvariant_italic" id="S2.E4X.2.1.1.m1.1.1.1.7.cmml" xref="S2.E4.m1.3.3.3.3.3.3a.4">otherwise</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.1c">\displaystyle\begin{cases}q_{l}=LN(z_{l-1})U_{ql},\\
k_{l}=LN(z_{l-1})U_{kl},\\
v_{l}=LN(z_{l-1})U_{vl}.\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S2.SS1.p3.21" class="ltx_p">Here, <math id="S2.SS1.p3.15.m1.3" class="ltx_Math" alttext="\left(U_{ql},U_{kl},U_{vl}\right)\in\mathbb{R}^{D\times D_{h}}" display="inline"><semantics id="S2.SS1.p3.15.m1.3a"><mrow id="S2.SS1.p3.15.m1.3.3" xref="S2.SS1.p3.15.m1.3.3.cmml"><mrow id="S2.SS1.p3.15.m1.3.3.3.3" xref="S2.SS1.p3.15.m1.3.3.3.4.cmml"><mo id="S2.SS1.p3.15.m1.3.3.3.3.4" xref="S2.SS1.p3.15.m1.3.3.3.4.cmml">(</mo><msub id="S2.SS1.p3.15.m1.1.1.1.1.1" xref="S2.SS1.p3.15.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.15.m1.1.1.1.1.1.2" xref="S2.SS1.p3.15.m1.1.1.1.1.1.2.cmml">U</mi><mrow id="S2.SS1.p3.15.m1.1.1.1.1.1.3" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.15.m1.1.1.1.1.1.3.2" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.15.m1.1.1.1.1.1.3.1" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.p3.15.m1.1.1.1.1.1.3.3" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.15.m1.3.3.3.3.5" xref="S2.SS1.p3.15.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.15.m1.2.2.2.2.2" xref="S2.SS1.p3.15.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.p3.15.m1.2.2.2.2.2.2" xref="S2.SS1.p3.15.m1.2.2.2.2.2.2.cmml">U</mi><mrow id="S2.SS1.p3.15.m1.2.2.2.2.2.3" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.cmml"><mi id="S2.SS1.p3.15.m1.2.2.2.2.2.3.2" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.15.m1.2.2.2.2.2.3.1" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS1.p3.15.m1.2.2.2.2.2.3.3" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.15.m1.3.3.3.3.6" xref="S2.SS1.p3.15.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.15.m1.3.3.3.3.3" xref="S2.SS1.p3.15.m1.3.3.3.3.3.cmml"><mi id="S2.SS1.p3.15.m1.3.3.3.3.3.2" xref="S2.SS1.p3.15.m1.3.3.3.3.3.2.cmml">U</mi><mrow id="S2.SS1.p3.15.m1.3.3.3.3.3.3" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.cmml"><mi id="S2.SS1.p3.15.m1.3.3.3.3.3.3.2" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.15.m1.3.3.3.3.3.3.1" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p3.15.m1.3.3.3.3.3.3.3" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.15.m1.3.3.3.3.7" xref="S2.SS1.p3.15.m1.3.3.3.4.cmml">)</mo></mrow><mo id="S2.SS1.p3.15.m1.3.3.4" xref="S2.SS1.p3.15.m1.3.3.4.cmml">∈</mo><msup id="S2.SS1.p3.15.m1.3.3.5" xref="S2.SS1.p3.15.m1.3.3.5.cmml"><mi id="S2.SS1.p3.15.m1.3.3.5.2" xref="S2.SS1.p3.15.m1.3.3.5.2.cmml">ℝ</mi><mrow id="S2.SS1.p3.15.m1.3.3.5.3" xref="S2.SS1.p3.15.m1.3.3.5.3.cmml"><mi id="S2.SS1.p3.15.m1.3.3.5.3.2" xref="S2.SS1.p3.15.m1.3.3.5.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p3.15.m1.3.3.5.3.1" xref="S2.SS1.p3.15.m1.3.3.5.3.1.cmml">×</mo><msub id="S2.SS1.p3.15.m1.3.3.5.3.3" xref="S2.SS1.p3.15.m1.3.3.5.3.3.cmml"><mi id="S2.SS1.p3.15.m1.3.3.5.3.3.2" xref="S2.SS1.p3.15.m1.3.3.5.3.3.2.cmml">D</mi><mi id="S2.SS1.p3.15.m1.3.3.5.3.3.3" xref="S2.SS1.p3.15.m1.3.3.5.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.15.m1.3b"><apply id="S2.SS1.p3.15.m1.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3"><in id="S2.SS1.p3.15.m1.3.3.4.cmml" xref="S2.SS1.p3.15.m1.3.3.4"></in><vector id="S2.SS1.p3.15.m1.3.3.3.4.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3"><apply id="S2.SS1.p3.15.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.15.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1.2">𝑈</ci><apply id="S2.SS1.p3.15.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3"><times id="S2.SS1.p3.15.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.1"></times><ci id="S2.SS1.p3.15.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.2">𝑞</ci><ci id="S2.SS1.p3.15.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.15.m1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S2.SS1.p3.15.m1.2.2.2.2.2.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.15.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2.2">𝑈</ci><apply id="S2.SS1.p3.15.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3"><times id="S2.SS1.p3.15.m1.2.2.2.2.2.3.1.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.1"></times><ci id="S2.SS1.p3.15.m1.2.2.2.2.2.3.2.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.2">𝑘</ci><ci id="S2.SS1.p3.15.m1.2.2.2.2.2.3.3.cmml" xref="S2.SS1.p3.15.m1.2.2.2.2.2.3.3">𝑙</ci></apply></apply><apply id="S2.SS1.p3.15.m1.3.3.3.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m1.3.3.3.3.3.1.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p3.15.m1.3.3.3.3.3.2.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3.2">𝑈</ci><apply id="S2.SS1.p3.15.m1.3.3.3.3.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3"><times id="S2.SS1.p3.15.m1.3.3.3.3.3.3.1.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.1"></times><ci id="S2.SS1.p3.15.m1.3.3.3.3.3.3.2.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.p3.15.m1.3.3.3.3.3.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3.3.3.3.3.3">𝑙</ci></apply></apply></vector><apply id="S2.SS1.p3.15.m1.3.3.5.cmml" xref="S2.SS1.p3.15.m1.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m1.3.3.5.1.cmml" xref="S2.SS1.p3.15.m1.3.3.5">superscript</csymbol><ci id="S2.SS1.p3.15.m1.3.3.5.2.cmml" xref="S2.SS1.p3.15.m1.3.3.5.2">ℝ</ci><apply id="S2.SS1.p3.15.m1.3.3.5.3.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3"><times id="S2.SS1.p3.15.m1.3.3.5.3.1.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.1"></times><ci id="S2.SS1.p3.15.m1.3.3.5.3.2.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.2">𝐷</ci><apply id="S2.SS1.p3.15.m1.3.3.5.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m1.3.3.5.3.3.1.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.3">subscript</csymbol><ci id="S2.SS1.p3.15.m1.3.3.5.3.3.2.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.3.2">𝐷</ci><ci id="S2.SS1.p3.15.m1.3.3.5.3.3.3.cmml" xref="S2.SS1.p3.15.m1.3.3.5.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.15.m1.3c">\left(U_{ql},U_{kl},U_{vl}\right)\in\mathbb{R}^{D\times D_{h}}</annotation></semantics></math> are learnable matrices in the <math id="S2.SS1.p3.16.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS1.p3.16.m2.1a"><mi id="S2.SS1.p3.16.m2.1.1" xref="S2.SS1.p3.16.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.16.m2.1b"><ci id="S2.SS1.p3.16.m2.1.1.cmml" xref="S2.SS1.p3.16.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.16.m2.1c">l</annotation></semantics></math>-th SA layer, and <math id="S2.SS1.p3.17.m3.1" class="ltx_Math" alttext="D_{h}" display="inline"><semantics id="S2.SS1.p3.17.m3.1a"><msub id="S2.SS1.p3.17.m3.1.1" xref="S2.SS1.p3.17.m3.1.1.cmml"><mi id="S2.SS1.p3.17.m3.1.1.2" xref="S2.SS1.p3.17.m3.1.1.2.cmml">D</mi><mi id="S2.SS1.p3.17.m3.1.1.3" xref="S2.SS1.p3.17.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.17.m3.1b"><apply id="S2.SS1.p3.17.m3.1.1.cmml" xref="S2.SS1.p3.17.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.17.m3.1.1.1.cmml" xref="S2.SS1.p3.17.m3.1.1">subscript</csymbol><ci id="S2.SS1.p3.17.m3.1.1.2.cmml" xref="S2.SS1.p3.17.m3.1.1.2">𝐷</ci><ci id="S2.SS1.p3.17.m3.1.1.3.cmml" xref="S2.SS1.p3.17.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.17.m3.1c">D_{h}</annotation></semantics></math> is the vector length <math id="S2.SS1.p3.18.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS1.p3.18.m4.1a"><mi id="S2.SS1.p3.18.m4.1.1" xref="S2.SS1.p3.18.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.18.m4.1b"><ci id="S2.SS1.p3.18.m4.1.1.cmml" xref="S2.SS1.p3.18.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.18.m4.1c">D</annotation></semantics></math> divided by the number of heads.
Additionally, <math id="S2.SS1.p3.19.m5.3" class="ltx_Math" alttext="\left(q_{l},k_{l},v_{l}\right)" display="inline"><semantics id="S2.SS1.p3.19.m5.3a"><mrow id="S2.SS1.p3.19.m5.3.3.3" xref="S2.SS1.p3.19.m5.3.3.4.cmml"><mo id="S2.SS1.p3.19.m5.3.3.3.4" xref="S2.SS1.p3.19.m5.3.3.4.cmml">(</mo><msub id="S2.SS1.p3.19.m5.1.1.1.1" xref="S2.SS1.p3.19.m5.1.1.1.1.cmml"><mi id="S2.SS1.p3.19.m5.1.1.1.1.2" xref="S2.SS1.p3.19.m5.1.1.1.1.2.cmml">q</mi><mi id="S2.SS1.p3.19.m5.1.1.1.1.3" xref="S2.SS1.p3.19.m5.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.SS1.p3.19.m5.3.3.3.5" xref="S2.SS1.p3.19.m5.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.19.m5.2.2.2.2" xref="S2.SS1.p3.19.m5.2.2.2.2.cmml"><mi id="S2.SS1.p3.19.m5.2.2.2.2.2" xref="S2.SS1.p3.19.m5.2.2.2.2.2.cmml">k</mi><mi id="S2.SS1.p3.19.m5.2.2.2.2.3" xref="S2.SS1.p3.19.m5.2.2.2.2.3.cmml">l</mi></msub><mo id="S2.SS1.p3.19.m5.3.3.3.6" xref="S2.SS1.p3.19.m5.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.19.m5.3.3.3.3" xref="S2.SS1.p3.19.m5.3.3.3.3.cmml"><mi id="S2.SS1.p3.19.m5.3.3.3.3.2" xref="S2.SS1.p3.19.m5.3.3.3.3.2.cmml">v</mi><mi id="S2.SS1.p3.19.m5.3.3.3.3.3" xref="S2.SS1.p3.19.m5.3.3.3.3.3.cmml">l</mi></msub><mo id="S2.SS1.p3.19.m5.3.3.3.7" xref="S2.SS1.p3.19.m5.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.19.m5.3b"><vector id="S2.SS1.p3.19.m5.3.3.4.cmml" xref="S2.SS1.p3.19.m5.3.3.3"><apply id="S2.SS1.p3.19.m5.1.1.1.1.cmml" xref="S2.SS1.p3.19.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.19.m5.1.1.1.1.1.cmml" xref="S2.SS1.p3.19.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.19.m5.1.1.1.1.2.cmml" xref="S2.SS1.p3.19.m5.1.1.1.1.2">𝑞</ci><ci id="S2.SS1.p3.19.m5.1.1.1.1.3.cmml" xref="S2.SS1.p3.19.m5.1.1.1.1.3">𝑙</ci></apply><apply id="S2.SS1.p3.19.m5.2.2.2.2.cmml" xref="S2.SS1.p3.19.m5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.19.m5.2.2.2.2.1.cmml" xref="S2.SS1.p3.19.m5.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.19.m5.2.2.2.2.2.cmml" xref="S2.SS1.p3.19.m5.2.2.2.2.2">𝑘</ci><ci id="S2.SS1.p3.19.m5.2.2.2.2.3.cmml" xref="S2.SS1.p3.19.m5.2.2.2.2.3">𝑙</ci></apply><apply id="S2.SS1.p3.19.m5.3.3.3.3.cmml" xref="S2.SS1.p3.19.m5.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.19.m5.3.3.3.3.1.cmml" xref="S2.SS1.p3.19.m5.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p3.19.m5.3.3.3.3.2.cmml" xref="S2.SS1.p3.19.m5.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.p3.19.m5.3.3.3.3.3.cmml" xref="S2.SS1.p3.19.m5.3.3.3.3.3">𝑙</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.19.m5.3c">\left(q_{l},k_{l},v_{l}\right)</annotation></semantics></math> are the input queries, keys, and values linearly transformed by <math id="S2.SS1.p3.20.m6.3" class="ltx_Math" alttext="\left(U_{ql},U_{kl},U_{vl}\right)" display="inline"><semantics id="S2.SS1.p3.20.m6.3a"><mrow id="S2.SS1.p3.20.m6.3.3.3" xref="S2.SS1.p3.20.m6.3.3.4.cmml"><mo id="S2.SS1.p3.20.m6.3.3.3.4" xref="S2.SS1.p3.20.m6.3.3.4.cmml">(</mo><msub id="S2.SS1.p3.20.m6.1.1.1.1" xref="S2.SS1.p3.20.m6.1.1.1.1.cmml"><mi id="S2.SS1.p3.20.m6.1.1.1.1.2" xref="S2.SS1.p3.20.m6.1.1.1.1.2.cmml">U</mi><mrow id="S2.SS1.p3.20.m6.1.1.1.1.3" xref="S2.SS1.p3.20.m6.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.20.m6.1.1.1.1.3.2" xref="S2.SS1.p3.20.m6.1.1.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.20.m6.1.1.1.1.3.1" xref="S2.SS1.p3.20.m6.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.p3.20.m6.1.1.1.1.3.3" xref="S2.SS1.p3.20.m6.1.1.1.1.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.20.m6.3.3.3.5" xref="S2.SS1.p3.20.m6.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.20.m6.2.2.2.2" xref="S2.SS1.p3.20.m6.2.2.2.2.cmml"><mi id="S2.SS1.p3.20.m6.2.2.2.2.2" xref="S2.SS1.p3.20.m6.2.2.2.2.2.cmml">U</mi><mrow id="S2.SS1.p3.20.m6.2.2.2.2.3" xref="S2.SS1.p3.20.m6.2.2.2.2.3.cmml"><mi id="S2.SS1.p3.20.m6.2.2.2.2.3.2" xref="S2.SS1.p3.20.m6.2.2.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.20.m6.2.2.2.2.3.1" xref="S2.SS1.p3.20.m6.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS1.p3.20.m6.2.2.2.2.3.3" xref="S2.SS1.p3.20.m6.2.2.2.2.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.20.m6.3.3.3.6" xref="S2.SS1.p3.20.m6.3.3.4.cmml">,</mo><msub id="S2.SS1.p3.20.m6.3.3.3.3" xref="S2.SS1.p3.20.m6.3.3.3.3.cmml"><mi id="S2.SS1.p3.20.m6.3.3.3.3.2" xref="S2.SS1.p3.20.m6.3.3.3.3.2.cmml">U</mi><mrow id="S2.SS1.p3.20.m6.3.3.3.3.3" xref="S2.SS1.p3.20.m6.3.3.3.3.3.cmml"><mi id="S2.SS1.p3.20.m6.3.3.3.3.3.2" xref="S2.SS1.p3.20.m6.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.20.m6.3.3.3.3.3.1" xref="S2.SS1.p3.20.m6.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p3.20.m6.3.3.3.3.3.3" xref="S2.SS1.p3.20.m6.3.3.3.3.3.3.cmml">l</mi></mrow></msub><mo id="S2.SS1.p3.20.m6.3.3.3.7" xref="S2.SS1.p3.20.m6.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.20.m6.3b"><vector id="S2.SS1.p3.20.m6.3.3.4.cmml" xref="S2.SS1.p3.20.m6.3.3.3"><apply id="S2.SS1.p3.20.m6.1.1.1.1.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.20.m6.1.1.1.1.1.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.20.m6.1.1.1.1.2.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1.2">𝑈</ci><apply id="S2.SS1.p3.20.m6.1.1.1.1.3.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1.3"><times id="S2.SS1.p3.20.m6.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1.3.1"></times><ci id="S2.SS1.p3.20.m6.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1.3.2">𝑞</ci><ci id="S2.SS1.p3.20.m6.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.20.m6.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S2.SS1.p3.20.m6.2.2.2.2.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.20.m6.2.2.2.2.1.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.20.m6.2.2.2.2.2.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2.2">𝑈</ci><apply id="S2.SS1.p3.20.m6.2.2.2.2.3.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2.3"><times id="S2.SS1.p3.20.m6.2.2.2.2.3.1.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2.3.1"></times><ci id="S2.SS1.p3.20.m6.2.2.2.2.3.2.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2.3.2">𝑘</ci><ci id="S2.SS1.p3.20.m6.2.2.2.2.3.3.cmml" xref="S2.SS1.p3.20.m6.2.2.2.2.3.3">𝑙</ci></apply></apply><apply id="S2.SS1.p3.20.m6.3.3.3.3.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p3.20.m6.3.3.3.3.1.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p3.20.m6.3.3.3.3.2.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3.2">𝑈</ci><apply id="S2.SS1.p3.20.m6.3.3.3.3.3.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3.3"><times id="S2.SS1.p3.20.m6.3.3.3.3.3.1.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3.3.1"></times><ci id="S2.SS1.p3.20.m6.3.3.3.3.3.2.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.p3.20.m6.3.3.3.3.3.3.cmml" xref="S2.SS1.p3.20.m6.3.3.3.3.3.3">𝑙</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.20.m6.3c">\left(U_{ql},U_{kl},U_{vl}\right)</annotation></semantics></math>.
From (<a href="#S2.E3" title="In 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), in MSA, the output <math id="S2.SS1.p3.21.m7.1" class="ltx_Math" alttext="MSA(LN(z_{l-1}))" display="inline"><semantics id="S2.SS1.p3.21.m7.1a"><mrow id="S2.SS1.p3.21.m7.1.1" xref="S2.SS1.p3.21.m7.1.1.cmml"><mi id="S2.SS1.p3.21.m7.1.1.3" xref="S2.SS1.p3.21.m7.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.21.m7.1.1.2" xref="S2.SS1.p3.21.m7.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.21.m7.1.1.4" xref="S2.SS1.p3.21.m7.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.21.m7.1.1.2a" xref="S2.SS1.p3.21.m7.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.21.m7.1.1.5" xref="S2.SS1.p3.21.m7.1.1.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.21.m7.1.1.2b" xref="S2.SS1.p3.21.m7.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.21.m7.1.1.1.1" xref="S2.SS1.p3.21.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.21.m7.1.1.1.1.2" xref="S2.SS1.p3.21.m7.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.21.m7.1.1.1.1.1" xref="S2.SS1.p3.21.m7.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.21.m7.1.1.1.1.1.3" xref="S2.SS1.p3.21.m7.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.21.m7.1.1.1.1.1.2" xref="S2.SS1.p3.21.m7.1.1.1.1.1.2.cmml">​</mo><mi id="S2.SS1.p3.21.m7.1.1.1.1.1.4" xref="S2.SS1.p3.21.m7.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.21.m7.1.1.1.1.1.2a" xref="S2.SS1.p3.21.m7.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS1.p3.21.m7.1.1.1.1.3" xref="S2.SS1.p3.21.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.21.m7.1b"><apply id="S2.SS1.p3.21.m7.1.1.cmml" xref="S2.SS1.p3.21.m7.1.1"><times id="S2.SS1.p3.21.m7.1.1.2.cmml" xref="S2.SS1.p3.21.m7.1.1.2"></times><ci id="S2.SS1.p3.21.m7.1.1.3.cmml" xref="S2.SS1.p3.21.m7.1.1.3">𝑀</ci><ci id="S2.SS1.p3.21.m7.1.1.4.cmml" xref="S2.SS1.p3.21.m7.1.1.4">𝑆</ci><ci id="S2.SS1.p3.21.m7.1.1.5.cmml" xref="S2.SS1.p3.21.m7.1.1.5">𝐴</ci><apply id="S2.SS1.p3.21.m7.1.1.1.1.1.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1"><times id="S2.SS1.p3.21.m7.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.2"></times><ci id="S2.SS1.p3.21.m7.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.3">𝐿</ci><ci id="S2.SS1.p3.21.m7.1.1.1.1.1.4.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.4">𝑁</ci><apply id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3"><minus id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.21.m7.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.21.m7.1c">MSA(LN(z_{l-1}))</annotation></semantics></math> is given by</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.2" class="ltx_Math" alttext="MSA(LN(z_{l-1}))=\begin{bmatrix}SA_{1};SA_{2};\cdots;SA_{T},\end{bmatrix}U_{msa}," display="block"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.1.4" xref="S2.E5.m1.2.2.1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.1.2a" xref="S2.E5.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.1.5" xref="S2.E5.m1.2.2.1.1.1.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.1.2b" xref="S2.E5.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.1.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.4" xref="S2.E5.m1.2.2.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.1.1.1.1.2a" xref="S2.E5.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5.m1.2.2.1.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><mrow id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.2.cmml"><mo id="S2.E5.m1.1.1.3.1" xref="S2.E5.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mtr id="S2.E5.m1.1.1.1.1a" xref="S2.E5.m1.1.1.1.1.cmml"><mtd id="S2.E5.m1.1.1.1.1b" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1.2.2.2.2.2" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.4.cmml"><mrow id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.1" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">​</mo><msub id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml">A</mi><mn id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.4" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.4.cmml">;</mo><mrow id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.1" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.1.cmml">​</mo><msub id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.2.cmml">A</mi><mn id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.3.cmml">2</mn></msub></mrow><mo id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.5" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.4.cmml">;</mo><mi mathvariant="normal" id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">⋯</mi><mo id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.6" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.4.cmml">;</mo><mrow id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.1" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.1.cmml">​</mo><msub id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.cmml"><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.2.cmml">A</mi><mi id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.3" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.3.cmml">T</mi></msub></mrow></mrow><mo id="S2.E5.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.E5.m1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><mo id="S2.E5.m1.1.1.3.2" xref="S2.E5.m1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">​</mo><msub id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml">U</mi><mrow id="S2.E5.m1.2.2.1.1.3.2.3" xref="S2.E5.m1.2.2.1.1.3.2.3.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.3.2" xref="S2.E5.m1.2.2.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.2.3.1" xref="S2.E5.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.3.2.3.3" xref="S2.E5.m1.2.2.1.1.3.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.2.3.1a" xref="S2.E5.m1.2.2.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.3.2.3.4" xref="S2.E5.m1.2.2.1.1.3.2.3.4.cmml">a</mi></mrow></msub></mrow></mrow><mo id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2"></eq><apply id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"><times id="S2.E5.m1.2.2.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.2"></times><ci id="S2.E5.m1.2.2.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.3">𝑀</ci><ci id="S2.E5.m1.2.2.1.1.1.4.cmml" xref="S2.E5.m1.2.2.1.1.1.4">𝑆</ci><ci id="S2.E5.m1.2.2.1.1.1.5.cmml" xref="S2.E5.m1.2.2.1.1.1.5">𝐴</ci><apply id="S2.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1"><times id="S2.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.3">𝐿</ci><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.4">𝑁</ci><apply id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><times id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></times><apply id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.3"><csymbol cd="latexml" id="S2.E5.m1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.3.1">matrix</csymbol><matrix id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1"><matrixrow id="S2.E5.m1.1.1.1.1a.cmml" xref="S2.E5.m1.1.1.1.1"><list id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.4.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3"><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1"><times id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.1"></times><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.2">𝑆</ci><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.2">𝐴</ci><cn type="integer" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2"><times id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.1"></times><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.2">𝑆</ci><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.2">𝐴</ci><cn type="integer" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.2.2.3.3">2</cn></apply></apply><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1">⋯</ci><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3"><times id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.1"></times><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.2">𝑆</ci><apply id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.2">𝐴</ci><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2.2.1.3.3.3.3">𝑇</ci></apply></apply></list></matrixrow></matrix></apply><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2">𝑈</ci><apply id="S2.E5.m1.2.2.1.1.3.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3"><times id="S2.E5.m1.2.2.1.1.3.2.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3.1"></times><ci id="S2.E5.m1.2.2.1.1.3.2.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3.2">𝑚</ci><ci id="S2.E5.m1.2.2.1.1.3.2.3.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3.3">𝑠</ci><ci id="S2.E5.m1.2.2.1.1.3.2.3.4.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3.4">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">MSA(LN(z_{l-1}))=\begin{bmatrix}SA_{1};SA_{2};\cdots;SA_{T},\end{bmatrix}U_{msa},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.25" class="ltx_p">where <math id="S2.SS1.p3.22.m1.1" class="ltx_Math" alttext="SA_{t}" display="inline"><semantics id="S2.SS1.p3.22.m1.1a"><mrow id="S2.SS1.p3.22.m1.1.1" xref="S2.SS1.p3.22.m1.1.1.cmml"><mi id="S2.SS1.p3.22.m1.1.1.2" xref="S2.SS1.p3.22.m1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.22.m1.1.1.1" xref="S2.SS1.p3.22.m1.1.1.1.cmml">​</mo><msub id="S2.SS1.p3.22.m1.1.1.3" xref="S2.SS1.p3.22.m1.1.1.3.cmml"><mi id="S2.SS1.p3.22.m1.1.1.3.2" xref="S2.SS1.p3.22.m1.1.1.3.2.cmml">A</mi><mi id="S2.SS1.p3.22.m1.1.1.3.3" xref="S2.SS1.p3.22.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.22.m1.1b"><apply id="S2.SS1.p3.22.m1.1.1.cmml" xref="S2.SS1.p3.22.m1.1.1"><times id="S2.SS1.p3.22.m1.1.1.1.cmml" xref="S2.SS1.p3.22.m1.1.1.1"></times><ci id="S2.SS1.p3.22.m1.1.1.2.cmml" xref="S2.SS1.p3.22.m1.1.1.2">𝑆</ci><apply id="S2.SS1.p3.22.m1.1.1.3.cmml" xref="S2.SS1.p3.22.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.22.m1.1.1.3.1.cmml" xref="S2.SS1.p3.22.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.22.m1.1.1.3.2.cmml" xref="S2.SS1.p3.22.m1.1.1.3.2">𝐴</ci><ci id="S2.SS1.p3.22.m1.1.1.3.3.cmml" xref="S2.SS1.p3.22.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.22.m1.1c">SA_{t}</annotation></semantics></math> is the output of the <math id="S2.SS1.p3.23.m2.4" class="ltx_Math" alttext="t\in\{1,2,\cdots,T\}" display="inline"><semantics id="S2.SS1.p3.23.m2.4a"><mrow id="S2.SS1.p3.23.m2.4.5" xref="S2.SS1.p3.23.m2.4.5.cmml"><mi id="S2.SS1.p3.23.m2.4.5.2" xref="S2.SS1.p3.23.m2.4.5.2.cmml">t</mi><mo id="S2.SS1.p3.23.m2.4.5.1" xref="S2.SS1.p3.23.m2.4.5.1.cmml">∈</mo><mrow id="S2.SS1.p3.23.m2.4.5.3.2" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml"><mo stretchy="false" id="S2.SS1.p3.23.m2.4.5.3.2.1" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml">{</mo><mn id="S2.SS1.p3.23.m2.1.1" xref="S2.SS1.p3.23.m2.1.1.cmml">1</mn><mo id="S2.SS1.p3.23.m2.4.5.3.2.2" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml">,</mo><mn id="S2.SS1.p3.23.m2.2.2" xref="S2.SS1.p3.23.m2.2.2.cmml">2</mn><mo id="S2.SS1.p3.23.m2.4.5.3.2.3" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p3.23.m2.3.3" xref="S2.SS1.p3.23.m2.3.3.cmml">⋯</mi><mo id="S2.SS1.p3.23.m2.4.5.3.2.4" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml">,</mo><mi id="S2.SS1.p3.23.m2.4.4" xref="S2.SS1.p3.23.m2.4.4.cmml">T</mi><mo stretchy="false" id="S2.SS1.p3.23.m2.4.5.3.2.5" xref="S2.SS1.p3.23.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.23.m2.4b"><apply id="S2.SS1.p3.23.m2.4.5.cmml" xref="S2.SS1.p3.23.m2.4.5"><in id="S2.SS1.p3.23.m2.4.5.1.cmml" xref="S2.SS1.p3.23.m2.4.5.1"></in><ci id="S2.SS1.p3.23.m2.4.5.2.cmml" xref="S2.SS1.p3.23.m2.4.5.2">𝑡</ci><set id="S2.SS1.p3.23.m2.4.5.3.1.cmml" xref="S2.SS1.p3.23.m2.4.5.3.2"><cn type="integer" id="S2.SS1.p3.23.m2.1.1.cmml" xref="S2.SS1.p3.23.m2.1.1">1</cn><cn type="integer" id="S2.SS1.p3.23.m2.2.2.cmml" xref="S2.SS1.p3.23.m2.2.2">2</cn><ci id="S2.SS1.p3.23.m2.3.3.cmml" xref="S2.SS1.p3.23.m2.3.3">⋯</ci><ci id="S2.SS1.p3.23.m2.4.4.cmml" xref="S2.SS1.p3.23.m2.4.4">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.23.m2.4c">t\in\{1,2,\cdots,T\}</annotation></semantics></math>-th SA, and <math id="S2.SS1.p3.24.m3.1" class="ltx_Math" alttext="U_{msa}\in\mathbb{R}^{k\cdot D_{h}\times D}" display="inline"><semantics id="S2.SS1.p3.24.m3.1a"><mrow id="S2.SS1.p3.24.m3.1.1" xref="S2.SS1.p3.24.m3.1.1.cmml"><msub id="S2.SS1.p3.24.m3.1.1.2" xref="S2.SS1.p3.24.m3.1.1.2.cmml"><mi id="S2.SS1.p3.24.m3.1.1.2.2" xref="S2.SS1.p3.24.m3.1.1.2.2.cmml">U</mi><mrow id="S2.SS1.p3.24.m3.1.1.2.3" xref="S2.SS1.p3.24.m3.1.1.2.3.cmml"><mi id="S2.SS1.p3.24.m3.1.1.2.3.2" xref="S2.SS1.p3.24.m3.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.24.m3.1.1.2.3.1" xref="S2.SS1.p3.24.m3.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p3.24.m3.1.1.2.3.3" xref="S2.SS1.p3.24.m3.1.1.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.24.m3.1.1.2.3.1a" xref="S2.SS1.p3.24.m3.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.p3.24.m3.1.1.2.3.4" xref="S2.SS1.p3.24.m3.1.1.2.3.4.cmml">a</mi></mrow></msub><mo id="S2.SS1.p3.24.m3.1.1.1" xref="S2.SS1.p3.24.m3.1.1.1.cmml">∈</mo><msup id="S2.SS1.p3.24.m3.1.1.3" xref="S2.SS1.p3.24.m3.1.1.3.cmml"><mi id="S2.SS1.p3.24.m3.1.1.3.2" xref="S2.SS1.p3.24.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p3.24.m3.1.1.3.3" xref="S2.SS1.p3.24.m3.1.1.3.3.cmml"><mrow id="S2.SS1.p3.24.m3.1.1.3.3.2" xref="S2.SS1.p3.24.m3.1.1.3.3.2.cmml"><mi id="S2.SS1.p3.24.m3.1.1.3.3.2.2" xref="S2.SS1.p3.24.m3.1.1.3.3.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p3.24.m3.1.1.3.3.2.1" xref="S2.SS1.p3.24.m3.1.1.3.3.2.1.cmml">⋅</mo><msub id="S2.SS1.p3.24.m3.1.1.3.3.2.3" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3.cmml"><mi id="S2.SS1.p3.24.m3.1.1.3.3.2.3.2" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3.2.cmml">D</mi><mi id="S2.SS1.p3.24.m3.1.1.3.3.2.3.3" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3.3.cmml">h</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p3.24.m3.1.1.3.3.1" xref="S2.SS1.p3.24.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p3.24.m3.1.1.3.3.3" xref="S2.SS1.p3.24.m3.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.24.m3.1b"><apply id="S2.SS1.p3.24.m3.1.1.cmml" xref="S2.SS1.p3.24.m3.1.1"><in id="S2.SS1.p3.24.m3.1.1.1.cmml" xref="S2.SS1.p3.24.m3.1.1.1"></in><apply id="S2.SS1.p3.24.m3.1.1.2.cmml" xref="S2.SS1.p3.24.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.24.m3.1.1.2.1.cmml" xref="S2.SS1.p3.24.m3.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.24.m3.1.1.2.2.cmml" xref="S2.SS1.p3.24.m3.1.1.2.2">𝑈</ci><apply id="S2.SS1.p3.24.m3.1.1.2.3.cmml" xref="S2.SS1.p3.24.m3.1.1.2.3"><times id="S2.SS1.p3.24.m3.1.1.2.3.1.cmml" xref="S2.SS1.p3.24.m3.1.1.2.3.1"></times><ci id="S2.SS1.p3.24.m3.1.1.2.3.2.cmml" xref="S2.SS1.p3.24.m3.1.1.2.3.2">𝑚</ci><ci id="S2.SS1.p3.24.m3.1.1.2.3.3.cmml" xref="S2.SS1.p3.24.m3.1.1.2.3.3">𝑠</ci><ci id="S2.SS1.p3.24.m3.1.1.2.3.4.cmml" xref="S2.SS1.p3.24.m3.1.1.2.3.4">𝑎</ci></apply></apply><apply id="S2.SS1.p3.24.m3.1.1.3.cmml" xref="S2.SS1.p3.24.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.24.m3.1.1.3.1.cmml" xref="S2.SS1.p3.24.m3.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.24.m3.1.1.3.2.cmml" xref="S2.SS1.p3.24.m3.1.1.3.2">ℝ</ci><apply id="S2.SS1.p3.24.m3.1.1.3.3.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3"><times id="S2.SS1.p3.24.m3.1.1.3.3.1.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.1"></times><apply id="S2.SS1.p3.24.m3.1.1.3.3.2.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2"><ci id="S2.SS1.p3.24.m3.1.1.3.3.2.1.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.1">⋅</ci><ci id="S2.SS1.p3.24.m3.1.1.3.3.2.2.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.2">𝑘</ci><apply id="S2.SS1.p3.24.m3.1.1.3.3.2.3.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p3.24.m3.1.1.3.3.2.3.1.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3">subscript</csymbol><ci id="S2.SS1.p3.24.m3.1.1.3.3.2.3.2.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3.2">𝐷</ci><ci id="S2.SS1.p3.24.m3.1.1.3.3.2.3.3.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.2.3.3">ℎ</ci></apply></apply><ci id="S2.SS1.p3.24.m3.1.1.3.3.3.cmml" xref="S2.SS1.p3.24.m3.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.24.m3.1c">U_{msa}\in\mathbb{R}^{k\cdot D_{h}\times D}</annotation></semantics></math> is a matrix for returning the shape of the MSA output to that of the input.
According to (<a href="#S2.E5" title="In 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), in Transformer encoder layer, the output <math id="S2.SS1.p3.25.m4.1" class="ltx_Math" alttext="z_{l}" display="inline"><semantics id="S2.SS1.p3.25.m4.1a"><msub id="S2.SS1.p3.25.m4.1.1" xref="S2.SS1.p3.25.m4.1.1.cmml"><mi id="S2.SS1.p3.25.m4.1.1.2" xref="S2.SS1.p3.25.m4.1.1.2.cmml">z</mi><mi id="S2.SS1.p3.25.m4.1.1.3" xref="S2.SS1.p3.25.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.25.m4.1b"><apply id="S2.SS1.p3.25.m4.1.1.cmml" xref="S2.SS1.p3.25.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.25.m4.1.1.1.cmml" xref="S2.SS1.p3.25.m4.1.1">subscript</csymbol><ci id="S2.SS1.p3.25.m4.1.1.2.cmml" xref="S2.SS1.p3.25.m4.1.1.2">𝑧</ci><ci id="S2.SS1.p3.25.m4.1.1.3.cmml" xref="S2.SS1.p3.25.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.25.m4.1c">z_{l}</annotation></semantics></math> is obtained by</p>
<table id="S2.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle z_{l}=" display="inline"><semantics id="S2.E6X.2.1.1.m1.1a"><mrow id="S2.E6X.2.1.1.m1.1.1" xref="S2.E6X.2.1.1.m1.1.1.cmml"><msub id="S2.E6X.2.1.1.m1.1.1.2" xref="S2.E6X.2.1.1.m1.1.1.2.cmml"><mi id="S2.E6X.2.1.1.m1.1.1.2.2" xref="S2.E6X.2.1.1.m1.1.1.2.2.cmml">z</mi><mi id="S2.E6X.2.1.1.m1.1.1.2.3" xref="S2.E6X.2.1.1.m1.1.1.2.3.cmml">l</mi></msub><mo id="S2.E6X.2.1.1.m1.1.1.1" xref="S2.E6X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S2.E6X.2.1.1.m1.1.1.3" xref="S2.E6X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E6X.2.1.1.m1.1b"><apply id="S2.E6X.2.1.1.m1.1.1.cmml" xref="S2.E6X.2.1.1.m1.1.1"><eq id="S2.E6X.2.1.1.m1.1.1.1.cmml" xref="S2.E6X.2.1.1.m1.1.1.1"></eq><apply id="S2.E6X.2.1.1.m1.1.1.2.cmml" xref="S2.E6X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E6X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E6X.2.1.1.m1.1.1.2.2">𝑧</ci><ci id="S2.E6X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E6X.2.1.1.m1.1.1.2.3">𝑙</ci></apply><csymbol cd="latexml" id="S2.E6X.2.1.1.m1.1.1.3.cmml" xref="S2.E6X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6X.2.1.1.m1.1c">\displaystyle z_{l}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle MLP(LN(z_{l}^{\prime}))+z_{l}^{\prime}," display="inline"><semantics id="S2.E6X.3.2.2.m1.1a"><mrow id="S2.E6X.3.2.2.m1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E6X.3.2.2.m1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E6X.3.2.2.m1.1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.E6X.3.2.2.m1.1.1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.4" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E6X.3.2.2.m1.1.1.1.1.1.2a" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.5" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.E6X.3.2.2.m1.1.1.1.1.1.2b" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.4" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2a" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6X.3.2.2.m1.1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.2.cmml">+</mo><msubsup id="S2.E6X.3.2.2.m1.1.1.1.1.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.cmml"><mi id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.2.3.cmml">l</mi><mo id="S2.E6X.3.2.2.m1.1.1.1.1.3.3" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo id="S2.E6X.3.2.2.m1.1.1.1.2" xref="S2.E6X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6X.3.2.2.m1.1b"><apply id="S2.E6X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1"><plus id="S2.E6X.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.2"></plus><apply id="S2.E6X.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1"><times id="S2.E6X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.3">𝑀</ci><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.4.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.4">𝐿</ci><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.5.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.5">𝑃</ci><apply id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1"><times id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S2.E6X.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3">superscript</csymbol><apply id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.2.2">𝑧</ci><ci id="S2.E6X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S2.E6X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E6X.3.2.2.m1.1.1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6X.3.2.2.m1.1c">\displaystyle MLP(LN(z_{l}^{\prime}))+z_{l}^{\prime},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S2.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle where\ \ z_{l}^{\prime}=MSA(LN(z_{l-1}))+z_{l-1}." display="inline"><semantics id="S2.E6Xa.2.1.1.m1.1a"><mrow id="S2.E6Xa.2.1.1.m1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.3.cmml"><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1a" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.4" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1b" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.5" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1c" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.6" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.6.cmml">e</mi></mrow><mspace width="1em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.3.cmml"></mspace><msubsup id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">l</mi><mo id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow><mo id="S2.E6Xa.2.1.1.m1.1.1.1.1.4" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.4" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2a" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.5" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2b" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml">​</mo><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2.cmml">​</mo><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.4" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2a" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.2.cmml">+</mo><msub id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml">z</mi><mrow id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">l</mi><mo id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo lspace="0em" id="S2.E6Xa.2.1.1.m1.1.1.1.2" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6Xa.2.1.1.m1.1b"><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1"><eq id="S2.E6Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.4"></eq><list id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2"><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></times><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.3">ℎ</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.4">𝑒</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.5">𝑟</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.6.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.1.1.1.6">𝑒</ci></apply><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3">𝑙</ci></apply><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.2.2.2.3">′</ci></apply></list><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3"><plus id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.2"></plus><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1"><times id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.2"></times><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.3">𝑀</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.4.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.4">𝑆</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.5.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.5">𝐴</ci><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1"><times id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.2"></times><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.3">𝐿</ci><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.4.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.4">𝑁</ci><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3"><minus id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.2">𝑧</ci><apply id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3"><minus id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.1"></minus><ci id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.2">𝑙</ci><cn type="integer" id="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E6Xa.2.1.1.m1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6Xa.2.1.1.m1.1c">\displaystyle where\ \ z_{l}^{\prime}=MSA(LN(z_{l-1}))+z_{l-1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.3" class="ltx_p">Finally, we obtain the output <math id="S2.SS1.p4.1.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS1.p4.1.m1.1a"><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">y</annotation></semantics></math> of ViT, which can be calculated from LN by inputting only the class token <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="z_{l}^{0}" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><msubsup id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml"><mi id="S2.SS1.p4.2.m2.1.1.2.2" xref="S2.SS1.p4.2.m2.1.1.2.2.cmml">z</mi><mi id="S2.SS1.p4.2.m2.1.1.2.3" xref="S2.SS1.p4.2.m2.1.1.2.3.cmml">l</mi><mn id="S2.SS1.p4.2.m2.1.1.3" xref="S2.SS1.p4.2.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p4.2.m2.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.2.1.cmml" xref="S2.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p4.2.m2.1.1.2.2.cmml" xref="S2.SS1.p4.2.m2.1.1.2.2">𝑧</ci><ci id="S2.SS1.p4.2.m2.1.1.2.3.cmml" xref="S2.SS1.p4.2.m2.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S2.SS1.p4.2.m2.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">z_{l}^{0}</annotation></semantics></math> from the outputs of the <math id="S2.SS1.p4.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">L</annotation></semantics></math>-th Transformer encoder layer.</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.1" class="ltx_Math" alttext="y=LN(z_{l}^{0})." display="block"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.3.cmml">y</mi><mo id="S2.E7.m1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E7.m1.1.1.1.1.1.4" xref="S2.E7.m1.1.1.1.1.1.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.2a" xref="S2.E7.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E7.m1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi><mn id="S2.E7.m1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msubsup><mo stretchy="false" id="S2.E7.m1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><eq id="S2.E7.m1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.2"></eq><ci id="S2.E7.m1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.3">𝑦</ci><apply id="S2.E7.m1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><times id="S2.E7.m1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.2"></times><ci id="S2.E7.m1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3">𝐿</ci><ci id="S2.E7.m1.1.1.1.1.1.4.cmml" xref="S2.E7.m1.1.1.1.1.1.4">𝑁</ci><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S2.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">y=LN(z_{l}^{0}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p4.4" class="ltx_p">ViT predicts the label of the input image on the basis of the output <math id="S2.SS1.p4.4.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS1.p4.4.m1.1a"><mi id="S2.SS1.p4.4.m1.1.1" xref="S2.SS1.p4.4.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m1.1b"><ci id="S2.SS1.p4.4.m1.1.1.cmml" xref="S2.SS1.p4.4.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m1.1c">y</annotation></semantics></math>.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F2.1.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:390.3pt;"><img src="/html/2409.19988/assets/x2.png" id="S2.F2.1.1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="233" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.1.1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S2.F2.1.1.3.2" class="ltx_text" style="font-size:90%;">Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F2.2.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:216.8pt;"><img src="/html/2409.19988/assets/x3.png" id="S2.F2.2.1.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="90" height="173" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S2.F2.2.1.3.2" class="ltx_text" style="font-size:90%;">Transformer encoder layer</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.4.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.5.2" class="ltx_text" style="font-size:90%;">ViT structure</span></figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Attention Privacy Leakage</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In federated learning, methods for updating a model can be broadly classified into two categories: Federated Stochastic Gradient Descent (FedSGD) and Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
As mentioned above, there is a gradient leakage attack called APRIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> that uses updated information to infer input images.
APRIL targets FedSGD-based learning using ViT.
We summarize the attack below.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">First, attackers calculate the input to the Transformer encoder layer <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="z_{0}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">z</mi><mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">z_{0}</annotation></semantics></math>:</p>
<table id="S2.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial l}{\partial z_{0}}z_{0}^{T}=U_{q1}^{T}\cdot\frac{\partial l}{\partial U_{q1}}+U_{v1}^{T}\cdot\frac{\partial l}{\partial U_{v1}}+U_{k1}^{T}\cdot\frac{\partial l}{\partial U_{k1}}," display="inline"><semantics id="S2.E8X.2.1.1.m1.1a"><mrow id="S2.E8X.2.1.1.m1.1.1.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E8X.2.1.1.m1.1.1.1.1.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.cmml"><mfrac id="S2.E8X.2.1.1.m1.1.1.1.1.2.2a" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">∂</mo><mi id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml">l</mi></mrow><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml">∂</mo><msub id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml">z</mi><mn id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml">0</mn></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E8X.2.1.1.m1.1.1.1.1.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.2.cmml">z</mi><mn id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.3.cmml">0</mn><mi id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S2.E8X.2.1.1.m1.1.1.1.1.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.cmml"><msubsup id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mfrac id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3a" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.1.cmml">∂</mo><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.2.cmml">l</mi></mrow><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.1.cmml">∂</mo><msub id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mstyle></mrow><mo id="S2.E8X.2.1.1.m1.1.1.1.1.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.cmml"><msubsup id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.1.cmml">⋅</mo><mstyle displaystyle="true" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mfrac id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3a" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml">∂</mo><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml">l</mi></mrow><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.1.cmml">∂</mo><msub id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mstyle></mrow><mo id="S2.E8X.2.1.1.m1.1.1.1.1.3.1a" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.4" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.cmml"><msubsup id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml">T</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.1.cmml">⋅</mo><mstyle displaystyle="true" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.cmml"><mfrac id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3a" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.cmml"><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.1.cmml">∂</mo><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.2.cmml">l</mi></mrow><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml"><mo rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.1.cmml">∂</mo><msub id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.2.cmml">U</mi><mrow id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.1" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.1.cmml">​</mo><mn id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.3" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="S2.E8X.2.1.1.m1.1.1.1.2" xref="S2.E8X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8X.2.1.1.m1.1b"><apply id="S2.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1"><eq id="S2.E8X.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.1"></eq><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2"><times id="S2.E8X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.1"></times><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2"><divide id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2"></divide><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.1"></partialdiff><ci id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.2.2">𝑙</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.1"></partialdiff><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.2">𝑧</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.2.3.2.3">0</cn></apply></apply></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.2">𝑧</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.2.3">0</cn></apply><ci id="S2.E8X.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3"><plus id="S2.E8X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.1"></plus><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2"><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.1">⋅</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2">superscript</csymbol><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.2">𝑞</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.2.3">𝑇</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3"><divide id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3"></divide><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.1"></partialdiff><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.2.2">𝑙</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.1"></partialdiff><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.2">𝑞</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.2.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3"><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.1">⋅</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2">superscript</csymbol><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.2">𝑣</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.2.3.3">1</cn></apply></apply><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.2.3">𝑇</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3"><divide id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3"></divide><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.1"></partialdiff><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.2.2">𝑙</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.1"></partialdiff><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.2">𝑣</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4"><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.1">⋅</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2">superscript</csymbol><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.2">𝑘</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.2.3.3">1</cn></apply></apply><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.2.3">𝑇</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3"><divide id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3"></divide><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.1"></partialdiff><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.2.2">𝑙</ci></apply><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3"><partialdiff id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.1"></partialdiff><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2"><csymbol cd="ambiguous" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2">subscript</csymbol><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.2">𝑈</ci><apply id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3"><times id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.3.cmml" xref="S2.E8X.2.1.1.m1.1.1.1.1.3.4.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8X.2.1.1.m1.1c">\displaystyle\frac{\partial l}{\partial z_{0}}z_{0}^{T}=U_{q1}^{T}\cdot\frac{\partial l}{\partial U_{q1}}+U_{v1}^{T}\cdot\frac{\partial l}{\partial U_{v1}}+U_{k1}^{T}\cdot\frac{\partial l}{\partial U_{k1}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr id="S2.E8Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial l}{\partial z_{0}}=\frac{\partial l}{\partial E_{pos}}." display="inline"><semantics id="S2.E8Xa.2.1.1.m1.1a"><mrow id="S2.E8Xa.2.1.1.m1.1.1.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E8Xa.2.1.1.m1.1.1.1.1.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.cmml"><mfrac id="S2.E8Xa.2.1.1.m1.1.1.1.1.2a" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.cmml"><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.cmml"><mo rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml">∂</mo><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml">l</mi></mrow><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.cmml"><mo rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml">∂</mo><msub id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.cmml"><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.2.cmml">z</mi><mn id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.3.cmml">0</mn></msub></mrow></mfrac></mstyle><mo id="S2.E8Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.cmml"><mfrac id="S2.E8Xa.2.1.1.m1.1.1.1.1.3a" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><mo rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml">l</mi></mrow><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml">∂</mo><msub id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml">E</mi><mrow id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1a" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4.cmml">s</mi></mrow></msub></mrow></mfrac></mstyle></mrow><mo lspace="0em" id="S2.E8Xa.2.1.1.m1.1.1.1.2" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8Xa.2.1.1.m1.1b"><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1"><eq id="S2.E8Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.1"></eq><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2"><divide id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2"></divide><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2"><partialdiff id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.1"></partialdiff><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.2.2">𝑙</ci></apply><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3"><partialdiff id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.1"></partialdiff><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.2">𝑧</ci><cn type="integer" id="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.2.3.2.3">0</cn></apply></apply></apply><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3"><divide id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3"></divide><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2"><partialdiff id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.1"></partialdiff><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.2.2">𝑙</ci></apply><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3"><partialdiff id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.1"></partialdiff><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.2">𝐸</ci><apply id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3"><times id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.2">𝑝</ci><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.3">𝑜</ci><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.3.4">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8Xa.2.1.1.m1.1c">\displaystyle\frac{\partial l}{\partial z_{0}}=\frac{\partial l}{\partial E_{pos}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS2.p2.4" class="ltx_p">Here, <math id="S2.SS2.p2.2.m1.1" class="ltx_math_unparsed" alttext="\frac{\partial l}{\partial\ast}" display="inline"><semantics id="S2.SS2.p2.2.m1.1a"><mfrac id="S2.SS2.p2.2.m1.1.1"><mrow id="S2.SS2.p2.2.m1.1.1.2"><mo rspace="0em" id="S2.SS2.p2.2.m1.1.1.2.1">∂</mo><mi id="S2.SS2.p2.2.m1.1.1.2.2">l</mi></mrow><mrow id="S2.SS2.p2.2.m1.1.1.3"><mo rspace="0.055em" id="S2.SS2.p2.2.m1.1.1.3.1">∂</mo><mo id="S2.SS2.p2.2.m1.1.1.3.2">∗</mo></mrow></mfrac><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m1.1b">\frac{\partial l}{\partial\ast}</annotation></semantics></math> is the gradient of the parameter <math id="S2.SS2.p2.3.m2.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="S2.SS2.p2.3.m2.1a"><mo id="S2.SS2.p2.3.m2.1.1" xref="S2.SS2.p2.3.m2.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m2.1b"><ci id="S2.SS2.p2.3.m2.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m2.1c">\ast</annotation></semantics></math> on the loss function.
Next, the inferred image <math id="S2.SS2.p2.4.m3.1" class="ltx_Math" alttext="x^{\prime}" display="inline"><semantics id="S2.SS2.p2.4.m3.1a"><msup id="S2.SS2.p2.4.m3.1.1" xref="S2.SS2.p2.4.m3.1.1.cmml"><mi id="S2.SS2.p2.4.m3.1.1.2" xref="S2.SS2.p2.4.m3.1.1.2.cmml">x</mi><mo id="S2.SS2.p2.4.m3.1.1.3" xref="S2.SS2.p2.4.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m3.1b"><apply id="S2.SS2.p2.4.m3.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m3.1.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1">superscript</csymbol><ci id="S2.SS2.p2.4.m3.1.1.2.cmml" xref="S2.SS2.p2.4.m3.1.1.2">𝑥</ci><ci id="S2.SS2.p2.4.m3.1.1.3.cmml" xref="S2.SS2.p2.4.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m3.1c">x^{\prime}</annotation></semantics></math> is obtained by inversion of (<a href="#S2.E1" title="In 2.1 Vision Transformer ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>):</p>
<table id="S2.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1.1" class="ltx_Math" alttext="x^{\prime}=E\times(z_{0}-E_{pos})^{T}." display="block"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><mrow id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><msup id="S2.E9.m1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.1.3.2.cmml">x</mi><mo id="S2.E9.m1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.E9.m1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E9.m1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.3.cmml">E</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E9.m1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.2.cmml">×</mo><msup id="S2.E9.m1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mn id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S2.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mrow id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E9.m1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.3.cmml">T</mi></msup></mrow></mrow><mo lspace="0em" id="S2.E9.m1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"><eq id="S2.E9.m1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.2"></eq><apply id="S2.E9.m1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E9.m1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E9.m1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.3.3">′</ci></apply><apply id="S2.E9.m1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1"><times id="S2.E9.m1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.2"></times><ci id="S2.E9.m1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.3">𝐸</ci><apply id="S2.E9.m1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1"><minus id="S2.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝐸</ci><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci></apply></apply></apply><ci id="S2.E9.m1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">x^{\prime}=E\times(z_{0}-E_{pos})^{T}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.6" class="ltx_p">In (<a href="#S2.E9" title="In 2.2 Attention Privacy Leakage ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), <math id="S2.SS2.p2.5.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.SS2.p2.5.m1.1a"><mi id="S2.SS2.p2.5.m1.1.1" xref="S2.SS2.p2.5.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m1.1b"><ci id="S2.SS2.p2.5.m1.1.1.cmml" xref="S2.SS2.p2.5.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m1.1c">E</annotation></semantics></math> and <math id="S2.SS2.p2.6.m2.1" class="ltx_Math" alttext="E_{pos}" display="inline"><semantics id="S2.SS2.p2.6.m2.1a"><msub id="S2.SS2.p2.6.m2.1.1" xref="S2.SS2.p2.6.m2.1.1.cmml"><mi id="S2.SS2.p2.6.m2.1.1.2" xref="S2.SS2.p2.6.m2.1.1.2.cmml">E</mi><mrow id="S2.SS2.p2.6.m2.1.1.3" xref="S2.SS2.p2.6.m2.1.1.3.cmml"><mi id="S2.SS2.p2.6.m2.1.1.3.2" xref="S2.SS2.p2.6.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m2.1.1.3.1" xref="S2.SS2.p2.6.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m2.1.1.3.3" xref="S2.SS2.p2.6.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m2.1.1.3.1a" xref="S2.SS2.p2.6.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.6.m2.1.1.3.4" xref="S2.SS2.p2.6.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m2.1b"><apply id="S2.SS2.p2.6.m2.1.1.cmml" xref="S2.SS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m2.1.1.1.cmml" xref="S2.SS2.p2.6.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m2.1.1.2.cmml" xref="S2.SS2.p2.6.m2.1.1.2">𝐸</ci><apply id="S2.SS2.p2.6.m2.1.1.3.cmml" xref="S2.SS2.p2.6.m2.1.1.3"><times id="S2.SS2.p2.6.m2.1.1.3.1.cmml" xref="S2.SS2.p2.6.m2.1.1.3.1"></times><ci id="S2.SS2.p2.6.m2.1.1.3.2.cmml" xref="S2.SS2.p2.6.m2.1.1.3.2">𝑝</ci><ci id="S2.SS2.p2.6.m2.1.1.3.3.cmml" xref="S2.SS2.p2.6.m2.1.1.3.3">𝑜</ci><ci id="S2.SS2.p2.6.m2.1.1.3.4.cmml" xref="S2.SS2.p2.6.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m2.1c">E_{pos}</annotation></semantics></math> refer to the parameters of the global model before being updated.
APRIL attempts to reconstruct the input images for learning by using the above procedure.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Previous Method</h3>

<figure id="S2.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F3.1.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:390.3pt;"><img src="/html/2409.19988/assets/x4.png" id="S2.F3.1.1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.1.1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S2.F3.1.1.3.2" class="ltx_text" style="font-size:90%;">Gradients with normal learning</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F3.2.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:390.3pt;"><img src="/html/2409.19988/assets/x5.png" id="S2.F3.2.1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.2.1.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S2.F3.2.1.3.2" class="ltx_text" style="font-size:90%;">Gradients with fixed-position method<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S2.F3.3.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:390.3pt;"><img src="/html/2409.19988/assets/x6.png" id="S2.F3.3.1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.3.1.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S2.F3.3.1.3.2" class="ltx_text" style="font-size:90%;">Gradients with random binary weight (proposed)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.5.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S2.F3.6.2" class="ltx_text" style="font-size:90%;">Update of gradients</span></figcaption>
</figure>
<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Several security enhancement methods for federated learning have been proposed.
A representative method is differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
In differential privacy, we add noise to the updated information so as to enhance security at a low computational cost.
However, differential privacy degrades model performance.
Another method lets a third party scramble the updated information for high anonymity for each client <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
This approach requires the assumption that the third party is absolutely credible.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.13" class="ltx_p">In contrast, there is another security enhancement method for federated learning with ViT, which is called the fixed-position method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
This method is implemented assuming FedSGD.
In FedSGD, the update of parameters is expressed by</p>
<table id="S2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1.9" class="ltx_Math" alttext="w_{A,i}^{m+1}=w_{A,i}^{m}-\eta\frac{\sum_{n=1}^{N}\theta_{A,i}^{n,m}}{N}," display="block"><semantics id="S2.E10.m1.9a"><mrow id="S2.E10.m1.9.9.1" xref="S2.E10.m1.9.9.1.1.cmml"><mrow id="S2.E10.m1.9.9.1.1" xref="S2.E10.m1.9.9.1.1.cmml"><msubsup id="S2.E10.m1.9.9.1.1.2" xref="S2.E10.m1.9.9.1.1.2.cmml"><mi id="S2.E10.m1.9.9.1.1.2.2.2" xref="S2.E10.m1.9.9.1.1.2.2.2.cmml">w</mi><mrow id="S2.E10.m1.2.2.2.4" xref="S2.E10.m1.2.2.2.3.cmml"><mi id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml">A</mi><mo id="S2.E10.m1.2.2.2.4.1" xref="S2.E10.m1.2.2.2.3.cmml">,</mo><mi id="S2.E10.m1.2.2.2.2" xref="S2.E10.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S2.E10.m1.9.9.1.1.2.3" xref="S2.E10.m1.9.9.1.1.2.3.cmml"><mi id="S2.E10.m1.9.9.1.1.2.3.2" xref="S2.E10.m1.9.9.1.1.2.3.2.cmml">m</mi><mo id="S2.E10.m1.9.9.1.1.2.3.1" xref="S2.E10.m1.9.9.1.1.2.3.1.cmml">+</mo><mn id="S2.E10.m1.9.9.1.1.2.3.3" xref="S2.E10.m1.9.9.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E10.m1.9.9.1.1.1" xref="S2.E10.m1.9.9.1.1.1.cmml">=</mo><mrow id="S2.E10.m1.9.9.1.1.3" xref="S2.E10.m1.9.9.1.1.3.cmml"><msubsup id="S2.E10.m1.9.9.1.1.3.2" xref="S2.E10.m1.9.9.1.1.3.2.cmml"><mi id="S2.E10.m1.9.9.1.1.3.2.2.2" xref="S2.E10.m1.9.9.1.1.3.2.2.2.cmml">w</mi><mrow id="S2.E10.m1.4.4.2.4" xref="S2.E10.m1.4.4.2.3.cmml"><mi id="S2.E10.m1.3.3.1.1" xref="S2.E10.m1.3.3.1.1.cmml">A</mi><mo id="S2.E10.m1.4.4.2.4.1" xref="S2.E10.m1.4.4.2.3.cmml">,</mo><mi id="S2.E10.m1.4.4.2.2" xref="S2.E10.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S2.E10.m1.9.9.1.1.3.2.3" xref="S2.E10.m1.9.9.1.1.3.2.3.cmml">m</mi></msubsup><mo id="S2.E10.m1.9.9.1.1.3.1" xref="S2.E10.m1.9.9.1.1.3.1.cmml">−</mo><mrow id="S2.E10.m1.9.9.1.1.3.3" xref="S2.E10.m1.9.9.1.1.3.3.cmml"><mi id="S2.E10.m1.9.9.1.1.3.3.2" xref="S2.E10.m1.9.9.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S2.E10.m1.9.9.1.1.3.3.1" xref="S2.E10.m1.9.9.1.1.3.3.1.cmml">​</mo><mfrac id="S2.E10.m1.8.8" xref="S2.E10.m1.8.8.cmml"><mrow id="S2.E10.m1.8.8.4" xref="S2.E10.m1.8.8.4.cmml"><msubsup id="S2.E10.m1.8.8.4.5" xref="S2.E10.m1.8.8.4.5.cmml"><mo id="S2.E10.m1.8.8.4.5.2.2" xref="S2.E10.m1.8.8.4.5.2.2.cmml">∑</mo><mrow id="S2.E10.m1.8.8.4.5.2.3" xref="S2.E10.m1.8.8.4.5.2.3.cmml"><mi id="S2.E10.m1.8.8.4.5.2.3.2" xref="S2.E10.m1.8.8.4.5.2.3.2.cmml">n</mi><mo id="S2.E10.m1.8.8.4.5.2.3.1" xref="S2.E10.m1.8.8.4.5.2.3.1.cmml">=</mo><mn id="S2.E10.m1.8.8.4.5.2.3.3" xref="S2.E10.m1.8.8.4.5.2.3.3.cmml">1</mn></mrow><mi id="S2.E10.m1.8.8.4.5.3" xref="S2.E10.m1.8.8.4.5.3.cmml">N</mi></msubsup><msubsup id="S2.E10.m1.8.8.4.6" xref="S2.E10.m1.8.8.4.6.cmml"><mi id="S2.E10.m1.8.8.4.6.2.2" xref="S2.E10.m1.8.8.4.6.2.2.cmml">θ</mi><mrow id="S2.E10.m1.6.6.2.2.2.4" xref="S2.E10.m1.6.6.2.2.2.3.cmml"><mi id="S2.E10.m1.5.5.1.1.1.1" xref="S2.E10.m1.5.5.1.1.1.1.cmml">A</mi><mo id="S2.E10.m1.6.6.2.2.2.4.1" xref="S2.E10.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S2.E10.m1.6.6.2.2.2.2" xref="S2.E10.m1.6.6.2.2.2.2.cmml">i</mi></mrow><mrow id="S2.E10.m1.8.8.4.4.2.4" xref="S2.E10.m1.8.8.4.4.2.3.cmml"><mi id="S2.E10.m1.7.7.3.3.1.1" xref="S2.E10.m1.7.7.3.3.1.1.cmml">n</mi><mo id="S2.E10.m1.8.8.4.4.2.4.1" xref="S2.E10.m1.8.8.4.4.2.3.cmml">,</mo><mi id="S2.E10.m1.8.8.4.4.2.2" xref="S2.E10.m1.8.8.4.4.2.2.cmml">m</mi></mrow></msubsup></mrow><mi id="S2.E10.m1.8.8.6" xref="S2.E10.m1.8.8.6.cmml">N</mi></mfrac></mrow></mrow></mrow><mo id="S2.E10.m1.9.9.1.2" xref="S2.E10.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.9b"><apply id="S2.E10.m1.9.9.1.1.cmml" xref="S2.E10.m1.9.9.1"><eq id="S2.E10.m1.9.9.1.1.1.cmml" xref="S2.E10.m1.9.9.1.1.1"></eq><apply id="S2.E10.m1.9.9.1.1.2.cmml" xref="S2.E10.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.9.9.1.1.2.1.cmml" xref="S2.E10.m1.9.9.1.1.2">superscript</csymbol><apply id="S2.E10.m1.9.9.1.1.2.2.cmml" xref="S2.E10.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.9.9.1.1.2.2.1.cmml" xref="S2.E10.m1.9.9.1.1.2">subscript</csymbol><ci id="S2.E10.m1.9.9.1.1.2.2.2.cmml" xref="S2.E10.m1.9.9.1.1.2.2.2">𝑤</ci><list id="S2.E10.m1.2.2.2.3.cmml" xref="S2.E10.m1.2.2.2.4"><ci id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1">𝐴</ci><ci id="S2.E10.m1.2.2.2.2.cmml" xref="S2.E10.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S2.E10.m1.9.9.1.1.2.3.cmml" xref="S2.E10.m1.9.9.1.1.2.3"><plus id="S2.E10.m1.9.9.1.1.2.3.1.cmml" xref="S2.E10.m1.9.9.1.1.2.3.1"></plus><ci id="S2.E10.m1.9.9.1.1.2.3.2.cmml" xref="S2.E10.m1.9.9.1.1.2.3.2">𝑚</ci><cn type="integer" id="S2.E10.m1.9.9.1.1.2.3.3.cmml" xref="S2.E10.m1.9.9.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E10.m1.9.9.1.1.3.cmml" xref="S2.E10.m1.9.9.1.1.3"><minus id="S2.E10.m1.9.9.1.1.3.1.cmml" xref="S2.E10.m1.9.9.1.1.3.1"></minus><apply id="S2.E10.m1.9.9.1.1.3.2.cmml" xref="S2.E10.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.9.9.1.1.3.2.1.cmml" xref="S2.E10.m1.9.9.1.1.3.2">superscript</csymbol><apply id="S2.E10.m1.9.9.1.1.3.2.2.cmml" xref="S2.E10.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.9.9.1.1.3.2.2.1.cmml" xref="S2.E10.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S2.E10.m1.9.9.1.1.3.2.2.2.cmml" xref="S2.E10.m1.9.9.1.1.3.2.2.2">𝑤</ci><list id="S2.E10.m1.4.4.2.3.cmml" xref="S2.E10.m1.4.4.2.4"><ci id="S2.E10.m1.3.3.1.1.cmml" xref="S2.E10.m1.3.3.1.1">𝐴</ci><ci id="S2.E10.m1.4.4.2.2.cmml" xref="S2.E10.m1.4.4.2.2">𝑖</ci></list></apply><ci id="S2.E10.m1.9.9.1.1.3.2.3.cmml" xref="S2.E10.m1.9.9.1.1.3.2.3">𝑚</ci></apply><apply id="S2.E10.m1.9.9.1.1.3.3.cmml" xref="S2.E10.m1.9.9.1.1.3.3"><times id="S2.E10.m1.9.9.1.1.3.3.1.cmml" xref="S2.E10.m1.9.9.1.1.3.3.1"></times><ci id="S2.E10.m1.9.9.1.1.3.3.2.cmml" xref="S2.E10.m1.9.9.1.1.3.3.2">𝜂</ci><apply id="S2.E10.m1.8.8.cmml" xref="S2.E10.m1.8.8"><divide id="S2.E10.m1.8.8.5.cmml" xref="S2.E10.m1.8.8"></divide><apply id="S2.E10.m1.8.8.4.cmml" xref="S2.E10.m1.8.8.4"><apply id="S2.E10.m1.8.8.4.5.cmml" xref="S2.E10.m1.8.8.4.5"><csymbol cd="ambiguous" id="S2.E10.m1.8.8.4.5.1.cmml" xref="S2.E10.m1.8.8.4.5">superscript</csymbol><apply id="S2.E10.m1.8.8.4.5.2.cmml" xref="S2.E10.m1.8.8.4.5"><csymbol cd="ambiguous" id="S2.E10.m1.8.8.4.5.2.1.cmml" xref="S2.E10.m1.8.8.4.5">subscript</csymbol><sum id="S2.E10.m1.8.8.4.5.2.2.cmml" xref="S2.E10.m1.8.8.4.5.2.2"></sum><apply id="S2.E10.m1.8.8.4.5.2.3.cmml" xref="S2.E10.m1.8.8.4.5.2.3"><eq id="S2.E10.m1.8.8.4.5.2.3.1.cmml" xref="S2.E10.m1.8.8.4.5.2.3.1"></eq><ci id="S2.E10.m1.8.8.4.5.2.3.2.cmml" xref="S2.E10.m1.8.8.4.5.2.3.2">𝑛</ci><cn type="integer" id="S2.E10.m1.8.8.4.5.2.3.3.cmml" xref="S2.E10.m1.8.8.4.5.2.3.3">1</cn></apply></apply><ci id="S2.E10.m1.8.8.4.5.3.cmml" xref="S2.E10.m1.8.8.4.5.3">𝑁</ci></apply><apply id="S2.E10.m1.8.8.4.6.cmml" xref="S2.E10.m1.8.8.4.6"><csymbol cd="ambiguous" id="S2.E10.m1.8.8.4.6.1.cmml" xref="S2.E10.m1.8.8.4.6">superscript</csymbol><apply id="S2.E10.m1.8.8.4.6.2.cmml" xref="S2.E10.m1.8.8.4.6"><csymbol cd="ambiguous" id="S2.E10.m1.8.8.4.6.2.1.cmml" xref="S2.E10.m1.8.8.4.6">subscript</csymbol><ci id="S2.E10.m1.8.8.4.6.2.2.cmml" xref="S2.E10.m1.8.8.4.6.2.2">𝜃</ci><list id="S2.E10.m1.6.6.2.2.2.3.cmml" xref="S2.E10.m1.6.6.2.2.2.4"><ci id="S2.E10.m1.5.5.1.1.1.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1">𝐴</ci><ci id="S2.E10.m1.6.6.2.2.2.2.cmml" xref="S2.E10.m1.6.6.2.2.2.2">𝑖</ci></list></apply><list id="S2.E10.m1.8.8.4.4.2.3.cmml" xref="S2.E10.m1.8.8.4.4.2.4"><ci id="S2.E10.m1.7.7.3.3.1.1.cmml" xref="S2.E10.m1.7.7.3.3.1.1">𝑛</ci><ci id="S2.E10.m1.8.8.4.4.2.2.cmml" xref="S2.E10.m1.8.8.4.4.2.2">𝑚</ci></list></apply></apply><ci id="S2.E10.m1.8.8.6.cmml" xref="S2.E10.m1.8.8.6">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.9c">w_{A,i}^{m+1}=w_{A,i}^{m}-\eta\frac{\sum_{n=1}^{N}\theta_{A,i}^{n,m}}{N},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.12" class="ltx_p">where <math id="S2.SS3.p2.1.m1.2" class="ltx_Math" alttext="w_{A,i}^{m}+1" display="inline"><semantics id="S2.SS3.p2.1.m1.2a"><mrow id="S2.SS3.p2.1.m1.2.3" xref="S2.SS3.p2.1.m1.2.3.cmml"><msubsup id="S2.SS3.p2.1.m1.2.3.2" xref="S2.SS3.p2.1.m1.2.3.2.cmml"><mi id="S2.SS3.p2.1.m1.2.3.2.2.2" xref="S2.SS3.p2.1.m1.2.3.2.2.2.cmml">w</mi><mrow id="S2.SS3.p2.1.m1.2.2.2.4" xref="S2.SS3.p2.1.m1.2.2.2.3.cmml"><mi id="S2.SS3.p2.1.m1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.1.m1.2.2.2.4.1" xref="S2.SS3.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.1.m1.2.2.2.2" xref="S2.SS3.p2.1.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS3.p2.1.m1.2.3.2.3" xref="S2.SS3.p2.1.m1.2.3.2.3.cmml">m</mi></msubsup><mo id="S2.SS3.p2.1.m1.2.3.1" xref="S2.SS3.p2.1.m1.2.3.1.cmml">+</mo><mn id="S2.SS3.p2.1.m1.2.3.3" xref="S2.SS3.p2.1.m1.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.2b"><apply id="S2.SS3.p2.1.m1.2.3.cmml" xref="S2.SS3.p2.1.m1.2.3"><plus id="S2.SS3.p2.1.m1.2.3.1.cmml" xref="S2.SS3.p2.1.m1.2.3.1"></plus><apply id="S2.SS3.p2.1.m1.2.3.2.cmml" xref="S2.SS3.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.2.3.2.1.cmml" xref="S2.SS3.p2.1.m1.2.3.2">superscript</csymbol><apply id="S2.SS3.p2.1.m1.2.3.2.2.cmml" xref="S2.SS3.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.2.3.2.2.1.cmml" xref="S2.SS3.p2.1.m1.2.3.2">subscript</csymbol><ci id="S2.SS3.p2.1.m1.2.3.2.2.2.cmml" xref="S2.SS3.p2.1.m1.2.3.2.2.2">𝑤</ci><list id="S2.SS3.p2.1.m1.2.2.2.3.cmml" xref="S2.SS3.p2.1.m1.2.2.2.4"><ci id="S2.SS3.p2.1.m1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.1.m1.2.2.2.2.cmml" xref="S2.SS3.p2.1.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S2.SS3.p2.1.m1.2.3.2.3.cmml" xref="S2.SS3.p2.1.m1.2.3.2.3">𝑚</ci></apply><cn type="integer" id="S2.SS3.p2.1.m1.2.3.3.cmml" xref="S2.SS3.p2.1.m1.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.2c">w_{A,i}^{m}+1</annotation></semantics></math> and <math id="S2.SS3.p2.2.m2.2" class="ltx_Math" alttext="w_{A,i}^{m}" display="inline"><semantics id="S2.SS3.p2.2.m2.2a"><msubsup id="S2.SS3.p2.2.m2.2.3" xref="S2.SS3.p2.2.m2.2.3.cmml"><mi id="S2.SS3.p2.2.m2.2.3.2.2" xref="S2.SS3.p2.2.m2.2.3.2.2.cmml">w</mi><mrow id="S2.SS3.p2.2.m2.2.2.2.4" xref="S2.SS3.p2.2.m2.2.2.2.3.cmml"><mi id="S2.SS3.p2.2.m2.1.1.1.1" xref="S2.SS3.p2.2.m2.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.2.m2.2.2.2.4.1" xref="S2.SS3.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.2.m2.2.2.2.2" xref="S2.SS3.p2.2.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS3.p2.2.m2.2.3.3" xref="S2.SS3.p2.2.m2.2.3.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.2b"><apply id="S2.SS3.p2.2.m2.2.3.cmml" xref="S2.SS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.2.3.1.cmml" xref="S2.SS3.p2.2.m2.2.3">superscript</csymbol><apply id="S2.SS3.p2.2.m2.2.3.2.cmml" xref="S2.SS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.2.3.2.1.cmml" xref="S2.SS3.p2.2.m2.2.3">subscript</csymbol><ci id="S2.SS3.p2.2.m2.2.3.2.2.cmml" xref="S2.SS3.p2.2.m2.2.3.2.2">𝑤</ci><list id="S2.SS3.p2.2.m2.2.2.2.3.cmml" xref="S2.SS3.p2.2.m2.2.2.2.4"><ci id="S2.SS3.p2.2.m2.1.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.2.m2.2.2.2.2.cmml" xref="S2.SS3.p2.2.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S2.SS3.p2.2.m2.2.3.3.cmml" xref="S2.SS3.p2.2.m2.2.3.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.2c">w_{A,i}^{m}</annotation></semantics></math> are the <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><mi id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">i</annotation></semantics></math>-th global model parameters of the <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">A</annotation></semantics></math>-th layer after the <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="m+1" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mrow id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">m</mi><mo id="S2.SS3.p2.5.m5.1.1.1" xref="S2.SS3.p2.5.m5.1.1.1.cmml">+</mo><mn id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><plus id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1"></plus><ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">𝑚</ci><cn type="integer" id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">m+1</annotation></semantics></math>-th or <math id="S2.SS3.p2.6.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.p2.6.m6.1a"><mi id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><ci id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">m</annotation></semantics></math>-th updates, <math id="S2.SS3.p2.7.m7.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S2.SS3.p2.7.m7.1a"><mi id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><ci id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">\eta</annotation></semantics></math> is the learning rate, <math id="S2.SS3.p2.8.m8.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS3.p2.8.m8.1a"><mi id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><ci id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">N</annotation></semantics></math> is the number of clients, and <math id="S2.SS3.p2.9.m9.4" class="ltx_Math" alttext="\theta_{A,i}^{n,m}" display="inline"><semantics id="S2.SS3.p2.9.m9.4a"><msubsup id="S2.SS3.p2.9.m9.4.5" xref="S2.SS3.p2.9.m9.4.5.cmml"><mi id="S2.SS3.p2.9.m9.4.5.2.2" xref="S2.SS3.p2.9.m9.4.5.2.2.cmml">θ</mi><mrow id="S2.SS3.p2.9.m9.2.2.2.4" xref="S2.SS3.p2.9.m9.2.2.2.3.cmml"><mi id="S2.SS3.p2.9.m9.1.1.1.1" xref="S2.SS3.p2.9.m9.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.9.m9.2.2.2.4.1" xref="S2.SS3.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.9.m9.2.2.2.2" xref="S2.SS3.p2.9.m9.2.2.2.2.cmml">i</mi></mrow><mrow id="S2.SS3.p2.9.m9.4.4.2.4" xref="S2.SS3.p2.9.m9.4.4.2.3.cmml"><mi id="S2.SS3.p2.9.m9.3.3.1.1" xref="S2.SS3.p2.9.m9.3.3.1.1.cmml">n</mi><mo id="S2.SS3.p2.9.m9.4.4.2.4.1" xref="S2.SS3.p2.9.m9.4.4.2.3.cmml">,</mo><mi id="S2.SS3.p2.9.m9.4.4.2.2" xref="S2.SS3.p2.9.m9.4.4.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m9.4b"><apply id="S2.SS3.p2.9.m9.4.5.cmml" xref="S2.SS3.p2.9.m9.4.5"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m9.4.5.1.cmml" xref="S2.SS3.p2.9.m9.4.5">superscript</csymbol><apply id="S2.SS3.p2.9.m9.4.5.2.cmml" xref="S2.SS3.p2.9.m9.4.5"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m9.4.5.2.1.cmml" xref="S2.SS3.p2.9.m9.4.5">subscript</csymbol><ci id="S2.SS3.p2.9.m9.4.5.2.2.cmml" xref="S2.SS3.p2.9.m9.4.5.2.2">𝜃</ci><list id="S2.SS3.p2.9.m9.2.2.2.3.cmml" xref="S2.SS3.p2.9.m9.2.2.2.4"><ci id="S2.SS3.p2.9.m9.1.1.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.9.m9.2.2.2.2.cmml" xref="S2.SS3.p2.9.m9.2.2.2.2">𝑖</ci></list></apply><list id="S2.SS3.p2.9.m9.4.4.2.3.cmml" xref="S2.SS3.p2.9.m9.4.4.2.4"><ci id="S2.SS3.p2.9.m9.3.3.1.1.cmml" xref="S2.SS3.p2.9.m9.3.3.1.1">𝑛</ci><ci id="S2.SS3.p2.9.m9.4.4.2.2.cmml" xref="S2.SS3.p2.9.m9.4.4.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m9.4c">\theta_{A,i}^{n,m}</annotation></semantics></math> is the gradient for updating <math id="S2.SS3.p2.10.m10.2" class="ltx_Math" alttext="w_{A,i}^{m}" display="inline"><semantics id="S2.SS3.p2.10.m10.2a"><msubsup id="S2.SS3.p2.10.m10.2.3" xref="S2.SS3.p2.10.m10.2.3.cmml"><mi id="S2.SS3.p2.10.m10.2.3.2.2" xref="S2.SS3.p2.10.m10.2.3.2.2.cmml">w</mi><mrow id="S2.SS3.p2.10.m10.2.2.2.4" xref="S2.SS3.p2.10.m10.2.2.2.3.cmml"><mi id="S2.SS3.p2.10.m10.1.1.1.1" xref="S2.SS3.p2.10.m10.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.10.m10.2.2.2.4.1" xref="S2.SS3.p2.10.m10.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.10.m10.2.2.2.2" xref="S2.SS3.p2.10.m10.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS3.p2.10.m10.2.3.3" xref="S2.SS3.p2.10.m10.2.3.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m10.2b"><apply id="S2.SS3.p2.10.m10.2.3.cmml" xref="S2.SS3.p2.10.m10.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.2.3.1.cmml" xref="S2.SS3.p2.10.m10.2.3">superscript</csymbol><apply id="S2.SS3.p2.10.m10.2.3.2.cmml" xref="S2.SS3.p2.10.m10.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.2.3.2.1.cmml" xref="S2.SS3.p2.10.m10.2.3">subscript</csymbol><ci id="S2.SS3.p2.10.m10.2.3.2.2.cmml" xref="S2.SS3.p2.10.m10.2.3.2.2">𝑤</ci><list id="S2.SS3.p2.10.m10.2.2.2.3.cmml" xref="S2.SS3.p2.10.m10.2.2.2.4"><ci id="S2.SS3.p2.10.m10.1.1.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.10.m10.2.2.2.2.cmml" xref="S2.SS3.p2.10.m10.2.2.2.2">𝑖</ci></list></apply><ci id="S2.SS3.p2.10.m10.2.3.3.cmml" xref="S2.SS3.p2.10.m10.2.3.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m10.2c">w_{A,i}^{m}</annotation></semantics></math> calculated by the <math id="S2.SS3.p2.11.m11.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS3.p2.11.m11.1a"><mi id="S2.SS3.p2.11.m11.1.1" xref="S2.SS3.p2.11.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.11.m11.1b"><ci id="S2.SS3.p2.11.m11.1.1.cmml" xref="S2.SS3.p2.11.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.11.m11.1c">n</annotation></semantics></math>-th client.
The parameter update is carried out for each batch training.
Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> depicts the gradients obtained from training using a plain FedSGD.
In this figure, <math id="S2.SS3.p2.12.m12.1" class="ltx_Math" alttext="Max" display="inline"><semantics id="S2.SS3.p2.12.m12.1a"><mrow id="S2.SS3.p2.12.m12.1.1" xref="S2.SS3.p2.12.m12.1.1.cmml"><mi id="S2.SS3.p2.12.m12.1.1.2" xref="S2.SS3.p2.12.m12.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.12.m12.1.1.1" xref="S2.SS3.p2.12.m12.1.1.1.cmml">​</mo><mi id="S2.SS3.p2.12.m12.1.1.3" xref="S2.SS3.p2.12.m12.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.12.m12.1.1.1a" xref="S2.SS3.p2.12.m12.1.1.1.cmml">​</mo><mi id="S2.SS3.p2.12.m12.1.1.4" xref="S2.SS3.p2.12.m12.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.12.m12.1b"><apply id="S2.SS3.p2.12.m12.1.1.cmml" xref="S2.SS3.p2.12.m12.1.1"><times id="S2.SS3.p2.12.m12.1.1.1.cmml" xref="S2.SS3.p2.12.m12.1.1.1"></times><ci id="S2.SS3.p2.12.m12.1.1.2.cmml" xref="S2.SS3.p2.12.m12.1.1.2">𝑀</ci><ci id="S2.SS3.p2.12.m12.1.1.3.cmml" xref="S2.SS3.p2.12.m12.1.1.3">𝑎</ci><ci id="S2.SS3.p2.12.m12.1.1.4.cmml" xref="S2.SS3.p2.12.m12.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.12.m12.1c">Max</annotation></semantics></math> is the number of gradients in each layer.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">The fixed-position method enhances security but does not learn the positional embeddin layer.
Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows gradients transmitted in federated learning with the fixed-position method.
All the gradients in the positional embedding layer are changed to 0.
In this case, the learning process is described as follows.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<blockquote id="S2.SS3.p4.1" class="ltx_quote">
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S2.I1.i1.1.1.1" class="ltx_text ltx_font_bold">Step 1:</span></span> 
<div id="S2.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i1.p1.1" class="ltx_p">A server sends global model information to each client.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S2.I1.i2.1.1.1" class="ltx_text ltx_font_bold">Step 2:</span></span> 
<div id="S2.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i2.p1.1" class="ltx_p">Each client trains each local model using his/her own dataset.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S2.I1.i3.1.1.1" class="ltx_text ltx_font_bold">Step 3:</span></span> 
<div id="S2.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i3.p1.1" class="ltx_p">Each client converts gradients in the positional embedding layer to 0.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S2.I1.i4.1.1.1" class="ltx_text ltx_font_bold">Step 4:</span></span> 
<div id="S2.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i4.p1.1" class="ltx_p">Each client sends the updated gradients to the server.</p>
</div>
</li>
<li id="S2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S2.I1.i5.1.1.1" class="ltx_text ltx_font_bold">Step 5:</span></span> 
<div id="S2.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i5.p1.1" class="ltx_p">The server integrates the information sent from all the clients and updates the global model.</p>
</div>
</li>
</ol>
</blockquote>
<p id="S2.SS3.p4.2" class="ltx_p">We repeat the steps a specified number of times.
The fixed-position method is highly robust against APRIL.
The attacker can be a server, one of the clients, or an external third party; the security enhancement method is effective against all of them.
The method, however, changes all gradients in the positional embedding layer to zero, so we cannot update the parameters.
This leads to severe degradation in model performance when learning a model without pre-training.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We propose a novel method that enhances security for federated learning using ViT.
The proposed method is robust against APRIL without affecting model performance.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Main Procedure</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The following series of steps is the main procedure for the federated learning to which the proposed method is applied.</p>
<blockquote id="S3.SS1.p1.2" class="ltx_quote">
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i1.1.1.1" class="ltx_text ltx_font_bold">Step 1:</span></span> 
<div id="S3.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i1.p1.1" class="ltx_p">A server sends global model information to each client.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i2.1.1.1" class="ltx_text ltx_font_bold">Step 2:</span></span> 
<div id="S3.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i2.p1.1" class="ltx_p">Each client trains each local model using his/her own dataset.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i3.1.1.1" class="ltx_text ltx_font_bold">Step 3:</span></span> 
<div id="S3.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i3.p1.1" class="ltx_p">Each client multiplies gradients by a random binary sequence.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i4.1.1.1" class="ltx_text ltx_font_bold">Step 4:</span></span> 
<div id="S3.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i4.p1.1" class="ltx_p">Each client sends the updated gradients to the server.</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i5.1.1.1" class="ltx_text ltx_font_bold">Step 5:</span></span> 
<div id="S3.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i5.p1.1" class="ltx_p">The server integrates the information sent from all the clients and updates the global model.</p>
</div>
</li>
</ol>
</blockquote>
<p id="S3.SS1.p1.3" class="ltx_p">We repeat this procedure a predefined number of times.
The main difference from the previous method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is Step 3.
Next, we explain Steps 3 and 5 in more detail.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Multiplication of Random Binary Weights</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><a href="#S2.F3" title="Figure 3 ‣ 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates a simplified gradient processing for each layer of ViT in the proposed method.
In Step 3, each client multiplies gradients by random binary weights <math id="S3.SS2.p1.1.m1.6" class="ltx_Math" alttext="B_{A,i}^{n,m}\in\{0,1\}" display="inline"><semantics id="S3.SS2.p1.1.m1.6a"><mrow id="S3.SS2.p1.1.m1.6.7" xref="S3.SS2.p1.1.m1.6.7.cmml"><msubsup id="S3.SS2.p1.1.m1.6.7.2" xref="S3.SS2.p1.1.m1.6.7.2.cmml"><mi id="S3.SS2.p1.1.m1.6.7.2.2.2" xref="S3.SS2.p1.1.m1.6.7.2.2.2.cmml">B</mi><mrow id="S3.SS2.p1.1.m1.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">A</mi><mo id="S3.SS2.p1.1.m1.2.2.2.4.1" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.1.m1.4.4.2.4" xref="S3.SS2.p1.1.m1.4.4.2.3.cmml"><mi id="S3.SS2.p1.1.m1.3.3.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.cmml">n</mi><mo id="S3.SS2.p1.1.m1.4.4.2.4.1" xref="S3.SS2.p1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.4.4.2.2" xref="S3.SS2.p1.1.m1.4.4.2.2.cmml">m</mi></mrow></msubsup><mo id="S3.SS2.p1.1.m1.6.7.1" xref="S3.SS2.p1.1.m1.6.7.1.cmml">∈</mo><mrow id="S3.SS2.p1.1.m1.6.7.3.2" xref="S3.SS2.p1.1.m1.6.7.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.6.7.3.2.1" xref="S3.SS2.p1.1.m1.6.7.3.1.cmml">{</mo><mn id="S3.SS2.p1.1.m1.5.5" xref="S3.SS2.p1.1.m1.5.5.cmml">0</mn><mo id="S3.SS2.p1.1.m1.6.7.3.2.2" xref="S3.SS2.p1.1.m1.6.7.3.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.6.6" xref="S3.SS2.p1.1.m1.6.6.cmml">1</mn><mo stretchy="false" id="S3.SS2.p1.1.m1.6.7.3.2.3" xref="S3.SS2.p1.1.m1.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.6b"><apply id="S3.SS2.p1.1.m1.6.7.cmml" xref="S3.SS2.p1.1.m1.6.7"><in id="S3.SS2.p1.1.m1.6.7.1.cmml" xref="S3.SS2.p1.1.m1.6.7.1"></in><apply id="S3.SS2.p1.1.m1.6.7.2.cmml" xref="S3.SS2.p1.1.m1.6.7.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.7.2.1.cmml" xref="S3.SS2.p1.1.m1.6.7.2">superscript</csymbol><apply id="S3.SS2.p1.1.m1.6.7.2.2.cmml" xref="S3.SS2.p1.1.m1.6.7.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.7.2.2.1.cmml" xref="S3.SS2.p1.1.m1.6.7.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.7.2.2.2.cmml" xref="S3.SS2.p1.1.m1.6.7.2.2.2">𝐵</ci><list id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4"><ci id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">𝐴</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.1.m1.4.4.2.3.cmml" xref="S3.SS2.p1.1.m1.4.4.2.4"><ci id="S3.SS2.p1.1.m1.3.3.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1">𝑛</ci><ci id="S3.SS2.p1.1.m1.4.4.2.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2">𝑚</ci></list></apply><set id="S3.SS2.p1.1.m1.6.7.3.1.cmml" xref="S3.SS2.p1.1.m1.6.7.3.2"><cn type="integer" id="S3.SS2.p1.1.m1.5.5.cmml" xref="S3.SS2.p1.1.m1.5.5">0</cn><cn type="integer" id="S3.SS2.p1.1.m1.6.6.cmml" xref="S3.SS2.p1.1.m1.6.6">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.6c">B_{A,i}^{n,m}\in\{0,1\}</annotation></semantics></math>.
Here, a weighted gradient <math id="S3.SS2.p1.2.m2.4" class="ltx_Math" alttext="\theta_{A,i}^{n,m^{\prime}}" display="inline"><semantics id="S3.SS2.p1.2.m2.4a"><msubsup id="S3.SS2.p1.2.m2.4.5" xref="S3.SS2.p1.2.m2.4.5.cmml"><mi id="S3.SS2.p1.2.m2.4.5.2.2" xref="S3.SS2.p1.2.m2.4.5.2.2.cmml">θ</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.4" xref="S3.SS2.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml">A</mi><mo id="S3.SS2.p1.2.m2.2.2.2.4.1" xref="S3.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.2.m2.4.4.2.2" xref="S3.SS2.p1.2.m2.4.4.2.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.cmml">n</mi><mo id="S3.SS2.p1.2.m2.4.4.2.2.2" xref="S3.SS2.p1.2.m2.4.4.2.3.cmml">,</mo><msup id="S3.SS2.p1.2.m2.4.4.2.2.1" xref="S3.SS2.p1.2.m2.4.4.2.2.1.cmml"><mi id="S3.SS2.p1.2.m2.4.4.2.2.1.2" xref="S3.SS2.p1.2.m2.4.4.2.2.1.2.cmml">m</mi><mo id="S3.SS2.p1.2.m2.4.4.2.2.1.3" xref="S3.SS2.p1.2.m2.4.4.2.2.1.3.cmml">′</mo></msup></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.4b"><apply id="S3.SS2.p1.2.m2.4.5.cmml" xref="S3.SS2.p1.2.m2.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.5.1.cmml" xref="S3.SS2.p1.2.m2.4.5">superscript</csymbol><apply id="S3.SS2.p1.2.m2.4.5.2.cmml" xref="S3.SS2.p1.2.m2.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.5.2.1.cmml" xref="S3.SS2.p1.2.m2.4.5">subscript</csymbol><ci id="S3.SS2.p1.2.m2.4.5.2.2.cmml" xref="S3.SS2.p1.2.m2.4.5.2.2">𝜃</ci><list id="S3.SS2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.4"><ci id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1">𝐴</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.2.m2.4.4.2.3.cmml" xref="S3.SS2.p1.2.m2.4.4.2.2"><ci id="S3.SS2.p1.2.m2.3.3.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1">𝑛</ci><apply id="S3.SS2.p1.2.m2.4.4.2.2.1.cmml" xref="S3.SS2.p1.2.m2.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.4.2.2.1.1.cmml" xref="S3.SS2.p1.2.m2.4.4.2.2.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.4.4.2.2.1.2.cmml" xref="S3.SS2.p1.2.m2.4.4.2.2.1.2">𝑚</ci><ci id="S3.SS2.p1.2.m2.4.4.2.2.1.3.cmml" xref="S3.SS2.p1.2.m2.4.4.2.2.1.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.4c">\theta_{A,i}^{n,m^{\prime}}</annotation></semantics></math> is given by</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.13" class="ltx_Math" alttext="\theta_{A,i}^{n,m^{\prime}}=B_{A,i}^{n,m}\times\theta_{A,i}^{n,m}," display="block"><semantics id="S3.E11.m1.13a"><mrow id="S3.E11.m1.13.13.1" xref="S3.E11.m1.13.13.1.1.cmml"><mrow id="S3.E11.m1.13.13.1.1" xref="S3.E11.m1.13.13.1.1.cmml"><msubsup id="S3.E11.m1.13.13.1.1.2" xref="S3.E11.m1.13.13.1.1.2.cmml"><mi id="S3.E11.m1.13.13.1.1.2.2.2" xref="S3.E11.m1.13.13.1.1.2.2.2.cmml">θ</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">A</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E11.m1.4.4.2.2" xref="S3.E11.m1.4.4.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">n</mi><mo id="S3.E11.m1.4.4.2.2.2" xref="S3.E11.m1.4.4.2.3.cmml">,</mo><msup id="S3.E11.m1.4.4.2.2.1" xref="S3.E11.m1.4.4.2.2.1.cmml"><mi id="S3.E11.m1.4.4.2.2.1.2" xref="S3.E11.m1.4.4.2.2.1.2.cmml">m</mi><mo id="S3.E11.m1.4.4.2.2.1.3" xref="S3.E11.m1.4.4.2.2.1.3.cmml">′</mo></msup></mrow></msubsup><mo id="S3.E11.m1.13.13.1.1.1" xref="S3.E11.m1.13.13.1.1.1.cmml">=</mo><mrow id="S3.E11.m1.13.13.1.1.3" xref="S3.E11.m1.13.13.1.1.3.cmml"><msubsup id="S3.E11.m1.13.13.1.1.3.2" xref="S3.E11.m1.13.13.1.1.3.2.cmml"><mi id="S3.E11.m1.13.13.1.1.3.2.2.2" xref="S3.E11.m1.13.13.1.1.3.2.2.2.cmml">B</mi><mrow id="S3.E11.m1.6.6.2.4" xref="S3.E11.m1.6.6.2.3.cmml"><mi id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml">A</mi><mo id="S3.E11.m1.6.6.2.4.1" xref="S3.E11.m1.6.6.2.3.cmml">,</mo><mi id="S3.E11.m1.6.6.2.2" xref="S3.E11.m1.6.6.2.2.cmml">i</mi></mrow><mrow id="S3.E11.m1.8.8.2.4" xref="S3.E11.m1.8.8.2.3.cmml"><mi id="S3.E11.m1.7.7.1.1" xref="S3.E11.m1.7.7.1.1.cmml">n</mi><mo id="S3.E11.m1.8.8.2.4.1" xref="S3.E11.m1.8.8.2.3.cmml">,</mo><mi id="S3.E11.m1.8.8.2.2" xref="S3.E11.m1.8.8.2.2.cmml">m</mi></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E11.m1.13.13.1.1.3.1" xref="S3.E11.m1.13.13.1.1.3.1.cmml">×</mo><msubsup id="S3.E11.m1.13.13.1.1.3.3" xref="S3.E11.m1.13.13.1.1.3.3.cmml"><mi id="S3.E11.m1.13.13.1.1.3.3.2.2" xref="S3.E11.m1.13.13.1.1.3.3.2.2.cmml">θ</mi><mrow id="S3.E11.m1.10.10.2.4" xref="S3.E11.m1.10.10.2.3.cmml"><mi id="S3.E11.m1.9.9.1.1" xref="S3.E11.m1.9.9.1.1.cmml">A</mi><mo id="S3.E11.m1.10.10.2.4.1" xref="S3.E11.m1.10.10.2.3.cmml">,</mo><mi id="S3.E11.m1.10.10.2.2" xref="S3.E11.m1.10.10.2.2.cmml">i</mi></mrow><mrow id="S3.E11.m1.12.12.2.4" xref="S3.E11.m1.12.12.2.3.cmml"><mi id="S3.E11.m1.11.11.1.1" xref="S3.E11.m1.11.11.1.1.cmml">n</mi><mo id="S3.E11.m1.12.12.2.4.1" xref="S3.E11.m1.12.12.2.3.cmml">,</mo><mi id="S3.E11.m1.12.12.2.2" xref="S3.E11.m1.12.12.2.2.cmml">m</mi></mrow></msubsup></mrow></mrow><mo id="S3.E11.m1.13.13.1.2" xref="S3.E11.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.13b"><apply id="S3.E11.m1.13.13.1.1.cmml" xref="S3.E11.m1.13.13.1"><eq id="S3.E11.m1.13.13.1.1.1.cmml" xref="S3.E11.m1.13.13.1.1.1"></eq><apply id="S3.E11.m1.13.13.1.1.2.cmml" xref="S3.E11.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.2.1.cmml" xref="S3.E11.m1.13.13.1.1.2">superscript</csymbol><apply id="S3.E11.m1.13.13.1.1.2.2.cmml" xref="S3.E11.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.2.2.1.cmml" xref="S3.E11.m1.13.13.1.1.2">subscript</csymbol><ci id="S3.E11.m1.13.13.1.1.2.2.2.cmml" xref="S3.E11.m1.13.13.1.1.2.2.2">𝜃</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝐴</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.E11.m1.4.4.2.3.cmml" xref="S3.E11.m1.4.4.2.2"><ci id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1">𝑛</ci><apply id="S3.E11.m1.4.4.2.2.1.cmml" xref="S3.E11.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.2.2.1.1.cmml" xref="S3.E11.m1.4.4.2.2.1">superscript</csymbol><ci id="S3.E11.m1.4.4.2.2.1.2.cmml" xref="S3.E11.m1.4.4.2.2.1.2">𝑚</ci><ci id="S3.E11.m1.4.4.2.2.1.3.cmml" xref="S3.E11.m1.4.4.2.2.1.3">′</ci></apply></list></apply><apply id="S3.E11.m1.13.13.1.1.3.cmml" xref="S3.E11.m1.13.13.1.1.3"><times id="S3.E11.m1.13.13.1.1.3.1.cmml" xref="S3.E11.m1.13.13.1.1.3.1"></times><apply id="S3.E11.m1.13.13.1.1.3.2.cmml" xref="S3.E11.m1.13.13.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.3.2.1.cmml" xref="S3.E11.m1.13.13.1.1.3.2">superscript</csymbol><apply id="S3.E11.m1.13.13.1.1.3.2.2.cmml" xref="S3.E11.m1.13.13.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.3.2.2.1.cmml" xref="S3.E11.m1.13.13.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.13.13.1.1.3.2.2.2.cmml" xref="S3.E11.m1.13.13.1.1.3.2.2.2">𝐵</ci><list id="S3.E11.m1.6.6.2.3.cmml" xref="S3.E11.m1.6.6.2.4"><ci id="S3.E11.m1.5.5.1.1.cmml" xref="S3.E11.m1.5.5.1.1">𝐴</ci><ci id="S3.E11.m1.6.6.2.2.cmml" xref="S3.E11.m1.6.6.2.2">𝑖</ci></list></apply><list id="S3.E11.m1.8.8.2.3.cmml" xref="S3.E11.m1.8.8.2.4"><ci id="S3.E11.m1.7.7.1.1.cmml" xref="S3.E11.m1.7.7.1.1">𝑛</ci><ci id="S3.E11.m1.8.8.2.2.cmml" xref="S3.E11.m1.8.8.2.2">𝑚</ci></list></apply><apply id="S3.E11.m1.13.13.1.1.3.3.cmml" xref="S3.E11.m1.13.13.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.3.3.1.cmml" xref="S3.E11.m1.13.13.1.1.3.3">superscript</csymbol><apply id="S3.E11.m1.13.13.1.1.3.3.2.cmml" xref="S3.E11.m1.13.13.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.13.13.1.1.3.3.2.1.cmml" xref="S3.E11.m1.13.13.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.13.13.1.1.3.3.2.2.cmml" xref="S3.E11.m1.13.13.1.1.3.3.2.2">𝜃</ci><list id="S3.E11.m1.10.10.2.3.cmml" xref="S3.E11.m1.10.10.2.4"><ci id="S3.E11.m1.9.9.1.1.cmml" xref="S3.E11.m1.9.9.1.1">𝐴</ci><ci id="S3.E11.m1.10.10.2.2.cmml" xref="S3.E11.m1.10.10.2.2">𝑖</ci></list></apply><list id="S3.E11.m1.12.12.2.3.cmml" xref="S3.E11.m1.12.12.2.4"><ci id="S3.E11.m1.11.11.1.1.cmml" xref="S3.E11.m1.11.11.1.1">𝑛</ci><ci id="S3.E11.m1.12.12.2.2.cmml" xref="S3.E11.m1.12.12.2.2">𝑚</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.13c">\theta_{A,i}^{n,m^{\prime}}=B_{A,i}^{n,m}\times\theta_{A,i}^{n,m},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.6" class="ltx_p">where <math id="S3.SS2.p1.3.m1.4" class="ltx_Math" alttext="B_{A,i}^{n,m}" display="inline"><semantics id="S3.SS2.p1.3.m1.4a"><msubsup id="S3.SS2.p1.3.m1.4.5" xref="S3.SS2.p1.3.m1.4.5.cmml"><mi id="S3.SS2.p1.3.m1.4.5.2.2" xref="S3.SS2.p1.3.m1.4.5.2.2.cmml">B</mi><mrow id="S3.SS2.p1.3.m1.2.2.2.4" xref="S3.SS2.p1.3.m1.2.2.2.3.cmml"><mi id="S3.SS2.p1.3.m1.1.1.1.1" xref="S3.SS2.p1.3.m1.1.1.1.1.cmml">A</mi><mo id="S3.SS2.p1.3.m1.2.2.2.4.1" xref="S3.SS2.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.3.m1.2.2.2.2" xref="S3.SS2.p1.3.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.3.m1.4.4.2.4" xref="S3.SS2.p1.3.m1.4.4.2.3.cmml"><mi id="S3.SS2.p1.3.m1.3.3.1.1" xref="S3.SS2.p1.3.m1.3.3.1.1.cmml">n</mi><mo id="S3.SS2.p1.3.m1.4.4.2.4.1" xref="S3.SS2.p1.3.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.3.m1.4.4.2.2" xref="S3.SS2.p1.3.m1.4.4.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.4b"><apply id="S3.SS2.p1.3.m1.4.5.cmml" xref="S3.SS2.p1.3.m1.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.4.5.1.cmml" xref="S3.SS2.p1.3.m1.4.5">superscript</csymbol><apply id="S3.SS2.p1.3.m1.4.5.2.cmml" xref="S3.SS2.p1.3.m1.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.4.5.2.1.cmml" xref="S3.SS2.p1.3.m1.4.5">subscript</csymbol><ci id="S3.SS2.p1.3.m1.4.5.2.2.cmml" xref="S3.SS2.p1.3.m1.4.5.2.2">𝐵</ci><list id="S3.SS2.p1.3.m1.2.2.2.3.cmml" xref="S3.SS2.p1.3.m1.2.2.2.4"><ci id="S3.SS2.p1.3.m1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1.1.1">𝐴</ci><ci id="S3.SS2.p1.3.m1.2.2.2.2.cmml" xref="S3.SS2.p1.3.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.3.m1.4.4.2.3.cmml" xref="S3.SS2.p1.3.m1.4.4.2.4"><ci id="S3.SS2.p1.3.m1.3.3.1.1.cmml" xref="S3.SS2.p1.3.m1.3.3.1.1">𝑛</ci><ci id="S3.SS2.p1.3.m1.4.4.2.2.cmml" xref="S3.SS2.p1.3.m1.4.4.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.4c">B_{A,i}^{n,m}</annotation></semantics></math> is a binary weight that is multiplied by <math id="S3.SS2.p1.4.m2.4" class="ltx_Math" alttext="\theta_{A,i}^{n,m}" display="inline"><semantics id="S3.SS2.p1.4.m2.4a"><msubsup id="S3.SS2.p1.4.m2.4.5" xref="S3.SS2.p1.4.m2.4.5.cmml"><mi id="S3.SS2.p1.4.m2.4.5.2.2" xref="S3.SS2.p1.4.m2.4.5.2.2.cmml">θ</mi><mrow id="S3.SS2.p1.4.m2.2.2.2.4" xref="S3.SS2.p1.4.m2.2.2.2.3.cmml"><mi id="S3.SS2.p1.4.m2.1.1.1.1" xref="S3.SS2.p1.4.m2.1.1.1.1.cmml">A</mi><mo id="S3.SS2.p1.4.m2.2.2.2.4.1" xref="S3.SS2.p1.4.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.4.m2.2.2.2.2" xref="S3.SS2.p1.4.m2.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.4.m2.4.4.2.4" xref="S3.SS2.p1.4.m2.4.4.2.3.cmml"><mi id="S3.SS2.p1.4.m2.3.3.1.1" xref="S3.SS2.p1.4.m2.3.3.1.1.cmml">n</mi><mo id="S3.SS2.p1.4.m2.4.4.2.4.1" xref="S3.SS2.p1.4.m2.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.4.m2.4.4.2.2" xref="S3.SS2.p1.4.m2.4.4.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.4b"><apply id="S3.SS2.p1.4.m2.4.5.cmml" xref="S3.SS2.p1.4.m2.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.4.5.1.cmml" xref="S3.SS2.p1.4.m2.4.5">superscript</csymbol><apply id="S3.SS2.p1.4.m2.4.5.2.cmml" xref="S3.SS2.p1.4.m2.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.4.5.2.1.cmml" xref="S3.SS2.p1.4.m2.4.5">subscript</csymbol><ci id="S3.SS2.p1.4.m2.4.5.2.2.cmml" xref="S3.SS2.p1.4.m2.4.5.2.2">𝜃</ci><list id="S3.SS2.p1.4.m2.2.2.2.3.cmml" xref="S3.SS2.p1.4.m2.2.2.2.4"><ci id="S3.SS2.p1.4.m2.1.1.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1.1.1">𝐴</ci><ci id="S3.SS2.p1.4.m2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m2.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.4.m2.4.4.2.3.cmml" xref="S3.SS2.p1.4.m2.4.4.2.4"><ci id="S3.SS2.p1.4.m2.3.3.1.1.cmml" xref="S3.SS2.p1.4.m2.3.3.1.1">𝑛</ci><ci id="S3.SS2.p1.4.m2.4.4.2.2.cmml" xref="S3.SS2.p1.4.m2.4.4.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.4c">\theta_{A,i}^{n,m}</annotation></semantics></math>.
In the case that the occurrence probability of zeros <math id="S3.SS2.p1.5.m3.2" class="ltx_Math" alttext="R\in[0,1]" display="inline"><semantics id="S3.SS2.p1.5.m3.2a"><mrow id="S3.SS2.p1.5.m3.2.3" xref="S3.SS2.p1.5.m3.2.3.cmml"><mi id="S3.SS2.p1.5.m3.2.3.2" xref="S3.SS2.p1.5.m3.2.3.2.cmml">R</mi><mo id="S3.SS2.p1.5.m3.2.3.1" xref="S3.SS2.p1.5.m3.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p1.5.m3.2.3.3.2" xref="S3.SS2.p1.5.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m3.2.3.3.2.1" xref="S3.SS2.p1.5.m3.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p1.5.m3.1.1" xref="S3.SS2.p1.5.m3.1.1.cmml">0</mn><mo id="S3.SS2.p1.5.m3.2.3.3.2.2" xref="S3.SS2.p1.5.m3.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p1.5.m3.2.2" xref="S3.SS2.p1.5.m3.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p1.5.m3.2.3.3.2.3" xref="S3.SS2.p1.5.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m3.2b"><apply id="S3.SS2.p1.5.m3.2.3.cmml" xref="S3.SS2.p1.5.m3.2.3"><in id="S3.SS2.p1.5.m3.2.3.1.cmml" xref="S3.SS2.p1.5.m3.2.3.1"></in><ci id="S3.SS2.p1.5.m3.2.3.2.cmml" xref="S3.SS2.p1.5.m3.2.3.2">𝑅</ci><interval closure="closed" id="S3.SS2.p1.5.m3.2.3.3.1.cmml" xref="S3.SS2.p1.5.m3.2.3.3.2"><cn type="integer" id="S3.SS2.p1.5.m3.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1">0</cn><cn type="integer" id="S3.SS2.p1.5.m3.2.2.cmml" xref="S3.SS2.p1.5.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m3.2c">R\in[0,1]</annotation></semantics></math> is set higher, more robust privacy protection would be provided; however, the model may not be updated correctly.
We tackle this issue by changing the random binary weights <math id="S3.SS2.p1.6.m4.4" class="ltx_Math" alttext="B_{A,i}^{n,m}" display="inline"><semantics id="S3.SS2.p1.6.m4.4a"><msubsup id="S3.SS2.p1.6.m4.4.5" xref="S3.SS2.p1.6.m4.4.5.cmml"><mi id="S3.SS2.p1.6.m4.4.5.2.2" xref="S3.SS2.p1.6.m4.4.5.2.2.cmml">B</mi><mrow id="S3.SS2.p1.6.m4.2.2.2.4" xref="S3.SS2.p1.6.m4.2.2.2.3.cmml"><mi id="S3.SS2.p1.6.m4.1.1.1.1" xref="S3.SS2.p1.6.m4.1.1.1.1.cmml">A</mi><mo id="S3.SS2.p1.6.m4.2.2.2.4.1" xref="S3.SS2.p1.6.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.6.m4.2.2.2.2" xref="S3.SS2.p1.6.m4.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.6.m4.4.4.2.4" xref="S3.SS2.p1.6.m4.4.4.2.3.cmml"><mi id="S3.SS2.p1.6.m4.3.3.1.1" xref="S3.SS2.p1.6.m4.3.3.1.1.cmml">n</mi><mo id="S3.SS2.p1.6.m4.4.4.2.4.1" xref="S3.SS2.p1.6.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.6.m4.4.4.2.2" xref="S3.SS2.p1.6.m4.4.4.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m4.4b"><apply id="S3.SS2.p1.6.m4.4.5.cmml" xref="S3.SS2.p1.6.m4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m4.4.5.1.cmml" xref="S3.SS2.p1.6.m4.4.5">superscript</csymbol><apply id="S3.SS2.p1.6.m4.4.5.2.cmml" xref="S3.SS2.p1.6.m4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m4.4.5.2.1.cmml" xref="S3.SS2.p1.6.m4.4.5">subscript</csymbol><ci id="S3.SS2.p1.6.m4.4.5.2.2.cmml" xref="S3.SS2.p1.6.m4.4.5.2.2">𝐵</ci><list id="S3.SS2.p1.6.m4.2.2.2.3.cmml" xref="S3.SS2.p1.6.m4.2.2.2.4"><ci id="S3.SS2.p1.6.m4.1.1.1.1.cmml" xref="S3.SS2.p1.6.m4.1.1.1.1">𝐴</ci><ci id="S3.SS2.p1.6.m4.2.2.2.2.cmml" xref="S3.SS2.p1.6.m4.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.6.m4.4.4.2.3.cmml" xref="S3.SS2.p1.6.m4.4.4.2.4"><ci id="S3.SS2.p1.6.m4.3.3.1.1.cmml" xref="S3.SS2.p1.6.m4.3.3.1.1">𝑛</ci><ci id="S3.SS2.p1.6.m4.4.4.2.2.cmml" xref="S3.SS2.p1.6.m4.4.4.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m4.4c">B_{A,i}^{n,m}</annotation></semantics></math> at each epoch.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.5" class="ltx_p">It is possible to define a different probability for each layer.
The positional embedding layer <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="E_{pos}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">E</mi><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.3.1a" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.1.1.3.4" xref="S3.SS2.p2.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐸</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS2.p2.1.m1.1.1.3.4.cmml" xref="S3.SS2.p2.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">E_{pos}</annotation></semantics></math> and linear layer <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">E</annotation></semantics></math> are layers that include the major information of an image, so APRIL uses these layers for image restoration.
Thus, for instance, it would be useful to assign high probabilities for <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="E_{pos}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">E</mi><mrow id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.3.1" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.3.1a" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.3.4" xref="S3.SS2.p2.3.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐸</ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><times id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">𝑝</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑜</ci><ci id="S3.SS2.p2.3.m3.1.1.3.4.cmml" xref="S3.SS2.p2.3.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">E_{pos}</annotation></semantics></math> and <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">E</annotation></semantics></math> while assigning low probabilities for other gradients.
In this paper, we apply the same probabilities <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">R</annotation></semantics></math> to all layers to simplify the argument.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Gradient Integration</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">Next, we elaborate on the gradient integration in Step 5.
The proposed method integrates gradients on the basis of FedSGD.
However, it is not appropriate to directly apply (<a href="#S2.E10" title="In 2.3 Previous Method ‣ 2 Preparation ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) to the proposed method because each client randomly converts the gradients to 0.
The gradient integration is implemented as:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.6" class="ltx_Math" alttext="w_{A,i}^{m+1}=\begin{cases}w_{A,i}^{m}-\eta\frac{\sum_{n=1}^{N}\theta_{A,i}^{n,m^{\prime}}}{\sum_{n=1}^{N}B_{A,i}^{n,m}}&amp;\text{if $0&lt;\sum_{n=1}^{N}B_{A,i}^{n,m}\leq N$}\\
w_{A,i}^{m}&amp;\text{if $\sum_{n=1}^{N}B_{A,i}^{n,m}=0$}.\\
\end{cases}" display="block"><semantics id="S3.E12.m1.6a"><mrow id="S3.E12.m1.6.7" xref="S3.E12.m1.6.7.cmml"><msubsup id="S3.E12.m1.6.7.2" xref="S3.E12.m1.6.7.2.cmml"><mi id="S3.E12.m1.6.7.2.2.2" xref="S3.E12.m1.6.7.2.2.2.cmml">w</mi><mrow id="S3.E12.m1.6.6.2.4" xref="S3.E12.m1.6.6.2.3.cmml"><mi id="S3.E12.m1.5.5.1.1" xref="S3.E12.m1.5.5.1.1.cmml">A</mi><mo id="S3.E12.m1.6.6.2.4.1" xref="S3.E12.m1.6.6.2.3.cmml">,</mo><mi id="S3.E12.m1.6.6.2.2" xref="S3.E12.m1.6.6.2.2.cmml">i</mi></mrow><mrow id="S3.E12.m1.6.7.2.3" xref="S3.E12.m1.6.7.2.3.cmml"><mi id="S3.E12.m1.6.7.2.3.2" xref="S3.E12.m1.6.7.2.3.2.cmml">m</mi><mo id="S3.E12.m1.6.7.2.3.1" xref="S3.E12.m1.6.7.2.3.1.cmml">+</mo><mn id="S3.E12.m1.6.7.2.3.3" xref="S3.E12.m1.6.7.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E12.m1.6.7.1" xref="S3.E12.m1.6.7.1.cmml">=</mo><mrow id="S3.E12.m1.4.4" xref="S3.E12.m1.6.7.3.1.cmml"><mo id="S3.E12.m1.4.4.5" xref="S3.E12.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E12.m1.4.4.4" xref="S3.E12.m1.6.7.3.1.cmml"><mtr id="S3.E12.m1.4.4.4a" xref="S3.E12.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4b" xref="S3.E12.m1.6.7.3.1.cmml"><mrow id="S3.E12.m1.3.3.3.3.2.1" xref="S3.E12.m1.3.3.3.3.2.1.cmml"><msubsup id="S3.E12.m1.3.3.3.3.2.1.12" xref="S3.E12.m1.3.3.3.3.2.1.12.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.12.2.2" xref="S3.E12.m1.3.3.3.3.2.1.12.2.2.cmml">w</mi><mrow id="S3.E12.m1.3.3.3.3.2.1.2.2.4" xref="S3.E12.m1.3.3.3.3.2.1.2.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.1.1.1" xref="S3.E12.m1.3.3.3.3.2.1.1.1.1.cmml">A</mi><mo id="S3.E12.m1.3.3.3.3.2.1.2.2.4.1" xref="S3.E12.m1.3.3.3.3.2.1.2.2.3.cmml">,</mo><mi id="S3.E12.m1.3.3.3.3.2.1.2.2.2" xref="S3.E12.m1.3.3.3.3.2.1.2.2.2.cmml">i</mi></mrow><mi id="S3.E12.m1.3.3.3.3.2.1.12.3" xref="S3.E12.m1.3.3.3.3.2.1.12.3.cmml">m</mi></msubsup><mo id="S3.E12.m1.3.3.3.3.2.1.11" xref="S3.E12.m1.3.3.3.3.2.1.11.cmml">−</mo><mrow id="S3.E12.m1.3.3.3.3.2.1.13" xref="S3.E12.m1.3.3.3.3.2.1.13.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.13.2" xref="S3.E12.m1.3.3.3.3.2.1.13.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.3.3.2.1.13.1" xref="S3.E12.m1.3.3.3.3.2.1.13.1.cmml">​</mo><mstyle displaystyle="false" id="S3.E12.m1.3.3.3.3.2.1.10" xref="S3.E12.m1.3.3.3.3.2.1.10.cmml"><mfrac id="S3.E12.m1.3.3.3.3.2.1.10a" xref="S3.E12.m1.3.3.3.3.2.1.10.cmml"><mrow id="S3.E12.m1.3.3.3.3.2.1.6.4" xref="S3.E12.m1.3.3.3.3.2.1.6.4.cmml"><mstyle displaystyle="false" id="S3.E12.m1.3.3.3.3.2.1.6.4.5" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.cmml"><msubsup id="S3.E12.m1.3.3.3.3.2.1.6.4.5a" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.cmml"><mo id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.2.cmml">∑</mo><mrow id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.2.cmml">n</mi><mo id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.1" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.1.cmml">=</mo><mn id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.3" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.3.3.3.3.2.1.6.4.5.3" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.3.cmml">N</mi></msubsup></mstyle><msubsup id="S3.E12.m1.3.3.3.3.2.1.6.4.6" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.2.cmml">θ</mi><mrow id="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.4" xref="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.3.1.1.1.1" xref="S3.E12.m1.3.3.3.3.2.1.3.1.1.1.1.cmml">A</mi><mo id="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.4.1" xref="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.2" xref="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.5.3.3.1.1" xref="S3.E12.m1.3.3.3.3.2.1.5.3.3.1.1.cmml">n</mi><mo id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.3.cmml">,</mo><msup id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.2" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.2.cmml">m</mi><mo id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.3" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.3.cmml">′</mo></msup></mrow></msubsup></mrow><mrow id="S3.E12.m1.3.3.3.3.2.1.10.8" xref="S3.E12.m1.3.3.3.3.2.1.10.8.cmml"><mstyle displaystyle="false" id="S3.E12.m1.3.3.3.3.2.1.10.8.5" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.cmml"><msubsup id="S3.E12.m1.3.3.3.3.2.1.10.8.5a" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.cmml"><mo id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.2" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.2.cmml">∑</mo><mrow id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.2" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.2.cmml">n</mi><mo id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.1" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.1.cmml">=</mo><mn id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.3" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.3.3.3.3.2.1.10.8.5.3" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.3.cmml">N</mi></msubsup></mstyle><msubsup id="S3.E12.m1.3.3.3.3.2.1.10.8.6" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.2" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.2.cmml">B</mi><mrow id="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.4" xref="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.7.5.1.1.1" xref="S3.E12.m1.3.3.3.3.2.1.7.5.1.1.1.cmml">A</mi><mo id="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.4.1" xref="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.3.cmml">,</mo><mi id="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.2" xref="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.2.cmml">i</mi></mrow><mrow id="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.4" xref="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.2.1.9.7.3.1.1" xref="S3.E12.m1.3.3.3.3.2.1.9.7.3.1.1.cmml">n</mi><mo id="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.4.1" xref="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.3.cmml">,</mo><mi id="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.2" xref="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.2.cmml">m</mi></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4c" xref="S3.E12.m1.6.7.3.1.cmml"><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1b.cmml"><mtext id="S3.E12.m1.1.1.1.1.1.1a" xref="S3.E12.m1.1.1.1.1.1.1b.cmml">if </mtext><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.cmml"><mn id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.2.cmml">0</mn><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.3.cmml">&lt;</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.cmml"><mstyle displaystyle="false" id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.cmml"><msubsup id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1a" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.cmml"><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.2.cmml">n</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.3.cmml">N</mi></msubsup></mstyle><msubsup id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.2.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.2.2.cmml">B</mi><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">A</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4.cmml">,</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.3.3.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.3.3.1.1.cmml">n</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4.cmml">,</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.2.cmml">m</mi></mrow></msubsup></mrow><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.5" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.5.cmml">≤</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.6" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.6.cmml">N</mi></mrow></mrow></mtd></mtr><mtr id="S3.E12.m1.4.4.4d" xref="S3.E12.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4e" xref="S3.E12.m1.6.7.3.1.cmml"><msubsup id="S3.E12.m1.4.4.4.4.2.1" xref="S3.E12.m1.4.4.4.4.2.1.cmml"><mi id="S3.E12.m1.4.4.4.4.2.1.4.2" xref="S3.E12.m1.4.4.4.4.2.1.4.2.cmml">w</mi><mrow id="S3.E12.m1.4.4.4.4.2.1.2.2.4" xref="S3.E12.m1.4.4.4.4.2.1.2.2.3.cmml"><mi id="S3.E12.m1.4.4.4.4.2.1.1.1.1" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1.cmml">A</mi><mo id="S3.E12.m1.4.4.4.4.2.1.2.2.4.1" xref="S3.E12.m1.4.4.4.4.2.1.2.2.3.cmml">,</mo><mi id="S3.E12.m1.4.4.4.4.2.1.2.2.2" xref="S3.E12.m1.4.4.4.4.2.1.2.2.2.cmml">i</mi></mrow><mi id="S3.E12.m1.4.4.4.4.2.1.5" xref="S3.E12.m1.4.4.4.4.2.1.5.cmml">m</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.4.4.4f" xref="S3.E12.m1.6.7.3.1.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1b.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1b.cmml"><mtext id="S3.E12.m1.2.2.2.2.1.1.1.1a" xref="S3.E12.m1.2.2.2.2.1.1.1.1a.cmml">if </mtext><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.cmml"><mstyle displaystyle="false" id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.cmml"><msubsup id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1a" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.cmml"><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.2.cmml">n</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.3.cmml">N</mi></msubsup></mstyle><msubsup id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.2.2.cmml">B</mi><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.1.1.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.1.1.1.1.cmml">A</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.3.3.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.3.3.1.1.cmml">n</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.2.cmml">m</mi></mrow></msubsup></mrow><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.1.cmml">=</mo><mn id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.3.cmml">0</mn></mrow></mrow><mo lspace="0em" id="S3.E12.m1.2.2.2.2.1.1.3.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1b.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.6b"><apply id="S3.E12.m1.6.7.cmml" xref="S3.E12.m1.6.7"><eq id="S3.E12.m1.6.7.1.cmml" xref="S3.E12.m1.6.7.1"></eq><apply id="S3.E12.m1.6.7.2.cmml" xref="S3.E12.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E12.m1.6.7.2.1.cmml" xref="S3.E12.m1.6.7.2">superscript</csymbol><apply id="S3.E12.m1.6.7.2.2.cmml" xref="S3.E12.m1.6.7.2"><csymbol cd="ambiguous" id="S3.E12.m1.6.7.2.2.1.cmml" xref="S3.E12.m1.6.7.2">subscript</csymbol><ci id="S3.E12.m1.6.7.2.2.2.cmml" xref="S3.E12.m1.6.7.2.2.2">𝑤</ci><list id="S3.E12.m1.6.6.2.3.cmml" xref="S3.E12.m1.6.6.2.4"><ci id="S3.E12.m1.5.5.1.1.cmml" xref="S3.E12.m1.5.5.1.1">𝐴</ci><ci id="S3.E12.m1.6.6.2.2.cmml" xref="S3.E12.m1.6.6.2.2">𝑖</ci></list></apply><apply id="S3.E12.m1.6.7.2.3.cmml" xref="S3.E12.m1.6.7.2.3"><plus id="S3.E12.m1.6.7.2.3.1.cmml" xref="S3.E12.m1.6.7.2.3.1"></plus><ci id="S3.E12.m1.6.7.2.3.2.cmml" xref="S3.E12.m1.6.7.2.3.2">𝑚</ci><cn type="integer" id="S3.E12.m1.6.7.2.3.3.cmml" xref="S3.E12.m1.6.7.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.6.7.3.1.cmml" xref="S3.E12.m1.4.4"><csymbol cd="latexml" id="S3.E12.m1.6.7.3.1.1.cmml" xref="S3.E12.m1.4.4.5">cases</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1"><minus id="S3.E12.m1.3.3.3.3.2.1.11.cmml" xref="S3.E12.m1.3.3.3.3.2.1.11"></minus><apply id="S3.E12.m1.3.3.3.3.2.1.12.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.12.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12">superscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.12.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.12.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12">subscript</csymbol><ci id="S3.E12.m1.3.3.3.3.2.1.12.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12.2.2">𝑤</ci><list id="S3.E12.m1.3.3.3.3.2.1.2.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.2.2.4"><ci id="S3.E12.m1.3.3.3.3.2.1.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.1.1.1">𝐴</ci><ci id="S3.E12.m1.3.3.3.3.2.1.2.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.2.2.2">𝑖</ci></list></apply><ci id="S3.E12.m1.3.3.3.3.2.1.12.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.12.3">𝑚</ci></apply><apply id="S3.E12.m1.3.3.3.3.2.1.13.cmml" xref="S3.E12.m1.3.3.3.3.2.1.13"><times id="S3.E12.m1.3.3.3.3.2.1.13.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.13.1"></times><ci id="S3.E12.m1.3.3.3.3.2.1.13.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.13.2">𝜂</ci><apply id="S3.E12.m1.3.3.3.3.2.1.10.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10"><divide id="S3.E12.m1.3.3.3.3.2.1.10.9.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10"></divide><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4"><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.5.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.6.4.5.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5">superscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5">subscript</csymbol><sum id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.2"></sum><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3"><eq id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.1"></eq><ci id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.2">𝑛</ci><cn type="integer" id="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.3.3.3.3.2.1.6.4.5.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.5.3">𝑁</ci></apply><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.6.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.6.4.6.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6">superscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6">subscript</csymbol><ci id="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.6.2.2">𝜃</ci><list id="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.4"><ci id="S3.E12.m1.3.3.3.3.2.1.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.3.1.1.1.1">𝐴</ci><ci id="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.4.2.2.2.2">𝑖</ci></list></apply><list id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2"><ci id="S3.E12.m1.3.3.3.3.2.1.5.3.3.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.5.3.3.1.1">𝑛</ci><apply id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1">superscript</csymbol><ci id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.2">𝑚</ci><ci id="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.6.4.4.2.2.1.3">′</ci></apply></list></apply></apply><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8"><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.5.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.10.8.5.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5">superscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5">subscript</csymbol><sum id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.2"></sum><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3"><eq id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.1"></eq><ci id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.2">𝑛</ci><cn type="integer" id="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.3.3.3.3.2.1.10.8.5.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.5.3">𝑁</ci></apply><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.6.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.10.8.6.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6">superscript</csymbol><apply id="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6">subscript</csymbol><ci id="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.6.2.2">𝐵</ci><list id="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.4"><ci id="S3.E12.m1.3.3.3.3.2.1.7.5.1.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.7.5.1.1.1">𝐴</ci><ci id="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.8.6.2.2.2">𝑖</ci></list></apply><list id="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.3.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.4"><ci id="S3.E12.m1.3.3.3.3.2.1.9.7.3.1.1.cmml" xref="S3.E12.m1.3.3.3.3.2.1.9.7.3.1.1">𝑛</ci><ci id="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.2.cmml" xref="S3.E12.m1.3.3.3.3.2.1.10.8.4.2.2">𝑚</ci></list></apply></apply></apply></apply></apply><ci id="S3.E12.m1.1.1.1.1.1.1b.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><mrow id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><mtext id="S3.E12.m1.1.1.1.1.1.1a.cmml" xref="S3.E12.m1.1.1.1.1.1.1">if </mtext><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5"><mn id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.2">0</mn><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.3">&lt;</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4"><msubsup id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1"><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.2">∑</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.2">n</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.1">=</mo><mn id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.2.3.3">1</mn></mrow><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.1.3">N</mi></msubsup><msubsup id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.4.2.2.2">B</mi><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.1.1.1.1">A</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.4">,</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.2.2.2.2">i</mi></mrow><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.3.3.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.3.3.1.1">n</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.4">,</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.4.2.2">m</mi></mrow></msubsup></mrow><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.5.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.5">≤</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.6.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.m1.4.5.6">N</mi></mrow></mrow></ci><apply id="S3.E12.m1.4.4.4.4.2.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.4.4.2.1.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1">superscript</csymbol><apply id="S3.E12.m1.4.4.4.4.2.1.4.cmml" xref="S3.E12.m1.4.4.4.4.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.4.4.2.1.4.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1">subscript</csymbol><ci id="S3.E12.m1.4.4.4.4.2.1.4.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.4.2">𝑤</ci><list id="S3.E12.m1.4.4.4.4.2.1.2.2.3.cmml" xref="S3.E12.m1.4.4.4.4.2.1.2.2.4"><ci id="S3.E12.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E12.m1.4.4.4.4.2.1.1.1.1">𝐴</ci><ci id="S3.E12.m1.4.4.4.4.2.1.2.2.2.cmml" xref="S3.E12.m1.4.4.4.4.2.1.2.2.2">𝑖</ci></list></apply><ci id="S3.E12.m1.4.4.4.4.2.1.5.cmml" xref="S3.E12.m1.4.4.4.4.2.1.5">𝑚</ci></apply><ci id="S3.E12.m1.2.2.2.2.1.1.1.1b.cmml" xref="S3.E12.m1.2.2.2.2.1.1.3"><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.3"><mtext id="S3.E12.m1.2.2.2.2.1.1.1.1a.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1a">if </mtext><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5"><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2"><msubsup id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1"><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.2">∑</mo><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.2">n</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.1">=</mo><mn id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.2.3.3">1</mn></mrow><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.1.3">N</mi></msubsup><msubsup id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.2.2.2.2">B</mi><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.1.1.1.1">A</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.4">,</mo><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.2.2.2.2">i</mi></mrow><mrow id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.3.3.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.3.3.1.1">n</mi><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.4">,</mo><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.4.2.2">m</mi></mrow></msubsup></mrow><mo id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.1">=</mo><mn id="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.m1.4.5.3">0</mn></mrow></mrow></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.6c">w_{A,i}^{m+1}=\begin{cases}w_{A,i}^{m}-\eta\frac{\sum_{n=1}^{N}\theta_{A,i}^{n,m^{\prime}}}{\sum_{n=1}^{N}B_{A,i}^{n,m}}&amp;\text{if $0&lt;\sum_{n=1}^{N}B_{A,i}^{n,m}\leq N$}\\
w_{A,i}^{m}&amp;\text{if $\sum_{n=1}^{N}B_{A,i}^{n,m}=0$}.\\
\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.1" class="ltx_p">Note that zero gradients are excluded when calculating the mean of the gradients.
As an exception, parameters cannot be updated in the case of <math id="S3.SS3.p1.1.m1.4" class="ltx_Math" alttext="\sum_{n=1}^{N}B_{A,i}^{n,m}=0" display="inline"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.5" xref="S3.SS3.p1.1.m1.4.5.cmml"><mrow id="S3.SS3.p1.1.m1.4.5.2" xref="S3.SS3.p1.1.m1.4.5.2.cmml"><msubsup id="S3.SS3.p1.1.m1.4.5.2.1" xref="S3.SS3.p1.1.m1.4.5.2.1.cmml"><mo id="S3.SS3.p1.1.m1.4.5.2.1.2.2" xref="S3.SS3.p1.1.m1.4.5.2.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p1.1.m1.4.5.2.1.2.3" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.cmml"><mi id="S3.SS3.p1.1.m1.4.5.2.1.2.3.2" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.2.cmml">n</mi><mo id="S3.SS3.p1.1.m1.4.5.2.1.2.3.1" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p1.1.m1.4.5.2.1.2.3.3" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p1.1.m1.4.5.2.1.3" xref="S3.SS3.p1.1.m1.4.5.2.1.3.cmml">N</mi></msubsup><msubsup id="S3.SS3.p1.1.m1.4.5.2.2" xref="S3.SS3.p1.1.m1.4.5.2.2.cmml"><mi id="S3.SS3.p1.1.m1.4.5.2.2.2.2" xref="S3.SS3.p1.1.m1.4.5.2.2.2.2.cmml">B</mi><mrow id="S3.SS3.p1.1.m1.2.2.2.4" xref="S3.SS3.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">A</mi><mo id="S3.SS3.p1.1.m1.2.2.2.4.1" xref="S3.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS3.p1.1.m1.4.4.2.4" xref="S3.SS3.p1.1.m1.4.4.2.3.cmml"><mi id="S3.SS3.p1.1.m1.3.3.1.1" xref="S3.SS3.p1.1.m1.3.3.1.1.cmml">n</mi><mo id="S3.SS3.p1.1.m1.4.4.2.4.1" xref="S3.SS3.p1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p1.1.m1.4.4.2.2" xref="S3.SS3.p1.1.m1.4.4.2.2.cmml">m</mi></mrow></msubsup></mrow><mo id="S3.SS3.p1.1.m1.4.5.1" xref="S3.SS3.p1.1.m1.4.5.1.cmml">=</mo><mn id="S3.SS3.p1.1.m1.4.5.3" xref="S3.SS3.p1.1.m1.4.5.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.5.cmml" xref="S3.SS3.p1.1.m1.4.5"><eq id="S3.SS3.p1.1.m1.4.5.1.cmml" xref="S3.SS3.p1.1.m1.4.5.1"></eq><apply id="S3.SS3.p1.1.m1.4.5.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2"><apply id="S3.SS3.p1.1.m1.4.5.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.2.1.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1">superscript</csymbol><apply id="S3.SS3.p1.1.m1.4.5.2.1.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.2.1.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1">subscript</csymbol><sum id="S3.SS3.p1.1.m1.4.5.2.1.2.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.2.2"></sum><apply id="S3.SS3.p1.1.m1.4.5.2.1.2.3.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3"><eq id="S3.SS3.p1.1.m1.4.5.2.1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.1"></eq><ci id="S3.SS3.p1.1.m1.4.5.2.1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.2">𝑛</ci><cn type="integer" id="S3.SS3.p1.1.m1.4.5.2.1.2.3.3.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.1.m1.4.5.2.1.3.cmml" xref="S3.SS3.p1.1.m1.4.5.2.1.3">𝑁</ci></apply><apply id="S3.SS3.p1.1.m1.4.5.2.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.2.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2">superscript</csymbol><apply id="S3.SS3.p1.1.m1.4.5.2.2.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.5.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.5.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.4.5.2.2.2.2">𝐵</ci><list id="S3.SS3.p1.1.m1.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.4"><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝐴</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS3.p1.1.m1.4.4.2.3.cmml" xref="S3.SS3.p1.1.m1.4.4.2.4"><ci id="S3.SS3.p1.1.m1.3.3.1.1.cmml" xref="S3.SS3.p1.1.m1.3.3.1.1">𝑛</ci><ci id="S3.SS3.p1.1.m1.4.4.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.2.2">𝑚</ci></list></apply></apply><cn type="integer" id="S3.SS3.p1.1.m1.4.5.3.cmml" xref="S3.SS3.p1.1.m1.4.5.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">\sum_{n=1}^{N}B_{A,i}^{n,m}=0</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results and Discussion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we clarify the effectiveness of the proposed method through experiments from the aspects of attack resistance and model performance.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.5" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Setup ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the fundamental conditions of our experiments.
We virtually configured a server and five clients on a single machine.
For a pre-trained model, we used vit_small_patch16_224, where the patch size <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">P</annotation></semantics></math> and learning rate <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\eta</annotation></semantics></math> were 16 and 0.0001, respectively.
We further set the occurrence probability of zeros <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">R</annotation></semantics></math> to 0.2, 0.5, and 0.8.
The experiments were conducted using the CIFAR10 dataset, which consists of 50,000 training images and 10,000 test images.
The images were resized from <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="32\times 32\times 3" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mn id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.1a" xref="S4.SS1.p1.4.m4.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.4.m4.1.1.4" xref="S4.SS1.p1.4.m4.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><times id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></times><cn type="integer" id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">32</cn><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">32</cn><cn type="integer" id="S4.SS1.p1.4.m4.1.1.4.cmml" xref="S4.SS1.p1.4.m4.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">32\times 32\times 3</annotation></semantics></math> to <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="224\times 224\times 3" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mn id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.5.m5.1.1.1a" xref="S4.SS1.p1.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.5.m5.1.1.4" xref="S4.SS1.p1.5.m5.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><times id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></times><cn type="integer" id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">224</cn><cn type="integer" id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">224</cn><cn type="integer" id="S4.SS1.p1.5.m5.1.1.4.cmml" xref="S4.SS1.p1.5.m5.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">224\times 224\times 3</annotation></semantics></math> by bilinear transformation to correspond to the input size of ViT.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We used 16 images from the CIFAR10 dataset to evaluate robustness against APRIL.
The code of APRIL was referenced from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
The images were input to the model fine-tuned with CIFAR10, and the inferred images were generated by APRIL from the updated information.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">Additionally, we evaluated model performance.
Using a model pre-trained using Image-Net and another model without pre-training, we verified the classification accuracy using the 10,000 test images at the end of each epoch.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.3.2" class="ltx_text" style="font-size:90%;">Fundamental conditions</span></figcaption>
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.4.1.1" class="ltx_tr">
<th id="S4.T1.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"># of clients</th>
<th id="S4.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">5</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.4.2.1" class="ltx_tr">
<th id="S4.T1.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">  Pre-trained model</th>
<td id="S4.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">  vit_small_patch16_224</td>
</tr>
<tr id="S4.T1.4.3.2" class="ltx_tr">
<th id="S4.T1.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">  Patch size</th>
<td id="S4.T1.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">  16</td>
</tr>
<tr id="S4.T1.4.4.3" class="ltx_tr">
<th id="S4.T1.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">  Learning rate</th>
<td id="S4.T1.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">  0.0001</td>
</tr>
<tr id="S4.T1.4.5.4" class="ltx_tr">
<th id="S4.T1.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">  Dataset</th>
<td id="S4.T1.4.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">  CIFAR10</td>
</tr>
<tr id="S4.T1.4.6.5" class="ltx_tr">
<th id="S4.T1.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">  Occurrence probability of zeros</th>
<td id="S4.T1.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">  0.2, 0.5, and 0.8</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Robustness against APRIL</h3>

<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.1.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:130.1pt;"><img src="/html/2409.19988/assets/x7.png" id="S4.F4.1.1.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.1.1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.1.1.3.2" class="ltx_text" style="font-size:90%;">Training image</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.2.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:130.1pt;"><img src="/html/2409.19988/assets/x8.png" id="S4.F4.2.2.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.2.2.3.2" class="ltx_text" style="font-size:90%;">Normal learning</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.5.5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:130.1pt;"><img src="/html/2409.19988/assets/x9.png" id="S4.F4.3.3.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.5.5.4.3.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F4.5.5.3.2" class="ltx_text" style="font-size:90%;">Fixed-position             method</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.8.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:130.1pt;"><img src="/html/2409.19988/assets/x10.png" id="S4.F4.6.1.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.8.3.4.3.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F4.8.3.3.2" class="ltx_text" style="font-size:90%;">Proposed method         (R=0.2)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.11.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:130.1pt;"><img src="/html/2409.19988/assets/x11.png" id="S4.F4.9.4.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.11.6.4.3.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S4.F4.11.6.3.2" class="ltx_text" style="font-size:90%;">Proposed method         (R=0.5)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F4.14.9" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:130.1pt;"><img src="/html/2409.19988/assets/x12.png" id="S4.F4.12.7.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="66" height="66" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.14.9.4.3.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S4.F4.14.9.3.2" class="ltx_text" style="font-size:90%;">Proposed method         (R=0.8)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.16.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.17.2" class="ltx_text" style="font-size:90%;">Images inferred by APRIL</span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> depicts the restoration results by APRIL using the updated information.
Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> is a training image, while <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> is an inferred image when using a plain model.
In this case, the visual information of the training image was fully disclosed by APRIL.
In contrast, as shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the fixed-position method prevented APRIL from successful restoration.
Similarly, from Figs. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and <a href="#S4.F4" title="Figure 4 ‣ 4.2 Robustness against APRIL ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, which are the images inferred by the proposed method, it was difficult for APRIL to successfully restore the training image even at <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="R=0.2" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">R</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑅</ci><cn type="float" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">R=0.2</annotation></semantics></math>.
Thus, we can claim that the proposed method is as robust to APRIL as the fixed-position method.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Image Classification Performance</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We assessed the influence of security enhancement with the proposed and fixed-position methods on classification accuracy.
Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Image Classification Performance ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><a href="#S4.F6" title="Figure 6 ‣ 4.4 Discussion ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the transition in classification accuracy for each epoch in the case of using the model pre-trained with ImageNet.
In this figure, the baseline is federated learning with the plain model.
It is clear that both the proposed and fixed-position methods retain similar accuracy to the baseline.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Image Classification Performance ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><a href="#S4.F6" title="Figure 6 ‣ 4.4 Discussion ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> is the transition in classification accuracy for each epoch using the model without pre-training.
Although the proposed method could maintain accuracy, the fixed-position method significantly reduced it.
In the case of using a model without pre-training, we should update all layers of ViT because the initial parameters are generally not suitable for classifying desired images.
The fixed-position method does not update the positional embedding layer; this is the reason for the reduction in accuracy.
In contrast, the proposed method updates all the layers, so accuracy can be improved.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F5.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:390.3pt;"><img src="/html/2409.19988/assets/x13.png" id="S4.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="241" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.1.1.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F5.1.2.2" class="ltx_text" style="font-size:90%;">W/ pre-training</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F5.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:390.3pt;"><img src="/html/2409.19988/assets/x14.png" id="S4.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="241" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F5.2.2.2" class="ltx_text" style="font-size:90%;">W/o pre-training</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.4.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.5.2" class="ltx_text" style="font-size:90%;">Comparison of classification accuracy</span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Discussion</h3>

<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F6.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:390.3pt;"><img src="/html/2409.19988/assets/x15.png" id="S4.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="241" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.3.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><math id="S4.F6.3.2.m1.1" class="ltx_Math" alttext="R=0.2" display="inline"><semantics id="S4.F6.3.2.m1.1b"><mrow id="S4.F6.3.2.m1.1.1" xref="S4.F6.3.2.m1.1.1.cmml"><mi mathsize="90%" id="S4.F6.3.2.m1.1.1.2" xref="S4.F6.3.2.m1.1.1.2.cmml">R</mi><mo mathsize="90%" id="S4.F6.3.2.m1.1.1.1" xref="S4.F6.3.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S4.F6.3.2.m1.1.1.3" xref="S4.F6.3.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.3.2.m1.1c"><apply id="S4.F6.3.2.m1.1.1.cmml" xref="S4.F6.3.2.m1.1.1"><eq id="S4.F6.3.2.m1.1.1.1.cmml" xref="S4.F6.3.2.m1.1.1.1"></eq><ci id="S4.F6.3.2.m1.1.1.2.cmml" xref="S4.F6.3.2.m1.1.1.2">𝑅</ci><cn type="float" id="S4.F6.3.2.m1.1.1.3.cmml" xref="S4.F6.3.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.2.m1.1d">R=0.2</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F6.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:390.3pt;"><img src="/html/2409.19988/assets/x16.png" id="S4.F6.4.g1" class="ltx_graphics ltx_img_landscape" width="241" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.6.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><math id="S4.F6.6.2.m1.1" class="ltx_Math" alttext="R=0.5" display="inline"><semantics id="S4.F6.6.2.m1.1b"><mrow id="S4.F6.6.2.m1.1.1" xref="S4.F6.6.2.m1.1.1.cmml"><mi mathsize="90%" id="S4.F6.6.2.m1.1.1.2" xref="S4.F6.6.2.m1.1.1.2.cmml">R</mi><mo mathsize="90%" id="S4.F6.6.2.m1.1.1.1" xref="S4.F6.6.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S4.F6.6.2.m1.1.1.3" xref="S4.F6.6.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.6.2.m1.1c"><apply id="S4.F6.6.2.m1.1.1.cmml" xref="S4.F6.6.2.m1.1.1"><eq id="S4.F6.6.2.m1.1.1.1.cmml" xref="S4.F6.6.2.m1.1.1.1"></eq><ci id="S4.F6.6.2.m1.1.1.2.cmml" xref="S4.F6.6.2.m1.1.1.2">𝑅</ci><cn type="float" id="S4.F6.6.2.m1.1.1.3.cmml" xref="S4.F6.6.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.2.m1.1d">R=0.5</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F6.9" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:390.3pt;"><img src="/html/2409.19988/assets/x17.png" id="S4.F6.7.g1" class="ltx_graphics ltx_img_landscape" width="241" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.9.3.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><math id="S4.F6.9.2.m1.1" class="ltx_Math" alttext="R=0.8" display="inline"><semantics id="S4.F6.9.2.m1.1b"><mrow id="S4.F6.9.2.m1.1.1" xref="S4.F6.9.2.m1.1.1.cmml"><mi mathsize="90%" id="S4.F6.9.2.m1.1.1.2" xref="S4.F6.9.2.m1.1.1.2.cmml">R</mi><mo mathsize="90%" id="S4.F6.9.2.m1.1.1.1" xref="S4.F6.9.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S4.F6.9.2.m1.1.1.3" xref="S4.F6.9.2.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.9.2.m1.1c"><apply id="S4.F6.9.2.m1.1.1.cmml" xref="S4.F6.9.2.m1.1.1"><eq id="S4.F6.9.2.m1.1.1.1.cmml" xref="S4.F6.9.2.m1.1.1.1"></eq><ci id="S4.F6.9.2.m1.1.1.2.cmml" xref="S4.F6.9.2.m1.1.1.2">𝑅</ci><cn type="float" id="S4.F6.9.2.m1.1.1.3.cmml" xref="S4.F6.9.2.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.9.2.m1.1d">R=0.8</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.11.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.12.2" class="ltx_text" style="font-size:90%;">Probability distribution of update counts</span></figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.2" class="ltx_p">We discuss why the classification accuracy was not degraded with the proposed method.
If the random binary weight of each client for a given parameter is zero, the parameter is not updated.
Thus, in the case that each client uses a common sequence of random binary weights throughout all epochs, some of the parameters may never be updated.
We call this a locked binary weights method.
In contrast, in the proposed method, the clients use a different sequence of random binary weights varying from epoch to epoch.
This significantly reduces the probability that parameters will never be updated.
In the proposed method, the probability <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="P(f)" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.2" xref="S4.SS4.p1.1.m1.1.2.cmml"><mi id="S4.SS4.p1.1.m1.1.2.2" xref="S4.SS4.p1.1.m1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.2.1" xref="S4.SS4.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS4.p1.1.m1.1.2.3.2" xref="S4.SS4.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p1.1.m1.1.2.3.2.1" xref="S4.SS4.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">f</mi><mo stretchy="false" id="S4.SS4.p1.1.m1.1.2.3.2.2" xref="S4.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.2"><times id="S4.SS4.p1.1.m1.1.2.1.cmml" xref="S4.SS4.p1.1.m1.1.2.1"></times><ci id="S4.SS4.p1.1.m1.1.2.2.cmml" xref="S4.SS4.p1.1.m1.1.2.2">𝑃</ci><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">P(f)</annotation></semantics></math> that a parameter is updated <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">f</annotation></semantics></math> times is obtained by</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.3" class="ltx_Math" alttext="P(f)={}_{m}C_{f}\times(1-R^{n})^{f}\times R^{n\times(1-f)}," display="block"><semantics id="S4.E13.m1.3a"><mrow id="S4.E13.m1.3.3.1" xref="S4.E13.m1.3.3.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1" xref="S4.E13.m1.3.3.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1.3" xref="S4.E13.m1.3.3.1.1.3.cmml"><mi id="S4.E13.m1.3.3.1.1.3.2" xref="S4.E13.m1.3.3.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.3.3.1.1.3.1" xref="S4.E13.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E13.m1.3.3.1.1.3.3.2" xref="S4.E13.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S4.E13.m1.3.3.1.1.3.3.2.1" xref="S4.E13.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml">f</mi><mo stretchy="false" id="S4.E13.m1.3.3.1.1.3.3.2.2" xref="S4.E13.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.3.3.1.1.2" xref="S4.E13.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.3.3.1.1.1" xref="S4.E13.m1.3.3.1.1.1.cmml"><mmultiscripts id="S4.E13.m1.3.3.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.3.2.2" xref="S4.E13.m1.3.3.1.1.1.3.2.2.cmml">C</mi><mi id="S4.E13.m1.3.3.1.1.1.3.2.3" xref="S4.E13.m1.3.3.1.1.1.3.2.3.cmml">f</mi><mrow id="S4.E13.m1.3.3.1.1.1.3a" xref="S4.E13.m1.3.3.1.1.1.3.cmml"></mrow><mprescripts id="S4.E13.m1.3.3.1.1.1.3b" xref="S4.E13.m1.3.3.1.1.1.3.cmml"></mprescripts><mi id="S4.E13.m1.3.3.1.1.1.3.3" xref="S4.E13.m1.3.3.1.1.1.3.3.cmml">m</mi><mrow id="S4.E13.m1.3.3.1.1.1.3c" xref="S4.E13.m1.3.3.1.1.1.3.cmml"></mrow></mmultiscripts><mo lspace="0.222em" rspace="0.222em" id="S4.E13.m1.3.3.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.2.cmml">×</mo><msup id="S4.E13.m1.3.3.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.3.3.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.3.3.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S4.E13.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">n</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="S4.E13.m1.3.3.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E13.m1.3.3.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.3.cmml">f</mi></msup><mo rspace="0.222em" id="S4.E13.m1.3.3.1.1.1.2a" xref="S4.E13.m1.3.3.1.1.1.2.cmml">×</mo><msup id="S4.E13.m1.3.3.1.1.1.4" xref="S4.E13.m1.3.3.1.1.1.4.cmml"><mi id="S4.E13.m1.3.3.1.1.1.4.2" xref="S4.E13.m1.3.3.1.1.1.4.2.cmml">R</mi><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.1.1.3.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.2.cmml">×</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mn id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E13.m1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.3.cmml">f</mi></mrow><mo stretchy="false" id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow><mo id="S4.E13.m1.3.3.1.2" xref="S4.E13.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.3b"><apply id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1"><eq id="S4.E13.m1.3.3.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.2"></eq><apply id="S4.E13.m1.3.3.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.3"><times id="S4.E13.m1.3.3.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.3.1"></times><ci id="S4.E13.m1.3.3.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.3.2">𝑃</ci><ci id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2">𝑓</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1"><times id="S4.E13.m1.3.3.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2"></times><apply id="S4.E13.m1.3.3.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.3.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.3.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.3.2.2">𝐶</ci><ci id="S4.E13.m1.3.3.1.1.1.3.2.3.cmml" xref="S4.E13.m1.3.3.1.1.1.3.2.3">𝑓</ci></apply><ci id="S4.E13.m1.3.3.1.1.1.3.3.cmml" xref="S4.E13.m1.3.3.1.1.1.3.3">𝑚</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1"><minus id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply><ci id="S4.E13.m1.3.3.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.3">𝑓</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.4.cmml" xref="S4.E13.m1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.4.1.cmml" xref="S4.E13.m1.3.3.1.1.1.4">superscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.4.2.cmml" xref="S4.E13.m1.3.3.1.1.1.4.2">𝑅</ci><apply id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><times id="S4.E13.m1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.2"></times><ci id="S4.E13.m1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.3">𝑛</ci><apply id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><minus id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E13.m1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">1</cn><ci id="S4.E13.m1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.3c">P(f)={}_{m}C_{f}\times(1-R^{n})^{f}\times R^{n\times(1-f)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p1.5" class="ltx_p">where <math id="S4.SS4.p1.3.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS4.p1.3.m1.1a"><mi id="S4.SS4.p1.3.m1.1.1" xref="S4.SS4.p1.3.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m1.1b"><ci id="S4.SS4.p1.3.m1.1.1.cmml" xref="S4.SS4.p1.3.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m1.1c">m</annotation></semantics></math>, <math id="S4.SS4.p1.4.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS4.p1.4.m2.1a"><mi id="S4.SS4.p1.4.m2.1.1" xref="S4.SS4.p1.4.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m2.1b"><ci id="S4.SS4.p1.4.m2.1.1.cmml" xref="S4.SS4.p1.4.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m2.1c">R</annotation></semantics></math>, and <math id="S4.SS4.p1.5.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS4.p1.5.m3.1a"><mi id="S4.SS4.p1.5.m3.1.1" xref="S4.SS4.p1.5.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m3.1b"><ci id="S4.SS4.p1.5.m3.1.1.cmml" xref="S4.SS4.p1.5.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m3.1c">n</annotation></semantics></math> denote the number of epochs, the occurrence probability of zeros, and the number of clients, respectively.
From this equation, the update frequency of each parameter will get larger as the number of clients and epochs increases.
Consequently, the proposed method is expected to train the model more effectively compared with the locked binary weights method.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.8" class="ltx_p">Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.4 Discussion ‣ 4 Experimental Results and Discussion ‣ Enhancing Security Using Random Binary Weights in Privacy-Preserving Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the probability distribution of update counts with <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="m=10" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">m</mi><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><eq id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></eq><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">m=10</annotation></semantics></math> and <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="n=5" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">n</mi><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><eq id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></eq><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝑛</ci><cn type="integer" id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">n=5</annotation></semantics></math>.
Here, in the proposed method and the locked binary weights method, <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">R</annotation></semantics></math> was defined as <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mn id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><cn type="float" id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">0.2</annotation></semantics></math>, <math id="S4.SS4.p2.5.m5.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS4.p2.5.m5.1a"><mn id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><cn type="float" id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">0.5</annotation></semantics></math>, and <math id="S4.SS4.p2.6.m6.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S4.SS4.p2.6.m6.1a"><mn id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><cn type="float" id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">0.8</annotation></semantics></math>.
From the results, it is clear that most of the parameters were constantly updated through <math id="S4.SS4.p2.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS4.p2.7.m7.1a"><mn id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><cn type="integer" id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">10</annotation></semantics></math> epochs with the fixed-position method.
This method, however, never updates the positional embedding layer.
Updating the positional embedding layer is important for improving the classification accuracy, so the method degrades the accuracy.
Note that it is difficult to recognize this in Fig.6 since the number of parameters in the positional embedding layer is significantly small.
The proposed method has a large number of updated parameters, although not as large as the fixed-position method.
Since non-updated parameters are not concentrated in a particular layer, our method can also obtain the updates of the positional embedding layer, which is a serious issue with the fixed-position method.
Furthermore, the use of an independent sequence of binary weights for each epoch enabled the proposed method to update more parameters than the locked binary weights method at the values of R defined in this section, that is <math id="S4.SS4.p2.8.m8.4" class="ltx_Math" alttext="R=0.2,0.5,and,0.8" display="inline"><semantics id="S4.SS4.p2.8.m8.4a"><mrow id="S4.SS4.p2.8.m8.4.4" xref="S4.SS4.p2.8.m8.4.4.cmml"><mi id="S4.SS4.p2.8.m8.4.4.3" xref="S4.SS4.p2.8.m8.4.4.3.cmml">R</mi><mo id="S4.SS4.p2.8.m8.4.4.2" xref="S4.SS4.p2.8.m8.4.4.2.cmml">=</mo><mrow id="S4.SS4.p2.8.m8.4.4.1.1" xref="S4.SS4.p2.8.m8.4.4.1.2.cmml"><mn id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml">0.2</mn><mo id="S4.SS4.p2.8.m8.4.4.1.1.2" xref="S4.SS4.p2.8.m8.4.4.1.2.cmml">,</mo><mn id="S4.SS4.p2.8.m8.2.2" xref="S4.SS4.p2.8.m8.2.2.cmml">0.5</mn><mo id="S4.SS4.p2.8.m8.4.4.1.1.3" xref="S4.SS4.p2.8.m8.4.4.1.2.cmml">,</mo><mrow id="S4.SS4.p2.8.m8.4.4.1.1.1" xref="S4.SS4.p2.8.m8.4.4.1.1.1.cmml"><mi id="S4.SS4.p2.8.m8.4.4.1.1.1.2" xref="S4.SS4.p2.8.m8.4.4.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.8.m8.4.4.1.1.1.1" xref="S4.SS4.p2.8.m8.4.4.1.1.1.1.cmml">​</mo><mi id="S4.SS4.p2.8.m8.4.4.1.1.1.3" xref="S4.SS4.p2.8.m8.4.4.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.8.m8.4.4.1.1.1.1a" xref="S4.SS4.p2.8.m8.4.4.1.1.1.1.cmml">​</mo><mi id="S4.SS4.p2.8.m8.4.4.1.1.1.4" xref="S4.SS4.p2.8.m8.4.4.1.1.1.4.cmml">d</mi></mrow><mo id="S4.SS4.p2.8.m8.4.4.1.1.4" xref="S4.SS4.p2.8.m8.4.4.1.2.cmml">,</mo><mn id="S4.SS4.p2.8.m8.3.3" xref="S4.SS4.p2.8.m8.3.3.cmml">0.8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.4b"><apply id="S4.SS4.p2.8.m8.4.4.cmml" xref="S4.SS4.p2.8.m8.4.4"><eq id="S4.SS4.p2.8.m8.4.4.2.cmml" xref="S4.SS4.p2.8.m8.4.4.2"></eq><ci id="S4.SS4.p2.8.m8.4.4.3.cmml" xref="S4.SS4.p2.8.m8.4.4.3">𝑅</ci><list id="S4.SS4.p2.8.m8.4.4.1.2.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1"><cn type="float" id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1">0.2</cn><cn type="float" id="S4.SS4.p2.8.m8.2.2.cmml" xref="S4.SS4.p2.8.m8.2.2">0.5</cn><apply id="S4.SS4.p2.8.m8.4.4.1.1.1.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1.1"><times id="S4.SS4.p2.8.m8.4.4.1.1.1.1.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1.1.1"></times><ci id="S4.SS4.p2.8.m8.4.4.1.1.1.2.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1.1.2">𝑎</ci><ci id="S4.SS4.p2.8.m8.4.4.1.1.1.3.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1.1.3">𝑛</ci><ci id="S4.SS4.p2.8.m8.4.4.1.1.1.4.cmml" xref="S4.SS4.p2.8.m8.4.4.1.1.1.4">𝑑</ci></apply><cn type="float" id="S4.SS4.p2.8.m8.3.3.cmml" xref="S4.SS4.p2.8.m8.3.3">0.8</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.4c">R=0.2,0.5,and,0.8</annotation></semantics></math>.
For these reasons, the proposed method provides not only enhanced security against attacks but also updates of a large number of parameters.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We proposed a new security enhancement method for ViT-based federated learning.
With most previous methods, the classification accuracy degrades.
The proposed method not only solves this issue but is also made robust to the APRIL attack by multiplying updated information by random binary weights.
Through our simulations, we confirmed resistance to APRIL and retention of model performance.
Our future work involves the application of this method to other models such as CNN models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B.A.Y. Arcas, “Communication-Efficient Learning of Deep Networks from Decentralized Data,”
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Artif. Intell. Stat.,</em> pp.1273-1282,
2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
L. Li, Y. Fan, M. Tse, and K. Y. Lin, “A review of applications in federated learning,”
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Computers &amp; Industrial Engineering,</em> vol.149, 106854, Elsevier,
2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
R. Aso, S. Sayaka, and H. Kiya, “Disposable-key-based image encryption for collaborative learning of Vision Transformer,”
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2408.05737.,</em>
2024,

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y. Wen, J. Geiping, L. Fowl, M. Goldblum, and T. Goldstein, “Fishing for User Data in Large-Batch Federated Leaarning via Gradient Magnification,”
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Machine Learning,</em> pp.23668-23684,
2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
L. Zhu, Z. Liu, and S. Han, “Deep Leakage from Gradients,”
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. NeurIPS.,</em> pp.14774-14784,
2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
L. Melis, C. Song, E. D. Cristofaro, and V. Shmatikov, “Exploiting Unintended Feature Leakage in Collaborative Learning,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. IEEE Secur. Priv.,</em> pp.691-706,
2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Lu, X. S. Zhang, T. Zhao, X. He, and J. Chang, “April: Finding the Achilles’ Heel on Privacy for Vision Transformers,”
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. CVPR.,</em> pp.10051-10060,
2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
L. T. Phong, Y. Aono, T. Hayashi, L. Wang, and S. Moriai, “Privacy-Preserving Deep Learning via Additively Homomorphic Encryption,”
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Inf. Forensics Security,</em> vol.13, pp.1333-1345,
2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. C. Yao, “Protocols for Secure Computations,”
<em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. IEEE FOCS.,</em> pp.160-164,
1982.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
R. Liu, Y. Cao, H. Chen, R. Guo, and M. Yoshizawa, “Flame: Differentially Private Federated Learning in the Shuffle Model,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proc. Int. AAAI Conf. Artif. Intell.,</em> vol.35, no.10, pp.8688-8696,
2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. Chaudhuri, C. Monteleoni, and A. D. Sarwate, “Differentially Private Empirical Risk Minimization,”
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research,</em> vol.12, pp.1069-1109,
2011.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S. Truex, N. Baracaldo, A. Anwar, T. Steinke, H. Ludwig, et al., “A Hybrid Approach to Privacy-Preserving Federated Learning,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. AlSec.,</em> pp.1-11,
2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Triastcyn, and B. Faltings, “Federated Learning with Bayesian Differential Privacy,”
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. IEEE Big Data,</em> pp.2587-2596,
2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. E. Ouadrhiri, and A. Abdelhadi, “Differential Privacy for Deep and Federated Learning: A Survey,”
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Access,</em> vol.10, pp.22359-22380,
2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
K. Wei, J. Li, M. Ding, C. Ma, H. H. Yang, et al., “Federated Learning with Differential Privacy: Algorithms and Performance Analysis,”
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Inf. Forensics Security,</em> vol.15, pp.3454-3469,
2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, et al., “An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale,”
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc. ICLR., Virtual Event, Austria,</em> pp.1-21,
2021.
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
R. Aso, S. Shiota, and H. Kiya, “Enhanced Security with Encrypted Vision Transformer in Federatd Learning.”
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. IEEE Global Conference on Consumer Electronics</em> pp.819-822,
2023.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
[Online]. Available: <span class="ltx_ref ltx_nolink ltx_url ltx_ref_self">https://github.com/JonasGeiping/breaching</span>

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.19987" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.19988" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.19988">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.19988" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.19989" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 18:12:34 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
