<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Modeling User Fatigue for Sequential Recommendation</title>
<!--Generated on Fri May 24 16:55:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="User Fatigue; Sequential Recommendation; Long and Short-term Interests" lang="en" name="keywords"/>
<base href="/html/2405.11764v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S1" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S2" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS1" title="In 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Interest-aware Similarity Matrix</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS2" title="In 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Fatigue-enhanced Multi-interest Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS3" title="In 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Fatigue-gated Recurrent Unit</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS4" title="In 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Fatigue-supervised Contrastive Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS5" title="In 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Model Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.SS1" title="In 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.SS2" title="In 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Overall Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.SS3" title="In 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.SS4" title="In 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Study on Fatigue Reduction (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.SS5" title="In 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Hyper-parameter Study (RQ4)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S5" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S5.SS1" title="In 5. Related Work ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S5.SS2" title="In 5. Related Work ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>User Fatigue in Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S6" title="In Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span>
</p>
</div>
<h1 class="ltx_title ltx_title_document">Modeling User Fatigue for Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nian Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0003-4689-2289" title="ORCID identifier">0000-0003-4689-2289</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Shenzhen International Graduate School, Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xin Ban
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cheng Ling
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Kuaishou Inc.</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chen Gao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lantao Hu
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peng Jiang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Kuaishou Inc.</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kun Gai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Independent</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yong Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qingmin Liao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Shenzhen International Graduate School, Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id22.id1">Recommender systems filter out information that meets user interests. However, users may be tired of the recommendations that are too similar to the content they have been exposed to in a short historical period, which is the so-called <span class="ltx_text ltx_font_italic" id="id22.id1.1">user fatigue</span>.
Despite the significance for a better user experience, user fatigue is seldom explored by existing recommenders.
In fact, there are three main challenges to be addressed for modeling user fatigue, including what features support it, how it influences user interests, and how its explicit signals are obtained.
In this paper, we propose to model user <span class="ltx_text ltx_font_bold" id="id22.id1.2">F</span>atigue in interest learning for sequential <span class="ltx_text ltx_font_bold" id="id22.id1.3">Rec</span>ommendations (<span class="ltx_text ltx_font_bold" id="id22.id1.4">FRec</span>). To address the first challenge, based on a multi-interest framework, we connect the target item with historical items and construct an interest-aware similarity matrix as features to support fatigue modeling. Regarding the second challenge, built upon feature cross, we propose a fatigue-enhanced multi-interest fusion to capture long-term interest. In addition, we develop a fatigue-gated recurrent unit for short-term interest learning, with temporal fatigue representations as important inputs for constructing update and reset gates. For the last challenge, we propose a novel sequence augmentation to obtain explicit fatigue signals for contrastive learning. We conduct extensive experiments on real-world datasets, including two public datasets and one large-scale industrial dataset. Experimental results show that FRec can improve AUC and GAUC up to 0.026 and 0.019 compared with state-of-the-art models, respectively. Moreover, large-scale online experiments demonstrate the effectiveness of FRec for fatigue reduction. Our codes are released at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/tsinghua-fib-lab/SIGIR24-FRec" title="">https://github.com/tsinghua-fib-lab/SIGIR24-FRec</a>.</p>
</div>
<div class="ltx_keywords">User Fatigue; Sequential Recommendation; Long and Short-term Interests
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval; July 14–18, 2024; Washington, DC, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR ’24), July 14–18, 2024, Washington, DC, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3626772.3657802</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0431-4/24/07</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Information systems applications</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In today’s online platforms, the recommender system is broadly deployed to filter out irrelevant content and fetch personalized content for users that they are interested in <cite class="ltx_cite ltx_citemacro_citep">(Hamilton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib16" title="">2017</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib11" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib12" title="">2020</a>; Quan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib34" title="">2023b</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib14" title="">2024</a>)</cite>. Therefore, in the development of recommendation models, how to capture user interests as accurately as possible is an essential problem.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Sequential recommender organizes users’ historical interactions in a temporal sequence and aims to predict the next item of interaction <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>. Many existing works built upon advanced neural networks focus on interest learning, including long and short-term user interests <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib17" title="">2015</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib36" title="">2018</a>)</cite>. Some works also propose to combine long and short-term interest modeling for better recommendation <cite class="ltx_cite ltx_citemacro_citep">(An et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib4" title="">2019</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>. Another line of modeling accurate user interests is to extract multiple interests from the sequence <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib32" title="">2019</a>; Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib27" title="">2021</a>; Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite>. These works argue that only one representation for modeling interests is not effective enough since users are usually interested in several kinds of items.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite of this, user fatigue has not been well studied in existing works, especially how it can influence user interests. In this work, <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">user fatigue refers that users may be tired of the recommendations that are too similar to content they have been exposed to in a short historical period</span>, such as news, advertisements, <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">etc.</span> For example, the click-through rate (CTR) of news will drop significantly with more and more times of exposure <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite>. It is important to note that user fatigue is fundamentally different from other concepts related to positive user experience in recommender systems. Specifically, <span class="ltx_text ltx_font_italic" id="S1.p3.1.3">diversity</span> typically focuses solely on the dissimilarity between items in the recommendation list, irrespective of the user’s historical interactions <cite class="ltx_cite ltx_citemacro_citep">(Alhijawi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib3" title="">2022</a>)</cite>. On the other hand, <span class="ltx_text ltx_font_italic" id="S1.p3.1.4">serendipity</span> or <span class="ltx_text ltx_font_italic" id="S1.p3.1.5">novelty</span> emphasizes that the recommended items are unexpected or unknown to the user, characterized by their divergence from historical items or by the items’ popularity <cite class="ltx_cite ltx_citemacro_citep">(Fu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib13" title="">2023</a>)</cite>. In contrast, user fatigue represents the negative aspect of user experience.
We verify the existence of user fatigue on a micro-video platform Kuaishou, using large-scale interaction data involving tens of millions of users. An industrial dataset is also collected from this platform for experiments in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4" title="4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. In Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:evtr</span>, we plot the <span class="ltx_text ltx_font_italic" id="S1.p3.1.6">normalized</span> effective view-through rate (EVTR) as the function of the number of effective views of videos with the same category in historical consumption. Compared with videos with other categories, the EVTR of videos with the target category decreases significantly and is consistently lower when users have too many effective views of the same category. This is obvious evidence of user fatigue with respect to the repetitive consumption of similar videos. This issue can harm user experience and further reduce platform activity.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">A few existing works address the issue of user fatigue with coarse-grained features based on item-level and category-level repetitions. Ma <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>)</cite> just feed these features into decision trees, which serve as the base recommendation model. Moriwaki <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Moriwaki et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib31" title="">2019</a>)</cite> define a simple quadratic function for directly mapping the features to user fatigue. These methods are usually ineffective since the way of modeling fatigue lacks flexibility and interpretability. As a matter of fact, there are three challenges to be addressed,</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Fine-grained features are hard to obtain to support fatigue modeling.</span> Intuitively, user fatigue depends on the similarity between the target and historical items. Existing works usually utilize item-level and category-level repetitions as the similarity features <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite>. However, these measurements are usually too coarse to represent the similarity between items accurately. For instance, even if the two videos both belong to the category of ‘pandas’, there may be still non-negligible differences, such as one is about ‘panda is eating bamboo’ and the other is about ‘pandas rentals from the UK’. Therefore, how to measure fine-grained similarity to support fatigue modeling is critical but difficult.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">The influence of user fatigue on interests is complex.</span> In general, the user’s certain interest will be weakened if he/she is experiencing fatigue with it. Existing works either neglect to model this influence <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite> or manually define it by a quadratic function <cite class="ltx_cite ltx_citemacro_citep">(Moriwaki et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib31" title="">2019</a>)</cite>, which is unrealistic in real-world scenarios. Actually, multiple historical items may contribute to causing user fatigue as a whole and further influence both long and short-term interests. Therefore, based on similarity features, how to fuse user fatigue with interest learning is also an essential point.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">There are no explicit signals of user fatigue contained in historical consumption.</span>
The decreasing engagement with certain types of items over time can be seen as users are tired of frequent exposures. However, this phenomenon can only be observed from later consumption after the current interaction. Therefore, it is hard to directly obtain corresponding signals of user fatigue with respect to the current item from historical consumption.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this work, we propose to model user fatigue in interest learning for sequential recommendations with the challenges above addressed. Specifically, we first extract multi-interest representations<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We use “representation” and “embedding” interchangeably in this paper.</span></span></span> from the historical sequence with the self-attention mechanism. To obtain fine-grained features to support fatigue modeling, we construct an interest-aware similarity matrix (ISM) measured by the projection distance built upon historical and target item embeddings. We then apply cross networks for feature interplay to assist in handling complex fatigue influence, based on which we model the influence on long-term interest. We further develop a fatigue-gated recurrent unit (FRU) for short-term interest learning.
For explicit signals of user fatigue, we propose a novel sequence augmentation to obtain them counterfactually and use them to supervise contrastive learning with respect to fatigue prediction.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">We have conducted extensive experiments on two public datasets and one large-scale industrial dataset to evaluate the effectiveness of our FRec. Compared with many state-of-the-art (SOTA) models, our FRec achieves significant improvements with respect to various accuracy and ranking metrics. Further online studies also demonstrate that FRec can reduce user fatigue by alleviating repeated exposure in consecutive consumptions and improve user experience significantly.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The contributions of this work are summarized as follows,</p>
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We take user fatigue into consideration and make an advanced step to incorporate it into interest learning for sequential recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We address primary challenges in modeling user fatigue by constructing fine-grained similarity features, handling its complex influence on long and short-term interests, and obtaining its signals with a novel sequence augmentation for contrastive learning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We conduct extensive offline and online experiments to demonstrate that FRec can improve the recommendation accuracy significantly (AUC up to 0.026, GAUC up to 0.019, and NDCG up to 5.8%) compared with SOTA methods and reduce user fatigue.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F2.sf1">
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Problem Formulation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.6">We consider a standard problem of sequential recommendation. For each user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">u</mi><mo id="S2.p1.1.m1.1.1.1" xref="S2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><in id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1"></in><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝑢</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>, let <math alttext="S_{u}=\{i_{1},i_{2},\cdots,i_{L_{u}}\}" class="ltx_Math" display="inline" id="S2.p1.2.m2.4"><semantics id="S2.p1.2.m2.4a"><mrow id="S2.p1.2.m2.4.4" xref="S2.p1.2.m2.4.4.cmml"><msub id="S2.p1.2.m2.4.4.5" xref="S2.p1.2.m2.4.4.5.cmml"><mi id="S2.p1.2.m2.4.4.5.2" xref="S2.p1.2.m2.4.4.5.2.cmml">S</mi><mi id="S2.p1.2.m2.4.4.5.3" xref="S2.p1.2.m2.4.4.5.3.cmml">u</mi></msub><mo id="S2.p1.2.m2.4.4.4" xref="S2.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.p1.2.m2.4.4.3.3" xref="S2.p1.2.m2.4.4.3.4.cmml"><mo id="S2.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S2.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S2.p1.2.m2.2.2.1.1.1" xref="S2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.p1.2.m2.2.2.1.1.1.2" xref="S2.p1.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S2.p1.2.m2.2.2.1.1.1.3" xref="S2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.4.4.3.3.5" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.p1.2.m2.3.3.2.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S2.p1.2.m2.3.3.2.2.2.3" xref="S2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.2.m2.4.4.3.3.6" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.p1.2.m2.1.1" mathvariant="normal" xref="S2.p1.2.m2.1.1.cmml">⋯</mi><mo id="S2.p1.2.m2.4.4.3.3.7" xref="S2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.p1.2.m2.4.4.3.3.3" xref="S2.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.p1.2.m2.4.4.3.3.3.2" xref="S2.p1.2.m2.4.4.3.3.3.2.cmml">i</mi><msub id="S2.p1.2.m2.4.4.3.3.3.3" xref="S2.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S2.p1.2.m2.4.4.3.3.3.3.2" xref="S2.p1.2.m2.4.4.3.3.3.3.2.cmml">L</mi><mi id="S2.p1.2.m2.4.4.3.3.3.3.3" xref="S2.p1.2.m2.4.4.3.3.3.3.3.cmml">u</mi></msub></msub><mo id="S2.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S2.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.4b"><apply id="S2.p1.2.m2.4.4.cmml" xref="S2.p1.2.m2.4.4"><eq id="S2.p1.2.m2.4.4.4.cmml" xref="S2.p1.2.m2.4.4.4"></eq><apply id="S2.p1.2.m2.4.4.5.cmml" xref="S2.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S2.p1.2.m2.4.4.5.1.cmml" xref="S2.p1.2.m2.4.4.5">subscript</csymbol><ci id="S2.p1.2.m2.4.4.5.2.cmml" xref="S2.p1.2.m2.4.4.5.2">𝑆</ci><ci id="S2.p1.2.m2.4.4.5.3.cmml" xref="S2.p1.2.m2.4.4.5.3">𝑢</ci></apply><set id="S2.p1.2.m2.4.4.3.4.cmml" xref="S2.p1.2.m2.4.4.3.3"><apply id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S2.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S2.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">⋯</ci><apply id="S2.p1.2.m2.4.4.3.3.3.cmml" xref="S2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.p1.2.m2.4.4.3.3.3.2">𝑖</ci><apply id="S2.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.p1.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S2.p1.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S2.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S2.p1.2.m2.4.4.3.3.3.3.2">𝐿</ci><ci id="S2.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="S2.p1.2.m2.4.4.3.3.3.3.3">𝑢</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.4c">S_{u}=\{i_{1},i_{2},\cdots,i_{L_{u}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.4d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math> denote the historical interaction sequence chronologically, <span class="ltx_text ltx_font_italic" id="S2.p1.6.1">i.e.</span>, ordered by the interaction timestamp of each item, where <math alttext="i_{l}\in\mathcal{I}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><msub id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml"><mi id="S2.p1.3.m3.1.1.2.2" xref="S2.p1.3.m3.1.1.2.2.cmml">i</mi><mi id="S2.p1.3.m3.1.1.2.3" xref="S2.p1.3.m3.1.1.2.3.cmml">l</mi></msub><mo id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><in id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"></in><apply id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.2.1.cmml" xref="S2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.2.cmml" xref="S2.p1.3.m3.1.1.2.2">𝑖</ci><ci id="S2.p1.3.m3.1.1.2.3.cmml" xref="S2.p1.3.m3.1.1.2.3">𝑙</ci></apply><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">i_{l}\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ caligraphic_I</annotation></semantics></math> and <math alttext="L_{u}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><msub id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">L</mi><mi id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝐿</ci><ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">L_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the sequence length. <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">caligraphic_U</annotation></semantics></math> and <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">caligraphic_I</annotation></semantics></math> denote the set of users and items, respectively.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.7">Most existing works focus on modeling user interests according to historical sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><msub id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">S</mi><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝑆</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> for predicting whether the user will interact with the target item <math alttext="i_{t}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">i</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑖</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. However, user fatigue is also a critical factor influencing the user interest and decision. In other words, if the item <math alttext="i_{t}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">i</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑖</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is very similar to many items in <math alttext="S_{u}" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">S</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝑆</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the user may not interact with it due to being tired of repeated interactions. In this work, we aim to model user fatigue with the sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">S</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑆</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and incorporate it with interest learning for capturing user decisions more accurately.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S2.p2.7.1">Input</span>: Historical sequences for all the users <math alttext="\{S_{u}|u\in\mathcal{U}\}" class="ltx_Math" display="inline" id="S2.p2.6.m6.2"><semantics id="S2.p2.6.m6.2a"><mrow id="S2.p2.6.m6.2.2.2" xref="S2.p2.6.m6.2.2.3.cmml"><mo id="S2.p2.6.m6.2.2.2.3" stretchy="false" xref="S2.p2.6.m6.2.2.3.1.cmml">{</mo><msub id="S2.p2.6.m6.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.cmml"><mi id="S2.p2.6.m6.1.1.1.1.2" xref="S2.p2.6.m6.1.1.1.1.2.cmml">S</mi><mi id="S2.p2.6.m6.1.1.1.1.3" xref="S2.p2.6.m6.1.1.1.1.3.cmml">u</mi></msub><mo id="S2.p2.6.m6.2.2.2.4" lspace="0em" rspace="0em" xref="S2.p2.6.m6.2.2.3.1.cmml">|</mo><mrow id="S2.p2.6.m6.2.2.2.2" xref="S2.p2.6.m6.2.2.2.2.cmml"><mi id="S2.p2.6.m6.2.2.2.2.2" xref="S2.p2.6.m6.2.2.2.2.2.cmml">u</mi><mo id="S2.p2.6.m6.2.2.2.2.1" xref="S2.p2.6.m6.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.2.2.2.2.3" xref="S2.p2.6.m6.2.2.2.2.3.cmml">𝒰</mi></mrow><mo id="S2.p2.6.m6.2.2.2.5" stretchy="false" xref="S2.p2.6.m6.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.2b"><apply id="S2.p2.6.m6.2.2.3.cmml" xref="S2.p2.6.m6.2.2.2"><csymbol cd="latexml" id="S2.p2.6.m6.2.2.3.1.cmml" xref="S2.p2.6.m6.2.2.2.3">conditional-set</csymbol><apply id="S2.p2.6.m6.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.p2.6.m6.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1.1.2">𝑆</ci><ci id="S2.p2.6.m6.1.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.1.3">𝑢</ci></apply><apply id="S2.p2.6.m6.2.2.2.2.cmml" xref="S2.p2.6.m6.2.2.2.2"><in id="S2.p2.6.m6.2.2.2.2.1.cmml" xref="S2.p2.6.m6.2.2.2.2.1"></in><ci id="S2.p2.6.m6.2.2.2.2.2.cmml" xref="S2.p2.6.m6.2.2.2.2.2">𝑢</ci><ci id="S2.p2.6.m6.2.2.2.2.3.cmml" xref="S2.p2.6.m6.2.2.2.2.3">𝒰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.2c">\{S_{u}|u\in\mathcal{U}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.2d">{ italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | italic_u ∈ caligraphic_U }</annotation></semantics></math>.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S2.p2.7.2">Output</span>: A model that can predict the user’s interaction probability for the next (target) item <math alttext="i_{t}" class="ltx_Math" display="inline" id="S2.p2.7.m7.1"><semantics id="S2.p2.7.m7.1a"><msub id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">i</mi><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝑖</ci><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S1.F2" title="Figure 2 ‣ 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> shows the framework of our FRec with four modules.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S1.F2.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S1.F2.3.2" style="font-size:90%;">The framework of FRec.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.23.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S3.T1.24.2" style="font-size:90%;">Frequently used notations.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.21">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.2.2.2">
<math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml">S</mi><mi id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">𝑆</ci><ci id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="L_{u}" class="ltx_Math" display="inline" id="S3.T1.2.2.2.m2.1"><semantics id="S3.T1.2.2.2.m2.1a"><msub id="S3.T1.2.2.2.m2.1.1" xref="S3.T1.2.2.2.m2.1.1.cmml"><mi id="S3.T1.2.2.2.m2.1.1.2" xref="S3.T1.2.2.2.m2.1.1.2.cmml">L</mi><mi id="S3.T1.2.2.2.m2.1.1.3" xref="S3.T1.2.2.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m2.1b"><apply id="S3.T1.2.2.2.m2.1.1.cmml" xref="S3.T1.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.m2.1.1.1.cmml" xref="S3.T1.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.T1.2.2.2.m2.1.1.2.cmml" xref="S3.T1.2.2.2.m2.1.1.2">𝐿</ci><ci id="S3.T1.2.2.2.m2.1.1.3.cmml" xref="S3.T1.2.2.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m2.1c">L_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.m2.1d">italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T1.3.3.3">Historical sequence for user <math alttext="u" class="ltx_Math" display="inline" id="S3.T1.3.3.3.m1.1"><semantics id="S3.T1.3.3.3.m1.1a"><mi id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><ci id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.m1.1d">italic_u</annotation></semantics></math>, and its length.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.5.2">
<math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.T1.4.4.1.m1.1"><semantics id="S3.T1.4.4.1.m1.1a"><msub id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml"><mover accent="true" id="S3.T1.4.4.1.m1.1.1.2" xref="S3.T1.4.4.1.m1.1.1.2.cmml"><mi id="S3.T1.4.4.1.m1.1.1.2.2" xref="S3.T1.4.4.1.m1.1.1.2.2.cmml">S</mi><mo id="S3.T1.4.4.1.m1.1.1.2.1" xref="S3.T1.4.4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.T1.4.4.1.m1.1.1.3" xref="S3.T1.4.4.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><apply id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.1.m1.1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">subscript</csymbol><apply id="S3.T1.4.4.1.m1.1.1.2.cmml" xref="S3.T1.4.4.1.m1.1.1.2"><ci id="S3.T1.4.4.1.m1.1.1.2.1.cmml" xref="S3.T1.4.4.1.m1.1.1.2.1">^</ci><ci id="S3.T1.4.4.1.m1.1.1.2.2.cmml" xref="S3.T1.4.4.1.m1.1.1.2.2">𝑆</ci></apply><ci id="S3.T1.4.4.1.m1.1.1.3.cmml" xref="S3.T1.4.4.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.1.m1.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="T_{u}" class="ltx_Math" display="inline" id="S3.T1.5.5.2.m2.1"><semantics id="S3.T1.5.5.2.m2.1a"><msub id="S3.T1.5.5.2.m2.1.1" xref="S3.T1.5.5.2.m2.1.1.cmml"><mi id="S3.T1.5.5.2.m2.1.1.2" xref="S3.T1.5.5.2.m2.1.1.2.cmml">T</mi><mi id="S3.T1.5.5.2.m2.1.1.3" xref="S3.T1.5.5.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.m2.1b"><apply id="S3.T1.5.5.2.m2.1.1.cmml" xref="S3.T1.5.5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.2.m2.1.1.1.cmml" xref="S3.T1.5.5.2.m2.1.1">subscript</csymbol><ci id="S3.T1.5.5.2.m2.1.1.2.cmml" xref="S3.T1.5.5.2.m2.1.1.2">𝑇</ci><ci id="S3.T1.5.5.2.m2.1.1.3.cmml" xref="S3.T1.5.5.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.m2.1c">T_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_left" id="S3.T1.6.6.3">Sub-sequence with recent items in <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.T1.6.6.3.m1.1"><semantics id="S3.T1.6.6.3.m1.1a"><msub id="S3.T1.6.6.3.m1.1.1" xref="S3.T1.6.6.3.m1.1.1.cmml"><mi id="S3.T1.6.6.3.m1.1.1.2" xref="S3.T1.6.6.3.m1.1.1.2.cmml">S</mi><mi id="S3.T1.6.6.3.m1.1.1.3" xref="S3.T1.6.6.3.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.3.m1.1b"><apply id="S3.T1.6.6.3.m1.1.1.cmml" xref="S3.T1.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.3.m1.1.1.1.cmml" xref="S3.T1.6.6.3.m1.1.1">subscript</csymbol><ci id="S3.T1.6.6.3.m1.1.1.2.cmml" xref="S3.T1.6.6.3.m1.1.1.2">𝑆</ci><ci id="S3.T1.6.6.3.m1.1.1.3.cmml" xref="S3.T1.6.6.3.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.3.m1.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.3.m1.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, and its length.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.7.7.1"><math alttext="T" class="ltx_Math" display="inline" id="S3.T1.7.7.1.m1.1"><semantics id="S3.T1.7.7.1.m1.1a"><mi id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><ci id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.1.m1.1d">italic_T</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.8.8.2">Truncated threshold for selecting sub-sequence <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.T1.8.8.2.m1.1"><semantics id="S3.T1.8.8.2.m1.1a"><msub id="S3.T1.8.8.2.m1.1.1" xref="S3.T1.8.8.2.m1.1.1.cmml"><mover accent="true" id="S3.T1.8.8.2.m1.1.1.2" xref="S3.T1.8.8.2.m1.1.1.2.cmml"><mi id="S3.T1.8.8.2.m1.1.1.2.2" xref="S3.T1.8.8.2.m1.1.1.2.2.cmml">S</mi><mo id="S3.T1.8.8.2.m1.1.1.2.1" xref="S3.T1.8.8.2.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.T1.8.8.2.m1.1.1.3" xref="S3.T1.8.8.2.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.2.m1.1b"><apply id="S3.T1.8.8.2.m1.1.1.cmml" xref="S3.T1.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.2.m1.1.1.1.cmml" xref="S3.T1.8.8.2.m1.1.1">subscript</csymbol><apply id="S3.T1.8.8.2.m1.1.1.2.cmml" xref="S3.T1.8.8.2.m1.1.1.2"><ci id="S3.T1.8.8.2.m1.1.1.2.1.cmml" xref="S3.T1.8.8.2.m1.1.1.2.1">^</ci><ci id="S3.T1.8.8.2.m1.1.1.2.2.cmml" xref="S3.T1.8.8.2.m1.1.1.2.2">𝑆</ci></apply><ci id="S3.T1.8.8.2.m1.1.1.3.cmml" xref="S3.T1.8.8.2.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.2.m1.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.2.m1.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.9.9.1"><math alttext="K" class="ltx_Math" display="inline" id="S3.T1.9.9.1.m1.1"><semantics id="S3.T1.9.9.1.m1.1a"><mi id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><ci id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.1.m1.1d">italic_K</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.9.9.2">The number of interests.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.10.1"><math alttext="C" class="ltx_Math" display="inline" id="S3.T1.10.10.1.m1.1"><semantics id="S3.T1.10.10.1.m1.1a"><mi id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><ci id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.1.m1.1d">italic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.10.10.2">The number of cross and convolutional layers.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.11.11.1"><math alttext="\mathbf{M}_{j}(\mathbf{M}^{\top}_{j})" class="ltx_Math" display="inline" id="S3.T1.11.11.1.m1.1"><semantics id="S3.T1.11.11.1.m1.1a"><mrow id="S3.T1.11.11.1.m1.1.1" xref="S3.T1.11.11.1.m1.1.1.cmml"><msub id="S3.T1.11.11.1.m1.1.1.3" xref="S3.T1.11.11.1.m1.1.1.3.cmml"><mi id="S3.T1.11.11.1.m1.1.1.3.2" xref="S3.T1.11.11.1.m1.1.1.3.2.cmml">𝐌</mi><mi id="S3.T1.11.11.1.m1.1.1.3.3" xref="S3.T1.11.11.1.m1.1.1.3.3.cmml">j</mi></msub><mo id="S3.T1.11.11.1.m1.1.1.2" xref="S3.T1.11.11.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.11.11.1.m1.1.1.1.1" xref="S3.T1.11.11.1.m1.1.1.1.1.1.cmml"><mo id="S3.T1.11.11.1.m1.1.1.1.1.2" stretchy="false" xref="S3.T1.11.11.1.m1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.T1.11.11.1.m1.1.1.1.1.1" xref="S3.T1.11.11.1.m1.1.1.1.1.1.cmml"><mi id="S3.T1.11.11.1.m1.1.1.1.1.1.2.2" xref="S3.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml">𝐌</mi><mi id="S3.T1.11.11.1.m1.1.1.1.1.1.3" xref="S3.T1.11.11.1.m1.1.1.1.1.1.3.cmml">j</mi><mo id="S3.T1.11.11.1.m1.1.1.1.1.1.2.3" xref="S3.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.T1.11.11.1.m1.1.1.1.1.3" stretchy="false" xref="S3.T1.11.11.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.m1.1b"><apply id="S3.T1.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1"><times id="S3.T1.11.11.1.m1.1.1.2.cmml" xref="S3.T1.11.11.1.m1.1.1.2"></times><apply id="S3.T1.11.11.1.m1.1.1.3.cmml" xref="S3.T1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.11.11.1.m1.1.1.3.1.cmml" xref="S3.T1.11.11.1.m1.1.1.3">subscript</csymbol><ci id="S3.T1.11.11.1.m1.1.1.3.2.cmml" xref="S3.T1.11.11.1.m1.1.1.3.2">𝐌</ci><ci id="S3.T1.11.11.1.m1.1.1.3.3.cmml" xref="S3.T1.11.11.1.m1.1.1.3.3">𝑗</ci></apply><apply id="S3.T1.11.11.1.m1.1.1.1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.T1.11.11.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1.1.2.2">𝐌</ci><csymbol cd="latexml" id="S3.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="S3.T1.11.11.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.11.11.1.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.m1.1c">\mathbf{M}_{j}(\mathbf{M}^{\top}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( bold_M start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.14.14.4">The <math alttext="j" class="ltx_Math" display="inline" id="S3.T1.12.12.2.m1.1"><semantics id="S3.T1.12.12.2.m1.1a"><mi id="S3.T1.12.12.2.m1.1.1" xref="S3.T1.12.12.2.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.2.m1.1b"><ci id="S3.T1.12.12.2.m1.1.1.cmml" xref="S3.T1.12.12.2.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.2.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.2.m1.1d">italic_j</annotation></semantics></math>-th column of the matrix <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S3.T1.13.13.3.m2.1"><semantics id="S3.T1.13.13.3.m2.1a"><mi id="S3.T1.13.13.3.m2.1.1" xref="S3.T1.13.13.3.m2.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.3.m2.1b"><ci id="S3.T1.13.13.3.m2.1.1.cmml" xref="S3.T1.13.13.3.m2.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.3.m2.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.3.m2.1d">bold_M</annotation></semantics></math> (transposed <math alttext="\mathbf{M}^{\top}" class="ltx_Math" display="inline" id="S3.T1.14.14.4.m3.1"><semantics id="S3.T1.14.14.4.m3.1a"><msup id="S3.T1.14.14.4.m3.1.1" xref="S3.T1.14.14.4.m3.1.1.cmml"><mi id="S3.T1.14.14.4.m3.1.1.2" xref="S3.T1.14.14.4.m3.1.1.2.cmml">𝐌</mi><mo id="S3.T1.14.14.4.m3.1.1.3" xref="S3.T1.14.14.4.m3.1.1.3.cmml">⊤</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.4.m3.1b"><apply id="S3.T1.14.14.4.m3.1.1.cmml" xref="S3.T1.14.14.4.m3.1.1"><csymbol cd="ambiguous" id="S3.T1.14.14.4.m3.1.1.1.cmml" xref="S3.T1.14.14.4.m3.1.1">superscript</csymbol><ci id="S3.T1.14.14.4.m3.1.1.2.cmml" xref="S3.T1.14.14.4.m3.1.1.2">𝐌</ci><csymbol cd="latexml" id="S3.T1.14.14.4.m3.1.1.3.cmml" xref="S3.T1.14.14.4.m3.1.1.3">top</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.4.m3.1c">\mathbf{M}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.4.m3.1d">bold_M start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>).</td>
</tr>
<tr class="ltx_tr" id="S3.T1.16.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.15.15.1"><math alttext="\mathbf{e}_{i}" class="ltx_Math" display="inline" id="S3.T1.15.15.1.m1.1"><semantics id="S3.T1.15.15.1.m1.1a"><msub id="S3.T1.15.15.1.m1.1.1" xref="S3.T1.15.15.1.m1.1.1.cmml"><mi id="S3.T1.15.15.1.m1.1.1.2" xref="S3.T1.15.15.1.m1.1.1.2.cmml">𝐞</mi><mi id="S3.T1.15.15.1.m1.1.1.3" xref="S3.T1.15.15.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.1.m1.1b"><apply id="S3.T1.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.15.15.1.m1.1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1">subscript</csymbol><ci id="S3.T1.15.15.1.m1.1.1.2.cmml" xref="S3.T1.15.15.1.m1.1.1.2">𝐞</ci><ci id="S3.T1.15.15.1.m1.1.1.3.cmml" xref="S3.T1.15.15.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.1.m1.1c">\mathbf{e}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.16.16.2">The embedding of item <math alttext="i" class="ltx_Math" display="inline" id="S3.T1.16.16.2.m1.1"><semantics id="S3.T1.16.16.2.m1.1a"><mi id="S3.T1.16.16.2.m1.1.1" xref="S3.T1.16.16.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.2.m1.1b"><ci id="S3.T1.16.16.2.m1.1.1.cmml" xref="S3.T1.16.16.2.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.16.2.m1.1d">italic_i</annotation></semantics></math>.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.17.17.1"><math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.T1.17.17.1.m1.1"><semantics id="S3.T1.17.17.1.m1.1a"><mi id="S3.T1.17.17.1.m1.1.1" xref="S3.T1.17.17.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.1.m1.1b"><ci id="S3.T1.17.17.1.m1.1.1.cmml" xref="S3.T1.17.17.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.17.1.m1.1d">bold_H</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.17.2">Multi-interest embedding matrix.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.18.18.1"><math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.T1.18.18.1.m1.1"><semantics id="S3.T1.18.18.1.m1.1a"><mi id="S3.T1.18.18.1.m1.1.1" xref="S3.T1.18.18.1.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.1b"><ci id="S3.T1.18.18.1.m1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.18.1.m1.1d">bold_F</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.18.18.2">Interest-aware similarity matrix.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.19.19.1"><math alttext="\mathbf{h},\mathbf{h}_{T_{u}}" class="ltx_Math" display="inline" id="S3.T1.19.19.1.m1.2"><semantics id="S3.T1.19.19.1.m1.2a"><mrow id="S3.T1.19.19.1.m1.2.2.1" xref="S3.T1.19.19.1.m1.2.2.2.cmml"><mi id="S3.T1.19.19.1.m1.1.1" xref="S3.T1.19.19.1.m1.1.1.cmml">𝐡</mi><mo id="S3.T1.19.19.1.m1.2.2.1.2" xref="S3.T1.19.19.1.m1.2.2.2.cmml">,</mo><msub id="S3.T1.19.19.1.m1.2.2.1.1" xref="S3.T1.19.19.1.m1.2.2.1.1.cmml"><mi id="S3.T1.19.19.1.m1.2.2.1.1.2" xref="S3.T1.19.19.1.m1.2.2.1.1.2.cmml">𝐡</mi><msub id="S3.T1.19.19.1.m1.2.2.1.1.3" xref="S3.T1.19.19.1.m1.2.2.1.1.3.cmml"><mi id="S3.T1.19.19.1.m1.2.2.1.1.3.2" xref="S3.T1.19.19.1.m1.2.2.1.1.3.2.cmml">T</mi><mi id="S3.T1.19.19.1.m1.2.2.1.1.3.3" xref="S3.T1.19.19.1.m1.2.2.1.1.3.3.cmml">u</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.1.m1.2b"><list id="S3.T1.19.19.1.m1.2.2.2.cmml" xref="S3.T1.19.19.1.m1.2.2.1"><ci id="S3.T1.19.19.1.m1.1.1.cmml" xref="S3.T1.19.19.1.m1.1.1">𝐡</ci><apply id="S3.T1.19.19.1.m1.2.2.1.1.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.T1.19.19.1.m1.2.2.1.1.1.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.T1.19.19.1.m1.2.2.1.1.2.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1.2">𝐡</ci><apply id="S3.T1.19.19.1.m1.2.2.1.1.3.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.T1.19.19.1.m1.2.2.1.1.3.1.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.T1.19.19.1.m1.2.2.1.1.3.2.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1.3.2">𝑇</ci><ci id="S3.T1.19.19.1.m1.2.2.1.1.3.3.cmml" xref="S3.T1.19.19.1.m1.2.2.1.1.3.3">𝑢</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.1.m1.2c">\mathbf{h},\mathbf{h}_{T_{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.19.19.1.m1.2d">bold_h , bold_h start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.19.19.2">Long and short-term interest embedding.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.20.20.1"><math alttext="\mathbf{MLP}" class="ltx_Math" display="inline" id="S3.T1.20.20.1.m1.1"><semantics id="S3.T1.20.20.1.m1.1a"><mi id="S3.T1.20.20.1.m1.1.1" xref="S3.T1.20.20.1.m1.1.1.cmml">𝐌𝐋𝐏</mi><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.1.m1.1b"><ci id="S3.T1.20.20.1.m1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1">𝐌𝐋𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.1.m1.1c">\mathbf{MLP}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.20.1.m1.1d">bold_MLP</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S3.T1.20.20.2">Multi-layer perceptron applied on the last dimension.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.21.21.1"><math alttext="\mathbf{W},\mathbf{b}" class="ltx_Math" display="inline" id="S3.T1.21.21.1.m1.2"><semantics id="S3.T1.21.21.1.m1.2a"><mrow id="S3.T1.21.21.1.m1.2.3.2" xref="S3.T1.21.21.1.m1.2.3.1.cmml"><mi id="S3.T1.21.21.1.m1.1.1" xref="S3.T1.21.21.1.m1.1.1.cmml">𝐖</mi><mo id="S3.T1.21.21.1.m1.2.3.2.1" xref="S3.T1.21.21.1.m1.2.3.1.cmml">,</mo><mi id="S3.T1.21.21.1.m1.2.2" xref="S3.T1.21.21.1.m1.2.2.cmml">𝐛</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.1.m1.2b"><list id="S3.T1.21.21.1.m1.2.3.1.cmml" xref="S3.T1.21.21.1.m1.2.3.2"><ci id="S3.T1.21.21.1.m1.1.1.cmml" xref="S3.T1.21.21.1.m1.1.1">𝐖</ci><ci id="S3.T1.21.21.1.m1.2.2.cmml" xref="S3.T1.21.21.1.m1.2.2">𝐛</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.1.m1.2c">\mathbf{W},\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.21.1.m1.2d">bold_W , bold_b</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T1.21.21.2">Learnable weight matrix and bias vector.</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Interest-aware Similarity Matrix</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Fine-grained target-historical item similarity is necessary to support the modeling of user fatigue. Indeed, the similarity between two items can stem from multiple aspects and correspond to multiple sub-interests of the user. For instance, the similarity of videos can be characterized by aspects such as shooting style, video tone, and topics, all of which can be used to model user fatigue when watching videos. Therefore, we first extract multi-interests from historical sequences.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.10">First of all, each item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_i</annotation></semantics></math> is assigned an embedding <math alttext="\mathbf{e}_{i}\in\mathbb{R}^{d\times 1}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.3.2" xref="S3.SS1.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.2.m2.1.1.3.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><in id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></in><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝐞</ci><ci id="S3.SS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3"><times id="S3.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3.2">𝑑</ci><cn id="S3.SS1.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{e}_{i}\in\mathbb{R}^{d\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_d</annotation></semantics></math> is the embedding dimension. Correspondingly, the sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑆</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_u</annotation></semantics></math> can be encoded as an embedding matrix <math alttext="\mathbf{S}_{u}\in\mathbb{R}^{d\times L_{u}}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><msub id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">𝐒</mi><mi id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">u</mi></msub><mo id="S3.SS1.p2.6.m6.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.6.m6.1.1.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.3.2" xref="S3.SS1.p2.6.m6.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.6.m6.1.1.3.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.3.3.2" xref="S3.SS1.p2.6.m6.1.1.3.3.3.2.cmml">L</mi><mi id="S3.SS1.p2.6.m6.1.1.3.3.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.3.3.cmml">u</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><in id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1"></in><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">𝐒</ci><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">𝑢</ci></apply><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3"><times id="S3.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.1"></times><ci id="S3.SS1.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.2">𝑑</ci><apply id="S3.SS1.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.3.2">𝐿</ci><ci id="S3.SS1.p2.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathbf{S}_{u}\in\mathbb{R}^{d\times L_{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">bold_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_l</annotation></semantics></math>-th column is <math alttext="\mathbf{e}_{i_{l}}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">𝐞</mi><msub id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml">i</mi><mi id="S3.SS1.p2.8.m8.1.1.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.cmml">l</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝐞</ci><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\mathbf{e}_{i_{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">bold_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, the embedding for item <math alttext="i_{l}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><msub id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">i</mi><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">𝑖</ci><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">i_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> in the sequence. We then choose a widely-used self-attention mechanism <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib29" title="">2017</a>; Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite> for multi-interest extraction. Specifically, we generate a multi-interest embedding matrix for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_u</annotation></semantics></math> as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E1">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}=\mathbf{S}_{u}\mathbf{A}," class="ltx_Math" display="inline" id="S3.E1X.2.1.1.m1.1"><semantics id="S3.E1X.2.1.1.m1.1a"><mrow id="S3.E1X.2.1.1.m1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E1X.2.1.1.m1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.2.cmml">𝐇</mi><mo id="S3.E1X.2.1.1.m1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1X.2.1.1.m1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.cmml"><msub id="S3.E1X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2.2.cmml">𝐒</mi><mi id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.E1X.2.1.1.m1.1.1.1.1.3.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.3.cmml">𝐀</mi></mrow></mrow><mo id="S3.E1X.2.1.1.m1.1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1"><eq id="S3.E1X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E1X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.2">𝐇</ci><apply id="S3.E1X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3"><times id="S3.E1X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.1"></times><apply id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2.2">𝐒</ci><ci id="S3.E1X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.2.3">𝑢</ci></apply><ci id="S3.E1X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1.3.3">𝐀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle\mathbf{H}=\mathbf{S}_{u}\mathbf{A},</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.2.1.1.m1.1d">bold_H = bold_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT bold_A ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{A}=\mathit{softmax}(\mathbf{MLP}_{1}(\mathbf{S}_{u}^{\top%
}))," class="ltx_Math" display="inline" id="S3.E1Xa.2.1.1.m1.1"><semantics id="S3.E1Xa.2.1.1.m1.1a"><mrow id="S3.E1Xa.2.1.1.m1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E1Xa.2.1.1.m1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.3.cmml">𝐀</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐒</mi><mi id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msubsup><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1Xa.2.1.1.m1.1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.2.1.1.m1.1b"><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1"><eq id="S3.E1Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.2"></eq><ci id="S3.E1Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.3">𝐀</ci><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.3">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</ci><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐒</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><csymbol cd="latexml" id="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.2.1.1.m1.1c">\displaystyle\mathbf{A}=\mathit{softmax}(\mathbf{MLP}_{1}(\mathbf{S}_{u}^{\top%
})),</annotation><annotation encoding="application/x-llamapun" id="S3.E1Xa.2.1.1.m1.1d">bold_A = italic_softmax ( bold_MLP start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.17">where <math alttext="\mathbf{MLP}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m1.1"><semantics id="S3.SS1.p2.11.m1.1a"><msub id="S3.SS1.p2.11.m1.1.1" xref="S3.SS1.p2.11.m1.1.1.cmml"><mi id="S3.SS1.p2.11.m1.1.1.2" xref="S3.SS1.p2.11.m1.1.1.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.SS1.p2.11.m1.1.1.3" xref="S3.SS1.p2.11.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m1.1b"><apply id="S3.SS1.p2.11.m1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m1.1.1.2.cmml" xref="S3.SS1.p2.11.m1.1.1.2">𝐌𝐋𝐏</ci><cn id="S3.SS1.p2.11.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.11.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m1.1c">\mathbf{MLP}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m1.1d">bold_MLP start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is a two-layer perceptron with <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.17.1">tanh</span> as nonlinear activation, and the output dimension is the number of interests <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m2.1"><semantics id="S3.SS1.p2.12.m2.1a"><mi id="S3.SS1.p2.12.m2.1.1" xref="S3.SS1.p2.12.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m2.1b"><ci id="S3.SS1.p2.12.m2.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m2.1d">italic_K</annotation></semantics></math>, which is a tunable hyper-parameter. Here <math alttext="\mathbf{A}\in\mathbb{R}^{L_{u}\times K}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m3.1"><semantics id="S3.SS1.p2.13.m3.1a"><mrow id="S3.SS1.p2.13.m3.1.1" xref="S3.SS1.p2.13.m3.1.1.cmml"><mi id="S3.SS1.p2.13.m3.1.1.2" xref="S3.SS1.p2.13.m3.1.1.2.cmml">𝐀</mi><mo id="S3.SS1.p2.13.m3.1.1.1" xref="S3.SS1.p2.13.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.13.m3.1.1.3" xref="S3.SS1.p2.13.m3.1.1.3.cmml"><mi id="S3.SS1.p2.13.m3.1.1.3.2" xref="S3.SS1.p2.13.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.13.m3.1.1.3.3" xref="S3.SS1.p2.13.m3.1.1.3.3.cmml"><msub id="S3.SS1.p2.13.m3.1.1.3.3.2" xref="S3.SS1.p2.13.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.13.m3.1.1.3.3.2.2" xref="S3.SS1.p2.13.m3.1.1.3.3.2.2.cmml">L</mi><mi id="S3.SS1.p2.13.m3.1.1.3.3.2.3" xref="S3.SS1.p2.13.m3.1.1.3.3.2.3.cmml">u</mi></msub><mo id="S3.SS1.p2.13.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.13.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.13.m3.1.1.3.3.3" xref="S3.SS1.p2.13.m3.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m3.1b"><apply id="S3.SS1.p2.13.m3.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1"><in id="S3.SS1.p2.13.m3.1.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1.1"></in><ci id="S3.SS1.p2.13.m3.1.1.2.cmml" xref="S3.SS1.p2.13.m3.1.1.2">𝐀</ci><apply id="S3.SS1.p2.13.m3.1.1.3.cmml" xref="S3.SS1.p2.13.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m3.1.1.3.1.cmml" xref="S3.SS1.p2.13.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.13.m3.1.1.3.2.cmml" xref="S3.SS1.p2.13.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.13.m3.1.1.3.3.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3"><times id="S3.SS1.p2.13.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.1"></times><apply id="S3.SS1.p2.13.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p2.13.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.2.2">𝐿</ci><ci id="S3.SS1.p2.13.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.2.3">𝑢</ci></apply><ci id="S3.SS1.p2.13.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.13.m3.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m3.1c">\mathbf{A}\in\mathbb{R}^{L_{u}\times K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m3.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT × italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> is attention weights for aggregating all the item embeddings in the sequence, which is generated by applying <math alttext="\mathit{softmax}" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m4.1"><semantics id="S3.SS1.p2.14.m4.1a"><mi id="S3.SS1.p2.14.m4.1.1" xref="S3.SS1.p2.14.m4.1.1.cmml">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m4.1b"><ci id="S3.SS1.p2.14.m4.1.1.cmml" xref="S3.SS1.p2.14.m4.1.1">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m4.1c">\mathit{softmax}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m4.1d">italic_softmax</annotation></semantics></math> along with the first dimension of <math alttext="\mathbf{MLP}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m5.1"><semantics id="S3.SS1.p2.15.m5.1a"><msub id="S3.SS1.p2.15.m5.1.1" xref="S3.SS1.p2.15.m5.1.1.cmml"><mi id="S3.SS1.p2.15.m5.1.1.2" xref="S3.SS1.p2.15.m5.1.1.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.SS1.p2.15.m5.1.1.3" xref="S3.SS1.p2.15.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m5.1b"><apply id="S3.SS1.p2.15.m5.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m5.1.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m5.1.1.2.cmml" xref="S3.SS1.p2.15.m5.1.1.2">𝐌𝐋𝐏</ci><cn id="S3.SS1.p2.15.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p2.15.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m5.1c">\mathbf{MLP}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m5.1d">bold_MLP start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> output. Finally, we obtain <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m6.1"><semantics id="S3.SS1.p2.16.m6.1a"><mi id="S3.SS1.p2.16.m6.1.1" xref="S3.SS1.p2.16.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m6.1b"><ci id="S3.SS1.p2.16.m6.1.1.cmml" xref="S3.SS1.p2.16.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m6.1d">italic_K</annotation></semantics></math> interest embeddings <math alttext="\mathbf{H}\in\mathbb{R}^{d\times K}" class="ltx_Math" display="inline" id="S3.SS1.p2.17.m7.1"><semantics id="S3.SS1.p2.17.m7.1a"><mrow id="S3.SS1.p2.17.m7.1.1" xref="S3.SS1.p2.17.m7.1.1.cmml"><mi id="S3.SS1.p2.17.m7.1.1.2" xref="S3.SS1.p2.17.m7.1.1.2.cmml">𝐇</mi><mo id="S3.SS1.p2.17.m7.1.1.1" xref="S3.SS1.p2.17.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.17.m7.1.1.3" xref="S3.SS1.p2.17.m7.1.1.3.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.2" xref="S3.SS1.p2.17.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.17.m7.1.1.3.3" xref="S3.SS1.p2.17.m7.1.1.3.3.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.3.2" xref="S3.SS1.p2.17.m7.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.p2.17.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.17.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.17.m7.1.1.3.3.3" xref="S3.SS1.p2.17.m7.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m7.1b"><apply id="S3.SS1.p2.17.m7.1.1.cmml" xref="S3.SS1.p2.17.m7.1.1"><in id="S3.SS1.p2.17.m7.1.1.1.cmml" xref="S3.SS1.p2.17.m7.1.1.1"></in><ci id="S3.SS1.p2.17.m7.1.1.2.cmml" xref="S3.SS1.p2.17.m7.1.1.2">𝐇</ci><apply id="S3.SS1.p2.17.m7.1.1.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.17.m7.1.1.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3"><times id="S3.SS1.p2.17.m7.1.1.3.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3.1"></times><ci id="S3.SS1.p2.17.m7.1.1.3.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.p2.17.m7.1.1.3.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m7.1c">\mathbf{H}\in\mathbb{R}^{d\times K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.17.m7.1d">bold_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> from the user’s historical interactions.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">To obtain fine-grained target-historical similarity, we leverage extracted multi-interest and item embeddings in latent space. Compared with existing works utilizing coarse-grained item-level or category-level features <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite>, the embedding-based similarity can measure relevance more accurately and effectively. Specifically, we construct an interest-aware similarity matrix to measure the similarity between the target item <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">i</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑖</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and historical item <math alttext="i_{l}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">i</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑖</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">i_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> with respect to each user interest, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{F}_{l,k}=\frac{1}{1+\left|\frac{\mathbf{e}_{i_{t}}^{\top}\mathbf{H}_{k%
}}{\|\mathbf{H}_{k}\|}-\frac{\mathbf{e}_{i_{l}}^{\top}\mathbf{H}_{k}}{\|%
\mathbf{H}_{k}\|}\right|}," class="ltx_Math" display="block" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml"><mi id="S3.E2.m1.6.6.1.1.2.2" xref="S3.E2.m1.6.6.1.1.2.2.cmml">𝐅</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">l</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml"><mn id="S3.E2.m1.5.5.5" xref="S3.E2.m1.5.5.5.cmml">1</mn><mrow id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml"><mn id="S3.E2.m1.5.5.3.5" xref="S3.E2.m1.5.5.3.5.cmml">1</mn><mo id="S3.E2.m1.5.5.3.4" xref="S3.E2.m1.5.5.3.4.cmml">+</mo><mrow id="S3.E2.m1.5.5.3.3.1" xref="S3.E2.m1.5.5.3.3.2.cmml"><mo id="S3.E2.m1.5.5.3.3.1.2" xref="S3.E2.m1.5.5.3.3.2.1.cmml">|</mo><mrow id="S3.E2.m1.5.5.3.3.1.1" xref="S3.E2.m1.5.5.3.3.1.1.cmml"><mfrac id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><msubsup id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.2.cmml">𝐞</mi><msub id="S3.E2.m1.3.3.1.1.3.2.2.3" xref="S3.E2.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.2.3.2" xref="S3.E2.m1.3.3.1.1.3.2.2.3.2.cmml">i</mi><mi id="S3.E2.m1.3.3.1.1.3.2.2.3.3" xref="S3.E2.m1.3.3.1.1.3.2.2.3.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><msub id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">𝐇</mi><mi id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">k</mi></msub></mrow><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.1.cmml">‖</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.2.cmml">𝐇</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E2.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="S3.E2.m1.5.5.3.3.1.1.1" xref="S3.E2.m1.5.5.3.3.1.1.1.cmml">−</mo><mfrac id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mrow id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.2.2.3.cmml"><msubsup id="S3.E2.m1.4.4.2.2.3.2" xref="S3.E2.m1.4.4.2.2.3.2.cmml"><mi id="S3.E2.m1.4.4.2.2.3.2.2.2" xref="S3.E2.m1.4.4.2.2.3.2.2.2.cmml">𝐞</mi><msub id="S3.E2.m1.4.4.2.2.3.2.2.3" xref="S3.E2.m1.4.4.2.2.3.2.2.3.cmml"><mi id="S3.E2.m1.4.4.2.2.3.2.2.3.2" xref="S3.E2.m1.4.4.2.2.3.2.2.3.2.cmml">i</mi><mi id="S3.E2.m1.4.4.2.2.3.2.2.3.3" xref="S3.E2.m1.4.4.2.2.3.2.2.3.3.cmml">l</mi></msub><mo id="S3.E2.m1.4.4.2.2.3.2.3" xref="S3.E2.m1.4.4.2.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.E2.m1.4.4.2.2.3.1" xref="S3.E2.m1.4.4.2.2.3.1.cmml">⁢</mo><msub id="S3.E2.m1.4.4.2.2.3.3" xref="S3.E2.m1.4.4.2.2.3.3.cmml"><mi id="S3.E2.m1.4.4.2.2.3.3.2" xref="S3.E2.m1.4.4.2.2.3.3.2.cmml">𝐇</mi><mi id="S3.E2.m1.4.4.2.2.3.3.3" xref="S3.E2.m1.4.4.2.2.3.3.3.cmml">k</mi></msub></mrow><mrow id="S3.E2.m1.4.4.2.2.1.1" xref="S3.E2.m1.4.4.2.2.1.2.cmml"><mo id="S3.E2.m1.4.4.2.2.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.2.2.1.2.1.cmml">‖</mo><msub id="S3.E2.m1.4.4.2.2.1.1.1" xref="S3.E2.m1.4.4.2.2.1.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.1.1.1.2" xref="S3.E2.m1.4.4.2.2.1.1.1.2.cmml">𝐇</mi><mi id="S3.E2.m1.4.4.2.2.1.1.1.3" xref="S3.E2.m1.4.4.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S3.E2.m1.4.4.2.2.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><mo id="S3.E2.m1.5.5.3.3.1.3" xref="S3.E2.m1.5.5.3.3.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"></eq><apply id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.2.2">𝐅</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑙</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"><divide id="S3.E2.m1.5.5.4.cmml" xref="S3.E2.m1.5.5"></divide><cn id="S3.E2.m1.5.5.5.cmml" type="integer" xref="S3.E2.m1.5.5.5">1</cn><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3"><plus id="S3.E2.m1.5.5.3.4.cmml" xref="S3.E2.m1.5.5.3.4"></plus><cn id="S3.E2.m1.5.5.3.5.cmml" type="integer" xref="S3.E2.m1.5.5.3.5">1</cn><apply id="S3.E2.m1.5.5.3.3.2.cmml" xref="S3.E2.m1.5.5.3.3.1"><abs id="S3.E2.m1.5.5.3.3.2.1.cmml" xref="S3.E2.m1.5.5.3.3.1.2"></abs><apply id="S3.E2.m1.5.5.3.3.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1"><minus id="S3.E2.m1.5.5.3.3.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.1.1.1"></minus><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><divide id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1"></divide><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2">𝐞</ci><apply id="S3.E2.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3.3">𝑡</ci></apply></apply><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">top</csymbol></apply><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">𝐇</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.2">𝐇</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><divide id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2"></divide><apply id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3"><times id="S3.E2.m1.4.4.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.1"></times><apply id="S3.E2.m1.4.4.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.2.1.cmml" xref="S3.E2.m1.4.4.2.2.3.2">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.3.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.3.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2.2.2">𝐞</ci><apply id="S3.E2.m1.4.4.2.2.3.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.2.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.3.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2.2.3.2">𝑖</ci><ci id="S3.E2.m1.4.4.2.2.3.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.2.2.3.3">𝑙</ci></apply></apply><csymbol cd="latexml" id="S3.E2.m1.4.4.2.2.3.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3.2.3">top</csymbol></apply><apply id="S3.E2.m1.4.4.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.3.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.2">𝐇</ci><ci id="S3.E2.m1.4.4.2.2.3.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.2.2.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.2">norm</csymbol><apply id="S3.E2.m1.4.4.2.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2">𝐇</ci><ci id="S3.E2.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\mathbf{F}_{l,k}=\frac{1}{1+\left|\frac{\mathbf{e}_{i_{t}}^{\top}\mathbf{H}_{k%
}}{\|\mathbf{H}_{k}\|}-\frac{\mathbf{e}_{i_{l}}^{\top}\mathbf{H}_{k}}{\|%
\mathbf{H}_{k}\|}\right|},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">bold_F start_POSTSUBSCRIPT italic_l , italic_k end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 1 + | divide start_ARG bold_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_H start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_H start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ end_ARG - divide start_ARG bold_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_H start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_H start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ end_ARG | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.14">where the similarity is based on the projection distance between the embedding of <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m1.1"><semantics id="S3.SS1.p3.3.m1.1a"><msub id="S3.SS1.p3.3.m1.1.1" xref="S3.SS1.p3.3.m1.1.1.cmml"><mi id="S3.SS1.p3.3.m1.1.1.2" xref="S3.SS1.p3.3.m1.1.1.2.cmml">i</mi><mi id="S3.SS1.p3.3.m1.1.1.3" xref="S3.SS1.p3.3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m1.1b"><apply id="S3.SS1.p3.3.m1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m1.1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m1.1.1.2.cmml" xref="S3.SS1.p3.3.m1.1.1.2">𝑖</ci><ci id="S3.SS1.p3.3.m1.1.1.3.cmml" xref="S3.SS1.p3.3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m1.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="i_{l}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m2.1"><semantics id="S3.SS1.p3.4.m2.1a"><msub id="S3.SS1.p3.4.m2.1.1" xref="S3.SS1.p3.4.m2.1.1.cmml"><mi id="S3.SS1.p3.4.m2.1.1.2" xref="S3.SS1.p3.4.m2.1.1.2.cmml">i</mi><mi id="S3.SS1.p3.4.m2.1.1.3" xref="S3.SS1.p3.4.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m2.1b"><apply id="S3.SS1.p3.4.m2.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m2.1.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m2.1.1.2.cmml" xref="S3.SS1.p3.4.m2.1.1.2">𝑖</ci><ci id="S3.SS1.p3.4.m2.1.1.3.cmml" xref="S3.SS1.p3.4.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m2.1c">i_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m2.1d">italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> on the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m3.1"><semantics id="S3.SS1.p3.5.m3.1a"><mi id="S3.SS1.p3.5.m3.1.1" xref="S3.SS1.p3.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m3.1b"><ci id="S3.SS1.p3.5.m3.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m3.1d">italic_k</annotation></semantics></math>-th interest embedding <math alttext="\mathbf{H}_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m4.1"><semantics id="S3.SS1.p3.6.m4.1a"><msub id="S3.SS1.p3.6.m4.1.1" xref="S3.SS1.p3.6.m4.1.1.cmml"><mi id="S3.SS1.p3.6.m4.1.1.2" xref="S3.SS1.p3.6.m4.1.1.2.cmml">𝐇</mi><mi id="S3.SS1.p3.6.m4.1.1.3" xref="S3.SS1.p3.6.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m4.1b"><apply id="S3.SS1.p3.6.m4.1.1.cmml" xref="S3.SS1.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m4.1.1.1.cmml" xref="S3.SS1.p3.6.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m4.1.1.2.cmml" xref="S3.SS1.p3.6.m4.1.1.2">𝐇</ci><ci id="S3.SS1.p3.6.m4.1.1.3.cmml" xref="S3.SS1.p3.6.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m4.1c">\mathbf{H}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m4.1d">bold_H start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and shorter distance means higher similarity. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.F3" title="Figure 3 ‣ 3.1. Interest-aware Similarity Matrix ‣ 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates how this similarity is calculated. Considering that user fatigue is the most relevant to items nearest to the target item, we confine the calculation of this similarity feature among the most recent <math alttext="T_{u}=\mathrm{min}(T,L_{u})" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m5.2"><semantics id="S3.SS1.p3.7.m5.2a"><mrow id="S3.SS1.p3.7.m5.2.2" xref="S3.SS1.p3.7.m5.2.2.cmml"><msub id="S3.SS1.p3.7.m5.2.2.3" xref="S3.SS1.p3.7.m5.2.2.3.cmml"><mi id="S3.SS1.p3.7.m5.2.2.3.2" xref="S3.SS1.p3.7.m5.2.2.3.2.cmml">T</mi><mi id="S3.SS1.p3.7.m5.2.2.3.3" xref="S3.SS1.p3.7.m5.2.2.3.3.cmml">u</mi></msub><mo id="S3.SS1.p3.7.m5.2.2.2" xref="S3.SS1.p3.7.m5.2.2.2.cmml">=</mo><mrow id="S3.SS1.p3.7.m5.2.2.1" xref="S3.SS1.p3.7.m5.2.2.1.cmml"><mi id="S3.SS1.p3.7.m5.2.2.1.3" xref="S3.SS1.p3.7.m5.2.2.1.3.cmml">min</mi><mo id="S3.SS1.p3.7.m5.2.2.1.2" xref="S3.SS1.p3.7.m5.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.7.m5.2.2.1.1.1" xref="S3.SS1.p3.7.m5.2.2.1.1.2.cmml"><mo id="S3.SS1.p3.7.m5.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p3.7.m5.2.2.1.1.2.cmml">(</mo><mi id="S3.SS1.p3.7.m5.1.1" xref="S3.SS1.p3.7.m5.1.1.cmml">T</mi><mo id="S3.SS1.p3.7.m5.2.2.1.1.1.3" xref="S3.SS1.p3.7.m5.2.2.1.1.2.cmml">,</mo><msub id="S3.SS1.p3.7.m5.2.2.1.1.1.1" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p3.7.m5.2.2.1.1.1.1.2" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1.2.cmml">L</mi><mi id="S3.SS1.p3.7.m5.2.2.1.1.1.1.3" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.SS1.p3.7.m5.2.2.1.1.1.4" stretchy="false" xref="S3.SS1.p3.7.m5.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m5.2b"><apply id="S3.SS1.p3.7.m5.2.2.cmml" xref="S3.SS1.p3.7.m5.2.2"><eq id="S3.SS1.p3.7.m5.2.2.2.cmml" xref="S3.SS1.p3.7.m5.2.2.2"></eq><apply id="S3.SS1.p3.7.m5.2.2.3.cmml" xref="S3.SS1.p3.7.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m5.2.2.3.1.cmml" xref="S3.SS1.p3.7.m5.2.2.3">subscript</csymbol><ci id="S3.SS1.p3.7.m5.2.2.3.2.cmml" xref="S3.SS1.p3.7.m5.2.2.3.2">𝑇</ci><ci id="S3.SS1.p3.7.m5.2.2.3.3.cmml" xref="S3.SS1.p3.7.m5.2.2.3.3">𝑢</ci></apply><apply id="S3.SS1.p3.7.m5.2.2.1.cmml" xref="S3.SS1.p3.7.m5.2.2.1"><times id="S3.SS1.p3.7.m5.2.2.1.2.cmml" xref="S3.SS1.p3.7.m5.2.2.1.2"></times><ci id="S3.SS1.p3.7.m5.2.2.1.3.cmml" xref="S3.SS1.p3.7.m5.2.2.1.3">min</ci><interval closure="open" id="S3.SS1.p3.7.m5.2.2.1.1.2.cmml" xref="S3.SS1.p3.7.m5.2.2.1.1.1"><ci id="S3.SS1.p3.7.m5.1.1.cmml" xref="S3.SS1.p3.7.m5.1.1">𝑇</ci><apply id="S3.SS1.p3.7.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1.2">𝐿</ci><ci id="S3.SS1.p3.7.m5.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p3.7.m5.2.2.1.1.1.1.3">𝑢</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m5.2c">T_{u}=\mathrm{min}(T,L_{u})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m5.2d">italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = roman_min ( italic_T , italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math> items, <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.14.1">i.e.</span>, <math alttext="l\in\{L_{u}-T_{u}+1,L_{u}-T_{u}+2,\cdots,L_{u}\}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m6.4"><semantics id="S3.SS1.p3.8.m6.4a"><mrow id="S3.SS1.p3.8.m6.4.4" xref="S3.SS1.p3.8.m6.4.4.cmml"><mi id="S3.SS1.p3.8.m6.4.4.5" xref="S3.SS1.p3.8.m6.4.4.5.cmml">l</mi><mo id="S3.SS1.p3.8.m6.4.4.4" xref="S3.SS1.p3.8.m6.4.4.4.cmml">∈</mo><mrow id="S3.SS1.p3.8.m6.4.4.3.3" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml"><mo id="S3.SS1.p3.8.m6.4.4.3.3.4" stretchy="false" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml">{</mo><mrow id="S3.SS1.p3.8.m6.2.2.1.1.1" xref="S3.SS1.p3.8.m6.2.2.1.1.1.cmml"><mrow id="S3.SS1.p3.8.m6.2.2.1.1.1.2" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.cmml"><msub id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.cmml"><mi id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.2" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.2.cmml">L</mi><mi id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.3" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.3.cmml">u</mi></msub><mo id="S3.SS1.p3.8.m6.2.2.1.1.1.2.1" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.1.cmml">−</mo><msub id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.2" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.2.cmml">T</mi><mi id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.3" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.3.cmml">u</mi></msub></mrow><mo id="S3.SS1.p3.8.m6.2.2.1.1.1.1" xref="S3.SS1.p3.8.m6.2.2.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.8.m6.2.2.1.1.1.3" xref="S3.SS1.p3.8.m6.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.8.m6.4.4.3.3.5" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml">,</mo><mrow id="S3.SS1.p3.8.m6.3.3.2.2.2" xref="S3.SS1.p3.8.m6.3.3.2.2.2.cmml"><mrow id="S3.SS1.p3.8.m6.3.3.2.2.2.2" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.cmml"><msub id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.2" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.2.cmml">L</mi><mi id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.3" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS1.p3.8.m6.3.3.2.2.2.2.1" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.1.cmml">−</mo><msub id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.2" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.2.cmml">T</mi><mi id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.3" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.3.cmml">u</mi></msub></mrow><mo id="S3.SS1.p3.8.m6.3.3.2.2.2.1" xref="S3.SS1.p3.8.m6.3.3.2.2.2.1.cmml">+</mo><mn id="S3.SS1.p3.8.m6.3.3.2.2.2.3" xref="S3.SS1.p3.8.m6.3.3.2.2.2.3.cmml">2</mn></mrow><mo id="S3.SS1.p3.8.m6.4.4.3.3.6" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p3.8.m6.1.1" mathvariant="normal" xref="S3.SS1.p3.8.m6.1.1.cmml">⋯</mi><mo id="S3.SS1.p3.8.m6.4.4.3.3.7" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p3.8.m6.4.4.3.3.3" xref="S3.SS1.p3.8.m6.4.4.3.3.3.cmml"><mi id="S3.SS1.p3.8.m6.4.4.3.3.3.2" xref="S3.SS1.p3.8.m6.4.4.3.3.3.2.cmml">L</mi><mi id="S3.SS1.p3.8.m6.4.4.3.3.3.3" xref="S3.SS1.p3.8.m6.4.4.3.3.3.3.cmml">u</mi></msub><mo id="S3.SS1.p3.8.m6.4.4.3.3.8" stretchy="false" xref="S3.SS1.p3.8.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m6.4b"><apply id="S3.SS1.p3.8.m6.4.4.cmml" xref="S3.SS1.p3.8.m6.4.4"><in id="S3.SS1.p3.8.m6.4.4.4.cmml" xref="S3.SS1.p3.8.m6.4.4.4"></in><ci id="S3.SS1.p3.8.m6.4.4.5.cmml" xref="S3.SS1.p3.8.m6.4.4.5">𝑙</ci><set id="S3.SS1.p3.8.m6.4.4.3.4.cmml" xref="S3.SS1.p3.8.m6.4.4.3.3"><apply id="S3.SS1.p3.8.m6.2.2.1.1.1.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1"><plus id="S3.SS1.p3.8.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.1"></plus><apply id="S3.SS1.p3.8.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2"><minus id="S3.SS1.p3.8.m6.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.1"></minus><apply id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.1.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.2">𝐿</ci><ci id="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.3.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.2.3">𝑢</ci></apply><apply id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.2">𝑇</ci><ci id="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.8.m6.2.2.1.1.1.2.3.3">𝑢</ci></apply></apply><cn id="S3.SS1.p3.8.m6.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.8.m6.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p3.8.m6.3.3.2.2.2.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2"><plus id="S3.SS1.p3.8.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.1"></plus><apply id="S3.SS1.p3.8.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2"><minus id="S3.SS1.p3.8.m6.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.1"></minus><apply id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.2">𝐿</ci><ci id="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.2.3">𝑢</ci></apply><apply id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.2">𝑇</ci><ci id="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.8.m6.3.3.2.2.2.2.3.3">𝑢</ci></apply></apply><cn id="S3.SS1.p3.8.m6.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p3.8.m6.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p3.8.m6.1.1.cmml" xref="S3.SS1.p3.8.m6.1.1">⋯</ci><apply id="S3.SS1.p3.8.m6.4.4.3.3.3.cmml" xref="S3.SS1.p3.8.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m6.4.4.3.3.3.1.cmml" xref="S3.SS1.p3.8.m6.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.8.m6.4.4.3.3.3.2.cmml" xref="S3.SS1.p3.8.m6.4.4.3.3.3.2">𝐿</ci><ci id="S3.SS1.p3.8.m6.4.4.3.3.3.3.cmml" xref="S3.SS1.p3.8.m6.4.4.3.3.3.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m6.4c">l\in\{L_{u}-T_{u}+1,L_{u}-T_{u}+2,\cdots,L_{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m6.4d">italic_l ∈ { italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT - italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 1 , italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT - italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 2 , ⋯ , italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT }</annotation></semantics></math>. <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m7.1"><semantics id="S3.SS1.p3.9.m7.1a"><mi id="S3.SS1.p3.9.m7.1.1" xref="S3.SS1.p3.9.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m7.1b"><ci id="S3.SS1.p3.9.m7.1.1.cmml" xref="S3.SS1.p3.9.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m7.1d">italic_T</annotation></semantics></math> is a tunable truncated threshold to control how many recent items should be included. We denote this sub-sequence of items as <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m8.1"><semantics id="S3.SS1.p3.10.m8.1a"><msub id="S3.SS1.p3.10.m8.1.1" xref="S3.SS1.p3.10.m8.1.1.cmml"><mover accent="true" id="S3.SS1.p3.10.m8.1.1.2" xref="S3.SS1.p3.10.m8.1.1.2.cmml"><mi id="S3.SS1.p3.10.m8.1.1.2.2" xref="S3.SS1.p3.10.m8.1.1.2.2.cmml">S</mi><mo id="S3.SS1.p3.10.m8.1.1.2.1" xref="S3.SS1.p3.10.m8.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p3.10.m8.1.1.3" xref="S3.SS1.p3.10.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m8.1b"><apply id="S3.SS1.p3.10.m8.1.1.cmml" xref="S3.SS1.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m8.1.1.1.cmml" xref="S3.SS1.p3.10.m8.1.1">subscript</csymbol><apply id="S3.SS1.p3.10.m8.1.1.2.cmml" xref="S3.SS1.p3.10.m8.1.1.2"><ci id="S3.SS1.p3.10.m8.1.1.2.1.cmml" xref="S3.SS1.p3.10.m8.1.1.2.1">^</ci><ci id="S3.SS1.p3.10.m8.1.1.2.2.cmml" xref="S3.SS1.p3.10.m8.1.1.2.2">𝑆</ci></apply><ci id="S3.SS1.p3.10.m8.1.1.3.cmml" xref="S3.SS1.p3.10.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m8.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m8.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>. The similarity matrix <math alttext="\mathbf{F}\in\mathbb{R}^{T\times K}" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m9.1"><semantics id="S3.SS1.p3.11.m9.1a"><mrow id="S3.SS1.p3.11.m9.1.1" xref="S3.SS1.p3.11.m9.1.1.cmml"><mi id="S3.SS1.p3.11.m9.1.1.2" xref="S3.SS1.p3.11.m9.1.1.2.cmml">𝐅</mi><mo id="S3.SS1.p3.11.m9.1.1.1" xref="S3.SS1.p3.11.m9.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.11.m9.1.1.3" xref="S3.SS1.p3.11.m9.1.1.3.cmml"><mi id="S3.SS1.p3.11.m9.1.1.3.2" xref="S3.SS1.p3.11.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.11.m9.1.1.3.3" xref="S3.SS1.p3.11.m9.1.1.3.3.cmml"><mi id="S3.SS1.p3.11.m9.1.1.3.3.2" xref="S3.SS1.p3.11.m9.1.1.3.3.2.cmml">T</mi><mo id="S3.SS1.p3.11.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.11.m9.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.11.m9.1.1.3.3.3" xref="S3.SS1.p3.11.m9.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m9.1b"><apply id="S3.SS1.p3.11.m9.1.1.cmml" xref="S3.SS1.p3.11.m9.1.1"><in id="S3.SS1.p3.11.m9.1.1.1.cmml" xref="S3.SS1.p3.11.m9.1.1.1"></in><ci id="S3.SS1.p3.11.m9.1.1.2.cmml" xref="S3.SS1.p3.11.m9.1.1.2">𝐅</ci><apply id="S3.SS1.p3.11.m9.1.1.3.cmml" xref="S3.SS1.p3.11.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m9.1.1.3.1.cmml" xref="S3.SS1.p3.11.m9.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.11.m9.1.1.3.2.cmml" xref="S3.SS1.p3.11.m9.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.11.m9.1.1.3.3.cmml" xref="S3.SS1.p3.11.m9.1.1.3.3"><times id="S3.SS1.p3.11.m9.1.1.3.3.1.cmml" xref="S3.SS1.p3.11.m9.1.1.3.3.1"></times><ci id="S3.SS1.p3.11.m9.1.1.3.3.2.cmml" xref="S3.SS1.p3.11.m9.1.1.3.3.2">𝑇</ci><ci id="S3.SS1.p3.11.m9.1.1.3.3.3.cmml" xref="S3.SS1.p3.11.m9.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m9.1c">\mathbf{F}\in\mathbb{R}^{T\times K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m9.1d">bold_F ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> will be padded with zeros as <math alttext="\mathbf{F}^{\top}=[\mathbf{F}^{\top},\mathbf{0}^{\top}_{K\times(T-L_{u})}]" class="ltx_Math" display="inline" id="S3.SS1.p3.12.m10.3"><semantics id="S3.SS1.p3.12.m10.3a"><mrow id="S3.SS1.p3.12.m10.3.3" xref="S3.SS1.p3.12.m10.3.3.cmml"><msup id="S3.SS1.p3.12.m10.3.3.4" xref="S3.SS1.p3.12.m10.3.3.4.cmml"><mi id="S3.SS1.p3.12.m10.3.3.4.2" xref="S3.SS1.p3.12.m10.3.3.4.2.cmml">𝐅</mi><mo id="S3.SS1.p3.12.m10.3.3.4.3" xref="S3.SS1.p3.12.m10.3.3.4.3.cmml">⊤</mo></msup><mo id="S3.SS1.p3.12.m10.3.3.3" xref="S3.SS1.p3.12.m10.3.3.3.cmml">=</mo><mrow id="S3.SS1.p3.12.m10.3.3.2.2" xref="S3.SS1.p3.12.m10.3.3.2.3.cmml"><mo id="S3.SS1.p3.12.m10.3.3.2.2.3" stretchy="false" xref="S3.SS1.p3.12.m10.3.3.2.3.cmml">[</mo><msup id="S3.SS1.p3.12.m10.2.2.1.1.1" xref="S3.SS1.p3.12.m10.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.12.m10.2.2.1.1.1.2" xref="S3.SS1.p3.12.m10.2.2.1.1.1.2.cmml">𝐅</mi><mo id="S3.SS1.p3.12.m10.2.2.1.1.1.3" xref="S3.SS1.p3.12.m10.2.2.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.SS1.p3.12.m10.3.3.2.2.4" xref="S3.SS1.p3.12.m10.3.3.2.3.cmml">,</mo><msubsup id="S3.SS1.p3.12.m10.3.3.2.2.2" xref="S3.SS1.p3.12.m10.3.3.2.2.2.cmml"><mn id="S3.SS1.p3.12.m10.3.3.2.2.2.2.2" xref="S3.SS1.p3.12.m10.3.3.2.2.2.2.2.cmml">𝟎</mn><mrow id="S3.SS1.p3.12.m10.1.1.1" xref="S3.SS1.p3.12.m10.1.1.1.cmml"><mi id="S3.SS1.p3.12.m10.1.1.1.3" xref="S3.SS1.p3.12.m10.1.1.1.3.cmml">K</mi><mo id="S3.SS1.p3.12.m10.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.12.m10.1.1.1.2.cmml">×</mo><mrow id="S3.SS1.p3.12.m10.1.1.1.1.1" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.12.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.12.m10.1.1.1.1.1.1" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.12.m10.1.1.1.1.1.1.2" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.2.cmml">T</mi><mo id="S3.SS1.p3.12.m10.1.1.1.1.1.1.1" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.2.cmml">L</mi><mi id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S3.SS1.p3.12.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.12.m10.3.3.2.2.2.2.3" xref="S3.SS1.p3.12.m10.3.3.2.2.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.SS1.p3.12.m10.3.3.2.2.5" stretchy="false" xref="S3.SS1.p3.12.m10.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m10.3b"><apply id="S3.SS1.p3.12.m10.3.3.cmml" xref="S3.SS1.p3.12.m10.3.3"><eq id="S3.SS1.p3.12.m10.3.3.3.cmml" xref="S3.SS1.p3.12.m10.3.3.3"></eq><apply id="S3.SS1.p3.12.m10.3.3.4.cmml" xref="S3.SS1.p3.12.m10.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m10.3.3.4.1.cmml" xref="S3.SS1.p3.12.m10.3.3.4">superscript</csymbol><ci id="S3.SS1.p3.12.m10.3.3.4.2.cmml" xref="S3.SS1.p3.12.m10.3.3.4.2">𝐅</ci><csymbol cd="latexml" id="S3.SS1.p3.12.m10.3.3.4.3.cmml" xref="S3.SS1.p3.12.m10.3.3.4.3">top</csymbol></apply><interval closure="closed" id="S3.SS1.p3.12.m10.3.3.2.3.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2"><apply id="S3.SS1.p3.12.m10.2.2.1.1.1.cmml" xref="S3.SS1.p3.12.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m10.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.12.m10.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p3.12.m10.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.12.m10.2.2.1.1.1.2">𝐅</ci><csymbol cd="latexml" id="S3.SS1.p3.12.m10.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.12.m10.2.2.1.1.1.3">top</csymbol></apply><apply id="S3.SS1.p3.12.m10.3.3.2.2.2.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m10.3.3.2.2.2.1.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2.2">subscript</csymbol><apply id="S3.SS1.p3.12.m10.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m10.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2.2">superscript</csymbol><cn id="S3.SS1.p3.12.m10.3.3.2.2.2.2.2.cmml" type="integer" xref="S3.SS1.p3.12.m10.3.3.2.2.2.2.2">0</cn><csymbol cd="latexml" id="S3.SS1.p3.12.m10.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p3.12.m10.3.3.2.2.2.2.3">top</csymbol></apply><apply id="S3.SS1.p3.12.m10.1.1.1.cmml" xref="S3.SS1.p3.12.m10.1.1.1"><times id="S3.SS1.p3.12.m10.1.1.1.2.cmml" xref="S3.SS1.p3.12.m10.1.1.1.2"></times><ci id="S3.SS1.p3.12.m10.1.1.1.3.cmml" xref="S3.SS1.p3.12.m10.1.1.1.3">𝐾</ci><apply id="S3.SS1.p3.12.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1"><minus id="S3.SS1.p3.12.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.1"></minus><ci id="S3.SS1.p3.12.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.2">𝑇</ci><apply id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.2">𝐿</ci><ci id="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.12.m10.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m10.3c">\mathbf{F}^{\top}=[\mathbf{F}^{\top},\mathbf{0}^{\top}_{K\times(T-L_{u})}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.12.m10.3d">bold_F start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = [ bold_F start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , bold_0 start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K × ( italic_T - italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ]</annotation></semantics></math> if <math alttext="T&gt;L_{u}" class="ltx_Math" display="inline" id="S3.SS1.p3.13.m11.1"><semantics id="S3.SS1.p3.13.m11.1a"><mrow id="S3.SS1.p3.13.m11.1.1" xref="S3.SS1.p3.13.m11.1.1.cmml"><mi id="S3.SS1.p3.13.m11.1.1.2" xref="S3.SS1.p3.13.m11.1.1.2.cmml">T</mi><mo id="S3.SS1.p3.13.m11.1.1.1" xref="S3.SS1.p3.13.m11.1.1.1.cmml">&gt;</mo><msub id="S3.SS1.p3.13.m11.1.1.3" xref="S3.SS1.p3.13.m11.1.1.3.cmml"><mi id="S3.SS1.p3.13.m11.1.1.3.2" xref="S3.SS1.p3.13.m11.1.1.3.2.cmml">L</mi><mi id="S3.SS1.p3.13.m11.1.1.3.3" xref="S3.SS1.p3.13.m11.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m11.1b"><apply id="S3.SS1.p3.13.m11.1.1.cmml" xref="S3.SS1.p3.13.m11.1.1"><gt id="S3.SS1.p3.13.m11.1.1.1.cmml" xref="S3.SS1.p3.13.m11.1.1.1"></gt><ci id="S3.SS1.p3.13.m11.1.1.2.cmml" xref="S3.SS1.p3.13.m11.1.1.2">𝑇</ci><apply id="S3.SS1.p3.13.m11.1.1.3.cmml" xref="S3.SS1.p3.13.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m11.1.1.3.1.cmml" xref="S3.SS1.p3.13.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.13.m11.1.1.3.2.cmml" xref="S3.SS1.p3.13.m11.1.1.3.2">𝐿</ci><ci id="S3.SS1.p3.13.m11.1.1.3.3.cmml" xref="S3.SS1.p3.13.m11.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m11.1c">T&gt;L_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.13.m11.1d">italic_T &gt; italic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="[\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.SS1.p3.14.m12.2"><semantics id="S3.SS1.p3.14.m12.2a"><mrow id="S3.SS1.p3.14.m12.2.3.2" xref="S3.SS1.p3.14.m12.2.3.1.cmml"><mo id="S3.SS1.p3.14.m12.2.3.2.1" stretchy="false" xref="S3.SS1.p3.14.m12.2.3.1.cmml">[</mo><mo id="S3.SS1.p3.14.m12.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p3.14.m12.1.1.cmml">⋅</mo><mo id="S3.SS1.p3.14.m12.2.3.2.2" rspace="0em" xref="S3.SS1.p3.14.m12.2.3.1.cmml">,</mo><mo id="S3.SS1.p3.14.m12.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p3.14.m12.2.2.cmml">⋅</mo><mo id="S3.SS1.p3.14.m12.2.3.2.3" stretchy="false" xref="S3.SS1.p3.14.m12.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m12.2b"><interval closure="closed" id="S3.SS1.p3.14.m12.2.3.1.cmml" xref="S3.SS1.p3.14.m12.2.3.2"><ci id="S3.SS1.p3.14.m12.1.1.cmml" xref="S3.SS1.p3.14.m12.1.1">⋅</ci><ci id="S3.SS1.p3.14.m12.2.2.cmml" xref="S3.SS1.p3.14.m12.2.2">⋅</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m12.2c">[\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.14.m12.2d">[ ⋅ , ⋅ ]</annotation></semantics></math> denotes the concatenation operation along the last dimension. It will support the modeling of user fatigue along with capturing users’ long and short-term interests.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S3.F3.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Illustration of the calculation of interest-aware similarity, represented by the length of the red line.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Fatigue-enhanced Multi-interest Fusion</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">Although multi-interest embeddings <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_H</annotation></semantics></math> capture multiple aspects of interests, there is a critical influence of user fatigue on long-term interests with respect to the target item. In other words, the importance should be decreased if the user is experiencing fatigue for a certain sub-interest. To adaptively adjust long-term interest, we propose a fatigue-enhanced multi-interest fusion built upon interest-aware similarity matrix <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_F</annotation></semantics></math>. A direct way is,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}=\mathbf{H}\mathbf{w}," class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.1"><semantics id="S3.E3X.2.1.1.m1.1a"><mrow id="S3.E3X.2.1.1.m1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.cmml">𝐡</mi><mo id="S3.E3X.2.1.1.m1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mi id="S3.E3X.2.1.1.m1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.cmml">𝐇𝐰</mi></mrow><mo id="S3.E3X.2.1.1.m1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1"><eq id="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E3X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2">𝐡</ci><ci id="S3.E3X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3">𝐇𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle\mathbf{h}=\mathbf{H}\mathbf{w},</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.1d">bold_h = bold_Hw ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{w}=\mathit{softmax}(\mathbf{MLP}_{2}(\mathbf{F}^{\top}))," class="ltx_Math" display="inline" id="S3.E3Xa.2.1.1.m1.1"><semantics id="S3.E3Xa.2.1.1.m1.1a"><mrow id="S3.E3Xa.2.1.1.m1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3.cmml">𝐰</mi><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</mi><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1"><eq id="S3.E3Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.2"></eq><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.3">𝐰</ci><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.3">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</ci><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐅</ci><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle\mathbf{w}=\mathit{softmax}(\mathbf{MLP}_{2}(\mathbf{F}^{\top})),</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.2.1.1.m1.1d">bold_w = italic_softmax ( bold_MLP start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_F start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.6">where <math alttext="\mathbf{MLP}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m1.1"><semantics id="S3.SS2.p1.3.m1.1a"><msub id="S3.SS2.p1.3.m1.1.1" xref="S3.SS2.p1.3.m1.1.1.cmml"><mi id="S3.SS2.p1.3.m1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.SS2.p1.3.m1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.1b"><apply id="S3.SS2.p1.3.m1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m1.1.1.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2">𝐌𝐋𝐏</ci><cn id="S3.SS2.p1.3.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.1c">\mathbf{MLP}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m1.1d">bold_MLP start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> has the output dimension of 1, and attention weights <math alttext="\mathbf{w}\in\mathbb{R}^{K\times 1}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m2.1"><semantics id="S3.SS2.p1.4.m2.1a"><mrow id="S3.SS2.p1.4.m2.1.1" xref="S3.SS2.p1.4.m2.1.1.cmml"><mi id="S3.SS2.p1.4.m2.1.1.2" xref="S3.SS2.p1.4.m2.1.1.2.cmml">𝐰</mi><mo id="S3.SS2.p1.4.m2.1.1.1" xref="S3.SS2.p1.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.4.m2.1.1.3" xref="S3.SS2.p1.4.m2.1.1.3.cmml"><mi id="S3.SS2.p1.4.m2.1.1.3.2" xref="S3.SS2.p1.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.4.m2.1.1.3.3" xref="S3.SS2.p1.4.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.4.m2.1.1.3.3.2" xref="S3.SS2.p1.4.m2.1.1.3.3.2.cmml">K</mi><mo id="S3.SS2.p1.4.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.4.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p1.4.m2.1.1.3.3.3" xref="S3.SS2.p1.4.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.1b"><apply id="S3.SS2.p1.4.m2.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1"><in id="S3.SS2.p1.4.m2.1.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1.1"></in><ci id="S3.SS2.p1.4.m2.1.1.2.cmml" xref="S3.SS2.p1.4.m2.1.1.2">𝐰</ci><apply id="S3.SS2.p1.4.m2.1.1.3.cmml" xref="S3.SS2.p1.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.1.1.3.1.cmml" xref="S3.SS2.p1.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m2.1.1.3.2.cmml" xref="S3.SS2.p1.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.4.m2.1.1.3.3.cmml" xref="S3.SS2.p1.4.m2.1.1.3.3"><times id="S3.SS2.p1.4.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.4.m2.1.1.3.3.1"></times><ci id="S3.SS2.p1.4.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.4.m2.1.1.3.3.2">𝐾</ci><cn id="S3.SS2.p1.4.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p1.4.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.1c">\mathbf{w}\in\mathbb{R}^{K\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m2.1d">bold_w ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> for interests fusion are obtained from similarity features with respect to each sub-interest. However, there are two key difficulties when learning fatigue-aware importance. On the one hand, the dependency of user fatigue on target-historical similarity can be nonlinear or even more complex <cite class="ltx_cite ltx_citemacro_citep">(Aharon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib2" title="">2019</a>; Moriwaki et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib31" title="">2019</a>)</cite>, and directly feeding these features into neural networks may not guarantee accurate modeling. On the other hand, several recently consumed items can jointly contribute to user fatigue on the target item. For example, compared with consuming only one video, a user experience much more fatigue if he/she has consumed five videos published by the same author of the target item within one hour. To tackle these problems, inspired by <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib38" title="">2017</a>)</cite>, we propose to utilize feature cross and apply <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m3.1"><semantics id="S3.SS2.p1.5.m3.1a"><mi id="S3.SS2.p1.5.m3.1.1" xref="S3.SS2.p1.5.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m3.1b"><ci id="S3.SS2.p1.5.m3.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m3.1d">italic_C</annotation></semantics></math> layers of Cross Network on the similarity matrix. Specifically, each cross layer processes the <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m4.1"><semantics id="S3.SS2.p1.6.m4.1a"><mi id="S3.SS2.p1.6.m4.1.1" xref="S3.SS2.p1.6.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m4.1b"><ci id="S3.SS2.p1.6.m4.1.1.cmml" xref="S3.SS2.p1.6.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m4.1d">italic_c</annotation></semantics></math>-th features as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{P}_{c+1}=\mathbf{P}_{0}\odot(\mathbf{W}_{c}\mathbf{P}_{c})+\mathbf{P}_%
{c}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">𝐏</mi><mrow id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S3.E4.m1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.cmml">𝐏</mi><mn id="S3.E4.m1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.E4.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐏</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">𝐏</mi><mi id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">𝐏</ci><apply id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><plus id="S3.E4.m1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1"></plus><ci id="S3.E4.m1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.2">𝑐</ci><cn id="S3.E4.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><plus id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2">𝐏</ci><cn id="S3.E4.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2">𝐖</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2">𝐏</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2">𝐏</ci><ci id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathbf{P}_{c+1}=\mathbf{P}_{0}\odot(\mathbf{W}_{c}\mathbf{P}_{c})+\mathbf{P}_%
{c},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_P start_POSTSUBSCRIPT italic_c + 1 end_POSTSUBSCRIPT = bold_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⊙ ( bold_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT bold_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + bold_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">where <math alttext="\mathbf{W}_{c}\in\mathbb{R}^{T\times T}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m1.1"><semantics id="S3.SS2.p1.7.m1.1a"><mrow id="S3.SS2.p1.7.m1.1.1" xref="S3.SS2.p1.7.m1.1.1.cmml"><msub id="S3.SS2.p1.7.m1.1.1.2" xref="S3.SS2.p1.7.m1.1.1.2.cmml"><mi id="S3.SS2.p1.7.m1.1.1.2.2" xref="S3.SS2.p1.7.m1.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.7.m1.1.1.2.3" xref="S3.SS2.p1.7.m1.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS2.p1.7.m1.1.1.1" xref="S3.SS2.p1.7.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.7.m1.1.1.3" xref="S3.SS2.p1.7.m1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m1.1.1.3.2" xref="S3.SS2.p1.7.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.7.m1.1.1.3.3" xref="S3.SS2.p1.7.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.7.m1.1.1.3.3.2" xref="S3.SS2.p1.7.m1.1.1.3.3.2.cmml">T</mi><mo id="S3.SS2.p1.7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.7.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.7.m1.1.1.3.3.3" xref="S3.SS2.p1.7.m1.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m1.1b"><apply id="S3.SS2.p1.7.m1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1"><in id="S3.SS2.p1.7.m1.1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1.1"></in><apply id="S3.SS2.p1.7.m1.1.1.2.cmml" xref="S3.SS2.p1.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m1.1.1.2.1.cmml" xref="S3.SS2.p1.7.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.7.m1.1.1.2.2.cmml" xref="S3.SS2.p1.7.m1.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.7.m1.1.1.2.3.cmml" xref="S3.SS2.p1.7.m1.1.1.2.3">𝑐</ci></apply><apply id="S3.SS2.p1.7.m1.1.1.3.cmml" xref="S3.SS2.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.7.m1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.7.m1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m1.1.1.3.3"><times id="S3.SS2.p1.7.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.7.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.7.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.7.m1.1.1.3.3.2">𝑇</ci><ci id="S3.SS2.p1.7.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.7.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m1.1c">\mathbf{W}_{c}\in\mathbb{R}^{T\times T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m1.1d">bold_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> is a learnable weight matrix and <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m2.1"><semantics id="S3.SS2.p1.8.m2.1a"><mo id="S3.SS2.p1.8.m2.1.1" xref="S3.SS2.p1.8.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m2.1b"><csymbol cd="latexml" id="S3.SS2.p1.8.m2.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m2.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m2.1d">⊙</annotation></semantics></math> denotes element-wise product. The layer <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m3.1"><semantics id="S3.SS2.p1.9.m3.1a"><mi id="S3.SS2.p1.9.m3.1.1" xref="S3.SS2.p1.9.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m3.1b"><ci id="S3.SS2.p1.9.m3.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m3.1d">italic_c</annotation></semantics></math> ranges from 0 to <math alttext="C-1" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m4.1"><semantics id="S3.SS2.p1.10.m4.1a"><mrow id="S3.SS2.p1.10.m4.1.1" xref="S3.SS2.p1.10.m4.1.1.cmml"><mi id="S3.SS2.p1.10.m4.1.1.2" xref="S3.SS2.p1.10.m4.1.1.2.cmml">C</mi><mo id="S3.SS2.p1.10.m4.1.1.1" xref="S3.SS2.p1.10.m4.1.1.1.cmml">−</mo><mn id="S3.SS2.p1.10.m4.1.1.3" xref="S3.SS2.p1.10.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m4.1b"><apply id="S3.SS2.p1.10.m4.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1"><minus id="S3.SS2.p1.10.m4.1.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1.1"></minus><ci id="S3.SS2.p1.10.m4.1.1.2.cmml" xref="S3.SS2.p1.10.m4.1.1.2">𝐶</ci><cn id="S3.SS2.p1.10.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p1.10.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m4.1c">C-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m4.1d">italic_C - 1</annotation></semantics></math> and <math alttext="\mathbf{P}_{0}=\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m5.1"><semantics id="S3.SS2.p1.11.m5.1a"><mrow id="S3.SS2.p1.11.m5.1.1" xref="S3.SS2.p1.11.m5.1.1.cmml"><msub id="S3.SS2.p1.11.m5.1.1.2" xref="S3.SS2.p1.11.m5.1.1.2.cmml"><mi id="S3.SS2.p1.11.m5.1.1.2.2" xref="S3.SS2.p1.11.m5.1.1.2.2.cmml">𝐏</mi><mn id="S3.SS2.p1.11.m5.1.1.2.3" xref="S3.SS2.p1.11.m5.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.p1.11.m5.1.1.1" xref="S3.SS2.p1.11.m5.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.11.m5.1.1.3" xref="S3.SS2.p1.11.m5.1.1.3.cmml">𝐅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m5.1b"><apply id="S3.SS2.p1.11.m5.1.1.cmml" xref="S3.SS2.p1.11.m5.1.1"><eq id="S3.SS2.p1.11.m5.1.1.1.cmml" xref="S3.SS2.p1.11.m5.1.1.1"></eq><apply id="S3.SS2.p1.11.m5.1.1.2.cmml" xref="S3.SS2.p1.11.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m5.1.1.2.1.cmml" xref="S3.SS2.p1.11.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.11.m5.1.1.2.2.cmml" xref="S3.SS2.p1.11.m5.1.1.2.2">𝐏</ci><cn id="S3.SS2.p1.11.m5.1.1.2.3.cmml" type="integer" xref="S3.SS2.p1.11.m5.1.1.2.3">0</cn></apply><ci id="S3.SS2.p1.11.m5.1.1.3.cmml" xref="S3.SS2.p1.11.m5.1.1.3">𝐅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m5.1c">\mathbf{P}_{0}=\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m5.1d">bold_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_F</annotation></semantics></math>. In this way, the feature interplay of the same item can generate high-order features for modeling complex similarity-fatigue dependency. The interplay between different items can assist in modeling the effect of multiple items on user fatigue. Finally, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.E3" title="In 3.2. Fatigue-enhanced Multi-interest Fusion ‣ 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> can be modified as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}=\mathbf{H}\mathbf{w}," class="ltx_Math" display="inline" id="S3.E5X.2.1.1.m1.1"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.2.cmml">𝐡</mi><mo id="S3.E5X.2.1.1.m1.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mi id="S3.E5X.2.1.1.m1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.1.1.3.cmml">𝐇𝐰</mi></mrow><mo id="S3.E5X.2.1.1.m1.1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"><eq id="S3.E5X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E5X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.2">𝐡</ci><ci id="S3.E5X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.1.1.3">𝐇𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathbf{h}=\mathbf{H}\mathbf{w},</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.2.1.1.m1.1d">bold_h = bold_Hw ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{w}=\mathit{softmax}\left(\mathbf{MLP}_{2}\left([\mathbf{P%
}_{C}^{\top},\mathbf{P}_{0}^{\top}]\right)\right)." class="ltx_Math" display="inline" id="S3.E5Xa.2.1.1.m1.1"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml">𝐰</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">[</mo><msubsup id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐏</mi><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">C</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msubsup><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐏</mi><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">0</mn><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"><eq id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.2"></eq><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.3">𝐰</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3">𝑠𝑜𝑓𝑡𝑚𝑎𝑥</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><interval closure="closed" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐏</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝐶</ci></apply><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐏</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">0</cn></apply><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\mathbf{w}=\mathit{softmax}\left(\mathbf{MLP}_{2}\left([\mathbf{P%
}_{C}^{\top},\mathbf{P}_{0}^{\top}]\right)\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.2.1.1.m1.1d">bold_w = italic_softmax ( bold_MLP start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( [ bold_P start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , bold_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.12">With the fatigue-enhanced fusion, we obtain the user’s long-term interest embedding <math alttext="\mathbf{h}\in\mathbb{R}^{d\times 1}" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m1.1"><semantics id="S3.SS2.p1.12.m1.1a"><mrow id="S3.SS2.p1.12.m1.1.1" xref="S3.SS2.p1.12.m1.1.1.cmml"><mi id="S3.SS2.p1.12.m1.1.1.2" xref="S3.SS2.p1.12.m1.1.1.2.cmml">𝐡</mi><mo id="S3.SS2.p1.12.m1.1.1.1" xref="S3.SS2.p1.12.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.12.m1.1.1.3" xref="S3.SS2.p1.12.m1.1.1.3.cmml"><mi id="S3.SS2.p1.12.m1.1.1.3.2" xref="S3.SS2.p1.12.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.12.m1.1.1.3.3" xref="S3.SS2.p1.12.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.12.m1.1.1.3.3.2" xref="S3.SS2.p1.12.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.p1.12.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.12.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p1.12.m1.1.1.3.3.3" xref="S3.SS2.p1.12.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m1.1b"><apply id="S3.SS2.p1.12.m1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1"><in id="S3.SS2.p1.12.m1.1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1.1"></in><ci id="S3.SS2.p1.12.m1.1.1.2.cmml" xref="S3.SS2.p1.12.m1.1.1.2">𝐡</ci><apply id="S3.SS2.p1.12.m1.1.1.3.cmml" xref="S3.SS2.p1.12.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m1.1.1.3.1.cmml" xref="S3.SS2.p1.12.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.12.m1.1.1.3.2.cmml" xref="S3.SS2.p1.12.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.12.m1.1.1.3.3.cmml" xref="S3.SS2.p1.12.m1.1.1.3.3"><times id="S3.SS2.p1.12.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.12.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.12.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.12.m1.1.1.3.3.2">𝑑</ci><cn id="S3.SS2.p1.12.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p1.12.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m1.1c">\mathbf{h}\in\mathbb{R}^{d\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m1.1d">bold_h ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Fatigue-gated Recurrent Unit</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">As stated in the previous subsection, recently consumed items in the historical sequence are important in causing user fatigue. Therefore, we model the influence of temporal user fatigue on short-term interest learning. Similarly, the similarity features are first processed with cross networks to tackle the problems of complex similarity-fatigue dependency and joint effects from multiple interests. Specifically, <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_C</annotation></semantics></math> cross layers are applied as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}_{c+1}=\mathbf{Q}_{0}\odot(\mathbf{Q}_{c}\mathbf{W}^{\prime}_{c})+%
\mathbf{Q}_{c}," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">𝐐</mi><mrow id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S3.E6.m1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">𝐐</mi><mn id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.E6.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐐</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">c</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml">𝐐</mi><mi id="S3.E6.m1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝐐</ci><apply id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><plus id="S3.E6.m1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.1"></plus><ci id="S3.E6.m1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2">𝑐</ci><cn id="S3.E6.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></plus><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">𝐐</ci><cn id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2">𝐐</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2">𝐐</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathbf{Q}_{c+1}=\mathbf{Q}_{0}\odot(\mathbf{Q}_{c}\mathbf{W}^{\prime}_{c})+%
\mathbf{Q}_{c},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_Q start_POSTSUBSCRIPT italic_c + 1 end_POSTSUBSCRIPT = bold_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⊙ ( bold_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT bold_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + bold_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.5">where <math alttext="\mathbf{W}^{\prime}_{c}\in\mathbb{R}^{K\times K}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m1.1"><semantics id="S3.SS3.p1.2.m1.1a"><mrow id="S3.SS3.p1.2.m1.1.1" xref="S3.SS3.p1.2.m1.1.1.cmml"><msubsup id="S3.SS3.p1.2.m1.1.1.2" xref="S3.SS3.p1.2.m1.1.1.2.cmml"><mi id="S3.SS3.p1.2.m1.1.1.2.2.2" xref="S3.SS3.p1.2.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS3.p1.2.m1.1.1.2.3" xref="S3.SS3.p1.2.m1.1.1.2.3.cmml">c</mi><mo id="S3.SS3.p1.2.m1.1.1.2.2.3" xref="S3.SS3.p1.2.m1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.p1.2.m1.1.1.1" xref="S3.SS3.p1.2.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.2.m1.1.1.3" xref="S3.SS3.p1.2.m1.1.1.3.cmml"><mi id="S3.SS3.p1.2.m1.1.1.3.2" xref="S3.SS3.p1.2.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.2.m1.1.1.3.3" xref="S3.SS3.p1.2.m1.1.1.3.3.cmml"><mi id="S3.SS3.p1.2.m1.1.1.3.3.2" xref="S3.SS3.p1.2.m1.1.1.3.3.2.cmml">K</mi><mo id="S3.SS3.p1.2.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.2.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.2.m1.1.1.3.3.3" xref="S3.SS3.p1.2.m1.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m1.1b"><apply id="S3.SS3.p1.2.m1.1.1.cmml" xref="S3.SS3.p1.2.m1.1.1"><in id="S3.SS3.p1.2.m1.1.1.1.cmml" xref="S3.SS3.p1.2.m1.1.1.1"></in><apply id="S3.SS3.p1.2.m1.1.1.2.cmml" xref="S3.SS3.p1.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m1.1.1.2.1.cmml" xref="S3.SS3.p1.2.m1.1.1.2">subscript</csymbol><apply id="S3.SS3.p1.2.m1.1.1.2.2.cmml" xref="S3.SS3.p1.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m1.1.1.2.2.1.cmml" xref="S3.SS3.p1.2.m1.1.1.2">superscript</csymbol><ci id="S3.SS3.p1.2.m1.1.1.2.2.2.cmml" xref="S3.SS3.p1.2.m1.1.1.2.2.2">𝐖</ci><ci id="S3.SS3.p1.2.m1.1.1.2.2.3.cmml" xref="S3.SS3.p1.2.m1.1.1.2.2.3">′</ci></apply><ci id="S3.SS3.p1.2.m1.1.1.2.3.cmml" xref="S3.SS3.p1.2.m1.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p1.2.m1.1.1.3.cmml" xref="S3.SS3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m1.1.1.3.1.cmml" xref="S3.SS3.p1.2.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.2.m1.1.1.3.2.cmml" xref="S3.SS3.p1.2.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.2.m1.1.1.3.3.cmml" xref="S3.SS3.p1.2.m1.1.1.3.3"><times id="S3.SS3.p1.2.m1.1.1.3.3.1.cmml" xref="S3.SS3.p1.2.m1.1.1.3.3.1"></times><ci id="S3.SS3.p1.2.m1.1.1.3.3.2.cmml" xref="S3.SS3.p1.2.m1.1.1.3.3.2">𝐾</ci><ci id="S3.SS3.p1.2.m1.1.1.3.3.3.cmml" xref="S3.SS3.p1.2.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m1.1c">\mathbf{W}^{\prime}_{c}\in\mathbb{R}^{K\times K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m1.1d">bold_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> is a learnable weight matrix and <math alttext="\mathbf{Q}_{0}=\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m2.1"><semantics id="S3.SS3.p1.3.m2.1a"><mrow id="S3.SS3.p1.3.m2.1.1" xref="S3.SS3.p1.3.m2.1.1.cmml"><msub id="S3.SS3.p1.3.m2.1.1.2" xref="S3.SS3.p1.3.m2.1.1.2.cmml"><mi id="S3.SS3.p1.3.m2.1.1.2.2" xref="S3.SS3.p1.3.m2.1.1.2.2.cmml">𝐐</mi><mn id="S3.SS3.p1.3.m2.1.1.2.3" xref="S3.SS3.p1.3.m2.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS3.p1.3.m2.1.1.1" xref="S3.SS3.p1.3.m2.1.1.1.cmml">=</mo><mi id="S3.SS3.p1.3.m2.1.1.3" xref="S3.SS3.p1.3.m2.1.1.3.cmml">𝐅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m2.1b"><apply id="S3.SS3.p1.3.m2.1.1.cmml" xref="S3.SS3.p1.3.m2.1.1"><eq id="S3.SS3.p1.3.m2.1.1.1.cmml" xref="S3.SS3.p1.3.m2.1.1.1"></eq><apply id="S3.SS3.p1.3.m2.1.1.2.cmml" xref="S3.SS3.p1.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m2.1.1.2.1.cmml" xref="S3.SS3.p1.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.3.m2.1.1.2.2.cmml" xref="S3.SS3.p1.3.m2.1.1.2.2">𝐐</ci><cn id="S3.SS3.p1.3.m2.1.1.2.3.cmml" type="integer" xref="S3.SS3.p1.3.m2.1.1.2.3">0</cn></apply><ci id="S3.SS3.p1.3.m2.1.1.3.cmml" xref="S3.SS3.p1.3.m2.1.1.3">𝐅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m2.1c">\mathbf{Q}_{0}=\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m2.1d">bold_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_F</annotation></semantics></math>. Furthermore, the temporal pattern contained in the sequence of recent items is also necessary for modeling fatigue. For instance, consuming five consecutive items similar to the target item will cause a more heightened perception of fatigue than that of disordered ones. Inspired by the effectiveness of CNNs in modeling sequences <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib36" title="">2018</a>; Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib5" title="">2018</a>)</cite>, we apply 1D convolutional networks to further model temporal user fatigue sequentially. Each layer of convolution operation for the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m3.1"><semantics id="S3.SS3.p1.4.m3.1a"><mi id="S3.SS3.p1.4.m3.1.1" xref="S3.SS3.p1.4.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m3.1b"><ci id="S3.SS3.p1.4.m3.1.1.cmml" xref="S3.SS3.p1.4.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m3.1d">italic_l</annotation></semantics></math>-th item in the sub-sequence <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m4.1"><semantics id="S3.SS3.p1.5.m4.1a"><msub id="S3.SS3.p1.5.m4.1.1" xref="S3.SS3.p1.5.m4.1.1.cmml"><mover accent="true" id="S3.SS3.p1.5.m4.1.1.2" xref="S3.SS3.p1.5.m4.1.1.2.cmml"><mi id="S3.SS3.p1.5.m4.1.1.2.2" xref="S3.SS3.p1.5.m4.1.1.2.2.cmml">S</mi><mo id="S3.SS3.p1.5.m4.1.1.2.1" xref="S3.SS3.p1.5.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.5.m4.1.1.3" xref="S3.SS3.p1.5.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m4.1b"><apply id="S3.SS3.p1.5.m4.1.1.cmml" xref="S3.SS3.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m4.1.1.1.cmml" xref="S3.SS3.p1.5.m4.1.1">subscript</csymbol><apply id="S3.SS3.p1.5.m4.1.1.2.cmml" xref="S3.SS3.p1.5.m4.1.1.2"><ci id="S3.SS3.p1.5.m4.1.1.2.1.cmml" xref="S3.SS3.p1.5.m4.1.1.2.1">^</ci><ci id="S3.SS3.p1.5.m4.1.1.2.2.cmml" xref="S3.SS3.p1.5.m4.1.1.2.2">𝑆</ci></apply><ci id="S3.SS3.p1.5.m4.1.1.3.cmml" xref="S3.SS3.p1.5.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m4.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m4.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is formulated as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{Q}}_{l}^{\top}=[q_{l}^{1},q_{l}^{2},\cdots,q_{l}^{d_%
{\mathrm{out}}}]^{\top}," class="ltx_Math" display="inline" id="S3.E7X.2.1.1.m1.2"><semantics id="S3.E7X.2.1.1.m1.2a"><mrow id="S3.E7X.2.1.1.m1.2.2.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.2.2.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml"><msubsup id="S3.E7X.2.1.1.m1.2.2.1.1.5" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml"><mover accent="true" id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.2.cmml">𝐐</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.1.cmml">^</mo></mover><mi id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.cmml">l</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.3.cmml">⊤</mo></msubsup><mo id="S3.E7X.2.1.1.m1.2.2.1.1.4" xref="S3.E7X.2.1.1.m1.2.2.1.1.4.cmml">=</mo><msup id="S3.E7X.2.1.1.m1.2.2.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.cmml"><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml"><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.4" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml">[</mo><msubsup id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">l</mi><mn id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.5" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.cmml">q</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.3.cmml">l</mi><mn id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.6" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><mi id="S3.E7X.2.1.1.m1.1.1" mathvariant="normal" xref="S3.E7X.2.1.1.m1.1.1.cmml">⋯</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.7" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.2.cmml">q</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.3.cmml">l</mi><msub id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.2.cmml">d</mi><mi id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.3.cmml">out</mi></msub></msubsup><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.8" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml">]</mo></mrow><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.5" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.5.cmml">⊤</mo></msup></mrow><mo id="S3.E7X.2.1.1.m1.2.2.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.2b"><apply id="S3.E7X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"><eq id="S3.E7X.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.4"></eq><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.5.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5">subscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2"><ci id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.1">^</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.2">𝐐</ci></apply><ci id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3">𝑙</ci></apply><csymbol cd="latexml" id="S3.E7X.2.1.1.m1.2.2.1.1.5.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.3">top</csymbol></apply><apply id="S3.E7X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3">superscript</csymbol><list id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.4.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3"><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2.3">𝑙</ci></apply><cn id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2">𝑞</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.3">𝑙</ci></apply><cn id="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1">⋯</ci><apply id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.2">𝑞</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.2.3">𝑙</ci></apply><apply id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.2">𝑑</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.3.3">out</ci></apply></apply></list><csymbol cd="latexml" id="S3.E7X.2.1.1.m1.2.2.1.1.3.5.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.5">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.2c">\displaystyle\hat{\mathbf{Q}}_{l}^{\top}=[q_{l}^{1},q_{l}^{2},\cdots,q_{l}^{d_%
{\mathrm{out}}}]^{\top},</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.2.1.1.m1.2d">over^ start_ARG bold_Q end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = [ italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , ⋯ , italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle q_{l}^{n}=\mathit{LeakyRelu}\left(\mathrm{SUM}\left(\hat{\mathbf%
{Q}}_{l-s+1:l}^{\top}\odot\mathbf{W}_{\mathrm{conv}}^{n}\right)\right)," class="ltx_Math" display="inline" id="S3.E7Xa.2.1.1.m1.1"><semantics id="S3.E7Xa.2.1.1.m1.1a"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml"><msubsup id="S3.E7Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml">q</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml">l</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml">n</mi></msubsup><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝐿𝑒𝑎𝑘𝑦𝑅𝑒𝑙𝑢</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">SUM</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐐</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.2.cmml">l</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.1.cmml">−</mo><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.3.cmml">s</mi></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1.cmml">+</mo><mn id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">:</mo><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">l</mi></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msubsup id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">conv</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msubsup></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1"><eq id="S3.E7Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2">𝑞</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.3">𝐿𝑒𝑎𝑘𝑦𝑅𝑒𝑙𝑢</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">SUM</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐐</ci></apply><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3"><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1">:</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2"><plus id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.1"></plus><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2"><minus id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.1"></minus><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.2">𝑙</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.2.3">𝑠</ci></apply><cn id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" type="integer" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.3">1</cn></apply><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑙</ci></apply></apply><csymbol cd="latexml" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">conv</ci></apply><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle q_{l}^{n}=\mathit{LeakyRelu}\left(\mathrm{SUM}\left(\hat{\mathbf%
{Q}}_{l-s+1:l}^{\top}\odot\mathbf{W}_{\mathrm{conv}}^{n}\right)\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.2.1.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = italic_LeakyRelu ( roman_SUM ( over^ start_ARG bold_Q end_ARG start_POSTSUBSCRIPT italic_l - italic_s + 1 : italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⊙ bold_W start_POSTSUBSCRIPT roman_conv end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.16">where <math alttext="\mathbf{W}_{\mathrm{conv}}^{n}\in\mathbb{R}^{d_{\mathrm{in}}\times s}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m1.1"><semantics id="S3.SS3.p1.6.m1.1a"><mrow id="S3.SS3.p1.6.m1.1.1" xref="S3.SS3.p1.6.m1.1.1.cmml"><msubsup id="S3.SS3.p1.6.m1.1.1.2" xref="S3.SS3.p1.6.m1.1.1.2.cmml"><mi id="S3.SS3.p1.6.m1.1.1.2.2.2" xref="S3.SS3.p1.6.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS3.p1.6.m1.1.1.2.2.3" xref="S3.SS3.p1.6.m1.1.1.2.2.3.cmml">conv</mi><mi id="S3.SS3.p1.6.m1.1.1.2.3" xref="S3.SS3.p1.6.m1.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.SS3.p1.6.m1.1.1.1" xref="S3.SS3.p1.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.6.m1.1.1.3" xref="S3.SS3.p1.6.m1.1.1.3.cmml"><mi id="S3.SS3.p1.6.m1.1.1.3.2" xref="S3.SS3.p1.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.6.m1.1.1.3.3" xref="S3.SS3.p1.6.m1.1.1.3.3.cmml"><msub id="S3.SS3.p1.6.m1.1.1.3.3.2" xref="S3.SS3.p1.6.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.p1.6.m1.1.1.3.3.2.2" xref="S3.SS3.p1.6.m1.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p1.6.m1.1.1.3.3.2.3" xref="S3.SS3.p1.6.m1.1.1.3.3.2.3.cmml">in</mi></msub><mo id="S3.SS3.p1.6.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.6.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.6.m1.1.1.3.3.3" xref="S3.SS3.p1.6.m1.1.1.3.3.3.cmml">s</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m1.1b"><apply id="S3.SS3.p1.6.m1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1"><in id="S3.SS3.p1.6.m1.1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1.1"></in><apply id="S3.SS3.p1.6.m1.1.1.2.cmml" xref="S3.SS3.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.6.m1.1.1.2.2.cmml" xref="S3.SS3.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.2.2.1.cmml" xref="S3.SS3.p1.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.6.m1.1.1.2.2.2.cmml" xref="S3.SS3.p1.6.m1.1.1.2.2.2">𝐖</ci><ci id="S3.SS3.p1.6.m1.1.1.2.2.3.cmml" xref="S3.SS3.p1.6.m1.1.1.2.2.3">conv</ci></apply><ci id="S3.SS3.p1.6.m1.1.1.2.3.cmml" xref="S3.SS3.p1.6.m1.1.1.2.3">𝑛</ci></apply><apply id="S3.SS3.p1.6.m1.1.1.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.3.1.cmml" xref="S3.SS3.p1.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.6.m1.1.1.3.2.cmml" xref="S3.SS3.p1.6.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.6.m1.1.1.3.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3"><times id="S3.SS3.p1.6.m1.1.1.3.3.1.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.1"></times><apply id="S3.SS3.p1.6.m1.1.1.3.3.2.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p1.6.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p1.6.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.2.3">in</ci></apply><ci id="S3.SS3.p1.6.m1.1.1.3.3.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m1.1c">\mathbf{W}_{\mathrm{conv}}^{n}\in\mathbb{R}^{d_{\mathrm{in}}\times s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m1.1d">bold_W start_POSTSUBSCRIPT roman_conv end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT × italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m2.1"><semantics id="S3.SS3.p1.7.m2.1a"><mi id="S3.SS3.p1.7.m2.1.1" xref="S3.SS3.p1.7.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m2.1b"><ci id="S3.SS3.p1.7.m2.1.1.cmml" xref="S3.SS3.p1.7.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m2.1d">italic_n</annotation></semantics></math>-th learnable filter kernel, and <math alttext="d_{\mathrm{in}}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m3.1"><semantics id="S3.SS3.p1.8.m3.1a"><msub id="S3.SS3.p1.8.m3.1.1" xref="S3.SS3.p1.8.m3.1.1.cmml"><mi id="S3.SS3.p1.8.m3.1.1.2" xref="S3.SS3.p1.8.m3.1.1.2.cmml">d</mi><mi id="S3.SS3.p1.8.m3.1.1.3" xref="S3.SS3.p1.8.m3.1.1.3.cmml">in</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m3.1b"><apply id="S3.SS3.p1.8.m3.1.1.cmml" xref="S3.SS3.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m3.1.1.1.cmml" xref="S3.SS3.p1.8.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m3.1.1.2.cmml" xref="S3.SS3.p1.8.m3.1.1.2">𝑑</ci><ci id="S3.SS3.p1.8.m3.1.1.3.cmml" xref="S3.SS3.p1.8.m3.1.1.3">in</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m3.1c">d_{\mathrm{in}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m3.1d">italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m4.1"><semantics id="S3.SS3.p1.9.m4.1a"><mi id="S3.SS3.p1.9.m4.1.1" xref="S3.SS3.p1.9.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m4.1b"><ci id="S3.SS3.p1.9.m4.1.1.cmml" xref="S3.SS3.p1.9.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m4.1d">italic_s</annotation></semantics></math> denotes the input dimension and the kernel size respectively. The number of filter kernels (<span class="ltx_text ltx_font_italic" id="S3.SS3.p1.16.1">i.e.</span>, the output dimension of this convolutional layer) is <math alttext="d_{\mathrm{out}}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m5.1"><semantics id="S3.SS3.p1.10.m5.1a"><msub id="S3.SS3.p1.10.m5.1.1" xref="S3.SS3.p1.10.m5.1.1.cmml"><mi id="S3.SS3.p1.10.m5.1.1.2" xref="S3.SS3.p1.10.m5.1.1.2.cmml">d</mi><mi id="S3.SS3.p1.10.m5.1.1.3" xref="S3.SS3.p1.10.m5.1.1.3.cmml">out</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m5.1b"><apply id="S3.SS3.p1.10.m5.1.1.cmml" xref="S3.SS3.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m5.1.1.1.cmml" xref="S3.SS3.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m5.1.1.2.cmml" xref="S3.SS3.p1.10.m5.1.1.2">𝑑</ci><ci id="S3.SS3.p1.10.m5.1.1.3.cmml" xref="S3.SS3.p1.10.m5.1.1.3">out</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m5.1c">d_{\mathrm{out}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m5.1d">italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT</annotation></semantics></math>. The input is the crossed features obtained above, <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.16.2">i.e.</span>, the initial <math alttext="\hat{\mathbf{Q}}=[\mathbf{Q}_{C},\mathbf{Q}_{0}]" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m6.2"><semantics id="S3.SS3.p1.11.m6.2a"><mrow id="S3.SS3.p1.11.m6.2.2" xref="S3.SS3.p1.11.m6.2.2.cmml"><mover accent="true" id="S3.SS3.p1.11.m6.2.2.4" xref="S3.SS3.p1.11.m6.2.2.4.cmml"><mi id="S3.SS3.p1.11.m6.2.2.4.2" xref="S3.SS3.p1.11.m6.2.2.4.2.cmml">𝐐</mi><mo id="S3.SS3.p1.11.m6.2.2.4.1" xref="S3.SS3.p1.11.m6.2.2.4.1.cmml">^</mo></mover><mo id="S3.SS3.p1.11.m6.2.2.3" xref="S3.SS3.p1.11.m6.2.2.3.cmml">=</mo><mrow id="S3.SS3.p1.11.m6.2.2.2.2" xref="S3.SS3.p1.11.m6.2.2.2.3.cmml"><mo id="S3.SS3.p1.11.m6.2.2.2.2.3" stretchy="false" xref="S3.SS3.p1.11.m6.2.2.2.3.cmml">[</mo><msub id="S3.SS3.p1.11.m6.1.1.1.1.1" xref="S3.SS3.p1.11.m6.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.11.m6.1.1.1.1.1.2" xref="S3.SS3.p1.11.m6.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S3.SS3.p1.11.m6.1.1.1.1.1.3" xref="S3.SS3.p1.11.m6.1.1.1.1.1.3.cmml">C</mi></msub><mo id="S3.SS3.p1.11.m6.2.2.2.2.4" xref="S3.SS3.p1.11.m6.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.11.m6.2.2.2.2.2" xref="S3.SS3.p1.11.m6.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.11.m6.2.2.2.2.2.2" xref="S3.SS3.p1.11.m6.2.2.2.2.2.2.cmml">𝐐</mi><mn id="S3.SS3.p1.11.m6.2.2.2.2.2.3" xref="S3.SS3.p1.11.m6.2.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.SS3.p1.11.m6.2.2.2.2.5" stretchy="false" xref="S3.SS3.p1.11.m6.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m6.2b"><apply id="S3.SS3.p1.11.m6.2.2.cmml" xref="S3.SS3.p1.11.m6.2.2"><eq id="S3.SS3.p1.11.m6.2.2.3.cmml" xref="S3.SS3.p1.11.m6.2.2.3"></eq><apply id="S3.SS3.p1.11.m6.2.2.4.cmml" xref="S3.SS3.p1.11.m6.2.2.4"><ci id="S3.SS3.p1.11.m6.2.2.4.1.cmml" xref="S3.SS3.p1.11.m6.2.2.4.1">^</ci><ci id="S3.SS3.p1.11.m6.2.2.4.2.cmml" xref="S3.SS3.p1.11.m6.2.2.4.2">𝐐</ci></apply><interval closure="closed" id="S3.SS3.p1.11.m6.2.2.2.3.cmml" xref="S3.SS3.p1.11.m6.2.2.2.2"><apply id="S3.SS3.p1.11.m6.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.11.m6.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.11.m6.1.1.1.1.1.2">𝐐</ci><ci id="S3.SS3.p1.11.m6.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.11.m6.1.1.1.1.1.3">𝐶</ci></apply><apply id="S3.SS3.p1.11.m6.2.2.2.2.2.cmml" xref="S3.SS3.p1.11.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m6.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.11.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.11.m6.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.11.m6.2.2.2.2.2.2">𝐐</ci><cn id="S3.SS3.p1.11.m6.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p1.11.m6.2.2.2.2.2.3">0</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m6.2c">\hat{\mathbf{Q}}=[\mathbf{Q}_{C},\mathbf{Q}_{0}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m6.2d">over^ start_ARG bold_Q end_ARG = [ bold_Q start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT , bold_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ]</annotation></semantics></math>, thus the initial <math alttext="d_{\mathrm{in}}=2K" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m7.1"><semantics id="S3.SS3.p1.12.m7.1a"><mrow id="S3.SS3.p1.12.m7.1.1" xref="S3.SS3.p1.12.m7.1.1.cmml"><msub id="S3.SS3.p1.12.m7.1.1.2" xref="S3.SS3.p1.12.m7.1.1.2.cmml"><mi id="S3.SS3.p1.12.m7.1.1.2.2" xref="S3.SS3.p1.12.m7.1.1.2.2.cmml">d</mi><mi id="S3.SS3.p1.12.m7.1.1.2.3" xref="S3.SS3.p1.12.m7.1.1.2.3.cmml">in</mi></msub><mo id="S3.SS3.p1.12.m7.1.1.1" xref="S3.SS3.p1.12.m7.1.1.1.cmml">=</mo><mrow id="S3.SS3.p1.12.m7.1.1.3" xref="S3.SS3.p1.12.m7.1.1.3.cmml"><mn id="S3.SS3.p1.12.m7.1.1.3.2" xref="S3.SS3.p1.12.m7.1.1.3.2.cmml">2</mn><mo id="S3.SS3.p1.12.m7.1.1.3.1" xref="S3.SS3.p1.12.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.12.m7.1.1.3.3" xref="S3.SS3.p1.12.m7.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m7.1b"><apply id="S3.SS3.p1.12.m7.1.1.cmml" xref="S3.SS3.p1.12.m7.1.1"><eq id="S3.SS3.p1.12.m7.1.1.1.cmml" xref="S3.SS3.p1.12.m7.1.1.1"></eq><apply id="S3.SS3.p1.12.m7.1.1.2.cmml" xref="S3.SS3.p1.12.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m7.1.1.2.1.cmml" xref="S3.SS3.p1.12.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.12.m7.1.1.2.2.cmml" xref="S3.SS3.p1.12.m7.1.1.2.2">𝑑</ci><ci id="S3.SS3.p1.12.m7.1.1.2.3.cmml" xref="S3.SS3.p1.12.m7.1.1.2.3">in</ci></apply><apply id="S3.SS3.p1.12.m7.1.1.3.cmml" xref="S3.SS3.p1.12.m7.1.1.3"><times id="S3.SS3.p1.12.m7.1.1.3.1.cmml" xref="S3.SS3.p1.12.m7.1.1.3.1"></times><cn id="S3.SS3.p1.12.m7.1.1.3.2.cmml" type="integer" xref="S3.SS3.p1.12.m7.1.1.3.2">2</cn><ci id="S3.SS3.p1.12.m7.1.1.3.3.cmml" xref="S3.SS3.p1.12.m7.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m7.1c">d_{\mathrm{in}}=2K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m7.1d">italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT = 2 italic_K</annotation></semantics></math>. After <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m8.1"><semantics id="S3.SS3.p1.13.m8.1a"><mi id="S3.SS3.p1.13.m8.1.1" xref="S3.SS3.p1.13.m8.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m8.1b"><ci id="S3.SS3.p1.13.m8.1.1.cmml" xref="S3.SS3.p1.13.m8.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m8.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m8.1d">italic_C</annotation></semantics></math> layers of convolution, we model temporal fatigue until the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m9.1"><semantics id="S3.SS3.p1.14.m9.1a"><mi id="S3.SS3.p1.14.m9.1.1" xref="S3.SS3.p1.14.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m9.1b"><ci id="S3.SS3.p1.14.m9.1.1.cmml" xref="S3.SS3.p1.14.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m9.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m9.1d">italic_l</annotation></semantics></math>-th item in the representation <math alttext="\hat{\mathbf{Q}}_{l}" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m10.1"><semantics id="S3.SS3.p1.15.m10.1a"><msub id="S3.SS3.p1.15.m10.1.1" xref="S3.SS3.p1.15.m10.1.1.cmml"><mover accent="true" id="S3.SS3.p1.15.m10.1.1.2" xref="S3.SS3.p1.15.m10.1.1.2.cmml"><mi id="S3.SS3.p1.15.m10.1.1.2.2" xref="S3.SS3.p1.15.m10.1.1.2.2.cmml">𝐐</mi><mo id="S3.SS3.p1.15.m10.1.1.2.1" xref="S3.SS3.p1.15.m10.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.15.m10.1.1.3" xref="S3.SS3.p1.15.m10.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m10.1b"><apply id="S3.SS3.p1.15.m10.1.1.cmml" xref="S3.SS3.p1.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m10.1.1.1.cmml" xref="S3.SS3.p1.15.m10.1.1">subscript</csymbol><apply id="S3.SS3.p1.15.m10.1.1.2.cmml" xref="S3.SS3.p1.15.m10.1.1.2"><ci id="S3.SS3.p1.15.m10.1.1.2.1.cmml" xref="S3.SS3.p1.15.m10.1.1.2.1">^</ci><ci id="S3.SS3.p1.15.m10.1.1.2.2.cmml" xref="S3.SS3.p1.15.m10.1.1.2.2">𝐐</ci></apply><ci id="S3.SS3.p1.15.m10.1.1.3.cmml" xref="S3.SS3.p1.15.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m10.1c">\hat{\mathbf{Q}}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m10.1d">over^ start_ARG bold_Q end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Note that we use ‘causal’ convolutions <cite class="ltx_cite ltx_citemacro_citep">(Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib5" title="">2018</a>)</cite> since current fatigue only depends on previous items. Zero padding is utilized when <math alttext="l&lt;s" class="ltx_Math" display="inline" id="S3.SS3.p1.16.m11.1"><semantics id="S3.SS3.p1.16.m11.1a"><mrow id="S3.SS3.p1.16.m11.1.1" xref="S3.SS3.p1.16.m11.1.1.cmml"><mi id="S3.SS3.p1.16.m11.1.1.2" xref="S3.SS3.p1.16.m11.1.1.2.cmml">l</mi><mo id="S3.SS3.p1.16.m11.1.1.1" xref="S3.SS3.p1.16.m11.1.1.1.cmml">&lt;</mo><mi id="S3.SS3.p1.16.m11.1.1.3" xref="S3.SS3.p1.16.m11.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m11.1b"><apply id="S3.SS3.p1.16.m11.1.1.cmml" xref="S3.SS3.p1.16.m11.1.1"><lt id="S3.SS3.p1.16.m11.1.1.1.cmml" xref="S3.SS3.p1.16.m11.1.1.1"></lt><ci id="S3.SS3.p1.16.m11.1.1.2.cmml" xref="S3.SS3.p1.16.m11.1.1.2">𝑙</ci><ci id="S3.SS3.p1.16.m11.1.1.3.cmml" xref="S3.SS3.p1.16.m11.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m11.1c">l&lt;s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.16.m11.1d">italic_l &lt; italic_s</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.3">In terms of modeling short-term interest, RNNs have been demonstrated as effective modules in many advanced works <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib17" title="">2015</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib45" title="">2019</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>, such as GRU, LSTM, <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.3.1">etc.</span> To incorporate fatigue influence, we propose a fatigue-gated recurrent unit (FRU) built upon GRU. Specifically, the extracted fatigue representation until each item serves as additional feature input to construct update and reset gates. With the state input <math alttext="\mathbf{h}_{l-1}\in\mathbb{R}^{d_{\mathrm{in}}\times 1}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><msub id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">𝐡</mi><mrow id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.1.2.3.2.cmml">l</mi><mo id="S3.SS3.p2.1.m1.1.1.2.3.1" xref="S3.SS3.p2.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.p2.1.m1.1.1.2.3.3" xref="S3.SS3.p2.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml"><msub id="S3.SS3.p2.1.m1.1.1.3.3.2" xref="S3.SS3.p2.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.3.2.2" xref="S3.SS3.p2.1.m1.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.1.m1.1.1.3.3.2.3" xref="S3.SS3.p2.1.m1.1.1.3.3.2.3.cmml">in</mi></msub><mo id="S3.SS3.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p2.1.m1.1.1.3.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><in id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></in><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">𝐡</ci><apply id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3"><minus id="S3.SS3.p2.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3.1"></minus><ci id="S3.SS3.p2.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3.2">𝑙</ci><cn id="S3.SS3.p2.1.m1.1.1.2.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3"><times id="S3.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.1"></times><apply id="S3.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.2.3">in</ci></apply><cn id="S3.SS3.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathbf{h}_{l-1}\in\mathbb{R}^{d_{\mathrm{in}}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">bold_h start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> from previous step and embedding input <math alttext="\mathbf{x}_{l}\in\mathbb{R}^{d_{\mathrm{in}}\times 1}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><msub id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml"><msub id="S3.SS3.p2.2.m2.1.1.3.3.2" xref="S3.SS3.p2.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.3.2.2" xref="S3.SS3.p2.2.m2.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.2.m2.1.1.3.3.2.3" xref="S3.SS3.p2.2.m2.1.1.3.3.2.3.cmml">in</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p2.2.m2.1.1.3.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><in id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></in><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝐱</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑙</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3"><times id="S3.SS3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.1"></times><apply id="S3.SS3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.2.3">in</ci></apply><cn id="S3.SS3.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathbf{x}_{l}\in\mathbb{R}^{d_{\mathrm{in}}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, new state <math alttext="\mathbf{h}_{l}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml"><msub id="S3.SS3.p2.3.m3.1.1.3.3.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.3.2.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.3.m3.1.1.3.3.2.3" xref="S3.SS3.p2.3.m3.1.1.3.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p2.3.m3.1.1.3.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><in id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></in><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝐡</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑙</ci></apply><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3"><times id="S3.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.1"></times><apply id="S3.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2.3">out</ci></apply><cn id="S3.SS3.p2.3.m3.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathbf{h}_{l}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">bold_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is calculated as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z}_{l}=\mathit{sigmoid}(\mathbf{W}_{z}\mathbf{x}_{l}+%
\mathbf{U}_{z}\mathbf{h}_{l-1}+\underline{\mathbf{V}_{z}\hat{\mathbf{Q}}_{l}}+%
\mathbf{b}_{z})," class="ltx_Math" display="inline" id="S3.E8X.2.1.1.m1.1"><semantics id="S3.E8X.2.1.1.m1.1a"><mrow id="S3.E8X.2.1.1.m1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.3.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mi><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">z</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐔</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">z</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐡</mi><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">l</mi><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><munder accentunder="true" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mrow id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml">𝐕</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3.cmml">z</mi></msub><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml">⁢</mo><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mover accent="true" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2.cmml">𝐐</mi><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1.cmml">^</mo></mover><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml">¯</mo></munder><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1b" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.2.cmml">𝐛</mi><mi id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.3" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.3.cmml">z</mi></msub></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8X.2.1.1.m1.1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.1b"><apply id="S3.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1"><eq id="S3.E8X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E8X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.3.2">𝐳</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1"><times id="S3.E8X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.3">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</ci><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1"><plus id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑧</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝐱</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐔</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3">𝑧</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝐡</ci><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3"><minus id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2">𝑙</ci><cn id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4"><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.1">¯</ci><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2"><times id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1"></times><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2">𝐕</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3">𝑧</ci></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2"><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1">^</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2">𝐐</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3">𝑙</ci></apply></apply></apply><apply id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.2">𝐛</ci><ci id="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.5.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.1c">\displaystyle\mathbf{z}_{l}=\mathit{sigmoid}(\mathbf{W}_{z}\mathbf{x}_{l}+%
\mathbf{U}_{z}\mathbf{h}_{l-1}+\underline{\mathbf{V}_{z}\hat{\mathbf{Q}}_{l}}+%
\mathbf{b}_{z}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.2.1.1.m1.1d">bold_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_sigmoid ( bold_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT + bold_U start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT bold_h start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT + under¯ start_ARG bold_V start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over^ start_ARG bold_Q end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG + bold_b start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{r}_{l}=\mathit{sigmoid}(\mathbf{W}_{r}\mathbf{x}_{l}+%
\mathbf{U}_{r}\mathbf{h}_{l-1}+\underline{\mathbf{V}_{r}\hat{\mathbf{Q}}_{l}}+%
\mathbf{b}_{r})," class="ltx_Math" display="inline" id="S3.E8Xa.2.1.1.m1.1"><semantics id="S3.E8Xa.2.1.1.m1.1a"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3.2.cmml">𝐫</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mi><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">r</mi></msub><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐔</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐡</mi><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">l</mi><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><munder accentunder="true" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mrow id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml"><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml">𝐕</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3.cmml">r</mi></msub><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml">⁢</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mover accent="true" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2.cmml">𝐐</mi><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1.cmml">^</mo></mover><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.1" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml">¯</mo></munder><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1b" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.2.cmml">𝐛</mi><mi id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.3" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.3.cmml">r</mi></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8Xa.2.1.1.m1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xa.2.1.1.m1.1b"><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1"><eq id="S3.E8Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3.2">𝐫</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.3">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</ci><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1"><plus id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑟</ci></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝐱</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐔</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝐡</ci><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3"><minus id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.2">𝑙</ci><cn id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4"><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.1">¯</ci><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2"><times id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.1"></times><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.2">𝐕</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.2.3">𝑟</ci></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3">subscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2"><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.1">^</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.2.2">𝐐</ci></apply><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.3.3">𝑙</ci></apply></apply></apply><apply id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.2">𝐛</ci><ci id="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.1.5.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.1c">\displaystyle\mathbf{r}_{l}=\mathit{sigmoid}(\mathbf{W}_{r}\mathbf{x}_{l}+%
\mathbf{U}_{r}\mathbf{h}_{l-1}+\underline{\mathbf{V}_{r}\hat{\mathbf{Q}}_{l}}+%
\mathbf{b}_{r}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xa.2.1.1.m1.1d">bold_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_sigmoid ( bold_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT + bold_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT bold_h start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT + under¯ start_ARG bold_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT over^ start_ARG bold_Q end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG + bold_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{h}}_{l}=\mathit{tanh}\left(\mathbf{W}_{h}\mathbf{x}_%
{l}+\mathbf{U}_{h}(\mathbf{r}_{l}\odot\mathbf{h}_{l-1})+\mathbf{b}_{h}\right)," class="ltx_Math" display="inline" id="S3.E8Xb.2.1.1.m1.1"><semantics id="S3.E8Xb.2.1.1.m1.1a"><mrow id="S3.E8Xb.2.1.1.m1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml">𝐡</mi><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.3.cmml">𝑡𝑎𝑛ℎ</mi><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">h</mi></msub><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐱</mi><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐔</mi><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">h</mi></msub><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐡</mi><mrow id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2a" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝐛</mi><mi id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml">h</mi></msub></mrow><mo id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8Xb.2.1.1.m1.1.1.1.2" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xb.2.1.1.m1.1b"><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1"><eq id="S3.E8Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2"><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.2.2">𝐡</ci></apply><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1"><times id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.3">𝑡𝑎𝑛ℎ</ci><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1"><plus id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐖</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝐱</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">𝐔</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">ℎ</ci></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐫</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐡</ci><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑙</ci><cn id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.2">𝐛</ci><ci id="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E8Xb.2.1.1.m1.1.1.1.1.1.1.1.1.4.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xb.2.1.1.m1.1c">\displaystyle\hat{\mathbf{h}}_{l}=\mathit{tanh}\left(\mathbf{W}_{h}\mathbf{x}_%
{l}+\mathbf{U}_{h}(\mathbf{r}_{l}\odot\mathbf{h}_{l-1})+\mathbf{b}_{h}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xb.2.1.1.m1.1d">over^ start_ARG bold_h end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_tanh ( bold_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT + bold_U start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( bold_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ⊙ bold_h start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ) + bold_b start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{l}=(1-\mathbf{z}_{l})\odot\mathbf{h}_{l-1}+\mathbf{z}%
_{l}\odot\hat{\mathbf{h}}_{l}," class="ltx_Math" display="inline" id="S3.E8Xc.2.1.1.m1.1"><semantics id="S3.E8Xc.2.1.1.m1.1a"><mrow id="S3.E8Xc.2.1.1.m1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E8Xc.2.1.1.m1.1.1.1.1.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">𝐡</mi><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.cmml"><msub id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.2.cmml">𝐳</mi><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.1.cmml">⊙</mo><msub id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.2.cmml">𝐡</mi><mo id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.1" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.3" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow></mrow><mo id="S3.E8Xc.2.1.1.m1.1.1.1.2" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xc.2.1.1.m1.1b"><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1"><eq id="S3.E8Xc.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3.2">𝐡</ci><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1"><plus id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.2"></plus><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.2">𝐡</ci><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3"><minus id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.2">𝑙</ci><cn id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.1">direct-product</csymbol><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.2">𝐳</ci><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2"><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.1">^</ci><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.2.2">𝐡</ci></apply><ci id="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8Xc.2.1.1.m1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xc.2.1.1.m1.1c">\displaystyle\mathbf{h}_{l}=(1-\mathbf{z}_{l})\odot\mathbf{h}_{l-1}+\mathbf{z}%
_{l}\odot\hat{\mathbf{h}}_{l},</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xc.2.1.1.m1.1d">bold_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = ( 1 - bold_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ⊙ bold_h start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT + bold_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ⊙ over^ start_ARG bold_h end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.10">where <math alttext="\mathbf{W}_{z,r,h},\mathbf{U}_{z,r,h},\mathbf{V}_{z,r}\in\mathbb{R}^{d_{%
\mathrm{out}}\times d_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m1.11"><semantics id="S3.SS3.p2.4.m1.11a"><mrow id="S3.SS3.p2.4.m1.11.11" xref="S3.SS3.p2.4.m1.11.11.cmml"><mrow id="S3.SS3.p2.4.m1.11.11.3.3" xref="S3.SS3.p2.4.m1.11.11.3.4.cmml"><msub id="S3.SS3.p2.4.m1.9.9.1.1.1" xref="S3.SS3.p2.4.m1.9.9.1.1.1.cmml"><mi id="S3.SS3.p2.4.m1.9.9.1.1.1.2" xref="S3.SS3.p2.4.m1.9.9.1.1.1.2.cmml">𝐖</mi><mrow id="S3.SS3.p2.4.m1.3.3.3.5" xref="S3.SS3.p2.4.m1.3.3.3.4.cmml"><mi id="S3.SS3.p2.4.m1.1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.1.cmml">z</mi><mo id="S3.SS3.p2.4.m1.3.3.3.5.1" xref="S3.SS3.p2.4.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p2.4.m1.2.2.2.2" xref="S3.SS3.p2.4.m1.2.2.2.2.cmml">r</mi><mo id="S3.SS3.p2.4.m1.3.3.3.5.2" xref="S3.SS3.p2.4.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p2.4.m1.3.3.3.3" xref="S3.SS3.p2.4.m1.3.3.3.3.cmml">h</mi></mrow></msub><mo id="S3.SS3.p2.4.m1.11.11.3.3.4" xref="S3.SS3.p2.4.m1.11.11.3.4.cmml">,</mo><msub id="S3.SS3.p2.4.m1.10.10.2.2.2" xref="S3.SS3.p2.4.m1.10.10.2.2.2.cmml"><mi id="S3.SS3.p2.4.m1.10.10.2.2.2.2" xref="S3.SS3.p2.4.m1.10.10.2.2.2.2.cmml">𝐔</mi><mrow id="S3.SS3.p2.4.m1.6.6.3.5" xref="S3.SS3.p2.4.m1.6.6.3.4.cmml"><mi id="S3.SS3.p2.4.m1.4.4.1.1" xref="S3.SS3.p2.4.m1.4.4.1.1.cmml">z</mi><mo id="S3.SS3.p2.4.m1.6.6.3.5.1" xref="S3.SS3.p2.4.m1.6.6.3.4.cmml">,</mo><mi id="S3.SS3.p2.4.m1.5.5.2.2" xref="S3.SS3.p2.4.m1.5.5.2.2.cmml">r</mi><mo id="S3.SS3.p2.4.m1.6.6.3.5.2" xref="S3.SS3.p2.4.m1.6.6.3.4.cmml">,</mo><mi id="S3.SS3.p2.4.m1.6.6.3.3" xref="S3.SS3.p2.4.m1.6.6.3.3.cmml">h</mi></mrow></msub><mo id="S3.SS3.p2.4.m1.11.11.3.3.5" xref="S3.SS3.p2.4.m1.11.11.3.4.cmml">,</mo><msub id="S3.SS3.p2.4.m1.11.11.3.3.3" xref="S3.SS3.p2.4.m1.11.11.3.3.3.cmml"><mi id="S3.SS3.p2.4.m1.11.11.3.3.3.2" xref="S3.SS3.p2.4.m1.11.11.3.3.3.2.cmml">𝐕</mi><mrow id="S3.SS3.p2.4.m1.8.8.2.4" xref="S3.SS3.p2.4.m1.8.8.2.3.cmml"><mi id="S3.SS3.p2.4.m1.7.7.1.1" xref="S3.SS3.p2.4.m1.7.7.1.1.cmml">z</mi><mo id="S3.SS3.p2.4.m1.8.8.2.4.1" xref="S3.SS3.p2.4.m1.8.8.2.3.cmml">,</mo><mi id="S3.SS3.p2.4.m1.8.8.2.2" xref="S3.SS3.p2.4.m1.8.8.2.2.cmml">r</mi></mrow></msub></mrow><mo id="S3.SS3.p2.4.m1.11.11.4" xref="S3.SS3.p2.4.m1.11.11.4.cmml">∈</mo><msup id="S3.SS3.p2.4.m1.11.11.5" xref="S3.SS3.p2.4.m1.11.11.5.cmml"><mi id="S3.SS3.p2.4.m1.11.11.5.2" xref="S3.SS3.p2.4.m1.11.11.5.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.4.m1.11.11.5.3" xref="S3.SS3.p2.4.m1.11.11.5.3.cmml"><msub id="S3.SS3.p2.4.m1.11.11.5.3.2" xref="S3.SS3.p2.4.m1.11.11.5.3.2.cmml"><mi id="S3.SS3.p2.4.m1.11.11.5.3.2.2" xref="S3.SS3.p2.4.m1.11.11.5.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.4.m1.11.11.5.3.2.3" xref="S3.SS3.p2.4.m1.11.11.5.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.p2.4.m1.11.11.5.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.4.m1.11.11.5.3.1.cmml">×</mo><msub id="S3.SS3.p2.4.m1.11.11.5.3.3" xref="S3.SS3.p2.4.m1.11.11.5.3.3.cmml"><mi id="S3.SS3.p2.4.m1.11.11.5.3.3.2" xref="S3.SS3.p2.4.m1.11.11.5.3.3.2.cmml">d</mi><mi id="S3.SS3.p2.4.m1.11.11.5.3.3.3" xref="S3.SS3.p2.4.m1.11.11.5.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.11b"><apply id="S3.SS3.p2.4.m1.11.11.cmml" xref="S3.SS3.p2.4.m1.11.11"><in id="S3.SS3.p2.4.m1.11.11.4.cmml" xref="S3.SS3.p2.4.m1.11.11.4"></in><list id="S3.SS3.p2.4.m1.11.11.3.4.cmml" xref="S3.SS3.p2.4.m1.11.11.3.3"><apply id="S3.SS3.p2.4.m1.9.9.1.1.1.cmml" xref="S3.SS3.p2.4.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.9.9.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.9.9.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m1.9.9.1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.9.9.1.1.1.2">𝐖</ci><list id="S3.SS3.p2.4.m1.3.3.3.4.cmml" xref="S3.SS3.p2.4.m1.3.3.3.5"><ci id="S3.SS3.p2.4.m1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1.1">𝑧</ci><ci id="S3.SS3.p2.4.m1.2.2.2.2.cmml" xref="S3.SS3.p2.4.m1.2.2.2.2">𝑟</ci><ci id="S3.SS3.p2.4.m1.3.3.3.3.cmml" xref="S3.SS3.p2.4.m1.3.3.3.3">ℎ</ci></list></apply><apply id="S3.SS3.p2.4.m1.10.10.2.2.2.cmml" xref="S3.SS3.p2.4.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.10.10.2.2.2.1.cmml" xref="S3.SS3.p2.4.m1.10.10.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.4.m1.10.10.2.2.2.2.cmml" xref="S3.SS3.p2.4.m1.10.10.2.2.2.2">𝐔</ci><list id="S3.SS3.p2.4.m1.6.6.3.4.cmml" xref="S3.SS3.p2.4.m1.6.6.3.5"><ci id="S3.SS3.p2.4.m1.4.4.1.1.cmml" xref="S3.SS3.p2.4.m1.4.4.1.1">𝑧</ci><ci id="S3.SS3.p2.4.m1.5.5.2.2.cmml" xref="S3.SS3.p2.4.m1.5.5.2.2">𝑟</ci><ci id="S3.SS3.p2.4.m1.6.6.3.3.cmml" xref="S3.SS3.p2.4.m1.6.6.3.3">ℎ</ci></list></apply><apply id="S3.SS3.p2.4.m1.11.11.3.3.3.cmml" xref="S3.SS3.p2.4.m1.11.11.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.11.11.3.3.3.1.cmml" xref="S3.SS3.p2.4.m1.11.11.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.4.m1.11.11.3.3.3.2.cmml" xref="S3.SS3.p2.4.m1.11.11.3.3.3.2">𝐕</ci><list id="S3.SS3.p2.4.m1.8.8.2.3.cmml" xref="S3.SS3.p2.4.m1.8.8.2.4"><ci id="S3.SS3.p2.4.m1.7.7.1.1.cmml" xref="S3.SS3.p2.4.m1.7.7.1.1">𝑧</ci><ci id="S3.SS3.p2.4.m1.8.8.2.2.cmml" xref="S3.SS3.p2.4.m1.8.8.2.2">𝑟</ci></list></apply></list><apply id="S3.SS3.p2.4.m1.11.11.5.cmml" xref="S3.SS3.p2.4.m1.11.11.5"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.11.11.5.1.cmml" xref="S3.SS3.p2.4.m1.11.11.5">superscript</csymbol><ci id="S3.SS3.p2.4.m1.11.11.5.2.cmml" xref="S3.SS3.p2.4.m1.11.11.5.2">ℝ</ci><apply id="S3.SS3.p2.4.m1.11.11.5.3.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3"><times id="S3.SS3.p2.4.m1.11.11.5.3.1.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.1"></times><apply id="S3.SS3.p2.4.m1.11.11.5.3.2.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.11.11.5.3.2.1.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.2">subscript</csymbol><ci id="S3.SS3.p2.4.m1.11.11.5.3.2.2.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.2.2">𝑑</ci><ci id="S3.SS3.p2.4.m1.11.11.5.3.2.3.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.2.3">out</ci></apply><apply id="S3.SS3.p2.4.m1.11.11.5.3.3.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.11.11.5.3.3.1.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.3">subscript</csymbol><ci id="S3.SS3.p2.4.m1.11.11.5.3.3.2.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.3.2">𝑑</ci><ci id="S3.SS3.p2.4.m1.11.11.5.3.3.3.cmml" xref="S3.SS3.p2.4.m1.11.11.5.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.11c">\mathbf{W}_{z,r,h},\mathbf{U}_{z,r,h},\mathbf{V}_{z,r}\in\mathbb{R}^{d_{%
\mathrm{out}}\times d_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m1.11d">bold_W start_POSTSUBSCRIPT italic_z , italic_r , italic_h end_POSTSUBSCRIPT , bold_U start_POSTSUBSCRIPT italic_z , italic_r , italic_h end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_z , italic_r end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{z,r,h}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m2.3"><semantics id="S3.SS3.p2.5.m2.3a"><mrow id="S3.SS3.p2.5.m2.3.4" xref="S3.SS3.p2.5.m2.3.4.cmml"><msub id="S3.SS3.p2.5.m2.3.4.2" xref="S3.SS3.p2.5.m2.3.4.2.cmml"><mi id="S3.SS3.p2.5.m2.3.4.2.2" xref="S3.SS3.p2.5.m2.3.4.2.2.cmml">𝐛</mi><mrow id="S3.SS3.p2.5.m2.3.3.3.5" xref="S3.SS3.p2.5.m2.3.3.3.4.cmml"><mi id="S3.SS3.p2.5.m2.1.1.1.1" xref="S3.SS3.p2.5.m2.1.1.1.1.cmml">z</mi><mo id="S3.SS3.p2.5.m2.3.3.3.5.1" xref="S3.SS3.p2.5.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p2.5.m2.2.2.2.2" xref="S3.SS3.p2.5.m2.2.2.2.2.cmml">r</mi><mo id="S3.SS3.p2.5.m2.3.3.3.5.2" xref="S3.SS3.p2.5.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS3.p2.5.m2.3.3.3.3" xref="S3.SS3.p2.5.m2.3.3.3.3.cmml">h</mi></mrow></msub><mo id="S3.SS3.p2.5.m2.3.4.1" xref="S3.SS3.p2.5.m2.3.4.1.cmml">∈</mo><msup id="S3.SS3.p2.5.m2.3.4.3" xref="S3.SS3.p2.5.m2.3.4.3.cmml"><mi id="S3.SS3.p2.5.m2.3.4.3.2" xref="S3.SS3.p2.5.m2.3.4.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.5.m2.3.4.3.3" xref="S3.SS3.p2.5.m2.3.4.3.3.cmml"><msub id="S3.SS3.p2.5.m2.3.4.3.3.2" xref="S3.SS3.p2.5.m2.3.4.3.3.2.cmml"><mi id="S3.SS3.p2.5.m2.3.4.3.3.2.2" xref="S3.SS3.p2.5.m2.3.4.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.5.m2.3.4.3.3.2.3" xref="S3.SS3.p2.5.m2.3.4.3.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.p2.5.m2.3.4.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.5.m2.3.4.3.3.1.cmml">×</mo><mn id="S3.SS3.p2.5.m2.3.4.3.3.3" xref="S3.SS3.p2.5.m2.3.4.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.3b"><apply id="S3.SS3.p2.5.m2.3.4.cmml" xref="S3.SS3.p2.5.m2.3.4"><in id="S3.SS3.p2.5.m2.3.4.1.cmml" xref="S3.SS3.p2.5.m2.3.4.1"></in><apply id="S3.SS3.p2.5.m2.3.4.2.cmml" xref="S3.SS3.p2.5.m2.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.3.4.2.1.cmml" xref="S3.SS3.p2.5.m2.3.4.2">subscript</csymbol><ci id="S3.SS3.p2.5.m2.3.4.2.2.cmml" xref="S3.SS3.p2.5.m2.3.4.2.2">𝐛</ci><list id="S3.SS3.p2.5.m2.3.3.3.4.cmml" xref="S3.SS3.p2.5.m2.3.3.3.5"><ci id="S3.SS3.p2.5.m2.1.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1.1.1">𝑧</ci><ci id="S3.SS3.p2.5.m2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m2.2.2.2.2">𝑟</ci><ci id="S3.SS3.p2.5.m2.3.3.3.3.cmml" xref="S3.SS3.p2.5.m2.3.3.3.3">ℎ</ci></list></apply><apply id="S3.SS3.p2.5.m2.3.4.3.cmml" xref="S3.SS3.p2.5.m2.3.4.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.3.4.3.1.cmml" xref="S3.SS3.p2.5.m2.3.4.3">superscript</csymbol><ci id="S3.SS3.p2.5.m2.3.4.3.2.cmml" xref="S3.SS3.p2.5.m2.3.4.3.2">ℝ</ci><apply id="S3.SS3.p2.5.m2.3.4.3.3.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3"><times id="S3.SS3.p2.5.m2.3.4.3.3.1.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3.1"></times><apply id="S3.SS3.p2.5.m2.3.4.3.3.2.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.3.4.3.3.2.1.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.5.m2.3.4.3.3.2.2.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3.2.2">𝑑</ci><ci id="S3.SS3.p2.5.m2.3.4.3.3.2.3.cmml" xref="S3.SS3.p2.5.m2.3.4.3.3.2.3">out</ci></apply><cn id="S3.SS3.p2.5.m2.3.4.3.3.3.cmml" type="integer" xref="S3.SS3.p2.5.m2.3.4.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.3c">\mathbf{b}_{z,r,h}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m2.3d">bold_b start_POSTSUBSCRIPT italic_z , italic_r , italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable weights and bias. The embedding input is the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m3.1"><semantics id="S3.SS3.p2.6.m3.1a"><mi id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><ci id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m3.1d">italic_l</annotation></semantics></math>-th item’s embedding, <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.10.1">i.e.</span>, <math alttext="\mathbf{x}_{l}=\mathbf{e}_{i_{l}}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m4.1"><semantics id="S3.SS3.p2.7.m4.1a"><mrow id="S3.SS3.p2.7.m4.1.1" xref="S3.SS3.p2.7.m4.1.1.cmml"><msub id="S3.SS3.p2.7.m4.1.1.2" xref="S3.SS3.p2.7.m4.1.1.2.cmml"><mi id="S3.SS3.p2.7.m4.1.1.2.2" xref="S3.SS3.p2.7.m4.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS3.p2.7.m4.1.1.2.3" xref="S3.SS3.p2.7.m4.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS3.p2.7.m4.1.1.1" xref="S3.SS3.p2.7.m4.1.1.1.cmml">=</mo><msub id="S3.SS3.p2.7.m4.1.1.3" xref="S3.SS3.p2.7.m4.1.1.3.cmml"><mi id="S3.SS3.p2.7.m4.1.1.3.2" xref="S3.SS3.p2.7.m4.1.1.3.2.cmml">𝐞</mi><msub id="S3.SS3.p2.7.m4.1.1.3.3" xref="S3.SS3.p2.7.m4.1.1.3.3.cmml"><mi id="S3.SS3.p2.7.m4.1.1.3.3.2" xref="S3.SS3.p2.7.m4.1.1.3.3.2.cmml">i</mi><mi id="S3.SS3.p2.7.m4.1.1.3.3.3" xref="S3.SS3.p2.7.m4.1.1.3.3.3.cmml">l</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m4.1b"><apply id="S3.SS3.p2.7.m4.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1"><eq id="S3.SS3.p2.7.m4.1.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1.1"></eq><apply id="S3.SS3.p2.7.m4.1.1.2.cmml" xref="S3.SS3.p2.7.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m4.1.1.2.1.cmml" xref="S3.SS3.p2.7.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.7.m4.1.1.2.2.cmml" xref="S3.SS3.p2.7.m4.1.1.2.2">𝐱</ci><ci id="S3.SS3.p2.7.m4.1.1.2.3.cmml" xref="S3.SS3.p2.7.m4.1.1.2.3">𝑙</ci></apply><apply id="S3.SS3.p2.7.m4.1.1.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m4.1.1.3.1.cmml" xref="S3.SS3.p2.7.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.7.m4.1.1.3.2.cmml" xref="S3.SS3.p2.7.m4.1.1.3.2">𝐞</ci><apply id="S3.SS3.p2.7.m4.1.1.3.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m4.1.1.3.3.1.cmml" xref="S3.SS3.p2.7.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p2.7.m4.1.1.3.3.2.cmml" xref="S3.SS3.p2.7.m4.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p2.7.m4.1.1.3.3.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m4.1c">\mathbf{x}_{l}=\mathbf{e}_{i_{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m4.1d">bold_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = bold_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. We set the initial state <math alttext="\mathbf{h}_{0}=\mathbf{h}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m5.1"><semantics id="S3.SS3.p2.8.m5.1a"><mrow id="S3.SS3.p2.8.m5.1.1" xref="S3.SS3.p2.8.m5.1.1.cmml"><msub id="S3.SS3.p2.8.m5.1.1.2" xref="S3.SS3.p2.8.m5.1.1.2.cmml"><mi id="S3.SS3.p2.8.m5.1.1.2.2" xref="S3.SS3.p2.8.m5.1.1.2.2.cmml">𝐡</mi><mn id="S3.SS3.p2.8.m5.1.1.2.3" xref="S3.SS3.p2.8.m5.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS3.p2.8.m5.1.1.1" xref="S3.SS3.p2.8.m5.1.1.1.cmml">=</mo><mi id="S3.SS3.p2.8.m5.1.1.3" xref="S3.SS3.p2.8.m5.1.1.3.cmml">𝐡</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m5.1b"><apply id="S3.SS3.p2.8.m5.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1"><eq id="S3.SS3.p2.8.m5.1.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1.1"></eq><apply id="S3.SS3.p2.8.m5.1.1.2.cmml" xref="S3.SS3.p2.8.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m5.1.1.2.1.cmml" xref="S3.SS3.p2.8.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.8.m5.1.1.2.2.cmml" xref="S3.SS3.p2.8.m5.1.1.2.2">𝐡</ci><cn id="S3.SS3.p2.8.m5.1.1.2.3.cmml" type="integer" xref="S3.SS3.p2.8.m5.1.1.2.3">0</cn></apply><ci id="S3.SS3.p2.8.m5.1.1.3.cmml" xref="S3.SS3.p2.8.m5.1.1.3">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m5.1c">\mathbf{h}_{0}=\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m5.1d">bold_h start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_h</annotation></semantics></math>, which is the long-term interest embedding with fatigue-enhanced fusion. In this formula, temporal user fatigue affects how short-term interests evolve. Generally speaking, the interests before the current time step should not be propagated to the next step if the corresponding fatigue is intense. We apply FRU on the sub-sequence <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m6.1"><semantics id="S3.SS3.p2.9.m6.1a"><msub id="S3.SS3.p2.9.m6.1.1" xref="S3.SS3.p2.9.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p2.9.m6.1.1.2" xref="S3.SS3.p2.9.m6.1.1.2.cmml"><mi id="S3.SS3.p2.9.m6.1.1.2.2" xref="S3.SS3.p2.9.m6.1.1.2.2.cmml">S</mi><mo id="S3.SS3.p2.9.m6.1.1.2.1" xref="S3.SS3.p2.9.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.9.m6.1.1.3" xref="S3.SS3.p2.9.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m6.1b"><apply id="S3.SS3.p2.9.m6.1.1.cmml" xref="S3.SS3.p2.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m6.1.1.1.cmml" xref="S3.SS3.p2.9.m6.1.1">subscript</csymbol><apply id="S3.SS3.p2.9.m6.1.1.2.cmml" xref="S3.SS3.p2.9.m6.1.1.2"><ci id="S3.SS3.p2.9.m6.1.1.2.1.cmml" xref="S3.SS3.p2.9.m6.1.1.2.1">^</ci><ci id="S3.SS3.p2.9.m6.1.1.2.2.cmml" xref="S3.SS3.p2.9.m6.1.1.2.2">𝑆</ci></apply><ci id="S3.SS3.p2.9.m6.1.1.3.cmml" xref="S3.SS3.p2.9.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m6.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m6.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, and the final output <math alttext="\mathbf{h}_{T_{u}}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m7.1"><semantics id="S3.SS3.p2.10.m7.1a"><mrow id="S3.SS3.p2.10.m7.1.1" xref="S3.SS3.p2.10.m7.1.1.cmml"><msub id="S3.SS3.p2.10.m7.1.1.2" xref="S3.SS3.p2.10.m7.1.1.2.cmml"><mi id="S3.SS3.p2.10.m7.1.1.2.2" xref="S3.SS3.p2.10.m7.1.1.2.2.cmml">𝐡</mi><msub id="S3.SS3.p2.10.m7.1.1.2.3" xref="S3.SS3.p2.10.m7.1.1.2.3.cmml"><mi id="S3.SS3.p2.10.m7.1.1.2.3.2" xref="S3.SS3.p2.10.m7.1.1.2.3.2.cmml">T</mi><mi id="S3.SS3.p2.10.m7.1.1.2.3.3" xref="S3.SS3.p2.10.m7.1.1.2.3.3.cmml">u</mi></msub></msub><mo id="S3.SS3.p2.10.m7.1.1.1" xref="S3.SS3.p2.10.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.10.m7.1.1.3" xref="S3.SS3.p2.10.m7.1.1.3.cmml"><mi id="S3.SS3.p2.10.m7.1.1.3.2" xref="S3.SS3.p2.10.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.10.m7.1.1.3.3" xref="S3.SS3.p2.10.m7.1.1.3.3.cmml"><msub id="S3.SS3.p2.10.m7.1.1.3.3.2" xref="S3.SS3.p2.10.m7.1.1.3.3.2.cmml"><mi id="S3.SS3.p2.10.m7.1.1.3.3.2.2" xref="S3.SS3.p2.10.m7.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p2.10.m7.1.1.3.3.2.3" xref="S3.SS3.p2.10.m7.1.1.3.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.p2.10.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.10.m7.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p2.10.m7.1.1.3.3.3" xref="S3.SS3.p2.10.m7.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m7.1b"><apply id="S3.SS3.p2.10.m7.1.1.cmml" xref="S3.SS3.p2.10.m7.1.1"><in id="S3.SS3.p2.10.m7.1.1.1.cmml" xref="S3.SS3.p2.10.m7.1.1.1"></in><apply id="S3.SS3.p2.10.m7.1.1.2.cmml" xref="S3.SS3.p2.10.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m7.1.1.2.1.cmml" xref="S3.SS3.p2.10.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.10.m7.1.1.2.2.cmml" xref="S3.SS3.p2.10.m7.1.1.2.2">𝐡</ci><apply id="S3.SS3.p2.10.m7.1.1.2.3.cmml" xref="S3.SS3.p2.10.m7.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m7.1.1.2.3.1.cmml" xref="S3.SS3.p2.10.m7.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p2.10.m7.1.1.2.3.2.cmml" xref="S3.SS3.p2.10.m7.1.1.2.3.2">𝑇</ci><ci id="S3.SS3.p2.10.m7.1.1.2.3.3.cmml" xref="S3.SS3.p2.10.m7.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S3.SS3.p2.10.m7.1.1.3.cmml" xref="S3.SS3.p2.10.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m7.1.1.3.1.cmml" xref="S3.SS3.p2.10.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.10.m7.1.1.3.2.cmml" xref="S3.SS3.p2.10.m7.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.10.m7.1.1.3.3.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3"><times id="S3.SS3.p2.10.m7.1.1.3.3.1.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3.1"></times><apply id="S3.SS3.p2.10.m7.1.1.3.3.2.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m7.1.1.3.3.2.1.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.10.m7.1.1.3.3.2.2.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p2.10.m7.1.1.3.3.2.3.cmml" xref="S3.SS3.p2.10.m7.1.1.3.3.2.3">out</ci></apply><cn id="S3.SS3.p2.10.m7.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.10.m7.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m7.1c">\mathbf{h}_{T_{u}}\in\mathbb{R}^{d_{\mathrm{out}}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m7.1d">bold_h start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> encodes user’s short-term interests with fatigue influence.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Fatigue-supervised Contrastive Learning</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.5">Although we have encoded temporal fatigue in latent space, whether these representations guarantee the modeling of real fatigue is unknown. The challenge is that there are no explicit signals for the supervision of representation learning. Inspired by the advantages of self-supervised learning <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib42" title="">2022</a>)</cite> and multi-task learning <cite class="ltx_cite ltx_citemacro_citep">(Quan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib33" title="">2023a</a>)</cite> in recommendations, we propose a novel sequence augmentation for fatigue-supervised contrastive learning. Specifically, <math alttext="N\in[\mathrm{max}(N_{r},1),T_{u}]" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.3"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3" xref="S3.SS4.p1.1.m1.3.3.cmml"><mi id="S3.SS4.p1.1.m1.3.3.4" xref="S3.SS4.p1.1.m1.3.3.4.cmml">N</mi><mo id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.cmml">∈</mo><mrow id="S3.SS4.p1.1.m1.3.3.2.2" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS4.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">[</mo><mrow id="S3.SS4.p1.1.m1.2.2.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.2.2.1.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml">max</mi><mo id="S3.SS4.p1.1.m1.2.2.1.1.1.2" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml">N</mi><mi id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mn id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.1.m1.3.3.2.2.4" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS4.p1.1.m1.3.3.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml">T</mi><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml">u</mi></msub><mo id="S3.SS4.p1.1.m1.3.3.2.2.5" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><apply id="S3.SS4.p1.1.m1.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3"><in id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3"></in><ci id="S3.SS4.p1.1.m1.3.3.4.cmml" xref="S3.SS4.p1.1.m1.3.3.4">𝑁</ci><interval closure="closed" id="S3.SS4.p1.1.m1.3.3.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2"><apply id="S3.SS4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1"><times id="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2"></times><ci id="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3">max</ci><interval closure="open" id="S3.SS4.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1"><apply id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.2">𝑁</ci><ci id="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.1.1.1.3">𝑟</ci></apply><cn id="S3.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1">1</cn></interval></apply><apply id="S3.SS4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2">𝑇</ci><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3">𝑢</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">N\in[\mathrm{max}(N_{r},1),T_{u}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.3d">italic_N ∈ [ roman_max ( italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , 1 ) , italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ]</annotation></semantics></math> items in the sub-sequence <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.2" xref="S3.SS4.p1.2.m2.1.1.2.2.cmml">S</mi><mo id="S3.SS4.p1.2.m2.1.1.2.1" xref="S3.SS4.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2"><ci id="S3.SS4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2.2">𝑆</ci></apply><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> are replaced by the target item, where <math alttext="N_{r}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑁</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> is the number of repetitions of the target item in <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2.cmml">S</mi><mo id="S3.SS4.p1.4.m4.1.1.2.1" xref="S3.SS4.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2"><ci id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1.2.1">^</ci><ci id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">𝑆</ci></apply><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.F4" title="Figure 4 ‣ 3.4. Fatigue-supervised Contrastive Learning ‣ 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, the primary idea is that users will experience more fatigue if they have much more repetitive consumption. We set a margin <math alttext="N_{r}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msub id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">N</mi><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝑁</ci><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> when choosing how many items to replace, which is large enough from the experimental results.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S3.F4.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.4.2.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.2.1" style="font-size:90%;">Illustration of the sequence augmentation to obtain fatigue signals. There is more fatigue if some items in the sub-sequence <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.F4.2.1.m1.1"><semantics id="S3.F4.2.1.m1.1b"><msub id="S3.F4.2.1.m1.1.1" xref="S3.F4.2.1.m1.1.1.cmml"><mover accent="true" id="S3.F4.2.1.m1.1.1.2" xref="S3.F4.2.1.m1.1.1.2.cmml"><mi id="S3.F4.2.1.m1.1.1.2.2" xref="S3.F4.2.1.m1.1.1.2.2.cmml">S</mi><mo id="S3.F4.2.1.m1.1.1.2.1" xref="S3.F4.2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.F4.2.1.m1.1.1.3" xref="S3.F4.2.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.2.1.m1.1c"><apply id="S3.F4.2.1.m1.1.1.cmml" xref="S3.F4.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.2.1.m1.1.1.1.cmml" xref="S3.F4.2.1.m1.1.1">subscript</csymbol><apply id="S3.F4.2.1.m1.1.1.2.cmml" xref="S3.F4.2.1.m1.1.1.2"><ci id="S3.F4.2.1.m1.1.1.2.1.cmml" xref="S3.F4.2.1.m1.1.1.2.1">^</ci><ci id="S3.F4.2.1.m1.1.1.2.2.cmml" xref="S3.F4.2.1.m1.1.1.2.2">𝑆</ci></apply><ci id="S3.F4.2.1.m1.1.1.3.cmml" xref="S3.F4.2.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.1.m1.1d">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.2.1.m1.1e">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> are replaced by the target item.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2">With the augmented sequence, we can also obtain similarity features <math alttext="\mathbf{Q}_{0}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msubsup id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.2" xref="S3.SS4.p2.1.m1.1.1.2.2.cmml">𝐐</mi><mn id="S3.SS4.p2.1.m1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.2.3.cmml">0</mn><mo id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2">𝐐</ci><cn id="S3.SS4.p2.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.1.1.2.3">0</cn></apply><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathbf{Q}_{0}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">bold_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> (and the processed <math alttext="\mathbf{Q}^{\prime}_{C}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msubsup id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2.2" xref="S3.SS4.p2.2.m2.1.1.2.2.cmml">𝐐</mi><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">C</mi><mo id="S3.SS4.p2.2.m2.1.1.2.3" xref="S3.SS4.p2.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2.2">𝐐</ci><ci id="S3.SS4.p2.2.m2.1.1.2.3.cmml" xref="S3.SS4.p2.2.m2.1.1.2.3">′</ci></apply><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathbf{Q}^{\prime}_{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">bold_Q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT</annotation></semantics></math> by cross networks) motivating the modeling of temporal fatigue after the same modeling introduced in previous subsections. All the learnable parameters are shared when modeling original and augmented sequences. Finally, user fatigue for the interaction of the target item can be predicted as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f=\mathrm{MEAN}\left(\mathbf{MLP}_{3}\left([\mathbf{Q}_{C},%
\mathbf{Q}_{0}]\right)\right)," class="ltx_Math" display="inline" id="S3.E9X.2.1.1.m1.1"><semantics id="S3.E9X.2.1.1.m1.1a"><mrow id="S3.E9X.2.1.1.m1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E9X.2.1.1.m1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.3.cmml">f</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.3.cmml">MEAN</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">[</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">C</mi></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐐</mi><mn id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9X.2.1.1.m1.1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.1b"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1"><eq id="S3.E9X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.2"></eq><ci id="S3.E9X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.3">𝑓</ci><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1"><times id="S3.E9X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.3">MEAN</ci><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">3</cn></apply><interval closure="closed" id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐶</ci></apply><apply id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐐</ci><cn id="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E9X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.1c">\displaystyle f=\mathrm{MEAN}\left(\mathbf{MLP}_{3}\left([\mathbf{Q}_{C},%
\mathbf{Q}_{0}]\right)\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.2.1.1.m1.1d">italic_f = roman_MEAN ( bold_MLP start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( [ bold_Q start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT , bold_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ] ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f^{\prime}=\mathrm{MEAN}\left(\mathbf{MLP}_{3}\left([\mathbf{Q}^%
{\prime}_{C},\mathbf{Q}^{\prime}_{0}]\right)\right)." class="ltx_Math" display="inline" id="S3.E9Xa.2.1.1.m1.1"><semantics id="S3.E9Xa.2.1.1.m1.1a"><mrow id="S3.E9Xa.2.1.1.m1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml"><msup id="S3.E9Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3.2.cmml">f</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.3.cmml">MEAN</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">[</mo><msubsup id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐐</mi><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">C</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐐</mi><mn id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">0</mn><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xa.2.1.1.m1.1b"><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1"><eq id="S3.E9Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.3.3">′</ci></apply><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.3">MEAN</ci><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">3</cn></apply><interval closure="closed" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐐</ci><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐶</ci></apply><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐐</ci><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">′</ci></apply><cn id="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xa.2.1.1.m1.1c">\displaystyle f^{\prime}=\mathrm{MEAN}\left(\mathbf{MLP}_{3}\left([\mathbf{Q}^%
{\prime}_{C},\mathbf{Q}^{\prime}_{0}]\right)\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E9Xa.2.1.1.m1.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_MEAN ( bold_MLP start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( [ bold_Q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT , bold_Q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ] ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.4">All the items in <math alttext="\hat{S}_{u}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m1.1"><semantics id="S3.SS4.p2.3.m1.1a"><msub id="S3.SS4.p2.3.m1.1.1" xref="S3.SS4.p2.3.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p2.3.m1.1.1.2" xref="S3.SS4.p2.3.m1.1.1.2.cmml"><mi id="S3.SS4.p2.3.m1.1.1.2.2" xref="S3.SS4.p2.3.m1.1.1.2.2.cmml">S</mi><mo id="S3.SS4.p2.3.m1.1.1.2.1" xref="S3.SS4.p2.3.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.3.m1.1.1.3" xref="S3.SS4.p2.3.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m1.1b"><apply id="S3.SS4.p2.3.m1.1.1.cmml" xref="S3.SS4.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m1.1.1.1.cmml" xref="S3.SS4.p2.3.m1.1.1">subscript</csymbol><apply id="S3.SS4.p2.3.m1.1.1.2.cmml" xref="S3.SS4.p2.3.m1.1.1.2"><ci id="S3.SS4.p2.3.m1.1.1.2.1.cmml" xref="S3.SS4.p2.3.m1.1.1.2.1">^</ci><ci id="S3.SS4.p2.3.m1.1.1.2.2.cmml" xref="S3.SS4.p2.3.m1.1.1.2.2">𝑆</ci></apply><ci id="S3.SS4.p2.3.m1.1.1.3.cmml" xref="S3.SS4.p2.3.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m1.1c">\hat{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m1.1d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> are considered for modeling the fatigue with <math alttext="\mathrm{MEAN}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m2.1"><semantics id="S3.SS4.p2.4.m2.1a"><mi id="S3.SS4.p2.4.m2.1.1" xref="S3.SS4.p2.4.m2.1.1.cmml">MEAN</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m2.1b"><ci id="S3.SS4.p2.4.m2.1.1.cmml" xref="S3.SS4.p2.4.m2.1.1">MEAN</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m2.1c">\mathrm{MEAN}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m2.1d">roman_MEAN</annotation></semantics></math>.
We then formulate the contrastive loss with fatigue as the supervision as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{con}}=\sum-\log\frac{\exp(-f)}{\exp(-f)+\sum_{j=1}^{4}%
\exp(-f^{\prime}_{j})}," class="ltx_Math" display="block" id="S3.E10.m1.7"><semantics id="S3.E10.m1.7a"><mrow id="S3.E10.m1.7.7.1" xref="S3.E10.m1.7.7.1.1.cmml"><mrow id="S3.E10.m1.7.7.1.1" xref="S3.E10.m1.7.7.1.1.cmml"><msub id="S3.E10.m1.7.7.1.1.2" xref="S3.E10.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.7.7.1.1.2.2" xref="S3.E10.m1.7.7.1.1.2.2.cmml">ℒ</mi><mi id="S3.E10.m1.7.7.1.1.2.3" xref="S3.E10.m1.7.7.1.1.2.3.cmml">con</mi></msub><mo id="S3.E10.m1.7.7.1.1.1" rspace="0.111em" xref="S3.E10.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.7.7.1.1.3" xref="S3.E10.m1.7.7.1.1.3.cmml"><mo id="S3.E10.m1.7.7.1.1.3.2" movablelimits="false" rspace="0em" xref="S3.E10.m1.7.7.1.1.3.2.cmml">∑</mo><mo id="S3.E10.m1.7.7.1.1.3.1" lspace="0em" xref="S3.E10.m1.7.7.1.1.3.1.cmml">−</mo><mrow id="S3.E10.m1.7.7.1.1.3.3" xref="S3.E10.m1.7.7.1.1.3.3.cmml"><mi id="S3.E10.m1.7.7.1.1.3.3.1" xref="S3.E10.m1.7.7.1.1.3.3.1.cmml">log</mi><mo id="S3.E10.m1.7.7.1.1.3.3a" lspace="0.167em" xref="S3.E10.m1.7.7.1.1.3.3.cmml">⁡</mo><mfrac id="S3.E10.m1.6.6" xref="S3.E10.m1.6.6.cmml"><mrow id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E10.m1.2.2.2.2a" xref="S3.E10.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E10.m1.2.2.2.2.1" xref="S3.E10.m1.2.2.2.3.cmml"><mo id="S3.E10.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E10.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E10.m1.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml"><mo id="S3.E10.m1.2.2.2.2.1.1a" xref="S3.E10.m1.2.2.2.2.1.1.cmml">−</mo><mi id="S3.E10.m1.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.2.cmml">f</mi></mrow><mo id="S3.E10.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E10.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.6.6.6" xref="S3.E10.m1.6.6.6.cmml"><mrow id="S3.E10.m1.5.5.5.3.1" xref="S3.E10.m1.5.5.5.3.2.cmml"><mi id="S3.E10.m1.3.3.3.1" xref="S3.E10.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E10.m1.5.5.5.3.1a" xref="S3.E10.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E10.m1.5.5.5.3.1.1" xref="S3.E10.m1.5.5.5.3.2.cmml"><mo id="S3.E10.m1.5.5.5.3.1.1.2" stretchy="false" xref="S3.E10.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E10.m1.5.5.5.3.1.1.1" xref="S3.E10.m1.5.5.5.3.1.1.1.cmml"><mo id="S3.E10.m1.5.5.5.3.1.1.1a" xref="S3.E10.m1.5.5.5.3.1.1.1.cmml">−</mo><mi id="S3.E10.m1.5.5.5.3.1.1.1.2" xref="S3.E10.m1.5.5.5.3.1.1.1.2.cmml">f</mi></mrow><mo id="S3.E10.m1.5.5.5.3.1.1.3" stretchy="false" xref="S3.E10.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.6.6.6.5" rspace="0.055em" xref="S3.E10.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E10.m1.6.6.6.4" xref="S3.E10.m1.6.6.6.4.cmml"><msubsup id="S3.E10.m1.6.6.6.4.2" xref="S3.E10.m1.6.6.6.4.2.cmml"><mo id="S3.E10.m1.6.6.6.4.2.2.2" xref="S3.E10.m1.6.6.6.4.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.6.6.6.4.2.2.3" xref="S3.E10.m1.6.6.6.4.2.2.3.cmml"><mi id="S3.E10.m1.6.6.6.4.2.2.3.2" xref="S3.E10.m1.6.6.6.4.2.2.3.2.cmml">j</mi><mo id="S3.E10.m1.6.6.6.4.2.2.3.1" xref="S3.E10.m1.6.6.6.4.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.6.6.6.4.2.2.3.3" xref="S3.E10.m1.6.6.6.4.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E10.m1.6.6.6.4.2.3" xref="S3.E10.m1.6.6.6.4.2.3.cmml">4</mn></msubsup><mrow id="S3.E10.m1.6.6.6.4.1.1" xref="S3.E10.m1.6.6.6.4.1.2.cmml"><mi id="S3.E10.m1.4.4.4.2" xref="S3.E10.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E10.m1.6.6.6.4.1.1a" xref="S3.E10.m1.6.6.6.4.1.2.cmml">⁡</mo><mrow id="S3.E10.m1.6.6.6.4.1.1.1" xref="S3.E10.m1.6.6.6.4.1.2.cmml"><mo id="S3.E10.m1.6.6.6.4.1.1.1.2" stretchy="false" xref="S3.E10.m1.6.6.6.4.1.2.cmml">(</mo><mrow id="S3.E10.m1.6.6.6.4.1.1.1.1" xref="S3.E10.m1.6.6.6.4.1.1.1.1.cmml"><mo id="S3.E10.m1.6.6.6.4.1.1.1.1a" xref="S3.E10.m1.6.6.6.4.1.1.1.1.cmml">−</mo><msubsup id="S3.E10.m1.6.6.6.4.1.1.1.1.2" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.cmml"><mi id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.2" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.2.cmml">f</mi><mi id="S3.E10.m1.6.6.6.4.1.1.1.1.2.3" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.3.cmml">j</mi><mo id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.3" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E10.m1.6.6.6.4.1.1.1.3" stretchy="false" xref="S3.E10.m1.6.6.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E10.m1.7.7.1.2" xref="S3.E10.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.7b"><apply id="S3.E10.m1.7.7.1.1.cmml" xref="S3.E10.m1.7.7.1"><eq id="S3.E10.m1.7.7.1.1.1.cmml" xref="S3.E10.m1.7.7.1.1.1"></eq><apply id="S3.E10.m1.7.7.1.1.2.cmml" xref="S3.E10.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.1.1.2.1.cmml" xref="S3.E10.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E10.m1.7.7.1.1.2.2.cmml" xref="S3.E10.m1.7.7.1.1.2.2">ℒ</ci><ci id="S3.E10.m1.7.7.1.1.2.3.cmml" xref="S3.E10.m1.7.7.1.1.2.3">con</ci></apply><apply id="S3.E10.m1.7.7.1.1.3.cmml" xref="S3.E10.m1.7.7.1.1.3"><minus id="S3.E10.m1.7.7.1.1.3.1.cmml" xref="S3.E10.m1.7.7.1.1.3.1"></minus><sum id="S3.E10.m1.7.7.1.1.3.2.cmml" xref="S3.E10.m1.7.7.1.1.3.2"></sum><apply id="S3.E10.m1.7.7.1.1.3.3.cmml" xref="S3.E10.m1.7.7.1.1.3.3"><log id="S3.E10.m1.7.7.1.1.3.3.1.cmml" xref="S3.E10.m1.7.7.1.1.3.3.1"></log><apply id="S3.E10.m1.6.6.cmml" xref="S3.E10.m1.6.6"><divide id="S3.E10.m1.6.6.7.cmml" xref="S3.E10.m1.6.6"></divide><apply id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2"><exp id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"></exp><apply id="S3.E10.m1.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1"><minus id="S3.E10.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1"></minus><ci id="S3.E10.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.2">𝑓</ci></apply></apply><apply id="S3.E10.m1.6.6.6.cmml" xref="S3.E10.m1.6.6.6"><plus id="S3.E10.m1.6.6.6.5.cmml" xref="S3.E10.m1.6.6.6.5"></plus><apply id="S3.E10.m1.5.5.5.3.2.cmml" xref="S3.E10.m1.5.5.5.3.1"><exp id="S3.E10.m1.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.1"></exp><apply id="S3.E10.m1.5.5.5.3.1.1.1.cmml" xref="S3.E10.m1.5.5.5.3.1.1.1"><minus id="S3.E10.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E10.m1.5.5.5.3.1.1.1"></minus><ci id="S3.E10.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E10.m1.5.5.5.3.1.1.1.2">𝑓</ci></apply></apply><apply id="S3.E10.m1.6.6.6.4.cmml" xref="S3.E10.m1.6.6.6.4"><apply id="S3.E10.m1.6.6.6.4.2.cmml" xref="S3.E10.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.4.2.1.cmml" xref="S3.E10.m1.6.6.6.4.2">superscript</csymbol><apply id="S3.E10.m1.6.6.6.4.2.2.cmml" xref="S3.E10.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.4.2.2.1.cmml" xref="S3.E10.m1.6.6.6.4.2">subscript</csymbol><sum id="S3.E10.m1.6.6.6.4.2.2.2.cmml" xref="S3.E10.m1.6.6.6.4.2.2.2"></sum><apply id="S3.E10.m1.6.6.6.4.2.2.3.cmml" xref="S3.E10.m1.6.6.6.4.2.2.3"><eq id="S3.E10.m1.6.6.6.4.2.2.3.1.cmml" xref="S3.E10.m1.6.6.6.4.2.2.3.1"></eq><ci id="S3.E10.m1.6.6.6.4.2.2.3.2.cmml" xref="S3.E10.m1.6.6.6.4.2.2.3.2">𝑗</ci><cn id="S3.E10.m1.6.6.6.4.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.6.6.6.4.2.2.3.3">1</cn></apply></apply><cn id="S3.E10.m1.6.6.6.4.2.3.cmml" type="integer" xref="S3.E10.m1.6.6.6.4.2.3">4</cn></apply><apply id="S3.E10.m1.6.6.6.4.1.2.cmml" xref="S3.E10.m1.6.6.6.4.1.1"><exp id="S3.E10.m1.4.4.4.2.cmml" xref="S3.E10.m1.4.4.4.2"></exp><apply id="S3.E10.m1.6.6.6.4.1.1.1.1.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1"><minus id="S3.E10.m1.6.6.6.4.1.1.1.1.1.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1"></minus><apply id="S3.E10.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.4.1.1.1.1.2.1.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2">subscript</csymbol><apply id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.2">𝑓</ci><ci id="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.2.3">′</ci></apply><ci id="S3.E10.m1.6.6.6.4.1.1.1.1.2.3.cmml" xref="S3.E10.m1.6.6.6.4.1.1.1.1.2.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.7c">\mathcal{L}_{\mathrm{con}}=\sum-\log\frac{\exp(-f)}{\exp(-f)+\sum_{j=1}^{4}%
\exp(-f^{\prime}_{j})},</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.7d">caligraphic_L start_POSTSUBSCRIPT roman_con end_POSTSUBSCRIPT = ∑ - roman_log divide start_ARG roman_exp ( - italic_f ) end_ARG start_ARG roman_exp ( - italic_f ) + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT roman_exp ( - italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.7">where <math alttext="f^{\prime}_{j}" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m1.1"><semantics id="S3.SS4.p2.5.m1.1a"><msubsup id="S3.SS4.p2.5.m1.1.1" xref="S3.SS4.p2.5.m1.1.1.cmml"><mi id="S3.SS4.p2.5.m1.1.1.2.2" xref="S3.SS4.p2.5.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS4.p2.5.m1.1.1.3" xref="S3.SS4.p2.5.m1.1.1.3.cmml">j</mi><mo id="S3.SS4.p2.5.m1.1.1.2.3" xref="S3.SS4.p2.5.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m1.1b"><apply id="S3.SS4.p2.5.m1.1.1.cmml" xref="S3.SS4.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m1.1.1.1.cmml" xref="S3.SS4.p2.5.m1.1.1">subscript</csymbol><apply id="S3.SS4.p2.5.m1.1.1.2.cmml" xref="S3.SS4.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m1.1.1.2.1.cmml" xref="S3.SS4.p2.5.m1.1.1">superscript</csymbol><ci id="S3.SS4.p2.5.m1.1.1.2.2.cmml" xref="S3.SS4.p2.5.m1.1.1.2.2">𝑓</ci><ci id="S3.SS4.p2.5.m1.1.1.2.3.cmml" xref="S3.SS4.p2.5.m1.1.1.2.3">′</ci></apply><ci id="S3.SS4.p2.5.m1.1.1.3.cmml" xref="S3.SS4.p2.5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m1.1c">f^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m1.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the fatigue of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m2.1"><semantics id="S3.SS4.p2.6.m2.1a"><mi id="S3.SS4.p2.6.m2.1.1" xref="S3.SS4.p2.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m2.1b"><ci id="S3.SS4.p2.6.m2.1.1.cmml" xref="S3.SS4.p2.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m2.1d">italic_j</annotation></semantics></math>-th augmentation, and we conduct four augmentations for each instance. Note that the fatigue should be larger after the augmentation, thus we use <math alttext="-f" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m3.1"><semantics id="S3.SS4.p2.7.m3.1a"><mrow id="S3.SS4.p2.7.m3.1.1" xref="S3.SS4.p2.7.m3.1.1.cmml"><mo id="S3.SS4.p2.7.m3.1.1a" xref="S3.SS4.p2.7.m3.1.1.cmml">−</mo><mi id="S3.SS4.p2.7.m3.1.1.2" xref="S3.SS4.p2.7.m3.1.1.2.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m3.1b"><apply id="S3.SS4.p2.7.m3.1.1.cmml" xref="S3.SS4.p2.7.m3.1.1"><minus id="S3.SS4.p2.7.m3.1.1.1.cmml" xref="S3.SS4.p2.7.m3.1.1"></minus><ci id="S3.SS4.p2.7.m3.1.1.2.cmml" xref="S3.SS4.p2.7.m3.1.1.2">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m3.1c">-f</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m3.1d">- italic_f</annotation></semantics></math> to calculate the likelihood.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Model Training</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.2">We consider both users’ long-term and short-term interests for interaction predictions, as well as user fatigue when making the decision on the target item. The prediction score for the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">italic_u</annotation></semantics></math> and the target items <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><msub id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">i</mi><mi id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">𝑖</ci><ci id="S3.SS5.p1.2.m2.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y_{u,i_{t}}=\mathbf{MLP}_{4}([\mathbf{h}^{\top},\mathbf{h}_{T_{u}}^{\top},%
\mathbf{e}_{i_{t}}^{\top}])-\mathit{tanh}(f)." class="ltx_Math" display="block" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4.1" xref="S3.E11.m1.4.4.1.1.cmml"><mrow id="S3.E11.m1.4.4.1.1" xref="S3.E11.m1.4.4.1.1.cmml"><msub id="S3.E11.m1.4.4.1.1.3" xref="S3.E11.m1.4.4.1.1.3.cmml"><mi id="S3.E11.m1.4.4.1.1.3.2" xref="S3.E11.m1.4.4.1.1.3.2.cmml">y</mi><mrow id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">u</mi><mo id="S3.E11.m1.2.2.2.2.2" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><msub id="S3.E11.m1.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.1.cmml"><mi id="S3.E11.m1.2.2.2.2.1.2" xref="S3.E11.m1.2.2.2.2.1.2.cmml">i</mi><mi id="S3.E11.m1.2.2.2.2.1.3" xref="S3.E11.m1.2.2.2.2.1.3.cmml">t</mi></msub></mrow></msub><mo id="S3.E11.m1.4.4.1.1.2" xref="S3.E11.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.4.4.1.1.1" xref="S3.E11.m1.4.4.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.cmml"><msub id="S3.E11.m1.4.4.1.1.1.1.3" xref="S3.E11.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.3.2" xref="S3.E11.m1.4.4.1.1.1.1.3.2.cmml">𝐌𝐋𝐏</mi><mn id="S3.E11.m1.4.4.1.1.1.1.3.3" xref="S3.E11.m1.4.4.1.1.1.1.3.3.cmml">4</mn></msub><mo id="S3.E11.m1.4.4.1.1.1.1.2" xref="S3.E11.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.1.1.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.cmml"><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml"><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.4" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml">[</mo><msup id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.5" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><msub id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.2.cmml">T</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.3.cmml">u</mi></msub><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.6" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐞</mi><msub id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.2" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.2.cmml">i</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml">⊤</mo></msubsup><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.7" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml">]</mo></mrow><mo id="S3.E11.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.1.1.1.2" xref="S3.E11.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.E11.m1.4.4.1.1.1.3" xref="S3.E11.m1.4.4.1.1.1.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.3.2" xref="S3.E11.m1.4.4.1.1.1.3.2.cmml">𝑡𝑎𝑛ℎ</mi><mo id="S3.E11.m1.4.4.1.1.1.3.1" xref="S3.E11.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.1.1.1.3.3.2" xref="S3.E11.m1.4.4.1.1.1.3.cmml"><mo id="S3.E11.m1.4.4.1.1.1.3.3.2.1" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.3.cmml">(</mo><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">f</mi><mo id="S3.E11.m1.4.4.1.1.1.3.3.2.2" stretchy="false" xref="S3.E11.m1.4.4.1.1.1.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.4.4.1.2" lspace="0em" xref="S3.E11.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.1.1.cmml" xref="S3.E11.m1.4.4.1"><eq id="S3.E11.m1.4.4.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.2"></eq><apply id="S3.E11.m1.4.4.1.1.3.cmml" xref="S3.E11.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.3.1.cmml" xref="S3.E11.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.3.2.cmml" xref="S3.E11.m1.4.4.1.1.3.2">𝑦</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑢</ci><apply id="S3.E11.m1.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.1.1.cmml" xref="S3.E11.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.1.2.cmml" xref="S3.E11.m1.2.2.2.2.1.2">𝑖</ci><ci id="S3.E11.m1.2.2.2.2.1.3.cmml" xref="S3.E11.m1.2.2.2.2.1.3">𝑡</ci></apply></list></apply><apply id="S3.E11.m1.4.4.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1"><minus id="S3.E11.m1.4.4.1.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1.2"></minus><apply id="S3.E11.m1.4.4.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1"><times id="S3.E11.m1.4.4.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.2"></times><apply id="S3.E11.m1.4.4.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.3.2">𝐌𝐋𝐏</ci><cn id="S3.E11.m1.4.4.1.1.1.1.3.3.cmml" type="integer" xref="S3.E11.m1.4.4.1.1.1.1.3.3">4</cn></apply><list id="S3.E11.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3"><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝐡</ci><csymbol cd="latexml" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.2">𝐡</ci><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.2">𝑇</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.3">𝑢</ci></apply></apply><csymbol cd="latexml" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.2">𝐞</ci><apply id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><csymbol cd="latexml" id="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1.1.3.3.3">top</csymbol></apply></list></apply><apply id="S3.E11.m1.4.4.1.1.1.3.cmml" xref="S3.E11.m1.4.4.1.1.1.3"><times id="S3.E11.m1.4.4.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.3.1"></times><ci id="S3.E11.m1.4.4.1.1.1.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.3.2">𝑡𝑎𝑛ℎ</ci><ci id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">y_{u,i_{t}}=\mathbf{MLP}_{4}([\mathbf{h}^{\top},\mathbf{h}_{T_{u}}^{\top},%
\mathbf{e}_{i_{t}}^{\top}])-\mathit{tanh}(f).</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">italic_y start_POSTSUBSCRIPT italic_u , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = bold_MLP start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ( [ bold_h start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , bold_h start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , bold_e start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ) - italic_tanh ( italic_f ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p1.3">We explicitly decrease the score with predicted user fatigue obtained from the subsection above. The function <math alttext="\mathit{tanh}" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m1.1"><semantics id="S3.SS5.p1.3.m1.1a"><mi id="S3.SS5.p1.3.m1.1.1" xref="S3.SS5.p1.3.m1.1.1.cmml">𝑡𝑎𝑛ℎ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m1.1b"><ci id="S3.SS5.p1.3.m1.1.1.cmml" xref="S3.SS5.p1.3.m1.1.1">𝑡𝑎𝑛ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m1.1c">\mathit{tanh}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m1.1d">italic_tanh</annotation></semantics></math> controls the magnitude of effects.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.4">The recommendation loss for model training is a widely-used softmax loss function <cite class="ltx_cite ltx_citemacro_citep">(Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite>, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{rec}}=\sum\limits_{(u,i_{t},i^{\prime}_{1}\sim i^{\prime}%
_{4})\in\mathcal{O}}-\log\frac{\exp(y_{u,i_{t}})}{\exp(y_{u,i_{t}})+\sum_{j=1}%
^{4}\exp(y_{u,i^{\prime}_{j}})}," class="ltx_Math" display="block" id="S3.E12.m1.15"><semantics id="S3.E12.m1.15a"><mrow id="S3.E12.m1.15.15.1" xref="S3.E12.m1.15.15.1.1.cmml"><mrow id="S3.E12.m1.15.15.1.1" xref="S3.E12.m1.15.15.1.1.cmml"><msub id="S3.E12.m1.15.15.1.1.2" xref="S3.E12.m1.15.15.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.15.15.1.1.2.2" xref="S3.E12.m1.15.15.1.1.2.2.cmml">ℒ</mi><mi id="S3.E12.m1.15.15.1.1.2.3" xref="S3.E12.m1.15.15.1.1.2.3.cmml">rec</mi></msub><mo id="S3.E12.m1.15.15.1.1.1" rspace="0.111em" xref="S3.E12.m1.15.15.1.1.1.cmml">=</mo><mrow id="S3.E12.m1.15.15.1.1.3" xref="S3.E12.m1.15.15.1.1.3.cmml"><munder id="S3.E12.m1.15.15.1.1.3.2" xref="S3.E12.m1.15.15.1.1.3.2.cmml"><mo id="S3.E12.m1.15.15.1.1.3.2.2" movablelimits="false" rspace="0em" xref="S3.E12.m1.15.15.1.1.3.2.2.cmml">∑</mo><mrow id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml"><mrow id="S3.E12.m1.2.2.2.2.1" xref="S3.E12.m1.2.2.2.2.1.1.cmml"><mo id="S3.E12.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E12.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E12.m1.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">u</mi><mo id="S3.E12.m1.2.2.2.2.1.1.2.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E12.m1.2.2.2.2.1.1.1.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.2.cmml">i</mi><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E12.m1.2.2.2.2.1.1.2.2.4" xref="S3.E12.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msubsup id="S3.E12.m1.2.2.2.2.1.1.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2.cmml">i</mi><mn id="S3.E12.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.3.cmml">1</mn><mo id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12.m1.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.3.cmml">∼</mo><msubsup id="S3.E12.m1.2.2.2.2.1.1.4" xref="S3.E12.m1.2.2.2.2.1.1.4.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.4.2.2" xref="S3.E12.m1.2.2.2.2.1.1.4.2.2.cmml">i</mi><mn id="S3.E12.m1.2.2.2.2.1.1.4.3" xref="S3.E12.m1.2.2.2.2.1.1.4.3.cmml">4</mn><mo id="S3.E12.m1.2.2.2.2.1.1.4.2.3" xref="S3.E12.m1.2.2.2.2.1.1.4.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E12.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E12.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E12.m1.2.2.2.3" xref="S3.E12.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.4.cmml">𝒪</mi></mrow></munder><mo id="S3.E12.m1.15.15.1.1.3.1" lspace="0em" xref="S3.E12.m1.15.15.1.1.3.1.cmml">−</mo><mrow id="S3.E12.m1.15.15.1.1.3.3" xref="S3.E12.m1.15.15.1.1.3.3.cmml"><mi id="S3.E12.m1.15.15.1.1.3.3.1" xref="S3.E12.m1.15.15.1.1.3.3.1.cmml">log</mi><mo id="S3.E12.m1.15.15.1.1.3.3a" lspace="0.167em" xref="S3.E12.m1.15.15.1.1.3.3.cmml">⁡</mo><mfrac id="S3.E12.m1.14.14" xref="S3.E12.m1.14.14.cmml"><mrow id="S3.E12.m1.6.6.4.4" xref="S3.E12.m1.6.6.4.5.cmml"><mi id="S3.E12.m1.5.5.3.3" xref="S3.E12.m1.5.5.3.3.cmml">exp</mi><mo id="S3.E12.m1.6.6.4.4a" xref="S3.E12.m1.6.6.4.5.cmml">⁡</mo><mrow id="S3.E12.m1.6.6.4.4.1" xref="S3.E12.m1.6.6.4.5.cmml"><mo id="S3.E12.m1.6.6.4.4.1.2" stretchy="false" xref="S3.E12.m1.6.6.4.5.cmml">(</mo><msub id="S3.E12.m1.6.6.4.4.1.1" xref="S3.E12.m1.6.6.4.4.1.1.cmml"><mi id="S3.E12.m1.6.6.4.4.1.1.2" xref="S3.E12.m1.6.6.4.4.1.1.2.cmml">y</mi><mrow id="S3.E12.m1.4.4.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.cmml">u</mi><mo id="S3.E12.m1.4.4.2.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.3.cmml">,</mo><msub id="S3.E12.m1.4.4.2.2.2.2.1" xref="S3.E12.m1.4.4.2.2.2.2.1.cmml"><mi id="S3.E12.m1.4.4.2.2.2.2.1.2" xref="S3.E12.m1.4.4.2.2.2.2.1.2.cmml">i</mi><mi id="S3.E12.m1.4.4.2.2.2.2.1.3" xref="S3.E12.m1.4.4.2.2.2.2.1.3.cmml">t</mi></msub></mrow></msub><mo id="S3.E12.m1.6.6.4.4.1.3" stretchy="false" xref="S3.E12.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E12.m1.14.14.12" xref="S3.E12.m1.14.14.12.cmml"><mrow id="S3.E12.m1.13.13.11.7.1" xref="S3.E12.m1.13.13.11.7.2.cmml"><mi id="S3.E12.m1.11.11.9.5" xref="S3.E12.m1.11.11.9.5.cmml">exp</mi><mo id="S3.E12.m1.13.13.11.7.1a" xref="S3.E12.m1.13.13.11.7.2.cmml">⁡</mo><mrow id="S3.E12.m1.13.13.11.7.1.1" xref="S3.E12.m1.13.13.11.7.2.cmml"><mo id="S3.E12.m1.13.13.11.7.1.1.2" stretchy="false" xref="S3.E12.m1.13.13.11.7.2.cmml">(</mo><msub id="S3.E12.m1.13.13.11.7.1.1.1" xref="S3.E12.m1.13.13.11.7.1.1.1.cmml"><mi id="S3.E12.m1.13.13.11.7.1.1.1.2" xref="S3.E12.m1.13.13.11.7.1.1.1.2.cmml">y</mi><mrow id="S3.E12.m1.8.8.6.2.2.2" xref="S3.E12.m1.8.8.6.2.2.3.cmml"><mi id="S3.E12.m1.7.7.5.1.1.1" xref="S3.E12.m1.7.7.5.1.1.1.cmml">u</mi><mo id="S3.E12.m1.8.8.6.2.2.2.2" xref="S3.E12.m1.8.8.6.2.2.3.cmml">,</mo><msub id="S3.E12.m1.8.8.6.2.2.2.1" xref="S3.E12.m1.8.8.6.2.2.2.1.cmml"><mi id="S3.E12.m1.8.8.6.2.2.2.1.2" xref="S3.E12.m1.8.8.6.2.2.2.1.2.cmml">i</mi><mi id="S3.E12.m1.8.8.6.2.2.2.1.3" xref="S3.E12.m1.8.8.6.2.2.2.1.3.cmml">t</mi></msub></mrow></msub><mo id="S3.E12.m1.13.13.11.7.1.1.3" stretchy="false" xref="S3.E12.m1.13.13.11.7.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.14.14.12.9" rspace="0.055em" xref="S3.E12.m1.14.14.12.9.cmml">+</mo><mrow id="S3.E12.m1.14.14.12.8" xref="S3.E12.m1.14.14.12.8.cmml"><msubsup id="S3.E12.m1.14.14.12.8.2" xref="S3.E12.m1.14.14.12.8.2.cmml"><mo id="S3.E12.m1.14.14.12.8.2.2.2" xref="S3.E12.m1.14.14.12.8.2.2.2.cmml">∑</mo><mrow id="S3.E12.m1.14.14.12.8.2.2.3" xref="S3.E12.m1.14.14.12.8.2.2.3.cmml"><mi id="S3.E12.m1.14.14.12.8.2.2.3.2" xref="S3.E12.m1.14.14.12.8.2.2.3.2.cmml">j</mi><mo id="S3.E12.m1.14.14.12.8.2.2.3.1" xref="S3.E12.m1.14.14.12.8.2.2.3.1.cmml">=</mo><mn id="S3.E12.m1.14.14.12.8.2.2.3.3" xref="S3.E12.m1.14.14.12.8.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E12.m1.14.14.12.8.2.3" xref="S3.E12.m1.14.14.12.8.2.3.cmml">4</mn></msubsup><mrow id="S3.E12.m1.14.14.12.8.1.1" xref="S3.E12.m1.14.14.12.8.1.2.cmml"><mi id="S3.E12.m1.12.12.10.6" xref="S3.E12.m1.12.12.10.6.cmml">exp</mi><mo id="S3.E12.m1.14.14.12.8.1.1a" xref="S3.E12.m1.14.14.12.8.1.2.cmml">⁡</mo><mrow id="S3.E12.m1.14.14.12.8.1.1.1" xref="S3.E12.m1.14.14.12.8.1.2.cmml"><mo id="S3.E12.m1.14.14.12.8.1.1.1.2" stretchy="false" xref="S3.E12.m1.14.14.12.8.1.2.cmml">(</mo><msub id="S3.E12.m1.14.14.12.8.1.1.1.1" xref="S3.E12.m1.14.14.12.8.1.1.1.1.cmml"><mi id="S3.E12.m1.14.14.12.8.1.1.1.1.2" xref="S3.E12.m1.14.14.12.8.1.1.1.1.2.cmml">y</mi><mrow id="S3.E12.m1.10.10.8.4.2.2" xref="S3.E12.m1.10.10.8.4.2.3.cmml"><mi id="S3.E12.m1.9.9.7.3.1.1" xref="S3.E12.m1.9.9.7.3.1.1.cmml">u</mi><mo id="S3.E12.m1.10.10.8.4.2.2.2" xref="S3.E12.m1.10.10.8.4.2.3.cmml">,</mo><msubsup id="S3.E12.m1.10.10.8.4.2.2.1" xref="S3.E12.m1.10.10.8.4.2.2.1.cmml"><mi id="S3.E12.m1.10.10.8.4.2.2.1.2.2" xref="S3.E12.m1.10.10.8.4.2.2.1.2.2.cmml">i</mi><mi id="S3.E12.m1.10.10.8.4.2.2.1.3" xref="S3.E12.m1.10.10.8.4.2.2.1.3.cmml">j</mi><mo id="S3.E12.m1.10.10.8.4.2.2.1.2.3" xref="S3.E12.m1.10.10.8.4.2.2.1.2.3.cmml">′</mo></msubsup></mrow></msub><mo id="S3.E12.m1.14.14.12.8.1.1.1.3" stretchy="false" xref="S3.E12.m1.14.14.12.8.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E12.m1.15.15.1.2" xref="S3.E12.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.15b"><apply id="S3.E12.m1.15.15.1.1.cmml" xref="S3.E12.m1.15.15.1"><eq id="S3.E12.m1.15.15.1.1.1.cmml" xref="S3.E12.m1.15.15.1.1.1"></eq><apply id="S3.E12.m1.15.15.1.1.2.cmml" xref="S3.E12.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.2.1.cmml" xref="S3.E12.m1.15.15.1.1.2">subscript</csymbol><ci id="S3.E12.m1.15.15.1.1.2.2.cmml" xref="S3.E12.m1.15.15.1.1.2.2">ℒ</ci><ci id="S3.E12.m1.15.15.1.1.2.3.cmml" xref="S3.E12.m1.15.15.1.1.2.3">rec</ci></apply><apply id="S3.E12.m1.15.15.1.1.3.cmml" xref="S3.E12.m1.15.15.1.1.3"><minus id="S3.E12.m1.15.15.1.1.3.1.cmml" xref="S3.E12.m1.15.15.1.1.3.1"></minus><apply id="S3.E12.m1.15.15.1.1.3.2.cmml" xref="S3.E12.m1.15.15.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.1.1.3.2.1.cmml" xref="S3.E12.m1.15.15.1.1.3.2">subscript</csymbol><sum id="S3.E12.m1.15.15.1.1.3.2.2.cmml" xref="S3.E12.m1.15.15.1.1.3.2.2"></sum><apply id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"><in id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.3"></in><apply id="S3.E12.m1.2.2.2.2.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E12.m1.2.2.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.3">similar-to</csymbol><list id="S3.E12.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑢</ci><apply id="S3.E12.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.2">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E12.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><apply id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2">superscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3">′</ci></apply><cn id="S3.E12.m1.2.2.2.2.1.1.2.2.2.3.cmml" type="integer" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.3">1</cn></apply></list><apply id="S3.E12.m1.2.2.2.2.1.1.4.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.4.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4">subscript</csymbol><apply id="S3.E12.m1.2.2.2.2.1.1.4.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.4.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4">superscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.4.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4.2.2">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.1.1.4.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4.2.3">′</ci></apply><cn id="S3.E12.m1.2.2.2.2.1.1.4.3.cmml" type="integer" xref="S3.E12.m1.2.2.2.2.1.1.4.3">4</cn></apply></apply><ci id="S3.E12.m1.2.2.2.4.cmml" xref="S3.E12.m1.2.2.2.4">𝒪</ci></apply></apply><apply id="S3.E12.m1.15.15.1.1.3.3.cmml" xref="S3.E12.m1.15.15.1.1.3.3"><log id="S3.E12.m1.15.15.1.1.3.3.1.cmml" xref="S3.E12.m1.15.15.1.1.3.3.1"></log><apply id="S3.E12.m1.14.14.cmml" xref="S3.E12.m1.14.14"><divide id="S3.E12.m1.14.14.13.cmml" xref="S3.E12.m1.14.14"></divide><apply id="S3.E12.m1.6.6.4.5.cmml" xref="S3.E12.m1.6.6.4.4"><exp id="S3.E12.m1.5.5.3.3.cmml" xref="S3.E12.m1.5.5.3.3"></exp><apply id="S3.E12.m1.6.6.4.4.1.1.cmml" xref="S3.E12.m1.6.6.4.4.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.6.6.4.4.1.1.1.cmml" xref="S3.E12.m1.6.6.4.4.1.1">subscript</csymbol><ci id="S3.E12.m1.6.6.4.4.1.1.2.cmml" xref="S3.E12.m1.6.6.4.4.1.1.2">𝑦</ci><list id="S3.E12.m1.4.4.2.2.2.3.cmml" xref="S3.E12.m1.4.4.2.2.2.2"><ci id="S3.E12.m1.3.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1">𝑢</ci><apply id="S3.E12.m1.4.4.2.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.2.2.1.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1">subscript</csymbol><ci id="S3.E12.m1.4.4.2.2.2.2.1.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1.2">𝑖</ci><ci id="S3.E12.m1.4.4.2.2.2.2.1.3.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1.3">𝑡</ci></apply></list></apply></apply><apply id="S3.E12.m1.14.14.12.cmml" xref="S3.E12.m1.14.14.12"><plus id="S3.E12.m1.14.14.12.9.cmml" xref="S3.E12.m1.14.14.12.9"></plus><apply id="S3.E12.m1.13.13.11.7.2.cmml" xref="S3.E12.m1.13.13.11.7.1"><exp id="S3.E12.m1.11.11.9.5.cmml" xref="S3.E12.m1.11.11.9.5"></exp><apply id="S3.E12.m1.13.13.11.7.1.1.1.cmml" xref="S3.E12.m1.13.13.11.7.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.13.13.11.7.1.1.1.1.cmml" xref="S3.E12.m1.13.13.11.7.1.1.1">subscript</csymbol><ci id="S3.E12.m1.13.13.11.7.1.1.1.2.cmml" xref="S3.E12.m1.13.13.11.7.1.1.1.2">𝑦</ci><list id="S3.E12.m1.8.8.6.2.2.3.cmml" xref="S3.E12.m1.8.8.6.2.2.2"><ci id="S3.E12.m1.7.7.5.1.1.1.cmml" xref="S3.E12.m1.7.7.5.1.1.1">𝑢</ci><apply id="S3.E12.m1.8.8.6.2.2.2.1.cmml" xref="S3.E12.m1.8.8.6.2.2.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.6.2.2.2.1.1.cmml" xref="S3.E12.m1.8.8.6.2.2.2.1">subscript</csymbol><ci id="S3.E12.m1.8.8.6.2.2.2.1.2.cmml" xref="S3.E12.m1.8.8.6.2.2.2.1.2">𝑖</ci><ci id="S3.E12.m1.8.8.6.2.2.2.1.3.cmml" xref="S3.E12.m1.8.8.6.2.2.2.1.3">𝑡</ci></apply></list></apply></apply><apply id="S3.E12.m1.14.14.12.8.cmml" xref="S3.E12.m1.14.14.12.8"><apply id="S3.E12.m1.14.14.12.8.2.cmml" xref="S3.E12.m1.14.14.12.8.2"><csymbol cd="ambiguous" id="S3.E12.m1.14.14.12.8.2.1.cmml" xref="S3.E12.m1.14.14.12.8.2">superscript</csymbol><apply id="S3.E12.m1.14.14.12.8.2.2.cmml" xref="S3.E12.m1.14.14.12.8.2"><csymbol cd="ambiguous" id="S3.E12.m1.14.14.12.8.2.2.1.cmml" xref="S3.E12.m1.14.14.12.8.2">subscript</csymbol><sum id="S3.E12.m1.14.14.12.8.2.2.2.cmml" xref="S3.E12.m1.14.14.12.8.2.2.2"></sum><apply id="S3.E12.m1.14.14.12.8.2.2.3.cmml" xref="S3.E12.m1.14.14.12.8.2.2.3"><eq id="S3.E12.m1.14.14.12.8.2.2.3.1.cmml" xref="S3.E12.m1.14.14.12.8.2.2.3.1"></eq><ci id="S3.E12.m1.14.14.12.8.2.2.3.2.cmml" xref="S3.E12.m1.14.14.12.8.2.2.3.2">𝑗</ci><cn id="S3.E12.m1.14.14.12.8.2.2.3.3.cmml" type="integer" xref="S3.E12.m1.14.14.12.8.2.2.3.3">1</cn></apply></apply><cn id="S3.E12.m1.14.14.12.8.2.3.cmml" type="integer" xref="S3.E12.m1.14.14.12.8.2.3">4</cn></apply><apply id="S3.E12.m1.14.14.12.8.1.2.cmml" xref="S3.E12.m1.14.14.12.8.1.1"><exp id="S3.E12.m1.12.12.10.6.cmml" xref="S3.E12.m1.12.12.10.6"></exp><apply id="S3.E12.m1.14.14.12.8.1.1.1.1.cmml" xref="S3.E12.m1.14.14.12.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.14.14.12.8.1.1.1.1.1.cmml" xref="S3.E12.m1.14.14.12.8.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.14.14.12.8.1.1.1.1.2.cmml" xref="S3.E12.m1.14.14.12.8.1.1.1.1.2">𝑦</ci><list id="S3.E12.m1.10.10.8.4.2.3.cmml" xref="S3.E12.m1.10.10.8.4.2.2"><ci id="S3.E12.m1.9.9.7.3.1.1.cmml" xref="S3.E12.m1.9.9.7.3.1.1">𝑢</ci><apply id="S3.E12.m1.10.10.8.4.2.2.1.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.8.4.2.2.1.1.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1">subscript</csymbol><apply id="S3.E12.m1.10.10.8.4.2.2.1.2.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.8.4.2.2.1.2.1.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1">superscript</csymbol><ci id="S3.E12.m1.10.10.8.4.2.2.1.2.2.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1.2.2">𝑖</ci><ci id="S3.E12.m1.10.10.8.4.2.2.1.2.3.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1.2.3">′</ci></apply><ci id="S3.E12.m1.10.10.8.4.2.2.1.3.cmml" xref="S3.E12.m1.10.10.8.4.2.2.1.3">𝑗</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.15c">\mathcal{L}_{\mathrm{rec}}=\sum\limits_{(u,i_{t},i^{\prime}_{1}\sim i^{\prime}%
_{4})\in\mathcal{O}}-\log\frac{\exp(y_{u,i_{t}})}{\exp(y_{u,i_{t}})+\sum_{j=1}%
^{4}\exp(y_{u,i^{\prime}_{j}})},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.15d">caligraphic_L start_POSTSUBSCRIPT roman_rec end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT ( italic_u , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∼ italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ) ∈ caligraphic_O end_POSTSUBSCRIPT - roman_log divide start_ARG roman_exp ( italic_y start_POSTSUBSCRIPT italic_u , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG roman_exp ( italic_y start_POSTSUBSCRIPT italic_u , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT roman_exp ( italic_y start_POSTSUBSCRIPT italic_u , italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p2.3">where <math alttext="\mathcal{O}" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">\mathcal{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">caligraphic_O</annotation></semantics></math> denotes all the training data, and <math alttext="i^{\prime}_{1}\sim i^{\prime}_{4}" class="ltx_Math" display="inline" id="S3.SS5.p2.2.m2.1"><semantics id="S3.SS5.p2.2.m2.1a"><mrow id="S3.SS5.p2.2.m2.1.1" xref="S3.SS5.p2.2.m2.1.1.cmml"><msubsup id="S3.SS5.p2.2.m2.1.1.2" xref="S3.SS5.p2.2.m2.1.1.2.cmml"><mi id="S3.SS5.p2.2.m2.1.1.2.2.2" xref="S3.SS5.p2.2.m2.1.1.2.2.2.cmml">i</mi><mn id="S3.SS5.p2.2.m2.1.1.2.3" xref="S3.SS5.p2.2.m2.1.1.2.3.cmml">1</mn><mo id="S3.SS5.p2.2.m2.1.1.2.2.3" xref="S3.SS5.p2.2.m2.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS5.p2.2.m2.1.1.1" xref="S3.SS5.p2.2.m2.1.1.1.cmml">∼</mo><msubsup id="S3.SS5.p2.2.m2.1.1.3" xref="S3.SS5.p2.2.m2.1.1.3.cmml"><mi id="S3.SS5.p2.2.m2.1.1.3.2.2" xref="S3.SS5.p2.2.m2.1.1.3.2.2.cmml">i</mi><mn id="S3.SS5.p2.2.m2.1.1.3.3" xref="S3.SS5.p2.2.m2.1.1.3.3.cmml">4</mn><mo id="S3.SS5.p2.2.m2.1.1.3.2.3" xref="S3.SS5.p2.2.m2.1.1.3.2.3.cmml">′</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m2.1b"><apply id="S3.SS5.p2.2.m2.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1"><csymbol cd="latexml" id="S3.SS5.p2.2.m2.1.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1.1">similar-to</csymbol><apply id="S3.SS5.p2.2.m2.1.1.2.cmml" xref="S3.SS5.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m2.1.1.2.1.cmml" xref="S3.SS5.p2.2.m2.1.1.2">subscript</csymbol><apply id="S3.SS5.p2.2.m2.1.1.2.2.cmml" xref="S3.SS5.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m2.1.1.2.2.1.cmml" xref="S3.SS5.p2.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS5.p2.2.m2.1.1.2.2.2.cmml" xref="S3.SS5.p2.2.m2.1.1.2.2.2">𝑖</ci><ci id="S3.SS5.p2.2.m2.1.1.2.2.3.cmml" xref="S3.SS5.p2.2.m2.1.1.2.2.3">′</ci></apply><cn id="S3.SS5.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS5.p2.2.m2.1.1.2.3">1</cn></apply><apply id="S3.SS5.p2.2.m2.1.1.3.cmml" xref="S3.SS5.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m2.1.1.3.1.cmml" xref="S3.SS5.p2.2.m2.1.1.3">subscript</csymbol><apply id="S3.SS5.p2.2.m2.1.1.3.2.cmml" xref="S3.SS5.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m2.1.1.3.2.1.cmml" xref="S3.SS5.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS5.p2.2.m2.1.1.3.2.2.cmml" xref="S3.SS5.p2.2.m2.1.1.3.2.2">𝑖</ci><ci id="S3.SS5.p2.2.m2.1.1.3.2.3.cmml" xref="S3.SS5.p2.2.m2.1.1.3.2.3">′</ci></apply><cn id="S3.SS5.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS5.p2.2.m2.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m2.1c">i^{\prime}_{1}\sim i^{\prime}_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.2.m2.1d">italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∼ italic_i start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> are randomly sampled negative items for each <math alttext="(u,i_{t})" class="ltx_Math" display="inline" id="S3.SS5.p2.3.m3.2"><semantics id="S3.SS5.p2.3.m3.2a"><mrow id="S3.SS5.p2.3.m3.2.2.1" xref="S3.SS5.p2.3.m3.2.2.2.cmml"><mo id="S3.SS5.p2.3.m3.2.2.1.2" stretchy="false" xref="S3.SS5.p2.3.m3.2.2.2.cmml">(</mo><mi id="S3.SS5.p2.3.m3.1.1" xref="S3.SS5.p2.3.m3.1.1.cmml">u</mi><mo id="S3.SS5.p2.3.m3.2.2.1.3" xref="S3.SS5.p2.3.m3.2.2.2.cmml">,</mo><msub id="S3.SS5.p2.3.m3.2.2.1.1" xref="S3.SS5.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS5.p2.3.m3.2.2.1.1.2" xref="S3.SS5.p2.3.m3.2.2.1.1.2.cmml">i</mi><mi id="S3.SS5.p2.3.m3.2.2.1.1.3" xref="S3.SS5.p2.3.m3.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.SS5.p2.3.m3.2.2.1.4" stretchy="false" xref="S3.SS5.p2.3.m3.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m3.2b"><interval closure="open" id="S3.SS5.p2.3.m3.2.2.2.cmml" xref="S3.SS5.p2.3.m3.2.2.1"><ci id="S3.SS5.p2.3.m3.1.1.cmml" xref="S3.SS5.p2.3.m3.1.1">𝑢</ci><apply id="S3.SS5.p2.3.m3.2.2.1.1.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS5.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1.2">𝑖</ci><ci id="S3.SS5.p2.3.m3.2.2.1.1.3.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m3.2c">(u,i_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.3.m3.2d">( italic_u , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> pair.</p>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.2">Final training loss is the combination of recommendation and contrastive loss,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{\mathrm{rec}}+\alpha\mathcal{L}_{\mathrm{con}}," class="ltx_Math" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E13.m1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.3.2.3.cmml">rec</mi></msub><mo id="S3.E13.m1.1.1.1.1.3.1" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.2.cmml">α</mi><mo id="S3.E13.m1.1.1.1.1.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E13.m1.1.1.1.1.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S3.E13.m1.1.1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.cmml">con</mi></msub></mrow></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"></eq><ci id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><plus id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.1"></plus><apply id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3">rec</ci></apply><apply id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S3.E13.m1.1.1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3">con</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{L}=\mathcal{L}_{\mathrm{rec}}+\alpha\mathcal{L}_{\mathrm{con}},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT roman_rec end_POSTSUBSCRIPT + italic_α caligraphic_L start_POSTSUBSCRIPT roman_con end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p3.1">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><mi id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">italic_α</annotation></semantics></math> is a hyper-parameter for controlling the importance of fatigue supervision.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">To evaluate our proposed FRec, we conduct extensive experiments on both public and large-scale industrial datasets. We will answer the following research questions in this section,</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">RQ1</span>: Can FRec outperform state-of-the-art models in terms of recommendation accuracy?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">RQ2</span>: Can each key module benefit the overall performance?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">RQ3</span>: Can FRec result in the reduction of user fatigue?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">RQ4</span>: How do key hyper-parameters influence the performance?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Settings</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span>
The statistics of datasets are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.T2" title="Table 2 ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, where Avg. Length denotes the sequence length averaged over all the users.</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">Kuaishou<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_medium" id="footnote2.5">https://www.kuaishou.com</span></span></span></span></span>. This is one of the largest micro-video platforms in China and this dataset has been used in many related works <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>)</cite>. It contains users’ interactions with micro-videos over one week (October 22 to October 28, 2020), and records various behaviors such as click, like, follow, <span class="ltx_text ltx_font_italic" id="S4.I2.i1.p1.1.2">etc.</span> We extract the click interactions for experiments.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Taobao<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><span class="ltx_text ltx_font_medium" id="footnote3.5">https://tianchi.aliyun.com/dataset/dataDetail?dataId=649</span></span></span></span></span>. This is the largest e-commerce platform in China. This dataset records users’ interactions with various products from November 25 to December 3, 2017, including page view, cart, purchase, <span class="ltx_text ltx_font_italic" id="S4.I2.i2.p1.1.2">etc.</span> We follow existing works <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite> and choose the data of page view for experiments.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Industrial</span>. The interaction data is collected from Kuaishou for 1 hour, involving tens of millions of users. Unlike public Kuaishou dataset, we include various behavioral data for experiments to model user fatigue from uninterrupted behavioral sequences.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">We adopt widely-used 10-core rules <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite> for public datasets to filter out inactive users and unpopular items. We split sequential interactions chronologically into 8:1:1 for training, validating, and testing models <cite class="ltx_cite ltx_citemacro_citep">(Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite>. Since we model user fatigue with respect to both short-term and long-term interests (such as a period of several days), the maximum sequence length is set longer than average length, <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.2.1">i.e.</span>, <math alttext="250" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><cn id="S4.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">250</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">250</annotation></semantics></math> for Kuaishou dataset and <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><cn id="S4.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">100</annotation></semantics></math> for Taobao dataset.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Statistics of three datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.2">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.3">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.4">#Instances</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.5">Avg. Length</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1.1">Kuaishou</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1.2">37,502</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1.3">131,063</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1.4">6,427,764</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.5">171.4</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.3.2.1">Taobao</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.3.2.2">41,101</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.3.2.3">90,524</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.3.2.4">2,256,967</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.5">54.9</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.1">Industrial</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.2">38,467,817</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.3">19,863,454</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.4">804,934,827</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.5">20.9</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Baselines.</span>
We choose the following state-of-the-art (SOTA) recommendation models for comparisons, 1) long-term and (or) short-term interest modeling: <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.2">DIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib46" title="">2018</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.3">DIEN</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib45" title="">2019</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.4">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib17" title="">2015</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.5">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib20" title="">2018</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.6">AdaMCT</span> <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib19" title="">2023</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.7">Caser</span> <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib36" title="">2018</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.8">SLi-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>)</cite>, and <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.9">CLSR</span> <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>, 2) multi-interest modeling: <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.10">SUM</span> <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib27" title="">2021</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.11">ComiRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite> with two versions of extracting multiple interests by dynamic routing (-DR) or self-attention (-SA), and <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.12">MGNM</span> <cite class="ltx_cite ltx_citemacro_citep">(Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib37" title="">2022</a>)</cite>, 3) fatigue modeling<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Although there is another method modeling user fatigue for click-through rate prediction <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib25" title="">2023a</a>)</cite>, we don’t include it because modeling fatigue relies on <span class="ltx_text ltx_font_italic" id="footnote4.1">non-click</span> historical sequences and rich context features. Besides, it obtains supervision signals of user fatigue through interaction data in future three days. These are unusual settings and not applicable to our general problem.</span></span></span>: <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.13">DFN</span> <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Evaluation Metrics.</span>
Similar to existing works sampling one negative item for each positive instance <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>, we sample nine negative items to ensure robust training and evaluation <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib28" title="">2022</a>)</cite>. We adopt widely-used accuracy metrics AUC and GAUC <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib46" title="">2018</a>)</cite> as well as ranking metrics HR@k, NDCG@k, and MRR <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib28" title="">2022</a>; Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib37" title="">2022</a>)</cite> for performance evaluation. We set <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_k</annotation></semantics></math> as 2 and 4, a widely-used setting in existing works <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib7" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.11"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.11.1">Hyper-parameter Settings.</span>
We implement our FRec and all the baselines with Microsoft Recommender<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span> https://github.com/microsoft/recommenders</span></span></span> based on Tensorflow<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span> https://www.tensorflow.org</span></span></span>. We use Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib21" title="">2014</a>)</cite> optimizer for modeling learning, where the initial learning rate is 0.001. L2 regularization weight is searched among {1e-4, 1e-6}. The batch size for training is set as 500. We early stop the training process when GAUC on the validation set decreases for two consecutive epochs. Embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><mi id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><ci id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_d</annotation></semantics></math> is set as 40 for all the models. The <math alttext="\mathbf{MLP}_{4}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">𝐌𝐋𝐏</mi><mn id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝐌𝐋𝐏</ci><cn id="S4.SS1.p5.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p5.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\mathbf{MLP}_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">bold_MLP start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> for final prediction is three-layer with hidden size [100, 64], with <span class="ltx_text ltx_font_italic" id="S4.SS1.p5.11.2">relu</span> as activation function, and batch normalization. We conduct a careful grid search to find optimal hyper-parameters for each model, following the original papers. For our FRec, the kernel size of convolutional layers <math alttext="s=5" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1"><semantics id="S4.SS1.p5.3.m3.1a"><mrow id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">s</mi><mo id="S4.SS1.p5.3.m3.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><eq id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1"></eq><ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">𝑠</ci><cn id="S4.SS1.p5.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p5.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">s=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.1d">italic_s = 5</annotation></semantics></math>, the number of interests <math alttext="K=4" class="ltx_Math" display="inline" id="S4.SS1.p5.4.m4.1"><semantics id="S4.SS1.p5.4.m4.1a"><mrow id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.p5.4.m4.1.1.2" xref="S4.SS1.p5.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS1.p5.4.m4.1.1.1" xref="S4.SS1.p5.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.4.m4.1.1.3" xref="S4.SS1.p5.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><eq id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1.1"></eq><ci id="S4.SS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.p5.4.m4.1.1.2">𝐾</ci><cn id="S4.SS1.p5.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p5.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">K=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.4.m4.1d">italic_K = 4</annotation></semantics></math>, and the number of cross and convolutional layers <math alttext="C=2" class="ltx_Math" display="inline" id="S4.SS1.p5.5.m5.1"><semantics id="S4.SS1.p5.5.m5.1a"><mrow id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.2" xref="S4.SS1.p5.5.m5.1.1.2.cmml">C</mi><mo id="S4.SS1.p5.5.m5.1.1.1" xref="S4.SS1.p5.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><eq id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1.1"></eq><ci id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.2">𝐶</ci><cn id="S4.SS1.p5.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p5.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">C=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.5.m5.1d">italic_C = 2</annotation></semantics></math>. For the convolution, the number of filter kernels (<span class="ltx_text ltx_font_italic" id="S4.SS1.p5.11.3">i.e.</span>, hidden dimension) is [20, 40]. In FRU, <math alttext="d_{in}=d_{out}=40" class="ltx_Math" display="inline" id="S4.SS1.p5.6.m6.1"><semantics id="S4.SS1.p5.6.m6.1a"><mrow id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><msub id="S4.SS1.p5.6.m6.1.1.2" xref="S4.SS1.p5.6.m6.1.1.2.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2.2" xref="S4.SS1.p5.6.m6.1.1.2.2.cmml">d</mi><mrow id="S4.SS1.p5.6.m6.1.1.2.3" xref="S4.SS1.p5.6.m6.1.1.2.3.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2.3.2" xref="S4.SS1.p5.6.m6.1.1.2.3.2.cmml">i</mi><mo id="S4.SS1.p5.6.m6.1.1.2.3.1" xref="S4.SS1.p5.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p5.6.m6.1.1.2.3.3" xref="S4.SS1.p5.6.m6.1.1.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml">=</mo><msub id="S4.SS1.p5.6.m6.1.1.4" xref="S4.SS1.p5.6.m6.1.1.4.cmml"><mi id="S4.SS1.p5.6.m6.1.1.4.2" xref="S4.SS1.p5.6.m6.1.1.4.2.cmml">d</mi><mrow id="S4.SS1.p5.6.m6.1.1.4.3" xref="S4.SS1.p5.6.m6.1.1.4.3.cmml"><mi id="S4.SS1.p5.6.m6.1.1.4.3.2" xref="S4.SS1.p5.6.m6.1.1.4.3.2.cmml">o</mi><mo id="S4.SS1.p5.6.m6.1.1.4.3.1" xref="S4.SS1.p5.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S4.SS1.p5.6.m6.1.1.4.3.3" xref="S4.SS1.p5.6.m6.1.1.4.3.3.cmml">u</mi><mo id="S4.SS1.p5.6.m6.1.1.4.3.1a" xref="S4.SS1.p5.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S4.SS1.p5.6.m6.1.1.4.3.4" xref="S4.SS1.p5.6.m6.1.1.4.3.4.cmml">t</mi></mrow></msub><mo id="S4.SS1.p5.6.m6.1.1.5" xref="S4.SS1.p5.6.m6.1.1.5.cmml">=</mo><mn id="S4.SS1.p5.6.m6.1.1.6" xref="S4.SS1.p5.6.m6.1.1.6.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><and id="S4.SS1.p5.6.m6.1.1a.cmml" xref="S4.SS1.p5.6.m6.1.1"></and><apply id="S4.SS1.p5.6.m6.1.1b.cmml" xref="S4.SS1.p5.6.m6.1.1"><eq id="S4.SS1.p5.6.m6.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3"></eq><apply id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.2.1.cmml" xref="S4.SS1.p5.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p5.6.m6.1.1.2.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2.2">𝑑</ci><apply id="S4.SS1.p5.6.m6.1.1.2.3.cmml" xref="S4.SS1.p5.6.m6.1.1.2.3"><times id="S4.SS1.p5.6.m6.1.1.2.3.1.cmml" xref="S4.SS1.p5.6.m6.1.1.2.3.1"></times><ci id="S4.SS1.p5.6.m6.1.1.2.3.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2.3.2">𝑖</ci><ci id="S4.SS1.p5.6.m6.1.1.2.3.3.cmml" xref="S4.SS1.p5.6.m6.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S4.SS1.p5.6.m6.1.1.4.cmml" xref="S4.SS1.p5.6.m6.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.4.1.cmml" xref="S4.SS1.p5.6.m6.1.1.4">subscript</csymbol><ci id="S4.SS1.p5.6.m6.1.1.4.2.cmml" xref="S4.SS1.p5.6.m6.1.1.4.2">𝑑</ci><apply id="S4.SS1.p5.6.m6.1.1.4.3.cmml" xref="S4.SS1.p5.6.m6.1.1.4.3"><times id="S4.SS1.p5.6.m6.1.1.4.3.1.cmml" xref="S4.SS1.p5.6.m6.1.1.4.3.1"></times><ci id="S4.SS1.p5.6.m6.1.1.4.3.2.cmml" xref="S4.SS1.p5.6.m6.1.1.4.3.2">𝑜</ci><ci id="S4.SS1.p5.6.m6.1.1.4.3.3.cmml" xref="S4.SS1.p5.6.m6.1.1.4.3.3">𝑢</ci><ci id="S4.SS1.p5.6.m6.1.1.4.3.4.cmml" xref="S4.SS1.p5.6.m6.1.1.4.3.4">𝑡</ci></apply></apply></apply><apply id="S4.SS1.p5.6.m6.1.1c.cmml" xref="S4.SS1.p5.6.m6.1.1"><eq id="S4.SS1.p5.6.m6.1.1.5.cmml" xref="S4.SS1.p5.6.m6.1.1.5"></eq><share href="https://arxiv.org/html/2405.11764v2#S4.SS1.p5.6.m6.1.1.4.cmml" id="S4.SS1.p5.6.m6.1.1d.cmml" xref="S4.SS1.p5.6.m6.1.1"></share><cn id="S4.SS1.p5.6.m6.1.1.6.cmml" type="integer" xref="S4.SS1.p5.6.m6.1.1.6">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">d_{in}=d_{out}=40</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT = 40</annotation></semantics></math>. Regarding other <math alttext="\mathbf{MLP}_{1,2,3}" class="ltx_Math" display="inline" id="S4.SS1.p5.7.m7.3"><semantics id="S4.SS1.p5.7.m7.3a"><msub id="S4.SS1.p5.7.m7.3.4" xref="S4.SS1.p5.7.m7.3.4.cmml"><mi id="S4.SS1.p5.7.m7.3.4.2" xref="S4.SS1.p5.7.m7.3.4.2.cmml">𝐌𝐋𝐏</mi><mrow id="S4.SS1.p5.7.m7.3.3.3.5" xref="S4.SS1.p5.7.m7.3.3.3.4.cmml"><mn id="S4.SS1.p5.7.m7.1.1.1.1" xref="S4.SS1.p5.7.m7.1.1.1.1.cmml">1</mn><mo id="S4.SS1.p5.7.m7.3.3.3.5.1" xref="S4.SS1.p5.7.m7.3.3.3.4.cmml">,</mo><mn id="S4.SS1.p5.7.m7.2.2.2.2" xref="S4.SS1.p5.7.m7.2.2.2.2.cmml">2</mn><mo id="S4.SS1.p5.7.m7.3.3.3.5.2" xref="S4.SS1.p5.7.m7.3.3.3.4.cmml">,</mo><mn id="S4.SS1.p5.7.m7.3.3.3.3" xref="S4.SS1.p5.7.m7.3.3.3.3.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.3b"><apply id="S4.SS1.p5.7.m7.3.4.cmml" xref="S4.SS1.p5.7.m7.3.4"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m7.3.4.1.cmml" xref="S4.SS1.p5.7.m7.3.4">subscript</csymbol><ci id="S4.SS1.p5.7.m7.3.4.2.cmml" xref="S4.SS1.p5.7.m7.3.4.2">𝐌𝐋𝐏</ci><list id="S4.SS1.p5.7.m7.3.3.3.4.cmml" xref="S4.SS1.p5.7.m7.3.3.3.5"><cn id="S4.SS1.p5.7.m7.1.1.1.1.cmml" type="integer" xref="S4.SS1.p5.7.m7.1.1.1.1">1</cn><cn id="S4.SS1.p5.7.m7.2.2.2.2.cmml" type="integer" xref="S4.SS1.p5.7.m7.2.2.2.2">2</cn><cn id="S4.SS1.p5.7.m7.3.3.3.3.cmml" type="integer" xref="S4.SS1.p5.7.m7.3.3.3.3">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.3c">\mathbf{MLP}_{1,2,3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.7.m7.3d">bold_MLP start_POSTSUBSCRIPT 1 , 2 , 3 end_POSTSUBSCRIPT</annotation></semantics></math>, they are two-layer with the hidden size as half of the input dimension. The truncated threshold <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p5.8.m8.1"><semantics id="S4.SS1.p5.8.m8.1a"><mi id="S4.SS1.p5.8.m8.1.1" xref="S4.SS1.p5.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.1b"><ci id="S4.SS1.p5.8.m8.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.8.m8.1d">italic_T</annotation></semantics></math> is set as <math alttext="50" class="ltx_Math" display="inline" id="S4.SS1.p5.9.m9.1"><semantics id="S4.SS1.p5.9.m9.1a"><mn id="S4.SS1.p5.9.m9.1.1" xref="S4.SS1.p5.9.m9.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.1b"><cn id="S4.SS1.p5.9.m9.1.1.cmml" type="integer" xref="S4.SS1.p5.9.m9.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.1c">50</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.9.m9.1d">50</annotation></semantics></math> for Kuaishou and <math alttext="40" class="ltx_Math" display="inline" id="S4.SS1.p5.10.m10.1"><semantics id="S4.SS1.p5.10.m10.1a"><mn id="S4.SS1.p5.10.m10.1.1" xref="S4.SS1.p5.10.m10.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.10.m10.1b"><cn id="S4.SS1.p5.10.m10.1.1.cmml" type="integer" xref="S4.SS1.p5.10.m10.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.10.m10.1c">40</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.10.m10.1d">40</annotation></semantics></math> for the Taobao dataset. The weight of contrastive learning <math alttext="\alpha=0.4" class="ltx_Math" display="inline" id="S4.SS1.p5.11.m11.1"><semantics id="S4.SS1.p5.11.m11.1a"><mrow id="S4.SS1.p5.11.m11.1.1" xref="S4.SS1.p5.11.m11.1.1.cmml"><mi id="S4.SS1.p5.11.m11.1.1.2" xref="S4.SS1.p5.11.m11.1.1.2.cmml">α</mi><mo id="S4.SS1.p5.11.m11.1.1.1" xref="S4.SS1.p5.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.11.m11.1.1.3" xref="S4.SS1.p5.11.m11.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.11.m11.1b"><apply id="S4.SS1.p5.11.m11.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1"><eq id="S4.SS1.p5.11.m11.1.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1.1"></eq><ci id="S4.SS1.p5.11.m11.1.1.2.cmml" xref="S4.SS1.p5.11.m11.1.1.2">𝛼</ci><cn id="S4.SS1.p5.11.m11.1.1.3.cmml" type="float" xref="S4.SS1.p5.11.m11.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.11.m11.1c">\alpha=0.4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.11.m11.1d">italic_α = 0.4</annotation></semantics></math>. Note that these hyper-parameters are not carefully tuned for better performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Overall Comparison (RQ1)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Public Datasets</span>. The performance on the Kuaishou and Taobao datasets are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.T3" title="Table 3 ‣ 4.2. Overall Comparison (RQ1) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. From the comparison, we have the following observations,</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.2.1">FRec outperforms all the baselines significantly.</span> On the Kuaishou dataset, FRec improves by about 0.009 in terms of AUC and GAUC. Corresponding improvements are 0.026 and 0.019 on the Taobao dataset. For other ranking metrics, the improvements range from 1.3%<math alttext="\sim" class="ltx_Math" display="inline" id="S4.I3.i1.p1.1.m1.1"><semantics id="S4.I3.i1.p1.1.m1.1a"><mo id="S4.I3.i1.p1.1.m1.1.1" xref="S4.I3.i1.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.1.m1.1b"><csymbol cd="latexml" id="S4.I3.i1.p1.1.m1.1.1.cmml" xref="S4.I3.i1.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.1.m1.1d">∼</annotation></semantics></math>3.0% and 2.4%<math alttext="\sim" class="ltx_Math" display="inline" id="S4.I3.i1.p1.2.m2.1"><semantics id="S4.I3.i1.p1.2.m2.1a"><mo id="S4.I3.i1.p1.2.m2.1.1" xref="S4.I3.i1.p1.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.2.m2.1b"><csymbol cd="latexml" id="S4.I3.i1.p1.2.m2.1.1.cmml" xref="S4.I3.i1.p1.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.2.m2.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.2.m2.1d">∼</annotation></semantics></math> 5.8% on the Kuaishou and Taobao datasets, respectively. The p-value ¡ 0.001 demonstrates that FRec can give consistently and significantly more accurate recommendations than SOTA models.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">Modeling long and short-term interests or multi-interests can obtain better performance generally.</span> CLSR, a SOTA model disentangling users’ long and short-term interests based on causal structure, obtains almost the best performance among the baselines on both datasets. Compared with models only capturing long-term (<span class="ltx_text ltx_font_italic" id="S4.I3.i2.p1.1.2">e.g.</span>, DIN) or short-term (<span class="ltx_text ltx_font_italic" id="S4.I3.i2.p1.1.3">e.g.</span>, GRU4Rec) interest, jointly modeling (CLSR, SLi-Rec) is better on most metrics. ComiRec-SA, a multi-interest framework based on self-attention, also obtains competitive performance.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">Feeding coarse-grained similarity features can benefit model performance.</span> On both datasets, DFN outperforms the backbone DIN on most metrics, especially on AUC. However, top performance can not be guaranteed since it directly concatenates several fatigue-aware features (<span class="ltx_text ltx_font_italic" id="S4.I3.i3.p1.1.2">e.g.</span>, the number of historical consumed items, the number of items that belong to the same category with the target item) with the embedding of the target item. In other words, it’s necessary to capture complex influence of user fatigue on interests accurately in model design.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.4.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S4.T3.5.2" style="font-size:90%;">Performance comparison on public dataset. All the results are averaged over five experiments. <span class="ltx_ERROR undefined" id="S4.T3.5.2.1">\ul</span>Underline means the best two baselines, and <span class="ltx_text ltx_font_bold" id="S4.T3.5.2.2">bold</span> means p-value ¡ 0.001 compared with the best baseline under the student’s t-test.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.6" style="width:628.6pt;height:235.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-51.2pt,19.2pt) scale(0.86,0.86) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.6.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.6.1.1.1.2"><span class="ltx_text" id="S4.T3.6.1.1.1.2.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.3"><span class="ltx_text" id="S4.T3.6.1.1.1.3.1">DIN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.4"><span class="ltx_text" id="S4.T3.6.1.1.1.4.1">DIEN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.5"><span class="ltx_text" id="S4.T3.6.1.1.1.5.1">GRU4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.6"><span class="ltx_text" id="S4.T3.6.1.1.1.6.1">SASRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.7"><span class="ltx_text" id="S4.T3.6.1.1.1.7.1">AdaMCT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.8"><span class="ltx_text" id="S4.T3.6.1.1.1.8.1">Caser</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.9"><span class="ltx_text" id="S4.T3.6.1.1.1.9.1">SLi-Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.6.1.1.1.10"><span class="ltx_text" id="S4.T3.6.1.1.1.10.1">CLSR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.11"><span class="ltx_text" id="S4.T3.6.1.1.1.11.1">SUM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.12"><span class="ltx_text" id="S4.T3.6.1.1.1.12.1">
<span class="ltx_inline-block" id="S4.T3.6.1.1.1.12.1.1">
<span class="ltx_p" id="S4.T3.6.1.1.1.12.1.1.1">ComiRec</span>
<span class="ltx_p" id="S4.T3.6.1.1.1.12.1.1.2">-DR</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.13"><span class="ltx_text" id="S4.T3.6.1.1.1.13.1">
<span class="ltx_inline-block" id="S4.T3.6.1.1.1.13.1.1">
<span class="ltx_p" id="S4.T3.6.1.1.1.13.1.1.1">ComiRec</span>
<span class="ltx_p" id="S4.T3.6.1.1.1.13.1.1.2">-SA</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.6.1.1.1.14"><span class="ltx_text" id="S4.T3.6.1.1.1.14.1">
<span class="ltx_inline-block" id="S4.T3.6.1.1.1.14.1.1">
<span class="ltx_p" id="S4.T3.6.1.1.1.14.1.1.1">MGNM</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.15"><span class="ltx_text" id="S4.T3.6.1.1.1.15.1">DFN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.6.1.1.1.16"><span class="ltx_text" id="S4.T3.6.1.1.1.16.1">FRec</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.6.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.1" rowspan="7"><span class="ltx_text" id="S4.T3.6.1.2.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.6.1.2.1.1.1.1" style="width:6.9pt;height:41.2pt;vertical-align:-17.1pt;"><span class="ltx_transformed_inner" style="width:41.2pt;transform:translate(-17.11pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.6.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.2.1.1.1.1.1.1">Kuaishou</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.2.1.2">AUC</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.3">0.6054</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.4">0.7520</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.5">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.2.1.5.1">\ul</span>0.8306</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.6">0.8298</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.7">0.8067</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.8">0.8228</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.9">0.8258</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.2.1.10">0.8263</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.11">0.8235</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.12">0.8239</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.13">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.2.1.13.1">\ul</span>0.8441</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.2.1.14">OOM<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>Due to the requirement of constructing graphs based on historical sequences, MGNM encounters out-of-memory (OOM) on the Kuaishou dataset, which has a longer maximum sequence length of <math alttext="250" class="ltx_Math" display="inline" id="footnote7.m1.1"><semantics id="footnote7.m1.1b"><mn id="footnote7.m1.1.1" xref="footnote7.m1.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="footnote7.m1.1c"><cn id="footnote7.m1.1.1.cmml" type="integer" xref="footnote7.m1.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote7.m1.1d">250</annotation><annotation encoding="application/x-llamapun" id="footnote7.m1.1e">250</annotation></semantics></math>. In original paper, the maximum sequence length is only <math alttext="100" class="ltx_Math" display="inline" id="footnote7.m2.1"><semantics id="footnote7.m2.1b"><mn id="footnote7.m2.1.1" xref="footnote7.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="footnote7.m2.1c"><cn id="footnote7.m2.1.1.cmml" type="integer" xref="footnote7.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote7.m2.1d">100</annotation><annotation encoding="application/x-llamapun" id="footnote7.m2.1e">100</annotation></semantics></math>.</span></span></span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.15">0.6613</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.2.1.16"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.2.1.16.1">0.8533</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.3.2.1">GAUC</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.2">0.8204</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.3">0.8198</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.4">0.8401</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.5">0.8270</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.6">0.8033</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.7">0.8417</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.8">0.8388</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.3.2.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.3.2.9.1">\ul</span>0.8473</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.10">0.8414</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.11">0.8259</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.12">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.3.2.12.1">\ul</span>0.8464</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.3.2.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.14">0.8159</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.3.2.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.3.2.15.1">0.8564</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.4.3.1">HR@2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.2">0.6179</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.3">0.6249</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.4">0.6570</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.5">0.6226</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.6">0.5776</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.7">0.6552</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.8">0.6651</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.4.3.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.4.3.9.1">\ul</span>0.6703</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.10">0.6570</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.11">0.6301</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.12">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.4.3.12.1">\ul</span>0.6658</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.4.3.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.14">0.6284</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.4.3.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.4.3.15.1">0.6878</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.5.4.1">HR@4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.2">0.8269</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.3">0.8356</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.4">0.8642</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.5">0.8466</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.6">0.8172</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.7">0.8683</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.8">0.8585</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.5.4.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.5.4.9.1">\ul</span>0.8747</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.10">0.8670</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.11">0.8429</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.12">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.5.4.12.1">\ul</span>0.8705</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.5.4.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.14">0.8424</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.5.4.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.5.4.15.1">0.8860</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.6.5.1">NDCG@2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.2">0.5417</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.3">0.5484</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.4">0.5784</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.5">0.5428</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.6">0.4982</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.7">0.5749</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.8">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.6.5.8.1">\ul</span>0.5897</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.6.5.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.6.5.9.1">\ul</span>0.5901</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.10">0.5779</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.11">0.5523</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.12">0.5869</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.6.5.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.14">0.5509</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.6.5.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.6.5.15.1">0.6077</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.7.6.1">NDCG@4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.2">0.6403</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.3">0.6479</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.4">0.6765</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.5">0.6486</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.6">0.6112</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.7">0.6758</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.8">0.6812</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.7.6.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.7.6.9.1">\ul</span>0.6869</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.10">0.6772</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.11">0.6527</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.12">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.7.6.12.1">\ul</span>0.6837</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.7.6.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.14">0.6519</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.7.6.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.7.6.15.1">0.7016</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.8.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.8.7.1">MRR</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.2">0.6045</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.3">0.6111</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.4">0.6355</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.5">0.6073</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.6">0.5719</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.7">0.6327</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.8">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.8.7.8.1">\ul</span>0.6442</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.8.7.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.8.7.9.1">\ul</span>0.6444</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.10">0.6353</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.11">0.6143</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.12">0.6422</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.8.7.13">OOM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.14">0.6136</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.8.7.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.8.7.15.1">0.6583</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.9.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.1.9.8.1" rowspan="7"><span class="ltx_text" id="S4.T3.6.1.9.8.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.6.1.9.8.1.1.1" style="width:6.9pt;height:31.9pt;vertical-align:-12.5pt;"><span class="ltx_transformed_inner" style="width:31.9pt;transform:translate(-12.5pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.6.1.9.8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.9.8.1.1.1.1.1">Taobao</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.9.8.2">AUC</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.3">0.6800</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.4">0.7592</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.5">0.8257</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.6">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.9.8.6.1">\ul</span>0.8455</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.7">0.8412</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.8">0.8264</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.9">0.8333</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.9.8.10">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.9.8.10.1">\ul</span>0.8527</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.11">0.8247</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.12">0.7820</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.13">0.8359</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.1.9.8.14">0.7291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.15">0.7630</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.1.9.8.16"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.9.8.16.1">0.8795</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.10.9.1">GAUC</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.2">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.10.9.2.1">\ul</span>0.8469</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.3">0.8263</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.4">0.8327</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.5">0.8430</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.6">0.8336</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.7">0.8376</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.8">0.8381</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.10.9.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.10.9.9.1">\ul</span>0.8601</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.10">0.8281</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.11">0.7779</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.12">0.8333</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.10.9.13">0.7279</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.14">0.8459</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.10.9.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.10.9.15.1">0.8792</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.11.10.1">HR@2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.2">0.7072</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.3">0.6737</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.4">0.6922</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.5">0.6964</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.6">0.6842</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.7">0.6878</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.8">0.6857</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.11.10.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.11.10.9.1">\ul</span>0.7305</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.10">0.6818</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.11">0.5675</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.12">0.6667</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.11.10.13">0.4897</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.14">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.11.10.14.1">\ul</span>0.7144</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.11.10.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.11.10.15.1">0.7660</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.12.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.12.11.1">HR@4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.2">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.12.11.2.1">\ul</span>0.8585</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.3">0.8393</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.4">0.8331</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.5">0.8460</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.6">0.8325</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.7">0.8417</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.8">0.8464</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.12.11.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.12.11.9.1">\ul</span>0.8667</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.10">0.8312</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.11">0.7702</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.12">0.8374</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.12.11.13">0.7055</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.14">0.8485</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.12.11.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.12.11.15.1">0.8873</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.13.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.13.12.1">NDCG@2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.2">0.6444</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.3">0.6101</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.4">0.6397</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.5">0.6373</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.6">0.6268</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.7">0.6311</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.8">0.6224</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.13.12.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.13.12.9.1">\ul</span>0.6754</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.10">0.6248</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.11">0.5010</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.12">0.6039</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.13.12.13">0.4258</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.14">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.13.12.14.1">\ul</span>0.6631</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.13.12.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.13.12.15.1">0.7143</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.14.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.14.13.1">NDCG@4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.2">0.7159</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.3">0.6883</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.4">0.7061</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.5">0.7079</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.6">0.6967</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.7">0.7036</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.8">0.6983</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.14.13.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.14.13.9.1">\ul</span>0.7397</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.10">0.6953</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.11">0.5964</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.12">0.6845</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.6.1.14.13.13">0.5271</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.14">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.14.13.14.1">\ul</span>0.7263</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.1.14.13.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.14.13.15.1">0.7716</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.1.15.14">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.6.1.15.14.1">MRR</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.2">0.6897</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.3">0.6623</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.4">0.6888</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.5">0.6851</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.6">0.6765</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.7">0.6818</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.8">0.6723</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.6.1.15.14.9">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.15.14.9.1">\ul</span>0.7177</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.10">0.6752</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.11">0.5736</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.12">0.6585</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.6.1.15.14.13">0.5121</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.14">
<span class="ltx_ERROR undefined" id="S4.T3.6.1.15.14.14.1">\ul</span>0.7082</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.6.1.15.14.15"><span class="ltx_text ltx_font_bold" id="S4.T3.6.1.15.14.15.1">0.7501</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Industrial Dataset</span>.
For the industrial deployment on Kuaishou, we select these baseline methods performing well on the public Kuaishou dataset.
Specifically, the baseline methods and our method are deployed to the click-through rate (CTR) prediction module in the industrial recommendation engine.
The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.T4" title="Table 4 ‣ 4.2. Overall Comparison (RQ1) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. Our FRec can improve both AUC and GAUC by more than 0.01 compared with the best baselines. This is a huge improvement for a real-world scenario with tens of millions of users <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib9" title="">2016</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib15" title="">2017</a>)</cite>. Note that this dataset has been scaled up hundreds of times, thus the improvement is more promising compared with that of the public Kuaishou dataset. We attribute this advantage to the choice of negative items in the evaluation. On the public Kuaishou dataset, negative items are randomly sampled. In contrast, we use the exposed videos users have not clicked on industrial dataset. In this scenario, user fatigue plays a critical role in consecutive decisions, where the exposed videos have generally matched user interests guaranteed by the advanced industrial recommender system. Therefore, FRec can effectively distinguish between clicked and non-clicked ones among all the exposed videos when modeling the influence of user fatigue on temporal interests accurately.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.2.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S4.T4.3.2" style="font-size:90%;">Performance comparison on the industrial dataset.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.2">GRU4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.3">SLi-Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.4">CLSR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.5">ComiRec-SA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.6">FRec</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.2.1.1">AUC</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.2.1.2">0.7252</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.2.1.3">0.7302</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.2.1.4">0.7267</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.2.1.5">0.7247</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.1.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.2.1.6.1">0.7408</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.3.2.1">GAUC</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.3.2.2">0.6525</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.3.2.3">0.6604</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.3.2.4">0.6584</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.3.2.5">0.6433</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.3.2.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.3.2.6.1">0.6709</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Efficiency Comparison</span>. Table <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.T5" title="Table 5 ‣ 4.2. Overall Comparison (RQ1) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> shows the training time per epoch of all the models on public datasets, demonstrating that the efficiency of FRec is comparable with simple and complex baselines.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5. </span>Training time (minutes) per epoch of all the models.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.4.1.1.1"><span class="ltx_text" id="S4.T5.4.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.2"><span class="ltx_text" id="S4.T5.4.1.1.2.1" style="font-size:90%;">DIN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.3"><span class="ltx_text" id="S4.T5.4.1.1.3.1" style="font-size:90%;">DIEN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.4"><span class="ltx_text" id="S4.T5.4.1.1.4.1" style="font-size:90%;">GRU4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.5"><span class="ltx_text" id="S4.T5.4.1.1.5.1" style="font-size:90%;">SASRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.6"><span class="ltx_text" id="S4.T5.4.1.1.6.1" style="font-size:90%;">AdaMCT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.7"><span class="ltx_text" id="S4.T5.4.1.1.7.1" style="font-size:90%;">Caser</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.8"><span class="ltx_text" id="S4.T5.4.1.1.8.1" style="font-size:90%;">SLi-Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.4.1.1.9"><span class="ltx_text" id="S4.T5.4.1.1.9.1" style="font-size:90%;">CLSR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.10"><span class="ltx_text" id="S4.T5.4.1.1.10.1" style="font-size:90%;">SUM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.11"><span class="ltx_text" id="S4.T5.4.1.1.11.1" style="font-size:90%;">
<span class="ltx_inline-block" id="S4.T5.4.1.1.11.1.1">
<span class="ltx_p" id="S4.T5.4.1.1.11.1.1.1">ComiRec</span>
<span class="ltx_p" id="S4.T5.4.1.1.11.1.1.2">-DR</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.12"><span class="ltx_text" id="S4.T5.4.1.1.12.1" style="font-size:90%;">
<span class="ltx_inline-block" id="S4.T5.4.1.1.12.1.1">
<span class="ltx_p" id="S4.T5.4.1.1.12.1.1.1">ComiRec</span>
<span class="ltx_p" id="S4.T5.4.1.1.12.1.1.2">-SA</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T5.4.1.1.13"><span class="ltx_text" id="S4.T5.4.1.1.13.1" style="font-size:90%;">
<span class="ltx_inline-block" id="S4.T5.4.1.1.13.1.1">
<span class="ltx_p" id="S4.T5.4.1.1.13.1.1.1">MGNM</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.14"><span class="ltx_text" id="S4.T5.4.1.1.14.1" style="font-size:90%;">DFN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.1.1.15"><span class="ltx_text" id="S4.T5.4.1.1.15.1" style="font-size:90%;">FRec</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.4.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.4.2.1.1.1" style="font-size:90%;">Kuaishou</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.2"><span class="ltx_text" id="S4.T5.4.2.1.2.1" style="font-size:90%;">17.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.3"><span class="ltx_text" id="S4.T5.4.2.1.3.1" style="font-size:90%;">17.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.4"><span class="ltx_text" id="S4.T5.4.2.1.4.1" style="font-size:90%;">18.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.5"><span class="ltx_text" id="S4.T5.4.2.1.5.1" style="font-size:90%;">59.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.6"><span class="ltx_text" id="S4.T5.4.2.1.6.1" style="font-size:90%;">17.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.7"><span class="ltx_text" id="S4.T5.4.2.1.7.1" style="font-size:90%;">16.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.8"><span class="ltx_text" id="S4.T5.4.2.1.8.1" style="font-size:90%;">24.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.4.2.1.9"><span class="ltx_text" id="S4.T5.4.2.1.9.1" style="font-size:90%;">21.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.10"><span class="ltx_text" id="S4.T5.4.2.1.10.1" style="font-size:90%;">83.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.11"><span class="ltx_text" id="S4.T5.4.2.1.11.1" style="font-size:90%;">16.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.12"><span class="ltx_text" id="S4.T5.4.2.1.12.1" style="font-size:90%;">17.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.4.2.1.13"><span class="ltx_text" id="S4.T5.4.2.1.13.1" style="font-size:90%;">OOM</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.14"><span class="ltx_text" id="S4.T5.4.2.1.14.1" style="font-size:90%;">19.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.2.1.15"><span class="ltx_text" id="S4.T5.4.2.1.15.1" style="font-size:90%;">23.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.4.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.4.3.2.1"><span class="ltx_text ltx_font_bold" id="S4.T5.4.3.2.1.1" style="font-size:90%;">Taobao</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.2"><span class="ltx_text" id="S4.T5.4.3.2.2.1" style="font-size:90%;">7.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.3"><span class="ltx_text" id="S4.T5.4.3.2.3.1" style="font-size:90%;">8.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.4"><span class="ltx_text" id="S4.T5.4.3.2.4.1" style="font-size:90%;">9.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.5"><span class="ltx_text" id="S4.T5.4.3.2.5.1" style="font-size:90%;">14.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.6"><span class="ltx_text" id="S4.T5.4.3.2.6.1" style="font-size:90%;">9.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.7"><span class="ltx_text" id="S4.T5.4.3.2.7.1" style="font-size:90%;">13.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.8"><span class="ltx_text" id="S4.T5.4.3.2.8.1" style="font-size:90%;">11.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.4.3.2.9"><span class="ltx_text" id="S4.T5.4.3.2.9.1" style="font-size:90%;">11.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.10"><span class="ltx_text" id="S4.T5.4.3.2.10.1" style="font-size:90%;">35.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.11"><span class="ltx_text" id="S4.T5.4.3.2.11.1" style="font-size:90%;">7.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.12"><span class="ltx_text" id="S4.T5.4.3.2.12.1" style="font-size:90%;">7.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.4.3.2.13"><span class="ltx_text" id="S4.T5.4.3.2.13.1" style="font-size:90%;">30.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.14"><span class="ltx_text" id="S4.T5.4.3.2.14.1" style="font-size:90%;">10.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.4.3.2.15"><span class="ltx_text" id="S4.T5.4.3.2.15.1" style="font-size:90%;">12.7</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Ablation Study (RQ2)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In our proposed FRec, there are some key modules for modeling user fatigue, including 1) fatigue-enhanced multi-interests fusion, 2) fatigue recurrent unit (FRU) with fatigue representations as additional input, 3) cross networks for feature interplay to handle complex fatigue influence on user interests, and 4) contrastive learning with explicit fatigue supervision. To extensively verify their benefits, we conduct ablation studies to investigate how each module influences model effectiveness. Correspondingly, we have made the following changes,</p>
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i1.p1.1.1">w/o Fusion</span>: replace fatigue-enhanced attentive fusion with mean pooling.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i2.p1.1.1">w/o FRU</span>: replace FRU with vanilla GRU, with convolutional fatigue features removed.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i3.p1">
<p class="ltx_p" id="S4.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i3.p1.1.1">w/o Cross</span>: replace cross layers with dense layers.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i4.p1">
<p class="ltx_p" id="S4.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i4.p1.1.1">w/o CL</span>: remove contrastive learning, <span class="ltx_text ltx_font_italic" id="S4.I4.i4.p1.1.2">i.e.</span>, set <math alttext="\alpha=0" class="ltx_Math" display="inline" id="S4.I4.i4.p1.1.m1.1"><semantics id="S4.I4.i4.p1.1.m1.1a"><mrow id="S4.I4.i4.p1.1.m1.1.1" xref="S4.I4.i4.p1.1.m1.1.1.cmml"><mi id="S4.I4.i4.p1.1.m1.1.1.2" xref="S4.I4.i4.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.I4.i4.p1.1.m1.1.1.1" xref="S4.I4.i4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.I4.i4.p1.1.m1.1.1.3" xref="S4.I4.i4.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I4.i4.p1.1.m1.1b"><apply id="S4.I4.i4.p1.1.m1.1.1.cmml" xref="S4.I4.i4.p1.1.m1.1.1"><eq id="S4.I4.i4.p1.1.m1.1.1.1.cmml" xref="S4.I4.i4.p1.1.m1.1.1.1"></eq><ci id="S4.I4.i4.p1.1.m1.1.1.2.cmml" xref="S4.I4.i4.p1.1.m1.1.1.2">𝛼</ci><cn id="S4.I4.i4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.I4.i4.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i4.p1.1.m1.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="S4.I4.i4.p1.1.m1.1d">italic_α = 0</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Performances with these key modules removed are shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:ablation</span>. Results show that FRec obtains better performances consistently compared with all the incomplete models on both datasets, demonstrating the necessity of the proposed modules for modeling user fatigue. Note that significantly worse performance without cross networks indicates critical benefits of the interplay of similarity features.
Furthermore, on the Kuaishou dataset, the performance drops the most when contrastive learning is removed, but this is not the case for the Taobao dataset. We attribute this difference to the effectiveness of sequence augmentation for obtaining fatigue signals. In Kuaishou, a micro-video platform, repetitive recommendations of the same videos obviously cause intense user fatigue. However, for e-commerce platforms like Taobao, multiple views of the same product page are relatively common, and users may not experience fatigue during limited repetitions. In contrast, FRU plays an essential role in the model on the Taobao dataset. This demonstrates the effectiveness of guiding short-term interest evolution with temporal user fatigue as necessary inputs for update and reset gates. It can be explained by the intention changes of sequential behaviors in the e-commerce applications <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib8" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib26" title="">2023b</a>)</cite>. Specifically, users have different intentions when browsing products, and they may experience fatigue of redundant exposure if the intention has switched. Therefore, fusing temporal user fatigue can assist in modeling short-term interests more accurately.</p>
</div>
<figure class="ltx_figure" id="S4.F8.sf1">
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Study on Fatigue Reduction (RQ3)</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.2"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.2.1">Online Experiments</span>. We further deploy FRec on Kuaishou to verify the effectiveness of fatigue reduction and satisfaction improvement. Specifically, we choose CLSR (the highest overall performance on public and industry datasets) for comparison and conduct an A/B test for 7 days, involving millions of users. Table <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.T6" title="Table 6 ‣ 4.4. Study on Fatigue Reduction (RQ3) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a> shows the improvement of key online metrics, which are defined as follows,</p>
<ul class="ltx_itemize" id="S4.I5">
<li class="ltx_item" id="S4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i1.p1">
<p class="ltx_p" id="S4.I5.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i1.p1.1.1">App usage</span> denotes the average dwell time users use the App.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i2.p1">
<p class="ltx_p" id="S4.I5.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i2.p1.1.1">#Play</span> denotes total number of effectively played videos.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i3.p1">
<p class="ltx_p" id="S4.I5.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i3.p1.1.1">#Category</span> denotes the average number of video categories in terms of the behavior of effective view.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i4.p1">
<p class="ltx_p" id="S4.I5.i4.p1.3"><span class="ltx_text ltx_font_bold" id="S4.I5.i4.p1.3.1">Concentration</span> indicates how similar videos consecutively exposed over a fixed window are. It’s calculated as <math alttext="N-C" class="ltx_Math" display="inline" id="S4.I5.i4.p1.1.m1.1"><semantics id="S4.I5.i4.p1.1.m1.1a"><mrow id="S4.I5.i4.p1.1.m1.1.1" xref="S4.I5.i4.p1.1.m1.1.1.cmml"><mi id="S4.I5.i4.p1.1.m1.1.1.2" xref="S4.I5.i4.p1.1.m1.1.1.2.cmml">N</mi><mo id="S4.I5.i4.p1.1.m1.1.1.1" xref="S4.I5.i4.p1.1.m1.1.1.1.cmml">−</mo><mi id="S4.I5.i4.p1.1.m1.1.1.3" xref="S4.I5.i4.p1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I5.i4.p1.1.m1.1b"><apply id="S4.I5.i4.p1.1.m1.1.1.cmml" xref="S4.I5.i4.p1.1.m1.1.1"><minus id="S4.I5.i4.p1.1.m1.1.1.1.cmml" xref="S4.I5.i4.p1.1.m1.1.1.1"></minus><ci id="S4.I5.i4.p1.1.m1.1.1.2.cmml" xref="S4.I5.i4.p1.1.m1.1.1.2">𝑁</ci><ci id="S4.I5.i4.p1.1.m1.1.1.3.cmml" xref="S4.I5.i4.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I5.i4.p1.1.m1.1c">N-C</annotation><annotation encoding="application/x-llamapun" id="S4.I5.i4.p1.1.m1.1d">italic_N - italic_C</annotation></semantics></math>, where <math alttext="N=6" class="ltx_Math" display="inline" id="S4.I5.i4.p1.2.m2.1"><semantics id="S4.I5.i4.p1.2.m2.1a"><mrow id="S4.I5.i4.p1.2.m2.1.1" xref="S4.I5.i4.p1.2.m2.1.1.cmml"><mi id="S4.I5.i4.p1.2.m2.1.1.2" xref="S4.I5.i4.p1.2.m2.1.1.2.cmml">N</mi><mo id="S4.I5.i4.p1.2.m2.1.1.1" xref="S4.I5.i4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.I5.i4.p1.2.m2.1.1.3" xref="S4.I5.i4.p1.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I5.i4.p1.2.m2.1b"><apply id="S4.I5.i4.p1.2.m2.1.1.cmml" xref="S4.I5.i4.p1.2.m2.1.1"><eq id="S4.I5.i4.p1.2.m2.1.1.1.cmml" xref="S4.I5.i4.p1.2.m2.1.1.1"></eq><ci id="S4.I5.i4.p1.2.m2.1.1.2.cmml" xref="S4.I5.i4.p1.2.m2.1.1.2">𝑁</ci><cn id="S4.I5.i4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.I5.i4.p1.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I5.i4.p1.2.m2.1c">N=6</annotation><annotation encoding="application/x-llamapun" id="S4.I5.i4.p1.2.m2.1d">italic_N = 6</annotation></semantics></math> denotes the number of videos in the window, and <math alttext="C" class="ltx_Math" display="inline" id="S4.I5.i4.p1.3.m3.1"><semantics id="S4.I5.i4.p1.3.m3.1a"><mi id="S4.I5.i4.p1.3.m3.1.1" xref="S4.I5.i4.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.I5.i4.p1.3.m3.1b"><ci id="S4.I5.i4.p1.3.m3.1.1.cmml" xref="S4.I5.i4.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I5.i4.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.I5.i4.p1.3.m3.1d">italic_C</annotation></semantics></math> is the number of video categories.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS4.p1.1">FRec improves all the metrics significantly around 0.1%<math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mo id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><csymbol cd="latexml" id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">∼</annotation></semantics></math>0.4%, which is impressive for large-scale online experiments. Obviously, FRec not only enables users to spend more time on the platform and view more videos but also promotes a more diverse video consumption. Particularly, the reduction in <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Concentration</span> indicates that there are fewer videos of the same category in consecutive exposures of a short period, which lowers the perception of user fatigue.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">In order to further demonstrate the effectiveness of fatigue reduction, we conduct a similar analysis in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:evtr</span> with online interaction data. The comparison between the results of CLSR and FRec is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.F10" title="Figure 10 ‣ 4.4. Study on Fatigue Reduction (RQ3) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>, where EVTR is also normalized. It’s obvious that FRec can improve EVTR significantly when users have consumed many similar videos. Note that the improvement is obtained in an online setting, thus this is strong evidence of fatigue reduction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.1.1">Offline Experiments</span>. Since it’s not practical to conduct similar experiments on offline datasets, we conduct alternative experiments to demonstrate the fatigue reduction of FRec. We first show a recommendation case for a user in the industrial dataset. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S4.F8" title="Figure 8 ‣ 4.4. Study on Fatigue Reduction (RQ3) ‣ 4. Experiments ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>, the user has watched many sports videos recently, but SLi-Rec (the best baseline) still ranks a basketball video in the first position. In contrast, our FRec ranks this video in the last position. This demonstrates that FRec can alleviate improper and repetitive recommendations that may cause user fatigue in a period of short time (<span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.2">e.g.</span>, five minutes). Besides, as a part of user interests, the video about the scenery and trips lies at the top, with which the user has limited interactions. This demonstrates that FRec can assist in satisfying user interests and reducing user fatigue adaptively.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.13">Furthermore, we investigate whether FRec can perform better when user fatigue plays an important role in user decisions. Specifically, we define a proxy to represent the importance, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="m=\sum_{i_{n}}(m_{i_{n}}-m_{i_{p}})," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml">m</mi><mo id="S4.E14.m1.1.1.1.1.2" rspace="0.111em" xref="S4.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml"><munder id="S4.E14.m1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.2.cmml"><mo id="S4.E14.m1.1.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S4.E14.m1.1.1.1.1.1.2.2.cmml">∑</mo><msub id="S4.E14.m1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.1.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.2.3.2" xref="S4.E14.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mi id="S4.E14.m1.1.1.1.1.1.2.3.3" xref="S4.E14.m1.1.1.1.1.1.2.3.3.cmml">n</mi></msub></munder><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E14.m1.1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><msub id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">n</mi></msub></msub><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E14.m1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><msub id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">p</mi></msub></msub></mrow><mo id="S4.E14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2"></eq><ci id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3">𝑚</ci><apply id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><apply id="S4.E14.m1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E14.m1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2.2"></sum><apply id="S4.E14.m1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E14.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><minus id="S4.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.2">𝑚</ci><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.3.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">m=\sum_{i_{n}}(m_{i_{n}}-m_{i_{p}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">italic_m = ∑ start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_m start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_m start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p4.12">where <math alttext="m_{i_{n}}" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1"><semantics id="S4.SS4.p4.1.m1.1a"><msub id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml"><mi id="S4.SS4.p4.1.m1.1.1.2" xref="S4.SS4.p4.1.m1.1.1.2.cmml">m</mi><msub id="S4.SS4.p4.1.m1.1.1.3" xref="S4.SS4.p4.1.m1.1.1.3.cmml"><mi id="S4.SS4.p4.1.m1.1.1.3.2" xref="S4.SS4.p4.1.m1.1.1.3.2.cmml">i</mi><mi id="S4.SS4.p4.1.m1.1.1.3.3" xref="S4.SS4.p4.1.m1.1.1.3.3.cmml">n</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><apply id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.1.1.2">𝑚</ci><apply id="S4.SS4.p4.1.m1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.3.2.cmml" xref="S4.SS4.p4.1.m1.1.1.3.2">𝑖</ci><ci id="S4.SS4.p4.1.m1.1.1.3.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">m_{i_{n}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.1d">italic_m start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="m_{i_{p}}" class="ltx_Math" display="inline" id="S4.SS4.p4.2.m2.1"><semantics id="S4.SS4.p4.2.m2.1a"><msub id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml"><mi id="S4.SS4.p4.2.m2.1.1.2" xref="S4.SS4.p4.2.m2.1.1.2.cmml">m</mi><msub id="S4.SS4.p4.2.m2.1.1.3" xref="S4.SS4.p4.2.m2.1.1.3.cmml"><mi id="S4.SS4.p4.2.m2.1.1.3.2" xref="S4.SS4.p4.2.m2.1.1.3.2.cmml">i</mi><mi id="S4.SS4.p4.2.m2.1.1.3.3" xref="S4.SS4.p4.2.m2.1.1.3.3.cmml">p</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b"><apply id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.1.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p4.2.m2.1.1.2.cmml" xref="S4.SS4.p4.2.m2.1.1.2">𝑚</ci><apply id="S4.SS4.p4.2.m2.1.1.3.cmml" xref="S4.SS4.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.1.1.3.1.cmml" xref="S4.SS4.p4.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS4.p4.2.m2.1.1.3.2.cmml" xref="S4.SS4.p4.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS4.p4.2.m2.1.1.3.3.cmml" xref="S4.SS4.p4.2.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">m_{i_{p}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) denotes the number of items within three-hour historical consumption that belong to the same category of the negative (positive) item <math alttext="i_{n}" class="ltx_Math" display="inline" id="S4.SS4.p4.3.m3.1"><semantics id="S4.SS4.p4.3.m3.1a"><msub id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml"><mi id="S4.SS4.p4.3.m3.1.1.2" xref="S4.SS4.p4.3.m3.1.1.2.cmml">i</mi><mi id="S4.SS4.p4.3.m3.1.1.3" xref="S4.SS4.p4.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b"><apply id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.3.m3.1.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p4.3.m3.1.1.2.cmml" xref="S4.SS4.p4.3.m3.1.1.2">𝑖</ci><ci id="S4.SS4.p4.3.m3.1.1.3.cmml" xref="S4.SS4.p4.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">i_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="i_{p}" class="ltx_Math" display="inline" id="S4.SS4.p4.4.m4.1"><semantics id="S4.SS4.p4.4.m4.1a"><msub id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml"><mi id="S4.SS4.p4.4.m4.1.1.2" xref="S4.SS4.p4.4.m4.1.1.2.cmml">i</mi><mi id="S4.SS4.p4.4.m4.1.1.3" xref="S4.SS4.p4.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b"><apply id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.4.m4.1.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p4.4.m4.1.1.2.cmml" xref="S4.SS4.p4.4.m4.1.1.2">𝑖</ci><ci id="S4.SS4.p4.4.m4.1.1.3.cmml" xref="S4.SS4.p4.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">i_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.4.m4.1d">italic_i start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>). This proxy <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p4.5.m5.1"><semantics id="S4.SS4.p4.5.m5.1a"><mi id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b"><ci id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.5.m5.1d">italic_m</annotation></semantics></math> indicates the difference between historical-negative and historical-positive item similarity. High <math alttext="m&gt;0" class="ltx_Math" display="inline" id="S4.SS4.p4.6.m6.1"><semantics id="S4.SS4.p4.6.m6.1a"><mrow id="S4.SS4.p4.6.m6.1.1" xref="S4.SS4.p4.6.m6.1.1.cmml"><mi id="S4.SS4.p4.6.m6.1.1.2" xref="S4.SS4.p4.6.m6.1.1.2.cmml">m</mi><mo id="S4.SS4.p4.6.m6.1.1.1" xref="S4.SS4.p4.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.SS4.p4.6.m6.1.1.3" xref="S4.SS4.p4.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.6.m6.1b"><apply id="S4.SS4.p4.6.m6.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1"><gt id="S4.SS4.p4.6.m6.1.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1.1"></gt><ci id="S4.SS4.p4.6.m6.1.1.2.cmml" xref="S4.SS4.p4.6.m6.1.1.2">𝑚</ci><cn id="S4.SS4.p4.6.m6.1.1.3.cmml" type="integer" xref="S4.SS4.p4.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.6.m6.1c">m&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.6.m6.1d">italic_m &gt; 0</annotation></semantics></math> means that only modeling user interests based on relevance learning is insufficient for accurate recommendations. In other words, users are willing to interact with the item <math alttext="i_{p}" class="ltx_Math" display="inline" id="S4.SS4.p4.7.m7.1"><semantics id="S4.SS4.p4.7.m7.1a"><msub id="S4.SS4.p4.7.m7.1.1" xref="S4.SS4.p4.7.m7.1.1.cmml"><mi id="S4.SS4.p4.7.m7.1.1.2" xref="S4.SS4.p4.7.m7.1.1.2.cmml">i</mi><mi id="S4.SS4.p4.7.m7.1.1.3" xref="S4.SS4.p4.7.m7.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.7.m7.1b"><apply id="S4.SS4.p4.7.m7.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.7.m7.1.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p4.7.m7.1.1.2.cmml" xref="S4.SS4.p4.7.m7.1.1.2">𝑖</ci><ci id="S4.SS4.p4.7.m7.1.1.3.cmml" xref="S4.SS4.p4.7.m7.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.7.m7.1c">i_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.7.m7.1d">italic_i start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> other than <math alttext="i_{n}" class="ltx_Math" display="inline" id="S4.SS4.p4.8.m8.1"><semantics id="S4.SS4.p4.8.m8.1a"><msub id="S4.SS4.p4.8.m8.1.1" xref="S4.SS4.p4.8.m8.1.1.cmml"><mi id="S4.SS4.p4.8.m8.1.1.2" xref="S4.SS4.p4.8.m8.1.1.2.cmml">i</mi><mi id="S4.SS4.p4.8.m8.1.1.3" xref="S4.SS4.p4.8.m8.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.8.m8.1b"><apply id="S4.SS4.p4.8.m8.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.8.m8.1.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.p4.8.m8.1.1.2.cmml" xref="S4.SS4.p4.8.m8.1.1.2">𝑖</ci><ci id="S4.SS4.p4.8.m8.1.1.3.cmml" xref="S4.SS4.p4.8.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.8.m8.1c">i_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.8.m8.1d">italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> because of experiencing fatigue. We divide all the instances into groups with different <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p4.9.m9.1"><semantics id="S4.SS4.p4.9.m9.1a"><mi id="S4.SS4.p4.9.m9.1.1" xref="S4.SS4.p4.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.9.m9.1b"><ci id="S4.SS4.p4.9.m9.1.1.cmml" xref="S4.SS4.p4.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.9.m9.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.9.m9.1d">italic_m</annotation></semantics></math>, and show the performance comparison in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:m</span>. Due to the sparsity of <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p4.10.m10.1"><semantics id="S4.SS4.p4.10.m10.1a"><mi id="S4.SS4.p4.10.m10.1.1" xref="S4.SS4.p4.10.m10.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.10.m10.1b"><ci id="S4.SS4.p4.10.m10.1.1.cmml" xref="S4.SS4.p4.10.m10.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.10.m10.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.10.m10.1d">italic_m</annotation></semantics></math> on the Kuaishou dataset, we only report results on the Taobao dataset. The best two baselines perform worse with increasing <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p4.11.m11.1"><semantics id="S4.SS4.p4.11.m11.1a"><mi id="S4.SS4.p4.11.m11.1.1" xref="S4.SS4.p4.11.m11.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.11.m11.1b"><ci id="S4.SS4.p4.11.m11.1.1.cmml" xref="S4.SS4.p4.11.m11.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.11.m11.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.11.m11.1d">italic_m</annotation></semantics></math>, especially when <math alttext="m\geq 5" class="ltx_Math" display="inline" id="S4.SS4.p4.12.m12.1"><semantics id="S4.SS4.p4.12.m12.1a"><mrow id="S4.SS4.p4.12.m12.1.1" xref="S4.SS4.p4.12.m12.1.1.cmml"><mi id="S4.SS4.p4.12.m12.1.1.2" xref="S4.SS4.p4.12.m12.1.1.2.cmml">m</mi><mo id="S4.SS4.p4.12.m12.1.1.1" xref="S4.SS4.p4.12.m12.1.1.1.cmml">≥</mo><mn id="S4.SS4.p4.12.m12.1.1.3" xref="S4.SS4.p4.12.m12.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.12.m12.1b"><apply id="S4.SS4.p4.12.m12.1.1.cmml" xref="S4.SS4.p4.12.m12.1.1"><geq id="S4.SS4.p4.12.m12.1.1.1.cmml" xref="S4.SS4.p4.12.m12.1.1.1"></geq><ci id="S4.SS4.p4.12.m12.1.1.2.cmml" xref="S4.SS4.p4.12.m12.1.1.2">𝑚</ci><cn id="S4.SS4.p4.12.m12.1.1.3.cmml" type="integer" xref="S4.SS4.p4.12.m12.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.12.m12.1c">m\geq 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.12.m12.1d">italic_m ≥ 5</annotation></semantics></math>. In contrast, our FRec keeps steady (and significantly better) performances thanks to the ability to model users’ temporal fatigue in short-term interest learning. Therefore, FRec can reduce user fatigue by ranking positive items at the top, which are less similar to historical items than negative items.</p>
</div>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F8.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F8.2.1.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text" id="S4.F8.3.2" style="font-size:90%;">Recommendations by SLiRec and FRec.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F10.sf1">
</figure>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T6.10.3.1" style="font-size:90%;">Table 6</span>. </span><span class="ltx_text" id="S4.T6.4.2" style="font-size:90%;">The improvement of key online metrics. <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.3.1.m1.1"><semantics id="S4.T6.3.1.m1.1b"><mo id="S4.T6.3.1.m1.1.1" stretchy="false" xref="S4.T6.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.1.m1.1c"><ci id="S4.T6.3.1.m1.1.1.cmml" xref="S4.T6.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.1.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.1.m1.1e">↑</annotation></semantics></math> (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.4.2.m2.1"><semantics id="S4.T6.4.2.m2.1b"><mo id="S4.T6.4.2.m2.1.1" stretchy="false" xref="S4.T6.4.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.4.2.m2.1c"><ci id="S4.T6.4.2.m2.1.1.cmml" xref="S4.T6.4.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.2.m2.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.4.2.m2.1e">↓</annotation></semantics></math>) means higher (lower) is better.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T6.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.8.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.8.4.5"><span class="ltx_text ltx_font_bold" id="S4.T6.8.4.5.1" style="font-size:90%;">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.5.1.1"><span class="ltx_text ltx_font_bold" id="S4.T6.5.1.1.1" style="font-size:90%;">App usage <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.5.1.1.1.m1.1"><semantics id="S4.T6.5.1.1.1.m1.1a"><mo id="S4.T6.5.1.1.1.m1.1.1" stretchy="false" xref="S4.T6.5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.5.1.1.1.m1.1b"><ci id="S4.T6.5.1.1.1.m1.1.1.cmml" xref="S4.T6.5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.5.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.6.2.2"><span class="ltx_text ltx_font_bold" id="S4.T6.6.2.2.1" style="font-size:90%;">#Play <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.6.2.2.1.m1.1"><semantics id="S4.T6.6.2.2.1.m1.1a"><mo id="S4.T6.6.2.2.1.m1.1.1" stretchy="false" xref="S4.T6.6.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.6.2.2.1.m1.1b"><ci id="S4.T6.6.2.2.1.m1.1.1.cmml" xref="S4.T6.6.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.6.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.7.3.3"><span class="ltx_text ltx_font_bold" id="S4.T6.7.3.3.1" style="font-size:90%;">#Category <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.7.3.3.1.m1.1"><semantics id="S4.T6.7.3.3.1.m1.1a"><mo id="S4.T6.7.3.3.1.m1.1.1" stretchy="false" xref="S4.T6.7.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.7.3.3.1.m1.1b"><ci id="S4.T6.7.3.3.1.m1.1.1.cmml" xref="S4.T6.7.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.7.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.7.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.8.4.4"><span class="ltx_text ltx_font_bold" id="S4.T6.8.4.4.1" style="font-size:90%;">Concentration <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.8.4.4.1.m1.1"><semantics id="S4.T6.8.4.4.1.m1.1a"><mo id="S4.T6.8.4.4.1.m1.1.1" stretchy="false" xref="S4.T6.8.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.8.4.4.1.m1.1b"><ci id="S4.T6.8.4.4.1.m1.1.1.cmml" xref="S4.T6.8.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.8.4.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.8.4.4.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.8.5.1">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T6.8.5.1.1"><span class="ltx_text" id="S4.T6.8.5.1.1.1" style="font-size:90%;">Impr. (%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T6.8.5.1.2"><span class="ltx_text" id="S4.T6.8.5.1.2.1" style="font-size:90%;">+0.300</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T6.8.5.1.3"><span class="ltx_text" id="S4.T6.8.5.1.3.1" style="font-size:90%;">+0.466</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T6.8.5.1.4"><span class="ltx_text" id="S4.T6.8.5.1.4.1" style="font-size:90%;">+0.408</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.8.5.1.5"><span class="ltx_text" id="S4.T6.8.5.1.5.1" style="font-size:90%;">-0.136</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F10.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F10.2.1.1" style="font-size:90%;">Figure 10</span>. </span><span class="ltx_text" id="S4.F10.3.2" style="font-size:90%;">Online EVTR comparison between CLSR and FRec.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Hyper-parameter Study (RQ4)</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We further investigate how key hyper-parameters impact the effectiveness of modeling user fatigue and recommendation performances. Due to the page limitations, we only report the results on the Taobao dataset. The results on the Kuaishou dataset imply the same conclusions.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p2.1.1">Kernel size</span>. As stated in subsection <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#S3.SS3" title="3.3. Fatigue-gated Recurrent Unit ‣ 3. Method ‣ Modeling User Fatigue for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>, considering consecutive items is necessary for modeling temporal fatigue. Therefore, we compare the performances under different kernel sizes of convolutions to verify whether FRec captures this pattern. As shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:ksize</span> (a), the performance is very low when kernel size is <math alttext="1" class="ltx_Math" display="inline" id="S4.SS5.p2.1.m1.1"><semantics id="S4.SS5.p2.1.m1.1a"><mn id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><cn id="S4.SS5.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS5.p2.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">1</annotation></semantics></math> and is higher with a larger size. This is direct evidence that FRec can effectively model user fatigue caused by consecutive consumption. Note that the performance also drops when the size is too large, this may be explained by users’ limited memory of historical experience.</p>
</div>
<figure class="ltx_figure" id="S4.F12.sf1">
</figure>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.1.1">Truncated threshold</span>. From the results shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:ksize</span> (b), we observe that using too short (10 items) or too long (60 items) sub-sequence both leads to worse performances. This can be attributed to the missing of critical items and the inclusion of noisy items respectively, when modeling short-term interests and temporal user fatigue. Besides, from the comparison of confidence intervals, we conclude that the proper choice of the truncated threshold assists in obtaining stable recommendation results.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">In recent years, deep learning has been widely applied to sequential recommendations, and many advanced neural networks have been utilized for modeling long and short-term interests <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib23" title="">2017</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib35" title="">2019</a>; An et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib4" title="">2019</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib24" title="">2020</a>)</cite>. Specifically, RNNs can directly capture the evolution of users’ short-term interests when encoding sequential items, including gated recurrent unit (GRU) <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib10" title="">2014</a>)</cite>, long short-term memory (LSTM) <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib18" title="">1997</a>)</cite>, <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.1">etc.</span> Similarly, CNNs have also been exploited to learn temporal patterns in historical consumption <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib36" title="">2018</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib40" title="">2019</a>; Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib41" title="">2019</a>)</cite>. In terms of long-term interests, some works rely on matrix factorization or attention mechanisms <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib23" title="">2017</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib43" title="">2019</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib24" title="">2020</a>)</cite>, which requires taking the whole sequence into consideration simultaneously. Recently, these two aspects have been disentangled for better modeling from the perspective of causal inference <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib44" title="">2022</a>)</cite>.
Many works also propose to encode users’ multiple interests by multiple representations simultaneously. In general, there are three types of modules for generating multiple interest representations, including multi-channel memory networks <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib32" title="">2019</a>; Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib27" title="">2021</a>)</cite>, dynamic routing <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib22" title="">2019</a>; Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite>, and self-attention mechanism <cite class="ltx_cite ltx_citemacro_citep">(Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib6" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Different from these works, we take user fatigue into consideration and model its influence on long and short-term interests.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>User Fatigue in Recommendation</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Modeling user fatigue has not received much attention from the academic community of the recommender system. Several existing works <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>; Aharon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib2" title="">2019</a>; Moriwaki et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib31" title="">2019</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib25" title="">2023a</a>)</cite> rely on coarse-grained features representing how similar the target item is to historical consumption, such as
how many historical items belong to the same category of the target item, <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.1">etc.</span>
Then these features are directly feeded into the base recommender (<span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.2">e.g.</span>, decision trees) <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib30" title="">2016</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib39" title="">2022</a>)</cite> or utilized for modeling fatigue by a quadratic function <cite class="ltx_cite ltx_citemacro_citep">(Moriwaki et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.11764v2#bib.bib31" title="">2019</a>)</cite>. On one hand, these methods require manual feature engineering and enough features are difficult to obtain when relevant data is missing. On the other hand, the way to model user fatigue is not carefully designed to handle complex relationships with similarity features.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In this work, we leverage fine-grained similarity features to support the modeling of user fatigue. Besides, user fatigue is also explicitly predicted based on contrastive learning.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we propose to model user fatigue in interest learning for sequential recommendations. Specifically, based on a multi-interest framework, we develop an interest-aware similarity matrix for fatigue modeling and handle its influence on long and short-term user interests. We also propose a novel sequence augmentation to obtain fatigue signals as supervision for contrastive learning. Extensive offline and online experiments demonstrate the effectiveness of our model in improving user experience and reducing user fatigue. As for future work, we will propose introducing a fatigue metric as a new dimension to explicitly measure the effectiveness of recommendations, thereby encouraging the development of fatigue modeling in recommender system research.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work is supported by the National Natural Science Foundation of China under U23B2030, 62272262, and 72342032. This work is supported by a grant from the Guoqiang Institute, Tsinghua University under 2021GQG1005. This work is also supported by Kuaishou.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aharon et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Michal Aharon, Yohay Kaplan, Rina Levy, Oren Somekh, Ayelet Blanc, Neetai Eshel, Avi Shahar, Assaf Singer, and Alex Zlotnik. 2019.

</span>
<span class="ltx_bibblock">Soft frequency capping for improved ad click prediction in yahoo gemini native. In <span class="ltx_text ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</span>. 2793–2801.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alhijawi et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Bushra Alhijawi, Arafat Awajan, and Salam Fraihat. 2022.

</span>
<span class="ltx_bibblock">Survey on the objectives of recommender systems: Measures, solutions, evaluation methodology, and new perspectives.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.3.1">Comput. Surveys</span> 55, 5 (2022), 1–38.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">An et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Mingxiao An, Fangzhao Wu, Chuhan Wu, Kun Zhang, Zheng Liu, and Xing Xie. 2019.

</span>
<span class="ltx_bibblock">Neural news recommendation with long-and short-term user representations. In <span class="ltx_text ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</span>. 336–345.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Shaojie Bai, J Zico Kolter, and Vladlen Koltun. 2018.

</span>
<span class="ltx_bibblock">An empirical evaluation of generic convolutional and recurrent networks for sequence modeling.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.3.1">arXiv preprint arXiv:1803.01271</span> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yukuo Cen, Jianwei Zhang, Xu Zou, Chang Zhou, Hongxia Yang, and Jie Tang. 2020.

</span>
<span class="ltx_bibblock">Controllable multi-interest framework for recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib6.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span>. 2942–2951.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chen Gao, Yu Zheng, Yiqun Hui, Yanan Niu, Yang Song, Depeng Jin, and Yong Li. 2021.

</span>
<span class="ltx_bibblock">Sequential Recommendation with Graph Neural Networks. In <span class="ltx_text ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>. 378–387.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Zhiwei Liu, Jia Li, Julian McAuley, and Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Intent contrastive learning for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib8.3.1">Proceedings of the ACM Web Conference 2022</span>. 2172–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib9.3.3.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, et al<span class="ltx_text" id="bib.bib9.4.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Wide &amp; deep learning for recommender systems. In <span class="ltx_text ltx_font_italic" id="bib.bib9.5.1">Proceedings of the 1st workshop on deep learning for recommender systems</span>. 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Kyunghyun Cho, Bart Van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, and Yoshua Bengio. 2014.

</span>
<span class="ltx_bibblock">Learning phrase representations using RNN encoder-decoder for statistical machine translation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.3.1">arXiv preprint arXiv:1406.1078</span> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jingtao Ding, Yuhan Quan, Xiangnan He, Yong Li, and Depeng Jin. 2019.

</span>
<span class="ltx_bibblock">Reinforced Negative Sampling for Recommendation with Exposure Data.. In <span class="ltx_text ltx_font_italic" id="bib.bib11.3.1">IJCAI</span>. Macao, 2230–2236.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jingtao Ding, Yuhan Quan, Quanming Yao, Yong Li, and Depeng Jin. 2020.

</span>
<span class="ltx_bibblock">Simplify and robustify negative sampling for implicit collaborative filtering.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.3.1">Advances in Neural Information Processing Systems</span> 33 (2020), 1094–1105.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhe Fu, Xi Niu, and Mary Lou Maher. 2023.

</span>
<span class="ltx_bibblock">Deep learning models for serendipity recommendations: a survey and new perspectives.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.3.1">Comput. Surveys</span> 56, 1 (2023), 1–26.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chen Gao, Yu Zheng, Wenjie Wang, Fuli Feng, Xiangnan He, and Yong Li. 2024.

</span>
<span class="ltx_bibblock">Causal inference in recommender systems: A survey and future directions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.3.1">ACM Transactions on Information Systems</span> 42, 4 (2024), 1–32.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: a factorization-machine based neural network for CTR prediction.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:1703.04247</span> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamilton et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Will Hamilton, Zhitao Ying, and Jure Leskovec. 2017.

</span>
<span class="ltx_bibblock">Inductive representation learning on large graphs.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.3.1">Advances in neural information processing systems</span> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.3.1">arXiv preprint arXiv:1511.06939</span> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber. 1997.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Neural computation</span> 9, 8 (1997), 1735–1780.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Juyong Jiang, Peiyan Zhang, Yingtao Luo, Chaozhuo Li, Jae Boum Kim, Kai Zhang, Senzhang Wang, Xing Xie, and Sunghun Kim. 2023.

</span>
<span class="ltx_bibblock">AdaMCT: adaptive mixture of CNN-transformer for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</span>. 976–986.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">2018 IEEE International Conference on Data Mining (ICDM)</span>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:1412.6980</span> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chao Li, Zhiyuan Liu, Mengmeng Wu, Yuchi Xu, Huan Zhao, Pipei Huang, Guoliang Kang, Qiwei Chen, Wei Li, and Dik Lun Lee. 2019.

</span>
<span class="ltx_bibblock">Multi-interest network with dynamic routing for recommendation at Tmall. In <span class="ltx_text ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</span>. 2615–2623.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jing Li, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Tao Lian, and Jun Ma. 2017.

</span>
<span class="ltx_bibblock">Neural attentive session-based recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management</span>. 1419–1428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiacheng Li, Yujie Wang, and Julian McAuley. 2020.

</span>
<span class="ltx_bibblock">Time interval aware self-attention for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib24.3.1">Proceedings of the 13th international conference on web search and data mining</span>. 322–330.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Ming Li, Naiyin Liu, Xiaofeng Pan, Yang Huang, Ningning Li, Yingmin Su, Chengjun Mao, and Bo Cao. 2023a.

</span>
<span class="ltx_bibblock">FAN: Fatigue-Aware Network for Click-Through Rate Prediction in E-commerce Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib25.3.1">Database Systems for Advanced Applications: 28th International Conference, DASFAA 2023, Tianjin, China, April 17–20, 2023, Proceedings, Part IV</span>. Springer, 502–514.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xuewei Li, Aitong Sun, Mankun Zhao, Jian Yu, Kun Zhu, Di Jin, Mei Yu, and Ruiguo Yu. 2023b.

</span>
<span class="ltx_bibblock">Multi-Intention Oriented Contrastive Learning for Sequential Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib26.3.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</span>. 411–419.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianxun Lian, Iyad Batal, Zheng Liu, Akshay Soni, Eun Yong Kang, Yajun Wang, and Xing Xie. 2021.

</span>
<span class="ltx_bibblock">Multi-Interest-Aware User Modeling for Large-Scale Sequential Recommendations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.3.1">arXiv preprint arXiv:2102.09211</span> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Guanyu Lin, Chen Gao, Yinfeng Li, Yu Zheng, Zhiheng Li, Depeng Jin, and Yong Li. 2022.

</span>
<span class="ltx_bibblock">Dual contrastive network for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</span>. 2686–2691.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Zhouhan Lin, Minwei Feng, Cicero Nogueira dos Santos, Mo Yu, Bing Xiang, Bowen Zhou, and Yoshua Bengio. 2017.

</span>
<span class="ltx_bibblock">A structured self-attentive sentence embedding.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:1703.03130</span> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Hao Ma, Xueqing Liu, and Zhihong Shen. 2016.

</span>
<span class="ltx_bibblock">User fatigue in online news recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib30.3.1">Proceedings of the 25th International Conference on World Wide Web</span>. 1363–1372.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moriwaki et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Daisuke Moriwaki, Komei Fujita, Shota Yasui, and Takahiro Hoshino. 2019.

</span>
<span class="ltx_bibblock">Fatigue-Aware Ad Creative Selection.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:1908.08936</span> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qi Pi, Weijie Bian, Guorui Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Practice on long sequential user behavior modeling for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span>. 2671–2679.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quan et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Yuhan Quan, Jingtao Ding, Chen Gao, Nian Li, Lingling Yi, Depeng Jin, and Yong Li. 2023a.

</span>
<span class="ltx_bibblock">Alleviating Video-length Effect for Micro-video Recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.3.1">ACM Transactions on Information Systems</span> 42, 2 (2023), 1–24.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quan et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yuhan Quan, Jingtao Ding, Chen Gao, Lingling Yi, Depeng Jin, and Yong Li. 2023b.

</span>
<span class="ltx_bibblock">Robust preference-guided denoising for graph based social recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib34.3.1">Proceedings of the ACM Web Conference 2023</span>. 1097–1108.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <span class="ltx_text ltx_font_italic" id="bib.bib35.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</span>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via convolutional sequence embedding. In <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Eleventh ACM International Conference on Web Search and Data Mining</span>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yu Tian, Jianxin Chang, Yanan Niu, Yang Song, and Chenliang Li. 2022.

</span>
<span class="ltx_bibblock">When multi-level meets multi-interest: A multi-grained neural model for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib37.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>. 1632–1641.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; cross network for ad click predictions.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib38.3.1">Proceedings of the ADKDD’17</span>. 1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ruobing Xie, Cheng Ling, Shaoliang Zhang, Feng Xia, and Leyu Lin. 2022.

</span>
<span class="ltx_bibblock">Multi-granularity Fatigue in Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</span>. 4595–4599.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chengfeng Xu, Pengpeng Zhao, Yanchi Liu, Jiajie Xu, Victor S Sheng S. Sheng, Zhiming Cui, Xiaofang Zhou, and Hui Xiong. 2019.

</span>
<span class="ltx_bibblock">Recurrent convolutional neural network for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib40.3.1">The world wide web conference</span>. 3398–3404.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
An Yan, Shuo Cheng, Wang-Cheng Kang, Mengting Wan, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">CosRec: 2D convolutional neural networks for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</span>. 2173–2176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Junliang Yu, Hongzhi Yin, Xin Xia, Tong Chen, Jundong Li, and Zi Huang. 2022.

</span>
<span class="ltx_bibblock">Self-supervised learning for recommender systems: A survey.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib42.3.1">arXiv preprint arXiv:2203.15876</span> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Zeping Yu, Jianxun Lian, Ahmad Mahmoody, Gongshen Liu, and Xing Xie. 2019.

</span>
<span class="ltx_bibblock">Adaptive User Modeling with Long and Short-Term Preferences for Personalized Recommendation.. In <span class="ltx_text ltx_font_italic" id="bib.bib43.3.1">IJCAI</span>. 4213–4219.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yu Zheng, Chen Gao, Jianxin Chang, Yanan Niu, Yang Song, Depeng Jin, and Yong Li. 2022.

</span>
<span class="ltx_bibblock">Disentangling long and short-term interests for recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib44.3.1">Proceedings of the ACM Web Conference 2022</span>. 2256–2267.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep interest evolution network for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib45.3.1">Proceedings of the AAAI conference on artificial intelligence</span>, Vol. 33. 5941–5948.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib46.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri May 24 16:55:12 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
