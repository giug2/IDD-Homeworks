<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.11203] 1 INTRODUCTION</title><meta property="og:description" content="We introduce a novel strategy to train randomised predictors in federated learning, where each node of the network aims at preserving its privacy by releasing a local predictor but keeping secret its training dataset w…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 INTRODUCTION">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="1 INTRODUCTION">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.11203">

<!--Generated on Tue Feb 27 23:50:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:4.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="p3" class="ltx_para ltx_noindent ltx_align_center">
<p id="p3.1" class="ltx_p"><span id="p3.1.1" class="ltx_text ltx_font_bold">Federated Learning with Nonvacuous Generalisation Bounds</span></p>
</div>
<div id="p4" class="ltx_para">
<br class="ltx_break">
<p id="p4.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="p5" class="ltx_para ltx_noindent">
<br class="ltx_break">
</div>
<div id="p6" class="ltx_para ltx_noindent">
<p id="p6.1" class="ltx_p"><span id="p6.1.1" class="ltx_text ltx_inline-block" style="width:487.8pt;"><span id="p6.1.1.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p6.1.1.1.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p6.1.1.1.1.1.1" class="ltx_tr">
<span id="p6.1.1.1.1.1.1.1" class="ltx_td ltx_align_center"><span id="p6.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Pierre Jobic</span></span></span>
</span>
</span></span>                      <span id="p6.1.1.2" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p6.1.1.2.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p6.1.1.2.1.1.1" class="ltx_tr">
<span id="p6.1.1.2.1.1.1.1" class="ltx_td ltx_align_center"><span id="p6.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold">Maxime Haddouche</span></span></span>
</span>
</span></span>                      <span id="p6.1.1.3" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p6.1.1.3.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p6.1.1.3.1.1.1" class="ltx_tr">
<span id="p6.1.1.3.1.1.1.1" class="ltx_td ltx_align_center"><span id="p6.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Benjamin Guedj</span></span></span>
</span>
</span>
</span>  </span></p>
</div>
<div id="p7" class="ltx_para">
<p id="p7.1" class="ltx_p"><span id="p7.1.1" class="ltx_text ltx_inline-block" style="width:487.8pt;"><span id="p7.1.1.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p7.1.1.1.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p7.1.1.1.1.1.1" class="ltx_tr">
<span id="p7.1.1.1.1.1.1.1" class="ltx_td ltx_align_center">CEA, List</span></span>
<span id="p7.1.1.1.1.2.2" class="ltx_tr">
<span id="p7.1.1.1.1.2.2.1" class="ltx_td ltx_align_center">Université Paris-Saclay</span></span>
</span>
</span></span>                      <span id="p7.1.1.2" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p7.1.1.2.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p7.1.1.2.1.1.1" class="ltx_tr">
<span id="p7.1.1.2.1.1.1.1" class="ltx_td ltx_align_center">Inria</span></span>
<span id="p7.1.1.2.1.2.2" class="ltx_tr">
<span id="p7.1.1.2.1.2.2.1" class="ltx_td ltx_align_center">University College London</span></span>
<span id="p7.1.1.2.1.3.3" class="ltx_tr">
<span id="p7.1.1.2.1.3.3.1" class="ltx_td ltx_align_center">Université de Lille</span></span>
</span>
</span></span>                      <span id="p7.1.1.3" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p7.1.1.3.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p7.1.1.3.1.1.1" class="ltx_tr">
<span id="p7.1.1.3.1.1.1.1" class="ltx_td ltx_align_center">Inria</span></span>
<span id="p7.1.1.3.1.2.2" class="ltx_tr">
<span id="p7.1.1.3.1.2.2.1" class="ltx_td ltx_align_center">University College London</span></span>
</span>
</span>
</span>  </span></p>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">We introduce a novel strategy to train randomised predictors in federated learning, where each node of the network aims at preserving its privacy by releasing a local predictor but keeping secret its training dataset with respect to the other nodes.
We then build a global randomised predictor which inherits the properties of the local private predictors in the sense of a PAC-Bayesian generalisation bound. We consider the synchronous case where all nodes share the same training objective (derived from a generalisation bound), and the asynchronous case where each node may have its own personalised training objective. We show through a series of numerical experiments that our approach achieves a comparable predictive performance to that of the batch approach where all datasets are shared across nodes. Moreover the predictors are supported by numerically nonvacuous generalisation bounds while preserving privacy for each node. We explicitly compute the increment on predictive performance and generalisation bounds between batch and federated settings, highlighting the price to pay to preserve privacy.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>INTRODUCTION</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">In the federated learning (FL) paradigm, a group of <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">users</em> (or nodes) is learning in parallel, and typically aims at preserving their personal datasets while sharing a common predictor. While maintaining the privacy of their own data, users mutually share information through a central <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">server</em>. There has been a significant surge of interest in federated learning in the past decade <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib31" title="" class="ltx_ref">Konečný et al., 2016b, </a>)</cite>, with clear applications in healthcare, transportation and retail, where it is typically of the utmost interest to avoid the leak of private information to other organisations or devices, for ethical or business motivations. The existing literature essentially categorises <em id="S1.p1.1.3" class="ltx_emph ltx_font_italic">horizontal</em> and <em id="S1.p1.1.4" class="ltx_emph ltx_font_italic">vertical</em> FL, depending on whether users’ datasets share many features or individuals. These two streams have generated various contributions such as the design of efficient communication
strategies <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib30" title="" class="ltx_ref">Konečný et al., 2016a, </a>; <a href="#bib.bib31" title="" class="ltx_ref">Konečný et al., 2016b, </a>; Suresh et al.,, <a href="#bib.bib58" title="" class="ltx_ref">2017</a>)</cite>, the preservation of privacy through
differentially-private distributed optimization methods <cite class="ltx_cite ltx_citemacro_citep">(Agarwal et al.,, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, the enforcement of fairness (as in many cases, post-training learning models may be biased or
unfair and may discriminate against some protected groups – <cite class="ltx_cite ltx_citemacro_citep">Hardt et al.,, <a href="#bib.bib24" title="" class="ltx_ref">2016</a>; Mohri et al.,, <a href="#bib.bib43" title="" class="ltx_ref">2019</a></cite>). We refer to <cite class="ltx_cite ltx_citemacro_citet">Zhang et al., (<a href="#bib.bib68" title="" class="ltx_ref">2021</a>); Mammen, (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>); Kairouz et al., (<a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> for recent surveys on FL.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Consider a simple federated learning framework <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al.,, <a href="#bib.bib10" title="" class="ltx_ref">2017</a>; <a href="#bib.bib41" title="" class="ltx_ref">McMahan et al., 2017b, </a>)</cite>. In each round, the server first provides the
initial model to each user, then each user updates the initial model with its personal data. Finally, the server aggregates the collected local
models into a single global model, which is used as next round’s initialisation if needed. Hereafter we will refer to this learning problem as <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">FL-SOB</em> (Federated Learning with Synchronous OBjectives). This is especially relevant when all users share a common learning goal (<span id="S1.p2.1.2" class="ltx_text ltx_font_italic">e.g.</span>, hospitals learning from different datasets to identify or predict a specific single pathology). Deep neural networks have been used to develop powerful federated algorithms <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib40" title="" class="ltx_ref">McMahan et al., 2017a, </a>)</cite>.
A more complex scenario consists in <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">personalised FL</em> (<em id="S1.p2.1.4" class="ltx_emph ltx_font_italic">PFL</em>, <cite class="ltx_cite ltx_citemacro_citep">Tan et al.,, <a href="#bib.bib59" title="" class="ltx_ref">2022</a></cite>) where users may have their own distinct learning goal but still want to share joint information as these goals share some level of similarity. This corresponds, for instance, to <em id="S1.p2.1.5" class="ltx_emph ltx_font_italic">transfer learning</em> (see <span id="S1.p2.1.6" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">Zhuang et al.,, <a href="#bib.bib73" title="" class="ltx_ref">2021</a></cite>) situations where one wants to extract some information of a learning problem (<span id="S1.p2.1.7" class="ltx_text ltx_font_italic">e.g.</span>, detecting tigers in images) to perform better on another one, sharing some similarities (<span id="S1.p2.1.8" class="ltx_text ltx_font_italic">e.g.</span>, detecting cats).</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Towards a unified framework.</span> The recent PAC-FL framework of <cite class="ltx_cite ltx_citemacro_citet"><a href="#bib.bib71" title="" class="ltx_ref">Zhang et al., 2023b </a></cite> proposes a unified framework to formalise FL, intricating the notion of generalisation ability (designed as utility) alongside privacy, and quantifying how much data are protected (<span id="S1.p3.1.2" class="ltx_text ltx_font_italic">i.e.</span> impossible to retrieve) while transmitting partial information to the server.
This framework builds from the work of <cite class="ltx_cite ltx_citemacro_citet">Zhang et al., (<a href="#bib.bib69" title="" class="ltx_ref">2019</a>)</cite> investigating the tradeoffs between privacy, utility and efficiency. The question of an optimal trade-off is crucial to deploy the FL framework in practice <cite class="ltx_cite ltx_citemacro_citep">(Tsipras et al.,, <a href="#bib.bib61" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">On the place of generalisation in FL.</span> Using their PAC-FL framework, <cite class="ltx_cite ltx_citemacro_citet"><a href="#bib.bib71" title="" class="ltx_ref">Zhang et al., 2023b </a></cite> proposed generalisation bounds involving the dimension of the predictor space. The question of generalisation in FL is central: <cite class="ltx_cite ltx_citemacro_citet">Mohri et al., (<a href="#bib.bib43" title="" class="ltx_ref">2019</a>); <a href="#bib.bib70" title="" class="ltx_ref">Zhang et al., 2023a </a></cite> established Rademacher-based generalisation bounds, <cite class="ltx_cite ltx_citemacro_citet">Yagli et al., (<a href="#bib.bib64" title="" class="ltx_ref">2020</a>)</cite> provided bounds based on mutual information to explain both generalisation ability and privacy leakage per user. Bayesian methods have also been considered in FL-SOB <cite class="ltx_cite ltx_citemacro_citep">(Yurochkin et al.,, <a href="#bib.bib66" title="" class="ltx_ref">2019</a>; Chen and Chao,, <a href="#bib.bib13" title="" class="ltx_ref">2021</a>; Zhang et al.,, <a href="#bib.bib72" title="" class="ltx_ref">2022</a>)</cite> as well as in PFL <cite class="ltx_cite ltx_citemacro_citep">(Kotelevskii et al.,, <a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p"><span id="S1.p5.1.1" class="ltx_text ltx_font_bold">PAC-Bayes learning in FL.</span> Beyond Bayesian methods, PAC-Bayes learning (see the seminal works of <cite class="ltx_cite ltx_citemacro_citep">Shawe-Taylor and Williamson,, <a href="#bib.bib57" title="" class="ltx_ref">1997</a>; McAllester,, <a href="#bib.bib38" title="" class="ltx_ref">1998</a>, <a href="#bib.bib39" title="" class="ltx_ref">2003</a>; Maurer,, <a href="#bib.bib37" title="" class="ltx_ref">2004</a></cite> – we refer to the surveys of <cite class="ltx_cite ltx_citemacro_citep">Guedj,, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Alquier,, <a href="#bib.bib3" title="" class="ltx_ref">2021</a></cite>, and to the recent monograph of <cite class="ltx_cite ltx_citemacro_citep">Hellström et al.,, <a href="#bib.bib25" title="" class="ltx_ref">2023</a></cite>) has recently re-emerged as a powerful framework in batch learning to explain the generalisation ability of neural nets by providing non-vacuous generalisation bounds <cite class="ltx_cite ltx_citemacro_citep">(Dziugaite and Roy,, <a href="#bib.bib18" title="" class="ltx_ref">2017</a>; Letarte et al.,, <a href="#bib.bib34" title="" class="ltx_ref">2019</a>; Pérez-Ortiz et al.,, <a href="#bib.bib47" title="" class="ltx_ref">2021</a>; Biggs and Guedj,, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite>. PAC-Bayes combines information-theoretic tools with the Bayesian paradigm of generating a data-dependent <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">posterior</em>
distribution over a predictor space from a <em id="S1.p5.1.3" class="ltx_emph ltx_font_italic">prior</em> distribution (or reference measure), usually data-independent. The flexibility of the PAC-Bayes framework makes it useful to explain generalisation in many learning settings. In particular, theoretical results and practical algorithms have been derived for various learning problems such as reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Fard and Pineau,, <a href="#bib.bib19" title="" class="ltx_ref">2010</a>)</cite>, online learning <cite class="ltx_cite ltx_citemacro_citep">(Li et al.,, <a href="#bib.bib35" title="" class="ltx_ref">2018</a>; Haddouche and Guedj,, <a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite>, constrative learning <cite class="ltx_cite ltx_citemacro_citep">(Nozawa et al.,, <a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>, generative models <cite class="ltx_cite ltx_citemacro_citep">(Chérief-Abdellatif et al.,, <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, multi-armed bandits <cite class="ltx_cite ltx_citemacro_citep">(Seldin et al.,, <a href="#bib.bib56" title="" class="ltx_ref">2011</a>, <a href="#bib.bib55" title="" class="ltx_ref">2012</a>; Sakhi et al.,, <a href="#bib.bib52" title="" class="ltx_ref">2022</a>)</cite>, meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Amit and Meir,, <a href="#bib.bib5" title="" class="ltx_ref">2018</a>; Farid and Majumdar,, <a href="#bib.bib20" title="" class="ltx_ref">2021</a>; Rothfuss et al.,, <a href="#bib.bib50" title="" class="ltx_ref">2021</a>, <a href="#bib.bib51" title="" class="ltx_ref">2022</a>; Ding et al.,, <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>, majority votes <cite class="ltx_cite ltx_citemacro_citep">(Zantedeschi et al.,, <a href="#bib.bib67" title="" class="ltx_ref">2021</a>; Biggs et al.,, <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> to name but a few.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Recently, some works have used the PAC-Bayes framework in FL: <cite class="ltx_cite ltx_citemacro_citet">Reisizadeh et al., (<a href="#bib.bib48" title="" class="ltx_ref">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Achituve et al., (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> have evaluated the post-training predictor shared by all users through a PAC-Bayes bound. Rather than exploiting existing bounds, new PAC-Bayes results, tailored for personalised FL, recently emerged with the aim to explain the efficiency of learning procedures <cite class="ltx_cite ltx_citemacro_citep">(Scott et al.,, <a href="#bib.bib53" title="" class="ltx_ref">2023</a>; Sefidgaran et al.,, <a href="#bib.bib54" title="" class="ltx_ref">2023</a>)</cite>, although the PAC-Bayes bound is not minimised by the algorithm. Finally, recent works showed that the Bayesian procedure ELBO, adapted to FL, is exactly the minimisation of a PAC-Bayes upper bound <cite class="ltx_cite ltx_citemacro_citep">(Kim and Hospedales,, <a href="#bib.bib28" title="" class="ltx_ref">2023</a>; Vedadi et al.,, <a href="#bib.bib62" title="" class="ltx_ref">2023</a>)</cite>. Thus, they show that those methods are well incorporated in a theoretical framework explaining their good generalisation ability.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold">Our contributions.</span> Beyond being a safety check for generalisation, PAC-Bayes theory provides state-of-the art learning algorithms with tight generalisation guarantees in the batch setting.
We adapt those algorithms to the FL-SOB and PFL settings. We propose <span id="S1.p7.1.2" class="ltx_text ltx_font_smallcaps">GenFL</span> (standing for Generalisation-driven Federated Learning),
an algorithm in which users optimise local PAC-Bayes objectives (bounds from <cite class="ltx_cite ltx_citemacro_citep">Dziugaite and Roy,, <a href="#bib.bib18" title="" class="ltx_ref">2017</a>; Pérez-Ortiz et al.,, <a href="#bib.bib47" title="" class="ltx_ref">2021</a></cite>).
We show a global generalisation bound for all users in FL-SOB, and local ones in PFL.
Finally, we show in numerical experiments that our procedure is competitive with the state-of-the-art and we bring nonvacuous generalisation guarantees to practitioners of federated learning.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p"><span id="S1.p8.1.1" class="ltx_text ltx_font_bold">Outline.</span> We describe our notation in <a href="#S2" title="2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a> and introduce in <a href="#S3" title="3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a> a novel algorithm called <span id="S1.p8.1.2" class="ltx_text ltx_font_smallcaps">GenFL</span>, alongside two instantiations to FL-SOB and PFL. We present numerical experiments to support our methods. in <a href="#S4" title="4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>. Our algorithms and the code used to generate figures in this paper is available at <a target="_blank" href="https://anonymous.4open.science/r/GenFL-010C/README.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://anonymous.4open.science/r/GenFL-010C/README.md</a>. The paper closes with a discussion in <a href="#S5" title="5 DISCUSSION" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">5</span></a>.
In <a href="#A1" title="Appendix A Approximating the inverted 𝑘⁢𝑙" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>, we comment on strategies to compute PAC-Bayesian bounds, <a href="#A2" title="Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a> contains a comprehensive description of our procedure in the PFL setting, and <a href="#A3" title="Appendix C Additional experiments" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">C</span></a> provides additional experiments.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>BACKGROUND</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.17" class="ltx_p"><span id="S2.p1.17.1" class="ltx_text ltx_font_bold">Federated learning.</span> We consider a predictor set <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{H}</annotation></semantics></math>, a data space <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathcal{Z}</annotation></semantics></math> and denote the space of distributions over <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{H}</annotation></semantics></math>, <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{M}(\mathcal{H})" display="inline"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.2" xref="S2.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.2.2" xref="S2.p1.4.m4.1.2.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="S2.p1.4.m4.1.2.1" xref="S2.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S2.p1.4.m4.1.2.3.2" xref="S2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S2.p1.4.m4.1.2.3.2.1" xref="S2.p1.4.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">ℋ</mi><mo stretchy="false" id="S2.p1.4.m4.1.2.3.2.2" xref="S2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.2.cmml" xref="S2.p1.4.m4.1.2"><times id="S2.p1.4.m4.1.2.1.cmml" xref="S2.p1.4.m4.1.2.1"></times><ci id="S2.p1.4.m4.1.2.2.cmml" xref="S2.p1.4.m4.1.2.2">ℳ</ci><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\mathcal{M}(\mathcal{H})</annotation></semantics></math>. We let <math id="S2.p1.5.m5.2" class="ltx_Math" alttext="\ell\colon\mathcal{H}\times\mathcal{Z}\rightarrow[0,1]" display="inline"><semantics id="S2.p1.5.m5.2a"><mrow id="S2.p1.5.m5.2.3" xref="S2.p1.5.m5.2.3.cmml"><mi mathvariant="normal" id="S2.p1.5.m5.2.3.2" xref="S2.p1.5.m5.2.3.2.cmml">ℓ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.p1.5.m5.2.3.1" xref="S2.p1.5.m5.2.3.1.cmml">:</mo><mrow id="S2.p1.5.m5.2.3.3" xref="S2.p1.5.m5.2.3.3.cmml"><mrow id="S2.p1.5.m5.2.3.3.2" xref="S2.p1.5.m5.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.2.3.3.2.2" xref="S2.p1.5.m5.2.3.3.2.2.cmml">ℋ</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.5.m5.2.3.3.2.1" xref="S2.p1.5.m5.2.3.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.2.3.3.2.3" xref="S2.p1.5.m5.2.3.3.2.3.cmml">𝒵</mi></mrow><mo stretchy="false" id="S2.p1.5.m5.2.3.3.1" xref="S2.p1.5.m5.2.3.3.1.cmml">→</mo><mrow id="S2.p1.5.m5.2.3.3.3.2" xref="S2.p1.5.m5.2.3.3.3.1.cmml"><mo stretchy="false" id="S2.p1.5.m5.2.3.3.3.2.1" xref="S2.p1.5.m5.2.3.3.3.1.cmml">[</mo><mn id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">0</mn><mo id="S2.p1.5.m5.2.3.3.3.2.2" xref="S2.p1.5.m5.2.3.3.3.1.cmml">,</mo><mn id="S2.p1.5.m5.2.2" xref="S2.p1.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S2.p1.5.m5.2.3.3.3.2.3" xref="S2.p1.5.m5.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.2b"><apply id="S2.p1.5.m5.2.3.cmml" xref="S2.p1.5.m5.2.3"><ci id="S2.p1.5.m5.2.3.1.cmml" xref="S2.p1.5.m5.2.3.1">:</ci><ci id="S2.p1.5.m5.2.3.2.cmml" xref="S2.p1.5.m5.2.3.2">ℓ</ci><apply id="S2.p1.5.m5.2.3.3.cmml" xref="S2.p1.5.m5.2.3.3"><ci id="S2.p1.5.m5.2.3.3.1.cmml" xref="S2.p1.5.m5.2.3.3.1">→</ci><apply id="S2.p1.5.m5.2.3.3.2.cmml" xref="S2.p1.5.m5.2.3.3.2"><times id="S2.p1.5.m5.2.3.3.2.1.cmml" xref="S2.p1.5.m5.2.3.3.2.1"></times><ci id="S2.p1.5.m5.2.3.3.2.2.cmml" xref="S2.p1.5.m5.2.3.3.2.2">ℋ</ci><ci id="S2.p1.5.m5.2.3.3.2.3.cmml" xref="S2.p1.5.m5.2.3.3.2.3">𝒵</ci></apply><interval closure="closed" id="S2.p1.5.m5.2.3.3.3.1.cmml" xref="S2.p1.5.m5.2.3.3.3.2"><cn type="integer" id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">0</cn><cn type="integer" id="S2.p1.5.m5.2.2.cmml" xref="S2.p1.5.m5.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.2c">\ell\colon\mathcal{H}\times\mathcal{Z}\rightarrow[0,1]</annotation></semantics></math> denote a loss function.
In FL, we consider an ensemble of <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="K\in\mathbb{N}^{*}" display="inline"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">K</mi><mo id="S2.p1.6.m6.1.1.1" xref="S2.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.3.2" xref="S2.p1.6.m6.1.1.3.2.cmml">ℕ</mi><mo id="S2.p1.6.m6.1.1.3.3" xref="S2.p1.6.m6.1.1.3.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><in id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1"></in><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝐾</ci><apply id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.3">superscript</csymbol><ci id="S2.p1.6.m6.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.3.2">ℕ</ci><times id="S2.p1.6.m6.1.1.3.3.cmml" xref="S2.p1.6.m6.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">K\in\mathbb{N}^{*}</annotation></semantics></math> users, and for each user <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="1\leq i\leq K" display="inline"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mn id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">1</mn><mo id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">≤</mo><mi id="S2.p1.7.m7.1.1.4" xref="S2.p1.7.m7.1.1.4.cmml">i</mi><mo id="S2.p1.7.m7.1.1.5" xref="S2.p1.7.m7.1.1.5.cmml">≤</mo><mi id="S2.p1.7.m7.1.1.6" xref="S2.p1.7.m7.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><and id="S2.p1.7.m7.1.1a.cmml" xref="S2.p1.7.m7.1.1"></and><apply id="S2.p1.7.m7.1.1b.cmml" xref="S2.p1.7.m7.1.1"><leq id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3"></leq><cn type="integer" id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">1</cn><ci id="S2.p1.7.m7.1.1.4.cmml" xref="S2.p1.7.m7.1.1.4">𝑖</ci></apply><apply id="S2.p1.7.m7.1.1c.cmml" xref="S2.p1.7.m7.1.1"><leq id="S2.p1.7.m7.1.1.5.cmml" xref="S2.p1.7.m7.1.1.5"></leq><share href="#S2.p1.7.m7.1.1.4.cmml" id="S2.p1.7.m7.1.1d.cmml" xref="S2.p1.7.m7.1.1"></share><ci id="S2.p1.7.m7.1.1.6.cmml" xref="S2.p1.7.m7.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">1\leq i\leq K</annotation></semantics></math>, we denote by <math id="S2.p1.8.m8.3" class="ltx_Math" alttext="\mathcal{S}_{i}=(\mathbf{z}_{i,j})_{j=1\cdots m_{i}}" display="inline"><semantics id="S2.p1.8.m8.3a"><mrow id="S2.p1.8.m8.3.3" xref="S2.p1.8.m8.3.3.cmml"><msub id="S2.p1.8.m8.3.3.3" xref="S2.p1.8.m8.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.8.m8.3.3.3.2" xref="S2.p1.8.m8.3.3.3.2.cmml">𝒮</mi><mi id="S2.p1.8.m8.3.3.3.3" xref="S2.p1.8.m8.3.3.3.3.cmml">i</mi></msub><mo id="S2.p1.8.m8.3.3.2" xref="S2.p1.8.m8.3.3.2.cmml">=</mo><msub id="S2.p1.8.m8.3.3.1" xref="S2.p1.8.m8.3.3.1.cmml"><mrow id="S2.p1.8.m8.3.3.1.1.1" xref="S2.p1.8.m8.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.p1.8.m8.3.3.1.1.1.2" xref="S2.p1.8.m8.3.3.1.1.1.1.cmml">(</mo><msub id="S2.p1.8.m8.3.3.1.1.1.1" xref="S2.p1.8.m8.3.3.1.1.1.1.cmml"><mi id="S2.p1.8.m8.3.3.1.1.1.1.2" xref="S2.p1.8.m8.3.3.1.1.1.1.2.cmml">𝐳</mi><mrow id="S2.p1.8.m8.2.2.2.4" xref="S2.p1.8.m8.2.2.2.3.cmml"><mi id="S2.p1.8.m8.1.1.1.1" xref="S2.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S2.p1.8.m8.2.2.2.4.1" xref="S2.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S2.p1.8.m8.2.2.2.2" xref="S2.p1.8.m8.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S2.p1.8.m8.3.3.1.1.1.3" xref="S2.p1.8.m8.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="S2.p1.8.m8.3.3.1.3" xref="S2.p1.8.m8.3.3.1.3.cmml"><mi id="S2.p1.8.m8.3.3.1.3.2" xref="S2.p1.8.m8.3.3.1.3.2.cmml">j</mi><mo id="S2.p1.8.m8.3.3.1.3.1" xref="S2.p1.8.m8.3.3.1.3.1.cmml">=</mo><mrow id="S2.p1.8.m8.3.3.1.3.3" xref="S2.p1.8.m8.3.3.1.3.3.cmml"><mn id="S2.p1.8.m8.3.3.1.3.3.2" xref="S2.p1.8.m8.3.3.1.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S2.p1.8.m8.3.3.1.3.3.1" xref="S2.p1.8.m8.3.3.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.p1.8.m8.3.3.1.3.3.3" xref="S2.p1.8.m8.3.3.1.3.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S2.p1.8.m8.3.3.1.3.3.1a" xref="S2.p1.8.m8.3.3.1.3.3.1.cmml">​</mo><msub id="S2.p1.8.m8.3.3.1.3.3.4" xref="S2.p1.8.m8.3.3.1.3.3.4.cmml"><mi id="S2.p1.8.m8.3.3.1.3.3.4.2" xref="S2.p1.8.m8.3.3.1.3.3.4.2.cmml">m</mi><mi id="S2.p1.8.m8.3.3.1.3.3.4.3" xref="S2.p1.8.m8.3.3.1.3.3.4.3.cmml">i</mi></msub></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.3b"><apply id="S2.p1.8.m8.3.3.cmml" xref="S2.p1.8.m8.3.3"><eq id="S2.p1.8.m8.3.3.2.cmml" xref="S2.p1.8.m8.3.3.2"></eq><apply id="S2.p1.8.m8.3.3.3.cmml" xref="S2.p1.8.m8.3.3.3"><csymbol cd="ambiguous" id="S2.p1.8.m8.3.3.3.1.cmml" xref="S2.p1.8.m8.3.3.3">subscript</csymbol><ci id="S2.p1.8.m8.3.3.3.2.cmml" xref="S2.p1.8.m8.3.3.3.2">𝒮</ci><ci id="S2.p1.8.m8.3.3.3.3.cmml" xref="S2.p1.8.m8.3.3.3.3">𝑖</ci></apply><apply id="S2.p1.8.m8.3.3.1.cmml" xref="S2.p1.8.m8.3.3.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.3.3.1.2.cmml" xref="S2.p1.8.m8.3.3.1">subscript</csymbol><apply id="S2.p1.8.m8.3.3.1.1.1.1.cmml" xref="S2.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="S2.p1.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S2.p1.8.m8.3.3.1.1.1.1.2.cmml" xref="S2.p1.8.m8.3.3.1.1.1.1.2">𝐳</ci><list id="S2.p1.8.m8.2.2.2.3.cmml" xref="S2.p1.8.m8.2.2.2.4"><ci id="S2.p1.8.m8.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1">𝑖</ci><ci id="S2.p1.8.m8.2.2.2.2.cmml" xref="S2.p1.8.m8.2.2.2.2">𝑗</ci></list></apply><apply id="S2.p1.8.m8.3.3.1.3.cmml" xref="S2.p1.8.m8.3.3.1.3"><eq id="S2.p1.8.m8.3.3.1.3.1.cmml" xref="S2.p1.8.m8.3.3.1.3.1"></eq><ci id="S2.p1.8.m8.3.3.1.3.2.cmml" xref="S2.p1.8.m8.3.3.1.3.2">𝑗</ci><apply id="S2.p1.8.m8.3.3.1.3.3.cmml" xref="S2.p1.8.m8.3.3.1.3.3"><times id="S2.p1.8.m8.3.3.1.3.3.1.cmml" xref="S2.p1.8.m8.3.3.1.3.3.1"></times><cn type="integer" id="S2.p1.8.m8.3.3.1.3.3.2.cmml" xref="S2.p1.8.m8.3.3.1.3.3.2">1</cn><ci id="S2.p1.8.m8.3.3.1.3.3.3.cmml" xref="S2.p1.8.m8.3.3.1.3.3.3">⋯</ci><apply id="S2.p1.8.m8.3.3.1.3.3.4.cmml" xref="S2.p1.8.m8.3.3.1.3.3.4"><csymbol cd="ambiguous" id="S2.p1.8.m8.3.3.1.3.3.4.1.cmml" xref="S2.p1.8.m8.3.3.1.3.3.4">subscript</csymbol><ci id="S2.p1.8.m8.3.3.1.3.3.4.2.cmml" xref="S2.p1.8.m8.3.3.1.3.3.4.2">𝑚</ci><ci id="S2.p1.8.m8.3.3.1.3.3.4.3.cmml" xref="S2.p1.8.m8.3.3.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.3c">\mathcal{S}_{i}=(\mathbf{z}_{i,j})_{j=1\cdots m_{i}}</annotation></semantics></math> its associated dataset of size <math id="S2.p1.9.m9.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S2.p1.9.m9.1a"><msub id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml"><mi id="S2.p1.9.m9.1.1.2" xref="S2.p1.9.m9.1.1.2.cmml">m</mi><mi id="S2.p1.9.m9.1.1.3" xref="S2.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><apply id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.cmml" xref="S2.p1.9.m9.1.1">subscript</csymbol><ci id="S2.p1.9.m9.1.1.2.cmml" xref="S2.p1.9.m9.1.1.2">𝑚</ci><ci id="S2.p1.9.m9.1.1.3.cmml" xref="S2.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">m_{i}</annotation></semantics></math>. We define <math id="S2.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S2.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><ci id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">\mathcal{S}</annotation></semantics></math>, of size <math id="S2.p1.11.m11.1" class="ltx_Math" alttext="m=\sum_{i=1}^{K}m_{i}" display="inline"><semantics id="S2.p1.11.m11.1a"><mrow id="S2.p1.11.m11.1.1" xref="S2.p1.11.m11.1.1.cmml"><mi id="S2.p1.11.m11.1.1.2" xref="S2.p1.11.m11.1.1.2.cmml">m</mi><mo rspace="0.111em" id="S2.p1.11.m11.1.1.1" xref="S2.p1.11.m11.1.1.1.cmml">=</mo><mrow id="S2.p1.11.m11.1.1.3" xref="S2.p1.11.m11.1.1.3.cmml"><msubsup id="S2.p1.11.m11.1.1.3.1" xref="S2.p1.11.m11.1.1.3.1.cmml"><mo id="S2.p1.11.m11.1.1.3.1.2.2" xref="S2.p1.11.m11.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.p1.11.m11.1.1.3.1.2.3" xref="S2.p1.11.m11.1.1.3.1.2.3.cmml"><mi id="S2.p1.11.m11.1.1.3.1.2.3.2" xref="S2.p1.11.m11.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.p1.11.m11.1.1.3.1.2.3.1" xref="S2.p1.11.m11.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.p1.11.m11.1.1.3.1.2.3.3" xref="S2.p1.11.m11.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.11.m11.1.1.3.1.3" xref="S2.p1.11.m11.1.1.3.1.3.cmml">K</mi></msubsup><msub id="S2.p1.11.m11.1.1.3.2" xref="S2.p1.11.m11.1.1.3.2.cmml"><mi id="S2.p1.11.m11.1.1.3.2.2" xref="S2.p1.11.m11.1.1.3.2.2.cmml">m</mi><mi id="S2.p1.11.m11.1.1.3.2.3" xref="S2.p1.11.m11.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m11.1b"><apply id="S2.p1.11.m11.1.1.cmml" xref="S2.p1.11.m11.1.1"><eq id="S2.p1.11.m11.1.1.1.cmml" xref="S2.p1.11.m11.1.1.1"></eq><ci id="S2.p1.11.m11.1.1.2.cmml" xref="S2.p1.11.m11.1.1.2">𝑚</ci><apply id="S2.p1.11.m11.1.1.3.cmml" xref="S2.p1.11.m11.1.1.3"><apply id="S2.p1.11.m11.1.1.3.1.cmml" xref="S2.p1.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.3.1.1.cmml" xref="S2.p1.11.m11.1.1.3.1">superscript</csymbol><apply id="S2.p1.11.m11.1.1.3.1.2.cmml" xref="S2.p1.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.3.1.2.1.cmml" xref="S2.p1.11.m11.1.1.3.1">subscript</csymbol><sum id="S2.p1.11.m11.1.1.3.1.2.2.cmml" xref="S2.p1.11.m11.1.1.3.1.2.2"></sum><apply id="S2.p1.11.m11.1.1.3.1.2.3.cmml" xref="S2.p1.11.m11.1.1.3.1.2.3"><eq id="S2.p1.11.m11.1.1.3.1.2.3.1.cmml" xref="S2.p1.11.m11.1.1.3.1.2.3.1"></eq><ci id="S2.p1.11.m11.1.1.3.1.2.3.2.cmml" xref="S2.p1.11.m11.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.p1.11.m11.1.1.3.1.2.3.3.cmml" xref="S2.p1.11.m11.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.p1.11.m11.1.1.3.1.3.cmml" xref="S2.p1.11.m11.1.1.3.1.3">𝐾</ci></apply><apply id="S2.p1.11.m11.1.1.3.2.cmml" xref="S2.p1.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.3.2.1.cmml" xref="S2.p1.11.m11.1.1.3.2">subscript</csymbol><ci id="S2.p1.11.m11.1.1.3.2.2.cmml" xref="S2.p1.11.m11.1.1.3.2.2">𝑚</ci><ci id="S2.p1.11.m11.1.1.3.2.3.cmml" xref="S2.p1.11.m11.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m11.1c">m=\sum_{i=1}^{K}m_{i}</annotation></semantics></math>, to be the union of all <math id="S2.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S2.p1.12.m12.1a"><msub id="S2.p1.12.m12.1.1" xref="S2.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.12.m12.1.1.2" xref="S2.p1.12.m12.1.1.2.cmml">𝒮</mi><mi id="S2.p1.12.m12.1.1.3" xref="S2.p1.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.12.m12.1b"><apply id="S2.p1.12.m12.1.1.cmml" xref="S2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m12.1.1.1.cmml" xref="S2.p1.12.m12.1.1">subscript</csymbol><ci id="S2.p1.12.m12.1.1.2.cmml" xref="S2.p1.12.m12.1.1.2">𝒮</ci><ci id="S2.p1.12.m12.1.1.3.cmml" xref="S2.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m12.1c">\mathcal{S}_{i}</annotation></semantics></math>. We assume that each <math id="S2.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S2.p1.13.m13.1a"><msub id="S2.p1.13.m13.1.1" xref="S2.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.13.m13.1.1.2" xref="S2.p1.13.m13.1.1.2.cmml">𝒮</mi><mi id="S2.p1.13.m13.1.1.3" xref="S2.p1.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.13.m13.1b"><apply id="S2.p1.13.m13.1.1.cmml" xref="S2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.p1.13.m13.1.1.1.cmml" xref="S2.p1.13.m13.1.1">subscript</csymbol><ci id="S2.p1.13.m13.1.1.2.cmml" xref="S2.p1.13.m13.1.1.2">𝒮</ci><ci id="S2.p1.13.m13.1.1.3.cmml" xref="S2.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m13.1c">\mathcal{S}_{i}</annotation></semantics></math> is <span id="S2.p1.17.2" class="ltx_text ltx_font_italic">i.i.d.</span> with associated distribution <math id="S2.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S2.p1.14.m14.1a"><msub id="S2.p1.14.m14.1.1" xref="S2.p1.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.14.m14.1.1.2" xref="S2.p1.14.m14.1.1.2.cmml">𝒟</mi><mi id="S2.p1.14.m14.1.1.3" xref="S2.p1.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.14.m14.1b"><apply id="S2.p1.14.m14.1.1.cmml" xref="S2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S2.p1.14.m14.1.1.1.cmml" xref="S2.p1.14.m14.1.1">subscript</csymbol><ci id="S2.p1.14.m14.1.1.2.cmml" xref="S2.p1.14.m14.1.1.2">𝒟</ci><ci id="S2.p1.14.m14.1.1.3.cmml" xref="S2.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m14.1c">\mathcal{D}_{i}</annotation></semantics></math>.
Each user <math id="S2.p1.15.m15.1" class="ltx_Math" alttext="1\leq i\leq K" display="inline"><semantics id="S2.p1.15.m15.1a"><mrow id="S2.p1.15.m15.1.1" xref="S2.p1.15.m15.1.1.cmml"><mn id="S2.p1.15.m15.1.1.2" xref="S2.p1.15.m15.1.1.2.cmml">1</mn><mo id="S2.p1.15.m15.1.1.3" xref="S2.p1.15.m15.1.1.3.cmml">≤</mo><mi id="S2.p1.15.m15.1.1.4" xref="S2.p1.15.m15.1.1.4.cmml">i</mi><mo id="S2.p1.15.m15.1.1.5" xref="S2.p1.15.m15.1.1.5.cmml">≤</mo><mi id="S2.p1.15.m15.1.1.6" xref="S2.p1.15.m15.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.15.m15.1b"><apply id="S2.p1.15.m15.1.1.cmml" xref="S2.p1.15.m15.1.1"><and id="S2.p1.15.m15.1.1a.cmml" xref="S2.p1.15.m15.1.1"></and><apply id="S2.p1.15.m15.1.1b.cmml" xref="S2.p1.15.m15.1.1"><leq id="S2.p1.15.m15.1.1.3.cmml" xref="S2.p1.15.m15.1.1.3"></leq><cn type="integer" id="S2.p1.15.m15.1.1.2.cmml" xref="S2.p1.15.m15.1.1.2">1</cn><ci id="S2.p1.15.m15.1.1.4.cmml" xref="S2.p1.15.m15.1.1.4">𝑖</ci></apply><apply id="S2.p1.15.m15.1.1c.cmml" xref="S2.p1.15.m15.1.1"><leq id="S2.p1.15.m15.1.1.5.cmml" xref="S2.p1.15.m15.1.1.5"></leq><share href="#S2.p1.15.m15.1.1.4.cmml" id="S2.p1.15.m15.1.1d.cmml" xref="S2.p1.15.m15.1.1"></share><ci id="S2.p1.15.m15.1.1.6.cmml" xref="S2.p1.15.m15.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.15.m15.1c">1\leq i\leq K</annotation></semantics></math> aims to jointly learn a predictor <math id="S2.p1.16.m16.1" class="ltx_Math" alttext="h\in\mathcal{H}" display="inline"><semantics id="S2.p1.16.m16.1a"><mrow id="S2.p1.16.m16.1.1" xref="S2.p1.16.m16.1.1.cmml"><mi id="S2.p1.16.m16.1.1.2" xref="S2.p1.16.m16.1.1.2.cmml">h</mi><mo id="S2.p1.16.m16.1.1.1" xref="S2.p1.16.m16.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.16.m16.1.1.3" xref="S2.p1.16.m16.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.16.m16.1b"><apply id="S2.p1.16.m16.1.1.cmml" xref="S2.p1.16.m16.1.1"><in id="S2.p1.16.m16.1.1.1.cmml" xref="S2.p1.16.m16.1.1.1"></in><ci id="S2.p1.16.m16.1.1.2.cmml" xref="S2.p1.16.m16.1.1.2">ℎ</ci><ci id="S2.p1.16.m16.1.1.3.cmml" xref="S2.p1.16.m16.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.16.m16.1c">h\in\mathcal{H}</annotation></semantics></math> while keeping private their training dataset <math id="S2.p1.17.m17.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S2.p1.17.m17.1a"><msub id="S2.p1.17.m17.1.1" xref="S2.p1.17.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.17.m17.1.1.2" xref="S2.p1.17.m17.1.1.2.cmml">𝒮</mi><mi id="S2.p1.17.m17.1.1.3" xref="S2.p1.17.m17.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.17.m17.1b"><apply id="S2.p1.17.m17.1.1.cmml" xref="S2.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S2.p1.17.m17.1.1.1.cmml" xref="S2.p1.17.m17.1.1">subscript</csymbol><ci id="S2.p1.17.m17.1.1.2.cmml" xref="S2.p1.17.m17.1.1.2">𝒮</ci><ci id="S2.p1.17.m17.1.1.3.cmml" xref="S2.p1.17.m17.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.17.m17.1c">\mathcal{S}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.11" class="ltx_p"><span id="S2.p2.11.1" class="ltx_text ltx_font_bold">Learning theory.</span>
In PAC-Bayes learning, instead of directly crafting a predictor <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="h\in\mathcal{H}" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">h</mi><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><in id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"></in><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">ℎ</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">h\in\mathcal{H}</annotation></semantics></math>, we design a data-driven posterior distribution <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\mathrm{Q}\in\mathcal{M}(\mathcal{H})" display="inline"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.2" xref="S2.p2.2.m2.1.2.cmml"><mi mathvariant="normal" id="S2.p2.2.m2.1.2.2" xref="S2.p2.2.m2.1.2.2.cmml">Q</mi><mo id="S2.p2.2.m2.1.2.1" xref="S2.p2.2.m2.1.2.1.cmml">∈</mo><mrow id="S2.p2.2.m2.1.2.3" xref="S2.p2.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.2.3.2" xref="S2.p2.2.m2.1.2.3.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="S2.p2.2.m2.1.2.3.1" xref="S2.p2.2.m2.1.2.3.1.cmml">​</mo><mrow id="S2.p2.2.m2.1.2.3.3.2" xref="S2.p2.2.m2.1.2.3.cmml"><mo stretchy="false" id="S2.p2.2.m2.1.2.3.3.2.1" xref="S2.p2.2.m2.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">ℋ</mi><mo stretchy="false" id="S2.p2.2.m2.1.2.3.3.2.2" xref="S2.p2.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.2.cmml" xref="S2.p2.2.m2.1.2"><in id="S2.p2.2.m2.1.2.1.cmml" xref="S2.p2.2.m2.1.2.1"></in><ci id="S2.p2.2.m2.1.2.2.cmml" xref="S2.p2.2.m2.1.2.2">Q</ci><apply id="S2.p2.2.m2.1.2.3.cmml" xref="S2.p2.2.m2.1.2.3"><times id="S2.p2.2.m2.1.2.3.1.cmml" xref="S2.p2.2.m2.1.2.3.1"></times><ci id="S2.p2.2.m2.1.2.3.2.cmml" xref="S2.p2.2.m2.1.2.3.2">ℳ</ci><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">ℋ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathrm{Q}\in\mathcal{M}(\mathcal{H})</annotation></semantics></math> with respect to a prior distribution <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="\mathrm{P}" display="inline"><semantics id="S2.p2.3.m3.1a"><mi mathvariant="normal" id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">P</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\mathrm{P}</annotation></semantics></math>.
To assess the generalisation ability of a predictor <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="h\in\mathcal{H}" display="inline"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">h</mi><mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><in id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></in><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">ℎ</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">h\in\mathcal{H}</annotation></semantics></math>, we define for each user <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p2.5.m5.1a"><mi id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">k</annotation></semantics></math> the <em id="S2.p2.11.2" class="ltx_emph ltx_font_italic">risk</em> to be <math id="S2.p2.6.m6.4" class="ltx_Math" alttext="\text{R}_{\mathcal{D}_{i}}:=\operatorname*{\mathbb{E}}_{\mathbf{z}\sim\mu}[\ell(h,\mathbf{z})]" display="inline"><semantics id="S2.p2.6.m6.4a"><mrow id="S2.p2.6.m6.4.4" xref="S2.p2.6.m6.4.4.cmml"><msub id="S2.p2.6.m6.4.4.4" xref="S2.p2.6.m6.4.4.4.cmml"><mtext id="S2.p2.6.m6.4.4.4.2" xref="S2.p2.6.m6.4.4.4.2a.cmml">R</mtext><msub id="S2.p2.6.m6.4.4.4.3" xref="S2.p2.6.m6.4.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.4.4.4.3.2" xref="S2.p2.6.m6.4.4.4.3.2.cmml">𝒟</mi><mi id="S2.p2.6.m6.4.4.4.3.3" xref="S2.p2.6.m6.4.4.4.3.3.cmml">i</mi></msub></msub><mo lspace="0.278em" id="S2.p2.6.m6.4.4.3" xref="S2.p2.6.m6.4.4.3.cmml">:=</mo><mrow id="S2.p2.6.m6.4.4.2.2" xref="S2.p2.6.m6.4.4.2.3.cmml"><msub id="S2.p2.6.m6.3.3.1.1.1" xref="S2.p2.6.m6.3.3.1.1.1.cmml"><mo lspace="0.111em" rspace="0em" id="S2.p2.6.m6.3.3.1.1.1.2" xref="S2.p2.6.m6.3.3.1.1.1.2.cmml">𝔼</mo><mrow id="S2.p2.6.m6.3.3.1.1.1.3" xref="S2.p2.6.m6.3.3.1.1.1.3.cmml"><mi id="S2.p2.6.m6.3.3.1.1.1.3.2" xref="S2.p2.6.m6.3.3.1.1.1.3.2.cmml">𝐳</mi><mo id="S2.p2.6.m6.3.3.1.1.1.3.1" xref="S2.p2.6.m6.3.3.1.1.1.3.1.cmml">∼</mo><mi id="S2.p2.6.m6.3.3.1.1.1.3.3" xref="S2.p2.6.m6.3.3.1.1.1.3.3.cmml">μ</mi></mrow></msub><mrow id="S2.p2.6.m6.4.4.2.2.2" xref="S2.p2.6.m6.4.4.2.3.cmml"><mo stretchy="false" id="S2.p2.6.m6.4.4.2.2.2.2" xref="S2.p2.6.m6.4.4.2.3.cmml">[</mo><mrow id="S2.p2.6.m6.4.4.2.2.2.1" xref="S2.p2.6.m6.4.4.2.2.2.1.cmml"><mi mathvariant="normal" id="S2.p2.6.m6.4.4.2.2.2.1.2" xref="S2.p2.6.m6.4.4.2.2.2.1.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p2.6.m6.4.4.2.2.2.1.1" xref="S2.p2.6.m6.4.4.2.2.2.1.1.cmml">​</mo><mrow id="S2.p2.6.m6.4.4.2.2.2.1.3.2" xref="S2.p2.6.m6.4.4.2.2.2.1.3.1.cmml"><mo stretchy="false" id="S2.p2.6.m6.4.4.2.2.2.1.3.2.1" xref="S2.p2.6.m6.4.4.2.2.2.1.3.1.cmml">(</mo><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">h</mi><mo id="S2.p2.6.m6.4.4.2.2.2.1.3.2.2" xref="S2.p2.6.m6.4.4.2.2.2.1.3.1.cmml">,</mo><mi id="S2.p2.6.m6.2.2" xref="S2.p2.6.m6.2.2.cmml">𝐳</mi><mo stretchy="false" id="S2.p2.6.m6.4.4.2.2.2.1.3.2.3" xref="S2.p2.6.m6.4.4.2.2.2.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.6.m6.4.4.2.2.2.3" xref="S2.p2.6.m6.4.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.4b"><apply id="S2.p2.6.m6.4.4.cmml" xref="S2.p2.6.m6.4.4"><csymbol cd="latexml" id="S2.p2.6.m6.4.4.3.cmml" xref="S2.p2.6.m6.4.4.3">assign</csymbol><apply id="S2.p2.6.m6.4.4.4.cmml" xref="S2.p2.6.m6.4.4.4"><csymbol cd="ambiguous" id="S2.p2.6.m6.4.4.4.1.cmml" xref="S2.p2.6.m6.4.4.4">subscript</csymbol><ci id="S2.p2.6.m6.4.4.4.2a.cmml" xref="S2.p2.6.m6.4.4.4.2"><mtext id="S2.p2.6.m6.4.4.4.2.cmml" xref="S2.p2.6.m6.4.4.4.2">R</mtext></ci><apply id="S2.p2.6.m6.4.4.4.3.cmml" xref="S2.p2.6.m6.4.4.4.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.4.4.4.3.1.cmml" xref="S2.p2.6.m6.4.4.4.3">subscript</csymbol><ci id="S2.p2.6.m6.4.4.4.3.2.cmml" xref="S2.p2.6.m6.4.4.4.3.2">𝒟</ci><ci id="S2.p2.6.m6.4.4.4.3.3.cmml" xref="S2.p2.6.m6.4.4.4.3.3">𝑖</ci></apply></apply><apply id="S2.p2.6.m6.4.4.2.3.cmml" xref="S2.p2.6.m6.4.4.2.2"><apply id="S2.p2.6.m6.3.3.1.1.1.cmml" xref="S2.p2.6.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.3.3.1.1.1.1.cmml" xref="S2.p2.6.m6.3.3.1.1.1">subscript</csymbol><ci id="S2.p2.6.m6.3.3.1.1.1.2.cmml" xref="S2.p2.6.m6.3.3.1.1.1.2">𝔼</ci><apply id="S2.p2.6.m6.3.3.1.1.1.3.cmml" xref="S2.p2.6.m6.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.p2.6.m6.3.3.1.1.1.3.1.cmml" xref="S2.p2.6.m6.3.3.1.1.1.3.1">similar-to</csymbol><ci id="S2.p2.6.m6.3.3.1.1.1.3.2.cmml" xref="S2.p2.6.m6.3.3.1.1.1.3.2">𝐳</ci><ci id="S2.p2.6.m6.3.3.1.1.1.3.3.cmml" xref="S2.p2.6.m6.3.3.1.1.1.3.3">𝜇</ci></apply></apply><apply id="S2.p2.6.m6.4.4.2.2.2.1.cmml" xref="S2.p2.6.m6.4.4.2.2.2.1"><times id="S2.p2.6.m6.4.4.2.2.2.1.1.cmml" xref="S2.p2.6.m6.4.4.2.2.2.1.1"></times><ci id="S2.p2.6.m6.4.4.2.2.2.1.2.cmml" xref="S2.p2.6.m6.4.4.2.2.2.1.2">ℓ</ci><interval closure="open" id="S2.p2.6.m6.4.4.2.2.2.1.3.1.cmml" xref="S2.p2.6.m6.4.4.2.2.2.1.3.2"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">ℎ</ci><ci id="S2.p2.6.m6.2.2.cmml" xref="S2.p2.6.m6.2.2">𝐳</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.4c">\text{R}_{\mathcal{D}_{i}}:=\operatorname*{\mathbb{E}}_{\mathbf{z}\sim\mu}[\ell(h,\mathbf{z})]</annotation></semantics></math> and its empirical counterpart <math id="S2.p2.7.m7.4" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}_{i}}:=\frac{1}{m}\sum_{j=1}^{m_{i}}\ell(h,\mathbf{z}_{i,j})" display="inline"><semantics id="S2.p2.7.m7.4a"><mrow id="S2.p2.7.m7.4.4" xref="S2.p2.7.m7.4.4.cmml"><msub id="S2.p2.7.m7.4.4.3" xref="S2.p2.7.m7.4.4.3.cmml"><mover accent="true" id="S2.p2.7.m7.4.4.3.2" xref="S2.p2.7.m7.4.4.3.2.cmml"><mtext id="S2.p2.7.m7.4.4.3.2.2" xref="S2.p2.7.m7.4.4.3.2.2a.cmml">R</mtext><mo id="S2.p2.7.m7.4.4.3.2.1" xref="S2.p2.7.m7.4.4.3.2.1.cmml">^</mo></mover><msub id="S2.p2.7.m7.4.4.3.3" xref="S2.p2.7.m7.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.7.m7.4.4.3.3.2" xref="S2.p2.7.m7.4.4.3.3.2.cmml">𝒮</mi><mi id="S2.p2.7.m7.4.4.3.3.3" xref="S2.p2.7.m7.4.4.3.3.3.cmml">i</mi></msub></msub><mo lspace="0.278em" rspace="0.278em" id="S2.p2.7.m7.4.4.2" xref="S2.p2.7.m7.4.4.2.cmml">:=</mo><mrow id="S2.p2.7.m7.4.4.1" xref="S2.p2.7.m7.4.4.1.cmml"><mfrac id="S2.p2.7.m7.4.4.1.3" xref="S2.p2.7.m7.4.4.1.3.cmml"><mn id="S2.p2.7.m7.4.4.1.3.2" xref="S2.p2.7.m7.4.4.1.3.2.cmml">1</mn><mi id="S2.p2.7.m7.4.4.1.3.3" xref="S2.p2.7.m7.4.4.1.3.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.p2.7.m7.4.4.1.2" xref="S2.p2.7.m7.4.4.1.2.cmml">​</mo><mrow id="S2.p2.7.m7.4.4.1.1" xref="S2.p2.7.m7.4.4.1.1.cmml"><msubsup id="S2.p2.7.m7.4.4.1.1.2" xref="S2.p2.7.m7.4.4.1.1.2.cmml"><mo id="S2.p2.7.m7.4.4.1.1.2.2.2" xref="S2.p2.7.m7.4.4.1.1.2.2.2.cmml">∑</mo><mrow id="S2.p2.7.m7.4.4.1.1.2.2.3" xref="S2.p2.7.m7.4.4.1.1.2.2.3.cmml"><mi id="S2.p2.7.m7.4.4.1.1.2.2.3.2" xref="S2.p2.7.m7.4.4.1.1.2.2.3.2.cmml">j</mi><mo id="S2.p2.7.m7.4.4.1.1.2.2.3.1" xref="S2.p2.7.m7.4.4.1.1.2.2.3.1.cmml">=</mo><mn id="S2.p2.7.m7.4.4.1.1.2.2.3.3" xref="S2.p2.7.m7.4.4.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.p2.7.m7.4.4.1.1.2.3" xref="S2.p2.7.m7.4.4.1.1.2.3.cmml"><mi id="S2.p2.7.m7.4.4.1.1.2.3.2" xref="S2.p2.7.m7.4.4.1.1.2.3.2.cmml">m</mi><mi id="S2.p2.7.m7.4.4.1.1.2.3.3" xref="S2.p2.7.m7.4.4.1.1.2.3.3.cmml">i</mi></msub></msubsup><mrow id="S2.p2.7.m7.4.4.1.1.1" xref="S2.p2.7.m7.4.4.1.1.1.cmml"><mi mathvariant="normal" id="S2.p2.7.m7.4.4.1.1.1.3" xref="S2.p2.7.m7.4.4.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p2.7.m7.4.4.1.1.1.2" xref="S2.p2.7.m7.4.4.1.1.1.2.cmml">​</mo><mrow id="S2.p2.7.m7.4.4.1.1.1.1.1" xref="S2.p2.7.m7.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.7.m7.4.4.1.1.1.1.1.2" xref="S2.p2.7.m7.4.4.1.1.1.1.2.cmml">(</mo><mi id="S2.p2.7.m7.3.3" xref="S2.p2.7.m7.3.3.cmml">h</mi><mo id="S2.p2.7.m7.4.4.1.1.1.1.1.3" xref="S2.p2.7.m7.4.4.1.1.1.1.2.cmml">,</mo><msub id="S2.p2.7.m7.4.4.1.1.1.1.1.1" xref="S2.p2.7.m7.4.4.1.1.1.1.1.1.cmml"><mi id="S2.p2.7.m7.4.4.1.1.1.1.1.1.2" xref="S2.p2.7.m7.4.4.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S2.p2.7.m7.2.2.2.4" xref="S2.p2.7.m7.2.2.2.3.cmml"><mi id="S2.p2.7.m7.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="S2.p2.7.m7.2.2.2.4.1" xref="S2.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S2.p2.7.m7.2.2.2.2" xref="S2.p2.7.m7.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S2.p2.7.m7.4.4.1.1.1.1.1.4" xref="S2.p2.7.m7.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.4b"><apply id="S2.p2.7.m7.4.4.cmml" xref="S2.p2.7.m7.4.4"><csymbol cd="latexml" id="S2.p2.7.m7.4.4.2.cmml" xref="S2.p2.7.m7.4.4.2">assign</csymbol><apply id="S2.p2.7.m7.4.4.3.cmml" xref="S2.p2.7.m7.4.4.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.3.1.cmml" xref="S2.p2.7.m7.4.4.3">subscript</csymbol><apply id="S2.p2.7.m7.4.4.3.2.cmml" xref="S2.p2.7.m7.4.4.3.2"><ci id="S2.p2.7.m7.4.4.3.2.1.cmml" xref="S2.p2.7.m7.4.4.3.2.1">^</ci><ci id="S2.p2.7.m7.4.4.3.2.2a.cmml" xref="S2.p2.7.m7.4.4.3.2.2"><mtext id="S2.p2.7.m7.4.4.3.2.2.cmml" xref="S2.p2.7.m7.4.4.3.2.2">R</mtext></ci></apply><apply id="S2.p2.7.m7.4.4.3.3.cmml" xref="S2.p2.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.3.3.1.cmml" xref="S2.p2.7.m7.4.4.3.3">subscript</csymbol><ci id="S2.p2.7.m7.4.4.3.3.2.cmml" xref="S2.p2.7.m7.4.4.3.3.2">𝒮</ci><ci id="S2.p2.7.m7.4.4.3.3.3.cmml" xref="S2.p2.7.m7.4.4.3.3.3">𝑖</ci></apply></apply><apply id="S2.p2.7.m7.4.4.1.cmml" xref="S2.p2.7.m7.4.4.1"><times id="S2.p2.7.m7.4.4.1.2.cmml" xref="S2.p2.7.m7.4.4.1.2"></times><apply id="S2.p2.7.m7.4.4.1.3.cmml" xref="S2.p2.7.m7.4.4.1.3"><divide id="S2.p2.7.m7.4.4.1.3.1.cmml" xref="S2.p2.7.m7.4.4.1.3"></divide><cn type="integer" id="S2.p2.7.m7.4.4.1.3.2.cmml" xref="S2.p2.7.m7.4.4.1.3.2">1</cn><ci id="S2.p2.7.m7.4.4.1.3.3.cmml" xref="S2.p2.7.m7.4.4.1.3.3">𝑚</ci></apply><apply id="S2.p2.7.m7.4.4.1.1.cmml" xref="S2.p2.7.m7.4.4.1.1"><apply id="S2.p2.7.m7.4.4.1.1.2.cmml" xref="S2.p2.7.m7.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.1.1.2.1.cmml" xref="S2.p2.7.m7.4.4.1.1.2">superscript</csymbol><apply id="S2.p2.7.m7.4.4.1.1.2.2.cmml" xref="S2.p2.7.m7.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.1.1.2.2.1.cmml" xref="S2.p2.7.m7.4.4.1.1.2">subscript</csymbol><sum id="S2.p2.7.m7.4.4.1.1.2.2.2.cmml" xref="S2.p2.7.m7.4.4.1.1.2.2.2"></sum><apply id="S2.p2.7.m7.4.4.1.1.2.2.3.cmml" xref="S2.p2.7.m7.4.4.1.1.2.2.3"><eq id="S2.p2.7.m7.4.4.1.1.2.2.3.1.cmml" xref="S2.p2.7.m7.4.4.1.1.2.2.3.1"></eq><ci id="S2.p2.7.m7.4.4.1.1.2.2.3.2.cmml" xref="S2.p2.7.m7.4.4.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.p2.7.m7.4.4.1.1.2.2.3.3.cmml" xref="S2.p2.7.m7.4.4.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.p2.7.m7.4.4.1.1.2.3.cmml" xref="S2.p2.7.m7.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.1.1.2.3.1.cmml" xref="S2.p2.7.m7.4.4.1.1.2.3">subscript</csymbol><ci id="S2.p2.7.m7.4.4.1.1.2.3.2.cmml" xref="S2.p2.7.m7.4.4.1.1.2.3.2">𝑚</ci><ci id="S2.p2.7.m7.4.4.1.1.2.3.3.cmml" xref="S2.p2.7.m7.4.4.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.p2.7.m7.4.4.1.1.1.cmml" xref="S2.p2.7.m7.4.4.1.1.1"><times id="S2.p2.7.m7.4.4.1.1.1.2.cmml" xref="S2.p2.7.m7.4.4.1.1.1.2"></times><ci id="S2.p2.7.m7.4.4.1.1.1.3.cmml" xref="S2.p2.7.m7.4.4.1.1.1.3">ℓ</ci><interval closure="open" id="S2.p2.7.m7.4.4.1.1.1.1.2.cmml" xref="S2.p2.7.m7.4.4.1.1.1.1.1"><ci id="S2.p2.7.m7.3.3.cmml" xref="S2.p2.7.m7.3.3">ℎ</ci><apply id="S2.p2.7.m7.4.4.1.1.1.1.1.1.cmml" xref="S2.p2.7.m7.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.4.4.1.1.1.1.1.1.1.cmml" xref="S2.p2.7.m7.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.7.m7.4.4.1.1.1.1.1.1.2.cmml" xref="S2.p2.7.m7.4.4.1.1.1.1.1.1.2">𝐳</ci><list id="S2.p2.7.m7.2.2.2.3.cmml" xref="S2.p2.7.m7.2.2.2.4"><ci id="S2.p2.7.m7.1.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1.1">𝑖</ci><ci id="S2.p2.7.m7.2.2.2.2.cmml" xref="S2.p2.7.m7.2.2.2.2">𝑗</ci></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.4c">\hat{\text{R}}_{\mathcal{S}_{i}}:=\frac{1}{m}\sum_{j=1}^{m_{i}}\ell(h,\mathbf{z}_{i,j})</annotation></semantics></math>. As PAC-Bayes focuses on elements of <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{M}(\mathcal{H})" display="inline"><semantics id="S2.p2.8.m8.1a"><mrow id="S2.p2.8.m8.1.2" xref="S2.p2.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m8.1.2.2" xref="S2.p2.8.m8.1.2.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="S2.p2.8.m8.1.2.1" xref="S2.p2.8.m8.1.2.1.cmml">​</mo><mrow id="S2.p2.8.m8.1.2.3.2" xref="S2.p2.8.m8.1.2.cmml"><mo stretchy="false" id="S2.p2.8.m8.1.2.3.2.1" xref="S2.p2.8.m8.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">ℋ</mi><mo stretchy="false" id="S2.p2.8.m8.1.2.3.2.2" xref="S2.p2.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><apply id="S2.p2.8.m8.1.2.cmml" xref="S2.p2.8.m8.1.2"><times id="S2.p2.8.m8.1.2.1.cmml" xref="S2.p2.8.m8.1.2.1"></times><ci id="S2.p2.8.m8.1.2.2.cmml" xref="S2.p2.8.m8.1.2.2">ℳ</ci><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\mathcal{M}(\mathcal{H})</annotation></semantics></math>, we also define the expected risk and empirical risks for <math id="S2.p2.9.m9.1" class="ltx_Math" alttext="Q\in\mathcal{M}(\mathcal{H})" display="inline"><semantics id="S2.p2.9.m9.1a"><mrow id="S2.p2.9.m9.1.2" xref="S2.p2.9.m9.1.2.cmml"><mi id="S2.p2.9.m9.1.2.2" xref="S2.p2.9.m9.1.2.2.cmml">Q</mi><mo id="S2.p2.9.m9.1.2.1" xref="S2.p2.9.m9.1.2.1.cmml">∈</mo><mrow id="S2.p2.9.m9.1.2.3" xref="S2.p2.9.m9.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.9.m9.1.2.3.2" xref="S2.p2.9.m9.1.2.3.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m9.1.2.3.1" xref="S2.p2.9.m9.1.2.3.1.cmml">​</mo><mrow id="S2.p2.9.m9.1.2.3.3.2" xref="S2.p2.9.m9.1.2.3.cmml"><mo stretchy="false" id="S2.p2.9.m9.1.2.3.3.2.1" xref="S2.p2.9.m9.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml">ℋ</mi><mo stretchy="false" id="S2.p2.9.m9.1.2.3.3.2.2" xref="S2.p2.9.m9.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.1b"><apply id="S2.p2.9.m9.1.2.cmml" xref="S2.p2.9.m9.1.2"><in id="S2.p2.9.m9.1.2.1.cmml" xref="S2.p2.9.m9.1.2.1"></in><ci id="S2.p2.9.m9.1.2.2.cmml" xref="S2.p2.9.m9.1.2.2">𝑄</ci><apply id="S2.p2.9.m9.1.2.3.cmml" xref="S2.p2.9.m9.1.2.3"><times id="S2.p2.9.m9.1.2.3.1.cmml" xref="S2.p2.9.m9.1.2.3.1"></times><ci id="S2.p2.9.m9.1.2.3.2.cmml" xref="S2.p2.9.m9.1.2.3.2">ℳ</ci><ci id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1">ℋ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.1c">Q\in\mathcal{M}(\mathcal{H})</annotation></semantics></math> as <math id="S2.p2.10.m10.4" class="ltx_Math" alttext="\text{R}_{\mathcal{D}_{i}}(\mathrm{Q}):=\operatorname*{\mathbb{E}}_{h\sim\mathrm{Q}}[\text{R}_{\mathcal{D}_{i}}(h)]" display="inline"><semantics id="S2.p2.10.m10.4a"><mrow id="S2.p2.10.m10.4.4" xref="S2.p2.10.m10.4.4.cmml"><mrow id="S2.p2.10.m10.4.4.4" xref="S2.p2.10.m10.4.4.4.cmml"><msub id="S2.p2.10.m10.4.4.4.2" xref="S2.p2.10.m10.4.4.4.2.cmml"><mtext id="S2.p2.10.m10.4.4.4.2.2" xref="S2.p2.10.m10.4.4.4.2.2a.cmml">R</mtext><msub id="S2.p2.10.m10.4.4.4.2.3" xref="S2.p2.10.m10.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.10.m10.4.4.4.2.3.2" xref="S2.p2.10.m10.4.4.4.2.3.2.cmml">𝒟</mi><mi id="S2.p2.10.m10.4.4.4.2.3.3" xref="S2.p2.10.m10.4.4.4.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.p2.10.m10.4.4.4.1" xref="S2.p2.10.m10.4.4.4.1.cmml">​</mo><mrow id="S2.p2.10.m10.4.4.4.3.2" xref="S2.p2.10.m10.4.4.4.cmml"><mo stretchy="false" id="S2.p2.10.m10.4.4.4.3.2.1" xref="S2.p2.10.m10.4.4.4.cmml">(</mo><mi mathvariant="normal" id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">Q</mi><mo rspace="0.278em" stretchy="false" id="S2.p2.10.m10.4.4.4.3.2.2" xref="S2.p2.10.m10.4.4.4.cmml">)</mo></mrow></mrow><mo id="S2.p2.10.m10.4.4.3" xref="S2.p2.10.m10.4.4.3.cmml">:=</mo><mrow id="S2.p2.10.m10.4.4.2.2" xref="S2.p2.10.m10.4.4.2.3.cmml"><msub id="S2.p2.10.m10.3.3.1.1.1" xref="S2.p2.10.m10.3.3.1.1.1.cmml"><mo lspace="0.111em" rspace="0em" id="S2.p2.10.m10.3.3.1.1.1.2" xref="S2.p2.10.m10.3.3.1.1.1.2.cmml">𝔼</mo><mrow id="S2.p2.10.m10.3.3.1.1.1.3" xref="S2.p2.10.m10.3.3.1.1.1.3.cmml"><mi id="S2.p2.10.m10.3.3.1.1.1.3.2" xref="S2.p2.10.m10.3.3.1.1.1.3.2.cmml">h</mi><mo id="S2.p2.10.m10.3.3.1.1.1.3.1" xref="S2.p2.10.m10.3.3.1.1.1.3.1.cmml">∼</mo><mi mathvariant="normal" id="S2.p2.10.m10.3.3.1.1.1.3.3" xref="S2.p2.10.m10.3.3.1.1.1.3.3.cmml">Q</mi></mrow></msub><mrow id="S2.p2.10.m10.4.4.2.2.2" xref="S2.p2.10.m10.4.4.2.3.cmml"><mo stretchy="false" id="S2.p2.10.m10.4.4.2.2.2.2" xref="S2.p2.10.m10.4.4.2.3.cmml">[</mo><mrow id="S2.p2.10.m10.4.4.2.2.2.1" xref="S2.p2.10.m10.4.4.2.2.2.1.cmml"><msub id="S2.p2.10.m10.4.4.2.2.2.1.2" xref="S2.p2.10.m10.4.4.2.2.2.1.2.cmml"><mtext id="S2.p2.10.m10.4.4.2.2.2.1.2.2" xref="S2.p2.10.m10.4.4.2.2.2.1.2.2a.cmml">R</mtext><msub id="S2.p2.10.m10.4.4.2.2.2.1.2.3" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.10.m10.4.4.2.2.2.1.2.3.2" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3.2.cmml">𝒟</mi><mi id="S2.p2.10.m10.4.4.2.2.2.1.2.3.3" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.p2.10.m10.4.4.2.2.2.1.1" xref="S2.p2.10.m10.4.4.2.2.2.1.1.cmml">​</mo><mrow id="S2.p2.10.m10.4.4.2.2.2.1.3.2" xref="S2.p2.10.m10.4.4.2.2.2.1.cmml"><mo stretchy="false" id="S2.p2.10.m10.4.4.2.2.2.1.3.2.1" xref="S2.p2.10.m10.4.4.2.2.2.1.cmml">(</mo><mi id="S2.p2.10.m10.2.2" xref="S2.p2.10.m10.2.2.cmml">h</mi><mo stretchy="false" id="S2.p2.10.m10.4.4.2.2.2.1.3.2.2" xref="S2.p2.10.m10.4.4.2.2.2.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.10.m10.4.4.2.2.2.3" xref="S2.p2.10.m10.4.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.4b"><apply id="S2.p2.10.m10.4.4.cmml" xref="S2.p2.10.m10.4.4"><csymbol cd="latexml" id="S2.p2.10.m10.4.4.3.cmml" xref="S2.p2.10.m10.4.4.3">assign</csymbol><apply id="S2.p2.10.m10.4.4.4.cmml" xref="S2.p2.10.m10.4.4.4"><times id="S2.p2.10.m10.4.4.4.1.cmml" xref="S2.p2.10.m10.4.4.4.1"></times><apply id="S2.p2.10.m10.4.4.4.2.cmml" xref="S2.p2.10.m10.4.4.4.2"><csymbol cd="ambiguous" id="S2.p2.10.m10.4.4.4.2.1.cmml" xref="S2.p2.10.m10.4.4.4.2">subscript</csymbol><ci id="S2.p2.10.m10.4.4.4.2.2a.cmml" xref="S2.p2.10.m10.4.4.4.2.2"><mtext id="S2.p2.10.m10.4.4.4.2.2.cmml" xref="S2.p2.10.m10.4.4.4.2.2">R</mtext></ci><apply id="S2.p2.10.m10.4.4.4.2.3.cmml" xref="S2.p2.10.m10.4.4.4.2.3"><csymbol cd="ambiguous" id="S2.p2.10.m10.4.4.4.2.3.1.cmml" xref="S2.p2.10.m10.4.4.4.2.3">subscript</csymbol><ci id="S2.p2.10.m10.4.4.4.2.3.2.cmml" xref="S2.p2.10.m10.4.4.4.2.3.2">𝒟</ci><ci id="S2.p2.10.m10.4.4.4.2.3.3.cmml" xref="S2.p2.10.m10.4.4.4.2.3.3">𝑖</ci></apply></apply><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">Q</ci></apply><apply id="S2.p2.10.m10.4.4.2.3.cmml" xref="S2.p2.10.m10.4.4.2.2"><apply id="S2.p2.10.m10.3.3.1.1.1.cmml" xref="S2.p2.10.m10.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p2.10.m10.3.3.1.1.1.1.cmml" xref="S2.p2.10.m10.3.3.1.1.1">subscript</csymbol><ci id="S2.p2.10.m10.3.3.1.1.1.2.cmml" xref="S2.p2.10.m10.3.3.1.1.1.2">𝔼</ci><apply id="S2.p2.10.m10.3.3.1.1.1.3.cmml" xref="S2.p2.10.m10.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.p2.10.m10.3.3.1.1.1.3.1.cmml" xref="S2.p2.10.m10.3.3.1.1.1.3.1">similar-to</csymbol><ci id="S2.p2.10.m10.3.3.1.1.1.3.2.cmml" xref="S2.p2.10.m10.3.3.1.1.1.3.2">ℎ</ci><ci id="S2.p2.10.m10.3.3.1.1.1.3.3.cmml" xref="S2.p2.10.m10.3.3.1.1.1.3.3">Q</ci></apply></apply><apply id="S2.p2.10.m10.4.4.2.2.2.1.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1"><times id="S2.p2.10.m10.4.4.2.2.2.1.1.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.1"></times><apply id="S2.p2.10.m10.4.4.2.2.2.1.2.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.p2.10.m10.4.4.2.2.2.1.2.1.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2">subscript</csymbol><ci id="S2.p2.10.m10.4.4.2.2.2.1.2.2a.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.2"><mtext id="S2.p2.10.m10.4.4.2.2.2.1.2.2.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.2">R</mtext></ci><apply id="S2.p2.10.m10.4.4.2.2.2.1.2.3.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S2.p2.10.m10.4.4.2.2.2.1.2.3.1.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3">subscript</csymbol><ci id="S2.p2.10.m10.4.4.2.2.2.1.2.3.2.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3.2">𝒟</ci><ci id="S2.p2.10.m10.4.4.2.2.2.1.2.3.3.cmml" xref="S2.p2.10.m10.4.4.2.2.2.1.2.3.3">𝑖</ci></apply></apply><ci id="S2.p2.10.m10.2.2.cmml" xref="S2.p2.10.m10.2.2">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.4c">\text{R}_{\mathcal{D}_{i}}(\mathrm{Q}):=\operatorname*{\mathbb{E}}_{h\sim\mathrm{Q}}[\text{R}_{\mathcal{D}_{i}}(h)]</annotation></semantics></math> and <math id="S2.p2.11.m11.4" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}_{i}}(\mathrm{Q}):=\operatorname*{\mathbb{E}}_{h\sim\mathrm{Q}}[\hat{\text{R}}_{\mathcal{S}_{i}}(h)]" display="inline"><semantics id="S2.p2.11.m11.4a"><mrow id="S2.p2.11.m11.4.4" xref="S2.p2.11.m11.4.4.cmml"><mrow id="S2.p2.11.m11.4.4.4" xref="S2.p2.11.m11.4.4.4.cmml"><msub id="S2.p2.11.m11.4.4.4.2" xref="S2.p2.11.m11.4.4.4.2.cmml"><mover accent="true" id="S2.p2.11.m11.4.4.4.2.2" xref="S2.p2.11.m11.4.4.4.2.2.cmml"><mtext id="S2.p2.11.m11.4.4.4.2.2.2" xref="S2.p2.11.m11.4.4.4.2.2.2a.cmml">R</mtext><mo id="S2.p2.11.m11.4.4.4.2.2.1" xref="S2.p2.11.m11.4.4.4.2.2.1.cmml">^</mo></mover><msub id="S2.p2.11.m11.4.4.4.2.3" xref="S2.p2.11.m11.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.11.m11.4.4.4.2.3.2" xref="S2.p2.11.m11.4.4.4.2.3.2.cmml">𝒮</mi><mi id="S2.p2.11.m11.4.4.4.2.3.3" xref="S2.p2.11.m11.4.4.4.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.p2.11.m11.4.4.4.1" xref="S2.p2.11.m11.4.4.4.1.cmml">​</mo><mrow id="S2.p2.11.m11.4.4.4.3.2" xref="S2.p2.11.m11.4.4.4.cmml"><mo stretchy="false" id="S2.p2.11.m11.4.4.4.3.2.1" xref="S2.p2.11.m11.4.4.4.cmml">(</mo><mi mathvariant="normal" id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml">Q</mi><mo rspace="0.278em" stretchy="false" id="S2.p2.11.m11.4.4.4.3.2.2" xref="S2.p2.11.m11.4.4.4.cmml">)</mo></mrow></mrow><mo id="S2.p2.11.m11.4.4.3" xref="S2.p2.11.m11.4.4.3.cmml">:=</mo><mrow id="S2.p2.11.m11.4.4.2.2" xref="S2.p2.11.m11.4.4.2.3.cmml"><msub id="S2.p2.11.m11.3.3.1.1.1" xref="S2.p2.11.m11.3.3.1.1.1.cmml"><mo lspace="0.111em" rspace="0em" id="S2.p2.11.m11.3.3.1.1.1.2" xref="S2.p2.11.m11.3.3.1.1.1.2.cmml">𝔼</mo><mrow id="S2.p2.11.m11.3.3.1.1.1.3" xref="S2.p2.11.m11.3.3.1.1.1.3.cmml"><mi id="S2.p2.11.m11.3.3.1.1.1.3.2" xref="S2.p2.11.m11.3.3.1.1.1.3.2.cmml">h</mi><mo id="S2.p2.11.m11.3.3.1.1.1.3.1" xref="S2.p2.11.m11.3.3.1.1.1.3.1.cmml">∼</mo><mi mathvariant="normal" id="S2.p2.11.m11.3.3.1.1.1.3.3" xref="S2.p2.11.m11.3.3.1.1.1.3.3.cmml">Q</mi></mrow></msub><mrow id="S2.p2.11.m11.4.4.2.2.2" xref="S2.p2.11.m11.4.4.2.3.cmml"><mo stretchy="false" id="S2.p2.11.m11.4.4.2.2.2.2" xref="S2.p2.11.m11.4.4.2.3.cmml">[</mo><mrow id="S2.p2.11.m11.4.4.2.2.2.1" xref="S2.p2.11.m11.4.4.2.2.2.1.cmml"><msub id="S2.p2.11.m11.4.4.2.2.2.1.2" xref="S2.p2.11.m11.4.4.2.2.2.1.2.cmml"><mover accent="true" id="S2.p2.11.m11.4.4.2.2.2.1.2.2" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.cmml"><mtext id="S2.p2.11.m11.4.4.2.2.2.1.2.2.2" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.2a.cmml">R</mtext><mo id="S2.p2.11.m11.4.4.2.2.2.1.2.2.1" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.1.cmml">^</mo></mover><msub id="S2.p2.11.m11.4.4.2.2.2.1.2.3" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.11.m11.4.4.2.2.2.1.2.3.2" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3.2.cmml">𝒮</mi><mi id="S2.p2.11.m11.4.4.2.2.2.1.2.3.3" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.p2.11.m11.4.4.2.2.2.1.1" xref="S2.p2.11.m11.4.4.2.2.2.1.1.cmml">​</mo><mrow id="S2.p2.11.m11.4.4.2.2.2.1.3.2" xref="S2.p2.11.m11.4.4.2.2.2.1.cmml"><mo stretchy="false" id="S2.p2.11.m11.4.4.2.2.2.1.3.2.1" xref="S2.p2.11.m11.4.4.2.2.2.1.cmml">(</mo><mi id="S2.p2.11.m11.2.2" xref="S2.p2.11.m11.2.2.cmml">h</mi><mo stretchy="false" id="S2.p2.11.m11.4.4.2.2.2.1.3.2.2" xref="S2.p2.11.m11.4.4.2.2.2.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.11.m11.4.4.2.2.2.3" xref="S2.p2.11.m11.4.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.4b"><apply id="S2.p2.11.m11.4.4.cmml" xref="S2.p2.11.m11.4.4"><csymbol cd="latexml" id="S2.p2.11.m11.4.4.3.cmml" xref="S2.p2.11.m11.4.4.3">assign</csymbol><apply id="S2.p2.11.m11.4.4.4.cmml" xref="S2.p2.11.m11.4.4.4"><times id="S2.p2.11.m11.4.4.4.1.cmml" xref="S2.p2.11.m11.4.4.4.1"></times><apply id="S2.p2.11.m11.4.4.4.2.cmml" xref="S2.p2.11.m11.4.4.4.2"><csymbol cd="ambiguous" id="S2.p2.11.m11.4.4.4.2.1.cmml" xref="S2.p2.11.m11.4.4.4.2">subscript</csymbol><apply id="S2.p2.11.m11.4.4.4.2.2.cmml" xref="S2.p2.11.m11.4.4.4.2.2"><ci id="S2.p2.11.m11.4.4.4.2.2.1.cmml" xref="S2.p2.11.m11.4.4.4.2.2.1">^</ci><ci id="S2.p2.11.m11.4.4.4.2.2.2a.cmml" xref="S2.p2.11.m11.4.4.4.2.2.2"><mtext id="S2.p2.11.m11.4.4.4.2.2.2.cmml" xref="S2.p2.11.m11.4.4.4.2.2.2">R</mtext></ci></apply><apply id="S2.p2.11.m11.4.4.4.2.3.cmml" xref="S2.p2.11.m11.4.4.4.2.3"><csymbol cd="ambiguous" id="S2.p2.11.m11.4.4.4.2.3.1.cmml" xref="S2.p2.11.m11.4.4.4.2.3">subscript</csymbol><ci id="S2.p2.11.m11.4.4.4.2.3.2.cmml" xref="S2.p2.11.m11.4.4.4.2.3.2">𝒮</ci><ci id="S2.p2.11.m11.4.4.4.2.3.3.cmml" xref="S2.p2.11.m11.4.4.4.2.3.3">𝑖</ci></apply></apply><ci id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1">Q</ci></apply><apply id="S2.p2.11.m11.4.4.2.3.cmml" xref="S2.p2.11.m11.4.4.2.2"><apply id="S2.p2.11.m11.3.3.1.1.1.cmml" xref="S2.p2.11.m11.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p2.11.m11.3.3.1.1.1.1.cmml" xref="S2.p2.11.m11.3.3.1.1.1">subscript</csymbol><ci id="S2.p2.11.m11.3.3.1.1.1.2.cmml" xref="S2.p2.11.m11.3.3.1.1.1.2">𝔼</ci><apply id="S2.p2.11.m11.3.3.1.1.1.3.cmml" xref="S2.p2.11.m11.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.p2.11.m11.3.3.1.1.1.3.1.cmml" xref="S2.p2.11.m11.3.3.1.1.1.3.1">similar-to</csymbol><ci id="S2.p2.11.m11.3.3.1.1.1.3.2.cmml" xref="S2.p2.11.m11.3.3.1.1.1.3.2">ℎ</ci><ci id="S2.p2.11.m11.3.3.1.1.1.3.3.cmml" xref="S2.p2.11.m11.3.3.1.1.1.3.3">Q</ci></apply></apply><apply id="S2.p2.11.m11.4.4.2.2.2.1.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1"><times id="S2.p2.11.m11.4.4.2.2.2.1.1.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.1"></times><apply id="S2.p2.11.m11.4.4.2.2.2.1.2.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.p2.11.m11.4.4.2.2.2.1.2.1.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2">subscript</csymbol><apply id="S2.p2.11.m11.4.4.2.2.2.1.2.2.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2"><ci id="S2.p2.11.m11.4.4.2.2.2.1.2.2.1.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.1">^</ci><ci id="S2.p2.11.m11.4.4.2.2.2.1.2.2.2a.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.2"><mtext id="S2.p2.11.m11.4.4.2.2.2.1.2.2.2.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.2.2">R</mtext></ci></apply><apply id="S2.p2.11.m11.4.4.2.2.2.1.2.3.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S2.p2.11.m11.4.4.2.2.2.1.2.3.1.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3">subscript</csymbol><ci id="S2.p2.11.m11.4.4.2.2.2.1.2.3.2.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3.2">𝒮</ci><ci id="S2.p2.11.m11.4.4.2.2.2.1.2.3.3.cmml" xref="S2.p2.11.m11.4.4.2.2.2.1.2.3.3">𝑖</ci></apply></apply><ci id="S2.p2.11.m11.2.2.cmml" xref="S2.p2.11.m11.2.2">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.4c">\hat{\text{R}}_{\mathcal{S}_{i}}(\mathrm{Q}):=\operatorname*{\mathbb{E}}_{h\sim\mathrm{Q}}[\hat{\text{R}}_{\mathcal{S}_{i}}(h)]</annotation></semantics></math>.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Background on PAC-Bayes learning.</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px1.p1.6" class="ltx_p">In a batch setting, we only consider the dataset <math id="S2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">\mathcal{S}</annotation></semantics></math> (this can be seen as the case where there is only one user) and we assume that all data are <span id="S2.SS0.SSS0.Px1.p1.6.1" class="ltx_text ltx_font_italic">i.i.d.</span> with distribution <math id="S2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{D}</annotation></semantics></math>. For two probability measures <math id="S2.SS0.SSS0.Px1.p1.3.m3.2" class="ltx_Math" alttext="\mathrm{P},\mathrm{Q}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.2a"><mrow id="S2.SS0.SSS0.Px1.p1.3.m3.2.3.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml"><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">P</mi><mo id="S2.SS0.SSS0.Px1.p1.3.m3.2.3.2.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.3.m3.2.2" xref="S2.SS0.SSS0.Px1.p1.3.m3.2.2.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.2b"><list id="S2.SS0.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.2.3.2"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">P</ci><ci id="S2.SS0.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.2.2">Q</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.2c">\mathrm{P},\mathrm{Q}</annotation></semantics></math> we define the <em id="S2.SS0.SSS0.Px1.p1.6.2" class="ltx_emph ltx_font_italic">Kullback-Leibler divergence</em> to be <math id="S2.SS0.SSS0.Px1.p1.4.m4.5" class="ltx_Math" alttext="\operatorname{KL}(\mathrm{Q},\mathrm{P})=\mathbb{E}_{h\sim\mathrm{P}}\left[\frac{d\mathrm{Q}}{d\mathrm{P}}(h)\right]" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.5a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">KL</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2a" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml">⁡</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml">(</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.2.2.cmml">Q</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.cmml">P</mi><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.2.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.2.cmml">𝔼</mi><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.2.cmml">h</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.1.cmml">∼</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.3.cmml">P</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.2.cmml">​</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.2.1.cmml">[</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml"><mfrac id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.3.cmml">Q</mi></mrow><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.3.cmml">P</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.3.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.cmml">h</mi><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.5b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5"><eq id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.2"></eq><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.3.2"><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1">KL</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.2.2">Q</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3">P</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1"><times id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.2"></times><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.2">𝔼</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.1">similar-to</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.2">ℎ</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.3.3.3">P</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1"><times id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2"><divide id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2"></divide><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2"><times id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.1"></times><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.2.3">Q</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3"><times id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.5.5.1.1.1.1.2.3.3">P</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.5c">\operatorname{KL}(\mathrm{Q},\mathrm{P})=\mathbb{E}_{h\sim\mathrm{P}}\left[\frac{d\mathrm{Q}}{d\mathrm{P}}(h)\right]</annotation></semantics></math> where <math id="S2.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\frac{d\mathrm{Q}}{d\mathrm{P}}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mfrac id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.cmml">Q</mi></mrow><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml">P</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1"><divide id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1"></divide><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2"><times id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.1"></times><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.2.3">Q</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3"><times id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.3.3">P</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">\frac{d\mathrm{Q}}{d\mathrm{P}}</annotation></semantics></math> is the Radon-Nikodym derivative. We also denote by <math id="S2.SS0.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathrm{kl}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.6.m6.1a"><mi id="S2.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">kl</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1">kl</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m6.1c">\mathrm{kl}</annotation></semantics></math> the KL divergence between two Bernoulli distributions.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Generalisation bounds.</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">We recall the following bound, due to <cite class="ltx_cite ltx_citemacro_citet">McAllester, (<a href="#bib.bib39" title="" class="ltx_ref">2003</a>); Maurer, (<a href="#bib.bib37" title="" class="ltx_ref">2004</a>)</cite>, which holds for bounded losses.</p>
</div>
<div id="Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem 1</span></span><span id="Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(McAllester’s bound)<span id="Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem1.p1" class="ltx_para">
<p id="Thmtheorem1.p1.4" class="ltx_p"><span id="Thmtheorem1.p1.4.4" class="ltx_text ltx_font_italic">For any data-free prior distribution <math id="Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathrm{P}\in\mathcal{M}(\mathcal{H})" display="inline"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mrow id="Thmtheorem1.p1.1.1.m1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.2.cmml"><mi mathvariant="normal" id="Thmtheorem1.p1.1.1.m1.1.2.2" xref="Thmtheorem1.p1.1.1.m1.1.2.2.cmml">P</mi><mo id="Thmtheorem1.p1.1.1.m1.1.2.1" xref="Thmtheorem1.p1.1.1.m1.1.2.1.cmml">∈</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.2.3" xref="Thmtheorem1.p1.1.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.1.1.m1.1.2.3.2" xref="Thmtheorem1.p1.1.1.m1.1.2.3.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.1.1.m1.1.2.3.1" xref="Thmtheorem1.p1.1.1.m1.1.2.3.1.cmml">​</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.2.3.3.2" xref="Thmtheorem1.p1.1.1.m1.1.2.3.cmml"><mo stretchy="false" id="Thmtheorem1.p1.1.1.m1.1.2.3.3.2.1" xref="Thmtheorem1.p1.1.1.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml">ℋ</mi><mo stretchy="false" id="Thmtheorem1.p1.1.1.m1.1.2.3.3.2.2" xref="Thmtheorem1.p1.1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><apply id="Thmtheorem1.p1.1.1.m1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2"><in id="Thmtheorem1.p1.1.1.m1.1.2.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2.1"></in><ci id="Thmtheorem1.p1.1.1.m1.1.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2.2">P</ci><apply id="Thmtheorem1.p1.1.1.m1.1.2.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2.3"><times id="Thmtheorem1.p1.1.1.m1.1.2.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2.3.1"></times><ci id="Thmtheorem1.p1.1.1.m1.1.2.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.2.3.2">ℳ</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1">ℋ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">\mathrm{P}\in\mathcal{M}(\mathcal{H})</annotation></semantics></math>, any <math id="Thmtheorem1.p1.2.2.m2.2" class="ltx_Math" alttext="\delta\in[0,1]" display="inline"><semantics id="Thmtheorem1.p1.2.2.m2.2a"><mrow id="Thmtheorem1.p1.2.2.m2.2.3" xref="Thmtheorem1.p1.2.2.m2.2.3.cmml"><mi id="Thmtheorem1.p1.2.2.m2.2.3.2" xref="Thmtheorem1.p1.2.2.m2.2.3.2.cmml">δ</mi><mo id="Thmtheorem1.p1.2.2.m2.2.3.1" xref="Thmtheorem1.p1.2.2.m2.2.3.1.cmml">∈</mo><mrow id="Thmtheorem1.p1.2.2.m2.2.3.3.2" xref="Thmtheorem1.p1.2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Thmtheorem1.p1.2.2.m2.2.3.3.2.1" xref="Thmtheorem1.p1.2.2.m2.2.3.3.1.cmml">[</mo><mn id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml">0</mn><mo id="Thmtheorem1.p1.2.2.m2.2.3.3.2.2" xref="Thmtheorem1.p1.2.2.m2.2.3.3.1.cmml">,</mo><mn id="Thmtheorem1.p1.2.2.m2.2.2" xref="Thmtheorem1.p1.2.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="Thmtheorem1.p1.2.2.m2.2.3.3.2.3" xref="Thmtheorem1.p1.2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.2b"><apply id="Thmtheorem1.p1.2.2.m2.2.3.cmml" xref="Thmtheorem1.p1.2.2.m2.2.3"><in id="Thmtheorem1.p1.2.2.m2.2.3.1.cmml" xref="Thmtheorem1.p1.2.2.m2.2.3.1"></in><ci id="Thmtheorem1.p1.2.2.m2.2.3.2.cmml" xref="Thmtheorem1.p1.2.2.m2.2.3.2">𝛿</ci><interval closure="closed" id="Thmtheorem1.p1.2.2.m2.2.3.3.1.cmml" xref="Thmtheorem1.p1.2.2.m2.2.3.3.2"><cn type="integer" id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1">0</cn><cn type="integer" id="Thmtheorem1.p1.2.2.m2.2.2.cmml" xref="Thmtheorem1.p1.2.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.2c">\delta\in[0,1]</annotation></semantics></math>, with probability at least <math id="Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="1-\delta" display="inline"><semantics id="Thmtheorem1.p1.3.3.m3.1a"><mrow id="Thmtheorem1.p1.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.cmml"><mn id="Thmtheorem1.p1.3.3.m3.1.1.2" xref="Thmtheorem1.p1.3.3.m3.1.1.2.cmml">1</mn><mo id="Thmtheorem1.p1.3.3.m3.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.cmml">−</mo><mi id="Thmtheorem1.p1.3.3.m3.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.m3.1b"><apply id="Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1"><minus id="Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1"></minus><cn type="integer" id="Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.2">1</cn><ci id="Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.m3.1c">1-\delta</annotation></semantics></math>, for any posterior distribution <math id="Thmtheorem1.p1.4.4.m4.1" class="ltx_Math" alttext="\mathrm{Q}\in\mathcal{M}(\mathcal{H})" display="inline"><semantics id="Thmtheorem1.p1.4.4.m4.1a"><mrow id="Thmtheorem1.p1.4.4.m4.1.2" xref="Thmtheorem1.p1.4.4.m4.1.2.cmml"><mi mathvariant="normal" id="Thmtheorem1.p1.4.4.m4.1.2.2" xref="Thmtheorem1.p1.4.4.m4.1.2.2.cmml">Q</mi><mo id="Thmtheorem1.p1.4.4.m4.1.2.1" xref="Thmtheorem1.p1.4.4.m4.1.2.1.cmml">∈</mo><mrow id="Thmtheorem1.p1.4.4.m4.1.2.3" xref="Thmtheorem1.p1.4.4.m4.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.4.4.m4.1.2.3.2" xref="Thmtheorem1.p1.4.4.m4.1.2.3.2.cmml">ℳ</mi><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.4.4.m4.1.2.3.1" xref="Thmtheorem1.p1.4.4.m4.1.2.3.1.cmml">​</mo><mrow id="Thmtheorem1.p1.4.4.m4.1.2.3.3.2" xref="Thmtheorem1.p1.4.4.m4.1.2.3.cmml"><mo stretchy="false" id="Thmtheorem1.p1.4.4.m4.1.2.3.3.2.1" xref="Thmtheorem1.p1.4.4.m4.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.4.4.m4.1.1" xref="Thmtheorem1.p1.4.4.m4.1.1.cmml">ℋ</mi><mo stretchy="false" id="Thmtheorem1.p1.4.4.m4.1.2.3.3.2.2" xref="Thmtheorem1.p1.4.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.4.4.m4.1b"><apply id="Thmtheorem1.p1.4.4.m4.1.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2"><in id="Thmtheorem1.p1.4.4.m4.1.2.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.1"></in><ci id="Thmtheorem1.p1.4.4.m4.1.2.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.2">Q</ci><apply id="Thmtheorem1.p1.4.4.m4.1.2.3.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.3"><times id="Thmtheorem1.p1.4.4.m4.1.2.3.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.3.1"></times><ci id="Thmtheorem1.p1.4.4.m4.1.2.3.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.3.2">ℳ</ci><ci id="Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1">ℋ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.4.4.m4.1c">\mathrm{Q}\in\mathcal{M}(\mathcal{H})</annotation></semantics></math>,</span></p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\displaystyle\mathrm{kl}\left(\text{R}_{\mathcal{D}}(\mathrm{Q}),\text{R}_{\mathcal{S}}(\mathrm{Q})\right)\leq\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m}," display="inline"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1.2" xref="S2.E1.m1.5.5.1.1.2.cmml"><mi id="S2.E1.m1.5.5.1.1.2.4" xref="S2.E1.m1.5.5.1.1.2.4.cmml">kl</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.2.3" xref="S2.E1.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.3.cmml"><mo id="S2.E1.m1.5.5.1.1.2.2.2.3" xref="S2.E1.m1.5.5.1.1.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.3.2.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi mathvariant="normal" id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">Q</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.2.2.2.4" xref="S2.E1.m1.5.5.1.1.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml"><msub id="S2.E1.m1.5.5.1.1.2.2.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.2.2.2.2.1" xref="S2.E1.m1.5.5.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.2.2.3.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.2.2.3.2.1" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml">(</mo><mi mathvariant="normal" id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">Q</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.2.2.3.2.2" xref="S2.E1.m1.5.5.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.2.2.2.5" xref="S2.E1.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml">≤</mo><mstyle displaystyle="true" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mfrac id="S2.E1.m1.2.2a" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mrow id="S2.E1.m1.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">KL</mi><mo id="S2.E1.m1.2.2.2.2.1a" xref="S2.E1.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.2.cmml">(</mo><mrow id="S2.E1.m1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.E1.m1.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S2.E1.m1.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.1.cmml">∥</mo><mi mathvariant="normal" id="S2.E1.m1.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">+</mo><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml"><mi id="S2.E1.m1.2.2.2.4.1" xref="S2.E1.m1.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S2.E1.m1.2.2.2.4a" xref="S2.E1.m1.2.2.2.4.cmml">⁡</mo><mfrac id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.2.cmml"><mrow id="S2.E1.m1.2.2.2.4.2.2" xref="S2.E1.m1.2.2.2.4.2.2.cmml"><mn id="S2.E1.m1.2.2.2.4.2.2.2" xref="S2.E1.m1.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.4.2.2.1" xref="S2.E1.m1.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="S2.E1.m1.2.2.2.4.2.2.3" xref="S2.E1.m1.2.2.2.4.2.2.3.cmml"><mi id="S2.E1.m1.2.2.2.4.2.2.3.2" xref="S2.E1.m1.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="S2.E1.m1.2.2.2.4.2.3" xref="S2.E1.m1.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mi id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml">m</mi></mfrac></mstyle></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><leq id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"></leq><apply id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2"><times id="S2.E1.m1.5.5.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.3"></times><ci id="S2.E1.m1.5.5.1.1.2.4.cmml" xref="S2.E1.m1.5.5.1.1.2.4">kl</ci><interval closure="open" id="S2.E1.m1.5.5.1.1.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"></times><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.2">R</mtext></ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2.3">𝒟</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">Q</ci></apply><apply id="S2.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2"><times id="S2.E1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.1"></times><apply id="S2.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.2.2.2.2.2.2a.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E1.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.2">R</mtext></ci><ci id="S2.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.2.2.2.3">𝒮</ci></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">Q</ci></apply></interval></apply><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><divide id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2"></divide><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><plus id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"></plus><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.1"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">KL</ci><apply id="S2.E1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2">Q</ci><ci id="S2.E1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3">P</ci></apply></apply><apply id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4"><ln id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4.1"></ln><apply id="S2.E1.m1.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.4.2"><divide id="S2.E1.m1.2.2.2.4.2.1.cmml" xref="S2.E1.m1.2.2.2.4.2"></divide><apply id="S2.E1.m1.2.2.2.4.2.2.cmml" xref="S2.E1.m1.2.2.2.4.2.2"><times id="S2.E1.m1.2.2.2.4.2.2.1.cmml" xref="S2.E1.m1.2.2.2.4.2.2.1"></times><cn type="integer" id="S2.E1.m1.2.2.2.4.2.2.2.cmml" xref="S2.E1.m1.2.2.2.4.2.2.2">2</cn><apply id="S2.E1.m1.2.2.2.4.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4.2.2.3"><root id="S2.E1.m1.2.2.2.4.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.4.2.2.3"></root><ci id="S2.E1.m1.2.2.2.4.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="S2.E1.m1.2.2.2.4.2.3.cmml" xref="S2.E1.m1.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><ci id="S2.E1.m1.2.2.4.cmml" xref="S2.E1.m1.2.2.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\displaystyle\mathrm{kl}\left(\text{R}_{\mathcal{D}}(\mathrm{Q}),\text{R}_{\mathcal{S}}(\mathrm{Q})\right)\leq\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Thmtheorem1.p1.6" class="ltx_p"><span id="Thmtheorem1.p1.6.1" class="ltx_text ltx_font_italic">which leads to the following upper bound on the risk</span></p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.5" class="ltx_Math" alttext="\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})\left\|\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)\right.," display="inline"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.3" xref="S2.E2.m1.5.5.1.1.3.cmml"><msub id="S2.E2.m1.5.5.1.1.3.2" xref="S2.E2.m1.5.5.1.1.3.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.5.5.1.1.3.2.2" xref="S2.E2.m1.5.5.1.1.3.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.5.5.1.1.3.2.3" xref="S2.E2.m1.5.5.1.1.3.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.1.1.3.1" xref="S2.E2.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S2.E2.m1.5.5.1.1.3.3.2" xref="S2.E2.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.1.1.3.3.2.1" xref="S2.E2.m1.5.5.1.1.3.cmml">(</mo><mi mathvariant="normal" id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">Q</mi><mo stretchy="false" id="S2.E2.m1.5.5.1.1.3.3.2.2" xref="S2.E2.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.1.2.cmml">≤</mo><mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.cmml"><msup id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.3.2.cmml">kl</mi><mrow id="S2.E2.m1.5.5.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.3.3.cmml"><mo id="S2.E2.m1.5.5.1.1.1.3.3a" xref="S2.E2.m1.5.5.1.1.1.3.3.cmml">−</mo><mn id="S2.E2.m1.5.5.1.1.1.3.3.2" xref="S2.E2.m1.5.5.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2a.cmml">R</mtext><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.3.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">Q</mi><mo stretchy="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml">∥</mo><mstyle displaystyle="true" id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mfrac id="S2.E2.m1.2.2a" xref="S2.E2.m1.2.2.cmml"><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mrow id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">KL</mi><mo id="S2.E2.m1.2.2.2.2.1a" xref="S2.E2.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.2.cmml">(</mo><mrow id="S2.E2.m1.2.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.E2.m1.2.2.2.2.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S2.E2.m1.2.2.2.2.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.1.cmml">∥</mo><mi mathvariant="normal" id="S2.E2.m1.2.2.2.2.1.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">+</mo><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml"><mi id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S2.E2.m1.2.2.2.4a" xref="S2.E2.m1.2.2.2.4.cmml">⁡</mo><mfrac id="S2.E2.m1.2.2.2.4.2" xref="S2.E2.m1.2.2.2.4.2.cmml"><mrow id="S2.E2.m1.2.2.2.4.2.2" xref="S2.E2.m1.2.2.2.4.2.2.cmml"><mn id="S2.E2.m1.2.2.2.4.2.2.2" xref="S2.E2.m1.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.4.2.2.1" xref="S2.E2.m1.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="S2.E2.m1.2.2.2.4.2.2.3" xref="S2.E2.m1.2.2.2.4.2.2.3.cmml"><mi id="S2.E2.m1.2.2.2.4.2.2.3.2" xref="S2.E2.m1.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="S2.E2.m1.2.2.2.4.2.3" xref="S2.E2.m1.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mi id="S2.E2.m1.2.2.4" xref="S2.E2.m1.2.2.4.cmml">m</mi></mfrac></mstyle></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1"><leq id="S2.E2.m1.5.5.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2"></leq><apply id="S2.E2.m1.5.5.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.3"><times id="S2.E2.m1.5.5.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.3.1"></times><apply id="S2.E2.m1.5.5.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.3.2.2a.cmml" xref="S2.E2.m1.5.5.1.1.3.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.5.5.1.1.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.3.2.2">R</mtext></ci><ci id="S2.E2.m1.5.5.1.1.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.3.2.3">𝒟</ci></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">Q</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.3.2">kl</ci><apply id="S2.E2.m1.5.5.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3.3"><minus id="S2.E2.m1.5.5.1.1.1.3.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.3.3"></minus><cn type="integer" id="S2.E2.m1.5.5.1.1.1.3.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.3.3.2">1</cn></apply></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2"><times id="S2.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.1"></times><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2">R</mtext></ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.2.3">𝒮</ci></apply><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">Q</ci></apply><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><divide id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2"></divide><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><plus id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></plus><apply id="S2.E2.m1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">KL</ci><apply id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.2">Q</ci><ci id="S2.E2.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.3">P</ci></apply></apply><apply id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4"><ln id="S2.E2.m1.2.2.2.4.1.cmml" xref="S2.E2.m1.2.2.2.4.1"></ln><apply id="S2.E2.m1.2.2.2.4.2.cmml" xref="S2.E2.m1.2.2.2.4.2"><divide id="S2.E2.m1.2.2.2.4.2.1.cmml" xref="S2.E2.m1.2.2.2.4.2"></divide><apply id="S2.E2.m1.2.2.2.4.2.2.cmml" xref="S2.E2.m1.2.2.2.4.2.2"><times id="S2.E2.m1.2.2.2.4.2.2.1.cmml" xref="S2.E2.m1.2.2.2.4.2.2.1"></times><cn type="integer" id="S2.E2.m1.2.2.2.4.2.2.2.cmml" xref="S2.E2.m1.2.2.2.4.2.2.2">2</cn><apply id="S2.E2.m1.2.2.2.4.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4.2.2.3"><root id="S2.E2.m1.2.2.2.4.2.2.3a.cmml" xref="S2.E2.m1.2.2.2.4.2.2.3"></root><ci id="S2.E2.m1.2.2.2.4.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="S2.E2.m1.2.2.2.4.2.3.cmml" xref="S2.E2.m1.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><ci id="S2.E2.m1.2.2.4.cmml" xref="S2.E2.m1.2.2.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})\left\|\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)\right.,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Thmtheorem1.p1.5" class="ltx_p"><span id="Thmtheorem1.p1.5.1" class="ltx_text ltx_font_italic">where <math id="Thmtheorem1.p1.5.1.m1.8" class="ltx_Math" alttext="\mathrm{kl}^{-1}(x,b)=\sup\left\{y\in[x,1]\mid kl(x,y)\leq b\right\}" display="inline"><semantics id="Thmtheorem1.p1.5.1.m1.8a"><mrow id="Thmtheorem1.p1.5.1.m1.8.8" xref="Thmtheorem1.p1.5.1.m1.8.8.cmml"><mrow id="Thmtheorem1.p1.5.1.m1.8.8.4" xref="Thmtheorem1.p1.5.1.m1.8.8.4.cmml"><msup id="Thmtheorem1.p1.5.1.m1.8.8.4.2" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.cmml"><mi id="Thmtheorem1.p1.5.1.m1.8.8.4.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.2.cmml">kl</mi><mrow id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.cmml"><mo id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3a" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.cmml">−</mo><mn id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.2" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.5.1.m1.8.8.4.1" xref="Thmtheorem1.p1.5.1.m1.8.8.4.1.cmml">​</mo><mrow id="Thmtheorem1.p1.5.1.m1.8.8.4.3.2" xref="Thmtheorem1.p1.5.1.m1.8.8.4.3.1.cmml"><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.8.8.4.3.2.1" xref="Thmtheorem1.p1.5.1.m1.8.8.4.3.1.cmml">(</mo><mi id="Thmtheorem1.p1.5.1.m1.1.1" xref="Thmtheorem1.p1.5.1.m1.1.1.cmml">x</mi><mo id="Thmtheorem1.p1.5.1.m1.8.8.4.3.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.4.3.1.cmml">,</mo><mi id="Thmtheorem1.p1.5.1.m1.2.2" xref="Thmtheorem1.p1.5.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.8.8.4.3.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.1389em" id="Thmtheorem1.p1.5.1.m1.8.8.3" xref="Thmtheorem1.p1.5.1.m1.8.8.3.cmml">=</mo><mrow id="Thmtheorem1.p1.5.1.m1.8.8.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.cmml"><mo lspace="0.1389em" rspace="0em" id="Thmtheorem1.p1.5.1.m1.8.8.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.2.3.cmml">sup</mo><mrow id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.cmml"><mo id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.1.cmml">{</mo><mrow id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.cmml"><mi id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.2" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.2.cmml">y</mi><mo id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.1" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.1.cmml">∈</mo><mrow id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.2" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.1.cmml"><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.2.1" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.1.cmml">[</mo><mi id="Thmtheorem1.p1.5.1.m1.3.3" xref="Thmtheorem1.p1.5.1.m1.3.3.cmml">x</mi><mo id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.2.2" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mn id="Thmtheorem1.p1.5.1.m1.4.4" xref="Thmtheorem1.p1.5.1.m1.4.4.cmml">1</mn><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.2.3" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo fence="true" lspace="0em" rspace="0em" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.4" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.1.cmml">∣</mo><mrow id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.cmml"><mrow id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.cmml"><mi id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1.cmml">​</mo><mi id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1a" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1.cmml">​</mo><mrow id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.1.cmml"><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.2.1" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.1.cmml">(</mo><mi id="Thmtheorem1.p1.5.1.m1.5.5" xref="Thmtheorem1.p1.5.1.m1.5.5.cmml">x</mi><mo id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.2.2" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.1.cmml">,</mo><mi id="Thmtheorem1.p1.5.1.m1.6.6" xref="Thmtheorem1.p1.5.1.m1.6.6.cmml">y</mi><mo stretchy="false" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.1" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.1.cmml">≤</mo><mi id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.3" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.3.cmml">b</mi></mrow><mo id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.5" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.5.1.m1.8b"><apply id="Thmtheorem1.p1.5.1.m1.8.8.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8"><eq id="Thmtheorem1.p1.5.1.m1.8.8.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.3"></eq><apply id="Thmtheorem1.p1.5.1.m1.8.8.4.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4"><times id="Thmtheorem1.p1.5.1.m1.8.8.4.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.1"></times><apply id="Thmtheorem1.p1.5.1.m1.8.8.4.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.5.1.m1.8.8.4.2.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2">superscript</csymbol><ci id="Thmtheorem1.p1.5.1.m1.8.8.4.2.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.2">kl</ci><apply id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3"><minus id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3"></minus><cn type="integer" id="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.2.3.2">1</cn></apply></apply><interval closure="open" id="Thmtheorem1.p1.5.1.m1.8.8.4.3.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.4.3.2"><ci id="Thmtheorem1.p1.5.1.m1.1.1.cmml" xref="Thmtheorem1.p1.5.1.m1.1.1">𝑥</ci><ci id="Thmtheorem1.p1.5.1.m1.2.2.cmml" xref="Thmtheorem1.p1.5.1.m1.2.2">𝑏</ci></interval></apply><apply id="Thmtheorem1.p1.5.1.m1.8.8.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2"><csymbol cd="latexml" id="Thmtheorem1.p1.5.1.m1.8.8.2.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.3">supremum</csymbol><apply id="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2"><csymbol cd="latexml" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.3.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.3">conditional-set</csymbol><apply id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1"><in id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.1"></in><ci id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.2">𝑦</ci><interval closure="closed" id="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.1.cmml" xref="Thmtheorem1.p1.5.1.m1.7.7.1.1.1.1.3.2"><ci id="Thmtheorem1.p1.5.1.m1.3.3.cmml" xref="Thmtheorem1.p1.5.1.m1.3.3">𝑥</ci><cn type="integer" id="Thmtheorem1.p1.5.1.m1.4.4.cmml" xref="Thmtheorem1.p1.5.1.m1.4.4">1</cn></interval></apply><apply id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2"><leq id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.1"></leq><apply id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2"><times id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.1"></times><ci id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.2.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.2">𝑘</ci><ci id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.3">𝑙</ci><interval closure="open" id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.1.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.2.4.2"><ci id="Thmtheorem1.p1.5.1.m1.5.5.cmml" xref="Thmtheorem1.p1.5.1.m1.5.5">𝑥</ci><ci id="Thmtheorem1.p1.5.1.m1.6.6.cmml" xref="Thmtheorem1.p1.5.1.m1.6.6">𝑦</ci></interval></apply><ci id="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.3.cmml" xref="Thmtheorem1.p1.5.1.m1.8.8.2.2.2.2.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.5.1.m1.8c">\mathrm{kl}^{-1}(x,b)=\sup\left\{y\in[x,1]\mid kl(x,y)\leq b\right\}</annotation></semantics></math>.</span></p>
</div>
</div>
<div id="S2.SS0.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p2.3" class="ltx_p">Note that by the definition of <math id="S2.SS0.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="kl^{-1}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p2.1.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.1" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml">​</mo><msup id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.2.cmml">l</mi><mrow id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.cmml"><mo id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3a" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p2.1.m1.1b"><apply id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1"><times id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.1"></times><ci id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.2">𝑘</ci><apply id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.2">𝑙</ci><apply id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3"><minus id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p2.1.m1.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p2.1.m1.1c">kl^{-1}</annotation></semantics></math>, (<a href="#S2.E2" title="Equation 2 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) is the tightest upper bound on <math id="S2.SS0.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="\text{R}_{\mathcal{D}}(\mathrm{Q})" display="inline"><semantics id="S2.SS0.SSS0.Px2.p2.2.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p2.2.m2.1.2" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.cmml"><msub id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.cmml"><mtext id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.3" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.1" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.3.2" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.3.2.1" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.1.cmml">Q</mi><mo stretchy="false" id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.3.2.2" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p2.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2"><times id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.1"></times><apply id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2a.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2"><mtext id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.2">R</mtext></ci><ci id="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.2.2.3">𝒟</ci></apply><ci id="S2.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p2.2.m2.1.1">Q</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p2.2.m2.1c">\text{R}_{\mathcal{D}}(\mathrm{Q})</annotation></semantics></math> that we can obtain starting from (<a href="#S2.E1" title="Equation 1 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). While <math id="S2.SS0.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="\mathrm{kl}^{-1}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p2.3.m3.1a"><msup id="S2.SS0.SSS0.Px2.p2.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml">kl</mi><mrow id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml"><mo id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3a" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.2" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p2.3.m3.1b"><apply id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.2">kl</ci><apply id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3"><minus id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3"></minus><cn type="integer" id="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p2.3.m3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p2.3.m3.1c">\mathrm{kl}^{-1}</annotation></semantics></math> has no closed form, it is possible to approximate it efficiently via root-finding techniques (see, <span id="S2.SS0.SSS0.Px2.p2.3.1" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">Dziugaite and Roy,, <a href="#bib.bib18" title="" class="ltx_ref">2017</a>, Appendix A</cite>). However, this function is hard to evaluate, and even harder to optimise. We need to rely on looser relaxations of (<a href="#S2.E1" title="Equation 1 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to design tractable optimisation procedures.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p3.1" class="ltx_p"><span id="S2.SS0.SSS0.Px2.p3.1.1" class="ltx_text ltx_font_bold">Relaxations of McAllester’s bound.</span> The most classical relaxation of (<a href="#S2.E1" title="Equation 1 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) relies on Pinsker’s inequality <math id="S2.SS0.SSS0.Px2.p3.1.m1.2" class="ltx_Math" alttext="\mathrm{kl}(q\|p)\geq\frac{(p-q)^{2}}{2}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p3.1.m1.2a"><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.2.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.cmml"><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.cmml"><mi id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.3.cmml">kl</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.2.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.2.cmml">q</mi><mo id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.1.cmml">∥</mo><mi id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.2.cmml">≥</mo><mfrac id="S2.SS0.SSS0.Px2.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.cmml"><msup id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.3.cmml">2</mn></msup><mn id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p3.1.m1.2b"><apply id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2"><geq id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.2"></geq><apply id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1"><times id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.2"></times><ci id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.3.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.3">kl</ci><apply id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.2">𝑞</ci><ci id="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.2.2.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1"><divide id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1"></divide><apply id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1"><minus id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.1"></minus><ci id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.1.1.1.3">𝑞</ci></apply><cn type="integer" id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.1.3">2</cn></apply><cn type="integer" id="S2.SS0.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p3.1.m1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p3.1.m1.2c">\mathrm{kl}(q\|p)\geq\frac{(p-q)^{2}}{2}</annotation></semantics></math> and leads to the following high-probability bound, valid under the same assumptions as <a href="#Thmtheorem1" title="Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Theorem</span> <span class="ltx_text ltx_ref_tag">1</span></a>:</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.5" class="ltx_Math" alttext="\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})+\sqrt{\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}." display="inline"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1.2" xref="S2.E3.m1.5.5.1.1.2.cmml"><msub id="S2.E3.m1.5.5.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.cmml"><mtext id="S2.E3.m1.5.5.1.1.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.1.1.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.1" xref="S2.E3.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.3.2" xref="S2.E3.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.3.2.1" xref="S2.E3.m1.5.5.1.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">Q</mi><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.3.2.2" xref="S2.E3.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.1" xref="S2.E3.m1.5.5.1.1.1.cmml">≤</mo><mrow id="S2.E3.m1.5.5.1.1.3" xref="S2.E3.m1.5.5.1.1.3.cmml"><mrow id="S2.E3.m1.5.5.1.1.3.2" xref="S2.E3.m1.5.5.1.1.3.2.cmml"><msub id="S2.E3.m1.5.5.1.1.3.2.2" xref="S2.E3.m1.5.5.1.1.3.2.2.cmml"><mover accent="true" id="S2.E3.m1.5.5.1.1.3.2.2.2" xref="S2.E3.m1.5.5.1.1.3.2.2.2.cmml"><mtext id="S2.E3.m1.5.5.1.1.3.2.2.2.2" xref="S2.E3.m1.5.5.1.1.3.2.2.2.2a.cmml">R</mtext><mo id="S2.E3.m1.5.5.1.1.3.2.2.2.1" xref="S2.E3.m1.5.5.1.1.3.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.1.1.3.2.2.3" xref="S2.E3.m1.5.5.1.1.3.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.3.2.1" xref="S2.E3.m1.5.5.1.1.3.2.1.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.3.2.3.2" xref="S2.E3.m1.5.5.1.1.3.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.2.3.2.1" xref="S2.E3.m1.5.5.1.1.3.2.cmml">(</mo><mi mathvariant="normal" id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">Q</mi><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.2.3.2.2" xref="S2.E3.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.3.1" xref="S2.E3.m1.5.5.1.1.3.1.cmml">+</mo><msqrt id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mstyle displaystyle="true" id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mfrac id="S2.E3.m1.2.2.2a" xref="S2.E3.m1.2.2.2.cmml"><mrow id="S2.E3.m1.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.cmml"><mrow id="S2.E3.m1.2.2.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">KL</mi><mo id="S2.E3.m1.2.2.2.2.2.2.1a" xref="S2.E3.m1.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.2.2.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.2.2.2.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.E3.m1.2.2.2.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S2.E3.m1.2.2.2.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml">∥</mo><mi mathvariant="normal" id="S2.E3.m1.2.2.2.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.2.3.cmml">+</mo><mrow id="S2.E3.m1.2.2.2.2.2.4" xref="S2.E3.m1.2.2.2.2.2.4.cmml"><mi id="S2.E3.m1.2.2.2.2.2.4.1" xref="S2.E3.m1.2.2.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S2.E3.m1.2.2.2.2.2.4a" xref="S2.E3.m1.2.2.2.2.2.4.cmml">⁡</mo><mfrac id="S2.E3.m1.2.2.2.2.2.4.2" xref="S2.E3.m1.2.2.2.2.2.4.2.cmml"><mrow id="S2.E3.m1.2.2.2.2.2.4.2.2" xref="S2.E3.m1.2.2.2.2.2.4.2.2.cmml"><mn id="S2.E3.m1.2.2.2.2.2.4.2.2.2" xref="S2.E3.m1.2.2.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.4.2.2.1" xref="S2.E3.m1.2.2.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="S2.E3.m1.2.2.2.2.2.4.2.2.3" xref="S2.E3.m1.2.2.2.2.2.4.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.4.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="S2.E3.m1.2.2.2.2.2.4.2.3" xref="S2.E3.m1.2.2.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.4.cmml"><mn id="S2.E3.m1.2.2.2.4.2" xref="S2.E3.m1.2.2.2.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.4.1.cmml">​</mo><mi id="S2.E3.m1.2.2.2.4.3" xref="S2.E3.m1.2.2.2.4.3.cmml">m</mi></mrow></mfrac></mstyle></msqrt></mrow></mrow><mo lspace="0em" id="S2.E3.m1.5.5.1.2" xref="S2.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1"><leq id="S2.E3.m1.5.5.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1"></leq><apply id="S2.E3.m1.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2"><times id="S2.E3.m1.5.5.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.1"></times><apply id="S2.E3.m1.5.5.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.2.2.2a.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2"><mtext id="S2.E3.m1.5.5.1.1.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2">R</mtext></ci><ci id="S2.E3.m1.5.5.1.1.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3">𝒟</ci></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">Q</ci></apply><apply id="S2.E3.m1.5.5.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3"><plus id="S2.E3.m1.5.5.1.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1"></plus><apply id="S2.E3.m1.5.5.1.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.3.2"><times id="S2.E3.m1.5.5.1.1.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.3.2.1"></times><apply id="S2.E3.m1.5.5.1.1.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2">subscript</csymbol><apply id="S2.E3.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2.2"><ci id="S2.E3.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2.2.1">^</ci><ci id="S2.E3.m1.5.5.1.1.3.2.2.2.2a.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2.2.2"><mtext id="S2.E3.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2.2.2">R</mtext></ci></apply><ci id="S2.E3.m1.5.5.1.1.3.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.3.2.2.3">𝒮</ci></apply><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">Q</ci></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><root id="S2.E3.m1.2.2a.cmml" xref="S2.E3.m1.2.2"></root><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><divide id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2"></divide><apply id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2"><plus id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3"></plus><apply id="S2.E3.m1.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1"><ci id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">KL</ci><apply id="S2.E3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.2">Q</ci><ci id="S2.E3.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.2.2.1.1.1.3">P</ci></apply></apply><apply id="S2.E3.m1.2.2.2.2.2.4.cmml" xref="S2.E3.m1.2.2.2.2.2.4"><ln id="S2.E3.m1.2.2.2.2.2.4.1.cmml" xref="S2.E3.m1.2.2.2.2.2.4.1"></ln><apply id="S2.E3.m1.2.2.2.2.2.4.2.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2"><divide id="S2.E3.m1.2.2.2.2.2.4.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2"></divide><apply id="S2.E3.m1.2.2.2.2.2.4.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2"><times id="S2.E3.m1.2.2.2.2.2.4.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2.1"></times><cn type="integer" id="S2.E3.m1.2.2.2.2.2.4.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2.2">2</cn><apply id="S2.E3.m1.2.2.2.2.2.4.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2.3"><root id="S2.E3.m1.2.2.2.2.2.4.2.2.3a.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2.3"></root><ci id="S2.E3.m1.2.2.2.2.2.4.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="S2.E3.m1.2.2.2.2.2.4.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.2.4.cmml" xref="S2.E3.m1.2.2.2.4"><times id="S2.E3.m1.2.2.2.4.1.cmml" xref="S2.E3.m1.2.2.2.4.1"></times><cn type="integer" id="S2.E3.m1.2.2.2.4.2.cmml" xref="S2.E3.m1.2.2.2.4.2">2</cn><ci id="S2.E3.m1.2.2.2.4.3.cmml" xref="S2.E3.m1.2.2.2.4.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})+\sqrt{\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p4.1" class="ltx_p">While (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is well known and already appears in <cite class="ltx_cite ltx_citemacro_citet">McAllester, (<a href="#bib.bib39" title="" class="ltx_ref">2003</a>)</cite>, novel relaxations, exploiting refined Pinsker’s inequality (see, <span id="S2.SS0.SSS0.Px2.p4.1.1" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">Boucheron et al.,, <a href="#bib.bib11" title="" class="ltx_ref">2013</a>, Lemma 8.4</cite>) have been exploited to obtain PAC-Bayes Bernstein bounds <cite class="ltx_cite ltx_citemacro_citep">(Tolstikhin and Seldin,, <a href="#bib.bib60" title="" class="ltx_ref">2013</a>; Mhammedi et al.,, <a href="#bib.bib42" title="" class="ltx_ref">2019</a>)</cite>. Building on this inequality, <cite class="ltx_cite ltx_citemacro_citet">Rivasplata et al., (<a href="#bib.bib49" title="" class="ltx_ref">2019</a>); Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> proposed a <em id="S2.SS0.SSS0.Px2.p4.1.2" class="ltx_emph ltx_font_italic">PAC-Bayes quadratic bound</em> recalled below, valid under the assumptions of <a href="#Thmtheorem1" title="Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Theorem</span> <span class="ltx_text ltx_ref_tag">1</span></a></p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})" display="inline"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.2" xref="S2.E4.m1.1.2.cmml"><msub id="S2.E4.m1.1.2.2" xref="S2.E4.m1.1.2.2.cmml"><mtext id="S2.E4.m1.1.2.2.2" xref="S2.E4.m1.1.2.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.2.2.3" xref="S2.E4.m1.1.2.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.2.1" xref="S2.E4.m1.1.2.1.cmml">​</mo><mrow id="S2.E4.m1.1.2.3.2" xref="S2.E4.m1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.1.2.3.2.1" xref="S2.E4.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">Q</mi><mo stretchy="false" id="S2.E4.m1.1.2.3.2.2" xref="S2.E4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.2.cmml" xref="S2.E4.m1.1.2"><times id="S2.E4.m1.1.2.1.cmml" xref="S2.E4.m1.1.2.1"></times><apply id="S2.E4.m1.1.2.2.cmml" xref="S2.E4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.2.1.cmml" xref="S2.E4.m1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.1.2.2.2a.cmml" xref="S2.E4.m1.1.2.2.2"><mtext id="S2.E4.m1.1.2.2.2.cmml" xref="S2.E4.m1.1.2.2.2">R</mtext></ci><ci id="S2.E4.m1.1.2.2.3.cmml" xref="S2.E4.m1.1.2.2.3">𝒟</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">Q</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.4" class="ltx_math_unparsed" alttext="\displaystyle\leq\left(\sqrt{\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})+\frac{\mathrm{KL}\left(\mathrm{Q}\|\mathrm{P}\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right." display="inline"><semantics id="S2.E4.m2.4a"><mrow id="S2.E4.m2.4b"><mo id="S2.E4.m2.4.5">≤</mo><mrow id="S2.E4.m2.4.6"><mo id="S2.E4.m2.4.6.1">(</mo><msqrt id="S2.E4.m2.4.4"><mrow id="S2.E4.m2.4.4.4"><mrow id="S2.E4.m2.4.4.4.6"><msub id="S2.E4.m2.4.4.4.6.2"><mover accent="true" id="S2.E4.m2.4.4.4.6.2.2"><mtext id="S2.E4.m2.4.4.4.6.2.2.2">R</mtext><mo id="S2.E4.m2.4.4.4.6.2.2.1">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.E4.m2.4.4.4.6.2.3">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.4.4.4.6.1">​</mo><mrow id="S2.E4.m2.4.4.4.6.3.2"><mo stretchy="false" id="S2.E4.m2.4.4.4.6.3.2.1">(</mo><mi mathvariant="normal" id="S2.E4.m2.4.4.4.4">Q</mi><mo stretchy="false" id="S2.E4.m2.4.4.4.6.3.2.2">)</mo></mrow></mrow><mo id="S2.E4.m2.4.4.4.5">+</mo><mstyle displaystyle="true" id="S2.E4.m2.3.3.3.3"><mfrac id="S2.E4.m2.3.3.3.3a"><mrow id="S2.E4.m2.3.3.3.3.3"><mrow id="S2.E4.m2.3.3.3.3.3.3"><mi id="S2.E4.m2.3.3.3.3.3.3.3">KL</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.3.3.3.3.3.3.2">​</mo><mrow id="S2.E4.m2.3.3.3.3.3.3.1.1"><mo id="S2.E4.m2.3.3.3.3.3.3.1.1.2">(</mo><mrow id="S2.E4.m2.3.3.3.3.3.3.1.1.1"><mi mathvariant="normal" id="S2.E4.m2.3.3.3.3.3.3.1.1.1.2">Q</mi><mo id="S2.E4.m2.3.3.3.3.3.3.1.1.1.1">∥</mo><mi mathvariant="normal" id="S2.E4.m2.3.3.3.3.3.3.1.1.1.3">P</mi></mrow><mo id="S2.E4.m2.3.3.3.3.3.3.1.1.3">)</mo></mrow></mrow><mo id="S2.E4.m2.3.3.3.3.3.4">+</mo><mrow id="S2.E4.m2.3.3.3.3.3.5.2"><mi id="S2.E4.m2.1.1.1.1.1.1">log</mi><mo id="S2.E4.m2.3.3.3.3.3.5.2a">⁡</mo><mrow id="S2.E4.m2.3.3.3.3.3.5.2.1"><mo id="S2.E4.m2.3.3.3.3.3.5.2.1.1">(</mo><mfrac id="S2.E4.m2.2.2.2.2.2.2"><mrow id="S2.E4.m2.2.2.2.2.2.2.2"><mn id="S2.E4.m2.2.2.2.2.2.2.2.2">2</mn><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.2.2.2.2.2.1">​</mo><msqrt id="S2.E4.m2.2.2.2.2.2.2.2.3"><mi id="S2.E4.m2.2.2.2.2.2.2.2.3.2">m</mi></msqrt></mrow><mi id="S2.E4.m2.2.2.2.2.2.2.3">δ</mi></mfrac><mo id="S2.E4.m2.3.3.3.3.3.5.2.1.2">)</mo></mrow></mrow></mrow><mrow id="S2.E4.m2.3.3.3.3.5"><mn id="S2.E4.m2.3.3.3.3.5.2">2</mn><mo lspace="0em" rspace="0em" id="S2.E4.m2.3.3.3.3.5.1">​</mo><mi id="S2.E4.m2.3.3.3.3.5.3">m</mi></mrow></mfrac></mstyle></mrow></msqrt></mrow></mrow><annotation encoding="application/x-tex" id="S2.E4.m2.4c">\displaystyle\leq\left(\sqrt{\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})+\frac{\mathrm{KL}\left(\mathrm{Q}\|\mathrm{P}\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\left.+\sqrt{\frac{\operatorname{KL}\left(\mathrm{Q}\|\mathrm{P}\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right)^{2}." display="inline"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4b"><mo id="S2.E5.m1.4.5">+</mo><msqrt id="S2.E5.m1.4.4"><mstyle displaystyle="true" id="S2.E5.m1.4.4.4"><mfrac id="S2.E5.m1.4.4.4a"><mrow id="S2.E5.m1.4.4.4.4.4"><mrow id="S2.E5.m1.4.4.4.4.4.4.1"><mi id="S2.E5.m1.1.1.1.1.1.1">KL</mi><mo id="S2.E5.m1.4.4.4.4.4.4.1a">⁡</mo><mrow id="S2.E5.m1.4.4.4.4.4.4.1.1"><mo id="S2.E5.m1.4.4.4.4.4.4.1.1.2">(</mo><mrow id="S2.E5.m1.4.4.4.4.4.4.1.1.1"><mi mathvariant="normal" id="S2.E5.m1.4.4.4.4.4.4.1.1.1.2">Q</mi><mo id="S2.E5.m1.4.4.4.4.4.4.1.1.1.1">∥</mo><mi mathvariant="normal" id="S2.E5.m1.4.4.4.4.4.4.1.1.1.3">P</mi></mrow><mo id="S2.E5.m1.4.4.4.4.4.4.1.1.3">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.4.4.4.5">+</mo><mrow id="S2.E5.m1.4.4.4.4.4.6.2"><mi id="S2.E5.m1.2.2.2.2.2.2">log</mi><mo id="S2.E5.m1.4.4.4.4.4.6.2a">⁡</mo><mrow id="S2.E5.m1.4.4.4.4.4.6.2.1"><mo id="S2.E5.m1.4.4.4.4.4.6.2.1.1">(</mo><mfrac id="S2.E5.m1.3.3.3.3.3.3"><mrow id="S2.E5.m1.3.3.3.3.3.3.2"><mn id="S2.E5.m1.3.3.3.3.3.3.2.2">2</mn><mo lspace="0em" rspace="0em" id="S2.E5.m1.3.3.3.3.3.3.2.1">​</mo><msqrt id="S2.E5.m1.3.3.3.3.3.3.2.3"><mi id="S2.E5.m1.3.3.3.3.3.3.2.3.2">m</mi></msqrt></mrow><mi id="S2.E5.m1.3.3.3.3.3.3.3">δ</mi></mfrac><mo id="S2.E5.m1.4.4.4.4.4.6.2.1.2">)</mo></mrow></mrow></mrow><mrow id="S2.E5.m1.4.4.4.6"><mn id="S2.E5.m1.4.4.4.6.2">2</mn><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.4.6.1">​</mo><mi id="S2.E5.m1.4.4.4.6.3">m</mi></mrow></mfrac></mstyle></msqrt><mo id="S2.E5.m1.4.6">)</mo><msup id="S2.E5.m1.4.7"><mi id="S2.E5.m1.4.7a"></mi><mn id="S2.E5.m1.4.7.1">2</mn></msup><mo lspace="0em" id="S2.E5.m1.4.8">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\displaystyle\left.+\sqrt{\frac{\operatorname{KL}\left(\mathrm{Q}\|\mathrm{P}\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right)^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p5.1" class="ltx_p">Note that (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) are easier to optimise than (<a href="#S2.E2" title="Equation 2 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), making them more relevant for practical learning algorithms.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p6" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p6.3" class="ltx_p"><span id="S2.SS0.SSS0.Px2.p6.3.1" class="ltx_text ltx_font_bold">Generalisation-driven learning algorithms.</span> Most of the PAC-Bayesian bounds in the literature are fully empirical. This paves the way to use the bound as a training objectives and leads to generalisation-driven learning algorithms.
A classical PAC-Bayesian algorithm is derived from Catoni’s bound (see, <span id="S2.SS0.SSS0.Px2.p6.3.2" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">Catoni,, <a href="#bib.bib12" title="" class="ltx_ref">2007</a></cite>, <cite class="ltx_cite ltx_citemacro_citep">Alquier et al.,, <a href="#bib.bib4" title="" class="ltx_ref">2016</a>, Theorem 4.1</cite>):</p>
<table id="A3.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.5" class="ltx_math_unparsed" alttext="\displaystyle\operatorname*{argmin}_{\mathrm{Q}\in\mathcal{M}_{(}\mathcal{H})}\text{R}_{\mathcal{S}}(\mathrm{Q})+\frac{\operatorname{KL}(\mathrm{Q},\mathrm{P})}{\lambda}." display="inline"><semantics id="S2.E6.m1.5a"><mrow id="S2.E6.m1.5.5.1"><mrow id="S2.E6.m1.5.5.1.1"><mrow id="S2.E6.m1.5.5.1.1.2"><mrow id="S2.E6.m1.5.5.1.1.2.2"><munder id="S2.E6.m1.5.5.1.1.2.2.1"><mo id="S2.E6.m1.5.5.1.1.2.2.1.2">argmin</mo><mrow id="S2.E6.m1.5.5.1.1.2.2.1.3"><mi mathvariant="normal" id="S2.E6.m1.5.5.1.1.2.2.1.3.1">Q</mi><mo id="S2.E6.m1.5.5.1.1.2.2.1.3.2">∈</mo><msub id="S2.E6.m1.5.5.1.1.2.2.1.3.3"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.5.5.1.1.2.2.1.3.3.2">ℳ</mi><mo stretchy="false" id="S2.E6.m1.5.5.1.1.2.2.1.3.3.3">(</mo></msub><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.5.5.1.1.2.2.1.3.4">ℋ</mi><mo stretchy="false" id="S2.E6.m1.5.5.1.1.2.2.1.3.5">)</mo></mrow></munder><msub id="S2.E6.m1.5.5.1.1.2.2.2"><mtext id="S2.E6.m1.5.5.1.1.2.2.2.2">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.5.5.1.1.2.2.2.3">𝒮</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.5.5.1.1.2.1">​</mo><mrow id="S2.E6.m1.5.5.1.1.2.3.2"><mo stretchy="false" id="S2.E6.m1.5.5.1.1.2.3.2.1">(</mo><mi mathvariant="normal" id="S2.E6.m1.4.4">Q</mi><mo stretchy="false" id="S2.E6.m1.5.5.1.1.2.3.2.2">)</mo></mrow></mrow><mo id="S2.E6.m1.5.5.1.1.1">+</mo><mstyle displaystyle="true" id="S2.E6.m1.3.3"><mfrac id="S2.E6.m1.3.3a"><mrow id="S2.E6.m1.3.3.3.5"><mi id="S2.E6.m1.1.1.1.1">KL</mi><mo id="S2.E6.m1.3.3.3.5a">⁡</mo><mrow id="S2.E6.m1.3.3.3.5.1"><mo stretchy="false" id="S2.E6.m1.3.3.3.5.1.1">(</mo><mi mathvariant="normal" id="S2.E6.m1.2.2.2.2">Q</mi><mo id="S2.E6.m1.3.3.3.5.1.2">,</mo><mi mathvariant="normal" id="S2.E6.m1.3.3.3.3">P</mi><mo stretchy="false" id="S2.E6.m1.3.3.3.5.1.3">)</mo></mrow></mrow><mi id="S2.E6.m1.3.3.5">λ</mi></mfrac></mstyle></mrow><mo lspace="0em" id="S2.E6.m1.5.5.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E6.m1.5b">\displaystyle\operatorname*{argmin}_{\mathrm{Q}\in\mathcal{M}_{(}\mathcal{H})}\text{R}_{\mathcal{S}}(\mathrm{Q})+\frac{\operatorname{KL}(\mathrm{Q},\mathrm{P})}{\lambda}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS0.SSS0.Px2.p6.2" class="ltx_p">In (<a href="#S2.E6" title="Equation 6 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) an <em id="S2.SS0.SSS0.Px2.p6.2.1" class="ltx_emph ltx_font_italic">inverse temperature</em> <math id="S2.SS0.SSS0.Px2.p6.1.m1.1" class="ltx_Math" alttext="\lambda&gt;0" display="inline"><semantics id="S2.SS0.SSS0.Px2.p6.1.m1.1a"><mrow id="S2.SS0.SSS0.Px2.p6.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.2" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.2.cmml">λ</mi><mo id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.1" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.1.cmml">&gt;</mo><mn id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.3" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p6.1.m1.1b"><apply id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1"><gt id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.1"></gt><ci id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.2">𝜆</ci><cn type="integer" id="S2.SS0.SSS0.Px2.p6.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p6.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p6.1.m1.1c">\lambda&gt;0</annotation></semantics></math> appears and acts as a learning rate in gradient descent. Similarly, it is possible to derive batch learning algorithms from (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) <cite class="ltx_cite ltx_citemacro_citep">(Dziugaite and Roy,, <a href="#bib.bib18" title="" class="ltx_ref">2017</a>; Pérez-Ortiz et al.,, <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>. Then, we have access to a theoretical upper bound which requires to approximate expectations over <math id="S2.SS0.SSS0.Px2.p6.2.m2.1" class="ltx_Math" alttext="\mathrm{Q}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p6.2.m2.1a"><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p6.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p6.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p6.2.m2.1b"><ci id="S2.SS0.SSS0.Px2.p6.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p6.2.m2.1.1">Q</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p6.2.m2.1c">\mathrm{Q}</annotation></semantics></math>. We next discuss how to mitigate this.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p7" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p7.3" class="ltx_p"><span id="S2.SS0.SSS0.Px2.p7.3.1" class="ltx_text ltx_font_bold">Computing generalisation guarantees.</span>
In practice, the tightest McAllester’s bound is computed,<span id="S2.SS0.SSS0.Px2.p7.3.2" class="ltx_text ltx_font_italic">i.e.</span>, (<a href="#S2.E1" title="Equation 1 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). First, note that the KL divergence is easy to compute in the Gaussian case as it has a closed form (see, <span id="S2.SS0.SSS0.Px2.p7.3.3" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">Duchi,, <a href="#bib.bib17" title="" class="ltx_ref">2007</a>, Section 9</cite>). Then, it remains to estimate the expected empirical risk over <math id="S2.SS0.SSS0.Px2.p7.1.m1.1" class="ltx_Math" alttext="\mathrm{Q}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p7.1.m1.1a"><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p7.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p7.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p7.1.m1.1b"><ci id="S2.SS0.SSS0.Px2.p7.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.1.m1.1.1">Q</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p7.1.m1.1c">\mathrm{Q}</annotation></semantics></math>, which is costly in practice as it involves Monte Carlo approximations. To alleviate this issue, we leverage the trick from <cite class="ltx_cite ltx_citemacro_citet">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>, Section 3.3)</cite>, which exploit a high probability upper bound of <math id="S2.SS0.SSS0.Px2.p7.2.m2.1" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})" display="inline"><semantics id="S2.SS0.SSS0.Px2.p7.2.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p7.2.m2.1.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.cmml"><msub id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.cmml"><mtext id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2a.cmml">R</mtext><mo id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.1" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.3" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.1" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.3.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.3.2.1" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p7.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.1.cmml">Q</mi><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.3.2.2" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p7.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2"><times id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.1"></times><apply id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2"><ci id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2a.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2"><mtext id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.2.2">R</mtext></ci></apply><ci id="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.2.2.3">𝒮</ci></apply><ci id="S2.SS0.SSS0.Px2.p7.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.2.m2.1.1">Q</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p7.2.m2.1c">\hat{\text{R}}_{\mathcal{S}}(\mathrm{Q})</annotation></semantics></math> with confidence level <math id="S2.SS0.SSS0.Px2.p7.3.m3.1" class="ltx_Math" alttext="\delta^{\prime}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p7.3.m3.1a"><msup id="S2.SS0.SSS0.Px2.p7.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1.2.cmml">δ</mi><mo id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p7.3.m3.1b"><apply id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1.2">𝛿</ci><ci id="S2.SS0.SSS0.Px2.p7.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p7.3.m3.1c">\delta^{\prime}</annotation></semantics></math></p>
<table id="A3.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\text{R}}_{\mathcal{S}}(Q)" display="inline"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.2" xref="S2.Ex1.m1.1.2.cmml"><msub id="S2.Ex1.m1.1.2.2" xref="S2.Ex1.m1.1.2.2.cmml"><mover accent="true" id="S2.Ex1.m1.1.2.2.2" xref="S2.Ex1.m1.1.2.2.2.cmml"><mtext id="S2.Ex1.m1.1.2.2.2.2" xref="S2.Ex1.m1.1.2.2.2.2a.cmml">R</mtext><mo id="S2.Ex1.m1.1.2.2.2.1" xref="S2.Ex1.m1.1.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.1.2.2.3" xref="S2.Ex1.m1.1.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.1.2.1" xref="S2.Ex1.m1.1.2.1.cmml">​</mo><mrow id="S2.Ex1.m1.1.2.3.2" xref="S2.Ex1.m1.1.2.cmml"><mo stretchy="false" id="S2.Ex1.m1.1.2.3.2.1" xref="S2.Ex1.m1.1.2.cmml">(</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">Q</mi><mo stretchy="false" id="S2.Ex1.m1.1.2.3.2.2" xref="S2.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.2.cmml" xref="S2.Ex1.m1.1.2"><times id="S2.Ex1.m1.1.2.1.cmml" xref="S2.Ex1.m1.1.2.1"></times><apply id="S2.Ex1.m1.1.2.2.cmml" xref="S2.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.2.2.1.cmml" xref="S2.Ex1.m1.1.2.2">subscript</csymbol><apply id="S2.Ex1.m1.1.2.2.2.cmml" xref="S2.Ex1.m1.1.2.2.2"><ci id="S2.Ex1.m1.1.2.2.2.1.cmml" xref="S2.Ex1.m1.1.2.2.2.1">^</ci><ci id="S2.Ex1.m1.1.2.2.2.2a.cmml" xref="S2.Ex1.m1.1.2.2.2.2"><mtext id="S2.Ex1.m1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.1.2.2.2.2">R</mtext></ci></apply><ci id="S2.Ex1.m1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.2.2.3">𝒮</ci></apply><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle\hat{\text{R}}_{\mathcal{S}}(Q)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\hat{Q}_{n})\left\|\frac{1}{n}\ln\left(\frac{2}{\delta^{{}^{\prime}}}\right)\right)\right.," display="inline"><semantics id="S2.Ex1.m2.3a"><mrow id="S2.Ex1.m2.3.3.1" xref="S2.Ex1.m2.3.3.1.1.cmml"><mrow id="S2.Ex1.m2.3.3.1.1" xref="S2.Ex1.m2.3.3.1.1.cmml"><mi id="S2.Ex1.m2.3.3.1.1.3" xref="S2.Ex1.m2.3.3.1.1.3.cmml"></mi><mo id="S2.Ex1.m2.3.3.1.1.2" xref="S2.Ex1.m2.3.3.1.1.2.cmml">≤</mo><mrow id="S2.Ex1.m2.3.3.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.cmml"><msup id="S2.Ex1.m2.3.3.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.3.cmml"><mi id="S2.Ex1.m2.3.3.1.1.1.3.2" xref="S2.Ex1.m2.3.3.1.1.1.3.2.cmml">kl</mi><mrow id="S2.Ex1.m2.3.3.1.1.1.3.3" xref="S2.Ex1.m2.3.3.1.1.1.3.3.cmml"><mo id="S2.Ex1.m2.3.3.1.1.1.3.3a" xref="S2.Ex1.m2.3.3.1.1.1.3.3.cmml">−</mo><mn id="S2.Ex1.m2.3.3.1.1.1.3.3.2" xref="S2.Ex1.m2.3.3.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.3.3.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.cmml"><mtext id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2a.cmml">R</mtext><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="true" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.2.cmml">∥</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.cmml"><mfrac id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2a" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.cmml"><mn id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.3.cmml">n</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml"><mi id="S2.Ex1.m2.1.1" xref="S2.Ex1.m2.1.1.cmml">ln</mi><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2a" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml"><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2.1.1" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S2.Ex1.m2.2.2" xref="S2.Ex1.m2.2.2.cmml"><mfrac id="S2.Ex1.m2.2.2a" xref="S2.Ex1.m2.2.2.cmml"><mn id="S2.Ex1.m2.2.2.2" xref="S2.Ex1.m2.2.2.2.cmml">2</mn><msup id="S2.Ex1.m2.2.2.3" xref="S2.Ex1.m2.2.2.3.cmml"><mi id="S2.Ex1.m2.2.2.3.2" xref="S2.Ex1.m2.2.2.3.2.cmml">δ</mi><msup id="S2.Ex1.m2.2.2.3.3" xref="S2.Ex1.m2.2.2.3.3.cmml"><mi id="S2.Ex1.m2.2.2.3.3a" xref="S2.Ex1.m2.2.2.3.3.cmml"></mi><mo id="S2.Ex1.m2.2.2.3.3.1" xref="S2.Ex1.m2.2.2.3.3.1.cmml">′</mo></msup></msup></mfrac></mstyle><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2.1.2" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m2.3.3.1.1.1.1.1.3" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m2.3.3.1.2" xref="S2.Ex1.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m2.3b"><apply id="S2.Ex1.m2.3.3.1.1.cmml" xref="S2.Ex1.m2.3.3.1"><leq id="S2.Ex1.m2.3.3.1.1.2.cmml" xref="S2.Ex1.m2.3.3.1.1.2"></leq><csymbol cd="latexml" id="S2.Ex1.m2.3.3.1.1.3.cmml" xref="S2.Ex1.m2.3.3.1.1.3">absent</csymbol><apply id="S2.Ex1.m2.3.3.1.1.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1"><times id="S2.Ex1.m2.3.3.1.1.1.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.2"></times><apply id="S2.Ex1.m2.3.3.1.1.1.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.3.3.1.1.1.3.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3">superscript</csymbol><ci id="S2.Ex1.m2.3.3.1.1.1.3.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3.2">kl</ci><apply id="S2.Ex1.m2.3.3.1.1.1.3.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3.3"><minus id="S2.Ex1.m2.3.3.1.1.1.3.3.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3.3"></minus><cn type="integer" id="S2.Ex1.m2.3.3.1.1.1.3.3.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.3.3.2">1</cn></apply></apply><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1"><times id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.2"></times><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2"><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2"><mtext id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.2.2">R</mtext></ci></apply><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.3.3">𝒮</ci></apply><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑄</ci></apply><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3"><times id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2"><divide id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2"></divide><cn type="integer" id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.2">1</cn><ci id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m2.3.3.1.1.1.1.1.1.3.3.2"><ln id="S2.Ex1.m2.1.1.cmml" xref="S2.Ex1.m2.1.1"></ln><apply id="S2.Ex1.m2.2.2.cmml" xref="S2.Ex1.m2.2.2"><divide id="S2.Ex1.m2.2.2.1.cmml" xref="S2.Ex1.m2.2.2"></divide><cn type="integer" id="S2.Ex1.m2.2.2.2.cmml" xref="S2.Ex1.m2.2.2.2">2</cn><apply id="S2.Ex1.m2.2.2.3.cmml" xref="S2.Ex1.m2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.2.2.3.1.cmml" xref="S2.Ex1.m2.2.2.3">superscript</csymbol><ci id="S2.Ex1.m2.2.2.3.2.cmml" xref="S2.Ex1.m2.2.2.3.2">𝛿</ci><apply id="S2.Ex1.m2.2.2.3.3.cmml" xref="S2.Ex1.m2.2.2.3.3"><ci id="S2.Ex1.m2.2.2.3.3.1.cmml" xref="S2.Ex1.m2.2.2.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m2.3c">\displaystyle\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\hat{Q}_{n})\left\|\frac{1}{n}\ln\left(\frac{2}{\delta^{{}^{\prime}}}\right)\right)\right.,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS0.SSS0.Px2.p7.5" class="ltx_p">where <math id="S2.SS0.SSS0.Px2.p7.4.m1.2" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}}({\hat{Q}_{n}})=\frac{1}{n}\sum_{i=1}^{n}\ell(W_{i},z_{i}),\forall i,W_{i}\sim\mathrm{Q}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p7.4.m1.2a"><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.3.cmml"><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.cmml"><mtext id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2a.cmml">R</mtext><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.4" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.3.cmml"><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.cmml"><mfrac id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.cmml"><mn id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.2.cmml">1</mn><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.3.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.cmml"><msubsup id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.cmml"><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.3.cmml">n</mi></msubsup><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.cmml"><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.4" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.3.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.3.cmml">(</mo><msub id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.4" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.3.cmml">,</mo><msub id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.5" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.3.cmml">,</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.cmml"><mo rspace="0.167em" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.1.cmml">∀</mo><mi id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.2.cmml">i</mi></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.cmml"><msub id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.1" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.1.cmml">∼</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.3.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p7.4.m1.2b"><apply id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.3a.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1"><eq id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.4"></eq><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1"><times id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.2"></times><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2"><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2a.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2"><mtext id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.2.2">R</mtext></ci></apply><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.3.3">𝒮</ci></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2"><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.2.2">𝑄</ci></apply><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><list id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2"><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1"><times id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.3"></times><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4"><divide id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4"></divide><cn type="integer" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.2">1</cn><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.4.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2"><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3">subscript</csymbol><sum id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.2"></sum><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3"><eq id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.1"></eq><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.3.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2"><times id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.3"></times><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.4.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.4">ℓ</ci><interval closure="open" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2"><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.2.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.1">for-all</csymbol><ci id="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.1.1.1.1.3.2.2.2">𝑖</ci></apply></list></apply><apply id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.1">similar-to</csymbol><apply id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p7.4.m1.2.2.2.2.3">Q</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p7.4.m1.2c">\hat{\text{R}}_{\mathcal{S}}({\hat{Q}_{n}})=\frac{1}{n}\sum_{i=1}^{n}\ell(W_{i},z_{i}),\forall i,W_{i}\sim\mathrm{Q}</annotation></semantics></math>. Then incorporating this upper bound in (<a href="#S2.E1" title="Equation 1 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) gives the final bound we use, with probability at least <math id="S2.SS0.SSS0.Px2.p7.5.m2.1" class="ltx_Math" alttext="1-\delta-\delta^{\prime}" display="inline"><semantics id="S2.SS0.SSS0.Px2.p7.5.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p7.5.m2.1.1" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.cmml"><mn id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.2" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1.cmml">−</mo><mi id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.3" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.3.cmml">δ</mi><mo id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1a" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1.cmml">−</mo><msup id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.2" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.2.cmml">δ</mi><mo id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.3" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p7.5.m2.1b"><apply id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1"><minus id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.1"></minus><cn type="integer" id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.2">1</cn><ci id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.3">𝛿</ci><apply id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.2">𝛿</ci><ci id="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px2.p7.5.m2.1.1.4.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p7.5.m2.1c">1-\delta-\delta^{\prime}</annotation></semantics></math>:</p>
</div>
<div id="S2.SS0.SSS0.Px2.p8" class="ltx_para ltx_noindent">
<table id="A3.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E7.m1.5" class="ltx_Math" alttext="\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}^{n}(\mathrm{Q})\left\|\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)\right.," display="inline"><semantics id="S2.E7.m1.5a"><mrow id="S2.E7.m1.5.5.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1.3" xref="S2.E7.m1.5.5.1.1.3.cmml"><msub id="S2.E7.m1.5.5.1.1.3.2" xref="S2.E7.m1.5.5.1.1.3.2.cmml"><mtext id="S2.E7.m1.5.5.1.1.3.2.2" xref="S2.E7.m1.5.5.1.1.3.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.5.5.1.1.3.2.3" xref="S2.E7.m1.5.5.1.1.3.2.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="S2.E7.m1.5.5.1.1.3.1" xref="S2.E7.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S2.E7.m1.5.5.1.1.3.3.2" xref="S2.E7.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S2.E7.m1.5.5.1.1.3.3.2.1" xref="S2.E7.m1.5.5.1.1.3.cmml">(</mo><mi mathvariant="normal" id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml">Q</mi><mo stretchy="false" id="S2.E7.m1.5.5.1.1.3.3.2.2" xref="S2.E7.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.5.5.1.1.2" xref="S2.E7.m1.5.5.1.1.2.cmml">≤</mo><mrow id="S2.E7.m1.5.5.1.1.1" xref="S2.E7.m1.5.5.1.1.1.cmml"><msup id="S2.E7.m1.5.5.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.3.2" xref="S2.E7.m1.5.5.1.1.1.3.2.cmml">kl</mi><mrow id="S2.E7.m1.5.5.1.1.1.3.3" xref="S2.E7.m1.5.5.1.1.1.3.3.cmml"><mo id="S2.E7.m1.5.5.1.1.1.3.3a" xref="S2.E7.m1.5.5.1.1.1.3.3.cmml">−</mo><mn id="S2.E7.m1.5.5.1.1.1.3.3.2" xref="S2.E7.m1.5.5.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E7.m1.5.5.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.5.5.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.cmml"><msubsup id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml"><mtext id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2a.cmml">R</mtext><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">𝒮</mi><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.3.2.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mi mathvariant="normal" id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml">Q</mi><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.3.2.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="true" id="S2.E7.m1.5.5.1.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml">∥</mo><mstyle displaystyle="true" id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mfrac id="S2.E7.m1.2.2a" xref="S2.E7.m1.2.2.cmml"><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.2.cmml"><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">KL</mi><mo id="S2.E7.m1.2.2.2.2.1a" xref="S2.E7.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E7.m1.2.2.2.2.1.1" xref="S2.E7.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.2.2.1.1.2" xref="S2.E7.m1.2.2.2.2.2.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.E7.m1.2.2.2.2.1.1.1.2" xref="S2.E7.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S2.E7.m1.2.2.2.2.1.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.1.cmml">∥</mo><mi mathvariant="normal" id="S2.E7.m1.2.2.2.2.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="S2.E7.m1.2.2.2.2.1.1.3" xref="S2.E7.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">+</mo><mrow id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.4.cmml"><mi id="S2.E7.m1.2.2.2.4.1" xref="S2.E7.m1.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S2.E7.m1.2.2.2.4a" xref="S2.E7.m1.2.2.2.4.cmml">⁡</mo><mfrac id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.4.2.cmml"><mrow id="S2.E7.m1.2.2.2.4.2.2" xref="S2.E7.m1.2.2.2.4.2.2.cmml"><mn id="S2.E7.m1.2.2.2.4.2.2.2" xref="S2.E7.m1.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.4.2.2.1" xref="S2.E7.m1.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="S2.E7.m1.2.2.2.4.2.2.3" xref="S2.E7.m1.2.2.2.4.2.2.3.cmml"><mi id="S2.E7.m1.2.2.2.4.2.2.3.2" xref="S2.E7.m1.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="S2.E7.m1.2.2.2.4.2.3" xref="S2.E7.m1.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mi id="S2.E7.m1.2.2.4" xref="S2.E7.m1.2.2.4.cmml">m</mi></mfrac></mstyle></mrow><mo id="S2.E7.m1.5.5.1.1.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.5.5.1.2" xref="S2.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.5b"><apply id="S2.E7.m1.5.5.1.1.cmml" xref="S2.E7.m1.5.5.1"><leq id="S2.E7.m1.5.5.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.2"></leq><apply id="S2.E7.m1.5.5.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.3"><times id="S2.E7.m1.5.5.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.3.1"></times><apply id="S2.E7.m1.5.5.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.3.2.1.cmml" xref="S2.E7.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.3.2.2a.cmml" xref="S2.E7.m1.5.5.1.1.3.2.2"><mtext id="S2.E7.m1.5.5.1.1.3.2.2.cmml" xref="S2.E7.m1.5.5.1.1.3.2.2">R</mtext></ci><ci id="S2.E7.m1.5.5.1.1.3.2.3.cmml" xref="S2.E7.m1.5.5.1.1.3.2.3">𝒟</ci></apply><ci id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3">Q</ci></apply><apply id="S2.E7.m1.5.5.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1"><times id="S2.E7.m1.5.5.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.2"></times><apply id="S2.E7.m1.5.5.1.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.3">superscript</csymbol><ci id="S2.E7.m1.5.5.1.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.3.2">kl</ci><apply id="S2.E7.m1.5.5.1.1.1.3.3.cmml" xref="S2.E7.m1.5.5.1.1.1.3.3"><minus id="S2.E7.m1.5.5.1.1.1.3.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.3.3"></minus><cn type="integer" id="S2.E7.m1.5.5.1.1.1.3.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.3.3.2">1</cn></apply></apply><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2"><times id="S2.E7.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.1"></times><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2"><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2a.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2"><mtext id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2">R</mtext></ci></apply><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3">𝒮</ci></apply><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2.2.3">𝑛</ci></apply><ci id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4">Q</ci></apply><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><divide id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2"></divide><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><plus id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></plus><apply id="S2.E7.m1.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.1"><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">KL</ci><apply id="S2.E7.m1.2.2.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.2">Q</ci><ci id="S2.E7.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.3">P</ci></apply></apply><apply id="S2.E7.m1.2.2.2.4.cmml" xref="S2.E7.m1.2.2.2.4"><ln id="S2.E7.m1.2.2.2.4.1.cmml" xref="S2.E7.m1.2.2.2.4.1"></ln><apply id="S2.E7.m1.2.2.2.4.2.cmml" xref="S2.E7.m1.2.2.2.4.2"><divide id="S2.E7.m1.2.2.2.4.2.1.cmml" xref="S2.E7.m1.2.2.2.4.2"></divide><apply id="S2.E7.m1.2.2.2.4.2.2.cmml" xref="S2.E7.m1.2.2.2.4.2.2"><times id="S2.E7.m1.2.2.2.4.2.2.1.cmml" xref="S2.E7.m1.2.2.2.4.2.2.1"></times><cn type="integer" id="S2.E7.m1.2.2.2.4.2.2.2.cmml" xref="S2.E7.m1.2.2.2.4.2.2.2">2</cn><apply id="S2.E7.m1.2.2.2.4.2.2.3.cmml" xref="S2.E7.m1.2.2.2.4.2.2.3"><root id="S2.E7.m1.2.2.2.4.2.2.3a.cmml" xref="S2.E7.m1.2.2.2.4.2.2.3"></root><ci id="S2.E7.m1.2.2.2.4.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="S2.E7.m1.2.2.2.4.2.3.cmml" xref="S2.E7.m1.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><ci id="S2.E7.m1.2.2.4.cmml" xref="S2.E7.m1.2.2.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.5c">\displaystyle\text{R}_{\mathcal{D}}(\mathrm{Q})\leq\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}^{n}(\mathrm{Q})\left\|\frac{\operatorname{KL}(\mathrm{Q}\|\mathrm{P})+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)\right.,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px2.p9" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p9.1" class="ltx_p">where <math id="S2.SS0.SSS0.Px2.p9.1.m1.4" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}}^{n}(\mathrm{Q})=\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\hat{Q}_{n})\left\|\frac{1}{n}\ln\left(\frac{2}{\delta^{{}^{\prime}}}\right)\right)\right." display="inline"><semantics id="S2.SS0.SSS0.Px2.p9.1.m1.4a"><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.cmml"><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.cmml"><msubsup id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.cmml"><mtext id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2a.cmml">R</mtext><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.3.cmml">𝒮</mi><mi id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.3.2.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.cmml">(</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px2.p9.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.1.1.cmml">Q</mi><mo stretchy="false" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.3.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.2.cmml">=</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.cmml"><msup id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.2.cmml">kl</mi><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.cmml"><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3a" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.2.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.cmml"><mtext id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2a.cmml">R</mtext><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="true" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.2.cmml">∥</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.cmml"><mfrac id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.cmml"><mn id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.2.cmml">1</mn><mi id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.3.cmml">n</mi></mfrac><mo lspace="0.167em" rspace="0em" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml"><mi id="S2.SS0.SSS0.Px2.p9.1.m1.2.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.2.2.cmml">ln</mi><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2a" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml"><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2.1.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml">(</mo><mfrac id="S2.SS0.SSS0.Px2.p9.1.m1.3.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.cmml"><mn id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.2.cmml">2</mn><msup id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.2.cmml">δ</mi><msup id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3a" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.cmml"></mi><mo id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.1" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.1.cmml">′</mo></msup></msup></mfrac><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2.1.2" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.3" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p9.1.m1.4b"><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4"><eq id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.2"></eq><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3"><times id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.1"></times><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2"><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2a.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2"><mtext id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.2.2">R</mtext></ci></apply><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.2.3">𝒮</ci></apply><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.3.2.3">𝑛</ci></apply><ci id="S2.SS0.SSS0.Px2.p9.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.1.1">Q</ci></apply><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1"><times id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.2"></times><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.2">kl</ci><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3"><minus id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3"></minus><cn type="integer" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.3.3.2">1</cn></apply></apply><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.2">conditional</csymbol><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1"><times id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.2"></times><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2"><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2a.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2"><mtext id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.2.2">R</mtext></ci></apply><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.3.3">𝒮</ci></apply><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2"><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝑄</ci></apply><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3"><times id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.1"></times><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2"><divide id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2"></divide><cn type="integer" id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.2">1</cn><ci id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.4.4.1.1.1.1.3.3.2"><ln id="S2.SS0.SSS0.Px2.p9.1.m1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.2.2"></ln><apply id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3"><divide id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3"></divide><cn type="integer" id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.2">2</cn><apply id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.2">𝛿</ci><apply id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3"><ci id="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p9.1.m1.3.3.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p9.1.m1.4c">\hat{\text{R}}_{\mathcal{S}}^{n}(\mathrm{Q})=\mathrm{kl}^{-1}\left(\hat{\text{R}}_{\mathcal{S}}(\hat{Q}_{n})\left\|\frac{1}{n}\ln\left(\frac{2}{\delta^{{}^{\prime}}}\right)\right)\right.</annotation></semantics></math>.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p10" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p10.2" class="ltx_p">To compute <math id="S2.SS0.SSS0.Px2.p10.1.m1.2" class="ltx_Math" alttext="\mathrm{kl}^{-1}(p,c)" display="inline"><semantics id="S2.SS0.SSS0.Px2.p10.1.m1.2a"><mrow id="S2.SS0.SSS0.Px2.p10.1.m1.2.3" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.cmml"><msup id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.2.cmml">kl</mi><mrow id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.cmml"><mo id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3a" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.cmml">−</mo><mn id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.1" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.1.cmml">​</mo><mrow id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.2.1" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px2.p10.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p10.1.m1.1.1.cmml">p</mi><mo id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.2.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p10.1.m1.2.2" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.2.cmml">c</mi><mo stretchy="false" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.2.3" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p10.1.m1.2b"><apply id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3"><times id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.1"></times><apply id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.2">kl</ci><apply id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3"><minus id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3"></minus><cn type="integer" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.2.3.2">1</cn></apply></apply><interval closure="open" id="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.3.3.2"><ci id="S2.SS0.SSS0.Px2.p10.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.1.1">𝑝</ci><ci id="S2.SS0.SSS0.Px2.p10.1.m1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p10.1.m1.2.2">𝑐</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p10.1.m1.2c">\mathrm{kl}^{-1}(p,c)</annotation></semantics></math> for any <math id="S2.SS0.SSS0.Px2.p10.2.m2.2" class="ltx_Math" alttext="p,c" display="inline"><semantics id="S2.SS0.SSS0.Px2.p10.2.m2.2a"><mrow id="S2.SS0.SSS0.Px2.p10.2.m2.2.3.2" xref="S2.SS0.SSS0.Px2.p10.2.m2.2.3.1.cmml"><mi id="S2.SS0.SSS0.Px2.p10.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p10.2.m2.1.1.cmml">p</mi><mo id="S2.SS0.SSS0.Px2.p10.2.m2.2.3.2.1" xref="S2.SS0.SSS0.Px2.p10.2.m2.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px2.p10.2.m2.2.2" xref="S2.SS0.SSS0.Px2.p10.2.m2.2.2.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p10.2.m2.2b"><list id="S2.SS0.SSS0.Px2.p10.2.m2.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p10.2.m2.2.3.2"><ci id="S2.SS0.SSS0.Px2.p10.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p10.2.m2.1.1">𝑝</ci><ci id="S2.SS0.SSS0.Px2.p10.2.m2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p10.2.m2.2.2">𝑐</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p10.2.m2.2c">p,c</annotation></semantics></math>, we leverage <cite class="ltx_cite ltx_citemacro_citet">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>, Appendix A)</cite> described in <a href="#A1" title="Appendix A Approximating the inverted 𝑘⁢𝑙" class="ltx_ref"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>GENERALISATION-DRIVEN FEDERATED LEARNING</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section we introduce our algorithm <span id="S3.p1.1.1" class="ltx_text ltx_font_smallcaps">GenFL</span>.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">From batch to federated PAC-Bayes algorithms.</span>
When training stochastic neural nets (SNNs) with PAC-Bayes objectives, it is common to assume that each weight follows a Gaussian distribution. For conciseness, we identify a SNN to the Gaussian distribution of all its weights <math id="S3.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{N}(\mu,Diag(\sigma_{i}))" display="inline"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.2.2.3" xref="S3.p2.1.m1.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.2" xref="S3.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S3.p2.1.m1.2.2.1.1" xref="S3.p2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.p2.1.m1.2.2.1.1.2" xref="S3.p2.1.m1.2.2.1.2.cmml">(</mo><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">μ</mi><mo id="S3.p2.1.m1.2.2.1.1.3" xref="S3.p2.1.m1.2.2.1.2.cmml">,</mo><mrow id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.p2.1.m1.2.2.1.1.1.4" xref="S3.p2.1.m1.2.2.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.1.1.1.2a" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.p2.1.m1.2.2.1.1.1.5" xref="S3.p2.1.m1.2.2.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.1.1.1.2b" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S3.p2.1.m1.2.2.1.1.1.6" xref="S3.p2.1.m1.2.2.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.1.1.1.2c" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.p2.1.m1.2.2.1.1.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.2.2.1.1.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.1.m1.2.2.1.1.1.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.1.m1.2.2.1.1.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.p2.1.m1.2.2.1.1.4" xref="S3.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><apply id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2"><times id="S3.p2.1.m1.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2"></times><ci id="S3.p2.1.m1.2.2.3.cmml" xref="S3.p2.1.m1.2.2.3">𝒩</ci><interval closure="open" id="S3.p2.1.m1.2.2.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝜇</ci><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><times id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2"></times><ci id="S3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3">𝐷</ci><ci id="S3.p2.1.m1.2.2.1.1.1.4.cmml" xref="S3.p2.1.m1.2.2.1.1.1.4">𝑖</ci><ci id="S3.p2.1.m1.2.2.1.1.1.5.cmml" xref="S3.p2.1.m1.2.2.1.1.1.5">𝑎</ci><ci id="S3.p2.1.m1.2.2.1.1.1.6.cmml" xref="S3.p2.1.m1.2.2.1.1.1.6">𝑔</ci><apply id="S3.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">\mathcal{N}(\mu,Diag(\sigma_{i}))</annotation></semantics></math>.
The works of <cite class="ltx_cite ltx_citemacro_citet">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>); Rivasplata et al., (<a href="#bib.bib49" title="" class="ltx_ref">2019</a>); Biggs and Guedj, (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>); Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>); Perez-Ortiz et al., (<a href="#bib.bib46" title="" class="ltx_ref">2021</a>); Biggs and Guedj, (<a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> proposed successful PAC-Bayesian training algorithms for SNNs which ensure generalisation guarantees. All these methods operate in a batch setting, <span id="S3.p2.1.2" class="ltx_text ltx_font_italic">i.e.</span>, the optimiser has access to all data simultaneously. Thus, building on the work of <cite class="ltx_cite ltx_citemacro_citet">Rivasplata et al., (<a href="#bib.bib49" title="" class="ltx_ref">2019</a>); Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, we propose <a href="#alg1" title="In 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Alg.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, a new learning algorithm called <span id="S3.p2.1.3" class="ltx_text ltx_font_smallcaps">GenFL</span> (Generalisation-driven Federated Learning), casting PAC-Bayes into FL. We stress that <span id="S3.p2.1.4" class="ltx_text ltx_font_smallcaps">GenFL</span> benefits from nonvacuous generalisation guarantees (<a href="#S4" title="4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.17.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.18.2" class="ltx_text ltx_font_smallcaps">GenFL</span>. users are indexed by <math id="alg1.8.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.8.m1.1b"><mi id="alg1.8.m1.1.1" xref="alg1.8.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m1.1c"><ci id="alg1.8.m1.1.1.cmml" xref="alg1.8.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m1.1d">k</annotation></semantics></math>; <math id="alg1.9.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.9.m2.1b"><mi id="alg1.9.m2.1.1" xref="alg1.9.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.9.m2.1c"><ci id="alg1.9.m2.1.1.cmml" xref="alg1.9.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m2.1d">B</annotation></semantics></math> is the local minibatch size, <math id="alg1.10.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.10.m3.1b"><mi id="alg1.10.m3.1.1" xref="alg1.10.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m3.1c"><ci id="alg1.10.m3.1.1.cmml" xref="alg1.10.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m3.1d">E</annotation></semantics></math> is the number of local epochs, <math id="alg1.11.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.11.m4.1b"><mi id="alg1.11.m4.1.1" xref="alg1.11.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.11.m4.1c"><ci id="alg1.11.m4.1.1.cmml" xref="alg1.11.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m4.1d">\eta</annotation></semantics></math> is the learning rate, <math id="alg1.12.m5.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg1.12.m5.1b"><mi id="alg1.12.m5.1.1" xref="alg1.12.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg1.12.m5.1c"><ci id="alg1.12.m5.1.1.cmml" xref="alg1.12.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m5.1d">f</annotation></semantics></math> the PAC-Bayes objective. The prior is <math id="alg1.13.m6.1" class="ltx_Math" alttext="\mathcal{N}(\mu_{\text{prior}}\sigma_{\text{prior}})" display="inline"><semantics id="alg1.13.m6.1b"><mrow id="alg1.13.m6.1.1" xref="alg1.13.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.m6.1.1.3" xref="alg1.13.m6.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg1.13.m6.1.1.2" xref="alg1.13.m6.1.1.2.cmml">​</mo><mrow id="alg1.13.m6.1.1.1.1" xref="alg1.13.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.13.m6.1.1.1.1.2" xref="alg1.13.m6.1.1.1.1.1.cmml">(</mo><mrow id="alg1.13.m6.1.1.1.1.1" xref="alg1.13.m6.1.1.1.1.1.cmml"><msub id="alg1.13.m6.1.1.1.1.1.2" xref="alg1.13.m6.1.1.1.1.1.2.cmml"><mi id="alg1.13.m6.1.1.1.1.1.2.2" xref="alg1.13.m6.1.1.1.1.1.2.2.cmml">μ</mi><mtext id="alg1.13.m6.1.1.1.1.1.2.3" xref="alg1.13.m6.1.1.1.1.1.2.3a.cmml">prior</mtext></msub><mo lspace="0em" rspace="0em" id="alg1.13.m6.1.1.1.1.1.1" xref="alg1.13.m6.1.1.1.1.1.1.cmml">​</mo><msub id="alg1.13.m6.1.1.1.1.1.3" xref="alg1.13.m6.1.1.1.1.1.3.cmml"><mi id="alg1.13.m6.1.1.1.1.1.3.2" xref="alg1.13.m6.1.1.1.1.1.3.2.cmml">σ</mi><mtext id="alg1.13.m6.1.1.1.1.1.3.3" xref="alg1.13.m6.1.1.1.1.1.3.3a.cmml">prior</mtext></msub></mrow><mo stretchy="false" id="alg1.13.m6.1.1.1.1.3" xref="alg1.13.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.m6.1c"><apply id="alg1.13.m6.1.1.cmml" xref="alg1.13.m6.1.1"><times id="alg1.13.m6.1.1.2.cmml" xref="alg1.13.m6.1.1.2"></times><ci id="alg1.13.m6.1.1.3.cmml" xref="alg1.13.m6.1.1.3">𝒩</ci><apply id="alg1.13.m6.1.1.1.1.1.cmml" xref="alg1.13.m6.1.1.1.1"><times id="alg1.13.m6.1.1.1.1.1.1.cmml" xref="alg1.13.m6.1.1.1.1.1.1"></times><apply id="alg1.13.m6.1.1.1.1.1.2.cmml" xref="alg1.13.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.13.m6.1.1.1.1.1.2.1.cmml" xref="alg1.13.m6.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.13.m6.1.1.1.1.1.2.2.cmml" xref="alg1.13.m6.1.1.1.1.1.2.2">𝜇</ci><ci id="alg1.13.m6.1.1.1.1.1.2.3a.cmml" xref="alg1.13.m6.1.1.1.1.1.2.3"><mtext mathsize="70%" id="alg1.13.m6.1.1.1.1.1.2.3.cmml" xref="alg1.13.m6.1.1.1.1.1.2.3">prior</mtext></ci></apply><apply id="alg1.13.m6.1.1.1.1.1.3.cmml" xref="alg1.13.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.13.m6.1.1.1.1.1.3.1.cmml" xref="alg1.13.m6.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.13.m6.1.1.1.1.1.3.2.cmml" xref="alg1.13.m6.1.1.1.1.1.3.2">𝜎</ci><ci id="alg1.13.m6.1.1.1.1.1.3.3a.cmml" xref="alg1.13.m6.1.1.1.1.1.3.3"><mtext mathsize="70%" id="alg1.13.m6.1.1.1.1.1.3.3.cmml" xref="alg1.13.m6.1.1.1.1.1.3.3">prior</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.m6.1d">\mathcal{N}(\mu_{\text{prior}}\sigma_{\text{prior}})</annotation></semantics></math> with parameter <math id="alg1.14.m7.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg1.14.m7.1b"><mi id="alg1.14.m7.1.1" xref="alg1.14.m7.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg1.14.m7.1c"><ci id="alg1.14.m7.1.1.cmml" xref="alg1.14.m7.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.m7.1d">\delta</annotation></semantics></math>.</figcaption>
<div id="alg1.19" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="m\leftarrow\sum_{k=1}^{K}m_{k}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">m</mi><mo rspace="0.111em" stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><msubsup id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml"><mo id="alg1.l2.m1.1.1.3.1.2.2" xref="alg1.l2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l2.m1.1.1.3.1.2.3" xref="alg1.l2.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l2.m1.1.1.3.1.2.3.2" xref="alg1.l2.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l2.m1.1.1.3.1.2.3.1" xref="alg1.l2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3.1.2.3.3" xref="alg1.l2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l2.m1.1.1.3.1.3" xref="alg1.l2.m1.1.1.3.1.3.cmml">K</mi></msubsup><msub id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml"><mi id="alg1.l2.m1.1.1.3.2.2" xref="alg1.l2.m1.1.1.3.2.2.cmml">m</mi><mi id="alg1.l2.m1.1.1.3.2.3" xref="alg1.l2.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑚</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><apply id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.1.cmml" xref="alg1.l2.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l2.m1.1.1.3.1.2.cmml" xref="alg1.l2.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.2.1.cmml" xref="alg1.l2.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l2.m1.1.1.3.1.2.2.cmml" xref="alg1.l2.m1.1.1.3.1.2.2"></sum><apply id="alg1.l2.m1.1.1.3.1.2.3.cmml" xref="alg1.l2.m1.1.1.3.1.2.3"><eq id="alg1.l2.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l2.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l2.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l2.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l2.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l2.m1.1.1.3.1.3.cmml" xref="alg1.l2.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.2.1.cmml" xref="alg1.l2.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.2.cmml" xref="alg1.l2.m1.1.1.3.2.2">𝑚</ci><ci id="alg1.l2.m1.1.1.3.2.3.cmml" xref="alg1.l2.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">m\leftarrow\sum_{k=1}^{K}m_{k}</annotation></semantics></math> <span id="alg1.l2.1" class="ltx_text" style="float:right;"><math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation></semantics></math> Total dataset size
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><math id="alg1.l3.m1.2" class="ltx_Math" alttext="w_{1}\leftarrow(\mu_{\text{prior}},\sigma_{\text{prior}})" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><msub id="alg1.l3.m1.2.2.4" xref="alg1.l3.m1.2.2.4.cmml"><mi id="alg1.l3.m1.2.2.4.2" xref="alg1.l3.m1.2.2.4.2.cmml">w</mi><mn id="alg1.l3.m1.2.2.4.3" xref="alg1.l3.m1.2.2.4.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml">←</mo><mrow id="alg1.l3.m1.2.2.2.2" xref="alg1.l3.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l3.m1.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.2.cmml">μ</mi><mtext id="alg1.l3.m1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.3a.cmml">prior</mtext></msub><mo id="alg1.l3.m1.2.2.2.2.4" xref="alg1.l3.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l3.m1.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.cmml"><mi id="alg1.l3.m1.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.cmml">σ</mi><mtext id="alg1.l3.m1.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.3a.cmml">prior</mtext></msub><mo stretchy="false" id="alg1.l3.m1.2.2.2.2.5" xref="alg1.l3.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><ci id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3">←</ci><apply id="alg1.l3.m1.2.2.4.cmml" xref="alg1.l3.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.4.1.cmml" xref="alg1.l3.m1.2.2.4">subscript</csymbol><ci id="alg1.l3.m1.2.2.4.2.cmml" xref="alg1.l3.m1.2.2.4.2">𝑤</ci><cn type="integer" id="alg1.l3.m1.2.2.4.3.cmml" xref="alg1.l3.m1.2.2.4.3">1</cn></apply><interval closure="open" id="alg1.l3.m1.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2"><apply id="alg1.l3.m1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l3.m1.1.1.1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg1.l3.m1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.3">prior</mtext></ci></apply><apply id="alg1.l3.m1.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l3.m1.2.2.2.2.2.3a.cmml" xref="alg1.l3.m1.2.2.2.2.2.3"><mtext mathsize="70%" id="alg1.l3.m1.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.3">prior</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">w_{1}\leftarrow(\mu_{\text{prior}},\sigma_{\text{prior}})</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l4.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">t</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg1.l5.m1.3" class="ltx_Math" alttext="S_{t}\leftarrow\text{random set of }\max(C\cdot K,1)\text{ users}" display="inline"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><msub id="alg1.l5.m1.3.3.3" xref="alg1.l5.m1.3.3.3.cmml"><mi id="alg1.l5.m1.3.3.3.2" xref="alg1.l5.m1.3.3.3.2.cmml">S</mi><mi id="alg1.l5.m1.3.3.3.3" xref="alg1.l5.m1.3.3.3.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l5.m1.3.3.2" xref="alg1.l5.m1.3.3.2.cmml">←</mo><mrow id="alg1.l5.m1.3.3.1" xref="alg1.l5.m1.3.3.1.cmml"><mtext id="alg1.l5.m1.3.3.1.3" xref="alg1.l5.m1.3.3.1.3a.cmml">random set of </mtext><mo lspace="0.167em" rspace="0em" id="alg1.l5.m1.3.3.1.2" xref="alg1.l5.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l5.m1.3.3.1.1.1" xref="alg1.l5.m1.3.3.1.1.2.cmml"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">max</mi><mo id="alg1.l5.m1.3.3.1.1.1a" xref="alg1.l5.m1.3.3.1.1.2.cmml">⁡</mo><mrow id="alg1.l5.m1.3.3.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.3.3.1.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg1.l5.m1.3.3.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.1.1.1.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l5.m1.3.3.1.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml">⋅</mo><mi id="alg1.l5.m1.3.3.1.1.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="alg1.l5.m1.3.3.1.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.2.cmml">,</mo><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l5.m1.3.3.1.1.1.1.4" xref="alg1.l5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.3.1.2a" xref="alg1.l5.m1.3.3.1.2.cmml">​</mo><mtext id="alg1.l5.m1.3.3.1.4" xref="alg1.l5.m1.3.3.1.4a.cmml"> users</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><ci id="alg1.l5.m1.3.3.2.cmml" xref="alg1.l5.m1.3.3.2">←</ci><apply id="alg1.l5.m1.3.3.3.cmml" xref="alg1.l5.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.1.cmml" xref="alg1.l5.m1.3.3.3">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.2.cmml" xref="alg1.l5.m1.3.3.3.2">𝑆</ci><ci id="alg1.l5.m1.3.3.3.3.cmml" xref="alg1.l5.m1.3.3.3.3">𝑡</ci></apply><apply id="alg1.l5.m1.3.3.1.cmml" xref="alg1.l5.m1.3.3.1"><times id="alg1.l5.m1.3.3.1.2.cmml" xref="alg1.l5.m1.3.3.1.2"></times><ci id="alg1.l5.m1.3.3.1.3a.cmml" xref="alg1.l5.m1.3.3.1.3"><mtext id="alg1.l5.m1.3.3.1.3.cmml" xref="alg1.l5.m1.3.3.1.3">random set of </mtext></ci><apply id="alg1.l5.m1.3.3.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1"><max id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"></max><apply id="alg1.l5.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1"><ci id="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1">⋅</ci><ci id="alg1.l5.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.2">𝐶</ci><ci id="alg1.l5.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.3">𝐾</ci></apply><cn type="integer" id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">1</cn></apply><ci id="alg1.l5.m1.3.3.1.4a.cmml" xref="alg1.l5.m1.3.3.1.4"><mtext id="alg1.l5.m1.3.3.1.4.cmml" xref="alg1.l5.m1.3.3.1.4"> users</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">S_{t}\leftarrow\text{random set of }\max(C\cdot K,1)\text{ users}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> each user <math id="alg1.l6.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">k</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑘</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑆</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">k\in S_{t}</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>         <math id="alg1.l7.m1.3" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow\textrm{userUpdate}(k,w_{t},m)" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><msubsup id="alg1.l7.m1.3.3.3" xref="alg1.l7.m1.3.3.3.cmml"><mi id="alg1.l7.m1.3.3.3.2.2" xref="alg1.l7.m1.3.3.3.2.2.cmml">w</mi><mrow id="alg1.l7.m1.3.3.3.2.3" xref="alg1.l7.m1.3.3.3.2.3.cmml"><mi id="alg1.l7.m1.3.3.3.2.3.2" xref="alg1.l7.m1.3.3.3.2.3.2.cmml">t</mi><mo id="alg1.l7.m1.3.3.3.2.3.1" xref="alg1.l7.m1.3.3.3.2.3.1.cmml">+</mo><mn id="alg1.l7.m1.3.3.3.2.3.3" xref="alg1.l7.m1.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l7.m1.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.3.3.2" xref="alg1.l7.m1.3.3.2.cmml">←</mo><mrow id="alg1.l7.m1.3.3.1" xref="alg1.l7.m1.3.3.1.cmml"><mtext id="alg1.l7.m1.3.3.1.3" xref="alg1.l7.m1.3.3.1.3a.cmml">userUpdate</mtext><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.1.2" xref="alg1.l7.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l7.m1.3.3.1.1.1" xref="alg1.l7.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.2.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">k</mi><mo id="alg1.l7.m1.3.3.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.2.cmml">,</mo><msub id="alg1.l7.m1.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.cmml">w</mi><mi id="alg1.l7.m1.3.3.1.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l7.m1.3.3.1.1.1.4" xref="alg1.l7.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">m</mi><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.5" xref="alg1.l7.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.2.cmml" xref="alg1.l7.m1.3.3.2">←</ci><apply id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.1.cmml" xref="alg1.l7.m1.3.3.3">superscript</csymbol><apply id="alg1.l7.m1.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.2.1.cmml" xref="alg1.l7.m1.3.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.2.2.cmml" xref="alg1.l7.m1.3.3.3.2.2">𝑤</ci><apply id="alg1.l7.m1.3.3.3.2.3.cmml" xref="alg1.l7.m1.3.3.3.2.3"><plus id="alg1.l7.m1.3.3.3.2.3.1.cmml" xref="alg1.l7.m1.3.3.3.2.3.1"></plus><ci id="alg1.l7.m1.3.3.3.2.3.2.cmml" xref="alg1.l7.m1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.3.3.3.2.3.3.cmml" xref="alg1.l7.m1.3.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l7.m1.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3">𝑘</ci></apply><apply id="alg1.l7.m1.3.3.1.cmml" xref="alg1.l7.m1.3.3.1"><times id="alg1.l7.m1.3.3.1.2.cmml" xref="alg1.l7.m1.3.3.1.2"></times><ci id="alg1.l7.m1.3.3.1.3a.cmml" xref="alg1.l7.m1.3.3.1.3"><mtext id="alg1.l7.m1.3.3.1.3.cmml" xref="alg1.l7.m1.3.3.1.3">userUpdate</mtext></ci><vector id="alg1.l7.m1.3.3.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑘</ci><apply id="alg1.l7.m1.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2">𝑤</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3">𝑡</ci></apply><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝑚</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">w_{t+1}^{k}\leftarrow\textrm{userUpdate}(k,w_{t},m)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{m_{k}}{m}w_{t+1}^{k}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml"><mo id="alg1.l9.m1.1.1.3.1.2.2" xref="alg1.l9.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l9.m1.1.1.3.1.2.3" xref="alg1.l9.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.1.2.3.2" xref="alg1.l9.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l9.m1.1.1.3.1.2.3.1" xref="alg1.l9.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3.1.2.3.3" xref="alg1.l9.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.1.1.3.1.3" xref="alg1.l9.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mfrac id="alg1.l9.m1.1.1.3.2.2" xref="alg1.l9.m1.1.1.3.2.2.cmml"><msub id="alg1.l9.m1.1.1.3.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l9.m1.1.1.3.2.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.2.cmml">m</mi><mi id="alg1.l9.m1.1.1.3.2.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l9.m1.1.1.3.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.2.1" xref="alg1.l9.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.2.3.2.2" xref="alg1.l9.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="alg1.l9.m1.1.1.3.2.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.2.3.2.3.2" xref="alg1.l9.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.2.3.2.3.1" xref="alg1.l9.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.3.2.3.2.3.3" xref="alg1.l9.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.1.1.3.2.3.3" xref="alg1.l9.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑤</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><plus id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></plus><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><apply id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.1.cmml" xref="alg1.l9.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.1.2.cmml" xref="alg1.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.2.1.cmml" xref="alg1.l9.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l9.m1.1.1.3.1.2.2.cmml" xref="alg1.l9.m1.1.1.3.1.2.2"></sum><apply id="alg1.l9.m1.1.1.3.1.2.3.cmml" xref="alg1.l9.m1.1.1.3.1.2.3"><eq id="alg1.l9.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l9.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l9.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.1.1.3.1.3.cmml" xref="alg1.l9.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><times id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.1"></times><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2"><divide id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.2"></divide><apply id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2.2">𝑚</ci><ci id="alg1.l9.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3">𝑚</ci></apply><apply id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.2.3">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.2">𝑤</ci><apply id="alg1.l9.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3"><plus id="alg1.l9.m1.1.1.3.2.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3.1"></plus><ci id="alg1.l9.m1.1.1.3.2.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.3.2.3.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.1.1.3.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{m_{k}}{m}w_{t+1}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span><span id="alg1.l12.1" class="ltx_text ltx_font_bold">userUpdate(k, w, m):</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span><math id="alg1.l13.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow(\text{split }\mathcal{S}_{k}\text{ into batches of size B})" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">ℬ</mi><mo stretchy="false" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">←</mo><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mtext id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2a.cmml">split </mtext><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">​</mo><msub id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.1.3.2.cmml">𝒮</mi><mi id="alg1.l13.m1.1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.1.1.1.1a" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="alg1.l13.m1.1.1.1.1.1.4" xref="alg1.l13.m1.1.1.1.1.1.4a.cmml"> into batches of size B</mtext></mrow><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">←</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">ℬ</ci><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><times id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"></times><ci id="alg1.l13.m1.1.1.1.1.1.2a.cmml" xref="alg1.l13.m1.1.1.1.1.1.2"><mtext id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">split </mtext></ci><apply id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.3.2">𝒮</ci><ci id="alg1.l13.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3.3">𝑘</ci></apply><ci id="alg1.l13.m1.1.1.1.1.1.4a.cmml" xref="alg1.l13.m1.1.1.1.1.1.4"><mtext id="alg1.l13.m1.1.1.1.1.1.4.cmml" xref="alg1.l13.m1.1.1.1.1.1.4"> into batches of size B</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathcal{B}\leftarrow(\text{split }\mathcal{S}_{k}\text{ into batches of size B})</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span><span id="alg1.l14.1" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l14.m1.4" class="ltx_Math" alttext="e=1,2,\cdots,E" display="inline"><semantics id="alg1.l14.m1.4a"><mrow id="alg1.l14.m1.4.5" xref="alg1.l14.m1.4.5.cmml"><mi id="alg1.l14.m1.4.5.2" xref="alg1.l14.m1.4.5.2.cmml">e</mi><mo id="alg1.l14.m1.4.5.1" xref="alg1.l14.m1.4.5.1.cmml">=</mo><mrow id="alg1.l14.m1.4.5.3.2" xref="alg1.l14.m1.4.5.3.1.cmml"><mn id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">1</mn><mo id="alg1.l14.m1.4.5.3.2.1" xref="alg1.l14.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml">2</mn><mo id="alg1.l14.m1.4.5.3.2.2" xref="alg1.l14.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l14.m1.3.3" xref="alg1.l14.m1.3.3.cmml">⋯</mi><mo id="alg1.l14.m1.4.5.3.2.3" xref="alg1.l14.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l14.m1.4.4" xref="alg1.l14.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.4b"><apply id="alg1.l14.m1.4.5.cmml" xref="alg1.l14.m1.4.5"><eq id="alg1.l14.m1.4.5.1.cmml" xref="alg1.l14.m1.4.5.1"></eq><ci id="alg1.l14.m1.4.5.2.cmml" xref="alg1.l14.m1.4.5.2">𝑒</ci><list id="alg1.l14.m1.4.5.3.1.cmml" xref="alg1.l14.m1.4.5.3.2"><cn type="integer" id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">1</cn><cn type="integer" id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2">2</cn><ci id="alg1.l14.m1.3.3.cmml" xref="alg1.l14.m1.3.3">⋯</ci><ci id="alg1.l14.m1.4.4.cmml" xref="alg1.l14.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.4c">e=1,2,\cdots,E</annotation></semantics></math> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <span id="alg1.l15.1" class="ltx_text ltx_font_bold">for</span> each local minibatch <math id="alg1.l15.m1.1" class="ltx_Math" alttext="b\in B" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">b</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">∈</mo><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><in id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></in><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑏</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">b\in B</annotation></semantics></math> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>         <math id="alg1.l16.m1.2" class="ltx_Math" alttext="w^{k}_{s}\leftarrow\mu^{k}+\sigma^{k}\odot\mathcal{N}(0,1)" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><msubsup id="alg1.l16.m1.2.3.2" xref="alg1.l16.m1.2.3.2.cmml"><mi id="alg1.l16.m1.2.3.2.2.2" xref="alg1.l16.m1.2.3.2.2.2.cmml">w</mi><mi id="alg1.l16.m1.2.3.2.3" xref="alg1.l16.m1.2.3.2.3.cmml">s</mi><mi id="alg1.l16.m1.2.3.2.2.3" xref="alg1.l16.m1.2.3.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l16.m1.2.3.1" xref="alg1.l16.m1.2.3.1.cmml">←</mo><mrow id="alg1.l16.m1.2.3.3" xref="alg1.l16.m1.2.3.3.cmml"><msup id="alg1.l16.m1.2.3.3.2" xref="alg1.l16.m1.2.3.3.2.cmml"><mi id="alg1.l16.m1.2.3.3.2.2" xref="alg1.l16.m1.2.3.3.2.2.cmml">μ</mi><mi id="alg1.l16.m1.2.3.3.2.3" xref="alg1.l16.m1.2.3.3.2.3.cmml">k</mi></msup><mo id="alg1.l16.m1.2.3.3.1" xref="alg1.l16.m1.2.3.3.1.cmml">+</mo><mrow id="alg1.l16.m1.2.3.3.3" xref="alg1.l16.m1.2.3.3.3.cmml"><mrow id="alg1.l16.m1.2.3.3.3.2" xref="alg1.l16.m1.2.3.3.3.2.cmml"><msup id="alg1.l16.m1.2.3.3.3.2.2" xref="alg1.l16.m1.2.3.3.3.2.2.cmml"><mi id="alg1.l16.m1.2.3.3.3.2.2.2" xref="alg1.l16.m1.2.3.3.3.2.2.2.cmml">σ</mi><mi id="alg1.l16.m1.2.3.3.3.2.2.3" xref="alg1.l16.m1.2.3.3.3.2.2.3.cmml">k</mi></msup><mo lspace="0.222em" rspace="0.222em" id="alg1.l16.m1.2.3.3.3.2.1" xref="alg1.l16.m1.2.3.3.3.2.1.cmml">⊙</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.2.3.3.3.2.3" xref="alg1.l16.m1.2.3.3.3.2.3.cmml">𝒩</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.3.3.3.1" xref="alg1.l16.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l16.m1.2.3.3.3.3.2" xref="alg1.l16.m1.2.3.3.3.3.1.cmml"><mo stretchy="false" id="alg1.l16.m1.2.3.3.3.3.2.1" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">(</mo><mn id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">0</mn><mo id="alg1.l16.m1.2.3.3.3.3.2.2" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">,</mo><mn id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l16.m1.2.3.3.3.3.2.3" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><ci id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3.1">←</ci><apply id="alg1.l16.m1.2.3.2.cmml" xref="alg1.l16.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.2.1.cmml" xref="alg1.l16.m1.2.3.2">subscript</csymbol><apply id="alg1.l16.m1.2.3.2.2.cmml" xref="alg1.l16.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.2.2.1.cmml" xref="alg1.l16.m1.2.3.2">superscript</csymbol><ci id="alg1.l16.m1.2.3.2.2.2.cmml" xref="alg1.l16.m1.2.3.2.2.2">𝑤</ci><ci id="alg1.l16.m1.2.3.2.2.3.cmml" xref="alg1.l16.m1.2.3.2.2.3">𝑘</ci></apply><ci id="alg1.l16.m1.2.3.2.3.cmml" xref="alg1.l16.m1.2.3.2.3">𝑠</ci></apply><apply id="alg1.l16.m1.2.3.3.cmml" xref="alg1.l16.m1.2.3.3"><plus id="alg1.l16.m1.2.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.1"></plus><apply id="alg1.l16.m1.2.3.3.2.cmml" xref="alg1.l16.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.3.2.1.cmml" xref="alg1.l16.m1.2.3.3.2">superscript</csymbol><ci id="alg1.l16.m1.2.3.3.2.2.cmml" xref="alg1.l16.m1.2.3.3.2.2">𝜇</ci><ci id="alg1.l16.m1.2.3.3.2.3.cmml" xref="alg1.l16.m1.2.3.3.2.3">𝑘</ci></apply><apply id="alg1.l16.m1.2.3.3.3.cmml" xref="alg1.l16.m1.2.3.3.3"><times id="alg1.l16.m1.2.3.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.3.1"></times><apply id="alg1.l16.m1.2.3.3.3.2.cmml" xref="alg1.l16.m1.2.3.3.3.2"><csymbol cd="latexml" id="alg1.l16.m1.2.3.3.3.2.1.cmml" xref="alg1.l16.m1.2.3.3.3.2.1">direct-product</csymbol><apply id="alg1.l16.m1.2.3.3.3.2.2.cmml" xref="alg1.l16.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.3.3.2.2.1.cmml" xref="alg1.l16.m1.2.3.3.3.2.2">superscript</csymbol><ci id="alg1.l16.m1.2.3.3.3.2.2.2.cmml" xref="alg1.l16.m1.2.3.3.3.2.2.2">𝜎</ci><ci id="alg1.l16.m1.2.3.3.3.2.2.3.cmml" xref="alg1.l16.m1.2.3.3.3.2.2.3">𝑘</ci></apply><ci id="alg1.l16.m1.2.3.3.3.2.3.cmml" xref="alg1.l16.m1.2.3.3.3.2.3">𝒩</ci></apply><interval closure="open" id="alg1.l16.m1.2.3.3.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.3.3.2"><cn type="integer" id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">0</cn><cn type="integer" id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">w^{k}_{s}\leftarrow\mu^{k}+\sigma^{k}\odot\mathcal{N}(0,1)</annotation></semantics></math> <span id="alg1.l16.1" class="ltx_text" style="float:right;"><math id="alg1.l16.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l16.1.m1.1a"><mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\triangleright</annotation></semantics></math> Reparam. trick
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>         <math id="alg1.l17.m1.6" class="ltx_Math" alttext="w^{k}\leftarrow w^{k}-\eta\nabla_{w}f_{m,\delta,\mu_{\text{prior}},\sigma_{\text{prior}}}(w^{k}_{s};b)" display="inline"><semantics id="alg1.l17.m1.6a"><mrow id="alg1.l17.m1.6.6" xref="alg1.l17.m1.6.6.cmml"><msup id="alg1.l17.m1.6.6.3" xref="alg1.l17.m1.6.6.3.cmml"><mi id="alg1.l17.m1.6.6.3.2" xref="alg1.l17.m1.6.6.3.2.cmml">w</mi><mi id="alg1.l17.m1.6.6.3.3" xref="alg1.l17.m1.6.6.3.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.l17.m1.6.6.2" xref="alg1.l17.m1.6.6.2.cmml">←</mo><mrow id="alg1.l17.m1.6.6.1" xref="alg1.l17.m1.6.6.1.cmml"><msup id="alg1.l17.m1.6.6.1.3" xref="alg1.l17.m1.6.6.1.3.cmml"><mi id="alg1.l17.m1.6.6.1.3.2" xref="alg1.l17.m1.6.6.1.3.2.cmml">w</mi><mi id="alg1.l17.m1.6.6.1.3.3" xref="alg1.l17.m1.6.6.1.3.3.cmml">k</mi></msup><mo id="alg1.l17.m1.6.6.1.2" xref="alg1.l17.m1.6.6.1.2.cmml">−</mo><mrow id="alg1.l17.m1.6.6.1.1" xref="alg1.l17.m1.6.6.1.1.cmml"><mi id="alg1.l17.m1.6.6.1.1.3" xref="alg1.l17.m1.6.6.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l17.m1.6.6.1.1.2" xref="alg1.l17.m1.6.6.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.6.6.1.1.4" xref="alg1.l17.m1.6.6.1.1.4.cmml"><msub id="alg1.l17.m1.6.6.1.1.4.1" xref="alg1.l17.m1.6.6.1.1.4.1.cmml"><mo rspace="0.167em" id="alg1.l17.m1.6.6.1.1.4.1.2" xref="alg1.l17.m1.6.6.1.1.4.1.2.cmml">∇</mo><mi id="alg1.l17.m1.6.6.1.1.4.1.3" xref="alg1.l17.m1.6.6.1.1.4.1.3.cmml">w</mi></msub><msub id="alg1.l17.m1.6.6.1.1.4.2" xref="alg1.l17.m1.6.6.1.1.4.2.cmml"><mi id="alg1.l17.m1.6.6.1.1.4.2.2" xref="alg1.l17.m1.6.6.1.1.4.2.2.cmml">f</mi><mrow id="alg1.l17.m1.4.4.4.4" xref="alg1.l17.m1.4.4.4.5.cmml"><mi id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">m</mi><mo id="alg1.l17.m1.4.4.4.4.3" xref="alg1.l17.m1.4.4.4.5.cmml">,</mo><mi id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.cmml">δ</mi><mo id="alg1.l17.m1.4.4.4.4.4" xref="alg1.l17.m1.4.4.4.5.cmml">,</mo><msub id="alg1.l17.m1.3.3.3.3.1" xref="alg1.l17.m1.3.3.3.3.1.cmml"><mi id="alg1.l17.m1.3.3.3.3.1.2" xref="alg1.l17.m1.3.3.3.3.1.2.cmml">μ</mi><mtext id="alg1.l17.m1.3.3.3.3.1.3" xref="alg1.l17.m1.3.3.3.3.1.3a.cmml">prior</mtext></msub><mo id="alg1.l17.m1.4.4.4.4.5" xref="alg1.l17.m1.4.4.4.5.cmml">,</mo><msub id="alg1.l17.m1.4.4.4.4.2" xref="alg1.l17.m1.4.4.4.4.2.cmml"><mi id="alg1.l17.m1.4.4.4.4.2.2" xref="alg1.l17.m1.4.4.4.4.2.2.cmml">σ</mi><mtext id="alg1.l17.m1.4.4.4.4.2.3" xref="alg1.l17.m1.4.4.4.4.2.3a.cmml">prior</mtext></msub></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l17.m1.6.6.1.1.2a" xref="alg1.l17.m1.6.6.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.6.6.1.1.1.1" xref="alg1.l17.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l17.m1.6.6.1.1.1.1.2" xref="alg1.l17.m1.6.6.1.1.1.2.cmml">(</mo><msubsup id="alg1.l17.m1.6.6.1.1.1.1.1" xref="alg1.l17.m1.6.6.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.6.6.1.1.1.1.1.2.2" xref="alg1.l17.m1.6.6.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l17.m1.6.6.1.1.1.1.1.3" xref="alg1.l17.m1.6.6.1.1.1.1.1.3.cmml">s</mi><mi id="alg1.l17.m1.6.6.1.1.1.1.1.2.3" xref="alg1.l17.m1.6.6.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="alg1.l17.m1.6.6.1.1.1.1.3" xref="alg1.l17.m1.6.6.1.1.1.2.cmml">;</mo><mi id="alg1.l17.m1.5.5" xref="alg1.l17.m1.5.5.cmml">b</mi><mo stretchy="false" id="alg1.l17.m1.6.6.1.1.1.1.4" xref="alg1.l17.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.6b"><apply id="alg1.l17.m1.6.6.cmml" xref="alg1.l17.m1.6.6"><ci id="alg1.l17.m1.6.6.2.cmml" xref="alg1.l17.m1.6.6.2">←</ci><apply id="alg1.l17.m1.6.6.3.cmml" xref="alg1.l17.m1.6.6.3"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.3.1.cmml" xref="alg1.l17.m1.6.6.3">superscript</csymbol><ci id="alg1.l17.m1.6.6.3.2.cmml" xref="alg1.l17.m1.6.6.3.2">𝑤</ci><ci id="alg1.l17.m1.6.6.3.3.cmml" xref="alg1.l17.m1.6.6.3.3">𝑘</ci></apply><apply id="alg1.l17.m1.6.6.1.cmml" xref="alg1.l17.m1.6.6.1"><minus id="alg1.l17.m1.6.6.1.2.cmml" xref="alg1.l17.m1.6.6.1.2"></minus><apply id="alg1.l17.m1.6.6.1.3.cmml" xref="alg1.l17.m1.6.6.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.1.3.1.cmml" xref="alg1.l17.m1.6.6.1.3">superscript</csymbol><ci id="alg1.l17.m1.6.6.1.3.2.cmml" xref="alg1.l17.m1.6.6.1.3.2">𝑤</ci><ci id="alg1.l17.m1.6.6.1.3.3.cmml" xref="alg1.l17.m1.6.6.1.3.3">𝑘</ci></apply><apply id="alg1.l17.m1.6.6.1.1.cmml" xref="alg1.l17.m1.6.6.1.1"><times id="alg1.l17.m1.6.6.1.1.2.cmml" xref="alg1.l17.m1.6.6.1.1.2"></times><ci id="alg1.l17.m1.6.6.1.1.3.cmml" xref="alg1.l17.m1.6.6.1.1.3">𝜂</ci><apply id="alg1.l17.m1.6.6.1.1.4.cmml" xref="alg1.l17.m1.6.6.1.1.4"><apply id="alg1.l17.m1.6.6.1.1.4.1.cmml" xref="alg1.l17.m1.6.6.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.1.1.4.1.1.cmml" xref="alg1.l17.m1.6.6.1.1.4.1">subscript</csymbol><ci id="alg1.l17.m1.6.6.1.1.4.1.2.cmml" xref="alg1.l17.m1.6.6.1.1.4.1.2">∇</ci><ci id="alg1.l17.m1.6.6.1.1.4.1.3.cmml" xref="alg1.l17.m1.6.6.1.1.4.1.3">𝑤</ci></apply><apply id="alg1.l17.m1.6.6.1.1.4.2.cmml" xref="alg1.l17.m1.6.6.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.1.1.4.2.1.cmml" xref="alg1.l17.m1.6.6.1.1.4.2">subscript</csymbol><ci id="alg1.l17.m1.6.6.1.1.4.2.2.cmml" xref="alg1.l17.m1.6.6.1.1.4.2.2">𝑓</ci><list id="alg1.l17.m1.4.4.4.5.cmml" xref="alg1.l17.m1.4.4.4.4"><ci id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">𝑚</ci><ci id="alg1.l17.m1.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2">𝛿</ci><apply id="alg1.l17.m1.3.3.3.3.1.cmml" xref="alg1.l17.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.3.3.1.1.cmml" xref="alg1.l17.m1.3.3.3.3.1">subscript</csymbol><ci id="alg1.l17.m1.3.3.3.3.1.2.cmml" xref="alg1.l17.m1.3.3.3.3.1.2">𝜇</ci><ci id="alg1.l17.m1.3.3.3.3.1.3a.cmml" xref="alg1.l17.m1.3.3.3.3.1.3"><mtext mathsize="50%" id="alg1.l17.m1.3.3.3.3.1.3.cmml" xref="alg1.l17.m1.3.3.3.3.1.3">prior</mtext></ci></apply><apply id="alg1.l17.m1.4.4.4.4.2.cmml" xref="alg1.l17.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.4.2.1.cmml" xref="alg1.l17.m1.4.4.4.4.2">subscript</csymbol><ci id="alg1.l17.m1.4.4.4.4.2.2.cmml" xref="alg1.l17.m1.4.4.4.4.2.2">𝜎</ci><ci id="alg1.l17.m1.4.4.4.4.2.3a.cmml" xref="alg1.l17.m1.4.4.4.4.2.3"><mtext mathsize="50%" id="alg1.l17.m1.4.4.4.4.2.3.cmml" xref="alg1.l17.m1.4.4.4.4.2.3">prior</mtext></ci></apply></list></apply></apply><list id="alg1.l17.m1.6.6.1.1.1.2.cmml" xref="alg1.l17.m1.6.6.1.1.1.1"><apply id="alg1.l17.m1.6.6.1.1.1.1.1.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1">subscript</csymbol><apply id="alg1.l17.m1.6.6.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.6.6.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1">superscript</csymbol><ci id="alg1.l17.m1.6.6.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l17.m1.6.6.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l17.m1.6.6.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.6.6.1.1.1.1.1.3">𝑠</ci></apply><ci id="alg1.l17.m1.5.5.cmml" xref="alg1.l17.m1.5.5">𝑏</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.6c">w^{k}\leftarrow w^{k}-\eta\nabla_{w}f_{m,\delta,\mu_{\text{prior}},\sigma_{\text{prior}}}(w^{k}_{s};b)</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span id="alg1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span><span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span><span id="alg1.l20.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l20.m1.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg1.l20.m1.1a"><msup id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">w</mi><mi id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1">superscript</csymbol><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑤</ci><ci id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">w^{k}</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>Global model distribution <math id="alg1.l21.m1.1" class="ltx_Math" alttext="w_{T}" display="inline"><semantics id="alg1.l21.m1.1a"><msub id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">w</mi><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑤</ci><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">w_{T}</annotation></semantics></math> mapped to <math id="alg1.l21.m2.2" class="ltx_Math" alttext="\mathcal{N}(\mu_{T},\sigma_{T})" display="inline"><semantics id="alg1.l21.m2.2a"><mrow id="alg1.l21.m2.2.2" xref="alg1.l21.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m2.2.2.4" xref="alg1.l21.m2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m2.2.2.3" xref="alg1.l21.m2.2.2.3.cmml">​</mo><mrow id="alg1.l21.m2.2.2.2.2" xref="alg1.l21.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l21.m2.2.2.2.2.3" xref="alg1.l21.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l21.m2.1.1.1.1.1" xref="alg1.l21.m2.1.1.1.1.1.cmml"><mi id="alg1.l21.m2.1.1.1.1.1.2" xref="alg1.l21.m2.1.1.1.1.1.2.cmml">μ</mi><mi id="alg1.l21.m2.1.1.1.1.1.3" xref="alg1.l21.m2.1.1.1.1.1.3.cmml">T</mi></msub><mo id="alg1.l21.m2.2.2.2.2.4" xref="alg1.l21.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l21.m2.2.2.2.2.2" xref="alg1.l21.m2.2.2.2.2.2.cmml"><mi id="alg1.l21.m2.2.2.2.2.2.2" xref="alg1.l21.m2.2.2.2.2.2.2.cmml">σ</mi><mi id="alg1.l21.m2.2.2.2.2.2.3" xref="alg1.l21.m2.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="alg1.l21.m2.2.2.2.2.5" xref="alg1.l21.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.2b"><apply id="alg1.l21.m2.2.2.cmml" xref="alg1.l21.m2.2.2"><times id="alg1.l21.m2.2.2.3.cmml" xref="alg1.l21.m2.2.2.3"></times><ci id="alg1.l21.m2.2.2.4.cmml" xref="alg1.l21.m2.2.2.4">𝒩</ci><interval closure="open" id="alg1.l21.m2.2.2.2.3.cmml" xref="alg1.l21.m2.2.2.2.2"><apply id="alg1.l21.m2.1.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m2.1.1.1.1.1.1.cmml" xref="alg1.l21.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l21.m2.1.1.1.1.1.2.cmml" xref="alg1.l21.m2.1.1.1.1.1.2">𝜇</ci><ci id="alg1.l21.m2.1.1.1.1.1.3.cmml" xref="alg1.l21.m2.1.1.1.1.1.3">𝑇</ci></apply><apply id="alg1.l21.m2.2.2.2.2.2.cmml" xref="alg1.l21.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l21.m2.2.2.2.2.2.1.cmml" xref="alg1.l21.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l21.m2.2.2.2.2.2.2.cmml" xref="alg1.l21.m2.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l21.m2.2.2.2.2.2.3.cmml" xref="alg1.l21.m2.2.2.2.2.2.3">𝑇</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.2c">\mathcal{N}(\mu_{T},\sigma_{T})</annotation></semantics></math>

</div>
</div>
</figure>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.9" class="ltx_p"><span id="S3.p3.9.1" class="ltx_text ltx_font_bold">A generalisation-driven FL algorithm.</span> <span id="S3.p3.9.2" class="ltx_text ltx_font_smallcaps">GenFL</span> combines a federated learning
protocol (<span id="S3.p3.9.3" class="ltx_text ltx_font_italic">i.e.</span>, FedSGD, FedAvg, <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib40" title="" class="ltx_ref">McMahan et al., 2017a </a></cite>) with a PAC-Bayes objective <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">f</annotation></semantics></math>. Its starts from the vector <math id="S3.p3.2.m2.2" class="ltx_Math" alttext="w_{1}=(\mu_{prior},\sigma_{prior})" display="inline"><semantics id="S3.p3.2.m2.2a"><mrow id="S3.p3.2.m2.2.2" xref="S3.p3.2.m2.2.2.cmml"><msub id="S3.p3.2.m2.2.2.4" xref="S3.p3.2.m2.2.2.4.cmml"><mi id="S3.p3.2.m2.2.2.4.2" xref="S3.p3.2.m2.2.2.4.2.cmml">w</mi><mn id="S3.p3.2.m2.2.2.4.3" xref="S3.p3.2.m2.2.2.4.3.cmml">1</mn></msub><mo id="S3.p3.2.m2.2.2.3" xref="S3.p3.2.m2.2.2.3.cmml">=</mo><mrow id="S3.p3.2.m2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.2.m2.2.2.2.2.3" xref="S3.p3.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.p3.2.m2.1.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.p3.2.m2.1.1.1.1.1.2" xref="S3.p3.2.m2.1.1.1.1.1.2.cmml">μ</mi><mrow id="S3.p3.2.m2.1.1.1.1.1.3" xref="S3.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.1.1.1.3.2" xref="S3.p3.2.m2.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.1.1.1.1.1.3.1" xref="S3.p3.2.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.2.m2.1.1.1.1.1.3.3" xref="S3.p3.2.m2.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.1.1.1.1.1.3.1a" xref="S3.p3.2.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.2.m2.1.1.1.1.1.3.4" xref="S3.p3.2.m2.1.1.1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.1.1.1.1.1.3.1b" xref="S3.p3.2.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.2.m2.1.1.1.1.1.3.5" xref="S3.p3.2.m2.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.1.1.1.1.1.3.1c" xref="S3.p3.2.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.2.m2.1.1.1.1.1.3.6" xref="S3.p3.2.m2.1.1.1.1.1.3.6.cmml">r</mi></mrow></msub><mo id="S3.p3.2.m2.2.2.2.2.4" xref="S3.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.p3.2.m2.2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.p3.2.m2.2.2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.2.2.2.cmml">σ</mi><mrow id="S3.p3.2.m2.2.2.2.2.2.3" xref="S3.p3.2.m2.2.2.2.2.2.3.cmml"><mi id="S3.p3.2.m2.2.2.2.2.2.3.2" xref="S3.p3.2.m2.2.2.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.2.2.2.2.2.3.1" xref="S3.p3.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.2.m2.2.2.2.2.2.3.3" xref="S3.p3.2.m2.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.2.2.2.2.2.3.1a" xref="S3.p3.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.2.m2.2.2.2.2.2.3.4" xref="S3.p3.2.m2.2.2.2.2.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.2.2.2.2.2.3.1b" xref="S3.p3.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.2.m2.2.2.2.2.2.3.5" xref="S3.p3.2.m2.2.2.2.2.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.2.2.2.2.2.3.1c" xref="S3.p3.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.2.m2.2.2.2.2.2.3.6" xref="S3.p3.2.m2.2.2.2.2.2.3.6.cmml">r</mi></mrow></msub><mo stretchy="false" id="S3.p3.2.m2.2.2.2.2.5" xref="S3.p3.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.2b"><apply id="S3.p3.2.m2.2.2.cmml" xref="S3.p3.2.m2.2.2"><eq id="S3.p3.2.m2.2.2.3.cmml" xref="S3.p3.2.m2.2.2.3"></eq><apply id="S3.p3.2.m2.2.2.4.cmml" xref="S3.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.p3.2.m2.2.2.4.1.cmml" xref="S3.p3.2.m2.2.2.4">subscript</csymbol><ci id="S3.p3.2.m2.2.2.4.2.cmml" xref="S3.p3.2.m2.2.2.4.2">𝑤</ci><cn type="integer" id="S3.p3.2.m2.2.2.4.3.cmml" xref="S3.p3.2.m2.2.2.4.3">1</cn></apply><interval closure="open" id="S3.p3.2.m2.2.2.2.3.cmml" xref="S3.p3.2.m2.2.2.2.2"><apply id="S3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1.2">𝜇</ci><apply id="S3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3"><times id="S3.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.1"></times><ci id="S3.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.3">𝑟</ci><ci id="S3.p3.2.m2.1.1.1.1.1.3.4.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.4">𝑖</ci><ci id="S3.p3.2.m2.1.1.1.1.1.3.5.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.5">𝑜</ci><ci id="S3.p3.2.m2.1.1.1.1.1.3.6.cmml" xref="S3.p3.2.m2.1.1.1.1.1.3.6">𝑟</ci></apply></apply><apply id="S3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.p3.2.m2.2.2.2.2.2.2">𝜎</ci><apply id="S3.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3"><times id="S3.p3.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.1"></times><ci id="S3.p3.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.2">𝑝</ci><ci id="S3.p3.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.3">𝑟</ci><ci id="S3.p3.2.m2.2.2.2.2.2.3.4.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.4">𝑖</ci><ci id="S3.p3.2.m2.2.2.2.2.2.3.5.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.5">𝑜</ci><ci id="S3.p3.2.m2.2.2.2.2.2.3.6.cmml" xref="S3.p3.2.m2.2.2.2.2.2.3.6">𝑟</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.2c">w_{1}=(\mu_{prior},\sigma_{prior})</annotation></semantics></math> corresponding to the initial distribution <math id="S3.p3.3.m3.2" class="ltx_Math" alttext="\mathrm{P}=\mathcal{N}(\mu_{prior},\sigma_{prior})" display="inline"><semantics id="S3.p3.3.m3.2a"><mrow id="S3.p3.3.m3.2.2" xref="S3.p3.3.m3.2.2.cmml"><mi mathvariant="normal" id="S3.p3.3.m3.2.2.4" xref="S3.p3.3.m3.2.2.4.cmml">P</mi><mo id="S3.p3.3.m3.2.2.3" xref="S3.p3.3.m3.2.2.3.cmml">=</mo><mrow id="S3.p3.3.m3.2.2.2" xref="S3.p3.3.m3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.2.2.2.4" xref="S3.p3.3.m3.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.2.2.2.3" xref="S3.p3.3.m3.2.2.2.3.cmml">​</mo><mrow id="S3.p3.3.m3.2.2.2.2.2" xref="S3.p3.3.m3.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.3.m3.2.2.2.2.2.3" xref="S3.p3.3.m3.2.2.2.2.3.cmml">(</mo><msub id="S3.p3.3.m3.1.1.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.1.2" xref="S3.p3.3.m3.1.1.1.1.1.1.2.cmml">μ</mi><mrow id="S3.p3.3.m3.1.1.1.1.1.1.3" xref="S3.p3.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.p3.3.m3.1.1.1.1.1.1.3.2" xref="S3.p3.3.m3.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.1.1.1.1.1.1.3.1" xref="S3.p3.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.3.m3.1.1.1.1.1.1.3.3" xref="S3.p3.3.m3.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.1.1.1.1.1.1.3.1a" xref="S3.p3.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.3.m3.1.1.1.1.1.1.3.4" xref="S3.p3.3.m3.1.1.1.1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.1.1.1.1.1.1.3.1b" xref="S3.p3.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.3.m3.1.1.1.1.1.1.3.5" xref="S3.p3.3.m3.1.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.1.1.1.1.1.1.3.1c" xref="S3.p3.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p3.3.m3.1.1.1.1.1.1.3.6" xref="S3.p3.3.m3.1.1.1.1.1.1.3.6.cmml">r</mi></mrow></msub><mo id="S3.p3.3.m3.2.2.2.2.2.4" xref="S3.p3.3.m3.2.2.2.2.3.cmml">,</mo><msub id="S3.p3.3.m3.2.2.2.2.2.2" xref="S3.p3.3.m3.2.2.2.2.2.2.cmml"><mi id="S3.p3.3.m3.2.2.2.2.2.2.2" xref="S3.p3.3.m3.2.2.2.2.2.2.2.cmml">σ</mi><mrow id="S3.p3.3.m3.2.2.2.2.2.2.3" xref="S3.p3.3.m3.2.2.2.2.2.2.3.cmml"><mi id="S3.p3.3.m3.2.2.2.2.2.2.3.2" xref="S3.p3.3.m3.2.2.2.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.2.2.2.2.2.2.3.1" xref="S3.p3.3.m3.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.3.m3.2.2.2.2.2.2.3.3" xref="S3.p3.3.m3.2.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.2.2.2.2.2.2.3.1a" xref="S3.p3.3.m3.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.3.m3.2.2.2.2.2.2.3.4" xref="S3.p3.3.m3.2.2.2.2.2.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.2.2.2.2.2.2.3.1b" xref="S3.p3.3.m3.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.3.m3.2.2.2.2.2.2.3.5" xref="S3.p3.3.m3.2.2.2.2.2.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.3.m3.2.2.2.2.2.2.3.1c" xref="S3.p3.3.m3.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p3.3.m3.2.2.2.2.2.2.3.6" xref="S3.p3.3.m3.2.2.2.2.2.2.3.6.cmml">r</mi></mrow></msub><mo stretchy="false" id="S3.p3.3.m3.2.2.2.2.2.5" xref="S3.p3.3.m3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.2b"><apply id="S3.p3.3.m3.2.2.cmml" xref="S3.p3.3.m3.2.2"><eq id="S3.p3.3.m3.2.2.3.cmml" xref="S3.p3.3.m3.2.2.3"></eq><ci id="S3.p3.3.m3.2.2.4.cmml" xref="S3.p3.3.m3.2.2.4">P</ci><apply id="S3.p3.3.m3.2.2.2.cmml" xref="S3.p3.3.m3.2.2.2"><times id="S3.p3.3.m3.2.2.2.3.cmml" xref="S3.p3.3.m3.2.2.2.3"></times><ci id="S3.p3.3.m3.2.2.2.4.cmml" xref="S3.p3.3.m3.2.2.2.4">𝒩</ci><interval closure="open" id="S3.p3.3.m3.2.2.2.2.3.cmml" xref="S3.p3.3.m3.2.2.2.2.2"><apply id="S3.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.2">𝜇</ci><apply id="S3.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3"><times id="S3.p3.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.1"></times><ci id="S3.p3.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.p3.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.3">𝑟</ci><ci id="S3.p3.3.m3.1.1.1.1.1.1.3.4.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.4">𝑖</ci><ci id="S3.p3.3.m3.1.1.1.1.1.1.3.5.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.5">𝑜</ci><ci id="S3.p3.3.m3.1.1.1.1.1.1.3.6.cmml" xref="S3.p3.3.m3.1.1.1.1.1.1.3.6">𝑟</ci></apply></apply><apply id="S3.p3.3.m3.2.2.2.2.2.2.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.2">𝜎</ci><apply id="S3.p3.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3"><times id="S3.p3.3.m3.2.2.2.2.2.2.3.1.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.1"></times><ci id="S3.p3.3.m3.2.2.2.2.2.2.3.2.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.2">𝑝</ci><ci id="S3.p3.3.m3.2.2.2.2.2.2.3.3.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.3">𝑟</ci><ci id="S3.p3.3.m3.2.2.2.2.2.2.3.4.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.4">𝑖</ci><ci id="S3.p3.3.m3.2.2.2.2.2.2.3.5.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.5">𝑜</ci><ci id="S3.p3.3.m3.2.2.2.2.2.2.3.6.cmml" xref="S3.p3.3.m3.2.2.2.2.2.2.3.6">𝑟</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.2c">\mathrm{P}=\mathcal{N}(\mu_{prior},\sigma_{prior})</annotation></semantics></math> and outputs after <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">T</annotation></semantics></math> rounds <math id="S3.p3.5.m5.2" class="ltx_Math" alttext="w_{T}=(\mu_{T},\sigma_{T})" display="inline"><semantics id="S3.p3.5.m5.2a"><mrow id="S3.p3.5.m5.2.2" xref="S3.p3.5.m5.2.2.cmml"><msub id="S3.p3.5.m5.2.2.4" xref="S3.p3.5.m5.2.2.4.cmml"><mi id="S3.p3.5.m5.2.2.4.2" xref="S3.p3.5.m5.2.2.4.2.cmml">w</mi><mi id="S3.p3.5.m5.2.2.4.3" xref="S3.p3.5.m5.2.2.4.3.cmml">T</mi></msub><mo id="S3.p3.5.m5.2.2.3" xref="S3.p3.5.m5.2.2.3.cmml">=</mo><mrow id="S3.p3.5.m5.2.2.2.2" xref="S3.p3.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.5.m5.2.2.2.2.3" xref="S3.p3.5.m5.2.2.2.3.cmml">(</mo><msub id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.p3.5.m5.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.p3.5.m5.2.2.2.2.4" xref="S3.p3.5.m5.2.2.2.3.cmml">,</mo><msub id="S3.p3.5.m5.2.2.2.2.2" xref="S3.p3.5.m5.2.2.2.2.2.cmml"><mi id="S3.p3.5.m5.2.2.2.2.2.2" xref="S3.p3.5.m5.2.2.2.2.2.2.cmml">σ</mi><mi id="S3.p3.5.m5.2.2.2.2.2.3" xref="S3.p3.5.m5.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.p3.5.m5.2.2.2.2.5" xref="S3.p3.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.2b"><apply id="S3.p3.5.m5.2.2.cmml" xref="S3.p3.5.m5.2.2"><eq id="S3.p3.5.m5.2.2.3.cmml" xref="S3.p3.5.m5.2.2.3"></eq><apply id="S3.p3.5.m5.2.2.4.cmml" xref="S3.p3.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.p3.5.m5.2.2.4.1.cmml" xref="S3.p3.5.m5.2.2.4">subscript</csymbol><ci id="S3.p3.5.m5.2.2.4.2.cmml" xref="S3.p3.5.m5.2.2.4.2">𝑤</ci><ci id="S3.p3.5.m5.2.2.4.3.cmml" xref="S3.p3.5.m5.2.2.4.3">𝑇</ci></apply><interval closure="open" id="S3.p3.5.m5.2.2.2.3.cmml" xref="S3.p3.5.m5.2.2.2.2"><apply id="S3.p3.5.m5.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.2">𝜇</ci><ci id="S3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.p3.5.m5.2.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.2.2.2.2.2.1.cmml" xref="S3.p3.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.5.m5.2.2.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2.2.2">𝜎</ci><ci id="S3.p3.5.m5.2.2.2.2.2.3.cmml" xref="S3.p3.5.m5.2.2.2.2.2.3">𝑇</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.2c">w_{T}=(\mu_{T},\sigma_{T})</annotation></semantics></math> corresponding to the posterior <math id="S3.p3.6.m6.2" class="ltx_Math" alttext="Q=\mathcal{N}(\mu_{T},\sigma_{T})" display="inline"><semantics id="S3.p3.6.m6.2a"><mrow id="S3.p3.6.m6.2.2" xref="S3.p3.6.m6.2.2.cmml"><mi id="S3.p3.6.m6.2.2.4" xref="S3.p3.6.m6.2.2.4.cmml">Q</mi><mo id="S3.p3.6.m6.2.2.3" xref="S3.p3.6.m6.2.2.3.cmml">=</mo><mrow id="S3.p3.6.m6.2.2.2" xref="S3.p3.6.m6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m6.2.2.2.4" xref="S3.p3.6.m6.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p3.6.m6.2.2.2.3" xref="S3.p3.6.m6.2.2.2.3.cmml">​</mo><mrow id="S3.p3.6.m6.2.2.2.2.2" xref="S3.p3.6.m6.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.6.m6.2.2.2.2.2.3" xref="S3.p3.6.m6.2.2.2.2.3.cmml">(</mo><msub id="S3.p3.6.m6.1.1.1.1.1.1" xref="S3.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.p3.6.m6.1.1.1.1.1.1.2" xref="S3.p3.6.m6.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.p3.6.m6.1.1.1.1.1.1.3" xref="S3.p3.6.m6.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.p3.6.m6.2.2.2.2.2.4" xref="S3.p3.6.m6.2.2.2.2.3.cmml">,</mo><msub id="S3.p3.6.m6.2.2.2.2.2.2" xref="S3.p3.6.m6.2.2.2.2.2.2.cmml"><mi id="S3.p3.6.m6.2.2.2.2.2.2.2" xref="S3.p3.6.m6.2.2.2.2.2.2.2.cmml">σ</mi><mi id="S3.p3.6.m6.2.2.2.2.2.2.3" xref="S3.p3.6.m6.2.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.p3.6.m6.2.2.2.2.2.5" xref="S3.p3.6.m6.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.2b"><apply id="S3.p3.6.m6.2.2.cmml" xref="S3.p3.6.m6.2.2"><eq id="S3.p3.6.m6.2.2.3.cmml" xref="S3.p3.6.m6.2.2.3"></eq><ci id="S3.p3.6.m6.2.2.4.cmml" xref="S3.p3.6.m6.2.2.4">𝑄</ci><apply id="S3.p3.6.m6.2.2.2.cmml" xref="S3.p3.6.m6.2.2.2"><times id="S3.p3.6.m6.2.2.2.3.cmml" xref="S3.p3.6.m6.2.2.2.3"></times><ci id="S3.p3.6.m6.2.2.2.4.cmml" xref="S3.p3.6.m6.2.2.2.4">𝒩</ci><interval closure="open" id="S3.p3.6.m6.2.2.2.2.3.cmml" xref="S3.p3.6.m6.2.2.2.2.2"><apply id="S3.p3.6.m6.1.1.1.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.p3.6.m6.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.p3.6.m6.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.p3.6.m6.2.2.2.2.2.2.cmml" xref="S3.p3.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.6.m6.2.2.2.2.2.2.1.cmml" xref="S3.p3.6.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.6.m6.2.2.2.2.2.2.2.cmml" xref="S3.p3.6.m6.2.2.2.2.2.2.2">𝜎</ci><ci id="S3.p3.6.m6.2.2.2.2.2.2.3.cmml" xref="S3.p3.6.m6.2.2.2.2.2.2.3">𝑇</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.2c">Q=\mathcal{N}(\mu_{T},\sigma_{T})</annotation></semantics></math>. Hence the learning procedure is divided in rounds, where subsets of users are sampled.
Sampled users are requested to perform local updates following a PAC-Bayes training procedure designed to ensure a good generalisation of the posterior distribution. Because users train SNNs, they sample weights from the posterior. In order to learn the variance parameter of the posterior (Gaussian), we use the well-known reparameterisation trick <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Welling,, <a href="#bib.bib29" title="" class="ltx_ref">2014</a>)</cite>: instead of directly sampling from the distribution, we sample from a standard Gaussian distribution and then apply a transformation to obtain the sampled weights: <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="W=\mu+\sigma V" display="inline"><semantics id="S3.p3.7.m7.1a"><mrow id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2" xref="S3.p3.7.m7.1.1.2.cmml">W</mi><mo id="S3.p3.7.m7.1.1.1" xref="S3.p3.7.m7.1.1.1.cmml">=</mo><mrow id="S3.p3.7.m7.1.1.3" xref="S3.p3.7.m7.1.1.3.cmml"><mi id="S3.p3.7.m7.1.1.3.2" xref="S3.p3.7.m7.1.1.3.2.cmml">μ</mi><mo id="S3.p3.7.m7.1.1.3.1" xref="S3.p3.7.m7.1.1.3.1.cmml">+</mo><mrow id="S3.p3.7.m7.1.1.3.3" xref="S3.p3.7.m7.1.1.3.3.cmml"><mi id="S3.p3.7.m7.1.1.3.3.2" xref="S3.p3.7.m7.1.1.3.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.p3.7.m7.1.1.3.3.1" xref="S3.p3.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S3.p3.7.m7.1.1.3.3.3" xref="S3.p3.7.m7.1.1.3.3.3.cmml">V</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><eq id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1.1"></eq><ci id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1.2">𝑊</ci><apply id="S3.p3.7.m7.1.1.3.cmml" xref="S3.p3.7.m7.1.1.3"><plus id="S3.p3.7.m7.1.1.3.1.cmml" xref="S3.p3.7.m7.1.1.3.1"></plus><ci id="S3.p3.7.m7.1.1.3.2.cmml" xref="S3.p3.7.m7.1.1.3.2">𝜇</ci><apply id="S3.p3.7.m7.1.1.3.3.cmml" xref="S3.p3.7.m7.1.1.3.3"><times id="S3.p3.7.m7.1.1.3.3.1.cmml" xref="S3.p3.7.m7.1.1.3.3.1"></times><ci id="S3.p3.7.m7.1.1.3.3.2.cmml" xref="S3.p3.7.m7.1.1.3.3.2">𝜎</ci><ci id="S3.p3.7.m7.1.1.3.3.3.cmml" xref="S3.p3.7.m7.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">W=\mu+\sigma V</annotation></semantics></math> where <math id="S3.p3.8.m8.2" class="ltx_Math" alttext="V\sim\mathcal{N}(0,\mathrm{Id})" display="inline"><semantics id="S3.p3.8.m8.2a"><mrow id="S3.p3.8.m8.2.3" xref="S3.p3.8.m8.2.3.cmml"><mi id="S3.p3.8.m8.2.3.2" xref="S3.p3.8.m8.2.3.2.cmml">V</mi><mo id="S3.p3.8.m8.2.3.1" xref="S3.p3.8.m8.2.3.1.cmml">∼</mo><mrow id="S3.p3.8.m8.2.3.3" xref="S3.p3.8.m8.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.8.m8.2.3.3.2" xref="S3.p3.8.m8.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p3.8.m8.2.3.3.1" xref="S3.p3.8.m8.2.3.3.1.cmml">​</mo><mrow id="S3.p3.8.m8.2.3.3.3.2" xref="S3.p3.8.m8.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.p3.8.m8.2.3.3.3.2.1" xref="S3.p3.8.m8.2.3.3.3.1.cmml">(</mo><mn id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">0</mn><mo id="S3.p3.8.m8.2.3.3.3.2.2" xref="S3.p3.8.m8.2.3.3.3.1.cmml">,</mo><mi id="S3.p3.8.m8.2.2" xref="S3.p3.8.m8.2.2.cmml">Id</mi><mo stretchy="false" id="S3.p3.8.m8.2.3.3.3.2.3" xref="S3.p3.8.m8.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.2b"><apply id="S3.p3.8.m8.2.3.cmml" xref="S3.p3.8.m8.2.3"><csymbol cd="latexml" id="S3.p3.8.m8.2.3.1.cmml" xref="S3.p3.8.m8.2.3.1">similar-to</csymbol><ci id="S3.p3.8.m8.2.3.2.cmml" xref="S3.p3.8.m8.2.3.2">𝑉</ci><apply id="S3.p3.8.m8.2.3.3.cmml" xref="S3.p3.8.m8.2.3.3"><times id="S3.p3.8.m8.2.3.3.1.cmml" xref="S3.p3.8.m8.2.3.3.1"></times><ci id="S3.p3.8.m8.2.3.3.2.cmml" xref="S3.p3.8.m8.2.3.3.2">𝒩</ci><interval closure="open" id="S3.p3.8.m8.2.3.3.3.1.cmml" xref="S3.p3.8.m8.2.3.3.3.2"><cn type="integer" id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">0</cn><ci id="S3.p3.8.m8.2.2.cmml" xref="S3.p3.8.m8.2.2">Id</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.2c">V\sim\mathcal{N}(0,\mathrm{Id})</annotation></semantics></math>, this allows to compute with respect to <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\sigma</annotation></semantics></math>.
When the round ends, the global model is computed from the local updates, thanks to the aggregation function from the FL protocol (weighted mean, median).</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.3" class="ltx_p">Next we show that with a PAC-Bayes objective <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">f</annotation></semantics></math>, we adapt <span id="S3.p4.3.1" class="ltx_text ltx_font_smallcaps">GenFL</span> to FL-SOB, where <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{S}</annotation></semantics></math> is fully <span id="S3.p4.3.2" class="ltx_text ltx_font_italic">i.i.d.</span>, <span id="S3.p4.3.3" class="ltx_text ltx_font_italic">i.e.</span>, all user datasets have the same distribution, and to PFL where each dataset <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">𝒮</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝒮</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mathcal{S}_{i}</annotation></semantics></math> is <span id="S3.p4.3.4" class="ltx_text ltx_font_italic">i.i.d.</span> but any two dataset can have distinct distributions.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.1.1" class="ltx_text ltx_font_smallcaps">GenFL</span> for FL-SOB</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.14" class="ltx_p"><span id="S3.SS1.p1.14.1" class="ltx_text ltx_font_bold">PAC-Bayesian objectives.</span> We assume that for any <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">i</annotation></semantics></math>, <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}=\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><msub id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><eq id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></eq><apply id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{D}_{i}=\mathcal{D}</annotation></semantics></math>. Thus, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{S}</annotation></semantics></math> is a <span id="S3.SS1.p1.14.2" class="ltx_text ltx_font_italic">i.i.d.</span> dataset of <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">m</annotation></semantics></math> points. We then consider the true and empirical risks on all <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{S}</annotation></semantics></math> <math id="S3.SS1.p1.6.m6.2" class="ltx_Math" alttext="\text{R}_{\mathcal{D}},\text{R}_{\mathcal{S}}" display="inline"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.2.2" xref="S3.SS1.p1.6.m6.2.2.3.cmml"><msub id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml"><mtext id="S3.SS1.p1.6.m6.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.3.cmml">𝒟</mi></msub><mo id="S3.SS1.p1.6.m6.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.6.m6.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.cmml"><mtext id="S3.SS1.p1.6.m6.2.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.2a.cmml">R</mtext><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.2.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.2.2.3.cmml">𝒮</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><list id="S3.SS1.p1.6.m6.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2"><apply id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.2a.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.2"><mtext id="S3.SS1.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.2">R</mtext></ci><ci id="S3.SS1.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.3">𝒟</ci></apply><apply id="S3.SS1.p1.6.m6.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.2.2.2a.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2"><mtext id="S3.SS1.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2">R</mtext></ci><ci id="S3.SS1.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.3">𝒮</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">\text{R}_{\mathcal{D}},\text{R}_{\mathcal{S}}</annotation></semantics></math>.
In a batch setting, it would be natural to optimise the bounds (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). However, the user <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i</annotation></semantics></math> only has access to its personal dataset <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝒮</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{S}_{i}</annotation></semantics></math> (of size <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">m</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑚</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">m_{i}</annotation></semantics></math>) to optimise its model <em id="S3.SS1.p1.14.3" class="ltx_emph ltx_font_italic">while knowing other datasets are involved</em>. We then derive accordingly from (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) two PAC-Bayesian learning algorithms, valid for any user, namely <math id="S3.SS1.p1.10.m10.2" class="ltx_Math" alttext="f_{1},f_{2}" display="inline"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.2.2" xref="S3.SS1.p1.10.m10.2.2.3.cmml"><msub id="S3.SS1.p1.10.m10.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.2" xref="S3.SS1.p1.10.m10.1.1.1.1.2.cmml">f</mi><mn id="S3.SS1.p1.10.m10.1.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.10.m10.2.2.2.3" xref="S3.SS1.p1.10.m10.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.10.m10.2.2.2.2" xref="S3.SS1.p1.10.m10.2.2.2.2.cmml"><mi id="S3.SS1.p1.10.m10.2.2.2.2.2" xref="S3.SS1.p1.10.m10.2.2.2.2.2.cmml">f</mi><mn id="S3.SS1.p1.10.m10.2.2.2.2.3" xref="S3.SS1.p1.10.m10.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><list id="S3.SS1.p1.10.m10.2.2.3.cmml" xref="S3.SS1.p1.10.m10.2.2.2"><apply id="S3.SS1.p1.10.m10.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.2">𝑓</ci><cn type="integer" id="S3.SS1.p1.10.m10.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.10.m10.2.2.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.2.2.2.2.1.cmml" xref="S3.SS1.p1.10.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.2.2.2.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2.2.2.2">𝑓</ci><cn type="integer" id="S3.SS1.p1.10.m10.2.2.2.2.3.cmml" xref="S3.SS1.p1.10.m10.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">f_{1},f_{2}</annotation></semantics></math>. Note that <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">f</mi><mn id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑓</ci><cn type="integer" id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">f_{1}</annotation></semantics></math> is adapted from the <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="f_{classic}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">f</mi><mrow id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.3.2" xref="S3.SS1.p1.12.m12.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.3" xref="S3.SS1.p1.12.m12.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1a" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.4" xref="S3.SS1.p1.12.m12.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1b" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.5" xref="S3.SS1.p1.12.m12.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1c" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.6" xref="S3.SS1.p1.12.m12.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1d" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.7" xref="S3.SS1.p1.12.m12.1.1.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1.3.1e" xref="S3.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.12.m12.1.1.3.8" xref="S3.SS1.p1.12.m12.1.1.3.8.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑓</ci><apply id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3"><times id="S3.SS1.p1.12.m12.1.1.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.3.1"></times><ci id="S3.SS1.p1.12.m12.1.1.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.3.2">𝑐</ci><ci id="S3.SS1.p1.12.m12.1.1.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3.3">𝑙</ci><ci id="S3.SS1.p1.12.m12.1.1.3.4.cmml" xref="S3.SS1.p1.12.m12.1.1.3.4">𝑎</ci><ci id="S3.SS1.p1.12.m12.1.1.3.5.cmml" xref="S3.SS1.p1.12.m12.1.1.3.5">𝑠</ci><ci id="S3.SS1.p1.12.m12.1.1.3.6.cmml" xref="S3.SS1.p1.12.m12.1.1.3.6">𝑠</ci><ci id="S3.SS1.p1.12.m12.1.1.3.7.cmml" xref="S3.SS1.p1.12.m12.1.1.3.7">𝑖</ci><ci id="S3.SS1.p1.12.m12.1.1.3.8.cmml" xref="S3.SS1.p1.12.m12.1.1.3.8">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">f_{classic}</annotation></semantics></math> objective and <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">f</mi><mn id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑓</ci><cn type="integer" id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">f_{2}</annotation></semantics></math> is adapted from <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="f_{quad}" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">f</mi><mrow id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.3.1" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m14.1.1.3.3" xref="S3.SS1.p1.14.m14.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.3.1a" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m14.1.1.3.4" xref="S3.SS1.p1.14.m14.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.3.1b" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m14.1.1.3.5" xref="S3.SS1.p1.14.m14.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑓</ci><apply id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3"><times id="S3.SS1.p1.14.m14.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1"></times><ci id="S3.SS1.p1.14.m14.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2">𝑞</ci><ci id="S3.SS1.p1.14.m14.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.3">𝑢</ci><ci id="S3.SS1.p1.14.m14.1.1.3.4.cmml" xref="S3.SS1.p1.14.m14.1.1.3.4">𝑎</ci><ci id="S3.SS1.p1.14.m14.1.1.3.5.cmml" xref="S3.SS1.p1.14.m14.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">f_{quad}</annotation></semantics></math> of <cite class="ltx_cite ltx_citemacro_citet">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>:</p>
<table id="A3.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle f_{1}(\mathcal{S}_{i})" display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msub id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">f</mi><mn id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><times id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></times><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑓</ci><cn type="integer" id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3">1</cn></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle f_{1}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m2.4" class="ltx_Math" alttext="\displaystyle=\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}." display="inline"><semantics id="S3.E8.m2.4a"><mrow id="S3.E8.m2.4.4.1" xref="S3.E8.m2.4.4.1.1.cmml"><mrow id="S3.E8.m2.4.4.1.1" xref="S3.E8.m2.4.4.1.1.cmml"><mi id="S3.E8.m2.4.4.1.1.2" xref="S3.E8.m2.4.4.1.1.2.cmml"></mi><mo id="S3.E8.m2.4.4.1.1.1" xref="S3.E8.m2.4.4.1.1.1.cmml">=</mo><mrow id="S3.E8.m2.4.4.1.1.3" xref="S3.E8.m2.4.4.1.1.3.cmml"><mrow id="S3.E8.m2.4.4.1.1.3.2" xref="S3.E8.m2.4.4.1.1.3.2.cmml"><msub id="S3.E8.m2.4.4.1.1.3.2.2" xref="S3.E8.m2.4.4.1.1.3.2.2.cmml"><mover accent="true" id="S3.E8.m2.4.4.1.1.3.2.2.2" xref="S3.E8.m2.4.4.1.1.3.2.2.2.cmml"><mtext id="S3.E8.m2.4.4.1.1.3.2.2.2.2" xref="S3.E8.m2.4.4.1.1.3.2.2.2.2a.cmml">R</mtext><mo id="S3.E8.m2.4.4.1.1.3.2.2.2.1" xref="S3.E8.m2.4.4.1.1.3.2.2.2.1.cmml">^</mo></mover><msub id="S3.E8.m2.4.4.1.1.3.2.2.3" xref="S3.E8.m2.4.4.1.1.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m2.4.4.1.1.3.2.2.3.2" xref="S3.E8.m2.4.4.1.1.3.2.2.3.2.cmml">𝒮</mi><mi id="S3.E8.m2.4.4.1.1.3.2.2.3.3" xref="S3.E8.m2.4.4.1.1.3.2.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E8.m2.4.4.1.1.3.2.1" xref="S3.E8.m2.4.4.1.1.3.2.1.cmml">​</mo><mrow id="S3.E8.m2.4.4.1.1.3.2.3.2" xref="S3.E8.m2.4.4.1.1.3.2.cmml"><mo stretchy="false" id="S3.E8.m2.4.4.1.1.3.2.3.2.1" xref="S3.E8.m2.4.4.1.1.3.2.cmml">(</mo><mi id="S3.E8.m2.3.3" xref="S3.E8.m2.3.3.cmml">Q</mi><mo stretchy="false" id="S3.E8.m2.4.4.1.1.3.2.3.2.2" xref="S3.E8.m2.4.4.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.4.4.1.1.3.1" xref="S3.E8.m2.4.4.1.1.3.1.cmml">+</mo><msqrt id="S3.E8.m2.2.2" xref="S3.E8.m2.2.2.cmml"><mstyle displaystyle="true" id="S3.E8.m2.2.2.2" xref="S3.E8.m2.2.2.2.cmml"><mfrac id="S3.E8.m2.2.2.2a" xref="S3.E8.m2.2.2.2.cmml"><mrow id="S3.E8.m2.2.2.2.2.2" xref="S3.E8.m2.2.2.2.2.2.cmml"><mrow id="S3.E8.m2.2.2.2.2.2.2.1" xref="S3.E8.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.cmml">KL</mi><mo id="S3.E8.m2.2.2.2.2.2.2.1a" xref="S3.E8.m2.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="S3.E8.m2.2.2.2.2.2.2.1.1" xref="S3.E8.m2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E8.m2.2.2.2.2.2.2.1.1.2" xref="S3.E8.m2.2.2.2.2.2.2.2.cmml">(</mo><mrow id="S3.E8.m2.2.2.2.2.2.2.1.1.1" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E8.m2.2.2.2.2.2.2.1.1.1.2" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="S3.E8.m2.2.2.2.2.2.2.1.1.1.1" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.1.cmml">∥</mo><mi id="S3.E8.m2.2.2.2.2.2.2.1.1.1.3" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="S3.E8.m2.2.2.2.2.2.2.1.1.3" xref="S3.E8.m2.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.2.2.2.2.2.3" xref="S3.E8.m2.2.2.2.2.2.3.cmml">+</mo><mrow id="S3.E8.m2.2.2.2.2.2.4" xref="S3.E8.m2.2.2.2.2.2.4.cmml"><mi id="S3.E8.m2.2.2.2.2.2.4.1" xref="S3.E8.m2.2.2.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S3.E8.m2.2.2.2.2.2.4a" xref="S3.E8.m2.2.2.2.2.2.4.cmml">⁡</mo><mfrac id="S3.E8.m2.2.2.2.2.2.4.2" xref="S3.E8.m2.2.2.2.2.2.4.2.cmml"><mrow id="S3.E8.m2.2.2.2.2.2.4.2.2" xref="S3.E8.m2.2.2.2.2.2.4.2.2.cmml"><mn id="S3.E8.m2.2.2.2.2.2.4.2.2.2" xref="S3.E8.m2.2.2.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8.m2.2.2.2.2.2.4.2.2.1" xref="S3.E8.m2.2.2.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="S3.E8.m2.2.2.2.2.2.4.2.2.3" xref="S3.E8.m2.2.2.2.2.2.4.2.2.3.cmml"><mi id="S3.E8.m2.2.2.2.2.2.4.2.2.3.2" xref="S3.E8.m2.2.2.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="S3.E8.m2.2.2.2.2.2.4.2.3" xref="S3.E8.m2.2.2.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mrow id="S3.E8.m2.2.2.2.4" xref="S3.E8.m2.2.2.2.4.cmml"><mn id="S3.E8.m2.2.2.2.4.2" xref="S3.E8.m2.2.2.2.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E8.m2.2.2.2.4.1" xref="S3.E8.m2.2.2.2.4.1.cmml">​</mo><mi id="S3.E8.m2.2.2.2.4.3" xref="S3.E8.m2.2.2.2.4.3.cmml">m</mi></mrow></mfrac></mstyle></msqrt></mrow></mrow><mo lspace="0em" id="S3.E8.m2.4.4.1.2" xref="S3.E8.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.4b"><apply id="S3.E8.m2.4.4.1.1.cmml" xref="S3.E8.m2.4.4.1"><eq id="S3.E8.m2.4.4.1.1.1.cmml" xref="S3.E8.m2.4.4.1.1.1"></eq><csymbol cd="latexml" id="S3.E8.m2.4.4.1.1.2.cmml" xref="S3.E8.m2.4.4.1.1.2">absent</csymbol><apply id="S3.E8.m2.4.4.1.1.3.cmml" xref="S3.E8.m2.4.4.1.1.3"><plus id="S3.E8.m2.4.4.1.1.3.1.cmml" xref="S3.E8.m2.4.4.1.1.3.1"></plus><apply id="S3.E8.m2.4.4.1.1.3.2.cmml" xref="S3.E8.m2.4.4.1.1.3.2"><times id="S3.E8.m2.4.4.1.1.3.2.1.cmml" xref="S3.E8.m2.4.4.1.1.3.2.1"></times><apply id="S3.E8.m2.4.4.1.1.3.2.2.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.3.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2">subscript</csymbol><apply id="S3.E8.m2.4.4.1.1.3.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.2"><ci id="S3.E8.m2.4.4.1.1.3.2.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.2.1">^</ci><ci id="S3.E8.m2.4.4.1.1.3.2.2.2.2a.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.2.2"><mtext id="S3.E8.m2.4.4.1.1.3.2.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.2.2">R</mtext></ci></apply><apply id="S3.E8.m2.4.4.1.1.3.2.2.3.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.3.2.2.3.1.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E8.m2.4.4.1.1.3.2.2.3.2.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.3.2">𝒮</ci><ci id="S3.E8.m2.4.4.1.1.3.2.2.3.3.cmml" xref="S3.E8.m2.4.4.1.1.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.E8.m2.3.3.cmml" xref="S3.E8.m2.3.3">𝑄</ci></apply><apply id="S3.E8.m2.2.2.cmml" xref="S3.E8.m2.2.2"><root id="S3.E8.m2.2.2a.cmml" xref="S3.E8.m2.2.2"></root><apply id="S3.E8.m2.2.2.2.cmml" xref="S3.E8.m2.2.2.2"><divide id="S3.E8.m2.2.2.2.3.cmml" xref="S3.E8.m2.2.2.2"></divide><apply id="S3.E8.m2.2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2.2"><plus id="S3.E8.m2.2.2.2.2.2.3.cmml" xref="S3.E8.m2.2.2.2.2.2.3"></plus><apply id="S3.E8.m2.2.2.2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2.2.2.1"><ci id="S3.E8.m2.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1">KL</ci><apply id="S3.E8.m2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E8.m2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.E8.m2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.2">𝑄</ci><ci id="S3.E8.m2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E8.m2.2.2.2.2.2.2.1.1.1.3">𝑃</ci></apply></apply><apply id="S3.E8.m2.2.2.2.2.2.4.cmml" xref="S3.E8.m2.2.2.2.2.2.4"><ln id="S3.E8.m2.2.2.2.2.2.4.1.cmml" xref="S3.E8.m2.2.2.2.2.2.4.1"></ln><apply id="S3.E8.m2.2.2.2.2.2.4.2.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2"><divide id="S3.E8.m2.2.2.2.2.2.4.2.1.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2"></divide><apply id="S3.E8.m2.2.2.2.2.2.4.2.2.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2"><times id="S3.E8.m2.2.2.2.2.2.4.2.2.1.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2.1"></times><cn type="integer" id="S3.E8.m2.2.2.2.2.2.4.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2.2">2</cn><apply id="S3.E8.m2.2.2.2.2.2.4.2.2.3.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2.3"><root id="S3.E8.m2.2.2.2.2.2.4.2.2.3a.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2.3"></root><ci id="S3.E8.m2.2.2.2.2.2.4.2.2.3.2.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="S3.E8.m2.2.2.2.2.2.4.2.3.cmml" xref="S3.E8.m2.2.2.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><apply id="S3.E8.m2.2.2.2.4.cmml" xref="S3.E8.m2.2.2.2.4"><times id="S3.E8.m2.2.2.2.4.1.cmml" xref="S3.E8.m2.2.2.2.4.1"></times><cn type="integer" id="S3.E8.m2.2.2.2.4.2.cmml" xref="S3.E8.m2.2.2.2.4.2">2</cn><ci id="S3.E8.m2.2.2.2.4.3.cmml" xref="S3.E8.m2.2.2.2.4.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.4c">\displaystyle=\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle f_{2}(\mathcal{S}_{i})" display="inline"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.3.2" xref="S3.Ex2.m1.1.1.3.2.cmml">f</mi><mn id="S3.Ex2.m1.1.1.3.3" xref="S3.Ex2.m1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.Ex2.m1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><times id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2"></times><apply id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.3.2">𝑓</ci><cn type="integer" id="S3.Ex2.m1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3">2</cn></apply><apply id="S3.Ex2.m1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2">𝒮</ci><ci id="S3.Ex2.m1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle f_{2}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m2.4" class="ltx_math_unparsed" alttext="\displaystyle=\left(\sqrt{\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\frac{\mathrm{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right." display="inline"><semantics id="S3.Ex2.m2.4a"><mrow id="S3.Ex2.m2.4b"><mo id="S3.Ex2.m2.4.5">=</mo><mrow id="S3.Ex2.m2.4.6"><mo id="S3.Ex2.m2.4.6.1">(</mo><msqrt id="S3.Ex2.m2.4.4"><mrow id="S3.Ex2.m2.4.4.4"><mrow id="S3.Ex2.m2.4.4.4.6"><msub id="S3.Ex2.m2.4.4.4.6.2"><mover accent="true" id="S3.Ex2.m2.4.4.4.6.2.2"><mtext id="S3.Ex2.m2.4.4.4.6.2.2.2">R</mtext><mo id="S3.Ex2.m2.4.4.4.6.2.2.1">^</mo></mover><msub id="S3.Ex2.m2.4.4.4.6.2.3"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.4.4.4.6.2.3.2">𝒮</mi><mi id="S3.Ex2.m2.4.4.4.6.2.3.3">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.4.4.4.6.1">​</mo><mrow id="S3.Ex2.m2.4.4.4.6.3.2"><mo stretchy="false" id="S3.Ex2.m2.4.4.4.6.3.2.1">(</mo><mi id="S3.Ex2.m2.4.4.4.4">Q</mi><mo stretchy="false" id="S3.Ex2.m2.4.4.4.6.3.2.2">)</mo></mrow></mrow><mo id="S3.Ex2.m2.4.4.4.5">+</mo><mstyle displaystyle="true" id="S3.Ex2.m2.3.3.3.3"><mfrac id="S3.Ex2.m2.3.3.3.3a"><mrow id="S3.Ex2.m2.3.3.3.3.3"><mrow id="S3.Ex2.m2.3.3.3.3.3.3"><mi id="S3.Ex2.m2.3.3.3.3.3.3.3">KL</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.3.3.3.3.2">​</mo><mrow id="S3.Ex2.m2.3.3.3.3.3.3.1.1"><mo id="S3.Ex2.m2.3.3.3.3.3.3.1.1.2">(</mo><mrow id="S3.Ex2.m2.3.3.3.3.3.3.1.1.1"><mi id="S3.Ex2.m2.3.3.3.3.3.3.1.1.1.2">Q</mi><mo id="S3.Ex2.m2.3.3.3.3.3.3.1.1.1.1">∥</mo><mi id="S3.Ex2.m2.3.3.3.3.3.3.1.1.1.3">P</mi></mrow><mo id="S3.Ex2.m2.3.3.3.3.3.3.1.1.3">)</mo></mrow></mrow><mo id="S3.Ex2.m2.3.3.3.3.3.4">+</mo><mrow id="S3.Ex2.m2.3.3.3.3.3.5.2"><mi id="S3.Ex2.m2.1.1.1.1.1.1">log</mi><mo id="S3.Ex2.m2.3.3.3.3.3.5.2a">⁡</mo><mrow id="S3.Ex2.m2.3.3.3.3.3.5.2.1"><mo id="S3.Ex2.m2.3.3.3.3.3.5.2.1.1">(</mo><mfrac id="S3.Ex2.m2.2.2.2.2.2.2"><mrow id="S3.Ex2.m2.2.2.2.2.2.2.2"><mn id="S3.Ex2.m2.2.2.2.2.2.2.2.2">2</mn><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.2.2.2.2.2.2.2.1">​</mo><msqrt id="S3.Ex2.m2.2.2.2.2.2.2.2.3"><mi id="S3.Ex2.m2.2.2.2.2.2.2.2.3.2">m</mi></msqrt></mrow><mi id="S3.Ex2.m2.2.2.2.2.2.2.3">δ</mi></mfrac><mo id="S3.Ex2.m2.3.3.3.3.3.5.2.1.2">)</mo></mrow></mrow></mrow><mrow id="S3.Ex2.m2.3.3.3.3.5"><mn id="S3.Ex2.m2.3.3.3.3.5.2">2</mn><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.3.3.5.1">​</mo><mi id="S3.Ex2.m2.3.3.3.3.5.3">m</mi></mrow></mfrac></mstyle></mrow></msqrt></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m2.4c">\displaystyle=\left(\sqrt{\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\frac{\mathrm{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\left.+\sqrt{\frac{\operatorname{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right)^{2}." display="inline"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4b"><mo id="S3.E9.m1.4.5">+</mo><msqrt id="S3.E9.m1.4.4"><mstyle displaystyle="true" id="S3.E9.m1.4.4.4"><mfrac id="S3.E9.m1.4.4.4a"><mrow id="S3.E9.m1.4.4.4.4.4"><mrow id="S3.E9.m1.4.4.4.4.4.4.1"><mi id="S3.E9.m1.1.1.1.1.1.1">KL</mi><mo id="S3.E9.m1.4.4.4.4.4.4.1a">⁡</mo><mrow id="S3.E9.m1.4.4.4.4.4.4.1.1"><mo id="S3.E9.m1.4.4.4.4.4.4.1.1.2">(</mo><mrow id="S3.E9.m1.4.4.4.4.4.4.1.1.1"><mi id="S3.E9.m1.4.4.4.4.4.4.1.1.1.2">Q</mi><mo id="S3.E9.m1.4.4.4.4.4.4.1.1.1.1">∥</mo><mi id="S3.E9.m1.4.4.4.4.4.4.1.1.1.3">P</mi></mrow><mo id="S3.E9.m1.4.4.4.4.4.4.1.1.3">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.4.4.4.5">+</mo><mrow id="S3.E9.m1.4.4.4.4.4.6.2"><mi id="S3.E9.m1.2.2.2.2.2.2">log</mi><mo id="S3.E9.m1.4.4.4.4.4.6.2a">⁡</mo><mrow id="S3.E9.m1.4.4.4.4.4.6.2.1"><mo id="S3.E9.m1.4.4.4.4.4.6.2.1.1">(</mo><mfrac id="S3.E9.m1.3.3.3.3.3.3"><mrow id="S3.E9.m1.3.3.3.3.3.3.2"><mn id="S3.E9.m1.3.3.3.3.3.3.2.2">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.3.3.3.3.2.1">​</mo><msqrt id="S3.E9.m1.3.3.3.3.3.3.2.3"><mi id="S3.E9.m1.3.3.3.3.3.3.2.3.2">m</mi></msqrt></mrow><mi id="S3.E9.m1.3.3.3.3.3.3.3">δ</mi></mfrac><mo id="S3.E9.m1.4.4.4.4.4.6.2.1.2">)</mo></mrow></mrow></mrow><mrow id="S3.E9.m1.4.4.4.6"><mn id="S3.E9.m1.4.4.4.6.2">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.4.6.1">​</mo><mi id="S3.E9.m1.4.4.4.6.3">m</mi></mrow></mfrac></mstyle></msqrt><mo id="S3.E9.m1.4.6">)</mo><msup id="S3.E9.m1.4.7"><mi id="S3.E9.m1.4.7a"></mi><mn id="S3.E9.m1.4.7.1">2</mn></msup><mo lspace="0em" id="S3.E9.m1.4.8">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\displaystyle\left.+\sqrt{\frac{\operatorname{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m}}\right)^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.21" class="ltx_p">Note that (<a href="#S3.E8" title="Equation 8 ‣ 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), (<a href="#S3.Ex2" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>) can be seen as proxys of (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). Indeed, every user has access to the total number of data points <math id="S3.SS1.p1.15.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.15.m1.1a"><mi id="S3.SS1.p1.15.m1.1.1" xref="S3.SS1.p1.15.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m1.1b"><ci id="S3.SS1.p1.15.m1.1.1.cmml" xref="S3.SS1.p1.15.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m1.1c">m</annotation></semantics></math> (as long as it is transmitted to the server), so the regularisation term (containing the KL divergence) is fully available, contrary to the empirical risk <math id="S3.SS1.p1.16.m2.1" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}}" display="inline"><semantics id="S3.SS1.p1.16.m2.1a"><msub id="S3.SS1.p1.16.m2.1.1" xref="S3.SS1.p1.16.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p1.16.m2.1.1.2" xref="S3.SS1.p1.16.m2.1.1.2.cmml"><mtext id="S3.SS1.p1.16.m2.1.1.2.2" xref="S3.SS1.p1.16.m2.1.1.2.2a.cmml">R</mtext><mo id="S3.SS1.p1.16.m2.1.1.2.1" xref="S3.SS1.p1.16.m2.1.1.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m2.1.1.3" xref="S3.SS1.p1.16.m2.1.1.3.cmml">𝒮</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m2.1b"><apply id="S3.SS1.p1.16.m2.1.1.cmml" xref="S3.SS1.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m2.1.1.1.cmml" xref="S3.SS1.p1.16.m2.1.1">subscript</csymbol><apply id="S3.SS1.p1.16.m2.1.1.2.cmml" xref="S3.SS1.p1.16.m2.1.1.2"><ci id="S3.SS1.p1.16.m2.1.1.2.1.cmml" xref="S3.SS1.p1.16.m2.1.1.2.1">^</ci><ci id="S3.SS1.p1.16.m2.1.1.2.2a.cmml" xref="S3.SS1.p1.16.m2.1.1.2.2"><mtext id="S3.SS1.p1.16.m2.1.1.2.2.cmml" xref="S3.SS1.p1.16.m2.1.1.2.2">R</mtext></ci></apply><ci id="S3.SS1.p1.16.m2.1.1.3.cmml" xref="S3.SS1.p1.16.m2.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m2.1c">\hat{\text{R}}_{\mathcal{S}}</annotation></semantics></math> which is then replaced by <math id="S3.SS1.p1.17.m3.1" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}_{i}}" display="inline"><semantics id="S3.SS1.p1.17.m3.1a"><msub id="S3.SS1.p1.17.m3.1.1" xref="S3.SS1.p1.17.m3.1.1.cmml"><mover accent="true" id="S3.SS1.p1.17.m3.1.1.2" xref="S3.SS1.p1.17.m3.1.1.2.cmml"><mtext id="S3.SS1.p1.17.m3.1.1.2.2" xref="S3.SS1.p1.17.m3.1.1.2.2a.cmml">R</mtext><mo id="S3.SS1.p1.17.m3.1.1.2.1" xref="S3.SS1.p1.17.m3.1.1.2.1.cmml">^</mo></mover><msub id="S3.SS1.p1.17.m3.1.1.3" xref="S3.SS1.p1.17.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.17.m3.1.1.3.2" xref="S3.SS1.p1.17.m3.1.1.3.2.cmml">𝒮</mi><mi id="S3.SS1.p1.17.m3.1.1.3.3" xref="S3.SS1.p1.17.m3.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m3.1b"><apply id="S3.SS1.p1.17.m3.1.1.cmml" xref="S3.SS1.p1.17.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m3.1.1.1.cmml" xref="S3.SS1.p1.17.m3.1.1">subscript</csymbol><apply id="S3.SS1.p1.17.m3.1.1.2.cmml" xref="S3.SS1.p1.17.m3.1.1.2"><ci id="S3.SS1.p1.17.m3.1.1.2.1.cmml" xref="S3.SS1.p1.17.m3.1.1.2.1">^</ci><ci id="S3.SS1.p1.17.m3.1.1.2.2a.cmml" xref="S3.SS1.p1.17.m3.1.1.2.2"><mtext id="S3.SS1.p1.17.m3.1.1.2.2.cmml" xref="S3.SS1.p1.17.m3.1.1.2.2">R</mtext></ci></apply><apply id="S3.SS1.p1.17.m3.1.1.3.cmml" xref="S3.SS1.p1.17.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m3.1.1.3.1.cmml" xref="S3.SS1.p1.17.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.17.m3.1.1.3.2.cmml" xref="S3.SS1.p1.17.m3.1.1.3.2">𝒮</ci><ci id="S3.SS1.p1.17.m3.1.1.3.3.cmml" xref="S3.SS1.p1.17.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m3.1c">\hat{\text{R}}_{\mathcal{S}_{i}}</annotation></semantics></math>. Note that in this case, the KL divergence is divided by <math id="S3.SS1.p1.18.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.18.m4.1a"><mi id="S3.SS1.p1.18.m4.1.1" xref="S3.SS1.p1.18.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m4.1b"><ci id="S3.SS1.p1.18.m4.1.1.cmml" xref="S3.SS1.p1.18.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m4.1c">m</annotation></semantics></math> instead of <math id="S3.SS1.p1.19.m5.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS1.p1.19.m5.1a"><msub id="S3.SS1.p1.19.m5.1.1" xref="S3.SS1.p1.19.m5.1.1.cmml"><mi id="S3.SS1.p1.19.m5.1.1.2" xref="S3.SS1.p1.19.m5.1.1.2.cmml">m</mi><mi id="S3.SS1.p1.19.m5.1.1.3" xref="S3.SS1.p1.19.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m5.1b"><apply id="S3.SS1.p1.19.m5.1.1.cmml" xref="S3.SS1.p1.19.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m5.1.1.1.cmml" xref="S3.SS1.p1.19.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m5.1.1.2.cmml" xref="S3.SS1.p1.19.m5.1.1.2">𝑚</ci><ci id="S3.SS1.p1.19.m5.1.1.3.cmml" xref="S3.SS1.p1.19.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m5.1c">m_{i}</annotation></semantics></math> (which would be natural if we were optimising (<a href="#S2.E3" title="Equation 3 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) (<a href="#S2.E4" title="Equation 4 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) for <math id="S3.SS1.p1.20.m6.1" class="ltx_Math" alttext="\mathcal{S}_{i}" display="inline"><semantics id="S3.SS1.p1.20.m6.1a"><msub id="S3.SS1.p1.20.m6.1.1" xref="S3.SS1.p1.20.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.20.m6.1.1.2" xref="S3.SS1.p1.20.m6.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.20.m6.1.1.3" xref="S3.SS1.p1.20.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m6.1b"><apply id="S3.SS1.p1.20.m6.1.1.cmml" xref="S3.SS1.p1.20.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m6.1.1.1.cmml" xref="S3.SS1.p1.20.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m6.1.1.2.cmml" xref="S3.SS1.p1.20.m6.1.1.2">𝒮</ci><ci id="S3.SS1.p1.20.m6.1.1.3.cmml" xref="S3.SS1.p1.20.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m6.1c">\mathcal{S}_{i}</annotation></semantics></math> instead of <math id="S3.SS1.p1.21.m7.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.21.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.21.m7.1.1" xref="S3.SS1.p1.21.m7.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m7.1b"><ci id="S3.SS1.p1.21.m7.1.1.cmml" xref="S3.SS1.p1.21.m7.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m7.1c">\mathcal{S}</annotation></semantics></math>). This suggests that each user has to give more weight, during the optimisation phase, to its data than to the regularisation. The reason behind this is that the server, by aggregating predictors, performs a regularisation step on a global level, hence the need to prioritise data on a local one.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.4" class="ltx_p"><span id="S3.SS1.p2.4.1" class="ltx_text ltx_font_bold">A global generalisation guarantee.</span> A major interest of the <span id="S3.SS1.p2.4.2" class="ltx_text ltx_font_italic">i.i.d.</span> assumption on <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{S}</annotation></semantics></math> is that, as long as users all exploit the same posterior distribution <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">Q</annotation></semantics></math>, and they transmit their empirical scores <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}_{i}}(Q)" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.2" xref="S3.SS1.p2.3.m3.1.2.cmml"><msub id="S3.SS1.p2.3.m3.1.2.2" xref="S3.SS1.p2.3.m3.1.2.2.cmml"><mover accent="true" id="S3.SS1.p2.3.m3.1.2.2.2" xref="S3.SS1.p2.3.m3.1.2.2.2.cmml"><mtext id="S3.SS1.p2.3.m3.1.2.2.2.2" xref="S3.SS1.p2.3.m3.1.2.2.2.2a.cmml">R</mtext><mo id="S3.SS1.p2.3.m3.1.2.2.2.1" xref="S3.SS1.p2.3.m3.1.2.2.2.1.cmml">^</mo></mover><msub id="S3.SS1.p2.3.m3.1.2.2.3" xref="S3.SS1.p2.3.m3.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.2.2.3.2" xref="S3.SS1.p2.3.m3.1.2.2.3.2.cmml">𝒮</mi><mi id="S3.SS1.p2.3.m3.1.2.2.3.3" xref="S3.SS1.p2.3.m3.1.2.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.2.1" xref="S3.SS1.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.3.m3.1.2.3.2" xref="S3.SS1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.1.2.3.2.1" xref="S3.SS1.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">Q</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.1.2.3.2.2" xref="S3.SS1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.2.cmml" xref="S3.SS1.p2.3.m3.1.2"><times id="S3.SS1.p2.3.m3.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2.1"></times><apply id="S3.SS1.p2.3.m3.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2.2">subscript</csymbol><apply id="S3.SS1.p2.3.m3.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2"><ci id="S3.SS1.p2.3.m3.1.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2.1">^</ci><ci id="S3.SS1.p2.3.m3.1.2.2.2.2a.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2.2"><mtext id="S3.SS1.p2.3.m3.1.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2.2">R</mtext></ci></apply><apply id="S3.SS1.p2.3.m3.1.2.2.3.cmml" xref="S3.SS1.p2.3.m3.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.2.3.1.cmml" xref="S3.SS1.p2.3.m3.1.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.2.2.3.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2.3.2">𝒮</ci><ci id="S3.SS1.p2.3.m3.1.2.2.3.3.cmml" xref="S3.SS1.p2.3.m3.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\hat{\text{R}}_{\mathcal{S}_{i}}(Q)</annotation></semantics></math>, every user is able to compute the global generalisation guarantee of (<a href="#S2.E2" title="Equation 2 ‣ Theorem 1 (McAllester’s bound). ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). This allows to maintain the bound of the batch setting (involving the total number of data points <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">m</annotation></semantics></math>), despite being in FL. This is empirically shown in <a href="#S4" title="4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>. We present in <a href="#alg2" title="In 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">2</span></a> <span id="S3.SS1.p2.4.3" class="ltx_text ltx_font_smallcaps">Fedbound</span>, the algorithm we use to compute the global bound (<a href="#S2.E7" title="Equation 7 ‣ Generalisation bounds. ‣ 2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), valid for all users simultaneously.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.19.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <span id="alg2.20.2" class="ltx_text ltx_font_smallcaps">FedBound</span>. The K users are indexed by k; <math id="alg2.9.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg2.9.m1.1b"><mi id="alg2.9.m1.1.1" xref="alg2.9.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg2.9.m1.1c"><ci id="alg2.9.m1.1.1.cmml" xref="alg2.9.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m1.1d">f</annotation></semantics></math> PAC-Bayes objective, prior <math id="alg2.10.m2.1" class="ltx_math_unparsed" alttext="\mathcal{N}(\mu_{\text{prior}}" display="inline"><semantics id="alg2.10.m2.1b"><mrow id="alg2.10.m2.1c"><mi class="ltx_font_mathcaligraphic" id="alg2.10.m2.1.1">𝒩</mi><mrow id="alg2.10.m2.1.2"><mo stretchy="false" id="alg2.10.m2.1.2.1">(</mo><msub id="alg2.10.m2.1.2.2"><mi id="alg2.10.m2.1.2.2.2">μ</mi><mtext id="alg2.10.m2.1.2.2.3">prior</mtext></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg2.10.m2.1d">\mathcal{N}(\mu_{\text{prior}}</annotation></semantics></math>, <math id="alg2.11.m3.1" class="ltx_math_unparsed" alttext="\sigma_{\text{prior}})" display="inline"><semantics id="alg2.11.m3.1b"><mrow id="alg2.11.m3.1c"><msub id="alg2.11.m3.1.1"><mi id="alg2.11.m3.1.1.2">σ</mi><mtext id="alg2.11.m3.1.1.3">prior</mtext></msub><mo stretchy="false" id="alg2.11.m3.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="alg2.11.m3.1d">\sigma_{\text{prior}})</annotation></semantics></math>; posterior <math id="alg2.12.m4.1" class="ltx_math_unparsed" alttext="\mathcal{N}(\mu_{T}" display="inline"><semantics id="alg2.12.m4.1b"><mrow id="alg2.12.m4.1c"><mi class="ltx_font_mathcaligraphic" id="alg2.12.m4.1.1">𝒩</mi><mrow id="alg2.12.m4.1.2"><mo stretchy="false" id="alg2.12.m4.1.2.1">(</mo><msub id="alg2.12.m4.1.2.2"><mi id="alg2.12.m4.1.2.2.2">μ</mi><mi id="alg2.12.m4.1.2.2.3">T</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg2.12.m4.1d">\mathcal{N}(\mu_{T}</annotation></semantics></math>, <math id="alg2.13.m5.1" class="ltx_math_unparsed" alttext="\sigma_{T})" display="inline"><semantics id="alg2.13.m5.1b"><mrow id="alg2.13.m5.1c"><msub id="alg2.13.m5.1.1"><mi id="alg2.13.m5.1.1.2">σ</mi><mi id="alg2.13.m5.1.1.3">T</mi></msub><mo stretchy="false" id="alg2.13.m5.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="alg2.13.m5.1d">\sigma_{T})</annotation></semantics></math>, <math id="alg2.14.m6.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg2.14.m6.1b"><mi id="alg2.14.m6.1.1" xref="alg2.14.m6.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg2.14.m6.1c"><ci id="alg2.14.m6.1.1.cmml" xref="alg2.14.m6.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.m6.1d">\delta</annotation></semantics></math>, <math id="alg2.15.m7.1" class="ltx_Math" alttext="\delta^{{}^{\prime}}" display="inline"><semantics id="alg2.15.m7.1b"><msup id="alg2.15.m7.1.1" xref="alg2.15.m7.1.1.cmml"><mi id="alg2.15.m7.1.1.2" xref="alg2.15.m7.1.1.2.cmml">δ</mi><msup id="alg2.15.m7.1.1.3" xref="alg2.15.m7.1.1.3.cmml"><mi id="alg2.15.m7.1.1.3b" xref="alg2.15.m7.1.1.3.cmml"></mi><mo id="alg2.15.m7.1.1.3.1" xref="alg2.15.m7.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="alg2.15.m7.1c"><apply id="alg2.15.m7.1.1.cmml" xref="alg2.15.m7.1.1"><csymbol cd="ambiguous" id="alg2.15.m7.1.1.1.cmml" xref="alg2.15.m7.1.1">superscript</csymbol><ci id="alg2.15.m7.1.1.2.cmml" xref="alg2.15.m7.1.1.2">𝛿</ci><apply id="alg2.15.m7.1.1.3.cmml" xref="alg2.15.m7.1.1.3"><ci id="alg2.15.m7.1.1.3.1.cmml" xref="alg2.15.m7.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.m7.1d">\delta^{{}^{\prime}}</annotation></semantics></math> parameters, <math id="alg2.16.m8.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg2.16.m8.1b"><mi id="alg2.16.m8.1.1" xref="alg2.16.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg2.16.m8.1c"><ci id="alg2.16.m8.1.1.cmml" xref="alg2.16.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.m8.1d">n</annotation></semantics></math> number of Monte Carlo sampling</figcaption>
<div id="alg2.21" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg2.l1.1" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg2.l2.m1.1" class="ltx_Math" alttext="m\leftarrow\sum_{k=1}^{K}m_{k}" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">m</mi><mo rspace="0.111em" stretchy="false" id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">←</mo><mrow id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><msubsup id="alg2.l2.m1.1.1.3.1" xref="alg2.l2.m1.1.1.3.1.cmml"><mo id="alg2.l2.m1.1.1.3.1.2.2" xref="alg2.l2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg2.l2.m1.1.1.3.1.2.3" xref="alg2.l2.m1.1.1.3.1.2.3.cmml"><mi id="alg2.l2.m1.1.1.3.1.2.3.2" xref="alg2.l2.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg2.l2.m1.1.1.3.1.2.3.1" xref="alg2.l2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg2.l2.m1.1.1.3.1.2.3.3" xref="alg2.l2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l2.m1.1.1.3.1.3" xref="alg2.l2.m1.1.1.3.1.3.cmml">K</mi></msubsup><msub id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml"><mi id="alg2.l2.m1.1.1.3.2.2" xref="alg2.l2.m1.1.1.3.2.2.cmml">m</mi><mi id="alg2.l2.m1.1.1.3.2.3" xref="alg2.l2.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><ci id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1">←</ci><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑚</ci><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><apply id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.1.cmml" xref="alg2.l2.m1.1.1.3.1">superscript</csymbol><apply id="alg2.l2.m1.1.1.3.1.2.cmml" xref="alg2.l2.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.2.1.cmml" xref="alg2.l2.m1.1.1.3.1">subscript</csymbol><sum id="alg2.l2.m1.1.1.3.1.2.2.cmml" xref="alg2.l2.m1.1.1.3.1.2.2"></sum><apply id="alg2.l2.m1.1.1.3.1.2.3.cmml" xref="alg2.l2.m1.1.1.3.1.2.3"><eq id="alg2.l2.m1.1.1.3.1.2.3.1.cmml" xref="alg2.l2.m1.1.1.3.1.2.3.1"></eq><ci id="alg2.l2.m1.1.1.3.1.2.3.2.cmml" xref="alg2.l2.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg2.l2.m1.1.1.3.1.2.3.3.cmml" xref="alg2.l2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l2.m1.1.1.3.1.3.cmml" xref="alg2.l2.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.2.1.cmml" xref="alg2.l2.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.2.cmml" xref="alg2.l2.m1.1.1.3.2.2">𝑚</ci><ci id="alg2.l2.m1.1.1.3.2.3.cmml" xref="alg2.l2.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">m\leftarrow\sum_{k=1}^{K}m_{k}</annotation></semantics></math> <span id="alg2.l2.1" class="ltx_text" style="float:right;"><math id="alg2.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l2.1.m1.1a"><mo id="alg2.l2.1.m1.1.1" xref="alg2.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l2.1.m1.1b"><ci id="alg2.l2.1.m1.1.1.cmml" xref="alg2.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.1.m1.1c">\triangleright</annotation></semantics></math> Total dataset size
</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><math id="alg2.l3.m1.2" class="ltx_Math" alttext="\mathrm{P}=\mathcal{N}(\mu_{\text{prior}},\sigma_{\text{prior}})" display="inline"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mi mathvariant="normal" id="alg2.l3.m1.2.2.4" xref="alg2.l3.m1.2.2.4.cmml">P</mi><mo id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">=</mo><mrow id="alg2.l3.m1.2.2.2" xref="alg2.l3.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.2.2.4" xref="alg2.l3.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.2.2.2.3" xref="alg2.l3.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l3.m1.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l3.m1.1.1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.1.1.1.1.1.1.2" xref="alg2.l3.m1.1.1.1.1.1.1.2.cmml">μ</mi><mtext id="alg2.l3.m1.1.1.1.1.1.1.3" xref="alg2.l3.m1.1.1.1.1.1.1.3a.cmml">prior</mtext></msub><mo id="alg2.l3.m1.2.2.2.2.2.4" xref="alg2.l3.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l3.m1.2.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.2.cmml"><mi id="alg2.l3.m1.2.2.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.2.2.cmml">σ</mi><mtext id="alg2.l3.m1.2.2.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.2.2.2.3a.cmml">prior</mtext></msub><mo stretchy="false" id="alg2.l3.m1.2.2.2.2.2.5" xref="alg2.l3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><eq id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3"></eq><ci id="alg2.l3.m1.2.2.4.cmml" xref="alg2.l3.m1.2.2.4">P</ci><apply id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2.2"><times id="alg2.l3.m1.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.3"></times><ci id="alg2.l3.m1.2.2.2.4.cmml" xref="alg2.l3.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg2.l3.m1.2.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2.2"><apply id="alg2.l3.m1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg2.l3.m1.1.1.1.1.1.1.3a.cmml" xref="alg2.l3.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.1.1.1.3">prior</mtext></ci></apply><apply id="alg2.l3.m1.2.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l3.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l3.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2.2.2">𝜎</ci><ci id="alg2.l3.m1.2.2.2.2.2.2.3a.cmml" xref="alg2.l3.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="alg2.l3.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2.2.2.3">prior</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\mathrm{P}=\mathcal{N}(\mu_{\text{prior}},\sigma_{\text{prior}})</annotation></semantics></math> <span id="alg2.l3.1" class="ltx_text" style="float:right;"><math id="alg2.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l3.1.m1.1a"><mo id="alg2.l3.1.m1.1.1" xref="alg2.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l3.1.m1.1b"><ci id="alg2.l3.1.m1.1.1.cmml" xref="alg2.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.1.m1.1c">\triangleright</annotation></semantics></math> Prior (learned or random)
</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><math id="alg2.l4.m1.2" class="ltx_Math" alttext="\mathrm{Q}=\mathcal{N}(\mu_{T},\sigma_{T})" display="inline"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml"><mi mathvariant="normal" id="alg2.l4.m1.2.2.4" xref="alg2.l4.m1.2.2.4.cmml">Q</mi><mo id="alg2.l4.m1.2.2.3" xref="alg2.l4.m1.2.2.3.cmml">=</mo><mrow id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.2.2.2.4" xref="alg2.l4.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.2.2.2.3" xref="alg2.l4.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l4.m1.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l4.m1.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="alg2.l4.m1.2.2.2.2.2.4" xref="alg2.l4.m1.2.2.2.2.3.cmml">,</mo><msub id="alg2.l4.m1.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.cmml"><mi id="alg2.l4.m1.2.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.2.cmml">σ</mi><mi id="alg2.l4.m1.2.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="alg2.l4.m1.2.2.2.2.2.5" xref="alg2.l4.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2"><eq id="alg2.l4.m1.2.2.3.cmml" xref="alg2.l4.m1.2.2.3"></eq><ci id="alg2.l4.m1.2.2.4.cmml" xref="alg2.l4.m1.2.2.4">Q</ci><apply id="alg2.l4.m1.2.2.2.cmml" xref="alg2.l4.m1.2.2.2"><times id="alg2.l4.m1.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.3"></times><ci id="alg2.l4.m1.2.2.2.4.cmml" xref="alg2.l4.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg2.l4.m1.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.2"><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="alg2.l4.m1.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l4.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2.2">𝜎</ci><ci id="alg2.l4.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.2.2.3">𝑇</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">\mathrm{Q}=\mathcal{N}(\mu_{T},\sigma_{T})</annotation></semantics></math> <span id="alg2.l4.1" class="ltx_text" style="float:right;"><math id="alg2.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l4.1.m1.1a"><mo id="alg2.l4.1.m1.1.1" xref="alg2.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.1.m1.1b"><ci id="alg2.l4.1.m1.1.1.cmml" xref="alg2.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.1.m1.1c">\triangleright</annotation></semantics></math> Posterior (learned)
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span><span id="alg2.l5.1" class="ltx_text ltx_font_bold">for</span> each user <math id="alg2.l5.m1.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">k</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">∈</mo><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><in id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></in><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑘</ci><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">k\in K</annotation></semantics></math> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg2.l6.m1.3" class="ltx_Math" alttext="error^{k}\leftarrow\textrm{userMCSampling}(k,w_{t},m)" display="inline"><semantics id="alg2.l6.m1.3a"><mrow id="alg2.l6.m1.3.3" xref="alg2.l6.m1.3.3.cmml"><mrow id="alg2.l6.m1.3.3.3" xref="alg2.l6.m1.3.3.3.cmml"><mi id="alg2.l6.m1.3.3.3.2" xref="alg2.l6.m1.3.3.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.3.3.3.1" xref="alg2.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.3.3.3.3" xref="alg2.l6.m1.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.3.3.3.1a" xref="alg2.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.3.3.3.4" xref="alg2.l6.m1.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.3.3.3.1b" xref="alg2.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.3.3.3.5" xref="alg2.l6.m1.3.3.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.3.3.3.1c" xref="alg2.l6.m1.3.3.3.1.cmml">​</mo><msup id="alg2.l6.m1.3.3.3.6" xref="alg2.l6.m1.3.3.3.6.cmml"><mi id="alg2.l6.m1.3.3.3.6.2" xref="alg2.l6.m1.3.3.3.6.2.cmml">r</mi><mi id="alg2.l6.m1.3.3.3.6.3" xref="alg2.l6.m1.3.3.3.6.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="alg2.l6.m1.3.3.2" xref="alg2.l6.m1.3.3.2.cmml">←</mo><mrow id="alg2.l6.m1.3.3.1" xref="alg2.l6.m1.3.3.1.cmml"><mtext id="alg2.l6.m1.3.3.1.3" xref="alg2.l6.m1.3.3.1.3a.cmml">userMCSampling</mtext><mo lspace="0em" rspace="0em" id="alg2.l6.m1.3.3.1.2" xref="alg2.l6.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l6.m1.3.3.1.1.1" xref="alg2.l6.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.2" xref="alg2.l6.m1.3.3.1.1.2.cmml">(</mo><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">k</mi><mo id="alg2.l6.m1.3.3.1.1.1.3" xref="alg2.l6.m1.3.3.1.1.2.cmml">,</mo><msub id="alg2.l6.m1.3.3.1.1.1.1" xref="alg2.l6.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l6.m1.3.3.1.1.1.1.2" xref="alg2.l6.m1.3.3.1.1.1.1.2.cmml">w</mi><mi id="alg2.l6.m1.3.3.1.1.1.1.3" xref="alg2.l6.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l6.m1.3.3.1.1.1.4" xref="alg2.l6.m1.3.3.1.1.2.cmml">,</mo><mi id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml">m</mi><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.5" xref="alg2.l6.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.3b"><apply id="alg2.l6.m1.3.3.cmml" xref="alg2.l6.m1.3.3"><ci id="alg2.l6.m1.3.3.2.cmml" xref="alg2.l6.m1.3.3.2">←</ci><apply id="alg2.l6.m1.3.3.3.cmml" xref="alg2.l6.m1.3.3.3"><times id="alg2.l6.m1.3.3.3.1.cmml" xref="alg2.l6.m1.3.3.3.1"></times><ci id="alg2.l6.m1.3.3.3.2.cmml" xref="alg2.l6.m1.3.3.3.2">𝑒</ci><ci id="alg2.l6.m1.3.3.3.3.cmml" xref="alg2.l6.m1.3.3.3.3">𝑟</ci><ci id="alg2.l6.m1.3.3.3.4.cmml" xref="alg2.l6.m1.3.3.3.4">𝑟</ci><ci id="alg2.l6.m1.3.3.3.5.cmml" xref="alg2.l6.m1.3.3.3.5">𝑜</ci><apply id="alg2.l6.m1.3.3.3.6.cmml" xref="alg2.l6.m1.3.3.3.6"><csymbol cd="ambiguous" id="alg2.l6.m1.3.3.3.6.1.cmml" xref="alg2.l6.m1.3.3.3.6">superscript</csymbol><ci id="alg2.l6.m1.3.3.3.6.2.cmml" xref="alg2.l6.m1.3.3.3.6.2">𝑟</ci><ci id="alg2.l6.m1.3.3.3.6.3.cmml" xref="alg2.l6.m1.3.3.3.6.3">𝑘</ci></apply></apply><apply id="alg2.l6.m1.3.3.1.cmml" xref="alg2.l6.m1.3.3.1"><times id="alg2.l6.m1.3.3.1.2.cmml" xref="alg2.l6.m1.3.3.1.2"></times><ci id="alg2.l6.m1.3.3.1.3a.cmml" xref="alg2.l6.m1.3.3.1.3"><mtext id="alg2.l6.m1.3.3.1.3.cmml" xref="alg2.l6.m1.3.3.1.3">userMCSampling</mtext></ci><vector id="alg2.l6.m1.3.3.1.1.2.cmml" xref="alg2.l6.m1.3.3.1.1.1"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑘</ci><apply id="alg2.l6.m1.3.3.1.1.1.1.cmml" xref="alg2.l6.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l6.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.2">𝑤</ci><ci id="alg2.l6.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.3">𝑡</ci></apply><ci id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2">𝑚</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.3c">error^{k}\leftarrow\textrm{userMCSampling}(k,w_{t},m)</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg2.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span><math id="alg2.l8.m1.1" class="ltx_Math" alttext="error\leftarrow\sum_{k=1}^{K}\frac{m_{k}}{m}error_{k}" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mrow id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml"><mi id="alg2.l8.m1.1.1.2.2" xref="alg2.l8.m1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.2.1" xref="alg2.l8.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.2.3" xref="alg2.l8.m1.1.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.2.1a" xref="alg2.l8.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.2.4" xref="alg2.l8.m1.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.2.1b" xref="alg2.l8.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.2.5" xref="alg2.l8.m1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.2.1c" xref="alg2.l8.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.2.6" xref="alg2.l8.m1.1.1.2.6.cmml">r</mi></mrow><mo rspace="0.111em" stretchy="false" id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">←</mo><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><msubsup id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml"><mo id="alg2.l8.m1.1.1.3.1.2.2" xref="alg2.l8.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg2.l8.m1.1.1.3.1.2.3" xref="alg2.l8.m1.1.1.3.1.2.3.cmml"><mi id="alg2.l8.m1.1.1.3.1.2.3.2" xref="alg2.l8.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg2.l8.m1.1.1.3.1.2.3.1" xref="alg2.l8.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg2.l8.m1.1.1.3.1.2.3.3" xref="alg2.l8.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l8.m1.1.1.3.1.3" xref="alg2.l8.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml"><mfrac id="alg2.l8.m1.1.1.3.2.2" xref="alg2.l8.m1.1.1.3.2.2.cmml"><msub id="alg2.l8.m1.1.1.3.2.2.2" xref="alg2.l8.m1.1.1.3.2.2.2.cmml"><mi id="alg2.l8.m1.1.1.3.2.2.2.2" xref="alg2.l8.m1.1.1.3.2.2.2.2.cmml">m</mi><mi id="alg2.l8.m1.1.1.3.2.2.2.3" xref="alg2.l8.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg2.l8.m1.1.1.3.2.2.3" xref="alg2.l8.m1.1.1.3.2.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.2.1" xref="alg2.l8.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.2.3" xref="alg2.l8.m1.1.1.3.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.2.1a" xref="alg2.l8.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.2.4" xref="alg2.l8.m1.1.1.3.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.2.1b" xref="alg2.l8.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.2.5" xref="alg2.l8.m1.1.1.3.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.2.1c" xref="alg2.l8.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.2.6" xref="alg2.l8.m1.1.1.3.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.2.1d" xref="alg2.l8.m1.1.1.3.2.1.cmml">​</mo><msub id="alg2.l8.m1.1.1.3.2.7" xref="alg2.l8.m1.1.1.3.2.7.cmml"><mi id="alg2.l8.m1.1.1.3.2.7.2" xref="alg2.l8.m1.1.1.3.2.7.2.cmml">r</mi><mi id="alg2.l8.m1.1.1.3.2.7.3" xref="alg2.l8.m1.1.1.3.2.7.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">←</ci><apply id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2"><times id="alg2.l8.m1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1.2.1"></times><ci id="alg2.l8.m1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.2.2">𝑒</ci><ci id="alg2.l8.m1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.2.3">𝑟</ci><ci id="alg2.l8.m1.1.1.2.4.cmml" xref="alg2.l8.m1.1.1.2.4">𝑟</ci><ci id="alg2.l8.m1.1.1.2.5.cmml" xref="alg2.l8.m1.1.1.2.5">𝑜</ci><ci id="alg2.l8.m1.1.1.2.6.cmml" xref="alg2.l8.m1.1.1.2.6">𝑟</ci></apply><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><apply id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.1.1.cmml" xref="alg2.l8.m1.1.1.3.1">superscript</csymbol><apply id="alg2.l8.m1.1.1.3.1.2.cmml" xref="alg2.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.1.2.1.cmml" xref="alg2.l8.m1.1.1.3.1">subscript</csymbol><sum id="alg2.l8.m1.1.1.3.1.2.2.cmml" xref="alg2.l8.m1.1.1.3.1.2.2"></sum><apply id="alg2.l8.m1.1.1.3.1.2.3.cmml" xref="alg2.l8.m1.1.1.3.1.2.3"><eq id="alg2.l8.m1.1.1.3.1.2.3.1.cmml" xref="alg2.l8.m1.1.1.3.1.2.3.1"></eq><ci id="alg2.l8.m1.1.1.3.1.2.3.2.cmml" xref="alg2.l8.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg2.l8.m1.1.1.3.1.2.3.3.cmml" xref="alg2.l8.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l8.m1.1.1.3.1.3.cmml" xref="alg2.l8.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2"><times id="alg2.l8.m1.1.1.3.2.1.cmml" xref="alg2.l8.m1.1.1.3.2.1"></times><apply id="alg2.l8.m1.1.1.3.2.2.cmml" xref="alg2.l8.m1.1.1.3.2.2"><divide id="alg2.l8.m1.1.1.3.2.2.1.cmml" xref="alg2.l8.m1.1.1.3.2.2"></divide><apply id="alg2.l8.m1.1.1.3.2.2.2.cmml" xref="alg2.l8.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.2.2.2.1.cmml" xref="alg2.l8.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.3.2.2.2.2.cmml" xref="alg2.l8.m1.1.1.3.2.2.2.2">𝑚</ci><ci id="alg2.l8.m1.1.1.3.2.2.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg2.l8.m1.1.1.3.2.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.2.3">𝑚</ci></apply><ci id="alg2.l8.m1.1.1.3.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.3">𝑒</ci><ci id="alg2.l8.m1.1.1.3.2.4.cmml" xref="alg2.l8.m1.1.1.3.2.4">𝑟</ci><ci id="alg2.l8.m1.1.1.3.2.5.cmml" xref="alg2.l8.m1.1.1.3.2.5">𝑟</ci><ci id="alg2.l8.m1.1.1.3.2.6.cmml" xref="alg2.l8.m1.1.1.3.2.6">𝑜</ci><apply id="alg2.l8.m1.1.1.3.2.7.cmml" xref="alg2.l8.m1.1.1.3.2.7"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.2.7.1.cmml" xref="alg2.l8.m1.1.1.3.2.7">subscript</csymbol><ci id="alg2.l8.m1.1.1.3.2.7.2.cmml" xref="alg2.l8.m1.1.1.3.2.7.2">𝑟</ci><ci id="alg2.l8.m1.1.1.3.2.7.3.cmml" xref="alg2.l8.m1.1.1.3.2.7.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">error\leftarrow\sum_{k=1}^{K}\frac{m_{k}}{m}error_{k}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><math id="alg2.l9.m1.3" class="ltx_Math" alttext="KL\_inv\leftarrow\mathrm{kl}^{-1}\left(error\mid\frac{1}{n}\ln(\frac{2}{\delta^{{}^{\prime}}})\right)" display="inline"><semantics id="alg2.l9.m1.3a"><mrow id="alg2.l9.m1.3.3" xref="alg2.l9.m1.3.3.cmml"><mrow id="alg2.l9.m1.3.3.3" xref="alg2.l9.m1.3.3.3.cmml"><mi id="alg2.l9.m1.3.3.3.2" xref="alg2.l9.m1.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.1" xref="alg2.l9.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.1a" xref="alg2.l9.m1.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l9.m1.3.3.3.4" xref="alg2.l9.m1.3.3.3.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.1b" xref="alg2.l9.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.3.5" xref="alg2.l9.m1.3.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.1c" xref="alg2.l9.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.3.6" xref="alg2.l9.m1.3.3.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.1d" xref="alg2.l9.m1.3.3.3.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.3.7" xref="alg2.l9.m1.3.3.3.7.cmml">v</mi></mrow><mo stretchy="false" id="alg2.l9.m1.3.3.2" xref="alg2.l9.m1.3.3.2.cmml">←</mo><mrow id="alg2.l9.m1.3.3.1" xref="alg2.l9.m1.3.3.1.cmml"><msup id="alg2.l9.m1.3.3.1.3" xref="alg2.l9.m1.3.3.1.3.cmml"><mi id="alg2.l9.m1.3.3.1.3.2" xref="alg2.l9.m1.3.3.1.3.2.cmml">kl</mi><mrow id="alg2.l9.m1.3.3.1.3.3" xref="alg2.l9.m1.3.3.1.3.3.cmml"><mo id="alg2.l9.m1.3.3.1.3.3a" xref="alg2.l9.m1.3.3.1.3.3.cmml">−</mo><mn id="alg2.l9.m1.3.3.1.3.3.2" xref="alg2.l9.m1.3.3.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.2" xref="alg2.l9.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l9.m1.3.3.1.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.cmml"><mo id="alg2.l9.m1.3.3.1.1.1.2" xref="alg2.l9.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg2.l9.m1.3.3.1.1.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.cmml"><mrow id="alg2.l9.m1.3.3.1.1.1.1.2" xref="alg2.l9.m1.3.3.1.1.1.1.2.cmml"><mi id="alg2.l9.m1.3.3.1.1.1.1.2.2" xref="alg2.l9.m1.3.3.1.1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.1.1.1.2.1" xref="alg2.l9.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.1.1.1.1.2.3" xref="alg2.l9.m1.3.3.1.1.1.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.1.1.1.2.1a" xref="alg2.l9.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.1.1.1.1.2.4" xref="alg2.l9.m1.3.3.1.1.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.1.1.1.2.1b" xref="alg2.l9.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.1.1.1.1.2.5" xref="alg2.l9.m1.3.3.1.1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.1.1.1.2.1c" xref="alg2.l9.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l9.m1.3.3.1.1.1.1.2.6" xref="alg2.l9.m1.3.3.1.1.1.1.2.6.cmml">r</mi></mrow><mo id="alg2.l9.m1.3.3.1.1.1.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.1.cmml">∣</mo><mrow id="alg2.l9.m1.3.3.1.1.1.1.3" xref="alg2.l9.m1.3.3.1.1.1.1.3.cmml"><mfrac id="alg2.l9.m1.3.3.1.1.1.1.3.2" xref="alg2.l9.m1.3.3.1.1.1.1.3.2.cmml"><mn id="alg2.l9.m1.3.3.1.1.1.1.3.2.2" xref="alg2.l9.m1.3.3.1.1.1.1.3.2.2.cmml">1</mn><mi id="alg2.l9.m1.3.3.1.1.1.1.3.2.3" xref="alg2.l9.m1.3.3.1.1.1.1.3.2.3.cmml">n</mi></mfrac><mo lspace="0.167em" rspace="0em" id="alg2.l9.m1.3.3.1.1.1.1.3.1" xref="alg2.l9.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="alg2.l9.m1.3.3.1.1.1.1.3.3.2" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">ln</mi><mo id="alg2.l9.m1.3.3.1.1.1.1.3.3.2a" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="alg2.l9.m1.3.3.1.1.1.1.3.3.2.1" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="alg2.l9.m1.3.3.1.1.1.1.3.3.2.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml">(</mo><mfrac id="alg2.l9.m1.2.2" xref="alg2.l9.m1.2.2.cmml"><mn id="alg2.l9.m1.2.2.2" xref="alg2.l9.m1.2.2.2.cmml">2</mn><msup id="alg2.l9.m1.2.2.3" xref="alg2.l9.m1.2.2.3.cmml"><mi id="alg2.l9.m1.2.2.3.2" xref="alg2.l9.m1.2.2.3.2.cmml">δ</mi><msup id="alg2.l9.m1.2.2.3.3" xref="alg2.l9.m1.2.2.3.3.cmml"><mi id="alg2.l9.m1.2.2.3.3a" xref="alg2.l9.m1.2.2.3.3.cmml"></mi><mo id="alg2.l9.m1.2.2.3.3.1" xref="alg2.l9.m1.2.2.3.3.1.cmml">′</mo></msup></msup></mfrac><mo stretchy="false" id="alg2.l9.m1.3.3.1.1.1.1.3.3.2.1.2" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg2.l9.m1.3.3.1.1.1.3" xref="alg2.l9.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.3b"><apply id="alg2.l9.m1.3.3.cmml" xref="alg2.l9.m1.3.3"><ci id="alg2.l9.m1.3.3.2.cmml" xref="alg2.l9.m1.3.3.2">←</ci><apply id="alg2.l9.m1.3.3.3.cmml" xref="alg2.l9.m1.3.3.3"><times id="alg2.l9.m1.3.3.3.1.cmml" xref="alg2.l9.m1.3.3.3.1"></times><ci id="alg2.l9.m1.3.3.3.2.cmml" xref="alg2.l9.m1.3.3.3.2">𝐾</ci><ci id="alg2.l9.m1.3.3.3.3.cmml" xref="alg2.l9.m1.3.3.3.3">𝐿</ci><ci id="alg2.l9.m1.3.3.3.4.cmml" xref="alg2.l9.m1.3.3.3.4">_</ci><ci id="alg2.l9.m1.3.3.3.5.cmml" xref="alg2.l9.m1.3.3.3.5">𝑖</ci><ci id="alg2.l9.m1.3.3.3.6.cmml" xref="alg2.l9.m1.3.3.3.6">𝑛</ci><ci id="alg2.l9.m1.3.3.3.7.cmml" xref="alg2.l9.m1.3.3.3.7">𝑣</ci></apply><apply id="alg2.l9.m1.3.3.1.cmml" xref="alg2.l9.m1.3.3.1"><times id="alg2.l9.m1.3.3.1.2.cmml" xref="alg2.l9.m1.3.3.1.2"></times><apply id="alg2.l9.m1.3.3.1.3.cmml" xref="alg2.l9.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.1.3.1.cmml" xref="alg2.l9.m1.3.3.1.3">superscript</csymbol><ci id="alg2.l9.m1.3.3.1.3.2.cmml" xref="alg2.l9.m1.3.3.1.3.2">kl</ci><apply id="alg2.l9.m1.3.3.1.3.3.cmml" xref="alg2.l9.m1.3.3.1.3.3"><minus id="alg2.l9.m1.3.3.1.3.3.1.cmml" xref="alg2.l9.m1.3.3.1.3.3"></minus><cn type="integer" id="alg2.l9.m1.3.3.1.3.3.2.cmml" xref="alg2.l9.m1.3.3.1.3.3.2">1</cn></apply></apply><apply id="alg2.l9.m1.3.3.1.1.1.1.cmml" xref="alg2.l9.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg2.l9.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="alg2.l9.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2"><times id="alg2.l9.m1.3.3.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.1"></times><ci id="alg2.l9.m1.3.3.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.2">𝑒</ci><ci id="alg2.l9.m1.3.3.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.3">𝑟</ci><ci id="alg2.l9.m1.3.3.1.1.1.1.2.4.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.4">𝑟</ci><ci id="alg2.l9.m1.3.3.1.1.1.1.2.5.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.5">𝑜</ci><ci id="alg2.l9.m1.3.3.1.1.1.1.2.6.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2.6">𝑟</ci></apply><apply id="alg2.l9.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3"><times id="alg2.l9.m1.3.3.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.1"></times><apply id="alg2.l9.m1.3.3.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.2"><divide id="alg2.l9.m1.3.3.1.1.1.1.3.2.1.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.2"></divide><cn type="integer" id="alg2.l9.m1.3.3.1.1.1.1.3.2.2.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.2.2">1</cn><ci id="alg2.l9.m1.3.3.1.1.1.1.3.2.3.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="alg2.l9.m1.3.3.1.1.1.1.3.3.1.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3.3.2"><ln id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"></ln><apply id="alg2.l9.m1.2.2.cmml" xref="alg2.l9.m1.2.2"><divide id="alg2.l9.m1.2.2.1.cmml" xref="alg2.l9.m1.2.2"></divide><cn type="integer" id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.2">2</cn><apply id="alg2.l9.m1.2.2.3.cmml" xref="alg2.l9.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.3.1.cmml" xref="alg2.l9.m1.2.2.3">superscript</csymbol><ci id="alg2.l9.m1.2.2.3.2.cmml" xref="alg2.l9.m1.2.2.3.2">𝛿</ci><apply id="alg2.l9.m1.2.2.3.3.cmml" xref="alg2.l9.m1.2.2.3.3"><ci id="alg2.l9.m1.2.2.3.3.1.cmml" xref="alg2.l9.m1.2.2.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.3c">KL\_inv\leftarrow\mathrm{kl}^{-1}\left(error\mid\frac{1}{n}\ln(\frac{2}{\delta^{{}^{\prime}}})\right)</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><math id="alg2.l10.m1.3" class="ltx_Math" alttext="\texttt{Up-bound}\leftarrow\mathrm{kl}^{-1}\left(KL\_inv\mid\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)" display="inline"><semantics id="alg2.l10.m1.3a"><mrow id="alg2.l10.m1.3.3" xref="alg2.l10.m1.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l10.m1.3.3.3" xref="alg2.l10.m1.3.3.3a.cmml">Up-bound</mtext><mo stretchy="false" id="alg2.l10.m1.3.3.2" xref="alg2.l10.m1.3.3.2.cmml">←</mo><mrow id="alg2.l10.m1.3.3.1" xref="alg2.l10.m1.3.3.1.cmml"><msup id="alg2.l10.m1.3.3.1.3" xref="alg2.l10.m1.3.3.1.3.cmml"><mi id="alg2.l10.m1.3.3.1.3.2" xref="alg2.l10.m1.3.3.1.3.2.cmml">kl</mi><mrow id="alg2.l10.m1.3.3.1.3.3" xref="alg2.l10.m1.3.3.1.3.3.cmml"><mo id="alg2.l10.m1.3.3.1.3.3a" xref="alg2.l10.m1.3.3.1.3.3.cmml">−</mo><mn id="alg2.l10.m1.3.3.1.3.3.2" xref="alg2.l10.m1.3.3.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.2" xref="alg2.l10.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l10.m1.3.3.1.1.1" xref="alg2.l10.m1.3.3.1.1.1.1.cmml"><mo id="alg2.l10.m1.3.3.1.1.1.2" xref="alg2.l10.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg2.l10.m1.3.3.1.1.1.1" xref="alg2.l10.m1.3.3.1.1.1.1.cmml"><mrow id="alg2.l10.m1.3.3.1.1.1.1.2" xref="alg2.l10.m1.3.3.1.1.1.1.2.cmml"><mi id="alg2.l10.m1.3.3.1.1.1.1.2.2" xref="alg2.l10.m1.3.3.1.1.1.1.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.1.1.1.2.1" xref="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.3.3.1.1.1.1.2.3" xref="alg2.l10.m1.3.3.1.1.1.1.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.1.1.1.2.1a" xref="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l10.m1.3.3.1.1.1.1.2.4" xref="alg2.l10.m1.3.3.1.1.1.1.2.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.1.1.1.2.1b" xref="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.3.3.1.1.1.1.2.5" xref="alg2.l10.m1.3.3.1.1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.1.1.1.2.1c" xref="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.3.3.1.1.1.1.2.6" xref="alg2.l10.m1.3.3.1.1.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.3.3.1.1.1.1.2.1d" xref="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.3.3.1.1.1.1.2.7" xref="alg2.l10.m1.3.3.1.1.1.1.2.7.cmml">v</mi></mrow><mo id="alg2.l10.m1.3.3.1.1.1.1.1" xref="alg2.l10.m1.3.3.1.1.1.1.1.cmml">∣</mo><mfrac id="alg2.l10.m1.2.2" xref="alg2.l10.m1.2.2.cmml"><mrow id="alg2.l10.m1.2.2.2" xref="alg2.l10.m1.2.2.2.cmml"><mrow id="alg2.l10.m1.2.2.2.2.1" xref="alg2.l10.m1.2.2.2.2.2.cmml"><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">KL</mi><mo id="alg2.l10.m1.2.2.2.2.1a" xref="alg2.l10.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="alg2.l10.m1.2.2.2.2.1.1" xref="alg2.l10.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="alg2.l10.m1.2.2.2.2.1.1.2" xref="alg2.l10.m1.2.2.2.2.2.cmml">(</mo><mrow id="alg2.l10.m1.2.2.2.2.1.1.1" xref="alg2.l10.m1.2.2.2.2.1.1.1.cmml"><mi id="alg2.l10.m1.2.2.2.2.1.1.1.2" xref="alg2.l10.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="alg2.l10.m1.2.2.2.2.1.1.1.1" xref="alg2.l10.m1.2.2.2.2.1.1.1.1.cmml">∥</mo><mi id="alg2.l10.m1.2.2.2.2.1.1.1.3" xref="alg2.l10.m1.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="alg2.l10.m1.2.2.2.2.1.1.3" xref="alg2.l10.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.l10.m1.2.2.2.3" xref="alg2.l10.m1.2.2.2.3.cmml">+</mo><mrow id="alg2.l10.m1.2.2.2.4" xref="alg2.l10.m1.2.2.2.4.cmml"><mi id="alg2.l10.m1.2.2.2.4.1" xref="alg2.l10.m1.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="alg2.l10.m1.2.2.2.4a" xref="alg2.l10.m1.2.2.2.4.cmml">⁡</mo><mfrac id="alg2.l10.m1.2.2.2.4.2" xref="alg2.l10.m1.2.2.2.4.2.cmml"><mrow id="alg2.l10.m1.2.2.2.4.2.2" xref="alg2.l10.m1.2.2.2.4.2.2.cmml"><mn id="alg2.l10.m1.2.2.2.4.2.2.2" xref="alg2.l10.m1.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.2.4.2.2.1" xref="alg2.l10.m1.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="alg2.l10.m1.2.2.2.4.2.2.3" xref="alg2.l10.m1.2.2.2.4.2.2.3.cmml"><mi id="alg2.l10.m1.2.2.2.4.2.2.3.2" xref="alg2.l10.m1.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="alg2.l10.m1.2.2.2.4.2.3" xref="alg2.l10.m1.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mi id="alg2.l10.m1.2.2.4" xref="alg2.l10.m1.2.2.4.cmml">m</mi></mfrac></mrow><mo id="alg2.l10.m1.3.3.1.1.1.3" xref="alg2.l10.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.3b"><apply id="alg2.l10.m1.3.3.cmml" xref="alg2.l10.m1.3.3"><ci id="alg2.l10.m1.3.3.2.cmml" xref="alg2.l10.m1.3.3.2">←</ci><ci id="alg2.l10.m1.3.3.3a.cmml" xref="alg2.l10.m1.3.3.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l10.m1.3.3.3.cmml" xref="alg2.l10.m1.3.3.3">Up-bound</mtext></ci><apply id="alg2.l10.m1.3.3.1.cmml" xref="alg2.l10.m1.3.3.1"><times id="alg2.l10.m1.3.3.1.2.cmml" xref="alg2.l10.m1.3.3.1.2"></times><apply id="alg2.l10.m1.3.3.1.3.cmml" xref="alg2.l10.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg2.l10.m1.3.3.1.3.1.cmml" xref="alg2.l10.m1.3.3.1.3">superscript</csymbol><ci id="alg2.l10.m1.3.3.1.3.2.cmml" xref="alg2.l10.m1.3.3.1.3.2">kl</ci><apply id="alg2.l10.m1.3.3.1.3.3.cmml" xref="alg2.l10.m1.3.3.1.3.3"><minus id="alg2.l10.m1.3.3.1.3.3.1.cmml" xref="alg2.l10.m1.3.3.1.3.3"></minus><cn type="integer" id="alg2.l10.m1.3.3.1.3.3.2.cmml" xref="alg2.l10.m1.3.3.1.3.3.2">1</cn></apply></apply><apply id="alg2.l10.m1.3.3.1.1.1.1.cmml" xref="alg2.l10.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg2.l10.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="alg2.l10.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2"><times id="alg2.l10.m1.3.3.1.1.1.1.2.1.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.1"></times><ci id="alg2.l10.m1.3.3.1.1.1.1.2.2.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.2">𝐾</ci><ci id="alg2.l10.m1.3.3.1.1.1.1.2.3.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.3">𝐿</ci><ci id="alg2.l10.m1.3.3.1.1.1.1.2.4.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.4">_</ci><ci id="alg2.l10.m1.3.3.1.1.1.1.2.5.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.5">𝑖</ci><ci id="alg2.l10.m1.3.3.1.1.1.1.2.6.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.6">𝑛</ci><ci id="alg2.l10.m1.3.3.1.1.1.1.2.7.cmml" xref="alg2.l10.m1.3.3.1.1.1.1.2.7">𝑣</ci></apply><apply id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2"><divide id="alg2.l10.m1.2.2.3.cmml" xref="alg2.l10.m1.2.2"></divide><apply id="alg2.l10.m1.2.2.2.cmml" xref="alg2.l10.m1.2.2.2"><plus id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.3"></plus><apply id="alg2.l10.m1.2.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2.1"><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">KL</ci><apply id="alg2.l10.m1.2.2.2.2.1.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="alg2.l10.m1.2.2.2.2.1.1.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="alg2.l10.m1.2.2.2.2.1.1.1.2.cmml" xref="alg2.l10.m1.2.2.2.2.1.1.1.2">𝑄</ci><ci id="alg2.l10.m1.2.2.2.2.1.1.1.3.cmml" xref="alg2.l10.m1.2.2.2.2.1.1.1.3">𝑃</ci></apply></apply><apply id="alg2.l10.m1.2.2.2.4.cmml" xref="alg2.l10.m1.2.2.2.4"><ln id="alg2.l10.m1.2.2.2.4.1.cmml" xref="alg2.l10.m1.2.2.2.4.1"></ln><apply id="alg2.l10.m1.2.2.2.4.2.cmml" xref="alg2.l10.m1.2.2.2.4.2"><divide id="alg2.l10.m1.2.2.2.4.2.1.cmml" xref="alg2.l10.m1.2.2.2.4.2"></divide><apply id="alg2.l10.m1.2.2.2.4.2.2.cmml" xref="alg2.l10.m1.2.2.2.4.2.2"><times id="alg2.l10.m1.2.2.2.4.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.4.2.2.1"></times><cn type="integer" id="alg2.l10.m1.2.2.2.4.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.4.2.2.2">2</cn><apply id="alg2.l10.m1.2.2.2.4.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.4.2.2.3"><root id="alg2.l10.m1.2.2.2.4.2.2.3a.cmml" xref="alg2.l10.m1.2.2.2.4.2.2.3"></root><ci id="alg2.l10.m1.2.2.2.4.2.2.3.2.cmml" xref="alg2.l10.m1.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="alg2.l10.m1.2.2.2.4.2.3.cmml" xref="alg2.l10.m1.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><ci id="alg2.l10.m1.2.2.4.cmml" xref="alg2.l10.m1.2.2.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.3c">\texttt{Up-bound}\leftarrow\mathrm{kl}^{-1}\left(KL\_inv\mid\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span><span id="alg2.l12.1" class="ltx_text ltx_font_bold">userMCSampling(k, w, m):</span>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span><span id="alg2.l13.1" class="ltx_text ltx_font_bold">for</span> each MC sampling <math id="alg2.l13.m1.4" class="ltx_Math" alttext="i=1,2,\cdots,n" display="inline"><semantics id="alg2.l13.m1.4a"><mrow id="alg2.l13.m1.4.5" xref="alg2.l13.m1.4.5.cmml"><mi id="alg2.l13.m1.4.5.2" xref="alg2.l13.m1.4.5.2.cmml">i</mi><mo id="alg2.l13.m1.4.5.1" xref="alg2.l13.m1.4.5.1.cmml">=</mo><mrow id="alg2.l13.m1.4.5.3.2" xref="alg2.l13.m1.4.5.3.1.cmml"><mn id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">1</mn><mo id="alg2.l13.m1.4.5.3.2.1" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml">2</mn><mo id="alg2.l13.m1.4.5.3.2.2" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l13.m1.3.3" xref="alg2.l13.m1.3.3.cmml">⋯</mi><mo id="alg2.l13.m1.4.5.3.2.3" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l13.m1.4.4" xref="alg2.l13.m1.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.4b"><apply id="alg2.l13.m1.4.5.cmml" xref="alg2.l13.m1.4.5"><eq id="alg2.l13.m1.4.5.1.cmml" xref="alg2.l13.m1.4.5.1"></eq><ci id="alg2.l13.m1.4.5.2.cmml" xref="alg2.l13.m1.4.5.2">𝑖</ci><list id="alg2.l13.m1.4.5.3.1.cmml" xref="alg2.l13.m1.4.5.3.2"><cn type="integer" id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">1</cn><cn type="integer" id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">2</cn><ci id="alg2.l13.m1.3.3.cmml" xref="alg2.l13.m1.3.3">⋯</ci><ci id="alg2.l13.m1.4.4.cmml" xref="alg2.l13.m1.4.4">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.4c">i=1,2,\cdots,n</annotation></semantics></math> <span id="alg2.l13.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <math id="alg2.l14.m1.1" class="ltx_Math" alttext="W^{k}_{i}\sim\mathrm{Q}" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msubsup id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2.2" xref="alg2.l14.m1.1.1.2.2.2.cmml">W</mi><mi id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">i</mi><mi id="alg2.l14.m1.1.1.2.2.3" xref="alg2.l14.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">∼</mo><mi mathvariant="normal" id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><csymbol cd="latexml" id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">similar-to</csymbol><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><apply id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.2.1.cmml" xref="alg2.l14.m1.1.1.2">superscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.2.cmml" xref="alg2.l14.m1.1.1.2.2.2">𝑊</ci><ci id="alg2.l14.m1.1.1.2.2.3.cmml" xref="alg2.l14.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">Q</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">W^{k}_{i}\sim\mathrm{Q}</annotation></semantics></math> <span id="alg2.l14.1" class="ltx_text" style="float:right;"><math id="alg2.l14.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l14.1.m1.1a"><mo id="alg2.l14.1.m1.1.1" xref="alg2.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l14.1.m1.1b"><ci id="alg2.l14.1.m1.1.1.cmml" xref="alg2.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.1.m1.1c">\triangleright</annotation></semantics></math> Sample weights from the posterior
</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <math id="alg2.l15.m1.1" class="ltx_Math" alttext="error^{k}_{i}\leftarrow\hat{\text{R}}_{\mathcal{S}_{k}}(W^{k}_{i})" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mrow id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><mi id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.3" xref="alg2.l15.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1a" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.4" xref="alg2.l15.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1b" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.5" xref="alg2.l15.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1c" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><msubsup id="alg2.l15.m1.1.1.3.6" xref="alg2.l15.m1.1.1.3.6.cmml"><mi id="alg2.l15.m1.1.1.3.6.2.2" xref="alg2.l15.m1.1.1.3.6.2.2.cmml">r</mi><mi id="alg2.l15.m1.1.1.3.6.3" xref="alg2.l15.m1.1.1.3.6.3.cmml">i</mi><mi id="alg2.l15.m1.1.1.3.6.2.3" xref="alg2.l15.m1.1.1.3.6.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">←</mo><mrow id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml"><msub id="alg2.l15.m1.1.1.1.3" xref="alg2.l15.m1.1.1.1.3.cmml"><mover accent="true" id="alg2.l15.m1.1.1.1.3.2" xref="alg2.l15.m1.1.1.1.3.2.cmml"><mtext id="alg2.l15.m1.1.1.1.3.2.2" xref="alg2.l15.m1.1.1.1.3.2.2a.cmml">R</mtext><mo id="alg2.l15.m1.1.1.1.3.2.1" xref="alg2.l15.m1.1.1.1.3.2.1.cmml">^</mo></mover><msub id="alg2.l15.m1.1.1.1.3.3" xref="alg2.l15.m1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l15.m1.1.1.1.3.3.2" xref="alg2.l15.m1.1.1.1.3.3.2.cmml">𝒮</mi><mi id="alg2.l15.m1.1.1.1.3.3.3" xref="alg2.l15.m1.1.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.1.2" xref="alg2.l15.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l15.m1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l15.m1.1.1.1.1.1.2" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l15.m1.1.1.1.1.1.1.2.2" xref="alg2.l15.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="alg2.l15.m1.1.1.1.1.1.1.3" xref="alg2.l15.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l15.m1.1.1.1.1.1.1.2.3" xref="alg2.l15.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg2.l15.m1.1.1.1.1.1.3" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">←</ci><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><times id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3.1"></times><ci id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2">𝑒</ci><ci id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3">𝑟</ci><ci id="alg2.l15.m1.1.1.3.4.cmml" xref="alg2.l15.m1.1.1.3.4">𝑟</ci><ci id="alg2.l15.m1.1.1.3.5.cmml" xref="alg2.l15.m1.1.1.3.5">𝑜</ci><apply id="alg2.l15.m1.1.1.3.6.cmml" xref="alg2.l15.m1.1.1.3.6"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.6.1.cmml" xref="alg2.l15.m1.1.1.3.6">subscript</csymbol><apply id="alg2.l15.m1.1.1.3.6.2.cmml" xref="alg2.l15.m1.1.1.3.6"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.6.2.1.cmml" xref="alg2.l15.m1.1.1.3.6">superscript</csymbol><ci id="alg2.l15.m1.1.1.3.6.2.2.cmml" xref="alg2.l15.m1.1.1.3.6.2.2">𝑟</ci><ci id="alg2.l15.m1.1.1.3.6.2.3.cmml" xref="alg2.l15.m1.1.1.3.6.2.3">𝑘</ci></apply><ci id="alg2.l15.m1.1.1.3.6.3.cmml" xref="alg2.l15.m1.1.1.3.6.3">𝑖</ci></apply></apply><apply id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"><times id="alg2.l15.m1.1.1.1.2.cmml" xref="alg2.l15.m1.1.1.1.2"></times><apply id="alg2.l15.m1.1.1.1.3.cmml" xref="alg2.l15.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.1.3">subscript</csymbol><apply id="alg2.l15.m1.1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.1.3.2"><ci id="alg2.l15.m1.1.1.1.3.2.1.cmml" xref="alg2.l15.m1.1.1.1.3.2.1">^</ci><ci id="alg2.l15.m1.1.1.1.3.2.2a.cmml" xref="alg2.l15.m1.1.1.1.3.2.2"><mtext id="alg2.l15.m1.1.1.1.3.2.2.cmml" xref="alg2.l15.m1.1.1.1.3.2.2">R</mtext></ci></apply><apply id="alg2.l15.m1.1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.3.3.1.cmml" xref="alg2.l15.m1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l15.m1.1.1.1.3.3.2.cmml" xref="alg2.l15.m1.1.1.1.3.3.2">𝒮</ci><ci id="alg2.l15.m1.1.1.1.3.3.3.cmml" xref="alg2.l15.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l15.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l15.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="alg2.l15.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">error^{k}_{i}\leftarrow\hat{\text{R}}_{\mathcal{S}_{k}}(W^{k}_{i})</annotation></semantics></math> <span id="alg2.l15.1" class="ltx_text" style="float:right;"><math id="alg2.l15.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l15.1.m1.1a"><mo id="alg2.l15.1.m1.1.1" xref="alg2.l15.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l15.1.m1.1b"><ci id="alg2.l15.1.m1.1.1.cmml" xref="alg2.l15.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.1.m1.1c">\triangleright</annotation></semantics></math> local empirical risk
</span>
</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span><span id="alg2.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span><math id="alg2.l17.m1.1" class="ltx_math_unparsed" alttext="error^{k}\leftarrow=\frac{1}{n}\sum_{i=1}^{n}error^{k}_{i}" display="inline"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1b"><mi id="alg2.l17.m1.1.1">e</mi><mi id="alg2.l17.m1.1.2">r</mi><mi id="alg2.l17.m1.1.3">r</mi><mi id="alg2.l17.m1.1.4">o</mi><msup id="alg2.l17.m1.1.5"><mi id="alg2.l17.m1.1.5.2">r</mi><mi id="alg2.l17.m1.1.5.3">k</mi></msup><mo rspace="0em" stretchy="false" id="alg2.l17.m1.1.6">←</mo><mo lspace="0em" id="alg2.l17.m1.1.7">=</mo><mfrac id="alg2.l17.m1.1.8"><mn id="alg2.l17.m1.1.8.2">1</mn><mi id="alg2.l17.m1.1.8.3">n</mi></mfrac><msubsup id="alg2.l17.m1.1.9"><mo id="alg2.l17.m1.1.9.2.2">∑</mo><mrow id="alg2.l17.m1.1.9.2.3"><mi id="alg2.l17.m1.1.9.2.3.2">i</mi><mo id="alg2.l17.m1.1.9.2.3.1">=</mo><mn id="alg2.l17.m1.1.9.2.3.3">1</mn></mrow><mi id="alg2.l17.m1.1.9.3">n</mi></msubsup><mi id="alg2.l17.m1.1.10">e</mi><mi id="alg2.l17.m1.1.11">r</mi><mi id="alg2.l17.m1.1.12">r</mi><mi id="alg2.l17.m1.1.13">o</mi><msubsup id="alg2.l17.m1.1.14"><mi id="alg2.l17.m1.1.14.2.2">r</mi><mi id="alg2.l17.m1.1.14.3">i</mi><mi id="alg2.l17.m1.1.14.2.3">k</mi></msubsup></mrow><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">error^{k}\leftarrow=\frac{1}{n}\sum_{i=1}^{n}error^{k}_{i}</annotation></semantics></math>

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span><span id="alg2.l18.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l18.m1.1" class="ltx_Math" alttext="error^{k}" display="inline"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.1" xref="alg2.l18.m1.1.1.1.cmml">​</mo><mi id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.1a" xref="alg2.l18.m1.1.1.1.cmml">​</mo><mi id="alg2.l18.m1.1.1.4" xref="alg2.l18.m1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.1b" xref="alg2.l18.m1.1.1.1.cmml">​</mo><mi id="alg2.l18.m1.1.1.5" xref="alg2.l18.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.1c" xref="alg2.l18.m1.1.1.1.cmml">​</mo><msup id="alg2.l18.m1.1.1.6" xref="alg2.l18.m1.1.1.6.cmml"><mi id="alg2.l18.m1.1.1.6.2" xref="alg2.l18.m1.1.1.6.2.cmml">r</mi><mi id="alg2.l18.m1.1.1.6.3" xref="alg2.l18.m1.1.1.6.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><times id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1"></times><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">𝑒</ci><ci id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3">𝑟</ci><ci id="alg2.l18.m1.1.1.4.cmml" xref="alg2.l18.m1.1.1.4">𝑟</ci><ci id="alg2.l18.m1.1.1.5.cmml" xref="alg2.l18.m1.1.1.5">𝑜</ci><apply id="alg2.l18.m1.1.1.6.cmml" xref="alg2.l18.m1.1.1.6"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.6.1.cmml" xref="alg2.l18.m1.1.1.6">superscript</csymbol><ci id="alg2.l18.m1.1.1.6.2.cmml" xref="alg2.l18.m1.1.1.6.2">𝑟</ci><ci id="alg2.l18.m1.1.1.6.3.cmml" xref="alg2.l18.m1.1.1.6.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">error^{k}</annotation></semantics></math>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span><span id="alg2.l19.1" class="ltx_text ltx_font_typewriter">Up-bound</span> holding with probability <math id="alg2.l19.m1.1" class="ltx_Math" alttext="1-\delta-\delta^{{}^{\prime}}" display="inline"><semantics id="alg2.l19.m1.1a"><mrow id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml"><mn id="alg2.l19.m1.1.1.2" xref="alg2.l19.m1.1.1.2.cmml">1</mn><mo id="alg2.l19.m1.1.1.1" xref="alg2.l19.m1.1.1.1.cmml">−</mo><mi id="alg2.l19.m1.1.1.3" xref="alg2.l19.m1.1.1.3.cmml">δ</mi><mo id="alg2.l19.m1.1.1.1a" xref="alg2.l19.m1.1.1.1.cmml">−</mo><msup id="alg2.l19.m1.1.1.4" xref="alg2.l19.m1.1.1.4.cmml"><mi id="alg2.l19.m1.1.1.4.2" xref="alg2.l19.m1.1.1.4.2.cmml">δ</mi><msup id="alg2.l19.m1.1.1.4.3" xref="alg2.l19.m1.1.1.4.3.cmml"><mi id="alg2.l19.m1.1.1.4.3a" xref="alg2.l19.m1.1.1.4.3.cmml"></mi><mo id="alg2.l19.m1.1.1.4.3.1" xref="alg2.l19.m1.1.1.4.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.1b"><apply id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1"><minus id="alg2.l19.m1.1.1.1.cmml" xref="alg2.l19.m1.1.1.1"></minus><cn type="integer" id="alg2.l19.m1.1.1.2.cmml" xref="alg2.l19.m1.1.1.2">1</cn><ci id="alg2.l19.m1.1.1.3.cmml" xref="alg2.l19.m1.1.1.3">𝛿</ci><apply id="alg2.l19.m1.1.1.4.cmml" xref="alg2.l19.m1.1.1.4"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.4.1.cmml" xref="alg2.l19.m1.1.1.4">superscript</csymbol><ci id="alg2.l19.m1.1.1.4.2.cmml" xref="alg2.l19.m1.1.1.4.2">𝛿</ci><apply id="alg2.l19.m1.1.1.4.3.cmml" xref="alg2.l19.m1.1.1.4.3"><ci id="alg2.l19.m1.1.1.4.3.1.cmml" xref="alg2.l19.m1.1.1.4.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.1c">1-\delta-\delta^{{}^{\prime}}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_smallcaps">GenFL</span> for personalised federated learning</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">A general training for the prior distribution.</span> In PFL, the learning objective of each user may differ, while sharing some similarities that can be learned and transferred from one user to another. This framework requires adjustments of our learning objectives. Indeed, contrary to <a href="#S3.SS1" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>, there is no clear global generalisation guarantee, so each user has then to optimise its own personal learning objective from a commonly shared prior. Using either a random prior or a learnt one on a fraction of users data, we run <span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">GenFL</span> similarly to <a href="#S3.SS1" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.1</span></a> with our PAC-Bayesian objective of interest <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">f</annotation></semantics></math>. The output distribution of <span id="S3.SS2.p1.1.3" class="ltx_text ltx_font_smallcaps">GenFL</span> is then considered as a common prior for all users which then needs to be personalised.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.5" class="ltx_p"><span id="S3.SS2.p2.5.1" class="ltx_text ltx_font_bold">A personalisation step.</span> Once a common prior distribution has been obtained from the federated training, it is necessary for each user to personalise it to its own problem. To do so, we apply PAC-Bayesian objectives similar to those in <a href="#S3.SS1" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>, namely <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">f</mi><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">f_{1}</annotation></semantics></math> (<a href="#S3.E8" title="Equation 8 ‣ 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) and <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">f</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">f_{2}</annotation></semantics></math> (<a href="#S3.Ex2" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>), where the batch size is modified from <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">m</annotation></semantics></math> to <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">m</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑚</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">m_{i}</annotation></semantics></math> for the <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">i</annotation></semantics></math>-th user. This reflect that each user now optimises its local goal instead of the global one. Each user ends up with its own personalised posterior distribution.
The way personalised bounds are implemented is similar to <a href="#alg2" title="In 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">2</span></a>, but without the aggregation step. We refer to <a href="#A2" title="Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a> for additional details.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>NUMERICAL EXPERIMENTS</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental framework</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">We follow the experimental framework of <cite class="ltx_cite ltx_citemacro_citet">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> combined with the FedAvg protocol <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib40" title="" class="ltx_ref">McMahan et al., 2017a </a></cite>.
We use the following libraries: Pytorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al.,, <a href="#bib.bib45" title="" class="ltx_ref">2019</a>)</cite> for deep learning, Flower <cite class="ltx_cite ltx_citemacro_citep">(Beutel et al.,, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> for federated learning, Slurm <cite class="ltx_cite ltx_citemacro_citep">(Yoo et al.,, <a href="#bib.bib65" title="" class="ltx_ref">2003</a>)</cite> for cluster experiments, and Hydra <cite class="ltx_cite ltx_citemacro_citep">(Yadan,, <a href="#bib.bib63" title="" class="ltx_ref">2019</a>)</cite> for overall experiment management. The cluster nodes we use have 48 SKYLAKE 3GHz CPUS. We do not use GPUs.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Prior distribution over weights.</span>
We propose two types of priors: data-free (random) prior chosen randomly around <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{N}(0,\mathrm{Id})" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.3" xref="S4.SS1.p2.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.2.3.2" xref="S4.SS1.p2.1.m1.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.2.3.1" xref="S4.SS1.p2.1.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.1.m1.2.3.3.2" xref="S4.SS1.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.3.2.1" xref="S4.SS1.p2.1.m1.2.3.3.1.cmml">(</mo><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">0</mn><mo id="S4.SS1.p2.1.m1.2.3.3.2.2" xref="S4.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml">Id</mi><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.3.2.3" xref="S4.SS1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.3.cmml" xref="S4.SS1.p2.1.m1.2.3"><times id="S4.SS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.1"></times><ci id="S4.SS1.p2.1.m1.2.3.2.cmml" xref="S4.SS1.p2.1.m1.2.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p2.1.m1.2.3.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.3.2"><cn type="integer" id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">0</cn><ci id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2">Id</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">\mathcal{N}(0,\mathrm{Id})</annotation></semantics></math> (as in <cite class="ltx_cite ltx_citemacro_citep">Dziugaite and Roy,, <a href="#bib.bib18" title="" class="ltx_ref">2017</a></cite>) and a data-dependent (learnt) prior. The latter is powerful to attenuate the KL divergence term, leading to sharper generalisation bounds and better accuracy.
Such a data-driven prior implies to use a fraction of the dataset from the training data to optimise the prior. The bound computation is then realised with a reduced dataset size (divided by 2 in practice).
However, the prior has gained efficiency (lower empirical risk) and the PAC-Bayes optimisation starts from a relevant point.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.8" class="ltx_p">We use Gaussian distribution for both prior and posterior over the weights of a neural network.
When data-free, the prior is <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="\mathrm{P}=\bigotimes_{l\in\textrm{layers}}\mathcal{N}(\text{truncated}(\mu^{l}_{\text{rand}}),\textrm{Diag}(\sigma_{\text{prior}}))" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><mrow id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml"><mi mathvariant="normal" id="S4.SS1.p3.1.m1.2.2.4" xref="S4.SS1.p3.1.m1.2.2.4.cmml">P</mi><mo rspace="0.111em" id="S4.SS1.p3.1.m1.2.2.3" xref="S4.SS1.p3.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p3.1.m1.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.cmml"><msub id="S4.SS1.p3.1.m1.2.2.2.3" xref="S4.SS1.p3.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.p3.1.m1.2.2.2.3.2" xref="S4.SS1.p3.1.m1.2.2.2.3.2.cmml">⨂</mo><mrow id="S4.SS1.p3.1.m1.2.2.2.3.3" xref="S4.SS1.p3.1.m1.2.2.2.3.3.cmml"><mi id="S4.SS1.p3.1.m1.2.2.2.3.3.2" xref="S4.SS1.p3.1.m1.2.2.2.3.3.2.cmml">l</mi><mo id="S4.SS1.p3.1.m1.2.2.2.3.3.1" xref="S4.SS1.p3.1.m1.2.2.2.3.3.1.cmml">∈</mo><mtext id="S4.SS1.p3.1.m1.2.2.2.3.3.3" xref="S4.SS1.p3.1.m1.2.2.2.3.3.3a.cmml">layers</mtext></mrow></msub><mrow id="S4.SS1.p3.1.m1.2.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.2.2.2.2.4" xref="S4.SS1.p3.1.m1.2.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.2.2.2.2.3" xref="S4.SS1.p3.1.m1.2.2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.2.2.2.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.3" xref="S4.SS1.p3.1.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml"><mtext id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3a.cmml">truncated</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mtext id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">rand</mtext><mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.1.m1.2.2.2.2.2.2.4" xref="S4.SS1.p3.1.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.cmml"><mtext id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3a.cmml">Diag</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.2" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.2" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.2.cmml">σ</mi><mtext id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3a.cmml">prior</mtext></msub><mo stretchy="false" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.3" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.5" xref="S4.SS1.p3.1.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2"><eq id="S4.SS1.p3.1.m1.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.3"></eq><ci id="S4.SS1.p3.1.m1.2.2.4.cmml" xref="S4.SS1.p3.1.m1.2.2.4">P</ci><apply id="S4.SS1.p3.1.m1.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2"><apply id="S4.SS1.p3.1.m1.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.2.2.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3">subscript</csymbol><csymbol cd="latexml" id="S4.SS1.p3.1.m1.2.2.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.2">tensor-product</csymbol><apply id="S4.SS1.p3.1.m1.2.2.2.3.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.3"><in id="S4.SS1.p3.1.m1.2.2.2.3.3.1.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.3.1"></in><ci id="S4.SS1.p3.1.m1.2.2.2.3.3.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.3.2">𝑙</ci><ci id="S4.SS1.p3.1.m1.2.2.2.3.3.3a.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.3.3"><mtext mathsize="70%" id="S4.SS1.p3.1.m1.2.2.2.3.3.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.3.3.3">layers</mtext></ci></apply></apply><apply id="S4.SS1.p3.1.m1.2.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2"><times id="S4.SS1.p3.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.3"></times><ci id="S4.SS1.p3.1.m1.2.2.2.2.4.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.4">𝒩</ci><interval closure="open" id="S4.SS1.p3.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2"><apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3a.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3"><mtext id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.3">truncated</mtext></ci><apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝜇</ci><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.1.3">rand</mtext></ci></apply></apply><apply id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2"><times id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.2"></times><ci id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3a.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3"><mtext id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.3">Diag</mtext></ci><apply id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.2">𝜎</ci><ci id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3a.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3"><mtext mathsize="70%" id="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2.2.2.2.1.1.1.3">prior</mtext></ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">\mathrm{P}=\bigotimes_{l\in\textrm{layers}}\mathcal{N}(\text{truncated}(\mu^{l}_{\text{rand}}),\textrm{Diag}(\sigma_{\text{prior}}))</annotation></semantics></math> with <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="\mu^{l}_{\text{rand}}\sim\mathcal{N}(0,\frac{1}{\sqrt{n^{l}_{in}}})" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><mrow id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><msubsup id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2.2.2" xref="S4.SS1.p3.2.m2.2.3.2.2.2.cmml">μ</mi><mtext id="S4.SS1.p3.2.m2.2.3.2.3" xref="S4.SS1.p3.2.m2.2.3.2.3a.cmml">rand</mtext><mi id="S4.SS1.p3.2.m2.2.3.2.2.3" xref="S4.SS1.p3.2.m2.2.3.2.2.3.cmml">l</mi></msubsup><mo id="S4.SS1.p3.2.m2.2.3.1" xref="S4.SS1.p3.2.m2.2.3.1.cmml">∼</mo><mrow id="S4.SS1.p3.2.m2.2.3.3" xref="S4.SS1.p3.2.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.2.m2.2.3.3.2" xref="S4.SS1.p3.2.m2.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.2.m2.2.3.3.1" xref="S4.SS1.p3.2.m2.2.3.3.1.cmml">​</mo><mrow id="S4.SS1.p3.2.m2.2.3.3.3.2" xref="S4.SS1.p3.2.m2.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p3.2.m2.2.3.3.3.2.1" xref="S4.SS1.p3.2.m2.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">0</mn><mo id="S4.SS1.p3.2.m2.2.3.3.3.2.2" xref="S4.SS1.p3.2.m2.2.3.3.3.1.cmml">,</mo><mfrac id="S4.SS1.p3.2.m2.2.2" xref="S4.SS1.p3.2.m2.2.2.cmml"><mn id="S4.SS1.p3.2.m2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.cmml">1</mn><msqrt id="S4.SS1.p3.2.m2.2.2.3" xref="S4.SS1.p3.2.m2.2.2.3.cmml"><msubsup id="S4.SS1.p3.2.m2.2.2.3.2" xref="S4.SS1.p3.2.m2.2.2.3.2.cmml"><mi id="S4.SS1.p3.2.m2.2.2.3.2.2.2" xref="S4.SS1.p3.2.m2.2.2.3.2.2.2.cmml">n</mi><mrow id="S4.SS1.p3.2.m2.2.2.3.2.3" xref="S4.SS1.p3.2.m2.2.2.3.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.2.3.2.3.2" xref="S4.SS1.p3.2.m2.2.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.2.m2.2.2.3.2.3.1" xref="S4.SS1.p3.2.m2.2.2.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p3.2.m2.2.2.3.2.3.3" xref="S4.SS1.p3.2.m2.2.2.3.2.3.3.cmml">n</mi></mrow><mi id="S4.SS1.p3.2.m2.2.2.3.2.2.3" xref="S4.SS1.p3.2.m2.2.2.3.2.2.3.cmml">l</mi></msubsup></msqrt></mfrac><mo stretchy="false" id="S4.SS1.p3.2.m2.2.3.3.3.2.3" xref="S4.SS1.p3.2.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><csymbol cd="latexml" id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.1">similar-to</csymbol><apply id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.3.2.1.cmml" xref="S4.SS1.p3.2.m2.2.3.2">subscript</csymbol><apply id="S4.SS1.p3.2.m2.2.3.2.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.3.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.3.2">superscript</csymbol><ci id="S4.SS1.p3.2.m2.2.3.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2.2.2">𝜇</ci><ci id="S4.SS1.p3.2.m2.2.3.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3.2.2.3">𝑙</ci></apply><ci id="S4.SS1.p3.2.m2.2.3.2.3a.cmml" xref="S4.SS1.p3.2.m2.2.3.2.3"><mtext mathsize="70%" id="S4.SS1.p3.2.m2.2.3.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3.2.3">rand</mtext></ci></apply><apply id="S4.SS1.p3.2.m2.2.3.3.cmml" xref="S4.SS1.p3.2.m2.2.3.3"><times id="S4.SS1.p3.2.m2.2.3.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.3.1"></times><ci id="S4.SS1.p3.2.m2.2.3.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p3.2.m2.2.3.3.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3.3.3.2"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">0</cn><apply id="S4.SS1.p3.2.m2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2"><divide id="S4.SS1.p3.2.m2.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2"></divide><cn type="integer" id="S4.SS1.p3.2.m2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2">1</cn><apply id="S4.SS1.p3.2.m2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.3"><root id="S4.SS1.p3.2.m2.2.2.3a.cmml" xref="S4.SS1.p3.2.m2.2.2.3"></root><apply id="S4.SS1.p3.2.m2.2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.3.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2">subscript</csymbol><apply id="S4.SS1.p3.2.m2.2.2.3.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.2.3.2.2.1.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2">superscript</csymbol><ci id="S4.SS1.p3.2.m2.2.2.3.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.2.2">𝑛</ci><ci id="S4.SS1.p3.2.m2.2.2.3.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.2.3">𝑙</ci></apply><apply id="S4.SS1.p3.2.m2.2.2.3.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.3"><times id="S4.SS1.p3.2.m2.2.2.3.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.3.1"></times><ci id="S4.SS1.p3.2.m2.2.2.3.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.3.2">𝑖</ci><ci id="S4.SS1.p3.2.m2.2.2.3.2.3.3.cmml" xref="S4.SS1.p3.2.m2.2.2.3.2.3.3">𝑛</ci></apply></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">\mu^{l}_{\text{rand}}\sim\mathcal{N}(0,\frac{1}{\sqrt{n^{l}_{in}}})</annotation></semantics></math>, and <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="\sigma_{\text{prior}}\in\mathbb{R}^{+*}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><msub id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2.2" xref="S4.SS1.p3.3.m3.1.1.2.2.cmml">σ</mi><mtext id="S4.SS1.p3.3.m3.1.1.2.3" xref="S4.SS1.p3.3.m3.1.1.2.3a.cmml">prior</mtext></msub><mo id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.3.m3.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3.3.2" xref="S4.SS1.p3.3.m3.1.1.3.3.2.cmml"></mi><mo rspace="0em" id="S4.SS1.p3.3.m3.1.1.3.3.1" xref="S4.SS1.p3.3.m3.1.1.3.3.1.cmml">+</mo><mo lspace="0em" id="S4.SS1.p3.3.m3.1.1.3.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.3.cmml">∗</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><in id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"></in><apply id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2.2">𝜎</ci><ci id="S4.SS1.p3.3.m3.1.1.2.3a.cmml" xref="S4.SS1.p3.3.m3.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.p3.3.m3.1.1.2.3.cmml" xref="S4.SS1.p3.3.m3.1.1.2.3">prior</mtext></ci></apply><apply id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3"><plus id="S4.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3.1"></plus><csymbol cd="latexml" id="S4.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3.2">absent</csymbol><times id="S4.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\sigma_{\text{prior}}\in\mathbb{R}^{+*}</annotation></semantics></math>. The truncature is done at <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="\pm\frac{2}{\sqrt{n^{l}_{in}}}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mo id="S4.SS1.p3.4.m4.1.1a" xref="S4.SS1.p3.4.m4.1.1.cmml">±</mo><mfrac id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2.2" xref="S4.SS1.p3.4.m4.1.1.2.2.cmml">2</mn><msqrt id="S4.SS1.p3.4.m4.1.1.2.3" xref="S4.SS1.p3.4.m4.1.1.2.3.cmml"><msubsup id="S4.SS1.p3.4.m4.1.1.2.3.2" xref="S4.SS1.p3.4.m4.1.1.2.3.2.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.2.2" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2.2.cmml">n</mi><mrow id="S4.SS1.p3.4.m4.1.1.2.3.2.3" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.3.2" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m4.1.1.2.3.2.3.1" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.3.3" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.3.cmml">n</mi></mrow><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.2.3" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2.3.cmml">l</mi></msubsup></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">plus-or-minus</csymbol><apply id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2"><divide id="S4.SS1.p3.4.m4.1.1.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2"></divide><cn type="integer" id="S4.SS1.p3.4.m4.1.1.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.2">2</cn><apply id="S4.SS1.p3.4.m4.1.1.2.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3"><root id="S4.SS1.p3.4.m4.1.1.2.3a.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3"></root><apply id="S4.SS1.p3.4.m4.1.1.2.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.2.3.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2">subscript</csymbol><apply id="S4.SS1.p3.4.m4.1.1.2.3.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.2.3.2.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2">superscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2.2">𝑛</ci><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.2.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2.3">𝑙</ci></apply><apply id="S4.SS1.p3.4.m4.1.1.2.3.2.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3"><times id="S4.SS1.p3.4.m4.1.1.2.3.2.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.1"></times><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.2">𝑖</ci><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\pm\frac{2}{\sqrt{n^{l}_{in}}}</annotation></semantics></math> where <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="n^{l}_{in}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><msubsup id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2.2" xref="S4.SS1.p3.5.m5.1.1.2.2.cmml">n</mi><mrow id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.5.m5.1.1.3.1" xref="S4.SS1.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.5.m5.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.3.3.cmml">n</mi></mrow><mi id="S4.SS1.p3.5.m5.1.1.2.3" xref="S4.SS1.p3.5.m5.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.2.1.cmml" xref="S4.SS1.p3.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2.2">𝑛</ci><ci id="S4.SS1.p3.5.m5.1.1.2.3.cmml" xref="S4.SS1.p3.5.m5.1.1.2.3">𝑙</ci></apply><apply id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3"><times id="S4.SS1.p3.5.m5.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3.1"></times><ci id="S4.SS1.p3.5.m5.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.5.m5.1.1.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">n^{l}_{in}</annotation></semantics></math> is the dimension of the inputs of the layer <math id="S4.SS1.p3.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS1.p3.6.m6.1a"><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">l</annotation></semantics></math>.
In the case of data-dependent prior, we have <math id="S4.SS1.p3.7.m7.2" class="ltx_Math" alttext="\mathrm{P}=\bigotimes_{l\in\textrm{layers}}\mathcal{N}(\mu^{l}_{\text{learnt}},\textrm{Diag}(\sigma_{\text{prior}}))" display="inline"><semantics id="S4.SS1.p3.7.m7.2a"><mrow id="S4.SS1.p3.7.m7.2.2" xref="S4.SS1.p3.7.m7.2.2.cmml"><mi mathvariant="normal" id="S4.SS1.p3.7.m7.2.2.4" xref="S4.SS1.p3.7.m7.2.2.4.cmml">P</mi><mo rspace="0.111em" id="S4.SS1.p3.7.m7.2.2.3" xref="S4.SS1.p3.7.m7.2.2.3.cmml">=</mo><mrow id="S4.SS1.p3.7.m7.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.cmml"><msub id="S4.SS1.p3.7.m7.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.3.cmml"><mo id="S4.SS1.p3.7.m7.2.2.2.3.2" xref="S4.SS1.p3.7.m7.2.2.2.3.2.cmml">⨂</mo><mrow id="S4.SS1.p3.7.m7.2.2.2.3.3" xref="S4.SS1.p3.7.m7.2.2.2.3.3.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.3.3.2" xref="S4.SS1.p3.7.m7.2.2.2.3.3.2.cmml">l</mi><mo id="S4.SS1.p3.7.m7.2.2.2.3.3.1" xref="S4.SS1.p3.7.m7.2.2.2.3.3.1.cmml">∈</mo><mtext id="S4.SS1.p3.7.m7.2.2.2.3.3.3" xref="S4.SS1.p3.7.m7.2.2.2.3.3.3a.cmml">layers</mtext></mrow></msub><mrow id="S4.SS1.p3.7.m7.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.7.m7.2.2.2.2.4" xref="S4.SS1.p3.7.m7.2.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.7.m7.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p3.7.m7.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mtext id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3a.cmml">learnt</mtext><mi id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S4.SS1.p3.7.m7.2.2.2.2.2.2.4" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.cmml"><mtext id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3a.cmml">Diag</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.2" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.2.cmml">σ</mi><mtext id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3a.cmml">prior</mtext></msub><mo stretchy="false" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.3" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.5" xref="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.2b"><apply id="S4.SS1.p3.7.m7.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2"><eq id="S4.SS1.p3.7.m7.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.3"></eq><ci id="S4.SS1.p3.7.m7.2.2.4.cmml" xref="S4.SS1.p3.7.m7.2.2.4">P</ci><apply id="S4.SS1.p3.7.m7.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2"><apply id="S4.SS1.p3.7.m7.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.3.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3">subscript</csymbol><csymbol cd="latexml" id="S4.SS1.p3.7.m7.2.2.2.3.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.2">tensor-product</csymbol><apply id="S4.SS1.p3.7.m7.2.2.2.3.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.3"><in id="S4.SS1.p3.7.m7.2.2.2.3.3.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.3.1"></in><ci id="S4.SS1.p3.7.m7.2.2.2.3.3.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.3.2">𝑙</ci><ci id="S4.SS1.p3.7.m7.2.2.2.3.3.3a.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.3.3"><mtext mathsize="70%" id="S4.SS1.p3.7.m7.2.2.2.3.3.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.3.3.3">layers</mtext></ci></apply></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2"><times id="S4.SS1.p3.7.m7.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.3"></times><ci id="S4.SS1.p3.7.m7.2.2.2.2.4.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.4">𝒩</ci><interval closure="open" id="S4.SS1.p3.7.m7.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2"><apply id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.2">𝜇</ci><ci id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3a.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.1.1.1.1.1.3">learnt</mtext></ci></apply><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2"><times id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.2"></times><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3a.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3"><mtext id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.3">Diag</mtext></ci><apply id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.2">𝜎</ci><ci id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3a.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3"><mtext mathsize="70%" id="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p3.7.m7.2.2.2.2.2.2.2.1.1.1.3">prior</mtext></ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.2c">\mathrm{P}=\bigotimes_{l\in\textrm{layers}}\mathcal{N}(\mu^{l}_{\text{learnt}},\textrm{Diag}(\sigma_{\text{prior}}))</annotation></semantics></math>, where <math id="S4.SS1.p3.8.m8.1" class="ltx_Math" alttext="\mu_{\text{learnt}}" display="inline"><semantics id="S4.SS1.p3.8.m8.1a"><msub id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml">μ</mi><mtext id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3a.cmml">learnt</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2">𝜇</ci><ci id="S4.SS1.p3.8.m8.1.1.3a.cmml" xref="S4.SS1.p3.8.m8.1.1.3"><mtext mathsize="70%" id="S4.SS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.3">learnt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">\mu_{\text{learnt}}</annotation></semantics></math>. It is obtained via ERM on the prior set on half of the training set, the other half being used for bound computation and posterior optimisation.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Dataset partition.</span>
To build a <span id="S4.SS1.p4.1.2" class="ltx_text ltx_font_italic">i.i.d.</span> FL setup, we consider the case where each user has exactly the same number of samples per class.
We partition MNIST as follows: we fix the number of users to 100. Then, each user receives a dataset size of 540, each class having 54 images.
In the case of the learnt prior, we split the training set of each user in half, the first one being used to train the prior, the second exploited by our learning algorithms.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.1" class="ltx_p">In the case of non-<span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_italic">i.i.d.</span> FL setup, we follow <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib40" title="" class="ltx_ref">McMahan et al., 2017a </a></cite>. First we sort MNIST by label, then we partition the dataset into chunks of 300 contiguous samples each (thus containing at most 2 labels, because it is sorted).
Again we split each user dataset in several parts. When the prior is random, we save 10% of the dataset to create a validation set. Remaining data is exploited for optimisation. When considering learnt priors, we save again 10% of the dataset as a validation set, we exploit 40% of the dataset to train the prior (respecting the proportion of each class), the remaining 50% being used by our learning algorithms.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para ltx_noindent">
<p id="S4.SS1.p6.3" class="ltx_p"><span id="S4.SS1.p6.3.1" class="ltx_text ltx_font_bold">Bound parameters.</span>
We used <math id="S4.SS1.p6.1.m1.1" class="ltx_Math" alttext="\delta=0.05" display="inline"><semantics id="S4.SS1.p6.1.m1.1a"><mrow id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml"><mi id="S4.SS1.p6.1.m1.1.1.2" xref="S4.SS1.p6.1.m1.1.1.2.cmml">δ</mi><mo id="S4.SS1.p6.1.m1.1.1.1" xref="S4.SS1.p6.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p6.1.m1.1.1.3" xref="S4.SS1.p6.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b"><apply id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1"><eq id="S4.SS1.p6.1.m1.1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1.1"></eq><ci id="S4.SS1.p6.1.m1.1.1.2.cmml" xref="S4.SS1.p6.1.m1.1.1.2">𝛿</ci><cn type="float" id="S4.SS1.p6.1.m1.1.1.3.cmml" xref="S4.SS1.p6.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">\delta=0.05</annotation></semantics></math>, <math id="S4.SS1.p6.2.m2.1" class="ltx_Math" alttext="\delta^{{}^{\prime}}=0.01" display="inline"><semantics id="S4.SS1.p6.2.m2.1a"><mrow id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml"><msup id="S4.SS1.p6.2.m2.1.1.2" xref="S4.SS1.p6.2.m2.1.1.2.cmml"><mi id="S4.SS1.p6.2.m2.1.1.2.2" xref="S4.SS1.p6.2.m2.1.1.2.2.cmml">δ</mi><msup id="S4.SS1.p6.2.m2.1.1.2.3" xref="S4.SS1.p6.2.m2.1.1.2.3.cmml"><mi id="S4.SS1.p6.2.m2.1.1.2.3a" xref="S4.SS1.p6.2.m2.1.1.2.3.cmml"></mi><mo id="S4.SS1.p6.2.m2.1.1.2.3.1" xref="S4.SS1.p6.2.m2.1.1.2.3.1.cmml">′</mo></msup></msup><mo id="S4.SS1.p6.2.m2.1.1.1" xref="S4.SS1.p6.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p6.2.m2.1.1.3" xref="S4.SS1.p6.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><apply id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1"><eq id="S4.SS1.p6.2.m2.1.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1.1"></eq><apply id="S4.SS1.p6.2.m2.1.1.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p6.2.m2.1.1.2.1.cmml" xref="S4.SS1.p6.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS1.p6.2.m2.1.1.2.2.cmml" xref="S4.SS1.p6.2.m2.1.1.2.2">𝛿</ci><apply id="S4.SS1.p6.2.m2.1.1.2.3.cmml" xref="S4.SS1.p6.2.m2.1.1.2.3"><ci id="S4.SS1.p6.2.m2.1.1.2.3.1.cmml" xref="S4.SS1.p6.2.m2.1.1.2.3.1">′</ci></apply></apply><cn type="float" id="S4.SS1.p6.2.m2.1.1.3.cmml" xref="S4.SS1.p6.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">\delta^{{}^{\prime}}=0.01</annotation></semantics></math>, <math id="S4.SS1.p6.3.m3.1" class="ltx_Math" alttext="n=150000" display="inline"><semantics id="S4.SS1.p6.3.m3.1a"><mrow id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml"><mi id="S4.SS1.p6.3.m3.1.1.2" xref="S4.SS1.p6.3.m3.1.1.2.cmml">n</mi><mo id="S4.SS1.p6.3.m3.1.1.1" xref="S4.SS1.p6.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p6.3.m3.1.1.3" xref="S4.SS1.p6.3.m3.1.1.3.cmml">150000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.1b"><apply id="S4.SS1.p6.3.m3.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1"><eq id="S4.SS1.p6.3.m3.1.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1.1"></eq><ci id="S4.SS1.p6.3.m3.1.1.2.cmml" xref="S4.SS1.p6.3.m3.1.1.2">𝑛</ci><cn type="integer" id="S4.SS1.p6.3.m3.1.1.3.cmml" xref="S4.SS1.p6.3.m3.1.1.3">150000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.1c">n=150000</annotation></semantics></math> Monte Carlo samples.</p>
</div>
<div id="S4.SS1.p7" class="ltx_para ltx_noindent">
<p id="S4.SS1.p7.9" class="ltx_p"><span id="S4.SS1.p7.9.1" class="ltx_text ltx_font_bold">Optimisation hyperparameters.</span>
The prior distribution scale <math id="S4.SS1.p7.1.m1.1" class="ltx_Math" alttext="\sigma_{\text{prior}}" display="inline"><semantics id="S4.SS1.p7.1.m1.1a"><msub id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml"><mi id="S4.SS1.p7.1.m1.1.1.2" xref="S4.SS1.p7.1.m1.1.1.2.cmml">σ</mi><mtext id="S4.SS1.p7.1.m1.1.1.3" xref="S4.SS1.p7.1.m1.1.1.3a.cmml">prior</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.1b"><apply id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2">𝜎</ci><ci id="S4.SS1.p7.1.m1.1.1.3a.cmml" xref="S4.SS1.p7.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS1.p7.1.m1.1.1.3.cmml" xref="S4.SS1.p7.1.m1.1.1.3">prior</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.1c">\sigma_{\text{prior}}</annotation></semantics></math> is set to <math id="S4.SS1.p7.2.m2.2" class="ltx_Math" alttext="2,5\times 10^{-2}" display="inline"><semantics id="S4.SS1.p7.2.m2.2a"><mrow id="S4.SS1.p7.2.m2.2.2.1" xref="S4.SS1.p7.2.m2.2.2.2.cmml"><mn id="S4.SS1.p7.2.m2.1.1" xref="S4.SS1.p7.2.m2.1.1.cmml">2</mn><mo id="S4.SS1.p7.2.m2.2.2.1.2" xref="S4.SS1.p7.2.m2.2.2.2.cmml">,</mo><mrow id="S4.SS1.p7.2.m2.2.2.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.cmml"><mn id="S4.SS1.p7.2.m2.2.2.1.1.2" xref="S4.SS1.p7.2.m2.2.2.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p7.2.m2.2.2.1.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.1.cmml">×</mo><msup id="S4.SS1.p7.2.m2.2.2.1.1.3" xref="S4.SS1.p7.2.m2.2.2.1.1.3.cmml"><mn id="S4.SS1.p7.2.m2.2.2.1.1.3.2" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p7.2.m2.2.2.1.1.3.3" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3.cmml"><mo id="S4.SS1.p7.2.m2.2.2.1.1.3.3a" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p7.2.m2.2.2.1.1.3.3.2" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.2.m2.2b"><list id="S4.SS1.p7.2.m2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1"><cn type="integer" id="S4.SS1.p7.2.m2.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1">2</cn><apply id="S4.SS1.p7.2.m2.2.2.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"><times id="S4.SS1.p7.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1"></times><cn type="integer" id="S4.SS1.p7.2.m2.2.2.1.1.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.2">5</cn><apply id="S4.SS1.p7.2.m2.2.2.1.1.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.1.1.3.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.p7.2.m2.2.2.1.1.3.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2">10</cn><apply id="S4.SS1.p7.2.m2.2.2.1.1.3.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3"><minus id="S4.SS1.p7.2.m2.2.2.1.1.3.3.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p7.2.m2.2.2.1.1.3.3.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3.2">2</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.2.m2.2c">2,5\times 10^{-2}</annotation></semantics></math>, the learning rate is <math id="S4.SS1.p7.3.m3.1" class="ltx_Math" alttext="5\times 10^{-3}" display="inline"><semantics id="S4.SS1.p7.3.m3.1a"><mrow id="S4.SS1.p7.3.m3.1.1" xref="S4.SS1.p7.3.m3.1.1.cmml"><mn id="S4.SS1.p7.3.m3.1.1.2" xref="S4.SS1.p7.3.m3.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p7.3.m3.1.1.1" xref="S4.SS1.p7.3.m3.1.1.1.cmml">×</mo><msup id="S4.SS1.p7.3.m3.1.1.3" xref="S4.SS1.p7.3.m3.1.1.3.cmml"><mn id="S4.SS1.p7.3.m3.1.1.3.2" xref="S4.SS1.p7.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p7.3.m3.1.1.3.3" xref="S4.SS1.p7.3.m3.1.1.3.3.cmml"><mo id="S4.SS1.p7.3.m3.1.1.3.3a" xref="S4.SS1.p7.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p7.3.m3.1.1.3.3.2" xref="S4.SS1.p7.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.3.m3.1b"><apply id="S4.SS1.p7.3.m3.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1"><times id="S4.SS1.p7.3.m3.1.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1.1"></times><cn type="integer" id="S4.SS1.p7.3.m3.1.1.2.cmml" xref="S4.SS1.p7.3.m3.1.1.2">5</cn><apply id="S4.SS1.p7.3.m3.1.1.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.3.m3.1.1.3.1.cmml" xref="S4.SS1.p7.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.p7.3.m3.1.1.3.2.cmml" xref="S4.SS1.p7.3.m3.1.1.3.2">10</cn><apply id="S4.SS1.p7.3.m3.1.1.3.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3"><minus id="S4.SS1.p7.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p7.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p7.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.3.m3.1c">5\times 10^{-3}</annotation></semantics></math> for 100 users. In order to compare with the batch learning setting, we compute our algorithms with 1 user. In this case, we use a learning rate of <math id="S4.SS1.p7.4.m4.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S4.SS1.p7.4.m4.1a"><mrow id="S4.SS1.p7.4.m4.1.1" xref="S4.SS1.p7.4.m4.1.1.cmml"><mn id="S4.SS1.p7.4.m4.1.1.2" xref="S4.SS1.p7.4.m4.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p7.4.m4.1.1.1" xref="S4.SS1.p7.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS1.p7.4.m4.1.1.3" xref="S4.SS1.p7.4.m4.1.1.3.cmml"><mn id="S4.SS1.p7.4.m4.1.1.3.2" xref="S4.SS1.p7.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p7.4.m4.1.1.3.3" xref="S4.SS1.p7.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.p7.4.m4.1.1.3.3a" xref="S4.SS1.p7.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p7.4.m4.1.1.3.3.2" xref="S4.SS1.p7.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.4.m4.1b"><apply id="S4.SS1.p7.4.m4.1.1.cmml" xref="S4.SS1.p7.4.m4.1.1"><times id="S4.SS1.p7.4.m4.1.1.1.cmml" xref="S4.SS1.p7.4.m4.1.1.1"></times><cn type="integer" id="S4.SS1.p7.4.m4.1.1.2.cmml" xref="S4.SS1.p7.4.m4.1.1.2">5</cn><apply id="S4.SS1.p7.4.m4.1.1.3.cmml" xref="S4.SS1.p7.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.4.m4.1.1.3.1.cmml" xref="S4.SS1.p7.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.p7.4.m4.1.1.3.2.cmml" xref="S4.SS1.p7.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.p7.4.m4.1.1.3.3.cmml" xref="S4.SS1.p7.4.m4.1.1.3.3"><minus id="S4.SS1.p7.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p7.4.m4.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p7.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p7.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.4.m4.1c">5\times 10^{-4}</annotation></semantics></math> to reach better performances.
The momentum is 0.95 for posterior optimization and 0.99 in prior optimisation.
During prior optimisation, we used a dropout rate of <math id="S4.SS1.p7.5.m5.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S4.SS1.p7.5.m5.1a"><mn id="S4.SS1.p7.5.m5.1.1" xref="S4.SS1.p7.5.m5.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.5.m5.1b"><cn type="float" id="S4.SS1.p7.5.m5.1.1.cmml" xref="S4.SS1.p7.5.m5.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.5.m5.1c">0.2</annotation></semantics></math> to avoid overfitting.
As theoretical results of <a href="#S2" title="2 BACKGROUND" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a> require a loss function in <math id="S4.SS1.p7.6.m6.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS1.p7.6.m6.2a"><mrow id="S4.SS1.p7.6.m6.2.3.2" xref="S4.SS1.p7.6.m6.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p7.6.m6.2.3.2.1" xref="S4.SS1.p7.6.m6.2.3.1.cmml">[</mo><mn id="S4.SS1.p7.6.m6.1.1" xref="S4.SS1.p7.6.m6.1.1.cmml">0</mn><mo id="S4.SS1.p7.6.m6.2.3.2.2" xref="S4.SS1.p7.6.m6.2.3.1.cmml">,</mo><mn id="S4.SS1.p7.6.m6.2.2" xref="S4.SS1.p7.6.m6.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p7.6.m6.2.3.2.3" xref="S4.SS1.p7.6.m6.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.6.m6.2b"><interval closure="closed" id="S4.SS1.p7.6.m6.2.3.1.cmml" xref="S4.SS1.p7.6.m6.2.3.2"><cn type="integer" id="S4.SS1.p7.6.m6.1.1.cmml" xref="S4.SS1.p7.6.m6.1.1">0</cn><cn type="integer" id="S4.SS1.p7.6.m6.2.2.cmml" xref="S4.SS1.p7.6.m6.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.6.m6.2c">[0,1]</annotation></semantics></math>, we use the bounded cross-entropy as in <cite class="ltx_cite ltx_citemacro_cite">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, <span id="S4.SS1.p7.9.2" class="ltx_text ltx_font_italic">i.e.</span>, <math id="S4.SS1.p7.7.m7.7" class="ltx_Math" alttext="\ell(x,y)=\frac{1}{\ln(p_{\text{min}})}\cdot\ln(\tilde{\sigma}(x)_{y})" display="inline"><semantics id="S4.SS1.p7.7.m7.7a"><mrow id="S4.SS1.p7.7.m7.7.7" xref="S4.SS1.p7.7.m7.7.7.cmml"><mrow id="S4.SS1.p7.7.m7.7.7.3" xref="S4.SS1.p7.7.m7.7.7.3.cmml"><mi mathvariant="normal" id="S4.SS1.p7.7.m7.7.7.3.2" xref="S4.SS1.p7.7.m7.7.7.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p7.7.m7.7.7.3.1" xref="S4.SS1.p7.7.m7.7.7.3.1.cmml">​</mo><mrow id="S4.SS1.p7.7.m7.7.7.3.3.2" xref="S4.SS1.p7.7.m7.7.7.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.3.3.2.1" xref="S4.SS1.p7.7.m7.7.7.3.3.1.cmml">(</mo><mi id="S4.SS1.p7.7.m7.3.3" xref="S4.SS1.p7.7.m7.3.3.cmml">x</mi><mo id="S4.SS1.p7.7.m7.7.7.3.3.2.2" xref="S4.SS1.p7.7.m7.7.7.3.3.1.cmml">,</mo><mi id="S4.SS1.p7.7.m7.4.4" xref="S4.SS1.p7.7.m7.4.4.cmml">y</mi><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.3.3.2.3" xref="S4.SS1.p7.7.m7.7.7.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p7.7.m7.7.7.2" xref="S4.SS1.p7.7.m7.7.7.2.cmml">=</mo><mrow id="S4.SS1.p7.7.m7.7.7.1" xref="S4.SS1.p7.7.m7.7.7.1.cmml"><mfrac id="S4.SS1.p7.7.m7.2.2" xref="S4.SS1.p7.7.m7.2.2.cmml"><mn id="S4.SS1.p7.7.m7.2.2.4" xref="S4.SS1.p7.7.m7.2.2.4.cmml">1</mn><mrow id="S4.SS1.p7.7.m7.2.2.2.2" xref="S4.SS1.p7.7.m7.2.2.2.3.cmml"><mi id="S4.SS1.p7.7.m7.1.1.1.1" xref="S4.SS1.p7.7.m7.1.1.1.1.cmml">ln</mi><mo id="S4.SS1.p7.7.m7.2.2.2.2a" xref="S4.SS1.p7.7.m7.2.2.2.3.cmml">⁡</mo><mrow id="S4.SS1.p7.7.m7.2.2.2.2.1" xref="S4.SS1.p7.7.m7.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p7.7.m7.2.2.2.2.1.2" xref="S4.SS1.p7.7.m7.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p7.7.m7.2.2.2.2.1.1" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.cmml"><mi id="S4.SS1.p7.7.m7.2.2.2.2.1.1.2" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.2.cmml">p</mi><mtext id="S4.SS1.p7.7.m7.2.2.2.2.1.1.3" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.3a.cmml">min</mtext></msub><mo stretchy="false" id="S4.SS1.p7.7.m7.2.2.2.2.1.3" xref="S4.SS1.p7.7.m7.2.2.2.3.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p7.7.m7.7.7.1.2" xref="S4.SS1.p7.7.m7.7.7.1.2.cmml">⋅</mo><mrow id="S4.SS1.p7.7.m7.7.7.1.1.1" xref="S4.SS1.p7.7.m7.7.7.1.1.2.cmml"><mi id="S4.SS1.p7.7.m7.6.6" xref="S4.SS1.p7.7.m7.6.6.cmml">ln</mi><mo id="S4.SS1.p7.7.m7.7.7.1.1.1a" xref="S4.SS1.p7.7.m7.7.7.1.1.2.cmml">⁡</mo><mrow id="S4.SS1.p7.7.m7.7.7.1.1.1.1" xref="S4.SS1.p7.7.m7.7.7.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.2" xref="S4.SS1.p7.7.m7.7.7.1.1.2.cmml">(</mo><mrow id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.2" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.2.cmml">σ</mi><mo id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.1" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.1" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.1.cmml">​</mo><msub id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.cmml"><mrow id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.2.2" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.2.2.1" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.cmml">(</mo><mi id="S4.SS1.p7.7.m7.5.5" xref="S4.SS1.p7.7.m7.5.5.cmml">x</mi><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.2.2.2" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.cmml">)</mo></mrow><mi id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.3" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.3.cmml">y</mi></msub></mrow><mo stretchy="false" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.3" xref="S4.SS1.p7.7.m7.7.7.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.7.m7.7b"><apply id="S4.SS1.p7.7.m7.7.7.cmml" xref="S4.SS1.p7.7.m7.7.7"><eq id="S4.SS1.p7.7.m7.7.7.2.cmml" xref="S4.SS1.p7.7.m7.7.7.2"></eq><apply id="S4.SS1.p7.7.m7.7.7.3.cmml" xref="S4.SS1.p7.7.m7.7.7.3"><times id="S4.SS1.p7.7.m7.7.7.3.1.cmml" xref="S4.SS1.p7.7.m7.7.7.3.1"></times><ci id="S4.SS1.p7.7.m7.7.7.3.2.cmml" xref="S4.SS1.p7.7.m7.7.7.3.2">ℓ</ci><interval closure="open" id="S4.SS1.p7.7.m7.7.7.3.3.1.cmml" xref="S4.SS1.p7.7.m7.7.7.3.3.2"><ci id="S4.SS1.p7.7.m7.3.3.cmml" xref="S4.SS1.p7.7.m7.3.3">𝑥</ci><ci id="S4.SS1.p7.7.m7.4.4.cmml" xref="S4.SS1.p7.7.m7.4.4">𝑦</ci></interval></apply><apply id="S4.SS1.p7.7.m7.7.7.1.cmml" xref="S4.SS1.p7.7.m7.7.7.1"><ci id="S4.SS1.p7.7.m7.7.7.1.2.cmml" xref="S4.SS1.p7.7.m7.7.7.1.2">⋅</ci><apply id="S4.SS1.p7.7.m7.2.2.cmml" xref="S4.SS1.p7.7.m7.2.2"><divide id="S4.SS1.p7.7.m7.2.2.3.cmml" xref="S4.SS1.p7.7.m7.2.2"></divide><cn type="integer" id="S4.SS1.p7.7.m7.2.2.4.cmml" xref="S4.SS1.p7.7.m7.2.2.4">1</cn><apply id="S4.SS1.p7.7.m7.2.2.2.3.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2"><ln id="S4.SS1.p7.7.m7.1.1.1.1.cmml" xref="S4.SS1.p7.7.m7.1.1.1.1"></ln><apply id="S4.SS1.p7.7.m7.2.2.2.2.1.1.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m7.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p7.7.m7.2.2.2.2.1.1.2.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.2">𝑝</ci><ci id="S4.SS1.p7.7.m7.2.2.2.2.1.1.3a.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.3"><mtext mathsize="50%" id="S4.SS1.p7.7.m7.2.2.2.2.1.1.3.cmml" xref="S4.SS1.p7.7.m7.2.2.2.2.1.1.3">min</mtext></ci></apply></apply></apply><apply id="S4.SS1.p7.7.m7.7.7.1.1.2.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1"><ln id="S4.SS1.p7.7.m7.6.6.cmml" xref="S4.SS1.p7.7.m7.6.6"></ln><apply id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1"><times id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.1"></times><apply id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2"><ci id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.1">~</ci><ci id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.2.2">𝜎</ci></apply><apply id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p7.7.m7.5.5.cmml" xref="S4.SS1.p7.7.m7.5.5">𝑥</ci><ci id="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p7.7.m7.7.7.1.1.1.1.1.3.3">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.7.m7.7c">\ell(x,y)=\frac{1}{\ln(p_{\text{min}})}\cdot\ln(\tilde{\sigma}(x)_{y})</annotation></semantics></math> with <math id="S4.SS1.p7.8.m8.5" class="ltx_Math" alttext="\tilde{\sigma}(x)_{y}=\max(\text{sigmoid}(x)_{y},p_{\text{min}})" display="inline"><semantics id="S4.SS1.p7.8.m8.5a"><mrow id="S4.SS1.p7.8.m8.5.5" xref="S4.SS1.p7.8.m8.5.5.cmml"><mrow id="S4.SS1.p7.8.m8.5.5.4" xref="S4.SS1.p7.8.m8.5.5.4.cmml"><mover accent="true" id="S4.SS1.p7.8.m8.5.5.4.2" xref="S4.SS1.p7.8.m8.5.5.4.2.cmml"><mi id="S4.SS1.p7.8.m8.5.5.4.2.2" xref="S4.SS1.p7.8.m8.5.5.4.2.2.cmml">σ</mi><mo id="S4.SS1.p7.8.m8.5.5.4.2.1" xref="S4.SS1.p7.8.m8.5.5.4.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS1.p7.8.m8.5.5.4.1" xref="S4.SS1.p7.8.m8.5.5.4.1.cmml">​</mo><msub id="S4.SS1.p7.8.m8.5.5.4.3" xref="S4.SS1.p7.8.m8.5.5.4.3.cmml"><mrow id="S4.SS1.p7.8.m8.5.5.4.3.2.2" xref="S4.SS1.p7.8.m8.5.5.4.3.cmml"><mo stretchy="false" id="S4.SS1.p7.8.m8.5.5.4.3.2.2.1" xref="S4.SS1.p7.8.m8.5.5.4.3.cmml">(</mo><mi id="S4.SS1.p7.8.m8.1.1" xref="S4.SS1.p7.8.m8.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.p7.8.m8.5.5.4.3.2.2.2" xref="S4.SS1.p7.8.m8.5.5.4.3.cmml">)</mo></mrow><mi id="S4.SS1.p7.8.m8.5.5.4.3.3" xref="S4.SS1.p7.8.m8.5.5.4.3.3.cmml">y</mi></msub></mrow><mo id="S4.SS1.p7.8.m8.5.5.3" xref="S4.SS1.p7.8.m8.5.5.3.cmml">=</mo><mrow id="S4.SS1.p7.8.m8.5.5.2.2" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml"><mi id="S4.SS1.p7.8.m8.3.3" xref="S4.SS1.p7.8.m8.3.3.cmml">max</mi><mo id="S4.SS1.p7.8.m8.5.5.2.2a" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml">⁡</mo><mrow id="S4.SS1.p7.8.m8.5.5.2.2.2" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml"><mo stretchy="false" id="S4.SS1.p7.8.m8.5.5.2.2.2.3" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml">(</mo><mrow id="S4.SS1.p7.8.m8.4.4.1.1.1.1" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.cmml"><mtext id="S4.SS1.p7.8.m8.4.4.1.1.1.1.2" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.2a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p7.8.m8.4.4.1.1.1.1.1" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.1.cmml">​</mo><msub id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.cmml"><mrow id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.2.2" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.2.2.1" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.cmml">(</mo><mi id="S4.SS1.p7.8.m8.2.2" xref="S4.SS1.p7.8.m8.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.2.2.2" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.cmml">)</mo></mrow><mi id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.3" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.3.cmml">y</mi></msub></mrow><mo id="S4.SS1.p7.8.m8.5.5.2.2.2.4" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml">,</mo><msub id="S4.SS1.p7.8.m8.5.5.2.2.2.2" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.cmml"><mi id="S4.SS1.p7.8.m8.5.5.2.2.2.2.2" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.2.cmml">p</mi><mtext id="S4.SS1.p7.8.m8.5.5.2.2.2.2.3" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.3a.cmml">min</mtext></msub><mo stretchy="false" id="S4.SS1.p7.8.m8.5.5.2.2.2.5" xref="S4.SS1.p7.8.m8.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.8.m8.5b"><apply id="S4.SS1.p7.8.m8.5.5.cmml" xref="S4.SS1.p7.8.m8.5.5"><eq id="S4.SS1.p7.8.m8.5.5.3.cmml" xref="S4.SS1.p7.8.m8.5.5.3"></eq><apply id="S4.SS1.p7.8.m8.5.5.4.cmml" xref="S4.SS1.p7.8.m8.5.5.4"><times id="S4.SS1.p7.8.m8.5.5.4.1.cmml" xref="S4.SS1.p7.8.m8.5.5.4.1"></times><apply id="S4.SS1.p7.8.m8.5.5.4.2.cmml" xref="S4.SS1.p7.8.m8.5.5.4.2"><ci id="S4.SS1.p7.8.m8.5.5.4.2.1.cmml" xref="S4.SS1.p7.8.m8.5.5.4.2.1">~</ci><ci id="S4.SS1.p7.8.m8.5.5.4.2.2.cmml" xref="S4.SS1.p7.8.m8.5.5.4.2.2">𝜎</ci></apply><apply id="S4.SS1.p7.8.m8.5.5.4.3.cmml" xref="S4.SS1.p7.8.m8.5.5.4.3"><csymbol cd="ambiguous" id="S4.SS1.p7.8.m8.5.5.4.3.1.cmml" xref="S4.SS1.p7.8.m8.5.5.4.3">subscript</csymbol><ci id="S4.SS1.p7.8.m8.1.1.cmml" xref="S4.SS1.p7.8.m8.1.1">𝑥</ci><ci id="S4.SS1.p7.8.m8.5.5.4.3.3.cmml" xref="S4.SS1.p7.8.m8.5.5.4.3.3">𝑦</ci></apply></apply><apply id="S4.SS1.p7.8.m8.5.5.2.3.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2"><max id="S4.SS1.p7.8.m8.3.3.cmml" xref="S4.SS1.p7.8.m8.3.3"></max><apply id="S4.SS1.p7.8.m8.4.4.1.1.1.1.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1"><times id="S4.SS1.p7.8.m8.4.4.1.1.1.1.1.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.1"></times><ci id="S4.SS1.p7.8.m8.4.4.1.1.1.1.2a.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.2"><mtext id="S4.SS1.p7.8.m8.4.4.1.1.1.1.2.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.2">sigmoid</mtext></ci><apply id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.1.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p7.8.m8.2.2.cmml" xref="S4.SS1.p7.8.m8.2.2">𝑥</ci><ci id="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.3.cmml" xref="S4.SS1.p7.8.m8.4.4.1.1.1.1.3.3">𝑦</ci></apply></apply><apply id="S4.SS1.p7.8.m8.5.5.2.2.2.2.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.8.m8.5.5.2.2.2.2.1.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p7.8.m8.5.5.2.2.2.2.2.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.2">𝑝</ci><ci id="S4.SS1.p7.8.m8.5.5.2.2.2.2.3a.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.3"><mtext mathsize="70%" id="S4.SS1.p7.8.m8.5.5.2.2.2.2.3.cmml" xref="S4.SS1.p7.8.m8.5.5.2.2.2.2.3">min</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.8.m8.5c">\tilde{\sigma}(x)_{y}=\max(\text{sigmoid}(x)_{y},p_{\text{min}})</annotation></semantics></math>. We took <math id="S4.SS1.p7.9.m9.1" class="ltx_Math" alttext="p_{\text{min}}=10^{-4}" display="inline"><semantics id="S4.SS1.p7.9.m9.1a"><mrow id="S4.SS1.p7.9.m9.1.1" xref="S4.SS1.p7.9.m9.1.1.cmml"><msub id="S4.SS1.p7.9.m9.1.1.2" xref="S4.SS1.p7.9.m9.1.1.2.cmml"><mi id="S4.SS1.p7.9.m9.1.1.2.2" xref="S4.SS1.p7.9.m9.1.1.2.2.cmml">p</mi><mtext id="S4.SS1.p7.9.m9.1.1.2.3" xref="S4.SS1.p7.9.m9.1.1.2.3a.cmml">min</mtext></msub><mo id="S4.SS1.p7.9.m9.1.1.1" xref="S4.SS1.p7.9.m9.1.1.1.cmml">=</mo><msup id="S4.SS1.p7.9.m9.1.1.3" xref="S4.SS1.p7.9.m9.1.1.3.cmml"><mn id="S4.SS1.p7.9.m9.1.1.3.2" xref="S4.SS1.p7.9.m9.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p7.9.m9.1.1.3.3" xref="S4.SS1.p7.9.m9.1.1.3.3.cmml"><mo id="S4.SS1.p7.9.m9.1.1.3.3a" xref="S4.SS1.p7.9.m9.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p7.9.m9.1.1.3.3.2" xref="S4.SS1.p7.9.m9.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.9.m9.1b"><apply id="S4.SS1.p7.9.m9.1.1.cmml" xref="S4.SS1.p7.9.m9.1.1"><eq id="S4.SS1.p7.9.m9.1.1.1.cmml" xref="S4.SS1.p7.9.m9.1.1.1"></eq><apply id="S4.SS1.p7.9.m9.1.1.2.cmml" xref="S4.SS1.p7.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p7.9.m9.1.1.2.1.cmml" xref="S4.SS1.p7.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS1.p7.9.m9.1.1.2.2.cmml" xref="S4.SS1.p7.9.m9.1.1.2.2">𝑝</ci><ci id="S4.SS1.p7.9.m9.1.1.2.3a.cmml" xref="S4.SS1.p7.9.m9.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.p7.9.m9.1.1.2.3.cmml" xref="S4.SS1.p7.9.m9.1.1.2.3">min</mtext></ci></apply><apply id="S4.SS1.p7.9.m9.1.1.3.cmml" xref="S4.SS1.p7.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.9.m9.1.1.3.1.cmml" xref="S4.SS1.p7.9.m9.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS1.p7.9.m9.1.1.3.2.cmml" xref="S4.SS1.p7.9.m9.1.1.3.2">10</cn><apply id="S4.SS1.p7.9.m9.1.1.3.3.cmml" xref="S4.SS1.p7.9.m9.1.1.3.3"><minus id="S4.SS1.p7.9.m9.1.1.3.3.1.cmml" xref="S4.SS1.p7.9.m9.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p7.9.m9.1.1.3.3.2.cmml" xref="S4.SS1.p7.9.m9.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.9.m9.1c">p_{\text{min}}=10^{-4}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p8" class="ltx_para ltx_noindent">
<p id="S4.SS1.p8.1" class="ltx_p"><span id="S4.SS1.p8.1.1" class="ltx_text ltx_font_bold">KL penalty.</span>
For stability reasons, we penalise the KL term during posterior optimisation (similarly to <cite class="ltx_cite ltx_citemacro_citep">Pérez-Ortiz et al.,, <a href="#bib.bib47" title="" class="ltx_ref">2021</a></cite>), thus we give more impact to the empirical risk during optimisation. Such a penalty helps performance and stability during training when random priors are involved. In this case, we use a penalty of <math id="S4.SS1.p8.1.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.SS1.p8.1.m1.1a"><mn id="S4.SS1.p8.1.m1.1.1" xref="S4.SS1.p8.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.1b"><cn type="float" id="S4.SS1.p8.1.m1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.1c">0.1</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p9" class="ltx_para ltx_noindent">
<p id="S4.SS1.p9.1" class="ltx_p"><span id="S4.SS1.p9.1.1" class="ltx_text ltx_font_bold">Federated Learning hyperparameters.</span>
Starting from a random prior, we perform our algorithm during 200 rounds to make the SNNs converge.
When learnt priors are considered, they are trained with a run of 100 rounds with 5 local epochs (convergence around 50 epochs). We then perform 10 additional rounds with 5 local epochs to train the posterior.
In both cases, we select 10% of the users each round to participate in the training.
As the dataset size of each user is small, we use a batch size of 25 (compared to 250 in the work of <cite class="ltx_cite ltx_citemacro_cite">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>).</p>
</div>
<div id="S4.SS1.p10" class="ltx_para ltx_noindent">
<p id="S4.SS1.p10.1" class="ltx_p"><span id="S4.SS1.p10.1.1" class="ltx_text ltx_font_bold">Neural Architecture.</span>
We consider a stochastic 2 hidden layer MLP with 600 units each, resulting in 1,198,210 number of parameters for the prior (with fixed covariance matrix) and doubled for the SNN (as we consider diagonal covariance matrices).</p>
</div>
<div id="S4.SS1.p11" class="ltx_para ltx_noindent">
<p id="S4.SS1.p11.4" class="ltx_p"><span id="S4.SS1.p11.4.1" class="ltx_text ltx_font_bold">Positive variance prior.</span>
To have a constrained positive standard deviation <math id="S4.SS1.p11.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS1.p11.1.m1.1a"><mi id="S4.SS1.p11.1.m1.1.1" xref="S4.SS1.p11.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.1.m1.1b"><ci id="S4.SS1.p11.1.m1.1.1.cmml" xref="S4.SS1.p11.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.1.m1.1c">\sigma</annotation></semantics></math> when sampling weights, we use the following transformation: <math id="S4.SS1.p11.2.m2.4" class="ltx_Math" alttext="\sigma=\ln(1+\exp(\rho))" display="inline"><semantics id="S4.SS1.p11.2.m2.4a"><mrow id="S4.SS1.p11.2.m2.4.4" xref="S4.SS1.p11.2.m2.4.4.cmml"><mi id="S4.SS1.p11.2.m2.4.4.3" xref="S4.SS1.p11.2.m2.4.4.3.cmml">σ</mi><mo id="S4.SS1.p11.2.m2.4.4.2" xref="S4.SS1.p11.2.m2.4.4.2.cmml">=</mo><mrow id="S4.SS1.p11.2.m2.4.4.1.1" xref="S4.SS1.p11.2.m2.4.4.1.2.cmml"><mi id="S4.SS1.p11.2.m2.3.3" xref="S4.SS1.p11.2.m2.3.3.cmml">ln</mi><mo id="S4.SS1.p11.2.m2.4.4.1.1a" xref="S4.SS1.p11.2.m2.4.4.1.2.cmml">⁡</mo><mrow id="S4.SS1.p11.2.m2.4.4.1.1.1" xref="S4.SS1.p11.2.m2.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS1.p11.2.m2.4.4.1.1.1.2" xref="S4.SS1.p11.2.m2.4.4.1.2.cmml">(</mo><mrow id="S4.SS1.p11.2.m2.4.4.1.1.1.1" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.cmml"><mn id="S4.SS1.p11.2.m2.4.4.1.1.1.1.2" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.p11.2.m2.4.4.1.1.1.1.1" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml"><mi id="S4.SS1.p11.2.m2.1.1" xref="S4.SS1.p11.2.m2.1.1.cmml">exp</mi><mo id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2a" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2.1" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2.1.1" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S4.SS1.p11.2.m2.2.2" xref="S4.SS1.p11.2.m2.2.2.cmml">ρ</mi><mo stretchy="false" id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2.1.2" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.p11.2.m2.4.4.1.1.1.3" xref="S4.SS1.p11.2.m2.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.2.m2.4b"><apply id="S4.SS1.p11.2.m2.4.4.cmml" xref="S4.SS1.p11.2.m2.4.4"><eq id="S4.SS1.p11.2.m2.4.4.2.cmml" xref="S4.SS1.p11.2.m2.4.4.2"></eq><ci id="S4.SS1.p11.2.m2.4.4.3.cmml" xref="S4.SS1.p11.2.m2.4.4.3">𝜎</ci><apply id="S4.SS1.p11.2.m2.4.4.1.2.cmml" xref="S4.SS1.p11.2.m2.4.4.1.1"><ln id="S4.SS1.p11.2.m2.3.3.cmml" xref="S4.SS1.p11.2.m2.3.3"></ln><apply id="S4.SS1.p11.2.m2.4.4.1.1.1.1.cmml" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1"><plus id="S4.SS1.p11.2.m2.4.4.1.1.1.1.1.cmml" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.1"></plus><cn type="integer" id="S4.SS1.p11.2.m2.4.4.1.1.1.1.2.cmml" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.2">1</cn><apply id="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.1.cmml" xref="S4.SS1.p11.2.m2.4.4.1.1.1.1.3.2"><exp id="S4.SS1.p11.2.m2.1.1.cmml" xref="S4.SS1.p11.2.m2.1.1"></exp><ci id="S4.SS1.p11.2.m2.2.2.cmml" xref="S4.SS1.p11.2.m2.2.2">𝜌</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.2.m2.4c">\sigma=\ln(1+\exp(\rho))</annotation></semantics></math>.
It makes <math id="S4.SS1.p11.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS1.p11.3.m3.1a"><mi id="S4.SS1.p11.3.m3.1.1" xref="S4.SS1.p11.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.3.m3.1b"><ci id="S4.SS1.p11.3.m3.1.1.cmml" xref="S4.SS1.p11.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.3.m3.1c">\sigma</annotation></semantics></math> always positive, and <math id="S4.SS1.p11.4.m4.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS1.p11.4.m4.1a"><mi id="S4.SS1.p11.4.m4.1.1" xref="S4.SS1.p11.4.m4.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p11.4.m4.1b"><ci id="S4.SS1.p11.4.m4.1.1.cmml" xref="S4.SS1.p11.4.m4.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p11.4.m4.1c">\rho</annotation></semantics></math> can be any real number that is optimised during training procedure.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.3" class="ltx_p">Note that in a classification problem, the generalisation error translates a positive influence of the learning phase as long as it is smaller than <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">1</annotation></semantics></math> (which is what we refer to with the term nonvacuous). Indeed, a bound below this threshold shows that the posterior will not fail at each try.
However, we focus on posteriors with generalisation bounds or test error smaller than <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">50</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">50\%</annotation></semantics></math> The reason is that, for a classification task, this threshold is the generalisation error of a randomised predictor with associated distribution <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathrm{Bernoulli}(0.5)" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.2.2" xref="S4.SS2.p1.3.m3.1.2.2.cmml">Bernoulli</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.2.1" xref="S4.SS2.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.3.m3.1.2.3.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.2.3.2.1" xref="S4.SS2.p1.3.m3.1.2.cmml">(</mo><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">0.5</mn><mo stretchy="false" id="S4.SS2.p1.3.m3.1.2.3.2.2" xref="S4.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><times id="S4.SS2.p1.3.m3.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2.1"></times><ci id="S4.SS2.p1.3.m3.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2.2">Bernoulli</ci><cn type="float" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathrm{Bernoulli}(0.5)</annotation></semantics></math>. Thus, having results below this threshold provably show we generalise better than a naive strategy.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">FL-SOB setting.</span></p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span> Results for the FL-SOB scenario.
<math id="S4.T1.5.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T1.5.m1.1b"><msup id="S4.T1.5.m1.1.1" xref="S4.T1.5.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T1.5.m1.1.1.2" xref="S4.T1.5.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T1.5.m1.1.1.3" xref="S4.T1.5.m1.1.1.3.cmml"><mn id="S4.T1.5.m1.1.1.3.2" xref="S4.T1.5.m1.1.1.3.2.cmml">0</mn><mo id="S4.T1.5.m1.1.1.3.1" xref="S4.T1.5.m1.1.1.3.1.cmml">−</mo><mn id="S4.T1.5.m1.1.1.3.3" xref="S4.T1.5.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T1.5.m1.1c"><apply id="S4.T1.5.m1.1.1.cmml" xref="S4.T1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.5.m1.1.1.1.cmml" xref="S4.T1.5.m1.1.1">superscript</csymbol><ci id="S4.T1.5.m1.1.1.2.cmml" xref="S4.T1.5.m1.1.1.2">ℓ</ci><apply id="S4.T1.5.m1.1.1.3.cmml" xref="S4.T1.5.m1.1.1.3"><minus id="S4.T1.5.m1.1.1.3.1.cmml" xref="S4.T1.5.m1.1.1.3.1"></minus><cn type="integer" id="S4.T1.5.m1.1.1.3.2.cmml" xref="S4.T1.5.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T1.5.m1.1.1.3.3.cmml" xref="S4.T1.5.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.m1.1d">\ell^{0-1}</annotation></semantics></math> corresponds to the 0-1 loss. The test error column is made on the test set of MNIST. The
Bound column corresponds to the generalisation bounds, computed with <a href="#alg2" title="In 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Alg.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. The <math id="S4.T1.6.m2.1" class="ltx_Math" alttext="KL/m" display="inline"><semantics id="S4.T1.6.m2.1b"><mrow id="S4.T1.6.m2.1.1" xref="S4.T1.6.m2.1.1.cmml"><mrow id="S4.T1.6.m2.1.1.2" xref="S4.T1.6.m2.1.1.2.cmml"><mi id="S4.T1.6.m2.1.1.2.2" xref="S4.T1.6.m2.1.1.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.T1.6.m2.1.1.2.1" xref="S4.T1.6.m2.1.1.2.1.cmml">​</mo><mi id="S4.T1.6.m2.1.1.2.3" xref="S4.T1.6.m2.1.1.2.3.cmml">L</mi></mrow><mo id="S4.T1.6.m2.1.1.1" xref="S4.T1.6.m2.1.1.1.cmml">/</mo><mi id="S4.T1.6.m2.1.1.3" xref="S4.T1.6.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.m2.1c"><apply id="S4.T1.6.m2.1.1.cmml" xref="S4.T1.6.m2.1.1"><divide id="S4.T1.6.m2.1.1.1.cmml" xref="S4.T1.6.m2.1.1.1"></divide><apply id="S4.T1.6.m2.1.1.2.cmml" xref="S4.T1.6.m2.1.1.2"><times id="S4.T1.6.m2.1.1.2.1.cmml" xref="S4.T1.6.m2.1.1.2.1"></times><ci id="S4.T1.6.m2.1.1.2.2.cmml" xref="S4.T1.6.m2.1.1.2.2">𝐾</ci><ci id="S4.T1.6.m2.1.1.2.3.cmml" xref="S4.T1.6.m2.1.1.2.3">𝐿</ci></apply><ci id="S4.T1.6.m2.1.1.3.cmml" xref="S4.T1.6.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.m2.1d">KL/m</annotation></semantics></math> column corresponds to the KL divergence term in the bound divided by <math id="S4.T1.7.m3.1" class="ltx_Math" alttext="m=60000" display="inline"><semantics id="S4.T1.7.m3.1b"><mrow id="S4.T1.7.m3.1.1" xref="S4.T1.7.m3.1.1.cmml"><mi id="S4.T1.7.m3.1.1.2" xref="S4.T1.7.m3.1.1.2.cmml">m</mi><mo id="S4.T1.7.m3.1.1.1" xref="S4.T1.7.m3.1.1.1.cmml">=</mo><mn id="S4.T1.7.m3.1.1.3" xref="S4.T1.7.m3.1.1.3.cmml">60000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.m3.1c"><apply id="S4.T1.7.m3.1.1.cmml" xref="S4.T1.7.m3.1.1"><eq id="S4.T1.7.m3.1.1.1.cmml" xref="S4.T1.7.m3.1.1.1"></eq><ci id="S4.T1.7.m3.1.1.2.cmml" xref="S4.T1.7.m3.1.1.2">𝑚</ci><cn type="integer" id="S4.T1.7.m3.1.1.3.cmml" xref="S4.T1.7.m3.1.1.3">60000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.m3.1d">m=60000</annotation></semantics></math> in data-free prior or <math id="S4.T1.8.m4.1" class="ltx_Math" alttext="m=30000" display="inline"><semantics id="S4.T1.8.m4.1b"><mrow id="S4.T1.8.m4.1.1" xref="S4.T1.8.m4.1.1.cmml"><mi id="S4.T1.8.m4.1.1.2" xref="S4.T1.8.m4.1.1.2.cmml">m</mi><mo id="S4.T1.8.m4.1.1.1" xref="S4.T1.8.m4.1.1.1.cmml">=</mo><mn id="S4.T1.8.m4.1.1.3" xref="S4.T1.8.m4.1.1.3.cmml">30000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.m4.1c"><apply id="S4.T1.8.m4.1.1.cmml" xref="S4.T1.8.m4.1.1"><eq id="S4.T1.8.m4.1.1.1.cmml" xref="S4.T1.8.m4.1.1.1"></eq><ci id="S4.T1.8.m4.1.1.2.cmml" xref="S4.T1.8.m4.1.1.2">𝑚</ci><cn type="integer" id="S4.T1.8.m4.1.1.3.cmml" xref="S4.T1.8.m4.1.1.3">30000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.m4.1d">m=30000</annotation></semantics></math> data-dependent prior. </figcaption>
<table id="S4.T1.27" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.27.20.1" class="ltx_tr">
<th id="S4.T1.27.20.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="2">Setup</th>
<td id="S4.T1.27.20.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Bound</td>
<td id="S4.T1.27.20.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Test Err.</td>
<td id="S4.T1.27.20.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">KL div</td>
</tr>
<tr id="S4.T1.11.3" class="ltx_tr">
<th id="S4.T1.11.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Prior</th>
<th id="S4.T1.11.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Obj.</th>
<td id="S4.T1.9.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T1.9.1.1.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T1.9.1.1.m1.1a"><msup id="S4.T1.9.1.1.m1.1.1" xref="S4.T1.9.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T1.9.1.1.m1.1.1.2" xref="S4.T1.9.1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T1.9.1.1.m1.1.1.3" xref="S4.T1.9.1.1.m1.1.1.3.cmml"><mn id="S4.T1.9.1.1.m1.1.1.3.2" xref="S4.T1.9.1.1.m1.1.1.3.2.cmml">0</mn><mo id="S4.T1.9.1.1.m1.1.1.3.1" xref="S4.T1.9.1.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.T1.9.1.1.m1.1.1.3.3" xref="S4.T1.9.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T1.9.1.1.m1.1b"><apply id="S4.T1.9.1.1.m1.1.1.cmml" xref="S4.T1.9.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.1.1.m1.1.1.1.cmml" xref="S4.T1.9.1.1.m1.1.1">superscript</csymbol><ci id="S4.T1.9.1.1.m1.1.1.2.cmml" xref="S4.T1.9.1.1.m1.1.1.2">ℓ</ci><apply id="S4.T1.9.1.1.m1.1.1.3.cmml" xref="S4.T1.9.1.1.m1.1.1.3"><minus id="S4.T1.9.1.1.m1.1.1.3.1.cmml" xref="S4.T1.9.1.1.m1.1.1.3.1"></minus><cn type="integer" id="S4.T1.9.1.1.m1.1.1.3.2.cmml" xref="S4.T1.9.1.1.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T1.9.1.1.m1.1.1.3.3.cmml" xref="S4.T1.9.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.1.1.m1.1c">\ell^{0-1}</annotation></semantics></math></td>
<td id="S4.T1.10.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T1.10.2.2.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T1.10.2.2.m1.1a"><msup id="S4.T1.10.2.2.m1.1.1" xref="S4.T1.10.2.2.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T1.10.2.2.m1.1.1.2" xref="S4.T1.10.2.2.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T1.10.2.2.m1.1.1.3" xref="S4.T1.10.2.2.m1.1.1.3.cmml"><mn id="S4.T1.10.2.2.m1.1.1.3.2" xref="S4.T1.10.2.2.m1.1.1.3.2.cmml">0</mn><mo id="S4.T1.10.2.2.m1.1.1.3.1" xref="S4.T1.10.2.2.m1.1.1.3.1.cmml">−</mo><mn id="S4.T1.10.2.2.m1.1.1.3.3" xref="S4.T1.10.2.2.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T1.10.2.2.m1.1b"><apply id="S4.T1.10.2.2.m1.1.1.cmml" xref="S4.T1.10.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.10.2.2.m1.1.1.1.cmml" xref="S4.T1.10.2.2.m1.1.1">superscript</csymbol><ci id="S4.T1.10.2.2.m1.1.1.2.cmml" xref="S4.T1.10.2.2.m1.1.1.2">ℓ</ci><apply id="S4.T1.10.2.2.m1.1.1.3.cmml" xref="S4.T1.10.2.2.m1.1.1.3"><minus id="S4.T1.10.2.2.m1.1.1.3.1.cmml" xref="S4.T1.10.2.2.m1.1.1.3.1"></minus><cn type="integer" id="S4.T1.10.2.2.m1.1.1.3.2.cmml" xref="S4.T1.10.2.2.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T1.10.2.2.m1.1.1.3.3.cmml" xref="S4.T1.10.2.2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.2.2.m1.1c">\ell^{0-1}</annotation></semantics></math></td>
<td id="S4.T1.11.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S4.T1.11.3.3.m1.1" class="ltx_Math" alttext="KL/m" display="inline"><semantics id="S4.T1.11.3.3.m1.1a"><mrow id="S4.T1.11.3.3.m1.1.1" xref="S4.T1.11.3.3.m1.1.1.cmml"><mrow id="S4.T1.11.3.3.m1.1.1.2" xref="S4.T1.11.3.3.m1.1.1.2.cmml"><mi id="S4.T1.11.3.3.m1.1.1.2.2" xref="S4.T1.11.3.3.m1.1.1.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.T1.11.3.3.m1.1.1.2.1" xref="S4.T1.11.3.3.m1.1.1.2.1.cmml">​</mo><mi id="S4.T1.11.3.3.m1.1.1.2.3" xref="S4.T1.11.3.3.m1.1.1.2.3.cmml">L</mi></mrow><mo id="S4.T1.11.3.3.m1.1.1.1" xref="S4.T1.11.3.3.m1.1.1.1.cmml">/</mo><mi id="S4.T1.11.3.3.m1.1.1.3" xref="S4.T1.11.3.3.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.3.3.m1.1b"><apply id="S4.T1.11.3.3.m1.1.1.cmml" xref="S4.T1.11.3.3.m1.1.1"><divide id="S4.T1.11.3.3.m1.1.1.1.cmml" xref="S4.T1.11.3.3.m1.1.1.1"></divide><apply id="S4.T1.11.3.3.m1.1.1.2.cmml" xref="S4.T1.11.3.3.m1.1.1.2"><times id="S4.T1.11.3.3.m1.1.1.2.1.cmml" xref="S4.T1.11.3.3.m1.1.1.2.1"></times><ci id="S4.T1.11.3.3.m1.1.1.2.2.cmml" xref="S4.T1.11.3.3.m1.1.1.2.2">𝐾</ci><ci id="S4.T1.11.3.3.m1.1.1.2.3.cmml" xref="S4.T1.11.3.3.m1.1.1.2.3">𝐿</ci></apply><ci id="S4.T1.11.3.3.m1.1.1.3.cmml" xref="S4.T1.11.3.3.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.3.3.m1.1c">KL/m</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.12.4" class="ltx_tr">
<th id="S4.T1.12.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Random</th>
<th id="S4.T1.12.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.12.4.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.12.4.1.m1.1a"><msub id="S4.T1.12.4.1.m1.1.1" xref="S4.T1.12.4.1.m1.1.1.cmml"><mi id="S4.T1.12.4.1.m1.1.1.2" xref="S4.T1.12.4.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.12.4.1.m1.1.1.3" xref="S4.T1.12.4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.12.4.1.m1.1b"><apply id="S4.T1.12.4.1.m1.1.1.cmml" xref="S4.T1.12.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.12.4.1.m1.1.1.1.cmml" xref="S4.T1.12.4.1.m1.1.1">subscript</csymbol><ci id="S4.T1.12.4.1.m1.1.1.2.cmml" xref="S4.T1.12.4.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.12.4.1.m1.1.1.3.cmml" xref="S4.T1.12.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.4.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.12.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.330</td>
<td id="S4.T1.12.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,141</td>
<td id="S4.T1.12.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,081</td>
</tr>
<tr id="S4.T1.13.5" class="ltx_tr">
<th id="S4.T1.13.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(1 client)</th>
<th id="S4.T1.13.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T1.13.5.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.13.5.1.m1.1a"><msub id="S4.T1.13.5.1.m1.1.1" xref="S4.T1.13.5.1.m1.1.1.cmml"><mi id="S4.T1.13.5.1.m1.1.1.2" xref="S4.T1.13.5.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.13.5.1.m1.1.1.3" xref="S4.T1.13.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.13.5.1.m1.1b"><apply id="S4.T1.13.5.1.m1.1.1.cmml" xref="S4.T1.13.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.13.5.1.m1.1.1.1.cmml" xref="S4.T1.13.5.1.m1.1.1">subscript</csymbol><ci id="S4.T1.13.5.1.m1.1.1.2.cmml" xref="S4.T1.13.5.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.13.5.1.m1.1.1.3.cmml" xref="S4.T1.13.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.5.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.13.5.3" class="ltx_td ltx_align_center ltx_border_r">0.316</td>
<td id="S4.T1.13.5.4" class="ltx_td ltx_align_center ltx_border_r">0,092</td>
<td id="S4.T1.13.5.5" class="ltx_td ltx_align_center ltx_border_r">0,138</td>
</tr>
<tr id="S4.T1.15.7" class="ltx_tr">
<th id="S4.T1.15.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Learnt</th>
<th id="S4.T1.14.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.14.6.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.14.6.1.m1.1a"><msub id="S4.T1.14.6.1.m1.1.1" xref="S4.T1.14.6.1.m1.1.1.cmml"><mi id="S4.T1.14.6.1.m1.1.1.2" xref="S4.T1.14.6.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.14.6.1.m1.1.1.3" xref="S4.T1.14.6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.14.6.1.m1.1b"><apply id="S4.T1.14.6.1.m1.1.1.cmml" xref="S4.T1.14.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.14.6.1.m1.1.1.1.cmml" xref="S4.T1.14.6.1.m1.1.1">subscript</csymbol><ci id="S4.T1.14.6.1.m1.1.1.2.cmml" xref="S4.T1.14.6.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.14.6.1.m1.1.1.3.cmml" xref="S4.T1.14.6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.6.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.15.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.028</td>
<td id="S4.T1.15.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,023</td>
<td id="S4.T1.15.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S4.T1.15.7.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.15.7.2.m1.1a"><mo id="S4.T1.15.7.2.m1.1.1" xref="S4.T1.15.7.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.7.2.m1.1b"><lt id="S4.T1.15.7.2.m1.1.1.cmml" xref="S4.T1.15.7.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.7.2.m1.1c">&lt;</annotation></semantics></math>0,001</td>
</tr>
<tr id="S4.T1.16.8" class="ltx_tr">
<th id="S4.T1.16.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(1 client)</th>
<th id="S4.T1.16.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T1.16.8.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.16.8.1.m1.1a"><msub id="S4.T1.16.8.1.m1.1.1" xref="S4.T1.16.8.1.m1.1.1.cmml"><mi id="S4.T1.16.8.1.m1.1.1.2" xref="S4.T1.16.8.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.16.8.1.m1.1.1.3" xref="S4.T1.16.8.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.16.8.1.m1.1b"><apply id="S4.T1.16.8.1.m1.1.1.cmml" xref="S4.T1.16.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.16.8.1.m1.1.1.1.cmml" xref="S4.T1.16.8.1.m1.1.1">subscript</csymbol><ci id="S4.T1.16.8.1.m1.1.1.2.cmml" xref="S4.T1.16.8.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.16.8.1.m1.1.1.3.cmml" xref="S4.T1.16.8.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.8.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.16.8.3" class="ltx_td ltx_align_center ltx_border_r">0.028</td>
<td id="S4.T1.16.8.4" class="ltx_td ltx_align_center ltx_border_r">0,020</td>
<td id="S4.T1.16.8.5" class="ltx_td ltx_align_center ltx_border_r">0,001</td>
</tr>
<tr id="S4.T1.27.21.2" class="ltx_tr">
<th id="S4.T1.27.21.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="5">100 users - GenFL - KL Penalty=0.1</th>
</tr>
<tr id="S4.T1.17.9" class="ltx_tr">
<th id="S4.T1.17.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Random</th>
<th id="S4.T1.17.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.17.9.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.17.9.1.m1.1a"><msub id="S4.T1.17.9.1.m1.1.1" xref="S4.T1.17.9.1.m1.1.1.cmml"><mi id="S4.T1.17.9.1.m1.1.1.2" xref="S4.T1.17.9.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.17.9.1.m1.1.1.3" xref="S4.T1.17.9.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.17.9.1.m1.1b"><apply id="S4.T1.17.9.1.m1.1.1.cmml" xref="S4.T1.17.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.17.9.1.m1.1.1.1.cmml" xref="S4.T1.17.9.1.m1.1.1">subscript</csymbol><ci id="S4.T1.17.9.1.m1.1.1.2.cmml" xref="S4.T1.17.9.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.17.9.1.m1.1.1.3.cmml" xref="S4.T1.17.9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.9.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.17.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.333</td>
<td id="S4.T1.17.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,123</td>
<td id="S4.T1.17.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,107</td>
</tr>
<tr id="S4.T1.18.10" class="ltx_tr">
<th id="S4.T1.18.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T1.18.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T1.18.10.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.18.10.1.m1.1a"><msub id="S4.T1.18.10.1.m1.1.1" xref="S4.T1.18.10.1.m1.1.1.cmml"><mi id="S4.T1.18.10.1.m1.1.1.2" xref="S4.T1.18.10.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.18.10.1.m1.1.1.3" xref="S4.T1.18.10.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.18.10.1.m1.1b"><apply id="S4.T1.18.10.1.m1.1.1.cmml" xref="S4.T1.18.10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.18.10.1.m1.1.1.1.cmml" xref="S4.T1.18.10.1.m1.1.1">subscript</csymbol><ci id="S4.T1.18.10.1.m1.1.1.2.cmml" xref="S4.T1.18.10.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.18.10.1.m1.1.1.3.cmml" xref="S4.T1.18.10.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.10.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.18.10.3" class="ltx_td ltx_align_center ltx_border_r">0.342</td>
<td id="S4.T1.18.10.4" class="ltx_td ltx_align_center ltx_border_r">0,090</td>
<td id="S4.T1.18.10.5" class="ltx_td ltx_align_center ltx_border_r">0,163</td>
</tr>
<tr id="S4.T1.20.12" class="ltx_tr">
<th id="S4.T1.20.12.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Learnt</th>
<th id="S4.T1.19.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.19.11.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.19.11.1.m1.1a"><msub id="S4.T1.19.11.1.m1.1.1" xref="S4.T1.19.11.1.m1.1.1.cmml"><mi id="S4.T1.19.11.1.m1.1.1.2" xref="S4.T1.19.11.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.19.11.1.m1.1.1.3" xref="S4.T1.19.11.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.19.11.1.m1.1b"><apply id="S4.T1.19.11.1.m1.1.1.cmml" xref="S4.T1.19.11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.19.11.1.m1.1.1.1.cmml" xref="S4.T1.19.11.1.m1.1.1">subscript</csymbol><ci id="S4.T1.19.11.1.m1.1.1.2.cmml" xref="S4.T1.19.11.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.19.11.1.m1.1.1.3.cmml" xref="S4.T1.19.11.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.11.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.20.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,061</td>
<td id="S4.T1.20.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,030</td>
<td id="S4.T1.20.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S4.T1.20.12.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.20.12.2.m1.1a"><mo id="S4.T1.20.12.2.m1.1.1" xref="S4.T1.20.12.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.20.12.2.m1.1b"><lt id="S4.T1.20.12.2.m1.1.1.cmml" xref="S4.T1.20.12.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.12.2.m1.1c">&lt;</annotation></semantics></math>0,001</td>
</tr>
<tr id="S4.T1.21.13" class="ltx_tr">
<th id="S4.T1.21.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T1.21.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T1.21.13.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.21.13.1.m1.1a"><msub id="S4.T1.21.13.1.m1.1.1" xref="S4.T1.21.13.1.m1.1.1.cmml"><mi id="S4.T1.21.13.1.m1.1.1.2" xref="S4.T1.21.13.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.21.13.1.m1.1.1.3" xref="S4.T1.21.13.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.21.13.1.m1.1b"><apply id="S4.T1.21.13.1.m1.1.1.cmml" xref="S4.T1.21.13.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.21.13.1.m1.1.1.1.cmml" xref="S4.T1.21.13.1.m1.1.1">subscript</csymbol><ci id="S4.T1.21.13.1.m1.1.1.2.cmml" xref="S4.T1.21.13.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.21.13.1.m1.1.1.3.cmml" xref="S4.T1.21.13.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.13.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.21.13.3" class="ltx_td ltx_align_center ltx_border_r">0,088</td>
<td id="S4.T1.21.13.4" class="ltx_td ltx_align_center ltx_border_r">0,029</td>
<td id="S4.T1.21.13.5" class="ltx_td ltx_align_center ltx_border_r">0,002</td>
</tr>
<tr id="S4.T1.27.22.3" class="ltx_tr">
<th id="S4.T1.27.22.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="5">100 users - GenFL - No KL Penalty</th>
</tr>
<tr id="S4.T1.22.14" class="ltx_tr">
<th id="S4.T1.22.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Random</th>
<th id="S4.T1.22.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.22.14.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.22.14.1.m1.1a"><msub id="S4.T1.22.14.1.m1.1.1" xref="S4.T1.22.14.1.m1.1.1.cmml"><mi id="S4.T1.22.14.1.m1.1.1.2" xref="S4.T1.22.14.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.22.14.1.m1.1.1.3" xref="S4.T1.22.14.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.22.14.1.m1.1b"><apply id="S4.T1.22.14.1.m1.1.1.cmml" xref="S4.T1.22.14.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.22.14.1.m1.1.1.1.cmml" xref="S4.T1.22.14.1.m1.1.1">subscript</csymbol><ci id="S4.T1.22.14.1.m1.1.1.2.cmml" xref="S4.T1.22.14.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.22.14.1.m1.1.1.3.cmml" xref="S4.T1.22.14.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.14.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.22.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,415</td>
<td id="S4.T1.22.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,256</td>
<td id="S4.T1.22.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,039</td>
</tr>
<tr id="S4.T1.23.15" class="ltx_tr">
<th id="S4.T1.23.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T1.23.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T1.23.15.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.23.15.1.m1.1a"><msub id="S4.T1.23.15.1.m1.1.1" xref="S4.T1.23.15.1.m1.1.1.cmml"><mi id="S4.T1.23.15.1.m1.1.1.2" xref="S4.T1.23.15.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.23.15.1.m1.1.1.3" xref="S4.T1.23.15.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.23.15.1.m1.1b"><apply id="S4.T1.23.15.1.m1.1.1.cmml" xref="S4.T1.23.15.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.23.15.1.m1.1.1.1.cmml" xref="S4.T1.23.15.1.m1.1.1">subscript</csymbol><ci id="S4.T1.23.15.1.m1.1.1.2.cmml" xref="S4.T1.23.15.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.23.15.1.m1.1.1.3.cmml" xref="S4.T1.23.15.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.15.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.23.15.3" class="ltx_td ltx_align_center ltx_border_r">0,408</td>
<td id="S4.T1.23.15.4" class="ltx_td ltx_align_center ltx_border_r">0,251</td>
<td id="S4.T1.23.15.5" class="ltx_td ltx_align_center ltx_border_r">0,041</td>
</tr>
<tr id="S4.T1.25.17" class="ltx_tr">
<th id="S4.T1.25.17.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Learnt</th>
<th id="S4.T1.24.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T1.24.16.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T1.24.16.1.m1.1a"><msub id="S4.T1.24.16.1.m1.1.1" xref="S4.T1.24.16.1.m1.1.1.cmml"><mi id="S4.T1.24.16.1.m1.1.1.2" xref="S4.T1.24.16.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.24.16.1.m1.1.1.3" xref="S4.T1.24.16.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.24.16.1.m1.1b"><apply id="S4.T1.24.16.1.m1.1.1.cmml" xref="S4.T1.24.16.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.24.16.1.m1.1.1.1.cmml" xref="S4.T1.24.16.1.m1.1.1">subscript</csymbol><ci id="S4.T1.24.16.1.m1.1.1.2.cmml" xref="S4.T1.24.16.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.24.16.1.m1.1.1.3.cmml" xref="S4.T1.24.16.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.24.16.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T1.25.17.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.039</td>
<td id="S4.T1.25.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,030</td>
<td id="S4.T1.25.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S4.T1.25.17.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.25.17.2.m1.1a"><mo id="S4.T1.25.17.2.m1.1.1" xref="S4.T1.25.17.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.25.17.2.m1.1b"><lt id="S4.T1.25.17.2.m1.1.1.cmml" xref="S4.T1.25.17.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.25.17.2.m1.1c">&lt;</annotation></semantics></math>0,001</td>
</tr>
<tr id="S4.T1.27.19" class="ltx_tr">
<th id="S4.T1.27.19.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T1.26.18.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><math id="S4.T1.26.18.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T1.26.18.1.m1.1a"><msub id="S4.T1.26.18.1.m1.1.1" xref="S4.T1.26.18.1.m1.1.1.cmml"><mi id="S4.T1.26.18.1.m1.1.1.2" xref="S4.T1.26.18.1.m1.1.1.2.cmml">f</mi><mn id="S4.T1.26.18.1.m1.1.1.3" xref="S4.T1.26.18.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.26.18.1.m1.1b"><apply id="S4.T1.26.18.1.m1.1.1.cmml" xref="S4.T1.26.18.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.26.18.1.m1.1.1.1.cmml" xref="S4.T1.26.18.1.m1.1.1">subscript</csymbol><ci id="S4.T1.26.18.1.m1.1.1.2.cmml" xref="S4.T1.26.18.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T1.26.18.1.m1.1.1.3.cmml" xref="S4.T1.26.18.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.26.18.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T1.27.19.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.040</td>
<td id="S4.T1.27.19.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0,030</td>
<td id="S4.T1.27.19.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">
<math id="S4.T1.27.19.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.T1.27.19.2.m1.1a"><mo id="S4.T1.27.19.2.m1.1.1" xref="S4.T1.27.19.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.T1.27.19.2.m1.1b"><lt id="S4.T1.27.19.2.m1.1.1.cmml" xref="S4.T1.27.19.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.27.19.2.m1.1c">&lt;</annotation></semantics></math>0,001</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.3" class="ltx_p"><a href="#S4.T1" title="In 4.2 Results ‣ 4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a> gathers our results for <span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_smallcaps">GenFL</span> applied with <math id="S4.SS2.p3.1.m1.2" class="ltx_Math" alttext="f_{1},f_{2}" display="inline"><semantics id="S4.SS2.p3.1.m1.2a"><mrow id="S4.SS2.p3.1.m1.2.2.2" xref="S4.SS2.p3.1.m1.2.2.3.cmml"><msub id="S4.SS2.p3.1.m1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.1.1.2.cmml">f</mi><mn id="S4.SS2.p3.1.m1.1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p3.1.m1.2.2.2.3" xref="S4.SS2.p3.1.m1.2.2.3.cmml">,</mo><msub id="S4.SS2.p3.1.m1.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.cmml"><mi id="S4.SS2.p3.1.m1.2.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.cmml">f</mi><mn id="S4.SS2.p3.1.m1.2.2.2.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.2b"><list id="S4.SS2.p3.1.m1.2.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.2"><apply id="S4.SS2.p3.1.m1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.3">1</cn></apply><apply id="S4.SS2.p3.1.m1.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.1.m1.2.2.2.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.2c">f_{1},f_{2}</annotation></semantics></math> alongside <span id="S4.SS2.p3.3.2" class="ltx_text ltx_font_smallcaps">FedBound</span>. We compared our results with 100 clients with the output of our algorithms for 1 client, corresponding to the batch learning case.
Our FL algorithms benefit from nonvacuous theoretical guarantees and test errors. In the case of data-dependent priors, test errors of <span id="S4.SS2.p3.3.3" class="ltx_text ltx_font_smallcaps">GenFL</span> nearly reach for both <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">f</mi><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">f_{1}</annotation></semantics></math> and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">f</mi><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">f_{2}</annotation></semantics></math>, the precision of their batch counterpart (3% in FL and 2% in batch). In the case of random prior, the KL penalty has a strong positive influence on the test errors.
The generalisation bounds of our algorithms are uniformly deteriorated compared to the batch setting, <em id="S4.SS2.p3.3.4" class="ltx_emph ltx_font_italic">while being of the same magnitude</em>. This is important to notice as this is the price to pay to adapt batch bounds to a federated setting. Indeed, as each user only optimised a proxy of the common generalisation bound, it is legitimate to retrieve in our results a short discrepancy comparing to the batch case.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.4" class="ltx_p">While <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="f_{\text{2}}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">f</mi><mtext id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3a.cmml">2</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝑓</ci><ci id="S4.SS2.p4.1.m1.1.1.3a.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">f_{\text{2}}</annotation></semantics></math> is consistently achieving better generalisation upper bounds in <cite class="ltx_cite ltx_citemacro_cite">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, it is outperformed by <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><msub id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">f</mi><mn id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">f_{1}</annotation></semantics></math> in the FL setting. However, notice that <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><msub id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">f</mi><mn id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">f_{2}</annotation></semantics></math> provides uniformly better test errors than <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><msub id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">f</mi><mn id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝑓</ci><cn type="integer" id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">f_{1}</annotation></semantics></math>, similarly to <cite class="ltx_cite ltx_citemacro_citet">Pérez-Ortiz et al., (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>. Note that better results are achieved if one considers the KL penalty trick with data-free prior and no KL penalty trick with data-dependent prior.
We interpret this fact as follows: given that the data-dependent prior is already performing well on training data, allowing the posterior optimisation to be unconstrained is not an issue as we found an area close from a local minimiser. However, as the random prior is not necessarily efficient, we need to move far from it to reach good empirical performances. However, moving freely from the prior distribution leads to a large KL divergence, hence the need to constrain the posterior optimisation to obtain both better bounds and test errors.
A take-home message is that adapting PAC-Bayes algorithms to FL is effective: it gives nonvacuous results close to the batch setting.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.1" class="ltx_p"><span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_bold">PFL setting.</span></p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results for the PFL scenario. <math id="S4.T2.4.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T2.4.m1.1b"><msup id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T2.4.m1.1.1.2" xref="S4.T2.4.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T2.4.m1.1.1.3" xref="S4.T2.4.m1.1.1.3.cmml"><mn id="S4.T2.4.m1.1.1.3.2" xref="S4.T2.4.m1.1.1.3.2.cmml">0</mn><mo id="S4.T2.4.m1.1.1.3.1" xref="S4.T2.4.m1.1.1.3.1.cmml">−</mo><mn id="S4.T2.4.m1.1.1.3.3" xref="S4.T2.4.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><apply id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.4.m1.1.1.1.cmml" xref="S4.T2.4.m1.1.1">superscript</csymbol><ci id="S4.T2.4.m1.1.1.2.cmml" xref="S4.T2.4.m1.1.1.2">ℓ</ci><apply id="S4.T2.4.m1.1.1.3.cmml" xref="S4.T2.4.m1.1.1.3"><minus id="S4.T2.4.m1.1.1.3.1.cmml" xref="S4.T2.4.m1.1.1.3.1"></minus><cn type="integer" id="S4.T2.4.m1.1.1.3.2.cmml" xref="S4.T2.4.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T2.4.m1.1.1.3.3.cmml" xref="S4.T2.4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">\ell^{0-1}</annotation></semantics></math> corresponds to the 0-1 loss. The test error column is made on the test set of each user (10% of local dataset).The
Gen. Bound column gathers generalisation bounds. Each user bound is computed locally with <math id="S4.T2.5.m2.1" class="ltx_Math" alttext="m_{i}=300" display="inline"><semantics id="S4.T2.5.m2.1b"><mrow id="S4.T2.5.m2.1.1" xref="S4.T2.5.m2.1.1.cmml"><msub id="S4.T2.5.m2.1.1.2" xref="S4.T2.5.m2.1.1.2.cmml"><mi id="S4.T2.5.m2.1.1.2.2" xref="S4.T2.5.m2.1.1.2.2.cmml">m</mi><mi id="S4.T2.5.m2.1.1.2.3" xref="S4.T2.5.m2.1.1.2.3.cmml">i</mi></msub><mo id="S4.T2.5.m2.1.1.1" xref="S4.T2.5.m2.1.1.1.cmml">=</mo><mn id="S4.T2.5.m2.1.1.3" xref="S4.T2.5.m2.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.m2.1c"><apply id="S4.T2.5.m2.1.1.cmml" xref="S4.T2.5.m2.1.1"><eq id="S4.T2.5.m2.1.1.1.cmml" xref="S4.T2.5.m2.1.1.1"></eq><apply id="S4.T2.5.m2.1.1.2.cmml" xref="S4.T2.5.m2.1.1.2"><csymbol cd="ambiguous" id="S4.T2.5.m2.1.1.2.1.cmml" xref="S4.T2.5.m2.1.1.2">subscript</csymbol><ci id="S4.T2.5.m2.1.1.2.2.cmml" xref="S4.T2.5.m2.1.1.2.2">𝑚</ci><ci id="S4.T2.5.m2.1.1.2.3.cmml" xref="S4.T2.5.m2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S4.T2.5.m2.1.1.3.cmml" xref="S4.T2.5.m2.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m2.1d">m_{i}=300</annotation></semantics></math> for learnt prior, while <math id="S4.T2.6.m3.1" class="ltx_Math" alttext="m_{i}=540" display="inline"><semantics id="S4.T2.6.m3.1b"><mrow id="S4.T2.6.m3.1.1" xref="S4.T2.6.m3.1.1.cmml"><msub id="S4.T2.6.m3.1.1.2" xref="S4.T2.6.m3.1.1.2.cmml"><mi id="S4.T2.6.m3.1.1.2.2" xref="S4.T2.6.m3.1.1.2.2.cmml">m</mi><mi id="S4.T2.6.m3.1.1.2.3" xref="S4.T2.6.m3.1.1.2.3.cmml">i</mi></msub><mo id="S4.T2.6.m3.1.1.1" xref="S4.T2.6.m3.1.1.1.cmml">=</mo><mn id="S4.T2.6.m3.1.1.3" xref="S4.T2.6.m3.1.1.3.cmml">540</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.m3.1c"><apply id="S4.T2.6.m3.1.1.cmml" xref="S4.T2.6.m3.1.1"><eq id="S4.T2.6.m3.1.1.1.cmml" xref="S4.T2.6.m3.1.1.1"></eq><apply id="S4.T2.6.m3.1.1.2.cmml" xref="S4.T2.6.m3.1.1.2"><csymbol cd="ambiguous" id="S4.T2.6.m3.1.1.2.1.cmml" xref="S4.T2.6.m3.1.1.2">subscript</csymbol><ci id="S4.T2.6.m3.1.1.2.2.cmml" xref="S4.T2.6.m3.1.1.2.2">𝑚</ci><ci id="S4.T2.6.m3.1.1.2.3.cmml" xref="S4.T2.6.m3.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S4.T2.6.m3.1.1.3.cmml" xref="S4.T2.6.m3.1.1.3">540</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m3.1d">m_{i}=540</annotation></semantics></math> for random prior.</figcaption>
<table id="S4.T2.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.7.1" class="ltx_tr">
<th id="S4.T2.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="2">Setup</th>
<td id="S4.T2.7.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">Gen. Bound <math id="S4.T2.7.1.1.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T2.7.1.1.m1.1a"><msup id="S4.T2.7.1.1.m1.1.1" xref="S4.T2.7.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T2.7.1.1.m1.1.1.2" xref="S4.T2.7.1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T2.7.1.1.m1.1.1.3" xref="S4.T2.7.1.1.m1.1.1.3.cmml"><mn id="S4.T2.7.1.1.m1.1.1.3.2" xref="S4.T2.7.1.1.m1.1.1.3.2.cmml">0</mn><mo id="S4.T2.7.1.1.m1.1.1.3.1" xref="S4.T2.7.1.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.T2.7.1.1.m1.1.1.3.3" xref="S4.T2.7.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.7.1.1.m1.1b"><apply id="S4.T2.7.1.1.m1.1.1.cmml" xref="S4.T2.7.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.7.1.1.m1.1.1.1.cmml" xref="S4.T2.7.1.1.m1.1.1">superscript</csymbol><ci id="S4.T2.7.1.1.m1.1.1.2.cmml" xref="S4.T2.7.1.1.m1.1.1.2">ℓ</ci><apply id="S4.T2.7.1.1.m1.1.1.3.cmml" xref="S4.T2.7.1.1.m1.1.1.3"><minus id="S4.T2.7.1.1.m1.1.1.3.1.cmml" xref="S4.T2.7.1.1.m1.1.1.3.1"></minus><cn type="integer" id="S4.T2.7.1.1.m1.1.1.3.2.cmml" xref="S4.T2.7.1.1.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T2.7.1.1.m1.1.1.3.3.cmml" xref="S4.T2.7.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.1.1.m1.1c">\ell^{0-1}</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.16.11.1" class="ltx_tr">
<th id="S4.T2.16.11.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Prior</th>
<th id="S4.T2.16.11.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Obj.</th>
<td id="S4.T2.16.11.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">min</td>
<td id="S4.T2.16.11.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">mean</td>
<td id="S4.T2.16.11.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">max</td>
</tr>
<tr id="S4.T2.8.2" class="ltx_tr">
<th id="S4.T2.8.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Random</th>
<th id="S4.T2.8.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.8.2.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T2.8.2.1.m1.1a"><msub id="S4.T2.8.2.1.m1.1.1" xref="S4.T2.8.2.1.m1.1.1.cmml"><mi id="S4.T2.8.2.1.m1.1.1.2" xref="S4.T2.8.2.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.8.2.1.m1.1.1.3" xref="S4.T2.8.2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.8.2.1.m1.1b"><apply id="S4.T2.8.2.1.m1.1.1.cmml" xref="S4.T2.8.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.8.2.1.m1.1.1.1.cmml" xref="S4.T2.8.2.1.m1.1.1">subscript</csymbol><ci id="S4.T2.8.2.1.m1.1.1.2.cmml" xref="S4.T2.8.2.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.8.2.1.m1.1.1.3.cmml" xref="S4.T2.8.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.2.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T2.8.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,063</td>
<td id="S4.T2.8.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,680</td>
<td id="S4.T2.8.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,847</td>
</tr>
<tr id="S4.T2.9.3" class="ltx_tr">
<th id="S4.T2.9.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T2.9.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r"><math id="S4.T2.9.3.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T2.9.3.1.m1.1a"><msub id="S4.T2.9.3.1.m1.1.1" xref="S4.T2.9.3.1.m1.1.1.cmml"><mi id="S4.T2.9.3.1.m1.1.1.2" xref="S4.T2.9.3.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.9.3.1.m1.1.1.3" xref="S4.T2.9.3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.9.3.1.m1.1b"><apply id="S4.T2.9.3.1.m1.1.1.cmml" xref="S4.T2.9.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.9.3.1.m1.1.1.1.cmml" xref="S4.T2.9.3.1.m1.1.1">subscript</csymbol><ci id="S4.T2.9.3.1.m1.1.1.2.cmml" xref="S4.T2.9.3.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.9.3.1.m1.1.1.3.cmml" xref="S4.T2.9.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.3.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T2.9.3.3" class="ltx_td ltx_align_center ltx_border_r">0,075</td>
<td id="S4.T2.9.3.4" class="ltx_td ltx_align_center ltx_border_r">0,713</td>
<td id="S4.T2.9.3.5" class="ltx_td ltx_align_center ltx_border_r">0,893</td>
</tr>
<tr id="S4.T2.10.4" class="ltx_tr">
<th id="S4.T2.10.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Learnt</th>
<th id="S4.T2.10.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.10.4.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T2.10.4.1.m1.1a"><msub id="S4.T2.10.4.1.m1.1.1" xref="S4.T2.10.4.1.m1.1.1.cmml"><mi id="S4.T2.10.4.1.m1.1.1.2" xref="S4.T2.10.4.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.10.4.1.m1.1.1.3" xref="S4.T2.10.4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.10.4.1.m1.1b"><apply id="S4.T2.10.4.1.m1.1.1.cmml" xref="S4.T2.10.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.10.4.1.m1.1.1.1.cmml" xref="S4.T2.10.4.1.m1.1.1">subscript</csymbol><ci id="S4.T2.10.4.1.m1.1.1.2.cmml" xref="S4.T2.10.4.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.10.4.1.m1.1.1.3.cmml" xref="S4.T2.10.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.4.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T2.10.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,054</td>
<td id="S4.T2.10.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,112</td>
<td id="S4.T2.10.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,222</td>
</tr>
<tr id="S4.T2.11.5" class="ltx_tr">
<th id="S4.T2.11.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T2.11.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r"><math id="S4.T2.11.5.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T2.11.5.1.m1.1a"><msub id="S4.T2.11.5.1.m1.1.1" xref="S4.T2.11.5.1.m1.1.1.cmml"><mi id="S4.T2.11.5.1.m1.1.1.2" xref="S4.T2.11.5.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.11.5.1.m1.1.1.3" xref="S4.T2.11.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.11.5.1.m1.1b"><apply id="S4.T2.11.5.1.m1.1.1.cmml" xref="S4.T2.11.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.11.5.1.m1.1.1.1.cmml" xref="S4.T2.11.5.1.m1.1.1">subscript</csymbol><ci id="S4.T2.11.5.1.m1.1.1.2.cmml" xref="S4.T2.11.5.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.11.5.1.m1.1.1.3.cmml" xref="S4.T2.11.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.5.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T2.11.5.3" class="ltx_td ltx_align_center ltx_border_r">0,052</td>
<td id="S4.T2.11.5.4" class="ltx_td ltx_align_center ltx_border_r">0,111</td>
<td id="S4.T2.11.5.5" class="ltx_td ltx_align_center ltx_border_r">0,220</td>
</tr>
<tr id="S4.T2.12.6" class="ltx_tr">
<th id="S4.T2.12.6.2" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="2"></th>
<td id="S4.T2.12.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">Test Error <math id="S4.T2.12.6.1.m1.1" class="ltx_Math" alttext="\ell^{0-1}" display="inline"><semantics id="S4.T2.12.6.1.m1.1a"><msup id="S4.T2.12.6.1.m1.1.1" xref="S4.T2.12.6.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.T2.12.6.1.m1.1.1.2" xref="S4.T2.12.6.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S4.T2.12.6.1.m1.1.1.3" xref="S4.T2.12.6.1.m1.1.1.3.cmml"><mn id="S4.T2.12.6.1.m1.1.1.3.2" xref="S4.T2.12.6.1.m1.1.1.3.2.cmml">0</mn><mo id="S4.T2.12.6.1.m1.1.1.3.1" xref="S4.T2.12.6.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.T2.12.6.1.m1.1.1.3.3" xref="S4.T2.12.6.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T2.12.6.1.m1.1b"><apply id="S4.T2.12.6.1.m1.1.1.cmml" xref="S4.T2.12.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.12.6.1.m1.1.1.1.cmml" xref="S4.T2.12.6.1.m1.1.1">superscript</csymbol><ci id="S4.T2.12.6.1.m1.1.1.2.cmml" xref="S4.T2.12.6.1.m1.1.1.2">ℓ</ci><apply id="S4.T2.12.6.1.m1.1.1.3.cmml" xref="S4.T2.12.6.1.m1.1.1.3"><minus id="S4.T2.12.6.1.m1.1.1.3.1.cmml" xref="S4.T2.12.6.1.m1.1.1.3.1"></minus><cn type="integer" id="S4.T2.12.6.1.m1.1.1.3.2.cmml" xref="S4.T2.12.6.1.m1.1.1.3.2">0</cn><cn type="integer" id="S4.T2.12.6.1.m1.1.1.3.3.cmml" xref="S4.T2.12.6.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.6.1.m1.1c">\ell^{0-1}</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T2.13.7" class="ltx_tr">
<th id="S4.T2.13.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Random</th>
<th id="S4.T2.13.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.13.7.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T2.13.7.1.m1.1a"><msub id="S4.T2.13.7.1.m1.1.1" xref="S4.T2.13.7.1.m1.1.1.cmml"><mi id="S4.T2.13.7.1.m1.1.1.2" xref="S4.T2.13.7.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.13.7.1.m1.1.1.3" xref="S4.T2.13.7.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.13.7.1.m1.1b"><apply id="S4.T2.13.7.1.m1.1.1.cmml" xref="S4.T2.13.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.13.7.1.m1.1.1.1.cmml" xref="S4.T2.13.7.1.m1.1.1">subscript</csymbol><ci id="S4.T2.13.7.1.m1.1.1.2.cmml" xref="S4.T2.13.7.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.13.7.1.m1.1.1.3.cmml" xref="S4.T2.13.7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.7.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T2.13.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0</td>
<td id="S4.T2.13.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,552</td>
<td id="S4.T2.13.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,767</td>
</tr>
<tr id="S4.T2.14.8" class="ltx_tr">
<th id="S4.T2.14.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T2.14.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r"><math id="S4.T2.14.8.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T2.14.8.1.m1.1a"><msub id="S4.T2.14.8.1.m1.1.1" xref="S4.T2.14.8.1.m1.1.1.cmml"><mi id="S4.T2.14.8.1.m1.1.1.2" xref="S4.T2.14.8.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.14.8.1.m1.1.1.3" xref="S4.T2.14.8.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.14.8.1.m1.1b"><apply id="S4.T2.14.8.1.m1.1.1.cmml" xref="S4.T2.14.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.14.8.1.m1.1.1.1.cmml" xref="S4.T2.14.8.1.m1.1.1">subscript</csymbol><ci id="S4.T2.14.8.1.m1.1.1.2.cmml" xref="S4.T2.14.8.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.14.8.1.m1.1.1.3.cmml" xref="S4.T2.14.8.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.8.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T2.14.8.3" class="ltx_td ltx_align_center ltx_border_r">0</td>
<td id="S4.T2.14.8.4" class="ltx_td ltx_align_center ltx_border_r">0,588</td>
<td id="S4.T2.14.8.5" class="ltx_td ltx_align_center ltx_border_r">0,833</td>
</tr>
<tr id="S4.T2.15.9" class="ltx_tr">
<th id="S4.T2.15.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Learnt</th>
<th id="S4.T2.15.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.15.9.1.m1.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S4.T2.15.9.1.m1.1a"><msub id="S4.T2.15.9.1.m1.1.1" xref="S4.T2.15.9.1.m1.1.1.cmml"><mi id="S4.T2.15.9.1.m1.1.1.2" xref="S4.T2.15.9.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.15.9.1.m1.1.1.3" xref="S4.T2.15.9.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.15.9.1.m1.1b"><apply id="S4.T2.15.9.1.m1.1.1.cmml" xref="S4.T2.15.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.15.9.1.m1.1.1.1.cmml" xref="S4.T2.15.9.1.m1.1.1">subscript</csymbol><ci id="S4.T2.15.9.1.m1.1.1.2.cmml" xref="S4.T2.15.9.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.15.9.1.m1.1.1.3.cmml" xref="S4.T2.15.9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.9.1.m1.1c">f_{1}</annotation></semantics></math></th>
<td id="S4.T2.15.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0</td>
<td id="S4.T2.15.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,050</td>
<td id="S4.T2.15.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0,183</td>
</tr>
<tr id="S4.T2.16.10" class="ltx_tr">
<th id="S4.T2.16.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">(us)</th>
<th id="S4.T2.16.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r"><math id="S4.T2.16.10.1.m1.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S4.T2.16.10.1.m1.1a"><msub id="S4.T2.16.10.1.m1.1.1" xref="S4.T2.16.10.1.m1.1.1.cmml"><mi id="S4.T2.16.10.1.m1.1.1.2" xref="S4.T2.16.10.1.m1.1.1.2.cmml">f</mi><mn id="S4.T2.16.10.1.m1.1.1.3" xref="S4.T2.16.10.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.16.10.1.m1.1b"><apply id="S4.T2.16.10.1.m1.1.1.cmml" xref="S4.T2.16.10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.16.10.1.m1.1.1.1.cmml" xref="S4.T2.16.10.1.m1.1.1">subscript</csymbol><ci id="S4.T2.16.10.1.m1.1.1.2.cmml" xref="S4.T2.16.10.1.m1.1.1.2">𝑓</ci><cn type="integer" id="S4.T2.16.10.1.m1.1.1.3.cmml" xref="S4.T2.16.10.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.10.1.m1.1c">f_{2}</annotation></semantics></math></th>
<td id="S4.T2.16.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0</td>
<td id="S4.T2.16.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0,044</td>
<td id="S4.T2.16.10.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0,150</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p6" class="ltx_para ltx_noindent">
<p id="S4.SS2.p6.1" class="ltx_p"><a href="#S4.T2" title="In 4.2 Results ‣ 4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> provides an overview of our results in the non-<span id="S4.SS2.p6.1.1" class="ltx_text ltx_font_italic">i.i.d.</span> case. It gathers, for both generalisation bounds and test error, the minimum, mean and maximum performance of all 100 users. The averaged performances are deteriorated compared to <a href="#S4.T1" title="In 4.2 Results ‣ 4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a> for all settings as we consider a harder problem. It is worth noticing that our bounds are nonvacuous and that our algorithms with learnt priors benefit from bounds and test errors lower than 50%. Indeed, if we do not learn the prior, we see from the distribution of errors in <a href="#S4.F1" title="In 4.2 Results ‣ 4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a> that most users have a deteriorated bound and test errors. For learnt priors, the error distribution shows that all users enjoy a meaningful bound as well as sound performance. An interesting point is that the common prior distribution does not support all users uniformly as we can see in <a href="#S4.F1" title="In 4.2 Results ‣ 4 NUMERICAL EXPERIMENTS" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>. Indeed, our algorithms with random priors suffer from deteriorated bounds and test errors on average and the worst case, but approximately 15% enjoy good test errors and 9% benefit from theoretical guarantees lower than 40%. Also, our algorithms with learnt priors enjoy test errors and generalisation guarantees lower than 20% for all users. Furthermore, approximately half of the users benefit from test errors lower than <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mrow id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mn id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml">5</mn><mo id="S4.SS2.p6.1.m1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">5\%</annotation></semantics></math>. This highlights the importance of the prior in this non-<span id="S4.SS2.p6.1.2" class="ltx_text ltx_font_italic">i.i.d.</span> setting. As the test set of each user is small (60 images), some users achieve a 0% test error.</p>
</div>
<figure id="S4.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2310.11203/assets/figs/fclassic_rand.png" id="S4.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="210" height="203" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2310.11203/assets/figs/fquad_rand.png" id="S4.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="210" height="203" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2310.11203/assets/figs/fclassic_learnt.png" id="S4.F1.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="214" height="203" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2310.11203/assets/figs/fquad_learnt.png" id="S4.F1.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="210" height="203" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Histograms gathering test errors (red) and bound (blue) of all 100 users of the PFL setting. In order from top to botton: Random prior<math id="S4.F1.5.m1.1" class="ltx_Math" alttext="-f_{1}" display="inline"><semantics id="S4.F1.5.m1.1b"><mrow id="S4.F1.5.m1.1.1" xref="S4.F1.5.m1.1.1.cmml"><mo id="S4.F1.5.m1.1.1b" xref="S4.F1.5.m1.1.1.cmml">−</mo><msub id="S4.F1.5.m1.1.1.2" xref="S4.F1.5.m1.1.1.2.cmml"><mi id="S4.F1.5.m1.1.1.2.2" xref="S4.F1.5.m1.1.1.2.2.cmml">f</mi><mn id="S4.F1.5.m1.1.1.2.3" xref="S4.F1.5.m1.1.1.2.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.5.m1.1c"><apply id="S4.F1.5.m1.1.1.cmml" xref="S4.F1.5.m1.1.1"><minus id="S4.F1.5.m1.1.1.1.cmml" xref="S4.F1.5.m1.1.1"></minus><apply id="S4.F1.5.m1.1.1.2.cmml" xref="S4.F1.5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.F1.5.m1.1.1.2.1.cmml" xref="S4.F1.5.m1.1.1.2">subscript</csymbol><ci id="S4.F1.5.m1.1.1.2.2.cmml" xref="S4.F1.5.m1.1.1.2.2">𝑓</ci><cn type="integer" id="S4.F1.5.m1.1.1.2.3.cmml" xref="S4.F1.5.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.5.m1.1d">-f_{1}</annotation></semantics></math>, Random prior<math id="S4.F1.6.m2.1" class="ltx_Math" alttext="-f_{2}" display="inline"><semantics id="S4.F1.6.m2.1b"><mrow id="S4.F1.6.m2.1.1" xref="S4.F1.6.m2.1.1.cmml"><mo id="S4.F1.6.m2.1.1b" xref="S4.F1.6.m2.1.1.cmml">−</mo><msub id="S4.F1.6.m2.1.1.2" xref="S4.F1.6.m2.1.1.2.cmml"><mi id="S4.F1.6.m2.1.1.2.2" xref="S4.F1.6.m2.1.1.2.2.cmml">f</mi><mn id="S4.F1.6.m2.1.1.2.3" xref="S4.F1.6.m2.1.1.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.6.m2.1c"><apply id="S4.F1.6.m2.1.1.cmml" xref="S4.F1.6.m2.1.1"><minus id="S4.F1.6.m2.1.1.1.cmml" xref="S4.F1.6.m2.1.1"></minus><apply id="S4.F1.6.m2.1.1.2.cmml" xref="S4.F1.6.m2.1.1.2"><csymbol cd="ambiguous" id="S4.F1.6.m2.1.1.2.1.cmml" xref="S4.F1.6.m2.1.1.2">subscript</csymbol><ci id="S4.F1.6.m2.1.1.2.2.cmml" xref="S4.F1.6.m2.1.1.2.2">𝑓</ci><cn type="integer" id="S4.F1.6.m2.1.1.2.3.cmml" xref="S4.F1.6.m2.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.6.m2.1d">-f_{2}</annotation></semantics></math>, Learnt prior<math id="S4.F1.7.m3.1" class="ltx_Math" alttext="-f_{1}" display="inline"><semantics id="S4.F1.7.m3.1b"><mrow id="S4.F1.7.m3.1.1" xref="S4.F1.7.m3.1.1.cmml"><mo id="S4.F1.7.m3.1.1b" xref="S4.F1.7.m3.1.1.cmml">−</mo><msub id="S4.F1.7.m3.1.1.2" xref="S4.F1.7.m3.1.1.2.cmml"><mi id="S4.F1.7.m3.1.1.2.2" xref="S4.F1.7.m3.1.1.2.2.cmml">f</mi><mn id="S4.F1.7.m3.1.1.2.3" xref="S4.F1.7.m3.1.1.2.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.7.m3.1c"><apply id="S4.F1.7.m3.1.1.cmml" xref="S4.F1.7.m3.1.1"><minus id="S4.F1.7.m3.1.1.1.cmml" xref="S4.F1.7.m3.1.1"></minus><apply id="S4.F1.7.m3.1.1.2.cmml" xref="S4.F1.7.m3.1.1.2"><csymbol cd="ambiguous" id="S4.F1.7.m3.1.1.2.1.cmml" xref="S4.F1.7.m3.1.1.2">subscript</csymbol><ci id="S4.F1.7.m3.1.1.2.2.cmml" xref="S4.F1.7.m3.1.1.2.2">𝑓</ci><cn type="integer" id="S4.F1.7.m3.1.1.2.3.cmml" xref="S4.F1.7.m3.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.7.m3.1d">-f_{1}</annotation></semantics></math>, Learnt prior<math id="S4.F1.8.m4.1" class="ltx_Math" alttext="-f_{2}" display="inline"><semantics id="S4.F1.8.m4.1b"><mrow id="S4.F1.8.m4.1.1" xref="S4.F1.8.m4.1.1.cmml"><mo id="S4.F1.8.m4.1.1b" xref="S4.F1.8.m4.1.1.cmml">−</mo><msub id="S4.F1.8.m4.1.1.2" xref="S4.F1.8.m4.1.1.2.cmml"><mi id="S4.F1.8.m4.1.1.2.2" xref="S4.F1.8.m4.1.1.2.2.cmml">f</mi><mn id="S4.F1.8.m4.1.1.2.3" xref="S4.F1.8.m4.1.1.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.8.m4.1c"><apply id="S4.F1.8.m4.1.1.cmml" xref="S4.F1.8.m4.1.1"><minus id="S4.F1.8.m4.1.1.1.cmml" xref="S4.F1.8.m4.1.1"></minus><apply id="S4.F1.8.m4.1.1.2.cmml" xref="S4.F1.8.m4.1.1.2"><csymbol cd="ambiguous" id="S4.F1.8.m4.1.1.2.1.cmml" xref="S4.F1.8.m4.1.1.2">subscript</csymbol><ci id="S4.F1.8.m4.1.1.2.2.cmml" xref="S4.F1.8.m4.1.1.2.2">𝑓</ci><cn type="integer" id="S4.F1.8.m4.1.1.2.3.cmml" xref="S4.F1.8.m4.1.1.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.8.m4.1d">-f_{2}</annotation></semantics></math>.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>DISCUSSION</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this work, we propose a novel algorithm for FL in two different settings: FL-SOB, which allows to exploit a global generalisation guarantee while keeping data separated; as well as PFL, which only involves an <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">i.i.d.</span> assumption for each user’s dataset. Our work raises two questions: <span id="S5.p1.1.2" class="ltx_text ltx_font_bold">(a) is it possible to remove the </span><span id="S5.p1.1.3" class="ltx_text ltx_font_italic">i.i.d.</span><span id="S5.p1.1.4" class="ltx_text ltx_font_bold"> assumption?</span> <span id="S5.p1.1.5" class="ltx_text ltx_font_bold">(b) is it possible to maintain a global generalisation guarantee, even in the personalised setting?</span> To answer (a), a line of work first initiated by <cite class="ltx_cite ltx_citemacro_citet">Kuzborskij and Szepesvári, (<a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite> (for <span id="S5.p1.1.6" class="ltx_text ltx_font_italic">i.i.d.</span> data) and continued by <cite class="ltx_cite ltx_citemacro_citet">Haddouche and Guedj, (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>); Chugg et al., (<a href="#bib.bib15" title="" class="ltx_ref">2023</a>); Jang et al., (<a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> (for non-<span id="S5.p1.1.7" class="ltx_text ltx_font_italic">i.i.d.</span> ones) focuses on PAC-Bayes bounds valid for data distribution with bounded variances. In the PFL setting, this could provide novel generalisation bounds without assuming each user possesses an <span id="S5.p1.1.8" class="ltx_text ltx_font_italic">i.i.d.</span> dataset. About (b), the recent work of <cite class="ltx_cite ltx_citemacro_citet">Sefidgaran et al., (<a href="#bib.bib54" title="" class="ltx_ref">2023</a>)</cite> provides elements of answer: they derive a general PAC-Bayesian bound holding for the classical FL setting <em id="S5.p1.1.9" class="ltx_emph ltx_font_italic">for all users simultaneously</em> involving explicitly the number of users and rounds. This allows fruitful theoretical interpretations (especially on the number of rounds involved during the FL training), but leads to vacuous generalisation guarantees for classification task with a federated SVM. This constrasts with our nonvacuous guarantees, even for the personalised setting, at the cost of considering generic PAC-Bayesian bounds, not explicitly tailored for federated learning. Establishing a PAC-Bayes bound designed for FL and leading to a non-vacuous generalisation guarantees remains an open challenge that we aim to adress in a future work.</p>
</div>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achituve et al.,  (2021)</span>
<span class="ltx_bibblock">
Achituve, I., Shamsian, A., Navon, A., Chechik, G., and Fetaya, E. (2021).

</span>
<span class="ltx_bibblock">Personalized Federated Learning With Gaussian Processes.

</span>
<span class="ltx_bibblock">In Ranzato, M., Beygelzimer, A., Dauphin, Y. N., Liang, P., and Vaughan, J. W., editors, <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 34: Annual Conference on Neural Information Processing Systems 2021, NeurIPS 2021, December 6-14, 2021, virtual</span>, pages 8392–8406.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al.,  (2018)</span>
<span class="ltx_bibblock">
Agarwal, N., Suresh, A. T., Yu, F. X., Kumar, S., and McMahan, B. (2018).

</span>
<span class="ltx_bibblock">cpSGD: Communication-efficient and differentially-private distributed SGD.

</span>
<span class="ltx_bibblock">In Bengio, S., Wallach, H. M., Larochelle, H., Grauman, K., Cesa-Bianchi, N., and Garnett, R., editors, <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 31: Annual Conference on Neural Information Processing Systems 2018, NeurIPS 2018, December 3-8, 2018, Montréal, Canada</span>, pages 7575–7586.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alquier,  (2021)</span>
<span class="ltx_bibblock">
Alquier, P. (2021).

</span>
<span class="ltx_bibblock">User-friendly introduction to PAC-Bayes bounds.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2110.11216.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alquier et al.,  (2016)</span>
<span class="ltx_bibblock">
Alquier, P., Ridgway, J., and Chopin, N. (2016).

</span>
<span class="ltx_bibblock">On the properties of variational approximations of Gibbs posteriors.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amit and Meir,  (2018)</span>
<span class="ltx_bibblock">
Amit, R. and Meir, R. (2018).

</span>
<span class="ltx_bibblock">Meta-Learning by Adjusting Priors Based on Extended PAC-Bayes Theory.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning (ICML)</span>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al.,  (2020)</span>
<span class="ltx_bibblock">
Beutel, D. J., Topal, T., Mathur, A., Qiu, X., Fernandez-Marques, J., Gao, Y., Sani, L., Kwing, H. L., Parcollet, T., Gusmão, P. P. d., and Lane, N. D. (2020).

</span>
<span class="ltx_bibblock">Flower: A Friendly Federated Learning Research Framework.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.14390</span>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biggs and Guedj,  (2021)</span>
<span class="ltx_bibblock">
Biggs, F. and Guedj, B. (2021).

</span>
<span class="ltx_bibblock">Differentiable PAC-Bayes objectives with partially aggregated neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Entropy</span>, 23(10).

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biggs and Guedj,  (2022)</span>
<span class="ltx_bibblock">
Biggs, F. and Guedj, B. (2022).

</span>
<span class="ltx_bibblock">Non-vacuous generalisation bounds for shallow neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning [ICML]</span>, volume 162 of <span id="bib.bib8.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 1963–1981. PMLR.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biggs et al.,  (2022)</span>
<span class="ltx_bibblock">
Biggs, F., Zantedeschi, V., and Guedj, B. (2022).

</span>
<span class="ltx_bibblock">On margins and generalisation for voting classifiers.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al.,  (2017)</span>
<span class="ltx_bibblock">
Bonawitz, K., Ivanov, V., Kreuter, B., Marcedone, A., McMahan, H. B., Patel, S., Ramage, D., Segal, A., and Seth, K. (2017).

</span>
<span class="ltx_bibblock">Practical secure aggregation for privacy-preserving machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security</span>, pages 1175–1191.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Boucheron et al.,  (2013)</span>
<span class="ltx_bibblock">
Boucheron, S., Lugosi, G., and Massart, P. (2013).

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Concentration Inequalities - A Nonasymptotic Theory of Independence</span>.

</span>
<span class="ltx_bibblock">Oxford University Press.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Catoni,  (2007)</span>
<span class="ltx_bibblock">
Catoni, O. (2007).

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">PAC-Bayesian supervised classification: the thermodynamics of statistical learning</span>.

</span>
<span class="ltx_bibblock">Institute of Mathematical Statistics.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Chao,  (2021)</span>
<span class="ltx_bibblock">
Chen, H. and Chao, W. (2021).

</span>
<span class="ltx_bibblock">FedBE: Making Bayesian Model Ensemble Applicable to Federated Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</span>. OpenReview.net.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chérief-Abdellatif et al.,  (2022)</span>
<span class="ltx_bibblock">
Chérief-Abdellatif, B.-E., Shi, Y., Doucet, A., and Guedj, B. (2022).

</span>
<span class="ltx_bibblock">On PAC-Bayesian reconstruction guarantees for VAEs.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proceedings of The 25th International Conference on Artificial Intelligence and Statistics [AISTATS]</span>, volume 151 of <span id="bib.bib14.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 3066–3079. PMLR.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chugg et al.,  (2023)</span>
<span class="ltx_bibblock">
Chugg, B., Wang, H., and Ramdas, A. (2023).

</span>
<span class="ltx_bibblock">A unified recipe for deriving (time-uniform) PAC-Bayes bounds.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2302.03421.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al.,  (2021)</span>
<span class="ltx_bibblock">
Ding, N., Chen, X., Levinboim, T., Goodman, S., and Soricut, R. (2021).

</span>
<span class="ltx_bibblock">Bridging the Gap Between Practice and PAC-Bayes Theory in Few-Shot Meta-Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</span>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duchi,  (2007)</span>
<span class="ltx_bibblock">
Duchi, J. (2007).

</span>
<span class="ltx_bibblock">Derivations for linear algebra and optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Berkeley, California</span>, 3(1):2325–5870.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dziugaite and Roy,  (2017)</span>
<span class="ltx_bibblock">
Dziugaite, G. K. and Roy, D. (2017).

</span>
<span class="ltx_bibblock">Computing Nonvacuous Generalization Bounds for Deep (Stochastic) Neural Networks with Many More Parameters than Training Data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Conference on Uncertainty in Artificial Intelligence (UAI)</span>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fard and Pineau,  (2010)</span>
<span class="ltx_bibblock">
Fard, M. M. and Pineau, J. (2010).

</span>
<span class="ltx_bibblock">PAC-Bayesian model selection for reinforcement learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</span>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Farid and Majumdar,  (2021)</span>
<span class="ltx_bibblock">
Farid, A. and Majumdar, A. (2021).

</span>
<span class="ltx_bibblock">Generalization Bounds for Meta-Learning via PAC-Bayes and Uniform Stability.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</span>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guedj,  (2019)</span>
<span class="ltx_bibblock">
Guedj, B. (2019).

</span>
<span class="ltx_bibblock">A Primer on PAC-Bayesian Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the second congress of the French Mathematical Society</span>, volume 33.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haddouche and Guedj,  (2022)</span>
<span class="ltx_bibblock">
Haddouche, M. and Guedj, B. (2022).

</span>
<span class="ltx_bibblock">Online PAC-Bayes Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</span>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haddouche and Guedj,  (2023)</span>
<span class="ltx_bibblock">
Haddouche, M. and Guedj, B. (2023).

</span>
<span class="ltx_bibblock">PAC-Bayes Generalisation Bounds for Heavy-Tailed Losses through Supermartingales.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Transactions on Machine Learning Research</span>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardt et al.,  (2016)</span>
<span class="ltx_bibblock">
Hardt, M., Price, E., and Srebro, N. (2016).

</span>
<span class="ltx_bibblock">Equality of Opportunity in Supervised Learning.

</span>
<span class="ltx_bibblock">In Lee, D. D., Sugiyama, M., von Luxburg, U., Guyon, I., and Garnett, R., editors, <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 29: Annual Conference on Neural Information Processing Systems 2016, December 5-10, 2016, Barcelona, Spain</span>, pages 3315–3323.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hellström et al.,  (2023)</span>
<span class="ltx_bibblock">
Hellström, F., Durisi, G., Guedj, B., and Raginsky, M. (2023).

</span>
<span class="ltx_bibblock">Generalization Bounds: Perspectives from Information Theory and PAC-Bayes.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv</span>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang et al.,  (2023)</span>
<span class="ltx_bibblock">
Jang, K., Jun, K.-S., Kuzborskij, I., and Orabona, F. (2023).

</span>
<span class="ltx_bibblock">Tighter PAC-Bayes Bounds Through Coin-Betting.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2302.05829.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al.,  (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N., Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., D’Oliveira, R. G. L., Eichner, H., Rouayheb, S. E., Evans, D., Gardner, J., Garrett, Z., Gascón, A., Ghazi, B., Gibbons, P. B., Gruteser, M., Harchaoui, Z., He, C., He, L., Huo, Z., Hutchinson, B., Hsu, J., Jaggi, M., Javidi, T., Joshi, G., Khodak, M., Konecný, J., Korolova, A., Koushanfar, F., Koyejo, S., Lepoint, T., Liu, Y., Mittal, P., Mohri, M., Nock, R., Özgür, A., Pagh, R., Qi, H., Ramage, D., Raskar, R., Raykova, M., Song, D., Song, W., Stich, S. U., Sun, Z., Suresh, A. T., Tramèr, F., Vepakomma, P., Wang, J., Xiong, L., Xu, Z., Yang, Q., Yu, F. X., Yu, H., and Zhao, S. (2021).

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Foundations and Trends® in Machine Learning</span>, 14(1–2):1–210.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Hospedales,  (2023)</span>
<span class="ltx_bibblock">
Kim, M. and Hospedales, T. M. (2023).

</span>
<span class="ltx_bibblock">FedHB: Hierarchical Bayesian Federated Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2305.04979.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Welling,  (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Welling, M. (2014).

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock">In Bengio, Y. and LeCun, Y., editors, <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">2nd International Conference on Learning Representations, ICLR 2014, Banff, AB, Canada, April 14-16, 2014, Conference Track Proceedings</span>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(30)</span>
<span class="ltx_bibblock">
Konečný, J., McMahan, H. B., Ramage, D., and Richtárik, P. (2016a).

</span>
<span class="ltx_bibblock">Federated Optimization: Distributed Machine Learning for On-Device Intelligence.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/1610.02527.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(31)</span>
<span class="ltx_bibblock">
Konečný, J., McMahan, H. B., Yu, F. X., Richtárik, P., Suresh, A. T., and Bacon, D. (2016b).

</span>
<span class="ltx_bibblock">Federated Learning: Strategies for Improving Communication Efficiency.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/1610.05492.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kotelevskii et al.,  (2022)</span>
<span class="ltx_bibblock">
Kotelevskii, N., Vono, M., Durmus, A., and Moulines, E. (2022).

</span>
<span class="ltx_bibblock">FedPop: A Bayesian Approach for Personalised Federated Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuzborskij and Szepesvári,  (2019)</span>
<span class="ltx_bibblock">
Kuzborskij, I. and Szepesvári, C. (2019).

</span>
<span class="ltx_bibblock">Efron-Stein PAC-Bayesian Inequalities.

</span>
<span class="ltx_bibblock">arXiv:1909.01931.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Letarte et al.,  (2019)</span>
<span class="ltx_bibblock">
Letarte, G., Germain, P., Guedj, B., and Laviolette, F. (2019).

</span>
<span class="ltx_bibblock">Dichotomize and generalize: PAC-Bayesian binary activated deep neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 32: Annual Conference on Neural Information Processing Systems [NeurIPS] 2019, 8-14 December 2019, Vancouver, BC, Canada</span>, pages 6869–6879.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al.,  (2018)</span>
<span class="ltx_bibblock">
Li, L., Guedj, B., and Loustau, S. (2018).

</span>
<span class="ltx_bibblock">A quasi-Bayesian perspective to online clustering.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Electron. J. Statist.</span>, 12(2):3071–3113.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mammen,  (2021)</span>
<span class="ltx_bibblock">
Mammen, P. M. (2021).

</span>
<span class="ltx_bibblock">Federated Learning: Opportunities and Challenges.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maurer,  (2004)</span>
<span class="ltx_bibblock">
Maurer, A. (2004).

</span>
<span class="ltx_bibblock">A note on the PAC-Bayesian theorem.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">arXiv</span>, cs/0411099.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAllester,  (1998)</span>
<span class="ltx_bibblock">
McAllester, D. A. (1998).

</span>
<span class="ltx_bibblock">Some PAC-Bayesian theorems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Proceedings of the eleventh annual conference on Computational Learning Theory</span>, pages 230–234. ACM.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAllester,  (2003)</span>
<span class="ltx_bibblock">
McAllester, D. A. (2003).

</span>
<span class="ltx_bibblock">PAC-Bayesian stochastic model selection.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Machine Learning</span>, 51(1):5–21.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(40)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and Arcas, B. A. y. (2017a).

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized Data.

</span>
<span class="ltx_bibblock">In Singh, A. and Zhu, J., editors, <span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">Proceedings of the 20th International Conference on Artificial Intelligence and Statistics</span>, volume 54 of <span id="bib.bib40.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(41)</span>
<span class="ltx_bibblock">
McMahan, H. B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A. (2017b).

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized Data.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mhammedi et al.,  (2019)</span>
<span class="ltx_bibblock">
Mhammedi, Z., Grünwald, P., and Guedj, B. (2019).

</span>
<span class="ltx_bibblock">PAC-Bayes un-expected Bernstein inequality.

</span>
<span class="ltx_bibblock">In <span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 32: Annual Conference on Neural Information Processing Systems [NeurIPS] 2019, 8-14 December 2019, Vancouver, BC, Canada</span>, pages 12180–12191.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri et al.,  (2019)</span>
<span class="ltx_bibblock">
Mohri, M., Sivek, G., and Suresh, A. T. (2019).

</span>
<span class="ltx_bibblock">Agnostic Federated Learning.

</span>
<span class="ltx_bibblock">In Chaudhuri, K. and Salakhutdinov, R., editors, <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</span>, volume 97 of <span id="bib.bib43.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 4615–4625. PMLR.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nozawa et al.,  (2020)</span>
<span class="ltx_bibblock">
Nozawa, K., Germain, P., and Guedj, B. (2020).

</span>
<span class="ltx_bibblock">PAC-Bayesian contrastive unsupervised representation learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">Conference on Uncertainty in Artificial Intelligence [UAI]</span>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al.,  (2019)</span>
<span class="ltx_bibblock">
Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J., Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga, L., Desmaison, A., Kopf, A., Yang, E., DeVito, Z., Raison, M., Tejani, A., Chilamkurthy, S., Steiner, B., Fang, L., Bai, J., and Chintala, S. (2019).

</span>
<span class="ltx_bibblock">PyTorch: An Imperative Style, High-Performance Deep Learning Library.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 32</span>, pages 8024–8035. Curran Associates, Inc.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez-Ortiz et al.,  (2021)</span>
<span class="ltx_bibblock">
Perez-Ortiz, M., Rivasplata, O., Parrado-Hernandez, E., Guedj, B., and Shawe-Taylor, J. (2021).

</span>
<span class="ltx_bibblock">Progress in Self-Certified Neural Networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">NeurIPS 2021 Workshop on Bayesian Deep Learning</span>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pérez-Ortiz et al.,  (2021)</span>
<span class="ltx_bibblock">
Pérez-Ortiz, M., Rivasplata, O., Shawe-Taylor, J., and Szepesvári, C. (2021).

</span>
<span class="ltx_bibblock">Tighter Risk Certificates for Neural Networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>, 22(227):1–40.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisizadeh et al.,  (2020)</span>
<span class="ltx_bibblock">
Reisizadeh, A., Farnia, F., Pedarsani, R., and Jadbabaie, A. (2020).

</span>
<span class="ltx_bibblock">Robust Federated Learning: The Case of Affine Distribution Shifts.

</span>
<span class="ltx_bibblock">In Larochelle, H., Ranzato, M., Hadsell, R., Balcan, M., and Lin, H., editors, <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</span>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rivasplata et al.,  (2019)</span>
<span class="ltx_bibblock">
Rivasplata, O., Tankasali, V. M., and Szepesvári, C. (2019).

</span>
<span class="ltx_bibblock">PAC-Bayes with Backprop.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/1908.07380.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rothfuss et al.,  (2021)</span>
<span class="ltx_bibblock">
Rothfuss, J., Fortuin, V., Josifoski, M., and Krause, A. (2021).

</span>
<span class="ltx_bibblock">PACOH: Bayes-optimal meta-learning with PAC-guarantees.

</span>
<span class="ltx_bibblock">In <span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning (ICML)</span>.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rothfuss et al.,  (2022)</span>
<span class="ltx_bibblock">
Rothfuss, J., Josifoski, M., Fortuin, V., and Krause, A. (2022).

</span>
<span class="ltx_bibblock">PAC-Bayesian Meta-Learning: From Theory to Practice.

</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2211.07206.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakhi et al.,  (2022)</span>
<span class="ltx_bibblock">
Sakhi, O., Chopin, N., and Alquier, P. (2022).

</span>
<span class="ltx_bibblock">PAC-Bayesian Offline Contextual Bandits With Guarantees.

</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2210.13132.

</span>
<span class="ltx_bibblock">To appear in ICML 2023.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scott et al.,  (2023)</span>
<span class="ltx_bibblock">
Scott, J., Zakerinia, H., and Lampert, C. H. (2023).

</span>
<span class="ltx_bibblock">PeFLL: A Lifelong Learning Approach to Personalized Federated Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2306.05515.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sefidgaran et al.,  (2023)</span>
<span class="ltx_bibblock">
Sefidgaran, M., Chor, R., Zaidi, A., and Wan, Y. (2023).

</span>
<span class="ltx_bibblock">Federated Learning You May Communicate Less Often!

</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2306.05862.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seldin et al.,  (2012)</span>
<span class="ltx_bibblock">
Seldin, Y., Laviolette, F., Cesa-Bianchi, N., Shawe-Taylor, J., and Auer, P. (2012).

</span>
<span class="ltx_bibblock">PAC-Bayesian Inequalities for Martingales.

</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Information Theory</span>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seldin et al.,  (2011)</span>
<span class="ltx_bibblock">
Seldin, Y., Laviolette, F., Shawe-Taylor, J., Peters, J., and Auer, P. (2011).

</span>
<span class="ltx_bibblock">PAC-Bayesian Analysis of Martingales and Multiarmed Bandits.

</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/1105.2416.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shawe-Taylor and Williamson,  (1997)</span>
<span class="ltx_bibblock">
Shawe-Taylor, J. and Williamson, R. C. (1997).

</span>
<span class="ltx_bibblock">A PAC analysis of a Bayes estimator.

</span>
<span class="ltx_bibblock">In <span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">Proceedings of the 10th annual conference on Computational Learning Theory</span>, pages 2–9. ACM.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suresh et al.,  (2017)</span>
<span class="ltx_bibblock">
Suresh, A. T., Yu, F. X., Kumar, S., and McMahan, H. B. (2017).

</span>
<span class="ltx_bibblock">Distributed Mean Estimation with Limited Communication.

</span>
<span class="ltx_bibblock">In Precup, D. and Teh, Y. W., editors, <span id="bib.bib58.1.1" class="ltx_text ltx_font_italic">Proceedings of the 34th International Conference on Machine Learning, ICML 2017, Sydney, NSW, Australia, 6-11 August 2017</span>, volume 70 of <span id="bib.bib58.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 3329–3337. PMLR.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al.,  (2022)</span>
<span class="ltx_bibblock">
Tan, A. Z., Yu, H., Cui, L., and Yang, Q. (2022).

</span>
<span class="ltx_bibblock">Towards Personalized Federated Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>, pages 1–17.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolstikhin and Seldin,  (2013)</span>
<span class="ltx_bibblock">
Tolstikhin, I. O. and Seldin, Y. (2013).

</span>
<span class="ltx_bibblock">PAC-Bayes-Empirical-Bernstein Inequality.

</span>
<span class="ltx_bibblock">In Burges, C. J. C., Bottou, L., Ghahramani, Z., and Weinberger, K. Q., editors, <span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 26: 27th Annual Conference on Neural Information Processing Systems 2013. Proceedings of a meeting held December 5-8, 2013, Lake Tahoe, Nevada, United States</span>, pages 109–117.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tsipras et al.,  (2019)</span>
<span class="ltx_bibblock">
Tsipras, D., Santurkar, S., Engstrom, L., Turner, A., and Madry, A. (2019).

</span>
<span class="ltx_bibblock">Robustness May Be at Odds with Accuracy.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vedadi et al.,  (2023)</span>
<span class="ltx_bibblock">
Vedadi, E., Dillon, J. V., Mansfield, P. A., Singhal, K., Afkanpour, A., and Morningstar, W. R. (2023).

</span>
<span class="ltx_bibblock">Federated Variational Inference: Towards Improved Personalization and Generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">arXiv</span>, abs/2305.13672.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yadan,  (2019)</span>
<span class="ltx_bibblock">
Yadan, O. (2019).

</span>
<span class="ltx_bibblock">Hydra - A framework for elegantly configuring complex applications.

</span>
<span class="ltx_bibblock">Github.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yagli et al.,  (2020)</span>
<span class="ltx_bibblock">
Yagli, S., Dytso, A., and Vincent Poor, H. (2020).

</span>
<span class="ltx_bibblock">Information-Theoretic Bounds on the Generalization Error and Privacy Leakage in Federated Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib64.1.1" class="ltx_text ltx_font_italic">2020 IEEE 21st International Workshop on Signal Processing Advances in Wireless Communications (SPAWC)</span>, pages 1–5.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoo et al.,  (2003)</span>
<span class="ltx_bibblock">
Yoo, A. B., Jette, M. A., and Grondona, M. (2003).

</span>
<span class="ltx_bibblock">Slurm: Simple linux utility for resource management.

</span>
<span class="ltx_bibblock">In Feitelson, D., Rudolph, L., and Schwiegelshohn, U., editors, <span id="bib.bib65.1.1" class="ltx_text ltx_font_italic">Job Scheduling Strategies for Parallel Processing</span>, pages 44–60, Berlin, Heidelberg. Springer Berlin Heidelberg.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al.,  (2019)</span>
<span class="ltx_bibblock">
Yurochkin, M., Agarwal, M., Ghosh, S., Greenewald, K., Hoang, N., and Khazaeni, Y. (2019).

</span>
<span class="ltx_bibblock">Bayesian Nonparametric Federated Learning of Neural Networks.

</span>
<span class="ltx_bibblock">In Chaudhuri, K. and Salakhutdinov, R., editors, <span id="bib.bib66.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</span>, volume 97 of <span id="bib.bib66.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 7252–7261. PMLR.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zantedeschi et al.,  (2021)</span>
<span class="ltx_bibblock">
Zantedeschi, V., Viallard, P., Morvant, E., Emonet, R., Habrard, A., Germain, P., and Guedj, B. (2021).

</span>
<span class="ltx_bibblock">Learning Stochastic Majority Votes by Minimizing a PAC-Bayes Generalization Bound.

</span>
<span class="ltx_bibblock">In <span id="bib.bib67.1.1" class="ltx_text ltx_font_italic">Conference on Neural Information Processing Systems (NeurIPS)</span>.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al.,  (2021)</span>
<span class="ltx_bibblock">
Zhang, C., Xie, Y., Bai, H., Yu, B., Li, W., and Gao, Y. (2021).

</span>
<span class="ltx_bibblock">A survey on federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib68.1.1" class="ltx_text ltx_font_italic">Knowledge-Based Systems</span>, 216:106775.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al.,  (2019)</span>
<span class="ltx_bibblock">
Zhang, H., Yu, Y., Jiao, J., Xing, E., Ghaoui, L. E., and Jordan, M. (2019).

</span>
<span class="ltx_bibblock">Theoretically Principled Trade-off between Robustness and Accuracy.

</span>
<span class="ltx_bibblock">In Chaudhuri, K. and Salakhutdinov, R., editors, <span id="bib.bib69.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</span>, volume 97 of <span id="bib.bib69.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 7472–7482. PMLR.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(70)</span>
<span class="ltx_bibblock">
Zhang, L., Lei, X., Shi, Y., Huang, H., and Chen, C. (2023a).

</span>
<span class="ltx_bibblock">Federated Learning for IoT Devices With Domain Generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib70.1.1" class="ltx_text ltx_font_italic">IEEE Internet Things J.</span>, 10(11):9622–9633.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(71)</span>
<span class="ltx_bibblock">
Zhang, X., Huang, A., Fan, L., Chen, K., and Yang, Q. (2023b).

</span>
<span class="ltx_bibblock">Probably Approximately Correct Federated Learning.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al.,  (2022)</span>
<span class="ltx_bibblock">
Zhang, X., Li, Y., Li, W., Guo, K., and Shao, Y. (2022).

</span>
<span class="ltx_bibblock">Personalized Federated Learning via Variational Bayesian Inference.

</span>
<span class="ltx_bibblock">In Chaudhuri, K., Jegelka, S., Song, L., Szepesvari, C., Niu, G., and Sabato, S., editors, <span id="bib.bib72.1.1" class="ltx_text ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning</span>, volume 162 of <span id="bib.bib72.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 26293–26310. PMLR.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al.,  (2021)</span>
<span class="ltx_bibblock">
Zhuang, F., Qi, Z., Duan, K., Xi, D., Zhu, Y., Zhu, H., Xiong, H., and He, Q. (2021).

</span>
<span class="ltx_bibblock">A Comprehensive Survey on Transfer Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib73.1.1" class="ltx_text ltx_font_italic">Proc. IEEE</span>, 109(1):43–76.

</span>
</li>
</ul>
</section>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Checklist</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<ol id="Sx1.I1" class="ltx_enumerate">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">For all models and algorithms presented, check if you include:</p>
<ol id="Sx1.I1.i1.I1" class="ltx_enumerate">
<li id="Sx1.I1.i1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="Sx1.I1.i1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.I1.i1.p1.1" class="ltx_p">A clear description of the mathematical setting, assumptions, algorithm, and/or model. [Yes]</p>
</div>
</li>
<li id="Sx1.I1.i1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="Sx1.I1.i1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i1.I1.i2.p1.1" class="ltx_p">An analysis of the properties and complexity (time, space, sample size) of any algorithm. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="Sx1.I1.i1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i1.I1.i3.p1.1" class="ltx_p">(Optional) Anonymized source code, with specification of all dependencies, including external libraries. [Yes]</p>
</div>
</li>
</ol>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">For any theoretical claim, check if you include:</p>
<ol id="Sx1.I1.i2.I1" class="ltx_enumerate">
<li id="Sx1.I1.i2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="Sx1.I1.i2.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i2.I1.i1.p1.1" class="ltx_p">Statements of the full set of assumptions of all theoretical results. [Yes]</p>
</div>
</li>
<li id="Sx1.I1.i2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="Sx1.I1.i2.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.I1.i2.p1.1" class="ltx_p">Complete proofs of all theoretical results. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="Sx1.I1.i2.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i2.I1.i3.p1.1" class="ltx_p">Clear explanations of any assumptions. [Yes]</p>
</div>
</li>
</ol>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">For all figures and tables that present empirical results, check if you include:</p>
<ol id="Sx1.I1.i3.I1" class="ltx_enumerate">
<li id="Sx1.I1.i3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="Sx1.I1.i3.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i3.I1.i1.p1.1" class="ltx_p">The code, data, and instructions needed to reproduce the main experimental results (either in the supplemental material or as a URL). [Yes]</p>
</div>
</li>
<li id="Sx1.I1.i3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="Sx1.I1.i3.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i3.I1.i2.p1.1" class="ltx_p">All the training details (e.g., data splits, hyperparameters, how they were chosen). [Yes]</p>
</div>
</li>
<li id="Sx1.I1.i3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="Sx1.I1.i3.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.I1.i3.p1.1" class="ltx_p">A clear definition of the specific measure or statistics and error bars (e.g., with respect to the random seed after running experiments multiple times). [No]</p>
</div>
</li>
<li id="Sx1.I1.i3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(d)</span> 
<div id="Sx1.I1.i3.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i3.I1.i4.p1.1" class="ltx_p">A description of the computing infrastructure used. (e.g., type of GPUs, internal cluster, or cloud provider). [Yes]</p>
</div>
</li>
</ol>
</div>
</li>
<li id="Sx1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="Sx1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i4.p1.1" class="ltx_p">If you are using existing assets (e.g., code, data, models) or curating/releasing new assets, check if you include:</p>
<ol id="Sx1.I1.i4.I1" class="ltx_enumerate">
<li id="Sx1.I1.i4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="Sx1.I1.i4.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i4.I1.i1.p1.1" class="ltx_p">Citations of the creator If your work uses existing assets. [Yes]</p>
</div>
</li>
<li id="Sx1.I1.i4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="Sx1.I1.i4.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i4.I1.i2.p1.1" class="ltx_p">The license information of the assets, if applicable. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="Sx1.I1.i4.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i4.I1.i3.p1.1" class="ltx_p">New assets either in the supplemental material or as a URL, if applicable. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(d)</span> 
<div id="Sx1.I1.i4.I1.i4.p1" class="ltx_para">
<p id="Sx1.I1.i4.I1.i4.p1.1" class="ltx_p">Information about consent from data providers/curators. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(e)</span> 
<div id="Sx1.I1.i4.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i4.I1.i5.p1.1" class="ltx_p">Discussion of sensible content if applicable, e.g., personally identifiable information or offensive content. [Not Applicable]</p>
</div>
</li>
</ol>
</div>
</li>
<li id="Sx1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="Sx1.I1.i5.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i5.p1.1" class="ltx_p">If you used crowdsourcing or conducted research with human subjects, check if you include:</p>
<ol id="Sx1.I1.i5.I1" class="ltx_enumerate">
<li id="Sx1.I1.i5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="Sx1.I1.i5.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i5.I1.i1.p1.1" class="ltx_p">The full text of instructions given to participants and screenshots. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="Sx1.I1.i5.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i5.I1.i2.p1.1" class="ltx_p">Descriptions of potential participant risks, with links to Institutional Review Board (IRB) approvals if applicable. [Not Applicable]</p>
</div>
</li>
<li id="Sx1.I1.i5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="Sx1.I1.i5.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="Sx1.I1.i5.I1.i3.p1.1" class="ltx_p">The estimated hourly wage paid to participants and the total amount spent on participant compensation. [Not Applicable]</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:4.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="Sx1.p3" class="ltx_para ltx_noindent ltx_align_center">
<p id="Sx1.p3.1" class="ltx_p"><span id="Sx1.p3.1.1" class="ltx_text ltx_font_bold">Federated Learning with Nonvacuous Generalisation Bounds
<br class="ltx_break">Supplementary Material</span></p>
</div>
<div id="Sx1.p4" class="ltx_para">
<br class="ltx_break">
<p id="Sx1.p4.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="Sx1.p5" class="ltx_para ltx_noindent">
<br class="ltx_break">
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Approximating the inverted <math id="A1.1.m1.1" class="ltx_Math" alttext="kl" display="inline"><semantics id="A1.1.m1.1b"><mrow id="A1.1.m1.1.1" xref="A1.1.m1.1.1.cmml"><mi id="A1.1.m1.1.1.2" xref="A1.1.m1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A1.1.m1.1.1.1" xref="A1.1.m1.1.1.1.cmml">​</mo><mi id="A1.1.m1.1.1.3" xref="A1.1.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.1.m1.1c"><apply id="A1.1.m1.1.1.cmml" xref="A1.1.m1.1.1"><times id="A1.1.m1.1.1.1.cmml" xref="A1.1.m1.1.1.1"></times><ci id="A1.1.m1.1.1.2.cmml" xref="A1.1.m1.1.1.2">𝑘</ci><ci id="A1.1.m1.1.1.3.cmml" xref="A1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.m1.1d">kl</annotation></semantics></math>
</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.8" class="ltx_p">To approximate the inverted kl divergence, we re-use the technique presented in <cite class="ltx_cite ltx_citemacro_citet">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>, Appendix A)</cite>. As there is no closed form formula for <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\mathrm{kl}^{-1}(q\mid c)" display="inline"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><msup id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml"><mi id="A1.p1.1.m1.1.1.3.2" xref="A1.p1.1.m1.1.1.3.2.cmml">kl</mi><mrow id="A1.p1.1.m1.1.1.3.3" xref="A1.p1.1.m1.1.1.3.3.cmml"><mo id="A1.p1.1.m1.1.1.3.3a" xref="A1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.p1.1.m1.1.1.3.3.2" xref="A1.p1.1.m1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="A1.p1.1.m1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.p1.1.m1.1.1.1.1.2" xref="A1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.p1.1.m1.1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.1.1.1.2" xref="A1.p1.1.m1.1.1.1.1.1.2.cmml">q</mi><mo id="A1.p1.1.m1.1.1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="A1.p1.1.m1.1.1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="A1.p1.1.m1.1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><times id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2"></times><apply id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.3.1.cmml" xref="A1.p1.1.m1.1.1.3">superscript</csymbol><ci id="A1.p1.1.m1.1.1.3.2.cmml" xref="A1.p1.1.m1.1.1.3.2">kl</ci><apply id="A1.p1.1.m1.1.1.3.3.cmml" xref="A1.p1.1.m1.1.1.3.3"><minus id="A1.p1.1.m1.1.1.3.3.1.cmml" xref="A1.p1.1.m1.1.1.3.3"></minus><cn type="integer" id="A1.p1.1.m1.1.1.3.3.2.cmml" xref="A1.p1.1.m1.1.1.3.3.2">1</cn></apply></apply><apply id="A1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1.1.1.2">𝑞</ci><ci id="A1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\mathrm{kl}^{-1}(q\mid c)</annotation></semantics></math>, we approximate it via root-finding techniques. For all <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="q\in" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">q</mi><mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><in id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></in><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑞</ci><csymbol cd="latexml" id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">q\in</annotation></semantics></math> <math id="A1.p1.3.m3.2" class="ltx_Math" alttext="(0,1)" display="inline"><semantics id="A1.p1.3.m3.2a"><mrow id="A1.p1.3.m3.2.3.2" xref="A1.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="A1.p1.3.m3.2.3.2.1" xref="A1.p1.3.m3.2.3.1.cmml">(</mo><mn id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml">0</mn><mo id="A1.p1.3.m3.2.3.2.2" xref="A1.p1.3.m3.2.3.1.cmml">,</mo><mn id="A1.p1.3.m3.2.2" xref="A1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="A1.p1.3.m3.2.3.2.3" xref="A1.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.2b"><interval closure="open" id="A1.p1.3.m3.2.3.1.cmml" xref="A1.p1.3.m3.2.3.2"><cn type="integer" id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1">0</cn><cn type="integer" id="A1.p1.3.m3.2.2.cmml" xref="A1.p1.3.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.2c">(0,1)</annotation></semantics></math> and <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="c\geq 0" display="inline"><semantics id="A1.p1.4.m4.1a"><mrow id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">c</mi><mo id="A1.p1.4.m4.1.1.1" xref="A1.p1.4.m4.1.1.1.cmml">≥</mo><mn id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><geq id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1.1"></geq><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑐</ci><cn type="integer" id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">c\geq 0</annotation></semantics></math>, define <math id="A1.p1.5.m5.5" class="ltx_Math" alttext="h_{q,c}(p)=\operatorname{KL}(q\|p)-c" display="inline"><semantics id="A1.p1.5.m5.5a"><mrow id="A1.p1.5.m5.5.5" xref="A1.p1.5.m5.5.5.cmml"><mrow id="A1.p1.5.m5.5.5.3" xref="A1.p1.5.m5.5.5.3.cmml"><msub id="A1.p1.5.m5.5.5.3.2" xref="A1.p1.5.m5.5.5.3.2.cmml"><mi id="A1.p1.5.m5.5.5.3.2.2" xref="A1.p1.5.m5.5.5.3.2.2.cmml">h</mi><mrow id="A1.p1.5.m5.2.2.2.4" xref="A1.p1.5.m5.2.2.2.3.cmml"><mi id="A1.p1.5.m5.1.1.1.1" xref="A1.p1.5.m5.1.1.1.1.cmml">q</mi><mo id="A1.p1.5.m5.2.2.2.4.1" xref="A1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="A1.p1.5.m5.2.2.2.2" xref="A1.p1.5.m5.2.2.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.p1.5.m5.5.5.3.1" xref="A1.p1.5.m5.5.5.3.1.cmml">​</mo><mrow id="A1.p1.5.m5.5.5.3.3.2" xref="A1.p1.5.m5.5.5.3.cmml"><mo stretchy="false" id="A1.p1.5.m5.5.5.3.3.2.1" xref="A1.p1.5.m5.5.5.3.cmml">(</mo><mi id="A1.p1.5.m5.3.3" xref="A1.p1.5.m5.3.3.cmml">p</mi><mo stretchy="false" id="A1.p1.5.m5.5.5.3.3.2.2" xref="A1.p1.5.m5.5.5.3.cmml">)</mo></mrow></mrow><mo id="A1.p1.5.m5.5.5.2" xref="A1.p1.5.m5.5.5.2.cmml">=</mo><mrow id="A1.p1.5.m5.5.5.1" xref="A1.p1.5.m5.5.5.1.cmml"><mrow id="A1.p1.5.m5.5.5.1.1.1" xref="A1.p1.5.m5.5.5.1.1.2.cmml"><mi id="A1.p1.5.m5.4.4" xref="A1.p1.5.m5.4.4.cmml">KL</mi><mo id="A1.p1.5.m5.5.5.1.1.1a" xref="A1.p1.5.m5.5.5.1.1.2.cmml">⁡</mo><mrow id="A1.p1.5.m5.5.5.1.1.1.1" xref="A1.p1.5.m5.5.5.1.1.2.cmml"><mo stretchy="false" id="A1.p1.5.m5.5.5.1.1.1.1.2" xref="A1.p1.5.m5.5.5.1.1.2.cmml">(</mo><mrow id="A1.p1.5.m5.5.5.1.1.1.1.1" xref="A1.p1.5.m5.5.5.1.1.1.1.1.cmml"><mi id="A1.p1.5.m5.5.5.1.1.1.1.1.2" xref="A1.p1.5.m5.5.5.1.1.1.1.1.2.cmml">q</mi><mo id="A1.p1.5.m5.5.5.1.1.1.1.1.1" xref="A1.p1.5.m5.5.5.1.1.1.1.1.1.cmml">∥</mo><mi id="A1.p1.5.m5.5.5.1.1.1.1.1.3" xref="A1.p1.5.m5.5.5.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="A1.p1.5.m5.5.5.1.1.1.1.3" xref="A1.p1.5.m5.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.p1.5.m5.5.5.1.2" xref="A1.p1.5.m5.5.5.1.2.cmml">−</mo><mi id="A1.p1.5.m5.5.5.1.3" xref="A1.p1.5.m5.5.5.1.3.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.5b"><apply id="A1.p1.5.m5.5.5.cmml" xref="A1.p1.5.m5.5.5"><eq id="A1.p1.5.m5.5.5.2.cmml" xref="A1.p1.5.m5.5.5.2"></eq><apply id="A1.p1.5.m5.5.5.3.cmml" xref="A1.p1.5.m5.5.5.3"><times id="A1.p1.5.m5.5.5.3.1.cmml" xref="A1.p1.5.m5.5.5.3.1"></times><apply id="A1.p1.5.m5.5.5.3.2.cmml" xref="A1.p1.5.m5.5.5.3.2"><csymbol cd="ambiguous" id="A1.p1.5.m5.5.5.3.2.1.cmml" xref="A1.p1.5.m5.5.5.3.2">subscript</csymbol><ci id="A1.p1.5.m5.5.5.3.2.2.cmml" xref="A1.p1.5.m5.5.5.3.2.2">ℎ</ci><list id="A1.p1.5.m5.2.2.2.3.cmml" xref="A1.p1.5.m5.2.2.2.4"><ci id="A1.p1.5.m5.1.1.1.1.cmml" xref="A1.p1.5.m5.1.1.1.1">𝑞</ci><ci id="A1.p1.5.m5.2.2.2.2.cmml" xref="A1.p1.5.m5.2.2.2.2">𝑐</ci></list></apply><ci id="A1.p1.5.m5.3.3.cmml" xref="A1.p1.5.m5.3.3">𝑝</ci></apply><apply id="A1.p1.5.m5.5.5.1.cmml" xref="A1.p1.5.m5.5.5.1"><minus id="A1.p1.5.m5.5.5.1.2.cmml" xref="A1.p1.5.m5.5.5.1.2"></minus><apply id="A1.p1.5.m5.5.5.1.1.2.cmml" xref="A1.p1.5.m5.5.5.1.1.1"><ci id="A1.p1.5.m5.4.4.cmml" xref="A1.p1.5.m5.4.4">KL</ci><apply id="A1.p1.5.m5.5.5.1.1.1.1.1.cmml" xref="A1.p1.5.m5.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A1.p1.5.m5.5.5.1.1.1.1.1.1.cmml" xref="A1.p1.5.m5.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="A1.p1.5.m5.5.5.1.1.1.1.1.2.cmml" xref="A1.p1.5.m5.5.5.1.1.1.1.1.2">𝑞</ci><ci id="A1.p1.5.m5.5.5.1.1.1.1.1.3.cmml" xref="A1.p1.5.m5.5.5.1.1.1.1.1.3">𝑝</ci></apply></apply><ci id="A1.p1.5.m5.5.5.1.3.cmml" xref="A1.p1.5.m5.5.5.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.5c">h_{q,c}(p)=\operatorname{KL}(q\|p)-c</annotation></semantics></math>. Then <math id="A1.p1.6.m6.3" class="ltx_Math" alttext="h_{q,c}^{\prime}(p)=\frac{1-q}{1-p}-\frac{q}{p}" display="inline"><semantics id="A1.p1.6.m6.3a"><mrow id="A1.p1.6.m6.3.4" xref="A1.p1.6.m6.3.4.cmml"><mrow id="A1.p1.6.m6.3.4.2" xref="A1.p1.6.m6.3.4.2.cmml"><msubsup id="A1.p1.6.m6.3.4.2.2" xref="A1.p1.6.m6.3.4.2.2.cmml"><mi id="A1.p1.6.m6.3.4.2.2.2.2" xref="A1.p1.6.m6.3.4.2.2.2.2.cmml">h</mi><mrow id="A1.p1.6.m6.2.2.2.4" xref="A1.p1.6.m6.2.2.2.3.cmml"><mi id="A1.p1.6.m6.1.1.1.1" xref="A1.p1.6.m6.1.1.1.1.cmml">q</mi><mo id="A1.p1.6.m6.2.2.2.4.1" xref="A1.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="A1.p1.6.m6.2.2.2.2" xref="A1.p1.6.m6.2.2.2.2.cmml">c</mi></mrow><mo id="A1.p1.6.m6.3.4.2.2.3" xref="A1.p1.6.m6.3.4.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.p1.6.m6.3.4.2.1" xref="A1.p1.6.m6.3.4.2.1.cmml">​</mo><mrow id="A1.p1.6.m6.3.4.2.3.2" xref="A1.p1.6.m6.3.4.2.cmml"><mo stretchy="false" id="A1.p1.6.m6.3.4.2.3.2.1" xref="A1.p1.6.m6.3.4.2.cmml">(</mo><mi id="A1.p1.6.m6.3.3" xref="A1.p1.6.m6.3.3.cmml">p</mi><mo stretchy="false" id="A1.p1.6.m6.3.4.2.3.2.2" xref="A1.p1.6.m6.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.p1.6.m6.3.4.1" xref="A1.p1.6.m6.3.4.1.cmml">=</mo><mrow id="A1.p1.6.m6.3.4.3" xref="A1.p1.6.m6.3.4.3.cmml"><mfrac id="A1.p1.6.m6.3.4.3.2" xref="A1.p1.6.m6.3.4.3.2.cmml"><mrow id="A1.p1.6.m6.3.4.3.2.2" xref="A1.p1.6.m6.3.4.3.2.2.cmml"><mn id="A1.p1.6.m6.3.4.3.2.2.2" xref="A1.p1.6.m6.3.4.3.2.2.2.cmml">1</mn><mo id="A1.p1.6.m6.3.4.3.2.2.1" xref="A1.p1.6.m6.3.4.3.2.2.1.cmml">−</mo><mi id="A1.p1.6.m6.3.4.3.2.2.3" xref="A1.p1.6.m6.3.4.3.2.2.3.cmml">q</mi></mrow><mrow id="A1.p1.6.m6.3.4.3.2.3" xref="A1.p1.6.m6.3.4.3.2.3.cmml"><mn id="A1.p1.6.m6.3.4.3.2.3.2" xref="A1.p1.6.m6.3.4.3.2.3.2.cmml">1</mn><mo id="A1.p1.6.m6.3.4.3.2.3.1" xref="A1.p1.6.m6.3.4.3.2.3.1.cmml">−</mo><mi id="A1.p1.6.m6.3.4.3.2.3.3" xref="A1.p1.6.m6.3.4.3.2.3.3.cmml">p</mi></mrow></mfrac><mo id="A1.p1.6.m6.3.4.3.1" xref="A1.p1.6.m6.3.4.3.1.cmml">−</mo><mfrac id="A1.p1.6.m6.3.4.3.3" xref="A1.p1.6.m6.3.4.3.3.cmml"><mi id="A1.p1.6.m6.3.4.3.3.2" xref="A1.p1.6.m6.3.4.3.3.2.cmml">q</mi><mi id="A1.p1.6.m6.3.4.3.3.3" xref="A1.p1.6.m6.3.4.3.3.3.cmml">p</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.3b"><apply id="A1.p1.6.m6.3.4.cmml" xref="A1.p1.6.m6.3.4"><eq id="A1.p1.6.m6.3.4.1.cmml" xref="A1.p1.6.m6.3.4.1"></eq><apply id="A1.p1.6.m6.3.4.2.cmml" xref="A1.p1.6.m6.3.4.2"><times id="A1.p1.6.m6.3.4.2.1.cmml" xref="A1.p1.6.m6.3.4.2.1"></times><apply id="A1.p1.6.m6.3.4.2.2.cmml" xref="A1.p1.6.m6.3.4.2.2"><csymbol cd="ambiguous" id="A1.p1.6.m6.3.4.2.2.1.cmml" xref="A1.p1.6.m6.3.4.2.2">superscript</csymbol><apply id="A1.p1.6.m6.3.4.2.2.2.cmml" xref="A1.p1.6.m6.3.4.2.2"><csymbol cd="ambiguous" id="A1.p1.6.m6.3.4.2.2.2.1.cmml" xref="A1.p1.6.m6.3.4.2.2">subscript</csymbol><ci id="A1.p1.6.m6.3.4.2.2.2.2.cmml" xref="A1.p1.6.m6.3.4.2.2.2.2">ℎ</ci><list id="A1.p1.6.m6.2.2.2.3.cmml" xref="A1.p1.6.m6.2.2.2.4"><ci id="A1.p1.6.m6.1.1.1.1.cmml" xref="A1.p1.6.m6.1.1.1.1">𝑞</ci><ci id="A1.p1.6.m6.2.2.2.2.cmml" xref="A1.p1.6.m6.2.2.2.2">𝑐</ci></list></apply><ci id="A1.p1.6.m6.3.4.2.2.3.cmml" xref="A1.p1.6.m6.3.4.2.2.3">′</ci></apply><ci id="A1.p1.6.m6.3.3.cmml" xref="A1.p1.6.m6.3.3">𝑝</ci></apply><apply id="A1.p1.6.m6.3.4.3.cmml" xref="A1.p1.6.m6.3.4.3"><minus id="A1.p1.6.m6.3.4.3.1.cmml" xref="A1.p1.6.m6.3.4.3.1"></minus><apply id="A1.p1.6.m6.3.4.3.2.cmml" xref="A1.p1.6.m6.3.4.3.2"><divide id="A1.p1.6.m6.3.4.3.2.1.cmml" xref="A1.p1.6.m6.3.4.3.2"></divide><apply id="A1.p1.6.m6.3.4.3.2.2.cmml" xref="A1.p1.6.m6.3.4.3.2.2"><minus id="A1.p1.6.m6.3.4.3.2.2.1.cmml" xref="A1.p1.6.m6.3.4.3.2.2.1"></minus><cn type="integer" id="A1.p1.6.m6.3.4.3.2.2.2.cmml" xref="A1.p1.6.m6.3.4.3.2.2.2">1</cn><ci id="A1.p1.6.m6.3.4.3.2.2.3.cmml" xref="A1.p1.6.m6.3.4.3.2.2.3">𝑞</ci></apply><apply id="A1.p1.6.m6.3.4.3.2.3.cmml" xref="A1.p1.6.m6.3.4.3.2.3"><minus id="A1.p1.6.m6.3.4.3.2.3.1.cmml" xref="A1.p1.6.m6.3.4.3.2.3.1"></minus><cn type="integer" id="A1.p1.6.m6.3.4.3.2.3.2.cmml" xref="A1.p1.6.m6.3.4.3.2.3.2">1</cn><ci id="A1.p1.6.m6.3.4.3.2.3.3.cmml" xref="A1.p1.6.m6.3.4.3.2.3.3">𝑝</ci></apply></apply><apply id="A1.p1.6.m6.3.4.3.3.cmml" xref="A1.p1.6.m6.3.4.3.3"><divide id="A1.p1.6.m6.3.4.3.3.1.cmml" xref="A1.p1.6.m6.3.4.3.3"></divide><ci id="A1.p1.6.m6.3.4.3.3.2.cmml" xref="A1.p1.6.m6.3.4.3.3.2">𝑞</ci><ci id="A1.p1.6.m6.3.4.3.3.3.cmml" xref="A1.p1.6.m6.3.4.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.3c">h_{q,c}^{\prime}(p)=\frac{1-q}{1-p}-\frac{q}{p}</annotation></semantics></math>. Assuming we possess a good anough initial estimate <math id="A1.p1.7.m7.1" class="ltx_Math" alttext="p_{0}" display="inline"><semantics id="A1.p1.7.m7.1a"><msub id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml"><mi id="A1.p1.7.m7.1.1.2" xref="A1.p1.7.m7.1.1.2.cmml">p</mi><mn id="A1.p1.7.m7.1.1.3" xref="A1.p1.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><apply id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.p1.7.m7.1.1.1.cmml" xref="A1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.p1.7.m7.1.1.2.cmml" xref="A1.p1.7.m7.1.1.2">𝑝</ci><cn type="integer" id="A1.p1.7.m7.1.1.3.cmml" xref="A1.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">p_{0}</annotation></semantics></math> of a root of <math id="A1.p1.8.m8.3" class="ltx_Math" alttext="h_{q,c}(\cdot)" display="inline"><semantics id="A1.p1.8.m8.3a"><mrow id="A1.p1.8.m8.3.4" xref="A1.p1.8.m8.3.4.cmml"><msub id="A1.p1.8.m8.3.4.2" xref="A1.p1.8.m8.3.4.2.cmml"><mi id="A1.p1.8.m8.3.4.2.2" xref="A1.p1.8.m8.3.4.2.2.cmml">h</mi><mrow id="A1.p1.8.m8.2.2.2.4" xref="A1.p1.8.m8.2.2.2.3.cmml"><mi id="A1.p1.8.m8.1.1.1.1" xref="A1.p1.8.m8.1.1.1.1.cmml">q</mi><mo id="A1.p1.8.m8.2.2.2.4.1" xref="A1.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="A1.p1.8.m8.2.2.2.2" xref="A1.p1.8.m8.2.2.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.p1.8.m8.3.4.1" xref="A1.p1.8.m8.3.4.1.cmml">​</mo><mrow id="A1.p1.8.m8.3.4.3.2" xref="A1.p1.8.m8.3.4.cmml"><mo stretchy="false" id="A1.p1.8.m8.3.4.3.2.1" xref="A1.p1.8.m8.3.4.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.p1.8.m8.3.3" xref="A1.p1.8.m8.3.3.cmml">⋅</mo><mo stretchy="false" id="A1.p1.8.m8.3.4.3.2.2" xref="A1.p1.8.m8.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.3b"><apply id="A1.p1.8.m8.3.4.cmml" xref="A1.p1.8.m8.3.4"><times id="A1.p1.8.m8.3.4.1.cmml" xref="A1.p1.8.m8.3.4.1"></times><apply id="A1.p1.8.m8.3.4.2.cmml" xref="A1.p1.8.m8.3.4.2"><csymbol cd="ambiguous" id="A1.p1.8.m8.3.4.2.1.cmml" xref="A1.p1.8.m8.3.4.2">subscript</csymbol><ci id="A1.p1.8.m8.3.4.2.2.cmml" xref="A1.p1.8.m8.3.4.2.2">ℎ</ci><list id="A1.p1.8.m8.2.2.2.3.cmml" xref="A1.p1.8.m8.2.2.2.4"><ci id="A1.p1.8.m8.1.1.1.1.cmml" xref="A1.p1.8.m8.1.1.1.1">𝑞</ci><ci id="A1.p1.8.m8.2.2.2.2.cmml" xref="A1.p1.8.m8.2.2.2.2">𝑐</ci></list></apply><ci id="A1.p1.8.m8.3.3.cmml" xref="A1.p1.8.m8.3.3">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.3c">h_{q,c}(\cdot)</annotation></semantics></math>, we can obtain improved estimates of a root via Newton’s method:</p>
<table id="A1.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex3.m1.12" class="ltx_Math" alttext="p_{n+1}=\mathrm{N}\left(p_{n};q,c\right)\text{ where }\mathrm{N}(p;q,c)=p-\frac{h_{q,c}(c)}{h_{q,c}^{\prime}(p)}\text{. }" display="block"><semantics id="A1.Ex3.m1.12a"><mrow id="A1.Ex3.m1.12.12" xref="A1.Ex3.m1.12.12.cmml"><msub id="A1.Ex3.m1.12.12.3" xref="A1.Ex3.m1.12.12.3.cmml"><mi id="A1.Ex3.m1.12.12.3.2" xref="A1.Ex3.m1.12.12.3.2.cmml">p</mi><mrow id="A1.Ex3.m1.12.12.3.3" xref="A1.Ex3.m1.12.12.3.3.cmml"><mi id="A1.Ex3.m1.12.12.3.3.2" xref="A1.Ex3.m1.12.12.3.3.2.cmml">n</mi><mo id="A1.Ex3.m1.12.12.3.3.1" xref="A1.Ex3.m1.12.12.3.3.1.cmml">+</mo><mn id="A1.Ex3.m1.12.12.3.3.3" xref="A1.Ex3.m1.12.12.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.Ex3.m1.12.12.4" xref="A1.Ex3.m1.12.12.4.cmml">=</mo><mrow id="A1.Ex3.m1.12.12.1" xref="A1.Ex3.m1.12.12.1.cmml"><mi mathvariant="normal" id="A1.Ex3.m1.12.12.1.3" xref="A1.Ex3.m1.12.12.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.12.12.1.2" xref="A1.Ex3.m1.12.12.1.2.cmml">​</mo><mrow id="A1.Ex3.m1.12.12.1.1.1" xref="A1.Ex3.m1.12.12.1.1.2.cmml"><mo id="A1.Ex3.m1.12.12.1.1.1.2" xref="A1.Ex3.m1.12.12.1.1.2.cmml">(</mo><msub id="A1.Ex3.m1.12.12.1.1.1.1" xref="A1.Ex3.m1.12.12.1.1.1.1.cmml"><mi id="A1.Ex3.m1.12.12.1.1.1.1.2" xref="A1.Ex3.m1.12.12.1.1.1.1.2.cmml">p</mi><mi id="A1.Ex3.m1.12.12.1.1.1.1.3" xref="A1.Ex3.m1.12.12.1.1.1.1.3.cmml">n</mi></msub><mo id="A1.Ex3.m1.12.12.1.1.1.3" xref="A1.Ex3.m1.12.12.1.1.2.cmml">;</mo><mi id="A1.Ex3.m1.7.7" xref="A1.Ex3.m1.7.7.cmml">q</mi><mo id="A1.Ex3.m1.12.12.1.1.1.4" xref="A1.Ex3.m1.12.12.1.1.2.cmml">,</mo><mi id="A1.Ex3.m1.8.8" xref="A1.Ex3.m1.8.8.cmml">c</mi><mo id="A1.Ex3.m1.12.12.1.1.1.5" xref="A1.Ex3.m1.12.12.1.1.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.12.12.1.2a" xref="A1.Ex3.m1.12.12.1.2.cmml">​</mo><mtext id="A1.Ex3.m1.12.12.1.4" xref="A1.Ex3.m1.12.12.1.4a.cmml"> where </mtext><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.12.12.1.2b" xref="A1.Ex3.m1.12.12.1.2.cmml">​</mo><mi mathvariant="normal" id="A1.Ex3.m1.12.12.1.5" xref="A1.Ex3.m1.12.12.1.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.12.12.1.2c" xref="A1.Ex3.m1.12.12.1.2.cmml">​</mo><mrow id="A1.Ex3.m1.12.12.1.6.2" xref="A1.Ex3.m1.12.12.1.6.1.cmml"><mo stretchy="false" id="A1.Ex3.m1.12.12.1.6.2.1" xref="A1.Ex3.m1.12.12.1.6.1.cmml">(</mo><mi id="A1.Ex3.m1.9.9" xref="A1.Ex3.m1.9.9.cmml">p</mi><mo id="A1.Ex3.m1.12.12.1.6.2.2" xref="A1.Ex3.m1.12.12.1.6.1.cmml">;</mo><mi id="A1.Ex3.m1.10.10" xref="A1.Ex3.m1.10.10.cmml">q</mi><mo id="A1.Ex3.m1.12.12.1.6.2.3" xref="A1.Ex3.m1.12.12.1.6.1.cmml">,</mo><mi id="A1.Ex3.m1.11.11" xref="A1.Ex3.m1.11.11.cmml">c</mi><mo stretchy="false" id="A1.Ex3.m1.12.12.1.6.2.4" xref="A1.Ex3.m1.12.12.1.6.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex3.m1.12.12.5" xref="A1.Ex3.m1.12.12.5.cmml">=</mo><mrow id="A1.Ex3.m1.12.12.6" xref="A1.Ex3.m1.12.12.6.cmml"><mi id="A1.Ex3.m1.12.12.6.2" xref="A1.Ex3.m1.12.12.6.2.cmml">p</mi><mo id="A1.Ex3.m1.12.12.6.1" xref="A1.Ex3.m1.12.12.6.1.cmml">−</mo><mrow id="A1.Ex3.m1.12.12.6.3" xref="A1.Ex3.m1.12.12.6.3.cmml"><mfrac id="A1.Ex3.m1.6.6" xref="A1.Ex3.m1.6.6.cmml"><mrow id="A1.Ex3.m1.3.3.3" xref="A1.Ex3.m1.3.3.3.cmml"><msub id="A1.Ex3.m1.3.3.3.5" xref="A1.Ex3.m1.3.3.3.5.cmml"><mi id="A1.Ex3.m1.3.3.3.5.2" xref="A1.Ex3.m1.3.3.3.5.2.cmml">h</mi><mrow id="A1.Ex3.m1.2.2.2.2.2.4" xref="A1.Ex3.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.cmml">q</mi><mo id="A1.Ex3.m1.2.2.2.2.2.4.1" xref="A1.Ex3.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.Ex3.m1.2.2.2.2.2.2" xref="A1.Ex3.m1.2.2.2.2.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.3.3.3.4" xref="A1.Ex3.m1.3.3.3.4.cmml">​</mo><mrow id="A1.Ex3.m1.3.3.3.6.2" xref="A1.Ex3.m1.3.3.3.cmml"><mo stretchy="false" id="A1.Ex3.m1.3.3.3.6.2.1" xref="A1.Ex3.m1.3.3.3.cmml">(</mo><mi id="A1.Ex3.m1.3.3.3.3" xref="A1.Ex3.m1.3.3.3.3.cmml">c</mi><mo stretchy="false" id="A1.Ex3.m1.3.3.3.6.2.2" xref="A1.Ex3.m1.3.3.3.cmml">)</mo></mrow></mrow><mrow id="A1.Ex3.m1.6.6.6" xref="A1.Ex3.m1.6.6.6.cmml"><msubsup id="A1.Ex3.m1.6.6.6.5" xref="A1.Ex3.m1.6.6.6.5.cmml"><mi id="A1.Ex3.m1.6.6.6.5.2.2" xref="A1.Ex3.m1.6.6.6.5.2.2.cmml">h</mi><mrow id="A1.Ex3.m1.5.5.5.2.2.4" xref="A1.Ex3.m1.5.5.5.2.2.3.cmml"><mi id="A1.Ex3.m1.4.4.4.1.1.1" xref="A1.Ex3.m1.4.4.4.1.1.1.cmml">q</mi><mo id="A1.Ex3.m1.5.5.5.2.2.4.1" xref="A1.Ex3.m1.5.5.5.2.2.3.cmml">,</mo><mi id="A1.Ex3.m1.5.5.5.2.2.2" xref="A1.Ex3.m1.5.5.5.2.2.2.cmml">c</mi></mrow><mo id="A1.Ex3.m1.6.6.6.5.3" xref="A1.Ex3.m1.6.6.6.5.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.6.6.6.4" xref="A1.Ex3.m1.6.6.6.4.cmml">​</mo><mrow id="A1.Ex3.m1.6.6.6.6.2" xref="A1.Ex3.m1.6.6.6.cmml"><mo stretchy="false" id="A1.Ex3.m1.6.6.6.6.2.1" xref="A1.Ex3.m1.6.6.6.cmml">(</mo><mi id="A1.Ex3.m1.6.6.6.3" xref="A1.Ex3.m1.6.6.6.3.cmml">p</mi><mo stretchy="false" id="A1.Ex3.m1.6.6.6.6.2.2" xref="A1.Ex3.m1.6.6.6.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex3.m1.12.12.6.3.1" xref="A1.Ex3.m1.12.12.6.3.1.cmml">​</mo><mtext id="A1.Ex3.m1.12.12.6.3.2" xref="A1.Ex3.m1.12.12.6.3.2a.cmml">. </mtext></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.12b"><apply id="A1.Ex3.m1.12.12.cmml" xref="A1.Ex3.m1.12.12"><and id="A1.Ex3.m1.12.12a.cmml" xref="A1.Ex3.m1.12.12"></and><apply id="A1.Ex3.m1.12.12b.cmml" xref="A1.Ex3.m1.12.12"><eq id="A1.Ex3.m1.12.12.4.cmml" xref="A1.Ex3.m1.12.12.4"></eq><apply id="A1.Ex3.m1.12.12.3.cmml" xref="A1.Ex3.m1.12.12.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.12.12.3.1.cmml" xref="A1.Ex3.m1.12.12.3">subscript</csymbol><ci id="A1.Ex3.m1.12.12.3.2.cmml" xref="A1.Ex3.m1.12.12.3.2">𝑝</ci><apply id="A1.Ex3.m1.12.12.3.3.cmml" xref="A1.Ex3.m1.12.12.3.3"><plus id="A1.Ex3.m1.12.12.3.3.1.cmml" xref="A1.Ex3.m1.12.12.3.3.1"></plus><ci id="A1.Ex3.m1.12.12.3.3.2.cmml" xref="A1.Ex3.m1.12.12.3.3.2">𝑛</ci><cn type="integer" id="A1.Ex3.m1.12.12.3.3.3.cmml" xref="A1.Ex3.m1.12.12.3.3.3">1</cn></apply></apply><apply id="A1.Ex3.m1.12.12.1.cmml" xref="A1.Ex3.m1.12.12.1"><times id="A1.Ex3.m1.12.12.1.2.cmml" xref="A1.Ex3.m1.12.12.1.2"></times><ci id="A1.Ex3.m1.12.12.1.3.cmml" xref="A1.Ex3.m1.12.12.1.3">N</ci><list id="A1.Ex3.m1.12.12.1.1.2.cmml" xref="A1.Ex3.m1.12.12.1.1.1"><apply id="A1.Ex3.m1.12.12.1.1.1.1.cmml" xref="A1.Ex3.m1.12.12.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex3.m1.12.12.1.1.1.1.1.cmml" xref="A1.Ex3.m1.12.12.1.1.1.1">subscript</csymbol><ci id="A1.Ex3.m1.12.12.1.1.1.1.2.cmml" xref="A1.Ex3.m1.12.12.1.1.1.1.2">𝑝</ci><ci id="A1.Ex3.m1.12.12.1.1.1.1.3.cmml" xref="A1.Ex3.m1.12.12.1.1.1.1.3">𝑛</ci></apply><ci id="A1.Ex3.m1.7.7.cmml" xref="A1.Ex3.m1.7.7">𝑞</ci><ci id="A1.Ex3.m1.8.8.cmml" xref="A1.Ex3.m1.8.8">𝑐</ci></list><ci id="A1.Ex3.m1.12.12.1.4a.cmml" xref="A1.Ex3.m1.12.12.1.4"><mtext id="A1.Ex3.m1.12.12.1.4.cmml" xref="A1.Ex3.m1.12.12.1.4"> where </mtext></ci><ci id="A1.Ex3.m1.12.12.1.5.cmml" xref="A1.Ex3.m1.12.12.1.5">N</ci><list id="A1.Ex3.m1.12.12.1.6.1.cmml" xref="A1.Ex3.m1.12.12.1.6.2"><ci id="A1.Ex3.m1.9.9.cmml" xref="A1.Ex3.m1.9.9">𝑝</ci><ci id="A1.Ex3.m1.10.10.cmml" xref="A1.Ex3.m1.10.10">𝑞</ci><ci id="A1.Ex3.m1.11.11.cmml" xref="A1.Ex3.m1.11.11">𝑐</ci></list></apply></apply><apply id="A1.Ex3.m1.12.12c.cmml" xref="A1.Ex3.m1.12.12"><eq id="A1.Ex3.m1.12.12.5.cmml" xref="A1.Ex3.m1.12.12.5"></eq><share href="#A1.Ex3.m1.12.12.1.cmml" id="A1.Ex3.m1.12.12d.cmml" xref="A1.Ex3.m1.12.12"></share><apply id="A1.Ex3.m1.12.12.6.cmml" xref="A1.Ex3.m1.12.12.6"><minus id="A1.Ex3.m1.12.12.6.1.cmml" xref="A1.Ex3.m1.12.12.6.1"></minus><ci id="A1.Ex3.m1.12.12.6.2.cmml" xref="A1.Ex3.m1.12.12.6.2">𝑝</ci><apply id="A1.Ex3.m1.12.12.6.3.cmml" xref="A1.Ex3.m1.12.12.6.3"><times id="A1.Ex3.m1.12.12.6.3.1.cmml" xref="A1.Ex3.m1.12.12.6.3.1"></times><apply id="A1.Ex3.m1.6.6.cmml" xref="A1.Ex3.m1.6.6"><divide id="A1.Ex3.m1.6.6.7.cmml" xref="A1.Ex3.m1.6.6"></divide><apply id="A1.Ex3.m1.3.3.3.cmml" xref="A1.Ex3.m1.3.3.3"><times id="A1.Ex3.m1.3.3.3.4.cmml" xref="A1.Ex3.m1.3.3.3.4"></times><apply id="A1.Ex3.m1.3.3.3.5.cmml" xref="A1.Ex3.m1.3.3.3.5"><csymbol cd="ambiguous" id="A1.Ex3.m1.3.3.3.5.1.cmml" xref="A1.Ex3.m1.3.3.3.5">subscript</csymbol><ci id="A1.Ex3.m1.3.3.3.5.2.cmml" xref="A1.Ex3.m1.3.3.3.5.2">ℎ</ci><list id="A1.Ex3.m1.2.2.2.2.2.3.cmml" xref="A1.Ex3.m1.2.2.2.2.2.4"><ci id="A1.Ex3.m1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1">𝑞</ci><ci id="A1.Ex3.m1.2.2.2.2.2.2.cmml" xref="A1.Ex3.m1.2.2.2.2.2.2">𝑐</ci></list></apply><ci id="A1.Ex3.m1.3.3.3.3.cmml" xref="A1.Ex3.m1.3.3.3.3">𝑐</ci></apply><apply id="A1.Ex3.m1.6.6.6.cmml" xref="A1.Ex3.m1.6.6.6"><times id="A1.Ex3.m1.6.6.6.4.cmml" xref="A1.Ex3.m1.6.6.6.4"></times><apply id="A1.Ex3.m1.6.6.6.5.cmml" xref="A1.Ex3.m1.6.6.6.5"><csymbol cd="ambiguous" id="A1.Ex3.m1.6.6.6.5.1.cmml" xref="A1.Ex3.m1.6.6.6.5">superscript</csymbol><apply id="A1.Ex3.m1.6.6.6.5.2.cmml" xref="A1.Ex3.m1.6.6.6.5"><csymbol cd="ambiguous" id="A1.Ex3.m1.6.6.6.5.2.1.cmml" xref="A1.Ex3.m1.6.6.6.5">subscript</csymbol><ci id="A1.Ex3.m1.6.6.6.5.2.2.cmml" xref="A1.Ex3.m1.6.6.6.5.2.2">ℎ</ci><list id="A1.Ex3.m1.5.5.5.2.2.3.cmml" xref="A1.Ex3.m1.5.5.5.2.2.4"><ci id="A1.Ex3.m1.4.4.4.1.1.1.cmml" xref="A1.Ex3.m1.4.4.4.1.1.1">𝑞</ci><ci id="A1.Ex3.m1.5.5.5.2.2.2.cmml" xref="A1.Ex3.m1.5.5.5.2.2.2">𝑐</ci></list></apply><ci id="A1.Ex3.m1.6.6.6.5.3.cmml" xref="A1.Ex3.m1.6.6.6.5.3">′</ci></apply><ci id="A1.Ex3.m1.6.6.6.3.cmml" xref="A1.Ex3.m1.6.6.6.3">𝑝</ci></apply></apply><ci id="A1.Ex3.m1.12.12.6.3.2a.cmml" xref="A1.Ex3.m1.12.12.6.3.2"><mtext id="A1.Ex3.m1.12.12.6.3.2.cmml" xref="A1.Ex3.m1.12.12.6.3.2">. </mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.12c">p_{n+1}=\mathrm{N}\left(p_{n};q,c\right)\text{ where }\mathrm{N}(p;q,c)=p-\frac{h_{q,c}(c)}{h_{q,c}^{\prime}(p)}\text{. }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.p1.13" class="ltx_p">This suggests the following approximation to <math id="A1.p1.9.m1.1" class="ltx_Math" alttext="\mathrm{kL}^{-1}(q\mid c)" display="inline"><semantics id="A1.p1.9.m1.1a"><mrow id="A1.p1.9.m1.1.1" xref="A1.p1.9.m1.1.1.cmml"><msup id="A1.p1.9.m1.1.1.3" xref="A1.p1.9.m1.1.1.3.cmml"><mi id="A1.p1.9.m1.1.1.3.2" xref="A1.p1.9.m1.1.1.3.2.cmml">kL</mi><mrow id="A1.p1.9.m1.1.1.3.3" xref="A1.p1.9.m1.1.1.3.3.cmml"><mo id="A1.p1.9.m1.1.1.3.3a" xref="A1.p1.9.m1.1.1.3.3.cmml">−</mo><mn id="A1.p1.9.m1.1.1.3.3.2" xref="A1.p1.9.m1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="A1.p1.9.m1.1.1.2" xref="A1.p1.9.m1.1.1.2.cmml">​</mo><mrow id="A1.p1.9.m1.1.1.1.1" xref="A1.p1.9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.p1.9.m1.1.1.1.1.2" xref="A1.p1.9.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.p1.9.m1.1.1.1.1.1" xref="A1.p1.9.m1.1.1.1.1.1.cmml"><mi id="A1.p1.9.m1.1.1.1.1.1.2" xref="A1.p1.9.m1.1.1.1.1.1.2.cmml">q</mi><mo id="A1.p1.9.m1.1.1.1.1.1.1" xref="A1.p1.9.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="A1.p1.9.m1.1.1.1.1.1.3" xref="A1.p1.9.m1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="A1.p1.9.m1.1.1.1.1.3" xref="A1.p1.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.9.m1.1b"><apply id="A1.p1.9.m1.1.1.cmml" xref="A1.p1.9.m1.1.1"><times id="A1.p1.9.m1.1.1.2.cmml" xref="A1.p1.9.m1.1.1.2"></times><apply id="A1.p1.9.m1.1.1.3.cmml" xref="A1.p1.9.m1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.9.m1.1.1.3.1.cmml" xref="A1.p1.9.m1.1.1.3">superscript</csymbol><ci id="A1.p1.9.m1.1.1.3.2.cmml" xref="A1.p1.9.m1.1.1.3.2">kL</ci><apply id="A1.p1.9.m1.1.1.3.3.cmml" xref="A1.p1.9.m1.1.1.3.3"><minus id="A1.p1.9.m1.1.1.3.3.1.cmml" xref="A1.p1.9.m1.1.1.3.3"></minus><cn type="integer" id="A1.p1.9.m1.1.1.3.3.2.cmml" xref="A1.p1.9.m1.1.1.3.3.2">1</cn></apply></apply><apply id="A1.p1.9.m1.1.1.1.1.1.cmml" xref="A1.p1.9.m1.1.1.1.1"><csymbol cd="latexml" id="A1.p1.9.m1.1.1.1.1.1.1.cmml" xref="A1.p1.9.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.p1.9.m1.1.1.1.1.1.2.cmml" xref="A1.p1.9.m1.1.1.1.1.1.2">𝑞</ci><ci id="A1.p1.9.m1.1.1.1.1.1.3.cmml" xref="A1.p1.9.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m1.1c">\mathrm{kL}^{-1}(q\mid c)</annotation></semantics></math> :
1. Let <math id="A1.p1.10.m2.1" class="ltx_Math" alttext="\tilde{b}=q+\sqrt{\frac{c}{2}}" display="inline"><semantics id="A1.p1.10.m2.1a"><mrow id="A1.p1.10.m2.1.1" xref="A1.p1.10.m2.1.1.cmml"><mover accent="true" id="A1.p1.10.m2.1.1.2" xref="A1.p1.10.m2.1.1.2.cmml"><mi id="A1.p1.10.m2.1.1.2.2" xref="A1.p1.10.m2.1.1.2.2.cmml">b</mi><mo id="A1.p1.10.m2.1.1.2.1" xref="A1.p1.10.m2.1.1.2.1.cmml">~</mo></mover><mo id="A1.p1.10.m2.1.1.1" xref="A1.p1.10.m2.1.1.1.cmml">=</mo><mrow id="A1.p1.10.m2.1.1.3" xref="A1.p1.10.m2.1.1.3.cmml"><mi id="A1.p1.10.m2.1.1.3.2" xref="A1.p1.10.m2.1.1.3.2.cmml">q</mi><mo id="A1.p1.10.m2.1.1.3.1" xref="A1.p1.10.m2.1.1.3.1.cmml">+</mo><msqrt id="A1.p1.10.m2.1.1.3.3" xref="A1.p1.10.m2.1.1.3.3.cmml"><mfrac id="A1.p1.10.m2.1.1.3.3.2" xref="A1.p1.10.m2.1.1.3.3.2.cmml"><mi id="A1.p1.10.m2.1.1.3.3.2.2" xref="A1.p1.10.m2.1.1.3.3.2.2.cmml">c</mi><mn id="A1.p1.10.m2.1.1.3.3.2.3" xref="A1.p1.10.m2.1.1.3.3.2.3.cmml">2</mn></mfrac></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.10.m2.1b"><apply id="A1.p1.10.m2.1.1.cmml" xref="A1.p1.10.m2.1.1"><eq id="A1.p1.10.m2.1.1.1.cmml" xref="A1.p1.10.m2.1.1.1"></eq><apply id="A1.p1.10.m2.1.1.2.cmml" xref="A1.p1.10.m2.1.1.2"><ci id="A1.p1.10.m2.1.1.2.1.cmml" xref="A1.p1.10.m2.1.1.2.1">~</ci><ci id="A1.p1.10.m2.1.1.2.2.cmml" xref="A1.p1.10.m2.1.1.2.2">𝑏</ci></apply><apply id="A1.p1.10.m2.1.1.3.cmml" xref="A1.p1.10.m2.1.1.3"><plus id="A1.p1.10.m2.1.1.3.1.cmml" xref="A1.p1.10.m2.1.1.3.1"></plus><ci id="A1.p1.10.m2.1.1.3.2.cmml" xref="A1.p1.10.m2.1.1.3.2">𝑞</ci><apply id="A1.p1.10.m2.1.1.3.3.cmml" xref="A1.p1.10.m2.1.1.3.3"><root id="A1.p1.10.m2.1.1.3.3a.cmml" xref="A1.p1.10.m2.1.1.3.3"></root><apply id="A1.p1.10.m2.1.1.3.3.2.cmml" xref="A1.p1.10.m2.1.1.3.3.2"><divide id="A1.p1.10.m2.1.1.3.3.2.1.cmml" xref="A1.p1.10.m2.1.1.3.3.2"></divide><ci id="A1.p1.10.m2.1.1.3.3.2.2.cmml" xref="A1.p1.10.m2.1.1.3.3.2.2">𝑐</ci><cn type="integer" id="A1.p1.10.m2.1.1.3.3.2.3.cmml" xref="A1.p1.10.m2.1.1.3.3.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m2.1c">\tilde{b}=q+\sqrt{\frac{c}{2}}</annotation></semantics></math>.
2. If <math id="A1.p1.11.m3.1" class="ltx_Math" alttext="\tilde{b}\geq 1" display="inline"><semantics id="A1.p1.11.m3.1a"><mrow id="A1.p1.11.m3.1.1" xref="A1.p1.11.m3.1.1.cmml"><mover accent="true" id="A1.p1.11.m3.1.1.2" xref="A1.p1.11.m3.1.1.2.cmml"><mi id="A1.p1.11.m3.1.1.2.2" xref="A1.p1.11.m3.1.1.2.2.cmml">b</mi><mo id="A1.p1.11.m3.1.1.2.1" xref="A1.p1.11.m3.1.1.2.1.cmml">~</mo></mover><mo id="A1.p1.11.m3.1.1.1" xref="A1.p1.11.m3.1.1.1.cmml">≥</mo><mn id="A1.p1.11.m3.1.1.3" xref="A1.p1.11.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.11.m3.1b"><apply id="A1.p1.11.m3.1.1.cmml" xref="A1.p1.11.m3.1.1"><geq id="A1.p1.11.m3.1.1.1.cmml" xref="A1.p1.11.m3.1.1.1"></geq><apply id="A1.p1.11.m3.1.1.2.cmml" xref="A1.p1.11.m3.1.1.2"><ci id="A1.p1.11.m3.1.1.2.1.cmml" xref="A1.p1.11.m3.1.1.2.1">~</ci><ci id="A1.p1.11.m3.1.1.2.2.cmml" xref="A1.p1.11.m3.1.1.2.2">𝑏</ci></apply><cn type="integer" id="A1.p1.11.m3.1.1.3.cmml" xref="A1.p1.11.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m3.1c">\tilde{b}\geq 1</annotation></semantics></math>, then return 1 .
3. Otherwise, return <math id="A1.p1.12.m4.1" class="ltx_Math" alttext="\mathrm{N}^{k}(\tilde{b})" display="inline"><semantics id="A1.p1.12.m4.1a"><mrow id="A1.p1.12.m4.1.2" xref="A1.p1.12.m4.1.2.cmml"><msup id="A1.p1.12.m4.1.2.2" xref="A1.p1.12.m4.1.2.2.cmml"><mi mathvariant="normal" id="A1.p1.12.m4.1.2.2.2" xref="A1.p1.12.m4.1.2.2.2.cmml">N</mi><mi id="A1.p1.12.m4.1.2.2.3" xref="A1.p1.12.m4.1.2.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="A1.p1.12.m4.1.2.1" xref="A1.p1.12.m4.1.2.1.cmml">​</mo><mrow id="A1.p1.12.m4.1.2.3.2" xref="A1.p1.12.m4.1.1.cmml"><mo stretchy="false" id="A1.p1.12.m4.1.2.3.2.1" xref="A1.p1.12.m4.1.1.cmml">(</mo><mover accent="true" id="A1.p1.12.m4.1.1" xref="A1.p1.12.m4.1.1.cmml"><mi id="A1.p1.12.m4.1.1.2" xref="A1.p1.12.m4.1.1.2.cmml">b</mi><mo id="A1.p1.12.m4.1.1.1" xref="A1.p1.12.m4.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="A1.p1.12.m4.1.2.3.2.2" xref="A1.p1.12.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.12.m4.1b"><apply id="A1.p1.12.m4.1.2.cmml" xref="A1.p1.12.m4.1.2"><times id="A1.p1.12.m4.1.2.1.cmml" xref="A1.p1.12.m4.1.2.1"></times><apply id="A1.p1.12.m4.1.2.2.cmml" xref="A1.p1.12.m4.1.2.2"><csymbol cd="ambiguous" id="A1.p1.12.m4.1.2.2.1.cmml" xref="A1.p1.12.m4.1.2.2">superscript</csymbol><ci id="A1.p1.12.m4.1.2.2.2.cmml" xref="A1.p1.12.m4.1.2.2.2">N</ci><ci id="A1.p1.12.m4.1.2.2.3.cmml" xref="A1.p1.12.m4.1.2.2.3">𝑘</ci></apply><apply id="A1.p1.12.m4.1.1.cmml" xref="A1.p1.12.m4.1.2.3.2"><ci id="A1.p1.12.m4.1.1.1.cmml" xref="A1.p1.12.m4.1.1.1">~</ci><ci id="A1.p1.12.m4.1.1.2.cmml" xref="A1.p1.12.m4.1.1.2">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.12.m4.1c">\mathrm{N}^{k}(\tilde{b})</annotation></semantics></math>, for some integer <math id="A1.p1.13.m5.1" class="ltx_Math" alttext="k&gt;0" display="inline"><semantics id="A1.p1.13.m5.1a"><mrow id="A1.p1.13.m5.1.1" xref="A1.p1.13.m5.1.1.cmml"><mi id="A1.p1.13.m5.1.1.2" xref="A1.p1.13.m5.1.1.2.cmml">k</mi><mo id="A1.p1.13.m5.1.1.1" xref="A1.p1.13.m5.1.1.1.cmml">&gt;</mo><mn id="A1.p1.13.m5.1.1.3" xref="A1.p1.13.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.13.m5.1b"><apply id="A1.p1.13.m5.1.1.cmml" xref="A1.p1.13.m5.1.1"><gt id="A1.p1.13.m5.1.1.1.cmml" xref="A1.p1.13.m5.1.1.1"></gt><ci id="A1.p1.13.m5.1.1.2.cmml" xref="A1.p1.13.m5.1.1.2">𝑘</ci><cn type="integer" id="A1.p1.13.m5.1.1.3.cmml" xref="A1.p1.13.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.13.m5.1c">k&gt;0</annotation></semantics></math>.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional details for <a href="#S3.SS2" title="3.2 GenFL for personalised federated learning ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>
</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">We provide here more details about the procedures of <a href="#S3.SS2" title="3.2 GenFL for personalised federated learning ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<section id="A2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">PAC-Bayes learning objectives</h5>

<div id="A2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px1.p1.3" class="ltx_p">As stated in the main documents, our learning objectives here are mainly similar to those in <a href="#S3.E8" title="In 3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equations</span> <span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S3.Ex2" title="3.1 GenFL for FL-SOB ‣ 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>. At the variation that now, the KL divergence is regularised by <math id="A2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="A2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">m</mi><mi id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑚</ci><ci id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.1.m1.1c">m_{i}</annotation></semantics></math> for the user <math id="A2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.2.m2.1c">i</annotation></semantics></math> instead of the common <math id="A2.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="A2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.3.m3.1c">m</annotation></semantics></math>. This comes from the fact that now, each user does not try to optimise proxys of a common global generalisation goal but only its personal McAllester bound, depending only on its data.</p>
</div>
<div id="A2.SS0.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<table id="A3.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle f_{1}(\mathcal{S}_{i})" display="inline"><semantics id="A2.Ex4.m1.1a"><mrow id="A2.Ex4.m1.1.1" xref="A2.Ex4.m1.1.1.cmml"><msub id="A2.Ex4.m1.1.1.3" xref="A2.Ex4.m1.1.1.3.cmml"><mi id="A2.Ex4.m1.1.1.3.2" xref="A2.Ex4.m1.1.1.3.2.cmml">f</mi><mn id="A2.Ex4.m1.1.1.3.3" xref="A2.Ex4.m1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.1.1.2" xref="A2.Ex4.m1.1.1.2.cmml">​</mo><mrow id="A2.Ex4.m1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex4.m1.1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex4.m1.1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="A2.Ex4.m1.1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex4.m1.1b"><apply id="A2.Ex4.m1.1.1.cmml" xref="A2.Ex4.m1.1.1"><times id="A2.Ex4.m1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.2"></times><apply id="A2.Ex4.m1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.3.1.cmml" xref="A2.Ex4.m1.1.1.3">subscript</csymbol><ci id="A2.Ex4.m1.1.1.3.2.cmml" xref="A2.Ex4.m1.1.1.3.2">𝑓</ci><cn type="integer" id="A2.Ex4.m1.1.1.3.3.cmml" xref="A2.Ex4.m1.1.1.3.3">1</cn></apply><apply id="A2.Ex4.m1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.2">𝒮</ci><ci id="A2.Ex4.m1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex4.m1.1c">\displaystyle f_{1}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex4.m2.3" class="ltx_Math" alttext="\displaystyle=\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m_{i}}}{\delta}}}{2m_{i}}}" display="inline"><semantics id="A2.Ex4.m2.3a"><mrow id="A2.Ex4.m2.3.4" xref="A2.Ex4.m2.3.4.cmml"><mi id="A2.Ex4.m2.3.4.2" xref="A2.Ex4.m2.3.4.2.cmml"></mi><mo id="A2.Ex4.m2.3.4.1" xref="A2.Ex4.m2.3.4.1.cmml">=</mo><mrow id="A2.Ex4.m2.3.4.3" xref="A2.Ex4.m2.3.4.3.cmml"><mrow id="A2.Ex4.m2.3.4.3.2" xref="A2.Ex4.m2.3.4.3.2.cmml"><msub id="A2.Ex4.m2.3.4.3.2.2" xref="A2.Ex4.m2.3.4.3.2.2.cmml"><mover accent="true" id="A2.Ex4.m2.3.4.3.2.2.2" xref="A2.Ex4.m2.3.4.3.2.2.2.cmml"><mtext id="A2.Ex4.m2.3.4.3.2.2.2.2" xref="A2.Ex4.m2.3.4.3.2.2.2.2a.cmml">R</mtext><mo id="A2.Ex4.m2.3.4.3.2.2.2.1" xref="A2.Ex4.m2.3.4.3.2.2.2.1.cmml">^</mo></mover><msub id="A2.Ex4.m2.3.4.3.2.2.3" xref="A2.Ex4.m2.3.4.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex4.m2.3.4.3.2.2.3.2" xref="A2.Ex4.m2.3.4.3.2.2.3.2.cmml">𝒮</mi><mi id="A2.Ex4.m2.3.4.3.2.2.3.3" xref="A2.Ex4.m2.3.4.3.2.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.3.4.3.2.1" xref="A2.Ex4.m2.3.4.3.2.1.cmml">​</mo><mrow id="A2.Ex4.m2.3.4.3.2.3.2" xref="A2.Ex4.m2.3.4.3.2.cmml"><mo stretchy="false" id="A2.Ex4.m2.3.4.3.2.3.2.1" xref="A2.Ex4.m2.3.4.3.2.cmml">(</mo><mi id="A2.Ex4.m2.3.3" xref="A2.Ex4.m2.3.3.cmml">Q</mi><mo stretchy="false" id="A2.Ex4.m2.3.4.3.2.3.2.2" xref="A2.Ex4.m2.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="A2.Ex4.m2.3.4.3.1" xref="A2.Ex4.m2.3.4.3.1.cmml">+</mo><msqrt id="A2.Ex4.m2.2.2" xref="A2.Ex4.m2.2.2.cmml"><mstyle displaystyle="true" id="A2.Ex4.m2.2.2.2" xref="A2.Ex4.m2.2.2.2.cmml"><mfrac id="A2.Ex4.m2.2.2.2a" xref="A2.Ex4.m2.2.2.2.cmml"><mrow id="A2.Ex4.m2.2.2.2.2.2" xref="A2.Ex4.m2.2.2.2.2.2.cmml"><mrow id="A2.Ex4.m2.2.2.2.2.2.2.1" xref="A2.Ex4.m2.2.2.2.2.2.2.2.cmml"><mi id="A2.Ex4.m2.1.1.1.1.1.1" xref="A2.Ex4.m2.1.1.1.1.1.1.cmml">KL</mi><mo id="A2.Ex4.m2.2.2.2.2.2.2.1a" xref="A2.Ex4.m2.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="A2.Ex4.m2.2.2.2.2.2.2.1.1" xref="A2.Ex4.m2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="A2.Ex4.m2.2.2.2.2.2.2.1.1.2" xref="A2.Ex4.m2.2.2.2.2.2.2.2.cmml">(</mo><mrow id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.cmml"><mi id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.2" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.1" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.1.cmml">∥</mo><mi id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.3" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="A2.Ex4.m2.2.2.2.2.2.2.1.1.3" xref="A2.Ex4.m2.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A2.Ex4.m2.2.2.2.2.2.3" xref="A2.Ex4.m2.2.2.2.2.2.3.cmml">+</mo><mrow id="A2.Ex4.m2.2.2.2.2.2.4" xref="A2.Ex4.m2.2.2.2.2.2.4.cmml"><mi id="A2.Ex4.m2.2.2.2.2.2.4.1" xref="A2.Ex4.m2.2.2.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="A2.Ex4.m2.2.2.2.2.2.4a" xref="A2.Ex4.m2.2.2.2.2.2.4.cmml">⁡</mo><mfrac id="A2.Ex4.m2.2.2.2.2.2.4.2" xref="A2.Ex4.m2.2.2.2.2.2.4.2.cmml"><mrow id="A2.Ex4.m2.2.2.2.2.2.4.2.2" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.cmml"><mn id="A2.Ex4.m2.2.2.2.2.2.4.2.2.2" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.2.2.2.2.2.4.2.2.1" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.cmml"><msub id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.cmml"><mi id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.2" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.2.cmml">m</mi><mi id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.3" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.3.cmml">i</mi></msub></msqrt></mrow><mi id="A2.Ex4.m2.2.2.2.2.2.4.2.3" xref="A2.Ex4.m2.2.2.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mrow id="A2.Ex4.m2.2.2.2.4" xref="A2.Ex4.m2.2.2.2.4.cmml"><mn id="A2.Ex4.m2.2.2.2.4.2" xref="A2.Ex4.m2.2.2.2.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex4.m2.2.2.2.4.1" xref="A2.Ex4.m2.2.2.2.4.1.cmml">​</mo><msub id="A2.Ex4.m2.2.2.2.4.3" xref="A2.Ex4.m2.2.2.2.4.3.cmml"><mi id="A2.Ex4.m2.2.2.2.4.3.2" xref="A2.Ex4.m2.2.2.2.4.3.2.cmml">m</mi><mi id="A2.Ex4.m2.2.2.2.4.3.3" xref="A2.Ex4.m2.2.2.2.4.3.3.cmml">i</mi></msub></mrow></mfrac></mstyle></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex4.m2.3b"><apply id="A2.Ex4.m2.3.4.cmml" xref="A2.Ex4.m2.3.4"><eq id="A2.Ex4.m2.3.4.1.cmml" xref="A2.Ex4.m2.3.4.1"></eq><csymbol cd="latexml" id="A2.Ex4.m2.3.4.2.cmml" xref="A2.Ex4.m2.3.4.2">absent</csymbol><apply id="A2.Ex4.m2.3.4.3.cmml" xref="A2.Ex4.m2.3.4.3"><plus id="A2.Ex4.m2.3.4.3.1.cmml" xref="A2.Ex4.m2.3.4.3.1"></plus><apply id="A2.Ex4.m2.3.4.3.2.cmml" xref="A2.Ex4.m2.3.4.3.2"><times id="A2.Ex4.m2.3.4.3.2.1.cmml" xref="A2.Ex4.m2.3.4.3.2.1"></times><apply id="A2.Ex4.m2.3.4.3.2.2.cmml" xref="A2.Ex4.m2.3.4.3.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m2.3.4.3.2.2.1.cmml" xref="A2.Ex4.m2.3.4.3.2.2">subscript</csymbol><apply id="A2.Ex4.m2.3.4.3.2.2.2.cmml" xref="A2.Ex4.m2.3.4.3.2.2.2"><ci id="A2.Ex4.m2.3.4.3.2.2.2.1.cmml" xref="A2.Ex4.m2.3.4.3.2.2.2.1">^</ci><ci id="A2.Ex4.m2.3.4.3.2.2.2.2a.cmml" xref="A2.Ex4.m2.3.4.3.2.2.2.2"><mtext id="A2.Ex4.m2.3.4.3.2.2.2.2.cmml" xref="A2.Ex4.m2.3.4.3.2.2.2.2">R</mtext></ci></apply><apply id="A2.Ex4.m2.3.4.3.2.2.3.cmml" xref="A2.Ex4.m2.3.4.3.2.2.3"><csymbol cd="ambiguous" id="A2.Ex4.m2.3.4.3.2.2.3.1.cmml" xref="A2.Ex4.m2.3.4.3.2.2.3">subscript</csymbol><ci id="A2.Ex4.m2.3.4.3.2.2.3.2.cmml" xref="A2.Ex4.m2.3.4.3.2.2.3.2">𝒮</ci><ci id="A2.Ex4.m2.3.4.3.2.2.3.3.cmml" xref="A2.Ex4.m2.3.4.3.2.2.3.3">𝑖</ci></apply></apply><ci id="A2.Ex4.m2.3.3.cmml" xref="A2.Ex4.m2.3.3">𝑄</ci></apply><apply id="A2.Ex4.m2.2.2.cmml" xref="A2.Ex4.m2.2.2"><root id="A2.Ex4.m2.2.2a.cmml" xref="A2.Ex4.m2.2.2"></root><apply id="A2.Ex4.m2.2.2.2.cmml" xref="A2.Ex4.m2.2.2.2"><divide id="A2.Ex4.m2.2.2.2.3.cmml" xref="A2.Ex4.m2.2.2.2"></divide><apply id="A2.Ex4.m2.2.2.2.2.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2"><plus id="A2.Ex4.m2.2.2.2.2.2.3.cmml" xref="A2.Ex4.m2.2.2.2.2.2.3"></plus><apply id="A2.Ex4.m2.2.2.2.2.2.2.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.2.1"><ci id="A2.Ex4.m2.1.1.1.1.1.1.cmml" xref="A2.Ex4.m2.1.1.1.1.1.1">KL</ci><apply id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.2">𝑄</ci><ci id="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.3.cmml" xref="A2.Ex4.m2.2.2.2.2.2.2.1.1.1.3">𝑃</ci></apply></apply><apply id="A2.Ex4.m2.2.2.2.2.2.4.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4"><ln id="A2.Ex4.m2.2.2.2.2.2.4.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.1"></ln><apply id="A2.Ex4.m2.2.2.2.2.2.4.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2"><divide id="A2.Ex4.m2.2.2.2.2.2.4.2.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2"></divide><apply id="A2.Ex4.m2.2.2.2.2.2.4.2.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2"><times id="A2.Ex4.m2.2.2.2.2.2.4.2.2.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.1"></times><cn type="integer" id="A2.Ex4.m2.2.2.2.2.2.4.2.2.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.2">2</cn><apply id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3"><root id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3a.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3"></root><apply id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2"><csymbol cd="ambiguous" id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.1.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2">subscript</csymbol><ci id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.2.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.2">𝑚</ci><ci id="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.3.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.2.3.2.3">𝑖</ci></apply></apply></apply><ci id="A2.Ex4.m2.2.2.2.2.2.4.2.3.cmml" xref="A2.Ex4.m2.2.2.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><apply id="A2.Ex4.m2.2.2.2.4.cmml" xref="A2.Ex4.m2.2.2.2.4"><times id="A2.Ex4.m2.2.2.2.4.1.cmml" xref="A2.Ex4.m2.2.2.2.4.1"></times><cn type="integer" id="A2.Ex4.m2.2.2.2.4.2.cmml" xref="A2.Ex4.m2.2.2.2.4.2">2</cn><apply id="A2.Ex4.m2.2.2.2.4.3.cmml" xref="A2.Ex4.m2.2.2.2.4.3"><csymbol cd="ambiguous" id="A2.Ex4.m2.2.2.2.4.3.1.cmml" xref="A2.Ex4.m2.2.2.2.4.3">subscript</csymbol><ci id="A2.Ex4.m2.2.2.2.4.3.2.cmml" xref="A2.Ex4.m2.2.2.2.4.3.2">𝑚</ci><ci id="A2.Ex4.m2.2.2.2.4.3.3.cmml" xref="A2.Ex4.m2.2.2.2.4.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex4.m2.3c">\displaystyle=\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m_{i}}}{\delta}}}{2m_{i}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle f_{2}(\mathcal{S}_{i})" display="inline"><semantics id="A2.Ex5.m1.1a"><mrow id="A2.Ex5.m1.1.1" xref="A2.Ex5.m1.1.1.cmml"><msub id="A2.Ex5.m1.1.1.3" xref="A2.Ex5.m1.1.1.3.cmml"><mi id="A2.Ex5.m1.1.1.3.2" xref="A2.Ex5.m1.1.1.3.2.cmml">f</mi><mn id="A2.Ex5.m1.1.1.3.3" xref="A2.Ex5.m1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m1.1.1.2" xref="A2.Ex5.m1.1.1.2.cmml">​</mo><mrow id="A2.Ex5.m1.1.1.1.1" xref="A2.Ex5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex5.m1.1.1.1.1.2" xref="A2.Ex5.m1.1.1.1.1.1.cmml">(</mo><msub id="A2.Ex5.m1.1.1.1.1.1" xref="A2.Ex5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m1.1.1.1.1.1.2" xref="A2.Ex5.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="A2.Ex5.m1.1.1.1.1.1.3" xref="A2.Ex5.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A2.Ex5.m1.1.1.1.1.3" xref="A2.Ex5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex5.m1.1b"><apply id="A2.Ex5.m1.1.1.cmml" xref="A2.Ex5.m1.1.1"><times id="A2.Ex5.m1.1.1.2.cmml" xref="A2.Ex5.m1.1.1.2"></times><apply id="A2.Ex5.m1.1.1.3.cmml" xref="A2.Ex5.m1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex5.m1.1.1.3.1.cmml" xref="A2.Ex5.m1.1.1.3">subscript</csymbol><ci id="A2.Ex5.m1.1.1.3.2.cmml" xref="A2.Ex5.m1.1.1.3.2">𝑓</ci><cn type="integer" id="A2.Ex5.m1.1.1.3.3.cmml" xref="A2.Ex5.m1.1.1.3.3">2</cn></apply><apply id="A2.Ex5.m1.1.1.1.1.1.cmml" xref="A2.Ex5.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.1.1.1.1.1.1.cmml" xref="A2.Ex5.m1.1.1.1.1">subscript</csymbol><ci id="A2.Ex5.m1.1.1.1.1.1.2.cmml" xref="A2.Ex5.m1.1.1.1.1.1.2">𝒮</ci><ci id="A2.Ex5.m1.1.1.1.1.1.3.cmml" xref="A2.Ex5.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m1.1c">\displaystyle f_{2}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex5.m2.9" class="ltx_Math" alttext="\displaystyle=\left(\sqrt{\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\frac{\mathrm{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m_{i}}}+\sqrt{\frac{\operatorname{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m_{i}}}\right)^{2}" display="inline"><semantics id="A2.Ex5.m2.9a"><mrow id="A2.Ex5.m2.9.9" xref="A2.Ex5.m2.9.9.cmml"><mi id="A2.Ex5.m2.9.9.3" xref="A2.Ex5.m2.9.9.3.cmml"></mi><mo id="A2.Ex5.m2.9.9.2" xref="A2.Ex5.m2.9.9.2.cmml">=</mo><msup id="A2.Ex5.m2.9.9.1" xref="A2.Ex5.m2.9.9.1.cmml"><mrow id="A2.Ex5.m2.9.9.1.1.1" xref="A2.Ex5.m2.9.9.1.1.1.1.cmml"><mo id="A2.Ex5.m2.9.9.1.1.1.2" xref="A2.Ex5.m2.9.9.1.1.1.1.cmml">(</mo><mrow id="A2.Ex5.m2.9.9.1.1.1.1" xref="A2.Ex5.m2.9.9.1.1.1.1.cmml"><msqrt id="A2.Ex5.m2.4.4" xref="A2.Ex5.m2.4.4.cmml"><mrow id="A2.Ex5.m2.4.4.4" xref="A2.Ex5.m2.4.4.4.cmml"><mrow id="A2.Ex5.m2.4.4.4.6" xref="A2.Ex5.m2.4.4.4.6.cmml"><msub id="A2.Ex5.m2.4.4.4.6.2" xref="A2.Ex5.m2.4.4.4.6.2.cmml"><mover accent="true" id="A2.Ex5.m2.4.4.4.6.2.2" xref="A2.Ex5.m2.4.4.4.6.2.2.cmml"><mtext id="A2.Ex5.m2.4.4.4.6.2.2.2" xref="A2.Ex5.m2.4.4.4.6.2.2.2a.cmml">R</mtext><mo id="A2.Ex5.m2.4.4.4.6.2.2.1" xref="A2.Ex5.m2.4.4.4.6.2.2.1.cmml">^</mo></mover><msub id="A2.Ex5.m2.4.4.4.6.2.3" xref="A2.Ex5.m2.4.4.4.6.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex5.m2.4.4.4.6.2.3.2" xref="A2.Ex5.m2.4.4.4.6.2.3.2.cmml">𝒮</mi><mi id="A2.Ex5.m2.4.4.4.6.2.3.3" xref="A2.Ex5.m2.4.4.4.6.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.4.4.4.6.1" xref="A2.Ex5.m2.4.4.4.6.1.cmml">​</mo><mrow id="A2.Ex5.m2.4.4.4.6.3.2" xref="A2.Ex5.m2.4.4.4.6.cmml"><mo stretchy="false" id="A2.Ex5.m2.4.4.4.6.3.2.1" xref="A2.Ex5.m2.4.4.4.6.cmml">(</mo><mi id="A2.Ex5.m2.4.4.4.4" xref="A2.Ex5.m2.4.4.4.4.cmml">Q</mi><mo stretchy="false" id="A2.Ex5.m2.4.4.4.6.3.2.2" xref="A2.Ex5.m2.4.4.4.6.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m2.4.4.4.5" xref="A2.Ex5.m2.4.4.4.5.cmml">+</mo><mstyle displaystyle="true" id="A2.Ex5.m2.3.3.3.3" xref="A2.Ex5.m2.3.3.3.3.cmml"><mfrac id="A2.Ex5.m2.3.3.3.3a" xref="A2.Ex5.m2.3.3.3.3.cmml"><mrow id="A2.Ex5.m2.3.3.3.3.3" xref="A2.Ex5.m2.3.3.3.3.3.cmml"><mrow id="A2.Ex5.m2.3.3.3.3.3.3" xref="A2.Ex5.m2.3.3.3.3.3.3.cmml"><mi id="A2.Ex5.m2.3.3.3.3.3.3.3" xref="A2.Ex5.m2.3.3.3.3.3.3.3.cmml">KL</mi><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.3.3.3.3.3.3.2" xref="A2.Ex5.m2.3.3.3.3.3.3.2.cmml">​</mo><mrow id="A2.Ex5.m2.3.3.3.3.3.3.1.1" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.cmml"><mo id="A2.Ex5.m2.3.3.3.3.3.3.1.1.2" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.cmml">(</mo><mrow id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.cmml"><mi id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.2" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.2.cmml">Q</mi><mo id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.1" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.1.cmml">∥</mo><mi id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.3" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.3.cmml">P</mi></mrow><mo id="A2.Ex5.m2.3.3.3.3.3.3.1.1.3" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m2.3.3.3.3.3.4" xref="A2.Ex5.m2.3.3.3.3.3.4.cmml">+</mo><mrow id="A2.Ex5.m2.3.3.3.3.3.5.2" xref="A2.Ex5.m2.3.3.3.3.3.5.1.cmml"><mi id="A2.Ex5.m2.1.1.1.1.1.1" xref="A2.Ex5.m2.1.1.1.1.1.1.cmml">log</mi><mo id="A2.Ex5.m2.3.3.3.3.3.5.2a" xref="A2.Ex5.m2.3.3.3.3.3.5.1.cmml">⁡</mo><mrow id="A2.Ex5.m2.3.3.3.3.3.5.2.1" xref="A2.Ex5.m2.3.3.3.3.3.5.1.cmml"><mo id="A2.Ex5.m2.3.3.3.3.3.5.2.1.1" xref="A2.Ex5.m2.3.3.3.3.3.5.1.cmml">(</mo><mfrac id="A2.Ex5.m2.2.2.2.2.2.2" xref="A2.Ex5.m2.2.2.2.2.2.2.cmml"><mrow id="A2.Ex5.m2.2.2.2.2.2.2.2" xref="A2.Ex5.m2.2.2.2.2.2.2.2.cmml"><mn id="A2.Ex5.m2.2.2.2.2.2.2.2.2" xref="A2.Ex5.m2.2.2.2.2.2.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.2.2.2.2.2.2.2.1" xref="A2.Ex5.m2.2.2.2.2.2.2.2.1.cmml">​</mo><msqrt id="A2.Ex5.m2.2.2.2.2.2.2.2.3" xref="A2.Ex5.m2.2.2.2.2.2.2.2.3.cmml"><mi id="A2.Ex5.m2.2.2.2.2.2.2.2.3.2" xref="A2.Ex5.m2.2.2.2.2.2.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="A2.Ex5.m2.2.2.2.2.2.2.3" xref="A2.Ex5.m2.2.2.2.2.2.2.3.cmml">δ</mi></mfrac><mo id="A2.Ex5.m2.3.3.3.3.3.5.2.1.2" xref="A2.Ex5.m2.3.3.3.3.3.5.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.Ex5.m2.3.3.3.3.5" xref="A2.Ex5.m2.3.3.3.3.5.cmml"><mn id="A2.Ex5.m2.3.3.3.3.5.2" xref="A2.Ex5.m2.3.3.3.3.5.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.3.3.3.3.5.1" xref="A2.Ex5.m2.3.3.3.3.5.1.cmml">​</mo><msub id="A2.Ex5.m2.3.3.3.3.5.3" xref="A2.Ex5.m2.3.3.3.3.5.3.cmml"><mi id="A2.Ex5.m2.3.3.3.3.5.3.2" xref="A2.Ex5.m2.3.3.3.3.5.3.2.cmml">m</mi><mi id="A2.Ex5.m2.3.3.3.3.5.3.3" xref="A2.Ex5.m2.3.3.3.3.5.3.3.cmml">i</mi></msub></mrow></mfrac></mstyle></mrow></msqrt><mo id="A2.Ex5.m2.9.9.1.1.1.1.1" xref="A2.Ex5.m2.9.9.1.1.1.1.1.cmml">+</mo><msqrt id="A2.Ex5.m2.8.8" xref="A2.Ex5.m2.8.8.cmml"><mstyle displaystyle="true" id="A2.Ex5.m2.8.8.4" xref="A2.Ex5.m2.8.8.4.cmml"><mfrac id="A2.Ex5.m2.8.8.4a" xref="A2.Ex5.m2.8.8.4.cmml"><mrow id="A2.Ex5.m2.8.8.4.4.4" xref="A2.Ex5.m2.8.8.4.4.4.cmml"><mrow id="A2.Ex5.m2.8.8.4.4.4.4.1" xref="A2.Ex5.m2.8.8.4.4.4.4.2.cmml"><mi id="A2.Ex5.m2.5.5.1.1.1.1" xref="A2.Ex5.m2.5.5.1.1.1.1.cmml">KL</mi><mo id="A2.Ex5.m2.8.8.4.4.4.4.1a" xref="A2.Ex5.m2.8.8.4.4.4.4.2.cmml">⁡</mo><mrow id="A2.Ex5.m2.8.8.4.4.4.4.1.1" xref="A2.Ex5.m2.8.8.4.4.4.4.2.cmml"><mo id="A2.Ex5.m2.8.8.4.4.4.4.1.1.2" xref="A2.Ex5.m2.8.8.4.4.4.4.2.cmml">(</mo><mrow id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.cmml"><mi id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.2" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.2.cmml">Q</mi><mo id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.1" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.1.cmml">∥</mo><mi id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.3" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.3.cmml">P</mi></mrow><mo id="A2.Ex5.m2.8.8.4.4.4.4.1.1.3" xref="A2.Ex5.m2.8.8.4.4.4.4.2.cmml">)</mo></mrow></mrow><mo id="A2.Ex5.m2.8.8.4.4.4.5" xref="A2.Ex5.m2.8.8.4.4.4.5.cmml">+</mo><mrow id="A2.Ex5.m2.8.8.4.4.4.6.2" xref="A2.Ex5.m2.8.8.4.4.4.6.1.cmml"><mi id="A2.Ex5.m2.6.6.2.2.2.2" xref="A2.Ex5.m2.6.6.2.2.2.2.cmml">log</mi><mo id="A2.Ex5.m2.8.8.4.4.4.6.2a" xref="A2.Ex5.m2.8.8.4.4.4.6.1.cmml">⁡</mo><mrow id="A2.Ex5.m2.8.8.4.4.4.6.2.1" xref="A2.Ex5.m2.8.8.4.4.4.6.1.cmml"><mo id="A2.Ex5.m2.8.8.4.4.4.6.2.1.1" xref="A2.Ex5.m2.8.8.4.4.4.6.1.cmml">(</mo><mfrac id="A2.Ex5.m2.7.7.3.3.3.3" xref="A2.Ex5.m2.7.7.3.3.3.3.cmml"><mrow id="A2.Ex5.m2.7.7.3.3.3.3.2" xref="A2.Ex5.m2.7.7.3.3.3.3.2.cmml"><mn id="A2.Ex5.m2.7.7.3.3.3.3.2.2" xref="A2.Ex5.m2.7.7.3.3.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.7.7.3.3.3.3.2.1" xref="A2.Ex5.m2.7.7.3.3.3.3.2.1.cmml">​</mo><msqrt id="A2.Ex5.m2.7.7.3.3.3.3.2.3" xref="A2.Ex5.m2.7.7.3.3.3.3.2.3.cmml"><mi id="A2.Ex5.m2.7.7.3.3.3.3.2.3.2" xref="A2.Ex5.m2.7.7.3.3.3.3.2.3.2.cmml">m</mi></msqrt></mrow><mi id="A2.Ex5.m2.7.7.3.3.3.3.3" xref="A2.Ex5.m2.7.7.3.3.3.3.3.cmml">δ</mi></mfrac><mo id="A2.Ex5.m2.8.8.4.4.4.6.2.1.2" xref="A2.Ex5.m2.8.8.4.4.4.6.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.Ex5.m2.8.8.4.6" xref="A2.Ex5.m2.8.8.4.6.cmml"><mn id="A2.Ex5.m2.8.8.4.6.2" xref="A2.Ex5.m2.8.8.4.6.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.Ex5.m2.8.8.4.6.1" xref="A2.Ex5.m2.8.8.4.6.1.cmml">​</mo><msub id="A2.Ex5.m2.8.8.4.6.3" xref="A2.Ex5.m2.8.8.4.6.3.cmml"><mi id="A2.Ex5.m2.8.8.4.6.3.2" xref="A2.Ex5.m2.8.8.4.6.3.2.cmml">m</mi><mi id="A2.Ex5.m2.8.8.4.6.3.3" xref="A2.Ex5.m2.8.8.4.6.3.3.cmml">i</mi></msub></mrow></mfrac></mstyle></msqrt></mrow><mo id="A2.Ex5.m2.9.9.1.1.1.3" xref="A2.Ex5.m2.9.9.1.1.1.1.cmml">)</mo></mrow><mn id="A2.Ex5.m2.9.9.1.3" xref="A2.Ex5.m2.9.9.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex5.m2.9b"><apply id="A2.Ex5.m2.9.9.cmml" xref="A2.Ex5.m2.9.9"><eq id="A2.Ex5.m2.9.9.2.cmml" xref="A2.Ex5.m2.9.9.2"></eq><csymbol cd="latexml" id="A2.Ex5.m2.9.9.3.cmml" xref="A2.Ex5.m2.9.9.3">absent</csymbol><apply id="A2.Ex5.m2.9.9.1.cmml" xref="A2.Ex5.m2.9.9.1"><csymbol cd="ambiguous" id="A2.Ex5.m2.9.9.1.2.cmml" xref="A2.Ex5.m2.9.9.1">superscript</csymbol><apply id="A2.Ex5.m2.9.9.1.1.1.1.cmml" xref="A2.Ex5.m2.9.9.1.1.1"><plus id="A2.Ex5.m2.9.9.1.1.1.1.1.cmml" xref="A2.Ex5.m2.9.9.1.1.1.1.1"></plus><apply id="A2.Ex5.m2.4.4.cmml" xref="A2.Ex5.m2.4.4"><root id="A2.Ex5.m2.4.4a.cmml" xref="A2.Ex5.m2.4.4"></root><apply id="A2.Ex5.m2.4.4.4.cmml" xref="A2.Ex5.m2.4.4.4"><plus id="A2.Ex5.m2.4.4.4.5.cmml" xref="A2.Ex5.m2.4.4.4.5"></plus><apply id="A2.Ex5.m2.4.4.4.6.cmml" xref="A2.Ex5.m2.4.4.4.6"><times id="A2.Ex5.m2.4.4.4.6.1.cmml" xref="A2.Ex5.m2.4.4.4.6.1"></times><apply id="A2.Ex5.m2.4.4.4.6.2.cmml" xref="A2.Ex5.m2.4.4.4.6.2"><csymbol cd="ambiguous" id="A2.Ex5.m2.4.4.4.6.2.1.cmml" xref="A2.Ex5.m2.4.4.4.6.2">subscript</csymbol><apply id="A2.Ex5.m2.4.4.4.6.2.2.cmml" xref="A2.Ex5.m2.4.4.4.6.2.2"><ci id="A2.Ex5.m2.4.4.4.6.2.2.1.cmml" xref="A2.Ex5.m2.4.4.4.6.2.2.1">^</ci><ci id="A2.Ex5.m2.4.4.4.6.2.2.2a.cmml" xref="A2.Ex5.m2.4.4.4.6.2.2.2"><mtext id="A2.Ex5.m2.4.4.4.6.2.2.2.cmml" xref="A2.Ex5.m2.4.4.4.6.2.2.2">R</mtext></ci></apply><apply id="A2.Ex5.m2.4.4.4.6.2.3.cmml" xref="A2.Ex5.m2.4.4.4.6.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.4.4.4.6.2.3.1.cmml" xref="A2.Ex5.m2.4.4.4.6.2.3">subscript</csymbol><ci id="A2.Ex5.m2.4.4.4.6.2.3.2.cmml" xref="A2.Ex5.m2.4.4.4.6.2.3.2">𝒮</ci><ci id="A2.Ex5.m2.4.4.4.6.2.3.3.cmml" xref="A2.Ex5.m2.4.4.4.6.2.3.3">𝑖</ci></apply></apply><ci id="A2.Ex5.m2.4.4.4.4.cmml" xref="A2.Ex5.m2.4.4.4.4">𝑄</ci></apply><apply id="A2.Ex5.m2.3.3.3.3.cmml" xref="A2.Ex5.m2.3.3.3.3"><divide id="A2.Ex5.m2.3.3.3.3.4.cmml" xref="A2.Ex5.m2.3.3.3.3"></divide><apply id="A2.Ex5.m2.3.3.3.3.3.cmml" xref="A2.Ex5.m2.3.3.3.3.3"><plus id="A2.Ex5.m2.3.3.3.3.3.4.cmml" xref="A2.Ex5.m2.3.3.3.3.3.4"></plus><apply id="A2.Ex5.m2.3.3.3.3.3.3.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3"><times id="A2.Ex5.m2.3.3.3.3.3.3.2.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.2"></times><ci id="A2.Ex5.m2.3.3.3.3.3.3.3.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.3">KL</ci><apply id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1"><csymbol cd="latexml" id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.1.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.1">conditional</csymbol><ci id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.2.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.2">𝑄</ci><ci id="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.3.cmml" xref="A2.Ex5.m2.3.3.3.3.3.3.1.1.1.3">𝑃</ci></apply></apply><apply id="A2.Ex5.m2.3.3.3.3.3.5.1.cmml" xref="A2.Ex5.m2.3.3.3.3.3.5.2"><log id="A2.Ex5.m2.1.1.1.1.1.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1"></log><apply id="A2.Ex5.m2.2.2.2.2.2.2.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2"><divide id="A2.Ex5.m2.2.2.2.2.2.2.1.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2"></divide><apply id="A2.Ex5.m2.2.2.2.2.2.2.2.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2"><times id="A2.Ex5.m2.2.2.2.2.2.2.2.1.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2.1"></times><cn type="integer" id="A2.Ex5.m2.2.2.2.2.2.2.2.2.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2.2">2</cn><apply id="A2.Ex5.m2.2.2.2.2.2.2.2.3.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2.3"><root id="A2.Ex5.m2.2.2.2.2.2.2.2.3a.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2.3"></root><ci id="A2.Ex5.m2.2.2.2.2.2.2.2.3.2.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.2.3.2">𝑚</ci></apply></apply><ci id="A2.Ex5.m2.2.2.2.2.2.2.3.cmml" xref="A2.Ex5.m2.2.2.2.2.2.2.3">𝛿</ci></apply></apply></apply><apply id="A2.Ex5.m2.3.3.3.3.5.cmml" xref="A2.Ex5.m2.3.3.3.3.5"><times id="A2.Ex5.m2.3.3.3.3.5.1.cmml" xref="A2.Ex5.m2.3.3.3.3.5.1"></times><cn type="integer" id="A2.Ex5.m2.3.3.3.3.5.2.cmml" xref="A2.Ex5.m2.3.3.3.3.5.2">2</cn><apply id="A2.Ex5.m2.3.3.3.3.5.3.cmml" xref="A2.Ex5.m2.3.3.3.3.5.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.3.3.3.3.5.3.1.cmml" xref="A2.Ex5.m2.3.3.3.3.5.3">subscript</csymbol><ci id="A2.Ex5.m2.3.3.3.3.5.3.2.cmml" xref="A2.Ex5.m2.3.3.3.3.5.3.2">𝑚</ci><ci id="A2.Ex5.m2.3.3.3.3.5.3.3.cmml" xref="A2.Ex5.m2.3.3.3.3.5.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="A2.Ex5.m2.8.8.cmml" xref="A2.Ex5.m2.8.8"><root id="A2.Ex5.m2.8.8a.cmml" xref="A2.Ex5.m2.8.8"></root><apply id="A2.Ex5.m2.8.8.4.cmml" xref="A2.Ex5.m2.8.8.4"><divide id="A2.Ex5.m2.8.8.4.5.cmml" xref="A2.Ex5.m2.8.8.4"></divide><apply id="A2.Ex5.m2.8.8.4.4.4.cmml" xref="A2.Ex5.m2.8.8.4.4.4"><plus id="A2.Ex5.m2.8.8.4.4.4.5.cmml" xref="A2.Ex5.m2.8.8.4.4.4.5"></plus><apply id="A2.Ex5.m2.8.8.4.4.4.4.2.cmml" xref="A2.Ex5.m2.8.8.4.4.4.4.1"><ci id="A2.Ex5.m2.5.5.1.1.1.1.cmml" xref="A2.Ex5.m2.5.5.1.1.1.1">KL</ci><apply id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.cmml" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1"><csymbol cd="latexml" id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.1.cmml" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.1">conditional</csymbol><ci id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.2.cmml" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.2">𝑄</ci><ci id="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.3.cmml" xref="A2.Ex5.m2.8.8.4.4.4.4.1.1.1.3">𝑃</ci></apply></apply><apply id="A2.Ex5.m2.8.8.4.4.4.6.1.cmml" xref="A2.Ex5.m2.8.8.4.4.4.6.2"><log id="A2.Ex5.m2.6.6.2.2.2.2.cmml" xref="A2.Ex5.m2.6.6.2.2.2.2"></log><apply id="A2.Ex5.m2.7.7.3.3.3.3.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3"><divide id="A2.Ex5.m2.7.7.3.3.3.3.1.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3"></divide><apply id="A2.Ex5.m2.7.7.3.3.3.3.2.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2"><times id="A2.Ex5.m2.7.7.3.3.3.3.2.1.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2.1"></times><cn type="integer" id="A2.Ex5.m2.7.7.3.3.3.3.2.2.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2.2">2</cn><apply id="A2.Ex5.m2.7.7.3.3.3.3.2.3.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2.3"><root id="A2.Ex5.m2.7.7.3.3.3.3.2.3a.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2.3"></root><ci id="A2.Ex5.m2.7.7.3.3.3.3.2.3.2.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.2.3.2">𝑚</ci></apply></apply><ci id="A2.Ex5.m2.7.7.3.3.3.3.3.cmml" xref="A2.Ex5.m2.7.7.3.3.3.3.3">𝛿</ci></apply></apply></apply><apply id="A2.Ex5.m2.8.8.4.6.cmml" xref="A2.Ex5.m2.8.8.4.6"><times id="A2.Ex5.m2.8.8.4.6.1.cmml" xref="A2.Ex5.m2.8.8.4.6.1"></times><cn type="integer" id="A2.Ex5.m2.8.8.4.6.2.cmml" xref="A2.Ex5.m2.8.8.4.6.2">2</cn><apply id="A2.Ex5.m2.8.8.4.6.3.cmml" xref="A2.Ex5.m2.8.8.4.6.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.8.8.4.6.3.1.cmml" xref="A2.Ex5.m2.8.8.4.6.3">subscript</csymbol><ci id="A2.Ex5.m2.8.8.4.6.3.2.cmml" xref="A2.Ex5.m2.8.8.4.6.3.2">𝑚</ci><ci id="A2.Ex5.m2.8.8.4.6.3.3.cmml" xref="A2.Ex5.m2.8.8.4.6.3.3">𝑖</ci></apply></apply></apply></apply></apply><cn type="integer" id="A2.Ex5.m2.9.9.1.3.cmml" xref="A2.Ex5.m2.9.9.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m2.9c">\displaystyle=\left(\sqrt{\hat{\text{R}}_{\mathcal{S}_{i}}(Q)+\frac{\mathrm{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m_{i}}}+\sqrt{\frac{\operatorname{KL}\left(Q\|P\right)+\log\left(\frac{2\sqrt{m}}{\delta}\right)}{2m_{i}}}\right)^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="A2.SS0.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px1.p3.3" class="ltx_p">More precisely we state explicitly the personalised algorithm we use in <a href="#alg3" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">3</span></a>. This algorithm shows that each user sacrifices half of its data in phase 1 to learn jointly a prior through <span id="A2.SS0.SSS0.Px1.p3.3.1" class="ltx_text ltx_font_smallcaps">GenFL</span>. In phase 2, we re-use the ClientUpdate procedure of <a href="#alg1" title="In 3 GENERALISATION-DRIVEN FEDERATED LEARNING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Alg.</span> <span class="ltx_text ltx_ref_tag">1</span></a> to personalise the prior to each client through the PAC-Bayesian learning goal <math id="A2.SS0.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="A2.SS0.SSS0.Px1.p3.1.m1.1a"><mi id="A2.SS0.SSS0.Px1.p3.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p3.1.m1.1b"><ci id="A2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p3.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p3.1.m1.1c">f</annotation></semantics></math> (being <math id="A2.SS0.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p3.2.m2.1a"><msub id="A2.SS0.SSS0.Px1.p3.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.2" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1.2.cmml">f</mi><mn id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.3" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p3.2.m2.1b"><apply id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1.2">𝑓</ci><cn type="integer" id="A2.SS0.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p3.2.m2.1c">f_{1}</annotation></semantics></math> or <math id="A2.SS0.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p3.3.m3.1a"><msub id="A2.SS0.SSS0.Px1.p3.3.m3.1.1" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.2" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml">f</mi><mn id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.3" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p3.3.m3.1b"><apply id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1.2">𝑓</ci><cn type="integer" id="A2.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p3.3.m3.1c">f_{2}</annotation></semantics></math> in practice).</p>
</div>
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.12.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span>  PFL algorithm with PAC-Bayesian personalisation step. The K clients are indexed by k; B is the local minibatch size, E is the number of local epochs, <math id="alg3.6.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg3.6.m1.1b"><mi id="alg3.6.m1.1.1" xref="alg3.6.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg3.6.m1.1c"><ci id="alg3.6.m1.1.1.cmml" xref="alg3.6.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.6.m1.1d">\eta</annotation></semantics></math> is the learning rate <math id="alg3.7.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg3.7.m2.1b"><mi id="alg3.7.m2.1.1" xref="alg3.7.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg3.7.m2.1c"><ci id="alg3.7.m2.1.1.cmml" xref="alg3.7.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.7.m2.1d">f</annotation></semantics></math> PAC-Bayes objective, <math id="alg3.8.m3.1" class="ltx_Math" alttext="\mu_{\text{prior}}" display="inline"><semantics id="alg3.8.m3.1b"><msub id="alg3.8.m3.1.1" xref="alg3.8.m3.1.1.cmml"><mi id="alg3.8.m3.1.1.2" xref="alg3.8.m3.1.1.2.cmml">μ</mi><mtext id="alg3.8.m3.1.1.3" xref="alg3.8.m3.1.1.3a.cmml">prior</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.8.m3.1c"><apply id="alg3.8.m3.1.1.cmml" xref="alg3.8.m3.1.1"><csymbol cd="ambiguous" id="alg3.8.m3.1.1.1.cmml" xref="alg3.8.m3.1.1">subscript</csymbol><ci id="alg3.8.m3.1.1.2.cmml" xref="alg3.8.m3.1.1.2">𝜇</ci><ci id="alg3.8.m3.1.1.3a.cmml" xref="alg3.8.m3.1.1.3"><mtext mathsize="70%" id="alg3.8.m3.1.1.3.cmml" xref="alg3.8.m3.1.1.3">prior</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.8.m3.1d">\mu_{\text{prior}}</annotation></semantics></math> prior center parameters, <math id="alg3.9.m4.1" class="ltx_Math" alttext="\sigma_{\text{prior}}" display="inline"><semantics id="alg3.9.m4.1b"><msub id="alg3.9.m4.1.1" xref="alg3.9.m4.1.1.cmml"><mi id="alg3.9.m4.1.1.2" xref="alg3.9.m4.1.1.2.cmml">σ</mi><mtext id="alg3.9.m4.1.1.3" xref="alg3.9.m4.1.1.3a.cmml">prior</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.9.m4.1c"><apply id="alg3.9.m4.1.1.cmml" xref="alg3.9.m4.1.1"><csymbol cd="ambiguous" id="alg3.9.m4.1.1.1.cmml" xref="alg3.9.m4.1.1">subscript</csymbol><ci id="alg3.9.m4.1.1.2.cmml" xref="alg3.9.m4.1.1.2">𝜎</ci><ci id="alg3.9.m4.1.1.3a.cmml" xref="alg3.9.m4.1.1.3"><mtext mathsize="70%" id="alg3.9.m4.1.1.3.cmml" xref="alg3.9.m4.1.1.3">prior</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.9.m4.1d">\sigma_{\text{prior}}</annotation></semantics></math> prior scale hyper-parameter, <math id="alg3.10.m5.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg3.10.m5.1b"><mi id="alg3.10.m5.1.1" xref="alg3.10.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg3.10.m5.1c"><ci id="alg3.10.m5.1.1.cmml" xref="alg3.10.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.10.m5.1d">\delta</annotation></semantics></math> confidence parameter</figcaption>
<div id="alg3.13" class="ltx_listing ltx_listing">
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><math id="alg3.l1.m1.2" class="ltx_Math" alttext="w_{0}\leftarrow(\mu_{\text{prior}},\sigma_{\text{prior}})" display="inline"><semantics id="alg3.l1.m1.2a"><mrow id="alg3.l1.m1.2.2" xref="alg3.l1.m1.2.2.cmml"><msub id="alg3.l1.m1.2.2.4" xref="alg3.l1.m1.2.2.4.cmml"><mi id="alg3.l1.m1.2.2.4.2" xref="alg3.l1.m1.2.2.4.2.cmml">w</mi><mn id="alg3.l1.m1.2.2.4.3" xref="alg3.l1.m1.2.2.4.3.cmml">0</mn></msub><mo stretchy="false" id="alg3.l1.m1.2.2.3" xref="alg3.l1.m1.2.2.3.cmml">←</mo><mrow id="alg3.l1.m1.2.2.2.2" xref="alg3.l1.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg3.l1.m1.2.2.2.2.3" xref="alg3.l1.m1.2.2.2.3.cmml">(</mo><msub id="alg3.l1.m1.1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.1.cmml"><mi id="alg3.l1.m1.1.1.1.1.1.2" xref="alg3.l1.m1.1.1.1.1.1.2.cmml">μ</mi><mtext id="alg3.l1.m1.1.1.1.1.1.3" xref="alg3.l1.m1.1.1.1.1.1.3a.cmml">prior</mtext></msub><mo id="alg3.l1.m1.2.2.2.2.4" xref="alg3.l1.m1.2.2.2.3.cmml">,</mo><msub id="alg3.l1.m1.2.2.2.2.2" xref="alg3.l1.m1.2.2.2.2.2.cmml"><mi id="alg3.l1.m1.2.2.2.2.2.2" xref="alg3.l1.m1.2.2.2.2.2.2.cmml">σ</mi><mtext id="alg3.l1.m1.2.2.2.2.2.3" xref="alg3.l1.m1.2.2.2.2.2.3a.cmml">prior</mtext></msub><mo stretchy="false" id="alg3.l1.m1.2.2.2.2.5" xref="alg3.l1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.2b"><apply id="alg3.l1.m1.2.2.cmml" xref="alg3.l1.m1.2.2"><ci id="alg3.l1.m1.2.2.3.cmml" xref="alg3.l1.m1.2.2.3">←</ci><apply id="alg3.l1.m1.2.2.4.cmml" xref="alg3.l1.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l1.m1.2.2.4.1.cmml" xref="alg3.l1.m1.2.2.4">subscript</csymbol><ci id="alg3.l1.m1.2.2.4.2.cmml" xref="alg3.l1.m1.2.2.4.2">𝑤</ci><cn type="integer" id="alg3.l1.m1.2.2.4.3.cmml" xref="alg3.l1.m1.2.2.4.3">0</cn></apply><interval closure="open" id="alg3.l1.m1.2.2.2.3.cmml" xref="alg3.l1.m1.2.2.2.2"><apply id="alg3.l1.m1.1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l1.m1.1.1.1.1.1.2.cmml" xref="alg3.l1.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg3.l1.m1.1.1.1.1.1.3a.cmml" xref="alg3.l1.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg3.l1.m1.1.1.1.1.1.3.cmml" xref="alg3.l1.m1.1.1.1.1.1.3">prior</mtext></ci></apply><apply id="alg3.l1.m1.2.2.2.2.2.cmml" xref="alg3.l1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l1.m1.2.2.2.2.2.1.cmml" xref="alg3.l1.m1.2.2.2.2.2">subscript</csymbol><ci id="alg3.l1.m1.2.2.2.2.2.2.cmml" xref="alg3.l1.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg3.l1.m1.2.2.2.2.2.3a.cmml" xref="alg3.l1.m1.2.2.2.2.2.3"><mtext mathsize="70%" id="alg3.l1.m1.2.2.2.2.2.3.cmml" xref="alg3.l1.m1.2.2.2.2.2.3">prior</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.2c">w_{0}\leftarrow(\mu_{\text{prior}},\sigma_{\text{prior}})</annotation></semantics></math>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg3.l2.m1.2" class="ltx_Math" alttext="\forall k,\mathcal{S}_{k}=\mathcal{S}_{k}^{1}\cup\mathcal{S}_{k}^{2}" display="inline"><semantics id="alg3.l2.m1.2a"><mrow id="alg3.l2.m1.2.2" xref="alg3.l2.m1.2.2.cmml"><mrow id="alg3.l2.m1.2.2.2.2" xref="alg3.l2.m1.2.2.2.3.cmml"><mrow id="alg3.l2.m1.1.1.1.1.1" xref="alg3.l2.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="alg3.l2.m1.1.1.1.1.1.1" xref="alg3.l2.m1.1.1.1.1.1.1.cmml">∀</mo><mi id="alg3.l2.m1.1.1.1.1.1.2" xref="alg3.l2.m1.1.1.1.1.1.2.cmml">k</mi></mrow><mo id="alg3.l2.m1.2.2.2.2.3" xref="alg3.l2.m1.2.2.2.3.cmml">,</mo><msub id="alg3.l2.m1.2.2.2.2.2" xref="alg3.l2.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l2.m1.2.2.2.2.2.2" xref="alg3.l2.m1.2.2.2.2.2.2.cmml">𝒮</mi><mi id="alg3.l2.m1.2.2.2.2.2.3" xref="alg3.l2.m1.2.2.2.2.2.3.cmml">k</mi></msub></mrow><mo id="alg3.l2.m1.2.2.3" xref="alg3.l2.m1.2.2.3.cmml">=</mo><mrow id="alg3.l2.m1.2.2.4" xref="alg3.l2.m1.2.2.4.cmml"><msubsup id="alg3.l2.m1.2.2.4.2" xref="alg3.l2.m1.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l2.m1.2.2.4.2.2.2" xref="alg3.l2.m1.2.2.4.2.2.2.cmml">𝒮</mi><mi id="alg3.l2.m1.2.2.4.2.2.3" xref="alg3.l2.m1.2.2.4.2.2.3.cmml">k</mi><mn id="alg3.l2.m1.2.2.4.2.3" xref="alg3.l2.m1.2.2.4.2.3.cmml">1</mn></msubsup><mo id="alg3.l2.m1.2.2.4.1" xref="alg3.l2.m1.2.2.4.1.cmml">∪</mo><msubsup id="alg3.l2.m1.2.2.4.3" xref="alg3.l2.m1.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l2.m1.2.2.4.3.2.2" xref="alg3.l2.m1.2.2.4.3.2.2.cmml">𝒮</mi><mi id="alg3.l2.m1.2.2.4.3.2.3" xref="alg3.l2.m1.2.2.4.3.2.3.cmml">k</mi><mn id="alg3.l2.m1.2.2.4.3.3" xref="alg3.l2.m1.2.2.4.3.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.2b"><apply id="alg3.l2.m1.2.2.cmml" xref="alg3.l2.m1.2.2"><eq id="alg3.l2.m1.2.2.3.cmml" xref="alg3.l2.m1.2.2.3"></eq><list id="alg3.l2.m1.2.2.2.3.cmml" xref="alg3.l2.m1.2.2.2.2"><apply id="alg3.l2.m1.1.1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l2.m1.1.1.1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1.1.1.1">for-all</csymbol><ci id="alg3.l2.m1.1.1.1.1.1.2.cmml" xref="alg3.l2.m1.1.1.1.1.1.2">𝑘</ci></apply><apply id="alg3.l2.m1.2.2.2.2.2.cmml" xref="alg3.l2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l2.m1.2.2.2.2.2.1.cmml" xref="alg3.l2.m1.2.2.2.2.2">subscript</csymbol><ci id="alg3.l2.m1.2.2.2.2.2.2.cmml" xref="alg3.l2.m1.2.2.2.2.2.2">𝒮</ci><ci id="alg3.l2.m1.2.2.2.2.2.3.cmml" xref="alg3.l2.m1.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="alg3.l2.m1.2.2.4.cmml" xref="alg3.l2.m1.2.2.4"><union id="alg3.l2.m1.2.2.4.1.cmml" xref="alg3.l2.m1.2.2.4.1"></union><apply id="alg3.l2.m1.2.2.4.2.cmml" xref="alg3.l2.m1.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l2.m1.2.2.4.2.1.cmml" xref="alg3.l2.m1.2.2.4.2">superscript</csymbol><apply id="alg3.l2.m1.2.2.4.2.2.cmml" xref="alg3.l2.m1.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l2.m1.2.2.4.2.2.1.cmml" xref="alg3.l2.m1.2.2.4.2">subscript</csymbol><ci id="alg3.l2.m1.2.2.4.2.2.2.cmml" xref="alg3.l2.m1.2.2.4.2.2.2">𝒮</ci><ci id="alg3.l2.m1.2.2.4.2.2.3.cmml" xref="alg3.l2.m1.2.2.4.2.2.3">𝑘</ci></apply><cn type="integer" id="alg3.l2.m1.2.2.4.2.3.cmml" xref="alg3.l2.m1.2.2.4.2.3">1</cn></apply><apply id="alg3.l2.m1.2.2.4.3.cmml" xref="alg3.l2.m1.2.2.4.3"><csymbol cd="ambiguous" id="alg3.l2.m1.2.2.4.3.1.cmml" xref="alg3.l2.m1.2.2.4.3">superscript</csymbol><apply id="alg3.l2.m1.2.2.4.3.2.cmml" xref="alg3.l2.m1.2.2.4.3"><csymbol cd="ambiguous" id="alg3.l2.m1.2.2.4.3.2.1.cmml" xref="alg3.l2.m1.2.2.4.3">subscript</csymbol><ci id="alg3.l2.m1.2.2.4.3.2.2.cmml" xref="alg3.l2.m1.2.2.4.3.2.2">𝒮</ci><ci id="alg3.l2.m1.2.2.4.3.2.3.cmml" xref="alg3.l2.m1.2.2.4.3.2.3">𝑘</ci></apply><cn type="integer" id="alg3.l2.m1.2.2.4.3.3.cmml" xref="alg3.l2.m1.2.2.4.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.2c">\forall k,\mathcal{S}_{k}=\mathcal{S}_{k}^{1}\cup\mathcal{S}_{k}^{2}</annotation></semantics></math> <span id="alg3.l2.1" class="ltx_text" style="float:right;"><math id="alg3.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l2.1.m1.1a"><mo id="alg3.l2.1.m1.1.1" xref="alg3.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l2.1.m1.1b"><ci id="alg3.l2.1.m1.1.1.cmml" xref="alg3.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.1.m1.1c">\triangleright</annotation></semantics></math> splitting datasets in half
</span>
</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg3.l3.1" class="ltx_text ltx_font_bold">Step 1: learning the prior.</span>

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><math id="alg3.l4.m1.1" class="ltx_Math" alttext="\mathcal{S}_{\mathrm{P}}\leftarrow\cup_{k=1}^{K}\frac{1}{2}\mathcal{S}_{k}^{1}" display="inline"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><msub id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l4.m1.1.1.2.2" xref="alg3.l4.m1.1.1.2.2.cmml">𝒮</mi><mi mathvariant="normal" id="alg3.l4.m1.1.1.2.3" xref="alg3.l4.m1.1.1.2.3.cmml">P</mi></msub><mo rspace="0em" stretchy="false" id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">←</mo><mrow id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml"><msubsup id="alg3.l4.m1.1.1.3.1" xref="alg3.l4.m1.1.1.3.1.cmml"><mo lspace="0em" id="alg3.l4.m1.1.1.3.1.2.2" xref="alg3.l4.m1.1.1.3.1.2.2.cmml">∪</mo><mrow id="alg3.l4.m1.1.1.3.1.2.3" xref="alg3.l4.m1.1.1.3.1.2.3.cmml"><mi id="alg3.l4.m1.1.1.3.1.2.3.2" xref="alg3.l4.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg3.l4.m1.1.1.3.1.2.3.1" xref="alg3.l4.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg3.l4.m1.1.1.3.1.2.3.3" xref="alg3.l4.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg3.l4.m1.1.1.3.1.3" xref="alg3.l4.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg3.l4.m1.1.1.3.2" xref="alg3.l4.m1.1.1.3.2.cmml"><mfrac id="alg3.l4.m1.1.1.3.2.2" xref="alg3.l4.m1.1.1.3.2.2.cmml"><mn id="alg3.l4.m1.1.1.3.2.2.2" xref="alg3.l4.m1.1.1.3.2.2.2.cmml">1</mn><mn id="alg3.l4.m1.1.1.3.2.2.3" xref="alg3.l4.m1.1.1.3.2.2.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.3.2.1" xref="alg3.l4.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg3.l4.m1.1.1.3.2.3" xref="alg3.l4.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l4.m1.1.1.3.2.3.2.2" xref="alg3.l4.m1.1.1.3.2.3.2.2.cmml">𝒮</mi><mi id="alg3.l4.m1.1.1.3.2.3.2.3" xref="alg3.l4.m1.1.1.3.2.3.2.3.cmml">k</mi><mn id="alg3.l4.m1.1.1.3.2.3.3" xref="alg3.l4.m1.1.1.3.2.3.3.cmml">1</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><ci id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1">←</ci><apply id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.2.1.cmml" xref="alg3.l4.m1.1.1.2">subscript</csymbol><ci id="alg3.l4.m1.1.1.2.2.cmml" xref="alg3.l4.m1.1.1.2.2">𝒮</ci><ci id="alg3.l4.m1.1.1.2.3.cmml" xref="alg3.l4.m1.1.1.2.3">P</ci></apply><apply id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3"><apply id="alg3.l4.m1.1.1.3.1.cmml" xref="alg3.l4.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.1.1.cmml" xref="alg3.l4.m1.1.1.3.1">superscript</csymbol><apply id="alg3.l4.m1.1.1.3.1.2.cmml" xref="alg3.l4.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.1.2.1.cmml" xref="alg3.l4.m1.1.1.3.1">subscript</csymbol><union id="alg3.l4.m1.1.1.3.1.2.2.cmml" xref="alg3.l4.m1.1.1.3.1.2.2"></union><apply id="alg3.l4.m1.1.1.3.1.2.3.cmml" xref="alg3.l4.m1.1.1.3.1.2.3"><eq id="alg3.l4.m1.1.1.3.1.2.3.1.cmml" xref="alg3.l4.m1.1.1.3.1.2.3.1"></eq><ci id="alg3.l4.m1.1.1.3.1.2.3.2.cmml" xref="alg3.l4.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg3.l4.m1.1.1.3.1.2.3.3.cmml" xref="alg3.l4.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg3.l4.m1.1.1.3.1.3.cmml" xref="alg3.l4.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg3.l4.m1.1.1.3.2.cmml" xref="alg3.l4.m1.1.1.3.2"><times id="alg3.l4.m1.1.1.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.2.1"></times><apply id="alg3.l4.m1.1.1.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.2.2"><divide id="alg3.l4.m1.1.1.3.2.2.1.cmml" xref="alg3.l4.m1.1.1.3.2.2"></divide><cn type="integer" id="alg3.l4.m1.1.1.3.2.2.2.cmml" xref="alg3.l4.m1.1.1.3.2.2.2">1</cn><cn type="integer" id="alg3.l4.m1.1.1.3.2.2.3.cmml" xref="alg3.l4.m1.1.1.3.2.2.3">2</cn></apply><apply id="alg3.l4.m1.1.1.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.2.3.1.cmml" xref="alg3.l4.m1.1.1.3.2.3">superscript</csymbol><apply id="alg3.l4.m1.1.1.3.2.3.2.cmml" xref="alg3.l4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.2.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.2.3">subscript</csymbol><ci id="alg3.l4.m1.1.1.3.2.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.2.3.2.2">𝒮</ci><ci id="alg3.l4.m1.1.1.3.2.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.2.3.2.3">𝑘</ci></apply><cn type="integer" id="alg3.l4.m1.1.1.3.2.3.3.cmml" xref="alg3.l4.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\mathcal{S}_{\mathrm{P}}\leftarrow\cup_{k=1}^{K}\frac{1}{2}\mathcal{S}_{k}^{1}</annotation></semantics></math> <span id="alg3.l4.1" class="ltx_text" style="float:right;"><math id="alg3.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l4.1.m1.1a"><mo id="alg3.l4.1.m1.1.1" xref="alg3.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l4.1.m1.1b"><ci id="alg3.l4.1.m1.1.1.cmml" xref="alg3.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.1.m1.1c">\triangleright</annotation></semantics></math> each user involves half of its dataset.
</span>
</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span><math id="alg3.l5.m1.2" class="ltx_Math" alttext="\mu_{\mathrm{P}}\leftarrow\textsc{GenFL}(\mu_{prior},\mathcal{S}_{\mathrm{P}})" display="inline"><semantics id="alg3.l5.m1.2a"><mrow id="alg3.l5.m1.2.2" xref="alg3.l5.m1.2.2.cmml"><msub id="alg3.l5.m1.2.2.4" xref="alg3.l5.m1.2.2.4.cmml"><mi id="alg3.l5.m1.2.2.4.2" xref="alg3.l5.m1.2.2.4.2.cmml">μ</mi><mi mathvariant="normal" id="alg3.l5.m1.2.2.4.3" xref="alg3.l5.m1.2.2.4.3.cmml">P</mi></msub><mo stretchy="false" id="alg3.l5.m1.2.2.3" xref="alg3.l5.m1.2.2.3.cmml">←</mo><mrow id="alg3.l5.m1.2.2.2" xref="alg3.l5.m1.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg3.l5.m1.2.2.2.4" xref="alg3.l5.m1.2.2.2.4a.cmml">GenFL</mtext><mo lspace="0em" rspace="0em" id="alg3.l5.m1.2.2.2.3" xref="alg3.l5.m1.2.2.2.3.cmml">​</mo><mrow id="alg3.l5.m1.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg3.l5.m1.2.2.2.2.2.3" xref="alg3.l5.m1.2.2.2.2.3.cmml">(</mo><msub id="alg3.l5.m1.1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.1.2.cmml">μ</mi><mrow id="alg3.l5.m1.1.1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.1.3.2" xref="alg3.l5.m1.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.1.1.1.1.1.3.1" xref="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l5.m1.1.1.1.1.1.1.3.3" xref="alg3.l5.m1.1.1.1.1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.1.1.1.1.1.3.1a" xref="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l5.m1.1.1.1.1.1.1.3.4" xref="alg3.l5.m1.1.1.1.1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.1.1.1.1.1.3.1b" xref="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l5.m1.1.1.1.1.1.1.3.5" xref="alg3.l5.m1.1.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.1.1.1.1.1.3.1c" xref="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg3.l5.m1.1.1.1.1.1.1.3.6" xref="alg3.l5.m1.1.1.1.1.1.1.3.6.cmml">r</mi></mrow></msub><mo id="alg3.l5.m1.2.2.2.2.2.4" xref="alg3.l5.m1.2.2.2.2.3.cmml">,</mo><msub id="alg3.l5.m1.2.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l5.m1.2.2.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.2.2.2.cmml">𝒮</mi><mi mathvariant="normal" id="alg3.l5.m1.2.2.2.2.2.2.3" xref="alg3.l5.m1.2.2.2.2.2.2.3.cmml">P</mi></msub><mo stretchy="false" id="alg3.l5.m1.2.2.2.2.2.5" xref="alg3.l5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.2b"><apply id="alg3.l5.m1.2.2.cmml" xref="alg3.l5.m1.2.2"><ci id="alg3.l5.m1.2.2.3.cmml" xref="alg3.l5.m1.2.2.3">←</ci><apply id="alg3.l5.m1.2.2.4.cmml" xref="alg3.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.4.1.cmml" xref="alg3.l5.m1.2.2.4">subscript</csymbol><ci id="alg3.l5.m1.2.2.4.2.cmml" xref="alg3.l5.m1.2.2.4.2">𝜇</ci><ci id="alg3.l5.m1.2.2.4.3.cmml" xref="alg3.l5.m1.2.2.4.3">P</ci></apply><apply id="alg3.l5.m1.2.2.2.cmml" xref="alg3.l5.m1.2.2.2"><times id="alg3.l5.m1.2.2.2.3.cmml" xref="alg3.l5.m1.2.2.2.3"></times><ci id="alg3.l5.m1.2.2.2.4a.cmml" xref="alg3.l5.m1.2.2.2.4"><mtext class="ltx_font_smallcaps" id="alg3.l5.m1.2.2.2.4.cmml" xref="alg3.l5.m1.2.2.2.4">GenFL</mtext></ci><interval closure="open" id="alg3.l5.m1.2.2.2.2.3.cmml" xref="alg3.l5.m1.2.2.2.2.2"><apply id="alg3.l5.m1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.2">𝜇</ci><apply id="alg3.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3"><times id="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.1"></times><ci id="alg3.l5.m1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="alg3.l5.m1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="alg3.l5.m1.1.1.1.1.1.1.3.4.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.4">𝑖</ci><ci id="alg3.l5.m1.1.1.1.1.1.1.3.5.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="alg3.l5.m1.1.1.1.1.1.1.3.6.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.6">𝑟</ci></apply></apply><apply id="alg3.l5.m1.2.2.2.2.2.2.cmml" xref="alg3.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg3.l5.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l5.m1.2.2.2.2.2.2.2">𝒮</ci><ci id="alg3.l5.m1.2.2.2.2.2.2.3.cmml" xref="alg3.l5.m1.2.2.2.2.2.2.3">P</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.2c">\mu_{\mathrm{P}}\leftarrow\textsc{GenFL}(\mu_{prior},\mathcal{S}_{\mathrm{P}})</annotation></semantics></math>

</div>
<div id="alg3.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span><math id="alg3.l6.m1.2" class="ltx_Math" alttext="w_{1}\leftarrow(\mu_{\mathrm{P}},\sigma_{prior})" display="inline"><semantics id="alg3.l6.m1.2a"><mrow id="alg3.l6.m1.2.2" xref="alg3.l6.m1.2.2.cmml"><msub id="alg3.l6.m1.2.2.4" xref="alg3.l6.m1.2.2.4.cmml"><mi id="alg3.l6.m1.2.2.4.2" xref="alg3.l6.m1.2.2.4.2.cmml">w</mi><mn id="alg3.l6.m1.2.2.4.3" xref="alg3.l6.m1.2.2.4.3.cmml">1</mn></msub><mo stretchy="false" id="alg3.l6.m1.2.2.3" xref="alg3.l6.m1.2.2.3.cmml">←</mo><mrow id="alg3.l6.m1.2.2.2.2" xref="alg3.l6.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg3.l6.m1.2.2.2.2.3" xref="alg3.l6.m1.2.2.2.3.cmml">(</mo><msub id="alg3.l6.m1.1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.cmml"><mi id="alg3.l6.m1.1.1.1.1.1.2" xref="alg3.l6.m1.1.1.1.1.1.2.cmml">μ</mi><mi mathvariant="normal" id="alg3.l6.m1.1.1.1.1.1.3" xref="alg3.l6.m1.1.1.1.1.1.3.cmml">P</mi></msub><mo id="alg3.l6.m1.2.2.2.2.4" xref="alg3.l6.m1.2.2.2.3.cmml">,</mo><msub id="alg3.l6.m1.2.2.2.2.2" xref="alg3.l6.m1.2.2.2.2.2.cmml"><mi id="alg3.l6.m1.2.2.2.2.2.2" xref="alg3.l6.m1.2.2.2.2.2.2.cmml">σ</mi><mrow id="alg3.l6.m1.2.2.2.2.2.3" xref="alg3.l6.m1.2.2.2.2.2.3.cmml"><mi id="alg3.l6.m1.2.2.2.2.2.3.2" xref="alg3.l6.m1.2.2.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.2.2.2.2.2.3.1" xref="alg3.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg3.l6.m1.2.2.2.2.2.3.3" xref="alg3.l6.m1.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.2.2.2.2.2.3.1a" xref="alg3.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg3.l6.m1.2.2.2.2.2.3.4" xref="alg3.l6.m1.2.2.2.2.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.2.2.2.2.2.3.1b" xref="alg3.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg3.l6.m1.2.2.2.2.2.3.5" xref="alg3.l6.m1.2.2.2.2.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.2.2.2.2.2.3.1c" xref="alg3.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg3.l6.m1.2.2.2.2.2.3.6" xref="alg3.l6.m1.2.2.2.2.2.3.6.cmml">r</mi></mrow></msub><mo stretchy="false" id="alg3.l6.m1.2.2.2.2.5" xref="alg3.l6.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.2b"><apply id="alg3.l6.m1.2.2.cmml" xref="alg3.l6.m1.2.2"><ci id="alg3.l6.m1.2.2.3.cmml" xref="alg3.l6.m1.2.2.3">←</ci><apply id="alg3.l6.m1.2.2.4.cmml" xref="alg3.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.4.1.cmml" xref="alg3.l6.m1.2.2.4">subscript</csymbol><ci id="alg3.l6.m1.2.2.4.2.cmml" xref="alg3.l6.m1.2.2.4.2">𝑤</ci><cn type="integer" id="alg3.l6.m1.2.2.4.3.cmml" xref="alg3.l6.m1.2.2.4.3">1</cn></apply><interval closure="open" id="alg3.l6.m1.2.2.2.3.cmml" xref="alg3.l6.m1.2.2.2.2"><apply id="alg3.l6.m1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l6.m1.1.1.1.1.1.2.cmml" xref="alg3.l6.m1.1.1.1.1.1.2">𝜇</ci><ci id="alg3.l6.m1.1.1.1.1.1.3.cmml" xref="alg3.l6.m1.1.1.1.1.1.3">P</ci></apply><apply id="alg3.l6.m1.2.2.2.2.2.cmml" xref="alg3.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.2.2.2.1.cmml" xref="alg3.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg3.l6.m1.2.2.2.2.2.2.cmml" xref="alg3.l6.m1.2.2.2.2.2.2">𝜎</ci><apply id="alg3.l6.m1.2.2.2.2.2.3.cmml" xref="alg3.l6.m1.2.2.2.2.2.3"><times id="alg3.l6.m1.2.2.2.2.2.3.1.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.1"></times><ci id="alg3.l6.m1.2.2.2.2.2.3.2.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.2">𝑝</ci><ci id="alg3.l6.m1.2.2.2.2.2.3.3.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.3">𝑟</ci><ci id="alg3.l6.m1.2.2.2.2.2.3.4.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.4">𝑖</ci><ci id="alg3.l6.m1.2.2.2.2.2.3.5.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.5">𝑜</ci><ci id="alg3.l6.m1.2.2.2.2.2.3.6.cmml" xref="alg3.l6.m1.2.2.2.2.2.3.6">𝑟</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.2c">w_{1}\leftarrow(\mu_{\mathrm{P}},\sigma_{prior})</annotation></semantics></math> <span id="alg3.l6.1" class="ltx_text" style="float:right;"><math id="alg3.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l6.1.m1.1a"><mo id="alg3.l6.1.m1.1.1" xref="alg3.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l6.1.m1.1b"><ci id="alg3.l6.1.m1.1.1.cmml" xref="alg3.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.1.m1.1c">\triangleright</annotation></semantics></math> Prior is constructed.
</span>
</div>
<div id="alg3.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg3.l7.1" class="ltx_text ltx_font_bold">Step 2: Personalisation step.</span>

</div>
<div id="alg3.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span><span id="alg3.l8.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg3.l8.m1.2" class="ltx_Math" alttext="k=1,\cdots K" display="inline"><semantics id="alg3.l8.m1.2a"><mrow id="alg3.l8.m1.2.2" xref="alg3.l8.m1.2.2.cmml"><mi id="alg3.l8.m1.2.2.3" xref="alg3.l8.m1.2.2.3.cmml">k</mi><mo id="alg3.l8.m1.2.2.2" xref="alg3.l8.m1.2.2.2.cmml">=</mo><mrow id="alg3.l8.m1.2.2.1.1" xref="alg3.l8.m1.2.2.1.2.cmml"><mn id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml">1</mn><mo id="alg3.l8.m1.2.2.1.1.2" xref="alg3.l8.m1.2.2.1.2.cmml">,</mo><mrow id="alg3.l8.m1.2.2.1.1.1" xref="alg3.l8.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="alg3.l8.m1.2.2.1.1.1.2" xref="alg3.l8.m1.2.2.1.1.1.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.2.2.1.1.1.1" xref="alg3.l8.m1.2.2.1.1.1.1.cmml">​</mo><mi id="alg3.l8.m1.2.2.1.1.1.3" xref="alg3.l8.m1.2.2.1.1.1.3.cmml">K</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.2b"><apply id="alg3.l8.m1.2.2.cmml" xref="alg3.l8.m1.2.2"><eq id="alg3.l8.m1.2.2.2.cmml" xref="alg3.l8.m1.2.2.2"></eq><ci id="alg3.l8.m1.2.2.3.cmml" xref="alg3.l8.m1.2.2.3">𝑘</ci><list id="alg3.l8.m1.2.2.1.2.cmml" xref="alg3.l8.m1.2.2.1.1"><cn type="integer" id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1">1</cn><apply id="alg3.l8.m1.2.2.1.1.1.cmml" xref="alg3.l8.m1.2.2.1.1.1"><times id="alg3.l8.m1.2.2.1.1.1.1.cmml" xref="alg3.l8.m1.2.2.1.1.1.1"></times><ci id="alg3.l8.m1.2.2.1.1.1.2.cmml" xref="alg3.l8.m1.2.2.1.1.1.2">⋯</ci><ci id="alg3.l8.m1.2.2.1.1.1.3.cmml" xref="alg3.l8.m1.2.2.1.1.1.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.2c">k=1,\cdots K</annotation></semantics></math> <span id="alg3.l8.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg3.l9.m1.3" class="ltx_Math" alttext="w_{\mathrm{Q}}^{k}\leftarrow ClientUpdate(k,w_{1},\frac{m_{k}}{2})" display="inline"><semantics id="alg3.l9.m1.3a"><mrow id="alg3.l9.m1.3.3" xref="alg3.l9.m1.3.3.cmml"><msubsup id="alg3.l9.m1.3.3.3" xref="alg3.l9.m1.3.3.3.cmml"><mi id="alg3.l9.m1.3.3.3.2.2" xref="alg3.l9.m1.3.3.3.2.2.cmml">w</mi><mi mathvariant="normal" id="alg3.l9.m1.3.3.3.2.3" xref="alg3.l9.m1.3.3.3.2.3.cmml">Q</mi><mi id="alg3.l9.m1.3.3.3.3" xref="alg3.l9.m1.3.3.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg3.l9.m1.3.3.2" xref="alg3.l9.m1.3.3.2.cmml">←</mo><mrow id="alg3.l9.m1.3.3.1" xref="alg3.l9.m1.3.3.1.cmml"><mi id="alg3.l9.m1.3.3.1.3" xref="alg3.l9.m1.3.3.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.4" xref="alg3.l9.m1.3.3.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2a" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.5" xref="alg3.l9.m1.3.3.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2b" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.6" xref="alg3.l9.m1.3.3.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2c" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.7" xref="alg3.l9.m1.3.3.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2d" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.8" xref="alg3.l9.m1.3.3.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2e" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.9" xref="alg3.l9.m1.3.3.1.9.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2f" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.10" xref="alg3.l9.m1.3.3.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2g" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.11" xref="alg3.l9.m1.3.3.1.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2h" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.12" xref="alg3.l9.m1.3.3.1.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2i" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.13" xref="alg3.l9.m1.3.3.1.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2j" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg3.l9.m1.3.3.1.14" xref="alg3.l9.m1.3.3.1.14.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg3.l9.m1.3.3.1.2k" xref="alg3.l9.m1.3.3.1.2.cmml">​</mo><mrow id="alg3.l9.m1.3.3.1.1.1" xref="alg3.l9.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg3.l9.m1.3.3.1.1.1.2" xref="alg3.l9.m1.3.3.1.1.2.cmml">(</mo><mi id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml">k</mi><mo id="alg3.l9.m1.3.3.1.1.1.3" xref="alg3.l9.m1.3.3.1.1.2.cmml">,</mo><msub id="alg3.l9.m1.3.3.1.1.1.1" xref="alg3.l9.m1.3.3.1.1.1.1.cmml"><mi id="alg3.l9.m1.3.3.1.1.1.1.2" xref="alg3.l9.m1.3.3.1.1.1.1.2.cmml">w</mi><mn id="alg3.l9.m1.3.3.1.1.1.1.3" xref="alg3.l9.m1.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="alg3.l9.m1.3.3.1.1.1.4" xref="alg3.l9.m1.3.3.1.1.2.cmml">,</mo><mfrac id="alg3.l9.m1.2.2" xref="alg3.l9.m1.2.2.cmml"><msub id="alg3.l9.m1.2.2.2" xref="alg3.l9.m1.2.2.2.cmml"><mi id="alg3.l9.m1.2.2.2.2" xref="alg3.l9.m1.2.2.2.2.cmml">m</mi><mi id="alg3.l9.m1.2.2.2.3" xref="alg3.l9.m1.2.2.2.3.cmml">k</mi></msub><mn id="alg3.l9.m1.2.2.3" xref="alg3.l9.m1.2.2.3.cmml">2</mn></mfrac><mo stretchy="false" id="alg3.l9.m1.3.3.1.1.1.5" xref="alg3.l9.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.3b"><apply id="alg3.l9.m1.3.3.cmml" xref="alg3.l9.m1.3.3"><ci id="alg3.l9.m1.3.3.2.cmml" xref="alg3.l9.m1.3.3.2">←</ci><apply id="alg3.l9.m1.3.3.3.cmml" xref="alg3.l9.m1.3.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.3.3.3.1.cmml" xref="alg3.l9.m1.3.3.3">superscript</csymbol><apply id="alg3.l9.m1.3.3.3.2.cmml" xref="alg3.l9.m1.3.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.3.3.3.2.1.cmml" xref="alg3.l9.m1.3.3.3">subscript</csymbol><ci id="alg3.l9.m1.3.3.3.2.2.cmml" xref="alg3.l9.m1.3.3.3.2.2">𝑤</ci><ci id="alg3.l9.m1.3.3.3.2.3.cmml" xref="alg3.l9.m1.3.3.3.2.3">Q</ci></apply><ci id="alg3.l9.m1.3.3.3.3.cmml" xref="alg3.l9.m1.3.3.3.3">𝑘</ci></apply><apply id="alg3.l9.m1.3.3.1.cmml" xref="alg3.l9.m1.3.3.1"><times id="alg3.l9.m1.3.3.1.2.cmml" xref="alg3.l9.m1.3.3.1.2"></times><ci id="alg3.l9.m1.3.3.1.3.cmml" xref="alg3.l9.m1.3.3.1.3">𝐶</ci><ci id="alg3.l9.m1.3.3.1.4.cmml" xref="alg3.l9.m1.3.3.1.4">𝑙</ci><ci id="alg3.l9.m1.3.3.1.5.cmml" xref="alg3.l9.m1.3.3.1.5">𝑖</ci><ci id="alg3.l9.m1.3.3.1.6.cmml" xref="alg3.l9.m1.3.3.1.6">𝑒</ci><ci id="alg3.l9.m1.3.3.1.7.cmml" xref="alg3.l9.m1.3.3.1.7">𝑛</ci><ci id="alg3.l9.m1.3.3.1.8.cmml" xref="alg3.l9.m1.3.3.1.8">𝑡</ci><ci id="alg3.l9.m1.3.3.1.9.cmml" xref="alg3.l9.m1.3.3.1.9">𝑈</ci><ci id="alg3.l9.m1.3.3.1.10.cmml" xref="alg3.l9.m1.3.3.1.10">𝑝</ci><ci id="alg3.l9.m1.3.3.1.11.cmml" xref="alg3.l9.m1.3.3.1.11">𝑑</ci><ci id="alg3.l9.m1.3.3.1.12.cmml" xref="alg3.l9.m1.3.3.1.12">𝑎</ci><ci id="alg3.l9.m1.3.3.1.13.cmml" xref="alg3.l9.m1.3.3.1.13">𝑡</ci><ci id="alg3.l9.m1.3.3.1.14.cmml" xref="alg3.l9.m1.3.3.1.14">𝑒</ci><vector id="alg3.l9.m1.3.3.1.1.2.cmml" xref="alg3.l9.m1.3.3.1.1.1"><ci id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1">𝑘</ci><apply id="alg3.l9.m1.3.3.1.1.1.1.cmml" xref="alg3.l9.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l9.m1.3.3.1.1.1.1.1.cmml" xref="alg3.l9.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg3.l9.m1.3.3.1.1.1.1.2.cmml" xref="alg3.l9.m1.3.3.1.1.1.1.2">𝑤</ci><cn type="integer" id="alg3.l9.m1.3.3.1.1.1.1.3.cmml" xref="alg3.l9.m1.3.3.1.1.1.1.3">1</cn></apply><apply id="alg3.l9.m1.2.2.cmml" xref="alg3.l9.m1.2.2"><divide id="alg3.l9.m1.2.2.1.cmml" xref="alg3.l9.m1.2.2"></divide><apply id="alg3.l9.m1.2.2.2.cmml" xref="alg3.l9.m1.2.2.2"><csymbol cd="ambiguous" id="alg3.l9.m1.2.2.2.1.cmml" xref="alg3.l9.m1.2.2.2">subscript</csymbol><ci id="alg3.l9.m1.2.2.2.2.cmml" xref="alg3.l9.m1.2.2.2.2">𝑚</ci><ci id="alg3.l9.m1.2.2.2.3.cmml" xref="alg3.l9.m1.2.2.2.3">𝑘</ci></apply><cn type="integer" id="alg3.l9.m1.2.2.3.cmml" xref="alg3.l9.m1.2.2.3">2</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.3c">w_{\mathrm{Q}}^{k}\leftarrow ClientUpdate(k,w_{1},\frac{m_{k}}{2})</annotation></semantics></math>

</div>
<div id="alg3.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><span id="alg3.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>Return <math id="alg3.l11.m1.1" class="ltx_Math" alttext="(w^{k}_{\mathrm{Q}})_{k=1\cdots K}" display="inline"><semantics id="alg3.l11.m1.1a"><msub id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mrow id="alg3.l11.m1.1.1.1.1" xref="alg3.l11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l11.m1.1.1.1.1.2" xref="alg3.l11.m1.1.1.1.1.1.cmml">(</mo><msubsup id="alg3.l11.m1.1.1.1.1.1" xref="alg3.l11.m1.1.1.1.1.1.cmml"><mi id="alg3.l11.m1.1.1.1.1.1.2.2" xref="alg3.l11.m1.1.1.1.1.1.2.2.cmml">w</mi><mi mathvariant="normal" id="alg3.l11.m1.1.1.1.1.1.3" xref="alg3.l11.m1.1.1.1.1.1.3.cmml">Q</mi><mi id="alg3.l11.m1.1.1.1.1.1.2.3" xref="alg3.l11.m1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg3.l11.m1.1.1.1.1.3" xref="alg3.l11.m1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3.cmml"><mi id="alg3.l11.m1.1.1.3.2" xref="alg3.l11.m1.1.1.3.2.cmml">k</mi><mo id="alg3.l11.m1.1.1.3.1" xref="alg3.l11.m1.1.1.3.1.cmml">=</mo><mrow id="alg3.l11.m1.1.1.3.3" xref="alg3.l11.m1.1.1.3.3.cmml"><mn id="alg3.l11.m1.1.1.3.3.2" xref="alg3.l11.m1.1.1.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.3.3.1" xref="alg3.l11.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg3.l11.m1.1.1.3.3.3" xref="alg3.l11.m1.1.1.3.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.1.1.3.3.1a" xref="alg3.l11.m1.1.1.3.3.1.cmml">​</mo><mi id="alg3.l11.m1.1.1.3.3.4" xref="alg3.l11.m1.1.1.3.3.4.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1">subscript</csymbol><apply id="alg3.l11.m1.1.1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.1.1.1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1.1">subscript</csymbol><apply id="alg3.l11.m1.1.1.1.1.1.2.cmml" xref="alg3.l11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.1.1.1.1.1.2.1.cmml" xref="alg3.l11.m1.1.1.1.1">superscript</csymbol><ci id="alg3.l11.m1.1.1.1.1.1.2.2.cmml" xref="alg3.l11.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg3.l11.m1.1.1.1.1.1.2.3.cmml" xref="alg3.l11.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg3.l11.m1.1.1.1.1.1.3.cmml" xref="alg3.l11.m1.1.1.1.1.1.3">Q</ci></apply><apply id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3"><eq id="alg3.l11.m1.1.1.3.1.cmml" xref="alg3.l11.m1.1.1.3.1"></eq><ci id="alg3.l11.m1.1.1.3.2.cmml" xref="alg3.l11.m1.1.1.3.2">𝑘</ci><apply id="alg3.l11.m1.1.1.3.3.cmml" xref="alg3.l11.m1.1.1.3.3"><times id="alg3.l11.m1.1.1.3.3.1.cmml" xref="alg3.l11.m1.1.1.3.3.1"></times><cn type="integer" id="alg3.l11.m1.1.1.3.3.2.cmml" xref="alg3.l11.m1.1.1.3.3.2">1</cn><ci id="alg3.l11.m1.1.1.3.3.3.cmml" xref="alg3.l11.m1.1.1.3.3.3">⋯</ci><ci id="alg3.l11.m1.1.1.3.3.4.cmml" xref="alg3.l11.m1.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">(w^{k}_{\mathrm{Q}})_{k=1\cdots K}</annotation></semantics></math>

</div>
<div id="alg3.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>
</div>
<div id="alg3.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span><span id="alg3.l13.1" class="ltx_text ltx_font_bold">ClientUpdate(k, w, m):</span>

</div>
<div id="alg3.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span><math id="alg3.l14.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow(\text{split }\mathcal{S}_{k}^{2}\text{ into batches of size B})" display="inline"><semantics id="alg3.l14.m1.1a"><mrow id="alg3.l14.m1.1.1" xref="alg3.l14.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l14.m1.1.1.3" xref="alg3.l14.m1.1.1.3.cmml">ℬ</mi><mo stretchy="false" id="alg3.l14.m1.1.1.2" xref="alg3.l14.m1.1.1.2.cmml">←</mo><mrow id="alg3.l14.m1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l14.m1.1.1.1.1.2" xref="alg3.l14.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l14.m1.1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.cmml"><mtext id="alg3.l14.m1.1.1.1.1.1.2" xref="alg3.l14.m1.1.1.1.1.1.2a.cmml">split </mtext><mo lspace="0em" rspace="0em" id="alg3.l14.m1.1.1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.1.1.cmml">​</mo><msubsup id="alg3.l14.m1.1.1.1.1.1.3" xref="alg3.l14.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l14.m1.1.1.1.1.1.3.2.2" xref="alg3.l14.m1.1.1.1.1.1.3.2.2.cmml">𝒮</mi><mi id="alg3.l14.m1.1.1.1.1.1.3.2.3" xref="alg3.l14.m1.1.1.1.1.1.3.2.3.cmml">k</mi><mn id="alg3.l14.m1.1.1.1.1.1.3.3" xref="alg3.l14.m1.1.1.1.1.1.3.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="alg3.l14.m1.1.1.1.1.1.1a" xref="alg3.l14.m1.1.1.1.1.1.1.cmml">​</mo><mtext id="alg3.l14.m1.1.1.1.1.1.4" xref="alg3.l14.m1.1.1.1.1.1.4a.cmml"> into batches of size B</mtext></mrow><mo stretchy="false" id="alg3.l14.m1.1.1.1.1.3" xref="alg3.l14.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l14.m1.1b"><apply id="alg3.l14.m1.1.1.cmml" xref="alg3.l14.m1.1.1"><ci id="alg3.l14.m1.1.1.2.cmml" xref="alg3.l14.m1.1.1.2">←</ci><ci id="alg3.l14.m1.1.1.3.cmml" xref="alg3.l14.m1.1.1.3">ℬ</ci><apply id="alg3.l14.m1.1.1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1.1"><times id="alg3.l14.m1.1.1.1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1.1.1.1"></times><ci id="alg3.l14.m1.1.1.1.1.1.2a.cmml" xref="alg3.l14.m1.1.1.1.1.1.2"><mtext id="alg3.l14.m1.1.1.1.1.1.2.cmml" xref="alg3.l14.m1.1.1.1.1.1.2">split </mtext></ci><apply id="alg3.l14.m1.1.1.1.1.1.3.cmml" xref="alg3.l14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l14.m1.1.1.1.1.1.3.1.cmml" xref="alg3.l14.m1.1.1.1.1.1.3">superscript</csymbol><apply id="alg3.l14.m1.1.1.1.1.1.3.2.cmml" xref="alg3.l14.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l14.m1.1.1.1.1.1.3.2.1.cmml" xref="alg3.l14.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.l14.m1.1.1.1.1.1.3.2.2.cmml" xref="alg3.l14.m1.1.1.1.1.1.3.2.2">𝒮</ci><ci id="alg3.l14.m1.1.1.1.1.1.3.2.3.cmml" xref="alg3.l14.m1.1.1.1.1.1.3.2.3">𝑘</ci></apply><cn type="integer" id="alg3.l14.m1.1.1.1.1.1.3.3.cmml" xref="alg3.l14.m1.1.1.1.1.1.3.3">2</cn></apply><ci id="alg3.l14.m1.1.1.1.1.1.4a.cmml" xref="alg3.l14.m1.1.1.1.1.1.4"><mtext id="alg3.l14.m1.1.1.1.1.1.4.cmml" xref="alg3.l14.m1.1.1.1.1.1.4"> into batches of size B</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.m1.1c">\mathcal{B}\leftarrow(\text{split }\mathcal{S}_{k}^{2}\text{ into batches of size B})</annotation></semantics></math>

</div>
<div id="alg3.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span><span id="alg3.l15.1" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg3.l15.m1.4" class="ltx_Math" alttext="e=1,2,\cdots,E" display="inline"><semantics id="alg3.l15.m1.4a"><mrow id="alg3.l15.m1.4.5" xref="alg3.l15.m1.4.5.cmml"><mi id="alg3.l15.m1.4.5.2" xref="alg3.l15.m1.4.5.2.cmml">e</mi><mo id="alg3.l15.m1.4.5.1" xref="alg3.l15.m1.4.5.1.cmml">=</mo><mrow id="alg3.l15.m1.4.5.3.2" xref="alg3.l15.m1.4.5.3.1.cmml"><mn id="alg3.l15.m1.1.1" xref="alg3.l15.m1.1.1.cmml">1</mn><mo id="alg3.l15.m1.4.5.3.2.1" xref="alg3.l15.m1.4.5.3.1.cmml">,</mo><mn id="alg3.l15.m1.2.2" xref="alg3.l15.m1.2.2.cmml">2</mn><mo id="alg3.l15.m1.4.5.3.2.2" xref="alg3.l15.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg3.l15.m1.3.3" xref="alg3.l15.m1.3.3.cmml">⋯</mi><mo id="alg3.l15.m1.4.5.3.2.3" xref="alg3.l15.m1.4.5.3.1.cmml">,</mo><mi id="alg3.l15.m1.4.4" xref="alg3.l15.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l15.m1.4b"><apply id="alg3.l15.m1.4.5.cmml" xref="alg3.l15.m1.4.5"><eq id="alg3.l15.m1.4.5.1.cmml" xref="alg3.l15.m1.4.5.1"></eq><ci id="alg3.l15.m1.4.5.2.cmml" xref="alg3.l15.m1.4.5.2">𝑒</ci><list id="alg3.l15.m1.4.5.3.1.cmml" xref="alg3.l15.m1.4.5.3.2"><cn type="integer" id="alg3.l15.m1.1.1.cmml" xref="alg3.l15.m1.1.1">1</cn><cn type="integer" id="alg3.l15.m1.2.2.cmml" xref="alg3.l15.m1.2.2">2</cn><ci id="alg3.l15.m1.3.3.cmml" xref="alg3.l15.m1.3.3">⋯</ci><ci id="alg3.l15.m1.4.4.cmml" xref="alg3.l15.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.m1.4c">e=1,2,\cdots,E</annotation></semantics></math> <span id="alg3.l15.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span id="alg3.l16.1" class="ltx_text ltx_font_bold">for</span> each local minibatch <math id="alg3.l16.m1.1" class="ltx_Math" alttext="b\in B" display="inline"><semantics id="alg3.l16.m1.1a"><mrow id="alg3.l16.m1.1.1" xref="alg3.l16.m1.1.1.cmml"><mi id="alg3.l16.m1.1.1.2" xref="alg3.l16.m1.1.1.2.cmml">b</mi><mo id="alg3.l16.m1.1.1.1" xref="alg3.l16.m1.1.1.1.cmml">∈</mo><mi id="alg3.l16.m1.1.1.3" xref="alg3.l16.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l16.m1.1b"><apply id="alg3.l16.m1.1.1.cmml" xref="alg3.l16.m1.1.1"><in id="alg3.l16.m1.1.1.1.cmml" xref="alg3.l16.m1.1.1.1"></in><ci id="alg3.l16.m1.1.1.2.cmml" xref="alg3.l16.m1.1.1.2">𝑏</ci><ci id="alg3.l16.m1.1.1.3.cmml" xref="alg3.l16.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l16.m1.1c">b\in B</annotation></semantics></math> <span id="alg3.l16.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg3.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>         <math id="alg3.l17.m1.2" class="ltx_Math" alttext="w^{k}_{s}\leftarrow\mu^{k}+\sigma^{k}\odot\mathcal{N}(0,1)" display="inline"><semantics id="alg3.l17.m1.2a"><mrow id="alg3.l17.m1.2.3" xref="alg3.l17.m1.2.3.cmml"><msubsup id="alg3.l17.m1.2.3.2" xref="alg3.l17.m1.2.3.2.cmml"><mi id="alg3.l17.m1.2.3.2.2.2" xref="alg3.l17.m1.2.3.2.2.2.cmml">w</mi><mi id="alg3.l17.m1.2.3.2.3" xref="alg3.l17.m1.2.3.2.3.cmml">s</mi><mi id="alg3.l17.m1.2.3.2.2.3" xref="alg3.l17.m1.2.3.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg3.l17.m1.2.3.1" xref="alg3.l17.m1.2.3.1.cmml">←</mo><mrow id="alg3.l17.m1.2.3.3" xref="alg3.l17.m1.2.3.3.cmml"><msup id="alg3.l17.m1.2.3.3.2" xref="alg3.l17.m1.2.3.3.2.cmml"><mi id="alg3.l17.m1.2.3.3.2.2" xref="alg3.l17.m1.2.3.3.2.2.cmml">μ</mi><mi id="alg3.l17.m1.2.3.3.2.3" xref="alg3.l17.m1.2.3.3.2.3.cmml">k</mi></msup><mo id="alg3.l17.m1.2.3.3.1" xref="alg3.l17.m1.2.3.3.1.cmml">+</mo><mrow id="alg3.l17.m1.2.3.3.3" xref="alg3.l17.m1.2.3.3.3.cmml"><mrow id="alg3.l17.m1.2.3.3.3.2" xref="alg3.l17.m1.2.3.3.3.2.cmml"><msup id="alg3.l17.m1.2.3.3.3.2.2" xref="alg3.l17.m1.2.3.3.3.2.2.cmml"><mi id="alg3.l17.m1.2.3.3.3.2.2.2" xref="alg3.l17.m1.2.3.3.3.2.2.2.cmml">σ</mi><mi id="alg3.l17.m1.2.3.3.3.2.2.3" xref="alg3.l17.m1.2.3.3.3.2.2.3.cmml">k</mi></msup><mo lspace="0.222em" rspace="0.222em" id="alg3.l17.m1.2.3.3.3.2.1" xref="alg3.l17.m1.2.3.3.3.2.1.cmml">⊙</mo><mi class="ltx_font_mathcaligraphic" id="alg3.l17.m1.2.3.3.3.2.3" xref="alg3.l17.m1.2.3.3.3.2.3.cmml">𝒩</mi></mrow><mo lspace="0em" rspace="0em" id="alg3.l17.m1.2.3.3.3.1" xref="alg3.l17.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg3.l17.m1.2.3.3.3.3.2" xref="alg3.l17.m1.2.3.3.3.3.1.cmml"><mo stretchy="false" id="alg3.l17.m1.2.3.3.3.3.2.1" xref="alg3.l17.m1.2.3.3.3.3.1.cmml">(</mo><mn id="alg3.l17.m1.1.1" xref="alg3.l17.m1.1.1.cmml">0</mn><mo id="alg3.l17.m1.2.3.3.3.3.2.2" xref="alg3.l17.m1.2.3.3.3.3.1.cmml">,</mo><mn id="alg3.l17.m1.2.2" xref="alg3.l17.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg3.l17.m1.2.3.3.3.3.2.3" xref="alg3.l17.m1.2.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l17.m1.2b"><apply id="alg3.l17.m1.2.3.cmml" xref="alg3.l17.m1.2.3"><ci id="alg3.l17.m1.2.3.1.cmml" xref="alg3.l17.m1.2.3.1">←</ci><apply id="alg3.l17.m1.2.3.2.cmml" xref="alg3.l17.m1.2.3.2"><csymbol cd="ambiguous" id="alg3.l17.m1.2.3.2.1.cmml" xref="alg3.l17.m1.2.3.2">subscript</csymbol><apply id="alg3.l17.m1.2.3.2.2.cmml" xref="alg3.l17.m1.2.3.2"><csymbol cd="ambiguous" id="alg3.l17.m1.2.3.2.2.1.cmml" xref="alg3.l17.m1.2.3.2">superscript</csymbol><ci id="alg3.l17.m1.2.3.2.2.2.cmml" xref="alg3.l17.m1.2.3.2.2.2">𝑤</ci><ci id="alg3.l17.m1.2.3.2.2.3.cmml" xref="alg3.l17.m1.2.3.2.2.3">𝑘</ci></apply><ci id="alg3.l17.m1.2.3.2.3.cmml" xref="alg3.l17.m1.2.3.2.3">𝑠</ci></apply><apply id="alg3.l17.m1.2.3.3.cmml" xref="alg3.l17.m1.2.3.3"><plus id="alg3.l17.m1.2.3.3.1.cmml" xref="alg3.l17.m1.2.3.3.1"></plus><apply id="alg3.l17.m1.2.3.3.2.cmml" xref="alg3.l17.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg3.l17.m1.2.3.3.2.1.cmml" xref="alg3.l17.m1.2.3.3.2">superscript</csymbol><ci id="alg3.l17.m1.2.3.3.2.2.cmml" xref="alg3.l17.m1.2.3.3.2.2">𝜇</ci><ci id="alg3.l17.m1.2.3.3.2.3.cmml" xref="alg3.l17.m1.2.3.3.2.3">𝑘</ci></apply><apply id="alg3.l17.m1.2.3.3.3.cmml" xref="alg3.l17.m1.2.3.3.3"><times id="alg3.l17.m1.2.3.3.3.1.cmml" xref="alg3.l17.m1.2.3.3.3.1"></times><apply id="alg3.l17.m1.2.3.3.3.2.cmml" xref="alg3.l17.m1.2.3.3.3.2"><csymbol cd="latexml" id="alg3.l17.m1.2.3.3.3.2.1.cmml" xref="alg3.l17.m1.2.3.3.3.2.1">direct-product</csymbol><apply id="alg3.l17.m1.2.3.3.3.2.2.cmml" xref="alg3.l17.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="alg3.l17.m1.2.3.3.3.2.2.1.cmml" xref="alg3.l17.m1.2.3.3.3.2.2">superscript</csymbol><ci id="alg3.l17.m1.2.3.3.3.2.2.2.cmml" xref="alg3.l17.m1.2.3.3.3.2.2.2">𝜎</ci><ci id="alg3.l17.m1.2.3.3.3.2.2.3.cmml" xref="alg3.l17.m1.2.3.3.3.2.2.3">𝑘</ci></apply><ci id="alg3.l17.m1.2.3.3.3.2.3.cmml" xref="alg3.l17.m1.2.3.3.3.2.3">𝒩</ci></apply><interval closure="open" id="alg3.l17.m1.2.3.3.3.3.1.cmml" xref="alg3.l17.m1.2.3.3.3.3.2"><cn type="integer" id="alg3.l17.m1.1.1.cmml" xref="alg3.l17.m1.1.1">0</cn><cn type="integer" id="alg3.l17.m1.2.2.cmml" xref="alg3.l17.m1.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l17.m1.2c">w^{k}_{s}\leftarrow\mu^{k}+\sigma^{k}\odot\mathcal{N}(0,1)</annotation></semantics></math> <span id="alg3.l17.1" class="ltx_text" style="float:right;"><math id="alg3.l17.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l17.1.m1.1a"><mo id="alg3.l17.1.m1.1.1" xref="alg3.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l17.1.m1.1b"><ci id="alg3.l17.1.m1.1.1.cmml" xref="alg3.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l17.1.m1.1c">\triangleright</annotation></semantics></math> Reparam. trick
</span>
</div>
<div id="alg3.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>         <math id="alg3.l18.m1.6" class="ltx_Math" alttext="w^{k}\leftarrow w^{k}-\eta\nabla_{w}f_{m,\delta,\mu_{\text{prior}},\sigma_{\text{prior}}}(w^{k}_{s};b)" display="inline"><semantics id="alg3.l18.m1.6a"><mrow id="alg3.l18.m1.6.6" xref="alg3.l18.m1.6.6.cmml"><msup id="alg3.l18.m1.6.6.3" xref="alg3.l18.m1.6.6.3.cmml"><mi id="alg3.l18.m1.6.6.3.2" xref="alg3.l18.m1.6.6.3.2.cmml">w</mi><mi id="alg3.l18.m1.6.6.3.3" xref="alg3.l18.m1.6.6.3.3.cmml">k</mi></msup><mo stretchy="false" id="alg3.l18.m1.6.6.2" xref="alg3.l18.m1.6.6.2.cmml">←</mo><mrow id="alg3.l18.m1.6.6.1" xref="alg3.l18.m1.6.6.1.cmml"><msup id="alg3.l18.m1.6.6.1.3" xref="alg3.l18.m1.6.6.1.3.cmml"><mi id="alg3.l18.m1.6.6.1.3.2" xref="alg3.l18.m1.6.6.1.3.2.cmml">w</mi><mi id="alg3.l18.m1.6.6.1.3.3" xref="alg3.l18.m1.6.6.1.3.3.cmml">k</mi></msup><mo id="alg3.l18.m1.6.6.1.2" xref="alg3.l18.m1.6.6.1.2.cmml">−</mo><mrow id="alg3.l18.m1.6.6.1.1" xref="alg3.l18.m1.6.6.1.1.cmml"><mi id="alg3.l18.m1.6.6.1.1.3" xref="alg3.l18.m1.6.6.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg3.l18.m1.6.6.1.1.2" xref="alg3.l18.m1.6.6.1.1.2.cmml">​</mo><mrow id="alg3.l18.m1.6.6.1.1.4" xref="alg3.l18.m1.6.6.1.1.4.cmml"><msub id="alg3.l18.m1.6.6.1.1.4.1" xref="alg3.l18.m1.6.6.1.1.4.1.cmml"><mo rspace="0.167em" id="alg3.l18.m1.6.6.1.1.4.1.2" xref="alg3.l18.m1.6.6.1.1.4.1.2.cmml">∇</mo><mi id="alg3.l18.m1.6.6.1.1.4.1.3" xref="alg3.l18.m1.6.6.1.1.4.1.3.cmml">w</mi></msub><msub id="alg3.l18.m1.6.6.1.1.4.2" xref="alg3.l18.m1.6.6.1.1.4.2.cmml"><mi id="alg3.l18.m1.6.6.1.1.4.2.2" xref="alg3.l18.m1.6.6.1.1.4.2.2.cmml">f</mi><mrow id="alg3.l18.m1.4.4.4.4" xref="alg3.l18.m1.4.4.4.5.cmml"><mi id="alg3.l18.m1.1.1.1.1" xref="alg3.l18.m1.1.1.1.1.cmml">m</mi><mo id="alg3.l18.m1.4.4.4.4.3" xref="alg3.l18.m1.4.4.4.5.cmml">,</mo><mi id="alg3.l18.m1.2.2.2.2" xref="alg3.l18.m1.2.2.2.2.cmml">δ</mi><mo id="alg3.l18.m1.4.4.4.4.4" xref="alg3.l18.m1.4.4.4.5.cmml">,</mo><msub id="alg3.l18.m1.3.3.3.3.1" xref="alg3.l18.m1.3.3.3.3.1.cmml"><mi id="alg3.l18.m1.3.3.3.3.1.2" xref="alg3.l18.m1.3.3.3.3.1.2.cmml">μ</mi><mtext id="alg3.l18.m1.3.3.3.3.1.3" xref="alg3.l18.m1.3.3.3.3.1.3a.cmml">prior</mtext></msub><mo id="alg3.l18.m1.4.4.4.4.5" xref="alg3.l18.m1.4.4.4.5.cmml">,</mo><msub id="alg3.l18.m1.4.4.4.4.2" xref="alg3.l18.m1.4.4.4.4.2.cmml"><mi id="alg3.l18.m1.4.4.4.4.2.2" xref="alg3.l18.m1.4.4.4.4.2.2.cmml">σ</mi><mtext id="alg3.l18.m1.4.4.4.4.2.3" xref="alg3.l18.m1.4.4.4.4.2.3a.cmml">prior</mtext></msub></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg3.l18.m1.6.6.1.1.2a" xref="alg3.l18.m1.6.6.1.1.2.cmml">​</mo><mrow id="alg3.l18.m1.6.6.1.1.1.1" xref="alg3.l18.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l18.m1.6.6.1.1.1.1.2" xref="alg3.l18.m1.6.6.1.1.1.2.cmml">(</mo><msubsup id="alg3.l18.m1.6.6.1.1.1.1.1" xref="alg3.l18.m1.6.6.1.1.1.1.1.cmml"><mi id="alg3.l18.m1.6.6.1.1.1.1.1.2.2" xref="alg3.l18.m1.6.6.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg3.l18.m1.6.6.1.1.1.1.1.3" xref="alg3.l18.m1.6.6.1.1.1.1.1.3.cmml">s</mi><mi id="alg3.l18.m1.6.6.1.1.1.1.1.2.3" xref="alg3.l18.m1.6.6.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="alg3.l18.m1.6.6.1.1.1.1.3" xref="alg3.l18.m1.6.6.1.1.1.2.cmml">;</mo><mi id="alg3.l18.m1.5.5" xref="alg3.l18.m1.5.5.cmml">b</mi><mo stretchy="false" id="alg3.l18.m1.6.6.1.1.1.1.4" xref="alg3.l18.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l18.m1.6b"><apply id="alg3.l18.m1.6.6.cmml" xref="alg3.l18.m1.6.6"><ci id="alg3.l18.m1.6.6.2.cmml" xref="alg3.l18.m1.6.6.2">←</ci><apply id="alg3.l18.m1.6.6.3.cmml" xref="alg3.l18.m1.6.6.3"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.3.1.cmml" xref="alg3.l18.m1.6.6.3">superscript</csymbol><ci id="alg3.l18.m1.6.6.3.2.cmml" xref="alg3.l18.m1.6.6.3.2">𝑤</ci><ci id="alg3.l18.m1.6.6.3.3.cmml" xref="alg3.l18.m1.6.6.3.3">𝑘</ci></apply><apply id="alg3.l18.m1.6.6.1.cmml" xref="alg3.l18.m1.6.6.1"><minus id="alg3.l18.m1.6.6.1.2.cmml" xref="alg3.l18.m1.6.6.1.2"></minus><apply id="alg3.l18.m1.6.6.1.3.cmml" xref="alg3.l18.m1.6.6.1.3"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.1.3.1.cmml" xref="alg3.l18.m1.6.6.1.3">superscript</csymbol><ci id="alg3.l18.m1.6.6.1.3.2.cmml" xref="alg3.l18.m1.6.6.1.3.2">𝑤</ci><ci id="alg3.l18.m1.6.6.1.3.3.cmml" xref="alg3.l18.m1.6.6.1.3.3">𝑘</ci></apply><apply id="alg3.l18.m1.6.6.1.1.cmml" xref="alg3.l18.m1.6.6.1.1"><times id="alg3.l18.m1.6.6.1.1.2.cmml" xref="alg3.l18.m1.6.6.1.1.2"></times><ci id="alg3.l18.m1.6.6.1.1.3.cmml" xref="alg3.l18.m1.6.6.1.1.3">𝜂</ci><apply id="alg3.l18.m1.6.6.1.1.4.cmml" xref="alg3.l18.m1.6.6.1.1.4"><apply id="alg3.l18.m1.6.6.1.1.4.1.cmml" xref="alg3.l18.m1.6.6.1.1.4.1"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.1.1.4.1.1.cmml" xref="alg3.l18.m1.6.6.1.1.4.1">subscript</csymbol><ci id="alg3.l18.m1.6.6.1.1.4.1.2.cmml" xref="alg3.l18.m1.6.6.1.1.4.1.2">∇</ci><ci id="alg3.l18.m1.6.6.1.1.4.1.3.cmml" xref="alg3.l18.m1.6.6.1.1.4.1.3">𝑤</ci></apply><apply id="alg3.l18.m1.6.6.1.1.4.2.cmml" xref="alg3.l18.m1.6.6.1.1.4.2"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.1.1.4.2.1.cmml" xref="alg3.l18.m1.6.6.1.1.4.2">subscript</csymbol><ci id="alg3.l18.m1.6.6.1.1.4.2.2.cmml" xref="alg3.l18.m1.6.6.1.1.4.2.2">𝑓</ci><list id="alg3.l18.m1.4.4.4.5.cmml" xref="alg3.l18.m1.4.4.4.4"><ci id="alg3.l18.m1.1.1.1.1.cmml" xref="alg3.l18.m1.1.1.1.1">𝑚</ci><ci id="alg3.l18.m1.2.2.2.2.cmml" xref="alg3.l18.m1.2.2.2.2">𝛿</ci><apply id="alg3.l18.m1.3.3.3.3.1.cmml" xref="alg3.l18.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg3.l18.m1.3.3.3.3.1.1.cmml" xref="alg3.l18.m1.3.3.3.3.1">subscript</csymbol><ci id="alg3.l18.m1.3.3.3.3.1.2.cmml" xref="alg3.l18.m1.3.3.3.3.1.2">𝜇</ci><ci id="alg3.l18.m1.3.3.3.3.1.3a.cmml" xref="alg3.l18.m1.3.3.3.3.1.3"><mtext mathsize="50%" id="alg3.l18.m1.3.3.3.3.1.3.cmml" xref="alg3.l18.m1.3.3.3.3.1.3">prior</mtext></ci></apply><apply id="alg3.l18.m1.4.4.4.4.2.cmml" xref="alg3.l18.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="alg3.l18.m1.4.4.4.4.2.1.cmml" xref="alg3.l18.m1.4.4.4.4.2">subscript</csymbol><ci id="alg3.l18.m1.4.4.4.4.2.2.cmml" xref="alg3.l18.m1.4.4.4.4.2.2">𝜎</ci><ci id="alg3.l18.m1.4.4.4.4.2.3a.cmml" xref="alg3.l18.m1.4.4.4.4.2.3"><mtext mathsize="50%" id="alg3.l18.m1.4.4.4.4.2.3.cmml" xref="alg3.l18.m1.4.4.4.4.2.3">prior</mtext></ci></apply></list></apply></apply><list id="alg3.l18.m1.6.6.1.1.1.2.cmml" xref="alg3.l18.m1.6.6.1.1.1.1"><apply id="alg3.l18.m1.6.6.1.1.1.1.1.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.1.1.1.1.1.1.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1">subscript</csymbol><apply id="alg3.l18.m1.6.6.1.1.1.1.1.2.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l18.m1.6.6.1.1.1.1.1.2.1.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1">superscript</csymbol><ci id="alg3.l18.m1.6.6.1.1.1.1.1.2.2.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1.2.2">𝑤</ci><ci id="alg3.l18.m1.6.6.1.1.1.1.1.2.3.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg3.l18.m1.6.6.1.1.1.1.1.3.cmml" xref="alg3.l18.m1.6.6.1.1.1.1.1.3">𝑠</ci></apply><ci id="alg3.l18.m1.5.5.cmml" xref="alg3.l18.m1.5.5">𝑏</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.m1.6c">w^{k}\leftarrow w^{k}-\eta\nabla_{w}f_{m,\delta,\mu_{\text{prior}},\sigma_{\text{prior}}}(w^{k}_{s};b)</annotation></semantics></math>

</div>
<div id="alg3.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>     <span id="alg3.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span><span id="alg3.l20.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l20.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span><span id="alg3.l21.1" class="ltx_text ltx_font_bold">return</span> <math id="alg3.l21.m1.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg3.l21.m1.1a"><msup id="alg3.l21.m1.1.1" xref="alg3.l21.m1.1.1.cmml"><mi id="alg3.l21.m1.1.1.2" xref="alg3.l21.m1.1.1.2.cmml">w</mi><mi id="alg3.l21.m1.1.1.3" xref="alg3.l21.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg3.l21.m1.1b"><apply id="alg3.l21.m1.1.1.cmml" xref="alg3.l21.m1.1.1"><csymbol cd="ambiguous" id="alg3.l21.m1.1.1.1.cmml" xref="alg3.l21.m1.1.1">superscript</csymbol><ci id="alg3.l21.m1.1.1.2.cmml" xref="alg3.l21.m1.1.1.2">𝑤</ci><ci id="alg3.l21.m1.1.1.3.cmml" xref="alg3.l21.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l21.m1.1c">w^{k}</annotation></semantics></math>

</div>
<div id="alg3.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>Personalised distributions <math id="alg3.l22.m1.2" class="ltx_Math" alttext="w_{\mathrm{Q}}^{k}\Leftrightarrow\mathcal{N}(\mu_{\mathrm{Q}}^{k},\sigma_{\mathrm{Q}}^{k})" display="inline"><semantics id="alg3.l22.m1.2a"><mrow id="alg3.l22.m1.2.2" xref="alg3.l22.m1.2.2.cmml"><msubsup id="alg3.l22.m1.2.2.4" xref="alg3.l22.m1.2.2.4.cmml"><mi id="alg3.l22.m1.2.2.4.2.2" xref="alg3.l22.m1.2.2.4.2.2.cmml">w</mi><mi mathvariant="normal" id="alg3.l22.m1.2.2.4.2.3" xref="alg3.l22.m1.2.2.4.2.3.cmml">Q</mi><mi id="alg3.l22.m1.2.2.4.3" xref="alg3.l22.m1.2.2.4.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg3.l22.m1.2.2.3" xref="alg3.l22.m1.2.2.3.cmml">⇔</mo><mrow id="alg3.l22.m1.2.2.2" xref="alg3.l22.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l22.m1.2.2.2.4" xref="alg3.l22.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg3.l22.m1.2.2.2.3" xref="alg3.l22.m1.2.2.2.3.cmml">​</mo><mrow id="alg3.l22.m1.2.2.2.2.2" xref="alg3.l22.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg3.l22.m1.2.2.2.2.2.3" xref="alg3.l22.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg3.l22.m1.1.1.1.1.1.1" xref="alg3.l22.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l22.m1.1.1.1.1.1.1.2.2" xref="alg3.l22.m1.1.1.1.1.1.1.2.2.cmml">μ</mi><mi mathvariant="normal" id="alg3.l22.m1.1.1.1.1.1.1.2.3" xref="alg3.l22.m1.1.1.1.1.1.1.2.3.cmml">Q</mi><mi id="alg3.l22.m1.1.1.1.1.1.1.3" xref="alg3.l22.m1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="alg3.l22.m1.2.2.2.2.2.4" xref="alg3.l22.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg3.l22.m1.2.2.2.2.2.2" xref="alg3.l22.m1.2.2.2.2.2.2.cmml"><mi id="alg3.l22.m1.2.2.2.2.2.2.2.2" xref="alg3.l22.m1.2.2.2.2.2.2.2.2.cmml">σ</mi><mi mathvariant="normal" id="alg3.l22.m1.2.2.2.2.2.2.2.3" xref="alg3.l22.m1.2.2.2.2.2.2.2.3.cmml">Q</mi><mi id="alg3.l22.m1.2.2.2.2.2.2.3" xref="alg3.l22.m1.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg3.l22.m1.2.2.2.2.2.5" xref="alg3.l22.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l22.m1.2b"><apply id="alg3.l22.m1.2.2.cmml" xref="alg3.l22.m1.2.2"><ci id="alg3.l22.m1.2.2.3.cmml" xref="alg3.l22.m1.2.2.3">⇔</ci><apply id="alg3.l22.m1.2.2.4.cmml" xref="alg3.l22.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.4.1.cmml" xref="alg3.l22.m1.2.2.4">superscript</csymbol><apply id="alg3.l22.m1.2.2.4.2.cmml" xref="alg3.l22.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.4.2.1.cmml" xref="alg3.l22.m1.2.2.4">subscript</csymbol><ci id="alg3.l22.m1.2.2.4.2.2.cmml" xref="alg3.l22.m1.2.2.4.2.2">𝑤</ci><ci id="alg3.l22.m1.2.2.4.2.3.cmml" xref="alg3.l22.m1.2.2.4.2.3">Q</ci></apply><ci id="alg3.l22.m1.2.2.4.3.cmml" xref="alg3.l22.m1.2.2.4.3">𝑘</ci></apply><apply id="alg3.l22.m1.2.2.2.cmml" xref="alg3.l22.m1.2.2.2"><times id="alg3.l22.m1.2.2.2.3.cmml" xref="alg3.l22.m1.2.2.2.3"></times><ci id="alg3.l22.m1.2.2.2.4.cmml" xref="alg3.l22.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg3.l22.m1.2.2.2.2.3.cmml" xref="alg3.l22.m1.2.2.2.2.2"><apply id="alg3.l22.m1.1.1.1.1.1.1.cmml" xref="alg3.l22.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l22.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg3.l22.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l22.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l22.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l22.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l22.m1.1.1.1.1.1.1.2.2">𝜇</ci><ci id="alg3.l22.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l22.m1.1.1.1.1.1.1.2.3">Q</ci></apply><ci id="alg3.l22.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l22.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg3.l22.m1.2.2.2.2.2.2.cmml" xref="alg3.l22.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.2.2.2.2.1.cmml" xref="alg3.l22.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg3.l22.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l22.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.2.2.2.2.2.1.cmml" xref="alg3.l22.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l22.m1.2.2.2.2.2.2.2.2.cmml" xref="alg3.l22.m1.2.2.2.2.2.2.2.2">𝜎</ci><ci id="alg3.l22.m1.2.2.2.2.2.2.2.3.cmml" xref="alg3.l22.m1.2.2.2.2.2.2.2.3">Q</ci></apply><ci id="alg3.l22.m1.2.2.2.2.2.2.3.cmml" xref="alg3.l22.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l22.m1.2c">w_{\mathrm{Q}}^{k}\Leftrightarrow\mathcal{N}(\mu_{\mathrm{Q}}^{k},\sigma_{\mathrm{Q}}^{k})</annotation></semantics></math>

</div>
</div>
</figure>
<div id="A2.SS0.SSS0.Px1.p4" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px1.p4.1" class="ltx_p">For the sake of completeness, we also precise in <a href="#alg4" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">4</span></a> how we calculate the personalised generalisation bounds once the PFL training of <a href="#alg3" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">3</span></a> is performed.</p>
</div>
<figure id="alg4" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg4.17.1.1" class="ltx_text ltx_font_bold">Algorithm 4</span> </span> <span id="alg4.18.2" class="ltx_text ltx_font_smallcaps">FedBound</span>. The K clients are indexed by k; <math id="alg4.8.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg4.8.m1.1b"><mi id="alg4.8.m1.1.1" xref="alg4.8.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg4.8.m1.1c"><ci id="alg4.8.m1.1.1.cmml" xref="alg4.8.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.8.m1.1d">f</annotation></semantics></math> PAC-Bayes objective, prior distribution <math id="alg4.9.m2.1" class="ltx_Math" alttext="\mu_{\mathrm{P}}" display="inline"><semantics id="alg4.9.m2.1b"><msub id="alg4.9.m2.1.1" xref="alg4.9.m2.1.1.cmml"><mi id="alg4.9.m2.1.1.2" xref="alg4.9.m2.1.1.2.cmml">μ</mi><mi mathvariant="normal" id="alg4.9.m2.1.1.3" xref="alg4.9.m2.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.9.m2.1c"><apply id="alg4.9.m2.1.1.cmml" xref="alg4.9.m2.1.1"><csymbol cd="ambiguous" id="alg4.9.m2.1.1.1.cmml" xref="alg4.9.m2.1.1">subscript</csymbol><ci id="alg4.9.m2.1.1.2.cmml" xref="alg4.9.m2.1.1.2">𝜇</ci><ci id="alg4.9.m2.1.1.3.cmml" xref="alg4.9.m2.1.1.3">P</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.9.m2.1d">\mu_{\mathrm{P}}</annotation></semantics></math>, <math id="alg4.10.m3.1" class="ltx_Math" alttext="\sigma_{\text{prior}}" display="inline"><semantics id="alg4.10.m3.1b"><msub id="alg4.10.m3.1.1" xref="alg4.10.m3.1.1.cmml"><mi id="alg4.10.m3.1.1.2" xref="alg4.10.m3.1.1.2.cmml">σ</mi><mtext id="alg4.10.m3.1.1.3" xref="alg4.10.m3.1.1.3a.cmml">prior</mtext></msub><annotation-xml encoding="MathML-Content" id="alg4.10.m3.1c"><apply id="alg4.10.m3.1.1.cmml" xref="alg4.10.m3.1.1"><csymbol cd="ambiguous" id="alg4.10.m3.1.1.1.cmml" xref="alg4.10.m3.1.1">subscript</csymbol><ci id="alg4.10.m3.1.1.2.cmml" xref="alg4.10.m3.1.1.2">𝜎</ci><ci id="alg4.10.m3.1.1.3a.cmml" xref="alg4.10.m3.1.1.3"><mtext mathsize="70%" id="alg4.10.m3.1.1.3.cmml" xref="alg4.10.m3.1.1.3">prior</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.10.m3.1d">\sigma_{\text{prior}}</annotation></semantics></math>; posterior <math id="alg4.11.m4.1" class="ltx_math_unparsed" alttext="\mathcal{N}(\mu_{T}" display="inline"><semantics id="alg4.11.m4.1b"><mrow id="alg4.11.m4.1c"><mi class="ltx_font_mathcaligraphic" id="alg4.11.m4.1.1">𝒩</mi><mrow id="alg4.11.m4.1.2"><mo stretchy="false" id="alg4.11.m4.1.2.1">(</mo><msub id="alg4.11.m4.1.2.2"><mi id="alg4.11.m4.1.2.2.2">μ</mi><mi id="alg4.11.m4.1.2.2.3">T</mi></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg4.11.m4.1d">\mathcal{N}(\mu_{T}</annotation></semantics></math> output of <a href="#alg3" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">3</span></a>, <math id="alg4.12.m5.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg4.12.m5.1b"><mi id="alg4.12.m5.1.1" xref="alg4.12.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg4.12.m5.1c"><ci id="alg4.12.m5.1.1.cmml" xref="alg4.12.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.12.m5.1d">\delta</annotation></semantics></math>, <math id="alg4.13.m6.1" class="ltx_Math" alttext="\delta^{{}^{\prime}}" display="inline"><semantics id="alg4.13.m6.1b"><msup id="alg4.13.m6.1.1" xref="alg4.13.m6.1.1.cmml"><mi id="alg4.13.m6.1.1.2" xref="alg4.13.m6.1.1.2.cmml">δ</mi><msup id="alg4.13.m6.1.1.3" xref="alg4.13.m6.1.1.3.cmml"><mi id="alg4.13.m6.1.1.3b" xref="alg4.13.m6.1.1.3.cmml"></mi><mo id="alg4.13.m6.1.1.3.1" xref="alg4.13.m6.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="alg4.13.m6.1c"><apply id="alg4.13.m6.1.1.cmml" xref="alg4.13.m6.1.1"><csymbol cd="ambiguous" id="alg4.13.m6.1.1.1.cmml" xref="alg4.13.m6.1.1">superscript</csymbol><ci id="alg4.13.m6.1.1.2.cmml" xref="alg4.13.m6.1.1.2">𝛿</ci><apply id="alg4.13.m6.1.1.3.cmml" xref="alg4.13.m6.1.1.3"><ci id="alg4.13.m6.1.1.3.1.cmml" xref="alg4.13.m6.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.13.m6.1d">\delta^{{}^{\prime}}</annotation></semantics></math> confidence parameters, <math id="alg4.14.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg4.14.m7.1b"><mi id="alg4.14.m7.1.1" xref="alg4.14.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg4.14.m7.1c"><ci id="alg4.14.m7.1.1.cmml" xref="alg4.14.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.14.m7.1d">n</annotation></semantics></math> number of MC sampling</figcaption>
<div id="alg4.19" class="ltx_listing ltx_listing">
<div id="alg4.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg4.l1.1" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg4.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg4.l2.m1.2" class="ltx_Math" alttext="\mathrm{P}=\mathcal{N}(\mu_{\mathrm{P}},\sigma_{\text{prior}})" display="inline"><semantics id="alg4.l2.m1.2a"><mrow id="alg4.l2.m1.2.2" xref="alg4.l2.m1.2.2.cmml"><mi mathvariant="normal" id="alg4.l2.m1.2.2.4" xref="alg4.l2.m1.2.2.4.cmml">P</mi><mo id="alg4.l2.m1.2.2.3" xref="alg4.l2.m1.2.2.3.cmml">=</mo><mrow id="alg4.l2.m1.2.2.2" xref="alg4.l2.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l2.m1.2.2.2.4" xref="alg4.l2.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg4.l2.m1.2.2.2.3" xref="alg4.l2.m1.2.2.2.3.cmml">​</mo><mrow id="alg4.l2.m1.2.2.2.2.2" xref="alg4.l2.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg4.l2.m1.2.2.2.2.2.3" xref="alg4.l2.m1.2.2.2.2.3.cmml">(</mo><msub id="alg4.l2.m1.1.1.1.1.1.1" xref="alg4.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l2.m1.1.1.1.1.1.1.2" xref="alg4.l2.m1.1.1.1.1.1.1.2.cmml">μ</mi><mi mathvariant="normal" id="alg4.l2.m1.1.1.1.1.1.1.3" xref="alg4.l2.m1.1.1.1.1.1.1.3.cmml">P</mi></msub><mo id="alg4.l2.m1.2.2.2.2.2.4" xref="alg4.l2.m1.2.2.2.2.3.cmml">,</mo><msub id="alg4.l2.m1.2.2.2.2.2.2" xref="alg4.l2.m1.2.2.2.2.2.2.cmml"><mi id="alg4.l2.m1.2.2.2.2.2.2.2" xref="alg4.l2.m1.2.2.2.2.2.2.2.cmml">σ</mi><mtext id="alg4.l2.m1.2.2.2.2.2.2.3" xref="alg4.l2.m1.2.2.2.2.2.2.3a.cmml">prior</mtext></msub><mo stretchy="false" id="alg4.l2.m1.2.2.2.2.2.5" xref="alg4.l2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l2.m1.2b"><apply id="alg4.l2.m1.2.2.cmml" xref="alg4.l2.m1.2.2"><eq id="alg4.l2.m1.2.2.3.cmml" xref="alg4.l2.m1.2.2.3"></eq><ci id="alg4.l2.m1.2.2.4.cmml" xref="alg4.l2.m1.2.2.4">P</ci><apply id="alg4.l2.m1.2.2.2.cmml" xref="alg4.l2.m1.2.2.2"><times id="alg4.l2.m1.2.2.2.3.cmml" xref="alg4.l2.m1.2.2.2.3"></times><ci id="alg4.l2.m1.2.2.2.4.cmml" xref="alg4.l2.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg4.l2.m1.2.2.2.2.3.cmml" xref="alg4.l2.m1.2.2.2.2.2"><apply id="alg4.l2.m1.1.1.1.1.1.1.cmml" xref="alg4.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l2.m1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg4.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l2.m1.1.1.1.1.1.1.3">P</ci></apply><apply id="alg4.l2.m1.2.2.2.2.2.2.cmml" xref="alg4.l2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l2.m1.2.2.2.2.2.2.1.cmml" xref="alg4.l2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg4.l2.m1.2.2.2.2.2.2.2.cmml" xref="alg4.l2.m1.2.2.2.2.2.2.2">𝜎</ci><ci id="alg4.l2.m1.2.2.2.2.2.2.3a.cmml" xref="alg4.l2.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="alg4.l2.m1.2.2.2.2.2.2.3.cmml" xref="alg4.l2.m1.2.2.2.2.2.2.3">prior</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.m1.2c">\mathrm{P}=\mathcal{N}(\mu_{\mathrm{P}},\sigma_{\text{prior}})</annotation></semantics></math> <span id="alg4.l2.1" class="ltx_text" style="float:right;"><math id="alg4.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l2.1.m1.1a"><mo id="alg4.l2.1.m1.1.1" xref="alg4.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l2.1.m1.1b"><ci id="alg4.l2.1.m1.1.1.cmml" xref="alg4.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.1.m1.1c">\triangleright</annotation></semantics></math>  Learned prior from <a href="#alg3" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Alg.</span> <span class="ltx_text ltx_ref_tag">3</span></a>
</span>
</div>
<div id="alg4.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><math id="alg4.l3.m1.2" class="ltx_Math" alttext="\mathrm{Q}=\mathcal{N}(\mu_{T},\sigma_{T})" display="inline"><semantics id="alg4.l3.m1.2a"><mrow id="alg4.l3.m1.2.2" xref="alg4.l3.m1.2.2.cmml"><mi mathvariant="normal" id="alg4.l3.m1.2.2.4" xref="alg4.l3.m1.2.2.4.cmml">Q</mi><mo id="alg4.l3.m1.2.2.3" xref="alg4.l3.m1.2.2.3.cmml">=</mo><mrow id="alg4.l3.m1.2.2.2" xref="alg4.l3.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l3.m1.2.2.2.4" xref="alg4.l3.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="alg4.l3.m1.2.2.2.3" xref="alg4.l3.m1.2.2.2.3.cmml">​</mo><mrow id="alg4.l3.m1.2.2.2.2.2" xref="alg4.l3.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg4.l3.m1.2.2.2.2.2.3" xref="alg4.l3.m1.2.2.2.2.3.cmml">(</mo><msub id="alg4.l3.m1.1.1.1.1.1.1" xref="alg4.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l3.m1.1.1.1.1.1.1.2" xref="alg4.l3.m1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="alg4.l3.m1.1.1.1.1.1.1.3" xref="alg4.l3.m1.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="alg4.l3.m1.2.2.2.2.2.4" xref="alg4.l3.m1.2.2.2.2.3.cmml">,</mo><msub id="alg4.l3.m1.2.2.2.2.2.2" xref="alg4.l3.m1.2.2.2.2.2.2.cmml"><mi id="alg4.l3.m1.2.2.2.2.2.2.2" xref="alg4.l3.m1.2.2.2.2.2.2.2.cmml">σ</mi><mi id="alg4.l3.m1.2.2.2.2.2.2.3" xref="alg4.l3.m1.2.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="alg4.l3.m1.2.2.2.2.2.5" xref="alg4.l3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.2b"><apply id="alg4.l3.m1.2.2.cmml" xref="alg4.l3.m1.2.2"><eq id="alg4.l3.m1.2.2.3.cmml" xref="alg4.l3.m1.2.2.3"></eq><ci id="alg4.l3.m1.2.2.4.cmml" xref="alg4.l3.m1.2.2.4">Q</ci><apply id="alg4.l3.m1.2.2.2.cmml" xref="alg4.l3.m1.2.2.2"><times id="alg4.l3.m1.2.2.2.3.cmml" xref="alg4.l3.m1.2.2.2.3"></times><ci id="alg4.l3.m1.2.2.2.4.cmml" xref="alg4.l3.m1.2.2.2.4">𝒩</ci><interval closure="open" id="alg4.l3.m1.2.2.2.2.3.cmml" xref="alg4.l3.m1.2.2.2.2.2"><apply id="alg4.l3.m1.1.1.1.1.1.1.cmml" xref="alg4.l3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l3.m1.1.1.1.1.1.1.2">𝜇</ci><ci id="alg4.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l3.m1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="alg4.l3.m1.2.2.2.2.2.2.cmml" xref="alg4.l3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l3.m1.2.2.2.2.2.2.1.cmml" xref="alg4.l3.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg4.l3.m1.2.2.2.2.2.2.2.cmml" xref="alg4.l3.m1.2.2.2.2.2.2.2">𝜎</ci><ci id="alg4.l3.m1.2.2.2.2.2.2.3.cmml" xref="alg4.l3.m1.2.2.2.2.2.2.3">𝑇</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.2c">\mathrm{Q}=\mathcal{N}(\mu_{T},\sigma_{T})</annotation></semantics></math> <span id="alg4.l3.1" class="ltx_text" style="float:right;"><math id="alg4.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l3.1.m1.1a"><mo id="alg4.l3.1.m1.1.1" xref="alg4.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l3.1.m1.1b"><ci id="alg4.l3.1.m1.1.1.cmml" xref="alg4.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.1.m1.1c">\triangleright</annotation></semantics></math> Posterior (learned)
</span>
</div>
<div id="alg4.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span><span id="alg4.l4.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg4.l4.m1.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="alg4.l4.m1.1a"><mrow id="alg4.l4.m1.1.1" xref="alg4.l4.m1.1.1.cmml"><mi id="alg4.l4.m1.1.1.2" xref="alg4.l4.m1.1.1.2.cmml">k</mi><mo id="alg4.l4.m1.1.1.1" xref="alg4.l4.m1.1.1.1.cmml">∈</mo><mi id="alg4.l4.m1.1.1.3" xref="alg4.l4.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.1b"><apply id="alg4.l4.m1.1.1.cmml" xref="alg4.l4.m1.1.1"><in id="alg4.l4.m1.1.1.1.cmml" xref="alg4.l4.m1.1.1.1"></in><ci id="alg4.l4.m1.1.1.2.cmml" xref="alg4.l4.m1.1.1.2">𝑘</ci><ci id="alg4.l4.m1.1.1.3.cmml" xref="alg4.l4.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.1c">k\in K</annotation></semantics></math> <span id="alg4.l4.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg4.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg4.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg4.l5.m1.3" class="ltx_Math" alttext="error^{k}\leftarrow ClientMCSampling(k,w_{t},m_{k}/2)" display="inline"><semantics id="alg4.l5.m1.3a"><mrow id="alg4.l5.m1.3.3" xref="alg4.l5.m1.3.3.cmml"><mrow id="alg4.l5.m1.3.3.4" xref="alg4.l5.m1.3.3.4.cmml"><mi id="alg4.l5.m1.3.3.4.2" xref="alg4.l5.m1.3.3.4.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.4.1" xref="alg4.l5.m1.3.3.4.1.cmml">​</mo><mi id="alg4.l5.m1.3.3.4.3" xref="alg4.l5.m1.3.3.4.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.4.1a" xref="alg4.l5.m1.3.3.4.1.cmml">​</mo><mi id="alg4.l5.m1.3.3.4.4" xref="alg4.l5.m1.3.3.4.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.4.1b" xref="alg4.l5.m1.3.3.4.1.cmml">​</mo><mi id="alg4.l5.m1.3.3.4.5" xref="alg4.l5.m1.3.3.4.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.4.1c" xref="alg4.l5.m1.3.3.4.1.cmml">​</mo><msup id="alg4.l5.m1.3.3.4.6" xref="alg4.l5.m1.3.3.4.6.cmml"><mi id="alg4.l5.m1.3.3.4.6.2" xref="alg4.l5.m1.3.3.4.6.2.cmml">r</mi><mi id="alg4.l5.m1.3.3.4.6.3" xref="alg4.l5.m1.3.3.4.6.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="alg4.l5.m1.3.3.3" xref="alg4.l5.m1.3.3.3.cmml">←</mo><mrow id="alg4.l5.m1.3.3.2" xref="alg4.l5.m1.3.3.2.cmml"><mi id="alg4.l5.m1.3.3.2.4" xref="alg4.l5.m1.3.3.2.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.5" xref="alg4.l5.m1.3.3.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3a" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.6" xref="alg4.l5.m1.3.3.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3b" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.7" xref="alg4.l5.m1.3.3.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3c" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.8" xref="alg4.l5.m1.3.3.2.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3d" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.9" xref="alg4.l5.m1.3.3.2.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3e" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.10" xref="alg4.l5.m1.3.3.2.10.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3f" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.11" xref="alg4.l5.m1.3.3.2.11.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3g" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.12" xref="alg4.l5.m1.3.3.2.12.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3h" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.13" xref="alg4.l5.m1.3.3.2.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3i" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.14" xref="alg4.l5.m1.3.3.2.14.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3j" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.15" xref="alg4.l5.m1.3.3.2.15.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3k" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.16" xref="alg4.l5.m1.3.3.2.16.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3l" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.17" xref="alg4.l5.m1.3.3.2.17.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3m" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.18" xref="alg4.l5.m1.3.3.2.18.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3n" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mi id="alg4.l5.m1.3.3.2.19" xref="alg4.l5.m1.3.3.2.19.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg4.l5.m1.3.3.2.3o" xref="alg4.l5.m1.3.3.2.3.cmml">​</mo><mrow id="alg4.l5.m1.3.3.2.2.2" xref="alg4.l5.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg4.l5.m1.3.3.2.2.2.3" xref="alg4.l5.m1.3.3.2.2.3.cmml">(</mo><mi id="alg4.l5.m1.1.1" xref="alg4.l5.m1.1.1.cmml">k</mi><mo id="alg4.l5.m1.3.3.2.2.2.4" xref="alg4.l5.m1.3.3.2.2.3.cmml">,</mo><msub id="alg4.l5.m1.2.2.1.1.1.1" xref="alg4.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg4.l5.m1.2.2.1.1.1.1.2" xref="alg4.l5.m1.2.2.1.1.1.1.2.cmml">w</mi><mi id="alg4.l5.m1.2.2.1.1.1.1.3" xref="alg4.l5.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="alg4.l5.m1.3.3.2.2.2.5" xref="alg4.l5.m1.3.3.2.2.3.cmml">,</mo><mrow id="alg4.l5.m1.3.3.2.2.2.2" xref="alg4.l5.m1.3.3.2.2.2.2.cmml"><msub id="alg4.l5.m1.3.3.2.2.2.2.2" xref="alg4.l5.m1.3.3.2.2.2.2.2.cmml"><mi id="alg4.l5.m1.3.3.2.2.2.2.2.2" xref="alg4.l5.m1.3.3.2.2.2.2.2.2.cmml">m</mi><mi id="alg4.l5.m1.3.3.2.2.2.2.2.3" xref="alg4.l5.m1.3.3.2.2.2.2.2.3.cmml">k</mi></msub><mo id="alg4.l5.m1.3.3.2.2.2.2.1" xref="alg4.l5.m1.3.3.2.2.2.2.1.cmml">/</mo><mn id="alg4.l5.m1.3.3.2.2.2.2.3" xref="alg4.l5.m1.3.3.2.2.2.2.3.cmml">2</mn></mrow><mo stretchy="false" id="alg4.l5.m1.3.3.2.2.2.6" xref="alg4.l5.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.m1.3b"><apply id="alg4.l5.m1.3.3.cmml" xref="alg4.l5.m1.3.3"><ci id="alg4.l5.m1.3.3.3.cmml" xref="alg4.l5.m1.3.3.3">←</ci><apply id="alg4.l5.m1.3.3.4.cmml" xref="alg4.l5.m1.3.3.4"><times id="alg4.l5.m1.3.3.4.1.cmml" xref="alg4.l5.m1.3.3.4.1"></times><ci id="alg4.l5.m1.3.3.4.2.cmml" xref="alg4.l5.m1.3.3.4.2">𝑒</ci><ci id="alg4.l5.m1.3.3.4.3.cmml" xref="alg4.l5.m1.3.3.4.3">𝑟</ci><ci id="alg4.l5.m1.3.3.4.4.cmml" xref="alg4.l5.m1.3.3.4.4">𝑟</ci><ci id="alg4.l5.m1.3.3.4.5.cmml" xref="alg4.l5.m1.3.3.4.5">𝑜</ci><apply id="alg4.l5.m1.3.3.4.6.cmml" xref="alg4.l5.m1.3.3.4.6"><csymbol cd="ambiguous" id="alg4.l5.m1.3.3.4.6.1.cmml" xref="alg4.l5.m1.3.3.4.6">superscript</csymbol><ci id="alg4.l5.m1.3.3.4.6.2.cmml" xref="alg4.l5.m1.3.3.4.6.2">𝑟</ci><ci id="alg4.l5.m1.3.3.4.6.3.cmml" xref="alg4.l5.m1.3.3.4.6.3">𝑘</ci></apply></apply><apply id="alg4.l5.m1.3.3.2.cmml" xref="alg4.l5.m1.3.3.2"><times id="alg4.l5.m1.3.3.2.3.cmml" xref="alg4.l5.m1.3.3.2.3"></times><ci id="alg4.l5.m1.3.3.2.4.cmml" xref="alg4.l5.m1.3.3.2.4">𝐶</ci><ci id="alg4.l5.m1.3.3.2.5.cmml" xref="alg4.l5.m1.3.3.2.5">𝑙</ci><ci id="alg4.l5.m1.3.3.2.6.cmml" xref="alg4.l5.m1.3.3.2.6">𝑖</ci><ci id="alg4.l5.m1.3.3.2.7.cmml" xref="alg4.l5.m1.3.3.2.7">𝑒</ci><ci id="alg4.l5.m1.3.3.2.8.cmml" xref="alg4.l5.m1.3.3.2.8">𝑛</ci><ci id="alg4.l5.m1.3.3.2.9.cmml" xref="alg4.l5.m1.3.3.2.9">𝑡</ci><ci id="alg4.l5.m1.3.3.2.10.cmml" xref="alg4.l5.m1.3.3.2.10">𝑀</ci><ci id="alg4.l5.m1.3.3.2.11.cmml" xref="alg4.l5.m1.3.3.2.11">𝐶</ci><ci id="alg4.l5.m1.3.3.2.12.cmml" xref="alg4.l5.m1.3.3.2.12">𝑆</ci><ci id="alg4.l5.m1.3.3.2.13.cmml" xref="alg4.l5.m1.3.3.2.13">𝑎</ci><ci id="alg4.l5.m1.3.3.2.14.cmml" xref="alg4.l5.m1.3.3.2.14">𝑚</ci><ci id="alg4.l5.m1.3.3.2.15.cmml" xref="alg4.l5.m1.3.3.2.15">𝑝</ci><ci id="alg4.l5.m1.3.3.2.16.cmml" xref="alg4.l5.m1.3.3.2.16">𝑙</ci><ci id="alg4.l5.m1.3.3.2.17.cmml" xref="alg4.l5.m1.3.3.2.17">𝑖</ci><ci id="alg4.l5.m1.3.3.2.18.cmml" xref="alg4.l5.m1.3.3.2.18">𝑛</ci><ci id="alg4.l5.m1.3.3.2.19.cmml" xref="alg4.l5.m1.3.3.2.19">𝑔</ci><vector id="alg4.l5.m1.3.3.2.2.3.cmml" xref="alg4.l5.m1.3.3.2.2.2"><ci id="alg4.l5.m1.1.1.cmml" xref="alg4.l5.m1.1.1">𝑘</ci><apply id="alg4.l5.m1.2.2.1.1.1.1.cmml" xref="alg4.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg4.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg4.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg4.l5.m1.2.2.1.1.1.1.2">𝑤</ci><ci id="alg4.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg4.l5.m1.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="alg4.l5.m1.3.3.2.2.2.2.cmml" xref="alg4.l5.m1.3.3.2.2.2.2"><divide id="alg4.l5.m1.3.3.2.2.2.2.1.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.1"></divide><apply id="alg4.l5.m1.3.3.2.2.2.2.2.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l5.m1.3.3.2.2.2.2.2.1.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg4.l5.m1.3.3.2.2.2.2.2.2.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.2.2">𝑚</ci><ci id="alg4.l5.m1.3.3.2.2.2.2.2.3.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.2.3">𝑘</ci></apply><cn type="integer" id="alg4.l5.m1.3.3.2.2.2.2.3.cmml" xref="alg4.l5.m1.3.3.2.2.2.2.3">2</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m1.3c">error^{k}\leftarrow ClientMCSampling(k,w_{t},m_{k}/2)</annotation></semantics></math>

</div>
<div id="alg4.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg4.l6.m1.3" class="ltx_Math" alttext="KL\_inv\leftarrow\emph{kl}^{-1}\left(error^{k}\mid\frac{1}{n}\ln(\frac{2}{\delta^{{}^{\prime}}})\right)" display="inline"><semantics id="alg4.l6.m1.3a"><mrow id="alg4.l6.m1.3.3" xref="alg4.l6.m1.3.3.cmml"><mrow id="alg4.l6.m1.3.3.3" xref="alg4.l6.m1.3.3.3.cmml"><mi id="alg4.l6.m1.3.3.3.2" xref="alg4.l6.m1.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.3.1" xref="alg4.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.3.3" xref="alg4.l6.m1.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.3.1a" xref="alg4.l6.m1.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg4.l6.m1.3.3.3.4" xref="alg4.l6.m1.3.3.3.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.3.1b" xref="alg4.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.3.5" xref="alg4.l6.m1.3.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.3.1c" xref="alg4.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.3.6" xref="alg4.l6.m1.3.3.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.3.1d" xref="alg4.l6.m1.3.3.3.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.3.7" xref="alg4.l6.m1.3.3.3.7.cmml">v</mi></mrow><mo stretchy="false" id="alg4.l6.m1.3.3.2" xref="alg4.l6.m1.3.3.2.cmml">←</mo><mrow id="alg4.l6.m1.3.3.1" xref="alg4.l6.m1.3.3.1.cmml"><msup id="alg4.l6.m1.3.3.1.3" xref="alg4.l6.m1.3.3.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="alg4.l6.m1.3.3.1.3.2" xref="alg4.l6.m1.3.3.1.3.2b.cmml"><em id="alg4.l6.m1.3.3.1.3.2.1nest" class="ltx_emph ltx_font_italic">kl</em></mtext><mrow id="alg4.l6.m1.3.3.1.3.3" xref="alg4.l6.m1.3.3.1.3.3.cmml"><mo id="alg4.l6.m1.3.3.1.3.3a" xref="alg4.l6.m1.3.3.1.3.3.cmml">−</mo><mn id="alg4.l6.m1.3.3.1.3.3.2" xref="alg4.l6.m1.3.3.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.1.2" xref="alg4.l6.m1.3.3.1.2.cmml">​</mo><mrow id="alg4.l6.m1.3.3.1.1.1" xref="alg4.l6.m1.3.3.1.1.1.1.cmml"><mo id="alg4.l6.m1.3.3.1.1.1.2" xref="alg4.l6.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg4.l6.m1.3.3.1.1.1.1" xref="alg4.l6.m1.3.3.1.1.1.1.cmml"><mrow id="alg4.l6.m1.3.3.1.1.1.1.2" xref="alg4.l6.m1.3.3.1.1.1.1.2.cmml"><mi id="alg4.l6.m1.3.3.1.1.1.1.2.2" xref="alg4.l6.m1.3.3.1.1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.1.1.1.1.2.1" xref="alg4.l6.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.1.1.1.1.2.3" xref="alg4.l6.m1.3.3.1.1.1.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.1.1.1.1.2.1a" xref="alg4.l6.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.1.1.1.1.2.4" xref="alg4.l6.m1.3.3.1.1.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.1.1.1.1.2.1b" xref="alg4.l6.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l6.m1.3.3.1.1.1.1.2.5" xref="alg4.l6.m1.3.3.1.1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg4.l6.m1.3.3.1.1.1.1.2.1c" xref="alg4.l6.m1.3.3.1.1.1.1.2.1.cmml">​</mo><msup id="alg4.l6.m1.3.3.1.1.1.1.2.6" xref="alg4.l6.m1.3.3.1.1.1.1.2.6.cmml"><mi id="alg4.l6.m1.3.3.1.1.1.1.2.6.2" xref="alg4.l6.m1.3.3.1.1.1.1.2.6.2.cmml">r</mi><mi id="alg4.l6.m1.3.3.1.1.1.1.2.6.3" xref="alg4.l6.m1.3.3.1.1.1.1.2.6.3.cmml">k</mi></msup></mrow><mo id="alg4.l6.m1.3.3.1.1.1.1.1" xref="alg4.l6.m1.3.3.1.1.1.1.1.cmml">∣</mo><mrow id="alg4.l6.m1.3.3.1.1.1.1.3" xref="alg4.l6.m1.3.3.1.1.1.1.3.cmml"><mfrac id="alg4.l6.m1.3.3.1.1.1.1.3.2" xref="alg4.l6.m1.3.3.1.1.1.1.3.2.cmml"><mn id="alg4.l6.m1.3.3.1.1.1.1.3.2.2" xref="alg4.l6.m1.3.3.1.1.1.1.3.2.2.cmml">1</mn><mi id="alg4.l6.m1.3.3.1.1.1.1.3.2.3" xref="alg4.l6.m1.3.3.1.1.1.1.3.2.3.cmml">n</mi></mfrac><mo lspace="0.167em" rspace="0em" id="alg4.l6.m1.3.3.1.1.1.1.3.1" xref="alg4.l6.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="alg4.l6.m1.3.3.1.1.1.1.3.3.2" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml"><mi id="alg4.l6.m1.1.1" xref="alg4.l6.m1.1.1.cmml">ln</mi><mo id="alg4.l6.m1.3.3.1.1.1.1.3.3.2a" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="alg4.l6.m1.3.3.1.1.1.1.3.3.2.1" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="alg4.l6.m1.3.3.1.1.1.1.3.3.2.1.1" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml">(</mo><mfrac id="alg4.l6.m1.2.2" xref="alg4.l6.m1.2.2.cmml"><mn id="alg4.l6.m1.2.2.2" xref="alg4.l6.m1.2.2.2.cmml">2</mn><msup id="alg4.l6.m1.2.2.3" xref="alg4.l6.m1.2.2.3.cmml"><mi id="alg4.l6.m1.2.2.3.2" xref="alg4.l6.m1.2.2.3.2.cmml">δ</mi><msup id="alg4.l6.m1.2.2.3.3" xref="alg4.l6.m1.2.2.3.3.cmml"><mi id="alg4.l6.m1.2.2.3.3a" xref="alg4.l6.m1.2.2.3.3.cmml"></mi><mo id="alg4.l6.m1.2.2.3.3.1" xref="alg4.l6.m1.2.2.3.3.1.cmml">′</mo></msup></msup></mfrac><mo stretchy="false" id="alg4.l6.m1.3.3.1.1.1.1.3.3.2.1.2" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg4.l6.m1.3.3.1.1.1.3" xref="alg4.l6.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.m1.3b"><apply id="alg4.l6.m1.3.3.cmml" xref="alg4.l6.m1.3.3"><ci id="alg4.l6.m1.3.3.2.cmml" xref="alg4.l6.m1.3.3.2">←</ci><apply id="alg4.l6.m1.3.3.3.cmml" xref="alg4.l6.m1.3.3.3"><times id="alg4.l6.m1.3.3.3.1.cmml" xref="alg4.l6.m1.3.3.3.1"></times><ci id="alg4.l6.m1.3.3.3.2.cmml" xref="alg4.l6.m1.3.3.3.2">𝐾</ci><ci id="alg4.l6.m1.3.3.3.3.cmml" xref="alg4.l6.m1.3.3.3.3">𝐿</ci><ci id="alg4.l6.m1.3.3.3.4.cmml" xref="alg4.l6.m1.3.3.3.4">_</ci><ci id="alg4.l6.m1.3.3.3.5.cmml" xref="alg4.l6.m1.3.3.3.5">𝑖</ci><ci id="alg4.l6.m1.3.3.3.6.cmml" xref="alg4.l6.m1.3.3.3.6">𝑛</ci><ci id="alg4.l6.m1.3.3.3.7.cmml" xref="alg4.l6.m1.3.3.3.7">𝑣</ci></apply><apply id="alg4.l6.m1.3.3.1.cmml" xref="alg4.l6.m1.3.3.1"><times id="alg4.l6.m1.3.3.1.2.cmml" xref="alg4.l6.m1.3.3.1.2"></times><apply id="alg4.l6.m1.3.3.1.3.cmml" xref="alg4.l6.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg4.l6.m1.3.3.1.3.1.cmml" xref="alg4.l6.m1.3.3.1.3">superscript</csymbol><ci id="alg4.l6.m1.3.3.1.3.2b.cmml" xref="alg4.l6.m1.3.3.1.3.2"><mtext class="ltx_mathvariant_italic" id="alg4.l6.m1.3.3.1.3.2.cmml" xref="alg4.l6.m1.3.3.1.3.2"><em id="alg4.l6.m1.3.3.1.3.2.1anest" class="ltx_emph ltx_font_italic">kl</em></mtext></ci><apply id="alg4.l6.m1.3.3.1.3.3.cmml" xref="alg4.l6.m1.3.3.1.3.3"><minus id="alg4.l6.m1.3.3.1.3.3.1.cmml" xref="alg4.l6.m1.3.3.1.3.3"></minus><cn type="integer" id="alg4.l6.m1.3.3.1.3.3.2.cmml" xref="alg4.l6.m1.3.3.1.3.3.2">1</cn></apply></apply><apply id="alg4.l6.m1.3.3.1.1.1.1.cmml" xref="alg4.l6.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg4.l6.m1.3.3.1.1.1.1.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="alg4.l6.m1.3.3.1.1.1.1.2.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2"><times id="alg4.l6.m1.3.3.1.1.1.1.2.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.1"></times><ci id="alg4.l6.m1.3.3.1.1.1.1.2.2.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.2">𝑒</ci><ci id="alg4.l6.m1.3.3.1.1.1.1.2.3.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.3">𝑟</ci><ci id="alg4.l6.m1.3.3.1.1.1.1.2.4.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.4">𝑟</ci><ci id="alg4.l6.m1.3.3.1.1.1.1.2.5.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.5">𝑜</ci><apply id="alg4.l6.m1.3.3.1.1.1.1.2.6.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.6"><csymbol cd="ambiguous" id="alg4.l6.m1.3.3.1.1.1.1.2.6.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.6">superscript</csymbol><ci id="alg4.l6.m1.3.3.1.1.1.1.2.6.2.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.6.2">𝑟</ci><ci id="alg4.l6.m1.3.3.1.1.1.1.2.6.3.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.2.6.3">𝑘</ci></apply></apply><apply id="alg4.l6.m1.3.3.1.1.1.1.3.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3"><times id="alg4.l6.m1.3.3.1.1.1.1.3.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.1"></times><apply id="alg4.l6.m1.3.3.1.1.1.1.3.2.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.2"><divide id="alg4.l6.m1.3.3.1.1.1.1.3.2.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.2"></divide><cn type="integer" id="alg4.l6.m1.3.3.1.1.1.1.3.2.2.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.2.2">1</cn><ci id="alg4.l6.m1.3.3.1.1.1.1.3.2.3.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="alg4.l6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="alg4.l6.m1.3.3.1.1.1.1.3.3.2"><ln id="alg4.l6.m1.1.1.cmml" xref="alg4.l6.m1.1.1"></ln><apply id="alg4.l6.m1.2.2.cmml" xref="alg4.l6.m1.2.2"><divide id="alg4.l6.m1.2.2.1.cmml" xref="alg4.l6.m1.2.2"></divide><cn type="integer" id="alg4.l6.m1.2.2.2.cmml" xref="alg4.l6.m1.2.2.2">2</cn><apply id="alg4.l6.m1.2.2.3.cmml" xref="alg4.l6.m1.2.2.3"><csymbol cd="ambiguous" id="alg4.l6.m1.2.2.3.1.cmml" xref="alg4.l6.m1.2.2.3">superscript</csymbol><ci id="alg4.l6.m1.2.2.3.2.cmml" xref="alg4.l6.m1.2.2.3.2">𝛿</ci><apply id="alg4.l6.m1.2.2.3.3.cmml" xref="alg4.l6.m1.2.2.3.3"><ci id="alg4.l6.m1.2.2.3.3.1.cmml" xref="alg4.l6.m1.2.2.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m1.3c">KL\_inv\leftarrow\emph{kl}^{-1}\left(error^{k}\mid\frac{1}{n}\ln(\frac{2}{\delta^{{}^{\prime}}})\right)</annotation></semantics></math>

</div>
<div id="alg4.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math id="alg4.l7.m1.3" class="ltx_Math" alttext="\texttt{Up-bound}_{k}\leftarrow\emph{kl}^{-1}\left(KL\_inv\mid\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)" display="inline"><semantics id="alg4.l7.m1.3a"><mrow id="alg4.l7.m1.3.3" xref="alg4.l7.m1.3.3.cmml"><msub id="alg4.l7.m1.3.3.3" xref="alg4.l7.m1.3.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg4.l7.m1.3.3.3.2" xref="alg4.l7.m1.3.3.3.2a.cmml">Up-bound</mtext><mi id="alg4.l7.m1.3.3.3.3" xref="alg4.l7.m1.3.3.3.3.cmml">k</mi></msub><mo stretchy="false" id="alg4.l7.m1.3.3.2" xref="alg4.l7.m1.3.3.2.cmml">←</mo><mrow id="alg4.l7.m1.3.3.1" xref="alg4.l7.m1.3.3.1.cmml"><msup id="alg4.l7.m1.3.3.1.3" xref="alg4.l7.m1.3.3.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="alg4.l7.m1.3.3.1.3.2" xref="alg4.l7.m1.3.3.1.3.2b.cmml"><em id="alg4.l7.m1.3.3.1.3.2.1nest" class="ltx_emph ltx_font_italic">kl</em></mtext><mrow id="alg4.l7.m1.3.3.1.3.3" xref="alg4.l7.m1.3.3.1.3.3.cmml"><mo id="alg4.l7.m1.3.3.1.3.3a" xref="alg4.l7.m1.3.3.1.3.3.cmml">−</mo><mn id="alg4.l7.m1.3.3.1.3.3.2" xref="alg4.l7.m1.3.3.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.2" xref="alg4.l7.m1.3.3.1.2.cmml">​</mo><mrow id="alg4.l7.m1.3.3.1.1.1" xref="alg4.l7.m1.3.3.1.1.1.1.cmml"><mo id="alg4.l7.m1.3.3.1.1.1.2" xref="alg4.l7.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg4.l7.m1.3.3.1.1.1.1" xref="alg4.l7.m1.3.3.1.1.1.1.cmml"><mrow id="alg4.l7.m1.3.3.1.1.1.1.2" xref="alg4.l7.m1.3.3.1.1.1.1.2.cmml"><mi id="alg4.l7.m1.3.3.1.1.1.1.2.2" xref="alg4.l7.m1.3.3.1.1.1.1.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.1.1.1.2.1" xref="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l7.m1.3.3.1.1.1.1.2.3" xref="alg4.l7.m1.3.3.1.1.1.1.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.1.1.1.2.1a" xref="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="alg4.l7.m1.3.3.1.1.1.1.2.4" xref="alg4.l7.m1.3.3.1.1.1.1.2.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.1.1.1.2.1b" xref="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l7.m1.3.3.1.1.1.1.2.5" xref="alg4.l7.m1.3.3.1.1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.1.1.1.2.1c" xref="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l7.m1.3.3.1.1.1.1.2.6" xref="alg4.l7.m1.3.3.1.1.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg4.l7.m1.3.3.1.1.1.1.2.1d" xref="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="alg4.l7.m1.3.3.1.1.1.1.2.7" xref="alg4.l7.m1.3.3.1.1.1.1.2.7.cmml">v</mi></mrow><mo id="alg4.l7.m1.3.3.1.1.1.1.1" xref="alg4.l7.m1.3.3.1.1.1.1.1.cmml">∣</mo><mfrac id="alg4.l7.m1.2.2" xref="alg4.l7.m1.2.2.cmml"><mrow id="alg4.l7.m1.2.2.2" xref="alg4.l7.m1.2.2.2.cmml"><mrow id="alg4.l7.m1.2.2.2.2.1" xref="alg4.l7.m1.2.2.2.2.2.cmml"><mi id="alg4.l7.m1.1.1.1.1" xref="alg4.l7.m1.1.1.1.1.cmml">KL</mi><mo id="alg4.l7.m1.2.2.2.2.1a" xref="alg4.l7.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="alg4.l7.m1.2.2.2.2.1.1" xref="alg4.l7.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="alg4.l7.m1.2.2.2.2.1.1.2" xref="alg4.l7.m1.2.2.2.2.2.cmml">(</mo><mrow id="alg4.l7.m1.2.2.2.2.1.1.1" xref="alg4.l7.m1.2.2.2.2.1.1.1.cmml"><mi id="alg4.l7.m1.2.2.2.2.1.1.1.2" xref="alg4.l7.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="alg4.l7.m1.2.2.2.2.1.1.1.1" xref="alg4.l7.m1.2.2.2.2.1.1.1.1.cmml">∥</mo><mi id="alg4.l7.m1.2.2.2.2.1.1.1.3" xref="alg4.l7.m1.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="alg4.l7.m1.2.2.2.2.1.1.3" xref="alg4.l7.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="alg4.l7.m1.2.2.2.3" xref="alg4.l7.m1.2.2.2.3.cmml">+</mo><mrow id="alg4.l7.m1.2.2.2.4" xref="alg4.l7.m1.2.2.2.4.cmml"><mi id="alg4.l7.m1.2.2.2.4.1" xref="alg4.l7.m1.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="alg4.l7.m1.2.2.2.4a" xref="alg4.l7.m1.2.2.2.4.cmml">⁡</mo><mfrac id="alg4.l7.m1.2.2.2.4.2" xref="alg4.l7.m1.2.2.2.4.2.cmml"><mrow id="alg4.l7.m1.2.2.2.4.2.2" xref="alg4.l7.m1.2.2.2.4.2.2.cmml"><mn id="alg4.l7.m1.2.2.2.4.2.2.2" xref="alg4.l7.m1.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg4.l7.m1.2.2.2.4.2.2.1" xref="alg4.l7.m1.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="alg4.l7.m1.2.2.2.4.2.2.3" xref="alg4.l7.m1.2.2.2.4.2.2.3.cmml"><mi id="alg4.l7.m1.2.2.2.4.2.2.3.2" xref="alg4.l7.m1.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="alg4.l7.m1.2.2.2.4.2.3" xref="alg4.l7.m1.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mi id="alg4.l7.m1.2.2.4" xref="alg4.l7.m1.2.2.4.cmml">m</mi></mfrac></mrow><mo id="alg4.l7.m1.3.3.1.1.1.3" xref="alg4.l7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.m1.3b"><apply id="alg4.l7.m1.3.3.cmml" xref="alg4.l7.m1.3.3"><ci id="alg4.l7.m1.3.3.2.cmml" xref="alg4.l7.m1.3.3.2">←</ci><apply id="alg4.l7.m1.3.3.3.cmml" xref="alg4.l7.m1.3.3.3"><csymbol cd="ambiguous" id="alg4.l7.m1.3.3.3.1.cmml" xref="alg4.l7.m1.3.3.3">subscript</csymbol><ci id="alg4.l7.m1.3.3.3.2a.cmml" xref="alg4.l7.m1.3.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg4.l7.m1.3.3.3.2.cmml" xref="alg4.l7.m1.3.3.3.2">Up-bound</mtext></ci><ci id="alg4.l7.m1.3.3.3.3.cmml" xref="alg4.l7.m1.3.3.3.3">𝑘</ci></apply><apply id="alg4.l7.m1.3.3.1.cmml" xref="alg4.l7.m1.3.3.1"><times id="alg4.l7.m1.3.3.1.2.cmml" xref="alg4.l7.m1.3.3.1.2"></times><apply id="alg4.l7.m1.3.3.1.3.cmml" xref="alg4.l7.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg4.l7.m1.3.3.1.3.1.cmml" xref="alg4.l7.m1.3.3.1.3">superscript</csymbol><ci id="alg4.l7.m1.3.3.1.3.2b.cmml" xref="alg4.l7.m1.3.3.1.3.2"><mtext class="ltx_mathvariant_italic" id="alg4.l7.m1.3.3.1.3.2.cmml" xref="alg4.l7.m1.3.3.1.3.2"><em id="alg4.l7.m1.3.3.1.3.2.1anest" class="ltx_emph ltx_font_italic">kl</em></mtext></ci><apply id="alg4.l7.m1.3.3.1.3.3.cmml" xref="alg4.l7.m1.3.3.1.3.3"><minus id="alg4.l7.m1.3.3.1.3.3.1.cmml" xref="alg4.l7.m1.3.3.1.3.3"></minus><cn type="integer" id="alg4.l7.m1.3.3.1.3.3.2.cmml" xref="alg4.l7.m1.3.3.1.3.3.2">1</cn></apply></apply><apply id="alg4.l7.m1.3.3.1.1.1.1.cmml" xref="alg4.l7.m1.3.3.1.1.1"><csymbol cd="latexml" id="alg4.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="alg4.l7.m1.3.3.1.1.1.1.2.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2"><times id="alg4.l7.m1.3.3.1.1.1.1.2.1.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.1"></times><ci id="alg4.l7.m1.3.3.1.1.1.1.2.2.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.2">𝐾</ci><ci id="alg4.l7.m1.3.3.1.1.1.1.2.3.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.3">𝐿</ci><ci id="alg4.l7.m1.3.3.1.1.1.1.2.4.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.4">_</ci><ci id="alg4.l7.m1.3.3.1.1.1.1.2.5.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.5">𝑖</ci><ci id="alg4.l7.m1.3.3.1.1.1.1.2.6.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.6">𝑛</ci><ci id="alg4.l7.m1.3.3.1.1.1.1.2.7.cmml" xref="alg4.l7.m1.3.3.1.1.1.1.2.7">𝑣</ci></apply><apply id="alg4.l7.m1.2.2.cmml" xref="alg4.l7.m1.2.2"><divide id="alg4.l7.m1.2.2.3.cmml" xref="alg4.l7.m1.2.2"></divide><apply id="alg4.l7.m1.2.2.2.cmml" xref="alg4.l7.m1.2.2.2"><plus id="alg4.l7.m1.2.2.2.3.cmml" xref="alg4.l7.m1.2.2.2.3"></plus><apply id="alg4.l7.m1.2.2.2.2.2.cmml" xref="alg4.l7.m1.2.2.2.2.1"><ci id="alg4.l7.m1.1.1.1.1.cmml" xref="alg4.l7.m1.1.1.1.1">KL</ci><apply id="alg4.l7.m1.2.2.2.2.1.1.1.cmml" xref="alg4.l7.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="alg4.l7.m1.2.2.2.2.1.1.1.1.cmml" xref="alg4.l7.m1.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="alg4.l7.m1.2.2.2.2.1.1.1.2.cmml" xref="alg4.l7.m1.2.2.2.2.1.1.1.2">𝑄</ci><ci id="alg4.l7.m1.2.2.2.2.1.1.1.3.cmml" xref="alg4.l7.m1.2.2.2.2.1.1.1.3">𝑃</ci></apply></apply><apply id="alg4.l7.m1.2.2.2.4.cmml" xref="alg4.l7.m1.2.2.2.4"><ln id="alg4.l7.m1.2.2.2.4.1.cmml" xref="alg4.l7.m1.2.2.2.4.1"></ln><apply id="alg4.l7.m1.2.2.2.4.2.cmml" xref="alg4.l7.m1.2.2.2.4.2"><divide id="alg4.l7.m1.2.2.2.4.2.1.cmml" xref="alg4.l7.m1.2.2.2.4.2"></divide><apply id="alg4.l7.m1.2.2.2.4.2.2.cmml" xref="alg4.l7.m1.2.2.2.4.2.2"><times id="alg4.l7.m1.2.2.2.4.2.2.1.cmml" xref="alg4.l7.m1.2.2.2.4.2.2.1"></times><cn type="integer" id="alg4.l7.m1.2.2.2.4.2.2.2.cmml" xref="alg4.l7.m1.2.2.2.4.2.2.2">2</cn><apply id="alg4.l7.m1.2.2.2.4.2.2.3.cmml" xref="alg4.l7.m1.2.2.2.4.2.2.3"><root id="alg4.l7.m1.2.2.2.4.2.2.3a.cmml" xref="alg4.l7.m1.2.2.2.4.2.2.3"></root><ci id="alg4.l7.m1.2.2.2.4.2.2.3.2.cmml" xref="alg4.l7.m1.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="alg4.l7.m1.2.2.2.4.2.3.cmml" xref="alg4.l7.m1.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><ci id="alg4.l7.m1.2.2.4.cmml" xref="alg4.l7.m1.2.2.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.m1.3c">\texttt{Up-bound}_{k}\leftarrow\emph{kl}^{-1}\left(KL\_inv\mid\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{m}\right)</annotation></semantics></math>

</div>
<div id="alg4.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span><span id="alg4.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg4.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg4.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>
</div>
<div id="alg4.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span><span id="alg4.l10.1" class="ltx_text ltx_font_bold">ClientMCSampling(k, w, m):</span>

</div>
<div id="alg4.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span><span id="alg4.l11.1" class="ltx_text ltx_font_bold">for</span> each MC sampling <math id="alg4.l11.m1.4" class="ltx_Math" alttext="i=1,2,\cdots,n" display="inline"><semantics id="alg4.l11.m1.4a"><mrow id="alg4.l11.m1.4.5" xref="alg4.l11.m1.4.5.cmml"><mi id="alg4.l11.m1.4.5.2" xref="alg4.l11.m1.4.5.2.cmml">i</mi><mo id="alg4.l11.m1.4.5.1" xref="alg4.l11.m1.4.5.1.cmml">=</mo><mrow id="alg4.l11.m1.4.5.3.2" xref="alg4.l11.m1.4.5.3.1.cmml"><mn id="alg4.l11.m1.1.1" xref="alg4.l11.m1.1.1.cmml">1</mn><mo id="alg4.l11.m1.4.5.3.2.1" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mn id="alg4.l11.m1.2.2" xref="alg4.l11.m1.2.2.cmml">2</mn><mo id="alg4.l11.m1.4.5.3.2.2" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg4.l11.m1.3.3" xref="alg4.l11.m1.3.3.cmml">⋯</mi><mo id="alg4.l11.m1.4.5.3.2.3" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mi id="alg4.l11.m1.4.4" xref="alg4.l11.m1.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l11.m1.4b"><apply id="alg4.l11.m1.4.5.cmml" xref="alg4.l11.m1.4.5"><eq id="alg4.l11.m1.4.5.1.cmml" xref="alg4.l11.m1.4.5.1"></eq><ci id="alg4.l11.m1.4.5.2.cmml" xref="alg4.l11.m1.4.5.2">𝑖</ci><list id="alg4.l11.m1.4.5.3.1.cmml" xref="alg4.l11.m1.4.5.3.2"><cn type="integer" id="alg4.l11.m1.1.1.cmml" xref="alg4.l11.m1.1.1">1</cn><cn type="integer" id="alg4.l11.m1.2.2.cmml" xref="alg4.l11.m1.2.2">2</cn><ci id="alg4.l11.m1.3.3.cmml" xref="alg4.l11.m1.3.3">⋯</ci><ci id="alg4.l11.m1.4.4.cmml" xref="alg4.l11.m1.4.4">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.m1.4c">i=1,2,\cdots,n</annotation></semantics></math> <span id="alg4.l11.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg4.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <math id="alg4.l12.m1.1" class="ltx_Math" alttext="W^{k}_{i}\sim\mathrm{Q}" display="inline"><semantics id="alg4.l12.m1.1a"><mrow id="alg4.l12.m1.1.1" xref="alg4.l12.m1.1.1.cmml"><msubsup id="alg4.l12.m1.1.1.2" xref="alg4.l12.m1.1.1.2.cmml"><mi id="alg4.l12.m1.1.1.2.2.2" xref="alg4.l12.m1.1.1.2.2.2.cmml">W</mi><mi id="alg4.l12.m1.1.1.2.3" xref="alg4.l12.m1.1.1.2.3.cmml">i</mi><mi id="alg4.l12.m1.1.1.2.2.3" xref="alg4.l12.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="alg4.l12.m1.1.1.1" xref="alg4.l12.m1.1.1.1.cmml">∼</mo><mi mathvariant="normal" id="alg4.l12.m1.1.1.3" xref="alg4.l12.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m1.1b"><apply id="alg4.l12.m1.1.1.cmml" xref="alg4.l12.m1.1.1"><csymbol cd="latexml" id="alg4.l12.m1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1">similar-to</csymbol><apply id="alg4.l12.m1.1.1.2.cmml" xref="alg4.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.2.1.cmml" xref="alg4.l12.m1.1.1.2">subscript</csymbol><apply id="alg4.l12.m1.1.1.2.2.cmml" xref="alg4.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.2.2.1.cmml" xref="alg4.l12.m1.1.1.2">superscript</csymbol><ci id="alg4.l12.m1.1.1.2.2.2.cmml" xref="alg4.l12.m1.1.1.2.2.2">𝑊</ci><ci id="alg4.l12.m1.1.1.2.2.3.cmml" xref="alg4.l12.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg4.l12.m1.1.1.2.3.cmml" xref="alg4.l12.m1.1.1.2.3">𝑖</ci></apply><ci id="alg4.l12.m1.1.1.3.cmml" xref="alg4.l12.m1.1.1.3">Q</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m1.1c">W^{k}_{i}\sim\mathrm{Q}</annotation></semantics></math> <span id="alg4.l12.1" class="ltx_text" style="float:right;"><math id="alg4.l12.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l12.1.m1.1a"><mo id="alg4.l12.1.m1.1.1" xref="alg4.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l12.1.m1.1b"><ci id="alg4.l12.1.m1.1.1.cmml" xref="alg4.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.1.m1.1c">\triangleright</annotation></semantics></math> Sample weights from the posterior
</span>
</div>
<div id="alg4.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <math id="alg4.l13.m1.1" class="ltx_Math" alttext="error^{k}_{i}\leftarrow\hat{\text{R}}_{\mathcal{S}_{k}^{2}}(W^{k}_{i})" display="inline"><semantics id="alg4.l13.m1.1a"><mrow id="alg4.l13.m1.1.1" xref="alg4.l13.m1.1.1.cmml"><mrow id="alg4.l13.m1.1.1.3" xref="alg4.l13.m1.1.1.3.cmml"><mi id="alg4.l13.m1.1.1.3.2" xref="alg4.l13.m1.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg4.l13.m1.1.1.3.1" xref="alg4.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg4.l13.m1.1.1.3.3" xref="alg4.l13.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l13.m1.1.1.3.1a" xref="alg4.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg4.l13.m1.1.1.3.4" xref="alg4.l13.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l13.m1.1.1.3.1b" xref="alg4.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg4.l13.m1.1.1.3.5" xref="alg4.l13.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg4.l13.m1.1.1.3.1c" xref="alg4.l13.m1.1.1.3.1.cmml">​</mo><msubsup id="alg4.l13.m1.1.1.3.6" xref="alg4.l13.m1.1.1.3.6.cmml"><mi id="alg4.l13.m1.1.1.3.6.2.2" xref="alg4.l13.m1.1.1.3.6.2.2.cmml">r</mi><mi id="alg4.l13.m1.1.1.3.6.3" xref="alg4.l13.m1.1.1.3.6.3.cmml">i</mi><mi id="alg4.l13.m1.1.1.3.6.2.3" xref="alg4.l13.m1.1.1.3.6.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg4.l13.m1.1.1.2" xref="alg4.l13.m1.1.1.2.cmml">←</mo><mrow id="alg4.l13.m1.1.1.1" xref="alg4.l13.m1.1.1.1.cmml"><msub id="alg4.l13.m1.1.1.1.3" xref="alg4.l13.m1.1.1.1.3.cmml"><mover accent="true" id="alg4.l13.m1.1.1.1.3.2" xref="alg4.l13.m1.1.1.1.3.2.cmml"><mtext id="alg4.l13.m1.1.1.1.3.2.2" xref="alg4.l13.m1.1.1.1.3.2.2a.cmml">R</mtext><mo id="alg4.l13.m1.1.1.1.3.2.1" xref="alg4.l13.m1.1.1.1.3.2.1.cmml">^</mo></mover><msubsup id="alg4.l13.m1.1.1.1.3.3" xref="alg4.l13.m1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l13.m1.1.1.1.3.3.2.2" xref="alg4.l13.m1.1.1.1.3.3.2.2.cmml">𝒮</mi><mi id="alg4.l13.m1.1.1.1.3.3.2.3" xref="alg4.l13.m1.1.1.1.3.3.2.3.cmml">k</mi><mn id="alg4.l13.m1.1.1.1.3.3.3" xref="alg4.l13.m1.1.1.1.3.3.3.cmml">2</mn></msubsup></msub><mo lspace="0em" rspace="0em" id="alg4.l13.m1.1.1.1.2" xref="alg4.l13.m1.1.1.1.2.cmml">​</mo><mrow id="alg4.l13.m1.1.1.1.1.1" xref="alg4.l13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg4.l13.m1.1.1.1.1.1.2" xref="alg4.l13.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg4.l13.m1.1.1.1.1.1.1" xref="alg4.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l13.m1.1.1.1.1.1.1.2.2" xref="alg4.l13.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="alg4.l13.m1.1.1.1.1.1.1.3" xref="alg4.l13.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg4.l13.m1.1.1.1.1.1.1.2.3" xref="alg4.l13.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg4.l13.m1.1.1.1.1.1.3" xref="alg4.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m1.1b"><apply id="alg4.l13.m1.1.1.cmml" xref="alg4.l13.m1.1.1"><ci id="alg4.l13.m1.1.1.2.cmml" xref="alg4.l13.m1.1.1.2">←</ci><apply id="alg4.l13.m1.1.1.3.cmml" xref="alg4.l13.m1.1.1.3"><times id="alg4.l13.m1.1.1.3.1.cmml" xref="alg4.l13.m1.1.1.3.1"></times><ci id="alg4.l13.m1.1.1.3.2.cmml" xref="alg4.l13.m1.1.1.3.2">𝑒</ci><ci id="alg4.l13.m1.1.1.3.3.cmml" xref="alg4.l13.m1.1.1.3.3">𝑟</ci><ci id="alg4.l13.m1.1.1.3.4.cmml" xref="alg4.l13.m1.1.1.3.4">𝑟</ci><ci id="alg4.l13.m1.1.1.3.5.cmml" xref="alg4.l13.m1.1.1.3.5">𝑜</ci><apply id="alg4.l13.m1.1.1.3.6.cmml" xref="alg4.l13.m1.1.1.3.6"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.3.6.1.cmml" xref="alg4.l13.m1.1.1.3.6">subscript</csymbol><apply id="alg4.l13.m1.1.1.3.6.2.cmml" xref="alg4.l13.m1.1.1.3.6"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.3.6.2.1.cmml" xref="alg4.l13.m1.1.1.3.6">superscript</csymbol><ci id="alg4.l13.m1.1.1.3.6.2.2.cmml" xref="alg4.l13.m1.1.1.3.6.2.2">𝑟</ci><ci id="alg4.l13.m1.1.1.3.6.2.3.cmml" xref="alg4.l13.m1.1.1.3.6.2.3">𝑘</ci></apply><ci id="alg4.l13.m1.1.1.3.6.3.cmml" xref="alg4.l13.m1.1.1.3.6.3">𝑖</ci></apply></apply><apply id="alg4.l13.m1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1"><times id="alg4.l13.m1.1.1.1.2.cmml" xref="alg4.l13.m1.1.1.1.2"></times><apply id="alg4.l13.m1.1.1.1.3.cmml" xref="alg4.l13.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.3.1.cmml" xref="alg4.l13.m1.1.1.1.3">subscript</csymbol><apply id="alg4.l13.m1.1.1.1.3.2.cmml" xref="alg4.l13.m1.1.1.1.3.2"><ci id="alg4.l13.m1.1.1.1.3.2.1.cmml" xref="alg4.l13.m1.1.1.1.3.2.1">^</ci><ci id="alg4.l13.m1.1.1.1.3.2.2a.cmml" xref="alg4.l13.m1.1.1.1.3.2.2"><mtext id="alg4.l13.m1.1.1.1.3.2.2.cmml" xref="alg4.l13.m1.1.1.1.3.2.2">R</mtext></ci></apply><apply id="alg4.l13.m1.1.1.1.3.3.cmml" xref="alg4.l13.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.3.3.1.cmml" xref="alg4.l13.m1.1.1.1.3.3">superscript</csymbol><apply id="alg4.l13.m1.1.1.1.3.3.2.cmml" xref="alg4.l13.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.3.3.2.1.cmml" xref="alg4.l13.m1.1.1.1.3.3">subscript</csymbol><ci id="alg4.l13.m1.1.1.1.3.3.2.2.cmml" xref="alg4.l13.m1.1.1.1.3.3.2.2">𝒮</ci><ci id="alg4.l13.m1.1.1.1.3.3.2.3.cmml" xref="alg4.l13.m1.1.1.1.3.3.2.3">𝑘</ci></apply><cn type="integer" id="alg4.l13.m1.1.1.1.3.3.3.cmml" xref="alg4.l13.m1.1.1.1.3.3.3">2</cn></apply></apply><apply id="alg4.l13.m1.1.1.1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1.1.1">subscript</csymbol><apply id="alg4.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.1.1.1.2.1.cmml" xref="alg4.l13.m1.1.1.1.1.1">superscript</csymbol><ci id="alg4.l13.m1.1.1.1.1.1.1.2.2.cmml" xref="alg4.l13.m1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="alg4.l13.m1.1.1.1.1.1.1.2.3.cmml" xref="alg4.l13.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg4.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l13.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m1.1c">error^{k}_{i}\leftarrow\hat{\text{R}}_{\mathcal{S}_{k}^{2}}(W^{k}_{i})</annotation></semantics></math> <span id="alg4.l13.1" class="ltx_text" style="float:right;"><math id="alg4.l13.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l13.1.m1.1a"><mo id="alg4.l13.1.m1.1.1" xref="alg4.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l13.1.m1.1b"><ci id="alg4.l13.1.m1.1.1.cmml" xref="alg4.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.1.m1.1c">\triangleright</annotation></semantics></math> local empirical risk
</span>
</div>
<div id="alg4.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span><span id="alg4.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg4.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg4.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span><math id="alg4.l15.m1.1" class="ltx_math_unparsed" alttext="error^{k}\leftarrow=\frac{1}{n}\sum_{i=1}^{n}error^{k}_{i}" display="inline"><semantics id="alg4.l15.m1.1a"><mrow id="alg4.l15.m1.1b"><mi id="alg4.l15.m1.1.1">e</mi><mi id="alg4.l15.m1.1.2">r</mi><mi id="alg4.l15.m1.1.3">r</mi><mi id="alg4.l15.m1.1.4">o</mi><msup id="alg4.l15.m1.1.5"><mi id="alg4.l15.m1.1.5.2">r</mi><mi id="alg4.l15.m1.1.5.3">k</mi></msup><mo rspace="0em" stretchy="false" id="alg4.l15.m1.1.6">←</mo><mo lspace="0em" id="alg4.l15.m1.1.7">=</mo><mfrac id="alg4.l15.m1.1.8"><mn id="alg4.l15.m1.1.8.2">1</mn><mi id="alg4.l15.m1.1.8.3">n</mi></mfrac><msubsup id="alg4.l15.m1.1.9"><mo id="alg4.l15.m1.1.9.2.2">∑</mo><mrow id="alg4.l15.m1.1.9.2.3"><mi id="alg4.l15.m1.1.9.2.3.2">i</mi><mo id="alg4.l15.m1.1.9.2.3.1">=</mo><mn id="alg4.l15.m1.1.9.2.3.3">1</mn></mrow><mi id="alg4.l15.m1.1.9.3">n</mi></msubsup><mi id="alg4.l15.m1.1.10">e</mi><mi id="alg4.l15.m1.1.11">r</mi><mi id="alg4.l15.m1.1.12">r</mi><mi id="alg4.l15.m1.1.13">o</mi><msubsup id="alg4.l15.m1.1.14"><mi id="alg4.l15.m1.1.14.2.2">r</mi><mi id="alg4.l15.m1.1.14.3">i</mi><mi id="alg4.l15.m1.1.14.2.3">k</mi></msubsup></mrow><annotation encoding="application/x-tex" id="alg4.l15.m1.1c">error^{k}\leftarrow=\frac{1}{n}\sum_{i=1}^{n}error^{k}_{i}</annotation></semantics></math>

</div>
<div id="alg4.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span><span id="alg4.l16.1" class="ltx_text ltx_font_bold">return</span> <math id="alg4.l16.m1.1" class="ltx_Math" alttext="error^{k}" display="inline"><semantics id="alg4.l16.m1.1a"><mrow id="alg4.l16.m1.1.1" xref="alg4.l16.m1.1.1.cmml"><mi id="alg4.l16.m1.1.1.2" xref="alg4.l16.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg4.l16.m1.1.1.1" xref="alg4.l16.m1.1.1.1.cmml">​</mo><mi id="alg4.l16.m1.1.1.3" xref="alg4.l16.m1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l16.m1.1.1.1a" xref="alg4.l16.m1.1.1.1.cmml">​</mo><mi id="alg4.l16.m1.1.1.4" xref="alg4.l16.m1.1.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg4.l16.m1.1.1.1b" xref="alg4.l16.m1.1.1.1.cmml">​</mo><mi id="alg4.l16.m1.1.1.5" xref="alg4.l16.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg4.l16.m1.1.1.1c" xref="alg4.l16.m1.1.1.1.cmml">​</mo><msup id="alg4.l16.m1.1.1.6" xref="alg4.l16.m1.1.1.6.cmml"><mi id="alg4.l16.m1.1.1.6.2" xref="alg4.l16.m1.1.1.6.2.cmml">r</mi><mi id="alg4.l16.m1.1.1.6.3" xref="alg4.l16.m1.1.1.6.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg4.l16.m1.1b"><apply id="alg4.l16.m1.1.1.cmml" xref="alg4.l16.m1.1.1"><times id="alg4.l16.m1.1.1.1.cmml" xref="alg4.l16.m1.1.1.1"></times><ci id="alg4.l16.m1.1.1.2.cmml" xref="alg4.l16.m1.1.1.2">𝑒</ci><ci id="alg4.l16.m1.1.1.3.cmml" xref="alg4.l16.m1.1.1.3">𝑟</ci><ci id="alg4.l16.m1.1.1.4.cmml" xref="alg4.l16.m1.1.1.4">𝑟</ci><ci id="alg4.l16.m1.1.1.5.cmml" xref="alg4.l16.m1.1.1.5">𝑜</ci><apply id="alg4.l16.m1.1.1.6.cmml" xref="alg4.l16.m1.1.1.6"><csymbol cd="ambiguous" id="alg4.l16.m1.1.1.6.1.cmml" xref="alg4.l16.m1.1.1.6">superscript</csymbol><ci id="alg4.l16.m1.1.1.6.2.cmml" xref="alg4.l16.m1.1.1.6.2">𝑟</ci><ci id="alg4.l16.m1.1.1.6.3.cmml" xref="alg4.l16.m1.1.1.6.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l16.m1.1c">error^{k}</annotation></semantics></math>

</div>
<div id="alg4.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span><math id="alg4.l17.m1.1" class="ltx_Math" alttext="\left(\texttt{Up-bound}_{k}\right)_{k=1\cdots K}" display="inline"><semantics id="alg4.l17.m1.1a"><msub id="alg4.l17.m1.1.1" xref="alg4.l17.m1.1.1.cmml"><mrow id="alg4.l17.m1.1.1.1.1" xref="alg4.l17.m1.1.1.1.1.1.cmml"><mo id="alg4.l17.m1.1.1.1.1.2" xref="alg4.l17.m1.1.1.1.1.1.cmml">(</mo><msub id="alg4.l17.m1.1.1.1.1.1" xref="alg4.l17.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg4.l17.m1.1.1.1.1.1.2" xref="alg4.l17.m1.1.1.1.1.1.2a.cmml">Up-bound</mtext><mi id="alg4.l17.m1.1.1.1.1.1.3" xref="alg4.l17.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg4.l17.m1.1.1.1.1.3" xref="alg4.l17.m1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="alg4.l17.m1.1.1.3" xref="alg4.l17.m1.1.1.3.cmml"><mi id="alg4.l17.m1.1.1.3.2" xref="alg4.l17.m1.1.1.3.2.cmml">k</mi><mo id="alg4.l17.m1.1.1.3.1" xref="alg4.l17.m1.1.1.3.1.cmml">=</mo><mrow id="alg4.l17.m1.1.1.3.3" xref="alg4.l17.m1.1.1.3.3.cmml"><mn id="alg4.l17.m1.1.1.3.3.2" xref="alg4.l17.m1.1.1.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg4.l17.m1.1.1.3.3.1" xref="alg4.l17.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="alg4.l17.m1.1.1.3.3.3" xref="alg4.l17.m1.1.1.3.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="alg4.l17.m1.1.1.3.3.1a" xref="alg4.l17.m1.1.1.3.3.1.cmml">​</mo><mi id="alg4.l17.m1.1.1.3.3.4" xref="alg4.l17.m1.1.1.3.3.4.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg4.l17.m1.1b"><apply id="alg4.l17.m1.1.1.cmml" xref="alg4.l17.m1.1.1"><csymbol cd="ambiguous" id="alg4.l17.m1.1.1.2.cmml" xref="alg4.l17.m1.1.1">subscript</csymbol><apply id="alg4.l17.m1.1.1.1.1.1.cmml" xref="alg4.l17.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l17.m1.1.1.1.1.1.1.cmml" xref="alg4.l17.m1.1.1.1.1">subscript</csymbol><ci id="alg4.l17.m1.1.1.1.1.1.2a.cmml" xref="alg4.l17.m1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg4.l17.m1.1.1.1.1.1.2.cmml" xref="alg4.l17.m1.1.1.1.1.1.2">Up-bound</mtext></ci><ci id="alg4.l17.m1.1.1.1.1.1.3.cmml" xref="alg4.l17.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg4.l17.m1.1.1.3.cmml" xref="alg4.l17.m1.1.1.3"><eq id="alg4.l17.m1.1.1.3.1.cmml" xref="alg4.l17.m1.1.1.3.1"></eq><ci id="alg4.l17.m1.1.1.3.2.cmml" xref="alg4.l17.m1.1.1.3.2">𝑘</ci><apply id="alg4.l17.m1.1.1.3.3.cmml" xref="alg4.l17.m1.1.1.3.3"><times id="alg4.l17.m1.1.1.3.3.1.cmml" xref="alg4.l17.m1.1.1.3.3.1"></times><cn type="integer" id="alg4.l17.m1.1.1.3.3.2.cmml" xref="alg4.l17.m1.1.1.3.3.2">1</cn><ci id="alg4.l17.m1.1.1.3.3.3.cmml" xref="alg4.l17.m1.1.1.3.3.3">⋯</ci><ci id="alg4.l17.m1.1.1.3.3.4.cmml" xref="alg4.l17.m1.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l17.m1.1c">\left(\texttt{Up-bound}_{k}\right)_{k=1\cdots K}</annotation></semantics></math> each valid with probability <math id="alg4.l17.m2.1" class="ltx_Math" alttext="1-\delta-\delta^{{}^{\prime}}" display="inline"><semantics id="alg4.l17.m2.1a"><mrow id="alg4.l17.m2.1.1" xref="alg4.l17.m2.1.1.cmml"><mn id="alg4.l17.m2.1.1.2" xref="alg4.l17.m2.1.1.2.cmml">1</mn><mo id="alg4.l17.m2.1.1.1" xref="alg4.l17.m2.1.1.1.cmml">−</mo><mi id="alg4.l17.m2.1.1.3" xref="alg4.l17.m2.1.1.3.cmml">δ</mi><mo id="alg4.l17.m2.1.1.1a" xref="alg4.l17.m2.1.1.1.cmml">−</mo><msup id="alg4.l17.m2.1.1.4" xref="alg4.l17.m2.1.1.4.cmml"><mi id="alg4.l17.m2.1.1.4.2" xref="alg4.l17.m2.1.1.4.2.cmml">δ</mi><msup id="alg4.l17.m2.1.1.4.3" xref="alg4.l17.m2.1.1.4.3.cmml"><mi id="alg4.l17.m2.1.1.4.3a" xref="alg4.l17.m2.1.1.4.3.cmml"></mi><mo id="alg4.l17.m2.1.1.4.3.1" xref="alg4.l17.m2.1.1.4.3.1.cmml">′</mo></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg4.l17.m2.1b"><apply id="alg4.l17.m2.1.1.cmml" xref="alg4.l17.m2.1.1"><minus id="alg4.l17.m2.1.1.1.cmml" xref="alg4.l17.m2.1.1.1"></minus><cn type="integer" id="alg4.l17.m2.1.1.2.cmml" xref="alg4.l17.m2.1.1.2">1</cn><ci id="alg4.l17.m2.1.1.3.cmml" xref="alg4.l17.m2.1.1.3">𝛿</ci><apply id="alg4.l17.m2.1.1.4.cmml" xref="alg4.l17.m2.1.1.4"><csymbol cd="ambiguous" id="alg4.l17.m2.1.1.4.1.cmml" xref="alg4.l17.m2.1.1.4">superscript</csymbol><ci id="alg4.l17.m2.1.1.4.2.cmml" xref="alg4.l17.m2.1.1.4.2">𝛿</ci><apply id="alg4.l17.m2.1.1.4.3.cmml" xref="alg4.l17.m2.1.1.4.3"><ci id="alg4.l17.m2.1.1.4.3.1.cmml" xref="alg4.l17.m2.1.1.4.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l17.m2.1c">1-\delta-\delta^{{}^{\prime}}</annotation></semantics></math>

</div>
</div>
</figure>
<div id="A2.SS0.SSS0.Px1.p5" class="ltx_para ltx_noindent">
<p id="A2.SS0.SSS0.Px1.p5.2" class="ltx_p"><a href="#alg4" title="In PAC-Bayes learning objectives ‣ Appendix B Additional details for Section 3.2" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">4</span></a> simply computes each PAC-Bayesian associated fort each client. Note that here <math id="A2.SS0.SSS0.Px1.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{S}_{k}^{2}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p5.1.m1.1a"><msubsup id="A2.SS0.SSS0.Px1.p5.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.2" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.2.cmml">𝒮</mi><mi id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.3" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.3.cmml">k</mi><mn id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.3" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p5.1.m1.1b"><apply id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1">superscript</csymbol><apply id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.1.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.2.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.2">𝒮</ci><ci id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.3.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="A2.SS0.SSS0.Px1.p5.1.m1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p5.1.m1.1c">\mathcal{S}_{k}^{2}</annotation></semantics></math> denotes the halve of <math id="A2.SS0.SSS0.Px1.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{S}_{k}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p5.2.m2.1a"><msub id="A2.SS0.SSS0.Px1.p5.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.2" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1.2.cmml">𝒮</mi><mi id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.3" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p5.2.m2.1b"><apply id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1.2">𝒮</ci><ci id="A2.SS0.SSS0.Px1.p5.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p5.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p5.2.m2.1c">\mathcal{S}_{k}</annotation></semantics></math> which has not been used to train the prior distribution.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional experiments </h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Additional experiments to compare with <cite class="ltx_cite ltx_citemacro_cite">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite>
</h3>

<div id="A3.SS1.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.p1.1" class="ltx_p">We also provide a proof of concept of <span id="A3.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">GenFL</span> by comparing with former method from <cite class="ltx_cite ltx_citemacro_cite">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="A3.SS1.p2" class="ltx_para ltx_noindent">
<p id="A3.SS1.p2.1" class="ltx_p"><span id="A3.SS1.p2.1.1" class="ltx_text ltx_font_bold">Computation time</span> The training procedures (prior, posterior) take separately several hours. The bound computation is slowered due Monte Carlo sampling.</p>
</div>
<section id="A3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.1.1 </span>Setup</h4>

<section id="A3.SS1.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Dataset Partition</h5>

<div id="A3.SS1.SSS1.Px1.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.SSS1.Px1.p1.1" class="ltx_p">We used the exact same dataset partition as previously, the exact <span id="A3.SS1.SSS1.Px1.p1.1.1" class="ltx_text ltx_font_italic">i.i.d.</span> partition. Each Client will have the exact same number of samples per class and same number of class.
Resulting in a dataset size of <math id="A3.SS1.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="540*100=54000" display="inline"><semantics id="A3.SS1.SSS1.Px1.p1.1.m1.1a"><mrow id="A3.SS1.SSS1.Px1.p1.1.m1.1.1" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.cmml"><mrow id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.cmml"><mn id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.2" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.2.cmml">540</mn><mo lspace="0.222em" rspace="0.222em" id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.1" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.1.cmml">∗</mo><mn id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.3" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.3.cmml">100</mn></mrow><mo id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.1" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.3" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.3.cmml">54000</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px1.p1.1.m1.1b"><apply id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1"><eq id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.1"></eq><apply id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2"><times id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.1.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.1"></times><cn type="integer" id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.2.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.2">540</cn><cn type="integer" id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.3.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.2.3">100</cn></apply><cn type="integer" id="A3.SS1.SSS1.Px1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.SSS1.Px1.p1.1.m1.1.1.3">54000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px1.p1.1.m1.1c">540*100=54000</annotation></semantics></math></p>
</div>
</section>
<section id="A3.SS1.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Random initialization of the prior</h5>

<div id="A3.SS1.SSS1.Px2.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.SSS1.Px2.p1.10" class="ltx_p">The prior is <math id="A3.SS1.SSS1.Px2.p1.1.m1.2" class="ltx_Math" alttext="P=\mathcal{N}(w_{0},\lambda Id)" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.1.m1.2a"><mrow id="A3.SS1.SSS1.Px2.p1.1.m1.2.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.4" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.4.cmml">P</mi><mo id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.3" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.4" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.3.cmml">​</mo><mrow id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.3.cmml">(</mo><msub id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml">w</mi><mn id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.3" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.4" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.3.cmml">,</mo><mrow id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1a" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.4" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.4.cmml">d</mi></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.5" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.1.m1.2b"><apply id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2"><eq id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.3"></eq><ci id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.4.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.4">𝑃</ci><apply id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2"><times id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.3"></times><ci id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.4.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.4">𝒩</ci><interval closure="open" id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2"><apply id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.2">𝑤</ci><cn type="integer" id="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.3">0</cn></apply><apply id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2"><times id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.1"></times><ci id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.2">𝜆</ci><ci id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.3">𝐼</ci><ci id="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.4.cmml" xref="A3.SS1.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.4">𝑑</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.1.m1.2c">P=\mathcal{N}(w_{0},\lambda Id)</annotation></semantics></math>, and <math id="A3.SS1.SSS1.Px2.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.2.m2.1a"><mi id="A3.SS1.SSS1.Px2.p1.2.m2.1.1" xref="A3.SS1.SSS1.Px2.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.2.m2.1b"><ci id="A3.SS1.SSS1.Px2.p1.2.m2.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.2.m2.1c">\lambda</annotation></semantics></math> is a hyperparameter that is learn during optimization. In order to have a union bound argument,
This <math id="A3.SS1.SSS1.Px2.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.3.m3.1a"><mi id="A3.SS1.SSS1.Px2.p1.3.m3.1.1" xref="A3.SS1.SSS1.Px2.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.3.m3.1b"><ci id="A3.SS1.SSS1.Px2.p1.3.m3.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.3.m3.1c">\lambda</annotation></semantics></math> must be discretize using the following formula: <math id="A3.SS1.SSS1.Px2.p1.4.m4.2" class="ltx_Math" alttext="\lambda=c\exp(-j/b)" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.4.m4.2a"><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.3" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.3.cmml">λ</mi><mo id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.2.cmml">=</mo><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.3" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.3.cmml">c</mi><mo lspace="0.167em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.2.cmml">​</mo><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.4.m4.1.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.1.1.cmml">exp</mi><mo id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1a" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml">⁡</mo><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml">(</mo><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.cmml"><mo id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1a" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.cmml">−</mo><mrow id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.2" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml">j</mi><mo id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.1" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.1.cmml">/</mo><mi id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.3" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.3.cmml">b</mi></mrow></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.3" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.4.m4.2b"><apply id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2"><eq id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.2"></eq><ci id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.3">𝜆</ci><apply id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1"><times id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.2"></times><ci id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.3">𝑐</ci><apply id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1"><exp id="A3.SS1.SSS1.Px2.p1.4.m4.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.1.1"></exp><apply id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1"><minus id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1"></minus><apply id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2"><divide id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.1"></divide><ci id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.2">𝑗</ci><ci id="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.4.m4.2.2.1.1.1.1.1.2.3">𝑏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.4.m4.2c">\lambda=c\exp(-j/b)</annotation></semantics></math> with <math id="A3.SS1.SSS1.Px2.p1.5.m5.2" class="ltx_Math" alttext="c=0.1,b=100" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.5.m5.2a"><mrow id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.3.cmml"><mrow id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.2" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.2.cmml">c</mi><mo id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.3" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.3.cmml">0.1</mn></mrow><mo id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.3a.cmml">,</mo><mrow id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.cmml"><mi id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.2.cmml">b</mi><mo id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.1" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.5.m5.2b"><apply id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2"><csymbol cd="ambiguous" id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.3a.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.3">formulae-sequence</csymbol><apply id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1"><eq id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.1"></eq><ci id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.2">𝑐</ci><cn type="float" id="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.1.1.1.1.3">0.1</cn></apply><apply id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2"><eq id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.1"></eq><ci id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.2">𝑏</ci><cn type="integer" id="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.5.m5.2.2.2.2.3">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.5.m5.2c">c=0.1,b=100</annotation></semantics></math> two fixed constant and <math id="A3.SS1.SSS1.Px2.p1.6.m6.1" class="ltx_Math" alttext="j\in\mathbb{N}" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.6.m6.1a"><mrow id="A3.SS1.SSS1.Px2.p1.6.m6.1.1" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.2" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.2.cmml">j</mi><mo id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.1" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.1.cmml">∈</mo><mi id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.3" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.6.m6.1b"><apply id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1"><in id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.1"></in><ci id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.2">𝑗</ci><ci id="A3.SS1.SSS1.Px2.p1.6.m6.1.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.6.m6.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.6.m6.1c">j\in\mathbb{N}</annotation></semantics></math>.
The <math id="A3.SS1.SSS1.Px2.p1.7.m7.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.7.m7.1a"><msub id="A3.SS1.SSS1.Px2.p1.7.m7.1.1" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.2" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1.2.cmml">w</mi><mn id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.3" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.7.m7.1b"><apply id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1.2">𝑤</ci><cn type="integer" id="A3.SS1.SSS1.Px2.p1.7.m7.1.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.7.m7.1c">w_{0}</annotation></semantics></math> is sampled throught the distribution <math id="A3.SS1.SSS1.Px2.p1.8.m8.2" class="ltx_Math" alttext="\mathcal{N}(0,\sigma)" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.8.m8.2a"><mrow id="A3.SS1.SSS1.Px2.p1.8.m8.2.3" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.2" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.1" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.1.cmml">​</mo><mrow id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.2" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.1.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.2.1" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.1.cmml">(</mo><mn id="A3.SS1.SSS1.Px2.p1.8.m8.1.1" xref="A3.SS1.SSS1.Px2.p1.8.m8.1.1.cmml">0</mn><mo id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.2.2" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.1.cmml">,</mo><mi id="A3.SS1.SSS1.Px2.p1.8.m8.2.2" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.2.cmml">σ</mi><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.2.3" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.8.m8.2b"><apply id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3"><times id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.1.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.1"></times><ci id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.2.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.2">𝒩</ci><interval closure="open" id="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.1.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.3.3.2"><cn type="integer" id="A3.SS1.SSS1.Px2.p1.8.m8.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.1.1">0</cn><ci id="A3.SS1.SSS1.Px2.p1.8.m8.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.8.m8.2.2">𝜎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.8.m8.2c">\mathcal{N}(0,\sigma)</annotation></semantics></math> and then truncated to <math id="A3.SS1.SSS1.Px2.p1.9.m9.2" class="ltx_Math" alttext="[-2\sigma,2\sigma]" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.9.m9.2a"><mrow id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.3.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.3.cmml">[</mo><mrow id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.cmml"><mo id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1a" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.cmml">−</mo><mrow id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.cmml"><mn id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.2" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.1" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.1.cmml">​</mo><mi id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.3" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.3.cmml">σ</mi></mrow></mrow><mo id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.4" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.3.cmml">,</mo><mrow id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.cmml"><mn id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.2" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.1" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.1.cmml">​</mo><mi id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.3" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.3.cmml">σ</mi></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.5" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.9.m9.2b"><interval closure="closed" id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2"><apply id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1"><minus id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1"></minus><apply id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2"><times id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.1"></times><cn type="integer" id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.2">2</cn><ci id="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.1.1.1.1.2.3">𝜎</ci></apply></apply><apply id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2"><times id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.1.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.1"></times><cn type="integer" id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.2">2</cn><ci id="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px2.p1.9.m9.2.2.2.2.3">𝜎</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.9.m9.2c">[-2\sigma,2\sigma]</annotation></semantics></math>. We used <math id="A3.SS1.SSS1.Px2.p1.10.m10.1" class="ltx_Math" alttext="\sigma=0.04" display="inline"><semantics id="A3.SS1.SSS1.Px2.p1.10.m10.1a"><mrow id="A3.SS1.SSS1.Px2.p1.10.m10.1.1" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.cmml"><mi id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.2" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.2.cmml">σ</mi><mo id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.1" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.3" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px2.p1.10.m10.1b"><apply id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1"><eq id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.1.cmml" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.1"></eq><ci id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.2.cmml" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.2">𝜎</ci><cn type="float" id="A3.SS1.SSS1.Px2.p1.10.m10.1.1.3.cmml" xref="A3.SS1.SSS1.Px2.p1.10.m10.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px2.p1.10.m10.1c">\sigma=0.04</annotation></semantics></math>.</p>
</div>
</section>
<section id="A3.SS1.SSS1.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">SGD on centered parameters of the posterior</h5>

<div id="A3.SS1.SSS1.Px3.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.SSS1.Px3.p1.1" class="ltx_p">For stability reason, <cite class="ltx_cite ltx_citemacro_cite">Dziugaite and Roy, (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> proposed to learn the centered parameters of the posterior <math id="A3.SS1.SSS1.Px3.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="A3.SS1.SSS1.Px3.p1.1.m1.1a"><mi id="A3.SS1.SSS1.Px3.p1.1.m1.1.1" xref="A3.SS1.SSS1.Px3.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px3.p1.1.m1.1b"><ci id="A3.SS1.SSS1.Px3.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS1.Px3.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px3.p1.1.m1.1c">w</annotation></semantics></math> via SGD on train set.
Doing this step, provide better result than learning the posterior directly. But is a deceiving step, because in this case, PAC-Bayes from scratch is not self-sufficient.</p>
</div>
</section>
<section id="A3.SS1.SSS1.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Learn posterior from the SGD</h5>

<div id="A3.SS1.SSS1.Px4.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.SSS1.Px4.p1.3" class="ltx_p">Then the posterior is initalized to <math id="A3.SS1.SSS1.Px4.p1.1.m1.3" class="ltx_Math" alttext="Q=\mathcal{N}(w,Diag(|w|))" display="inline"><semantics id="A3.SS1.SSS1.Px4.p1.1.m1.3a"><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.cmml"><mi id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.3.cmml">Q</mi><mo id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.2.cmml">=</mo><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.2.cmml">​</mo><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.2.cmml">(</mo><mi id="A3.SS1.SSS1.Px4.p1.1.m1.2.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.2.2.cmml">w</mi><mo id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.2.cmml">,</mo><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.4" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2a" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.5" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2b" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.6" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2c" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.2.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A3.SS1.SSS1.Px4.p1.1.m1.1.1" xref="A3.SS1.SSS1.Px4.p1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.3" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.4" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px4.p1.1.m1.3b"><apply id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3"><eq id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.2.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.2"></eq><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.3.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.3">𝑄</ci><apply id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1"><times id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.2.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.2"></times><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.3.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.3">𝒩</ci><interval closure="open" id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.2.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1"><ci id="A3.SS1.SSS1.Px4.p1.1.m1.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.2.2">𝑤</ci><apply id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1"><times id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.2"></times><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.3">𝐷</ci><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.4.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.4">𝑖</ci><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.5.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.5">𝑎</ci><ci id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.6.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.6">𝑔</ci><apply id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.2"><abs id="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.3.3.1.1.1.1.1.1.1.2.1"></abs><ci id="A3.SS1.SSS1.Px4.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.1.m1.1.1">𝑤</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px4.p1.1.m1.3c">Q=\mathcal{N}(w,Diag(|w|))</annotation></semantics></math> (<math id="A3.SS1.SSS1.Px4.p1.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="A3.SS1.SSS1.Px4.p1.2.m2.1a"><mi id="A3.SS1.SSS1.Px4.p1.2.m2.1.1" xref="A3.SS1.SSS1.Px4.p1.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px4.p1.2.m2.1b"><ci id="A3.SS1.SSS1.Px4.p1.2.m2.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px4.p1.2.m2.1c">w</annotation></semantics></math> coming from the previous SGD).
This posterior is optimized on the classic Mc Allester loss: <math id="A3.SS1.SSS1.Px4.p1.3.m3.3" class="ltx_Math" alttext="\hat{\text{R}}_{\mathcal{S}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}" display="inline"><semantics id="A3.SS1.SSS1.Px4.p1.3.m3.3a"><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.3.4" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.cmml"><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.cmml"><msub id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.cmml"><mover accent="true" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.cmml"><mtext id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2a.cmml">R</mtext><mo id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.1.cmml">^</mo></mover><mi class="ltx_font_mathcaligraphic" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.3.cmml">𝒮</mi></msub><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.1.cmml">​</mo><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.3.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.3.2.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.cmml">(</mo><mi id="A3.SS1.SSS1.Px4.p1.3.m3.3.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.3.cmml">Q</mi><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.3.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.1.cmml">+</mo><msqrt id="A3.SS1.SSS1.Px4.p1.3.m3.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.cmml"><mfrac id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.cmml"><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.cmml"><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml"><mi id="A3.SS1.SSS1.Px4.p1.3.m3.1.1.1.1.1.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.1.1.1.1.1.1.cmml">KL</mi><mo id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1a" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml">(</mo><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml"><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.2.cmml">Q</mi><mo id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.1.cmml">∥</mo><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo stretchy="false" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.3.cmml">+</mo><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.cmml"><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4a" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.cmml">⁡</mo><mfrac id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.cmml"><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.cmml"><mn id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.1.cmml">​</mo><msqrt id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.cmml"><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.2.cmml">m</mi></msqrt></mrow><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.3.cmml">δ</mi></mfrac></mrow></mrow><mrow id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.cmml"><mn id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.2" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.1" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.1.cmml">​</mo><mi id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.3" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.3.cmml">m</mi></mrow></mfrac></msqrt></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px4.p1.3.m3.3b"><apply id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4"><plus id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.1"></plus><apply id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2"><times id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.1"></times><apply id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2"><csymbol cd="ambiguous" id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2">subscript</csymbol><apply id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2"><ci id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.1">^</ci><ci id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2a.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2"><mtext id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.2.2">R</mtext></ci></apply><ci id="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.4.2.2.3">𝒮</ci></apply><ci id="A3.SS1.SSS1.Px4.p1.3.m3.3.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.3.3">𝑄</ci></apply><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2"><root id="A3.SS1.SSS1.Px4.p1.3.m3.2.2a.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2"></root><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2"><divide id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2"></divide><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2"><plus id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.3"></plus><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1"><ci id="A3.SS1.SSS1.Px4.p1.3.m3.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.1.1.1.1.1.1">KL</ci><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.2">𝑄</ci><ci id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.2.1.1.1.3">𝑃</ci></apply></apply><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4"><ln id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.1"></ln><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2"><divide id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2"></divide><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2"><times id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.1"></times><cn type="integer" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.2">2</cn><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3"><root id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3a.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3"></root><ci id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.2.3.2">𝑚</ci></apply></apply><ci id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.2.2.4.2.3">𝛿</ci></apply></apply></apply><apply id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4"><times id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.1.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.1"></times><cn type="integer" id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.2.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.2">2</cn><ci id="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.3.cmml" xref="A3.SS1.SSS1.Px4.p1.3.m3.2.2.2.4.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px4.p1.3.m3.3c">\hat{\text{R}}_{\mathcal{S}}(Q)+\sqrt{\frac{\operatorname{KL}(Q\|P)+\ln{\frac{2\sqrt{m}}{\delta}}}{2m}}</annotation></semantics></math></p>
</div>
</section>
<section id="A3.SS1.SSS1.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Bounds parameters</h5>

<div id="A3.SS1.SSS1.Px5.p1" class="ltx_para ltx_noindent">
<p id="A3.SS1.SSS1.Px5.p1.3" class="ltx_p">Bounds were computed with confidence parameters <math id="A3.SS1.SSS1.Px5.p1.1.m1.1" class="ltx_Math" alttext="\delta=0.05" display="inline"><semantics id="A3.SS1.SSS1.Px5.p1.1.m1.1a"><mrow id="A3.SS1.SSS1.Px5.p1.1.m1.1.1" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.cmml"><mi id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.2" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.2.cmml">δ</mi><mo id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.1" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.3" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px5.p1.1.m1.1b"><apply id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1"><eq id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.1"></eq><ci id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.2.cmml" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.2">𝛿</ci><cn type="float" id="A3.SS1.SSS1.Px5.p1.1.m1.1.1.3.cmml" xref="A3.SS1.SSS1.Px5.p1.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px5.p1.1.m1.1c">\delta=0.05</annotation></semantics></math>, <math id="A3.SS1.SSS1.Px5.p1.2.m2.1" class="ltx_Math" alttext="\delta^{{}^{\prime}}=0.01" display="inline"><semantics id="A3.SS1.SSS1.Px5.p1.2.m2.1a"><mrow id="A3.SS1.SSS1.Px5.p1.2.m2.1.1" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.cmml"><msup id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.cmml"><mi id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.2" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.2.cmml">δ</mi><msup id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.cmml"><mi id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3a" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.cmml"></mi><mo id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.1" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.1.cmml">′</mo></msup></msup><mo id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.1" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.3" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px5.p1.2.m2.1b"><apply id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1"><eq id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.1"></eq><apply id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.1.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2">superscript</csymbol><ci id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.2.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.2">𝛿</ci><apply id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3"><ci id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.1.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.2.3.1">′</ci></apply></apply><cn type="float" id="A3.SS1.SSS1.Px5.p1.2.m2.1.1.3.cmml" xref="A3.SS1.SSS1.Px5.p1.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px5.p1.2.m2.1c">\delta^{{}^{\prime}}=0.01</annotation></semantics></math> and with <math id="A3.SS1.SSS1.Px5.p1.3.m3.1" class="ltx_Math" alttext="n=150000" display="inline"><semantics id="A3.SS1.SSS1.Px5.p1.3.m3.1a"><mrow id="A3.SS1.SSS1.Px5.p1.3.m3.1.1" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.cmml"><mi id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.2" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.2.cmml">n</mi><mo id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.1" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.3" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.3.cmml">150000</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS1.Px5.p1.3.m3.1b"><apply id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1"><eq id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.1.cmml" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.1"></eq><ci id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.2.cmml" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.2">𝑛</ci><cn type="integer" id="A3.SS1.SSS1.Px5.p1.3.m3.1.1.3.cmml" xref="A3.SS1.SSS1.Px5.p1.3.m3.1.1.3">150000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS1.Px5.p1.3.m3.1c">n=150000</annotation></semantics></math> monte carlo samples.</p>
</div>
</section>
</section>
<section id="A3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.1.2 </span>Results</h4>

<figure id="A3.T3" class="ltx_table">
<table id="A3.T3.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T3.2.3.1" class="ltx_tr">
<td id="A3.T3.2.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Metrics</td>
<td id="A3.T3.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">GenFL</td>
<td id="A3.T3.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">GenFL</td>
<td id="A3.T3.2.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dziugaite</td>
</tr>
<tr id="A3.T3.2.4.2" class="ltx_tr">
<td id="A3.T3.2.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Clients number</td>
<td id="A3.T3.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="A3.T3.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1</td>
<td id="A3.T3.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">”1”</td>
</tr>
<tr id="A3.T3.2.5.3" class="ltx_tr">
<td id="A3.T3.2.5.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Trainset Size</td>
<td id="A3.T3.2.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54000</td>
<td id="A3.T3.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54000</td>
<td id="A3.T3.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60000</td>
</tr>
<tr id="A3.T3.2.2" class="ltx_tr">
<td id="A3.T3.2.2.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Train Error</td>
<td id="A3.T3.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.013</td>
<td id="A3.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="A3.T3.1.1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.T3.1.1.1.m1.1a"><mo id="A3.T3.1.1.1.m1.1.1" xref="A3.T3.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="A3.T3.1.1.1.m1.1.1.cmml" xref="A3.T3.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.1.1.1.m1.1c">\sim</annotation></semantics></math>0</td>
<td id="A3.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="A3.T3.2.2.2.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.T3.2.2.2.m1.1a"><mo id="A3.T3.2.2.2.m1.1.1" xref="A3.T3.2.2.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="A3.T3.2.2.2.m1.1.1.cmml" xref="A3.T3.2.2.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.2.2.2.m1.1c">\sim</annotation></semantics></math>0</td>
</tr>
<tr id="A3.T3.2.6.4" class="ltx_tr">
<td id="A3.T3.2.6.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Test Error</td>
<td id="A3.T3.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.019</td>
<td id="A3.T3.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.018</td>
<td id="A3.T3.2.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.016</td>
</tr>
<tr id="A3.T3.2.7.5" class="ltx_tr">
<td id="A3.T3.2.7.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SNN Train Error</td>
<td id="A3.T3.2.7.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.051</td>
<td id="A3.T3.2.7.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.039</td>
<td id="A3.T3.2.7.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.028</td>
</tr>
<tr id="A3.T3.2.8.6" class="ltx_tr">
<td id="A3.T3.2.8.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SNN Test Error</td>
<td id="A3.T3.2.8.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.051</td>
<td id="A3.T3.2.8.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.043</td>
<td id="A3.T3.2.8.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.033</td>
</tr>
<tr id="A3.T3.2.9.7" class="ltx_tr">
<td id="A3.T3.2.9.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">PAC-Bayes Bound</td>
<td id="A3.T3.2.9.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.241</td>
<td id="A3.T3.2.9.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.175</td>
<td id="A3.T3.2.9.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.186</td>
</tr>
<tr id="A3.T3.2.10.8" class="ltx_tr">
<td id="A3.T3.2.10.8.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">KL divergence</td>
<td id="A3.T3.2.10.8.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">7039</td>
<td id="A3.T3.2.10.8.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">4629</td>
<td id="A3.T3.2.10.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">6534</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Train and Test Error are the ones from the optimized (deterministic) NN learnt by the SGD.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.11202" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.11203" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.11203">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.11203" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.11204" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 23:50:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
