<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal</title>
<!--Generated on Sat Sep 28 04:41:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.19679v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S1" title="In SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2" title="In SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.SS1" title="In 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Restoration in Adverse Weather Conditions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.SS2" title="In 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Semi-Supervised Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.SS3" title="In 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Diffusion-based Generative Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3" title="In SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The Proposed SemiDDM-Weather</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS1" title="In 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Semi-Supervised Adverse Weather Removal Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS2" title="In 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Customization of a Wavelet Diffusion Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS3" title="In 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Target Design for Enhancing Pseudo-label Accuracy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS4" title="In 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Training and Inference details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4" title="In SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.SS1" title="In 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Comparison with SOTA Competitors</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.SS2" title="In 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance on Real-World Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.SS3" title="In 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Application in the Wild</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.SS4" title="In 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.SS5" title="In 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Model Complexity Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S5" title="In SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fang Long
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:longfang@e.gzhu.edu.cn">longfang@e.gzhu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenkang Su
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:swk1004@gzhu.edu.cn">swk1004@gzhu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zixuan Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lizx@e.gzhu.edu.cn">lizx@e.gzhu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Cai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lcai_gxy@hqu.edu.cn">lcai_gxy@hqu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mingjie Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:limingjie@gzhu.edu.cn">limingjie@gzhu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuan-Gen Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wangyg@gzhu.edu.cn">wangyg@gzhu.edu.cn</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaochun Cao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:caoxiaochun@mail.sysu.edu.cn">caoxiaochun@mail.sysu.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Adverse weather removal aims to restore clear vision under adverse weather conditions. Existing methods are mostly tailored for specific weather types and rely heavily on extensive labeled data. In dealing with these two limitations, this paper presents a pioneering semi-supervised all-in-one adverse weather removal framework built on the teacher-student network with a Denoising Diffusion Model (DDM) as the backbone, termed SemiDDM-Weather. As for the design of DDM backbone in our SemiDDM-Weather, we adopt the SOTA Wavelet Diffusion Model-Wavediff with customized inputs and loss functions, devoted to facilitating the learning of many-to-one mapping distributions for efficient all-in-one adverse weather removal with limited label data. To mitigate the risk of misleading model training due to potentially inaccurate pseudo-labels generated by the teacher network in semi-supervised learning, we introduce quality assessment and content consistency constraints to screen the “optimal” outputs from the teacher network as the pseudo-labels, thus more effectively guiding the student network training with unlabeled data. Experimental results show that on both synthetic and real-world datasets, our SemiDDM-Weather consistently delivers high visual quality and superior adverse weather removal, even when compared to fully supervised competitors.
Our code and pre-trained model are available at <a class="ltx_ref ltx_href" href="https://github.com/longfafffa/SemiDDM-Weather" title="">this repository</a>.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Adverse weather removal, all-in-one, semi-supervised, denoising diffusion model.

</div>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\affiliation</span>
<p class="ltx_p" id="p1.2">[inst1]organization=School of Computer Science and Cyber Engineering,addressline=Guangzhou University,
city=Guangzhou,
postcode=510006,
state=Guangdong,
country=China

<span class="ltx_ERROR undefined" id="p1.2.1">\affiliation</span>[inst2]organization=College of Engineering,
addressline=Huaqiao University,
city=Quanzhou,
postcode=361021,
state=Fujian,
country=China

<span class="ltx_ERROR undefined" id="p1.2.2">\affiliation</span>[inst3]organization=School of Cyber Science and Technology,
addressline=Shenzhen Campus of Sun Yat-sen University,
city=Shenzhen,
postcode=518107,
state=Guangdong,
country=China</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Images captured under adverse weather conditions such as haze, rain, snow, and adhering raindrops often suffer from degraded visual quality, which not only affects the aesthetics of the image, but also potentially jeopardizes the performance of various downstream vision applications (e.g., detection <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib1" title="">1</a>]</cite>, segmentation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib2" title="">2</a>]</cite>, and depth estimation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib3" title="">3</a>]</cite>). Consequently, removing the impact of adverse weather conditions is crucial and has drawn much attention to computer vision.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Over the past decade, remarkable achievements in the visual quality of restored images for different adverse weather conditions have been made <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib6" title="">6</a>]</cite>. Most of them, however, are tailored to address a specific weather degradation, making it difficult to meet the demands in practical situations, as degradation usually varies in the wild. In this regard, some advanced <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">all-in-one</em> methods <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib9" title="">9</a>]</cite> have been developed, capable of restoring clear images from various adverse weather conditions without the need for any other targeted designs. Despite their notable progress, all of them are designed to learn the many-to-one mapping in a supervised manner, which requires large amounts of pairwise degraded-clear image samples for training. However, acquiring such paired images under adverse weather conditions poses a considerable challenge. Semi-supervised learning emerges as a viable solution to overcome the scarcity of paired data across various computer vision applications. Yet, to our knowledge, the exploration of semi-supervised learning techniques for all-in-one adverse weather removal remains an open issue.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Adverse weather removal is widely recognized as an inherently ill-posed inverse problem, seeking to generate a plausible reconstruction for the degraded input. Recent works <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite> have reframed this challenge as a conditional generative modeling task aimed at generating perceptually more plausible samples by drawing from the posterior distribution. Denoising Diffusion Models (DDMs) have emerged as a potent solution, demonstrating remarkable abilities in learning the underlying data distribution <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib12" title="">12</a>]</cite> and thus, hold great promise for this application. They are particularly adept at handling the complex many-to-one mappings that characterize adverse weather removal tasks. WeatherDiff <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite> is a pioneer in employing DDMs for all-in-one adverse weather removal. However, its reliance on supervised training using large amounts of paired data, as well as its lengthy inference times, greatly limits its practicality.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.6">To tackle the challenges presented, we propose a semi-supervised framework called <span class="ltx_text ltx_font_bold" id="S1.p4.6.1">SemiDDM-Weather</span>, which stands out as the first to achieve consistently visual high-quality image restoration in all-in-one adverse weather removal using limited labeled data. The proposed SemiDDM-Weather adopts a teacher-student network <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib13" title="">13</a>]</cite> as the basis for semi-supervised learning, which consists of an identically structured network of student and teacher. The student network is trained using labeled and unlabeled images, while the teacher network is incrementally refined through an Exponential Moving Average (EMA) of the student network’s parameters, devoted to generating pseudo-labels for the unlabeled data to reverse-guide the students’ training.
Inspired by previous methods, we also approach it as a conditional generative modeling task by sampling from the posterior distribution, but here we are in a semi-supervised manner. Therefore, the model backbone must possess strong generative capabilities to learn many-to-one mapping relationships to effectively address the problem of removing various adverse weather conditions with a unified model under limited labeled data.
Excitingly, diffusion models are well-suited for this task due to their superior ability to capture underlying data distributions, as well as their prowess in generating high-quality outputs. Nevertheless, commonly used diffusion models necessitate numerous sampling steps, hindering inference speed and potentially accumulating errors, making semi-supervised learning more challenging. In response to this defect, we customize a wavelet diffusion model to serve as the backbone of both the teacher and student networks, which is built upon the SOTA WaveDiff <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib14" title="">14</a>]</cite>, by modifying its model input and loss function to better adapt to our adverse weather removal task. It requires only four sampling steps instead of the usual hundreds, significantly enhancing inference efficiency and thus reducing cumulative errors from incorrect pseudo-labels.
Specifically, we implement a crop-based training approach that processes <math alttext="64\times 64" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mn id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">64</mn><mo id="S1.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p4.1.m1.1.1.1.cmml">×</mo><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><times id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1"></times><cn id="S1.p4.1.m1.1.1.2.cmml" type="integer" xref="S1.p4.1.m1.1.1.2">64</cn><cn id="S1.p4.1.m1.1.1.3.cmml" type="integer" xref="S1.p4.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">64 × 64</annotation></semantics></math> patches of the degraded image as inputs, optimizing computational efficiency without compromising training effectiveness. Furthermore, we refine the content consistency of the outputs relative to the conditional inputs by integrating perceptual loss into the generator’s training and enhancing the original <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><msub id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">ℒ</mi><mn id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">subscript</csymbol><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">ℒ</ci><cn id="S1.p4.2.m2.1.1.3.cmml" type="integer" xref="S1.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss with a hybrid of <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><msub id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">ℒ</mi><mn id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.3.m3.1.1.1.cmml" xref="S1.p4.3.m3.1.1">subscript</csymbol><ci id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2">ℒ</ci><cn id="S1.p4.3.m3.1.1.3.cmml" type="integer" xref="S1.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><msub id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.4.m4.1.1.2" xref="S1.p4.4.m4.1.1.2.cmml">ℒ</mi><mn id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1">subscript</csymbol><ci id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1.2">ℒ</ci><cn id="S1.p4.4.m4.1.1.3.cmml" type="integer" xref="S1.p4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> losses, which leverages the precision of <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><msub id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2.cmml">ℒ</mi><mn id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1">subscript</csymbol><ci id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2">ℒ</ci><cn id="S1.p4.5.m5.1.1.3.cmml" type="integer" xref="S1.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss while benefiting from the noise resilience of <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><msub id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.6.m6.1.1.2" xref="S1.p4.6.m6.1.1.2.cmml">ℒ</mi><mn id="S1.p4.6.m6.1.1.3" xref="S1.p4.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><apply id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p4.6.m6.1.1.1.cmml" xref="S1.p4.6.m6.1.1">subscript</csymbol><ci id="S1.p4.6.m6.1.1.2.cmml" xref="S1.p4.6.m6.1.1.2">ℒ</ci><cn id="S1.p4.6.m6.1.1.3.cmml" type="integer" xref="S1.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> loss to improve content restoration. Notably, since wavelets are highly frequency-aware, the introduction of the wavelet-based diffusion scheme in our SemiDDM-Weather further sharpens the perceptual quality of the restored images.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Considering the teacher network outputs do not always surpass those of the student network, there is a risk that potentially inaccurate pseudo-labels generated by the teacher network could mislead the training of the student network. To mitigate this risk, the targeted design for the pseudo-label to improve its accuracy has been made.
Specifically, rather than using the current outputs of the teacher network, here we use the “optimal” outputs generated by the teacher network during training as the pseudo-labels to guide the student network training with unlabeled data. As for how to choose the “optimal” ones, we not only incorporate the quality assessment but also introduce content consistency constraints between the generated images and the degraded ones.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In light of the difficulties in acquiring Ground Truth (GT) under adverse weather conditions, traditional Full-Reference Image Quality Assessment (FR-IQA) metrics like PSNR and SSIM fall short in assessing the quality of image restoration. Moreover, our method prioritizes the restoration of perceptually clearer images. Therefore, we did not use pixel-level metrics such as PSNR and SSIM, as these metrics do not fully capture perceptual image quality as perceived by humans, as shown in <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib15" title="">15</a>]</cite>. Instead, we used No-Reference Image Quality Assessment (NR-IQA) metrics for quality evaluation, which aligns with recent studies such as <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib17" title="">17</a>]</cite>. Experimental results indicate that our approach markedly exceeds other SOTA fully-supervised methods, including those tailored for specific and all-in-one weather conditions. Additionally, our method not only counteracts the negative impact of adverse weather in downstream tasks but also outperforms other fully-supervised techniques in mitigating such effects.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In summary, our contributions are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We present a pioneering semi-supervised all-in-one adverse weather removal framework and modify the SOTA Wavediff to serve as the backbone, making it possible for a unified model to effectively remove various adverse weather conditions with limited labeled data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We use the “optimal” outputs from the teacher network in terms of both quality and content, rather than its current outputs, as pseudo-labels, which facilitates more accurate pseudo-labels acquisition, thus benefiting the model training</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Owing to the introduction of wavelet in the model, its strong frequency awareness allows it to restore perceptually clearer images, even beyond the ground truth (GT).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">Though our approach is semi-supervised, experimental results validate that it outperforms the current SOTA fully-supervised ones in restoration capability for various adverse weather scenarios.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Restoration in Adverse Weather Conditions</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Adverse weather removal has been extensively explored in recent years, and existing methods can be divided into two families, i.e., weather-specific methods and all-in-one methods.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p2.1.1">Weather-Specific Methods.</span>
These methods are designed to address specific adverse weather degradations such as deraining, desnowing, raindrop removal, and among others. For <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.2">rain streak removal</span>,
Cai et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib4" title="">4</a>]</cite> utilized the depth and density information to restore images for rain conditions. Zhao et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib6" title="">6</a>]</cite> developed a novel cycle contrastive adversarial framework incorporating Cycle Contrastive Learning (CCL) and Location Contrastive Learning (LCL) to address unsupervised single image deraining problems. Zhang et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib5" title="">5</a>]</cite> introduced a Paired Rain Removal Network (PRRNet), which leverages both stereo images and semantic information to remove rain streaks effectively.
For <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.3">snow removal</span>, Wang et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib18" title="">18</a>]</cite> adopted a multi-sub-networks structure to learn features with different scales to handle snow removal problems. Chen et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib19" title="">19</a>]</cite> developed an innovative and efficient paradigm to improve the performance and generalization ability of snow removal by integrating the degradation perception and background modeling. Chen et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib20" title="">20</a>]</cite> proposed an extremely lightweight recursive network (XLRNet) designed to address de-snowing problems, which is constructed using a single recursive strategy and two novel lightweight modules.
For <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.4">raindrop removal</span>, Quan et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib21" title="">21</a>]</cite> devised a convolutional neural network (CNN) mechanism for raindrop removal.
Wang et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib22" title="">22</a>]</cite> introduce a context-enhanced representation learning and deraining network, with a novel two-branch encoder design to solve the raindrop removal problem.
Chen et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib23" title="">23</a>]</cite> approached this problem from a global perspective to learn and model degradation relationships, thereby removing raindrop degradation.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Although the above methods show excellent removal capabilities for targeted weather conditions, they are difficult to apply to other types of weather conditions, which may cause a significant performance bottleneck in practical applications.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S2.SS1.p4.1.1">All-in-One Methods.</span>
Regarding the above issue, recent researches <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib9" title="">9</a>]</cite> have shifted towards unified (a.k.a., all-in-one) frameworks that aim to handle various types of weather removal using the same model. Li et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib24" title="">24</a>]</cite> designed a generator
with multiple task-specific encoders and a common decoder to handle various adverse weather degradations. Valanarasu et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite> constructed an end-to-end Transformer-based framework to remove various adverse weather. Zhu et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite> incorporated a two-stage training strategy to explore both general weather features and specific weather-related features to solve this problem.
Liu et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib9" title="">9</a>]</cite> introduced a multi-patch skip-forward architecture for the encoder, facilitating the transfer of fine-grained features from the initial layers to deeper layers, thereby enhancing feature embedding with detailed semantics for adverse weather removal.
Recently, the emergence of DDMs with their strong capability in learning underlying data distributions and generating high-quality outputs has led to their application in this field. Notably, Özdenizci et al. <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite> developed a method utilizing patch-based DDM for all-in-one adverse weather removal, achieving a significant advancement. However, although this approach presented commendable restoration results, it requires large amounts of sampling steps and labeled data, which limits its practicality.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Semi-Supervised Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">When labeled data is limited, Semi-Supervised Learning (SSL) plays an important role in improving the model’s performance by leveraging unlabeled data. Pseudo-labeling is one of the most widely used SSL techniques <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib28" title="">28</a>]</cite>, which generates pseudo-labels for unlabeled data based on model predictions. Another technique is consistency regularization <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib30" title="">30</a>]</cite>, which aims to effectively enhance model performance by enforcing consistency among the distributions of multiple augmented samples generated using different data augmentation techniques for the same unlabeled sample. For pseudo-labeling techniques, most algorithms typically employ the teacher-student network, where the teacher network is used to generate pseudo-labels for guiding the training of the student network with unlabeled data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib32" title="">32</a>]</cite>.
However, these approaches can be problematic, as the teacher’s outputs aren’t always better than the student’s, potentially leading to misleading training with incorrect labels. Additionally, for consistency regularization techniques, most methods rely on the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mn id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">ℒ</ci><cn id="S2.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss for consistency regularization constraints. But, refer to <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib32" title="">32</a>]</cite>, the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mn id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">ℒ</ci><cn id="S2.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss may lead the student model to overfit on incorrect predictions, thereby resulting in confirmation bias. To address this issue,  <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib32" title="">32</a>]</cite> not only introduced a reliable bank to store pseudo-labels, which are determined by the NR-IQA method to select the “best-ever” quality outputs from the teacher network as reliable pseudo-labels, but also replaced the typical <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mn id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">ℒ</ci><cn id="S2.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss used in consistency regularization with a contrastive loss.
Nevertheless, only the NR-IQA metric is utilized to determine “best-ever” outputs, focusing primarily on visual quality while neglecting corresponding image content, which may be inadequate for conditional diffusion related to image content.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="106" id="S2.F1.1.g1" src="x1.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The denoising process of WaveDiff. The operations within the dashed box will be iteratively repeated until obtaining the final denoised output <math alttext="q(y_{0}^{\prime})" class="ltx_Math" display="inline" id="S2.F1.3.m1.1"><semantics id="S2.F1.3.m1.1b"><mrow id="S2.F1.3.m1.1.1" xref="S2.F1.3.m1.1.1.cmml"><mi id="S2.F1.3.m1.1.1.3" xref="S2.F1.3.m1.1.1.3.cmml">q</mi><mo id="S2.F1.3.m1.1.1.2" xref="S2.F1.3.m1.1.1.2.cmml">⁢</mo><mrow id="S2.F1.3.m1.1.1.1.1" xref="S2.F1.3.m1.1.1.1.1.1.cmml"><mo id="S2.F1.3.m1.1.1.1.1.2" stretchy="false" xref="S2.F1.3.m1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.F1.3.m1.1.1.1.1.1" xref="S2.F1.3.m1.1.1.1.1.1.cmml"><mi id="S2.F1.3.m1.1.1.1.1.1.2.2" xref="S2.F1.3.m1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S2.F1.3.m1.1.1.1.1.1.2.3" xref="S2.F1.3.m1.1.1.1.1.1.2.3.cmml">0</mn><mo id="S2.F1.3.m1.1.1.1.1.1.3" xref="S2.F1.3.m1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S2.F1.3.m1.1.1.1.1.3" stretchy="false" xref="S2.F1.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.3.m1.1c"><apply id="S2.F1.3.m1.1.1.cmml" xref="S2.F1.3.m1.1.1"><times id="S2.F1.3.m1.1.1.2.cmml" xref="S2.F1.3.m1.1.1.2"></times><ci id="S2.F1.3.m1.1.1.3.cmml" xref="S2.F1.3.m1.1.1.3">𝑞</ci><apply id="S2.F1.3.m1.1.1.1.1.1.cmml" xref="S2.F1.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F1.3.m1.1.1.1.1.1.1.cmml" xref="S2.F1.3.m1.1.1.1.1">superscript</csymbol><apply id="S2.F1.3.m1.1.1.1.1.1.2.cmml" xref="S2.F1.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F1.3.m1.1.1.1.1.1.2.1.cmml" xref="S2.F1.3.m1.1.1.1.1">subscript</csymbol><ci id="S2.F1.3.m1.1.1.1.1.1.2.2.cmml" xref="S2.F1.3.m1.1.1.1.1.1.2.2">𝑦</ci><cn id="S2.F1.3.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.F1.3.m1.1.1.1.1.1.2.3">0</cn></apply><ci id="S2.F1.3.m1.1.1.1.1.1.3.cmml" xref="S2.F1.3.m1.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.3.m1.1d">q(y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S2.F1.3.m1.1e">italic_q ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> The training process of WaveDiff</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2" style="font-size:80%;">repeat</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text" id="alg1.l2.2" style="font-size:80%;">    </span><math alttext="y\sim q(y),t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="alg1.l2.m1.8"><semantics id="alg1.l2.m1.8a"><mrow id="alg1.l2.m1.8.8.2" xref="alg1.l2.m1.8.8.3.cmml"><mrow id="alg1.l2.m1.7.7.1.1" xref="alg1.l2.m1.7.7.1.1.cmml"><mi id="alg1.l2.m1.7.7.1.1.2" mathsize="80%" xref="alg1.l2.m1.7.7.1.1.2.cmml">y</mi><mo id="alg1.l2.m1.7.7.1.1.1" mathsize="80%" xref="alg1.l2.m1.7.7.1.1.1.cmml">∼</mo><mrow id="alg1.l2.m1.7.7.1.1.3" xref="alg1.l2.m1.7.7.1.1.3.cmml"><mi id="alg1.l2.m1.7.7.1.1.3.2" mathsize="80%" xref="alg1.l2.m1.7.7.1.1.3.2.cmml">q</mi><mo id="alg1.l2.m1.7.7.1.1.3.1" xref="alg1.l2.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="alg1.l2.m1.7.7.1.1.3.3.2" xref="alg1.l2.m1.7.7.1.1.3.cmml"><mo id="alg1.l2.m1.7.7.1.1.3.3.2.1" maxsize="80%" minsize="80%" xref="alg1.l2.m1.7.7.1.1.3.cmml">(</mo><mi id="alg1.l2.m1.1.1" mathsize="80%" xref="alg1.l2.m1.1.1.cmml">y</mi><mo id="alg1.l2.m1.7.7.1.1.3.3.2.2" maxsize="80%" minsize="80%" xref="alg1.l2.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l2.m1.8.8.2.3" mathsize="80%" xref="alg1.l2.m1.8.8.3a.cmml">,</mo><mrow id="alg1.l2.m1.8.8.2.2.2" xref="alg1.l2.m1.8.8.2.2.3.cmml"><mrow id="alg1.l2.m1.8.8.2.2.1.1" xref="alg1.l2.m1.8.8.2.2.1.1.cmml"><mi id="alg1.l2.m1.8.8.2.2.1.1.3" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.3.cmml">t</mi><mo id="alg1.l2.m1.8.8.2.2.1.1.2" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.2.cmml">∼</mo><mrow id="alg1.l2.m1.8.8.2.2.1.1.1" xref="alg1.l2.m1.8.8.2.2.1.1.1.cmml"><mi id="alg1.l2.m1.8.8.2.2.1.1.1.3" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.3.cmml">Uniform</mi><mo id="alg1.l2.m1.8.8.2.2.1.1.1.2" xref="alg1.l2.m1.8.8.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l2.m1.8.8.2.2.1.1.1.1.1" xref="alg1.l2.m1.8.8.2.2.1.1.1.cmml"><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2.1" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml">{</mo><mn id="alg1.l2.m1.2.2" mathsize="80%" xref="alg1.l2.m1.2.2.cmml">1</mn><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg1.l2.m1.3.3" mathsize="80%" mathvariant="normal" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" mathsize="80%" xref="alg1.l2.m1.4.4.cmml">T</mi><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2.4" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml">}</mo></mrow><mo id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l2.m1.8.8.2.2.2.3" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.3a.cmml">,</mo><mrow id="alg1.l2.m1.8.8.2.2.2.2" xref="alg1.l2.m1.8.8.2.2.2.2.cmml"><mi id="alg1.l2.m1.8.8.2.2.2.2.2" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.2.cmml">z</mi><mo id="alg1.l2.m1.8.8.2.2.2.2.1" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.1.cmml">∼</mo><mrow id="alg1.l2.m1.8.8.2.2.2.2.3" xref="alg1.l2.m1.8.8.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.8.8.2.2.2.2.3.2" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.3.2.cmml">𝒩</mi><mo id="alg1.l2.m1.8.8.2.2.2.2.3.1" xref="alg1.l2.m1.8.8.2.2.2.2.3.1.cmml">⁢</mo><mrow id="alg1.l2.m1.8.8.2.2.2.2.3.3.2" xref="alg1.l2.m1.8.8.2.2.2.2.3.3.1.cmml"><mo id="alg1.l2.m1.8.8.2.2.2.2.3.3.2.1" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.3.3.1.cmml">(</mo><mn id="alg1.l2.m1.5.5" mathsize="80%" xref="alg1.l2.m1.5.5.cmml">0</mn><mo id="alg1.l2.m1.8.8.2.2.2.2.3.3.2.2" mathsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.3.3.1.cmml">,</mo><mi id="alg1.l2.m1.6.6" mathsize="80%" xref="alg1.l2.m1.6.6.cmml">𝐈</mi><mo id="alg1.l2.m1.8.8.2.2.2.2.3.3.2.3" maxsize="80%" minsize="80%" xref="alg1.l2.m1.8.8.2.2.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.8b"><apply id="alg1.l2.m1.8.8.3.cmml" xref="alg1.l2.m1.8.8.2"><csymbol cd="ambiguous" id="alg1.l2.m1.8.8.3a.cmml" xref="alg1.l2.m1.8.8.2.3">formulae-sequence</csymbol><apply id="alg1.l2.m1.7.7.1.1.cmml" xref="alg1.l2.m1.7.7.1.1"><csymbol cd="latexml" id="alg1.l2.m1.7.7.1.1.1.cmml" xref="alg1.l2.m1.7.7.1.1.1">similar-to</csymbol><ci id="alg1.l2.m1.7.7.1.1.2.cmml" xref="alg1.l2.m1.7.7.1.1.2">𝑦</ci><apply id="alg1.l2.m1.7.7.1.1.3.cmml" xref="alg1.l2.m1.7.7.1.1.3"><times id="alg1.l2.m1.7.7.1.1.3.1.cmml" xref="alg1.l2.m1.7.7.1.1.3.1"></times><ci id="alg1.l2.m1.7.7.1.1.3.2.cmml" xref="alg1.l2.m1.7.7.1.1.3.2">𝑞</ci><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑦</ci></apply></apply><apply id="alg1.l2.m1.8.8.2.2.3.cmml" xref="alg1.l2.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.8.8.2.2.3a.cmml" xref="alg1.l2.m1.8.8.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l2.m1.8.8.2.2.1.1.cmml" xref="alg1.l2.m1.8.8.2.2.1.1"><csymbol cd="latexml" id="alg1.l2.m1.8.8.2.2.1.1.2.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.2">similar-to</csymbol><ci id="alg1.l2.m1.8.8.2.2.1.1.3.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.3">𝑡</ci><apply id="alg1.l2.m1.8.8.2.2.1.1.1.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.1"><times id="alg1.l2.m1.8.8.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.1.2"></times><ci id="alg1.l2.m1.8.8.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.1.3">Uniform</ci><set id="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.8.8.2.2.1.1.1.1.1.1.2"><cn id="alg1.l2.m1.2.2.cmml" type="integer" xref="alg1.l2.m1.2.2">1</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝑇</ci></set></apply></apply><apply id="alg1.l2.m1.8.8.2.2.2.2.cmml" xref="alg1.l2.m1.8.8.2.2.2.2"><csymbol cd="latexml" id="alg1.l2.m1.8.8.2.2.2.2.1.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.1">similar-to</csymbol><ci id="alg1.l2.m1.8.8.2.2.2.2.2.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.2">𝑧</ci><apply id="alg1.l2.m1.8.8.2.2.2.2.3.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.3"><times id="alg1.l2.m1.8.8.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.3.1"></times><ci id="alg1.l2.m1.8.8.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.3.2">𝒩</ci><interval closure="open" id="alg1.l2.m1.8.8.2.2.2.2.3.3.1.cmml" xref="alg1.l2.m1.8.8.2.2.2.2.3.3.2"><cn id="alg1.l2.m1.5.5.cmml" type="integer" xref="alg1.l2.m1.5.5">0</cn><ci id="alg1.l2.m1.6.6.cmml" xref="alg1.l2.m1.6.6">𝐈</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.8c">y\sim q(y),t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.8d">italic_y ∼ italic_q ( italic_y ) , italic_t ∼ roman_Uniform ( { 1 , … , italic_T } ) , italic_z ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math><span class="ltx_text" id="alg1.l2.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.2.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text" id="alg1.l3.3" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l3.1" style="font-size:80%;">Forward process <math alttext="\to" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" stretchy="false" xref="alg1.l3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">→</annotation></semantics></math> diffusion:</span><span class="ltx_text" id="alg1.l3.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text" id="alg1.l4.2" style="font-size:80%;">    </span><math alttext="y_{0}=\textbf{DWT}(y)" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><msub id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml"><mi id="alg1.l4.m1.1.2.2.2" mathsize="80%" xref="alg1.l4.m1.1.2.2.2.cmml">y</mi><mn id="alg1.l4.m1.1.2.2.3" mathsize="80%" xref="alg1.l4.m1.1.2.2.3.cmml">0</mn></msub><mo id="alg1.l4.m1.1.2.1" mathsize="80%" xref="alg1.l4.m1.1.2.1.cmml">=</mo><mrow id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.2.3.2" mathsize="80%" xref="alg1.l4.m1.1.2.3.2a.cmml">DWT</mtext><mo id="alg1.l4.m1.1.2.3.1" xref="alg1.l4.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l4.m1.1.2.3.3.2" xref="alg1.l4.m1.1.2.3.cmml"><mo id="alg1.l4.m1.1.2.3.3.2.1" maxsize="80%" minsize="80%" xref="alg1.l4.m1.1.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" mathsize="80%" xref="alg1.l4.m1.1.1.cmml">y</mi><mo id="alg1.l4.m1.1.2.3.3.2.2" maxsize="80%" minsize="80%" xref="alg1.l4.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><eq id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1"></eq><apply id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.2.1.cmml" xref="alg1.l4.m1.1.2.2">subscript</csymbol><ci id="alg1.l4.m1.1.2.2.2.cmml" xref="alg1.l4.m1.1.2.2.2">𝑦</ci><cn id="alg1.l4.m1.1.2.2.3.cmml" type="integer" xref="alg1.l4.m1.1.2.2.3">0</cn></apply><apply id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3"><times id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3.1"></times><ci id="alg1.l4.m1.1.2.3.2a.cmml" xref="alg1.l4.m1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.2.3.2.cmml" mathsize="80%" xref="alg1.l4.m1.1.2.3.2">DWT</mtext></ci><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">y_{0}=\textbf{DWT}(y)</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = DWT ( italic_y )</annotation></semantics></math><span class="ltx_text" id="alg1.l4.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg1.l5.2" style="font-size:80%;">    </span><math alttext="q(y_{t-1}\mid y_{0})=\mathcal{N}(y_{t-1};\sqrt{\bar{\alpha}_{t-1}}y_{0},1-\bar%
{\alpha}_{t-1})" class="ltx_Math" display="inline" id="alg1.l5.m1.4"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" mathsize="80%" xref="alg1.l5.m1.1.1.1.3.cmml">q</mi><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="alg1.l5.m1.1.1.1.1.1.1.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2.3.2" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.2.3.1" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="alg1.l5.m1.1.1.1.1.1.1.2.3.3" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l5.m1.1.1.1.1.1.1.1" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml">y</mi><mn id="alg1.l5.m1.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l5.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.4.4.5" mathsize="80%" xref="alg1.l5.m1.4.4.5.cmml">=</mo><mrow id="alg1.l5.m1.4.4.4" xref="alg1.l5.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.4.4.4.5" mathsize="80%" xref="alg1.l5.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg1.l5.m1.4.4.4.4" xref="alg1.l5.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.4.3.3" xref="alg1.l5.m1.4.4.4.3.4.cmml"><mo id="alg1.l5.m1.4.4.4.3.3.4" maxsize="80%" minsize="80%" xref="alg1.l5.m1.4.4.4.3.4.cmml">(</mo><msub id="alg1.l5.m1.2.2.2.1.1.1" xref="alg1.l5.m1.2.2.2.1.1.1.cmml"><mi id="alg1.l5.m1.2.2.2.1.1.1.2" mathsize="80%" xref="alg1.l5.m1.2.2.2.1.1.1.2.cmml">y</mi><mrow id="alg1.l5.m1.2.2.2.1.1.1.3" xref="alg1.l5.m1.2.2.2.1.1.1.3.cmml"><mi id="alg1.l5.m1.2.2.2.1.1.1.3.2" mathsize="80%" xref="alg1.l5.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="alg1.l5.m1.2.2.2.1.1.1.3.1" mathsize="80%" xref="alg1.l5.m1.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="alg1.l5.m1.2.2.2.1.1.1.3.3" mathsize="80%" xref="alg1.l5.m1.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l5.m1.4.4.4.3.3.5" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg1.l5.m1.3.3.3.2.2.2" xref="alg1.l5.m1.3.3.3.2.2.2.cmml"><msqrt id="alg1.l5.m1.3.3.3.2.2.2.2" xref="alg1.l5.m1.3.3.3.2.2.2.2.cmml"><msub id="alg1.l5.m1.3.3.3.2.2.2.2.2" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l5.m1.3.3.3.2.2.2.2.2.2" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.3.3.3.2.2.2.2.2.2.2" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2.2.cmml">α</mi><mo id="alg1.l5.m1.3.3.3.2.2.2.2.2.2.1" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mrow id="alg1.l5.m1.3.3.3.2.2.2.2.2.3" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.2" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.1" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.3" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></msqrt><mo id="alg1.l5.m1.3.3.3.2.2.2.1" xref="alg1.l5.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="alg1.l5.m1.3.3.3.2.2.2.3" xref="alg1.l5.m1.3.3.3.2.2.2.3.cmml"><mi id="alg1.l5.m1.3.3.3.2.2.2.3.2" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.3.2.cmml">y</mi><mn id="alg1.l5.m1.3.3.3.2.2.2.3.3" mathsize="80%" xref="alg1.l5.m1.3.3.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l5.m1.4.4.4.3.3.6" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.4.cmml">,</mo><mrow id="alg1.l5.m1.4.4.4.3.3.3" xref="alg1.l5.m1.4.4.4.3.3.3.cmml"><mn id="alg1.l5.m1.4.4.4.3.3.3.2" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.2.cmml">1</mn><mo id="alg1.l5.m1.4.4.4.3.3.3.1" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.1.cmml">−</mo><msub id="alg1.l5.m1.4.4.4.3.3.3.3" xref="alg1.l5.m1.4.4.4.3.3.3.3.cmml"><mover accent="true" id="alg1.l5.m1.4.4.4.3.3.3.3.2" xref="alg1.l5.m1.4.4.4.3.3.3.3.2.cmml"><mi id="alg1.l5.m1.4.4.4.3.3.3.3.2.2" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.3.2.2.cmml">α</mi><mo id="alg1.l5.m1.4.4.4.3.3.3.3.2.1" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.3.2.1.cmml">¯</mo></mover><mrow id="alg1.l5.m1.4.4.4.3.3.3.3.3" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.cmml"><mi id="alg1.l5.m1.4.4.4.3.3.3.3.3.2" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l5.m1.4.4.4.3.3.3.3.3.1" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.1.cmml">−</mo><mn id="alg1.l5.m1.4.4.4.3.3.3.3.3.3" mathsize="80%" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l5.m1.4.4.4.3.3.7" maxsize="80%" minsize="80%" xref="alg1.l5.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><eq id="alg1.l5.m1.4.4.5.cmml" xref="alg1.l5.m1.4.4.5"></eq><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝑞</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.3"><minus id="alg1.l5.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.1"></minus><ci id="alg1.l5.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="alg1.l5.m1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2">𝑦</ci><cn id="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l5.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="alg1.l5.m1.4.4.4.cmml" xref="alg1.l5.m1.4.4.4"><times id="alg1.l5.m1.4.4.4.4.cmml" xref="alg1.l5.m1.4.4.4.4"></times><ci id="alg1.l5.m1.4.4.4.5.cmml" xref="alg1.l5.m1.4.4.4.5">𝒩</ci><list id="alg1.l5.m1.4.4.4.3.4.cmml" xref="alg1.l5.m1.4.4.4.3.3"><apply id="alg1.l5.m1.2.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.2.1.1.1.2">𝑦</ci><apply id="alg1.l5.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l5.m1.2.2.2.1.1.1.3"><minus id="alg1.l5.m1.2.2.2.1.1.1.3.1.cmml" xref="alg1.l5.m1.2.2.2.1.1.1.3.1"></minus><ci id="alg1.l5.m1.2.2.2.1.1.1.3.2.cmml" xref="alg1.l5.m1.2.2.2.1.1.1.3.2">𝑡</ci><cn id="alg1.l5.m1.2.2.2.1.1.1.3.3.cmml" type="integer" xref="alg1.l5.m1.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l5.m1.3.3.3.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2"><times id="alg1.l5.m1.3.3.3.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.1"></times><apply id="alg1.l5.m1.3.3.3.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2"><root id="alg1.l5.m1.3.3.3.2.2.2.2a.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2"></root><apply id="alg1.l5.m1.3.3.3.2.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2">subscript</csymbol><apply id="alg1.l5.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2"><ci id="alg1.l5.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2.1">¯</ci><ci id="alg1.l5.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.2.2">𝛼</ci></apply><apply id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3"><minus id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.1"></minus><ci id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.2">𝑡</ci><cn id="alg1.l5.m1.3.3.3.2.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l5.m1.3.3.3.2.2.2.2.2.3.3">1</cn></apply></apply></apply><apply id="alg1.l5.m1.3.3.3.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.2.2.2.3.1.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.2.2.2.3.2.cmml" xref="alg1.l5.m1.3.3.3.2.2.2.3.2">𝑦</ci><cn id="alg1.l5.m1.3.3.3.2.2.2.3.3.cmml" type="integer" xref="alg1.l5.m1.3.3.3.2.2.2.3.3">0</cn></apply></apply><apply id="alg1.l5.m1.4.4.4.3.3.3.cmml" xref="alg1.l5.m1.4.4.4.3.3.3"><minus id="alg1.l5.m1.4.4.4.3.3.3.1.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.1"></minus><cn id="alg1.l5.m1.4.4.4.3.3.3.2.cmml" type="integer" xref="alg1.l5.m1.4.4.4.3.3.3.2">1</cn><apply id="alg1.l5.m1.4.4.4.3.3.3.3.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.4.3.3.3.3.1.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3">subscript</csymbol><apply id="alg1.l5.m1.4.4.4.3.3.3.3.2.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.2"><ci id="alg1.l5.m1.4.4.4.3.3.3.3.2.1.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.2.1">¯</ci><ci id="alg1.l5.m1.4.4.4.3.3.3.3.2.2.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.2.2">𝛼</ci></apply><apply id="alg1.l5.m1.4.4.4.3.3.3.3.3.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.3"><minus id="alg1.l5.m1.4.4.4.3.3.3.3.3.1.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.1"></minus><ci id="alg1.l5.m1.4.4.4.3.3.3.3.3.2.cmml" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.2">𝑡</ci><cn id="alg1.l5.m1.4.4.4.3.3.3.3.3.3.cmml" type="integer" xref="alg1.l5.m1.4.4.4.3.3.3.3.3.3">1</cn></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">q(y_{t-1}\mid y_{0})=\mathcal{N}(y_{t-1};\sqrt{\bar{\alpha}_{t-1}}y_{0},1-\bar%
{\alpha}_{t-1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.4d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l5.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text" id="alg1.l6.2" style="font-size:80%;">    </span><math alttext="q(y_{t}\mid y_{t-1})=\mathcal{N}\left(y_{t};\sqrt{\alpha_{t}}y_{t-1},1-\alpha_%
{t}\right)" class="ltx_Math" display="inline" id="alg1.l6.m1.4"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.3" mathsize="80%" xref="alg1.l6.m1.1.1.1.3.cmml">q</mi><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l6.m1.1.1.1.1.1.1.1" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml">y</mi><mrow id="alg1.l6.m1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3.2" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l6.m1.1.1.1.1.1.1.3.3.1" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l6.m1.1.1.1.1.1.1.3.3.3" mathsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l6.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l6.m1.4.4.5" mathsize="80%" xref="alg1.l6.m1.4.4.5.cmml">=</mo><mrow id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.4.4.4.5" mathsize="80%" xref="alg1.l6.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg1.l6.m1.4.4.4.4" xref="alg1.l6.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg1.l6.m1.4.4.4.3.3" xref="alg1.l6.m1.4.4.4.3.4.cmml"><mo id="alg1.l6.m1.4.4.4.3.3.4" xref="alg1.l6.m1.4.4.4.3.4.cmml">(</mo><msub id="alg1.l6.m1.2.2.2.1.1.1" xref="alg1.l6.m1.2.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.1.1.1.2" mathsize="80%" xref="alg1.l6.m1.2.2.2.1.1.1.2.cmml">y</mi><mi id="alg1.l6.m1.2.2.2.1.1.1.3" mathsize="80%" xref="alg1.l6.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.4.4.3.3.5" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg1.l6.m1.3.3.3.2.2.2" xref="alg1.l6.m1.3.3.3.2.2.2.cmml"><msqrt id="alg1.l6.m1.3.3.3.2.2.2.2" xref="alg1.l6.m1.3.3.3.2.2.2.2.cmml"><msub id="alg1.l6.m1.3.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.3.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.3.2.2.2.2.2.2" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.2.2.2.cmml">α</mi><mi id="alg1.l6.m1.3.3.3.2.2.2.2.2.3" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="alg1.l6.m1.3.3.3.2.2.2.1" xref="alg1.l6.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="alg1.l6.m1.3.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.3.2.2.2.3.cmml"><mi id="alg1.l6.m1.3.3.3.2.2.2.3.2" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.3.2.cmml">y</mi><mrow id="alg1.l6.m1.3.3.3.2.2.2.3.3" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.cmml"><mi id="alg1.l6.m1.3.3.3.2.2.2.3.3.2" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l6.m1.3.3.3.2.2.2.3.3.1" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.1.cmml">−</mo><mn id="alg1.l6.m1.3.3.3.2.2.2.3.3.3" mathsize="80%" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l6.m1.4.4.4.3.3.6" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.4.cmml">,</mo><mrow id="alg1.l6.m1.4.4.4.3.3.3" xref="alg1.l6.m1.4.4.4.3.3.3.cmml"><mn id="alg1.l6.m1.4.4.4.3.3.3.2" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.3.3.2.cmml">1</mn><mo id="alg1.l6.m1.4.4.4.3.3.3.1" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.3.3.1.cmml">−</mo><msub id="alg1.l6.m1.4.4.4.3.3.3.3" xref="alg1.l6.m1.4.4.4.3.3.3.3.cmml"><mi id="alg1.l6.m1.4.4.4.3.3.3.3.2" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.3.3.3.2.cmml">α</mi><mi id="alg1.l6.m1.4.4.4.3.3.3.3.3" mathsize="80%" xref="alg1.l6.m1.4.4.4.3.3.3.3.3.cmml">t</mi></msub></mrow><mo id="alg1.l6.m1.4.4.4.3.3.7" xref="alg1.l6.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><eq id="alg1.l6.m1.4.4.5.cmml" xref="alg1.l6.m1.4.4.5"></eq><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3">𝑞</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2">𝑦</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3"><minus id="alg1.l6.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg1.l6.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4"><times id="alg1.l6.m1.4.4.4.4.cmml" xref="alg1.l6.m1.4.4.4.4"></times><ci id="alg1.l6.m1.4.4.4.5.cmml" xref="alg1.l6.m1.4.4.4.5">𝒩</ci><list id="alg1.l6.m1.4.4.4.3.4.cmml" xref="alg1.l6.m1.4.4.4.3.3"><apply id="alg1.l6.m1.2.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="alg1.l6.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg1.l6.m1.3.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2"><times id="alg1.l6.m1.3.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.1"></times><apply id="alg1.l6.m1.3.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2"><root id="alg1.l6.m1.3.3.3.2.2.2.2a.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2"></root><apply id="alg1.l6.m1.3.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2.2.2">𝛼</ci><ci id="alg1.l6.m1.3.3.3.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="alg1.l6.m1.3.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.2.2.2.3.1.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.2.2.2.3.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3.2">𝑦</ci><apply id="alg1.l6.m1.3.3.3.2.2.2.3.3.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3.3"><minus id="alg1.l6.m1.3.3.3.2.2.2.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.1"></minus><ci id="alg1.l6.m1.3.3.3.2.2.2.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.2">𝑡</ci><cn id="alg1.l6.m1.3.3.3.2.2.2.3.3.3.cmml" type="integer" xref="alg1.l6.m1.3.3.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l6.m1.4.4.4.3.3.3.cmml" xref="alg1.l6.m1.4.4.4.3.3.3"><minus id="alg1.l6.m1.4.4.4.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.4.3.3.3.1"></minus><cn id="alg1.l6.m1.4.4.4.3.3.3.2.cmml" type="integer" xref="alg1.l6.m1.4.4.4.3.3.3.2">1</cn><apply id="alg1.l6.m1.4.4.4.3.3.3.3.cmml" xref="alg1.l6.m1.4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.4.3.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.4.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.4.4.4.3.3.3.3.2.cmml" xref="alg1.l6.m1.4.4.4.3.3.3.3.2">𝛼</ci><ci id="alg1.l6.m1.4.4.4.3.3.3.3.3.cmml" xref="alg1.l6.m1.4.4.4.3.3.3.3.3">𝑡</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">q(y_{t}\mid y_{t-1})=\mathcal{N}\left(y_{t};\sqrt{\alpha_{t}}y_{t-1},1-\alpha_%
{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.4d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l6.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.2.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg1.l7.3" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l7.1" style="font-size:80%;">Reverse process <math alttext="\to" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" stretchy="false" xref="alg1.l7.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">→</annotation></semantics></math> denoising:</span><span class="ltx_text" id="alg1.l7.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:80%;">    </span><math alttext="y_{0}^{\prime}=G(y_{t},z,t)" class="ltx_Math" display="inline" id="alg1.l8.m1.3"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml"><msubsup id="alg1.l8.m1.3.3.3" xref="alg1.l8.m1.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.2.2" mathsize="80%" xref="alg1.l8.m1.3.3.3.2.2.cmml">y</mi><mn id="alg1.l8.m1.3.3.3.2.3" mathsize="80%" xref="alg1.l8.m1.3.3.3.2.3.cmml">0</mn><mo id="alg1.l8.m1.3.3.3.3" mathsize="80%" xref="alg1.l8.m1.3.3.3.3.cmml">′</mo></msubsup><mo id="alg1.l8.m1.3.3.2" mathsize="80%" xref="alg1.l8.m1.3.3.2.cmml">=</mo><mrow id="alg1.l8.m1.3.3.1" xref="alg1.l8.m1.3.3.1.cmml"><mi id="alg1.l8.m1.3.3.1.3" mathsize="80%" xref="alg1.l8.m1.3.3.1.3.cmml">G</mi><mo id="alg1.l8.m1.3.3.1.2" xref="alg1.l8.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.3.3.1.1.1" xref="alg1.l8.m1.3.3.1.1.2.cmml"><mo id="alg1.l8.m1.3.3.1.1.1.2" maxsize="80%" minsize="80%" xref="alg1.l8.m1.3.3.1.1.2.cmml">(</mo><msub id="alg1.l8.m1.3.3.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l8.m1.3.3.1.1.1.1.2" mathsize="80%" xref="alg1.l8.m1.3.3.1.1.1.1.2.cmml">y</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.3" mathsize="80%" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l8.m1.3.3.1.1.1.3" mathsize="80%" xref="alg1.l8.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l8.m1.1.1" mathsize="80%" xref="alg1.l8.m1.1.1.cmml">z</mi><mo id="alg1.l8.m1.3.3.1.1.1.4" mathsize="80%" xref="alg1.l8.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l8.m1.2.2" mathsize="80%" xref="alg1.l8.m1.2.2.cmml">t</mi><mo id="alg1.l8.m1.3.3.1.1.1.5" maxsize="80%" minsize="80%" xref="alg1.l8.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3"><eq id="alg1.l8.m1.3.3.2.cmml" xref="alg1.l8.m1.3.3.2"></eq><apply id="alg1.l8.m1.3.3.3.cmml" xref="alg1.l8.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3">superscript</csymbol><apply id="alg1.l8.m1.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.2.1.cmml" xref="alg1.l8.m1.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.2.2.cmml" xref="alg1.l8.m1.3.3.3.2.2">𝑦</ci><cn id="alg1.l8.m1.3.3.3.2.3.cmml" type="integer" xref="alg1.l8.m1.3.3.3.2.3">0</cn></apply><ci id="alg1.l8.m1.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3">′</ci></apply><apply id="alg1.l8.m1.3.3.1.cmml" xref="alg1.l8.m1.3.3.1"><times id="alg1.l8.m1.3.3.1.2.cmml" xref="alg1.l8.m1.3.3.1.2"></times><ci id="alg1.l8.m1.3.3.1.3.cmml" xref="alg1.l8.m1.3.3.1.3">𝐺</ci><vector id="alg1.l8.m1.3.3.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1"><apply id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3">𝑡</ci></apply><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑧</ci><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">y_{0}^{\prime}=G(y_{t},z,t)</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.3d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_G ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:80%;">    </span><math alttext="q(y^{\prime}_{t-1}\mid y_{t},y_{0}^{\prime})=\mathcal{N}\left(y^{\prime}_{t-1}%
;\tilde{\mu}_{t}(y_{t},y_{0}^{\prime}),\tilde{\beta}_{t}\right)" class="ltx_Math" display="inline" id="alg1.l9.m1.4"><semantics id="alg1.l9.m1.4a"><mrow id="alg1.l9.m1.4.4" xref="alg1.l9.m1.4.4.cmml"><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.3.cmml">q</mi><mo id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l9.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><msubsup id="alg1.l9.m1.1.1.1.1.1.1.4" xref="alg1.l9.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.4.2.2" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="alg1.l9.m1.1.1.1.1.1.1.4.3" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.4.3.2" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.4.3.1" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="alg1.l9.m1.1.1.1.1.1.1.4.3.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow><mo id="alg1.l9.m1.1.1.1.1.1.1.4.2.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.4.2.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.1.1.1.1.1.1.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l9.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.2" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l9.m1.1.1.1.1.1.1.2.2.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="alg1.l9.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.2" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3" mathsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="alg1.l9.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l9.m1.4.4.5" mathsize="80%" xref="alg1.l9.m1.4.4.5.cmml">=</mo><mrow id="alg1.l9.m1.4.4.4" xref="alg1.l9.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.4.4.4.5" mathsize="80%" xref="alg1.l9.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg1.l9.m1.4.4.4.4" xref="alg1.l9.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg1.l9.m1.4.4.4.3.3" xref="alg1.l9.m1.4.4.4.3.4.cmml"><mo id="alg1.l9.m1.4.4.4.3.3.4" xref="alg1.l9.m1.4.4.4.3.4.cmml">(</mo><msubsup id="alg1.l9.m1.2.2.2.1.1.1" xref="alg1.l9.m1.2.2.2.1.1.1.cmml"><mi id="alg1.l9.m1.2.2.2.1.1.1.2.2" mathsize="80%" xref="alg1.l9.m1.2.2.2.1.1.1.2.2.cmml">y</mi><mrow id="alg1.l9.m1.2.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.2.1.1.1.3.cmml"><mi id="alg1.l9.m1.2.2.2.1.1.1.3.2" mathsize="80%" xref="alg1.l9.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="alg1.l9.m1.2.2.2.1.1.1.3.1" mathsize="80%" xref="alg1.l9.m1.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="alg1.l9.m1.2.2.2.1.1.1.3.3" mathsize="80%" xref="alg1.l9.m1.2.2.2.1.1.1.3.3.cmml">1</mn></mrow><mo id="alg1.l9.m1.2.2.2.1.1.1.2.3" mathsize="80%" xref="alg1.l9.m1.2.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.4.4.4.3.3.5" mathsize="80%" xref="alg1.l9.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg1.l9.m1.3.3.3.2.2.2" xref="alg1.l9.m1.3.3.3.2.2.2.cmml"><msub id="alg1.l9.m1.3.3.3.2.2.2.4" xref="alg1.l9.m1.3.3.3.2.2.2.4.cmml"><mover accent="true" id="alg1.l9.m1.3.3.3.2.2.2.4.2" xref="alg1.l9.m1.3.3.3.2.2.2.4.2.cmml"><mi id="alg1.l9.m1.3.3.3.2.2.2.4.2.2" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.4.2.2.cmml">μ</mi><mo id="alg1.l9.m1.3.3.3.2.2.2.4.2.1" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.4.2.1.cmml">~</mo></mover><mi id="alg1.l9.m1.3.3.3.2.2.2.4.3" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.4.3.cmml">t</mi></msub><mo id="alg1.l9.m1.3.3.3.2.2.2.3" xref="alg1.l9.m1.3.3.3.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l9.m1.3.3.3.2.2.2.2.2" xref="alg1.l9.m1.3.3.3.2.2.2.2.3.cmml"><mo id="alg1.l9.m1.3.3.3.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.3.cmml">(</mo><msub id="alg1.l9.m1.3.3.3.2.2.2.1.1.1" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.2" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1.2.cmml">y</mi><mi id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.3" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l9.m1.3.3.3.2.2.2.2.2.4" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l9.m1.3.3.3.2.2.2.2.2.2" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.2.cmml">y</mi><mn id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.3.cmml">0</mn><mo id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.3" mathsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.3.3.3.2.2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.l9.m1.3.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l9.m1.4.4.4.3.3.6" mathsize="80%" xref="alg1.l9.m1.4.4.4.3.4.cmml">,</mo><msub id="alg1.l9.m1.4.4.4.3.3.3" xref="alg1.l9.m1.4.4.4.3.3.3.cmml"><mover accent="true" id="alg1.l9.m1.4.4.4.3.3.3.2" xref="alg1.l9.m1.4.4.4.3.3.3.2.cmml"><mi id="alg1.l9.m1.4.4.4.3.3.3.2.2" mathsize="80%" xref="alg1.l9.m1.4.4.4.3.3.3.2.2.cmml">β</mi><mo id="alg1.l9.m1.4.4.4.3.3.3.2.1" mathsize="80%" xref="alg1.l9.m1.4.4.4.3.3.3.2.1.cmml">~</mo></mover><mi id="alg1.l9.m1.4.4.4.3.3.3.3" mathsize="80%" xref="alg1.l9.m1.4.4.4.3.3.3.3.cmml">t</mi></msub><mo id="alg1.l9.m1.4.4.4.3.3.7" xref="alg1.l9.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.4b"><apply id="alg1.l9.m1.4.4.cmml" xref="alg1.l9.m1.4.4"><eq id="alg1.l9.m1.4.4.5.cmml" xref="alg1.l9.m1.4.4.5"></eq><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><times id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></times><ci id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3">𝑞</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4">subscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.4.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.4.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.2.2">𝑦</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.4.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.2.3">′</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3"><minus id="alg1.l9.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.1"></minus><ci id="alg1.l9.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="alg1.l9.m1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply><apply id="alg1.l9.m1.4.4.4.cmml" xref="alg1.l9.m1.4.4.4"><times id="alg1.l9.m1.4.4.4.4.cmml" xref="alg1.l9.m1.4.4.4.4"></times><ci id="alg1.l9.m1.4.4.4.5.cmml" xref="alg1.l9.m1.4.4.4.5">𝒩</ci><list id="alg1.l9.m1.4.4.4.3.4.cmml" xref="alg1.l9.m1.4.4.4.3.3"><apply id="alg1.l9.m1.2.2.2.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.1.1.1">subscript</csymbol><apply id="alg1.l9.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.1.1.1.2.1.cmml" xref="alg1.l9.m1.2.2.2.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.2.2.2.1.1.1.2.2.cmml" xref="alg1.l9.m1.2.2.2.1.1.1.2.2">𝑦</ci><ci id="alg1.l9.m1.2.2.2.1.1.1.2.3.cmml" xref="alg1.l9.m1.2.2.2.1.1.1.2.3">′</ci></apply><apply id="alg1.l9.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.2.1.1.1.3"><minus id="alg1.l9.m1.2.2.2.1.1.1.3.1.cmml" xref="alg1.l9.m1.2.2.2.1.1.1.3.1"></minus><ci id="alg1.l9.m1.2.2.2.1.1.1.3.2.cmml" xref="alg1.l9.m1.2.2.2.1.1.1.3.2">𝑡</ci><cn id="alg1.l9.m1.2.2.2.1.1.1.3.3.cmml" type="integer" xref="alg1.l9.m1.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.3.3.3.2.2.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2"><times id="alg1.l9.m1.3.3.3.2.2.2.3.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.3"></times><apply id="alg1.l9.m1.3.3.3.2.2.2.4.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.2.2.2.4.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4">subscript</csymbol><apply id="alg1.l9.m1.3.3.3.2.2.2.4.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4.2"><ci id="alg1.l9.m1.3.3.3.2.2.2.4.2.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4.2.1">~</ci><ci id="alg1.l9.m1.3.3.3.2.2.2.4.2.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4.2.2">𝜇</ci></apply><ci id="alg1.l9.m1.3.3.3.2.2.2.4.3.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="alg1.l9.m1.3.3.3.2.2.2.2.3.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2"><apply id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1.2">𝑦</ci><ci id="alg1.l9.m1.3.3.3.2.2.2.1.1.1.3.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.2">𝑦</ci><cn id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.3.cmml" type="integer" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.2.3">0</cn></apply><ci id="alg1.l9.m1.3.3.3.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.3.3.3.2.2.2.2.2.2.3">′</ci></apply></interval></apply><apply id="alg1.l9.m1.4.4.4.3.3.3.cmml" xref="alg1.l9.m1.4.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.4.3.3.3.1.cmml" xref="alg1.l9.m1.4.4.4.3.3.3">subscript</csymbol><apply id="alg1.l9.m1.4.4.4.3.3.3.2.cmml" xref="alg1.l9.m1.4.4.4.3.3.3.2"><ci id="alg1.l9.m1.4.4.4.3.3.3.2.1.cmml" xref="alg1.l9.m1.4.4.4.3.3.3.2.1">~</ci><ci id="alg1.l9.m1.4.4.4.3.3.3.2.2.cmml" xref="alg1.l9.m1.4.4.4.3.3.3.2.2">𝛽</ci></apply><ci id="alg1.l9.m1.4.4.4.3.3.3.3.cmml" xref="alg1.l9.m1.4.4.4.3.3.3.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.4c">q(y^{\prime}_{t-1}\mid y_{t},y_{0}^{\prime})=\mathcal{N}\left(y^{\prime}_{t-1}%
;\tilde{\mu}_{t}(y_{t},y_{0}^{\prime}),\tilde{\beta}_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.4d">italic_q ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = caligraphic_N ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; over~ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , over~ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l9.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l10.3" style="font-size:80%;">Model Optimization:</span><span class="ltx_text" id="alg1.l10.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg1.l11.2" style="font-size:80%;">    </span><math alttext="\text{Min}\mathcal{L}_{\text{adv}}^{D}=-\log D(y_{t-1},y_{t},t)+\log D(y^{%
\prime}_{t-1},y_{t},t)" class="ltx_Math" display="inline" id="alg1.l11.m1.6"><semantics id="alg1.l11.m1.6a"><mrow id="alg1.l11.m1.6.6" xref="alg1.l11.m1.6.6.cmml"><mrow id="alg1.l11.m1.6.6.6" xref="alg1.l11.m1.6.6.6.cmml"><mtext id="alg1.l11.m1.6.6.6.2" mathsize="80%" xref="alg1.l11.m1.6.6.6.2a.cmml">Min</mtext><mo id="alg1.l11.m1.6.6.6.1" xref="alg1.l11.m1.6.6.6.1.cmml">⁢</mo><msubsup id="alg1.l11.m1.6.6.6.3" xref="alg1.l11.m1.6.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.6.6.6.3.2.2" mathsize="80%" xref="alg1.l11.m1.6.6.6.3.2.2.cmml">ℒ</mi><mtext id="alg1.l11.m1.6.6.6.3.2.3" mathsize="80%" xref="alg1.l11.m1.6.6.6.3.2.3a.cmml">adv</mtext><mi id="alg1.l11.m1.6.6.6.3.3" mathsize="80%" xref="alg1.l11.m1.6.6.6.3.3.cmml">D</mi></msubsup></mrow><mo id="alg1.l11.m1.6.6.5" mathsize="80%" xref="alg1.l11.m1.6.6.5.cmml">=</mo><mrow id="alg1.l11.m1.6.6.4" xref="alg1.l11.m1.6.6.4.cmml"><mrow id="alg1.l11.m1.4.4.2.2" xref="alg1.l11.m1.4.4.2.2.cmml"><mo id="alg1.l11.m1.4.4.2.2a" mathsize="80%" rspace="0.167em" xref="alg1.l11.m1.4.4.2.2.cmml">−</mo><mrow id="alg1.l11.m1.4.4.2.2.2" xref="alg1.l11.m1.4.4.2.2.2.cmml"><mrow id="alg1.l11.m1.4.4.2.2.2.4" xref="alg1.l11.m1.4.4.2.2.2.4.cmml"><mi id="alg1.l11.m1.4.4.2.2.2.4.1" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.4.1.cmml">log</mi><mo id="alg1.l11.m1.4.4.2.2.2.4a" lspace="0.167em" xref="alg1.l11.m1.4.4.2.2.2.4.cmml">⁡</mo><mi id="alg1.l11.m1.4.4.2.2.2.4.2" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.4.2.cmml">D</mi></mrow><mo id="alg1.l11.m1.4.4.2.2.2.3" xref="alg1.l11.m1.4.4.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l11.m1.4.4.2.2.2.2.2" xref="alg1.l11.m1.4.4.2.2.2.2.3.cmml"><mo id="alg1.l11.m1.4.4.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.3.cmml">(</mo><msub id="alg1.l11.m1.3.3.1.1.1.1.1.1" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.1.1.2" mathsize="80%" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.2.cmml">y</mi><mrow id="alg1.l11.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.1" mathsize="80%" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l11.m1.4.4.2.2.2.2.2.4" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.3.cmml">,</mo><msub id="alg1.l11.m1.4.4.2.2.2.2.2.2" xref="alg1.l11.m1.4.4.2.2.2.2.2.2.cmml"><mi id="alg1.l11.m1.4.4.2.2.2.2.2.2.2" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l11.m1.4.4.2.2.2.2.2.2.3" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l11.m1.4.4.2.2.2.2.2.5" mathsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.3.cmml">,</mo><mi id="alg1.l11.m1.1.1" mathsize="80%" xref="alg1.l11.m1.1.1.cmml">t</mi><mo id="alg1.l11.m1.4.4.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg1.l11.m1.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l11.m1.6.6.4.5" mathsize="80%" xref="alg1.l11.m1.6.6.4.5.cmml">+</mo><mrow id="alg1.l11.m1.6.6.4.4" xref="alg1.l11.m1.6.6.4.4.cmml"><mrow id="alg1.l11.m1.6.6.4.4.4" xref="alg1.l11.m1.6.6.4.4.4.cmml"><mi id="alg1.l11.m1.6.6.4.4.4.1" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.4.1.cmml">log</mi><mo id="alg1.l11.m1.6.6.4.4.4a" lspace="0.167em" xref="alg1.l11.m1.6.6.4.4.4.cmml">⁡</mo><mi id="alg1.l11.m1.6.6.4.4.4.2" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.4.2.cmml">D</mi></mrow><mo id="alg1.l11.m1.6.6.4.4.3" xref="alg1.l11.m1.6.6.4.4.3.cmml">⁢</mo><mrow id="alg1.l11.m1.6.6.4.4.2.2" xref="alg1.l11.m1.6.6.4.4.2.3.cmml"><mo id="alg1.l11.m1.6.6.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg1.l11.m1.6.6.4.4.2.3.cmml">(</mo><msubsup id="alg1.l11.m1.5.5.3.3.1.1.1" xref="alg1.l11.m1.5.5.3.3.1.1.1.cmml"><mi id="alg1.l11.m1.5.5.3.3.1.1.1.2.2" mathsize="80%" xref="alg1.l11.m1.5.5.3.3.1.1.1.2.2.cmml">y</mi><mrow id="alg1.l11.m1.5.5.3.3.1.1.1.3" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.cmml"><mi id="alg1.l11.m1.5.5.3.3.1.1.1.3.2" mathsize="80%" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.2.cmml">t</mi><mo id="alg1.l11.m1.5.5.3.3.1.1.1.3.1" mathsize="80%" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.1.cmml">−</mo><mn id="alg1.l11.m1.5.5.3.3.1.1.1.3.3" mathsize="80%" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.3.cmml">1</mn></mrow><mo id="alg1.l11.m1.5.5.3.3.1.1.1.2.3" mathsize="80%" xref="alg1.l11.m1.5.5.3.3.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l11.m1.6.6.4.4.2.2.4" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.2.3.cmml">,</mo><msub id="alg1.l11.m1.6.6.4.4.2.2.2" xref="alg1.l11.m1.6.6.4.4.2.2.2.cmml"><mi id="alg1.l11.m1.6.6.4.4.2.2.2.2" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.2.2.2.2.cmml">y</mi><mi id="alg1.l11.m1.6.6.4.4.2.2.2.3" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l11.m1.6.6.4.4.2.2.5" mathsize="80%" xref="alg1.l11.m1.6.6.4.4.2.3.cmml">,</mo><mi id="alg1.l11.m1.2.2" mathsize="80%" xref="alg1.l11.m1.2.2.cmml">t</mi><mo id="alg1.l11.m1.6.6.4.4.2.2.6" maxsize="80%" minsize="80%" xref="alg1.l11.m1.6.6.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.6b"><apply id="alg1.l11.m1.6.6.cmml" xref="alg1.l11.m1.6.6"><eq id="alg1.l11.m1.6.6.5.cmml" xref="alg1.l11.m1.6.6.5"></eq><apply id="alg1.l11.m1.6.6.6.cmml" xref="alg1.l11.m1.6.6.6"><times id="alg1.l11.m1.6.6.6.1.cmml" xref="alg1.l11.m1.6.6.6.1"></times><ci id="alg1.l11.m1.6.6.6.2a.cmml" xref="alg1.l11.m1.6.6.6.2"><mtext id="alg1.l11.m1.6.6.6.2.cmml" mathsize="80%" xref="alg1.l11.m1.6.6.6.2">Min</mtext></ci><apply id="alg1.l11.m1.6.6.6.3.cmml" xref="alg1.l11.m1.6.6.6.3"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.6.3.1.cmml" xref="alg1.l11.m1.6.6.6.3">superscript</csymbol><apply id="alg1.l11.m1.6.6.6.3.2.cmml" xref="alg1.l11.m1.6.6.6.3"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.6.3.2.1.cmml" xref="alg1.l11.m1.6.6.6.3">subscript</csymbol><ci id="alg1.l11.m1.6.6.6.3.2.2.cmml" xref="alg1.l11.m1.6.6.6.3.2.2">ℒ</ci><ci id="alg1.l11.m1.6.6.6.3.2.3a.cmml" xref="alg1.l11.m1.6.6.6.3.2.3"><mtext id="alg1.l11.m1.6.6.6.3.2.3.cmml" mathsize="56%" xref="alg1.l11.m1.6.6.6.3.2.3">adv</mtext></ci></apply><ci id="alg1.l11.m1.6.6.6.3.3.cmml" xref="alg1.l11.m1.6.6.6.3.3">𝐷</ci></apply></apply><apply id="alg1.l11.m1.6.6.4.cmml" xref="alg1.l11.m1.6.6.4"><plus id="alg1.l11.m1.6.6.4.5.cmml" xref="alg1.l11.m1.6.6.4.5"></plus><apply id="alg1.l11.m1.4.4.2.2.cmml" xref="alg1.l11.m1.4.4.2.2"><minus id="alg1.l11.m1.4.4.2.2.3.cmml" xref="alg1.l11.m1.4.4.2.2"></minus><apply id="alg1.l11.m1.4.4.2.2.2.cmml" xref="alg1.l11.m1.4.4.2.2.2"><times id="alg1.l11.m1.4.4.2.2.2.3.cmml" xref="alg1.l11.m1.4.4.2.2.2.3"></times><apply id="alg1.l11.m1.4.4.2.2.2.4.cmml" xref="alg1.l11.m1.4.4.2.2.2.4"><log id="alg1.l11.m1.4.4.2.2.2.4.1.cmml" xref="alg1.l11.m1.4.4.2.2.2.4.1"></log><ci id="alg1.l11.m1.4.4.2.2.2.4.2.cmml" xref="alg1.l11.m1.4.4.2.2.2.4.2">𝐷</ci></apply><vector id="alg1.l11.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l11.m1.4.4.2.2.2.2.2"><apply id="alg1.l11.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.2">𝑦</ci><apply id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3"><minus id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg1.l11.m1.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l11.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l11.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l11.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.4.4.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg1.l11.m1.6.6.4.4.cmml" xref="alg1.l11.m1.6.6.4.4"><times id="alg1.l11.m1.6.6.4.4.3.cmml" xref="alg1.l11.m1.6.6.4.4.3"></times><apply id="alg1.l11.m1.6.6.4.4.4.cmml" xref="alg1.l11.m1.6.6.4.4.4"><log id="alg1.l11.m1.6.6.4.4.4.1.cmml" xref="alg1.l11.m1.6.6.4.4.4.1"></log><ci id="alg1.l11.m1.6.6.4.4.4.2.cmml" xref="alg1.l11.m1.6.6.4.4.4.2">𝐷</ci></apply><vector id="alg1.l11.m1.6.6.4.4.2.3.cmml" xref="alg1.l11.m1.6.6.4.4.2.2"><apply id="alg1.l11.m1.5.5.3.3.1.1.1.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.5.5.3.3.1.1.1.1.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1">subscript</csymbol><apply id="alg1.l11.m1.5.5.3.3.1.1.1.2.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.5.5.3.3.1.1.1.2.1.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1">superscript</csymbol><ci id="alg1.l11.m1.5.5.3.3.1.1.1.2.2.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1.2.2">𝑦</ci><ci id="alg1.l11.m1.5.5.3.3.1.1.1.2.3.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1.2.3">′</ci></apply><apply id="alg1.l11.m1.5.5.3.3.1.1.1.3.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1.3"><minus id="alg1.l11.m1.5.5.3.3.1.1.1.3.1.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.1"></minus><ci id="alg1.l11.m1.5.5.3.3.1.1.1.3.2.cmml" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.2">𝑡</ci><cn id="alg1.l11.m1.5.5.3.3.1.1.1.3.3.cmml" type="integer" xref="alg1.l11.m1.5.5.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l11.m1.6.6.4.4.2.2.2.cmml" xref="alg1.l11.m1.6.6.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.4.4.2.2.2.1.cmml" xref="alg1.l11.m1.6.6.4.4.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.6.6.4.4.2.2.2.2.cmml" xref="alg1.l11.m1.6.6.4.4.2.2.2.2">𝑦</ci><ci id="alg1.l11.m1.6.6.4.4.2.2.2.3.cmml" xref="alg1.l11.m1.6.6.4.4.2.2.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑡</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.6c">\text{Min}\mathcal{L}_{\text{adv}}^{D}=-\log D(y_{t-1},y_{t},t)+\log D(y^{%
\prime}_{t-1},y_{t},t)</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.6d">Min caligraphic_L start_POSTSUBSCRIPT adv end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT = - roman_log italic_D ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + roman_log italic_D ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg1.l11.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg1.l12.2" style="font-size:80%;">    </span><math alttext="\text{Min}\mathcal{L}_{\text{adv}}^{G}=-\log D(y^{\prime}_{t-1},y_{t},t)+%
\mathcal{L}_{1}(y_{0}^{\prime},y_{0})" class="ltx_Math" display="inline" id="alg1.l12.m1.5"><semantics id="alg1.l12.m1.5a"><mrow id="alg1.l12.m1.5.5" xref="alg1.l12.m1.5.5.cmml"><mrow id="alg1.l12.m1.5.5.6" xref="alg1.l12.m1.5.5.6.cmml"><mtext id="alg1.l12.m1.5.5.6.2" mathsize="80%" xref="alg1.l12.m1.5.5.6.2a.cmml">Min</mtext><mo id="alg1.l12.m1.5.5.6.1" xref="alg1.l12.m1.5.5.6.1.cmml">⁢</mo><msubsup id="alg1.l12.m1.5.5.6.3" xref="alg1.l12.m1.5.5.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.5.5.6.3.2.2" mathsize="80%" xref="alg1.l12.m1.5.5.6.3.2.2.cmml">ℒ</mi><mtext id="alg1.l12.m1.5.5.6.3.2.3" mathsize="80%" xref="alg1.l12.m1.5.5.6.3.2.3a.cmml">adv</mtext><mi id="alg1.l12.m1.5.5.6.3.3" mathsize="80%" xref="alg1.l12.m1.5.5.6.3.3.cmml">G</mi></msubsup></mrow><mo id="alg1.l12.m1.5.5.5" mathsize="80%" xref="alg1.l12.m1.5.5.5.cmml">=</mo><mrow id="alg1.l12.m1.5.5.4" xref="alg1.l12.m1.5.5.4.cmml"><mrow id="alg1.l12.m1.3.3.2.2" xref="alg1.l12.m1.3.3.2.2.cmml"><mo id="alg1.l12.m1.3.3.2.2a" mathsize="80%" rspace="0.167em" xref="alg1.l12.m1.3.3.2.2.cmml">−</mo><mrow id="alg1.l12.m1.3.3.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.cmml"><mrow id="alg1.l12.m1.3.3.2.2.2.4" xref="alg1.l12.m1.3.3.2.2.2.4.cmml"><mi id="alg1.l12.m1.3.3.2.2.2.4.1" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.4.1.cmml">log</mi><mo id="alg1.l12.m1.3.3.2.2.2.4a" lspace="0.167em" xref="alg1.l12.m1.3.3.2.2.2.4.cmml">⁡</mo><mi id="alg1.l12.m1.3.3.2.2.2.4.2" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.4.2.cmml">D</mi></mrow><mo id="alg1.l12.m1.3.3.2.2.2.3" xref="alg1.l12.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l12.m1.3.3.2.2.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml"><mo id="alg1.l12.m1.3.3.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l12.m1.2.2.1.1.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="alg1.l12.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.1" mathsize="80%" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.l12.m1.3.3.2.2.2.2.2.4" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml">,</mo><msub id="alg1.l12.m1.3.3.2.2.2.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.2.2.2.cmml"><mi id="alg1.l12.m1.3.3.2.2.2.2.2.2.2" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l12.m1.3.3.2.2.2.2.2.2.3" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l12.m1.3.3.2.2.2.2.2.5" mathsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml">,</mo><mi id="alg1.l12.m1.1.1" mathsize="80%" xref="alg1.l12.m1.1.1.cmml">t</mi><mo id="alg1.l12.m1.3.3.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l12.m1.5.5.4.5" mathsize="80%" xref="alg1.l12.m1.5.5.4.5.cmml">+</mo><mrow id="alg1.l12.m1.5.5.4.4" xref="alg1.l12.m1.5.5.4.4.cmml"><msub id="alg1.l12.m1.5.5.4.4.4" xref="alg1.l12.m1.5.5.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.5.5.4.4.4.2" mathsize="80%" xref="alg1.l12.m1.5.5.4.4.4.2.cmml">ℒ</mi><mn id="alg1.l12.m1.5.5.4.4.4.3" mathsize="80%" xref="alg1.l12.m1.5.5.4.4.4.3.cmml">1</mn></msub><mo id="alg1.l12.m1.5.5.4.4.3" xref="alg1.l12.m1.5.5.4.4.3.cmml">⁢</mo><mrow id="alg1.l12.m1.5.5.4.4.2.2" xref="alg1.l12.m1.5.5.4.4.2.3.cmml"><mo id="alg1.l12.m1.5.5.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg1.l12.m1.5.5.4.4.2.3.cmml">(</mo><msubsup id="alg1.l12.m1.4.4.3.3.1.1.1" xref="alg1.l12.m1.4.4.3.3.1.1.1.cmml"><mi id="alg1.l12.m1.4.4.3.3.1.1.1.2.2" mathsize="80%" xref="alg1.l12.m1.4.4.3.3.1.1.1.2.2.cmml">y</mi><mn id="alg1.l12.m1.4.4.3.3.1.1.1.2.3" mathsize="80%" xref="alg1.l12.m1.4.4.3.3.1.1.1.2.3.cmml">0</mn><mo id="alg1.l12.m1.4.4.3.3.1.1.1.3" mathsize="80%" xref="alg1.l12.m1.4.4.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg1.l12.m1.5.5.4.4.2.2.4" mathsize="80%" xref="alg1.l12.m1.5.5.4.4.2.3.cmml">,</mo><msub id="alg1.l12.m1.5.5.4.4.2.2.2" xref="alg1.l12.m1.5.5.4.4.2.2.2.cmml"><mi id="alg1.l12.m1.5.5.4.4.2.2.2.2" mathsize="80%" xref="alg1.l12.m1.5.5.4.4.2.2.2.2.cmml">y</mi><mn id="alg1.l12.m1.5.5.4.4.2.2.2.3" mathsize="80%" xref="alg1.l12.m1.5.5.4.4.2.2.2.3.cmml">0</mn></msub><mo id="alg1.l12.m1.5.5.4.4.2.2.5" maxsize="80%" minsize="80%" xref="alg1.l12.m1.5.5.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.5b"><apply id="alg1.l12.m1.5.5.cmml" xref="alg1.l12.m1.5.5"><eq id="alg1.l12.m1.5.5.5.cmml" xref="alg1.l12.m1.5.5.5"></eq><apply id="alg1.l12.m1.5.5.6.cmml" xref="alg1.l12.m1.5.5.6"><times id="alg1.l12.m1.5.5.6.1.cmml" xref="alg1.l12.m1.5.5.6.1"></times><ci id="alg1.l12.m1.5.5.6.2a.cmml" xref="alg1.l12.m1.5.5.6.2"><mtext id="alg1.l12.m1.5.5.6.2.cmml" mathsize="80%" xref="alg1.l12.m1.5.5.6.2">Min</mtext></ci><apply id="alg1.l12.m1.5.5.6.3.cmml" xref="alg1.l12.m1.5.5.6.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.6.3.1.cmml" xref="alg1.l12.m1.5.5.6.3">superscript</csymbol><apply id="alg1.l12.m1.5.5.6.3.2.cmml" xref="alg1.l12.m1.5.5.6.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.6.3.2.1.cmml" xref="alg1.l12.m1.5.5.6.3">subscript</csymbol><ci id="alg1.l12.m1.5.5.6.3.2.2.cmml" xref="alg1.l12.m1.5.5.6.3.2.2">ℒ</ci><ci id="alg1.l12.m1.5.5.6.3.2.3a.cmml" xref="alg1.l12.m1.5.5.6.3.2.3"><mtext id="alg1.l12.m1.5.5.6.3.2.3.cmml" mathsize="56%" xref="alg1.l12.m1.5.5.6.3.2.3">adv</mtext></ci></apply><ci id="alg1.l12.m1.5.5.6.3.3.cmml" xref="alg1.l12.m1.5.5.6.3.3">𝐺</ci></apply></apply><apply id="alg1.l12.m1.5.5.4.cmml" xref="alg1.l12.m1.5.5.4"><plus id="alg1.l12.m1.5.5.4.5.cmml" xref="alg1.l12.m1.5.5.4.5"></plus><apply id="alg1.l12.m1.3.3.2.2.cmml" xref="alg1.l12.m1.3.3.2.2"><minus id="alg1.l12.m1.3.3.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2"></minus><apply id="alg1.l12.m1.3.3.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2"><times id="alg1.l12.m1.3.3.2.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2.3"></times><apply id="alg1.l12.m1.3.3.2.2.2.4.cmml" xref="alg1.l12.m1.3.3.2.2.2.4"><log id="alg1.l12.m1.3.3.2.2.2.4.1.cmml" xref="alg1.l12.m1.3.3.2.2.2.4.1"></log><ci id="alg1.l12.m1.3.3.2.2.2.4.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.4.2">𝐷</ci></apply><vector id="alg1.l12.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2"><apply id="alg1.l12.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg1.l12.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.2.3">′</ci></apply><apply id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3"><minus id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg1.l12.m1.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.2.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.3.3.2.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l12.m1.3.3.2.2.2.2.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg1.l12.m1.5.5.4.4.cmml" xref="alg1.l12.m1.5.5.4.4"><times id="alg1.l12.m1.5.5.4.4.3.cmml" xref="alg1.l12.m1.5.5.4.4.3"></times><apply id="alg1.l12.m1.5.5.4.4.4.cmml" xref="alg1.l12.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.4.4.4.1.cmml" xref="alg1.l12.m1.5.5.4.4.4">subscript</csymbol><ci id="alg1.l12.m1.5.5.4.4.4.2.cmml" xref="alg1.l12.m1.5.5.4.4.4.2">ℒ</ci><cn id="alg1.l12.m1.5.5.4.4.4.3.cmml" type="integer" xref="alg1.l12.m1.5.5.4.4.4.3">1</cn></apply><interval closure="open" id="alg1.l12.m1.5.5.4.4.2.3.cmml" xref="alg1.l12.m1.5.5.4.4.2.2"><apply id="alg1.l12.m1.4.4.3.3.1.1.1.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.3.3.1.1.1.1.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1">superscript</csymbol><apply id="alg1.l12.m1.4.4.3.3.1.1.1.2.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.3.3.1.1.1.2.1.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.4.4.3.3.1.1.1.2.2.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1.2.2">𝑦</ci><cn id="alg1.l12.m1.4.4.3.3.1.1.1.2.3.cmml" type="integer" xref="alg1.l12.m1.4.4.3.3.1.1.1.2.3">0</cn></apply><ci id="alg1.l12.m1.4.4.3.3.1.1.1.3.cmml" xref="alg1.l12.m1.4.4.3.3.1.1.1.3">′</ci></apply><apply id="alg1.l12.m1.5.5.4.4.2.2.2.cmml" xref="alg1.l12.m1.5.5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.4.4.2.2.2.1.cmml" xref="alg1.l12.m1.5.5.4.4.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.5.5.4.4.2.2.2.2.cmml" xref="alg1.l12.m1.5.5.4.4.2.2.2.2">𝑦</ci><cn id="alg1.l12.m1.5.5.4.4.2.2.2.3.cmml" type="integer" xref="alg1.l12.m1.5.5.4.4.2.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.5c">\text{Min}\mathcal{L}_{\text{adv}}^{G}=-\log D(y^{\prime}_{t-1},y_{t},t)+%
\mathcal{L}_{1}(y_{0}^{\prime},y_{0})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.5d">Min caligraphic_L start_POSTSUBSCRIPT adv end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT = - roman_log italic_D ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l12.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l13.2" style="font-size:80%;">until</span><span class="ltx_text" id="alg1.l13.3" style="font-size:80%;"> converged
</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Diffusion-based Generative Models</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Diffusion models, a novel class of generative models, have been recognized as SOTA generators due to their effective learning of complex distributions and their strong potential for generating diverse, high-fidelity samples. However, it has always suffered from low sampling efficiency. On this issue, Xiao <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib33" title="">33</a>]</cite> claimed that the slow sampling of diffusion models stems from the assumption that the denoising distribution is approximated by Gaussian distributions. For that, they introduce a novel generative model, termed DiffusionGAN, to parameterize the denoising distribution with a more expressive multimodal distribution, enabling denoising for larger steps. Although this model bridges the speed gap with GAN, it is still largely slower than GAN competitors. Building upon this, Phung <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib14" title="">14</a>]</cite> integrating the wavelet-based diffusion scheme into the diffusion process, namely WaveDiff, which offers faster convergence than the baseline Diffusion, and closing the gap with StyleGAN models <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib35" title="">35</a>]</cite>. Unlike traditional diffusion models, WaveDiff introduces a novel wavelet-based generative model to parameterize the denoising distribution rather than assuming the denoising distribution is Gaussian distribution, thus enabling large step sizes for fast sampling, and the diffusing/denoising process is performed in the wavelet domain.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.8">The training process of WaveDiff is outlined in algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg1" title="Algorithm 1 ‣ 2.2 Semi-Supervised Learning ‣ 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">1</span></a>, wherein the denoising process is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.F1" title="Figure 1 ‣ 2.2 Semi-Supervised Learning ‣ 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">1</span></a>. Specifically, the model comprises a generator and a discriminator, operating on images in the wavelet domain. Given the input <math alttext="y" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_y</annotation></semantics></math>, it is first transformed into <math alttext="y_{0}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">y</mi><mn id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑦</ci><cn id="S2.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">y_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> through wavelet transformation and then fed into the model for training. The generator is used to predict the denoised output of <math alttext="y_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><msubsup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.2.2.cmml">y</mi><mrow id="S2.SS3.p2.3.m3.1.1.2.3" xref="S2.SS3.p2.3.m3.1.1.2.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2.3.2" xref="S2.SS3.p2.3.m3.1.1.2.3.2.cmml">t</mi><mo id="S2.SS3.p2.3.m3.1.1.2.3.1" xref="S2.SS3.p2.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S2.SS3.p2.3.m3.1.1.2.3.3" xref="S2.SS3.p2.3.m3.1.1.2.3.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.2">𝑦</ci><apply id="S2.SS3.p2.3.m3.1.1.2.3.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3"><minus id="S2.SS3.p2.3.m3.1.1.2.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3.1"></minus><ci id="S2.SS3.p2.3.m3.1.1.2.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3.2">𝑡</ci><cn id="S2.SS3.p2.3.m3.1.1.2.3.3.cmml" type="integer" xref="S2.SS3.p2.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">y_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. But instead of directly outputting <math alttext="y_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><msubsup id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2.2" xref="S2.SS3.p2.4.m4.1.1.2.2.cmml">y</mi><mrow id="S2.SS3.p2.4.m4.1.1.2.3" xref="S2.SS3.p2.4.m4.1.1.2.3.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2.3.2" xref="S2.SS3.p2.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S2.SS3.p2.4.m4.1.1.2.3.1" xref="S2.SS3.p2.4.m4.1.1.2.3.1.cmml">−</mo><mn id="S2.SS3.p2.4.m4.1.1.2.3.3" xref="S2.SS3.p2.4.m4.1.1.2.3.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">superscript</csymbol><apply id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.2">𝑦</ci><apply id="S2.SS3.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3"><minus id="S2.SS3.p2.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.1"></minus><ci id="S2.SS3.p2.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.2">𝑡</ci><cn id="S2.SS3.p2.4.m4.1.1.2.3.3.cmml" type="integer" xref="S2.SS3.p2.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">y_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> in the denoising step, the generator first predicts the <math alttext="y_{0}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.1"><semantics id="S2.SS3.p2.5.m5.1a"><msubsup id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2.2" xref="S2.SS3.p2.5.m5.1.1.2.2.cmml">y</mi><mn id="S2.SS3.p2.5.m5.1.1.2.3" xref="S2.SS3.p2.5.m5.1.1.2.3.cmml">0</mn><mo id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">superscript</csymbol><apply id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2.2">𝑦</ci><cn id="S2.SS3.p2.5.m5.1.1.2.3.cmml" type="integer" xref="S2.SS3.p2.5.m5.1.1.2.3">0</cn></apply><ci id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">y_{0}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> from the noise-corrupted version of the data <math alttext="y_{t}\sim q(y_{t}\mid y_{0})" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.1"><semantics id="S2.SS3.p2.6.m6.1a"><mrow id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml"><msub id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.2" xref="S2.SS3.p2.6.m6.1.1.3.2.cmml">y</mi><mi id="S2.SS3.p2.6.m6.1.1.3.3" xref="S2.SS3.p2.6.m6.1.1.3.3.cmml">t</mi></msub><mo id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">∼</mo><mrow id="S2.SS3.p2.6.m6.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.1.3" xref="S2.SS3.p2.6.m6.1.1.1.3.cmml">q</mi><mo id="S2.SS3.p2.6.m6.1.1.1.2" xref="S2.SS3.p2.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p2.6.m6.1.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.6.m6.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.6.m6.1.1.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml"><msub id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.2" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.3" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS3.p2.6.m6.1.1.1.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.2" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.2.cmml">y</mi><mn id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.3" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S2.SS3.p2.6.m6.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1"><csymbol cd="latexml" id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">similar-to</csymbol><apply id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2">𝑦</ci><ci id="S2.SS3.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3">𝑡</ci></apply><apply id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1"><times id="S2.SS3.p2.6.m6.1.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.1.2"></times><ci id="S2.SS3.p2.6.m6.1.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.1.3">𝑞</ci><apply id="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.2">𝑦</ci><cn id="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">y_{t}\sim q(y_{t}\mid y_{0})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_q ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> at time step t, and then using the posterior distribution: <math alttext="y_{t-1}^{\prime}\sim q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m7.1"><semantics id="S2.SS3.p2.7.m7.1a"><mrow id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml"><msubsup id="S2.SS3.p2.7.m7.1.1.3" xref="S2.SS3.p2.7.m7.1.1.3.cmml"><mi id="S2.SS3.p2.7.m7.1.1.3.2.2" xref="S2.SS3.p2.7.m7.1.1.3.2.2.cmml">y</mi><mrow id="S2.SS3.p2.7.m7.1.1.3.2.3" xref="S2.SS3.p2.7.m7.1.1.3.2.3.cmml"><mi id="S2.SS3.p2.7.m7.1.1.3.2.3.2" xref="S2.SS3.p2.7.m7.1.1.3.2.3.2.cmml">t</mi><mo id="S2.SS3.p2.7.m7.1.1.3.2.3.1" xref="S2.SS3.p2.7.m7.1.1.3.2.3.1.cmml">−</mo><mn id="S2.SS3.p2.7.m7.1.1.3.2.3.3" xref="S2.SS3.p2.7.m7.1.1.3.2.3.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.7.m7.1.1.3.3" xref="S2.SS3.p2.7.m7.1.1.3.3.cmml">′</mo></msubsup><mo id="S2.SS3.p2.7.m7.1.1.2" xref="S2.SS3.p2.7.m7.1.1.2.cmml">∼</mo><mrow id="S2.SS3.p2.7.m7.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.3" xref="S2.SS3.p2.7.m7.1.1.1.3.cmml">q</mi><mo id="S2.SS3.p2.7.m7.1.1.1.2" xref="S2.SS3.p2.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p2.7.m7.1.1.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.7.m7.1.1.1.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml"><msubsup id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.3.cmml"><msub id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><apply id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1"><csymbol cd="latexml" id="S2.SS3.p2.7.m7.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.2">similar-to</csymbol><apply id="S2.SS3.p2.7.m7.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.3.1.cmml" xref="S2.SS3.p2.7.m7.1.1.3">superscript</csymbol><apply id="S2.SS3.p2.7.m7.1.1.3.2.cmml" xref="S2.SS3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.3.2.1.cmml" xref="S2.SS3.p2.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.7.m7.1.1.3.2.2.cmml" xref="S2.SS3.p2.7.m7.1.1.3.2.2">𝑦</ci><apply id="S2.SS3.p2.7.m7.1.1.3.2.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3.2.3"><minus id="S2.SS3.p2.7.m7.1.1.3.2.3.1.cmml" xref="S2.SS3.p2.7.m7.1.1.3.2.3.1"></minus><ci id="S2.SS3.p2.7.m7.1.1.3.2.3.2.cmml" xref="S2.SS3.p2.7.m7.1.1.3.2.3.2">𝑡</ci><cn id="S2.SS3.p2.7.m7.1.1.3.2.3.3.cmml" type="integer" xref="S2.SS3.p2.7.m7.1.1.3.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.7.m7.1.1.3.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3.3">′</ci></apply><apply id="S2.SS3.p2.7.m7.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1"><times id="S2.SS3.p2.7.m7.1.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.2"></times><ci id="S2.SS3.p2.7.m7.1.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.3">𝑞</ci><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4">superscript</csymbol><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.2">𝑦</ci><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3"><minus id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.1"></minus><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.4.3">′</ci></apply><list id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2"><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">y_{t-1}^{\prime}\sim q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> to get the denoised output <math alttext="y_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p2.8.m8.1"><semantics id="S2.SS3.p2.8.m8.1a"><msubsup id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml"><mi id="S2.SS3.p2.8.m8.1.1.2.2" xref="S2.SS3.p2.8.m8.1.1.2.2.cmml">y</mi><mrow id="S2.SS3.p2.8.m8.1.1.2.3" xref="S2.SS3.p2.8.m8.1.1.2.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.2.3.2" xref="S2.SS3.p2.8.m8.1.1.2.3.2.cmml">t</mi><mo id="S2.SS3.p2.8.m8.1.1.2.3.1" xref="S2.SS3.p2.8.m8.1.1.2.3.1.cmml">−</mo><mn id="S2.SS3.p2.8.m8.1.1.2.3.3" xref="S2.SS3.p2.8.m8.1.1.2.3.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.8.m8.1.1.3" xref="S2.SS3.p2.8.m8.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><apply id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1">superscript</csymbol><apply id="S2.SS3.p2.8.m8.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.2.1.cmml" xref="S2.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.2.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2.2">𝑦</ci><apply id="S2.SS3.p2.8.m8.1.1.2.3.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3"><minus id="S2.SS3.p2.8.m8.1.1.2.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3.1"></minus><ci id="S2.SS3.p2.8.m8.1.1.2.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3.2">𝑡</ci><cn id="S2.SS3.p2.8.m8.1.1.2.3.3.cmml" type="integer" xref="S2.SS3.p2.8.m8.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.8.m8.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">y_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.8.m8.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. So it can implicitly model the denoising distribution. The discriminator is used to determine the authenticity of the denoised outputs and optimizes both the generator and the discriminator in an adversarial training manner. Moreover, the introduction of wavelets enrich the frequency-aware at both image and feature levels, which will facilitate the perceptual quality of the generated images <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>. Inspired by this model, we customize a wavelet diffusion model, built upon WaveDiff, to serve as the backbone of SemiDDM-Weather by modifying its inputs and loss functions to better adapt to our adverse weather removal task.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="505" id="S2.F2.1.g1" src="x2.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of our <span class="ltx_text ltx_font_bold" id="S2.F2.3.1">SemiDDM-Weather</span> framework, which innovatively integrates a DDM into the teacher-student network
</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The Proposed SemiDDM-Weather</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section detailedly describes the design of our SemiDDM-Weather. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS1" title="3.1 Semi-Supervised Adverse Weather Removal Framework ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3.1</span></a> outlines the proposed semi-supervised adverse weather removal framework, i.e., SemiDDM-Weather. How we customize a wavelet diffusion model to serve as the backbone of SemiDDM-Weather, is provided in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS2" title="3.2 Customization of a Wavelet Diffusion Model ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3.2</span></a>. The targeted design for improving the accuracy of pseudo-labels under the teacher-student based network is detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS3" title="3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Training and inference details are presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.SS4" title="3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Semi-Supervised Adverse Weather Removal Framework</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To achieve the removal of various adverse weather conditions with limited labeled data, inspired by study in <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib36" title="">36</a>]</cite>, we adopt a teacher-student network<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In this paper, for differentiation, we use the subscripts ‘<span class="ltx_text ltx_markedasmath" id="footnote1.1">tn</span>’ and ‘<span class="ltx_text ltx_markedasmath" id="footnote1.2">sn</span>’ to indicate the teacher and student networks, respectively.</span></span></span> as the foundation for semi-supervised learning. As depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.F2" title="Figure 2 ‣ 2.3 Diffusion-based Generative Models ‣ 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">2</span></a>, the teacher and student networks share the same structure network with a customized wavelet diffusion model as the backbone to effectively capture the complex many-to-one mapping distributions.
The teacher network is responsible for generating pseudo-labels for unlabeled images, which are subsequently utilized to guide the training of the student network. Its weights <math alttext="\theta_{\text{tn}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">θ</mi><mtext id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3a.cmml">tn</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><mtext id="S3.SS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.1.m1.1.1.3">tn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\theta_{\text{tn}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT tn end_POSTSUBSCRIPT</annotation></semantics></math> are updated from the student network via EMA strategy, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\theta_{\text{tn}}=\eta\cdot\theta_{\text{tn}}+(1-\eta)\cdot\theta_{\text{sn}}," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">θ</mi><mtext id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3a.cmml">tn</mtext></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">η</mi><mo id="S3.E1.m1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.3.3.2.cmml">θ</mi><mtext id="S3.E1.m1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.3a.cmml">tn</mtext></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">θ</mi><mtext id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3a.cmml">sn</mtext></msub></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><mtext id="S3.E1.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.3">tn</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></plus><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><ci id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3.1">⋅</ci><ci id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">𝜂</ci><apply id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.1.3.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3.3"><mtext id="S3.E1.m1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.1.3.3.3">tn</mtext></ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝜂</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3"><mtext id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.1.1.3.3">sn</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\theta_{\text{tn}}=\eta\cdot\theta_{\text{tn}}+(1-\eta)\cdot\theta_{\text{sn}},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_θ start_POSTSUBSCRIPT tn end_POSTSUBSCRIPT = italic_η ⋅ italic_θ start_POSTSUBSCRIPT tn end_POSTSUBSCRIPT + ( 1 - italic_η ) ⋅ italic_θ start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.2">where <math alttext="\eta\in(0,1)" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.2"><semantics id="S3.SS1.p1.2.m1.2a"><mrow id="S3.SS1.p1.2.m1.2.3" xref="S3.SS1.p1.2.m1.2.3.cmml"><mi id="S3.SS1.p1.2.m1.2.3.2" xref="S3.SS1.p1.2.m1.2.3.2.cmml">η</mi><mo id="S3.SS1.p1.2.m1.2.3.1" xref="S3.SS1.p1.2.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.2.m1.2.3.3.2" xref="S3.SS1.p1.2.m1.2.3.3.1.cmml"><mo id="S3.SS1.p1.2.m1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.2.m1.2.3.3.1.cmml">(</mo><mn id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml">0</mn><mo id="S3.SS1.p1.2.m1.2.3.3.2.2" xref="S3.SS1.p1.2.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.2.m1.2.2" xref="S3.SS1.p1.2.m1.2.2.cmml">1</mn><mo id="S3.SS1.p1.2.m1.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.2b"><apply id="S3.SS1.p1.2.m1.2.3.cmml" xref="S3.SS1.p1.2.m1.2.3"><in id="S3.SS1.p1.2.m1.2.3.1.cmml" xref="S3.SS1.p1.2.m1.2.3.1"></in><ci id="S3.SS1.p1.2.m1.2.3.2.cmml" xref="S3.SS1.p1.2.m1.2.3.2">𝜂</ci><interval closure="open" id="S3.SS1.p1.2.m1.2.3.3.1.cmml" xref="S3.SS1.p1.2.m1.2.3.3.2"><cn id="S3.SS1.p1.2.m1.1.1.cmml" type="integer" xref="S3.SS1.p1.2.m1.1.1">0</cn><cn id="S3.SS1.p1.2.m1.2.2.cmml" type="integer" xref="S3.SS1.p1.2.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.2c">\eta\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.2d">italic_η ∈ ( 0 , 1 )</annotation></semantics></math> denotes the momentum that controls the updating rate, serving to smooth the parameters over time. Given that the teacher network’s outputs may not consistently outperform the student network’s, directly using them as pseudo-labels could introduce inaccuracies and potentially mislead the student network’s training.
To abate this risk, we use the “optimal” outputs generated by the teacher network during training to more effectively steer the student network’s learning.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">The student network parameters, denoted as <math alttext="\theta_{\text{sn}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">θ</mi><mtext id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3a.cmml">sn</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝜃</ci><ci id="S3.SS1.p2.1.m1.1.1.3a.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><mtext id="S3.SS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.1.m1.1.1.3">sn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\theta_{\text{sn}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_θ start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT</annotation></semantics></math>, are trained with both labeled images and unlabeled images. Concretely, the training of the student network can be formulated as minimizing the loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">caligraphic_L</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}=\mathcal{L}_{\text{sup}}+\lambda_{t}\cdot\mathcal{L}_{\text{unsup}}," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3a.cmml">sup</mtext></msub><mo id="S3.E2.m1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="S3.E2.m1.1.1.1.1.3.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.E2.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E2.m1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.3a.cmml">unsup</mtext></msub></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><ci id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><plus id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.1"></plus><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3"><mtext id="S3.E2.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.2.3">sup</mtext></ci></apply><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><ci id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3.3"><mtext id="S3.E2.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.3.3.3">unsup</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathcal{L}=\mathcal{L}_{\text{sup}}+\lambda_{t}\cdot\mathcal{L}_{\text{unsup}},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ caligraphic_L start_POSTSUBSCRIPT unsup end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.7">where <math alttext="\mathcal{L}_{\text{sup}}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m1.1"><semantics id="S3.SS1.p2.3.m1.1a"><msub id="S3.SS1.p2.3.m1.1.1" xref="S3.SS1.p2.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m1.1.1.2" xref="S3.SS1.p2.3.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.3.m1.1.1.3" xref="S3.SS1.p2.3.m1.1.1.3a.cmml">sup</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m1.1b"><apply id="S3.SS1.p2.3.m1.1.1.cmml" xref="S3.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m1.1.1.1.cmml" xref="S3.SS1.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m1.1.1.2.cmml" xref="S3.SS1.p2.3.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p2.3.m1.1.1.3a.cmml" xref="S3.SS1.p2.3.m1.1.1.3"><mtext id="S3.SS1.p2.3.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.3.m1.1.1.3">sup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m1.1c">\mathcal{L}_{\text{sup}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m1.1d">caligraphic_L start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\text{unsup}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m2.1"><semantics id="S3.SS1.p2.4.m2.1a"><msub id="S3.SS1.p2.4.m2.1.1" xref="S3.SS1.p2.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m2.1.1.2" xref="S3.SS1.p2.4.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.4.m2.1.1.3" xref="S3.SS1.p2.4.m2.1.1.3a.cmml">unsup</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m2.1b"><apply id="S3.SS1.p2.4.m2.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m2.1.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m2.1.1.2.cmml" xref="S3.SS1.p2.4.m2.1.1.2">ℒ</ci><ci id="S3.SS1.p2.4.m2.1.1.3a.cmml" xref="S3.SS1.p2.4.m2.1.1.3"><mtext id="S3.SS1.p2.4.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.4.m2.1.1.3">unsup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m2.1c">\mathcal{L}_{\text{unsup}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m2.1d">caligraphic_L start_POSTSUBSCRIPT unsup end_POSTSUBSCRIPT</annotation></semantics></math> represent the supervised loss and unsupervised loss, respectively, and <math alttext="\lambda_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m3.1"><semantics id="S3.SS1.p2.5.m3.1a"><msub id="S3.SS1.p2.5.m3.1.1" xref="S3.SS1.p2.5.m3.1.1.cmml"><mi id="S3.SS1.p2.5.m3.1.1.2" xref="S3.SS1.p2.5.m3.1.1.2.cmml">λ</mi><mi id="S3.SS1.p2.5.m3.1.1.3" xref="S3.SS1.p2.5.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m3.1b"><apply id="S3.SS1.p2.5.m3.1.1.cmml" xref="S3.SS1.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m3.1.1.1.cmml" xref="S3.SS1.p2.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m3.1.1.2.cmml" xref="S3.SS1.p2.5.m3.1.1.2">𝜆</ci><ci id="S3.SS1.p2.5.m3.1.1.3.cmml" xref="S3.SS1.p2.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m3.1c">\lambda_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m3.1d">italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a time-varying hyper-parameter for the trade-off between <math alttext="\mathcal{L}_{\text{sup}}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m4.1"><semantics id="S3.SS1.p2.6.m4.1a"><msub id="S3.SS1.p2.6.m4.1.1" xref="S3.SS1.p2.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m4.1.1.2" xref="S3.SS1.p2.6.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.6.m4.1.1.3" xref="S3.SS1.p2.6.m4.1.1.3a.cmml">sup</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m4.1b"><apply id="S3.SS1.p2.6.m4.1.1.cmml" xref="S3.SS1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m4.1.1.1.cmml" xref="S3.SS1.p2.6.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m4.1.1.2.cmml" xref="S3.SS1.p2.6.m4.1.1.2">ℒ</ci><ci id="S3.SS1.p2.6.m4.1.1.3a.cmml" xref="S3.SS1.p2.6.m4.1.1.3"><mtext id="S3.SS1.p2.6.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.6.m4.1.1.3">sup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m4.1c">\mathcal{L}_{\text{sup}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m4.1d">caligraphic_L start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{\text{unsup}}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m5.1"><semantics id="S3.SS1.p2.7.m5.1a"><msub id="S3.SS1.p2.7.m5.1.1" xref="S3.SS1.p2.7.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.7.m5.1.1.2" xref="S3.SS1.p2.7.m5.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.7.m5.1.1.3" xref="S3.SS1.p2.7.m5.1.1.3a.cmml">unsup</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m5.1b"><apply id="S3.SS1.p2.7.m5.1.1.cmml" xref="S3.SS1.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m5.1.1.1.cmml" xref="S3.SS1.p2.7.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m5.1.1.2.cmml" xref="S3.SS1.p2.7.m5.1.1.2">ℒ</ci><ci id="S3.SS1.p2.7.m5.1.1.3a.cmml" xref="S3.SS1.p2.7.m5.1.1.3"><mtext id="S3.SS1.p2.7.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.7.m5.1.1.3">unsup</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m5.1c">\mathcal{L}_{\text{unsup}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m5.1d">caligraphic_L start_POSTSUBSCRIPT unsup end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Customization of a Wavelet Diffusion Model</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.9">In our scheme, degraded images are required as conditional inputs to the generator, allowing us to generate pairwise corresponding estimates of these degraded images, but this inevitably consumes more computational resources. Moreover, WaveDiff’s generator exclusively utilizes <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">ℒ</ci><cn id="S3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss for constraining the generated content, which does not adequately ensure content consistency between the generated outputs and the degraded image conditional inputs. Therefore, directly using it as the backbone of our framework may not be well-suited to our task. Upon these deficiencies, We customize a wavelet diffusion model as the backbone of SemiDDM-Weather which is built upon WaveDiff by modifying its model inputs and loss functions to better adapt to our adverse weather removal task. Specifically, to trade off the computational resource consumption and high-performance model training, we adopt a crop-based training strategy that feeds the model with a cropped <math alttext="64\times 64" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">64</mn><mo id="S3.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></times><cn id="S3.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.2">64</cn><cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">64 × 64</annotation></semantics></math> patch from the input image instead of the entire image. To address the limitations of using only <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">ℒ</ci><cn id="S3.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss for content consistency constraint, we incorporate perceptual loss to guide training, which can effectively preserve the texture and structural information of the images. In addition, we further extend the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">ℒ</ci><cn id="S3.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss to a combination of <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">ℒ</ci><cn id="S3.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{{2}}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">ℒ</ci><cn id="S3.SS2.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{L}_{{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> losses, thus combining the advantages of the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">ℒ</ci><cn id="S3.SS2.p1.7.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss in maintaining pixel accuracy with the insensitivity of the <math alttext="\mathcal{L}_{{2}}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">ℒ</ci><cn id="S3.SS2.p1.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathcal{L}_{{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> loss to noise for better content reconstruction. What’s more, similar to previous semi-supervised learning frameworks, we use the contrast loss instead of the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">ℒ</mi><mn id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">ℒ</ci><cn id="S3.SS2.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS2.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss as the consistency constraint to reduce the risk of the model overfit to incorrect predictions, thereby diminishing confirmation bias <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib32" title="">32</a>]</cite>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> The acquisition of “optimal” pseudo-labels</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span><math alttext="{y}^{t}_{c}=\text{Reverse}_{t}(y_{t},x_{0}),{y}^{s}_{c}=\text{Reverse}_{s}(y_{%
t},x_{0})" class="ltx_Math" display="inline" id="alg2.l1.m1.2"><semantics id="alg2.l1.m1.2a"><mrow id="alg2.l1.m1.2.2.2" xref="alg2.l1.m1.2.2.3.cmml"><mrow id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml"><msubsup id="alg2.l1.m1.1.1.1.1.4" xref="alg2.l1.m1.1.1.1.1.4.cmml"><mi id="alg2.l1.m1.1.1.1.1.4.2.2" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.4.2.2.cmml">y</mi><mi id="alg2.l1.m1.1.1.1.1.4.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.4.3.cmml">c</mi><mi id="alg2.l1.m1.1.1.1.1.4.2.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.4.2.3.cmml">t</mi></msubsup><mo id="alg2.l1.m1.1.1.1.1.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.3.cmml">=</mo><mrow id="alg2.l1.m1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.2.cmml"><msub id="alg2.l1.m1.1.1.1.1.2.4" xref="alg2.l1.m1.1.1.1.1.2.4.cmml"><mtext id="alg2.l1.m1.1.1.1.1.2.4.2" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.4.2a.cmml">Reverse</mtext><mi id="alg2.l1.m1.1.1.1.1.2.4.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo id="alg2.l1.m1.1.1.1.1.2.3" xref="alg2.l1.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg2.l1.m1.1.1.1.1.2.2.2" xref="alg2.l1.m1.1.1.1.1.2.2.3.cmml"><mo id="alg2.l1.m1.1.1.1.1.2.2.2.3" maxsize="80%" minsize="80%" xref="alg2.l1.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="alg2.l1.m1.1.1.1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.1.1.1.1.2" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg2.l1.m1.1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l1.m1.1.1.1.1.2.2.2.4" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg2.l1.m1.1.1.1.1.2.2.2.2" xref="alg2.l1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="alg2.l1.m1.1.1.1.1.2.2.2.2.2" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mn id="alg2.l1.m1.1.1.1.1.2.2.2.2.3" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.2.2.2.3.cmml">0</mn></msub><mo id="alg2.l1.m1.1.1.1.1.2.2.2.5" maxsize="80%" minsize="80%" xref="alg2.l1.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l1.m1.2.2.2.3" mathsize="80%" xref="alg2.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg2.l1.m1.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.cmml"><msubsup id="alg2.l1.m1.2.2.2.2.4" xref="alg2.l1.m1.2.2.2.2.4.cmml"><mi id="alg2.l1.m1.2.2.2.2.4.2.2" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.4.2.2.cmml">y</mi><mi id="alg2.l1.m1.2.2.2.2.4.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.4.3.cmml">c</mi><mi id="alg2.l1.m1.2.2.2.2.4.2.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.4.2.3.cmml">s</mi></msubsup><mo id="alg2.l1.m1.2.2.2.2.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.3.cmml">=</mo><mrow id="alg2.l1.m1.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.cmml"><msub id="alg2.l1.m1.2.2.2.2.2.4" xref="alg2.l1.m1.2.2.2.2.2.4.cmml"><mtext id="alg2.l1.m1.2.2.2.2.2.4.2" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.4.2a.cmml">Reverse</mtext><mi id="alg2.l1.m1.2.2.2.2.2.4.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.4.3.cmml">s</mi></msub><mo id="alg2.l1.m1.2.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="alg2.l1.m1.2.2.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.2.3.cmml"><mo id="alg2.l1.m1.2.2.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg2.l1.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="alg2.l1.m1.2.2.2.2.1.1.1.1" xref="alg2.l1.m1.2.2.2.2.1.1.1.1.cmml"><mi id="alg2.l1.m1.2.2.2.2.1.1.1.1.2" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.1.1.1.1.2.cmml">y</mi><mi id="alg2.l1.m1.2.2.2.2.1.1.1.1.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l1.m1.2.2.2.2.2.2.2.4" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="alg2.l1.m1.2.2.2.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg2.l1.m1.2.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.2.2.2.2.cmml">x</mi><mn id="alg2.l1.m1.2.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="alg2.l1.m1.2.2.2.2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg2.l1.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.2b"><apply id="alg2.l1.m1.2.2.3.cmml" xref="alg2.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.3a.cmml" xref="alg2.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1"><eq id="alg2.l1.m1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.3"></eq><apply id="alg2.l1.m1.1.1.1.1.4.cmml" xref="alg2.l1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.4.1.cmml" xref="alg2.l1.m1.1.1.1.1.4">subscript</csymbol><apply id="alg2.l1.m1.1.1.1.1.4.2.cmml" xref="alg2.l1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l1.m1.1.1.1.1.4">superscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.4.2.2">𝑦</ci><ci id="alg2.l1.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l1.m1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="alg2.l1.m1.1.1.1.1.4.3.cmml" xref="alg2.l1.m1.1.1.1.1.4.3">𝑐</ci></apply><apply id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.2"><times id="alg2.l1.m1.1.1.1.1.2.3.cmml" xref="alg2.l1.m1.1.1.1.1.2.3"></times><apply id="alg2.l1.m1.1.1.1.1.2.4.cmml" xref="alg2.l1.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.2.4.1.cmml" xref="alg2.l1.m1.1.1.1.1.2.4">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.2.4.2a.cmml" xref="alg2.l1.m1.1.1.1.1.2.4.2"><mtext id="alg2.l1.m1.1.1.1.1.2.4.2.cmml" mathsize="80%" xref="alg2.l1.m1.1.1.1.1.2.4.2">Reverse</mtext></ci><ci id="alg2.l1.m1.1.1.1.1.2.4.3.cmml" xref="alg2.l1.m1.1.1.1.1.2.4.3">𝑡</ci></apply><interval closure="open" id="alg2.l1.m1.1.1.1.1.2.2.3.cmml" xref="alg2.l1.m1.1.1.1.1.2.2.2"><apply id="alg2.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg2.l1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l1.m1.1.1.1.1.2.2.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="alg2.l1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="alg2.l1.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><cn id="alg2.l1.m1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="alg2.l1.m1.1.1.1.1.2.2.2.2.3">0</cn></apply></interval></apply></apply><apply id="alg2.l1.m1.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2"><eq id="alg2.l1.m1.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.3"></eq><apply id="alg2.l1.m1.2.2.2.2.4.cmml" xref="alg2.l1.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.4.1.cmml" xref="alg2.l1.m1.2.2.2.2.4">subscript</csymbol><apply id="alg2.l1.m1.2.2.2.2.4.2.cmml" xref="alg2.l1.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.4.2.1.cmml" xref="alg2.l1.m1.2.2.2.2.4">superscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.4.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.4.2.2">𝑦</ci><ci id="alg2.l1.m1.2.2.2.2.4.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.4.2.3">𝑠</ci></apply><ci id="alg2.l1.m1.2.2.2.2.4.3.cmml" xref="alg2.l1.m1.2.2.2.2.4.3">𝑐</ci></apply><apply id="alg2.l1.m1.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2"><times id="alg2.l1.m1.2.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.3"></times><apply id="alg2.l1.m1.2.2.2.2.2.4.cmml" xref="alg2.l1.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.2.4.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.4">subscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.4.2a.cmml" xref="alg2.l1.m1.2.2.2.2.2.4.2"><mtext id="alg2.l1.m1.2.2.2.2.2.4.2.cmml" mathsize="80%" xref="alg2.l1.m1.2.2.2.2.2.4.2">Reverse</mtext></ci><ci id="alg2.l1.m1.2.2.2.2.2.4.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.4.3">𝑠</ci></apply><interval closure="open" id="alg2.l1.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.2.2"><apply id="alg2.l1.m1.2.2.2.2.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.2.2.1.1.1.1.2">𝑦</ci><ci id="alg2.l1.m1.2.2.2.2.1.1.1.1.3.cmml" xref="alg2.l1.m1.2.2.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.2.2.2.2">𝑥</ci><cn id="alg2.l1.m1.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="alg2.l1.m1.2.2.2.2.2.2.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.2c">{y}^{t}_{c}=\text{Reverse}_{t}(y_{t},x_{0}),{y}^{s}_{c}=\text{Reverse}_{s}(y_{%
t},x_{0})</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.2d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Reverse start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Reverse start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg2.l1.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l2.2" style="font-size:80%;">if</span><span class="ltx_text" id="alg2.l2.3" style="font-size:80%;"> </span><math alttext="\textsc{Q}({y}^{t}_{c})&gt;\max(\textsc{Q}({y}^{s}_{c}),\textsc{Q}(y_{c}))\text{ %
and }\mathcal{L}_{1}({y}^{t}_{c},{y}^{s}_{c})&lt;\varphi" class="ltx_Math" display="inline" id="alg2.l2.m1.6"><semantics id="alg2.l2.m1.6a"><mrow id="alg2.l2.m1.6.6" xref="alg2.l2.m1.6.6.cmml"><mrow id="alg2.l2.m1.2.2.1" xref="alg2.l2.m1.2.2.1.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.2.2.1.3" mathsize="80%" xref="alg2.l2.m1.2.2.1.3a.cmml">Q</mtext><mo id="alg2.l2.m1.2.2.1.2" xref="alg2.l2.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l2.m1.2.2.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.cmml"><mo id="alg2.l2.m1.2.2.1.1.1.2" maxsize="80%" minsize="80%" xref="alg2.l2.m1.2.2.1.1.1.1.cmml">(</mo><msubsup id="alg2.l2.m1.2.2.1.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l2.m1.2.2.1.1.1.1.2.2" mathsize="80%" xref="alg2.l2.m1.2.2.1.1.1.1.2.2.cmml">y</mi><mi id="alg2.l2.m1.2.2.1.1.1.1.3" mathsize="80%" xref="alg2.l2.m1.2.2.1.1.1.1.3.cmml">c</mi><mi id="alg2.l2.m1.2.2.1.1.1.1.2.3" mathsize="80%" xref="alg2.l2.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg2.l2.m1.2.2.1.1.1.3" maxsize="80%" minsize="80%" xref="alg2.l2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l2.m1.6.6.7" mathsize="80%" xref="alg2.l2.m1.6.6.7.cmml">&gt;</mo><mrow id="alg2.l2.m1.6.6.5" xref="alg2.l2.m1.6.6.5.cmml"><mrow id="alg2.l2.m1.4.4.3.2.2" xref="alg2.l2.m1.4.4.3.2.3.cmml"><mi id="alg2.l2.m1.1.1" mathsize="80%" xref="alg2.l2.m1.1.1.cmml">max</mi><mo id="alg2.l2.m1.4.4.3.2.2a" xref="alg2.l2.m1.4.4.3.2.3.cmml">⁡</mo><mrow id="alg2.l2.m1.4.4.3.2.2.2" xref="alg2.l2.m1.4.4.3.2.3.cmml"><mo id="alg2.l2.m1.4.4.3.2.2.2.3" maxsize="80%" minsize="80%" xref="alg2.l2.m1.4.4.3.2.3.cmml">(</mo><mrow id="alg2.l2.m1.3.3.2.1.1.1.1" xref="alg2.l2.m1.3.3.2.1.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.3.3.2.1.1.1.1.3" mathsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.3a.cmml">Q</mtext><mo id="alg2.l2.m1.3.3.2.1.1.1.1.2" xref="alg2.l2.m1.3.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l2.m1.3.3.2.1.1.1.1.1.1" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mo id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.3.cmml">c</mi><mi id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l2.m1.4.4.3.2.2.2.4" mathsize="80%" xref="alg2.l2.m1.4.4.3.2.3.cmml">,</mo><mrow id="alg2.l2.m1.4.4.3.2.2.2.2" xref="alg2.l2.m1.4.4.3.2.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.4.4.3.2.2.2.2.3" mathsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.3a.cmml">Q</mtext><mo id="alg2.l2.m1.4.4.3.2.2.2.2.2" xref="alg2.l2.m1.4.4.3.2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l2.m1.4.4.3.2.2.2.2.1.1" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.cmml"><mo id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.2" maxsize="80%" minsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.cmml"><mi id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.2" mathsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.2.cmml">y</mi><mi id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.3" mathsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.3.cmml">c</mi></msub><mo id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.3" maxsize="80%" minsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l2.m1.4.4.3.2.2.2.5" maxsize="80%" minsize="80%" xref="alg2.l2.m1.4.4.3.2.3.cmml">)</mo></mrow></mrow><mo id="alg2.l2.m1.6.6.5.5" xref="alg2.l2.m1.6.6.5.5.cmml">⁢</mo><mtext id="alg2.l2.m1.6.6.5.6" mathsize="80%" xref="alg2.l2.m1.6.6.5.6a.cmml"> and </mtext><mo id="alg2.l2.m1.6.6.5.5a" xref="alg2.l2.m1.6.6.5.5.cmml">⁢</mo><msub id="alg2.l2.m1.6.6.5.7" xref="alg2.l2.m1.6.6.5.7.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.6.6.5.7.2" mathsize="80%" xref="alg2.l2.m1.6.6.5.7.2.cmml">ℒ</mi><mn id="alg2.l2.m1.6.6.5.7.3" mathsize="80%" xref="alg2.l2.m1.6.6.5.7.3.cmml">1</mn></msub><mo id="alg2.l2.m1.6.6.5.5b" xref="alg2.l2.m1.6.6.5.5.cmml">⁢</mo><mrow id="alg2.l2.m1.6.6.5.4.2" xref="alg2.l2.m1.6.6.5.4.3.cmml"><mo id="alg2.l2.m1.6.6.5.4.2.3" maxsize="80%" minsize="80%" xref="alg2.l2.m1.6.6.5.4.3.cmml">(</mo><msubsup id="alg2.l2.m1.5.5.4.3.1.1" xref="alg2.l2.m1.5.5.4.3.1.1.cmml"><mi id="alg2.l2.m1.5.5.4.3.1.1.2.2" mathsize="80%" xref="alg2.l2.m1.5.5.4.3.1.1.2.2.cmml">y</mi><mi id="alg2.l2.m1.5.5.4.3.1.1.3" mathsize="80%" xref="alg2.l2.m1.5.5.4.3.1.1.3.cmml">c</mi><mi id="alg2.l2.m1.5.5.4.3.1.1.2.3" mathsize="80%" xref="alg2.l2.m1.5.5.4.3.1.1.2.3.cmml">t</mi></msubsup><mo id="alg2.l2.m1.6.6.5.4.2.4" mathsize="80%" xref="alg2.l2.m1.6.6.5.4.3.cmml">,</mo><msubsup id="alg2.l2.m1.6.6.5.4.2.2" xref="alg2.l2.m1.6.6.5.4.2.2.cmml"><mi id="alg2.l2.m1.6.6.5.4.2.2.2.2" mathsize="80%" xref="alg2.l2.m1.6.6.5.4.2.2.2.2.cmml">y</mi><mi id="alg2.l2.m1.6.6.5.4.2.2.3" mathsize="80%" xref="alg2.l2.m1.6.6.5.4.2.2.3.cmml">c</mi><mi id="alg2.l2.m1.6.6.5.4.2.2.2.3" mathsize="80%" xref="alg2.l2.m1.6.6.5.4.2.2.2.3.cmml">s</mi></msubsup><mo id="alg2.l2.m1.6.6.5.4.2.5" maxsize="80%" minsize="80%" xref="alg2.l2.m1.6.6.5.4.3.cmml">)</mo></mrow></mrow><mo id="alg2.l2.m1.6.6.8" mathsize="80%" xref="alg2.l2.m1.6.6.8.cmml">&lt;</mo><mi id="alg2.l2.m1.6.6.9" mathsize="80%" xref="alg2.l2.m1.6.6.9.cmml">φ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.6b"><apply id="alg2.l2.m1.6.6.cmml" xref="alg2.l2.m1.6.6"><and id="alg2.l2.m1.6.6a.cmml" xref="alg2.l2.m1.6.6"></and><apply id="alg2.l2.m1.6.6b.cmml" xref="alg2.l2.m1.6.6"><gt id="alg2.l2.m1.6.6.7.cmml" xref="alg2.l2.m1.6.6.7"></gt><apply id="alg2.l2.m1.2.2.1.cmml" xref="alg2.l2.m1.2.2.1"><times id="alg2.l2.m1.2.2.1.2.cmml" xref="alg2.l2.m1.2.2.1.2"></times><ci id="alg2.l2.m1.2.2.1.3a.cmml" xref="alg2.l2.m1.2.2.1.3"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.2.2.1.3.cmml" mathsize="80%" xref="alg2.l2.m1.2.2.1.3">Q</mtext></ci><apply id="alg2.l2.m1.2.2.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1">subscript</csymbol><apply id="alg2.l2.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.1.1.1.1.2.1.cmml" xref="alg2.l2.m1.2.2.1.1.1">superscript</csymbol><ci id="alg2.l2.m1.2.2.1.1.1.1.2.2.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.2.2">𝑦</ci><ci id="alg2.l2.m1.2.2.1.1.1.1.2.3.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l2.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.3">𝑐</ci></apply></apply><apply id="alg2.l2.m1.6.6.5.cmml" xref="alg2.l2.m1.6.6.5"><times id="alg2.l2.m1.6.6.5.5.cmml" xref="alg2.l2.m1.6.6.5.5"></times><apply id="alg2.l2.m1.4.4.3.2.3.cmml" xref="alg2.l2.m1.4.4.3.2.2"><max id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"></max><apply id="alg2.l2.m1.3.3.2.1.1.1.1.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1"><times id="alg2.l2.m1.3.3.2.1.1.1.1.2.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.2"></times><ci id="alg2.l2.m1.3.3.2.1.1.1.1.3a.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.3"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.3.3.2.1.1.1.1.3.cmml" mathsize="80%" xref="alg2.l2.m1.3.3.2.1.1.1.1.3">Q</mtext></ci><apply id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.3.3.2.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="alg2.l2.m1.4.4.3.2.2.2.2.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2"><times id="alg2.l2.m1.4.4.3.2.2.2.2.2.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.2"></times><ci id="alg2.l2.m1.4.4.3.2.2.2.2.3a.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.3"><mtext class="ltx_font_smallcaps" id="alg2.l2.m1.4.4.3.2.2.2.2.3.cmml" mathsize="80%" xref="alg2.l2.m1.4.4.3.2.2.2.2.3">Q</mtext></ci><apply id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.1.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.2.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.2">𝑦</ci><ci id="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.3.cmml" xref="alg2.l2.m1.4.4.3.2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></apply><ci id="alg2.l2.m1.6.6.5.6a.cmml" xref="alg2.l2.m1.6.6.5.6"><mtext id="alg2.l2.m1.6.6.5.6.cmml" mathsize="80%" xref="alg2.l2.m1.6.6.5.6"> and </mtext></ci><apply id="alg2.l2.m1.6.6.5.7.cmml" xref="alg2.l2.m1.6.6.5.7"><csymbol cd="ambiguous" id="alg2.l2.m1.6.6.5.7.1.cmml" xref="alg2.l2.m1.6.6.5.7">subscript</csymbol><ci id="alg2.l2.m1.6.6.5.7.2.cmml" xref="alg2.l2.m1.6.6.5.7.2">ℒ</ci><cn id="alg2.l2.m1.6.6.5.7.3.cmml" type="integer" xref="alg2.l2.m1.6.6.5.7.3">1</cn></apply><interval closure="open" id="alg2.l2.m1.6.6.5.4.3.cmml" xref="alg2.l2.m1.6.6.5.4.2"><apply id="alg2.l2.m1.5.5.4.3.1.1.cmml" xref="alg2.l2.m1.5.5.4.3.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.5.5.4.3.1.1.1.cmml" xref="alg2.l2.m1.5.5.4.3.1.1">subscript</csymbol><apply id="alg2.l2.m1.5.5.4.3.1.1.2.cmml" xref="alg2.l2.m1.5.5.4.3.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.5.5.4.3.1.1.2.1.cmml" xref="alg2.l2.m1.5.5.4.3.1.1">superscript</csymbol><ci id="alg2.l2.m1.5.5.4.3.1.1.2.2.cmml" xref="alg2.l2.m1.5.5.4.3.1.1.2.2">𝑦</ci><ci id="alg2.l2.m1.5.5.4.3.1.1.2.3.cmml" xref="alg2.l2.m1.5.5.4.3.1.1.2.3">𝑡</ci></apply><ci id="alg2.l2.m1.5.5.4.3.1.1.3.cmml" xref="alg2.l2.m1.5.5.4.3.1.1.3">𝑐</ci></apply><apply id="alg2.l2.m1.6.6.5.4.2.2.cmml" xref="alg2.l2.m1.6.6.5.4.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.6.6.5.4.2.2.1.cmml" xref="alg2.l2.m1.6.6.5.4.2.2">subscript</csymbol><apply id="alg2.l2.m1.6.6.5.4.2.2.2.cmml" xref="alg2.l2.m1.6.6.5.4.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.6.6.5.4.2.2.2.1.cmml" xref="alg2.l2.m1.6.6.5.4.2.2">superscript</csymbol><ci id="alg2.l2.m1.6.6.5.4.2.2.2.2.cmml" xref="alg2.l2.m1.6.6.5.4.2.2.2.2">𝑦</ci><ci id="alg2.l2.m1.6.6.5.4.2.2.2.3.cmml" xref="alg2.l2.m1.6.6.5.4.2.2.2.3">𝑠</ci></apply><ci id="alg2.l2.m1.6.6.5.4.2.2.3.cmml" xref="alg2.l2.m1.6.6.5.4.2.2.3">𝑐</ci></apply></interval></apply></apply><apply id="alg2.l2.m1.6.6c.cmml" xref="alg2.l2.m1.6.6"><lt id="alg2.l2.m1.6.6.8.cmml" xref="alg2.l2.m1.6.6.8"></lt><share href="https://arxiv.org/html/2409.19679v1#alg2.l2.m1.6.6.5.cmml" id="alg2.l2.m1.6.6d.cmml" xref="alg2.l2.m1.6.6"></share><ci id="alg2.l2.m1.6.6.9.cmml" xref="alg2.l2.m1.6.6.9">𝜑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.6c">\textsc{Q}({y}^{t}_{c})&gt;\max(\textsc{Q}({y}^{s}_{c}),\textsc{Q}(y_{c}))\text{ %
and }\mathcal{L}_{1}({y}^{t}_{c},{y}^{s}_{c})&lt;\varphi</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.6d">Q ( italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) &gt; roman_max ( Q ( italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) , Q ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ) and caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) &lt; italic_φ</annotation></semantics></math><span class="ltx_text" id="alg2.l2.4" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l2.5" style="font-size:80%;">then</span><span class="ltx_text" id="alg2.l2.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text" id="alg2.l3.2" style="font-size:80%;">    </span><math alttext="{y}^{r}_{c}={y}^{t}_{c}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msubsup id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2.2" mathsize="80%" xref="alg2.l3.m1.1.1.2.2.2.cmml">y</mi><mi id="alg2.l3.m1.1.1.2.3" mathsize="80%" xref="alg2.l3.m1.1.1.2.3.cmml">c</mi><mi id="alg2.l3.m1.1.1.2.2.3" mathsize="80%" xref="alg2.l3.m1.1.1.2.2.3.cmml">r</mi></msubsup><mo id="alg2.l3.m1.1.1.1" mathsize="80%" xref="alg2.l3.m1.1.1.1.cmml">=</mo><msubsup id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2.2" mathsize="80%" xref="alg2.l3.m1.1.1.3.2.2.cmml">y</mi><mi id="alg2.l3.m1.1.1.3.3" mathsize="80%" xref="alg2.l3.m1.1.1.3.3.cmml">c</mi><mi id="alg2.l3.m1.1.1.3.2.3" mathsize="80%" xref="alg2.l3.m1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">subscript</csymbol><apply id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.2.1.cmml" xref="alg2.l3.m1.1.1.2">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.2.cmml" xref="alg2.l3.m1.1.1.2.2.2">𝑦</ci><ci id="alg2.l3.m1.1.1.2.2.3.cmml" xref="alg2.l3.m1.1.1.2.2.3">𝑟</ci></apply><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑐</ci></apply><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><apply id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.2.1.cmml" xref="alg2.l3.m1.1.1.3">superscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2">𝑦</ci><ci id="alg2.l3.m1.1.1.3.2.3.cmml" xref="alg2.l3.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">{y}^{r}_{c}={y}^{t}_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l3.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l4.2" style="font-size:80%;">else</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg2.l5.2" style="font-size:80%;">    </span><math alttext="{y}^{r}_{c}=y_{c}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msubsup id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.2.2.2" mathsize="80%" xref="alg2.l5.m1.1.1.2.2.2.cmml">y</mi><mi id="alg2.l5.m1.1.1.2.3" mathsize="80%" xref="alg2.l5.m1.1.1.2.3.cmml">c</mi><mi id="alg2.l5.m1.1.1.2.2.3" mathsize="80%" xref="alg2.l5.m1.1.1.2.2.3.cmml">r</mi></msubsup><mo id="alg2.l5.m1.1.1.1" mathsize="80%" xref="alg2.l5.m1.1.1.1.cmml">=</mo><msub id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.3.2" mathsize="80%" xref="alg2.l5.m1.1.1.3.2.cmml">y</mi><mi id="alg2.l5.m1.1.1.3.3" mathsize="80%" xref="alg2.l5.m1.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></eq><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><apply id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.2.1.cmml" xref="alg2.l5.m1.1.1.2">superscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.2.cmml" xref="alg2.l5.m1.1.1.2.2.2">𝑦</ci><ci id="alg2.l5.m1.1.1.2.2.3.cmml" xref="alg2.l5.m1.1.1.2.2.3">𝑟</ci></apply><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝑐</ci></apply><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2">𝑦</ci><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">{y}^{r}_{c}=y_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l5.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l6.2" style="font-size:80%;">end</span><span class="ltx_text" id="alg2.l6.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l6.4" style="font-size:80%;">if</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Target Design for Enhancing Pseudo-label Accuracy</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Since the teacher network’s outputs do not always surpass those of the student network, using its current outputs as pseudo-labels can potentially mislead the training of the student network on unlabeled data. To address this issue, the targeted design has been made to improve the accuracy of the pseudo-labels used to guide the student network’s training.
Specifically, we utilize the “optimal” outputs obtained from the teacher network during the training process as the pseudo-labels to guide the student network training with unlabeled images, rather than relying on the current outputs. All of these “optimal” outputs are stored in the pseudo-label dynamic warehouse.
Regarding the construction of this dynamic warehouse, we first employ the model, trained exclusively on labeled data, to establish the initial “optimal” output for each piece of unlabeled data. Next, in each training iteration, we compare the current output of the teacher network with both the output of the student network and the corresponding “optimal” one in the pseudo-label dynamic warehouse. If the teacher’s current output is of the best quality, we will immediately use it to update the “optimal” pseudo-label stored in the dynamic warehouse. This process ensures that the outputs stored in the pseudo-label dynamic warehouse consistently represent the optimal results produced by the teacher network throughout training.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.5">As to evaluating whether the teacher network’s current output is of the best quality, we employ two criteria. 1) An NR-IQA metric, MUSIQ <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib37" title="">37</a>]</cite>, is introduced to evaluate the visual quality. The quality of the teacher network’s current output is proportional to the score of MUSIQ, i.e., the better the quality, the higher the score. As shown in line 2 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg2" title="Algorithm 2 ‣ 3.2 Customization of a Wavelet Diffusion Model ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">2</span></a>, <math alttext="\textsc{Q}({x})" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mtext class="ltx_font_smallcaps" id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2a.cmml">Q</mtext><mo id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mo id="S3.SS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><times id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></times><ci id="S3.SS3.p2.1.m1.1.2.2a.cmml" xref="S3.SS3.p2.1.m1.1.2.2"><mtext class="ltx_font_smallcaps" id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2">Q</mtext></ci><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\textsc{Q}({x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">Q ( italic_x )</annotation></semantics></math> represents the MUSIQ score of input <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_x</annotation></semantics></math>. 2) A consistency constraint is incorporated to evaluate the quality of teacher’s outputs. As shown in line 2 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg2" title="Algorithm 2 ‣ 3.2 Customization of a Wavelet Diffusion Model ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">2</span></a>, the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">ℒ</mi><mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ℒ</ci><cn id="S3.SS3.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance between the outputs of the teacher and the student networks is required to be less than a predefined threshold <math alttext="\varphi" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_φ</annotation></semantics></math>. Based on extensive testing, <math alttext="\varphi" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_φ</annotation></semantics></math> is optimally set to 0.1 in our scheme. Note that the predictions of the teacher network were considered to be of the best quality only if they comply with these two criteria.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.3.1.1">Algorithm 3</span> </span> The training process of <span class="ltx_text ltx_font_bold" id="alg3.4.2">SemiDDM-Weather</span></figcaption>
<div class="ltx_listing ltx_listing" id="alg3.5">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l1.1.1.1" style="font-size:80%;">1:</span></span>
</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text" id="alg3.l2.2" style="font-size:80%;">degraded image </span><math alttext="x" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mi id="alg3.l2.m1.1.1" mathsize="80%" xref="alg3.l2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><ci id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg3.l2.3" style="font-size:80%;">, label </span><math alttext="y" class="ltx_Math" display="inline" id="alg3.l2.m2.1"><semantics id="alg3.l2.m2.1a"><mi id="alg3.l2.m2.1.1" mathsize="80%" xref="alg3.l2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m2.1b"><ci id="alg3.l2.m2.1.1.cmml" xref="alg3.l2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m2.1d">italic_y</annotation></semantics></math><span class="ltx_text" id="alg3.l2.4" style="font-size:80%;"> (labeled data: GT </span><math alttext="\to" class="ltx_Math" display="inline" id="alg3.l2.m3.1"><semantics id="alg3.l2.m3.1a"><mo id="alg3.l2.m3.1.1" mathsize="80%" stretchy="false" xref="alg3.l2.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg3.l2.m3.1b"><ci id="alg3.l2.m3.1.1.cmml" xref="alg3.l2.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m3.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m3.1d">→</annotation></semantics></math><span class="ltx_text" id="alg3.l2.5" style="font-size:80%;"> </span><math alttext="y" class="ltx_Math" display="inline" id="alg3.l2.m4.1"><semantics id="alg3.l2.m4.1a"><mi id="alg3.l2.m4.1.1" mathsize="80%" xref="alg3.l2.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m4.1b"><ci id="alg3.l2.m4.1.1.cmml" xref="alg3.l2.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m4.1d">italic_y</annotation></semantics></math><span class="ltx_text" id="alg3.l2.6" style="font-size:80%;">; unlabeled data: “optimal” pseudo-label </span><math alttext="\to" class="ltx_Math" display="inline" id="alg3.l2.m5.1"><semantics id="alg3.l2.m5.1a"><mo id="alg3.l2.m5.1.1" mathsize="80%" stretchy="false" xref="alg3.l2.m5.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg3.l2.m5.1b"><ci id="alg3.l2.m5.1.1.cmml" xref="alg3.l2.m5.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m5.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m5.1d">→</annotation></semantics></math><span class="ltx_text" id="alg3.l2.7" style="font-size:80%;"> </span><math alttext="y" class="ltx_Math" display="inline" id="alg3.l2.m6.1"><semantics id="alg3.l2.m6.1a"><mi id="alg3.l2.m6.1.1" mathsize="80%" xref="alg3.l2.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m6.1b"><ci id="alg3.l2.m6.1.1.cmml" xref="alg3.l2.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m6.1d">italic_y</annotation></semantics></math><span class="ltx_text" id="alg3.l2.8" style="font-size:80%;">)
</span>
</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l3.2" style="font-size:80%;">repeat</span>
</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text" id="alg3.l4.2" style="font-size:80%;">    </span><math alttext="x_{c}={\text{Crop}}_{64}({x}),x_{0}=\text{DWT}(x_{c})" class="ltx_Math" display="inline" id="alg3.l4.m1.3"><semantics id="alg3.l4.m1.3a"><mrow id="alg3.l4.m1.3.3.2" xref="alg3.l4.m1.3.3.3.cmml"><mrow id="alg3.l4.m1.2.2.1.1" xref="alg3.l4.m1.2.2.1.1.cmml"><msub id="alg3.l4.m1.2.2.1.1.2" xref="alg3.l4.m1.2.2.1.1.2.cmml"><mi id="alg3.l4.m1.2.2.1.1.2.2" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.2.2.cmml">x</mi><mi id="alg3.l4.m1.2.2.1.1.2.3" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.2.3.cmml">c</mi></msub><mo id="alg3.l4.m1.2.2.1.1.1" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.1.cmml">=</mo><mrow id="alg3.l4.m1.2.2.1.1.3" xref="alg3.l4.m1.2.2.1.1.3.cmml"><msub id="alg3.l4.m1.2.2.1.1.3.2" xref="alg3.l4.m1.2.2.1.1.3.2.cmml"><mtext id="alg3.l4.m1.2.2.1.1.3.2.2" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.3.2.2a.cmml">Crop</mtext><mn id="alg3.l4.m1.2.2.1.1.3.2.3" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.3.2.3.cmml">64</mn></msub><mo id="alg3.l4.m1.2.2.1.1.3.1" xref="alg3.l4.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="alg3.l4.m1.2.2.1.1.3.3.2" xref="alg3.l4.m1.2.2.1.1.3.cmml"><mo id="alg3.l4.m1.2.2.1.1.3.3.2.1" maxsize="80%" minsize="80%" xref="alg3.l4.m1.2.2.1.1.3.cmml">(</mo><mi id="alg3.l4.m1.1.1" mathsize="80%" xref="alg3.l4.m1.1.1.cmml">x</mi><mo id="alg3.l4.m1.2.2.1.1.3.3.2.2" maxsize="80%" minsize="80%" xref="alg3.l4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l4.m1.3.3.2.3" mathsize="80%" xref="alg3.l4.m1.3.3.3a.cmml">,</mo><mrow id="alg3.l4.m1.3.3.2.2" xref="alg3.l4.m1.3.3.2.2.cmml"><msub id="alg3.l4.m1.3.3.2.2.3" xref="alg3.l4.m1.3.3.2.2.3.cmml"><mi id="alg3.l4.m1.3.3.2.2.3.2" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.3.2.cmml">x</mi><mn id="alg3.l4.m1.3.3.2.2.3.3" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.3.3.cmml">0</mn></msub><mo id="alg3.l4.m1.3.3.2.2.2" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.2.cmml">=</mo><mrow id="alg3.l4.m1.3.3.2.2.1" xref="alg3.l4.m1.3.3.2.2.1.cmml"><mtext id="alg3.l4.m1.3.3.2.2.1.3" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.1.3a.cmml">DWT</mtext><mo id="alg3.l4.m1.3.3.2.2.1.2" xref="alg3.l4.m1.3.3.2.2.1.2.cmml">⁢</mo><mrow id="alg3.l4.m1.3.3.2.2.1.1.1" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.cmml"><mo id="alg3.l4.m1.3.3.2.2.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.cmml">(</mo><msub id="alg3.l4.m1.3.3.2.2.1.1.1.1" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.cmml"><mi id="alg3.l4.m1.3.3.2.2.1.1.1.1.2" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.2.cmml">x</mi><mi id="alg3.l4.m1.3.3.2.2.1.1.1.1.3" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="alg3.l4.m1.3.3.2.2.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.3b"><apply id="alg3.l4.m1.3.3.3.cmml" xref="alg3.l4.m1.3.3.2"><csymbol cd="ambiguous" id="alg3.l4.m1.3.3.3a.cmml" xref="alg3.l4.m1.3.3.2.3">formulae-sequence</csymbol><apply id="alg3.l4.m1.2.2.1.1.cmml" xref="alg3.l4.m1.2.2.1.1"><eq id="alg3.l4.m1.2.2.1.1.1.cmml" xref="alg3.l4.m1.2.2.1.1.1"></eq><apply id="alg3.l4.m1.2.2.1.1.2.cmml" xref="alg3.l4.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg3.l4.m1.2.2.1.1.2.1.cmml" xref="alg3.l4.m1.2.2.1.1.2">subscript</csymbol><ci id="alg3.l4.m1.2.2.1.1.2.2.cmml" xref="alg3.l4.m1.2.2.1.1.2.2">𝑥</ci><ci id="alg3.l4.m1.2.2.1.1.2.3.cmml" xref="alg3.l4.m1.2.2.1.1.2.3">𝑐</ci></apply><apply id="alg3.l4.m1.2.2.1.1.3.cmml" xref="alg3.l4.m1.2.2.1.1.3"><times id="alg3.l4.m1.2.2.1.1.3.1.cmml" xref="alg3.l4.m1.2.2.1.1.3.1"></times><apply id="alg3.l4.m1.2.2.1.1.3.2.cmml" xref="alg3.l4.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l4.m1.2.2.1.1.3.2.1.cmml" xref="alg3.l4.m1.2.2.1.1.3.2">subscript</csymbol><ci id="alg3.l4.m1.2.2.1.1.3.2.2a.cmml" xref="alg3.l4.m1.2.2.1.1.3.2.2"><mtext id="alg3.l4.m1.2.2.1.1.3.2.2.cmml" mathsize="80%" xref="alg3.l4.m1.2.2.1.1.3.2.2">Crop</mtext></ci><cn id="alg3.l4.m1.2.2.1.1.3.2.3.cmml" type="integer" xref="alg3.l4.m1.2.2.1.1.3.2.3">64</cn></apply><ci id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">𝑥</ci></apply></apply><apply id="alg3.l4.m1.3.3.2.2.cmml" xref="alg3.l4.m1.3.3.2.2"><eq id="alg3.l4.m1.3.3.2.2.2.cmml" xref="alg3.l4.m1.3.3.2.2.2"></eq><apply id="alg3.l4.m1.3.3.2.2.3.cmml" xref="alg3.l4.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l4.m1.3.3.2.2.3.1.cmml" xref="alg3.l4.m1.3.3.2.2.3">subscript</csymbol><ci id="alg3.l4.m1.3.3.2.2.3.2.cmml" xref="alg3.l4.m1.3.3.2.2.3.2">𝑥</ci><cn id="alg3.l4.m1.3.3.2.2.3.3.cmml" type="integer" xref="alg3.l4.m1.3.3.2.2.3.3">0</cn></apply><apply id="alg3.l4.m1.3.3.2.2.1.cmml" xref="alg3.l4.m1.3.3.2.2.1"><times id="alg3.l4.m1.3.3.2.2.1.2.cmml" xref="alg3.l4.m1.3.3.2.2.1.2"></times><ci id="alg3.l4.m1.3.3.2.2.1.3a.cmml" xref="alg3.l4.m1.3.3.2.2.1.3"><mtext id="alg3.l4.m1.3.3.2.2.1.3.cmml" mathsize="80%" xref="alg3.l4.m1.3.3.2.2.1.3">DWT</mtext></ci><apply id="alg3.l4.m1.3.3.2.2.1.1.1.1.cmml" xref="alg3.l4.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l4.m1.3.3.2.2.1.1.1.1.1.cmml" xref="alg3.l4.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="alg3.l4.m1.3.3.2.2.1.1.1.1.2.cmml" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.2">𝑥</ci><ci id="alg3.l4.m1.3.3.2.2.1.1.1.1.3.cmml" xref="alg3.l4.m1.3.3.2.2.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.3c">x_{c}={\text{Crop}}_{64}({x}),x_{0}=\text{DWT}(x_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.3d">italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Crop start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT ( italic_x ) , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = DWT ( italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l4.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg3.l5.2" style="font-size:80%;">    </span><math alttext="y_{c}={\text{Crop}}_{64}({y}),y_{0}=\text{DWT}(y_{c})" class="ltx_Math" display="inline" id="alg3.l5.m1.3"><semantics id="alg3.l5.m1.3a"><mrow id="alg3.l5.m1.3.3.2" xref="alg3.l5.m1.3.3.3.cmml"><mrow id="alg3.l5.m1.2.2.1.1" xref="alg3.l5.m1.2.2.1.1.cmml"><msub id="alg3.l5.m1.2.2.1.1.2" xref="alg3.l5.m1.2.2.1.1.2.cmml"><mi id="alg3.l5.m1.2.2.1.1.2.2" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.2.2.cmml">y</mi><mi id="alg3.l5.m1.2.2.1.1.2.3" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.2.3.cmml">c</mi></msub><mo id="alg3.l5.m1.2.2.1.1.1" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.1.cmml">=</mo><mrow id="alg3.l5.m1.2.2.1.1.3" xref="alg3.l5.m1.2.2.1.1.3.cmml"><msub id="alg3.l5.m1.2.2.1.1.3.2" xref="alg3.l5.m1.2.2.1.1.3.2.cmml"><mtext id="alg3.l5.m1.2.2.1.1.3.2.2" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.3.2.2a.cmml">Crop</mtext><mn id="alg3.l5.m1.2.2.1.1.3.2.3" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.3.2.3.cmml">64</mn></msub><mo id="alg3.l5.m1.2.2.1.1.3.1" xref="alg3.l5.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="alg3.l5.m1.2.2.1.1.3.3.2" xref="alg3.l5.m1.2.2.1.1.3.cmml"><mo id="alg3.l5.m1.2.2.1.1.3.3.2.1" maxsize="80%" minsize="80%" xref="alg3.l5.m1.2.2.1.1.3.cmml">(</mo><mi id="alg3.l5.m1.1.1" mathsize="80%" xref="alg3.l5.m1.1.1.cmml">y</mi><mo id="alg3.l5.m1.2.2.1.1.3.3.2.2" maxsize="80%" minsize="80%" xref="alg3.l5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l5.m1.3.3.2.3" mathsize="80%" xref="alg3.l5.m1.3.3.3a.cmml">,</mo><mrow id="alg3.l5.m1.3.3.2.2" xref="alg3.l5.m1.3.3.2.2.cmml"><msub id="alg3.l5.m1.3.3.2.2.3" xref="alg3.l5.m1.3.3.2.2.3.cmml"><mi id="alg3.l5.m1.3.3.2.2.3.2" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.3.2.cmml">y</mi><mn id="alg3.l5.m1.3.3.2.2.3.3" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.3.3.cmml">0</mn></msub><mo id="alg3.l5.m1.3.3.2.2.2" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.2.cmml">=</mo><mrow id="alg3.l5.m1.3.3.2.2.1" xref="alg3.l5.m1.3.3.2.2.1.cmml"><mtext id="alg3.l5.m1.3.3.2.2.1.3" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.1.3a.cmml">DWT</mtext><mo id="alg3.l5.m1.3.3.2.2.1.2" xref="alg3.l5.m1.3.3.2.2.1.2.cmml">⁢</mo><mrow id="alg3.l5.m1.3.3.2.2.1.1.1" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.cmml"><mo id="alg3.l5.m1.3.3.2.2.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.cmml">(</mo><msub id="alg3.l5.m1.3.3.2.2.1.1.1.1" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.cmml"><mi id="alg3.l5.m1.3.3.2.2.1.1.1.1.2" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.2.cmml">y</mi><mi id="alg3.l5.m1.3.3.2.2.1.1.1.1.3" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="alg3.l5.m1.3.3.2.2.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.3b"><apply id="alg3.l5.m1.3.3.3.cmml" xref="alg3.l5.m1.3.3.2"><csymbol cd="ambiguous" id="alg3.l5.m1.3.3.3a.cmml" xref="alg3.l5.m1.3.3.2.3">formulae-sequence</csymbol><apply id="alg3.l5.m1.2.2.1.1.cmml" xref="alg3.l5.m1.2.2.1.1"><eq id="alg3.l5.m1.2.2.1.1.1.cmml" xref="alg3.l5.m1.2.2.1.1.1"></eq><apply id="alg3.l5.m1.2.2.1.1.2.cmml" xref="alg3.l5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.1.2.1.cmml" xref="alg3.l5.m1.2.2.1.1.2">subscript</csymbol><ci id="alg3.l5.m1.2.2.1.1.2.2.cmml" xref="alg3.l5.m1.2.2.1.1.2.2">𝑦</ci><ci id="alg3.l5.m1.2.2.1.1.2.3.cmml" xref="alg3.l5.m1.2.2.1.1.2.3">𝑐</ci></apply><apply id="alg3.l5.m1.2.2.1.1.3.cmml" xref="alg3.l5.m1.2.2.1.1.3"><times id="alg3.l5.m1.2.2.1.1.3.1.cmml" xref="alg3.l5.m1.2.2.1.1.3.1"></times><apply id="alg3.l5.m1.2.2.1.1.3.2.cmml" xref="alg3.l5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.1.3.2.1.cmml" xref="alg3.l5.m1.2.2.1.1.3.2">subscript</csymbol><ci id="alg3.l5.m1.2.2.1.1.3.2.2a.cmml" xref="alg3.l5.m1.2.2.1.1.3.2.2"><mtext id="alg3.l5.m1.2.2.1.1.3.2.2.cmml" mathsize="80%" xref="alg3.l5.m1.2.2.1.1.3.2.2">Crop</mtext></ci><cn id="alg3.l5.m1.2.2.1.1.3.2.3.cmml" type="integer" xref="alg3.l5.m1.2.2.1.1.3.2.3">64</cn></apply><ci id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1">𝑦</ci></apply></apply><apply id="alg3.l5.m1.3.3.2.2.cmml" xref="alg3.l5.m1.3.3.2.2"><eq id="alg3.l5.m1.3.3.2.2.2.cmml" xref="alg3.l5.m1.3.3.2.2.2"></eq><apply id="alg3.l5.m1.3.3.2.2.3.cmml" xref="alg3.l5.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l5.m1.3.3.2.2.3.1.cmml" xref="alg3.l5.m1.3.3.2.2.3">subscript</csymbol><ci id="alg3.l5.m1.3.3.2.2.3.2.cmml" xref="alg3.l5.m1.3.3.2.2.3.2">𝑦</ci><cn id="alg3.l5.m1.3.3.2.2.3.3.cmml" type="integer" xref="alg3.l5.m1.3.3.2.2.3.3">0</cn></apply><apply id="alg3.l5.m1.3.3.2.2.1.cmml" xref="alg3.l5.m1.3.3.2.2.1"><times id="alg3.l5.m1.3.3.2.2.1.2.cmml" xref="alg3.l5.m1.3.3.2.2.1.2"></times><ci id="alg3.l5.m1.3.3.2.2.1.3a.cmml" xref="alg3.l5.m1.3.3.2.2.1.3"><mtext id="alg3.l5.m1.3.3.2.2.1.3.cmml" mathsize="80%" xref="alg3.l5.m1.3.3.2.2.1.3">DWT</mtext></ci><apply id="alg3.l5.m1.3.3.2.2.1.1.1.1.cmml" xref="alg3.l5.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l5.m1.3.3.2.2.1.1.1.1.1.cmml" xref="alg3.l5.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="alg3.l5.m1.3.3.2.2.1.1.1.1.2.cmml" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.2">𝑦</ci><ci id="alg3.l5.m1.3.3.2.2.1.1.1.1.3.cmml" xref="alg3.l5.m1.3.3.2.2.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.3c">y_{c}={\text{Crop}}_{64}({y}),y_{0}=\text{DWT}(y_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.3d">italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Crop start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT ( italic_y ) , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = DWT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l5.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text" id="alg3.l6.2" style="font-size:80%;">    </span><math alttext="y_{0}\sim q(y_{0}),t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,%
\mathbf{I})" class="ltx_Math" display="inline" id="alg3.l6.m1.7"><semantics id="alg3.l6.m1.7a"><mrow id="alg3.l6.m1.7.7.2" xref="alg3.l6.m1.7.7.3.cmml"><mrow id="alg3.l6.m1.6.6.1.1" xref="alg3.l6.m1.6.6.1.1.cmml"><msub id="alg3.l6.m1.6.6.1.1.3" xref="alg3.l6.m1.6.6.1.1.3.cmml"><mi id="alg3.l6.m1.6.6.1.1.3.2" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.3.2.cmml">y</mi><mn id="alg3.l6.m1.6.6.1.1.3.3" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l6.m1.6.6.1.1.2" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.2.cmml">∼</mo><mrow id="alg3.l6.m1.6.6.1.1.1" xref="alg3.l6.m1.6.6.1.1.1.cmml"><mi id="alg3.l6.m1.6.6.1.1.1.3" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.1.3.cmml">q</mi><mo id="alg3.l6.m1.6.6.1.1.1.2" xref="alg3.l6.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l6.m1.6.6.1.1.1.1.1" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml"><mo id="alg3.l6.m1.6.6.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l6.m1.6.6.1.1.1.1.1.1" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml"><mi id="alg3.l6.m1.6.6.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.2.cmml">y</mi><mn id="alg3.l6.m1.6.6.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg3.l6.m1.6.6.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l6.m1.7.7.2.3" mathsize="80%" xref="alg3.l6.m1.7.7.3a.cmml">,</mo><mrow id="alg3.l6.m1.7.7.2.2.2" xref="alg3.l6.m1.7.7.2.2.3.cmml"><mrow id="alg3.l6.m1.7.7.2.2.1.1" xref="alg3.l6.m1.7.7.2.2.1.1.cmml"><mi id="alg3.l6.m1.7.7.2.2.1.1.3" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.3.cmml">t</mi><mo id="alg3.l6.m1.7.7.2.2.1.1.2" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.2.cmml">∼</mo><mrow id="alg3.l6.m1.7.7.2.2.1.1.1" xref="alg3.l6.m1.7.7.2.2.1.1.1.cmml"><mi id="alg3.l6.m1.7.7.2.2.1.1.1.3" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.3.cmml">Uniform</mi><mo id="alg3.l6.m1.7.7.2.2.1.1.1.2" xref="alg3.l6.m1.7.7.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l6.m1.7.7.2.2.1.1.1.1.1" xref="alg3.l6.m1.7.7.2.2.1.1.1.cmml"><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.cmml">(</mo><mrow id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml"><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2.1" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">{</mo><mn id="alg3.l6.m1.1.1" mathsize="80%" xref="alg3.l6.m1.1.1.cmml">1</mn><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg3.l6.m1.2.2" mathsize="80%" mathvariant="normal" xref="alg3.l6.m1.2.2.cmml">…</mi><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg3.l6.m1.3.3" mathsize="80%" xref="alg3.l6.m1.3.3.cmml">T</mi><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2.4" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">}</mo></mrow><mo id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l6.m1.7.7.2.2.2.3" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.3a.cmml">,</mo><mrow id="alg3.l6.m1.7.7.2.2.2.2" xref="alg3.l6.m1.7.7.2.2.2.2.cmml"><mi id="alg3.l6.m1.7.7.2.2.2.2.2" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.2.cmml">z</mi><mo id="alg3.l6.m1.7.7.2.2.2.2.1" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.1.cmml">∼</mo><mrow id="alg3.l6.m1.7.7.2.2.2.2.3" xref="alg3.l6.m1.7.7.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l6.m1.7.7.2.2.2.2.3.2" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.3.2.cmml">𝒩</mi><mo id="alg3.l6.m1.7.7.2.2.2.2.3.1" xref="alg3.l6.m1.7.7.2.2.2.2.3.1.cmml">⁢</mo><mrow id="alg3.l6.m1.7.7.2.2.2.2.3.3.2" xref="alg3.l6.m1.7.7.2.2.2.2.3.3.1.cmml"><mo id="alg3.l6.m1.7.7.2.2.2.2.3.3.2.1" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.3.3.1.cmml">(</mo><mn id="alg3.l6.m1.4.4" mathsize="80%" xref="alg3.l6.m1.4.4.cmml">0</mn><mo id="alg3.l6.m1.7.7.2.2.2.2.3.3.2.2" mathsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.3.3.1.cmml">,</mo><mi id="alg3.l6.m1.5.5" mathsize="80%" xref="alg3.l6.m1.5.5.cmml">𝐈</mi><mo id="alg3.l6.m1.7.7.2.2.2.2.3.3.2.3" maxsize="80%" minsize="80%" xref="alg3.l6.m1.7.7.2.2.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.7b"><apply id="alg3.l6.m1.7.7.3.cmml" xref="alg3.l6.m1.7.7.2"><csymbol cd="ambiguous" id="alg3.l6.m1.7.7.3a.cmml" xref="alg3.l6.m1.7.7.2.3">formulae-sequence</csymbol><apply id="alg3.l6.m1.6.6.1.1.cmml" xref="alg3.l6.m1.6.6.1.1"><csymbol cd="latexml" id="alg3.l6.m1.6.6.1.1.2.cmml" xref="alg3.l6.m1.6.6.1.1.2">similar-to</csymbol><apply id="alg3.l6.m1.6.6.1.1.3.cmml" xref="alg3.l6.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="alg3.l6.m1.6.6.1.1.3.1.cmml" xref="alg3.l6.m1.6.6.1.1.3">subscript</csymbol><ci id="alg3.l6.m1.6.6.1.1.3.2.cmml" xref="alg3.l6.m1.6.6.1.1.3.2">𝑦</ci><cn id="alg3.l6.m1.6.6.1.1.3.3.cmml" type="integer" xref="alg3.l6.m1.6.6.1.1.3.3">0</cn></apply><apply id="alg3.l6.m1.6.6.1.1.1.cmml" xref="alg3.l6.m1.6.6.1.1.1"><times id="alg3.l6.m1.6.6.1.1.1.2.cmml" xref="alg3.l6.m1.6.6.1.1.1.2"></times><ci id="alg3.l6.m1.6.6.1.1.1.3.cmml" xref="alg3.l6.m1.6.6.1.1.1.3">𝑞</ci><apply id="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="alg3.l6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.2">𝑦</ci><cn id="alg3.l6.m1.6.6.1.1.1.1.1.1.3.cmml" type="integer" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="alg3.l6.m1.7.7.2.2.3.cmml" xref="alg3.l6.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="alg3.l6.m1.7.7.2.2.3a.cmml" xref="alg3.l6.m1.7.7.2.2.2.3">formulae-sequence</csymbol><apply id="alg3.l6.m1.7.7.2.2.1.1.cmml" xref="alg3.l6.m1.7.7.2.2.1.1"><csymbol cd="latexml" id="alg3.l6.m1.7.7.2.2.1.1.2.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.2">similar-to</csymbol><ci id="alg3.l6.m1.7.7.2.2.1.1.3.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.3">𝑡</ci><apply id="alg3.l6.m1.7.7.2.2.1.1.1.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.1"><times id="alg3.l6.m1.7.7.2.2.1.1.1.2.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.1.2"></times><ci id="alg3.l6.m1.7.7.2.2.1.1.1.3.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.1.3">Uniform</ci><set id="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.7.7.2.2.1.1.1.1.1.1.2"><cn id="alg3.l6.m1.1.1.cmml" type="integer" xref="alg3.l6.m1.1.1">1</cn><ci id="alg3.l6.m1.2.2.cmml" xref="alg3.l6.m1.2.2">…</ci><ci id="alg3.l6.m1.3.3.cmml" xref="alg3.l6.m1.3.3">𝑇</ci></set></apply></apply><apply id="alg3.l6.m1.7.7.2.2.2.2.cmml" xref="alg3.l6.m1.7.7.2.2.2.2"><csymbol cd="latexml" id="alg3.l6.m1.7.7.2.2.2.2.1.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.1">similar-to</csymbol><ci id="alg3.l6.m1.7.7.2.2.2.2.2.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.2">𝑧</ci><apply id="alg3.l6.m1.7.7.2.2.2.2.3.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.3"><times id="alg3.l6.m1.7.7.2.2.2.2.3.1.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.3.1"></times><ci id="alg3.l6.m1.7.7.2.2.2.2.3.2.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.3.2">𝒩</ci><interval closure="open" id="alg3.l6.m1.7.7.2.2.2.2.3.3.1.cmml" xref="alg3.l6.m1.7.7.2.2.2.2.3.3.2"><cn id="alg3.l6.m1.4.4.cmml" type="integer" xref="alg3.l6.m1.4.4">0</cn><ci id="alg3.l6.m1.5.5.cmml" xref="alg3.l6.m1.5.5">𝐈</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.7c">y_{0}\sim q(y_{0}),t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,%
\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m1.7d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_q ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , italic_t ∼ roman_Uniform ( { 1 , … , italic_T } ) , italic_z ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math><span class="ltx_text" id="alg3.l6.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l7.2.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg3.l7.3" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg3.l7.1" style="font-size:80%;">Forward process <math alttext="\to" class="ltx_Math" display="inline" id="alg3.l7.1.m1.1"><semantics id="alg3.l7.1.m1.1a"><mo id="alg3.l7.1.m1.1.1" stretchy="false" xref="alg3.l7.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg3.l7.1.m1.1b"><ci id="alg3.l7.1.m1.1.1.cmml" xref="alg3.l7.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.1.m1.1d">→</annotation></semantics></math> diffusion:</span><span class="ltx_text" id="alg3.l7.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg3.l8.2" style="font-size:80%;">    </span><math alttext="q(y_{t-1}\mid y_{0})=\mathcal{N}(y_{t-1};\sqrt{\bar{\alpha}_{t-1}}y_{0},1-\bar%
{\alpha}_{t-1})" class="ltx_Math" display="inline" id="alg3.l8.m1.4"><semantics id="alg3.l8.m1.4a"><mrow id="alg3.l8.m1.4.4" xref="alg3.l8.m1.4.4.cmml"><mrow id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml"><mi id="alg3.l8.m1.1.1.1.3" mathsize="80%" xref="alg3.l8.m1.1.1.1.3.cmml">q</mi><mo id="alg3.l8.m1.1.1.1.2" xref="alg3.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l8.m1.1.1.1.1.1" xref="alg3.l8.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l8.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l8.m1.1.1.1.1.1.1" xref="alg3.l8.m1.1.1.1.1.1.1.cmml"><msub id="alg3.l8.m1.1.1.1.1.1.1.2" xref="alg3.l8.m1.1.1.1.1.1.1.2.cmml"><mi id="alg3.l8.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l8.m1.1.1.1.1.1.1.2.3" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.cmml"><mi id="alg3.l8.m1.1.1.1.1.1.1.2.3.2" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l8.m1.1.1.1.1.1.1.2.3.1" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l8.m1.1.1.1.1.1.1.2.3.3" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l8.m1.1.1.1.1.1.1.1" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="alg3.l8.m1.1.1.1.1.1.1.3" xref="alg3.l8.m1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l8.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.3.2.cmml">y</mi><mn id="alg3.l8.m1.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="alg3.l8.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l8.m1.4.4.5" mathsize="80%" xref="alg3.l8.m1.4.4.5.cmml">=</mo><mrow id="alg3.l8.m1.4.4.4" xref="alg3.l8.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l8.m1.4.4.4.5" mathsize="80%" xref="alg3.l8.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg3.l8.m1.4.4.4.4" xref="alg3.l8.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg3.l8.m1.4.4.4.3.3" xref="alg3.l8.m1.4.4.4.3.4.cmml"><mo id="alg3.l8.m1.4.4.4.3.3.4" maxsize="80%" minsize="80%" xref="alg3.l8.m1.4.4.4.3.4.cmml">(</mo><msub id="alg3.l8.m1.2.2.2.1.1.1" xref="alg3.l8.m1.2.2.2.1.1.1.cmml"><mi id="alg3.l8.m1.2.2.2.1.1.1.2" mathsize="80%" xref="alg3.l8.m1.2.2.2.1.1.1.2.cmml">y</mi><mrow id="alg3.l8.m1.2.2.2.1.1.1.3" xref="alg3.l8.m1.2.2.2.1.1.1.3.cmml"><mi id="alg3.l8.m1.2.2.2.1.1.1.3.2" mathsize="80%" xref="alg3.l8.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="alg3.l8.m1.2.2.2.1.1.1.3.1" mathsize="80%" xref="alg3.l8.m1.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="alg3.l8.m1.2.2.2.1.1.1.3.3" mathsize="80%" xref="alg3.l8.m1.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l8.m1.4.4.4.3.3.5" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg3.l8.m1.3.3.3.2.2.2" xref="alg3.l8.m1.3.3.3.2.2.2.cmml"><msqrt id="alg3.l8.m1.3.3.3.2.2.2.2" xref="alg3.l8.m1.3.3.3.2.2.2.2.cmml"><msub id="alg3.l8.m1.3.3.3.2.2.2.2.2" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.cmml"><mover accent="true" id="alg3.l8.m1.3.3.3.2.2.2.2.2.2" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="alg3.l8.m1.3.3.3.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2.2.cmml">α</mi><mo id="alg3.l8.m1.3.3.3.2.2.2.2.2.2.1" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mrow id="alg3.l8.m1.3.3.3.2.2.2.2.2.3" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.2" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.1" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.1.cmml">−</mo><mn id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.3" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub></msqrt><mo id="alg3.l8.m1.3.3.3.2.2.2.1" xref="alg3.l8.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="alg3.l8.m1.3.3.3.2.2.2.3" xref="alg3.l8.m1.3.3.3.2.2.2.3.cmml"><mi id="alg3.l8.m1.3.3.3.2.2.2.3.2" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.3.2.cmml">y</mi><mn id="alg3.l8.m1.3.3.3.2.2.2.3.3" mathsize="80%" xref="alg3.l8.m1.3.3.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo id="alg3.l8.m1.4.4.4.3.3.6" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.4.cmml">,</mo><mrow id="alg3.l8.m1.4.4.4.3.3.3" xref="alg3.l8.m1.4.4.4.3.3.3.cmml"><mn id="alg3.l8.m1.4.4.4.3.3.3.2" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.2.cmml">1</mn><mo id="alg3.l8.m1.4.4.4.3.3.3.1" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.1.cmml">−</mo><msub id="alg3.l8.m1.4.4.4.3.3.3.3" xref="alg3.l8.m1.4.4.4.3.3.3.3.cmml"><mover accent="true" id="alg3.l8.m1.4.4.4.3.3.3.3.2" xref="alg3.l8.m1.4.4.4.3.3.3.3.2.cmml"><mi id="alg3.l8.m1.4.4.4.3.3.3.3.2.2" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.3.2.2.cmml">α</mi><mo id="alg3.l8.m1.4.4.4.3.3.3.3.2.1" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.3.2.1.cmml">¯</mo></mover><mrow id="alg3.l8.m1.4.4.4.3.3.3.3.3" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.cmml"><mi id="alg3.l8.m1.4.4.4.3.3.3.3.3.2" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.2.cmml">t</mi><mo id="alg3.l8.m1.4.4.4.3.3.3.3.3.1" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.1.cmml">−</mo><mn id="alg3.l8.m1.4.4.4.3.3.3.3.3.3" mathsize="80%" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg3.l8.m1.4.4.4.3.3.7" maxsize="80%" minsize="80%" xref="alg3.l8.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.4b"><apply id="alg3.l8.m1.4.4.cmml" xref="alg3.l8.m1.4.4"><eq id="alg3.l8.m1.4.4.5.cmml" xref="alg3.l8.m1.4.4.5"></eq><apply id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1"><times id="alg3.l8.m1.1.1.1.2.cmml" xref="alg3.l8.m1.1.1.1.2"></times><ci id="alg3.l8.m1.1.1.1.3.cmml" xref="alg3.l8.m1.1.1.1.3">𝑞</ci><apply id="alg3.l8.m1.1.1.1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg3.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.l8.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="alg3.l8.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2.3"><minus id="alg3.l8.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.1"></minus><ci id="alg3.l8.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l8.m1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l8.m1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg3.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.l8.m1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l8.m1.1.1.1.1.1.1.3.2">𝑦</ci><cn id="alg3.l8.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l8.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="alg3.l8.m1.4.4.4.cmml" xref="alg3.l8.m1.4.4.4"><times id="alg3.l8.m1.4.4.4.4.cmml" xref="alg3.l8.m1.4.4.4.4"></times><ci id="alg3.l8.m1.4.4.4.5.cmml" xref="alg3.l8.m1.4.4.4.5">𝒩</ci><list id="alg3.l8.m1.4.4.4.3.4.cmml" xref="alg3.l8.m1.4.4.4.3.3"><apply id="alg3.l8.m1.2.2.2.1.1.1.cmml" xref="alg3.l8.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l8.m1.2.2.2.1.1.1.1.cmml" xref="alg3.l8.m1.2.2.2.1.1.1">subscript</csymbol><ci id="alg3.l8.m1.2.2.2.1.1.1.2.cmml" xref="alg3.l8.m1.2.2.2.1.1.1.2">𝑦</ci><apply id="alg3.l8.m1.2.2.2.1.1.1.3.cmml" xref="alg3.l8.m1.2.2.2.1.1.1.3"><minus id="alg3.l8.m1.2.2.2.1.1.1.3.1.cmml" xref="alg3.l8.m1.2.2.2.1.1.1.3.1"></minus><ci id="alg3.l8.m1.2.2.2.1.1.1.3.2.cmml" xref="alg3.l8.m1.2.2.2.1.1.1.3.2">𝑡</ci><cn id="alg3.l8.m1.2.2.2.1.1.1.3.3.cmml" type="integer" xref="alg3.l8.m1.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l8.m1.3.3.3.2.2.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2"><times id="alg3.l8.m1.3.3.3.2.2.2.1.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.1"></times><apply id="alg3.l8.m1.3.3.3.2.2.2.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2"><root id="alg3.l8.m1.3.3.3.2.2.2.2a.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2"></root><apply id="alg3.l8.m1.3.3.3.2.2.2.2.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l8.m1.3.3.3.2.2.2.2.2.1.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2">subscript</csymbol><apply id="alg3.l8.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2"><ci id="alg3.l8.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2.1">¯</ci><ci id="alg3.l8.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.2.2">𝛼</ci></apply><apply id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3"><minus id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.1"></minus><ci id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.2">𝑡</ci><cn id="alg3.l8.m1.3.3.3.2.2.2.2.2.3.3.cmml" type="integer" xref="alg3.l8.m1.3.3.3.2.2.2.2.2.3.3">1</cn></apply></apply></apply><apply id="alg3.l8.m1.3.3.3.2.2.2.3.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l8.m1.3.3.3.2.2.2.3.1.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="alg3.l8.m1.3.3.3.2.2.2.3.2.cmml" xref="alg3.l8.m1.3.3.3.2.2.2.3.2">𝑦</ci><cn id="alg3.l8.m1.3.3.3.2.2.2.3.3.cmml" type="integer" xref="alg3.l8.m1.3.3.3.2.2.2.3.3">0</cn></apply></apply><apply id="alg3.l8.m1.4.4.4.3.3.3.cmml" xref="alg3.l8.m1.4.4.4.3.3.3"><minus id="alg3.l8.m1.4.4.4.3.3.3.1.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.1"></minus><cn id="alg3.l8.m1.4.4.4.3.3.3.2.cmml" type="integer" xref="alg3.l8.m1.4.4.4.3.3.3.2">1</cn><apply id="alg3.l8.m1.4.4.4.3.3.3.3.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg3.l8.m1.4.4.4.3.3.3.3.1.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3">subscript</csymbol><apply id="alg3.l8.m1.4.4.4.3.3.3.3.2.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.2"><ci id="alg3.l8.m1.4.4.4.3.3.3.3.2.1.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.2.1">¯</ci><ci id="alg3.l8.m1.4.4.4.3.3.3.3.2.2.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.2.2">𝛼</ci></apply><apply id="alg3.l8.m1.4.4.4.3.3.3.3.3.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.3"><minus id="alg3.l8.m1.4.4.4.3.3.3.3.3.1.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.1"></minus><ci id="alg3.l8.m1.4.4.4.3.3.3.3.3.2.cmml" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.2">𝑡</ci><cn id="alg3.l8.m1.4.4.4.3.3.3.3.3.3.cmml" type="integer" xref="alg3.l8.m1.4.4.4.3.3.3.3.3.3">1</cn></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.4c">q(y_{t-1}\mid y_{0})=\mathcal{N}(y_{t-1};\sqrt{\bar{\alpha}_{t-1}}y_{0},1-\bar%
{\alpha}_{t-1})</annotation><annotation encoding="application/x-llamapun" id="alg3.l8.m1.4d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l8.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg3.l9.2" style="font-size:80%;">    </span><math alttext="q(y_{t}\mid y_{t-1})=\mathcal{N}\left(y_{t};\sqrt{\alpha_{t}}y_{t-1},1-\alpha_%
{t}\right)" class="ltx_Math" display="inline" id="alg3.l9.m1.4"><semantics id="alg3.l9.m1.4a"><mrow id="alg3.l9.m1.4.4" xref="alg3.l9.m1.4.4.cmml"><mrow id="alg3.l9.m1.1.1.1" xref="alg3.l9.m1.1.1.1.cmml"><mi id="alg3.l9.m1.1.1.1.3" mathsize="80%" xref="alg3.l9.m1.1.1.1.3.cmml">q</mi><mo id="alg3.l9.m1.1.1.1.2" xref="alg3.l9.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l9.m1.1.1.1.1.1" xref="alg3.l9.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l9.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l9.m1.1.1.1.1.1.1" xref="alg3.l9.m1.1.1.1.1.1.1.cmml"><msub id="alg3.l9.m1.1.1.1.1.1.1.2" xref="alg3.l9.m1.1.1.1.1.1.1.2.cmml"><mi id="alg3.l9.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="alg3.l9.m1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="alg3.l9.m1.1.1.1.1.1.1.1" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="alg3.l9.m1.1.1.1.1.1.1.3" xref="alg3.l9.m1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l9.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.3.2.cmml">y</mi><mrow id="alg3.l9.m1.1.1.1.1.1.1.3.3" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg3.l9.m1.1.1.1.1.1.1.3.3.2" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg3.l9.m1.1.1.1.1.1.1.3.3.1" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg3.l9.m1.1.1.1.1.1.1.3.3.3" mathsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg3.l9.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l9.m1.4.4.5" mathsize="80%" xref="alg3.l9.m1.4.4.5.cmml">=</mo><mrow id="alg3.l9.m1.4.4.4" xref="alg3.l9.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l9.m1.4.4.4.5" mathsize="80%" xref="alg3.l9.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg3.l9.m1.4.4.4.4" xref="alg3.l9.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg3.l9.m1.4.4.4.3.3" xref="alg3.l9.m1.4.4.4.3.4.cmml"><mo id="alg3.l9.m1.4.4.4.3.3.4" xref="alg3.l9.m1.4.4.4.3.4.cmml">(</mo><msub id="alg3.l9.m1.2.2.2.1.1.1" xref="alg3.l9.m1.2.2.2.1.1.1.cmml"><mi id="alg3.l9.m1.2.2.2.1.1.1.2" mathsize="80%" xref="alg3.l9.m1.2.2.2.1.1.1.2.cmml">y</mi><mi id="alg3.l9.m1.2.2.2.1.1.1.3" mathsize="80%" xref="alg3.l9.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l9.m1.4.4.4.3.3.5" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg3.l9.m1.3.3.3.2.2.2" xref="alg3.l9.m1.3.3.3.2.2.2.cmml"><msqrt id="alg3.l9.m1.3.3.3.2.2.2.2" xref="alg3.l9.m1.3.3.3.2.2.2.2.cmml"><msub id="alg3.l9.m1.3.3.3.2.2.2.2.2" xref="alg3.l9.m1.3.3.3.2.2.2.2.2.cmml"><mi id="alg3.l9.m1.3.3.3.2.2.2.2.2.2" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.2.2.2.cmml">α</mi><mi id="alg3.l9.m1.3.3.3.2.2.2.2.2.3" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="alg3.l9.m1.3.3.3.2.2.2.1" xref="alg3.l9.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="alg3.l9.m1.3.3.3.2.2.2.3" xref="alg3.l9.m1.3.3.3.2.2.2.3.cmml"><mi id="alg3.l9.m1.3.3.3.2.2.2.3.2" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.3.2.cmml">y</mi><mrow id="alg3.l9.m1.3.3.3.2.2.2.3.3" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.cmml"><mi id="alg3.l9.m1.3.3.3.2.2.2.3.3.2" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.2.cmml">t</mi><mo id="alg3.l9.m1.3.3.3.2.2.2.3.3.1" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.1.cmml">−</mo><mn id="alg3.l9.m1.3.3.3.2.2.2.3.3.3" mathsize="80%" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg3.l9.m1.4.4.4.3.3.6" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.4.cmml">,</mo><mrow id="alg3.l9.m1.4.4.4.3.3.3" xref="alg3.l9.m1.4.4.4.3.3.3.cmml"><mn id="alg3.l9.m1.4.4.4.3.3.3.2" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.3.3.2.cmml">1</mn><mo id="alg3.l9.m1.4.4.4.3.3.3.1" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.3.3.1.cmml">−</mo><msub id="alg3.l9.m1.4.4.4.3.3.3.3" xref="alg3.l9.m1.4.4.4.3.3.3.3.cmml"><mi id="alg3.l9.m1.4.4.4.3.3.3.3.2" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.3.3.3.2.cmml">α</mi><mi id="alg3.l9.m1.4.4.4.3.3.3.3.3" mathsize="80%" xref="alg3.l9.m1.4.4.4.3.3.3.3.3.cmml">t</mi></msub></mrow><mo id="alg3.l9.m1.4.4.4.3.3.7" xref="alg3.l9.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.4b"><apply id="alg3.l9.m1.4.4.cmml" xref="alg3.l9.m1.4.4"><eq id="alg3.l9.m1.4.4.5.cmml" xref="alg3.l9.m1.4.4.5"></eq><apply id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1"><times id="alg3.l9.m1.1.1.1.2.cmml" xref="alg3.l9.m1.1.1.1.2"></times><ci id="alg3.l9.m1.1.1.1.3.cmml" xref="alg3.l9.m1.1.1.1.3">𝑞</ci><apply id="alg3.l9.m1.1.1.1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg3.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg3.l9.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg3.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.l9.m1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3.2">𝑦</ci><apply id="alg3.l9.m1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3.3"><minus id="alg3.l9.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg3.l9.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg3.l9.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg3.l9.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg3.l9.m1.4.4.4.cmml" xref="alg3.l9.m1.4.4.4"><times id="alg3.l9.m1.4.4.4.4.cmml" xref="alg3.l9.m1.4.4.4.4"></times><ci id="alg3.l9.m1.4.4.4.5.cmml" xref="alg3.l9.m1.4.4.4.5">𝒩</ci><list id="alg3.l9.m1.4.4.4.3.4.cmml" xref="alg3.l9.m1.4.4.4.3.3"><apply id="alg3.l9.m1.2.2.2.1.1.1.cmml" xref="alg3.l9.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l9.m1.2.2.2.1.1.1.1.cmml" xref="alg3.l9.m1.2.2.2.1.1.1">subscript</csymbol><ci id="alg3.l9.m1.2.2.2.1.1.1.2.cmml" xref="alg3.l9.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="alg3.l9.m1.2.2.2.1.1.1.3.cmml" xref="alg3.l9.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg3.l9.m1.3.3.3.2.2.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2"><times id="alg3.l9.m1.3.3.3.2.2.2.1.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.1"></times><apply id="alg3.l9.m1.3.3.3.2.2.2.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2"><root id="alg3.l9.m1.3.3.3.2.2.2.2a.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2"></root><apply id="alg3.l9.m1.3.3.3.2.2.2.2.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l9.m1.3.3.3.2.2.2.2.2.1.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg3.l9.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2.2.2">𝛼</ci><ci id="alg3.l9.m1.3.3.3.2.2.2.2.2.3.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="alg3.l9.m1.3.3.3.2.2.2.3.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l9.m1.3.3.3.2.2.2.3.1.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="alg3.l9.m1.3.3.3.2.2.2.3.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3.2">𝑦</ci><apply id="alg3.l9.m1.3.3.3.2.2.2.3.3.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3.3"><minus id="alg3.l9.m1.3.3.3.2.2.2.3.3.1.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.1"></minus><ci id="alg3.l9.m1.3.3.3.2.2.2.3.3.2.cmml" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.2">𝑡</ci><cn id="alg3.l9.m1.3.3.3.2.2.2.3.3.3.cmml" type="integer" xref="alg3.l9.m1.3.3.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="alg3.l9.m1.4.4.4.3.3.3.cmml" xref="alg3.l9.m1.4.4.4.3.3.3"><minus id="alg3.l9.m1.4.4.4.3.3.3.1.cmml" xref="alg3.l9.m1.4.4.4.3.3.3.1"></minus><cn id="alg3.l9.m1.4.4.4.3.3.3.2.cmml" type="integer" xref="alg3.l9.m1.4.4.4.3.3.3.2">1</cn><apply id="alg3.l9.m1.4.4.4.3.3.3.3.cmml" xref="alg3.l9.m1.4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.4.4.4.3.3.3.3.1.cmml" xref="alg3.l9.m1.4.4.4.3.3.3.3">subscript</csymbol><ci id="alg3.l9.m1.4.4.4.3.3.3.3.2.cmml" xref="alg3.l9.m1.4.4.4.3.3.3.3.2">𝛼</ci><ci id="alg3.l9.m1.4.4.4.3.3.3.3.3.cmml" xref="alg3.l9.m1.4.4.4.3.3.3.3.3">𝑡</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.4c">q(y_{t}\mid y_{t-1})=\mathcal{N}\left(y_{t};\sqrt{\alpha_{t}}y_{t-1},1-\alpha_%
{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.m1.4d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l9.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l10.2.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg3.l10.3" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg3.l10.1" style="font-size:80%;">Reverse process <math alttext="\to" class="ltx_Math" display="inline" id="alg3.l10.1.m1.1"><semantics id="alg3.l10.1.m1.1a"><mo id="alg3.l10.1.m1.1.1" stretchy="false" xref="alg3.l10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg3.l10.1.m1.1b"><ci id="alg3.l10.1.m1.1.1.cmml" xref="alg3.l10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.1.m1.1d">→</annotation></semantics></math> denoising:</span><span class="ltx_text" id="alg3.l10.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg3.l11.2" style="font-size:80%;">    </span><math alttext="{y}_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)" class="ltx_Math" display="inline" id="alg3.l11.m1.4"><semantics id="alg3.l11.m1.4a"><mrow id="alg3.l11.m1.4.4" xref="alg3.l11.m1.4.4.cmml"><msubsup id="alg3.l11.m1.4.4.4" xref="alg3.l11.m1.4.4.4.cmml"><mi id="alg3.l11.m1.4.4.4.2.2" mathsize="80%" xref="alg3.l11.m1.4.4.4.2.2.cmml">y</mi><mn id="alg3.l11.m1.4.4.4.2.3" mathsize="80%" xref="alg3.l11.m1.4.4.4.2.3.cmml">0</mn><mo id="alg3.l11.m1.4.4.4.3" mathsize="80%" xref="alg3.l11.m1.4.4.4.3.cmml">′</mo></msubsup><mo id="alg3.l11.m1.4.4.3" mathsize="80%" xref="alg3.l11.m1.4.4.3.cmml">=</mo><mrow id="alg3.l11.m1.4.4.2" xref="alg3.l11.m1.4.4.2.cmml"><msub id="alg3.l11.m1.4.4.2.4" xref="alg3.l11.m1.4.4.2.4.cmml"><mi id="alg3.l11.m1.4.4.2.4.2" mathsize="80%" xref="alg3.l11.m1.4.4.2.4.2.cmml">G</mi><mtext id="alg3.l11.m1.4.4.2.4.3" mathsize="80%" xref="alg3.l11.m1.4.4.2.4.3a.cmml">sn</mtext></msub><mo id="alg3.l11.m1.4.4.2.3" xref="alg3.l11.m1.4.4.2.3.cmml">⁢</mo><mrow id="alg3.l11.m1.4.4.2.2.2" xref="alg3.l11.m1.4.4.2.2.3.cmml"><mo id="alg3.l11.m1.4.4.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l11.m1.4.4.2.2.3.cmml">(</mo><msub id="alg3.l11.m1.3.3.1.1.1.1" xref="alg3.l11.m1.3.3.1.1.1.1.cmml"><mi id="alg3.l11.m1.3.3.1.1.1.1.2" mathsize="80%" xref="alg3.l11.m1.3.3.1.1.1.1.2.cmml">y</mi><mi id="alg3.l11.m1.3.3.1.1.1.1.3" mathsize="80%" xref="alg3.l11.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l11.m1.4.4.2.2.2.4" mathsize="80%" xref="alg3.l11.m1.4.4.2.2.3.cmml">,</mo><msub id="alg3.l11.m1.4.4.2.2.2.2" xref="alg3.l11.m1.4.4.2.2.2.2.cmml"><mi id="alg3.l11.m1.4.4.2.2.2.2.2" mathsize="80%" xref="alg3.l11.m1.4.4.2.2.2.2.2.cmml">x</mi><mn id="alg3.l11.m1.4.4.2.2.2.2.3" mathsize="80%" xref="alg3.l11.m1.4.4.2.2.2.2.3.cmml">0</mn></msub><mo id="alg3.l11.m1.4.4.2.2.2.5" mathsize="80%" xref="alg3.l11.m1.4.4.2.2.3.cmml">,</mo><mi id="alg3.l11.m1.1.1" mathsize="80%" xref="alg3.l11.m1.1.1.cmml">z</mi><mo id="alg3.l11.m1.4.4.2.2.2.6" mathsize="80%" xref="alg3.l11.m1.4.4.2.2.3.cmml">,</mo><mi id="alg3.l11.m1.2.2" mathsize="80%" xref="alg3.l11.m1.2.2.cmml">t</mi><mo id="alg3.l11.m1.4.4.2.2.2.7" maxsize="80%" minsize="80%" xref="alg3.l11.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.4b"><apply id="alg3.l11.m1.4.4.cmml" xref="alg3.l11.m1.4.4"><eq id="alg3.l11.m1.4.4.3.cmml" xref="alg3.l11.m1.4.4.3"></eq><apply id="alg3.l11.m1.4.4.4.cmml" xref="alg3.l11.m1.4.4.4"><csymbol cd="ambiguous" id="alg3.l11.m1.4.4.4.1.cmml" xref="alg3.l11.m1.4.4.4">superscript</csymbol><apply id="alg3.l11.m1.4.4.4.2.cmml" xref="alg3.l11.m1.4.4.4"><csymbol cd="ambiguous" id="alg3.l11.m1.4.4.4.2.1.cmml" xref="alg3.l11.m1.4.4.4">subscript</csymbol><ci id="alg3.l11.m1.4.4.4.2.2.cmml" xref="alg3.l11.m1.4.4.4.2.2">𝑦</ci><cn id="alg3.l11.m1.4.4.4.2.3.cmml" type="integer" xref="alg3.l11.m1.4.4.4.2.3">0</cn></apply><ci id="alg3.l11.m1.4.4.4.3.cmml" xref="alg3.l11.m1.4.4.4.3">′</ci></apply><apply id="alg3.l11.m1.4.4.2.cmml" xref="alg3.l11.m1.4.4.2"><times id="alg3.l11.m1.4.4.2.3.cmml" xref="alg3.l11.m1.4.4.2.3"></times><apply id="alg3.l11.m1.4.4.2.4.cmml" xref="alg3.l11.m1.4.4.2.4"><csymbol cd="ambiguous" id="alg3.l11.m1.4.4.2.4.1.cmml" xref="alg3.l11.m1.4.4.2.4">subscript</csymbol><ci id="alg3.l11.m1.4.4.2.4.2.cmml" xref="alg3.l11.m1.4.4.2.4.2">𝐺</ci><ci id="alg3.l11.m1.4.4.2.4.3a.cmml" xref="alg3.l11.m1.4.4.2.4.3"><mtext id="alg3.l11.m1.4.4.2.4.3.cmml" mathsize="56%" xref="alg3.l11.m1.4.4.2.4.3">sn</mtext></ci></apply><vector id="alg3.l11.m1.4.4.2.2.3.cmml" xref="alg3.l11.m1.4.4.2.2.2"><apply id="alg3.l11.m1.3.3.1.1.1.1.cmml" xref="alg3.l11.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.3.3.1.1.1.1.1.cmml" xref="alg3.l11.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg3.l11.m1.3.3.1.1.1.1.2.cmml" xref="alg3.l11.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="alg3.l11.m1.3.3.1.1.1.1.3.cmml" xref="alg3.l11.m1.3.3.1.1.1.1.3">𝑡</ci></apply><apply id="alg3.l11.m1.4.4.2.2.2.2.cmml" xref="alg3.l11.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l11.m1.4.4.2.2.2.2.1.cmml" xref="alg3.l11.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg3.l11.m1.4.4.2.2.2.2.2.cmml" xref="alg3.l11.m1.4.4.2.2.2.2.2">𝑥</ci><cn id="alg3.l11.m1.4.4.2.2.2.2.3.cmml" type="integer" xref="alg3.l11.m1.4.4.2.2.2.2.3">0</cn></apply><ci id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1">𝑧</ci><ci id="alg3.l11.m1.2.2.cmml" xref="alg3.l11.m1.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.4c">{y}_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.m1.4d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_G start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_z , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg3.l11.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg3.l12.2" style="font-size:80%;">    </span><math alttext="q({y}_{t-1}^{\prime}\mid y_{t},{y}_{0}^{\prime})=\mathcal{N}\left({y}_{t-1}^{%
\prime};\tilde{\mu}_{t}(y_{t},{y}_{0}^{\prime}),\tilde{\beta}_{t}\right)" class="ltx_Math" display="inline" id="alg3.l12.m1.4"><semantics id="alg3.l12.m1.4a"><mrow id="alg3.l12.m1.4.4" xref="alg3.l12.m1.4.4.cmml"><mrow id="alg3.l12.m1.1.1.1" xref="alg3.l12.m1.1.1.1.cmml"><mi id="alg3.l12.m1.1.1.1.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.3.cmml">q</mi><mo id="alg3.l12.m1.1.1.1.2" xref="alg3.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l12.m1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l12.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l12.m1.1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.cmml"><msubsup id="alg3.l12.m1.1.1.1.1.1.1.4" xref="alg3.l12.m1.1.1.1.1.1.1.4.cmml"><mi id="alg3.l12.m1.1.1.1.1.1.1.4.2.2" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="alg3.l12.m1.1.1.1.1.1.1.4.2.3" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.2" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.1" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="alg3.l12.m1.1.1.1.1.1.1.4.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="alg3.l12.m1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="alg3.l12.m1.1.1.1.1.1.1.2.2" xref="alg3.l12.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg3.l12.m1.1.1.1.1.1.1.1.1.1" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l12.m1.1.1.1.1.1.1.2.2.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="alg3.l12.m1.1.1.1.1.1.1.2.2.2" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.2" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.3" mathsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="alg3.l12.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l12.m1.4.4.5" mathsize="80%" xref="alg3.l12.m1.4.4.5.cmml">=</mo><mrow id="alg3.l12.m1.4.4.4" xref="alg3.l12.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l12.m1.4.4.4.5" mathsize="80%" xref="alg3.l12.m1.4.4.4.5.cmml">𝒩</mi><mo id="alg3.l12.m1.4.4.4.4" xref="alg3.l12.m1.4.4.4.4.cmml">⁢</mo><mrow id="alg3.l12.m1.4.4.4.3.3" xref="alg3.l12.m1.4.4.4.3.4.cmml"><mo id="alg3.l12.m1.4.4.4.3.3.4" xref="alg3.l12.m1.4.4.4.3.4.cmml">(</mo><msubsup id="alg3.l12.m1.2.2.2.1.1.1" xref="alg3.l12.m1.2.2.2.1.1.1.cmml"><mi id="alg3.l12.m1.2.2.2.1.1.1.2.2" mathsize="80%" xref="alg3.l12.m1.2.2.2.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l12.m1.2.2.2.1.1.1.2.3" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.cmml"><mi id="alg3.l12.m1.2.2.2.1.1.1.2.3.2" mathsize="80%" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l12.m1.2.2.2.1.1.1.2.3.1" mathsize="80%" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l12.m1.2.2.2.1.1.1.2.3.3" mathsize="80%" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="alg3.l12.m1.2.2.2.1.1.1.3" mathsize="80%" xref="alg3.l12.m1.2.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l12.m1.4.4.4.3.3.5" mathsize="80%" xref="alg3.l12.m1.4.4.4.3.4.cmml">;</mo><mrow id="alg3.l12.m1.3.3.3.2.2.2" xref="alg3.l12.m1.3.3.3.2.2.2.cmml"><msub id="alg3.l12.m1.3.3.3.2.2.2.4" xref="alg3.l12.m1.3.3.3.2.2.2.4.cmml"><mover accent="true" id="alg3.l12.m1.3.3.3.2.2.2.4.2" xref="alg3.l12.m1.3.3.3.2.2.2.4.2.cmml"><mi id="alg3.l12.m1.3.3.3.2.2.2.4.2.2" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.4.2.2.cmml">μ</mi><mo id="alg3.l12.m1.3.3.3.2.2.2.4.2.1" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.4.2.1.cmml">~</mo></mover><mi id="alg3.l12.m1.3.3.3.2.2.2.4.3" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.4.3.cmml">t</mi></msub><mo id="alg3.l12.m1.3.3.3.2.2.2.3" xref="alg3.l12.m1.3.3.3.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l12.m1.3.3.3.2.2.2.2.2" xref="alg3.l12.m1.3.3.3.2.2.2.2.3.cmml"><mo id="alg3.l12.m1.3.3.3.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.3.cmml">(</mo><msub id="alg3.l12.m1.3.3.3.2.2.2.1.1.1" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1.cmml"><mi id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.2" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1.2.cmml">y</mi><mi id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.3" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l12.m1.3.3.3.2.2.2.2.2.4" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="alg3.l12.m1.3.3.3.2.2.2.2.2.2" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.2.cmml">y</mi><mn id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.3.cmml">0</mn><mo id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg3.l12.m1.3.3.3.2.2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l12.m1.3.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg3.l12.m1.4.4.4.3.3.6" mathsize="80%" xref="alg3.l12.m1.4.4.4.3.4.cmml">,</mo><msub id="alg3.l12.m1.4.4.4.3.3.3" xref="alg3.l12.m1.4.4.4.3.3.3.cmml"><mover accent="true" id="alg3.l12.m1.4.4.4.3.3.3.2" xref="alg3.l12.m1.4.4.4.3.3.3.2.cmml"><mi id="alg3.l12.m1.4.4.4.3.3.3.2.2" mathsize="80%" xref="alg3.l12.m1.4.4.4.3.3.3.2.2.cmml">β</mi><mo id="alg3.l12.m1.4.4.4.3.3.3.2.1" mathsize="80%" xref="alg3.l12.m1.4.4.4.3.3.3.2.1.cmml">~</mo></mover><mi id="alg3.l12.m1.4.4.4.3.3.3.3" mathsize="80%" xref="alg3.l12.m1.4.4.4.3.3.3.3.cmml">t</mi></msub><mo id="alg3.l12.m1.4.4.4.3.3.7" xref="alg3.l12.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l12.m1.4b"><apply id="alg3.l12.m1.4.4.cmml" xref="alg3.l12.m1.4.4"><eq id="alg3.l12.m1.4.4.5.cmml" xref="alg3.l12.m1.4.4.5"></eq><apply id="alg3.l12.m1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1"><times id="alg3.l12.m1.1.1.1.2.cmml" xref="alg3.l12.m1.1.1.1.2"></times><ci id="alg3.l12.m1.1.1.1.3.cmml" xref="alg3.l12.m1.1.1.1.3">𝑞</ci><apply id="alg3.l12.m1.1.1.1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="alg3.l12.m1.1.1.1.1.1.1.4.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.4.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4">superscript</csymbol><apply id="alg3.l12.m1.1.1.1.1.1.1.4.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.4.2.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg3.l12.m1.1.1.1.1.1.1.4.2.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.2">𝑦</ci><apply id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3"><minus id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.1"></minus><ci id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="alg3.l12.m1.1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="alg3.l12.m1.1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="alg3.l12.m1.1.1.1.1.1.1.4.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.4.3">′</ci></apply><list id="alg3.l12.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2"><apply id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg3.l12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="alg3.l12.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg3.l12.m1.1.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply><apply id="alg3.l12.m1.4.4.4.cmml" xref="alg3.l12.m1.4.4.4"><times id="alg3.l12.m1.4.4.4.4.cmml" xref="alg3.l12.m1.4.4.4.4"></times><ci id="alg3.l12.m1.4.4.4.5.cmml" xref="alg3.l12.m1.4.4.4.5">𝒩</ci><list id="alg3.l12.m1.4.4.4.3.4.cmml" xref="alg3.l12.m1.4.4.4.3.3"><apply id="alg3.l12.m1.2.2.2.1.1.1.cmml" xref="alg3.l12.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l12.m1.2.2.2.1.1.1.1.cmml" xref="alg3.l12.m1.2.2.2.1.1.1">superscript</csymbol><apply id="alg3.l12.m1.2.2.2.1.1.1.2.cmml" xref="alg3.l12.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l12.m1.2.2.2.1.1.1.2.1.cmml" xref="alg3.l12.m1.2.2.2.1.1.1">subscript</csymbol><ci id="alg3.l12.m1.2.2.2.1.1.1.2.2.cmml" xref="alg3.l12.m1.2.2.2.1.1.1.2.2">𝑦</ci><apply id="alg3.l12.m1.2.2.2.1.1.1.2.3.cmml" xref="alg3.l12.m1.2.2.2.1.1.1.2.3"><minus id="alg3.l12.m1.2.2.2.1.1.1.2.3.1.cmml" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.1"></minus><ci id="alg3.l12.m1.2.2.2.1.1.1.2.3.2.cmml" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l12.m1.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l12.m1.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg3.l12.m1.2.2.2.1.1.1.3.cmml" xref="alg3.l12.m1.2.2.2.1.1.1.3">′</ci></apply><apply id="alg3.l12.m1.3.3.3.2.2.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2"><times id="alg3.l12.m1.3.3.3.2.2.2.3.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.3"></times><apply id="alg3.l12.m1.3.3.3.2.2.2.4.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l12.m1.3.3.3.2.2.2.4.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4">subscript</csymbol><apply id="alg3.l12.m1.3.3.3.2.2.2.4.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4.2"><ci id="alg3.l12.m1.3.3.3.2.2.2.4.2.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4.2.1">~</ci><ci id="alg3.l12.m1.3.3.3.2.2.2.4.2.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4.2.2">𝜇</ci></apply><ci id="alg3.l12.m1.3.3.3.2.2.2.4.3.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="alg3.l12.m1.3.3.3.2.2.2.2.3.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2"><apply id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1.2">𝑦</ci><ci id="alg3.l12.m1.3.3.3.2.2.2.1.1.1.3.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.1.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.2.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.2">𝑦</ci><cn id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.3.cmml" type="integer" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.2.3">0</cn></apply><ci id="alg3.l12.m1.3.3.3.2.2.2.2.2.2.3.cmml" xref="alg3.l12.m1.3.3.3.2.2.2.2.2.2.3">′</ci></apply></interval></apply><apply id="alg3.l12.m1.4.4.4.3.3.3.cmml" xref="alg3.l12.m1.4.4.4.3.3.3"><csymbol cd="ambiguous" id="alg3.l12.m1.4.4.4.3.3.3.1.cmml" xref="alg3.l12.m1.4.4.4.3.3.3">subscript</csymbol><apply id="alg3.l12.m1.4.4.4.3.3.3.2.cmml" xref="alg3.l12.m1.4.4.4.3.3.3.2"><ci id="alg3.l12.m1.4.4.4.3.3.3.2.1.cmml" xref="alg3.l12.m1.4.4.4.3.3.3.2.1">~</ci><ci id="alg3.l12.m1.4.4.4.3.3.3.2.2.cmml" xref="alg3.l12.m1.4.4.4.3.3.3.2.2">𝛽</ci></apply><ci id="alg3.l12.m1.4.4.4.3.3.3.3.cmml" xref="alg3.l12.m1.4.4.4.3.3.3.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l12.m1.4c">q({y}_{t-1}^{\prime}\mid y_{t},{y}_{0}^{\prime})=\mathcal{N}\left({y}_{t-1}^{%
\prime};\tilde{\mu}_{t}(y_{t},{y}_{0}^{\prime}),\tilde{\beta}_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg3.l12.m1.4d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = caligraphic_N ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ; over~ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , over~ start_ARG italic_β end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l12.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg3.l13.2" style="font-size:80%;">    </span><math alttext="{y}_{c}^{\prime}=\text{IDWT}({y}_{0}^{\prime})" class="ltx_Math" display="inline" id="alg3.l13.m1.1"><semantics id="alg3.l13.m1.1a"><mrow id="alg3.l13.m1.1.1" xref="alg3.l13.m1.1.1.cmml"><msubsup id="alg3.l13.m1.1.1.3" xref="alg3.l13.m1.1.1.3.cmml"><mi id="alg3.l13.m1.1.1.3.2.2" mathsize="80%" xref="alg3.l13.m1.1.1.3.2.2.cmml">y</mi><mi id="alg3.l13.m1.1.1.3.2.3" mathsize="80%" xref="alg3.l13.m1.1.1.3.2.3.cmml">c</mi><mo id="alg3.l13.m1.1.1.3.3" mathsize="80%" xref="alg3.l13.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="alg3.l13.m1.1.1.2" mathsize="80%" xref="alg3.l13.m1.1.1.2.cmml">=</mo><mrow id="alg3.l13.m1.1.1.1" xref="alg3.l13.m1.1.1.1.cmml"><mtext id="alg3.l13.m1.1.1.1.3" mathsize="80%" xref="alg3.l13.m1.1.1.1.3a.cmml">IDWT</mtext><mo id="alg3.l13.m1.1.1.1.2" xref="alg3.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l13.m1.1.1.1.1.1" xref="alg3.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l13.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg3.l13.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg3.l13.m1.1.1.1.1.1.1" xref="alg3.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l13.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l13.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="alg3.l13.m1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg3.l13.m1.1.1.1.1.1.1.2.3.cmml">0</mn><mo id="alg3.l13.m1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l13.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l13.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg3.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l13.m1.1b"><apply id="alg3.l13.m1.1.1.cmml" xref="alg3.l13.m1.1.1"><eq id="alg3.l13.m1.1.1.2.cmml" xref="alg3.l13.m1.1.1.2"></eq><apply id="alg3.l13.m1.1.1.3.cmml" xref="alg3.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l13.m1.1.1.3.1.cmml" xref="alg3.l13.m1.1.1.3">superscript</csymbol><apply id="alg3.l13.m1.1.1.3.2.cmml" xref="alg3.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l13.m1.1.1.3.2.1.cmml" xref="alg3.l13.m1.1.1.3">subscript</csymbol><ci id="alg3.l13.m1.1.1.3.2.2.cmml" xref="alg3.l13.m1.1.1.3.2.2">𝑦</ci><ci id="alg3.l13.m1.1.1.3.2.3.cmml" xref="alg3.l13.m1.1.1.3.2.3">𝑐</ci></apply><ci id="alg3.l13.m1.1.1.3.3.cmml" xref="alg3.l13.m1.1.1.3.3">′</ci></apply><apply id="alg3.l13.m1.1.1.1.cmml" xref="alg3.l13.m1.1.1.1"><times id="alg3.l13.m1.1.1.1.2.cmml" xref="alg3.l13.m1.1.1.1.2"></times><ci id="alg3.l13.m1.1.1.1.3a.cmml" xref="alg3.l13.m1.1.1.1.3"><mtext id="alg3.l13.m1.1.1.1.3.cmml" mathsize="80%" xref="alg3.l13.m1.1.1.1.3">IDWT</mtext></ci><apply id="alg3.l13.m1.1.1.1.1.1.1.cmml" xref="alg3.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l13.m1.1.1.1.1.1">superscript</csymbol><apply id="alg3.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l13.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l13.m1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="alg3.l13.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg3.l13.m1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg3.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l13.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m1.1c">{y}_{c}^{\prime}=\text{IDWT}({y}_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.m1.1d">italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = IDWT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l13.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg3.l14.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg3.l14.3" style="font-size:80%;">if</span><span class="ltx_text" id="alg3.l14.4" style="font-size:80%;"> Labeled </span><span class="ltx_text ltx_font_bold" id="alg3.l14.5" style="font-size:80%;">then</span><span class="ltx_text" id="alg3.l14.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg3.l15.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}_{\text{aux}}=\mathcal{L}_{\text{rec}}({y}_{c}^{\prime},y_{c})+%
\mathcal{L}_{\text{perc}}({y}_{c}^{\prime},y_{c})" class="ltx_Math" display="inline" id="alg3.l15.m1.4"><semantics id="alg3.l15.m1.4a"><mrow id="alg3.l15.m1.4.4" xref="alg3.l15.m1.4.4.cmml"><msub id="alg3.l15.m1.4.4.6" xref="alg3.l15.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l15.m1.4.4.6.2" mathsize="80%" xref="alg3.l15.m1.4.4.6.2.cmml">ℒ</mi><mtext id="alg3.l15.m1.4.4.6.3" mathsize="80%" xref="alg3.l15.m1.4.4.6.3a.cmml">aux</mtext></msub><mo id="alg3.l15.m1.4.4.5" mathsize="80%" xref="alg3.l15.m1.4.4.5.cmml">=</mo><mrow id="alg3.l15.m1.4.4.4" xref="alg3.l15.m1.4.4.4.cmml"><mrow id="alg3.l15.m1.2.2.2.2" xref="alg3.l15.m1.2.2.2.2.cmml"><msub id="alg3.l15.m1.2.2.2.2.4" xref="alg3.l15.m1.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l15.m1.2.2.2.2.4.2" mathsize="80%" xref="alg3.l15.m1.2.2.2.2.4.2.cmml">ℒ</mi><mtext id="alg3.l15.m1.2.2.2.2.4.3" mathsize="80%" xref="alg3.l15.m1.2.2.2.2.4.3a.cmml">rec</mtext></msub><mo id="alg3.l15.m1.2.2.2.2.3" xref="alg3.l15.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l15.m1.2.2.2.2.2.2" xref="alg3.l15.m1.2.2.2.2.2.3.cmml"><mo id="alg3.l15.m1.2.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l15.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="alg3.l15.m1.1.1.1.1.1.1.1" xref="alg3.l15.m1.1.1.1.1.1.1.1.cmml"><mi id="alg3.l15.m1.1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l15.m1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="alg3.l15.m1.1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg3.l15.m1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mo id="alg3.l15.m1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l15.m1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l15.m1.2.2.2.2.2.2.4" mathsize="80%" xref="alg3.l15.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg3.l15.m1.2.2.2.2.2.2.2" xref="alg3.l15.m1.2.2.2.2.2.2.2.cmml"><mi id="alg3.l15.m1.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l15.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l15.m1.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l15.m1.2.2.2.2.2.2.2.3.cmml">c</mi></msub><mo id="alg3.l15.m1.2.2.2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l15.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg3.l15.m1.4.4.4.5" mathsize="80%" xref="alg3.l15.m1.4.4.4.5.cmml">+</mo><mrow id="alg3.l15.m1.4.4.4.4" xref="alg3.l15.m1.4.4.4.4.cmml"><msub id="alg3.l15.m1.4.4.4.4.4" xref="alg3.l15.m1.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l15.m1.4.4.4.4.4.2" mathsize="80%" xref="alg3.l15.m1.4.4.4.4.4.2.cmml">ℒ</mi><mtext id="alg3.l15.m1.4.4.4.4.4.3" mathsize="80%" xref="alg3.l15.m1.4.4.4.4.4.3a.cmml">perc</mtext></msub><mo id="alg3.l15.m1.4.4.4.4.3" xref="alg3.l15.m1.4.4.4.4.3.cmml">⁢</mo><mrow id="alg3.l15.m1.4.4.4.4.2.2" xref="alg3.l15.m1.4.4.4.4.2.3.cmml"><mo id="alg3.l15.m1.4.4.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l15.m1.4.4.4.4.2.3.cmml">(</mo><msubsup id="alg3.l15.m1.3.3.3.3.1.1.1" xref="alg3.l15.m1.3.3.3.3.1.1.1.cmml"><mi id="alg3.l15.m1.3.3.3.3.1.1.1.2.2" mathsize="80%" xref="alg3.l15.m1.3.3.3.3.1.1.1.2.2.cmml">y</mi><mi id="alg3.l15.m1.3.3.3.3.1.1.1.2.3" mathsize="80%" xref="alg3.l15.m1.3.3.3.3.1.1.1.2.3.cmml">c</mi><mo id="alg3.l15.m1.3.3.3.3.1.1.1.3" mathsize="80%" xref="alg3.l15.m1.3.3.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l15.m1.4.4.4.4.2.2.4" mathsize="80%" xref="alg3.l15.m1.4.4.4.4.2.3.cmml">,</mo><msub id="alg3.l15.m1.4.4.4.4.2.2.2" xref="alg3.l15.m1.4.4.4.4.2.2.2.cmml"><mi id="alg3.l15.m1.4.4.4.4.2.2.2.2" mathsize="80%" xref="alg3.l15.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="alg3.l15.m1.4.4.4.4.2.2.2.3" mathsize="80%" xref="alg3.l15.m1.4.4.4.4.2.2.2.3.cmml">c</mi></msub><mo id="alg3.l15.m1.4.4.4.4.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l15.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l15.m1.4b"><apply id="alg3.l15.m1.4.4.cmml" xref="alg3.l15.m1.4.4"><eq id="alg3.l15.m1.4.4.5.cmml" xref="alg3.l15.m1.4.4.5"></eq><apply id="alg3.l15.m1.4.4.6.cmml" xref="alg3.l15.m1.4.4.6"><csymbol cd="ambiguous" id="alg3.l15.m1.4.4.6.1.cmml" xref="alg3.l15.m1.4.4.6">subscript</csymbol><ci id="alg3.l15.m1.4.4.6.2.cmml" xref="alg3.l15.m1.4.4.6.2">ℒ</ci><ci id="alg3.l15.m1.4.4.6.3a.cmml" xref="alg3.l15.m1.4.4.6.3"><mtext id="alg3.l15.m1.4.4.6.3.cmml" mathsize="56%" xref="alg3.l15.m1.4.4.6.3">aux</mtext></ci></apply><apply id="alg3.l15.m1.4.4.4.cmml" xref="alg3.l15.m1.4.4.4"><plus id="alg3.l15.m1.4.4.4.5.cmml" xref="alg3.l15.m1.4.4.4.5"></plus><apply id="alg3.l15.m1.2.2.2.2.cmml" xref="alg3.l15.m1.2.2.2.2"><times id="alg3.l15.m1.2.2.2.2.3.cmml" xref="alg3.l15.m1.2.2.2.2.3"></times><apply id="alg3.l15.m1.2.2.2.2.4.cmml" xref="alg3.l15.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l15.m1.2.2.2.2.4.1.cmml" xref="alg3.l15.m1.2.2.2.2.4">subscript</csymbol><ci id="alg3.l15.m1.2.2.2.2.4.2.cmml" xref="alg3.l15.m1.2.2.2.2.4.2">ℒ</ci><ci id="alg3.l15.m1.2.2.2.2.4.3a.cmml" xref="alg3.l15.m1.2.2.2.2.4.3"><mtext id="alg3.l15.m1.2.2.2.2.4.3.cmml" mathsize="56%" xref="alg3.l15.m1.2.2.2.2.4.3">rec</mtext></ci></apply><interval closure="open" id="alg3.l15.m1.2.2.2.2.2.3.cmml" xref="alg3.l15.m1.2.2.2.2.2.2"><apply id="alg3.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg3.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l15.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l15.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg3.l15.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="alg3.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l15.m1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg3.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l15.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l15.m1.2.2.2.2.2.2.2.1.cmml" xref="alg3.l15.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l15.m1.2.2.2.2.2.2.2.2.cmml" xref="alg3.l15.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l15.m1.2.2.2.2.2.2.2.3.cmml" xref="alg3.l15.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply></interval></apply><apply id="alg3.l15.m1.4.4.4.4.cmml" xref="alg3.l15.m1.4.4.4.4"><times id="alg3.l15.m1.4.4.4.4.3.cmml" xref="alg3.l15.m1.4.4.4.4.3"></times><apply id="alg3.l15.m1.4.4.4.4.4.cmml" xref="alg3.l15.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg3.l15.m1.4.4.4.4.4.1.cmml" xref="alg3.l15.m1.4.4.4.4.4">subscript</csymbol><ci id="alg3.l15.m1.4.4.4.4.4.2.cmml" xref="alg3.l15.m1.4.4.4.4.4.2">ℒ</ci><ci id="alg3.l15.m1.4.4.4.4.4.3a.cmml" xref="alg3.l15.m1.4.4.4.4.4.3"><mtext id="alg3.l15.m1.4.4.4.4.4.3.cmml" mathsize="56%" xref="alg3.l15.m1.4.4.4.4.4.3">perc</mtext></ci></apply><interval closure="open" id="alg3.l15.m1.4.4.4.4.2.3.cmml" xref="alg3.l15.m1.4.4.4.4.2.2"><apply id="alg3.l15.m1.3.3.3.3.1.1.1.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l15.m1.3.3.3.3.1.1.1.1.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1">superscript</csymbol><apply id="alg3.l15.m1.3.3.3.3.1.1.1.2.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l15.m1.3.3.3.3.1.1.1.2.1.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="alg3.l15.m1.3.3.3.3.1.1.1.2.2.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1.2.2">𝑦</ci><ci id="alg3.l15.m1.3.3.3.3.1.1.1.2.3.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1.2.3">𝑐</ci></apply><ci id="alg3.l15.m1.3.3.3.3.1.1.1.3.cmml" xref="alg3.l15.m1.3.3.3.3.1.1.1.3">′</ci></apply><apply id="alg3.l15.m1.4.4.4.4.2.2.2.cmml" xref="alg3.l15.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg3.l15.m1.4.4.4.4.2.2.2.1.cmml" xref="alg3.l15.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="alg3.l15.m1.4.4.4.4.2.2.2.2.cmml" xref="alg3.l15.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="alg3.l15.m1.4.4.4.4.2.2.2.3.cmml" xref="alg3.l15.m1.4.4.4.4.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.m1.4c">\mathcal{L}_{\text{aux}}=\mathcal{L}_{\text{rec}}({y}_{c}^{\prime},y_{c})+%
\mathcal{L}_{\text{perc}}({y}_{c}^{\prime},y_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l15.m1.4d">caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + caligraphic_L start_POSTSUBSCRIPT perc end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l15.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text" id="alg3.l16.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}^{G}_{\text{sup}}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+%
\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c})" class="ltx_Math" display="inline" id="alg3.l16.m1.5"><semantics id="alg3.l16.m1.5a"><mrow id="alg3.l16.m1.5.5" xref="alg3.l16.m1.5.5.cmml"><msubsup id="alg3.l16.m1.5.5.6" xref="alg3.l16.m1.5.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l16.m1.5.5.6.2.2" mathsize="80%" xref="alg3.l16.m1.5.5.6.2.2.cmml">ℒ</mi><mtext id="alg3.l16.m1.5.5.6.3" mathsize="80%" xref="alg3.l16.m1.5.5.6.3a.cmml">sup</mtext><mi id="alg3.l16.m1.5.5.6.2.3" mathsize="80%" xref="alg3.l16.m1.5.5.6.2.3.cmml">G</mi></msubsup><mo id="alg3.l16.m1.5.5.5" mathsize="80%" xref="alg3.l16.m1.5.5.5.cmml">=</mo><mrow id="alg3.l16.m1.5.5.4" xref="alg3.l16.m1.5.5.4.cmml"><mrow id="alg3.l16.m1.3.3.2.2" xref="alg3.l16.m1.3.3.2.2.cmml"><mo id="alg3.l16.m1.3.3.2.2a" mathsize="80%" rspace="0.167em" xref="alg3.l16.m1.3.3.2.2.cmml">−</mo><mrow id="alg3.l16.m1.3.3.2.2.2" xref="alg3.l16.m1.3.3.2.2.2.cmml"><mrow id="alg3.l16.m1.3.3.2.2.2.4" xref="alg3.l16.m1.3.3.2.2.2.4.cmml"><mi id="alg3.l16.m1.3.3.2.2.2.4.1" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.4.1.cmml">log</mi><mo id="alg3.l16.m1.3.3.2.2.2.4a" lspace="0.167em" xref="alg3.l16.m1.3.3.2.2.2.4.cmml">⁡</mo><msub id="alg3.l16.m1.3.3.2.2.2.4.2" xref="alg3.l16.m1.3.3.2.2.2.4.2.cmml"><mi id="alg3.l16.m1.3.3.2.2.2.4.2.2" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.4.2.2.cmml">D</mi><mtext id="alg3.l16.m1.3.3.2.2.2.4.2.3" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l16.m1.3.3.2.2.2.3" xref="alg3.l16.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l16.m1.3.3.2.2.2.2.2" xref="alg3.l16.m1.3.3.2.2.2.2.3.cmml"><mo id="alg3.l16.m1.3.3.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.3.cmml">(</mo><msubsup id="alg3.l16.m1.2.2.1.1.1.1.1.1" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.cmml"><mi id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.2" mathsize="80%" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.1" mathsize="80%" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.3" mathsize="80%" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="alg3.l16.m1.2.2.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l16.m1.3.3.2.2.2.2.2.4" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.3.cmml">,</mo><msub id="alg3.l16.m1.3.3.2.2.2.2.2.2" xref="alg3.l16.m1.3.3.2.2.2.2.2.2.cmml"><mi id="alg3.l16.m1.3.3.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l16.m1.3.3.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l16.m1.3.3.2.2.2.2.2.5" mathsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.3.cmml">,</mo><mi id="alg3.l16.m1.1.1" mathsize="80%" xref="alg3.l16.m1.1.1.cmml">t</mi><mo id="alg3.l16.m1.3.3.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l16.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l16.m1.5.5.4.5" mathsize="80%" xref="alg3.l16.m1.5.5.4.5.cmml">+</mo><mrow id="alg3.l16.m1.5.5.4.4" xref="alg3.l16.m1.5.5.4.4.cmml"><msub id="alg3.l16.m1.5.5.4.4.4" xref="alg3.l16.m1.5.5.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l16.m1.5.5.4.4.4.2" mathsize="80%" xref="alg3.l16.m1.5.5.4.4.4.2.cmml">ℒ</mi><mtext id="alg3.l16.m1.5.5.4.4.4.3" mathsize="80%" xref="alg3.l16.m1.5.5.4.4.4.3a.cmml">aux</mtext></msub><mo id="alg3.l16.m1.5.5.4.4.3" xref="alg3.l16.m1.5.5.4.4.3.cmml">⁢</mo><mrow id="alg3.l16.m1.5.5.4.4.2.2" xref="alg3.l16.m1.5.5.4.4.2.3.cmml"><mo id="alg3.l16.m1.5.5.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l16.m1.5.5.4.4.2.3.cmml">(</mo><msubsup id="alg3.l16.m1.4.4.3.3.1.1.1" xref="alg3.l16.m1.4.4.3.3.1.1.1.cmml"><mi id="alg3.l16.m1.4.4.3.3.1.1.1.2.2" mathsize="80%" xref="alg3.l16.m1.4.4.3.3.1.1.1.2.2.cmml">y</mi><mi id="alg3.l16.m1.4.4.3.3.1.1.1.2.3" mathsize="80%" xref="alg3.l16.m1.4.4.3.3.1.1.1.2.3.cmml">c</mi><mo id="alg3.l16.m1.4.4.3.3.1.1.1.3" mathsize="80%" xref="alg3.l16.m1.4.4.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l16.m1.5.5.4.4.2.2.4" mathsize="80%" xref="alg3.l16.m1.5.5.4.4.2.3.cmml">,</mo><msub id="alg3.l16.m1.5.5.4.4.2.2.2" xref="alg3.l16.m1.5.5.4.4.2.2.2.cmml"><mi id="alg3.l16.m1.5.5.4.4.2.2.2.2" mathsize="80%" xref="alg3.l16.m1.5.5.4.4.2.2.2.2.cmml">y</mi><mi id="alg3.l16.m1.5.5.4.4.2.2.2.3" mathsize="80%" xref="alg3.l16.m1.5.5.4.4.2.2.2.3.cmml">c</mi></msub><mo id="alg3.l16.m1.5.5.4.4.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l16.m1.5.5.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l16.m1.5b"><apply id="alg3.l16.m1.5.5.cmml" xref="alg3.l16.m1.5.5"><eq id="alg3.l16.m1.5.5.5.cmml" xref="alg3.l16.m1.5.5.5"></eq><apply id="alg3.l16.m1.5.5.6.cmml" xref="alg3.l16.m1.5.5.6"><csymbol cd="ambiguous" id="alg3.l16.m1.5.5.6.1.cmml" xref="alg3.l16.m1.5.5.6">subscript</csymbol><apply id="alg3.l16.m1.5.5.6.2.cmml" xref="alg3.l16.m1.5.5.6"><csymbol cd="ambiguous" id="alg3.l16.m1.5.5.6.2.1.cmml" xref="alg3.l16.m1.5.5.6">superscript</csymbol><ci id="alg3.l16.m1.5.5.6.2.2.cmml" xref="alg3.l16.m1.5.5.6.2.2">ℒ</ci><ci id="alg3.l16.m1.5.5.6.2.3.cmml" xref="alg3.l16.m1.5.5.6.2.3">𝐺</ci></apply><ci id="alg3.l16.m1.5.5.6.3a.cmml" xref="alg3.l16.m1.5.5.6.3"><mtext id="alg3.l16.m1.5.5.6.3.cmml" mathsize="56%" xref="alg3.l16.m1.5.5.6.3">sup</mtext></ci></apply><apply id="alg3.l16.m1.5.5.4.cmml" xref="alg3.l16.m1.5.5.4"><plus id="alg3.l16.m1.5.5.4.5.cmml" xref="alg3.l16.m1.5.5.4.5"></plus><apply id="alg3.l16.m1.3.3.2.2.cmml" xref="alg3.l16.m1.3.3.2.2"><minus id="alg3.l16.m1.3.3.2.2.3.cmml" xref="alg3.l16.m1.3.3.2.2"></minus><apply id="alg3.l16.m1.3.3.2.2.2.cmml" xref="alg3.l16.m1.3.3.2.2.2"><times id="alg3.l16.m1.3.3.2.2.2.3.cmml" xref="alg3.l16.m1.3.3.2.2.2.3"></times><apply id="alg3.l16.m1.3.3.2.2.2.4.cmml" xref="alg3.l16.m1.3.3.2.2.2.4"><log id="alg3.l16.m1.3.3.2.2.2.4.1.cmml" xref="alg3.l16.m1.3.3.2.2.2.4.1"></log><apply id="alg3.l16.m1.3.3.2.2.2.4.2.cmml" xref="alg3.l16.m1.3.3.2.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l16.m1.3.3.2.2.2.4.2.1.cmml" xref="alg3.l16.m1.3.3.2.2.2.4.2">subscript</csymbol><ci id="alg3.l16.m1.3.3.2.2.2.4.2.2.cmml" xref="alg3.l16.m1.3.3.2.2.2.4.2.2">𝐷</ci><ci id="alg3.l16.m1.3.3.2.2.2.4.2.3a.cmml" xref="alg3.l16.m1.3.3.2.2.2.4.2.3"><mtext id="alg3.l16.m1.3.3.2.2.2.4.2.3.cmml" mathsize="56%" xref="alg3.l16.m1.3.3.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l16.m1.3.3.2.2.2.2.3.cmml" xref="alg3.l16.m1.3.3.2.2.2.2.2"><apply id="alg3.l16.m1.2.2.1.1.1.1.1.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci><apply id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3"><minus id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.1"></minus><ci id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg3.l16.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg3.l16.m1.2.2.1.1.1.1.1.1.3">′</ci></apply><apply id="alg3.l16.m1.3.3.2.2.2.2.2.2.cmml" xref="alg3.l16.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l16.m1.3.3.2.2.2.2.2.2.1.cmml" xref="alg3.l16.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l16.m1.3.3.2.2.2.2.2.2.2.cmml" xref="alg3.l16.m1.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l16.m1.3.3.2.2.2.2.2.2.3.cmml" xref="alg3.l16.m1.3.3.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l16.m1.1.1.cmml" xref="alg3.l16.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg3.l16.m1.5.5.4.4.cmml" xref="alg3.l16.m1.5.5.4.4"><times id="alg3.l16.m1.5.5.4.4.3.cmml" xref="alg3.l16.m1.5.5.4.4.3"></times><apply id="alg3.l16.m1.5.5.4.4.4.cmml" xref="alg3.l16.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="alg3.l16.m1.5.5.4.4.4.1.cmml" xref="alg3.l16.m1.5.5.4.4.4">subscript</csymbol><ci id="alg3.l16.m1.5.5.4.4.4.2.cmml" xref="alg3.l16.m1.5.5.4.4.4.2">ℒ</ci><ci id="alg3.l16.m1.5.5.4.4.4.3a.cmml" xref="alg3.l16.m1.5.5.4.4.4.3"><mtext id="alg3.l16.m1.5.5.4.4.4.3.cmml" mathsize="56%" xref="alg3.l16.m1.5.5.4.4.4.3">aux</mtext></ci></apply><interval closure="open" id="alg3.l16.m1.5.5.4.4.2.3.cmml" xref="alg3.l16.m1.5.5.4.4.2.2"><apply id="alg3.l16.m1.4.4.3.3.1.1.1.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l16.m1.4.4.3.3.1.1.1.1.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1">superscript</csymbol><apply id="alg3.l16.m1.4.4.3.3.1.1.1.2.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l16.m1.4.4.3.3.1.1.1.2.1.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1">subscript</csymbol><ci id="alg3.l16.m1.4.4.3.3.1.1.1.2.2.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1.2.2">𝑦</ci><ci id="alg3.l16.m1.4.4.3.3.1.1.1.2.3.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1.2.3">𝑐</ci></apply><ci id="alg3.l16.m1.4.4.3.3.1.1.1.3.cmml" xref="alg3.l16.m1.4.4.3.3.1.1.1.3">′</ci></apply><apply id="alg3.l16.m1.5.5.4.4.2.2.2.cmml" xref="alg3.l16.m1.5.5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg3.l16.m1.5.5.4.4.2.2.2.1.cmml" xref="alg3.l16.m1.5.5.4.4.2.2.2">subscript</csymbol><ci id="alg3.l16.m1.5.5.4.4.2.2.2.2.cmml" xref="alg3.l16.m1.5.5.4.4.2.2.2.2">𝑦</ci><ci id="alg3.l16.m1.5.5.4.4.2.2.2.3.cmml" xref="alg3.l16.m1.5.5.4.4.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l16.m1.5c">\mathcal{L}^{G}_{\text{sup}}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+%
\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l16.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l16.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text" id="alg3.l17.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t)" class="ltx_Math" display="inline" id="alg3.l17.m1.6"><semantics id="alg3.l17.m1.6a"><mrow id="alg3.l17.m1.6.6" xref="alg3.l17.m1.6.6.cmml"><msubsup id="alg3.l17.m1.6.6.6" xref="alg3.l17.m1.6.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l17.m1.6.6.6.2.2" mathsize="80%" xref="alg3.l17.m1.6.6.6.2.2.cmml">ℒ</mi><mtext id="alg3.l17.m1.6.6.6.3" mathsize="80%" xref="alg3.l17.m1.6.6.6.3a.cmml">sup</mtext><mi id="alg3.l17.m1.6.6.6.2.3" mathsize="80%" xref="alg3.l17.m1.6.6.6.2.3.cmml">D</mi></msubsup><mo id="alg3.l17.m1.6.6.5" mathsize="80%" xref="alg3.l17.m1.6.6.5.cmml">=</mo><mrow id="alg3.l17.m1.6.6.4" xref="alg3.l17.m1.6.6.4.cmml"><mrow id="alg3.l17.m1.4.4.2.2" xref="alg3.l17.m1.4.4.2.2.cmml"><mo id="alg3.l17.m1.4.4.2.2a" mathsize="80%" rspace="0.167em" xref="alg3.l17.m1.4.4.2.2.cmml">−</mo><mrow id="alg3.l17.m1.4.4.2.2.2" xref="alg3.l17.m1.4.4.2.2.2.cmml"><mrow id="alg3.l17.m1.4.4.2.2.2.4" xref="alg3.l17.m1.4.4.2.2.2.4.cmml"><mi id="alg3.l17.m1.4.4.2.2.2.4.1" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.4.1.cmml">log</mi><mo id="alg3.l17.m1.4.4.2.2.2.4a" lspace="0.167em" xref="alg3.l17.m1.4.4.2.2.2.4.cmml">⁡</mo><msub id="alg3.l17.m1.4.4.2.2.2.4.2" xref="alg3.l17.m1.4.4.2.2.2.4.2.cmml"><mi id="alg3.l17.m1.4.4.2.2.2.4.2.2" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.4.2.2.cmml">D</mi><mtext id="alg3.l17.m1.4.4.2.2.2.4.2.3" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l17.m1.4.4.2.2.2.3" xref="alg3.l17.m1.4.4.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l17.m1.4.4.2.2.2.2.2" xref="alg3.l17.m1.4.4.2.2.2.2.3.cmml"><mo id="alg3.l17.m1.4.4.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.3.cmml">(</mo><msub id="alg3.l17.m1.3.3.1.1.1.1.1.1" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg3.l17.m1.3.3.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.2.cmml">y</mi><mrow id="alg3.l17.m1.3.3.1.1.1.1.1.1.3" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.1" mathsize="80%" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l17.m1.4.4.2.2.2.2.2.4" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.3.cmml">,</mo><msub id="alg3.l17.m1.4.4.2.2.2.2.2.2" xref="alg3.l17.m1.4.4.2.2.2.2.2.2.cmml"><mi id="alg3.l17.m1.4.4.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l17.m1.4.4.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l17.m1.4.4.2.2.2.2.2.5" mathsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.3.cmml">,</mo><mi id="alg3.l17.m1.1.1" mathsize="80%" xref="alg3.l17.m1.1.1.cmml">t</mi><mo id="alg3.l17.m1.4.4.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l17.m1.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l17.m1.6.6.4.5" mathsize="80%" xref="alg3.l17.m1.6.6.4.5.cmml">+</mo><mrow id="alg3.l17.m1.6.6.4.4" xref="alg3.l17.m1.6.6.4.4.cmml"><mrow id="alg3.l17.m1.6.6.4.4.4" xref="alg3.l17.m1.6.6.4.4.4.cmml"><mi id="alg3.l17.m1.6.6.4.4.4.1" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.4.1.cmml">log</mi><mo id="alg3.l17.m1.6.6.4.4.4a" lspace="0.167em" xref="alg3.l17.m1.6.6.4.4.4.cmml">⁡</mo><msub id="alg3.l17.m1.6.6.4.4.4.2" xref="alg3.l17.m1.6.6.4.4.4.2.cmml"><mi id="alg3.l17.m1.6.6.4.4.4.2.2" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.4.2.2.cmml">D</mi><mtext id="alg3.l17.m1.6.6.4.4.4.2.3" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l17.m1.6.6.4.4.3" xref="alg3.l17.m1.6.6.4.4.3.cmml">⁢</mo><mrow id="alg3.l17.m1.6.6.4.4.2.2" xref="alg3.l17.m1.6.6.4.4.2.3.cmml"><mo id="alg3.l17.m1.6.6.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l17.m1.6.6.4.4.2.3.cmml">(</mo><msubsup id="alg3.l17.m1.5.5.3.3.1.1.1" xref="alg3.l17.m1.5.5.3.3.1.1.1.cmml"><mi id="alg3.l17.m1.5.5.3.3.1.1.1.2.2" mathsize="80%" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l17.m1.5.5.3.3.1.1.1.2.3" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.cmml"><mi id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.2" mathsize="80%" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.1" mathsize="80%" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.3" mathsize="80%" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="alg3.l17.m1.5.5.3.3.1.1.1.3" mathsize="80%" xref="alg3.l17.m1.5.5.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l17.m1.6.6.4.4.2.2.4" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.2.3.cmml">,</mo><msub id="alg3.l17.m1.6.6.4.4.2.2.2" xref="alg3.l17.m1.6.6.4.4.2.2.2.cmml"><mi id="alg3.l17.m1.6.6.4.4.2.2.2.2" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.2.2.2.2.cmml">y</mi><mi id="alg3.l17.m1.6.6.4.4.2.2.2.3" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l17.m1.6.6.4.4.2.2.5" mathsize="80%" xref="alg3.l17.m1.6.6.4.4.2.3.cmml">,</mo><mi id="alg3.l17.m1.2.2" mathsize="80%" xref="alg3.l17.m1.2.2.cmml">t</mi><mo id="alg3.l17.m1.6.6.4.4.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l17.m1.6.6.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l17.m1.6b"><apply id="alg3.l17.m1.6.6.cmml" xref="alg3.l17.m1.6.6"><eq id="alg3.l17.m1.6.6.5.cmml" xref="alg3.l17.m1.6.6.5"></eq><apply id="alg3.l17.m1.6.6.6.cmml" xref="alg3.l17.m1.6.6.6"><csymbol cd="ambiguous" id="alg3.l17.m1.6.6.6.1.cmml" xref="alg3.l17.m1.6.6.6">subscript</csymbol><apply id="alg3.l17.m1.6.6.6.2.cmml" xref="alg3.l17.m1.6.6.6"><csymbol cd="ambiguous" id="alg3.l17.m1.6.6.6.2.1.cmml" xref="alg3.l17.m1.6.6.6">superscript</csymbol><ci id="alg3.l17.m1.6.6.6.2.2.cmml" xref="alg3.l17.m1.6.6.6.2.2">ℒ</ci><ci id="alg3.l17.m1.6.6.6.2.3.cmml" xref="alg3.l17.m1.6.6.6.2.3">𝐷</ci></apply><ci id="alg3.l17.m1.6.6.6.3a.cmml" xref="alg3.l17.m1.6.6.6.3"><mtext id="alg3.l17.m1.6.6.6.3.cmml" mathsize="56%" xref="alg3.l17.m1.6.6.6.3">sup</mtext></ci></apply><apply id="alg3.l17.m1.6.6.4.cmml" xref="alg3.l17.m1.6.6.4"><plus id="alg3.l17.m1.6.6.4.5.cmml" xref="alg3.l17.m1.6.6.4.5"></plus><apply id="alg3.l17.m1.4.4.2.2.cmml" xref="alg3.l17.m1.4.4.2.2"><minus id="alg3.l17.m1.4.4.2.2.3.cmml" xref="alg3.l17.m1.4.4.2.2"></minus><apply id="alg3.l17.m1.4.4.2.2.2.cmml" xref="alg3.l17.m1.4.4.2.2.2"><times id="alg3.l17.m1.4.4.2.2.2.3.cmml" xref="alg3.l17.m1.4.4.2.2.2.3"></times><apply id="alg3.l17.m1.4.4.2.2.2.4.cmml" xref="alg3.l17.m1.4.4.2.2.2.4"><log id="alg3.l17.m1.4.4.2.2.2.4.1.cmml" xref="alg3.l17.m1.4.4.2.2.2.4.1"></log><apply id="alg3.l17.m1.4.4.2.2.2.4.2.cmml" xref="alg3.l17.m1.4.4.2.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l17.m1.4.4.2.2.2.4.2.1.cmml" xref="alg3.l17.m1.4.4.2.2.2.4.2">subscript</csymbol><ci id="alg3.l17.m1.4.4.2.2.2.4.2.2.cmml" xref="alg3.l17.m1.4.4.2.2.2.4.2.2">𝐷</ci><ci id="alg3.l17.m1.4.4.2.2.2.4.2.3a.cmml" xref="alg3.l17.m1.4.4.2.2.2.4.2.3"><mtext id="alg3.l17.m1.4.4.2.2.2.4.2.3.cmml" mathsize="56%" xref="alg3.l17.m1.4.4.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l17.m1.4.4.2.2.2.2.3.cmml" xref="alg3.l17.m1.4.4.2.2.2.2.2"><apply id="alg3.l17.m1.3.3.1.1.1.1.1.1.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l17.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.2">𝑦</ci><apply id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3"><minus id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.1"></minus><ci id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l17.m1.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l17.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l17.m1.4.4.2.2.2.2.2.2.cmml" xref="alg3.l17.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l17.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg3.l17.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l17.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg3.l17.m1.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l17.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg3.l17.m1.4.4.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l17.m1.1.1.cmml" xref="alg3.l17.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg3.l17.m1.6.6.4.4.cmml" xref="alg3.l17.m1.6.6.4.4"><times id="alg3.l17.m1.6.6.4.4.3.cmml" xref="alg3.l17.m1.6.6.4.4.3"></times><apply id="alg3.l17.m1.6.6.4.4.4.cmml" xref="alg3.l17.m1.6.6.4.4.4"><log id="alg3.l17.m1.6.6.4.4.4.1.cmml" xref="alg3.l17.m1.6.6.4.4.4.1"></log><apply id="alg3.l17.m1.6.6.4.4.4.2.cmml" xref="alg3.l17.m1.6.6.4.4.4.2"><csymbol cd="ambiguous" id="alg3.l17.m1.6.6.4.4.4.2.1.cmml" xref="alg3.l17.m1.6.6.4.4.4.2">subscript</csymbol><ci id="alg3.l17.m1.6.6.4.4.4.2.2.cmml" xref="alg3.l17.m1.6.6.4.4.4.2.2">𝐷</ci><ci id="alg3.l17.m1.6.6.4.4.4.2.3a.cmml" xref="alg3.l17.m1.6.6.4.4.4.2.3"><mtext id="alg3.l17.m1.6.6.4.4.4.2.3.cmml" mathsize="56%" xref="alg3.l17.m1.6.6.4.4.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l17.m1.6.6.4.4.2.3.cmml" xref="alg3.l17.m1.6.6.4.4.2.2"><apply id="alg3.l17.m1.5.5.3.3.1.1.1.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l17.m1.5.5.3.3.1.1.1.1.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1">superscript</csymbol><apply id="alg3.l17.m1.5.5.3.3.1.1.1.2.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l17.m1.5.5.3.3.1.1.1.2.1.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1">subscript</csymbol><ci id="alg3.l17.m1.5.5.3.3.1.1.1.2.2.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.2">𝑦</ci><apply id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3"><minus id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.1.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.1"></minus><ci id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.2.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l17.m1.5.5.3.3.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l17.m1.5.5.3.3.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg3.l17.m1.5.5.3.3.1.1.1.3.cmml" xref="alg3.l17.m1.5.5.3.3.1.1.1.3">′</ci></apply><apply id="alg3.l17.m1.6.6.4.4.2.2.2.cmml" xref="alg3.l17.m1.6.6.4.4.2.2.2"><csymbol cd="ambiguous" id="alg3.l17.m1.6.6.4.4.2.2.2.1.cmml" xref="alg3.l17.m1.6.6.4.4.2.2.2">subscript</csymbol><ci id="alg3.l17.m1.6.6.4.4.2.2.2.2.cmml" xref="alg3.l17.m1.6.6.4.4.2.2.2.2">𝑦</ci><ci id="alg3.l17.m1.6.6.4.4.2.2.2.3.cmml" xref="alg3.l17.m1.6.6.4.4.2.2.2.3">𝑡</ci></apply><ci id="alg3.l17.m1.2.2.cmml" xref="alg3.l17.m1.2.2">𝑡</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l17.m1.6c">\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t)</annotation><annotation encoding="application/x-llamapun" id="alg3.l17.m1.6d">caligraphic_L start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg3.l17.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text" id="alg3.l18.2" style="font-size:80%;">        </span><math alttext="\text{Minimize}~{}\mathcal{L}^{G}_{\text{sup}},~{}\text{Minimize}~{}\mathcal{L%
}^{D}_{\text{sup}}" class="ltx_Math" display="inline" id="alg3.l18.m1.2"><semantics id="alg3.l18.m1.2a"><mrow id="alg3.l18.m1.2.2.2" xref="alg3.l18.m1.2.2.3.cmml"><mrow id="alg3.l18.m1.1.1.1.1" xref="alg3.l18.m1.1.1.1.1.cmml"><mtext id="alg3.l18.m1.1.1.1.1.2" mathsize="80%" xref="alg3.l18.m1.1.1.1.1.2a.cmml">Minimize</mtext><mo id="alg3.l18.m1.1.1.1.1.1" lspace="0.270em" xref="alg3.l18.m1.1.1.1.1.1.cmml">⁢</mo><msubsup id="alg3.l18.m1.1.1.1.1.3" xref="alg3.l18.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.m1.1.1.1.1.3.2.2" mathsize="80%" xref="alg3.l18.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="alg3.l18.m1.1.1.1.1.3.3" mathsize="80%" xref="alg3.l18.m1.1.1.1.1.3.3a.cmml">sup</mtext><mi id="alg3.l18.m1.1.1.1.1.3.2.3" mathsize="80%" xref="alg3.l18.m1.1.1.1.1.3.2.3.cmml">G</mi></msubsup></mrow><mo id="alg3.l18.m1.2.2.2.3" mathsize="80%" rspace="0.437em" xref="alg3.l18.m1.2.2.3.cmml">,</mo><mrow id="alg3.l18.m1.2.2.2.2" xref="alg3.l18.m1.2.2.2.2.cmml"><mtext id="alg3.l18.m1.2.2.2.2.2" mathsize="80%" xref="alg3.l18.m1.2.2.2.2.2a.cmml">Minimize</mtext><mo id="alg3.l18.m1.2.2.2.2.1" lspace="0.270em" xref="alg3.l18.m1.2.2.2.2.1.cmml">⁢</mo><msubsup id="alg3.l18.m1.2.2.2.2.3" xref="alg3.l18.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.m1.2.2.2.2.3.2.2" mathsize="80%" xref="alg3.l18.m1.2.2.2.2.3.2.2.cmml">ℒ</mi><mtext id="alg3.l18.m1.2.2.2.2.3.3" mathsize="80%" xref="alg3.l18.m1.2.2.2.2.3.3a.cmml">sup</mtext><mi id="alg3.l18.m1.2.2.2.2.3.2.3" mathsize="80%" xref="alg3.l18.m1.2.2.2.2.3.2.3.cmml">D</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l18.m1.2b"><list id="alg3.l18.m1.2.2.3.cmml" xref="alg3.l18.m1.2.2.2"><apply id="alg3.l18.m1.1.1.1.1.cmml" xref="alg3.l18.m1.1.1.1.1"><times id="alg3.l18.m1.1.1.1.1.1.cmml" xref="alg3.l18.m1.1.1.1.1.1"></times><ci id="alg3.l18.m1.1.1.1.1.2a.cmml" xref="alg3.l18.m1.1.1.1.1.2"><mtext id="alg3.l18.m1.1.1.1.1.2.cmml" mathsize="80%" xref="alg3.l18.m1.1.1.1.1.2">Minimize</mtext></ci><apply id="alg3.l18.m1.1.1.1.1.3.cmml" xref="alg3.l18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l18.m1.1.1.1.1.3.1.cmml" xref="alg3.l18.m1.1.1.1.1.3">subscript</csymbol><apply id="alg3.l18.m1.1.1.1.1.3.2.cmml" xref="alg3.l18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l18.m1.1.1.1.1.3.2.1.cmml" xref="alg3.l18.m1.1.1.1.1.3">superscript</csymbol><ci id="alg3.l18.m1.1.1.1.1.3.2.2.cmml" xref="alg3.l18.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="alg3.l18.m1.1.1.1.1.3.2.3.cmml" xref="alg3.l18.m1.1.1.1.1.3.2.3">𝐺</ci></apply><ci id="alg3.l18.m1.1.1.1.1.3.3a.cmml" xref="alg3.l18.m1.1.1.1.1.3.3"><mtext id="alg3.l18.m1.1.1.1.1.3.3.cmml" mathsize="56%" xref="alg3.l18.m1.1.1.1.1.3.3">sup</mtext></ci></apply></apply><apply id="alg3.l18.m1.2.2.2.2.cmml" xref="alg3.l18.m1.2.2.2.2"><times id="alg3.l18.m1.2.2.2.2.1.cmml" xref="alg3.l18.m1.2.2.2.2.1"></times><ci id="alg3.l18.m1.2.2.2.2.2a.cmml" xref="alg3.l18.m1.2.2.2.2.2"><mtext id="alg3.l18.m1.2.2.2.2.2.cmml" mathsize="80%" xref="alg3.l18.m1.2.2.2.2.2">Minimize</mtext></ci><apply id="alg3.l18.m1.2.2.2.2.3.cmml" xref="alg3.l18.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l18.m1.2.2.2.2.3.1.cmml" xref="alg3.l18.m1.2.2.2.2.3">subscript</csymbol><apply id="alg3.l18.m1.2.2.2.2.3.2.cmml" xref="alg3.l18.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l18.m1.2.2.2.2.3.2.1.cmml" xref="alg3.l18.m1.2.2.2.2.3">superscript</csymbol><ci id="alg3.l18.m1.2.2.2.2.3.2.2.cmml" xref="alg3.l18.m1.2.2.2.2.3.2.2">ℒ</ci><ci id="alg3.l18.m1.2.2.2.2.3.2.3.cmml" xref="alg3.l18.m1.2.2.2.2.3.2.3">𝐷</ci></apply><ci id="alg3.l18.m1.2.2.2.2.3.3a.cmml" xref="alg3.l18.m1.2.2.2.2.3.3"><mtext id="alg3.l18.m1.2.2.2.2.3.3.cmml" mathsize="56%" xref="alg3.l18.m1.2.2.2.2.3.3">sup</mtext></ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.m1.2c">\text{Minimize}~{}\mathcal{L}^{G}_{\text{sup}},~{}\text{Minimize}~{}\mathcal{L%
}^{D}_{\text{sup}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l18.m1.2d">Minimize caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT , Minimize caligraphic_L start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg3.l18.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text" id="alg3.l19.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg3.l19.3" style="font-size:80%;">else</span>
</div>
<div class="ltx_listingline" id="alg3.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l20.1.1.1" style="font-size:80%;">20:</span></span><span class="ltx_text" id="alg3.l20.2" style="font-size:80%;">        </span><math alttext="{y}^{t}_{c}=\text{Reverse}_{t}(y_{t},x_{0}),{y}^{s}_{c}=\text{Reverse}_{s}(y_{%
t},x_{0})" class="ltx_Math" display="inline" id="alg3.l20.m1.2"><semantics id="alg3.l20.m1.2a"><mrow id="alg3.l20.m1.2.2.2" xref="alg3.l20.m1.2.2.3.cmml"><mrow id="alg3.l20.m1.1.1.1.1" xref="alg3.l20.m1.1.1.1.1.cmml"><msubsup id="alg3.l20.m1.1.1.1.1.4" xref="alg3.l20.m1.1.1.1.1.4.cmml"><mi id="alg3.l20.m1.1.1.1.1.4.2.2" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.4.2.2.cmml">y</mi><mi id="alg3.l20.m1.1.1.1.1.4.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.4.3.cmml">c</mi><mi id="alg3.l20.m1.1.1.1.1.4.2.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.4.2.3.cmml">t</mi></msubsup><mo id="alg3.l20.m1.1.1.1.1.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.3.cmml">=</mo><mrow id="alg3.l20.m1.1.1.1.1.2" xref="alg3.l20.m1.1.1.1.1.2.cmml"><msub id="alg3.l20.m1.1.1.1.1.2.4" xref="alg3.l20.m1.1.1.1.1.2.4.cmml"><mtext id="alg3.l20.m1.1.1.1.1.2.4.2" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.4.2a.cmml">Reverse</mtext><mi id="alg3.l20.m1.1.1.1.1.2.4.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo id="alg3.l20.m1.1.1.1.1.2.3" xref="alg3.l20.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg3.l20.m1.1.1.1.1.2.2.2" xref="alg3.l20.m1.1.1.1.1.2.2.3.cmml"><mo id="alg3.l20.m1.1.1.1.1.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l20.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="alg3.l20.m1.1.1.1.1.1.1.1.1" xref="alg3.l20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg3.l20.m1.1.1.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg3.l20.m1.1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l20.m1.1.1.1.1.2.2.2.4" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg3.l20.m1.1.1.1.1.2.2.2.2" xref="alg3.l20.m1.1.1.1.1.2.2.2.2.cmml"><mi id="alg3.l20.m1.1.1.1.1.2.2.2.2.2" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mn id="alg3.l20.m1.1.1.1.1.2.2.2.2.3" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.2.2.2.3.cmml">0</mn></msub><mo id="alg3.l20.m1.1.1.1.1.2.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l20.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l20.m1.2.2.2.3" mathsize="80%" xref="alg3.l20.m1.2.2.3a.cmml">,</mo><mrow id="alg3.l20.m1.2.2.2.2" xref="alg3.l20.m1.2.2.2.2.cmml"><msubsup id="alg3.l20.m1.2.2.2.2.4" xref="alg3.l20.m1.2.2.2.2.4.cmml"><mi id="alg3.l20.m1.2.2.2.2.4.2.2" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.4.2.2.cmml">y</mi><mi id="alg3.l20.m1.2.2.2.2.4.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.4.3.cmml">c</mi><mi id="alg3.l20.m1.2.2.2.2.4.2.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.4.2.3.cmml">s</mi></msubsup><mo id="alg3.l20.m1.2.2.2.2.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.3.cmml">=</mo><mrow id="alg3.l20.m1.2.2.2.2.2" xref="alg3.l20.m1.2.2.2.2.2.cmml"><msub id="alg3.l20.m1.2.2.2.2.2.4" xref="alg3.l20.m1.2.2.2.2.2.4.cmml"><mtext id="alg3.l20.m1.2.2.2.2.2.4.2" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.4.2a.cmml">Reverse</mtext><mi id="alg3.l20.m1.2.2.2.2.2.4.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.4.3.cmml">s</mi></msub><mo id="alg3.l20.m1.2.2.2.2.2.3" xref="alg3.l20.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l20.m1.2.2.2.2.2.2.2" xref="alg3.l20.m1.2.2.2.2.2.2.3.cmml"><mo id="alg3.l20.m1.2.2.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l20.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="alg3.l20.m1.2.2.2.2.1.1.1.1" xref="alg3.l20.m1.2.2.2.2.1.1.1.1.cmml"><mi id="alg3.l20.m1.2.2.2.2.1.1.1.1.2" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.1.1.1.1.2.cmml">y</mi><mi id="alg3.l20.m1.2.2.2.2.1.1.1.1.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l20.m1.2.2.2.2.2.2.2.4" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="alg3.l20.m1.2.2.2.2.2.2.2.2" xref="alg3.l20.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg3.l20.m1.2.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.2.2.2.2.cmml">x</mi><mn id="alg3.l20.m1.2.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="alg3.l20.m1.2.2.2.2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l20.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l20.m1.2b"><apply id="alg3.l20.m1.2.2.3.cmml" xref="alg3.l20.m1.2.2.2"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.3a.cmml" xref="alg3.l20.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg3.l20.m1.1.1.1.1.cmml" xref="alg3.l20.m1.1.1.1.1"><eq id="alg3.l20.m1.1.1.1.1.3.cmml" xref="alg3.l20.m1.1.1.1.1.3"></eq><apply id="alg3.l20.m1.1.1.1.1.4.cmml" xref="alg3.l20.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg3.l20.m1.1.1.1.1.4.1.cmml" xref="alg3.l20.m1.1.1.1.1.4">subscript</csymbol><apply id="alg3.l20.m1.1.1.1.1.4.2.cmml" xref="alg3.l20.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg3.l20.m1.1.1.1.1.4.2.1.cmml" xref="alg3.l20.m1.1.1.1.1.4">superscript</csymbol><ci id="alg3.l20.m1.1.1.1.1.4.2.2.cmml" xref="alg3.l20.m1.1.1.1.1.4.2.2">𝑦</ci><ci id="alg3.l20.m1.1.1.1.1.4.2.3.cmml" xref="alg3.l20.m1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="alg3.l20.m1.1.1.1.1.4.3.cmml" xref="alg3.l20.m1.1.1.1.1.4.3">𝑐</ci></apply><apply id="alg3.l20.m1.1.1.1.1.2.cmml" xref="alg3.l20.m1.1.1.1.1.2"><times id="alg3.l20.m1.1.1.1.1.2.3.cmml" xref="alg3.l20.m1.1.1.1.1.2.3"></times><apply id="alg3.l20.m1.1.1.1.1.2.4.cmml" xref="alg3.l20.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg3.l20.m1.1.1.1.1.2.4.1.cmml" xref="alg3.l20.m1.1.1.1.1.2.4">subscript</csymbol><ci id="alg3.l20.m1.1.1.1.1.2.4.2a.cmml" xref="alg3.l20.m1.1.1.1.1.2.4.2"><mtext id="alg3.l20.m1.1.1.1.1.2.4.2.cmml" mathsize="80%" xref="alg3.l20.m1.1.1.1.1.2.4.2">Reverse</mtext></ci><ci id="alg3.l20.m1.1.1.1.1.2.4.3.cmml" xref="alg3.l20.m1.1.1.1.1.2.4.3">𝑡</ci></apply><interval closure="open" id="alg3.l20.m1.1.1.1.1.2.2.3.cmml" xref="alg3.l20.m1.1.1.1.1.2.2.2"><apply id="alg3.l20.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l20.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l20.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg3.l20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l20.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg3.l20.m1.1.1.1.1.2.2.2.2.cmml" xref="alg3.l20.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l20.m1.1.1.1.1.2.2.2.2.1.cmml" xref="alg3.l20.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="alg3.l20.m1.1.1.1.1.2.2.2.2.2.cmml" xref="alg3.l20.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><cn id="alg3.l20.m1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="alg3.l20.m1.1.1.1.1.2.2.2.2.3">0</cn></apply></interval></apply></apply><apply id="alg3.l20.m1.2.2.2.2.cmml" xref="alg3.l20.m1.2.2.2.2"><eq id="alg3.l20.m1.2.2.2.2.3.cmml" xref="alg3.l20.m1.2.2.2.2.3"></eq><apply id="alg3.l20.m1.2.2.2.2.4.cmml" xref="alg3.l20.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.2.2.4.1.cmml" xref="alg3.l20.m1.2.2.2.2.4">subscript</csymbol><apply id="alg3.l20.m1.2.2.2.2.4.2.cmml" xref="alg3.l20.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.2.2.4.2.1.cmml" xref="alg3.l20.m1.2.2.2.2.4">superscript</csymbol><ci id="alg3.l20.m1.2.2.2.2.4.2.2.cmml" xref="alg3.l20.m1.2.2.2.2.4.2.2">𝑦</ci><ci id="alg3.l20.m1.2.2.2.2.4.2.3.cmml" xref="alg3.l20.m1.2.2.2.2.4.2.3">𝑠</ci></apply><ci id="alg3.l20.m1.2.2.2.2.4.3.cmml" xref="alg3.l20.m1.2.2.2.2.4.3">𝑐</ci></apply><apply id="alg3.l20.m1.2.2.2.2.2.cmml" xref="alg3.l20.m1.2.2.2.2.2"><times id="alg3.l20.m1.2.2.2.2.2.3.cmml" xref="alg3.l20.m1.2.2.2.2.2.3"></times><apply id="alg3.l20.m1.2.2.2.2.2.4.cmml" xref="alg3.l20.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.2.2.2.4.1.cmml" xref="alg3.l20.m1.2.2.2.2.2.4">subscript</csymbol><ci id="alg3.l20.m1.2.2.2.2.2.4.2a.cmml" xref="alg3.l20.m1.2.2.2.2.2.4.2"><mtext id="alg3.l20.m1.2.2.2.2.2.4.2.cmml" mathsize="80%" xref="alg3.l20.m1.2.2.2.2.2.4.2">Reverse</mtext></ci><ci id="alg3.l20.m1.2.2.2.2.2.4.3.cmml" xref="alg3.l20.m1.2.2.2.2.2.4.3">𝑠</ci></apply><interval closure="open" id="alg3.l20.m1.2.2.2.2.2.2.3.cmml" xref="alg3.l20.m1.2.2.2.2.2.2.2"><apply id="alg3.l20.m1.2.2.2.2.1.1.1.1.cmml" xref="alg3.l20.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.2.2.1.1.1.1.1.cmml" xref="alg3.l20.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg3.l20.m1.2.2.2.2.1.1.1.1.2.cmml" xref="alg3.l20.m1.2.2.2.2.1.1.1.1.2">𝑦</ci><ci id="alg3.l20.m1.2.2.2.2.1.1.1.1.3.cmml" xref="alg3.l20.m1.2.2.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="alg3.l20.m1.2.2.2.2.2.2.2.2.cmml" xref="alg3.l20.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l20.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg3.l20.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l20.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg3.l20.m1.2.2.2.2.2.2.2.2.2">𝑥</ci><cn id="alg3.l20.m1.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="alg3.l20.m1.2.2.2.2.2.2.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l20.m1.2c">{y}^{t}_{c}=\text{Reverse}_{t}(y_{t},x_{0}),{y}^{s}_{c}=\text{Reverse}_{s}(y_{%
t},x_{0})</annotation><annotation encoding="application/x-llamapun" id="alg3.l20.m1.2d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Reverse start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Reverse start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l20.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l21.1.1.1" style="font-size:80%;">21:</span></span><span class="ltx_text" id="alg3.l21.2" style="font-size:80%;">        </span><math alttext="y^{r}_{c}=\text{Optimal}(y_{c},{y}^{t}_{c},{y}^{s}_{c})" class="ltx_Math" display="inline" id="alg3.l21.m1.3"><semantics id="alg3.l21.m1.3a"><mrow id="alg3.l21.m1.3.3" xref="alg3.l21.m1.3.3.cmml"><msubsup id="alg3.l21.m1.3.3.5" xref="alg3.l21.m1.3.3.5.cmml"><mi id="alg3.l21.m1.3.3.5.2.2" mathsize="80%" xref="alg3.l21.m1.3.3.5.2.2.cmml">y</mi><mi id="alg3.l21.m1.3.3.5.3" mathsize="80%" xref="alg3.l21.m1.3.3.5.3.cmml">c</mi><mi id="alg3.l21.m1.3.3.5.2.3" mathsize="80%" xref="alg3.l21.m1.3.3.5.2.3.cmml">r</mi></msubsup><mo id="alg3.l21.m1.3.3.4" mathsize="80%" xref="alg3.l21.m1.3.3.4.cmml">=</mo><mrow id="alg3.l21.m1.3.3.3" xref="alg3.l21.m1.3.3.3.cmml"><mtext id="alg3.l21.m1.3.3.3.5" mathsize="80%" xref="alg3.l21.m1.3.3.3.5a.cmml">Optimal</mtext><mo id="alg3.l21.m1.3.3.3.4" xref="alg3.l21.m1.3.3.3.4.cmml">⁢</mo><mrow id="alg3.l21.m1.3.3.3.3.3" xref="alg3.l21.m1.3.3.3.3.4.cmml"><mo id="alg3.l21.m1.3.3.3.3.3.4" maxsize="80%" minsize="80%" xref="alg3.l21.m1.3.3.3.3.4.cmml">(</mo><msub id="alg3.l21.m1.1.1.1.1.1.1" xref="alg3.l21.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l21.m1.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l21.m1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg3.l21.m1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l21.m1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="alg3.l21.m1.3.3.3.3.3.5" mathsize="80%" xref="alg3.l21.m1.3.3.3.3.4.cmml">,</mo><msubsup id="alg3.l21.m1.2.2.2.2.2.2" xref="alg3.l21.m1.2.2.2.2.2.2.cmml"><mi id="alg3.l21.m1.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l21.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l21.m1.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l21.m1.2.2.2.2.2.2.3.cmml">c</mi><mi id="alg3.l21.m1.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l21.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg3.l21.m1.3.3.3.3.3.6" mathsize="80%" xref="alg3.l21.m1.3.3.3.3.4.cmml">,</mo><msubsup id="alg3.l21.m1.3.3.3.3.3.3" xref="alg3.l21.m1.3.3.3.3.3.3.cmml"><mi id="alg3.l21.m1.3.3.3.3.3.3.2.2" mathsize="80%" xref="alg3.l21.m1.3.3.3.3.3.3.2.2.cmml">y</mi><mi id="alg3.l21.m1.3.3.3.3.3.3.3" mathsize="80%" xref="alg3.l21.m1.3.3.3.3.3.3.3.cmml">c</mi><mi id="alg3.l21.m1.3.3.3.3.3.3.2.3" mathsize="80%" xref="alg3.l21.m1.3.3.3.3.3.3.2.3.cmml">s</mi></msubsup><mo id="alg3.l21.m1.3.3.3.3.3.7" maxsize="80%" minsize="80%" xref="alg3.l21.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l21.m1.3b"><apply id="alg3.l21.m1.3.3.cmml" xref="alg3.l21.m1.3.3"><eq id="alg3.l21.m1.3.3.4.cmml" xref="alg3.l21.m1.3.3.4"></eq><apply id="alg3.l21.m1.3.3.5.cmml" xref="alg3.l21.m1.3.3.5"><csymbol cd="ambiguous" id="alg3.l21.m1.3.3.5.1.cmml" xref="alg3.l21.m1.3.3.5">subscript</csymbol><apply id="alg3.l21.m1.3.3.5.2.cmml" xref="alg3.l21.m1.3.3.5"><csymbol cd="ambiguous" id="alg3.l21.m1.3.3.5.2.1.cmml" xref="alg3.l21.m1.3.3.5">superscript</csymbol><ci id="alg3.l21.m1.3.3.5.2.2.cmml" xref="alg3.l21.m1.3.3.5.2.2">𝑦</ci><ci id="alg3.l21.m1.3.3.5.2.3.cmml" xref="alg3.l21.m1.3.3.5.2.3">𝑟</ci></apply><ci id="alg3.l21.m1.3.3.5.3.cmml" xref="alg3.l21.m1.3.3.5.3">𝑐</ci></apply><apply id="alg3.l21.m1.3.3.3.cmml" xref="alg3.l21.m1.3.3.3"><times id="alg3.l21.m1.3.3.3.4.cmml" xref="alg3.l21.m1.3.3.3.4"></times><ci id="alg3.l21.m1.3.3.3.5a.cmml" xref="alg3.l21.m1.3.3.3.5"><mtext id="alg3.l21.m1.3.3.3.5.cmml" mathsize="80%" xref="alg3.l21.m1.3.3.3.5">Optimal</mtext></ci><vector id="alg3.l21.m1.3.3.3.3.4.cmml" xref="alg3.l21.m1.3.3.3.3.3"><apply id="alg3.l21.m1.1.1.1.1.1.1.cmml" xref="alg3.l21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l21.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l21.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l21.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l21.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg3.l21.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l21.m1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="alg3.l21.m1.2.2.2.2.2.2.cmml" xref="alg3.l21.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l21.m1.2.2.2.2.2.2.1.cmml" xref="alg3.l21.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg3.l21.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l21.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l21.m1.2.2.2.2.2.2.2.1.cmml" xref="alg3.l21.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg3.l21.m1.2.2.2.2.2.2.2.2.cmml" xref="alg3.l21.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l21.m1.2.2.2.2.2.2.2.3.cmml" xref="alg3.l21.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l21.m1.2.2.2.2.2.2.3.cmml" xref="alg3.l21.m1.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg3.l21.m1.3.3.3.3.3.3.cmml" xref="alg3.l21.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg3.l21.m1.3.3.3.3.3.3.1.cmml" xref="alg3.l21.m1.3.3.3.3.3.3">subscript</csymbol><apply id="alg3.l21.m1.3.3.3.3.3.3.2.cmml" xref="alg3.l21.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg3.l21.m1.3.3.3.3.3.3.2.1.cmml" xref="alg3.l21.m1.3.3.3.3.3.3">superscript</csymbol><ci id="alg3.l21.m1.3.3.3.3.3.3.2.2.cmml" xref="alg3.l21.m1.3.3.3.3.3.3.2.2">𝑦</ci><ci id="alg3.l21.m1.3.3.3.3.3.3.2.3.cmml" xref="alg3.l21.m1.3.3.3.3.3.3.2.3">𝑠</ci></apply><ci id="alg3.l21.m1.3.3.3.3.3.3.3.cmml" xref="alg3.l21.m1.3.3.3.3.3.3.3">𝑐</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l21.m1.3c">y^{r}_{c}=\text{Optimal}(y_{c},{y}^{t}_{c},{y}^{s}_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l21.m1.3d">italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = Optimal ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l21.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l22.1.1.1" style="font-size:80%;">22:</span></span><span class="ltx_text" id="alg3.l22.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}^{G}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+\mathcal{L}_{1%
}({y}_{0}^{\prime},y_{0})" class="ltx_Math" display="inline" id="alg3.l22.m1.5"><semantics id="alg3.l22.m1.5a"><mrow id="alg3.l22.m1.5.5" xref="alg3.l22.m1.5.5.cmml"><msup id="alg3.l22.m1.5.5.6" xref="alg3.l22.m1.5.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l22.m1.5.5.6.2" mathsize="80%" xref="alg3.l22.m1.5.5.6.2.cmml">ℒ</mi><mi id="alg3.l22.m1.5.5.6.3" mathsize="80%" xref="alg3.l22.m1.5.5.6.3.cmml">G</mi></msup><mo id="alg3.l22.m1.5.5.5" mathsize="80%" xref="alg3.l22.m1.5.5.5.cmml">=</mo><mrow id="alg3.l22.m1.5.5.4" xref="alg3.l22.m1.5.5.4.cmml"><mrow id="alg3.l22.m1.3.3.2.2" xref="alg3.l22.m1.3.3.2.2.cmml"><mo id="alg3.l22.m1.3.3.2.2a" mathsize="80%" rspace="0.167em" xref="alg3.l22.m1.3.3.2.2.cmml">−</mo><mrow id="alg3.l22.m1.3.3.2.2.2" xref="alg3.l22.m1.3.3.2.2.2.cmml"><mrow id="alg3.l22.m1.3.3.2.2.2.4" xref="alg3.l22.m1.3.3.2.2.2.4.cmml"><mi id="alg3.l22.m1.3.3.2.2.2.4.1" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.4.1.cmml">log</mi><mo id="alg3.l22.m1.3.3.2.2.2.4a" lspace="0.167em" xref="alg3.l22.m1.3.3.2.2.2.4.cmml">⁡</mo><msub id="alg3.l22.m1.3.3.2.2.2.4.2" xref="alg3.l22.m1.3.3.2.2.2.4.2.cmml"><mi id="alg3.l22.m1.3.3.2.2.2.4.2.2" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.4.2.2.cmml">D</mi><mtext id="alg3.l22.m1.3.3.2.2.2.4.2.3" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l22.m1.3.3.2.2.2.3" xref="alg3.l22.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l22.m1.3.3.2.2.2.2.2" xref="alg3.l22.m1.3.3.2.2.2.2.3.cmml"><mo id="alg3.l22.m1.3.3.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.3.cmml">(</mo><msubsup id="alg3.l22.m1.2.2.1.1.1.1.1.1" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.cmml"><mi id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.2" mathsize="80%" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.1" mathsize="80%" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.3" mathsize="80%" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="alg3.l22.m1.2.2.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l22.m1.3.3.2.2.2.2.2.4" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.3.cmml">,</mo><msub id="alg3.l22.m1.3.3.2.2.2.2.2.2" xref="alg3.l22.m1.3.3.2.2.2.2.2.2.cmml"><mi id="alg3.l22.m1.3.3.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l22.m1.3.3.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l22.m1.3.3.2.2.2.2.2.5" mathsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.3.cmml">,</mo><mi id="alg3.l22.m1.1.1" mathsize="80%" xref="alg3.l22.m1.1.1.cmml">t</mi><mo id="alg3.l22.m1.3.3.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l22.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l22.m1.5.5.4.5" mathsize="80%" xref="alg3.l22.m1.5.5.4.5.cmml">+</mo><mrow id="alg3.l22.m1.5.5.4.4" xref="alg3.l22.m1.5.5.4.4.cmml"><msub id="alg3.l22.m1.5.5.4.4.4" xref="alg3.l22.m1.5.5.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l22.m1.5.5.4.4.4.2" mathsize="80%" xref="alg3.l22.m1.5.5.4.4.4.2.cmml">ℒ</mi><mn id="alg3.l22.m1.5.5.4.4.4.3" mathsize="80%" xref="alg3.l22.m1.5.5.4.4.4.3.cmml">1</mn></msub><mo id="alg3.l22.m1.5.5.4.4.3" xref="alg3.l22.m1.5.5.4.4.3.cmml">⁢</mo><mrow id="alg3.l22.m1.5.5.4.4.2.2" xref="alg3.l22.m1.5.5.4.4.2.3.cmml"><mo id="alg3.l22.m1.5.5.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l22.m1.5.5.4.4.2.3.cmml">(</mo><msubsup id="alg3.l22.m1.4.4.3.3.1.1.1" xref="alg3.l22.m1.4.4.3.3.1.1.1.cmml"><mi id="alg3.l22.m1.4.4.3.3.1.1.1.2.2" mathsize="80%" xref="alg3.l22.m1.4.4.3.3.1.1.1.2.2.cmml">y</mi><mn id="alg3.l22.m1.4.4.3.3.1.1.1.2.3" mathsize="80%" xref="alg3.l22.m1.4.4.3.3.1.1.1.2.3.cmml">0</mn><mo id="alg3.l22.m1.4.4.3.3.1.1.1.3" mathsize="80%" xref="alg3.l22.m1.4.4.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l22.m1.5.5.4.4.2.2.4" mathsize="80%" xref="alg3.l22.m1.5.5.4.4.2.3.cmml">,</mo><msub id="alg3.l22.m1.5.5.4.4.2.2.2" xref="alg3.l22.m1.5.5.4.4.2.2.2.cmml"><mi id="alg3.l22.m1.5.5.4.4.2.2.2.2" mathsize="80%" xref="alg3.l22.m1.5.5.4.4.2.2.2.2.cmml">y</mi><mn id="alg3.l22.m1.5.5.4.4.2.2.2.3" mathsize="80%" xref="alg3.l22.m1.5.5.4.4.2.2.2.3.cmml">0</mn></msub><mo id="alg3.l22.m1.5.5.4.4.2.2.5" maxsize="80%" minsize="80%" xref="alg3.l22.m1.5.5.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l22.m1.5b"><apply id="alg3.l22.m1.5.5.cmml" xref="alg3.l22.m1.5.5"><eq id="alg3.l22.m1.5.5.5.cmml" xref="alg3.l22.m1.5.5.5"></eq><apply id="alg3.l22.m1.5.5.6.cmml" xref="alg3.l22.m1.5.5.6"><csymbol cd="ambiguous" id="alg3.l22.m1.5.5.6.1.cmml" xref="alg3.l22.m1.5.5.6">superscript</csymbol><ci id="alg3.l22.m1.5.5.6.2.cmml" xref="alg3.l22.m1.5.5.6.2">ℒ</ci><ci id="alg3.l22.m1.5.5.6.3.cmml" xref="alg3.l22.m1.5.5.6.3">𝐺</ci></apply><apply id="alg3.l22.m1.5.5.4.cmml" xref="alg3.l22.m1.5.5.4"><plus id="alg3.l22.m1.5.5.4.5.cmml" xref="alg3.l22.m1.5.5.4.5"></plus><apply id="alg3.l22.m1.3.3.2.2.cmml" xref="alg3.l22.m1.3.3.2.2"><minus id="alg3.l22.m1.3.3.2.2.3.cmml" xref="alg3.l22.m1.3.3.2.2"></minus><apply id="alg3.l22.m1.3.3.2.2.2.cmml" xref="alg3.l22.m1.3.3.2.2.2"><times id="alg3.l22.m1.3.3.2.2.2.3.cmml" xref="alg3.l22.m1.3.3.2.2.2.3"></times><apply id="alg3.l22.m1.3.3.2.2.2.4.cmml" xref="alg3.l22.m1.3.3.2.2.2.4"><log id="alg3.l22.m1.3.3.2.2.2.4.1.cmml" xref="alg3.l22.m1.3.3.2.2.2.4.1"></log><apply id="alg3.l22.m1.3.3.2.2.2.4.2.cmml" xref="alg3.l22.m1.3.3.2.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l22.m1.3.3.2.2.2.4.2.1.cmml" xref="alg3.l22.m1.3.3.2.2.2.4.2">subscript</csymbol><ci id="alg3.l22.m1.3.3.2.2.2.4.2.2.cmml" xref="alg3.l22.m1.3.3.2.2.2.4.2.2">𝐷</ci><ci id="alg3.l22.m1.3.3.2.2.2.4.2.3a.cmml" xref="alg3.l22.m1.3.3.2.2.2.4.2.3"><mtext id="alg3.l22.m1.3.3.2.2.2.4.2.3.cmml" mathsize="56%" xref="alg3.l22.m1.3.3.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l22.m1.3.3.2.2.2.2.3.cmml" xref="alg3.l22.m1.3.3.2.2.2.2.2"><apply id="alg3.l22.m1.2.2.1.1.1.1.1.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci><apply id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3"><minus id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.1"></minus><ci id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg3.l22.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg3.l22.m1.2.2.1.1.1.1.1.1.3">′</ci></apply><apply id="alg3.l22.m1.3.3.2.2.2.2.2.2.cmml" xref="alg3.l22.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l22.m1.3.3.2.2.2.2.2.2.1.cmml" xref="alg3.l22.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l22.m1.3.3.2.2.2.2.2.2.2.cmml" xref="alg3.l22.m1.3.3.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l22.m1.3.3.2.2.2.2.2.2.3.cmml" xref="alg3.l22.m1.3.3.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l22.m1.1.1.cmml" xref="alg3.l22.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg3.l22.m1.5.5.4.4.cmml" xref="alg3.l22.m1.5.5.4.4"><times id="alg3.l22.m1.5.5.4.4.3.cmml" xref="alg3.l22.m1.5.5.4.4.3"></times><apply id="alg3.l22.m1.5.5.4.4.4.cmml" xref="alg3.l22.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="alg3.l22.m1.5.5.4.4.4.1.cmml" xref="alg3.l22.m1.5.5.4.4.4">subscript</csymbol><ci id="alg3.l22.m1.5.5.4.4.4.2.cmml" xref="alg3.l22.m1.5.5.4.4.4.2">ℒ</ci><cn id="alg3.l22.m1.5.5.4.4.4.3.cmml" type="integer" xref="alg3.l22.m1.5.5.4.4.4.3">1</cn></apply><interval closure="open" id="alg3.l22.m1.5.5.4.4.2.3.cmml" xref="alg3.l22.m1.5.5.4.4.2.2"><apply id="alg3.l22.m1.4.4.3.3.1.1.1.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.4.4.3.3.1.1.1.1.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1">superscript</csymbol><apply id="alg3.l22.m1.4.4.3.3.1.1.1.2.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.m1.4.4.3.3.1.1.1.2.1.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1">subscript</csymbol><ci id="alg3.l22.m1.4.4.3.3.1.1.1.2.2.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1.2.2">𝑦</ci><cn id="alg3.l22.m1.4.4.3.3.1.1.1.2.3.cmml" type="integer" xref="alg3.l22.m1.4.4.3.3.1.1.1.2.3">0</cn></apply><ci id="alg3.l22.m1.4.4.3.3.1.1.1.3.cmml" xref="alg3.l22.m1.4.4.3.3.1.1.1.3">′</ci></apply><apply id="alg3.l22.m1.5.5.4.4.2.2.2.cmml" xref="alg3.l22.m1.5.5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg3.l22.m1.5.5.4.4.2.2.2.1.cmml" xref="alg3.l22.m1.5.5.4.4.2.2.2">subscript</csymbol><ci id="alg3.l22.m1.5.5.4.4.2.2.2.2.cmml" xref="alg3.l22.m1.5.5.4.4.2.2.2.2">𝑦</ci><cn id="alg3.l22.m1.5.5.4.4.2.2.2.3.cmml" type="integer" xref="alg3.l22.m1.5.5.4.4.2.2.2.3">0</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l22.m1.5c">\mathcal{L}^{G}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+\mathcal{L}_{1%
}({y}_{0}^{\prime},y_{0})</annotation><annotation encoding="application/x-llamapun" id="alg3.l22.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l22.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l23.1.1.1" style="font-size:80%;">23:</span></span><span class="ltx_text" id="alg3.l23.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}^{G}_{\text{sup}}=\mathcal{L}^{G}+\mathcal{L}_{\text{contr}}({y}^{s%
}_{c},{y^{r}_{c}},x_{c})" class="ltx_Math" display="inline" id="alg3.l23.m1.3"><semantics id="alg3.l23.m1.3a"><mrow id="alg3.l23.m1.3.3" xref="alg3.l23.m1.3.3.cmml"><msubsup id="alg3.l23.m1.3.3.5" xref="alg3.l23.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l23.m1.3.3.5.2.2" mathsize="80%" xref="alg3.l23.m1.3.3.5.2.2.cmml">ℒ</mi><mtext id="alg3.l23.m1.3.3.5.3" mathsize="80%" xref="alg3.l23.m1.3.3.5.3a.cmml">sup</mtext><mi id="alg3.l23.m1.3.3.5.2.3" mathsize="80%" xref="alg3.l23.m1.3.3.5.2.3.cmml">G</mi></msubsup><mo id="alg3.l23.m1.3.3.4" mathsize="80%" xref="alg3.l23.m1.3.3.4.cmml">=</mo><mrow id="alg3.l23.m1.3.3.3" xref="alg3.l23.m1.3.3.3.cmml"><msup id="alg3.l23.m1.3.3.3.5" xref="alg3.l23.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l23.m1.3.3.3.5.2" mathsize="80%" xref="alg3.l23.m1.3.3.3.5.2.cmml">ℒ</mi><mi id="alg3.l23.m1.3.3.3.5.3" mathsize="80%" xref="alg3.l23.m1.3.3.3.5.3.cmml">G</mi></msup><mo id="alg3.l23.m1.3.3.3.4" mathsize="80%" xref="alg3.l23.m1.3.3.3.4.cmml">+</mo><mrow id="alg3.l23.m1.3.3.3.3" xref="alg3.l23.m1.3.3.3.3.cmml"><msub id="alg3.l23.m1.3.3.3.3.5" xref="alg3.l23.m1.3.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l23.m1.3.3.3.3.5.2" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.5.2.cmml">ℒ</mi><mtext id="alg3.l23.m1.3.3.3.3.5.3" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.5.3a.cmml">contr</mtext></msub><mo id="alg3.l23.m1.3.3.3.3.4" xref="alg3.l23.m1.3.3.3.3.4.cmml">⁢</mo><mrow id="alg3.l23.m1.3.3.3.3.3.3" xref="alg3.l23.m1.3.3.3.3.3.4.cmml"><mo id="alg3.l23.m1.3.3.3.3.3.3.4" maxsize="80%" minsize="80%" xref="alg3.l23.m1.3.3.3.3.3.4.cmml">(</mo><msubsup id="alg3.l23.m1.1.1.1.1.1.1.1" xref="alg3.l23.m1.1.1.1.1.1.1.1.cmml"><mi id="alg3.l23.m1.1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l23.m1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="alg3.l23.m1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg3.l23.m1.1.1.1.1.1.1.1.3.cmml">c</mi><mi id="alg3.l23.m1.1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg3.l23.m1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo id="alg3.l23.m1.3.3.3.3.3.3.5" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg3.l23.m1.2.2.2.2.2.2.2" xref="alg3.l23.m1.2.2.2.2.2.2.2.cmml"><mi id="alg3.l23.m1.2.2.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l23.m1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l23.m1.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l23.m1.2.2.2.2.2.2.2.3.cmml">c</mi><mi id="alg3.l23.m1.2.2.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l23.m1.2.2.2.2.2.2.2.2.3.cmml">r</mi></msubsup><mo id="alg3.l23.m1.3.3.3.3.3.3.6" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.3.4.cmml">,</mo><msub id="alg3.l23.m1.3.3.3.3.3.3.3" xref="alg3.l23.m1.3.3.3.3.3.3.3.cmml"><mi id="alg3.l23.m1.3.3.3.3.3.3.3.2" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.3.3.3.2.cmml">x</mi><mi id="alg3.l23.m1.3.3.3.3.3.3.3.3" mathsize="80%" xref="alg3.l23.m1.3.3.3.3.3.3.3.3.cmml">c</mi></msub><mo id="alg3.l23.m1.3.3.3.3.3.3.7" maxsize="80%" minsize="80%" xref="alg3.l23.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l23.m1.3b"><apply id="alg3.l23.m1.3.3.cmml" xref="alg3.l23.m1.3.3"><eq id="alg3.l23.m1.3.3.4.cmml" xref="alg3.l23.m1.3.3.4"></eq><apply id="alg3.l23.m1.3.3.5.cmml" xref="alg3.l23.m1.3.3.5"><csymbol cd="ambiguous" id="alg3.l23.m1.3.3.5.1.cmml" xref="alg3.l23.m1.3.3.5">subscript</csymbol><apply id="alg3.l23.m1.3.3.5.2.cmml" xref="alg3.l23.m1.3.3.5"><csymbol cd="ambiguous" id="alg3.l23.m1.3.3.5.2.1.cmml" xref="alg3.l23.m1.3.3.5">superscript</csymbol><ci id="alg3.l23.m1.3.3.5.2.2.cmml" xref="alg3.l23.m1.3.3.5.2.2">ℒ</ci><ci id="alg3.l23.m1.3.3.5.2.3.cmml" xref="alg3.l23.m1.3.3.5.2.3">𝐺</ci></apply><ci id="alg3.l23.m1.3.3.5.3a.cmml" xref="alg3.l23.m1.3.3.5.3"><mtext id="alg3.l23.m1.3.3.5.3.cmml" mathsize="56%" xref="alg3.l23.m1.3.3.5.3">sup</mtext></ci></apply><apply id="alg3.l23.m1.3.3.3.cmml" xref="alg3.l23.m1.3.3.3"><plus id="alg3.l23.m1.3.3.3.4.cmml" xref="alg3.l23.m1.3.3.3.4"></plus><apply id="alg3.l23.m1.3.3.3.5.cmml" xref="alg3.l23.m1.3.3.3.5"><csymbol cd="ambiguous" id="alg3.l23.m1.3.3.3.5.1.cmml" xref="alg3.l23.m1.3.3.3.5">superscript</csymbol><ci id="alg3.l23.m1.3.3.3.5.2.cmml" xref="alg3.l23.m1.3.3.3.5.2">ℒ</ci><ci id="alg3.l23.m1.3.3.3.5.3.cmml" xref="alg3.l23.m1.3.3.3.5.3">𝐺</ci></apply><apply id="alg3.l23.m1.3.3.3.3.cmml" xref="alg3.l23.m1.3.3.3.3"><times id="alg3.l23.m1.3.3.3.3.4.cmml" xref="alg3.l23.m1.3.3.3.3.4"></times><apply id="alg3.l23.m1.3.3.3.3.5.cmml" xref="alg3.l23.m1.3.3.3.3.5"><csymbol cd="ambiguous" id="alg3.l23.m1.3.3.3.3.5.1.cmml" xref="alg3.l23.m1.3.3.3.3.5">subscript</csymbol><ci id="alg3.l23.m1.3.3.3.3.5.2.cmml" xref="alg3.l23.m1.3.3.3.3.5.2">ℒ</ci><ci id="alg3.l23.m1.3.3.3.3.5.3a.cmml" xref="alg3.l23.m1.3.3.3.3.5.3"><mtext id="alg3.l23.m1.3.3.3.3.5.3.cmml" mathsize="56%" xref="alg3.l23.m1.3.3.3.3.5.3">contr</mtext></ci></apply><vector id="alg3.l23.m1.3.3.3.3.3.4.cmml" xref="alg3.l23.m1.3.3.3.3.3.3"><apply id="alg3.l23.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l23.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg3.l23.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l23.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg3.l23.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="alg3.l23.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="alg3.l23.m1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l23.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="alg3.l23.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l23.m1.2.2.2.2.2.2.2.1.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="alg3.l23.m1.2.2.2.2.2.2.2.2.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l23.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg3.l23.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l23.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2.2.3">𝑟</ci></apply><ci id="alg3.l23.m1.2.2.2.2.2.2.2.3.cmml" xref="alg3.l23.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg3.l23.m1.3.3.3.3.3.3.3.cmml" xref="alg3.l23.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg3.l23.m1.3.3.3.3.3.3.3.1.cmml" xref="alg3.l23.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="alg3.l23.m1.3.3.3.3.3.3.3.2.cmml" xref="alg3.l23.m1.3.3.3.3.3.3.3.2">𝑥</ci><ci id="alg3.l23.m1.3.3.3.3.3.3.3.3.cmml" xref="alg3.l23.m1.3.3.3.3.3.3.3.3">𝑐</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l23.m1.3c">\mathcal{L}^{G}_{\text{sup}}=\mathcal{L}^{G}+\mathcal{L}_{\text{contr}}({y}^{s%
}_{c},{y^{r}_{c}},x_{c})</annotation><annotation encoding="application/x-llamapun" id="alg3.l23.m1.3d">caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT + caligraphic_L start_POSTSUBSCRIPT contr end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg3.l23.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l24.1.1.1" style="font-size:80%;">24:</span></span><span class="ltx_text" id="alg3.l24.2" style="font-size:80%;">        </span><math alttext="\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t)" class="ltx_Math" display="inline" id="alg3.l24.m1.6"><semantics id="alg3.l24.m1.6a"><mrow id="alg3.l24.m1.6.6" xref="alg3.l24.m1.6.6.cmml"><msubsup id="alg3.l24.m1.6.6.6" xref="alg3.l24.m1.6.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l24.m1.6.6.6.2.2" mathsize="80%" xref="alg3.l24.m1.6.6.6.2.2.cmml">ℒ</mi><mtext id="alg3.l24.m1.6.6.6.3" mathsize="80%" xref="alg3.l24.m1.6.6.6.3a.cmml">sup</mtext><mi id="alg3.l24.m1.6.6.6.2.3" mathsize="80%" xref="alg3.l24.m1.6.6.6.2.3.cmml">D</mi></msubsup><mo id="alg3.l24.m1.6.6.5" mathsize="80%" xref="alg3.l24.m1.6.6.5.cmml">=</mo><mrow id="alg3.l24.m1.6.6.4" xref="alg3.l24.m1.6.6.4.cmml"><mrow id="alg3.l24.m1.4.4.2.2" xref="alg3.l24.m1.4.4.2.2.cmml"><mo id="alg3.l24.m1.4.4.2.2a" mathsize="80%" rspace="0.167em" xref="alg3.l24.m1.4.4.2.2.cmml">−</mo><mrow id="alg3.l24.m1.4.4.2.2.2" xref="alg3.l24.m1.4.4.2.2.2.cmml"><mrow id="alg3.l24.m1.4.4.2.2.2.4" xref="alg3.l24.m1.4.4.2.2.2.4.cmml"><mi id="alg3.l24.m1.4.4.2.2.2.4.1" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.4.1.cmml">log</mi><mo id="alg3.l24.m1.4.4.2.2.2.4a" lspace="0.167em" xref="alg3.l24.m1.4.4.2.2.2.4.cmml">⁡</mo><msub id="alg3.l24.m1.4.4.2.2.2.4.2" xref="alg3.l24.m1.4.4.2.2.2.4.2.cmml"><mi id="alg3.l24.m1.4.4.2.2.2.4.2.2" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.4.2.2.cmml">D</mi><mtext id="alg3.l24.m1.4.4.2.2.2.4.2.3" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l24.m1.4.4.2.2.2.3" xref="alg3.l24.m1.4.4.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l24.m1.4.4.2.2.2.2.2" xref="alg3.l24.m1.4.4.2.2.2.2.3.cmml"><mo id="alg3.l24.m1.4.4.2.2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.3.cmml">(</mo><msub id="alg3.l24.m1.3.3.1.1.1.1.1.1" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg3.l24.m1.3.3.1.1.1.1.1.1.2" mathsize="80%" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.2.cmml">y</mi><mrow id="alg3.l24.m1.3.3.1.1.1.1.1.1.3" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.1" mathsize="80%" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l24.m1.4.4.2.2.2.2.2.4" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.3.cmml">,</mo><msub id="alg3.l24.m1.4.4.2.2.2.2.2.2" xref="alg3.l24.m1.4.4.2.2.2.2.2.2.cmml"><mi id="alg3.l24.m1.4.4.2.2.2.2.2.2.2" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg3.l24.m1.4.4.2.2.2.2.2.2.3" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l24.m1.4.4.2.2.2.2.2.5" mathsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.3.cmml">,</mo><mi id="alg3.l24.m1.1.1" mathsize="80%" xref="alg3.l24.m1.1.1.cmml">t</mi><mo id="alg3.l24.m1.4.4.2.2.2.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l24.m1.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l24.m1.6.6.4.5" mathsize="80%" xref="alg3.l24.m1.6.6.4.5.cmml">+</mo><mrow id="alg3.l24.m1.6.6.4.4" xref="alg3.l24.m1.6.6.4.4.cmml"><mrow id="alg3.l24.m1.6.6.4.4.4" xref="alg3.l24.m1.6.6.4.4.4.cmml"><mi id="alg3.l24.m1.6.6.4.4.4.1" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.4.1.cmml">log</mi><mo id="alg3.l24.m1.6.6.4.4.4a" lspace="0.167em" xref="alg3.l24.m1.6.6.4.4.4.cmml">⁡</mo><msub id="alg3.l24.m1.6.6.4.4.4.2" xref="alg3.l24.m1.6.6.4.4.4.2.cmml"><mi id="alg3.l24.m1.6.6.4.4.4.2.2" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.4.2.2.cmml">D</mi><mtext id="alg3.l24.m1.6.6.4.4.4.2.3" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="alg3.l24.m1.6.6.4.4.3" xref="alg3.l24.m1.6.6.4.4.3.cmml">⁢</mo><mrow id="alg3.l24.m1.6.6.4.4.2.2" xref="alg3.l24.m1.6.6.4.4.2.3.cmml"><mo id="alg3.l24.m1.6.6.4.4.2.2.3" maxsize="80%" minsize="80%" xref="alg3.l24.m1.6.6.4.4.2.3.cmml">(</mo><msubsup id="alg3.l24.m1.5.5.3.3.1.1.1" xref="alg3.l24.m1.5.5.3.3.1.1.1.cmml"><mi id="alg3.l24.m1.5.5.3.3.1.1.1.2.2" mathsize="80%" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.2.cmml">y</mi><mrow id="alg3.l24.m1.5.5.3.3.1.1.1.2.3" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.cmml"><mi id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.2" mathsize="80%" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.1" mathsize="80%" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.1.cmml">−</mo><mn id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.3" mathsize="80%" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="alg3.l24.m1.5.5.3.3.1.1.1.3" mathsize="80%" xref="alg3.l24.m1.5.5.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="alg3.l24.m1.6.6.4.4.2.2.4" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.2.3.cmml">,</mo><msub id="alg3.l24.m1.6.6.4.4.2.2.2" xref="alg3.l24.m1.6.6.4.4.2.2.2.cmml"><mi id="alg3.l24.m1.6.6.4.4.2.2.2.2" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.2.2.2.2.cmml">y</mi><mi id="alg3.l24.m1.6.6.4.4.2.2.2.3" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.2.2.2.3.cmml">t</mi></msub><mo id="alg3.l24.m1.6.6.4.4.2.2.5" mathsize="80%" xref="alg3.l24.m1.6.6.4.4.2.3.cmml">,</mo><mi id="alg3.l24.m1.2.2" mathsize="80%" xref="alg3.l24.m1.2.2.cmml">t</mi><mo id="alg3.l24.m1.6.6.4.4.2.2.6" maxsize="80%" minsize="80%" xref="alg3.l24.m1.6.6.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l24.m1.6b"><apply id="alg3.l24.m1.6.6.cmml" xref="alg3.l24.m1.6.6"><eq id="alg3.l24.m1.6.6.5.cmml" xref="alg3.l24.m1.6.6.5"></eq><apply id="alg3.l24.m1.6.6.6.cmml" xref="alg3.l24.m1.6.6.6"><csymbol cd="ambiguous" id="alg3.l24.m1.6.6.6.1.cmml" xref="alg3.l24.m1.6.6.6">subscript</csymbol><apply id="alg3.l24.m1.6.6.6.2.cmml" xref="alg3.l24.m1.6.6.6"><csymbol cd="ambiguous" id="alg3.l24.m1.6.6.6.2.1.cmml" xref="alg3.l24.m1.6.6.6">superscript</csymbol><ci id="alg3.l24.m1.6.6.6.2.2.cmml" xref="alg3.l24.m1.6.6.6.2.2">ℒ</ci><ci id="alg3.l24.m1.6.6.6.2.3.cmml" xref="alg3.l24.m1.6.6.6.2.3">𝐷</ci></apply><ci id="alg3.l24.m1.6.6.6.3a.cmml" xref="alg3.l24.m1.6.6.6.3"><mtext id="alg3.l24.m1.6.6.6.3.cmml" mathsize="56%" xref="alg3.l24.m1.6.6.6.3">sup</mtext></ci></apply><apply id="alg3.l24.m1.6.6.4.cmml" xref="alg3.l24.m1.6.6.4"><plus id="alg3.l24.m1.6.6.4.5.cmml" xref="alg3.l24.m1.6.6.4.5"></plus><apply id="alg3.l24.m1.4.4.2.2.cmml" xref="alg3.l24.m1.4.4.2.2"><minus id="alg3.l24.m1.4.4.2.2.3.cmml" xref="alg3.l24.m1.4.4.2.2"></minus><apply id="alg3.l24.m1.4.4.2.2.2.cmml" xref="alg3.l24.m1.4.4.2.2.2"><times id="alg3.l24.m1.4.4.2.2.2.3.cmml" xref="alg3.l24.m1.4.4.2.2.2.3"></times><apply id="alg3.l24.m1.4.4.2.2.2.4.cmml" xref="alg3.l24.m1.4.4.2.2.2.4"><log id="alg3.l24.m1.4.4.2.2.2.4.1.cmml" xref="alg3.l24.m1.4.4.2.2.2.4.1"></log><apply id="alg3.l24.m1.4.4.2.2.2.4.2.cmml" xref="alg3.l24.m1.4.4.2.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l24.m1.4.4.2.2.2.4.2.1.cmml" xref="alg3.l24.m1.4.4.2.2.2.4.2">subscript</csymbol><ci id="alg3.l24.m1.4.4.2.2.2.4.2.2.cmml" xref="alg3.l24.m1.4.4.2.2.2.4.2.2">𝐷</ci><ci id="alg3.l24.m1.4.4.2.2.2.4.2.3a.cmml" xref="alg3.l24.m1.4.4.2.2.2.4.2.3"><mtext id="alg3.l24.m1.4.4.2.2.2.4.2.3.cmml" mathsize="56%" xref="alg3.l24.m1.4.4.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l24.m1.4.4.2.2.2.2.3.cmml" xref="alg3.l24.m1.4.4.2.2.2.2.2"><apply id="alg3.l24.m1.3.3.1.1.1.1.1.1.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l24.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l24.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.2">𝑦</ci><apply id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3"><minus id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.1"></minus><ci id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l24.m1.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l24.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l24.m1.4.4.2.2.2.2.2.2.cmml" xref="alg3.l24.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l24.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg3.l24.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="alg3.l24.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg3.l24.m1.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="alg3.l24.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg3.l24.m1.4.4.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l24.m1.1.1.cmml" xref="alg3.l24.m1.1.1">𝑡</ci></vector></apply></apply><apply id="alg3.l24.m1.6.6.4.4.cmml" xref="alg3.l24.m1.6.6.4.4"><times id="alg3.l24.m1.6.6.4.4.3.cmml" xref="alg3.l24.m1.6.6.4.4.3"></times><apply id="alg3.l24.m1.6.6.4.4.4.cmml" xref="alg3.l24.m1.6.6.4.4.4"><log id="alg3.l24.m1.6.6.4.4.4.1.cmml" xref="alg3.l24.m1.6.6.4.4.4.1"></log><apply id="alg3.l24.m1.6.6.4.4.4.2.cmml" xref="alg3.l24.m1.6.6.4.4.4.2"><csymbol cd="ambiguous" id="alg3.l24.m1.6.6.4.4.4.2.1.cmml" xref="alg3.l24.m1.6.6.4.4.4.2">subscript</csymbol><ci id="alg3.l24.m1.6.6.4.4.4.2.2.cmml" xref="alg3.l24.m1.6.6.4.4.4.2.2">𝐷</ci><ci id="alg3.l24.m1.6.6.4.4.4.2.3a.cmml" xref="alg3.l24.m1.6.6.4.4.4.2.3"><mtext id="alg3.l24.m1.6.6.4.4.4.2.3.cmml" mathsize="56%" xref="alg3.l24.m1.6.6.4.4.4.2.3">sn</mtext></ci></apply></apply><vector id="alg3.l24.m1.6.6.4.4.2.3.cmml" xref="alg3.l24.m1.6.6.4.4.2.2"><apply id="alg3.l24.m1.5.5.3.3.1.1.1.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l24.m1.5.5.3.3.1.1.1.1.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1">superscript</csymbol><apply id="alg3.l24.m1.5.5.3.3.1.1.1.2.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l24.m1.5.5.3.3.1.1.1.2.1.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1">subscript</csymbol><ci id="alg3.l24.m1.5.5.3.3.1.1.1.2.2.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.2">𝑦</ci><apply id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3"><minus id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.1.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.1"></minus><ci id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.2.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l24.m1.5.5.3.3.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l24.m1.5.5.3.3.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg3.l24.m1.5.5.3.3.1.1.1.3.cmml" xref="alg3.l24.m1.5.5.3.3.1.1.1.3">′</ci></apply><apply id="alg3.l24.m1.6.6.4.4.2.2.2.cmml" xref="alg3.l24.m1.6.6.4.4.2.2.2"><csymbol cd="ambiguous" id="alg3.l24.m1.6.6.4.4.2.2.2.1.cmml" xref="alg3.l24.m1.6.6.4.4.2.2.2">subscript</csymbol><ci id="alg3.l24.m1.6.6.4.4.2.2.2.2.cmml" xref="alg3.l24.m1.6.6.4.4.2.2.2.2">𝑦</ci><ci id="alg3.l24.m1.6.6.4.4.2.2.2.3.cmml" xref="alg3.l24.m1.6.6.4.4.2.2.2.3">𝑡</ci></apply><ci id="alg3.l24.m1.2.2.cmml" xref="alg3.l24.m1.2.2">𝑡</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l24.m1.6c">\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t)</annotation><annotation encoding="application/x-llamapun" id="alg3.l24.m1.6d">caligraphic_L start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg3.l24.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l25.1.1.1" style="font-size:80%;">25:</span></span><span class="ltx_text" id="alg3.l25.2" style="font-size:80%;">        </span><math alttext="\text{Minimize}~{}\lambda_{t}\cdot\mathcal{L}^{G}_{\text{sup}},~{}\text{%
Minimize}~{}\lambda_{t}\cdot\mathcal{L}^{D}_{\text{sup}}" class="ltx_Math" display="inline" id="alg3.l25.m1.2"><semantics id="alg3.l25.m1.2a"><mrow id="alg3.l25.m1.2.2.2" xref="alg3.l25.m1.2.2.3.cmml"><mrow id="alg3.l25.m1.1.1.1.1" xref="alg3.l25.m1.1.1.1.1.cmml"><mrow id="alg3.l25.m1.1.1.1.1.2" xref="alg3.l25.m1.1.1.1.1.2.cmml"><mtext id="alg3.l25.m1.1.1.1.1.2.2" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.2.2a.cmml">Minimize</mtext><mo id="alg3.l25.m1.1.1.1.1.2.1" lspace="0.270em" xref="alg3.l25.m1.1.1.1.1.2.1.cmml">⁢</mo><msub id="alg3.l25.m1.1.1.1.1.2.3" xref="alg3.l25.m1.1.1.1.1.2.3.cmml"><mi id="alg3.l25.m1.1.1.1.1.2.3.2" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.2.3.2.cmml">λ</mi><mi id="alg3.l25.m1.1.1.1.1.2.3.3" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="alg3.l25.m1.1.1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="alg3.l25.m1.1.1.1.1.1.cmml">⋅</mo><msubsup id="alg3.l25.m1.1.1.1.1.3" xref="alg3.l25.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l25.m1.1.1.1.1.3.2.2" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="alg3.l25.m1.1.1.1.1.3.3" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.3.3a.cmml">sup</mtext><mi id="alg3.l25.m1.1.1.1.1.3.2.3" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.3.2.3.cmml">G</mi></msubsup></mrow><mo id="alg3.l25.m1.2.2.2.3" mathsize="80%" rspace="0.437em" xref="alg3.l25.m1.2.2.3.cmml">,</mo><mrow id="alg3.l25.m1.2.2.2.2" xref="alg3.l25.m1.2.2.2.2.cmml"><mrow id="alg3.l25.m1.2.2.2.2.2" xref="alg3.l25.m1.2.2.2.2.2.cmml"><mtext id="alg3.l25.m1.2.2.2.2.2.2" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.2.2a.cmml">Minimize</mtext><mo id="alg3.l25.m1.2.2.2.2.2.1" lspace="0.270em" xref="alg3.l25.m1.2.2.2.2.2.1.cmml">⁢</mo><msub id="alg3.l25.m1.2.2.2.2.2.3" xref="alg3.l25.m1.2.2.2.2.2.3.cmml"><mi id="alg3.l25.m1.2.2.2.2.2.3.2" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.2.3.2.cmml">λ</mi><mi id="alg3.l25.m1.2.2.2.2.2.3.3" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow><mo id="alg3.l25.m1.2.2.2.2.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="alg3.l25.m1.2.2.2.2.1.cmml">⋅</mo><msubsup id="alg3.l25.m1.2.2.2.2.3" xref="alg3.l25.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l25.m1.2.2.2.2.3.2.2" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.3.2.2.cmml">ℒ</mi><mtext id="alg3.l25.m1.2.2.2.2.3.3" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.3.3a.cmml">sup</mtext><mi id="alg3.l25.m1.2.2.2.2.3.2.3" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.3.2.3.cmml">D</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l25.m1.2b"><list id="alg3.l25.m1.2.2.3.cmml" xref="alg3.l25.m1.2.2.2"><apply id="alg3.l25.m1.1.1.1.1.cmml" xref="alg3.l25.m1.1.1.1.1"><ci id="alg3.l25.m1.1.1.1.1.1.cmml" xref="alg3.l25.m1.1.1.1.1.1">⋅</ci><apply id="alg3.l25.m1.1.1.1.1.2.cmml" xref="alg3.l25.m1.1.1.1.1.2"><times id="alg3.l25.m1.1.1.1.1.2.1.cmml" xref="alg3.l25.m1.1.1.1.1.2.1"></times><ci id="alg3.l25.m1.1.1.1.1.2.2a.cmml" xref="alg3.l25.m1.1.1.1.1.2.2"><mtext id="alg3.l25.m1.1.1.1.1.2.2.cmml" mathsize="80%" xref="alg3.l25.m1.1.1.1.1.2.2">Minimize</mtext></ci><apply id="alg3.l25.m1.1.1.1.1.2.3.cmml" xref="alg3.l25.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg3.l25.m1.1.1.1.1.2.3.1.cmml" xref="alg3.l25.m1.1.1.1.1.2.3">subscript</csymbol><ci id="alg3.l25.m1.1.1.1.1.2.3.2.cmml" xref="alg3.l25.m1.1.1.1.1.2.3.2">𝜆</ci><ci id="alg3.l25.m1.1.1.1.1.2.3.3.cmml" xref="alg3.l25.m1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg3.l25.m1.1.1.1.1.3.cmml" xref="alg3.l25.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l25.m1.1.1.1.1.3.1.cmml" xref="alg3.l25.m1.1.1.1.1.3">subscript</csymbol><apply id="alg3.l25.m1.1.1.1.1.3.2.cmml" xref="alg3.l25.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l25.m1.1.1.1.1.3.2.1.cmml" xref="alg3.l25.m1.1.1.1.1.3">superscript</csymbol><ci id="alg3.l25.m1.1.1.1.1.3.2.2.cmml" xref="alg3.l25.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="alg3.l25.m1.1.1.1.1.3.2.3.cmml" xref="alg3.l25.m1.1.1.1.1.3.2.3">𝐺</ci></apply><ci id="alg3.l25.m1.1.1.1.1.3.3a.cmml" xref="alg3.l25.m1.1.1.1.1.3.3"><mtext id="alg3.l25.m1.1.1.1.1.3.3.cmml" mathsize="56%" xref="alg3.l25.m1.1.1.1.1.3.3">sup</mtext></ci></apply></apply><apply id="alg3.l25.m1.2.2.2.2.cmml" xref="alg3.l25.m1.2.2.2.2"><ci id="alg3.l25.m1.2.2.2.2.1.cmml" xref="alg3.l25.m1.2.2.2.2.1">⋅</ci><apply id="alg3.l25.m1.2.2.2.2.2.cmml" xref="alg3.l25.m1.2.2.2.2.2"><times id="alg3.l25.m1.2.2.2.2.2.1.cmml" xref="alg3.l25.m1.2.2.2.2.2.1"></times><ci id="alg3.l25.m1.2.2.2.2.2.2a.cmml" xref="alg3.l25.m1.2.2.2.2.2.2"><mtext id="alg3.l25.m1.2.2.2.2.2.2.cmml" mathsize="80%" xref="alg3.l25.m1.2.2.2.2.2.2">Minimize</mtext></ci><apply id="alg3.l25.m1.2.2.2.2.2.3.cmml" xref="alg3.l25.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l25.m1.2.2.2.2.2.3.1.cmml" xref="alg3.l25.m1.2.2.2.2.2.3">subscript</csymbol><ci id="alg3.l25.m1.2.2.2.2.2.3.2.cmml" xref="alg3.l25.m1.2.2.2.2.2.3.2">𝜆</ci><ci id="alg3.l25.m1.2.2.2.2.2.3.3.cmml" xref="alg3.l25.m1.2.2.2.2.2.3.3">𝑡</ci></apply></apply><apply id="alg3.l25.m1.2.2.2.2.3.cmml" xref="alg3.l25.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l25.m1.2.2.2.2.3.1.cmml" xref="alg3.l25.m1.2.2.2.2.3">subscript</csymbol><apply id="alg3.l25.m1.2.2.2.2.3.2.cmml" xref="alg3.l25.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg3.l25.m1.2.2.2.2.3.2.1.cmml" xref="alg3.l25.m1.2.2.2.2.3">superscript</csymbol><ci id="alg3.l25.m1.2.2.2.2.3.2.2.cmml" xref="alg3.l25.m1.2.2.2.2.3.2.2">ℒ</ci><ci id="alg3.l25.m1.2.2.2.2.3.2.3.cmml" xref="alg3.l25.m1.2.2.2.2.3.2.3">𝐷</ci></apply><ci id="alg3.l25.m1.2.2.2.2.3.3a.cmml" xref="alg3.l25.m1.2.2.2.2.3.3"><mtext id="alg3.l25.m1.2.2.2.2.3.3.cmml" mathsize="56%" xref="alg3.l25.m1.2.2.2.2.3.3">sup</mtext></ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l25.m1.2c">\text{Minimize}~{}\lambda_{t}\cdot\mathcal{L}^{G}_{\text{sup}},~{}\text{%
Minimize}~{}\lambda_{t}\cdot\mathcal{L}^{D}_{\text{sup}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l25.m1.2d">Minimize italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT , Minimize italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ caligraphic_L start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg3.l25.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l26.1.1.1" style="font-size:80%;">26:</span></span><span class="ltx_text" id="alg3.l26.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg3.l26.3" style="font-size:80%;">end</span><span class="ltx_text" id="alg3.l26.4" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg3.l26.5" style="font-size:80%;">if</span>
</div>
<div class="ltx_listingline" id="alg3.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l27.1.1.1" style="font-size:80%;">27:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l27.2" style="font-size:80%;">until</span><span class="ltx_text" id="alg3.l27.3" style="font-size:80%;"> converged
</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Training and Inference details</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.17">In the following, we will describe the model training and inference in detail. The training process is outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg3" title="Algorithm 3 ‣ 3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>. The schematic diagram of labeled data training is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.F3" title="Figure 3 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>.
To be specific, given the degraded image <math alttext="x\in\mathbb{R}^{3\times\text{H}\times\text{W}}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS4.p1.1.m1.1.1.3.3.2" xref="S3.SS4.p1.1.m1.1.1.3.3.2.cmml">3</mn><mo id="S3.SS4.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">×</mo><mtext id="S3.SS4.p1.1.m1.1.1.3.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.3a.cmml">H</mtext><mo id="S3.SS4.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.1.m1.1.1.3.3.1.cmml">×</mo><mtext id="S3.SS4.p1.1.m1.1.1.3.3.4" xref="S3.SS4.p1.1.m1.1.1.3.3.4a.cmml">W</mtext></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><in id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></in><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑥</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3"><times id="S3.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.1"></times><cn id="S3.SS4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1.3.3.2">3</cn><ci id="S3.SS4.p1.1.m1.1.1.3.3.3a.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.3"><mtext id="S3.SS4.p1.1.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.SS4.p1.1.m1.1.1.3.3.3">H</mtext></ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.4a.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.4"><mtext id="S3.SS4.p1.1.m1.1.1.3.3.4.cmml" mathsize="70%" xref="S3.SS4.p1.1.m1.1.1.3.3.4">W</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">x\in\mathbb{R}^{3\times\text{H}\times\text{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT 3 × H × W end_POSTSUPERSCRIPT</annotation></semantics></math> and its corresponding label <math alttext="y\in\mathbb{R}^{3\times\text{H}\times\text{W}}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">y</mi><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml"><mn id="S3.SS4.p1.2.m2.1.1.3.3.2" xref="S3.SS4.p1.2.m2.1.1.3.3.2.cmml">3</mn><mo id="S3.SS4.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">×</mo><mtext id="S3.SS4.p1.2.m2.1.1.3.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.3a.cmml">H</mtext><mo id="S3.SS4.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">×</mo><mtext id="S3.SS4.p1.2.m2.1.1.3.3.4" xref="S3.SS4.p1.2.m2.1.1.3.3.4a.cmml">W</mtext></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><in id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></in><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑦</ci><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3"><times id="S3.SS4.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.1"></times><cn id="S3.SS4.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.2.m2.1.1.3.3.2">3</cn><ci id="S3.SS4.p1.2.m2.1.1.3.3.3a.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.3"><mtext id="S3.SS4.p1.2.m2.1.1.3.3.3.cmml" mathsize="70%" xref="S3.SS4.p1.2.m2.1.1.3.3.3">H</mtext></ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.4a.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.4"><mtext id="S3.SS4.p1.2.m2.1.1.3.3.4.cmml" mathsize="70%" xref="S3.SS4.p1.2.m2.1.1.3.3.4">W</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">y\in\mathbb{R}^{3\times\text{H}\times\text{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_y ∈ blackboard_R start_POSTSUPERSCRIPT 3 × H × W end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="y" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_y</annotation></semantics></math> represents the GT if <math alttext="x" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">italic_x</annotation></semantics></math> is labeled data, otherwise the “optimal” outputs from the pseudo-label dynamic warehouse, we first crop them into <math alttext="64\times 64" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mn id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">64</mn><mo id="S3.SS4.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.5.m5.1.1.1.cmml">×</mo><mn id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><times id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1"></times><cn id="S3.SS4.p1.5.m5.1.1.2.cmml" type="integer" xref="S3.SS4.p1.5.m5.1.1.2">64</cn><cn id="S3.SS4.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS4.p1.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">64 × 64</annotation></semantics></math> patches, resulting <math alttext="x^{c}\in\mathbb{R}^{3\times 64\times 64}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><msup id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml"><mi id="S3.SS4.p1.6.m6.1.1.2.2" xref="S3.SS4.p1.6.m6.1.1.2.2.cmml">x</mi><mi id="S3.SS4.p1.6.m6.1.1.2.3" xref="S3.SS4.p1.6.m6.1.1.2.3.cmml">c</mi></msup><mo id="S3.SS4.p1.6.m6.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml"><mi id="S3.SS4.p1.6.m6.1.1.3.2" xref="S3.SS4.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.6.m6.1.1.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.cmml"><mn id="S3.SS4.p1.6.m6.1.1.3.3.2" xref="S3.SS4.p1.6.m6.1.1.3.3.2.cmml">3</mn><mo id="S3.SS4.p1.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.6.m6.1.1.3.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.3.cmml">64</mn><mo id="S3.SS4.p1.6.m6.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.6.m6.1.1.3.3.4" xref="S3.SS4.p1.6.m6.1.1.3.3.4.cmml">64</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><in id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1"></in><apply id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2.2">𝑥</ci><ci id="S3.SS4.p1.6.m6.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.1.1.2.3">𝑐</ci></apply><apply id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.6.m6.1.1.3.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3"><times id="S3.SS4.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3.1"></times><cn id="S3.SS4.p1.6.m6.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.6.m6.1.1.3.3.2">3</cn><cn id="S3.SS4.p1.6.m6.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p1.6.m6.1.1.3.3.3">64</cn><cn id="S3.SS4.p1.6.m6.1.1.3.3.4.cmml" type="integer" xref="S3.SS4.p1.6.m6.1.1.3.3.4">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">x^{c}\in\mathbb{R}^{3\times 64\times 64}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.1d">italic_x start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 3 × 64 × 64 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="y^{c}\in\mathbb{R}^{3\times 64\times 64}" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1"><semantics id="S3.SS4.p1.7.m7.1a"><mrow id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><msup id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2.2" xref="S3.SS4.p1.7.m7.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p1.7.m7.1.1.2.3" xref="S3.SS4.p1.7.m7.1.1.2.3.cmml">c</mi></msup><mo id="S3.SS4.p1.7.m7.1.1.1" xref="S3.SS4.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml"><mi id="S3.SS4.p1.7.m7.1.1.3.2" xref="S3.SS4.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.7.m7.1.1.3.3" xref="S3.SS4.p1.7.m7.1.1.3.3.cmml"><mn id="S3.SS4.p1.7.m7.1.1.3.3.2" xref="S3.SS4.p1.7.m7.1.1.3.3.2.cmml">3</mn><mo id="S3.SS4.p1.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.7.m7.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.7.m7.1.1.3.3.3" xref="S3.SS4.p1.7.m7.1.1.3.3.3.cmml">64</mn><mo id="S3.SS4.p1.7.m7.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.7.m7.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.7.m7.1.1.3.3.4" xref="S3.SS4.p1.7.m7.1.1.3.3.4.cmml">64</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><in id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1.1"></in><apply id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.2.1.cmml" xref="S3.SS4.p1.7.m7.1.1.2">superscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2.2">𝑦</ci><ci id="S3.SS4.p1.7.m7.1.1.2.3.cmml" xref="S3.SS4.p1.7.m7.1.1.2.3">𝑐</ci></apply><apply id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.3.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.3.2.cmml" xref="S3.SS4.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.7.m7.1.1.3.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3.3"><times id="S3.SS4.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3.3.1"></times><cn id="S3.SS4.p1.7.m7.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.7.m7.1.1.3.3.2">3</cn><cn id="S3.SS4.p1.7.m7.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p1.7.m7.1.1.3.3.3">64</cn><cn id="S3.SS4.p1.7.m7.1.1.3.3.4.cmml" type="integer" xref="S3.SS4.p1.7.m7.1.1.3.3.4">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">y^{c}\in\mathbb{R}^{3\times 64\times 64}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m7.1d">italic_y start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 3 × 64 × 64 end_POSTSUPERSCRIPT</annotation></semantics></math>. Note that the labeled data is randomly cropped while the unlabeled ones are center-cropped, due to the consideration of the alignment of the “optimal” outputs. Next, we decompose them into four wavelet subbands and then concatenate them into a single target in channel dimension, i.e., <math alttext="x_{0}\in\mathbb{R}^{12\times 64\times 64}" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m8.1"><semantics id="S3.SS4.p1.8.m8.1a"><mrow id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><msub id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2.2" xref="S3.SS4.p1.8.m8.1.1.2.2.cmml">x</mi><mn id="S3.SS4.p1.8.m8.1.1.2.3" xref="S3.SS4.p1.8.m8.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS4.p1.8.m8.1.1.1" xref="S3.SS4.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml"><mi id="S3.SS4.p1.8.m8.1.1.3.2" xref="S3.SS4.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.8.m8.1.1.3.3" xref="S3.SS4.p1.8.m8.1.1.3.3.cmml"><mn id="S3.SS4.p1.8.m8.1.1.3.3.2" xref="S3.SS4.p1.8.m8.1.1.3.3.2.cmml">12</mn><mo id="S3.SS4.p1.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.8.m8.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.8.m8.1.1.3.3.3" xref="S3.SS4.p1.8.m8.1.1.3.3.3.cmml">64</mn><mo id="S3.SS4.p1.8.m8.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.8.m8.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.8.m8.1.1.3.3.4" xref="S3.SS4.p1.8.m8.1.1.3.3.4.cmml">64</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><in id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1.1"></in><apply id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.2.1.cmml" xref="S3.SS4.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2.2">𝑥</ci><cn id="S3.SS4.p1.8.m8.1.1.2.3.cmml" type="integer" xref="S3.SS4.p1.8.m8.1.1.2.3">0</cn></apply><apply id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.3.1.cmml" xref="S3.SS4.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.3.2.cmml" xref="S3.SS4.p1.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.8.m8.1.1.3.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3.3"><times id="S3.SS4.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS4.p1.8.m8.1.1.3.3.1"></times><cn id="S3.SS4.p1.8.m8.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.8.m8.1.1.3.3.2">12</cn><cn id="S3.SS4.p1.8.m8.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p1.8.m8.1.1.3.3.3">64</cn><cn id="S3.SS4.p1.8.m8.1.1.3.3.4.cmml" type="integer" xref="S3.SS4.p1.8.m8.1.1.3.3.4">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">x_{0}\in\mathbb{R}^{12\times 64\times 64}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m8.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 12 × 64 × 64 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="y_{0}\in\mathbb{R}^{12\times 64\times 64}" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m9.1"><semantics id="S3.SS4.p1.9.m9.1a"><mrow id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><msub id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">y</mi><mn id="S3.SS4.p1.9.m9.1.1.2.3" xref="S3.SS4.p1.9.m9.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS4.p1.9.m9.1.1.1" xref="S3.SS4.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.3.2" xref="S3.SS4.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.9.m9.1.1.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.cmml"><mn id="S3.SS4.p1.9.m9.1.1.3.3.2" xref="S3.SS4.p1.9.m9.1.1.3.3.2.cmml">12</mn><mo id="S3.SS4.p1.9.m9.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.9.m9.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.9.m9.1.1.3.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.3.cmml">64</mn><mo id="S3.SS4.p1.9.m9.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.9.m9.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.9.m9.1.1.3.3.4" xref="S3.SS4.p1.9.m9.1.1.3.3.4.cmml">64</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><in id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1.1"></in><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">𝑦</ci><cn id="S3.SS4.p1.9.m9.1.1.2.3.cmml" type="integer" xref="S3.SS4.p1.9.m9.1.1.2.3">0</cn></apply><apply id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.9.m9.1.1.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3"><times id="S3.SS4.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.1"></times><cn id="S3.SS4.p1.9.m9.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.9.m9.1.1.3.3.2">12</cn><cn id="S3.SS4.p1.9.m9.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p1.9.m9.1.1.3.3.3">64</cn><cn id="S3.SS4.p1.9.m9.1.1.3.3.4.cmml" type="integer" xref="S3.SS4.p1.9.m9.1.1.3.3.4">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">y_{0}\in\mathbb{R}^{12\times 64\times 64}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m9.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 12 × 64 × 64 end_POSTSUPERSCRIPT</annotation></semantics></math>, for the diffusion/denoising process. More concretely, referring to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.F3" title="Figure 3 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>, we inject Gaussian noise to <math alttext="y_{0}" class="ltx_Math" display="inline" id="S3.SS4.p1.10.m10.1"><semantics id="S3.SS4.p1.10.m10.1a"><msub id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><mi id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml">y</mi><mn id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2">𝑦</ci><cn id="S3.SS4.p1.10.m10.1.1.3.cmml" type="integer" xref="S3.SS4.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">y_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.10.m10.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> (i.e., diffusion), obtaining <math alttext="y_{t-1}" class="ltx_Math" display="inline" id="S3.SS4.p1.11.m11.1"><semantics id="S3.SS4.p1.11.m11.1a"><msub id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><mi id="S3.SS4.p1.11.m11.1.1.2" xref="S3.SS4.p1.11.m11.1.1.2.cmml">y</mi><mrow id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.3.2" xref="S3.SS4.p1.11.m11.1.1.3.2.cmml">t</mi><mo id="S3.SS4.p1.11.m11.1.1.3.1" xref="S3.SS4.p1.11.m11.1.1.3.1.cmml">−</mo><mn id="S3.SS4.p1.11.m11.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2">𝑦</ci><apply id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><minus id="S3.SS4.p1.11.m11.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3.1"></minus><ci id="S3.SS4.p1.11.m11.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2">𝑡</ci><cn id="S3.SS4.p1.11.m11.1.1.3.3.cmml" type="integer" xref="S3.SS4.p1.11.m11.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">y_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.11.m11.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.12.m12.1"><semantics id="S3.SS4.p1.12.m12.1a"><msub id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml"><mi id="S3.SS4.p1.12.m12.1.1.2" xref="S3.SS4.p1.12.m12.1.1.2.cmml">y</mi><mi id="S3.SS4.p1.12.m12.1.1.3" xref="S3.SS4.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.1b"><apply id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m12.1.1.2.cmml" xref="S3.SS4.p1.12.m12.1.1.2">𝑦</ci><ci id="S3.SS4.p1.12.m12.1.1.3.cmml" xref="S3.SS4.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.12.m12.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, as detailed in lines 7-8 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg3" title="Algorithm 3 ‣ 3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>.
Subsequently, the noise-corrupted result <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.13.m13.1"><semantics id="S3.SS4.p1.13.m13.1a"><msub id="S3.SS4.p1.13.m13.1.1" xref="S3.SS4.p1.13.m13.1.1.cmml"><mi id="S3.SS4.p1.13.m13.1.1.2" xref="S3.SS4.p1.13.m13.1.1.2.cmml">y</mi><mi id="S3.SS4.p1.13.m13.1.1.3" xref="S3.SS4.p1.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m13.1b"><apply id="S3.SS4.p1.13.m13.1.1.cmml" xref="S3.SS4.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m13.1.1.1.cmml" xref="S3.SS4.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS4.p1.13.m13.1.1.2.cmml" xref="S3.SS4.p1.13.m13.1.1.2">𝑦</ci><ci id="S3.SS4.p1.13.m13.1.1.3.cmml" xref="S3.SS4.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m13.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.13.m13.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the degraded image <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.SS4.p1.14.m14.1"><semantics id="S3.SS4.p1.14.m14.1a"><msub id="S3.SS4.p1.14.m14.1.1" xref="S3.SS4.p1.14.m14.1.1.cmml"><mi id="S3.SS4.p1.14.m14.1.1.2" xref="S3.SS4.p1.14.m14.1.1.2.cmml">x</mi><mn id="S3.SS4.p1.14.m14.1.1.3" xref="S3.SS4.p1.14.m14.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m14.1b"><apply id="S3.SS4.p1.14.m14.1.1.cmml" xref="S3.SS4.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.14.m14.1.1.1.cmml" xref="S3.SS4.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS4.p1.14.m14.1.1.2.cmml" xref="S3.SS4.p1.14.m14.1.1.2">𝑥</ci><cn id="S3.SS4.p1.14.m14.1.1.3.cmml" type="integer" xref="S3.SS4.p1.14.m14.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m14.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.14.m14.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> are fed into the generator, resulting in the predicted <math alttext="{y}_{0}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p1.15.m15.1"><semantics id="S3.SS4.p1.15.m15.1a"><msubsup id="S3.SS4.p1.15.m15.1.1" xref="S3.SS4.p1.15.m15.1.1.cmml"><mi id="S3.SS4.p1.15.m15.1.1.2.2" xref="S3.SS4.p1.15.m15.1.1.2.2.cmml">y</mi><mn id="S3.SS4.p1.15.m15.1.1.2.3" xref="S3.SS4.p1.15.m15.1.1.2.3.cmml">0</mn><mo id="S3.SS4.p1.15.m15.1.1.3" xref="S3.SS4.p1.15.m15.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m15.1b"><apply id="S3.SS4.p1.15.m15.1.1.cmml" xref="S3.SS4.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m15.1.1.1.cmml" xref="S3.SS4.p1.15.m15.1.1">superscript</csymbol><apply id="S3.SS4.p1.15.m15.1.1.2.cmml" xref="S3.SS4.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m15.1.1.2.1.cmml" xref="S3.SS4.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS4.p1.15.m15.1.1.2.2.cmml" xref="S3.SS4.p1.15.m15.1.1.2.2">𝑦</ci><cn id="S3.SS4.p1.15.m15.1.1.2.3.cmml" type="integer" xref="S3.SS4.p1.15.m15.1.1.2.3">0</cn></apply><ci id="S3.SS4.p1.15.m15.1.1.3.cmml" xref="S3.SS4.p1.15.m15.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m15.1c">{y}_{0}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.15.m15.1d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. This predicted value is then used in the posterior distribution: <math alttext="{y}_{t-1}^{\prime}\sim q({y}_{t-1}^{\prime}\mid y_{t},{y}_{0}^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p1.16.m16.1"><semantics id="S3.SS4.p1.16.m16.1a"><mrow id="S3.SS4.p1.16.m16.1.1" xref="S3.SS4.p1.16.m16.1.1.cmml"><msubsup id="S3.SS4.p1.16.m16.1.1.3" xref="S3.SS4.p1.16.m16.1.1.3.cmml"><mi id="S3.SS4.p1.16.m16.1.1.3.2.2" xref="S3.SS4.p1.16.m16.1.1.3.2.2.cmml">y</mi><mrow id="S3.SS4.p1.16.m16.1.1.3.2.3" xref="S3.SS4.p1.16.m16.1.1.3.2.3.cmml"><mi id="S3.SS4.p1.16.m16.1.1.3.2.3.2" xref="S3.SS4.p1.16.m16.1.1.3.2.3.2.cmml">t</mi><mo id="S3.SS4.p1.16.m16.1.1.3.2.3.1" xref="S3.SS4.p1.16.m16.1.1.3.2.3.1.cmml">−</mo><mn id="S3.SS4.p1.16.m16.1.1.3.2.3.3" xref="S3.SS4.p1.16.m16.1.1.3.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p1.16.m16.1.1.3.3" xref="S3.SS4.p1.16.m16.1.1.3.3.cmml">′</mo></msubsup><mo id="S3.SS4.p1.16.m16.1.1.2" xref="S3.SS4.p1.16.m16.1.1.2.cmml">∼</mo><mrow id="S3.SS4.p1.16.m16.1.1.1" xref="S3.SS4.p1.16.m16.1.1.1.cmml"><mi id="S3.SS4.p1.16.m16.1.1.1.3" xref="S3.SS4.p1.16.m16.1.1.1.3.cmml">q</mi><mo id="S3.SS4.p1.16.m16.1.1.1.2" xref="S3.SS4.p1.16.m16.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.16.m16.1.1.1.1.1" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.16.m16.1.1.1.1.1.1" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.cmml"><msubsup id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.cmml"><mi id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.1" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.1.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.3.cmml"><msub id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.2" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.3" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.SS4.p1.16.m16.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.m16.1b"><apply id="S3.SS4.p1.16.m16.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1"><csymbol cd="latexml" id="S3.SS4.p1.16.m16.1.1.2.cmml" xref="S3.SS4.p1.16.m16.1.1.2">similar-to</csymbol><apply id="S3.SS4.p1.16.m16.1.1.3.cmml" xref="S3.SS4.p1.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.3.1.cmml" xref="S3.SS4.p1.16.m16.1.1.3">superscript</csymbol><apply id="S3.SS4.p1.16.m16.1.1.3.2.cmml" xref="S3.SS4.p1.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.3.2.1.cmml" xref="S3.SS4.p1.16.m16.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.16.m16.1.1.3.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.3.2.2">𝑦</ci><apply id="S3.SS4.p1.16.m16.1.1.3.2.3.cmml" xref="S3.SS4.p1.16.m16.1.1.3.2.3"><minus id="S3.SS4.p1.16.m16.1.1.3.2.3.1.cmml" xref="S3.SS4.p1.16.m16.1.1.3.2.3.1"></minus><ci id="S3.SS4.p1.16.m16.1.1.3.2.3.2.cmml" xref="S3.SS4.p1.16.m16.1.1.3.2.3.2">𝑡</ci><cn id="S3.SS4.p1.16.m16.1.1.3.2.3.3.cmml" type="integer" xref="S3.SS4.p1.16.m16.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.16.m16.1.1.3.3.cmml" xref="S3.SS4.p1.16.m16.1.1.3.3">′</ci></apply><apply id="S3.SS4.p1.16.m16.1.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1"><times id="S3.SS4.p1.16.m16.1.1.1.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.2"></times><ci id="S3.SS4.p1.16.m16.1.1.1.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.3">𝑞</ci><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.2">𝑦</ci><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3"><minus id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.1"></minus><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.4.3">′</ci></apply><list id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2"><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS4.p1.16.m16.1.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.m16.1c">{y}_{t-1}^{\prime}\sim q({y}_{t-1}^{\prime}\mid y_{t},{y}_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.16.m16.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, for denoising, yielding the denoised output <math alttext="{y}_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p1.17.m17.1"><semantics id="S3.SS4.p1.17.m17.1a"><msubsup id="S3.SS4.p1.17.m17.1.1" xref="S3.SS4.p1.17.m17.1.1.cmml"><mi id="S3.SS4.p1.17.m17.1.1.2.2" xref="S3.SS4.p1.17.m17.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p1.17.m17.1.1.2.3" xref="S3.SS4.p1.17.m17.1.1.2.3.cmml"><mi id="S3.SS4.p1.17.m17.1.1.2.3.2" xref="S3.SS4.p1.17.m17.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p1.17.m17.1.1.2.3.1" xref="S3.SS4.p1.17.m17.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p1.17.m17.1.1.2.3.3" xref="S3.SS4.p1.17.m17.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p1.17.m17.1.1.3" xref="S3.SS4.p1.17.m17.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.17.m17.1b"><apply id="S3.SS4.p1.17.m17.1.1.cmml" xref="S3.SS4.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m17.1.1.1.cmml" xref="S3.SS4.p1.17.m17.1.1">superscript</csymbol><apply id="S3.SS4.p1.17.m17.1.1.2.cmml" xref="S3.SS4.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m17.1.1.2.1.cmml" xref="S3.SS4.p1.17.m17.1.1">subscript</csymbol><ci id="S3.SS4.p1.17.m17.1.1.2.2.cmml" xref="S3.SS4.p1.17.m17.1.1.2.2">𝑦</ci><apply id="S3.SS4.p1.17.m17.1.1.2.3.cmml" xref="S3.SS4.p1.17.m17.1.1.2.3"><minus id="S3.SS4.p1.17.m17.1.1.2.3.1.cmml" xref="S3.SS4.p1.17.m17.1.1.2.3.1"></minus><ci id="S3.SS4.p1.17.m17.1.1.2.3.2.cmml" xref="S3.SS4.p1.17.m17.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p1.17.m17.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p1.17.m17.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.17.m17.1.1.3.cmml" xref="S3.SS4.p1.17.m17.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.17.m17.1c">{y}_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.17.m17.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, as shown in lines 10-11 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg3" title="Algorithm 3 ‣ 3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="476" id="S3.F3.g1" src="x3.png" width="748"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The schematic diagram of labeled data training in the student network</figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.22">For labeled image training, considering that we are utilizing a conditional diffusion model to address various adverse weather degradation issues, it is important to maintain the content consistency between the generated outputs and the degraded image conditional inputs.
To achieve this, we refine the loss function of the WaveDiff’s generator, i.e.,
</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}^{G}_{\text{sup}}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+%
\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c})." class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.6" xref="S3.E3.m1.2.2.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.6.2.2" xref="S3.E3.m1.2.2.1.1.6.2.2.cmml">ℒ</mi><mtext id="S3.E3.m1.2.2.1.1.6.3" xref="S3.E3.m1.2.2.1.1.6.3a.cmml">sup</mtext><mi id="S3.E3.m1.2.2.1.1.6.2.3" xref="S3.E3.m1.2.2.1.1.6.2.3.cmml">G</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.5" xref="S3.E3.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.cmml"><mo id="S3.E3.m1.2.2.1.1.2.2a" rspace="0.167em" xref="S3.E3.m1.2.2.1.1.2.2.cmml">−</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2.2.4" xref="S3.E3.m1.2.2.1.1.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.4.1" xref="S3.E3.m1.2.2.1.1.2.2.2.4.1.cmml">log</mi><mo id="S3.E3.m1.2.2.1.1.2.2.2.4a" lspace="0.167em" xref="S3.E3.m1.2.2.1.1.2.2.2.4.cmml">⁡</mo><msub id="S3.E3.m1.2.2.1.1.2.2.2.4.2" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.4.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.2.cmml">D</mi><mtext id="S3.E3.m1.2.2.1.1.2.2.2.4.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.4" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.5" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">t</mi><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.6" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.4.5" xref="S3.E3.m1.2.2.1.1.4.5.cmml">+</mo><mrow id="S3.E3.m1.2.2.1.1.4.4" xref="S3.E3.m1.2.2.1.1.4.4.cmml"><msub id="S3.E3.m1.2.2.1.1.4.4.4" xref="S3.E3.m1.2.2.1.1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.4.4.4.2" xref="S3.E3.m1.2.2.1.1.4.4.4.2.cmml">ℒ</mi><mtext id="S3.E3.m1.2.2.1.1.4.4.4.3" xref="S3.E3.m1.2.2.1.1.4.4.4.3a.cmml">aux</mtext></msub><mo id="S3.E3.m1.2.2.1.1.4.4.3" xref="S3.E3.m1.2.2.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.4.4.2.2" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">(</mo><msubsup id="S3.E3.m1.2.2.1.1.3.3.1.1.1" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.cmml">y</mi><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3.cmml">c</mi><mo id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.4" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.1.1.4.4.2.2.2" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.4.4.2.2.2.2" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.cmml">c</mi></msub><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.5" stretchy="false" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" lspace="0em" xref="S3.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.1.1.5"></eq><apply id="S3.E3.m1.2.2.1.1.6.cmml" xref="S3.E3.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.6.1.cmml" xref="S3.E3.m1.2.2.1.1.6">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.6.2.cmml" xref="S3.E3.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.6.2.1.cmml" xref="S3.E3.m1.2.2.1.1.6">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.6.2.2.cmml" xref="S3.E3.m1.2.2.1.1.6.2.2">ℒ</ci><ci id="S3.E3.m1.2.2.1.1.6.2.3.cmml" xref="S3.E3.m1.2.2.1.1.6.2.3">𝐺</ci></apply><ci id="S3.E3.m1.2.2.1.1.6.3a.cmml" xref="S3.E3.m1.2.2.1.1.6.3"><mtext id="S3.E3.m1.2.2.1.1.6.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.1.1.6.3">sup</mtext></ci></apply><apply id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"><plus id="S3.E3.m1.2.2.1.1.4.5.cmml" xref="S3.E3.m1.2.2.1.1.4.5"></plus><apply id="S3.E3.m1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2"><minus id="S3.E3.m1.2.2.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2"></minus><apply id="S3.E3.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"><times id="S3.E3.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.1.1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4"><log id="S3.E3.m1.2.2.1.1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4.1"></log><apply id="S3.E3.m1.2.2.1.1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.4.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.4.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.2">𝐷</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.4.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.3"><mtext id="S3.E3.m1.2.2.1.1.2.2.2.4.2.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.1.1.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3"><minus id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑡</ci></vector></apply></apply><apply id="S3.E3.m1.2.2.1.1.4.4.cmml" xref="S3.E3.m1.2.2.1.1.4.4"><times id="S3.E3.m1.2.2.1.1.4.4.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.3"></times><apply id="S3.E3.m1.2.2.1.1.4.4.4.cmml" xref="S3.E3.m1.2.2.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.4.4.4.1.cmml" xref="S3.E3.m1.2.2.1.1.4.4.4">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.4.4.4.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.4.2">ℒ</ci><ci id="S3.E3.m1.2.2.1.1.4.4.4.3a.cmml" xref="S3.E3.m1.2.2.1.1.4.4.4.3"><mtext id="S3.E3.m1.2.2.1.1.4.4.4.3.cmml" mathsize="70%" xref="S3.E3.m1.2.2.1.1.4.4.4.3">aux</mtext></ci></apply><interval closure="open" id="S3.E3.m1.2.2.1.1.4.4.2.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2"><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2">𝑦</ci><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3">′</ci></apply><apply id="S3.E3.m1.2.2.1.1.4.4.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.4.4.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.2">𝑦</ci><ci id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathcal{L}^{G}_{\text{sup}}=-\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)+%
\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c}).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">caligraphic_L start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.5">Referring to Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.E3" title="In 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>), apart from the original adversarial loss <math alttext="\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.3"><semantics id="S3.SS4.p2.1.m1.3a"><mrow id="S3.SS4.p2.1.m1.3.3" xref="S3.SS4.p2.1.m1.3.3.cmml"><mrow id="S3.SS4.p2.1.m1.3.3.4" xref="S3.SS4.p2.1.m1.3.3.4.cmml"><mi id="S3.SS4.p2.1.m1.3.3.4.1" xref="S3.SS4.p2.1.m1.3.3.4.1.cmml">log</mi><mo id="S3.SS4.p2.1.m1.3.3.4a" lspace="0.167em" xref="S3.SS4.p2.1.m1.3.3.4.cmml">⁡</mo><msub id="S3.SS4.p2.1.m1.3.3.4.2" xref="S3.SS4.p2.1.m1.3.3.4.2.cmml"><mi id="S3.SS4.p2.1.m1.3.3.4.2.2" xref="S3.SS4.p2.1.m1.3.3.4.2.2.cmml">D</mi><mtext id="S3.SS4.p2.1.m1.3.3.4.2.3" xref="S3.SS4.p2.1.m1.3.3.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="S3.SS4.p2.1.m1.3.3.3" xref="S3.SS4.p2.1.m1.3.3.3.cmml">⁢</mo><mrow id="S3.SS4.p2.1.m1.3.3.2.2" xref="S3.SS4.p2.1.m1.3.3.2.3.cmml"><mo id="S3.SS4.p2.1.m1.3.3.2.2.3" stretchy="false" xref="S3.SS4.p2.1.m1.3.3.2.3.cmml">(</mo><msubsup id="S3.SS4.p2.1.m1.2.2.1.1.1" xref="S3.SS4.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.2" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.1" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.3" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p2.1.m1.2.2.1.1.1.3" xref="S3.SS4.p2.1.m1.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.1.m1.3.3.2.2.4" xref="S3.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS4.p2.1.m1.3.3.2.2.2" xref="S3.SS4.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.p2.1.m1.3.3.2.2.2.2" xref="S3.SS4.p2.1.m1.3.3.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p2.1.m1.3.3.2.2.2.3" xref="S3.SS4.p2.1.m1.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS4.p2.1.m1.3.3.2.2.5" xref="S3.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">t</mi><mo id="S3.SS4.p2.1.m1.3.3.2.2.6" stretchy="false" xref="S3.SS4.p2.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.3b"><apply id="S3.SS4.p2.1.m1.3.3.cmml" xref="S3.SS4.p2.1.m1.3.3"><times id="S3.SS4.p2.1.m1.3.3.3.cmml" xref="S3.SS4.p2.1.m1.3.3.3"></times><apply id="S3.SS4.p2.1.m1.3.3.4.cmml" xref="S3.SS4.p2.1.m1.3.3.4"><log id="S3.SS4.p2.1.m1.3.3.4.1.cmml" xref="S3.SS4.p2.1.m1.3.3.4.1"></log><apply id="S3.SS4.p2.1.m1.3.3.4.2.cmml" xref="S3.SS4.p2.1.m1.3.3.4.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.3.3.4.2.1.cmml" xref="S3.SS4.p2.1.m1.3.3.4.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.3.3.4.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.4.2.2">𝐷</ci><ci id="S3.SS4.p2.1.m1.3.3.4.2.3a.cmml" xref="S3.SS4.p2.1.m1.3.3.4.2.3"><mtext id="S3.SS4.p2.1.m1.3.3.4.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.1.m1.3.3.4.2.3">sn</mtext></ci></apply></apply><vector id="S3.SS4.p2.1.m1.3.3.2.3.cmml" xref="S3.SS4.p2.1.m1.3.3.2.2"><apply id="S3.SS4.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.2">𝑦</ci><apply id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3"><minus id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.1"></minus><ci id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1.1.3">′</ci></apply><apply id="S3.SS4.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.2.2.2.2">𝑦</ci><ci id="S3.SS4.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝑡</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.3c">\log D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.3d">roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math> in WaveDiff, a auxiliary loss <math alttext="\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c})" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.2"><semantics id="S3.SS4.p2.2.m2.2a"><mrow id="S3.SS4.p2.2.m2.2.2" xref="S3.SS4.p2.2.m2.2.2.cmml"><msub id="S3.SS4.p2.2.m2.2.2.4" xref="S3.SS4.p2.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.2.m2.2.2.4.2" xref="S3.SS4.p2.2.m2.2.2.4.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.2.m2.2.2.4.3" xref="S3.SS4.p2.2.m2.2.2.4.3a.cmml">aux</mtext></msub><mo id="S3.SS4.p2.2.m2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.3.cmml">⁢</mo><mrow id="S3.SS4.p2.2.m2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml"><mo id="S3.SS4.p2.2.m2.2.2.2.2.3" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml">(</mo><msubsup id="S3.SS4.p2.2.m2.1.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1.1.2.2" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p2.2.m2.1.1.1.1.1.2.3" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2.3.cmml">c</mi><mo id="S3.SS4.p2.2.m2.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.2.m2.2.2.2.2.4" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p2.2.m2.2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS4.p2.2.m2.2.2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p2.2.m2.2.2.2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS4.p2.2.m2.2.2.2.2.5" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2"><times id="S3.SS4.p2.2.m2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.3"></times><apply id="S3.SS4.p2.2.m2.2.2.4.cmml" xref="S3.SS4.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.4.1.cmml" xref="S3.SS4.p2.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.4.2.cmml" xref="S3.SS4.p2.2.m2.2.2.4.2">ℒ</ci><ci id="S3.SS4.p2.2.m2.2.2.4.3a.cmml" xref="S3.SS4.p2.2.m2.2.2.4.3"><mtext id="S3.SS4.p2.2.m2.2.2.4.3.cmml" mathsize="70%" xref="S3.SS4.p2.2.m2.2.2.4.3">aux</mtext></ci></apply><interval closure="open" id="S3.SS4.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2"><apply id="S3.SS4.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.SS4.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS4.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS4.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2.2.3">𝑐</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">\mathcal{L}_{\text{aux}}({y}_{c}^{\prime},y_{c})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.2d">caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math> comprises of <math alttext="\mathcal{L}_{\text{rec}}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><msub id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3a.cmml">rec</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">ℒ</ci><ci id="S3.SS4.p2.3.m3.1.1.3a.cmml" xref="S3.SS4.p2.3.m3.1.1.3"><mtext id="S3.SS4.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.3.m3.1.1.3">rec</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\mathcal{L}_{\text{rec}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT</annotation></semantics></math> loss and <math alttext="\mathcal{L}_{\text{perc}}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><msub id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3a.cmml">perc</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">ℒ</ci><ci id="S3.SS4.p2.4.m4.1.1.3a.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><mtext id="S3.SS4.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.4.m4.1.1.3">perc</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\mathcal{L}_{\text{perc}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT perc end_POSTSUBSCRIPT</annotation></semantics></math> are further introduced. Specifically, the <math alttext="\mathcal{L}_{\text{aux}}" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><msub id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3a.cmml">aux</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2">ℒ</ci><ci id="S3.SS4.p2.5.m5.1.1.3a.cmml" xref="S3.SS4.p2.5.m5.1.1.3"><mtext id="S3.SS4.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.5.m5.1.1.3">aux</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">\mathcal{L}_{\text{aux}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT</annotation></semantics></math> is formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{aux}}=5\cdot\mathcal{L}_{\text{rec}}({y}_{c}^{\prime},y_{c}%
)+10\cdot\mathcal{L}_{\text{perc}}({y}_{c}^{\prime},y_{c})," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.6.2" xref="S3.E4.m1.1.1.1.1.6.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.6.3" xref="S3.E4.m1.1.1.1.1.6.3a.cmml">aux</mtext></msub><mo id="S3.E4.m1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2.4" xref="S3.E4.m1.1.1.1.1.2.2.4.cmml"><mn id="S3.E4.m1.1.1.1.1.2.2.4.2" xref="S3.E4.m1.1.1.1.1.2.2.4.2.cmml">5</mn><mo id="S3.E4.m1.1.1.1.1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.1.1.1.1.2.2.4.1.cmml">⋅</mo><msub id="S3.E4.m1.1.1.1.1.2.2.4.3" xref="S3.E4.m1.1.1.1.1.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.2.2.4.3.2" xref="S3.E4.m1.1.1.1.1.2.2.4.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.2.2.4.3.3" xref="S3.E4.m1.1.1.1.1.2.2.4.3.3a.cmml">rec</mtext></msub></mrow><mo id="S3.E4.m1.1.1.1.1.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.4" xref="S3.E4.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.4.5" xref="S3.E4.m1.1.1.1.1.4.5.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1.4.4" xref="S3.E4.m1.1.1.1.1.4.4.cmml"><mrow id="S3.E4.m1.1.1.1.1.4.4.4" xref="S3.E4.m1.1.1.1.1.4.4.4.cmml"><mn id="S3.E4.m1.1.1.1.1.4.4.4.2" xref="S3.E4.m1.1.1.1.1.4.4.4.2.cmml">10</mn><mo id="S3.E4.m1.1.1.1.1.4.4.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.1.1.1.1.4.4.4.1.cmml">⋅</mo><msub id="S3.E4.m1.1.1.1.1.4.4.4.3" xref="S3.E4.m1.1.1.1.1.4.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.4.4.4.3.2" xref="S3.E4.m1.1.1.1.1.4.4.4.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.4.4.4.3.3" xref="S3.E4.m1.1.1.1.1.4.4.4.3.3a.cmml">perc</mtext></msub></mrow><mo id="S3.E4.m1.1.1.1.1.4.4.3" xref="S3.E4.m1.1.1.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.4.4.2.2" xref="S3.E4.m1.1.1.1.1.4.4.2.3.cmml"><mo id="S3.E4.m1.1.1.1.1.4.4.2.2.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.4.4.2.3.cmml">(</mo><msubsup id="S3.E4.m1.1.1.1.1.3.3.1.1.1" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.2.cmml">y</mi><mi id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.3.cmml">c</mi><mo id="S3.E4.m1.1.1.1.1.3.3.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.1.1.1.1.4.4.2.2.4" xref="S3.E4.m1.1.1.1.1.4.4.2.3.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.4.4.2.2.2" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.4.4.2.2.2.2" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.1.1.1.1.4.4.2.2.2.3" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2.3.cmml">c</mi></msub><mo id="S3.E4.m1.1.1.1.1.4.4.2.2.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.5"></eq><apply id="S3.E4.m1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.6.1.cmml" xref="S3.E4.m1.1.1.1.1.6">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.6.2.cmml" xref="S3.E4.m1.1.1.1.1.6.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.6.3a.cmml" xref="S3.E4.m1.1.1.1.1.6.3"><mtext id="S3.E4.m1.1.1.1.1.6.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.6.3">aux</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"><plus id="S3.E4.m1.1.1.1.1.4.5.cmml" xref="S3.E4.m1.1.1.1.1.4.5"></plus><apply id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2"><times id="S3.E4.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3"></times><apply id="S3.E4.m1.1.1.1.1.2.2.4.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4"><ci id="S3.E4.m1.1.1.1.1.2.2.4.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4.1">⋅</ci><cn id="S3.E4.m1.1.1.1.1.2.2.4.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.2.4.2">5</cn><apply id="S3.E4.m1.1.1.1.1.2.2.4.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.2.2.4.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.2.4.3.3"><mtext id="S3.E4.m1.1.1.1.1.2.2.4.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.2.2.4.3.3">rec</mtext></ci></apply></apply><interval closure="open" id="S3.E4.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3">𝑐</ci></apply></interval></apply><apply id="S3.E4.m1.1.1.1.1.4.4.cmml" xref="S3.E4.m1.1.1.1.1.4.4"><times id="S3.E4.m1.1.1.1.1.4.4.3.cmml" xref="S3.E4.m1.1.1.1.1.4.4.3"></times><apply id="S3.E4.m1.1.1.1.1.4.4.4.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4"><ci id="S3.E4.m1.1.1.1.1.4.4.4.1.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4.1">⋅</ci><cn id="S3.E4.m1.1.1.1.1.4.4.4.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.4.4.4.2">10</cn><apply id="S3.E4.m1.1.1.1.1.4.4.4.3.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.4.4.4.3.1.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.4.4.4.3.2.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.4.4.4.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.4.4.4.3.3"><mtext id="S3.E4.m1.1.1.1.1.4.4.4.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.4.4.4.3.3">perc</mtext></ci></apply></apply><interval closure="open" id="S3.E4.m1.1.1.1.1.4.4.2.3.cmml" xref="S3.E4.m1.1.1.1.1.4.4.2.2"><apply id="S3.E4.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.2">𝑦</ci><ci id="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1.1.1.3">′</ci></apply><apply id="S3.E4.m1.1.1.1.1.4.4.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.1.1.1.1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.4.4.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathcal{L}_{\text{aux}}=5\cdot\mathcal{L}_{\text{rec}}({y}_{c}^{\prime},y_{c}%
)+10\cdot\mathcal{L}_{\text{perc}}({y}_{c}^{\prime},y_{c}),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT aux end_POSTSUBSCRIPT = 5 ⋅ caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + 10 ⋅ caligraphic_L start_POSTSUBSCRIPT perc end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.23">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{rec}}=0.1\cdot\mathcal{L}_{1}({y}_{c}^{\prime},y_{c})+0.9%
\cdot\mathcal{L}_{2}({y}_{c}^{\prime},y_{c})," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.6" xref="S3.E5.m1.1.1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.6.2" xref="S3.E5.m1.1.1.1.1.6.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.1.1.6.3" xref="S3.E5.m1.1.1.1.1.6.3a.cmml">rec</mtext></msub><mo id="S3.E5.m1.1.1.1.1.5" xref="S3.E5.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.4.cmml"><mrow id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E5.m1.1.1.1.1.2.2.4" xref="S3.E5.m1.1.1.1.1.2.2.4.cmml"><mn id="S3.E5.m1.1.1.1.1.2.2.4.2" xref="S3.E5.m1.1.1.1.1.2.2.4.2.cmml">0.1</mn><mo id="S3.E5.m1.1.1.1.1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.2.2.4.1.cmml">⋅</mo><msub id="S3.E5.m1.1.1.1.1.2.2.4.3" xref="S3.E5.m1.1.1.1.1.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2.2.4.3.2" xref="S3.E5.m1.1.1.1.1.2.2.4.3.2.cmml">ℒ</mi><mn id="S3.E5.m1.1.1.1.1.2.2.4.3.3" xref="S3.E5.m1.1.1.1.1.2.2.4.3.3.cmml">1</mn></msub></mrow><mo id="S3.E5.m1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E5.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.1.1.1.1.2.2.2.2.4" xref="S3.E5.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.E5.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.4.5" xref="S3.E5.m1.1.1.1.1.4.5.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.4.4" xref="S3.E5.m1.1.1.1.1.4.4.cmml"><mrow id="S3.E5.m1.1.1.1.1.4.4.4" xref="S3.E5.m1.1.1.1.1.4.4.4.cmml"><mn id="S3.E5.m1.1.1.1.1.4.4.4.2" xref="S3.E5.m1.1.1.1.1.4.4.4.2.cmml">0.9</mn><mo id="S3.E5.m1.1.1.1.1.4.4.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.4.4.4.1.cmml">⋅</mo><msub id="S3.E5.m1.1.1.1.1.4.4.4.3" xref="S3.E5.m1.1.1.1.1.4.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.4.4.4.3.2" xref="S3.E5.m1.1.1.1.1.4.4.4.3.2.cmml">ℒ</mi><mn id="S3.E5.m1.1.1.1.1.4.4.4.3.3" xref="S3.E5.m1.1.1.1.1.4.4.4.3.3.cmml">2</mn></msub></mrow><mo id="S3.E5.m1.1.1.1.1.4.4.3" xref="S3.E5.m1.1.1.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.4.4.2.2" xref="S3.E5.m1.1.1.1.1.4.4.2.3.cmml"><mo id="S3.E5.m1.1.1.1.1.4.4.2.2.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.4.4.2.3.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.3.3.1.1.1" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.2.cmml">y</mi><mi id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.3.cmml">c</mi><mo id="S3.E5.m1.1.1.1.1.3.3.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.1.1.1.1.4.4.2.2.4" xref="S3.E5.m1.1.1.1.1.4.4.2.3.cmml">,</mo><msub id="S3.E5.m1.1.1.1.1.4.4.2.2.2" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.4.4.2.2.2.2" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E5.m1.1.1.1.1.4.4.2.2.2.3" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2.3.cmml">c</mi></msub><mo id="S3.E5.m1.1.1.1.1.4.4.2.2.5" stretchy="false" xref="S3.E5.m1.1.1.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.5.cmml" xref="S3.E5.m1.1.1.1.1.5"></eq><apply id="S3.E5.m1.1.1.1.1.6.cmml" xref="S3.E5.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.6.1.cmml" xref="S3.E5.m1.1.1.1.1.6">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.6.2.cmml" xref="S3.E5.m1.1.1.1.1.6.2">ℒ</ci><ci id="S3.E5.m1.1.1.1.1.6.3a.cmml" xref="S3.E5.m1.1.1.1.1.6.3"><mtext id="S3.E5.m1.1.1.1.1.6.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.1.1.6.3">rec</mtext></ci></apply><apply id="S3.E5.m1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.4"><plus id="S3.E5.m1.1.1.1.1.4.5.cmml" xref="S3.E5.m1.1.1.1.1.4.5"></plus><apply id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2"><times id="S3.E5.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3"></times><apply id="S3.E5.m1.1.1.1.1.2.2.4.cmml" xref="S3.E5.m1.1.1.1.1.2.2.4"><ci id="S3.E5.m1.1.1.1.1.2.2.4.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.4.1">⋅</ci><cn id="S3.E5.m1.1.1.1.1.2.2.4.2.cmml" type="float" xref="S3.E5.m1.1.1.1.1.2.2.4.2">0.1</cn><apply id="S3.E5.m1.1.1.1.1.2.2.4.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.4.3.2">ℒ</ci><cn id="S3.E5.m1.1.1.1.1.2.2.4.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.2.2.4.3.3">1</cn></apply></apply><interval closure="open" id="S3.E5.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.3">𝑐</ci></apply></interval></apply><apply id="S3.E5.m1.1.1.1.1.4.4.cmml" xref="S3.E5.m1.1.1.1.1.4.4"><times id="S3.E5.m1.1.1.1.1.4.4.3.cmml" xref="S3.E5.m1.1.1.1.1.4.4.3"></times><apply id="S3.E5.m1.1.1.1.1.4.4.4.cmml" xref="S3.E5.m1.1.1.1.1.4.4.4"><ci id="S3.E5.m1.1.1.1.1.4.4.4.1.cmml" xref="S3.E5.m1.1.1.1.1.4.4.4.1">⋅</ci><cn id="S3.E5.m1.1.1.1.1.4.4.4.2.cmml" type="float" xref="S3.E5.m1.1.1.1.1.4.4.4.2">0.9</cn><apply id="S3.E5.m1.1.1.1.1.4.4.4.3.cmml" xref="S3.E5.m1.1.1.1.1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.4.4.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.4.4.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.4.4.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.4.4.4.3.2">ℒ</ci><cn id="S3.E5.m1.1.1.1.1.4.4.4.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.4.4.4.3.3">2</cn></apply></apply><interval closure="open" id="S3.E5.m1.1.1.1.1.4.4.2.3.cmml" xref="S3.E5.m1.1.1.1.1.4.4.2.2"><apply id="S3.E5.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.2">𝑦</ci><ci id="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E5.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1.1.1.3">′</ci></apply><apply id="S3.E5.m1.1.1.1.1.4.4.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2.2">𝑦</ci><ci id="S3.E5.m1.1.1.1.1.4.4.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.4.4.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}_{\text{rec}}=0.1\cdot\mathcal{L}_{1}({y}_{c}^{\prime},y_{c})+0.9%
\cdot\mathcal{L}_{2}({y}_{c}^{\prime},y_{c}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT = 0.1 ⋅ caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + 0.9 ⋅ caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{perc}}=\sum_{j=1}^{K}\sum_{i=1}^{N}|\phi_{j}({y^{\prime}_{c%
}}_{i})-\phi_{j}({y_{c}}_{i})|." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3a.cmml">perc</mtext></msub><mo id="S3.E6.m1.1.1.1.1.2" rspace="0.111em" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><munderover id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E6.m1.1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">′</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">ϕ</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mmultiscripts id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">y</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">c</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"></mrow><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">i</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1b" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"></mrow></mmultiscripts><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><mtext id="S3.E6.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.3">perc</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.3"><eq id="S3.E6.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E6.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E6.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E6.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><abs id="S3.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">′</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2">italic-ϕ</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.3">𝑐</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{L}_{\text{perc}}=\sum_{j=1}^{K}\sum_{i=1}^{N}|\phi_{j}({y^{\prime}_{c%
}}_{i})-\phi_{j}({y_{c}}_{i})|.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT perc end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT | italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) | .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.14"><math alttext="\mathcal{L}_{\text{rec}}" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m1.1"><semantics id="S3.SS4.p2.6.m1.1a"><msub id="S3.SS4.p2.6.m1.1.1" xref="S3.SS4.p2.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.6.m1.1.1.2" xref="S3.SS4.p2.6.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.6.m1.1.1.3" xref="S3.SS4.p2.6.m1.1.1.3a.cmml">rec</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m1.1b"><apply id="S3.SS4.p2.6.m1.1.1.cmml" xref="S3.SS4.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m1.1.1.1.cmml" xref="S3.SS4.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.m1.1.1.2.cmml" xref="S3.SS4.p2.6.m1.1.1.2">ℒ</ci><ci id="S3.SS4.p2.6.m1.1.1.3a.cmml" xref="S3.SS4.p2.6.m1.1.1.3"><mtext id="S3.SS4.p2.6.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.6.m1.1.1.3">rec</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m1.1c">\mathcal{L}_{\text{rec}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m1.1d">caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT</annotation></semantics></math> represents the reconstruction loss, it a combination of <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m2.1"><semantics id="S3.SS4.p2.7.m2.1a"><msub id="S3.SS4.p2.7.m2.1.1" xref="S3.SS4.p2.7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.7.m2.1.1.2" xref="S3.SS4.p2.7.m2.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.p2.7.m2.1.1.3" xref="S3.SS4.p2.7.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m2.1b"><apply id="S3.SS4.p2.7.m2.1.1.cmml" xref="S3.SS4.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m2.1.1.1.cmml" xref="S3.SS4.p2.7.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.7.m2.1.1.2.cmml" xref="S3.SS4.p2.7.m2.1.1.2">ℒ</ci><cn id="S3.SS4.p2.7.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p2.7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m2.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m2.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss and <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m3.1"><semantics id="S3.SS4.p2.8.m3.1a"><msub id="S3.SS4.p2.8.m3.1.1" xref="S3.SS4.p2.8.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.8.m3.1.1.2" xref="S3.SS4.p2.8.m3.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.p2.8.m3.1.1.3" xref="S3.SS4.p2.8.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m3.1b"><apply id="S3.SS4.p2.8.m3.1.1.cmml" xref="S3.SS4.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m3.1.1.1.cmml" xref="S3.SS4.p2.8.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.8.m3.1.1.2.cmml" xref="S3.SS4.p2.8.m3.1.1.2">ℒ</ci><cn id="S3.SS4.p2.8.m3.1.1.3.cmml" type="integer" xref="S3.SS4.p2.8.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m3.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m3.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> loss. <math alttext="\mathcal{L}_{\text{perc}}" class="ltx_Math" display="inline" id="S3.SS4.p2.9.m4.1"><semantics id="S3.SS4.p2.9.m4.1a"><msub id="S3.SS4.p2.9.m4.1.1" xref="S3.SS4.p2.9.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.9.m4.1.1.2" xref="S3.SS4.p2.9.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p2.9.m4.1.1.3" xref="S3.SS4.p2.9.m4.1.1.3a.cmml">perc</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m4.1b"><apply id="S3.SS4.p2.9.m4.1.1.cmml" xref="S3.SS4.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m4.1.1.1.cmml" xref="S3.SS4.p2.9.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.9.m4.1.1.2.cmml" xref="S3.SS4.p2.9.m4.1.1.2">ℒ</ci><ci id="S3.SS4.p2.9.m4.1.1.3a.cmml" xref="S3.SS4.p2.9.m4.1.1.3"><mtext id="S3.SS4.p2.9.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.9.m4.1.1.3">perc</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m4.1c">\mathcal{L}_{\text{perc}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.9.m4.1d">caligraphic_L start_POSTSUBSCRIPT perc end_POSTSUBSCRIPT</annotation></semantics></math> denotes the perpetual loss, obtained by using a pre-trained VGG-16 network <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib38" title="">38</a>]</cite>. <math alttext="\phi_{j}" class="ltx_Math" display="inline" id="S3.SS4.p2.10.m5.1"><semantics id="S3.SS4.p2.10.m5.1a"><msub id="S3.SS4.p2.10.m5.1.1" xref="S3.SS4.p2.10.m5.1.1.cmml"><mi id="S3.SS4.p2.10.m5.1.1.2" xref="S3.SS4.p2.10.m5.1.1.2.cmml">ϕ</mi><mi id="S3.SS4.p2.10.m5.1.1.3" xref="S3.SS4.p2.10.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m5.1b"><apply id="S3.SS4.p2.10.m5.1.1.cmml" xref="S3.SS4.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m5.1.1.1.cmml" xref="S3.SS4.p2.10.m5.1.1">subscript</csymbol><ci id="S3.SS4.p2.10.m5.1.1.2.cmml" xref="S3.SS4.p2.10.m5.1.1.2">italic-ϕ</ci><ci id="S3.SS4.p2.10.m5.1.1.3.cmml" xref="S3.SS4.p2.10.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m5.1c">\phi_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.10.m5.1d">italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="j^{th}" class="ltx_Math" display="inline" id="S3.SS4.p2.11.m6.1"><semantics id="S3.SS4.p2.11.m6.1a"><msup id="S3.SS4.p2.11.m6.1.1" xref="S3.SS4.p2.11.m6.1.1.cmml"><mi id="S3.SS4.p2.11.m6.1.1.2" xref="S3.SS4.p2.11.m6.1.1.2.cmml">j</mi><mrow id="S3.SS4.p2.11.m6.1.1.3" xref="S3.SS4.p2.11.m6.1.1.3.cmml"><mi id="S3.SS4.p2.11.m6.1.1.3.2" xref="S3.SS4.p2.11.m6.1.1.3.2.cmml">t</mi><mo id="S3.SS4.p2.11.m6.1.1.3.1" xref="S3.SS4.p2.11.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.11.m6.1.1.3.3" xref="S3.SS4.p2.11.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.11.m6.1b"><apply id="S3.SS4.p2.11.m6.1.1.cmml" xref="S3.SS4.p2.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.11.m6.1.1.1.cmml" xref="S3.SS4.p2.11.m6.1.1">superscript</csymbol><ci id="S3.SS4.p2.11.m6.1.1.2.cmml" xref="S3.SS4.p2.11.m6.1.1.2">𝑗</ci><apply id="S3.SS4.p2.11.m6.1.1.3.cmml" xref="S3.SS4.p2.11.m6.1.1.3"><times id="S3.SS4.p2.11.m6.1.1.3.1.cmml" xref="S3.SS4.p2.11.m6.1.1.3.1"></times><ci id="S3.SS4.p2.11.m6.1.1.3.2.cmml" xref="S3.SS4.p2.11.m6.1.1.3.2">𝑡</ci><ci id="S3.SS4.p2.11.m6.1.1.3.3.cmml" xref="S3.SS4.p2.11.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.11.m6.1c">j^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.11.m6.1d">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> pooling layer’s activation map in the VGG-16, and this module selects pool-1, pool-2, and pool-3. <math alttext="y_{c}" class="ltx_Math" display="inline" id="S3.SS4.p2.12.m7.1"><semantics id="S3.SS4.p2.12.m7.1a"><msub id="S3.SS4.p2.12.m7.1.1" xref="S3.SS4.p2.12.m7.1.1.cmml"><mi id="S3.SS4.p2.12.m7.1.1.2" xref="S3.SS4.p2.12.m7.1.1.2.cmml">y</mi><mi id="S3.SS4.p2.12.m7.1.1.3" xref="S3.SS4.p2.12.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.12.m7.1b"><apply id="S3.SS4.p2.12.m7.1.1.cmml" xref="S3.SS4.p2.12.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.12.m7.1.1.1.cmml" xref="S3.SS4.p2.12.m7.1.1">subscript</csymbol><ci id="S3.SS4.p2.12.m7.1.1.2.cmml" xref="S3.SS4.p2.12.m7.1.1.2">𝑦</ci><ci id="S3.SS4.p2.12.m7.1.1.3.cmml" xref="S3.SS4.p2.12.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.12.m7.1c">y_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.12.m7.1d">italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the crop patch of the labeled image and <math alttext="y^{\prime}_{c}" class="ltx_Math" display="inline" id="S3.SS4.p2.13.m8.1"><semantics id="S3.SS4.p2.13.m8.1a"><msubsup id="S3.SS4.p2.13.m8.1.1" xref="S3.SS4.p2.13.m8.1.1.cmml"><mi id="S3.SS4.p2.13.m8.1.1.2.2" xref="S3.SS4.p2.13.m8.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p2.13.m8.1.1.3" xref="S3.SS4.p2.13.m8.1.1.3.cmml">c</mi><mo id="S3.SS4.p2.13.m8.1.1.2.3" xref="S3.SS4.p2.13.m8.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.13.m8.1b"><apply id="S3.SS4.p2.13.m8.1.1.cmml" xref="S3.SS4.p2.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m8.1.1.1.cmml" xref="S3.SS4.p2.13.m8.1.1">subscript</csymbol><apply id="S3.SS4.p2.13.m8.1.1.2.cmml" xref="S3.SS4.p2.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m8.1.1.2.1.cmml" xref="S3.SS4.p2.13.m8.1.1">superscript</csymbol><ci id="S3.SS4.p2.13.m8.1.1.2.2.cmml" xref="S3.SS4.p2.13.m8.1.1.2.2">𝑦</ci><ci id="S3.SS4.p2.13.m8.1.1.2.3.cmml" xref="S3.SS4.p2.13.m8.1.1.2.3">′</ci></apply><ci id="S3.SS4.p2.13.m8.1.1.3.cmml" xref="S3.SS4.p2.13.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.13.m8.1c">y^{\prime}_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.13.m8.1d">italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding prediction of the generator. <math alttext="D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)" class="ltx_Math" display="inline" id="S3.SS4.p2.14.m9.3"><semantics id="S3.SS4.p2.14.m9.3a"><mrow id="S3.SS4.p2.14.m9.3.3" xref="S3.SS4.p2.14.m9.3.3.cmml"><msub id="S3.SS4.p2.14.m9.3.3.4" xref="S3.SS4.p2.14.m9.3.3.4.cmml"><mi id="S3.SS4.p2.14.m9.3.3.4.2" xref="S3.SS4.p2.14.m9.3.3.4.2.cmml">D</mi><mtext id="S3.SS4.p2.14.m9.3.3.4.3" xref="S3.SS4.p2.14.m9.3.3.4.3a.cmml">sn</mtext></msub><mo id="S3.SS4.p2.14.m9.3.3.3" xref="S3.SS4.p2.14.m9.3.3.3.cmml">⁢</mo><mrow id="S3.SS4.p2.14.m9.3.3.2.2" xref="S3.SS4.p2.14.m9.3.3.2.3.cmml"><mo id="S3.SS4.p2.14.m9.3.3.2.2.3" stretchy="false" xref="S3.SS4.p2.14.m9.3.3.2.3.cmml">(</mo><msubsup id="S3.SS4.p2.14.m9.2.2.1.1.1" xref="S3.SS4.p2.14.m9.2.2.1.1.1.cmml"><mi id="S3.SS4.p2.14.m9.2.2.1.1.1.2.2" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.cmml"><mi id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.2" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.1" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.3" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p2.14.m9.2.2.1.1.1.3" xref="S3.SS4.p2.14.m9.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.14.m9.3.3.2.2.4" xref="S3.SS4.p2.14.m9.3.3.2.3.cmml">,</mo><msub id="S3.SS4.p2.14.m9.3.3.2.2.2" xref="S3.SS4.p2.14.m9.3.3.2.2.2.cmml"><mi id="S3.SS4.p2.14.m9.3.3.2.2.2.2" xref="S3.SS4.p2.14.m9.3.3.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p2.14.m9.3.3.2.2.2.3" xref="S3.SS4.p2.14.m9.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS4.p2.14.m9.3.3.2.2.5" xref="S3.SS4.p2.14.m9.3.3.2.3.cmml">,</mo><mi id="S3.SS4.p2.14.m9.1.1" xref="S3.SS4.p2.14.m9.1.1.cmml">t</mi><mo id="S3.SS4.p2.14.m9.3.3.2.2.6" stretchy="false" xref="S3.SS4.p2.14.m9.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.14.m9.3b"><apply id="S3.SS4.p2.14.m9.3.3.cmml" xref="S3.SS4.p2.14.m9.3.3"><times id="S3.SS4.p2.14.m9.3.3.3.cmml" xref="S3.SS4.p2.14.m9.3.3.3"></times><apply id="S3.SS4.p2.14.m9.3.3.4.cmml" xref="S3.SS4.p2.14.m9.3.3.4"><csymbol cd="ambiguous" id="S3.SS4.p2.14.m9.3.3.4.1.cmml" xref="S3.SS4.p2.14.m9.3.3.4">subscript</csymbol><ci id="S3.SS4.p2.14.m9.3.3.4.2.cmml" xref="S3.SS4.p2.14.m9.3.3.4.2">𝐷</ci><ci id="S3.SS4.p2.14.m9.3.3.4.3a.cmml" xref="S3.SS4.p2.14.m9.3.3.4.3"><mtext id="S3.SS4.p2.14.m9.3.3.4.3.cmml" mathsize="70%" xref="S3.SS4.p2.14.m9.3.3.4.3">sn</mtext></ci></apply><vector id="S3.SS4.p2.14.m9.3.3.2.3.cmml" xref="S3.SS4.p2.14.m9.3.3.2.2"><apply id="S3.SS4.p2.14.m9.2.2.1.1.1.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.14.m9.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.14.m9.2.2.1.1.1.2.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.14.m9.2.2.1.1.1.2.1.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.14.m9.2.2.1.1.1.2.2.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.2">𝑦</ci><apply id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3"><minus id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.1.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.1"></minus><ci id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.2.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p2.14.m9.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p2.14.m9.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.14.m9.2.2.1.1.1.3">′</ci></apply><apply id="S3.SS4.p2.14.m9.3.3.2.2.2.cmml" xref="S3.SS4.p2.14.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.14.m9.3.3.2.2.2.1.cmml" xref="S3.SS4.p2.14.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.14.m9.3.3.2.2.2.2.cmml" xref="S3.SS4.p2.14.m9.3.3.2.2.2.2">𝑦</ci><ci id="S3.SS4.p2.14.m9.3.3.2.2.2.3.cmml" xref="S3.SS4.p2.14.m9.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.14.m9.1.1.cmml" xref="S3.SS4.p2.14.m9.1.1">𝑡</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.14.m9.3c">D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.14.m9.3d">italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math> is the original adversarial loss of WaveDiff, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)=\sigma({\mathcal{FC}}({\mathcal{OP}}%
({cat}(y_{t-1}^{\prime},y_{t}),t)))," class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><msub id="S3.E7.m1.3.3.1.1.2.4" xref="S3.E7.m1.3.3.1.1.2.4.cmml"><mi id="S3.E7.m1.3.3.1.1.2.4.2" xref="S3.E7.m1.3.3.1.1.2.4.2.cmml">D</mi><mtext id="S3.E7.m1.3.3.1.1.2.4.3" xref="S3.E7.m1.3.3.1.1.2.4.3a.cmml">sn</mtext></msub><mo id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml"><mo id="S3.E7.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E7.m1.3.3.1.1.2.2.2.4" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E7.m1.3.3.1.1.2.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.2.2.cmml">y</mi><mi id="S3.E7.m1.3.3.1.1.2.2.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E7.m1.3.3.1.1.2.2.2.5" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.2.2.2.6" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.4" xref="S3.E7.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.3" xref="S3.E7.m1.3.3.1.1.3.3.cmml">σ</mi><mo id="S3.E7.m1.3.3.1.1.3.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.cmml"><mo id="S3.E7.m1.3.3.1.1.3.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.3.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.3.cmml">ℱ</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.3.1.1.1.4" xref="S3.E7.m1.3.3.1.1.3.1.1.1.4.cmml">𝒞</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.2a" xref="S3.E7.m1.3.3.1.1.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml">𝒪</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.4" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.4.cmml">𝒫</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2a" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.4.cmml">c</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.5" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.5.cmml">a</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3a" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.6" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.6.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3b" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.3.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.4"></eq><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><times id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3"></times><apply id="S3.E7.m1.3.3.1.1.2.4.cmml" xref="S3.E7.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.4.1.cmml" xref="S3.E7.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.4.2.cmml" xref="S3.E7.m1.3.3.1.1.2.4.2">𝐷</ci><ci id="S3.E7.m1.3.3.1.1.2.4.3a.cmml" xref="S3.E7.m1.3.3.1.1.2.4.3"><mtext id="S3.E7.m1.3.3.1.1.2.4.3.cmml" mathsize="70%" xref="S3.E7.m1.3.3.1.1.2.4.3">sn</mtext></ci></apply><vector id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2"><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E7.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2.2">𝑦</ci><ci id="S3.E7.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝑡</ci></vector></apply><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"><times id="S3.E7.m1.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2"></times><ci id="S3.E7.m1.3.3.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.3.3">𝜎</ci><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1"><times id="S3.E7.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.2"></times><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.3">ℱ</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.4">𝒞</ci><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.3">𝒪</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.4">𝒫</ci><interval closure="open" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1"><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.4">𝑐</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.5">𝑎</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.6">𝑡</ci><interval closure="open" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝑡</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">D_{\text{sn}}({y}_{t-1}^{\prime},y_{t},t)=\sigma({\mathcal{FC}}({\mathcal{OP}}%
({cat}(y_{t-1}^{\prime},y_{t}),t))),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) = italic_σ ( caligraphic_F caligraphic_C ( caligraphic_O caligraphic_P ( italic_c italic_a italic_t ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , italic_t ) ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.21">where <math alttext="{cat}(y_{t-1}^{\prime},y_{t})" class="ltx_Math" display="inline" id="S3.SS4.p2.15.m1.2"><semantics id="S3.SS4.p2.15.m1.2a"><mrow id="S3.SS4.p2.15.m1.2.2" xref="S3.SS4.p2.15.m1.2.2.cmml"><mi id="S3.SS4.p2.15.m1.2.2.4" xref="S3.SS4.p2.15.m1.2.2.4.cmml">c</mi><mo id="S3.SS4.p2.15.m1.2.2.3" xref="S3.SS4.p2.15.m1.2.2.3.cmml">⁢</mo><mi id="S3.SS4.p2.15.m1.2.2.5" xref="S3.SS4.p2.15.m1.2.2.5.cmml">a</mi><mo id="S3.SS4.p2.15.m1.2.2.3a" xref="S3.SS4.p2.15.m1.2.2.3.cmml">⁢</mo><mi id="S3.SS4.p2.15.m1.2.2.6" xref="S3.SS4.p2.15.m1.2.2.6.cmml">t</mi><mo id="S3.SS4.p2.15.m1.2.2.3b" xref="S3.SS4.p2.15.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS4.p2.15.m1.2.2.2.2" xref="S3.SS4.p2.15.m1.2.2.2.3.cmml"><mo id="S3.SS4.p2.15.m1.2.2.2.2.3" stretchy="false" xref="S3.SS4.p2.15.m1.2.2.2.3.cmml">(</mo><msubsup id="S3.SS4.p2.15.m1.1.1.1.1.1" xref="S3.SS4.p2.15.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.15.m1.1.1.1.1.1.2.2" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.2" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.1" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.3" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p2.15.m1.1.1.1.1.1.3" xref="S3.SS4.p2.15.m1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.15.m1.2.2.2.2.4" xref="S3.SS4.p2.15.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p2.15.m1.2.2.2.2.2" xref="S3.SS4.p2.15.m1.2.2.2.2.2.cmml"><mi id="S3.SS4.p2.15.m1.2.2.2.2.2.2" xref="S3.SS4.p2.15.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p2.15.m1.2.2.2.2.2.3" xref="S3.SS4.p2.15.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS4.p2.15.m1.2.2.2.2.5" stretchy="false" xref="S3.SS4.p2.15.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.15.m1.2b"><apply id="S3.SS4.p2.15.m1.2.2.cmml" xref="S3.SS4.p2.15.m1.2.2"><times id="S3.SS4.p2.15.m1.2.2.3.cmml" xref="S3.SS4.p2.15.m1.2.2.3"></times><ci id="S3.SS4.p2.15.m1.2.2.4.cmml" xref="S3.SS4.p2.15.m1.2.2.4">𝑐</ci><ci id="S3.SS4.p2.15.m1.2.2.5.cmml" xref="S3.SS4.p2.15.m1.2.2.5">𝑎</ci><ci id="S3.SS4.p2.15.m1.2.2.6.cmml" xref="S3.SS4.p2.15.m1.2.2.6">𝑡</ci><interval closure="open" id="S3.SS4.p2.15.m1.2.2.2.3.cmml" xref="S3.SS4.p2.15.m1.2.2.2.2"><apply id="S3.SS4.p2.15.m1.1.1.1.1.1.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.15.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.15.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.15.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.15.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3"><minus id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.1"></minus><ci id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p2.15.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p2.15.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.15.m1.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS4.p2.15.m1.2.2.2.2.2.cmml" xref="S3.SS4.p2.15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.15.m1.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.15.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.15.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.15.m1.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS4.p2.15.m1.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.15.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.15.m1.2c">{cat}(y_{t-1}^{\prime},y_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.15.m1.2d">italic_c italic_a italic_t ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the operation of concatenating <math alttext="y_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p2.16.m2.1"><semantics id="S3.SS4.p2.16.m2.1a"><msubsup id="S3.SS4.p2.16.m2.1.1" xref="S3.SS4.p2.16.m2.1.1.cmml"><mi id="S3.SS4.p2.16.m2.1.1.2.2" xref="S3.SS4.p2.16.m2.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p2.16.m2.1.1.2.3" xref="S3.SS4.p2.16.m2.1.1.2.3.cmml"><mi id="S3.SS4.p2.16.m2.1.1.2.3.2" xref="S3.SS4.p2.16.m2.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p2.16.m2.1.1.2.3.1" xref="S3.SS4.p2.16.m2.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p2.16.m2.1.1.2.3.3" xref="S3.SS4.p2.16.m2.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p2.16.m2.1.1.3" xref="S3.SS4.p2.16.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.16.m2.1b"><apply id="S3.SS4.p2.16.m2.1.1.cmml" xref="S3.SS4.p2.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.16.m2.1.1.1.cmml" xref="S3.SS4.p2.16.m2.1.1">superscript</csymbol><apply id="S3.SS4.p2.16.m2.1.1.2.cmml" xref="S3.SS4.p2.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.16.m2.1.1.2.1.cmml" xref="S3.SS4.p2.16.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.16.m2.1.1.2.2.cmml" xref="S3.SS4.p2.16.m2.1.1.2.2">𝑦</ci><apply id="S3.SS4.p2.16.m2.1.1.2.3.cmml" xref="S3.SS4.p2.16.m2.1.1.2.3"><minus id="S3.SS4.p2.16.m2.1.1.2.3.1.cmml" xref="S3.SS4.p2.16.m2.1.1.2.3.1"></minus><ci id="S3.SS4.p2.16.m2.1.1.2.3.2.cmml" xref="S3.SS4.p2.16.m2.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p2.16.m2.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p2.16.m2.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p2.16.m2.1.1.3.cmml" xref="S3.SS4.p2.16.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.16.m2.1c">y_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.16.m2.1d">italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS4.p2.17.m3.1"><semantics id="S3.SS4.p2.17.m3.1a"><msub id="S3.SS4.p2.17.m3.1.1" xref="S3.SS4.p2.17.m3.1.1.cmml"><mi id="S3.SS4.p2.17.m3.1.1.2" xref="S3.SS4.p2.17.m3.1.1.2.cmml">y</mi><mi id="S3.SS4.p2.17.m3.1.1.3" xref="S3.SS4.p2.17.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.17.m3.1b"><apply id="S3.SS4.p2.17.m3.1.1.cmml" xref="S3.SS4.p2.17.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.17.m3.1.1.1.cmml" xref="S3.SS4.p2.17.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.17.m3.1.1.2.cmml" xref="S3.SS4.p2.17.m3.1.1.2">𝑦</ci><ci id="S3.SS4.p2.17.m3.1.1.3.cmml" xref="S3.SS4.p2.17.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.17.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.17.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> along a specified dimension. The function <math alttext="{\mathcal{OP}}" class="ltx_Math" display="inline" id="S3.SS4.p2.18.m4.1"><semantics id="S3.SS4.p2.18.m4.1a"><mrow id="S3.SS4.p2.18.m4.1.1" xref="S3.SS4.p2.18.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.18.m4.1.1.2" xref="S3.SS4.p2.18.m4.1.1.2.cmml">𝒪</mi><mo id="S3.SS4.p2.18.m4.1.1.1" xref="S3.SS4.p2.18.m4.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.18.m4.1.1.3" xref="S3.SS4.p2.18.m4.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.18.m4.1b"><apply id="S3.SS4.p2.18.m4.1.1.cmml" xref="S3.SS4.p2.18.m4.1.1"><times id="S3.SS4.p2.18.m4.1.1.1.cmml" xref="S3.SS4.p2.18.m4.1.1.1"></times><ci id="S3.SS4.p2.18.m4.1.1.2.cmml" xref="S3.SS4.p2.18.m4.1.1.2">𝒪</ci><ci id="S3.SS4.p2.18.m4.1.1.3.cmml" xref="S3.SS4.p2.18.m4.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.18.m4.1c">{\mathcal{OP}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.18.m4.1d">caligraphic_O caligraphic_P</annotation></semantics></math> refers to a series of operations, typically involving convolutional layers followed by batch normalization and non-linear activations, which are designed to extract and refine features from the concatenated tensor. The term <math alttext="\mathcal{FC}" class="ltx_Math" display="inline" id="S3.SS4.p2.19.m5.1"><semantics id="S3.SS4.p2.19.m5.1a"><mrow id="S3.SS4.p2.19.m5.1.1" xref="S3.SS4.p2.19.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.19.m5.1.1.2" xref="S3.SS4.p2.19.m5.1.1.2.cmml">ℱ</mi><mo id="S3.SS4.p2.19.m5.1.1.1" xref="S3.SS4.p2.19.m5.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.19.m5.1.1.3" xref="S3.SS4.p2.19.m5.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.19.m5.1b"><apply id="S3.SS4.p2.19.m5.1.1.cmml" xref="S3.SS4.p2.19.m5.1.1"><times id="S3.SS4.p2.19.m5.1.1.1.cmml" xref="S3.SS4.p2.19.m5.1.1.1"></times><ci id="S3.SS4.p2.19.m5.1.1.2.cmml" xref="S3.SS4.p2.19.m5.1.1.2">ℱ</ci><ci id="S3.SS4.p2.19.m5.1.1.3.cmml" xref="S3.SS4.p2.19.m5.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.19.m5.1c">\mathcal{FC}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.19.m5.1d">caligraphic_F caligraphic_C</annotation></semantics></math> denotes the final fully connected layer, which receives these processed features and outputs a scalar value utilized for classification purposes. The function <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS4.p2.20.m6.1"><semantics id="S3.SS4.p2.20.m6.1a"><mi id="S3.SS4.p2.20.m6.1.1" xref="S3.SS4.p2.20.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.20.m6.1b"><ci id="S3.SS4.p2.20.m6.1.1.cmml" xref="S3.SS4.p2.20.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.20.m6.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.20.m6.1d">italic_σ</annotation></semantics></math> denotes the sigmoid activation, which maps the output of the <math alttext="\mathcal{FC}" class="ltx_Math" display="inline" id="S3.SS4.p2.21.m7.1"><semantics id="S3.SS4.p2.21.m7.1a"><mrow id="S3.SS4.p2.21.m7.1.1" xref="S3.SS4.p2.21.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.21.m7.1.1.2" xref="S3.SS4.p2.21.m7.1.1.2.cmml">ℱ</mi><mo id="S3.SS4.p2.21.m7.1.1.1" xref="S3.SS4.p2.21.m7.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.21.m7.1.1.3" xref="S3.SS4.p2.21.m7.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.21.m7.1b"><apply id="S3.SS4.p2.21.m7.1.1.cmml" xref="S3.SS4.p2.21.m7.1.1"><times id="S3.SS4.p2.21.m7.1.1.1.cmml" xref="S3.SS4.p2.21.m7.1.1.1"></times><ci id="S3.SS4.p2.21.m7.1.1.2.cmml" xref="S3.SS4.p2.21.m7.1.1.2">ℱ</ci><ci id="S3.SS4.p2.21.m7.1.1.3.cmml" xref="S3.SS4.p2.21.m7.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.21.m7.1c">\mathcal{FC}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.21.m7.1d">caligraphic_F caligraphic_C</annotation></semantics></math> layer to a probability between 0 and 1.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1">As for the discriminator loss, as shown in line 16 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg3" title="Algorithm 3 ‣ 3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>, it follows exactly the one of WaveDiff. The specific form of the discriminator loss is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t)." class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><msubsup id="S3.E8.m1.3.3.1.1.6" xref="S3.E8.m1.3.3.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.3.1.1.6.2.2" xref="S3.E8.m1.3.3.1.1.6.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.3.3.1.1.6.3" xref="S3.E8.m1.3.3.1.1.6.3a.cmml">sup</mtext><mi id="S3.E8.m1.3.3.1.1.6.2.3" xref="S3.E8.m1.3.3.1.1.6.2.3.cmml">D</mi></msubsup><mo id="S3.E8.m1.3.3.1.1.5" xref="S3.E8.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.4" xref="S3.E8.m1.3.3.1.1.4.cmml"><mrow id="S3.E8.m1.3.3.1.1.2.2" xref="S3.E8.m1.3.3.1.1.2.2.cmml"><mo id="S3.E8.m1.3.3.1.1.2.2a" rspace="0.167em" xref="S3.E8.m1.3.3.1.1.2.2.cmml">−</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.2.cmml"><mrow id="S3.E8.m1.3.3.1.1.2.2.2.4" xref="S3.E8.m1.3.3.1.1.2.2.2.4.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.2.4.1" xref="S3.E8.m1.3.3.1.1.2.2.2.4.1.cmml">log</mi><mo id="S3.E8.m1.3.3.1.1.2.2.2.4a" lspace="0.167em" xref="S3.E8.m1.3.3.1.1.2.2.2.4.cmml">⁡</mo><msub id="S3.E8.m1.3.3.1.1.2.2.2.4.2" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.2.4.2.2" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.2.cmml">D</mi><mtext id="S3.E8.m1.3.3.1.1.2.2.2.4.2.3" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="S3.E8.m1.3.3.1.1.2.2.2.3" xref="S3.E8.m1.3.3.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml"><mo id="S3.E8.m1.3.3.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E8.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.2.2.2.2.2.5" xref="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.2.2.2.2.2.6" stretchy="false" xref="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.4.5" xref="S3.E8.m1.3.3.1.1.4.5.cmml">+</mo><mrow id="S3.E8.m1.3.3.1.1.4.4" xref="S3.E8.m1.3.3.1.1.4.4.cmml"><mrow id="S3.E8.m1.3.3.1.1.4.4.4" xref="S3.E8.m1.3.3.1.1.4.4.4.cmml"><mi id="S3.E8.m1.3.3.1.1.4.4.4.1" xref="S3.E8.m1.3.3.1.1.4.4.4.1.cmml">log</mi><mo id="S3.E8.m1.3.3.1.1.4.4.4a" lspace="0.167em" xref="S3.E8.m1.3.3.1.1.4.4.4.cmml">⁡</mo><msub id="S3.E8.m1.3.3.1.1.4.4.4.2" xref="S3.E8.m1.3.3.1.1.4.4.4.2.cmml"><mi id="S3.E8.m1.3.3.1.1.4.4.4.2.2" xref="S3.E8.m1.3.3.1.1.4.4.4.2.2.cmml">D</mi><mtext id="S3.E8.m1.3.3.1.1.4.4.4.2.3" xref="S3.E8.m1.3.3.1.1.4.4.4.2.3a.cmml">sn</mtext></msub></mrow><mo id="S3.E8.m1.3.3.1.1.4.4.3" xref="S3.E8.m1.3.3.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.4.4.2.2" xref="S3.E8.m1.3.3.1.1.4.4.2.3.cmml"><mo id="S3.E8.m1.3.3.1.1.4.4.2.2.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.4.4.2.3.cmml">(</mo><msubsup id="S3.E8.m1.3.3.1.1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.2.cmml">y</mi><mrow id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.2" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.1" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.3" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E8.m1.3.3.1.1.3.3.1.1.1.3" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E8.m1.3.3.1.1.4.4.2.2.4" xref="S3.E8.m1.3.3.1.1.4.4.2.3.cmml">,</mo><msub id="S3.E8.m1.3.3.1.1.4.4.2.2.2" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2.cmml"><mi id="S3.E8.m1.3.3.1.1.4.4.2.2.2.2" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2.2.cmml">y</mi><mi id="S3.E8.m1.3.3.1.1.4.4.2.2.2.3" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.4.4.2.2.5" xref="S3.E8.m1.3.3.1.1.4.4.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.4.4.2.2.6" stretchy="false" xref="S3.E8.m1.3.3.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" lspace="0em" xref="S3.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><eq id="S3.E8.m1.3.3.1.1.5.cmml" xref="S3.E8.m1.3.3.1.1.5"></eq><apply id="S3.E8.m1.3.3.1.1.6.cmml" xref="S3.E8.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.6.1.cmml" xref="S3.E8.m1.3.3.1.1.6">subscript</csymbol><apply id="S3.E8.m1.3.3.1.1.6.2.cmml" xref="S3.E8.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.6.2.1.cmml" xref="S3.E8.m1.3.3.1.1.6">superscript</csymbol><ci id="S3.E8.m1.3.3.1.1.6.2.2.cmml" xref="S3.E8.m1.3.3.1.1.6.2.2">ℒ</ci><ci id="S3.E8.m1.3.3.1.1.6.2.3.cmml" xref="S3.E8.m1.3.3.1.1.6.2.3">𝐷</ci></apply><ci id="S3.E8.m1.3.3.1.1.6.3a.cmml" xref="S3.E8.m1.3.3.1.1.6.3"><mtext id="S3.E8.m1.3.3.1.1.6.3.cmml" mathsize="70%" xref="S3.E8.m1.3.3.1.1.6.3">sup</mtext></ci></apply><apply id="S3.E8.m1.3.3.1.1.4.cmml" xref="S3.E8.m1.3.3.1.1.4"><plus id="S3.E8.m1.3.3.1.1.4.5.cmml" xref="S3.E8.m1.3.3.1.1.4.5"></plus><apply id="S3.E8.m1.3.3.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2"><minus id="S3.E8.m1.3.3.1.1.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2"></minus><apply id="S3.E8.m1.3.3.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2"><times id="S3.E8.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.3"></times><apply id="S3.E8.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4"><log id="S3.E8.m1.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4.1"></log><apply id="S3.E8.m1.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.2.4.2.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.2.4.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.2">𝐷</ci><ci id="S3.E8.m1.3.3.1.1.2.2.2.4.2.3a.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.3"><mtext id="S3.E8.m1.3.3.1.1.2.2.2.4.2.3.cmml" mathsize="70%" xref="S3.E8.m1.3.3.1.1.2.2.2.4.2.3">sn</mtext></ci></apply></apply><vector id="S3.E8.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2"><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3"><minus id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑡</ci></vector></apply></apply><apply id="S3.E8.m1.3.3.1.1.4.4.cmml" xref="S3.E8.m1.3.3.1.1.4.4"><times id="S3.E8.m1.3.3.1.1.4.4.3.cmml" xref="S3.E8.m1.3.3.1.1.4.4.3"></times><apply id="S3.E8.m1.3.3.1.1.4.4.4.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4"><log id="S3.E8.m1.3.3.1.1.4.4.4.1.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4.1"></log><apply id="S3.E8.m1.3.3.1.1.4.4.4.2.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.4.4.4.2.1.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.4.4.4.2.2.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4.2.2">𝐷</ci><ci id="S3.E8.m1.3.3.1.1.4.4.4.2.3a.cmml" xref="S3.E8.m1.3.3.1.1.4.4.4.2.3"><mtext id="S3.E8.m1.3.3.1.1.4.4.4.2.3.cmml" mathsize="70%" xref="S3.E8.m1.3.3.1.1.4.4.4.2.3">sn</mtext></ci></apply></apply><vector id="S3.E8.m1.3.3.1.1.4.4.2.3.cmml" xref="S3.E8.m1.3.3.1.1.4.4.2.2"><apply id="S3.E8.m1.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.2">𝑦</ci><apply id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3"><minus id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.1"></minus><ci id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.2">𝑡</ci><cn id="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3.3.1.1.1.3">′</ci></apply><apply id="S3.E8.m1.3.3.1.1.4.4.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.4.4.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.4.4.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2.2">𝑦</ci><ci id="S3.E8.m1.3.3.1.1.4.4.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.4.4.2.2.2.3">𝑡</ci></apply><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝑡</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\mathcal{L}^{D}_{\text{sup}}=-\log D_{\text{sn}}(y_{t-1},y_{t},t)+\log D_{%
\text{sn}}({y}_{t-1}^{\prime},y_{t},t).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">caligraphic_L start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT sup end_POSTSUBSCRIPT = - roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) + roman_log italic_D start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="278" id="S3.F4.g1" src="x4.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The schematic diagram of the dense regular grid cropping strategy. In this diagram, the grid size represents the spacing used for cropping, while the box size represents the size of the cropped images. In our method, we set the spacing to 4 pixels, and each crop is sized at <math alttext="64\times 64" class="ltx_Math" display="inline" id="S3.F4.8.m1.1"><semantics id="S3.F4.8.m1.1b"><mrow id="S3.F4.8.m1.1.1" xref="S3.F4.8.m1.1.1.cmml"><mn id="S3.F4.8.m1.1.1.2" xref="S3.F4.8.m1.1.1.2.cmml">64</mn><mo id="S3.F4.8.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F4.8.m1.1.1.1.cmml">×</mo><mn id="S3.F4.8.m1.1.1.3" xref="S3.F4.8.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.8.m1.1c"><apply id="S3.F4.8.m1.1.1.cmml" xref="S3.F4.8.m1.1.1"><times id="S3.F4.8.m1.1.1.1.cmml" xref="S3.F4.8.m1.1.1.1"></times><cn id="S3.F4.8.m1.1.1.2.cmml" type="integer" xref="S3.F4.8.m1.1.1.2">64</cn><cn id="S3.F4.8.m1.1.1.3.cmml" type="integer" xref="S3.F4.8.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.8.m1.1d">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S3.F4.8.m1.1e">64 × 64</annotation></semantics></math> pixels. The cropping sequence systematically proceeds along the grid from left to right and from top to bottom, and the cropped patches of <math alttext="x" class="ltx_Math" display="inline" id="S3.F4.9.m2.1"><semantics id="S3.F4.9.m2.1b"><mi id="S3.F4.9.m2.1.1" xref="S3.F4.9.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F4.9.m2.1c"><ci id="S3.F4.9.m2.1.1.cmml" xref="S3.F4.9.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.9.m2.1d">x</annotation><annotation encoding="application/x-llamapun" id="S3.F4.9.m2.1e">italic_x</annotation></semantics></math> are collected in a dictionary <math alttext="\mathcal{P}=\{{x}_{p_{1}},{x}_{p_{2}},...,{x}_{p_{K}}\},{x}_{p_{k}}={\text{%
Crop}}_{64}(\mathbf{M}_{k}\circ x)" class="ltx_Math" display="inline" id="S3.F4.10.m3.3"><semantics id="S3.F4.10.m3.3b"><mrow id="S3.F4.10.m3.3.3.2" xref="S3.F4.10.m3.3.3.3.cmml"><mrow id="S3.F4.10.m3.2.2.1.1" xref="S3.F4.10.m3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F4.10.m3.2.2.1.1.5" xref="S3.F4.10.m3.2.2.1.1.5.cmml">𝒫</mi><mo id="S3.F4.10.m3.2.2.1.1.4" xref="S3.F4.10.m3.2.2.1.1.4.cmml">=</mo><mrow id="S3.F4.10.m3.2.2.1.1.3.3" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml"><mo id="S3.F4.10.m3.2.2.1.1.3.3.4" stretchy="false" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml">{</mo><msub id="S3.F4.10.m3.2.2.1.1.1.1.1" xref="S3.F4.10.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.F4.10.m3.2.2.1.1.1.1.1.2" xref="S3.F4.10.m3.2.2.1.1.1.1.1.2.cmml">x</mi><msub id="S3.F4.10.m3.2.2.1.1.1.1.1.3" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3.cmml"><mi id="S3.F4.10.m3.2.2.1.1.1.1.1.3.2" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3.2.cmml">p</mi><mn id="S3.F4.10.m3.2.2.1.1.1.1.1.3.3" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.F4.10.m3.2.2.1.1.3.3.5" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml">,</mo><msub id="S3.F4.10.m3.2.2.1.1.2.2.2" xref="S3.F4.10.m3.2.2.1.1.2.2.2.cmml"><mi id="S3.F4.10.m3.2.2.1.1.2.2.2.2" xref="S3.F4.10.m3.2.2.1.1.2.2.2.2.cmml">x</mi><msub id="S3.F4.10.m3.2.2.1.1.2.2.2.3" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3.cmml"><mi id="S3.F4.10.m3.2.2.1.1.2.2.2.3.2" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3.2.cmml">p</mi><mn id="S3.F4.10.m3.2.2.1.1.2.2.2.3.3" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.F4.10.m3.2.2.1.1.3.3.6" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml">,</mo><mi id="S3.F4.10.m3.1.1" mathvariant="normal" xref="S3.F4.10.m3.1.1.cmml">…</mi><mo id="S3.F4.10.m3.2.2.1.1.3.3.7" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml">,</mo><msub id="S3.F4.10.m3.2.2.1.1.3.3.3" xref="S3.F4.10.m3.2.2.1.1.3.3.3.cmml"><mi id="S3.F4.10.m3.2.2.1.1.3.3.3.2" xref="S3.F4.10.m3.2.2.1.1.3.3.3.2.cmml">x</mi><msub id="S3.F4.10.m3.2.2.1.1.3.3.3.3" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3.cmml"><mi id="S3.F4.10.m3.2.2.1.1.3.3.3.3.2" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3.2.cmml">p</mi><mi id="S3.F4.10.m3.2.2.1.1.3.3.3.3.3" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3.3.cmml">K</mi></msub></msub><mo id="S3.F4.10.m3.2.2.1.1.3.3.8" stretchy="false" xref="S3.F4.10.m3.2.2.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S3.F4.10.m3.3.3.2.3" xref="S3.F4.10.m3.3.3.3a.cmml">,</mo><mrow id="S3.F4.10.m3.3.3.2.2" xref="S3.F4.10.m3.3.3.2.2.cmml"><msub id="S3.F4.10.m3.3.3.2.2.3" xref="S3.F4.10.m3.3.3.2.2.3.cmml"><mi id="S3.F4.10.m3.3.3.2.2.3.2" xref="S3.F4.10.m3.3.3.2.2.3.2.cmml">x</mi><msub id="S3.F4.10.m3.3.3.2.2.3.3" xref="S3.F4.10.m3.3.3.2.2.3.3.cmml"><mi id="S3.F4.10.m3.3.3.2.2.3.3.2" xref="S3.F4.10.m3.3.3.2.2.3.3.2.cmml">p</mi><mi id="S3.F4.10.m3.3.3.2.2.3.3.3" xref="S3.F4.10.m3.3.3.2.2.3.3.3.cmml">k</mi></msub></msub><mo id="S3.F4.10.m3.3.3.2.2.2" xref="S3.F4.10.m3.3.3.2.2.2.cmml">=</mo><mrow id="S3.F4.10.m3.3.3.2.2.1" xref="S3.F4.10.m3.3.3.2.2.1.cmml"><msub id="S3.F4.10.m3.3.3.2.2.1.3" xref="S3.F4.10.m3.3.3.2.2.1.3.cmml"><mtext id="S3.F4.10.m3.3.3.2.2.1.3.2" xref="S3.F4.10.m3.3.3.2.2.1.3.2a.cmml">Crop</mtext><mn id="S3.F4.10.m3.3.3.2.2.1.3.3" xref="S3.F4.10.m3.3.3.2.2.1.3.3.cmml">64</mn></msub><mo id="S3.F4.10.m3.3.3.2.2.1.2" xref="S3.F4.10.m3.3.3.2.2.1.2.cmml">⁢</mo><mrow id="S3.F4.10.m3.3.3.2.2.1.1.1" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.cmml"><mo id="S3.F4.10.m3.3.3.2.2.1.1.1.2" stretchy="false" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.F4.10.m3.3.3.2.2.1.1.1.1" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.cmml"><msub id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.cmml"><mi id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.2" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.2.cmml">𝐌</mi><mi id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.3" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.F4.10.m3.3.3.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.1.cmml">∘</mo><mi id="S3.F4.10.m3.3.3.2.2.1.1.1.1.3" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.F4.10.m3.3.3.2.2.1.1.1.3" stretchy="false" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.10.m3.3c"><apply id="S3.F4.10.m3.3.3.3.cmml" xref="S3.F4.10.m3.3.3.2"><csymbol cd="ambiguous" id="S3.F4.10.m3.3.3.3a.cmml" xref="S3.F4.10.m3.3.3.2.3">formulae-sequence</csymbol><apply id="S3.F4.10.m3.2.2.1.1.cmml" xref="S3.F4.10.m3.2.2.1.1"><eq id="S3.F4.10.m3.2.2.1.1.4.cmml" xref="S3.F4.10.m3.2.2.1.1.4"></eq><ci id="S3.F4.10.m3.2.2.1.1.5.cmml" xref="S3.F4.10.m3.2.2.1.1.5">𝒫</ci><set id="S3.F4.10.m3.2.2.1.1.3.4.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3"><apply id="S3.F4.10.m3.2.2.1.1.1.1.1.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1.2">𝑥</ci><apply id="S3.F4.10.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.1.1.1.3.1.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.1.1.1.3.2.cmml" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3.2">𝑝</ci><cn id="S3.F4.10.m3.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.F4.10.m3.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.F4.10.m3.2.2.1.1.2.2.2.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.2.2.2.1.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.2.2.2.2.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2.2">𝑥</ci><apply id="S3.F4.10.m3.2.2.1.1.2.2.2.3.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.2.2.2.3.1.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.2.2.2.3.2.cmml" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3.2">𝑝</ci><cn id="S3.F4.10.m3.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.F4.10.m3.2.2.1.1.2.2.2.3.3">2</cn></apply></apply><ci id="S3.F4.10.m3.1.1.cmml" xref="S3.F4.10.m3.1.1">…</ci><apply id="S3.F4.10.m3.2.2.1.1.3.3.3.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.3.3.3.1.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.3.3.3.2.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3.2">𝑥</ci><apply id="S3.F4.10.m3.2.2.1.1.3.3.3.3.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.2.2.1.1.3.3.3.3.1.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S3.F4.10.m3.2.2.1.1.3.3.3.3.2.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3.2">𝑝</ci><ci id="S3.F4.10.m3.2.2.1.1.3.3.3.3.3.cmml" xref="S3.F4.10.m3.2.2.1.1.3.3.3.3.3">𝐾</ci></apply></apply></set></apply><apply id="S3.F4.10.m3.3.3.2.2.cmml" xref="S3.F4.10.m3.3.3.2.2"><eq id="S3.F4.10.m3.3.3.2.2.2.cmml" xref="S3.F4.10.m3.3.3.2.2.2"></eq><apply id="S3.F4.10.m3.3.3.2.2.3.cmml" xref="S3.F4.10.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.3.3.2.2.3.1.cmml" xref="S3.F4.10.m3.3.3.2.2.3">subscript</csymbol><ci id="S3.F4.10.m3.3.3.2.2.3.2.cmml" xref="S3.F4.10.m3.3.3.2.2.3.2">𝑥</ci><apply id="S3.F4.10.m3.3.3.2.2.3.3.cmml" xref="S3.F4.10.m3.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.3.3.2.2.3.3.1.cmml" xref="S3.F4.10.m3.3.3.2.2.3.3">subscript</csymbol><ci id="S3.F4.10.m3.3.3.2.2.3.3.2.cmml" xref="S3.F4.10.m3.3.3.2.2.3.3.2">𝑝</ci><ci id="S3.F4.10.m3.3.3.2.2.3.3.3.cmml" xref="S3.F4.10.m3.3.3.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.F4.10.m3.3.3.2.2.1.cmml" xref="S3.F4.10.m3.3.3.2.2.1"><times id="S3.F4.10.m3.3.3.2.2.1.2.cmml" xref="S3.F4.10.m3.3.3.2.2.1.2"></times><apply id="S3.F4.10.m3.3.3.2.2.1.3.cmml" xref="S3.F4.10.m3.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S3.F4.10.m3.3.3.2.2.1.3.1.cmml" xref="S3.F4.10.m3.3.3.2.2.1.3">subscript</csymbol><ci id="S3.F4.10.m3.3.3.2.2.1.3.2a.cmml" xref="S3.F4.10.m3.3.3.2.2.1.3.2"><mtext id="S3.F4.10.m3.3.3.2.2.1.3.2.cmml" xref="S3.F4.10.m3.3.3.2.2.1.3.2">Crop</mtext></ci><cn id="S3.F4.10.m3.3.3.2.2.1.3.3.cmml" type="integer" xref="S3.F4.10.m3.3.3.2.2.1.3.3">64</cn></apply><apply id="S3.F4.10.m3.3.3.2.2.1.1.1.1.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1"><compose id="S3.F4.10.m3.3.3.2.2.1.1.1.1.1.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.1"></compose><apply id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.1.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.2.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.2">𝐌</ci><ci id="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.3.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.F4.10.m3.3.3.2.2.1.1.1.1.3.cmml" xref="S3.F4.10.m3.3.3.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.10.m3.3d">\mathcal{P}=\{{x}_{p_{1}},{x}_{p_{2}},...,{x}_{p_{K}}\},{x}_{p_{k}}={\text{%
Crop}}_{64}(\mathbf{M}_{k}\circ x)</annotation><annotation encoding="application/x-llamapun" id="S3.F4.10.m3.3e">caligraphic_P = { italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUBSCRIPT } , italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = Crop start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT ( bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∘ italic_x )</annotation></semantics></math>, where <math alttext="\circ" class="ltx_Math" display="inline" id="S3.F4.11.m4.1"><semantics id="S3.F4.11.m4.1b"><mo id="S3.F4.11.m4.1.1" xref="S3.F4.11.m4.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S3.F4.11.m4.1c"><compose id="S3.F4.11.m4.1.1.cmml" xref="S3.F4.11.m4.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.11.m4.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="S3.F4.11.m4.1e">∘</annotation></semantics></math> indicates element-wise multiple and <math alttext="\mathbf{M}_{k}" class="ltx_Math" display="inline" id="S3.F4.12.m5.1"><semantics id="S3.F4.12.m5.1b"><msub id="S3.F4.12.m5.1.1" xref="S3.F4.12.m5.1.1.cmml"><mi id="S3.F4.12.m5.1.1.2" xref="S3.F4.12.m5.1.1.2.cmml">𝐌</mi><mi id="S3.F4.12.m5.1.1.3" xref="S3.F4.12.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.12.m5.1c"><apply id="S3.F4.12.m5.1.1.cmml" xref="S3.F4.12.m5.1.1"><csymbol cd="ambiguous" id="S3.F4.12.m5.1.1.1.cmml" xref="S3.F4.12.m5.1.1">subscript</csymbol><ci id="S3.F4.12.m5.1.1.2.cmml" xref="S3.F4.12.m5.1.1.2">𝐌</ci><ci id="S3.F4.12.m5.1.1.3.cmml" xref="S3.F4.12.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.12.m5.1d">\mathbf{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.12.m5.1e">bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="k^{th}" class="ltx_Math" display="inline" id="S3.F4.13.m6.1"><semantics id="S3.F4.13.m6.1b"><msup id="S3.F4.13.m6.1.1" xref="S3.F4.13.m6.1.1.cmml"><mi id="S3.F4.13.m6.1.1.2" xref="S3.F4.13.m6.1.1.2.cmml">k</mi><mrow id="S3.F4.13.m6.1.1.3" xref="S3.F4.13.m6.1.1.3.cmml"><mi id="S3.F4.13.m6.1.1.3.2" xref="S3.F4.13.m6.1.1.3.2.cmml">t</mi><mo id="S3.F4.13.m6.1.1.3.1" xref="S3.F4.13.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.F4.13.m6.1.1.3.3" xref="S3.F4.13.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.F4.13.m6.1c"><apply id="S3.F4.13.m6.1.1.cmml" xref="S3.F4.13.m6.1.1"><csymbol cd="ambiguous" id="S3.F4.13.m6.1.1.1.cmml" xref="S3.F4.13.m6.1.1">superscript</csymbol><ci id="S3.F4.13.m6.1.1.2.cmml" xref="S3.F4.13.m6.1.1.2">𝑘</ci><apply id="S3.F4.13.m6.1.1.3.cmml" xref="S3.F4.13.m6.1.1.3"><times id="S3.F4.13.m6.1.1.3.1.cmml" xref="S3.F4.13.m6.1.1.3.1"></times><ci id="S3.F4.13.m6.1.1.3.2.cmml" xref="S3.F4.13.m6.1.1.3.2">𝑡</ci><ci id="S3.F4.13.m6.1.1.3.3.cmml" xref="S3.F4.13.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.13.m6.1d">k^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.13.m6.1e">italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> patch mask of <math alttext="x" class="ltx_Math" display="inline" id="S3.F4.14.m7.1"><semantics id="S3.F4.14.m7.1b"><mi id="S3.F4.14.m7.1.1" xref="S3.F4.14.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F4.14.m7.1c"><ci id="S3.F4.14.m7.1.1.cmml" xref="S3.F4.14.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.14.m7.1d">x</annotation><annotation encoding="application/x-llamapun" id="S3.F4.14.m7.1e">italic_x</annotation></semantics></math> (1 for corresponding patch locations while 0 for others)
</figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.3">For unlabeled data training, the discriminator loss, as shown in line 23 of
Algorithm 2, also follows the formulation used in WaveDiff, i.e., Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.E8" title="In 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">8</span></a>).
For the generator loss, as shown in line 21 of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg3" title="Algorithm 3 ‣ 3.3 Target Design for Enhancing Pseudo-label Accuracy ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>, only the <math alttext="\mathcal{L}_{\text{1}}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><msub id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3a.cmml">1</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">ℒ</ci><ci id="S3.SS4.p4.1.m1.1.1.3a.cmml" xref="S3.SS4.p4.1.m1.1.1.3"><mtext id="S3.SS4.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p4.1.m1.1.1.3">1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\mathcal{L}_{\text{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> loss and the adversarial loss are employed to train the generator, as it is considered that applying too many constraints to unlabeled data with pseudo-labels may mislead the training process.
Besides, as aforementioned, simply using the <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><msub id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">ℒ</ci><cn id="S3.SS4.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance as the consistency loss can easily overfit the student model to incorrect predictions, thus resulting in confirmation bias. To cope with this issue, we further replace it with a contrastive loss <math alttext="\mathcal{L}_{\text{contr}}" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1"><semantics id="S3.SS4.p4.3.m3.1a"><msub id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.3.m3.1.1.2" xref="S3.SS4.p4.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS4.p4.3.m3.1.1.3" xref="S3.SS4.p4.3.m3.1.1.3a.cmml">contr</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p4.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.2">ℒ</ci><ci id="S3.SS4.p4.3.m3.1.1.3a.cmml" xref="S3.SS4.p4.3.m3.1.1.3"><mtext id="S3.SS4.p4.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p4.3.m3.1.1.3">contr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">\mathcal{L}_{\text{contr}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT contr end_POSTSUBSCRIPT</annotation></semantics></math> in our scheme, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{\text{contr}}=\sum_{j=1}^{K}\sum_{i=1}^{M}\omega_{j}\cdot\frac{|%
\phi_{j}({y^{s}_{c}}(I)),\phi_{j}({y^{r}_{c}}(i))|}{|\phi_{j}({y^{s}_{c}}(i)),%
\phi_{j}({x_{c}}(i))|}," class="ltx_math_unparsed" display="block" id="S3.E9.m1.5"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5.1"><mrow id="S3.E9.m1.5.5.1.1"><msub id="S3.E9.m1.5.5.1.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1.2.2">ℒ</mi><mtext id="S3.E9.m1.5.5.1.1.2.3">contr</mtext></msub><mo id="S3.E9.m1.5.5.1.1.1" rspace="0.111em">=</mo><mrow id="S3.E9.m1.5.5.1.1.3"><munderover id="S3.E9.m1.5.5.1.1.3.1"><mo id="S3.E9.m1.5.5.1.1.3.1.2.2" movablelimits="false" rspace="0em">∑</mo><mrow id="S3.E9.m1.5.5.1.1.3.1.2.3"><mi id="S3.E9.m1.5.5.1.1.3.1.2.3.2">j</mi><mo id="S3.E9.m1.5.5.1.1.3.1.2.3.1">=</mo><mn id="S3.E9.m1.5.5.1.1.3.1.2.3.3">1</mn></mrow><mi id="S3.E9.m1.5.5.1.1.3.1.3">K</mi></munderover><mrow id="S3.E9.m1.5.5.1.1.3.2"><munderover id="S3.E9.m1.5.5.1.1.3.2.1"><mo id="S3.E9.m1.5.5.1.1.3.2.1.2.2" movablelimits="false">∑</mo><mrow id="S3.E9.m1.5.5.1.1.3.2.1.2.3"><mi id="S3.E9.m1.5.5.1.1.3.2.1.2.3.2">i</mi><mo id="S3.E9.m1.5.5.1.1.3.2.1.2.3.1">=</mo><mn id="S3.E9.m1.5.5.1.1.3.2.1.2.3.3">1</mn></mrow><mi id="S3.E9.m1.5.5.1.1.3.2.1.3">M</mi></munderover><mrow id="S3.E9.m1.5.5.1.1.3.2.2"><msub id="S3.E9.m1.5.5.1.1.3.2.2.2"><mi id="S3.E9.m1.5.5.1.1.3.2.2.2.2">ω</mi><mi id="S3.E9.m1.5.5.1.1.3.2.2.2.3">j</mi></msub><mo id="S3.E9.m1.5.5.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em">⋅</mo><mfrac id="S3.E9.m1.4.4"><mrow id="S3.E9.m1.2.2.2"><mo fence="false" id="S3.E9.m1.2.2.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E9.m1.2.2.2.4"><mi id="S3.E9.m1.2.2.2.4.2">ϕ</mi><mi id="S3.E9.m1.2.2.2.4.3">j</mi></msub><mrow id="S3.E9.m1.2.2.2.5"><mo id="S3.E9.m1.2.2.2.5.1" stretchy="false">(</mo><msubsup id="S3.E9.m1.2.2.2.5.2"><mi id="S3.E9.m1.2.2.2.5.2.2.2">y</mi><mi id="S3.E9.m1.2.2.2.5.2.3">c</mi><mi id="S3.E9.m1.2.2.2.5.2.2.3">s</mi></msubsup><mrow id="S3.E9.m1.2.2.2.5.3"><mo id="S3.E9.m1.2.2.2.5.3.1" stretchy="false">(</mo><mi id="S3.E9.m1.1.1.1.1">I</mi><mo id="S3.E9.m1.2.2.2.5.3.2" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.2.2.2.5.4" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.2.2.2.6">,</mo><msub id="S3.E9.m1.2.2.2.7"><mi id="S3.E9.m1.2.2.2.7.2">ϕ</mi><mi id="S3.E9.m1.2.2.2.7.3">j</mi></msub><mrow id="S3.E9.m1.2.2.2.8"><mo id="S3.E9.m1.2.2.2.8.1" stretchy="false">(</mo><msubsup id="S3.E9.m1.2.2.2.8.2"><mi id="S3.E9.m1.2.2.2.8.2.2.2">y</mi><mi id="S3.E9.m1.2.2.2.8.2.3">c</mi><mi id="S3.E9.m1.2.2.2.8.2.2.3">r</mi></msubsup><mrow id="S3.E9.m1.2.2.2.8.3"><mo id="S3.E9.m1.2.2.2.8.3.1" stretchy="false">(</mo><mi id="S3.E9.m1.2.2.2.2">i</mi><mo id="S3.E9.m1.2.2.2.8.3.2" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.2.2.2.8.4" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E9.m1.2.2.2.9" stretchy="false">|</mo></mrow><mrow id="S3.E9.m1.4.4.4"><mo fence="false" id="S3.E9.m1.4.4.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E9.m1.4.4.4.4"><mi id="S3.E9.m1.4.4.4.4.2">ϕ</mi><mi id="S3.E9.m1.4.4.4.4.3">j</mi></msub><mrow id="S3.E9.m1.4.4.4.5"><mo id="S3.E9.m1.4.4.4.5.1" stretchy="false">(</mo><msubsup id="S3.E9.m1.4.4.4.5.2"><mi id="S3.E9.m1.4.4.4.5.2.2.2">y</mi><mi id="S3.E9.m1.4.4.4.5.2.3">c</mi><mi id="S3.E9.m1.4.4.4.5.2.2.3">s</mi></msubsup><mrow id="S3.E9.m1.4.4.4.5.3"><mo id="S3.E9.m1.4.4.4.5.3.1" stretchy="false">(</mo><mi id="S3.E9.m1.3.3.3.1">i</mi><mo id="S3.E9.m1.4.4.4.5.3.2" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.4.4.4.5.4" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.4.4.4.6">,</mo><msub id="S3.E9.m1.4.4.4.7"><mi id="S3.E9.m1.4.4.4.7.2">ϕ</mi><mi id="S3.E9.m1.4.4.4.7.3">j</mi></msub><mrow id="S3.E9.m1.4.4.4.8"><mo id="S3.E9.m1.4.4.4.8.1" stretchy="false">(</mo><msub id="S3.E9.m1.4.4.4.8.2"><mi id="S3.E9.m1.4.4.4.8.2.2">x</mi><mi id="S3.E9.m1.4.4.4.8.2.3">c</mi></msub><mrow id="S3.E9.m1.4.4.4.8.3"><mo id="S3.E9.m1.4.4.4.8.3.1" stretchy="false">(</mo><mi id="S3.E9.m1.4.4.4.2">i</mi><mo id="S3.E9.m1.4.4.4.8.3.2" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.4.4.4.8.4" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E9.m1.4.4.4.9" stretchy="false">|</mo></mrow></mfrac></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.5.5.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.5b">\mathcal{L}_{\text{contr}}=\sum_{j=1}^{K}\sum_{i=1}^{M}\omega_{j}\cdot\frac{|%
\phi_{j}({y^{s}_{c}}(I)),\phi_{j}({y^{r}_{c}}(i))|}{|\phi_{j}({y^{s}_{c}}(i)),%
\phi_{j}({x_{c}}(i))|},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.5c">caligraphic_L start_POSTSUBSCRIPT contr end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_ω start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ divide start_ARG | italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_I ) ) , italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_i ) ) | end_ARG start_ARG | italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_i ) ) , italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_i ) ) | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p4.10">where <math alttext="x_{c}" class="ltx_Math" display="inline" id="S3.SS4.p4.4.m1.1"><semantics id="S3.SS4.p4.4.m1.1a"><msub id="S3.SS4.p4.4.m1.1.1" xref="S3.SS4.p4.4.m1.1.1.cmml"><mi id="S3.SS4.p4.4.m1.1.1.2" xref="S3.SS4.p4.4.m1.1.1.2.cmml">x</mi><mi id="S3.SS4.p4.4.m1.1.1.3" xref="S3.SS4.p4.4.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m1.1b"><apply id="S3.SS4.p4.4.m1.1.1.cmml" xref="S3.SS4.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m1.1.1.1.cmml" xref="S3.SS4.p4.4.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.4.m1.1.1.2.cmml" xref="S3.SS4.p4.4.m1.1.1.2">𝑥</ci><ci id="S3.SS4.p4.4.m1.1.1.3.cmml" xref="S3.SS4.p4.4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m1.1c">x_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.4.m1.1d">italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> represents the unlabeled degraded image, <math alttext="{y^{s}_{c}}" class="ltx_Math" display="inline" id="S3.SS4.p4.5.m2.1"><semantics id="S3.SS4.p4.5.m2.1a"><msubsup id="S3.SS4.p4.5.m2.1.1" xref="S3.SS4.p4.5.m2.1.1.cmml"><mi id="S3.SS4.p4.5.m2.1.1.2.2" xref="S3.SS4.p4.5.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p4.5.m2.1.1.3" xref="S3.SS4.p4.5.m2.1.1.3.cmml">c</mi><mi id="S3.SS4.p4.5.m2.1.1.2.3" xref="S3.SS4.p4.5.m2.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m2.1b"><apply id="S3.SS4.p4.5.m2.1.1.cmml" xref="S3.SS4.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m2.1.1.1.cmml" xref="S3.SS4.p4.5.m2.1.1">subscript</csymbol><apply id="S3.SS4.p4.5.m2.1.1.2.cmml" xref="S3.SS4.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m2.1.1.2.1.cmml" xref="S3.SS4.p4.5.m2.1.1">superscript</csymbol><ci id="S3.SS4.p4.5.m2.1.1.2.2.cmml" xref="S3.SS4.p4.5.m2.1.1.2.2">𝑦</ci><ci id="S3.SS4.p4.5.m2.1.1.2.3.cmml" xref="S3.SS4.p4.5.m2.1.1.2.3">𝑠</ci></apply><ci id="S3.SS4.p4.5.m2.1.1.3.cmml" xref="S3.SS4.p4.5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m2.1c">{y^{s}_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.5.m2.1d">italic_y start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the denoising output from the student network and <math alttext="{y^{r}_{c}}" class="ltx_Math" display="inline" id="S3.SS4.p4.6.m3.1"><semantics id="S3.SS4.p4.6.m3.1a"><msubsup id="S3.SS4.p4.6.m3.1.1" xref="S3.SS4.p4.6.m3.1.1.cmml"><mi id="S3.SS4.p4.6.m3.1.1.2.2" xref="S3.SS4.p4.6.m3.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p4.6.m3.1.1.3" xref="S3.SS4.p4.6.m3.1.1.3.cmml">c</mi><mi id="S3.SS4.p4.6.m3.1.1.2.3" xref="S3.SS4.p4.6.m3.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m3.1b"><apply id="S3.SS4.p4.6.m3.1.1.cmml" xref="S3.SS4.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.6.m3.1.1.1.cmml" xref="S3.SS4.p4.6.m3.1.1">subscript</csymbol><apply id="S3.SS4.p4.6.m3.1.1.2.cmml" xref="S3.SS4.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.6.m3.1.1.2.1.cmml" xref="S3.SS4.p4.6.m3.1.1">superscript</csymbol><ci id="S3.SS4.p4.6.m3.1.1.2.2.cmml" xref="S3.SS4.p4.6.m3.1.1.2.2">𝑦</ci><ci id="S3.SS4.p4.6.m3.1.1.2.3.cmml" xref="S3.SS4.p4.6.m3.1.1.2.3">𝑟</ci></apply><ci id="S3.SS4.p4.6.m3.1.1.3.cmml" xref="S3.SS4.p4.6.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m3.1c">{y^{r}_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.6.m3.1d">italic_y start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding “optimal” output. The function <math alttext="\phi_{j}" class="ltx_Math" display="inline" id="S3.SS4.p4.7.m4.1"><semantics id="S3.SS4.p4.7.m4.1a"><msub id="S3.SS4.p4.7.m4.1.1" xref="S3.SS4.p4.7.m4.1.1.cmml"><mi id="S3.SS4.p4.7.m4.1.1.2" xref="S3.SS4.p4.7.m4.1.1.2.cmml">ϕ</mi><mi id="S3.SS4.p4.7.m4.1.1.3" xref="S3.SS4.p4.7.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.m4.1b"><apply id="S3.SS4.p4.7.m4.1.1.cmml" xref="S3.SS4.p4.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.7.m4.1.1.1.cmml" xref="S3.SS4.p4.7.m4.1.1">subscript</csymbol><ci id="S3.SS4.p4.7.m4.1.1.2.cmml" xref="S3.SS4.p4.7.m4.1.1.2">italic-ϕ</ci><ci id="S3.SS4.p4.7.m4.1.1.3.cmml" xref="S3.SS4.p4.7.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.m4.1c">\phi_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.7.m4.1d">italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="j^{th}" class="ltx_Math" display="inline" id="S3.SS4.p4.8.m5.1"><semantics id="S3.SS4.p4.8.m5.1a"><msup id="S3.SS4.p4.8.m5.1.1" xref="S3.SS4.p4.8.m5.1.1.cmml"><mi id="S3.SS4.p4.8.m5.1.1.2" xref="S3.SS4.p4.8.m5.1.1.2.cmml">j</mi><mrow id="S3.SS4.p4.8.m5.1.1.3" xref="S3.SS4.p4.8.m5.1.1.3.cmml"><mi id="S3.SS4.p4.8.m5.1.1.3.2" xref="S3.SS4.p4.8.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS4.p4.8.m5.1.1.3.1" xref="S3.SS4.p4.8.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p4.8.m5.1.1.3.3" xref="S3.SS4.p4.8.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.8.m5.1b"><apply id="S3.SS4.p4.8.m5.1.1.cmml" xref="S3.SS4.p4.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.8.m5.1.1.1.cmml" xref="S3.SS4.p4.8.m5.1.1">superscript</csymbol><ci id="S3.SS4.p4.8.m5.1.1.2.cmml" xref="S3.SS4.p4.8.m5.1.1.2">𝑗</ci><apply id="S3.SS4.p4.8.m5.1.1.3.cmml" xref="S3.SS4.p4.8.m5.1.1.3"><times id="S3.SS4.p4.8.m5.1.1.3.1.cmml" xref="S3.SS4.p4.8.m5.1.1.3.1"></times><ci id="S3.SS4.p4.8.m5.1.1.3.2.cmml" xref="S3.SS4.p4.8.m5.1.1.3.2">𝑡</ci><ci id="S3.SS4.p4.8.m5.1.1.3.3.cmml" xref="S3.SS4.p4.8.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.8.m5.1c">j^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.8.m5.1d">italic_j start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> hidden layer of the pre-trained VGG-19 network, and <math alttext="\omega_{j}" class="ltx_Math" display="inline" id="S3.SS4.p4.9.m6.1"><semantics id="S3.SS4.p4.9.m6.1a"><msub id="S3.SS4.p4.9.m6.1.1" xref="S3.SS4.p4.9.m6.1.1.cmml"><mi id="S3.SS4.p4.9.m6.1.1.2" xref="S3.SS4.p4.9.m6.1.1.2.cmml">ω</mi><mi id="S3.SS4.p4.9.m6.1.1.3" xref="S3.SS4.p4.9.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.9.m6.1b"><apply id="S3.SS4.p4.9.m6.1.1.cmml" xref="S3.SS4.p4.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.9.m6.1.1.1.cmml" xref="S3.SS4.p4.9.m6.1.1">subscript</csymbol><ci id="S3.SS4.p4.9.m6.1.1.2.cmml" xref="S3.SS4.p4.9.m6.1.1.2">𝜔</ci><ci id="S3.SS4.p4.9.m6.1.1.3.cmml" xref="S3.SS4.p4.9.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.9.m6.1c">\omega_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.9.m6.1d">italic_ω start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding weight coefficient. The <math alttext="\mathcal{L}_{{1}}" class="ltx_Math" display="inline" id="S3.SS4.p4.10.m7.1"><semantics id="S3.SS4.p4.10.m7.1a"><msub id="S3.SS4.p4.10.m7.1.1" xref="S3.SS4.p4.10.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.10.m7.1.1.2" xref="S3.SS4.p4.10.m7.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.p4.10.m7.1.1.3" xref="S3.SS4.p4.10.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.10.m7.1b"><apply id="S3.SS4.p4.10.m7.1.1.cmml" xref="S3.SS4.p4.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.10.m7.1.1.1.cmml" xref="S3.SS4.p4.10.m7.1.1">subscript</csymbol><ci id="S3.SS4.p4.10.m7.1.1.2.cmml" xref="S3.SS4.p4.10.m7.1.1.2">ℒ</ci><cn id="S3.SS4.p4.10.m7.1.1.3.cmml" type="integer" xref="S3.SS4.p4.10.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.10.m7.1c">\mathcal{L}_{{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.10.m7.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> distance is employed in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.E9" title="In 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">9</span></a>) to quantify the feature space disparity between the students’ denoising outputs with a positive sample (“optimal” output) and a negative sample (degraded input image).</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The schematic diagram of the model inference process. For the denoising process, please refer to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S2.F1" title="Figure 1 ‣ 2.2 Semi-Supervised Learning ‣ 2 Related Work ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">1</span></a> for a similar process. The cropping process can similarly reference Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.F4" title="Figure 4 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">4</span></a></figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg4.3.1.1">Algorithm 4</span> </span> The inference process of <span class="ltx_text ltx_font_bold" id="alg4.4.2">SemiDDM-Weather</span></figcaption>
<div class="ltx_listing ltx_listing" id="alg4.5">
<div class="ltx_listingline" id="alg4.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text" id="alg4.l1.2" style="font-size:80%;">degraded image </span><math alttext="x" class="ltx_Math" display="inline" id="alg4.l1.m1.1"><semantics id="alg4.l1.m1.1a"><mi id="alg4.l1.m1.1.1" mathsize="80%" xref="alg4.l1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><ci id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg4.l1.3" style="font-size:80%;">, patch mask dictionary </span><math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="alg4.l1.m2.1"><semantics id="alg4.l1.m2.1a"><mi id="alg4.l1.m2.1.1" mathsize="80%" xref="alg4.l1.m2.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m2.1b"><ci id="alg4.l1.m2.1.1.cmml" xref="alg4.l1.m2.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m2.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m2.1d">blackboard_M</annotation></semantics></math><span class="ltx_text" id="alg4.l1.4" style="font-size:80%;">.
</span>
</div>
<div class="ltx_listingline" id="alg4.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l2.1.1.1" style="font-size:80%;">2:</span></span><math alttext="t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="alg4.l2.m1.7"><semantics id="alg4.l2.m1.7a"><mrow id="alg4.l2.m1.7.7.2" xref="alg4.l2.m1.7.7.3.cmml"><mrow id="alg4.l2.m1.6.6.1.1" xref="alg4.l2.m1.6.6.1.1.cmml"><mi id="alg4.l2.m1.6.6.1.1.3" mathsize="80%" xref="alg4.l2.m1.6.6.1.1.3.cmml">t</mi><mo id="alg4.l2.m1.6.6.1.1.2" mathsize="80%" xref="alg4.l2.m1.6.6.1.1.2.cmml">∼</mo><mrow id="alg4.l2.m1.6.6.1.1.1" xref="alg4.l2.m1.6.6.1.1.1.cmml"><mi id="alg4.l2.m1.6.6.1.1.1.3" mathsize="80%" xref="alg4.l2.m1.6.6.1.1.1.3.cmml">Uniform</mi><mo id="alg4.l2.m1.6.6.1.1.1.2" xref="alg4.l2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="alg4.l2.m1.6.6.1.1.1.1.1" xref="alg4.l2.m1.6.6.1.1.1.cmml"><mo id="alg4.l2.m1.6.6.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg4.l2.m1.6.6.1.1.1.cmml">(</mo><mrow id="alg4.l2.m1.6.6.1.1.1.1.1.1.2" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="alg4.l2.m1.6.6.1.1.1.1.1.1.2.1" maxsize="80%" minsize="80%" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml">{</mo><mn id="alg4.l2.m1.1.1" mathsize="80%" xref="alg4.l2.m1.1.1.cmml">1</mn><mo id="alg4.l2.m1.6.6.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg4.l2.m1.2.2" mathsize="80%" mathvariant="normal" xref="alg4.l2.m1.2.2.cmml">…</mi><mo id="alg4.l2.m1.6.6.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml">,</mo><mi id="alg4.l2.m1.3.3" mathsize="80%" xref="alg4.l2.m1.3.3.cmml">T</mi><mo id="alg4.l2.m1.6.6.1.1.1.1.1.1.2.4" maxsize="80%" minsize="80%" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml">}</mo></mrow><mo id="alg4.l2.m1.6.6.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg4.l2.m1.6.6.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg4.l2.m1.7.7.2.3" mathsize="80%" xref="alg4.l2.m1.7.7.3a.cmml">,</mo><mrow id="alg4.l2.m1.7.7.2.2" xref="alg4.l2.m1.7.7.2.2.cmml"><mi id="alg4.l2.m1.7.7.2.2.2" mathsize="80%" xref="alg4.l2.m1.7.7.2.2.2.cmml">z</mi><mo id="alg4.l2.m1.7.7.2.2.1" mathsize="80%" xref="alg4.l2.m1.7.7.2.2.1.cmml">∼</mo><mrow id="alg4.l2.m1.7.7.2.2.3" xref="alg4.l2.m1.7.7.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l2.m1.7.7.2.2.3.2" mathsize="80%" xref="alg4.l2.m1.7.7.2.2.3.2.cmml">𝒩</mi><mo id="alg4.l2.m1.7.7.2.2.3.1" xref="alg4.l2.m1.7.7.2.2.3.1.cmml">⁢</mo><mrow id="alg4.l2.m1.7.7.2.2.3.3.2" xref="alg4.l2.m1.7.7.2.2.3.3.1.cmml"><mo id="alg4.l2.m1.7.7.2.2.3.3.2.1" maxsize="80%" minsize="80%" xref="alg4.l2.m1.7.7.2.2.3.3.1.cmml">(</mo><mn id="alg4.l2.m1.4.4" mathsize="80%" xref="alg4.l2.m1.4.4.cmml">0</mn><mo id="alg4.l2.m1.7.7.2.2.3.3.2.2" mathsize="80%" xref="alg4.l2.m1.7.7.2.2.3.3.1.cmml">,</mo><mi id="alg4.l2.m1.5.5" mathsize="80%" xref="alg4.l2.m1.5.5.cmml">𝐈</mi><mo id="alg4.l2.m1.7.7.2.2.3.3.2.3" maxsize="80%" minsize="80%" xref="alg4.l2.m1.7.7.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l2.m1.7b"><apply id="alg4.l2.m1.7.7.3.cmml" xref="alg4.l2.m1.7.7.2"><csymbol cd="ambiguous" id="alg4.l2.m1.7.7.3a.cmml" xref="alg4.l2.m1.7.7.2.3">formulae-sequence</csymbol><apply id="alg4.l2.m1.6.6.1.1.cmml" xref="alg4.l2.m1.6.6.1.1"><csymbol cd="latexml" id="alg4.l2.m1.6.6.1.1.2.cmml" xref="alg4.l2.m1.6.6.1.1.2">similar-to</csymbol><ci id="alg4.l2.m1.6.6.1.1.3.cmml" xref="alg4.l2.m1.6.6.1.1.3">𝑡</ci><apply id="alg4.l2.m1.6.6.1.1.1.cmml" xref="alg4.l2.m1.6.6.1.1.1"><times id="alg4.l2.m1.6.6.1.1.1.2.cmml" xref="alg4.l2.m1.6.6.1.1.1.2"></times><ci id="alg4.l2.m1.6.6.1.1.1.3.cmml" xref="alg4.l2.m1.6.6.1.1.1.3">Uniform</ci><set id="alg4.l2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="alg4.l2.m1.6.6.1.1.1.1.1.1.2"><cn id="alg4.l2.m1.1.1.cmml" type="integer" xref="alg4.l2.m1.1.1">1</cn><ci id="alg4.l2.m1.2.2.cmml" xref="alg4.l2.m1.2.2">…</ci><ci id="alg4.l2.m1.3.3.cmml" xref="alg4.l2.m1.3.3">𝑇</ci></set></apply></apply><apply id="alg4.l2.m1.7.7.2.2.cmml" xref="alg4.l2.m1.7.7.2.2"><csymbol cd="latexml" id="alg4.l2.m1.7.7.2.2.1.cmml" xref="alg4.l2.m1.7.7.2.2.1">similar-to</csymbol><ci id="alg4.l2.m1.7.7.2.2.2.cmml" xref="alg4.l2.m1.7.7.2.2.2">𝑧</ci><apply id="alg4.l2.m1.7.7.2.2.3.cmml" xref="alg4.l2.m1.7.7.2.2.3"><times id="alg4.l2.m1.7.7.2.2.3.1.cmml" xref="alg4.l2.m1.7.7.2.2.3.1"></times><ci id="alg4.l2.m1.7.7.2.2.3.2.cmml" xref="alg4.l2.m1.7.7.2.2.3.2">𝒩</ci><interval closure="open" id="alg4.l2.m1.7.7.2.2.3.3.1.cmml" xref="alg4.l2.m1.7.7.2.2.3.3.2"><cn id="alg4.l2.m1.4.4.cmml" type="integer" xref="alg4.l2.m1.4.4">0</cn><ci id="alg4.l2.m1.5.5.cmml" xref="alg4.l2.m1.5.5">𝐈</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.m1.7c">t\sim\mathrm{Uniform}(\{1,\dotsc,T\}),z\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="alg4.l2.m1.7d">italic_t ∼ roman_Uniform ( { 1 , … , italic_T } ) , italic_z ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math><span class="ltx_text" id="alg4.l2.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l3.1.1.1" style="font-size:80%;">3:</span></span><math alttext="\bm{\hat{\Omega}}_{t}=\mathbf{0},\mathbf{M}=\mathbf{0}" class="ltx_Math" display="inline" id="alg4.l3.m1.2"><semantics id="alg4.l3.m1.2a"><mrow id="alg4.l3.m1.2.2.2" xref="alg4.l3.m1.2.2.3.cmml"><mrow id="alg4.l3.m1.1.1.1.1" xref="alg4.l3.m1.1.1.1.1.cmml"><msub id="alg4.l3.m1.1.1.1.1.2" xref="alg4.l3.m1.1.1.1.1.2.cmml"><mover accent="true" id="alg4.l3.m1.1.1.1.1.2.2" xref="alg4.l3.m1.1.1.1.1.2.2.cmml"><mi id="alg4.l3.m1.1.1.1.1.2.2.2" mathsize="80%" xref="alg4.l3.m1.1.1.1.1.2.2.2.cmml">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l3.m1.1.1.1.1.2.2.1" mathsize="80%" mathvariant="bold" xref="alg4.l3.m1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg4.l3.m1.1.1.1.1.2.3" mathsize="80%" xref="alg4.l3.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="alg4.l3.m1.1.1.1.1.1" mathsize="80%" xref="alg4.l3.m1.1.1.1.1.1.cmml">=</mo><mn id="alg4.l3.m1.1.1.1.1.3" mathsize="80%" xref="alg4.l3.m1.1.1.1.1.3.cmml">𝟎</mn></mrow><mo id="alg4.l3.m1.2.2.2.3" mathsize="80%" xref="alg4.l3.m1.2.2.3a.cmml">,</mo><mrow id="alg4.l3.m1.2.2.2.2" xref="alg4.l3.m1.2.2.2.2.cmml"><mi id="alg4.l3.m1.2.2.2.2.2" mathsize="80%" xref="alg4.l3.m1.2.2.2.2.2.cmml">𝐌</mi><mo id="alg4.l3.m1.2.2.2.2.1" mathsize="80%" xref="alg4.l3.m1.2.2.2.2.1.cmml">=</mo><mn id="alg4.l3.m1.2.2.2.2.3" mathsize="80%" xref="alg4.l3.m1.2.2.2.2.3.cmml">𝟎</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.2b"><apply id="alg4.l3.m1.2.2.3.cmml" xref="alg4.l3.m1.2.2.2"><csymbol cd="ambiguous" id="alg4.l3.m1.2.2.3a.cmml" xref="alg4.l3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg4.l3.m1.1.1.1.1.cmml" xref="alg4.l3.m1.1.1.1.1"><eq id="alg4.l3.m1.1.1.1.1.1.cmml" xref="alg4.l3.m1.1.1.1.1.1"></eq><apply id="alg4.l3.m1.1.1.1.1.2.cmml" xref="alg4.l3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l3.m1.1.1.1.1.2.1.cmml" xref="alg4.l3.m1.1.1.1.1.2">subscript</csymbol><apply id="alg4.l3.m1.1.1.1.1.2.2.cmml" xref="alg4.l3.m1.1.1.1.1.2.2"><ci id="alg4.l3.m1.1.1.1.1.2.2.1.cmml" xref="alg4.l3.m1.1.1.1.1.2.2.1">bold-^</ci><ci id="alg4.l3.m1.1.1.1.1.2.2.2.cmml" xref="alg4.l3.m1.1.1.1.1.2.2.2">𝛀</ci></apply><ci id="alg4.l3.m1.1.1.1.1.2.3.cmml" xref="alg4.l3.m1.1.1.1.1.2.3">𝑡</ci></apply><cn id="alg4.l3.m1.1.1.1.1.3.cmml" type="integer" xref="alg4.l3.m1.1.1.1.1.3">0</cn></apply><apply id="alg4.l3.m1.2.2.2.2.cmml" xref="alg4.l3.m1.2.2.2.2"><eq id="alg4.l3.m1.2.2.2.2.1.cmml" xref="alg4.l3.m1.2.2.2.2.1"></eq><ci id="alg4.l3.m1.2.2.2.2.2.cmml" xref="alg4.l3.m1.2.2.2.2.2">𝐌</ci><cn id="alg4.l3.m1.2.2.2.2.3.cmml" type="integer" xref="alg4.l3.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.2c">\bm{\hat{\Omega}}_{t}=\mathbf{0},\mathbf{M}=\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m1.2d">overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_0 , bold_M = bold_0</annotation></semantics></math><span class="ltx_text" id="alg4.l3.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg4.l4.2" style="font-size:80%;">for</span><span class="ltx_text" id="alg4.l4.3" style="font-size:80%;"> </span><math alttext="k=1,\ldots,K" class="ltx_Math" display="inline" id="alg4.l4.m1.3"><semantics id="alg4.l4.m1.3a"><mrow id="alg4.l4.m1.3.4" xref="alg4.l4.m1.3.4.cmml"><mi id="alg4.l4.m1.3.4.2" mathsize="80%" xref="alg4.l4.m1.3.4.2.cmml">k</mi><mo id="alg4.l4.m1.3.4.1" mathsize="80%" xref="alg4.l4.m1.3.4.1.cmml">=</mo><mrow id="alg4.l4.m1.3.4.3.2" xref="alg4.l4.m1.3.4.3.1.cmml"><mn id="alg4.l4.m1.1.1" mathsize="80%" xref="alg4.l4.m1.1.1.cmml">1</mn><mo id="alg4.l4.m1.3.4.3.2.1" mathsize="80%" xref="alg4.l4.m1.3.4.3.1.cmml">,</mo><mi id="alg4.l4.m1.2.2" mathsize="80%" mathvariant="normal" xref="alg4.l4.m1.2.2.cmml">…</mi><mo id="alg4.l4.m1.3.4.3.2.2" mathsize="80%" xref="alg4.l4.m1.3.4.3.1.cmml">,</mo><mi id="alg4.l4.m1.3.3" mathsize="80%" xref="alg4.l4.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.3b"><apply id="alg4.l4.m1.3.4.cmml" xref="alg4.l4.m1.3.4"><eq id="alg4.l4.m1.3.4.1.cmml" xref="alg4.l4.m1.3.4.1"></eq><ci id="alg4.l4.m1.3.4.2.cmml" xref="alg4.l4.m1.3.4.2">𝑘</ci><list id="alg4.l4.m1.3.4.3.1.cmml" xref="alg4.l4.m1.3.4.3.2"><cn id="alg4.l4.m1.1.1.cmml" type="integer" xref="alg4.l4.m1.1.1">1</cn><ci id="alg4.l4.m1.2.2.cmml" xref="alg4.l4.m1.2.2">…</ci><ci id="alg4.l4.m1.3.3.cmml" xref="alg4.l4.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.3c">k=1,\ldots,K</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m1.3d">italic_k = 1 , … , italic_K</annotation></semantics></math><span class="ltx_text" id="alg4.l4.4" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg4.l4.5" style="font-size:80%;">do</span><span class="ltx_text" id="alg4.l4.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg4.l5.2" style="font-size:80%;">    </span><math alttext="x_{p_{k}}={\text{Crop}}_{64}(\mathbf{M}_{k}\circ x" class="ltx_math_unparsed" display="inline" id="alg4.l5.m1.1"><semantics id="alg4.l5.m1.1a"><mrow id="alg4.l5.m1.1b"><msub id="alg4.l5.m1.1.1"><mi id="alg4.l5.m1.1.1.2" mathsize="80%">x</mi><msub id="alg4.l5.m1.1.1.3"><mi id="alg4.l5.m1.1.1.3.2" mathsize="80%">p</mi><mi id="alg4.l5.m1.1.1.3.3" mathsize="80%">k</mi></msub></msub><mo id="alg4.l5.m1.1.2" mathsize="80%">=</mo><msub id="alg4.l5.m1.1.3"><mtext id="alg4.l5.m1.1.3.2" mathsize="80%">Crop</mtext><mn id="alg4.l5.m1.1.3.3" mathsize="80%">64</mn></msub><mrow id="alg4.l5.m1.1.4"><mo id="alg4.l5.m1.1.4.1" maxsize="80%" minsize="80%">(</mo><msub id="alg4.l5.m1.1.4.2"><mi id="alg4.l5.m1.1.4.2.2" mathsize="80%">𝐌</mi><mi id="alg4.l5.m1.1.4.2.3" mathsize="80%">k</mi></msub><mo id="alg4.l5.m1.1.4.3" lspace="0.222em" mathsize="80%" rspace="0.222em">∘</mo><mi id="alg4.l5.m1.1.4.4" mathsize="80%">x</mi></mrow></mrow><annotation encoding="application/x-tex" id="alg4.l5.m1.1c">x_{p_{k}}={\text{Crop}}_{64}(\mathbf{M}_{k}\circ x</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m1.1d">italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = Crop start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT ( bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∘ italic_x</annotation></semantics></math><span class="ltx_text" id="alg4.l5.3" style="font-size:80%;">), </span><math alttext="\mathbf{M}_{k}\in\mathbb{M}" class="ltx_Math" display="inline" id="alg4.l5.m2.1"><semantics id="alg4.l5.m2.1a"><mrow id="alg4.l5.m2.1.1" xref="alg4.l5.m2.1.1.cmml"><msub id="alg4.l5.m2.1.1.2" xref="alg4.l5.m2.1.1.2.cmml"><mi id="alg4.l5.m2.1.1.2.2" mathsize="80%" xref="alg4.l5.m2.1.1.2.2.cmml">𝐌</mi><mi id="alg4.l5.m2.1.1.2.3" mathsize="80%" xref="alg4.l5.m2.1.1.2.3.cmml">k</mi></msub><mo id="alg4.l5.m2.1.1.1" mathsize="80%" xref="alg4.l5.m2.1.1.1.cmml">∈</mo><mi id="alg4.l5.m2.1.1.3" mathsize="80%" xref="alg4.l5.m2.1.1.3.cmml">𝕄</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.m2.1b"><apply id="alg4.l5.m2.1.1.cmml" xref="alg4.l5.m2.1.1"><in id="alg4.l5.m2.1.1.1.cmml" xref="alg4.l5.m2.1.1.1"></in><apply id="alg4.l5.m2.1.1.2.cmml" xref="alg4.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg4.l5.m2.1.1.2.1.cmml" xref="alg4.l5.m2.1.1.2">subscript</csymbol><ci id="alg4.l5.m2.1.1.2.2.cmml" xref="alg4.l5.m2.1.1.2.2">𝐌</ci><ci id="alg4.l5.m2.1.1.2.3.cmml" xref="alg4.l5.m2.1.1.2.3">𝑘</ci></apply><ci id="alg4.l5.m2.1.1.3.cmml" xref="alg4.l5.m2.1.1.3">𝕄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m2.1c">\mathbf{M}_{k}\in\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m2.1d">bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_M</annotation></semantics></math><span class="ltx_text" id="alg4.l5.4" style="font-size:80%;"> // </span><math alttext="\circ" class="ltx_Math" display="inline" id="alg4.l5.m3.1"><semantics id="alg4.l5.m3.1a"><mo id="alg4.l5.m3.1.1" mathsize="80%" xref="alg4.l5.m3.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="alg4.l5.m3.1b"><compose id="alg4.l5.m3.1.1.cmml" xref="alg4.l5.m3.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m3.1c">\circ</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m3.1d">∘</annotation></semantics></math><span class="ltx_text" id="alg4.l5.5" style="font-size:80%;">: element-wise multiplication
</span>
</div>
<div class="ltx_listingline" id="alg4.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text" id="alg4.l6.2" style="font-size:80%;">    </span><math alttext="x_{0}=\text{DWT}(x_{p_{k}})" class="ltx_Math" display="inline" id="alg4.l6.m1.1"><semantics id="alg4.l6.m1.1a"><mrow id="alg4.l6.m1.1.1" xref="alg4.l6.m1.1.1.cmml"><msub id="alg4.l6.m1.1.1.3" xref="alg4.l6.m1.1.1.3.cmml"><mi id="alg4.l6.m1.1.1.3.2" mathsize="80%" xref="alg4.l6.m1.1.1.3.2.cmml">x</mi><mn id="alg4.l6.m1.1.1.3.3" mathsize="80%" xref="alg4.l6.m1.1.1.3.3.cmml">0</mn></msub><mo id="alg4.l6.m1.1.1.2" mathsize="80%" xref="alg4.l6.m1.1.1.2.cmml">=</mo><mrow id="alg4.l6.m1.1.1.1" xref="alg4.l6.m1.1.1.1.cmml"><mtext id="alg4.l6.m1.1.1.1.3" mathsize="80%" xref="alg4.l6.m1.1.1.1.3a.cmml">DWT</mtext><mo id="alg4.l6.m1.1.1.1.2" xref="alg4.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg4.l6.m1.1.1.1.1.1" xref="alg4.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg4.l6.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg4.l6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg4.l6.m1.1.1.1.1.1.1" xref="alg4.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l6.m1.1.1.1.1.1.1.2" mathsize="80%" xref="alg4.l6.m1.1.1.1.1.1.1.2.cmml">x</mi><msub id="alg4.l6.m1.1.1.1.1.1.1.3" xref="alg4.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg4.l6.m1.1.1.1.1.1.1.3.2" mathsize="80%" xref="alg4.l6.m1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="alg4.l6.m1.1.1.1.1.1.1.3.3" mathsize="80%" xref="alg4.l6.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo id="alg4.l6.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg4.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.m1.1b"><apply id="alg4.l6.m1.1.1.cmml" xref="alg4.l6.m1.1.1"><eq id="alg4.l6.m1.1.1.2.cmml" xref="alg4.l6.m1.1.1.2"></eq><apply id="alg4.l6.m1.1.1.3.cmml" xref="alg4.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l6.m1.1.1.3.1.cmml" xref="alg4.l6.m1.1.1.3">subscript</csymbol><ci id="alg4.l6.m1.1.1.3.2.cmml" xref="alg4.l6.m1.1.1.3.2">𝑥</ci><cn id="alg4.l6.m1.1.1.3.3.cmml" type="integer" xref="alg4.l6.m1.1.1.3.3">0</cn></apply><apply id="alg4.l6.m1.1.1.1.cmml" xref="alg4.l6.m1.1.1.1"><times id="alg4.l6.m1.1.1.1.2.cmml" xref="alg4.l6.m1.1.1.1.2"></times><ci id="alg4.l6.m1.1.1.1.3a.cmml" xref="alg4.l6.m1.1.1.1.3"><mtext id="alg4.l6.m1.1.1.1.3.cmml" mathsize="80%" xref="alg4.l6.m1.1.1.1.3">DWT</mtext></ci><apply id="alg4.l6.m1.1.1.1.1.1.1.cmml" xref="alg4.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l6.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="alg4.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg4.l6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg4.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg4.l6.m1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="alg4.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg4.l6.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m1.1c">x_{0}=\text{DWT}(x_{p_{k}})</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.m1.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = DWT ( italic_x start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg4.l6.3" style="font-size:80%;">,
</span>
</div>
<div class="ltx_listingline" id="alg4.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg4.l7.2" style="font-size:80%;">    </span><math alttext="y_{t}\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="alg4.l7.m1.2"><semantics id="alg4.l7.m1.2a"><mrow id="alg4.l7.m1.2.3" xref="alg4.l7.m1.2.3.cmml"><msub id="alg4.l7.m1.2.3.2" xref="alg4.l7.m1.2.3.2.cmml"><mi id="alg4.l7.m1.2.3.2.2" mathsize="80%" xref="alg4.l7.m1.2.3.2.2.cmml">y</mi><mi id="alg4.l7.m1.2.3.2.3" mathsize="80%" xref="alg4.l7.m1.2.3.2.3.cmml">t</mi></msub><mo id="alg4.l7.m1.2.3.1" mathsize="80%" xref="alg4.l7.m1.2.3.1.cmml">∼</mo><mrow id="alg4.l7.m1.2.3.3" xref="alg4.l7.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l7.m1.2.3.3.2" mathsize="80%" xref="alg4.l7.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg4.l7.m1.2.3.3.1" xref="alg4.l7.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg4.l7.m1.2.3.3.3.2" xref="alg4.l7.m1.2.3.3.3.1.cmml"><mo id="alg4.l7.m1.2.3.3.3.2.1" maxsize="80%" minsize="80%" xref="alg4.l7.m1.2.3.3.3.1.cmml">(</mo><mn id="alg4.l7.m1.1.1" mathsize="80%" xref="alg4.l7.m1.1.1.cmml">0</mn><mo id="alg4.l7.m1.2.3.3.3.2.2" mathsize="80%" xref="alg4.l7.m1.2.3.3.3.1.cmml">,</mo><mi id="alg4.l7.m1.2.2" mathsize="80%" xref="alg4.l7.m1.2.2.cmml">𝐈</mi><mo id="alg4.l7.m1.2.3.3.3.2.3" maxsize="80%" minsize="80%" xref="alg4.l7.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.m1.2b"><apply id="alg4.l7.m1.2.3.cmml" xref="alg4.l7.m1.2.3"><csymbol cd="latexml" id="alg4.l7.m1.2.3.1.cmml" xref="alg4.l7.m1.2.3.1">similar-to</csymbol><apply id="alg4.l7.m1.2.3.2.cmml" xref="alg4.l7.m1.2.3.2"><csymbol cd="ambiguous" id="alg4.l7.m1.2.3.2.1.cmml" xref="alg4.l7.m1.2.3.2">subscript</csymbol><ci id="alg4.l7.m1.2.3.2.2.cmml" xref="alg4.l7.m1.2.3.2.2">𝑦</ci><ci id="alg4.l7.m1.2.3.2.3.cmml" xref="alg4.l7.m1.2.3.2.3">𝑡</ci></apply><apply id="alg4.l7.m1.2.3.3.cmml" xref="alg4.l7.m1.2.3.3"><times id="alg4.l7.m1.2.3.3.1.cmml" xref="alg4.l7.m1.2.3.3.1"></times><ci id="alg4.l7.m1.2.3.3.2.cmml" xref="alg4.l7.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg4.l7.m1.2.3.3.3.1.cmml" xref="alg4.l7.m1.2.3.3.3.2"><cn id="alg4.l7.m1.1.1.cmml" type="integer" xref="alg4.l7.m1.1.1">0</cn><ci id="alg4.l7.m1.2.2.cmml" xref="alg4.l7.m1.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.m1.2c">y_{t}\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.m1.2d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math><span class="ltx_text" id="alg4.l7.3" style="font-size:80%;">,
</span>
</div>
<div class="ltx_listingline" id="alg4.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg4.l8.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg4.l8.3" style="font-size:80%;">for</span><span class="ltx_text" id="alg4.l8.4" style="font-size:80%;"> </span><math alttext="t=T,\ldots,1" class="ltx_Math" display="inline" id="alg4.l8.m1.3"><semantics id="alg4.l8.m1.3a"><mrow id="alg4.l8.m1.3.4" xref="alg4.l8.m1.3.4.cmml"><mi id="alg4.l8.m1.3.4.2" mathsize="80%" xref="alg4.l8.m1.3.4.2.cmml">t</mi><mo id="alg4.l8.m1.3.4.1" mathsize="80%" xref="alg4.l8.m1.3.4.1.cmml">=</mo><mrow id="alg4.l8.m1.3.4.3.2" xref="alg4.l8.m1.3.4.3.1.cmml"><mi id="alg4.l8.m1.1.1" mathsize="80%" xref="alg4.l8.m1.1.1.cmml">T</mi><mo id="alg4.l8.m1.3.4.3.2.1" mathsize="80%" xref="alg4.l8.m1.3.4.3.1.cmml">,</mo><mi id="alg4.l8.m1.2.2" mathsize="80%" mathvariant="normal" xref="alg4.l8.m1.2.2.cmml">…</mi><mo id="alg4.l8.m1.3.4.3.2.2" mathsize="80%" xref="alg4.l8.m1.3.4.3.1.cmml">,</mo><mn id="alg4.l8.m1.3.3" mathsize="80%" xref="alg4.l8.m1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l8.m1.3b"><apply id="alg4.l8.m1.3.4.cmml" xref="alg4.l8.m1.3.4"><eq id="alg4.l8.m1.3.4.1.cmml" xref="alg4.l8.m1.3.4.1"></eq><ci id="alg4.l8.m1.3.4.2.cmml" xref="alg4.l8.m1.3.4.2">𝑡</ci><list id="alg4.l8.m1.3.4.3.1.cmml" xref="alg4.l8.m1.3.4.3.2"><ci id="alg4.l8.m1.1.1.cmml" xref="alg4.l8.m1.1.1">𝑇</ci><ci id="alg4.l8.m1.2.2.cmml" xref="alg4.l8.m1.2.2">…</ci><cn id="alg4.l8.m1.3.3.cmml" type="integer" xref="alg4.l8.m1.3.3">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.m1.3c">t=T,\ldots,1</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.m1.3d">italic_t = italic_T , … , 1</annotation></semantics></math><span class="ltx_text" id="alg4.l8.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg4.l8.6" style="font-size:80%;">do</span><span class="ltx_text" id="alg4.l8.7" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg4.l9.2" style="font-size:80%;">        </span><math alttext="y_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)" class="ltx_Math" display="inline" id="alg4.l9.m1.4"><semantics id="alg4.l9.m1.4a"><mrow id="alg4.l9.m1.4.4" xref="alg4.l9.m1.4.4.cmml"><msubsup id="alg4.l9.m1.4.4.4" xref="alg4.l9.m1.4.4.4.cmml"><mi id="alg4.l9.m1.4.4.4.2.2" mathsize="80%" xref="alg4.l9.m1.4.4.4.2.2.cmml">y</mi><mn id="alg4.l9.m1.4.4.4.2.3" mathsize="80%" xref="alg4.l9.m1.4.4.4.2.3.cmml">0</mn><mo id="alg4.l9.m1.4.4.4.3" mathsize="80%" xref="alg4.l9.m1.4.4.4.3.cmml">′</mo></msubsup><mo id="alg4.l9.m1.4.4.3" mathsize="80%" xref="alg4.l9.m1.4.4.3.cmml">=</mo><mrow id="alg4.l9.m1.4.4.2" xref="alg4.l9.m1.4.4.2.cmml"><msub id="alg4.l9.m1.4.4.2.4" xref="alg4.l9.m1.4.4.2.4.cmml"><mi id="alg4.l9.m1.4.4.2.4.2" mathsize="80%" xref="alg4.l9.m1.4.4.2.4.2.cmml">G</mi><mtext id="alg4.l9.m1.4.4.2.4.3" mathsize="80%" xref="alg4.l9.m1.4.4.2.4.3a.cmml">sn</mtext></msub><mo id="alg4.l9.m1.4.4.2.3" xref="alg4.l9.m1.4.4.2.3.cmml">⁢</mo><mrow id="alg4.l9.m1.4.4.2.2.2" xref="alg4.l9.m1.4.4.2.2.3.cmml"><mo id="alg4.l9.m1.4.4.2.2.2.3" maxsize="80%" minsize="80%" xref="alg4.l9.m1.4.4.2.2.3.cmml">(</mo><msub id="alg4.l9.m1.3.3.1.1.1.1" xref="alg4.l9.m1.3.3.1.1.1.1.cmml"><mi id="alg4.l9.m1.3.3.1.1.1.1.2" mathsize="80%" xref="alg4.l9.m1.3.3.1.1.1.1.2.cmml">y</mi><mi id="alg4.l9.m1.3.3.1.1.1.1.3" mathsize="80%" xref="alg4.l9.m1.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg4.l9.m1.4.4.2.2.2.4" mathsize="80%" xref="alg4.l9.m1.4.4.2.2.3.cmml">,</mo><msub id="alg4.l9.m1.4.4.2.2.2.2" xref="alg4.l9.m1.4.4.2.2.2.2.cmml"><mi id="alg4.l9.m1.4.4.2.2.2.2.2" mathsize="80%" xref="alg4.l9.m1.4.4.2.2.2.2.2.cmml">x</mi><mn id="alg4.l9.m1.4.4.2.2.2.2.3" mathsize="80%" xref="alg4.l9.m1.4.4.2.2.2.2.3.cmml">0</mn></msub><mo id="alg4.l9.m1.4.4.2.2.2.5" mathsize="80%" xref="alg4.l9.m1.4.4.2.2.3.cmml">,</mo><mi id="alg4.l9.m1.1.1" mathsize="80%" xref="alg4.l9.m1.1.1.cmml">z</mi><mo id="alg4.l9.m1.4.4.2.2.2.6" mathsize="80%" xref="alg4.l9.m1.4.4.2.2.3.cmml">,</mo><mi id="alg4.l9.m1.2.2" mathsize="80%" xref="alg4.l9.m1.2.2.cmml">t</mi><mo id="alg4.l9.m1.4.4.2.2.2.7" maxsize="80%" minsize="80%" xref="alg4.l9.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l9.m1.4b"><apply id="alg4.l9.m1.4.4.cmml" xref="alg4.l9.m1.4.4"><eq id="alg4.l9.m1.4.4.3.cmml" xref="alg4.l9.m1.4.4.3"></eq><apply id="alg4.l9.m1.4.4.4.cmml" xref="alg4.l9.m1.4.4.4"><csymbol cd="ambiguous" id="alg4.l9.m1.4.4.4.1.cmml" xref="alg4.l9.m1.4.4.4">superscript</csymbol><apply id="alg4.l9.m1.4.4.4.2.cmml" xref="alg4.l9.m1.4.4.4"><csymbol cd="ambiguous" id="alg4.l9.m1.4.4.4.2.1.cmml" xref="alg4.l9.m1.4.4.4">subscript</csymbol><ci id="alg4.l9.m1.4.4.4.2.2.cmml" xref="alg4.l9.m1.4.4.4.2.2">𝑦</ci><cn id="alg4.l9.m1.4.4.4.2.3.cmml" type="integer" xref="alg4.l9.m1.4.4.4.2.3">0</cn></apply><ci id="alg4.l9.m1.4.4.4.3.cmml" xref="alg4.l9.m1.4.4.4.3">′</ci></apply><apply id="alg4.l9.m1.4.4.2.cmml" xref="alg4.l9.m1.4.4.2"><times id="alg4.l9.m1.4.4.2.3.cmml" xref="alg4.l9.m1.4.4.2.3"></times><apply id="alg4.l9.m1.4.4.2.4.cmml" xref="alg4.l9.m1.4.4.2.4"><csymbol cd="ambiguous" id="alg4.l9.m1.4.4.2.4.1.cmml" xref="alg4.l9.m1.4.4.2.4">subscript</csymbol><ci id="alg4.l9.m1.4.4.2.4.2.cmml" xref="alg4.l9.m1.4.4.2.4.2">𝐺</ci><ci id="alg4.l9.m1.4.4.2.4.3a.cmml" xref="alg4.l9.m1.4.4.2.4.3"><mtext id="alg4.l9.m1.4.4.2.4.3.cmml" mathsize="56%" xref="alg4.l9.m1.4.4.2.4.3">sn</mtext></ci></apply><vector id="alg4.l9.m1.4.4.2.2.3.cmml" xref="alg4.l9.m1.4.4.2.2.2"><apply id="alg4.l9.m1.3.3.1.1.1.1.cmml" xref="alg4.l9.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l9.m1.3.3.1.1.1.1.1.cmml" xref="alg4.l9.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg4.l9.m1.3.3.1.1.1.1.2.cmml" xref="alg4.l9.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="alg4.l9.m1.3.3.1.1.1.1.3.cmml" xref="alg4.l9.m1.3.3.1.1.1.1.3">𝑡</ci></apply><apply id="alg4.l9.m1.4.4.2.2.2.2.cmml" xref="alg4.l9.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l9.m1.4.4.2.2.2.2.1.cmml" xref="alg4.l9.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg4.l9.m1.4.4.2.2.2.2.2.cmml" xref="alg4.l9.m1.4.4.2.2.2.2.2">𝑥</ci><cn id="alg4.l9.m1.4.4.2.2.2.2.3.cmml" type="integer" xref="alg4.l9.m1.4.4.2.2.2.2.3">0</cn></apply><ci id="alg4.l9.m1.1.1.cmml" xref="alg4.l9.m1.1.1">𝑧</ci><ci id="alg4.l9.m1.2.2.cmml" xref="alg4.l9.m1.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.m1.4c">y_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.m1.4d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_G start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_z , italic_t )</annotation></semantics></math><span class="ltx_text" id="alg4.l9.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg4.l10.2" style="font-size:80%;">        </span><math alttext="q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})" class="ltx_Math" display="inline" id="alg4.l10.m1.1"><semantics id="alg4.l10.m1.1a"><mrow id="alg4.l10.m1.1.1" xref="alg4.l10.m1.1.1.cmml"><mi id="alg4.l10.m1.1.1.3" mathsize="80%" xref="alg4.l10.m1.1.1.3.cmml">q</mi><mo id="alg4.l10.m1.1.1.2" xref="alg4.l10.m1.1.1.2.cmml">⁢</mo><mrow id="alg4.l10.m1.1.1.1.1" xref="alg4.l10.m1.1.1.1.1.1.cmml"><mo id="alg4.l10.m1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg4.l10.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg4.l10.m1.1.1.1.1.1" xref="alg4.l10.m1.1.1.1.1.1.cmml"><msubsup id="alg4.l10.m1.1.1.1.1.1.4" xref="alg4.l10.m1.1.1.1.1.1.4.cmml"><mi id="alg4.l10.m1.1.1.1.1.1.4.2.2" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="alg4.l10.m1.1.1.1.1.1.4.2.3" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.cmml"><mi id="alg4.l10.m1.1.1.1.1.1.4.2.3.2" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="alg4.l10.m1.1.1.1.1.1.4.2.3.1" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="alg4.l10.m1.1.1.1.1.1.4.2.3.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="alg4.l10.m1.1.1.1.1.1.4.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="alg4.l10.m1.1.1.1.1.1.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.3.cmml">∣</mo><mrow id="alg4.l10.m1.1.1.1.1.1.2.2" xref="alg4.l10.m1.1.1.1.1.1.2.3.cmml"><msub id="alg4.l10.m1.1.1.1.1.1.1.1.1" xref="alg4.l10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg4.l10.m1.1.1.1.1.1.1.1.1.2" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="alg4.l10.m1.1.1.1.1.1.1.1.1.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg4.l10.m1.1.1.1.1.1.2.2.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="alg4.l10.m1.1.1.1.1.1.2.2.2" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.cmml"><mi id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.2" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="alg4.l10.m1.1.1.1.1.1.2.2.2.3" mathsize="80%" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="alg4.l10.m1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg4.l10.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l10.m1.1b"><apply id="alg4.l10.m1.1.1.cmml" xref="alg4.l10.m1.1.1"><times id="alg4.l10.m1.1.1.2.cmml" xref="alg4.l10.m1.1.1.2"></times><ci id="alg4.l10.m1.1.1.3.cmml" xref="alg4.l10.m1.1.1.3">𝑞</ci><apply id="alg4.l10.m1.1.1.1.1.1.cmml" xref="alg4.l10.m1.1.1.1.1"><csymbol cd="latexml" id="alg4.l10.m1.1.1.1.1.1.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.3">conditional</csymbol><apply id="alg4.l10.m1.1.1.1.1.1.4.cmml" xref="alg4.l10.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.1.1.4.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.4">superscript</csymbol><apply id="alg4.l10.m1.1.1.1.1.1.4.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.1.1.4.2.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.4">subscript</csymbol><ci id="alg4.l10.m1.1.1.1.1.1.4.2.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.4.2.2">𝑦</ci><apply id="alg4.l10.m1.1.1.1.1.1.4.2.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.4.2.3"><minus id="alg4.l10.m1.1.1.1.1.1.4.2.3.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.1"></minus><ci id="alg4.l10.m1.1.1.1.1.1.4.2.3.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="alg4.l10.m1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="alg4.l10.m1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="alg4.l10.m1.1.1.1.1.1.4.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.4.3">′</ci></apply><list id="alg4.l10.m1.1.1.1.1.1.2.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2"><apply id="alg4.l10.m1.1.1.1.1.1.1.1.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="alg4.l10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg4.l10.m1.1.1.1.1.1.2.2.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.1.1.2.2.2.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="alg4.l10.m1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="alg4.l10.m1.1.1.1.1.1.2.2.2.3.cmml" xref="alg4.l10.m1.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m1.1c">q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.m1.1d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg4.l10.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg4.l11.2" style="font-size:80%;">    </span><span class="ltx_text ltx_font_bold" id="alg4.l11.3" style="font-size:80%;">end</span><span class="ltx_text" id="alg4.l11.4" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg4.l11.5" style="font-size:80%;">for</span>
</div>
<div class="ltx_listingline" id="alg4.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg4.l12.2" style="font-size:80%;">    </span><math alttext="y_{p_{k}}^{\prime}=\text{IDWT}(y_{0}^{\prime})" class="ltx_Math" display="inline" id="alg4.l12.m1.1"><semantics id="alg4.l12.m1.1a"><mrow id="alg4.l12.m1.1.1" xref="alg4.l12.m1.1.1.cmml"><msubsup id="alg4.l12.m1.1.1.3" xref="alg4.l12.m1.1.1.3.cmml"><mi id="alg4.l12.m1.1.1.3.2.2" mathsize="80%" xref="alg4.l12.m1.1.1.3.2.2.cmml">y</mi><msub id="alg4.l12.m1.1.1.3.2.3" xref="alg4.l12.m1.1.1.3.2.3.cmml"><mi id="alg4.l12.m1.1.1.3.2.3.2" mathsize="80%" xref="alg4.l12.m1.1.1.3.2.3.2.cmml">p</mi><mi id="alg4.l12.m1.1.1.3.2.3.3" mathsize="80%" xref="alg4.l12.m1.1.1.3.2.3.3.cmml">k</mi></msub><mo id="alg4.l12.m1.1.1.3.3" mathsize="80%" xref="alg4.l12.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="alg4.l12.m1.1.1.2" mathsize="80%" xref="alg4.l12.m1.1.1.2.cmml">=</mo><mrow id="alg4.l12.m1.1.1.1" xref="alg4.l12.m1.1.1.1.cmml"><mtext id="alg4.l12.m1.1.1.1.3" mathsize="80%" xref="alg4.l12.m1.1.1.1.3a.cmml">IDWT</mtext><mo id="alg4.l12.m1.1.1.1.2" xref="alg4.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg4.l12.m1.1.1.1.1.1" xref="alg4.l12.m1.1.1.1.1.1.1.cmml"><mo id="alg4.l12.m1.1.1.1.1.1.2" maxsize="80%" minsize="80%" xref="alg4.l12.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg4.l12.m1.1.1.1.1.1.1" xref="alg4.l12.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l12.m1.1.1.1.1.1.1.2.2" mathsize="80%" xref="alg4.l12.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="alg4.l12.m1.1.1.1.1.1.1.2.3" mathsize="80%" xref="alg4.l12.m1.1.1.1.1.1.1.2.3.cmml">0</mn><mo id="alg4.l12.m1.1.1.1.1.1.1.3" mathsize="80%" xref="alg4.l12.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg4.l12.m1.1.1.1.1.1.3" maxsize="80%" minsize="80%" xref="alg4.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m1.1b"><apply id="alg4.l12.m1.1.1.cmml" xref="alg4.l12.m1.1.1"><eq id="alg4.l12.m1.1.1.2.cmml" xref="alg4.l12.m1.1.1.2"></eq><apply id="alg4.l12.m1.1.1.3.cmml" xref="alg4.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.3.1.cmml" xref="alg4.l12.m1.1.1.3">superscript</csymbol><apply id="alg4.l12.m1.1.1.3.2.cmml" xref="alg4.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.3.2.1.cmml" xref="alg4.l12.m1.1.1.3">subscript</csymbol><ci id="alg4.l12.m1.1.1.3.2.2.cmml" xref="alg4.l12.m1.1.1.3.2.2">𝑦</ci><apply id="alg4.l12.m1.1.1.3.2.3.cmml" xref="alg4.l12.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.3.2.3.1.cmml" xref="alg4.l12.m1.1.1.3.2.3">subscript</csymbol><ci id="alg4.l12.m1.1.1.3.2.3.2.cmml" xref="alg4.l12.m1.1.1.3.2.3.2">𝑝</ci><ci id="alg4.l12.m1.1.1.3.2.3.3.cmml" xref="alg4.l12.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><ci id="alg4.l12.m1.1.1.3.3.cmml" xref="alg4.l12.m1.1.1.3.3">′</ci></apply><apply id="alg4.l12.m1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1"><times id="alg4.l12.m1.1.1.1.2.cmml" xref="alg4.l12.m1.1.1.1.2"></times><ci id="alg4.l12.m1.1.1.1.3a.cmml" xref="alg4.l12.m1.1.1.1.3"><mtext id="alg4.l12.m1.1.1.1.3.cmml" mathsize="80%" xref="alg4.l12.m1.1.1.1.3">IDWT</mtext></ci><apply id="alg4.l12.m1.1.1.1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1.1.1">superscript</csymbol><apply id="alg4.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.1.1.1.1.2.1.cmml" xref="alg4.l12.m1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l12.m1.1.1.1.1.1.1.2.2.cmml" xref="alg4.l12.m1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="alg4.l12.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg4.l12.m1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg4.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l12.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m1.1c">y_{p_{k}}^{\prime}=\text{IDWT}(y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m1.1d">italic_y start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = IDWT ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg4.l12.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg4.l13.2" style="font-size:80%;">    </span><math alttext="\bm{\hat{\Omega}}_{t}=\bm{\hat{\Omega}}_{t}+Filling(\mathbf{M}_{k},y_{p_{k}}^{\prime}" class="ltx_math_unparsed" display="inline" id="alg4.l13.m1.1"><semantics id="alg4.l13.m1.1a"><mrow id="alg4.l13.m1.1b"><msub id="alg4.l13.m1.1.1"><mover accent="true" id="alg4.l13.m1.1.1.2"><mi id="alg4.l13.m1.1.1.2.2" mathsize="80%">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l13.m1.1.1.2.1" mathsize="80%" mathvariant="bold">^</mo></mover><mi id="alg4.l13.m1.1.1.3" mathsize="80%">t</mi></msub><mo id="alg4.l13.m1.1.2" mathsize="80%">=</mo><msub id="alg4.l13.m1.1.3"><mover accent="true" id="alg4.l13.m1.1.3.2"><mi id="alg4.l13.m1.1.3.2.2" mathsize="80%">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l13.m1.1.3.2.1" mathsize="80%" mathvariant="bold">^</mo></mover><mi id="alg4.l13.m1.1.3.3" mathsize="80%">t</mi></msub><mo id="alg4.l13.m1.1.4" mathsize="80%">+</mo><mi id="alg4.l13.m1.1.5" mathsize="80%">F</mi><mi id="alg4.l13.m1.1.6" mathsize="80%">i</mi><mi id="alg4.l13.m1.1.7" mathsize="80%">l</mi><mi id="alg4.l13.m1.1.8" mathsize="80%">l</mi><mi id="alg4.l13.m1.1.9" mathsize="80%">i</mi><mi id="alg4.l13.m1.1.10" mathsize="80%">n</mi><mi id="alg4.l13.m1.1.11" mathsize="80%">g</mi><mrow id="alg4.l13.m1.1.12"><mo id="alg4.l13.m1.1.12.1" maxsize="80%" minsize="80%">(</mo><msub id="alg4.l13.m1.1.12.2"><mi id="alg4.l13.m1.1.12.2.2" mathsize="80%">𝐌</mi><mi id="alg4.l13.m1.1.12.2.3" mathsize="80%">k</mi></msub><mo id="alg4.l13.m1.1.12.3" mathsize="80%">,</mo><msubsup id="alg4.l13.m1.1.12.4"><mi id="alg4.l13.m1.1.12.4.2.2" mathsize="80%">y</mi><msub id="alg4.l13.m1.1.12.4.2.3"><mi id="alg4.l13.m1.1.12.4.2.3.2" mathsize="80%">p</mi><mi id="alg4.l13.m1.1.12.4.2.3.3" mathsize="80%">k</mi></msub><mo id="alg4.l13.m1.1.12.4.3" mathsize="80%">′</mo></msubsup></mrow></mrow><annotation encoding="application/x-tex" id="alg4.l13.m1.1c">\bm{\hat{\Omega}}_{t}=\bm{\hat{\Omega}}_{t}+Filling(\mathbf{M}_{k},y_{p_{k}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m1.1d">overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_F italic_i italic_l italic_l italic_i italic_n italic_g ( bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg4.l13.3" style="font-size:80%;">) // fill the patch in </span><math alttext="\mathbf{M}_{k}" class="ltx_Math" display="inline" id="alg4.l13.m2.1"><semantics id="alg4.l13.m2.1a"><msub id="alg4.l13.m2.1.1" xref="alg4.l13.m2.1.1.cmml"><mi id="alg4.l13.m2.1.1.2" mathsize="80%" xref="alg4.l13.m2.1.1.2.cmml">𝐌</mi><mi id="alg4.l13.m2.1.1.3" mathsize="80%" xref="alg4.l13.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l13.m2.1b"><apply id="alg4.l13.m2.1.1.cmml" xref="alg4.l13.m2.1.1"><csymbol cd="ambiguous" id="alg4.l13.m2.1.1.1.cmml" xref="alg4.l13.m2.1.1">subscript</csymbol><ci id="alg4.l13.m2.1.1.2.cmml" xref="alg4.l13.m2.1.1.2">𝐌</ci><ci id="alg4.l13.m2.1.1.3.cmml" xref="alg4.l13.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m2.1c">\mathbf{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m2.1d">bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg4.l13.4" style="font-size:80%;"> with </span><math alttext="y_{p_{k}}^{\prime}" class="ltx_Math" display="inline" id="alg4.l13.m3.1"><semantics id="alg4.l13.m3.1a"><msubsup id="alg4.l13.m3.1.1" xref="alg4.l13.m3.1.1.cmml"><mi id="alg4.l13.m3.1.1.2.2" mathsize="80%" xref="alg4.l13.m3.1.1.2.2.cmml">y</mi><msub id="alg4.l13.m3.1.1.2.3" xref="alg4.l13.m3.1.1.2.3.cmml"><mi id="alg4.l13.m3.1.1.2.3.2" mathsize="80%" xref="alg4.l13.m3.1.1.2.3.2.cmml">p</mi><mi id="alg4.l13.m3.1.1.2.3.3" mathsize="80%" xref="alg4.l13.m3.1.1.2.3.3.cmml">k</mi></msub><mo id="alg4.l13.m3.1.1.3" mathsize="80%" xref="alg4.l13.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg4.l13.m3.1b"><apply id="alg4.l13.m3.1.1.cmml" xref="alg4.l13.m3.1.1"><csymbol cd="ambiguous" id="alg4.l13.m3.1.1.1.cmml" xref="alg4.l13.m3.1.1">superscript</csymbol><apply id="alg4.l13.m3.1.1.2.cmml" xref="alg4.l13.m3.1.1"><csymbol cd="ambiguous" id="alg4.l13.m3.1.1.2.1.cmml" xref="alg4.l13.m3.1.1">subscript</csymbol><ci id="alg4.l13.m3.1.1.2.2.cmml" xref="alg4.l13.m3.1.1.2.2">𝑦</ci><apply id="alg4.l13.m3.1.1.2.3.cmml" xref="alg4.l13.m3.1.1.2.3"><csymbol cd="ambiguous" id="alg4.l13.m3.1.1.2.3.1.cmml" xref="alg4.l13.m3.1.1.2.3">subscript</csymbol><ci id="alg4.l13.m3.1.1.2.3.2.cmml" xref="alg4.l13.m3.1.1.2.3.2">𝑝</ci><ci id="alg4.l13.m3.1.1.2.3.3.cmml" xref="alg4.l13.m3.1.1.2.3.3">𝑘</ci></apply></apply><ci id="alg4.l13.m3.1.1.3.cmml" xref="alg4.l13.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m3.1c">y_{p_{k}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m3.1d">italic_y start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg4.l13.5" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg4.l14.2" style="font-size:80%;">    </span><math alttext="\mathbf{M}=\mathbf{M}+\mathbf{M}_{k}" class="ltx_Math" display="inline" id="alg4.l14.m1.1"><semantics id="alg4.l14.m1.1a"><mrow id="alg4.l14.m1.1.1" xref="alg4.l14.m1.1.1.cmml"><mi id="alg4.l14.m1.1.1.2" mathsize="80%" xref="alg4.l14.m1.1.1.2.cmml">𝐌</mi><mo id="alg4.l14.m1.1.1.1" mathsize="80%" xref="alg4.l14.m1.1.1.1.cmml">=</mo><mrow id="alg4.l14.m1.1.1.3" xref="alg4.l14.m1.1.1.3.cmml"><mi id="alg4.l14.m1.1.1.3.2" mathsize="80%" xref="alg4.l14.m1.1.1.3.2.cmml">𝐌</mi><mo id="alg4.l14.m1.1.1.3.1" mathsize="80%" xref="alg4.l14.m1.1.1.3.1.cmml">+</mo><msub id="alg4.l14.m1.1.1.3.3" xref="alg4.l14.m1.1.1.3.3.cmml"><mi id="alg4.l14.m1.1.1.3.3.2" mathsize="80%" xref="alg4.l14.m1.1.1.3.3.2.cmml">𝐌</mi><mi id="alg4.l14.m1.1.1.3.3.3" mathsize="80%" xref="alg4.l14.m1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.m1.1b"><apply id="alg4.l14.m1.1.1.cmml" xref="alg4.l14.m1.1.1"><eq id="alg4.l14.m1.1.1.1.cmml" xref="alg4.l14.m1.1.1.1"></eq><ci id="alg4.l14.m1.1.1.2.cmml" xref="alg4.l14.m1.1.1.2">𝐌</ci><apply id="alg4.l14.m1.1.1.3.cmml" xref="alg4.l14.m1.1.1.3"><plus id="alg4.l14.m1.1.1.3.1.cmml" xref="alg4.l14.m1.1.1.3.1"></plus><ci id="alg4.l14.m1.1.1.3.2.cmml" xref="alg4.l14.m1.1.1.3.2">𝐌</ci><apply id="alg4.l14.m1.1.1.3.3.cmml" xref="alg4.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l14.m1.1.1.3.3.1.cmml" xref="alg4.l14.m1.1.1.3.3">subscript</csymbol><ci id="alg4.l14.m1.1.1.3.3.2.cmml" xref="alg4.l14.m1.1.1.3.3.2">𝐌</ci><ci id="alg4.l14.m1.1.1.3.3.3.cmml" xref="alg4.l14.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.m1.1c">\mathbf{M}=\mathbf{M}+\mathbf{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.m1.1d">bold_M = bold_M + bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg4.l14.3" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg4.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text ltx_font_bold" id="alg4.l15.2" style="font-size:80%;">end</span><span class="ltx_text" id="alg4.l15.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg4.l15.4" style="font-size:80%;">for</span>
</div>
<div class="ltx_listingline" id="alg4.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l16.1.1.1" style="font-size:80%;">16:</span></span><math alttext="\bm{\hat{\Omega}}_{t}=\bm{\hat{\Omega}}_{t}\oslash\mathbf{M}" class="ltx_Math" display="inline" id="alg4.l16.m1.1"><semantics id="alg4.l16.m1.1a"><mrow id="alg4.l16.m1.1.1" xref="alg4.l16.m1.1.1.cmml"><msub id="alg4.l16.m1.1.1.2" xref="alg4.l16.m1.1.1.2.cmml"><mover accent="true" id="alg4.l16.m1.1.1.2.2" xref="alg4.l16.m1.1.1.2.2.cmml"><mi id="alg4.l16.m1.1.1.2.2.2" mathsize="80%" xref="alg4.l16.m1.1.1.2.2.2.cmml">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l16.m1.1.1.2.2.1" mathsize="80%" mathvariant="bold" xref="alg4.l16.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg4.l16.m1.1.1.2.3" mathsize="80%" xref="alg4.l16.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg4.l16.m1.1.1.1" mathsize="80%" xref="alg4.l16.m1.1.1.1.cmml">=</mo><mrow id="alg4.l16.m1.1.1.3" xref="alg4.l16.m1.1.1.3.cmml"><msub id="alg4.l16.m1.1.1.3.2" xref="alg4.l16.m1.1.1.3.2.cmml"><mover accent="true" id="alg4.l16.m1.1.1.3.2.2" xref="alg4.l16.m1.1.1.3.2.2.cmml"><mi id="alg4.l16.m1.1.1.3.2.2.2" mathsize="80%" xref="alg4.l16.m1.1.1.3.2.2.2.cmml">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l16.m1.1.1.3.2.2.1" mathsize="80%" mathvariant="bold" xref="alg4.l16.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="alg4.l16.m1.1.1.3.2.3" mathsize="80%" xref="alg4.l16.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg4.l16.m1.1.1.3.1" mathsize="80%" xref="alg4.l16.m1.1.1.3.1.cmml">⊘</mo><mi id="alg4.l16.m1.1.1.3.3" mathsize="80%" xref="alg4.l16.m1.1.1.3.3.cmml">𝐌</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l16.m1.1b"><apply id="alg4.l16.m1.1.1.cmml" xref="alg4.l16.m1.1.1"><eq id="alg4.l16.m1.1.1.1.cmml" xref="alg4.l16.m1.1.1.1"></eq><apply id="alg4.l16.m1.1.1.2.cmml" xref="alg4.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l16.m1.1.1.2.1.cmml" xref="alg4.l16.m1.1.1.2">subscript</csymbol><apply id="alg4.l16.m1.1.1.2.2.cmml" xref="alg4.l16.m1.1.1.2.2"><ci id="alg4.l16.m1.1.1.2.2.1.cmml" xref="alg4.l16.m1.1.1.2.2.1">bold-^</ci><ci id="alg4.l16.m1.1.1.2.2.2.cmml" xref="alg4.l16.m1.1.1.2.2.2">𝛀</ci></apply><ci id="alg4.l16.m1.1.1.2.3.cmml" xref="alg4.l16.m1.1.1.2.3">𝑡</ci></apply><apply id="alg4.l16.m1.1.1.3.cmml" xref="alg4.l16.m1.1.1.3"><ci id="alg4.l16.m1.1.1.3.1.cmml" xref="alg4.l16.m1.1.1.3.1">⊘</ci><apply id="alg4.l16.m1.1.1.3.2.cmml" xref="alg4.l16.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg4.l16.m1.1.1.3.2.1.cmml" xref="alg4.l16.m1.1.1.3.2">subscript</csymbol><apply id="alg4.l16.m1.1.1.3.2.2.cmml" xref="alg4.l16.m1.1.1.3.2.2"><ci id="alg4.l16.m1.1.1.3.2.2.1.cmml" xref="alg4.l16.m1.1.1.3.2.2.1">bold-^</ci><ci id="alg4.l16.m1.1.1.3.2.2.2.cmml" xref="alg4.l16.m1.1.1.3.2.2.2">𝛀</ci></apply><ci id="alg4.l16.m1.1.1.3.2.3.cmml" xref="alg4.l16.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg4.l16.m1.1.1.3.3.cmml" xref="alg4.l16.m1.1.1.3.3">𝐌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l16.m1.1c">\bm{\hat{\Omega}}_{t}=\bm{\hat{\Omega}}_{t}\oslash\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="alg4.l16.m1.1d">overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊘ bold_M</annotation></semantics></math><span class="ltx_text" id="alg4.l16.2" style="font-size:80%;">       // </span><math alttext="\oslash" class="ltx_Math" display="inline" id="alg4.l16.m2.1"><semantics id="alg4.l16.m2.1a"><mo id="alg4.l16.m2.1.1" mathsize="80%" xref="alg4.l16.m2.1.1.cmml">⊘</mo><annotation-xml encoding="MathML-Content" id="alg4.l16.m2.1b"><ci id="alg4.l16.m2.1.1.cmml" xref="alg4.l16.m2.1.1">⊘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l16.m2.1c">\oslash</annotation><annotation encoding="application/x-llamapun" id="alg4.l16.m2.1d">⊘</annotation></semantics></math><span class="ltx_text" id="alg4.l16.3" style="font-size:80%;">: element-wise division
</span>
</div>
<div class="ltx_listingline" id="alg4.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg4.l17.2" style="font-size:80%;">return</span><span class="ltx_text" id="alg4.l17.3" style="font-size:80%;"> </span><math alttext="\bm{\hat{\Omega}}_{t}" class="ltx_Math" display="inline" id="alg4.l17.m1.1"><semantics id="alg4.l17.m1.1a"><msub id="alg4.l17.m1.1.1" xref="alg4.l17.m1.1.1.cmml"><mover accent="true" id="alg4.l17.m1.1.1.2" xref="alg4.l17.m1.1.1.2.cmml"><mi id="alg4.l17.m1.1.1.2.2" mathsize="80%" xref="alg4.l17.m1.1.1.2.2.cmml">𝛀</mi><mo class="ltx_mathvariant_bold" id="alg4.l17.m1.1.1.2.1" mathsize="80%" mathvariant="bold" xref="alg4.l17.m1.1.1.2.1.cmml">^</mo></mover><mi id="alg4.l17.m1.1.1.3" mathsize="80%" xref="alg4.l17.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l17.m1.1b"><apply id="alg4.l17.m1.1.1.cmml" xref="alg4.l17.m1.1.1"><csymbol cd="ambiguous" id="alg4.l17.m1.1.1.1.cmml" xref="alg4.l17.m1.1.1">subscript</csymbol><apply id="alg4.l17.m1.1.1.2.cmml" xref="alg4.l17.m1.1.1.2"><ci id="alg4.l17.m1.1.1.2.1.cmml" xref="alg4.l17.m1.1.1.2.1">bold-^</ci><ci id="alg4.l17.m1.1.1.2.2.cmml" xref="alg4.l17.m1.1.1.2.2">𝛀</ci></apply><ci id="alg4.l17.m1.1.1.3.cmml" xref="alg4.l17.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l17.m1.1c">\bm{\hat{\Omega}}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg4.l17.m1.1d">overbold_^ start_ARG bold_Ω end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg4.l17.4" style="font-size:80%;">
</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.12">For model inference, we continue to use the crop-based data input strategy. Notably, there is a slight difference. Instead of randomly cropping, we crop the degraded image <math alttext="x" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1"><semantics id="S3.SS4.p5.1.m1.1a"><mi id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><ci id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.1.m1.1d">italic_x</annotation></semantics></math> into <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.1"><semantics id="S3.SS4.p5.2.m2.1a"><mi id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><ci id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.2.m2.1d">italic_K</annotation></semantics></math> overlapping patches of size 64<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.p5.3.m3.1"><semantics id="S3.SS4.p5.3.m3.1a"><mo id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><times id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.3.m3.1d">×</annotation></semantics></math>64 over dense regular grids with a spacing of 4 pixels, collected into a dictionary <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS4.p5.4.m4.1"><semantics id="S3.SS4.p5.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.4.m4.1.1" xref="S3.SS4.p5.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m4.1b"><ci id="S3.SS4.p5.4.m4.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.4.m4.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.4.m4.1d">caligraphic_P</annotation></semantics></math>. The dense regular grid cropping strategy is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.F4" title="Figure 4 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">4</span></a>. These patches will be firstly transformed by wavelet and then input into the student network for denoising. After that, the inverse wavelet transform will be conducted on the denoised results to obtain the restoration of these patches. Finally, the restored patches will be reassembled to reconstruct the entire image. Note that, for the overlapping regions, an averaging method is applied to ensure visual consistency, effectively smoothing the edges of these areas to achieve a cohesive and natural image restoration outcome. The illustration of this process is referred to in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S3.F5" title="Figure 5 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">5</span></a>.
As for the details of denoising process, we fed the variable <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS4.p5.5.m5.1"><semantics id="S3.SS4.p5.5.m5.1a"><msub id="S3.SS4.p5.5.m5.1.1" xref="S3.SS4.p5.5.m5.1.1.cmml"><mi id="S3.SS4.p5.5.m5.1.1.2" xref="S3.SS4.p5.5.m5.1.1.2.cmml">y</mi><mi id="S3.SS4.p5.5.m5.1.1.3" xref="S3.SS4.p5.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.m5.1b"><apply id="S3.SS4.p5.5.m5.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.5.m5.1.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p5.5.m5.1.1.2.cmml" xref="S3.SS4.p5.5.m5.1.1.2">𝑦</ci><ci id="S3.SS4.p5.5.m5.1.1.3.cmml" xref="S3.SS4.p5.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.5.m5.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the conditional input <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.SS4.p5.6.m6.1"><semantics id="S3.SS4.p5.6.m6.1a"><msub id="S3.SS4.p5.6.m6.1.1" xref="S3.SS4.p5.6.m6.1.1.cmml"><mi id="S3.SS4.p5.6.m6.1.1.2" xref="S3.SS4.p5.6.m6.1.1.2.cmml">x</mi><mn id="S3.SS4.p5.6.m6.1.1.3" xref="S3.SS4.p5.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.6.m6.1b"><apply id="S3.SS4.p5.6.m6.1.1.cmml" xref="S3.SS4.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.6.m6.1.1.1.cmml" xref="S3.SS4.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p5.6.m6.1.1.2.cmml" xref="S3.SS4.p5.6.m6.1.1.2">𝑥</ci><cn id="S3.SS4.p5.6.m6.1.1.3.cmml" type="integer" xref="S3.SS4.p5.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.6.m6.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.6.m6.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the latent variable <math alttext="z\sim\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.SS4.p5.7.m7.2"><semantics id="S3.SS4.p5.7.m7.2a"><mrow id="S3.SS4.p5.7.m7.2.3" xref="S3.SS4.p5.7.m7.2.3.cmml"><mi id="S3.SS4.p5.7.m7.2.3.2" xref="S3.SS4.p5.7.m7.2.3.2.cmml">z</mi><mo id="S3.SS4.p5.7.m7.2.3.1" xref="S3.SS4.p5.7.m7.2.3.1.cmml">∼</mo><mrow id="S3.SS4.p5.7.m7.2.3.3" xref="S3.SS4.p5.7.m7.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.7.m7.2.3.3.2" xref="S3.SS4.p5.7.m7.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS4.p5.7.m7.2.3.3.1" xref="S3.SS4.p5.7.m7.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS4.p5.7.m7.2.3.3.3.2" xref="S3.SS4.p5.7.m7.2.3.3.3.1.cmml"><mo id="S3.SS4.p5.7.m7.2.3.3.3.2.1" stretchy="false" xref="S3.SS4.p5.7.m7.2.3.3.3.1.cmml">(</mo><mn id="S3.SS4.p5.7.m7.1.1" xref="S3.SS4.p5.7.m7.1.1.cmml">0</mn><mo id="S3.SS4.p5.7.m7.2.3.3.3.2.2" xref="S3.SS4.p5.7.m7.2.3.3.3.1.cmml">,</mo><mi id="S3.SS4.p5.7.m7.2.2" xref="S3.SS4.p5.7.m7.2.2.cmml">𝐈</mi><mo id="S3.SS4.p5.7.m7.2.3.3.3.2.3" stretchy="false" xref="S3.SS4.p5.7.m7.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.7.m7.2b"><apply id="S3.SS4.p5.7.m7.2.3.cmml" xref="S3.SS4.p5.7.m7.2.3"><csymbol cd="latexml" id="S3.SS4.p5.7.m7.2.3.1.cmml" xref="S3.SS4.p5.7.m7.2.3.1">similar-to</csymbol><ci id="S3.SS4.p5.7.m7.2.3.2.cmml" xref="S3.SS4.p5.7.m7.2.3.2">𝑧</ci><apply id="S3.SS4.p5.7.m7.2.3.3.cmml" xref="S3.SS4.p5.7.m7.2.3.3"><times id="S3.SS4.p5.7.m7.2.3.3.1.cmml" xref="S3.SS4.p5.7.m7.2.3.3.1"></times><ci id="S3.SS4.p5.7.m7.2.3.3.2.cmml" xref="S3.SS4.p5.7.m7.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS4.p5.7.m7.2.3.3.3.1.cmml" xref="S3.SS4.p5.7.m7.2.3.3.3.2"><cn id="S3.SS4.p5.7.m7.1.1.cmml" type="integer" xref="S3.SS4.p5.7.m7.1.1">0</cn><ci id="S3.SS4.p5.7.m7.2.2.cmml" xref="S3.SS4.p5.7.m7.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.7.m7.2c">z\sim\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.7.m7.2d">italic_z ∼ caligraphic_N ( 0 , bold_I )</annotation></semantics></math>, and the timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p5.8.m8.1"><semantics id="S3.SS4.p5.8.m8.1a"><mi id="S3.SS4.p5.8.m8.1.1" xref="S3.SS4.p5.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.8.m8.1b"><ci id="S3.SS4.p5.8.m8.1.1.cmml" xref="S3.SS4.p5.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.8.m8.1d">italic_t</annotation></semantics></math> into the generator of the student network to approximate the <math alttext="y_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)" class="ltx_Math" display="inline" id="S3.SS4.p5.9.m9.4"><semantics id="S3.SS4.p5.9.m9.4a"><mrow id="S3.SS4.p5.9.m9.4.4" xref="S3.SS4.p5.9.m9.4.4.cmml"><msubsup id="S3.SS4.p5.9.m9.4.4.4" xref="S3.SS4.p5.9.m9.4.4.4.cmml"><mi id="S3.SS4.p5.9.m9.4.4.4.2.2" xref="S3.SS4.p5.9.m9.4.4.4.2.2.cmml">y</mi><mn id="S3.SS4.p5.9.m9.4.4.4.2.3" xref="S3.SS4.p5.9.m9.4.4.4.2.3.cmml">0</mn><mo id="S3.SS4.p5.9.m9.4.4.4.3" xref="S3.SS4.p5.9.m9.4.4.4.3.cmml">′</mo></msubsup><mo id="S3.SS4.p5.9.m9.4.4.3" xref="S3.SS4.p5.9.m9.4.4.3.cmml">=</mo><mrow id="S3.SS4.p5.9.m9.4.4.2" xref="S3.SS4.p5.9.m9.4.4.2.cmml"><msub id="S3.SS4.p5.9.m9.4.4.2.4" xref="S3.SS4.p5.9.m9.4.4.2.4.cmml"><mi id="S3.SS4.p5.9.m9.4.4.2.4.2" xref="S3.SS4.p5.9.m9.4.4.2.4.2.cmml">G</mi><mtext id="S3.SS4.p5.9.m9.4.4.2.4.3" xref="S3.SS4.p5.9.m9.4.4.2.4.3a.cmml">sn</mtext></msub><mo id="S3.SS4.p5.9.m9.4.4.2.3" xref="S3.SS4.p5.9.m9.4.4.2.3.cmml">⁢</mo><mrow id="S3.SS4.p5.9.m9.4.4.2.2.2" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml"><mo id="S3.SS4.p5.9.m9.4.4.2.2.2.3" stretchy="false" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml">(</mo><msub id="S3.SS4.p5.9.m9.3.3.1.1.1.1" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1.cmml"><mi id="S3.SS4.p5.9.m9.3.3.1.1.1.1.2" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1.2.cmml">y</mi><mi id="S3.SS4.p5.9.m9.3.3.1.1.1.1.3" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p5.9.m9.4.4.2.2.2.4" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml">,</mo><msub id="S3.SS4.p5.9.m9.4.4.2.2.2.2" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2.cmml"><mi id="S3.SS4.p5.9.m9.4.4.2.2.2.2.2" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2.2.cmml">x</mi><mn id="S3.SS4.p5.9.m9.4.4.2.2.2.2.3" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.SS4.p5.9.m9.4.4.2.2.2.5" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml">,</mo><mi id="S3.SS4.p5.9.m9.1.1" xref="S3.SS4.p5.9.m9.1.1.cmml">z</mi><mo id="S3.SS4.p5.9.m9.4.4.2.2.2.6" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml">,</mo><mi id="S3.SS4.p5.9.m9.2.2" xref="S3.SS4.p5.9.m9.2.2.cmml">t</mi><mo id="S3.SS4.p5.9.m9.4.4.2.2.2.7" stretchy="false" xref="S3.SS4.p5.9.m9.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.9.m9.4b"><apply id="S3.SS4.p5.9.m9.4.4.cmml" xref="S3.SS4.p5.9.m9.4.4"><eq id="S3.SS4.p5.9.m9.4.4.3.cmml" xref="S3.SS4.p5.9.m9.4.4.3"></eq><apply id="S3.SS4.p5.9.m9.4.4.4.cmml" xref="S3.SS4.p5.9.m9.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m9.4.4.4.1.cmml" xref="S3.SS4.p5.9.m9.4.4.4">superscript</csymbol><apply id="S3.SS4.p5.9.m9.4.4.4.2.cmml" xref="S3.SS4.p5.9.m9.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m9.4.4.4.2.1.cmml" xref="S3.SS4.p5.9.m9.4.4.4">subscript</csymbol><ci id="S3.SS4.p5.9.m9.4.4.4.2.2.cmml" xref="S3.SS4.p5.9.m9.4.4.4.2.2">𝑦</ci><cn id="S3.SS4.p5.9.m9.4.4.4.2.3.cmml" type="integer" xref="S3.SS4.p5.9.m9.4.4.4.2.3">0</cn></apply><ci id="S3.SS4.p5.9.m9.4.4.4.3.cmml" xref="S3.SS4.p5.9.m9.4.4.4.3">′</ci></apply><apply id="S3.SS4.p5.9.m9.4.4.2.cmml" xref="S3.SS4.p5.9.m9.4.4.2"><times id="S3.SS4.p5.9.m9.4.4.2.3.cmml" xref="S3.SS4.p5.9.m9.4.4.2.3"></times><apply id="S3.SS4.p5.9.m9.4.4.2.4.cmml" xref="S3.SS4.p5.9.m9.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m9.4.4.2.4.1.cmml" xref="S3.SS4.p5.9.m9.4.4.2.4">subscript</csymbol><ci id="S3.SS4.p5.9.m9.4.4.2.4.2.cmml" xref="S3.SS4.p5.9.m9.4.4.2.4.2">𝐺</ci><ci id="S3.SS4.p5.9.m9.4.4.2.4.3a.cmml" xref="S3.SS4.p5.9.m9.4.4.2.4.3"><mtext id="S3.SS4.p5.9.m9.4.4.2.4.3.cmml" mathsize="70%" xref="S3.SS4.p5.9.m9.4.4.2.4.3">sn</mtext></ci></apply><vector id="S3.SS4.p5.9.m9.4.4.2.2.3.cmml" xref="S3.SS4.p5.9.m9.4.4.2.2.2"><apply id="S3.SS4.p5.9.m9.3.3.1.1.1.1.cmml" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m9.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p5.9.m9.3.3.1.1.1.1.2.cmml" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1.2">𝑦</ci><ci id="S3.SS4.p5.9.m9.3.3.1.1.1.1.3.cmml" xref="S3.SS4.p5.9.m9.3.3.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p5.9.m9.4.4.2.2.2.2.cmml" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p5.9.m9.4.4.2.2.2.2.1.cmml" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p5.9.m9.4.4.2.2.2.2.2.cmml" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2.2">𝑥</ci><cn id="S3.SS4.p5.9.m9.4.4.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p5.9.m9.4.4.2.2.2.2.3">0</cn></apply><ci id="S3.SS4.p5.9.m9.1.1.cmml" xref="S3.SS4.p5.9.m9.1.1">𝑧</ci><ci id="S3.SS4.p5.9.m9.2.2.cmml" xref="S3.SS4.p5.9.m9.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.9.m9.4c">y_{0}^{\prime}=G_{\text{sn}}(y_{t},x_{0},z,t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.9.m9.4d">italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_G start_POSTSUBSCRIPT sn end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_z , italic_t )</annotation></semantics></math>. According to the posterior distribution <math alttext="q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p5.10.m10.1"><semantics id="S3.SS4.p5.10.m10.1a"><mrow id="S3.SS4.p5.10.m10.1.1" xref="S3.SS4.p5.10.m10.1.1.cmml"><mi id="S3.SS4.p5.10.m10.1.1.3" xref="S3.SS4.p5.10.m10.1.1.3.cmml">q</mi><mo id="S3.SS4.p5.10.m10.1.1.2" xref="S3.SS4.p5.10.m10.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p5.10.m10.1.1.1.1" xref="S3.SS4.p5.10.m10.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.10.m10.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p5.10.m10.1.1.1.1.1" xref="S3.SS4.p5.10.m10.1.1.1.1.1.cmml"><msubsup id="S3.SS4.p5.10.m10.1.1.1.1.1.4" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.cmml"><mi id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.2.cmml">y</mi><mrow id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.cmml"><mi id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.1" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.10.m10.1.1.1.1.1.4.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="S3.SS4.p5.10.m10.1.1.1.1.1.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.3.cmml"><msub id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.2" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mo id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.3" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.SS4.p5.10.m10.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.10.m10.1b"><apply id="S3.SS4.p5.10.m10.1.1.cmml" xref="S3.SS4.p5.10.m10.1.1"><times id="S3.SS4.p5.10.m10.1.1.2.cmml" xref="S3.SS4.p5.10.m10.1.1.2"></times><ci id="S3.SS4.p5.10.m10.1.1.3.cmml" xref="S3.SS4.p5.10.m10.1.1.3">𝑞</ci><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p5.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.4.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m10.1.1.1.1.1.4.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4">superscript</csymbol><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.2">𝑦</ci><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3"><minus id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.1"></minus><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.4.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.4.3">′</ci></apply><list id="S3.SS4.p5.10.m10.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2"><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS4.p5.10.m10.1.1.1.1.1.2.2.2.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.10.m10.1c">q(y_{t-1}^{\prime}\mid y_{t},y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.10.m10.1d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, then we can obtain the denoised output <math alttext="q(y_{t-1}^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p5.11.m11.1"><semantics id="S3.SS4.p5.11.m11.1a"><mrow id="S3.SS4.p5.11.m11.1.1" xref="S3.SS4.p5.11.m11.1.1.cmml"><mi id="S3.SS4.p5.11.m11.1.1.3" xref="S3.SS4.p5.11.m11.1.1.3.cmml">q</mi><mo id="S3.SS4.p5.11.m11.1.1.2" xref="S3.SS4.p5.11.m11.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p5.11.m11.1.1.1.1" xref="S3.SS4.p5.11.m11.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.11.m11.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.11.m11.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.p5.11.m11.1.1.1.1.1" xref="S3.SS4.p5.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS4.p5.11.m11.1.1.1.1.1.2.2" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.cmml"><mi id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.2" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.1" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.3" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS4.p5.11.m11.1.1.1.1.1.3" xref="S3.SS4.p5.11.m11.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p5.11.m11.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.11.m11.1b"><apply id="S3.SS4.p5.11.m11.1.1.cmml" xref="S3.SS4.p5.11.m11.1.1"><times id="S3.SS4.p5.11.m11.1.1.2.cmml" xref="S3.SS4.p5.11.m11.1.1.2"></times><ci id="S3.SS4.p5.11.m11.1.1.3.cmml" xref="S3.SS4.p5.11.m11.1.1.3">𝑞</ci><apply id="S3.SS4.p5.11.m11.1.1.1.1.1.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p5.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.11.m11.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p5.11.m11.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3"><minus id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.1.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.1"></minus><ci id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.2.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS4.p5.11.m11.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p5.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.11.m11.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.11.m11.1c">q(y_{t-1}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.11.m11.1d">italic_q ( italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>. This process is iteratively repeated until obtaining the final denoised output <math alttext="q(y_{0}^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p5.12.m12.1"><semantics id="S3.SS4.p5.12.m12.1a"><mrow id="S3.SS4.p5.12.m12.1.1" xref="S3.SS4.p5.12.m12.1.1.cmml"><mi id="S3.SS4.p5.12.m12.1.1.3" xref="S3.SS4.p5.12.m12.1.1.3.cmml">q</mi><mo id="S3.SS4.p5.12.m12.1.1.2" xref="S3.SS4.p5.12.m12.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p5.12.m12.1.1.1.1" xref="S3.SS4.p5.12.m12.1.1.1.1.1.cmml"><mo id="S3.SS4.p5.12.m12.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.12.m12.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.p5.12.m12.1.1.1.1.1" xref="S3.SS4.p5.12.m12.1.1.1.1.1.cmml"><mi id="S3.SS4.p5.12.m12.1.1.1.1.1.2.2" xref="S3.SS4.p5.12.m12.1.1.1.1.1.2.2.cmml">y</mi><mn id="S3.SS4.p5.12.m12.1.1.1.1.1.2.3" xref="S3.SS4.p5.12.m12.1.1.1.1.1.2.3.cmml">0</mn><mo id="S3.SS4.p5.12.m12.1.1.1.1.1.3" xref="S3.SS4.p5.12.m12.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS4.p5.12.m12.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.12.m12.1b"><apply id="S3.SS4.p5.12.m12.1.1.cmml" xref="S3.SS4.p5.12.m12.1.1"><times id="S3.SS4.p5.12.m12.1.1.2.cmml" xref="S3.SS4.p5.12.m12.1.1.2"></times><ci id="S3.SS4.p5.12.m12.1.1.3.cmml" xref="S3.SS4.p5.12.m12.1.1.3">𝑞</ci><apply id="S3.SS4.p5.12.m12.1.1.1.1.1.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p5.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.12.m12.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p5.12.m12.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1.1.2.2">𝑦</ci><cn id="S3.SS4.p5.12.m12.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS4.p5.12.m12.1.1.1.1.1.2.3">0</cn></apply><ci id="S3.SS4.p5.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.12.m12.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.12.m12.1c">q(y_{0}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.12.m12.1d">italic_q ( italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, as shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#alg4" title="Algorithm 4 ‣ 3.4 Training and Inference details ‣ 3 The Proposed SemiDDM-Weather ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">4</span></a>, steps 7-10.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Settings</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">(1) <span class="ltx_text ltx_font_italic" id="S4.p1.1.1">Data Preparation</span>: In this part, we detailedly describe the datasets with challenging adverse weather conditions used in our method. Similar to other all-in-one methods <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>, we use a combination of several public adverse weather datasets for training, including Raindrop, Outdoor-Rain, and Snow100K.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Training Dataset.  <span class="ltx_text ltx_font_italic" id="S4.p2.1.1">Raindrop</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib39" title="">39</a>]</cite> training set, comprising 861 images with raindrops, introduce real raindrop artifacts on the camera sensor to obstruct the view;
<span class="ltx_text ltx_font_italic" id="S4.p2.1.2">Outdoor-Rain</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite> training set, with 9000 synthetic images impaired by both fog and rain streaks; and <span class="ltx_text ltx_font_italic" id="S4.p2.1.3">Snow100K</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib40" title="">40</a>]</cite> training set, compromise 50000 synthetic images degraded by snow. Given the number of images in each dataset is not equal, for the Snow100k dataset, only 9000 images are randomly selected for training. Note that for each dataset, we divided it into labeled and unlabeled sets at a ratio of 1:1.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">Test Dataset.  <span class="ltx_text ltx_font_italic" id="S4.p3.1.1">Raindrop</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib39" title="">39</a>]</cite> test set, containing 58 images, was acquired in the same manner as the training set;
<span class="ltx_text ltx_font_italic" id="S4.p3.1.2">Outdoor-Rain</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite> test set, including 750 synthetic images;
<span class="ltx_text ltx_font_italic" id="S4.p3.1.3">Snow100K-2000</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib40" title="">40</a>]</cite> test set, selecting 2000 synthetic images from <span class="ltx_text ltx_font_italic" id="S4.p3.1.4">Snow100K</span>’s test set like <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib42" title="">42</a>]</cite>. <span class="ltx_text ltx_font_italic" id="S4.p3.1.5">Snow100K-Real</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib40" title="">40</a>]</cite> dataset, comprising 1329 authentic snow-degraded test images; and <span class="ltx_text ltx_font_italic" id="S4.p3.1.6">IVIPC-DQA</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib43" title="">43</a>]</cite> dataset, involving 206 real-scene images under rain conditions.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.2">(2) <span class="ltx_text ltx_font_italic" id="S4.p4.2.1">Implementation Details</span>: Our method is implemented on the Pytorch platform and conducted on NVIDIA RTX 3090 GPUs. AdamP <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib44" title="">44</a>]</cite> is adopted as our optimizer. The model training consists of two phases, wherein the first phase lasts 500 epochs for a batch size of 196, and the second one extends to 650 epochs for a batch size of 64. Specifically, in the first phase, we train the model only by using labeled data and then use the trained model to initialize the pseudo-label dynamic warehouse to get the initial “optimal” pseudo-labels for unlabeled data. In the second phase, we restart the training by incorporating unlabeled data and its corresponding “optimal” pseudo-labels. In both phases, the initial learning rate is set to <math alttext="1.6\mathrm{e}^{-4}" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mn id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">1.6</mn><mo id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">⁢</mo><msup id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml"><mi id="S4.p4.1.m1.1.1.3.2" mathvariant="normal" xref="S4.p4.1.m1.1.1.3.2.cmml">e</mi><mrow id="S4.p4.1.m1.1.1.3.3" xref="S4.p4.1.m1.1.1.3.3.cmml"><mo id="S4.p4.1.m1.1.1.3.3a" xref="S4.p4.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.p4.1.m1.1.1.3.3.2" xref="S4.p4.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><times id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1"></times><cn id="S4.p4.1.m1.1.1.2.cmml" type="float" xref="S4.p4.1.m1.1.1.2">1.6</cn><apply id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.3.1.cmml" xref="S4.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.p4.1.m1.1.1.3.2.cmml" xref="S4.p4.1.m1.1.1.3.2">e</ci><apply id="S4.p4.1.m1.1.1.3.3.cmml" xref="S4.p4.1.m1.1.1.3.3"><minus id="S4.p4.1.m1.1.1.3.3.1.cmml" xref="S4.p4.1.m1.1.1.3.3"></minus><cn id="S4.p4.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.p4.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">1.6\mathrm{e}^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">1.6 roman_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="1.25\mathrm{e}^{-4}" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mrow id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mn id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">1.25</mn><mo id="S4.p4.2.m2.1.1.1" xref="S4.p4.2.m2.1.1.1.cmml">⁢</mo><msup id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml"><mi id="S4.p4.2.m2.1.1.3.2" mathvariant="normal" xref="S4.p4.2.m2.1.1.3.2.cmml">e</mi><mrow id="S4.p4.2.m2.1.1.3.3" xref="S4.p4.2.m2.1.1.3.3.cmml"><mo id="S4.p4.2.m2.1.1.3.3a" xref="S4.p4.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.p4.2.m2.1.1.3.3.2" xref="S4.p4.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><times id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1"></times><cn id="S4.p4.2.m2.1.1.2.cmml" type="float" xref="S4.p4.2.m2.1.1.2">1.25</cn><apply id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.3.1.cmml" xref="S4.p4.2.m2.1.1.3">superscript</csymbol><ci id="S4.p4.2.m2.1.1.3.2.cmml" xref="S4.p4.2.m2.1.1.3.2">e</ci><apply id="S4.p4.2.m2.1.1.3.3.cmml" xref="S4.p4.2.m2.1.1.3.3"><minus id="S4.p4.2.m2.1.1.3.3.1.cmml" xref="S4.p4.2.m2.1.1.3.3"></minus><cn id="S4.p4.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.p4.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">1.25\mathrm{e}^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">1.25 roman_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for the generator and the discriminator, respectively.
Considering that our model is trained on a composite dataset, which contains various weather-conditioned datasets, to ensure our method is robust enough to restore various types of weather-degraded images in the all-in-one model, we introduce the Memory Replay Training strategy <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib45" title="">45</a>]</cite> for model training. To be specific, in the initial 150 training epochs, our method is exclusively trained using the <span class="ltx_text ltx_font_italic" id="S4.p4.2.2">Raindrop</span> dataset. Upon completion of this phase, we extend the dataset collection to include the <span class="ltx_text ltx_font_italic" id="S4.p4.2.3">Outdoor-Rain</span> dataset and continue training for an additional 150 epochs. Finally, we enrich the training dataset by adding the <span class="ltx_text ltx_font_italic" id="S4.p4.2.4">Snow100K</span> dataset, which, along with the previously used datasets, is employed in the subsequent training. This strategy can make the model learn all types of weather restoration and give peak performance for each task <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib45" title="">45</a>]</cite>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Comparison with SOTA Competitors</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We perform comparisons of our SemiDDM-Weather with several other fully-supervised SOTA methods, including weather-specific methods and all-in-one methods on the involved test datasets.
For weather-specific removal methods, we choose RaindropAttn <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib21" title="">21</a>]</cite>, IDT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib46" title="">46</a>]</cite>, and UDR-S2Former <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib23" title="">23</a>]</cite> for raindrop removal, HRGAN <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite>, PCNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib47" title="">47</a>]</cite>, and MPRNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib48" title="">48</a>]</cite> for deraining, and FocalNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib41" title="">41</a>]</cite>, SFNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib42" title="">42</a>]</cite>, and FSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib49" title="">49</a>]</cite> for desnowing,
For all-in-one methods, we select TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>, WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>, and WeatherDiff<sub class="ltx_sub" id="S4.SS1.p1.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>.
The following detailed subjective and objective evaluation results demonstrate that despite using limited labeled data compared to these SOTA fully-supervised methods, our approach still achieves better adverse weather restoration results, even superior to the GT.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">(1) <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.1">Subjective Evaluation</span>: Figs. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.F6" title="Figure 6 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.F7" title="Figure 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.F8" title="Figure 8 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">8</span></a> illustrate instances of test datasets, including <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.2">Raindrop</span>, <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.3">Outdoor-rain</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.4">Snow100K-2000</span>. It shows that our method not only effectively removes the degradations caused by adverse weather conditions such as raindrops, rain streaks, and snow through a unified (a.k.a., all-in-one) framework, but also enhances the image clarity, such as clearer vehicle markings, text, and lane lines, especially surpassing that of the GT, affirming our superior restoration quality. This improvement provides better image restoration for various downstream tasks. Furthermore, compared to other specific as well as unified frameworks, our approach trained with limited labeled data demonstrates greater practical value.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">(2) <span class="ltx_text ltx_font_italic" id="S4.SS1.p3.1.1">Objective Evaluation</span>: Considering that only using subjective evaluation is not comprehensive, we also introduce objective evaluation to evaluate the performance of our method. Objective image quality assessment (IQA) methods can be categorized as full-reference, reduced-reference, and no-reference. Since it is difficult to obtain realistic GT images under adverse weather conditions, and our primary aim is to recover perceptually clearer images, GT images are no longer suitable as a reference. Consequently, the corresponding FR-IQA metrics, such as PSNR and SSIM, are not applicable. Instead, we adopt NR-IQA metrics for image quality evaluation. In this paper, five top-performance metrics are employed for objective evaluation, including PAQ2PIQ <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib50" title="">50</a>]</cite>, DBCNN <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib51" title="">51</a>]</cite>, CLIPIQA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib52" title="">52</a>]</cite>, MUSIQ-SPAQ <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib37" title="">37</a>]</cite>, and NIQE <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib53" title="">53</a>]</cite>. In Tables <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T1" title="Table 1 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T2" title="Table 2 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">2</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T3" title="Table 3 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">3</span></a>, we compare our approach to other fully-supervised approaches, including weather-specific and all-in-one approaches, for these five NR-IQA metrics. It is clear that our method, which employs a semi-supervised learning framework trained with limited labeled data, significantly outperforms other methods overall, even over GT, affirming that the restoration results from our method are visually high-quality.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf1.g1" src="x6.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text" id="S4.F6.sf1.2.1" style="font-size:70%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf2.g1" src="x7.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text" id="S4.F6.sf2.2.1" style="font-size:70%;">RaindropAttn <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib21" title="">21</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf3.g1" src="x8.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text" id="S4.F6.sf3.2.1" style="font-size:70%;">IDT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib46" title="">46</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf4.g1" src="x9.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span><span class="ltx_text" id="S4.F6.sf4.2.1" style="font-size:70%;">UDR-S2Former <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib23" title="">23</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf5.g1" src="x10.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span><span class="ltx_text" id="S4.F6.sf5.2.1" style="font-size:70%;">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F6.sf6.g1" src="x11.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span><span class="ltx_text" id="S4.F6.sf6.2.1" style="font-size:70%;">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="178" id="S4.F6.sf7.g1" src="x12.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span><span class="ltx_text" id="S4.F6.sf7.2.1" style="font-size:70%;">WeatherDiff<sub class="ltx_sub" id="S4.F6.sf7.2.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="178" id="S4.F6.sf8.g1" src="x13.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span><span class="ltx_text" id="S4.F6.sf8.2.1" style="font-size:70%;">GT</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf9"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="178" id="S4.F6.sf9.g1" src="x14.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(i) </span><span class="ltx_text" id="S4.F6.sf9.2.1" style="font-size:70%;">Ours</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Restoration instances on  <span class="ltx_text ltx_font_italic" id="S4.F6.2.1">Raindrop</span> test set by our method and other SOTA fully-supervised competitors. The red box highlights the zoomed-in patch</figcaption>
</figure>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Objective evaluation comparison on <span class="ltx_text ltx_font_italic" id="S4.T1.10.1">RainDrop</span> test set in terms of five no-reference IQA (NR-IQA) metrics. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T1.11.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.12.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.5.5">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.6">Method</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" stretchy="false" xref="S4.T1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mo id="S4.T1.2.2.2.m1.1.1" stretchy="false" xref="S4.T1.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><ci id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.m1.1a"><mo id="S4.T1.3.3.3.m1.1.1" stretchy="false" xref="S4.T1.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.m1.1b"><ci id="S4.T1.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.4.4.m1.1"><semantics id="S4.T1.4.4.4.m1.1a"><mo id="S4.T1.4.4.4.m1.1.1" stretchy="false" xref="S4.T1.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.m1.1b"><ci id="S4.T1.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T1.5.5.5.m1.1"><semantics id="S4.T1.5.5.5.m1.1a"><mo id="S4.T1.5.5.5.m1.1.1" stretchy="false" xref="S4.T1.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.m1.1b"><ci id="S4.T1.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.7.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.1">RaindropAttn <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib21" title="">21</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.2">72.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.3">67.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.4">0.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.5">72.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.7.1.6">20.71</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.8.2">
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.1">IDT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib46" title="">46</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.8.2.2.1">73.38</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.3">68.55</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.4">0.42</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.8.2.5.1">73.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.8.2.6.1">20.26</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.9.3">
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.1">UDR-S2Former <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib23" title="">23</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.2">73.27</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.3">68.06</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.4">0.42</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.5">73.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.9.3.6">20.38</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.10.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.1">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.2">71.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.3">60.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.4">0.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.5">71.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.10.4.6">20.53</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.11.5">
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.2">73.19</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.3">68.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.4">0.43</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.5">73.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5.6">20.48</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.1">
<math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.T1.6.6.1.m1.1"><semantics id="S4.T1.6.6.1.m1.1a"><msub id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml"><mtext id="S4.T1.6.6.1.m1.1.1.2" xref="S4.T1.6.6.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.T1.6.6.1.m1.1.1.3" xref="S4.T1.6.6.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T1.6.6.1.m1.1.1.2a.cmml" xref="S4.T1.6.6.1.m1.1.1.2"><mtext id="S4.T1.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.T1.6.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.6.6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.2">73.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.6.3.1">69.59</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.4">0.46</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.5">73.72</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6">20.27</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.12.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.1">GT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.2">72.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.3">68.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.4.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.5">73.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.6.6">20.27</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.13.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.13.7.2.1">74.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.13.7.3.1">72.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.13.7.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.13.7.5.1">74.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.13.7.6"><span class="ltx_text ltx_font_bold" id="S4.T1.6.13.7.6.1">19.21</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf1.g1" src="x15.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text" id="S4.F7.sf1.2.1" style="font-size:70%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf2.g1" src="x16.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text" id="S4.F7.sf2.2.1" style="font-size:70%;">HRGAN <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="178" id="S4.F7.sf3.g1" src="x17.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text" id="S4.F7.sf3.2.1" style="font-size:70%;">PCNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib47" title="">47</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf4.g1" src="x18.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span><span class="ltx_text" id="S4.F7.sf4.2.1" style="font-size:70%;">MPRNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib48" title="">48</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf5.g1" src="x19.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span><span class="ltx_text" id="S4.F7.sf5.2.1" style="font-size:70%;">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf6.g1" src="x20.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span><span class="ltx_text" id="S4.F7.sf6.2.1" style="font-size:70%;">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf7.g1" src="x21.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span><span class="ltx_text" id="S4.F7.sf7.2.1" style="font-size:70%;">WeatherDiff<sub class="ltx_sub" id="S4.F7.sf7.2.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf8.g1" src="x22.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span><span class="ltx_text" id="S4.F7.sf8.2.1" style="font-size:70%;">GT</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf9"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="S4.F7.sf9.g1" src="x23.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(i) </span><span class="ltx_text" id="S4.F7.sf9.2.1" style="font-size:70%;">Ours</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Restoration instances on  <span class="ltx_text ltx_font_italic" id="S4.F7.2.1">Outdoor-Rain</span> test set by our method and other SOTA fully-supervised competitors. The red box highlights the zoomed-in patch</figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Objective Evaluation comparison on <span class="ltx_text ltx_font_italic" id="S4.T2.10.1">Outdoor-rain</span> test set in terms of five no-reference IQA (NR-IQA) metrics. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T2.11.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.12.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.5.6">Method</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><ci id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><mo id="S4.T2.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.7.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.1">HRGAN <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib10" title="">10</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.2">72.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.3">63.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.4">0.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.5">73.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.7.1.6">20.10</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.8.2">
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.1">PCNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.2">73.97</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.3">61.54</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.4">0.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.5">71.62</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.8.2.6">20.20</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.9.3">
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.1">MPRNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib48" title="">48</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.2">74.49</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.3">66.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.4">0.42</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.5">73.91</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.6">19.86</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.10.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.1">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.2">73.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.3">62.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.4">0.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.5">72.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.6">19.54</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.11.5">
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.2">74.89</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.3">69.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.4">0.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.5">74.55</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.6">19.74</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.1">
<math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.T2.6.6.1.m1.1"><semantics id="S4.T2.6.6.1.m1.1a"><msub id="S4.T2.6.6.1.m1.1.1" xref="S4.T2.6.6.1.m1.1.1.cmml"><mtext id="S4.T2.6.6.1.m1.1.1.2" xref="S4.T2.6.6.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.T2.6.6.1.m1.1.1.3" xref="S4.T2.6.6.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.1.m1.1b"><apply id="S4.T2.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.6.6.1.m1.1.1.1.cmml" xref="S4.T2.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T2.6.6.1.m1.1.1.2a.cmml" xref="S4.T2.6.6.1.m1.1.1.2"><mtext id="S4.T2.6.6.1.m1.1.1.2.cmml" xref="S4.T2.6.6.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.T2.6.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T2.6.6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.6.2.1">75.09</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.3">73.39</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.4">0.52</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.6.5.1">76.02</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.6">19.37</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.12.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.1">GT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.2">74.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.12.6.3.1">74.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.4"><span class="ltx_text ltx_font_bold" id="S4.T2.6.12.6.4.1">0.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.5">75.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.12.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.12.6.6.1">19.30</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.13.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.13.7.2.1">76.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.3"><span class="ltx_text ltx_font_bold" id="S4.T2.6.13.7.3.1">76.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.13.7.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.5"><span class="ltx_text ltx_font_bold" id="S4.T2.6.13.7.5.1">76.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.6.13.7.6"><span class="ltx_text ltx_font_bold" id="S4.T2.6.13.7.6.1">18.33</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="201" id="S4.F8.sf1.g1" src="x24.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text" id="S4.F8.sf1.2.1" style="font-size:70%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="201" id="S4.F8.sf2.g1" src="x25.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text" id="S4.F8.sf2.2.1" style="font-size:70%;">FocalNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib41" title="">41</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="201" id="S4.F8.sf3.g1" src="x26.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text" id="S4.F8.sf3.2.1" style="font-size:70%;">SFNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib42" title="">42</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="201" id="S4.F8.sf4.g1" src="x27.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span><span class="ltx_text" id="S4.F8.sf4.2.1" style="font-size:70%;">FSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib49" title="">49</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S4.F8.sf5.g1" src="x28.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span><span class="ltx_text" id="S4.F8.sf5.2.1" style="font-size:70%;">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="S4.F8.sf6.g1" src="x29.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span><span class="ltx_text" id="S4.F8.sf6.2.1" style="font-size:70%;">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S4.F8.sf7.g1" src="x30.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span><span class="ltx_text" id="S4.F8.sf7.2.1" style="font-size:70%;">WeatherDiff<sub class="ltx_sub" id="S4.F8.sf7.2.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S4.F8.sf8.g1" src="x31.png" width="266"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span><span class="ltx_text" id="S4.F8.sf8.2.1" style="font-size:70%;">GT</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf9"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S4.F8.sf9.g1" src="x32.png" width="265"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(i) </span><span class="ltx_text" id="S4.F8.sf9.2.1" style="font-size:70%;">Ours</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Restoration instances on  <span class="ltx_text ltx_font_italic" id="S4.F8.2.1">Snow100K-2000</span> test set by our method and other SOTA fully-supervised competitors. The red box highlights the zoomed-in patch</figcaption>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Objective evaluation comparison on <span class="ltx_text ltx_font_italic" id="S4.T3.10.1">Snow100K-2000</span> test set in terms of five no-reference IQA (NR-IQA) metrics. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T3.11.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.12.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.5.5">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.5.5.6">Method</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.4.4.m1.1"><semantics id="S4.T3.4.4.4.m1.1a"><mo id="S4.T3.4.4.4.m1.1.1" stretchy="false" xref="S4.T3.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.m1.1b"><ci id="S4.T3.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.5.5.m1.1"><semantics id="S4.T3.5.5.5.m1.1a"><mo id="S4.T3.5.5.5.m1.1.1" stretchy="false" xref="S4.T3.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.m1.1b"><ci id="S4.T3.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.7.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.1">FocalNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib41" title="">41</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.2">72.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.3">55.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.7.1.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.5">68.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.7.1.6">20.61</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.8.2">
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.1">SFNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib42" title="">42</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.2">72.39</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.8.2.3.1">56.02</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.8.2.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.5">68.62</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.8.2.6">20.60</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.9.3">
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.1">FSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib49" title="">49</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.2">72.33</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.3">55.72</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.9.3.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.5">68.61</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.9.3.6">20.58</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.10.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.1">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.2">70.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.3">51.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.4">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.5">66.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.10.4.6">20.73</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.11.5">
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.2">71.61</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.3">52.07</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.4">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.5">67.12</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.11.5.6">20.71</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6">
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.1">
<math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.T3.6.6.1.m1.1"><semantics id="S4.T3.6.6.1.m1.1a"><msub id="S4.T3.6.6.1.m1.1.1" xref="S4.T3.6.6.1.m1.1.1.cmml"><mtext id="S4.T3.6.6.1.m1.1.1.2" xref="S4.T3.6.6.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.T3.6.6.1.m1.1.1.3" xref="S4.T3.6.6.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.1.m1.1b"><apply id="S4.T3.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.6.6.1.m1.1.1.1.cmml" xref="S4.T3.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T3.6.6.1.m1.1.1.2a.cmml" xref="S4.T3.6.6.1.m1.1.1.2"><mtext id="S4.T3.6.6.1.m1.1.1.2.cmml" xref="S4.T3.6.6.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.T3.6.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T3.6.6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.2">72.54</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.3">55.61</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.6.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.5">68.64</td>
<td class="ltx_td ltx_align_center" id="S4.T3.6.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.6.6.1">20.44</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.12.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.1">GT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.12.6.2.1">72.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.3"><span class="ltx_text ltx_font_bold" id="S4.T3.6.12.6.3.1">56.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.4"><span class="ltx_text ltx_font_bold" id="S4.T3.6.12.6.4.1">0.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.12.6.5.1">69.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.12.6.6">20.73</td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.13.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.2"><span class="ltx_text ltx_font_bold" id="S4.T3.6.13.7.2.1">73.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.3">55.43</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.6.13.7.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.5"><span class="ltx_text ltx_font_bold" id="S4.T3.6.13.7.5.1">69.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.6.13.7.6"><span class="ltx_text ltx_font_bold" id="S4.T3.6.13.7.6.1">19.43</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="101" id="S4.F9.sf1.g1" src="x33.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text" id="S4.F9.sf1.2.1" style="font-size:70%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="101" id="S4.F9.sf2.g1" src="x34.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text" id="S4.F9.sf2.2.1" style="font-size:70%;">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="101" id="S4.F9.sf3.g1" src="x35.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text" id="S4.F9.sf3.2.1" style="font-size:70%;">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="101" id="S4.F9.sf4.g1" src="x36.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span><span class="ltx_text" id="S4.F9.sf4.2.1" style="font-size:70%;">WeatherDiff<sub class="ltx_sub" id="S4.F9.sf4.2.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="101" id="S4.F9.sf5.g1" src="x37.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span><span class="ltx_text" id="S4.F9.sf5.2.1" style="font-size:70%;">Ours</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Restoration instances on <span class="ltx_text ltx_font_italic" id="S4.F9.2.1">IVIPC-DQA</span> test set by our method and other SOTA fully-supervised competitors. The red box highlights the zoomed-in patch</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="141" id="S4.F10.sf1.g1" src="x38.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text" id="S4.F10.sf1.2.1" style="font-size:70%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="141" id="S4.F10.sf2.g1" src="x39.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text" id="S4.F10.sf2.2.1" style="font-size:70%;">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="142" id="S4.F10.sf3.g1" src="x40.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text" id="S4.F10.sf3.2.1" style="font-size:70%;">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F10.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="141" id="S4.F10.sf4.g1" src="x41.png" width="149"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span><span class="ltx_text" id="S4.F10.sf4.2.1" style="font-size:70%;">WeatherDiff<sub class="ltx_sub" id="S4.F10.sf4.2.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F10.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="141" id="S4.F10.sf5.g1" src="x42.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span><span class="ltx_text" id="S4.F10.sf5.2.1" style="font-size:70%;">Ours</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Restoration instances on <span class="ltx_text ltx_font_italic" id="S4.F10.2.1">Snow100K-Real</span> test set by our method and other SOTA fully-supervised competitors. The red box highlights the zoomed-in patch</figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Objective evaluation comparison on <span class="ltx_text ltx_font_italic" id="S4.T4.10.1">IVIPC-DQA</span> test set in terms of five no-reference IQA (NR-IQA) metrics. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T4.11.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.12.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.5.5.6">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.m1.1.1" stretchy="false" xref="S4.T4.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.m1.1a"><mo id="S4.T4.2.2.2.m1.1.1" stretchy="false" xref="S4.T4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.m1.1b"><ci id="S4.T4.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.3.3.3.m1.1"><semantics id="S4.T4.3.3.3.m1.1a"><mo id="S4.T4.3.3.3.m1.1.1" stretchy="false" xref="S4.T4.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.m1.1b"><ci id="S4.T4.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.4.4.4.m1.1"><semantics id="S4.T4.4.4.4.m1.1a"><mo id="S4.T4.4.4.4.m1.1.1" stretchy="false" xref="S4.T4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.m1.1b"><ci id="S4.T4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.5.5.5.m1.1"><semantics id="S4.T4.5.5.5.m1.1a"><mo id="S4.T4.5.5.5.m1.1.1" stretchy="false" xref="S4.T4.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.m1.1b"><ci id="S4.T4.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T4.6.7.1.1">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.7.1.2">71.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.7.1.3">49.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.7.1.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.7.1.4.1">0.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.7.1.5">59.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.7.1.6">20.54</td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.6.8.2.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.6.8.2.2">71.51</td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.8.2.3">46.36</td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.8.2.4">0.48</td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.8.2.5">57.77</td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.8.2.6">20.40</td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.6.6.1">
<math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.T4.6.6.1.m1.1"><semantics id="S4.T4.6.6.1.m1.1a"><msub id="S4.T4.6.6.1.m1.1.1" xref="S4.T4.6.6.1.m1.1.1.cmml"><mtext id="S4.T4.6.6.1.m1.1.1.2" xref="S4.T4.6.6.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.T4.6.6.1.m1.1.1.3" xref="S4.T4.6.6.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.1.m1.1b"><apply id="S4.T4.6.6.1.m1.1.1.cmml" xref="S4.T4.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.6.6.1.m1.1.1.1.cmml" xref="S4.T4.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T4.6.6.1.m1.1.1.2a.cmml" xref="S4.T4.6.6.1.m1.1.1.2"><mtext id="S4.T4.6.6.1.m1.1.1.2.cmml" xref="S4.T4.6.6.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.T4.6.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T4.6.6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.6.2.1">72.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.6.3.1">52.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.6.4"><span class="ltx_text ltx_font_bold" id="S4.T4.6.6.4.1">0.52</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.6.5.1">59.85</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.6.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.6.6.1">20.21</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T4.6.9.3.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.6.9.3.2"><span class="ltx_text ltx_font_bold" id="S4.T4.6.9.3.2.1">73.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.6.9.3.3"><span class="ltx_text ltx_font_bold" id="S4.T4.6.9.3.3.1">56.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.6.9.3.4">0.49</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.6.9.3.5"><span class="ltx_text ltx_font_bold" id="S4.T4.6.9.3.5.1">60.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.6.9.3.6"><span class="ltx_text ltx_font_bold" id="S4.T4.6.9.3.6.1">19.14</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Objective evaluation comparison on <span class="ltx_text ltx_font_italic" id="S4.T5.10.1">Snow100K-Real</span> test set in terms of five no-reference IQA (NR-IQA) metrics. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T5.11.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.12.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.5.5.6">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.1.1.1.m1.1"><semantics id="S4.T5.1.1.1.m1.1a"><mo id="S4.T5.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.2.2.2.m1.1"><semantics id="S4.T5.2.2.2.m1.1a"><mo id="S4.T5.2.2.2.m1.1.1" stretchy="false" xref="S4.T5.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.m1.1b"><ci id="S4.T5.2.2.2.m1.1.1.cmml" xref="S4.T5.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.3.3.3.m1.1"><semantics id="S4.T5.3.3.3.m1.1a"><mo id="S4.T5.3.3.3.m1.1.1" stretchy="false" xref="S4.T5.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.m1.1b"><ci id="S4.T5.3.3.3.m1.1.1.cmml" xref="S4.T5.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.4.4.4.m1.1"><semantics id="S4.T5.4.4.4.m1.1a"><mo id="S4.T5.4.4.4.m1.1.1" stretchy="false" xref="S4.T5.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.m1.1b"><ci id="S4.T5.4.4.4.m1.1.1.cmml" xref="S4.T5.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.5.5.5.m1.1"><semantics id="S4.T5.5.5.5.m1.1a"><mo id="S4.T5.5.5.5.m1.1.1" stretchy="false" xref="S4.T5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.5.m1.1b"><ci id="S4.T5.5.5.5.m1.1.1.cmml" xref="S4.T5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.5.5.5.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T5.6.7.1.1">TransWeather <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib25" title="">25</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.7.1.2">69.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.7.1.3">50.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.7.1.4">0.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.7.1.5">63.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.7.1.6">20.48</td>
</tr>
<tr class="ltx_tr" id="S4.T5.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T5.6.8.2.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T5.6.8.2.2">69.80</td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.8.2.3">49.92</td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.8.2.4">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.8.2.5">62.85</td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.8.2.6">20.57</td>
</tr>
<tr class="ltx_tr" id="S4.T5.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T5.6.6.1">
<math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.T5.6.6.1.m1.1"><semantics id="S4.T5.6.6.1.m1.1a"><msub id="S4.T5.6.6.1.m1.1.1" xref="S4.T5.6.6.1.m1.1.1.cmml"><mtext id="S4.T5.6.6.1.m1.1.1.2" xref="S4.T5.6.6.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.T5.6.6.1.m1.1.1.3" xref="S4.T5.6.6.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T5.6.6.1.m1.1b"><apply id="S4.T5.6.6.1.m1.1.1.cmml" xref="S4.T5.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.6.6.1.m1.1.1.1.cmml" xref="S4.T5.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T5.6.6.1.m1.1.1.2a.cmml" xref="S4.T5.6.6.1.m1.1.1.2"><mtext id="S4.T5.6.6.1.m1.1.1.2.cmml" xref="S4.T5.6.6.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.T5.6.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T5.6.6.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.6.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.T5.6.6.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.6.6.2.1">70.49</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.6.6.3.1">52.88</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.6.6.4.1">0.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.6.6.5.1">64.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.6.6.6.1">20.46</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T5.6.9.3.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.6.9.3.2"><span class="ltx_text ltx_font_bold" id="S4.T5.6.9.3.2.1">71.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.6.9.3.3"><span class="ltx_text ltx_font_bold" id="S4.T5.6.9.3.3.1">53.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.6.9.3.4"><span class="ltx_text ltx_font_bold" id="S4.T5.6.9.3.4.1">0.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.6.9.3.5"><span class="ltx_text ltx_font_bold" id="S4.T5.6.9.3.5.1">65.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.6.9.3.6"><span class="ltx_text ltx_font_bold" id="S4.T5.6.9.3.6.1">19.49</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Performance comparison of lane detection using CLRNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib54" title="">54</a>]</cite> and ADNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib55" title="">55</a>]</cite> on <span class="ltx_text ltx_font_italic" id="S4.T6.8.1">CULane</span> test set: our method versus TKL and WGWS-Net restoration methods. The best results are highlighted in bold.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T6.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.6.7.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.6.7.1.1" rowspan="2"><span class="ltx_text" id="S4.T6.6.7.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T6.6.7.1.2">CLRNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib54" title="">54</a>]</cite>
</td>
<td class="ltx_td ltx_border_tt" id="S4.T6.6.7.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T6.6.7.1.4">ADNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib55" title="">55</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.1">Precision<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.1.1.1.m1.1"><semantics id="S4.T6.1.1.1.m1.1a"><mo id="S4.T6.1.1.1.m1.1.1" stretchy="false" xref="S4.T6.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.2.2">Recall<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.2.2.2.m1.1"><semantics id="S4.T6.2.2.2.m1.1a"><mo id="S4.T6.2.2.2.m1.1.1" stretchy="false" xref="S4.T6.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.2.m1.1b"><ci id="S4.T6.2.2.2.m1.1.1.cmml" xref="S4.T6.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.3.3">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.3.3.3.m1.1"><semantics id="S4.T6.3.3.3.m1.1a"><mo id="S4.T6.3.3.3.m1.1.1" stretchy="false" xref="S4.T6.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.3.m1.1b"><ci id="S4.T6.3.3.3.m1.1.1.cmml" xref="S4.T6.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td" id="S4.T6.6.6.7"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.4.4.4">Precision<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.4.4.4.m1.1"><semantics id="S4.T6.4.4.4.m1.1a"><mo id="S4.T6.4.4.4.m1.1.1" stretchy="false" xref="S4.T6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.4.m1.1b"><ci id="S4.T6.4.4.4.m1.1.1.cmml" xref="S4.T6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.5.5.5">Recall<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.5.5.5.m1.1"><semantics id="S4.T6.5.5.5.m1.1a"><mo id="S4.T6.5.5.5.m1.1.1" stretchy="false" xref="S4.T6.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.5.5.5.m1.1b"><ci id="S4.T6.5.5.5.m1.1.1.cmml" xref="S4.T6.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.6.6">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.6.6.6.m1.1"><semantics id="S4.T6.6.6.6.m1.1a"><mo id="S4.T6.6.6.6.m1.1.1" stretchy="false" xref="S4.T6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.6.6.6.m1.1b"><ci id="S4.T6.6.6.6.m1.1.1.cmml" xref="S4.T6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.8.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.1">GT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.2">0.5472</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.3">0.4657</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.4">0.5032</td>
<td class="ltx_td ltx_border_t" id="S4.T6.6.8.2.5"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.6">0.5220</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.7">0.4495</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.8.2.8">0.4831</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.9.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.1">Degraded Image</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.2">0.5468</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.3">0.2807</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.4">0.3710</td>
<td class="ltx_td ltx_border_t" id="S4.T6.6.9.3.5"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.6">0.4936</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.7">0.2394</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.9.3.8">0.3224</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.10.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.1">TKL <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib7" title="">7</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.2">0.4131</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.3">0.3153</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.4">0.3576</td>
<td class="ltx_td ltx_border_t" id="S4.T6.6.10.4.5"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.6">0.4646</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.7">0.2459</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.10.4.8">0.3216</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.11.5">
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.1">WGWS-Net <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.2">0.4226</td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.3">0.3340</td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.4">0.3731</td>
<td class="ltx_td" id="S4.T6.6.11.5.5"></td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.6">0.3983</td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.7">0.3244</td>
<td class="ltx_td ltx_align_center" id="S4.T6.6.11.5.8">0.3576</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.12.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.2"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.2.1">0.5460</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.3"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.3.1">0.4337</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.4"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.4.1">0.4833</span></td>
<td class="ltx_td ltx_border_bb" id="S4.T6.6.12.6.5"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.6"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.6.1">0.5274</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.7"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.7.1">0.4287</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.6.12.6.8"><span class="ltx_text ltx_font_bold" id="S4.T6.6.12.6.8.1">0.4730</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Abalation study of SemiDDM-Weather on <span class="ltx_text ltx_font_italic" id="S4.T7.9.1">Outdoor-Rain</span> test set. The best results are in <span class="ltx_text ltx_font_bold" id="S4.T7.10.2">bold</span> and the second bests are with <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T7.11.3">underline</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T7.5.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T7.5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.5.5.5.6">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.1.1.1.1">PAQ2PIQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.1.1.1.1.m1.1"><semantics id="S4.T7.1.1.1.1.m1.1a"><mo id="S4.T7.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T7.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.1.1.1.1.m1.1b"><ci id="S4.T7.1.1.1.1.m1.1.1.cmml" xref="S4.T7.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.2.2.2.2">DBCNN<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.2.2.2.2.m1.1"><semantics id="S4.T7.2.2.2.2.m1.1a"><mo id="S4.T7.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T7.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.2.2.2.2.m1.1b"><ci id="S4.T7.2.2.2.2.m1.1.1.cmml" xref="S4.T7.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.3.3.3">CLIPIQA<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.3.3.3.3.m1.1"><semantics id="S4.T7.3.3.3.3.m1.1a"><mo id="S4.T7.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T7.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.3.3.3.3.m1.1b"><ci id="S4.T7.3.3.3.3.m1.1.1.cmml" xref="S4.T7.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.4.4.4.4">MUSIQ-SPAQ<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.4.4.4.4.m1.1"><semantics id="S4.T7.4.4.4.4.m1.1a"><mo id="S4.T7.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T7.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.4.4.4.4.m1.1b"><ci id="S4.T7.4.4.4.4.m1.1.1.cmml" xref="S4.T7.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.5.5.5.5">NIQE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T7.5.5.5.5.m1.1"><semantics id="S4.T7.5.5.5.5.m1.1a"><mo id="S4.T7.5.5.5.5.m1.1.1" stretchy="false" xref="S4.T7.5.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T7.5.5.5.5.m1.1b"><ci id="S4.T7.5.5.5.5.m1.1.1.cmml" xref="S4.T7.5.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.5.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.5.5.5.5.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S4.T7.5.5.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.1">Ours (baseline)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.2"><span class="ltx_text ltx_font_bold" id="S4.T7.5.5.6.1.2.1">76.42</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.3"><span class="ltx_text ltx_font_bold" id="S4.T7.5.5.6.1.3.1">76.31</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.4"><span class="ltx_text ltx_font_bold" id="S4.T7.5.5.6.1.4.1">0.57</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T7.5.5.6.1.5.1">76.70</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.5.5.6.1.6">18.33</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.5.5.7.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.1">w/o aux</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.2">-8.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.3">-29.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.4">-0.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.5">-19.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.5.5.7.1.6">+2.64</td>
</tr>
<tr class="ltx_tr" id="S4.T7.5.5.8.2">
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.1">w/o dynamic warehouse</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.2">-0.08</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.3">-2.61</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.4">0.0</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.5"><span class="ltx_text ltx_font_bold" id="S4.T7.5.5.8.2.5.1">+0.09</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.8.2.6">-0.05</td>
</tr>
<tr class="ltx_tr" id="S4.T7.5.5.9.3">
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.1">w/o contrast</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T7.5.5.9.3.2.1">-0.06</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T7.5.5.9.3.3.1">-0.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.4">0.0</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.5">-0.21</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.9.3.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T7.5.5.9.3.6.1">-0.08</span></td>
</tr>
<tr class="ltx_tr" id="S4.T7.5.5.10.4">
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.1">w/o consistency</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.2">-0.26</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.3">-4.24</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.4">-0.05</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.5">-0.10</td>
<td class="ltx_td ltx_align_center" id="S4.T7.5.5.10.4.6"><span class="ltx_text ltx_font_bold" id="S4.T7.5.5.10.4.6.1">-0.10</span></td>
</tr>
<tr class="ltx_tr" id="S4.T7.5.5.11.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.1">w/o sequence</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.2">-3.13</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.3">-14.20</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.4">-0.07</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.5">-9.64</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.5.5.11.5.6">+3.93</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance on Real-World Dataset</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To further validate the practicality of our method, we extend our evaluation to real-world data and include the current advanced methods, e.g., TransWeather, WGWS-Net, and <math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mtext id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2a.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><mtext id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math>, for comparison. Figs. <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.F9" title="Figure 9 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">9</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.F10" title="Figure 10 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">10</span></a> illustrate the deraining instance on the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.1">IVIPC-DQA</span> test set and the desnowing instance on the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.2">Snow100K-Real</span> test set, respectively. It is observed that our method not only achieves superior degradation removal but also enhances image clarity, confirming the superiority of our method over other existing methods, such as clearer lawn and sharper tree textures. Tables <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T4" title="Table 4 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">4</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T5" title="Table 5 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">5</span></a> show the objective evaluation results on the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.3">IVIPC-DQA</span> test set and the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.4">Snow100K-Real</span> test set, respectively. Similarly, it can be observed that our method achieves the best results.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Application in the Wild</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this part, we conduct further experiments to verify the practical effect of our method in enhancing the performance of downstream vision applications, such as lane detection. Since TransWeather fails on these downstream tasks, and <math alttext="\text{WeatherDiff}_{64}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mtext id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2a.cmml">WeatherDiff</mtext><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">64</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2a.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><mtext id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">WeatherDiff</mtext></ci><cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\text{WeatherDiff}_{64}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">WeatherDiff start_POSTSUBSCRIPT 64 end_POSTSUBSCRIPT</annotation></semantics></math> is quite time-consuming, only TKL <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib7" title="">7</a>]</cite> and WGWS-Net (all-in-one methods) are included for comparison. We selected models trained on the <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1">CULane</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib56" title="">56</a>]</cite> dataset, including CLRNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib54" title="">54</a>]</cite>, and ADNet-ResNet-34 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib55" title="">55</a>]</cite>, to verify the practical effect of our method. The related experimental results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T6" title="Table 6 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">6</span></a>. These results clearly demonstrate that, in mitigating performance degradation caused by adverse weather conditions in downstream tasks, our method is not only effective but even superior to fully-supervised methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">(1) <span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.1">Auxiliary Loss of the Generator for Labeled Images Training</span>: Referring to Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T7" title="Table 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a>, it can be seen that without the auxiliary loss, the performance of our proposed model consistently degrades significantly over all the five metrics. This verifies that our auxiliary loss design contributes to the overall framework.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">(2) <span class="ltx_text ltx_font_italic" id="S4.SS4.p2.1.1">Pseudo-label Dynamic Warehouse for Unlabeled Images Training</span>: To assess the impact of the pseudo-label dynamic warehouse on our method, we compare the difference in performance with and without the pseudo-label dynamic warehouse. The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T7" title="Table 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a> show that the introduction of the pseudo-label dynamic warehouse has improved our performance in general, especially on the DBCNN metric.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">(3) <span class="ltx_text ltx_font_italic" id="S4.SS4.p3.1.1">Contrastive Loss for Unlabeled Images Training</span>: As can be seen from the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T7" title="Table 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a>, removing the contrast loss leads to a decrease in overall performance, which proves that the introduced contrast loss is effective to some extent.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">(4) <span class="ltx_text ltx_font_italic" id="S4.SS4.p4.1.1">Method for Constructing Pseudo-label Dynamic Warehouse</span>: We added a consistency constraint to assess the quality of teachers’ network predictions. As can be seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T7" title="Table 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a>, this constraint plays an important role in selecting “optimal” pseudo-labels.</p>
</div>
<div class="ltx_para" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.1">(5) <span class="ltx_text ltx_font_italic" id="S4.SS4.p5.1.1">Contribution of Memory Replay Training Strategy</span>: As can be seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T7" title="Table 7 ‣ 4.1 Comparison with SOTA Competitors ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">7</span></a>, the memory replay training strategy has demonstrated significant effectiveness for our model training.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Model Complexity Analysis</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To comprehensively assess the performance, we compare the efficiency of our method with the other DDM-based all-in-one adverse weather removal method, WeatherDiff<sub class="ltx_sub" id="S4.SS5.p1.1.1">64</sub> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#bib.bib8" title="">8</a>]</cite>. The results of model parameters (Params.) and floating-point operations (FLOPs) are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19679v1#S4.T8" title="Table 8 ‣ 4.5 Model Complexity Analysis ‣ 4 Experimental Settings ‣ SemiDDM-Weather: A Semi-supervised Learning Framework for All-in-one Adverse Weather Removal"><span class="ltx_text ltx_ref_tag">8</span></a>.
It is evident that our method, which uses only half as much labeled data as WeatherDiff<sub class="ltx_sub" id="S4.SS5.p1.1.2">64</sub> yet achieves superior restoration performance, is also more efficient and consumes fewer computational resources.</p>
</div>
<figure class="ltx_table" id="S4.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Model specifications of WeatherDiff<sub class="ltx_sub" id="S4.T8.4.1">64</sub> and our method including parameters (M) and FLOPs (GB) on a single GPU for one sample</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T8.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T8.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T8.2.2.3">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T8.1.1.1">Params.<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T8.1.1.1.m1.1"><semantics id="S4.T8.1.1.1.m1.1a"><mo id="S4.T8.1.1.1.m1.1.1" stretchy="false" xref="S4.T8.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T8.1.1.1.m1.1b"><ci id="S4.T8.1.1.1.m1.1.1.cmml" xref="S4.T8.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T8.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T8.2.2.2">FLOPs<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T8.2.2.2.m1.1"><semantics id="S4.T8.2.2.2.m1.1a"><mo id="S4.T8.2.2.2.m1.1.1" stretchy="false" xref="S4.T8.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T8.2.2.2.m1.1b"><ci id="S4.T8.2.2.2.m1.1.1.cmml" xref="S4.T8.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T8.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T8.2.2.2.m1.1d">↓</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T8.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T8.2.3.1.1">WeatherDiff<sub class="ltx_sub" id="S4.T8.2.3.1.1.1">64</sub> (supervised)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.2.3.1.2">82.962</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.2.3.1.3">30.026</td>
</tr>
<tr class="ltx_tr" id="S4.T8.2.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T8.2.4.2.1">Ours (semi-supervised)</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T8.2.4.2.2"><span class="ltx_text ltx_font_bold" id="S4.T8.2.4.2.2.1">55.654</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T8.2.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T8.2.4.2.3.1">7.179</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To restore visual high-quality images from adverse weather conditions with limited labeled data, this paper has presented a pioneering semi-supervised learning framework by incorporating a Denoising Diffusion Model into the teacher-student network, termed SemiDDM-Weather.
By customizing the wavelet diffusion model WaveDiff as the backbone, our SemiDDM-Weather can effectively capture complex many-to-one mapping distributions, thereby achieving perceptually clearer image restoration, even surpassing the ground truth (GT).
Furthermore, to enhance the accuracy of pseudo-labels used for training the student network with unlabeled data, we construct a pseudo-label dynamic warehouse to store the “optimal” outputs from the teacher network, determined by the combination of quality assessment and content consistency constraint.
Ablation studies validate the effectiveness of our design. Exhaustive experimental results show that our approach achieves consistently visual high-quality and superior adverse weather removal compared to fully-supervised competitors on both synthetic and real-world datasets. Applications on downstream vision tasks further confirm its practicability.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. Shi, S. Zhao, J. Wu, Z. Wu, H. Yan, Fixated object detection based on saliency prior in traffic scenes, IEEE Transactions on Circuits and Systems for Video Technology 34 (3) (2024) 1413–1426.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J. Xu, Z. Xiong, S. P. Bhattacharyya, Pidnet: A real-time semantic segmentation network inspired by pid controllers, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 19529–19539.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M. A. Uy, R. Martin-Brualla, L. Guibas, K. Li, Scade: Nerfs from space carving with ambiguity-aware depth estimates, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 16518–16527.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
L. Cai, Y. Fu, T. Zhu, Y. Xiang, Y. Zhang, H. Zeng, Joint depth and density guided single image de-raining, IEEE Transactions on Circuits and Systems for Video Technology 32 (7) (2021) 4108–4121.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
K. Zhang, W. Luo, Y. Yu, W. Ren, F. Zhao, C. Li, L. Ma, W. Liu, H. Li, Beyond monocular deraining: Parallel stereo deraining network via semantic prior, International Journal of Computer Vision 130 (7) (2022) 1754–1769.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Zhao, W. Cai, C. Hu, Z. Yuan, Cycle contrastive adversarial learning with structural consistency for unsupervised high-quality image deraining transformer, Neural Networks 178 (2024) 106428.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
W.-T. Chen, Z.-K. Huang, C.-C. Tsai, H.-H. Yang, J.-J. Ding, S.-Y. Kuo, Learning multiple adverse weather removal via two-stage knowledge learning and multi-contrastive regularization: Toward a unified model, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 17653–17662.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
O. Özdenizci, R. Legenstein, Restoring vision in adverse weather conditions with patch-based denoising diffusion models, IEEE Transactions on Pattern Analysis and Machine Intelligence 45 (8) (2023) 10346–10357.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. Liu, A. Zhang, W. Zhu, B. Fu, B. Ding, S. Xiong, Residual deformable convolution for better image de-weathering, Pattern Recognition 147 (2024) 110093.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
R. Li, L.-F. Cheong, R. T. Tan, Heavy rain image restoration: Integrating physics model and conditional adversarial learning, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2019, pp. 1633–1642.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Gao, X. Liu, B. Zeng, S. Xu, Y. Li, X. Luo, J. Liu, X. Zhen, B. Zhang, Implicit diffusion models for continuous super-resolution, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 10021–10030.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Lugmayr, M. Danelljan, A. Romero, F. Yu, R. Timofte, L. Van Gool, Repaint: Inpainting using denoising diffusion probabilistic models, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 11461–11471.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Tarvainen, H. Valpola, Mean teachers are better role models: Weight-averaged consistency targets improve semi-supervised deep learning results, Advances in Neural Information Processing Systems 30 (2017) 1195–1204.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Phung, Q. Dao, A. Tran, Wavelet diffusion models are fast and scalable image generators, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 10199–10208.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
F. Yu, J. Gu, Z. Li, J. Hu, X. Kong, X. Wang, J. He, Y. Qiao, C. Dong, Scaling up to excellence: Practicing model scaling for photo-realistic image restoration in the wild, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2024, pp. 25669–25680.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
C. Wang, J. Pan, W. Lin, J. Dong, W. Wang, X.-M. Wu, Selfpromer: Self-prompt dehazing transformers with depth-consistency, in: Proceedings of the AAAI Conference on Artificial Intelligence, 2024, pp. 5327–5335.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Zhang, H. Zhang, X. Chai, Z. Cheng, R. Xie, L. Song, W. Zhang, Diff-restorer: Unleashing visual prompts for diffusion-based universal image restoration, arXiv preprint arXiv:2407.03636 (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
C. Wang, X. Xing, Y. Wu, Z. Su, J. Chen, Dcsfn: Deep cross-scale fusion network for single image rain removal, in: Proceedings of the 28th ACM International Conference on Multimedia, 2020, pp. 1643–1651.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
S. Chen, T. Ye, C. Xue, H. Chen, Y. Liu, E. Chen, L. Zhu, Uncertainty-driven dynamic degradation perceiving and background modeling for efficient single image desnowing, in: Proceedings of the 31st ACM International Conference on Multimedia, 2023, pp. 4269–4280.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Z. Chen, Y. Sun, X. Bi, J. Yue, Lightweight image de-snowing: A better trade-off between network capacity and performance, Neural Networks 165 (2023) 896–908.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Quan, S. Deng, Y. Chen, H. Ji, Deep learning for seeing through window with raindrops, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, 2019, pp. 2463–2471.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
G. Wang, C. Sun, A. Sowmya, Context-enhanced representation learning for single image deraining, International Journal of Computer Vision 129 (5) (2021) 1650–1674.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
S. Chen, T. Ye, J. Bai, E. Chen, J. Shi, L. Zhu, Sparse sampling transformer with uncertainty-driven ranking for unified removal of raindrops and rain streaks, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, 2023, pp. 13106–13117.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
R. Li, R. T. Tan, L.-F. Cheong, All in one bad weather removal using architectural search, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2020, pp. 3175–3185.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
J. M. J. Valanarasu, R. Yasarla, V. M. Patel, Transweather: Transformer-based restoration of images degraded by adverse weather conditions, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 2353–2363.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Zhu, T. Wang, X. Fu, X. Yang, X. Guo, J. Dai, Y. Qiao, X. Hu, Learning weather-general and weather-specific features for image restoration under multiple adverse weather conditions, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 21747–21758.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Q. Xie, M.-T. Luong, E. Hovy, Q. V. Le, Self-training with noisy student improves imagenet classification, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2020, pp. 10687–10698.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
D. Berthelot, N. Carlini, I. Goodfellow, N. Papernot, A. Oliver, C. A. Raffel, Mixmatch: A holistic approach to semi-supervised learning, Advances in Neural Information Processing Systems 32 (2019) 5050–5060.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
A. Rasmus, M. Berglund, M. Honkala, H. Valpola, T. Raiko, Semi-supervised learning with ladder networks, Advances in Neural Information Processing Systems 28 (2015) 3546–3554.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
P. Bachman, O. Alsharif, D. Precup, Learning with pseudo-ensembles, Advances in Neural Information Processing Systems 27 (2014) 3365–3373.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Tang, W. Chen, Y. Luo, Y. Zhang, Humble teachers teach better students for semi-supervised object detection, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2021, pp. 3132–3141.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
S. Huang, K. Wang, H. Liu, J. Chen, Y. Li, Contrastive semi-supervised learning for underwater image restoration via reliable bank, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2023, pp. 18145–18155.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Xiao, K. Kreis, A. Vahdat, Tackling the generative learning trilemma with denoising diffusion GANs, in: International Conference on Learning Representations, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
W. Huang, S. Tu, L. Xu, Ia-faces: A bidirectional method for semantic face editing, Neural Networks 158 (2023) 272–292.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
S. H. Lee, H. gun Chi, G. Oh, W. Byeon, S. H. Yoon, H. Park, W. Cho, J. Kim, S. Kim, Robust sound-guided image manipulation, Neural Networks 175 (2024) 106271.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
K. Sohn, D. Berthelot, N. Carlini, Z. Zhang, H. Zhang, C. A. Raffel, E. D. Cubuk, A. Kurakin, C.-L. Li, Fixmatch: Simplifying semi-supervised learning with consistency and confidence, Advances in Neural Information Processing Systems 33 (2020) 596–608.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
J. Ke, Q. Wang, Y. Wang, P. Milanfar, F. Yang, Musiq: Multi-scale image quality transformer, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, 2021, pp. 5148–5157.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
K. Simonyan, A. Zisserman, Very deep convolutional networks for large-scale image recognition, arXiv preprint arXiv:1409.1556 (2014).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
R. Qian, R. T. Tan, W. Yang, J. Su, J. Liu, Attentive generative adversarial network for raindrop removal from a single image, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2018, pp. 2482–2491.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Y. Liu, D.-W. Jaw, S.-C. Huang, J.-N. Hwang, Desnownet: Context-aware deep network for snow removal, IEEE Transactions on Image Processing 27 (6) (2018) 3064–3073.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Y. Cui, W. Ren, X. Cao, A. Knoll, Focal network for image restoration, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, 2023, pp. 13001–13011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Y. Cui, Y. Tao, Z. Bing, W. Ren, X. Gao, X. Cao, K. Huang, A. Knoll, Selective frequency network for image restoration, in: International Conference on Learning Representations, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Q. Wu, L. Wang, K. N. Ngan, H. Li, F. Meng, L. Xu, Subjective and objective de-raining quality assessment towards authentic rain image, IEEE Transactions on Circuits and Systems for Video Technology 30 (11) (2020) 3883–3897.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
B. Heo, S. Chun, S. J. Oh, D. Han, S. Yun, G. Kim, Y. Uh, J.-W. Ha, Adamp: Slowing down the slowdown for momentum optimizers on scale-invariant weights, arXiv preprint arXiv:2006.08217 (2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
A. Kulkarni, S. S. Phutke, S. Murala, Unified transformer network for multi-weather image restoration, in: Proceedings of the European Conference on Computer Vision, 2022, pp. 344–360.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Xiao, X. Fu, A. Liu, F. Wu, Z.-J. Zha, Image de-raining transformer, IEEE Transactions on Pattern Analysis and Machine Intelligence 45 (11) (2023) 12978–12995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
K. Jiang, Z. Wang, P. Yi, C. Chen, Z. Wang, X. Wang, J. Jiang, C.-W. Lin, Rain-free and residue hand-in-hand: A progressive coupled network for real-time image deraining, IEEE Transactions on Image Processing 30 (2021) 7404–7418.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
S. W. Zamir, A. Arora, S. Khan, M. Hayat, F. S. Khan, M.-H. Yang, L. Shao, Multi-stage progressive image restoration, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2021, pp. 14821–14831.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Y. Cui, W. Ren, X. Cao, A. Knoll, Image restoration via frequency selection, IEEE Transactions on Pattern Analysis and Machine Intelligence 46 (2) (2024) 1093–1108.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Z. Ying, H. Niu, P. Gupta, D. Mahajan, D. Ghadiyaram, A. Bovik, From patches to pictures (paq-2-piq): Mapping the perceptual space of picture quality, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2020, pp. 3575–3585.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
W. Zhang, K. Ma, J. Yan, D. Deng, Z. Wang, Blind image quality assessment using a deep bilinear convolutional neural network, IEEE Transactions on Circuits and Systems for Video Technology 30 (1) (2020) 36–47.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
J. Wang, K. C. Chan, C. C. Loy, Exploring clip for assessing the look and feel of images, in: Proceedings of the AAAI Conference on Artificial Intelligence, 2023, pp. 2555–2563.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
A. Mittal, R. Soundararajan, A. C. Bovik, Making a “completely blind” image quality analyzer, IEEE Signal Processing Letters 20 (3) (2012) 209–212.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
T. Zheng, Y. Huang, Y. Liu, W. Tang, Z. Yang, D. Cai, X. He, Clrnet: Cross layer refinement network for lane detection, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022, pp. 898–907.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
L. Xiao, X. Li, S. Yang, W. Yang, Adnet: Lane shape prediction via anchor decomposition, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, 2023, pp. 6404–6413.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
X. Pan, J. Shi, P. Luo, X. Wang, X. Tang, Spatial as deep: Spatial cnn for traffic scene understanding, in: Proceedings of the AAAI Conference on Artificial Intelligence, 2018, pp. 7276–7283.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep 28 04:41:34 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
