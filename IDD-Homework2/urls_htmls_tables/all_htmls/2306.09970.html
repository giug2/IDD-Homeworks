<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2306.09970] HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning</title><meta property="og:description" content="In this paper, we focus on the important yet understudied problem of Continual Federated Learning (CFL), where a server communicates with a set of clients to incrementally learn new concepts over time without sharing o…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2306.09970">

<!--Generated on Wed Feb 28 23:52:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id1.1.id1" class="ltx_text ltx_font_bold">
Shaunak Halbe
 James Seale Smith
 Junjiao Tian
 Zsolt Kira
</span> 
<br class="ltx_break">Georgia Institute of Technology
</span><span class="ltx_author_notes"><span id="id2.2.id1" class="ltx_text ltx_font_bold">Correspondence to shalbe9@gatech.edu.</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">In this paper, we focus on the important yet understudied problem of Continual Federated Learning (CFL), where a server communicates with a set of clients to incrementally learn new concepts over time without sharing or storing any data. The complexity of this problem is compounded by challenges from both the Continual and Federated Learning perspectives. Specifically, models trained in a CFL setup suffer from catastrophic forgetting which is exacerbated by data heterogeneity across clients.
Existing attempts at this problem tend to impose large overheads on clients and communication channels or require access to stored data which renders them unsuitable for real-world use due to privacy.
In this paper, we attempt to tackle forgetting and heterogeneity while minimizing overhead costs and without requiring access to any stored data. We achieve this by leveraging a prompting based approach (such that only prompts and classifier heads have to be communicated) and proposing a novel and lightweight generation and distillation scheme to consolidate client models at the server.
We formulate this problem for image classification and establish strong baselines for comparison, conduct experiments on CIFAR-100 as well as challenging, large-scale datasets like ImageNet-R and DomainNet.
Our approach outperforms both existing methods and our own baselines by as much as 7% while significantly reducing communication and client-level computation costs.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) is a privacy-preserving learning paradigm that enables learning a global model through communication with a distributed set of clients. These clients have exclusive access to private data, and collaborate with a central server to learn a shared task by communicating parameters such as model weights, gradients, or learning statistics. For example, the popular FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> method works by iteratively aggregating client models by averaging model weights. Classical FL methods such as FedAvg have garnered significant attention due to the increasing demand for user privacy and the growth of edge computing.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, currently most federated learning methods focus on learning statically, that is across a fixed set of categories determined <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">a-priori</span>. In non-federated works, on the other hand, there has been a great deal of progress on learning an increasing number of categories incrementally, referred to as <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">continual</span> learning (and more specifically <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">class-incremental learning</span>)
 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. In addition to the problem of catastrophic forgetting, incremental learning breaks current assumptions in FL, namely that the data is Independent and Identically Distributed (IID), which
has been shown to cause issues of model divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. While <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">heterogeneous federated learning</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> approaches have been developed, they do not support the <em id="S1.p2.1.5" class="ltx_emph ltx_font_italic">dynamic data distributions</em> that occur in continual learning and the real-world. For example, such a setting has immense practical impact to applications such as healthcare, autonomous vehicles, and chat-bots.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2306.09970/assets/figures/source/teaser.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="146" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">
In Continual Federated Learning (CFL), clients learn from unique, continual data. We propose a prompt-based CFL approach, paired with a lightweight generation and distillation scheme, to consolidate client models at the server in a communication-efficient and privacy-preserving manner.
</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Therefore, in this paper we look at the understudied problem of <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">Continual Federated Learning (CFL)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. While a few CFL methods exist, they address the issue of forgetting using approaches such as: reducing inter-client interference, knowledge distillation, and image-level generative replay.
Specifically, they often communicate full model weights, real/synthesized image-level data, or gradients. Additionally, some methods store old data in memory buffers or train a generative model to mimic local data; at the very least, all methods share complete models parameters with the server which can lead to privacy leaks with advancements in model inversion and other extraction techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">As a result, many of these methods fail to effectively uphold the principles of CFL, such as privacy, communication efficiency, and computational efficiency</span>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To mitigate forgetting while adhering to the core principles of CFL, we propose HePCo: <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">H</span>eterogeneous <span id="S1.p4.1.2" class="ltx_text ltx_font_bold">P</span>rompt <span id="S1.p4.1.3" class="ltx_text ltx_font_bold">Co</span>nsolidation (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Our method is driven by the goals of (i) minimizing communication costs, (ii) ensuring client privacy, and (iii) client-level computation efficiency. We first propose to leverage <em id="S1.p4.1.4" class="ltx_emph ltx_font_italic">prompting</em>-based methods, which have shown successful results in the rehearsal-free continual learning setting. This also has the benefit of utilizing frozen Foundation Models, meaning that only prompts and classifiers have to be transmitted, reducing communication. The key contribution of our approach is then to answer the question of how to merge prompts from different clients in a scalable manner. Towards this end we propose a lightweight method for generating pseudo-data and distilling client model information. Importantly, we distill data from both the past task label distribution as well as the current task label distribution, preventing both catastrophic forgetting and performance degradation due to client heterogeneity. <span id="S1.p4.1.5" class="ltx_text ltx_font_italic">In summary, we make the following key contributions:</span></p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We modify and extend popular continual prompt-based approaches to the setting of Continual Federated Learning (CFL), implementing a range of methods that we will open-source.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce a light-weight pseudo-latent knowledge distillation mechanism to aggregate client models trained on non-IID data partitions. Importantly, our approach incurs no additional client-side computation and does not store or generate training data.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We outperform both existing methods and contributed baselines by as much as 7% while drastically reducing communication costs by only sharing a small set of model parameters.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Prompting for Continual Learning:</span>
Continual learning algorithms fall into several primary groups. Some methods involve expanding the model’s architecture as new tasks arise <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, while others regularize the model with prior task knowledge either in the weight space or the prediction space <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Additionally, rehearsal-based methods leverage stored data or samples from a generative model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Despite their efficacy, these methods might compromise data privacy and impose substantial memory costs, which justifies the need for <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">rehearsal-free strategies</em>. In the realm of rehearsal-free continual learning, some studies focus on an online learning perspective utilizing a pre-trained model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, or explore prototype-based techniques to avert catastrophic forgetting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Other work proposes deep-model inversion to produce images for rehearsal, yet the computational expense and data-privacy issues render this approach challenging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. NCDwF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> performs classifier inversion and pseudo-replay in the latent-space to reduce forgetting in a novel class-discovery setting. Recent works have demonstrated that <span id="S2.p1.1.3" class="ltx_text ltx_font_bold">prompting</span> within a static, pre-trained transformer model for continual learning achieves state of the art performance without any rehearsal data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Our work builds off of the foundations of these prompting methods, but in the continual federated learning setting.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Heterogeneous Federated Learning:</span> Federated learning involves a number of clients learning over local data, to be aggregated by a global server. One of the simplest early methods for this is FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which simply averages the parameters of the clients in a manner weighted by the amount of data they have.
The most investigated challenge in federated learning (FL) is client heterogeneity, which can cause local models to diverge and the aggregated global model to perform sub-optimally <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. In this work, we discuss FL works tackling this issue in two categories: parameter-averaging methods and knowledge distillation methods. To combat high heterogeneity in local data, methods like FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, FedPD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, and SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> are used out of which FedProx is a <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">stateless</span> algorithm suited to our setting while the rest are <span id="S2.p2.1.3" class="ltx_text ltx_font_italic">stateful</span> algorithms. Knowledge-distillation-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> usually use additional data to perform distillation on the server or client side to robustly aggregate local models. FedFTG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> operates in a data-free setting by generating pseudo-data through inversion in the image space. In contrast, we achieve knowledge distillation using pseudo-data generated in latent space to 1) reduce computation overhead stemming from inversion in a higher-dimensional space and 2) fine-tune both the classifier and the prompt components simultaneously which is essential to mitigate forgetting.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Continual Federated Learning:</span>
Most of the current CFL methods suffer from various limitations in terms of performance, efficiency and privacy. FedWeiT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> aims to learn better client models by minimizing interference across client weights. FedWeiT incurs considerable overheads in terms of communication, computation and storage. GLFC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> uses a prototype based approach with a memory buffer to store old data. This poses a threat to privacy of client data. CFed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> proposes a distillation based approach that makes use of an unlabelled dataset to aggregate client models as well as to rehearse old tasks. However the requirement for a curated dataset can severely impact real-world applicability. TARGET <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> attempts to combat forgetting through replay of old tasks driven by generated images. FedCIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> leverages an Auxiliary Classifier GAN (ACGAN) to alleviate forgetting by synthesizing old images for replay. However, generating images to mimic local datasets can be viewed as a privacy risk especially in light of recent research on model inversion attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. In contrast, our approach prioritizes client privacy by generating in the latent space which cannot be traced back to the image space. Further, this benefits communication and compute efficiency.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we describe the formulation by introducing the class-incremental learning and heterogeneous federated learning aspects in our CFL setting.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.5" class="ltx_p"><span id="S3.p2.5.1" class="ltx_text ltx_font_bold">Class-Incremental Federated Learning.</span> We focus on the <span id="S3.p2.5.2" class="ltx_text ltx_font_italic">class-incremental</span> learning scenario, where a model is tasked with learning new classes over time. Under this setting, a global model is learned through a sequence of <span id="S3.p2.5.3" class="ltx_text ltx_font_italic">N global</span> tasks <math id="S3.p2.1.m1.4" class="ltx_Math" alttext="\emph{T}=\{T^{1},T^{2},...,T^{N}\}" display="inline"><semantics id="S3.p2.1.m1.4a"><mrow id="S3.p2.1.m1.4.4" xref="S3.p2.1.m1.4.4.cmml"><mtext class="ltx_mathvariant_italic" id="S3.p2.1.m1.4.4.5" xref="S3.p2.1.m1.4.4.5b.cmml"><em id="S3.p2.1.m1.4.4.5.1nest" class="ltx_emph ltx_font_italic">T</em></mtext><mo id="S3.p2.1.m1.4.4.4" xref="S3.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.p2.1.m1.4.4.3.3" xref="S3.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.p2.1.m1.4.4.3.3.4" xref="S3.p2.1.m1.4.4.3.4.cmml">{</mo><msup id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">T</mi><mn id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.p2.1.m1.4.4.3.3.5" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msup id="S3.p2.1.m1.3.3.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.p2.1.m1.3.3.2.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.2.cmml">T</mi><mn id="S3.p2.1.m1.3.3.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.p2.1.m1.4.4.3.3.6" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.p2.1.m1.4.4.3.3.7" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msup id="S3.p2.1.m1.4.4.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.p2.1.m1.4.4.3.3.3.2" xref="S3.p2.1.m1.4.4.3.3.3.2.cmml">T</mi><mi id="S3.p2.1.m1.4.4.3.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.3.cmml">N</mi></msup><mo stretchy="false" id="S3.p2.1.m1.4.4.3.3.8" xref="S3.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.4b"><apply id="S3.p2.1.m1.4.4.cmml" xref="S3.p2.1.m1.4.4"><eq id="S3.p2.1.m1.4.4.4.cmml" xref="S3.p2.1.m1.4.4.4"></eq><ci id="S3.p2.1.m1.4.4.5b.cmml" xref="S3.p2.1.m1.4.4.5"><mtext class="ltx_mathvariant_italic" id="S3.p2.1.m1.4.4.5.cmml" xref="S3.p2.1.m1.4.4.5"><em id="S3.p2.1.m1.4.4.5.1anest" class="ltx_emph ltx_font_italic">T</em></mtext></ci><set id="S3.p2.1.m1.4.4.3.4.cmml" xref="S3.p2.1.m1.4.4.3.3"><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2">𝑇</ci><cn type="integer" id="S3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2">𝑇</ci><cn type="integer" id="S3.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">…</ci><apply id="S3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.p2.1.m1.4.4.3.3.3.2">𝑇</ci><ci id="S3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.4c">\emph{T}=\{T^{1},T^{2},...,T^{N}\}</annotation></semantics></math>. Following the standard assumption in continual learning, the sets of categories <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We use the terms ’category’, ’class’, and ’label’ interchangeably to refer to the target classification label.</span></span></span>seen across distinct <span id="S3.p2.5.4" class="ltx_text ltx_font_italic">global</span> tasks are mutually exclusive. As this is done in a federated setup, each task is learned through <span id="S3.p2.5.5" class="ltx_text ltx_font_italic">R</span> independent rounds by randomly sampling a set of <span id="S3.p2.5.6" class="ltx_text ltx_font_italic">stateless</span> clients <em id="S3.p2.5.7" class="ltx_emph ltx_font_italic">C</em> = {<math id="S3.p2.2.m2.1" class="ltx_Math" alttext="c_{1}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">c</mi><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑐</ci><cn type="integer" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">c_{1}</annotation></semantics></math>, <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="c_{2}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">c</mi><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑐</ci><cn type="integer" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">c_{2}</annotation></semantics></math>, <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="c_{3}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">c</mi><mn id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑐</ci><cn type="integer" id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">c_{3}</annotation></semantics></math>, …, <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="c_{S}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">c</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝑐</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">c_{S}</annotation></semantics></math>} in each round. In a <span id="S3.p2.5.8" class="ltx_text ltx_font_italic">stateless</span> setting, new clients are visited in each round. Previously seen data cannot be accessed at any time during the training.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.19" class="ltx_p"><span id="S3.p3.19.1" class="ltx_text ltx_font_bold">Heterogeneous Federated Learning.</span> To simulate a real-world heterogeneous federated learning scenario, we use three configuration parameters to control the level of heterogeneity with increasing granularity: <span id="S3.p3.19.2" class="ltx_text ltx_font_italic">split ratio</span>, <span id="S3.p3.19.3" class="ltx_text ltx_font_italic">category ratio</span>, and <span id="S3.p3.19.4" class="ltx_text ltx_font_italic">imbalance ratio</span>. At the top level, the most common heterogeneity is varying local dataset sizes. A specific client <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">c</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑐</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">c_{i}</annotation></semantics></math> can be exposed to a subset of the current task dataset <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="D^{t}" display="inline"><semantics id="S3.p3.2.m2.1a"><msup id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">D</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">superscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝐷</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">D^{t}</annotation></semantics></math> as their local dataset <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="D_{i}^{t}" display="inline"><semantics id="S3.p3.3.m3.1a"><msubsup id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2.2" xref="S3.p3.3.m3.1.1.2.2.cmml">D</mi><mi id="S3.p3.3.m3.1.1.2.3" xref="S3.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">superscript</csymbol><apply id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.2.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.2.cmml" xref="S3.p3.3.m3.1.1.2.2">𝐷</ci><ci id="S3.p3.3.m3.1.1.2.3.cmml" xref="S3.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">D_{i}^{t}</annotation></semantics></math>, and the size <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="|D_{i}^{t}|" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.2.cmml"><mo stretchy="false" id="S3.p3.4.m4.1.1.1.2" xref="S3.p3.4.m4.1.1.2.1.cmml">|</mo><msubsup id="S3.p3.4.m4.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.cmml"><mi id="S3.p3.4.m4.1.1.1.1.2.2" xref="S3.p3.4.m4.1.1.1.1.2.2.cmml">D</mi><mi id="S3.p3.4.m4.1.1.1.1.2.3" xref="S3.p3.4.m4.1.1.1.1.2.3.cmml">i</mi><mi id="S3.p3.4.m4.1.1.1.1.3" xref="S3.p3.4.m4.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.p3.4.m4.1.1.1.3" xref="S3.p3.4.m4.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.1"><abs id="S3.p3.4.m4.1.1.2.1.cmml" xref="S3.p3.4.m4.1.1.1.2"></abs><apply id="S3.p3.4.m4.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.p3.4.m4.1.1.1.1.2.cmml" xref="S3.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.1.2.1.cmml" xref="S3.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.1.1.2.2.cmml" xref="S3.p3.4.m4.1.1.1.1.2.2">𝐷</ci><ci id="S3.p3.4.m4.1.1.1.1.2.3.cmml" xref="S3.p3.4.m4.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.p3.4.m4.1.1.1.1.3.cmml" xref="S3.p3.4.m4.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">|D_{i}^{t}|</annotation></semantics></math> varies from each other. We denote this as the <span id="S3.p3.19.5" class="ltx_text ltx_font_italic">split ratio</span> <math id="S3.p3.5.m5.2" class="ltx_Math" alttext="\gamma=\lvert D_{i}^{t}\rvert/\lvert D^{t}\rvert" display="inline"><semantics id="S3.p3.5.m5.2a"><mrow id="S3.p3.5.m5.2.2" xref="S3.p3.5.m5.2.2.cmml"><mi id="S3.p3.5.m5.2.2.4" xref="S3.p3.5.m5.2.2.4.cmml">γ</mi><mo id="S3.p3.5.m5.2.2.3" xref="S3.p3.5.m5.2.2.3.cmml">=</mo><mrow id="S3.p3.5.m5.2.2.2" xref="S3.p3.5.m5.2.2.2.cmml"><mrow id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p3.5.m5.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.2.1.cmml">|</mo><msubsup id="S3.p3.5.m5.1.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.cmml">D</mi><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.p3.5.m5.1.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.p3.5.m5.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.p3.5.m5.2.2.2.3" xref="S3.p3.5.m5.2.2.2.3.cmml">/</mo><mrow id="S3.p3.5.m5.2.2.2.2.1" xref="S3.p3.5.m5.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.p3.5.m5.2.2.2.2.1.2" xref="S3.p3.5.m5.2.2.2.2.2.1.cmml">|</mo><msup id="S3.p3.5.m5.2.2.2.2.1.1" xref="S3.p3.5.m5.2.2.2.2.1.1.cmml"><mi id="S3.p3.5.m5.2.2.2.2.1.1.2" xref="S3.p3.5.m5.2.2.2.2.1.1.2.cmml">D</mi><mi id="S3.p3.5.m5.2.2.2.2.1.1.3" xref="S3.p3.5.m5.2.2.2.2.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.p3.5.m5.2.2.2.2.1.3" xref="S3.p3.5.m5.2.2.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.2b"><apply id="S3.p3.5.m5.2.2.cmml" xref="S3.p3.5.m5.2.2"><eq id="S3.p3.5.m5.2.2.3.cmml" xref="S3.p3.5.m5.2.2.3"></eq><ci id="S3.p3.5.m5.2.2.4.cmml" xref="S3.p3.5.m5.2.2.4">𝛾</ci><apply id="S3.p3.5.m5.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2"><divide id="S3.p3.5.m5.2.2.2.3.cmml" xref="S3.p3.5.m5.2.2.2.3"></divide><apply id="S3.p3.5.m5.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1"><abs id="S3.p3.5.m5.1.1.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.2"></abs><apply id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2">𝐷</ci><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.p3.5.m5.2.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2.1"><abs id="S3.p3.5.m5.2.2.2.2.2.1.cmml" xref="S3.p3.5.m5.2.2.2.2.1.2"></abs><apply id="S3.p3.5.m5.2.2.2.2.1.1.cmml" xref="S3.p3.5.m5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.2.2.2.2.1.1.1.cmml" xref="S3.p3.5.m5.2.2.2.2.1.1">superscript</csymbol><ci id="S3.p3.5.m5.2.2.2.2.1.1.2.cmml" xref="S3.p3.5.m5.2.2.2.2.1.1.2">𝐷</ci><ci id="S3.p3.5.m5.2.2.2.2.1.1.3.cmml" xref="S3.p3.5.m5.2.2.2.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.2c">\gamma=\lvert D_{i}^{t}\rvert/\lvert D^{t}\rvert</annotation></semantics></math>. At a lower level,
the local dataset <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="D_{i}^{t}" display="inline"><semantics id="S3.p3.6.m6.1a"><msubsup id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi id="S3.p3.6.m6.1.1.2.2" xref="S3.p3.6.m6.1.1.2.2.cmml">D</mi><mi id="S3.p3.6.m6.1.1.2.3" xref="S3.p3.6.m6.1.1.2.3.cmml">i</mi><mi id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">superscript</csymbol><apply id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.1.cmml" xref="S3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2">𝐷</ci><ci id="S3.p3.6.m6.1.1.2.3.cmml" xref="S3.p3.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">D_{i}^{t}</annotation></semantics></math> consists of a subset of the categories from those in the current global task. Specifically, a global task <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="T^{t}" display="inline"><semantics id="S3.p3.7.m7.1a"><msup id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2" xref="S3.p3.7.m7.1.1.2.cmml">T</mi><mi id="S3.p3.7.m7.1.1.3" xref="S3.p3.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1">superscript</csymbol><ci id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1.2">𝑇</ci><ci id="S3.p3.7.m7.1.1.3.cmml" xref="S3.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">T^{t}</annotation></semantics></math> consists of categories <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="K^{t}" display="inline"><semantics id="S3.p3.8.m8.1a"><msup id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><mi id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml">K</mi><mi id="S3.p3.8.m8.1.1.3" xref="S3.p3.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1">superscript</csymbol><ci id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2">𝐾</ci><ci id="S3.p3.8.m8.1.1.3.cmml" xref="S3.p3.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">K^{t}</annotation></semantics></math>, where <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="\lvert K^{t}\rvert" display="inline"><semantics id="S3.p3.9.m9.1a"><mrow id="S3.p3.9.m9.1.1.1" xref="S3.p3.9.m9.1.1.2.cmml"><mo stretchy="false" id="S3.p3.9.m9.1.1.1.2" xref="S3.p3.9.m9.1.1.2.1.cmml">|</mo><msup id="S3.p3.9.m9.1.1.1.1" xref="S3.p3.9.m9.1.1.1.1.cmml"><mi id="S3.p3.9.m9.1.1.1.1.2" xref="S3.p3.9.m9.1.1.1.1.2.cmml">K</mi><mi id="S3.p3.9.m9.1.1.1.1.3" xref="S3.p3.9.m9.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.p3.9.m9.1.1.1.3" xref="S3.p3.9.m9.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><apply id="S3.p3.9.m9.1.1.2.cmml" xref="S3.p3.9.m9.1.1.1"><abs id="S3.p3.9.m9.1.1.2.1.cmml" xref="S3.p3.9.m9.1.1.1.2"></abs><apply id="S3.p3.9.m9.1.1.1.1.cmml" xref="S3.p3.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.1.1.1.cmml" xref="S3.p3.9.m9.1.1.1.1">superscript</csymbol><ci id="S3.p3.9.m9.1.1.1.1.2.cmml" xref="S3.p3.9.m9.1.1.1.1.2">𝐾</ci><ci id="S3.p3.9.m9.1.1.1.1.3.cmml" xref="S3.p3.9.m9.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\lvert K^{t}\rvert</annotation></semantics></math> denotes the number of unique categories <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><math id="footnotex2.m1a.1" class="ltx_Math" alttext="\lvert\cdot\rvert" display="inline"><semantics id="footnotex2.m1a.1b"><mrow id="footnotex2.m1a.1.2.2" xref="footnotex2.m1a.1.2.1.cmml"><mo stretchy="false" id="footnotex2.m1a.1.2.2.1" xref="footnotex2.m1a.1.2.1.1.cmml">|</mo><mo lspace="0em" rspace="0em" id="footnotex2.m1a.1.1" xref="footnotex2.m1a.1.1.cmml">⋅</mo><mo stretchy="false" id="footnotex2.m1a.1.2.2.2" xref="footnotex2.m1a.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="footnotex2.m1a.1c"><apply id="footnotex2.m1a.1.2.1.cmml" xref="footnotex2.m1a.1.2.2"><abs id="footnotex2.m1a.1.2.1.1.cmml" xref="footnotex2.m1a.1.2.2.1"></abs><ci id="footnotex2.m1a.1.1.cmml" xref="footnotex2.m1a.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnotex2.m1a.1d">\lvert\cdot\rvert</annotation></semantics></math> corresponds to set cardinality.</span></span></span>. In a given round <span id="S3.p3.19.6" class="ltx_text ltx_font_italic">r</span>, each client <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.p3.10.m10.1a"><msub id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mi id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml">c</mi><mi id="S3.p3.10.m10.1.1.3" xref="S3.p3.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2">𝑐</ci><ci id="S3.p3.10.m10.1.1.3.cmml" xref="S3.p3.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">c_{i}</annotation></semantics></math> sees data containing <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="K_{i}^{t}\in K^{t}" display="inline"><semantics id="S3.p3.11.m11.1a"><mrow id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml"><msubsup id="S3.p3.11.m11.1.1.2" xref="S3.p3.11.m11.1.1.2.cmml"><mi id="S3.p3.11.m11.1.1.2.2.2" xref="S3.p3.11.m11.1.1.2.2.2.cmml">K</mi><mi id="S3.p3.11.m11.1.1.2.2.3" xref="S3.p3.11.m11.1.1.2.2.3.cmml">i</mi><mi id="S3.p3.11.m11.1.1.2.3" xref="S3.p3.11.m11.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.p3.11.m11.1.1.1" xref="S3.p3.11.m11.1.1.1.cmml">∈</mo><msup id="S3.p3.11.m11.1.1.3" xref="S3.p3.11.m11.1.1.3.cmml"><mi id="S3.p3.11.m11.1.1.3.2" xref="S3.p3.11.m11.1.1.3.2.cmml">K</mi><mi id="S3.p3.11.m11.1.1.3.3" xref="S3.p3.11.m11.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1"><in id="S3.p3.11.m11.1.1.1.cmml" xref="S3.p3.11.m11.1.1.1"></in><apply id="S3.p3.11.m11.1.1.2.cmml" xref="S3.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.2.1.cmml" xref="S3.p3.11.m11.1.1.2">superscript</csymbol><apply id="S3.p3.11.m11.1.1.2.2.cmml" xref="S3.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.2.2.1.cmml" xref="S3.p3.11.m11.1.1.2">subscript</csymbol><ci id="S3.p3.11.m11.1.1.2.2.2.cmml" xref="S3.p3.11.m11.1.1.2.2.2">𝐾</ci><ci id="S3.p3.11.m11.1.1.2.2.3.cmml" xref="S3.p3.11.m11.1.1.2.2.3">𝑖</ci></apply><ci id="S3.p3.11.m11.1.1.2.3.cmml" xref="S3.p3.11.m11.1.1.2.3">𝑡</ci></apply><apply id="S3.p3.11.m11.1.1.3.cmml" xref="S3.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.3.1.cmml" xref="S3.p3.11.m11.1.1.3">superscript</csymbol><ci id="S3.p3.11.m11.1.1.3.2.cmml" xref="S3.p3.11.m11.1.1.3.2">𝐾</ci><ci id="S3.p3.11.m11.1.1.3.3.cmml" xref="S3.p3.11.m11.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">K_{i}^{t}\in K^{t}</annotation></semantics></math> categories.  We denote <math id="S3.p3.12.m12.1" class="ltx_Math" alttext="\kappa=K_{i}^{t}/K^{t}" display="inline"><semantics id="S3.p3.12.m12.1a"><mrow id="S3.p3.12.m12.1.1" xref="S3.p3.12.m12.1.1.cmml"><mi id="S3.p3.12.m12.1.1.2" xref="S3.p3.12.m12.1.1.2.cmml">κ</mi><mo id="S3.p3.12.m12.1.1.1" xref="S3.p3.12.m12.1.1.1.cmml">=</mo><mrow id="S3.p3.12.m12.1.1.3" xref="S3.p3.12.m12.1.1.3.cmml"><msubsup id="S3.p3.12.m12.1.1.3.2" xref="S3.p3.12.m12.1.1.3.2.cmml"><mi id="S3.p3.12.m12.1.1.3.2.2.2" xref="S3.p3.12.m12.1.1.3.2.2.2.cmml">K</mi><mi id="S3.p3.12.m12.1.1.3.2.2.3" xref="S3.p3.12.m12.1.1.3.2.2.3.cmml">i</mi><mi id="S3.p3.12.m12.1.1.3.2.3" xref="S3.p3.12.m12.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S3.p3.12.m12.1.1.3.1" xref="S3.p3.12.m12.1.1.3.1.cmml">/</mo><msup id="S3.p3.12.m12.1.1.3.3" xref="S3.p3.12.m12.1.1.3.3.cmml"><mi id="S3.p3.12.m12.1.1.3.3.2" xref="S3.p3.12.m12.1.1.3.3.2.cmml">K</mi><mi id="S3.p3.12.m12.1.1.3.3.3" xref="S3.p3.12.m12.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.12.m12.1b"><apply id="S3.p3.12.m12.1.1.cmml" xref="S3.p3.12.m12.1.1"><eq id="S3.p3.12.m12.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1"></eq><ci id="S3.p3.12.m12.1.1.2.cmml" xref="S3.p3.12.m12.1.1.2">𝜅</ci><apply id="S3.p3.12.m12.1.1.3.cmml" xref="S3.p3.12.m12.1.1.3"><divide id="S3.p3.12.m12.1.1.3.1.cmml" xref="S3.p3.12.m12.1.1.3.1"></divide><apply id="S3.p3.12.m12.1.1.3.2.cmml" xref="S3.p3.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.3.2.1.cmml" xref="S3.p3.12.m12.1.1.3.2">superscript</csymbol><apply id="S3.p3.12.m12.1.1.3.2.2.cmml" xref="S3.p3.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.3.2.2.1.cmml" xref="S3.p3.12.m12.1.1.3.2">subscript</csymbol><ci id="S3.p3.12.m12.1.1.3.2.2.2.cmml" xref="S3.p3.12.m12.1.1.3.2.2.2">𝐾</ci><ci id="S3.p3.12.m12.1.1.3.2.2.3.cmml" xref="S3.p3.12.m12.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.p3.12.m12.1.1.3.2.3.cmml" xref="S3.p3.12.m12.1.1.3.2.3">𝑡</ci></apply><apply id="S3.p3.12.m12.1.1.3.3.cmml" xref="S3.p3.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.3.3.1.cmml" xref="S3.p3.12.m12.1.1.3.3">superscript</csymbol><ci id="S3.p3.12.m12.1.1.3.3.2.cmml" xref="S3.p3.12.m12.1.1.3.3.2">𝐾</ci><ci id="S3.p3.12.m12.1.1.3.3.3.cmml" xref="S3.p3.12.m12.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m12.1c">\kappa=K_{i}^{t}/K^{t}</annotation></semantics></math> as the <span id="S3.p3.19.7" class="ltx_text ltx_font_italic">category ratio</span> which is a value between 0 and 1. At the lowest level, each category can have a different amount of data. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> to also create an artificial long-tail distribution for local data which is different for each client. This distribution is governed by an <span id="S3.p3.19.8" class="ltx_text ltx_font_italic">imbalance ratio</span> <math id="S3.p3.13.m13.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.p3.13.m13.1a"><mi id="S3.p3.13.m13.1.1" xref="S3.p3.13.m13.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.p3.13.m13.1b"><ci id="S3.p3.13.m13.1.1.cmml" xref="S3.p3.13.m13.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m13.1c">\beta</annotation></semantics></math>. If <math id="S3.p3.14.m14.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S3.p3.14.m14.1a"><mrow id="S3.p3.14.m14.1.1" xref="S3.p3.14.m14.1.1.cmml"><mi id="S3.p3.14.m14.1.1.2" xref="S3.p3.14.m14.1.1.2.cmml">β</mi><mo id="S3.p3.14.m14.1.1.1" xref="S3.p3.14.m14.1.1.1.cmml">=</mo><mn id="S3.p3.14.m14.1.1.3" xref="S3.p3.14.m14.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.14.m14.1b"><apply id="S3.p3.14.m14.1.1.cmml" xref="S3.p3.14.m14.1.1"><eq id="S3.p3.14.m14.1.1.1.cmml" xref="S3.p3.14.m14.1.1.1"></eq><ci id="S3.p3.14.m14.1.1.2.cmml" xref="S3.p3.14.m14.1.1.2">𝛽</ci><cn type="integer" id="S3.p3.14.m14.1.1.3.cmml" xref="S3.p3.14.m14.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m14.1c">\beta=1</annotation></semantics></math>, each client <math id="S3.p3.15.m15.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.p3.15.m15.1a"><msub id="S3.p3.15.m15.1.1" xref="S3.p3.15.m15.1.1.cmml"><mi id="S3.p3.15.m15.1.1.2" xref="S3.p3.15.m15.1.1.2.cmml">c</mi><mi id="S3.p3.15.m15.1.1.3" xref="S3.p3.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.15.m15.1b"><apply id="S3.p3.15.m15.1.1.cmml" xref="S3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p3.15.m15.1.1.1.cmml" xref="S3.p3.15.m15.1.1">subscript</csymbol><ci id="S3.p3.15.m15.1.1.2.cmml" xref="S3.p3.15.m15.1.1.2">𝑐</ci><ci id="S3.p3.15.m15.1.1.3.cmml" xref="S3.p3.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m15.1c">c_{i}</annotation></semantics></math> is allocated samples uniformly from <math id="S3.p3.16.m16.1" class="ltx_Math" alttext="K_{i}^{t}" display="inline"><semantics id="S3.p3.16.m16.1a"><msubsup id="S3.p3.16.m16.1.1" xref="S3.p3.16.m16.1.1.cmml"><mi id="S3.p3.16.m16.1.1.2.2" xref="S3.p3.16.m16.1.1.2.2.cmml">K</mi><mi id="S3.p3.16.m16.1.1.2.3" xref="S3.p3.16.m16.1.1.2.3.cmml">i</mi><mi id="S3.p3.16.m16.1.1.3" xref="S3.p3.16.m16.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.16.m16.1b"><apply id="S3.p3.16.m16.1.1.cmml" xref="S3.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p3.16.m16.1.1.1.cmml" xref="S3.p3.16.m16.1.1">superscript</csymbol><apply id="S3.p3.16.m16.1.1.2.cmml" xref="S3.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p3.16.m16.1.1.2.1.cmml" xref="S3.p3.16.m16.1.1">subscript</csymbol><ci id="S3.p3.16.m16.1.1.2.2.cmml" xref="S3.p3.16.m16.1.1.2.2">𝐾</ci><ci id="S3.p3.16.m16.1.1.2.3.cmml" xref="S3.p3.16.m16.1.1.2.3">𝑖</ci></apply><ci id="S3.p3.16.m16.1.1.3.cmml" xref="S3.p3.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.16.m16.1c">K_{i}^{t}</annotation></semantics></math> categories. In summary, a smaller split ratio <math id="S3.p3.17.m17.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p3.17.m17.1a"><mi id="S3.p3.17.m17.1.1" xref="S3.p3.17.m17.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.17.m17.1b"><ci id="S3.p3.17.m17.1.1.cmml" xref="S3.p3.17.m17.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.17.m17.1c">\gamma</annotation></semantics></math>, a smaller category ratio <math id="S3.p3.18.m18.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S3.p3.18.m18.1a"><mi id="S3.p3.18.m18.1.1" xref="S3.p3.18.m18.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.18.m18.1b"><ci id="S3.p3.18.m18.1.1.cmml" xref="S3.p3.18.m18.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.18.m18.1c">\kappa</annotation></semantics></math>, or a smaller imbalance ratio <math id="S3.p3.19.m19.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.p3.19.m19.1a"><mi id="S3.p3.19.m19.1.1" xref="S3.p3.19.m19.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.p3.19.m19.1b"><ci id="S3.p3.19.m19.1.1.cmml" xref="S3.p3.19.m19.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.19.m19.1c">\beta</annotation></semantics></math> increases heterogeneity thereby increasing the complexity of the task.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.2" class="ltx_p">As discussed before, combining client models in a heterogeneous setting causes the obtained model to forget global knowledge from the previous rounds as shown by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>. Also, training clients on locally-available datasets induces forgetting of global knowledge outside the local distributions. <span id="S3.p4.2.1" class="ltx_text ltx_font_italic">Intra-task forgetting</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
measures such performance drops induced by the data heterogeneity (non-IIDness) across clients. <span id="S3.p4.2.2" class="ltx_text ltx_font_italic">Inter-task forgetting</span> measures the drop in performance on old tasks <math id="S3.p4.1.m1.4" class="ltx_Math" alttext="\{T^{1},T^{2},...,T^{t-1}\}" display="inline"><semantics id="S3.p4.1.m1.4a"><mrow id="S3.p4.1.m1.4.4.3" xref="S3.p4.1.m1.4.4.4.cmml"><mo stretchy="false" id="S3.p4.1.m1.4.4.3.4" xref="S3.p4.1.m1.4.4.4.cmml">{</mo><msup id="S3.p4.1.m1.2.2.1.1" xref="S3.p4.1.m1.2.2.1.1.cmml"><mi id="S3.p4.1.m1.2.2.1.1.2" xref="S3.p4.1.m1.2.2.1.1.2.cmml">T</mi><mn id="S3.p4.1.m1.2.2.1.1.3" xref="S3.p4.1.m1.2.2.1.1.3.cmml">1</mn></msup><mo id="S3.p4.1.m1.4.4.3.5" xref="S3.p4.1.m1.4.4.4.cmml">,</mo><msup id="S3.p4.1.m1.3.3.2.2" xref="S3.p4.1.m1.3.3.2.2.cmml"><mi id="S3.p4.1.m1.3.3.2.2.2" xref="S3.p4.1.m1.3.3.2.2.2.cmml">T</mi><mn id="S3.p4.1.m1.3.3.2.2.3" xref="S3.p4.1.m1.3.3.2.2.3.cmml">2</mn></msup><mo id="S3.p4.1.m1.4.4.3.6" xref="S3.p4.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">…</mi><mo id="S3.p4.1.m1.4.4.3.7" xref="S3.p4.1.m1.4.4.4.cmml">,</mo><msup id="S3.p4.1.m1.4.4.3.3" xref="S3.p4.1.m1.4.4.3.3.cmml"><mi id="S3.p4.1.m1.4.4.3.3.2" xref="S3.p4.1.m1.4.4.3.3.2.cmml">T</mi><mrow id="S3.p4.1.m1.4.4.3.3.3" xref="S3.p4.1.m1.4.4.3.3.3.cmml"><mi id="S3.p4.1.m1.4.4.3.3.3.2" xref="S3.p4.1.m1.4.4.3.3.3.2.cmml">t</mi><mo id="S3.p4.1.m1.4.4.3.3.3.1" xref="S3.p4.1.m1.4.4.3.3.3.1.cmml">−</mo><mn id="S3.p4.1.m1.4.4.3.3.3.3" xref="S3.p4.1.m1.4.4.3.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.p4.1.m1.4.4.3.8" xref="S3.p4.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.4b"><set id="S3.p4.1.m1.4.4.4.cmml" xref="S3.p4.1.m1.4.4.3"><apply id="S3.p4.1.m1.2.2.1.1.cmml" xref="S3.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.2.2.1.1.1.cmml" xref="S3.p4.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.p4.1.m1.2.2.1.1.2.cmml" xref="S3.p4.1.m1.2.2.1.1.2">𝑇</ci><cn type="integer" id="S3.p4.1.m1.2.2.1.1.3.cmml" xref="S3.p4.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.p4.1.m1.3.3.2.2.cmml" xref="S3.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.3.3.2.2.1.cmml" xref="S3.p4.1.m1.3.3.2.2">superscript</csymbol><ci id="S3.p4.1.m1.3.3.2.2.2.cmml" xref="S3.p4.1.m1.3.3.2.2.2">𝑇</ci><cn type="integer" id="S3.p4.1.m1.3.3.2.2.3.cmml" xref="S3.p4.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">…</ci><apply id="S3.p4.1.m1.4.4.3.3.cmml" xref="S3.p4.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.p4.1.m1.4.4.3.3.1.cmml" xref="S3.p4.1.m1.4.4.3.3">superscript</csymbol><ci id="S3.p4.1.m1.4.4.3.3.2.cmml" xref="S3.p4.1.m1.4.4.3.3.2">𝑇</ci><apply id="S3.p4.1.m1.4.4.3.3.3.cmml" xref="S3.p4.1.m1.4.4.3.3.3"><minus id="S3.p4.1.m1.4.4.3.3.3.1.cmml" xref="S3.p4.1.m1.4.4.3.3.3.1"></minus><ci id="S3.p4.1.m1.4.4.3.3.3.2.cmml" xref="S3.p4.1.m1.4.4.3.3.3.2">𝑡</ci><cn type="integer" id="S3.p4.1.m1.4.4.3.3.3.3.cmml" xref="S3.p4.1.m1.4.4.3.3.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.4c">\{T^{1},T^{2},...,T^{t-1}\}</annotation></semantics></math> after learning a new task <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="T^{t}" display="inline"><semantics id="S3.p4.2.m2.1a"><msup id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">T</mi><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑇</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">T^{t}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we describe our novel approach called HePCo (<span id="S4.p1.1.1" class="ltx_text ltx_font_bold">H</span>eterogenous <span id="S4.p1.1.2" class="ltx_text ltx_font_bold">P</span>rompt <span id="S4.p1.1.3" class="ltx_text ltx_font_bold">Co</span>nsolidation) which tackles forgetting and heterogeneity using a data-free distillation strategy applied in the model’s latent space. Knowing the limitations of FedAvg under non-IID data partitioning, we propose to fine-tune the global model at server side by distilling knowledge from the accumulated client models. However, unlike prior CFL works, we first propose to leverage the current state of art <span id="S4.p1.1.4" class="ltx_text ltx_font_italic">prompting methods</span> in continual learning. Such methods optimize learnable parameters that augment the input to a transformer model (prompt tuning) or its underlying attention mechanism (prefix tuning). These methods have been shown to obtain strong performance without requiring rehearsal. More importantly, applying prompting schemes at the client level can combat inter-task forgetting because such prompts do not destroy information in the frozen model’s weights. As a result, prompts provide privacy-preserving information that can be combined at the server in a more effective manner.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Despite these advantages, there is a key challenge in applying prompting to the CFL setting: It is not obvious how the server should <span id="S4.p2.1.1" class="ltx_text ltx_font_italic">combine</span> prompts learned by the individual clients on subsets of the categories within a task. Naively performing weight averaging performs poorly (as we show in Sec. <a href="#S5" title="5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) and simply maintaining a growing prompt pool scales poorly with the number of clients. Our key novelty is therefore to propose a lightweight <span id="S4.p2.1.2" class="ltx_text ltx_font_italic">distillation method</span>, performed in the latent-space of the model, which greatly mitigates intra-task and inter-task forgetting. Crucially, rather than combining different client prompts, we perform distillation of these prompts in a data-free manner by <span id="S4.p2.1.3" class="ltx_text ltx_font_italic">generating pseudo-data</span>. Importantly, the generation and distillation operations are computationally inexpensive as they are carried out in the latent space of the model. This design prioritizes privacy and efficiency, which are crucial for federated learning. In summary, in our method communication between clients and the server is low, the information is effectively distilled, and the method achieves state-of-art performance. Below we detail or method and depict it in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Background: L2P ‣ 4 Method ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Background: L2P</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.10" class="ltx_p">L2P (Learning to Prompt) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> is a continual learning method that learns a set of model embeddings (prompts) that can be dynamically inserted into a pretrained vision transformer. (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. Prompts hold task-specific information that instructs the model to solve corresponding tasks. L2P maintains a prompt pool <math id="S4.SS1.p1.1.m1.4" class="ltx_Math" alttext="P=\{P_{1},P_{2},\cdot\cdot\cdot,P_{M}\}" display="inline"><semantics id="S4.SS1.p1.1.m1.4a"><mrow id="S4.SS1.p1.1.m1.4.4" xref="S4.SS1.p1.1.m1.4.4.cmml"><mi id="S4.SS1.p1.1.m1.4.4.5" xref="S4.SS1.p1.1.m1.4.4.5.cmml">P</mi><mo id="S4.SS1.p1.1.m1.4.4.4" xref="S4.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.1.m1.4.4.3.3" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.4.4.3.3.4" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S4.SS1.p1.1.m1.2.2.1.1.1" xref="S4.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.2.2.1.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.cmml">P</mi><mn id="S4.SS1.p1.1.m1.2.2.1.1.1.3" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.1.m1.4.4.3.3.5" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.1.m1.3.3.2.2.2" xref="S4.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.1.m1.3.3.2.2.2.2" xref="S4.SS1.p1.1.m1.3.3.2.2.2.2.cmml">P</mi><mn id="S4.SS1.p1.1.m1.3.3.2.2.2.3" xref="S4.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.1.m1.4.4.3.3.6" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="S4.SS1.p1.1.m1.4.4.3.3.7" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.1.m1.4.4.3.3.3" xref="S4.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.1.m1.4.4.3.3.3.2" xref="S4.SS1.p1.1.m1.4.4.3.3.3.2.cmml">P</mi><mi id="S4.SS1.p1.1.m1.4.4.3.3.3.3" xref="S4.SS1.p1.1.m1.4.4.3.3.3.3.cmml">M</mi></msub><mo stretchy="false" id="S4.SS1.p1.1.m1.4.4.3.3.8" xref="S4.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.4b"><apply id="S4.SS1.p1.1.m1.4.4.cmml" xref="S4.SS1.p1.1.m1.4.4"><eq id="S4.SS1.p1.1.m1.4.4.4.cmml" xref="S4.SS1.p1.1.m1.4.4.4"></eq><ci id="S4.SS1.p1.1.m1.4.4.5.cmml" xref="S4.SS1.p1.1.m1.4.4.5">𝑃</ci><set id="S4.SS1.p1.1.m1.4.4.3.4.cmml" xref="S4.SS1.p1.1.m1.4.4.3.3"><apply id="S4.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2">𝑃</ci><cn type="integer" id="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.2.2">𝑃</ci><cn type="integer" id="S4.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">⋯</ci><apply id="S4.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S4.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.1.m1.4.4.3.3.3.2">𝑃</ci><ci id="S4.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.4c">P=\{P_{1},P_{2},\cdot\cdot\cdot,P_{M}\}</annotation></semantics></math> of size M, where <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="P_{i}\in\mathbb{R}^{L_{p}\times D}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">P</mi><mi id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml"><msub id="S4.SS1.p1.2.m2.1.1.3.3.2" xref="S4.SS1.p1.2.m2.1.1.3.3.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.3.2.2" xref="S4.SS1.p1.2.m2.1.1.3.3.2.2.cmml">L</mi><mi id="S4.SS1.p1.2.m2.1.1.3.3.2.3" xref="S4.SS1.p1.2.m2.1.1.3.3.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.2.m2.1.1.3.3.1" xref="S4.SS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.2.m2.1.1.3.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><in id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></in><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑃</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3"><times id="S4.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.1"></times><apply id="S4.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2.2">𝐿</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.2.3">𝑝</ci></apply><ci id="S4.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">P_{i}\in\mathbb{R}^{L_{p}\times D}</annotation></semantics></math> are prompt parameters with <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="L_{p}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">L</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝐿</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">L_{p}</annotation></semantics></math> as the prompt length (chosen as a hyperparameter) and <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">D</annotation></semantics></math> the embedding dimension. Each prompt <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">P</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑃</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">P_{i}</annotation></semantics></math> has an associated key <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="k_{i}\in\mathbb{R^{D}}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><msub id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">k</mi><mi id="S4.SS1.p1.6.m6.1.1.2.3" xref="S4.SS1.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml"><mi id="S4.SS1.p1.6.m6.1.1.3.2" xref="S4.SS1.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p1.6.m6.1.1.3.3" xref="S4.SS1.p1.6.m6.1.1.3.3.cmml">𝔻</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><in id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></in><apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">𝑘</ci><ci id="S4.SS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2">ℝ</ci><ci id="S4.SS1.p1.6.m6.1.1.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3">𝔻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">k_{i}\in\mathbb{R^{D}}</annotation></semantics></math>. An input image <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">x</annotation></semantics></math> is converted into a visual query <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="q(x)\in\mathbb{R^{D}}" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mrow id="S4.SS1.p1.8.m8.1.2" xref="S4.SS1.p1.8.m8.1.2.cmml"><mrow id="S4.SS1.p1.8.m8.1.2.2" xref="S4.SS1.p1.8.m8.1.2.2.cmml"><mi id="S4.SS1.p1.8.m8.1.2.2.2" xref="S4.SS1.p1.8.m8.1.2.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.1.2.2.1" xref="S4.SS1.p1.8.m8.1.2.2.1.cmml">​</mo><mrow id="S4.SS1.p1.8.m8.1.2.2.3.2" xref="S4.SS1.p1.8.m8.1.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.2.3.2.1" xref="S4.SS1.p1.8.m8.1.2.2.cmml">(</mo><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.2.3.2.2" xref="S4.SS1.p1.8.m8.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.8.m8.1.2.1" xref="S4.SS1.p1.8.m8.1.2.1.cmml">∈</mo><msup id="S4.SS1.p1.8.m8.1.2.3" xref="S4.SS1.p1.8.m8.1.2.3.cmml"><mi id="S4.SS1.p1.8.m8.1.2.3.2" xref="S4.SS1.p1.8.m8.1.2.3.2.cmml">ℝ</mi><mi id="S4.SS1.p1.8.m8.1.2.3.3" xref="S4.SS1.p1.8.m8.1.2.3.3.cmml">𝔻</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.2.cmml" xref="S4.SS1.p1.8.m8.1.2"><in id="S4.SS1.p1.8.m8.1.2.1.cmml" xref="S4.SS1.p1.8.m8.1.2.1"></in><apply id="S4.SS1.p1.8.m8.1.2.2.cmml" xref="S4.SS1.p1.8.m8.1.2.2"><times id="S4.SS1.p1.8.m8.1.2.2.1.cmml" xref="S4.SS1.p1.8.m8.1.2.2.1"></times><ci id="S4.SS1.p1.8.m8.1.2.2.2.cmml" xref="S4.SS1.p1.8.m8.1.2.2.2">𝑞</ci><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝑥</ci></apply><apply id="S4.SS1.p1.8.m8.1.2.3.cmml" xref="S4.SS1.p1.8.m8.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.2.3.1.cmml" xref="S4.SS1.p1.8.m8.1.2.3">superscript</csymbol><ci id="S4.SS1.p1.8.m8.1.2.3.2.cmml" xref="S4.SS1.p1.8.m8.1.2.3.2">ℝ</ci><ci id="S4.SS1.p1.8.m8.1.2.3.3.cmml" xref="S4.SS1.p1.8.m8.1.2.3.3">𝔻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">q(x)\in\mathbb{R^{D}}</annotation></semantics></math> by passing through the frozen vision transformer encoder <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\theta_{pt}" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><msub id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">θ</mi><mrow id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml"><mi id="S4.SS1.p1.9.m9.1.1.3.2" xref="S4.SS1.p1.9.m9.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m9.1.1.3.1" xref="S4.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.9.m9.1.1.3.3" xref="S4.SS1.p1.9.m9.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">𝜃</ci><apply id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3"><times id="S4.SS1.p1.9.m9.1.1.3.1.cmml" xref="S4.SS1.p1.9.m9.1.1.3.1"></times><ci id="S4.SS1.p1.9.m9.1.1.3.2.cmml" xref="S4.SS1.p1.9.m9.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.9.m9.1.1.3.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\theta_{pt}</annotation></semantics></math>. Prompts are selected from the pool by measuring the cosine similarity between associated keys and the visual query. Top <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mi id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">N</annotation></semantics></math> prompts that have the highest key-query similarity are chosen to be inserted into the transformer. Here, the ViT encoder is frozen and the prompts and keys are learned using two separate optimization losses.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2306.09970/assets/figures/source/method.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="503" height="291" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text" style="font-size:90%;">Latent generation and distillation with underlying <span id="S4.F2.4.2.1" class="ltx_text ltx_font_italic">decomposed prompting</span> scheme.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Client Side : Decomposed Prompting</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">While L2P is very successful in protecting against forgetting, its performance is restrained by certain design choices. We therefore adopt key changes inspired by prior work noting this <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, including for our baselines, resulting in better accuracy across the board. Specifically, rather than using discrete prompts that restrict capacity and introduces an additional hyperparameter (given by <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">N</annotation></semantics></math>), we form our final prompt <em id="S4.SS2.p1.2.1" class="ltx_emph ltx_font_bold ltx_font_italic">p</em> by taking sum of the prompts <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">P</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑃</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">P_{i}</annotation></semantics></math> weighted by the cosine scores.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In the federated learning setting, each client hosts the aforementioned prompting scheme and learns the key and prompt matrices along with the classifier in an end-to-end fashion while keeping the ViT backbone frozen. After learning the local task, in our method clients transfer the key, prompt weights along with the classifier weights to the server. By sending only a limited number of parameters to the server, the overall communication load is significantly reduced compared to sharing the entire model. As we are sharing only prompts and classifier weights, the exact client model cannot be replicated at the server side thereby preserving privacy of the client as it prevents local model inversion.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Server Side : Latent Generation</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.3" class="ltx_p">At the end of each round, the server receives <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\lvert C\rvert" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.2.2" xref="S4.SS3.p1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.2.2.1" xref="S4.SS3.p1.1.m1.1.2.1.1.cmml">|</mo><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">C</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.1.2.2.2" xref="S4.SS3.p1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2.2"><abs id="S4.SS3.p1.1.m1.1.2.1.1.cmml" xref="S4.SS3.p1.1.m1.1.2.2.1"></abs><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\lvert C\rvert</annotation></semantics></math> prompt and classifier weights collected from the active clients. First, we simply average these transmitted parameters to form intermediate server weights.
Let <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="w_{c}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">w</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑤</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">w_{c}</annotation></semantics></math> indicate a weight parameter that encompasses key, prompt and classifier weights. We obtain the intermediate server weights by <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="w_{avg}=\frac{1}{C}\sum_{c\in\emph{\small C}}w\textsubscript{c}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><msub id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.2.2.cmml">w</mi><mrow id="S4.SS3.p1.3.m3.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2.3.2" xref="S4.SS3.p1.3.m3.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.2.3.1" xref="S4.SS3.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.3.m3.1.1.2.3.3" xref="S4.SS3.p1.3.m3.1.1.2.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.2.3.1a" xref="S4.SS3.p1.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.3.m3.1.1.2.3.4" xref="S4.SS3.p1.3.m3.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mfrac id="S4.SS3.p1.3.m3.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml"><mn id="S4.SS3.p1.3.m3.1.1.3.2.2" xref="S4.SS3.p1.3.m3.1.1.3.2.2.cmml">1</mn><mi id="S4.SS3.p1.3.m3.1.1.3.2.3" xref="S4.SS3.p1.3.m3.1.1.3.2.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.3.1" xref="S4.SS3.p1.3.m3.1.1.3.1.cmml">​</mo><mrow id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml"><msub id="S4.SS3.p1.3.m3.1.1.3.3.1" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml"><mo id="S4.SS3.p1.3.m3.1.1.3.3.1.2" xref="S4.SS3.p1.3.m3.1.1.3.3.1.2.cmml">∑</mo><mrow id="S4.SS3.p1.3.m3.1.1.3.3.1.3" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.3.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.3.m3.1.1.3.3.1.3.1" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.1.cmml">∈</mo><mtext class="ltx_mathvariant_italic" mathsize="128%" id="S4.SS3.p1.3.m3.1.1.3.3.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.3b.cmml"><em id="S4.SS3.p1.3.m3.1.1.3.3.1.3.3.1nest" class="ltx_emph ltx_font_italic" style="font-size:90%;">C</em></mtext></mrow></msub><mrow id="S4.SS3.p1.3.m3.1.1.3.3.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.3.2.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.3.3.2.1" xref="S4.SS3.p1.3.m3.1.1.3.3.2.1.cmml">​</mo><mtext id="S4.SS3.p1.3.m3.1.1.3.3.2.3" xref="S4.SS3.p1.3.m3.1.1.3.3.2.3b.cmml"><sub id="S4.SS3.p1.3.m3.1.1.3.3.2.3.1nest" class="ltx_sub">c</sub></mtext></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><eq id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></eq><apply id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.2">𝑤</ci><apply id="S4.SS3.p1.3.m3.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3"><times id="S4.SS3.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3.1"></times><ci id="S4.SS3.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3.2">𝑎</ci><ci id="S4.SS3.p1.3.m3.1.1.2.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3.3">𝑣</ci><ci id="S4.SS3.p1.3.m3.1.1.2.3.4.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><times id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.1"></times><apply id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2"><divide id="S4.SS3.p1.3.m3.1.1.3.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2"></divide><cn type="integer" id="S4.SS3.p1.3.m3.1.1.3.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2.2">1</cn><ci id="S4.SS3.p1.3.m3.1.1.3.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2.3">𝐶</ci></apply><apply id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3"><apply id="S4.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.3.3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1">subscript</csymbol><sum id="S4.SS3.p1.3.m3.1.1.3.3.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.2"></sum><apply id="S4.SS3.p1.3.m3.1.1.3.3.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3"><in id="S4.SS3.p1.3.m3.1.1.3.3.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.1"></in><ci id="S4.SS3.p1.3.m3.1.1.3.3.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.2">𝑐</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.1.3.3b.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.3"><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S4.SS3.p1.3.m3.1.1.3.3.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1.3.3"><em id="S4.SS3.p1.3.m3.1.1.3.3.1.3.3.1anest" class="ltx_emph ltx_font_italic" style="font-size:90%;">C</em></mtext></ci></apply></apply><apply id="S4.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2"><times id="S4.SS3.p1.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.1"></times><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.2">𝑤</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.3b.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.3"><mtext id="S4.SS3.p1.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2.3"><sub id="S4.SS3.p1.3.m3.1.1.3.3.2.3.1anest" class="ltx_sub">c</sub></mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">w_{avg}=\frac{1}{C}\sum_{c\in\emph{\small C}}w\textsubscript{c}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.6" class="ltx_p">Due to data heterogeneity, the local model weights diverge which upon averaging degrade the performance of the intermediate server model. We therefore propose to fine-tune the server model using data-free distillation in the latent space to retain the performance of the client models. We generate pseudo data in the latent space of the <span id="S4.SS3.p2.6.1" class="ltx_text ltx_font_italic">image query</span> (used in prompting) which is the <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">D</annotation></semantics></math> dimensional output space of visual encoder.
The pseudo-data generated in this space
allows us to fine-tune both the classifier and the key-prompt weights. We use a lightweight feedforward neural network as our conditional generator with a <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">D</annotation></semantics></math> dimensional output. This generator takes as input a class label (from categories in current task <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">t</annotation></semantics></math>)and a noise vector of dimension <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="D_{noise}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msub id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">D</mi><mrow id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.2" xref="S4.SS3.p2.4.m4.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.3.1" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m4.1.1.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.3.1a" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m4.1.1.3.4" xref="S4.SS3.p2.4.m4.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.3.1b" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m4.1.1.3.5" xref="S4.SS3.p2.4.m4.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.3.1c" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m4.1.1.3.6" xref="S4.SS3.p2.4.m4.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝐷</ci><apply id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"><times id="S4.SS3.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.1"></times><ci id="S4.SS3.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.2">𝑛</ci><ci id="S4.SS3.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3">𝑜</ci><ci id="S4.SS3.p2.4.m4.1.1.3.4.cmml" xref="S4.SS3.p2.4.m4.1.1.3.4">𝑖</ci><ci id="S4.SS3.p2.4.m4.1.1.3.5.cmml" xref="S4.SS3.p2.4.m4.1.1.3.5">𝑠</ci><ci id="S4.SS3.p2.4.m4.1.1.3.6.cmml" xref="S4.SS3.p2.4.m4.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">D_{noise}</annotation></semantics></math> sampled from the standard normal distribution <math id="S4.SS3.p2.5.m5.2" class="ltx_Math" alttext="\mathcal{N}(\mathbf{0},\mathbf{1})" display="inline"><semantics id="S4.SS3.p2.5.m5.2a"><mrow id="S4.SS3.p2.5.m5.2.3" xref="S4.SS3.p2.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.5.m5.2.3.2" xref="S4.SS3.p2.5.m5.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.5.m5.2.3.1" xref="S4.SS3.p2.5.m5.2.3.1.cmml">​</mo><mrow id="S4.SS3.p2.5.m5.2.3.3.2" xref="S4.SS3.p2.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.5.m5.2.3.3.2.1" xref="S4.SS3.p2.5.m5.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">𝟎</mn><mo id="S4.SS3.p2.5.m5.2.3.3.2.2" xref="S4.SS3.p2.5.m5.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p2.5.m5.2.2" xref="S4.SS3.p2.5.m5.2.2.cmml">𝟏</mn><mo stretchy="false" id="S4.SS3.p2.5.m5.2.3.3.2.3" xref="S4.SS3.p2.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.2b"><apply id="S4.SS3.p2.5.m5.2.3.cmml" xref="S4.SS3.p2.5.m5.2.3"><times id="S4.SS3.p2.5.m5.2.3.1.cmml" xref="S4.SS3.p2.5.m5.2.3.1"></times><ci id="S4.SS3.p2.5.m5.2.3.2.cmml" xref="S4.SS3.p2.5.m5.2.3.2">𝒩</ci><interval closure="open" id="S4.SS3.p2.5.m5.2.3.3.1.cmml" xref="S4.SS3.p2.5.m5.2.3.3.2"><cn type="integer" id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">0</cn><cn type="integer" id="S4.SS3.p2.5.m5.2.2.cmml" xref="S4.SS3.p2.5.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.2c">\mathcal{N}(\mathbf{0},\mathbf{1})</annotation></semantics></math>. We encode the class label using an embedding layer and concatenate the obtained class embedding with the noise vector to form the input of the generator. From the generator, we obtain a pseudo latent of dimension <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">D</annotation></semantics></math> conditioned on the class label as follows:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.3" class="ltx_Math" alttext="\small z=G(\epsilon,y;\theta_{gen})," display="block"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml">z</mi><mo mathsize="90%" id="S4.E1.m1.3.3.1.1.2" xref="S4.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">ϵ</mi><mo mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">,</mo><mi mathsize="90%" id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">y</mi><mo mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.4" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">;</mo><msub id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1a" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.1.3.4" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="S4.E1.m1.3.3.1.1.1.1.1.5" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S4.E1.m1.3.3.1.2" xref="S4.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1"><eq id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2"></eq><ci id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3">𝑧</ci><apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.3">𝐺</ci><vector id="S4.E1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">italic-ϵ</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑦</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2">𝜃</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.4.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\small z=G(\epsilon,y;\theta_{gen}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.8" class="ltx_p">where <math id="S4.SS3.p2.7.m1.1" class="ltx_Math" alttext="z\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS3.p2.7.m1.1a"><mrow id="S4.SS3.p2.7.m1.1.1" xref="S4.SS3.p2.7.m1.1.1.cmml"><mi id="S4.SS3.p2.7.m1.1.1.2" xref="S4.SS3.p2.7.m1.1.1.2.cmml">z</mi><mo id="S4.SS3.p2.7.m1.1.1.1" xref="S4.SS3.p2.7.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.7.m1.1.1.3" xref="S4.SS3.p2.7.m1.1.1.3.cmml"><mi id="S4.SS3.p2.7.m1.1.1.3.2" xref="S4.SS3.p2.7.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.p2.7.m1.1.1.3.3" xref="S4.SS3.p2.7.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m1.1b"><apply id="S4.SS3.p2.7.m1.1.1.cmml" xref="S4.SS3.p2.7.m1.1.1"><in id="S4.SS3.p2.7.m1.1.1.1.cmml" xref="S4.SS3.p2.7.m1.1.1.1"></in><ci id="S4.SS3.p2.7.m1.1.1.2.cmml" xref="S4.SS3.p2.7.m1.1.1.2">𝑧</ci><apply id="S4.SS3.p2.7.m1.1.1.3.cmml" xref="S4.SS3.p2.7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m1.1.1.3.1.cmml" xref="S4.SS3.p2.7.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.7.m1.1.1.3.2.cmml" xref="S4.SS3.p2.7.m1.1.1.3.2">ℝ</ci><ci id="S4.SS3.p2.7.m1.1.1.3.3.cmml" xref="S4.SS3.p2.7.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m1.1c">z\in\mathbb{R}^{D}</annotation></semantics></math> is the generated pseudo latent and <math id="S4.SS3.p2.8.m2.2" class="ltx_Math" alttext="\epsilon\in\mathbb{R}^{D_{noise}}\sim\mathcal{N}(\mathbf{0},\mathbf{1})" display="inline"><semantics id="S4.SS3.p2.8.m2.2a"><mrow id="S4.SS3.p2.8.m2.2.3" xref="S4.SS3.p2.8.m2.2.3.cmml"><mi id="S4.SS3.p2.8.m2.2.3.2" xref="S4.SS3.p2.8.m2.2.3.2.cmml">ϵ</mi><mo id="S4.SS3.p2.8.m2.2.3.3" xref="S4.SS3.p2.8.m2.2.3.3.cmml">∈</mo><msup id="S4.SS3.p2.8.m2.2.3.4" xref="S4.SS3.p2.8.m2.2.3.4.cmml"><mi id="S4.SS3.p2.8.m2.2.3.4.2" xref="S4.SS3.p2.8.m2.2.3.4.2.cmml">ℝ</mi><msub id="S4.SS3.p2.8.m2.2.3.4.3" xref="S4.SS3.p2.8.m2.2.3.4.3.cmml"><mi id="S4.SS3.p2.8.m2.2.3.4.3.2" xref="S4.SS3.p2.8.m2.2.3.4.3.2.cmml">D</mi><mrow id="S4.SS3.p2.8.m2.2.3.4.3.3" xref="S4.SS3.p2.8.m2.2.3.4.3.3.cmml"><mi id="S4.SS3.p2.8.m2.2.3.4.3.3.2" xref="S4.SS3.p2.8.m2.2.3.4.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.8.m2.2.3.4.3.3.1" xref="S4.SS3.p2.8.m2.2.3.4.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.8.m2.2.3.4.3.3.3" xref="S4.SS3.p2.8.m2.2.3.4.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.8.m2.2.3.4.3.3.1a" xref="S4.SS3.p2.8.m2.2.3.4.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.8.m2.2.3.4.3.3.4" xref="S4.SS3.p2.8.m2.2.3.4.3.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.8.m2.2.3.4.3.3.1b" xref="S4.SS3.p2.8.m2.2.3.4.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.8.m2.2.3.4.3.3.5" xref="S4.SS3.p2.8.m2.2.3.4.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.8.m2.2.3.4.3.3.1c" xref="S4.SS3.p2.8.m2.2.3.4.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.8.m2.2.3.4.3.3.6" xref="S4.SS3.p2.8.m2.2.3.4.3.3.6.cmml">e</mi></mrow></msub></msup><mo id="S4.SS3.p2.8.m2.2.3.5" xref="S4.SS3.p2.8.m2.2.3.5.cmml">∼</mo><mrow id="S4.SS3.p2.8.m2.2.3.6" xref="S4.SS3.p2.8.m2.2.3.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.8.m2.2.3.6.2" xref="S4.SS3.p2.8.m2.2.3.6.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.8.m2.2.3.6.1" xref="S4.SS3.p2.8.m2.2.3.6.1.cmml">​</mo><mrow id="S4.SS3.p2.8.m2.2.3.6.3.2" xref="S4.SS3.p2.8.m2.2.3.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.8.m2.2.3.6.3.2.1" xref="S4.SS3.p2.8.m2.2.3.6.3.1.cmml">(</mo><mn id="S4.SS3.p2.8.m2.1.1" xref="S4.SS3.p2.8.m2.1.1.cmml">𝟎</mn><mo id="S4.SS3.p2.8.m2.2.3.6.3.2.2" xref="S4.SS3.p2.8.m2.2.3.6.3.1.cmml">,</mo><mn id="S4.SS3.p2.8.m2.2.2" xref="S4.SS3.p2.8.m2.2.2.cmml">𝟏</mn><mo stretchy="false" id="S4.SS3.p2.8.m2.2.3.6.3.2.3" xref="S4.SS3.p2.8.m2.2.3.6.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m2.2b"><apply id="S4.SS3.p2.8.m2.2.3.cmml" xref="S4.SS3.p2.8.m2.2.3"><and id="S4.SS3.p2.8.m2.2.3a.cmml" xref="S4.SS3.p2.8.m2.2.3"></and><apply id="S4.SS3.p2.8.m2.2.3b.cmml" xref="S4.SS3.p2.8.m2.2.3"><in id="S4.SS3.p2.8.m2.2.3.3.cmml" xref="S4.SS3.p2.8.m2.2.3.3"></in><ci id="S4.SS3.p2.8.m2.2.3.2.cmml" xref="S4.SS3.p2.8.m2.2.3.2">italic-ϵ</ci><apply id="S4.SS3.p2.8.m2.2.3.4.cmml" xref="S4.SS3.p2.8.m2.2.3.4"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m2.2.3.4.1.cmml" xref="S4.SS3.p2.8.m2.2.3.4">superscript</csymbol><ci id="S4.SS3.p2.8.m2.2.3.4.2.cmml" xref="S4.SS3.p2.8.m2.2.3.4.2">ℝ</ci><apply id="S4.SS3.p2.8.m2.2.3.4.3.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m2.2.3.4.3.1.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3">subscript</csymbol><ci id="S4.SS3.p2.8.m2.2.3.4.3.2.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.2">𝐷</ci><apply id="S4.SS3.p2.8.m2.2.3.4.3.3.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3"><times id="S4.SS3.p2.8.m2.2.3.4.3.3.1.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.1"></times><ci id="S4.SS3.p2.8.m2.2.3.4.3.3.2.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.2">𝑛</ci><ci id="S4.SS3.p2.8.m2.2.3.4.3.3.3.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.3">𝑜</ci><ci id="S4.SS3.p2.8.m2.2.3.4.3.3.4.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.4">𝑖</ci><ci id="S4.SS3.p2.8.m2.2.3.4.3.3.5.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.5">𝑠</ci><ci id="S4.SS3.p2.8.m2.2.3.4.3.3.6.cmml" xref="S4.SS3.p2.8.m2.2.3.4.3.3.6">𝑒</ci></apply></apply></apply></apply><apply id="S4.SS3.p2.8.m2.2.3c.cmml" xref="S4.SS3.p2.8.m2.2.3"><csymbol cd="latexml" id="S4.SS3.p2.8.m2.2.3.5.cmml" xref="S4.SS3.p2.8.m2.2.3.5">similar-to</csymbol><share href="#S4.SS3.p2.8.m2.2.3.4.cmml" id="S4.SS3.p2.8.m2.2.3d.cmml" xref="S4.SS3.p2.8.m2.2.3"></share><apply id="S4.SS3.p2.8.m2.2.3.6.cmml" xref="S4.SS3.p2.8.m2.2.3.6"><times id="S4.SS3.p2.8.m2.2.3.6.1.cmml" xref="S4.SS3.p2.8.m2.2.3.6.1"></times><ci id="S4.SS3.p2.8.m2.2.3.6.2.cmml" xref="S4.SS3.p2.8.m2.2.3.6.2">𝒩</ci><interval closure="open" id="S4.SS3.p2.8.m2.2.3.6.3.1.cmml" xref="S4.SS3.p2.8.m2.2.3.6.3.2"><cn type="integer" id="S4.SS3.p2.8.m2.1.1.cmml" xref="S4.SS3.p2.8.m2.1.1">0</cn><cn type="integer" id="S4.SS3.p2.8.m2.2.2.cmml" xref="S4.SS3.p2.8.m2.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m2.2c">\epsilon\in\mathbb{R}^{D_{noise}}\sim\mathcal{N}(\mathbf{0},\mathbf{1})</annotation></semantics></math> is the noise vector. For effective knowledge distillation, pseudo data should conform to the latent space of the client models. We optimize for a classification loss which is a weighted sum of classification losses for each individual client, similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. The total classification loss can be given as:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.7" class="ltx_Math" alttext="\small\mathcal{L}_{cls}=\sum_{c\in C}\alpha_{r,t}^{c,y}\mathcal{L}_{cls}^{c}\quad\text{where}\quad\mathcal{L}_{cls}^{c}=\mathcal{L}_{CE}(\phi(z;w_{c}),y)" display="block"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7.7" xref="S4.E2.m1.7.7.cmml"><msub id="S4.E2.m1.7.7.3" xref="S4.E2.m1.7.7.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E2.m1.7.7.3.2" xref="S4.E2.m1.7.7.3.2.cmml">ℒ</mi><mrow id="S4.E2.m1.7.7.3.3" xref="S4.E2.m1.7.7.3.3.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.3.3.2" xref="S4.E2.m1.7.7.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.3.3.1" xref="S4.E2.m1.7.7.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.3.3.3" xref="S4.E2.m1.7.7.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.3.3.1a" xref="S4.E2.m1.7.7.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.3.3.4" xref="S4.E2.m1.7.7.3.3.4.cmml">s</mi></mrow></msub><mo mathsize="90%" rspace="0.111em" id="S4.E2.m1.7.7.4" xref="S4.E2.m1.7.7.4.cmml">=</mo><mrow id="S4.E2.m1.7.7.5" xref="S4.E2.m1.7.7.5.cmml"><munder id="S4.E2.m1.7.7.5.1" xref="S4.E2.m1.7.7.5.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E2.m1.7.7.5.1.2" xref="S4.E2.m1.7.7.5.1.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.5.1.3" xref="S4.E2.m1.7.7.5.1.3.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.5.1.3.2" xref="S4.E2.m1.7.7.5.1.3.2.cmml">c</mi><mo mathsize="90%" id="S4.E2.m1.7.7.5.1.3.1" xref="S4.E2.m1.7.7.5.1.3.1.cmml">∈</mo><mi mathsize="90%" id="S4.E2.m1.7.7.5.1.3.3" xref="S4.E2.m1.7.7.5.1.3.3.cmml">C</mi></mrow></munder><mrow id="S4.E2.m1.7.7.5.2" xref="S4.E2.m1.7.7.5.2.cmml"><msubsup id="S4.E2.m1.7.7.5.2.2" xref="S4.E2.m1.7.7.5.2.2.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.2.2.2" xref="S4.E2.m1.7.7.5.2.2.2.2.cmml">α</mi><mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">r</mi><mo mathsize="90%" id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">t</mi></mrow><mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.3.cmml"><mi mathsize="90%" id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">c</mi><mo mathsize="90%" id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml">y</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.1" xref="S4.E2.m1.7.7.5.2.1.cmml">​</mo><msubsup id="S4.E2.m1.7.7.5.2.3" xref="S4.E2.m1.7.7.5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E2.m1.7.7.5.2.3.2.2" xref="S4.E2.m1.7.7.5.2.3.2.2.cmml">ℒ</mi><mrow id="S4.E2.m1.7.7.5.2.3.2.3" xref="S4.E2.m1.7.7.5.2.3.2.3.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.3.2.3.2" xref="S4.E2.m1.7.7.5.2.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.3.2.3.1" xref="S4.E2.m1.7.7.5.2.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.3.2.3.3" xref="S4.E2.m1.7.7.5.2.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.3.2.3.1a" xref="S4.E2.m1.7.7.5.2.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.3.2.3.4" xref="S4.E2.m1.7.7.5.2.3.2.3.4.cmml">s</mi></mrow><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.3.3" xref="S4.E2.m1.7.7.5.2.3.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.1a" xref="S4.E2.m1.7.7.5.2.1.cmml">​</mo><mtext mathsize="90%" id="S4.E2.m1.7.7.5.2.4" xref="S4.E2.m1.7.7.5.2.4a.cmml">where</mtext><mo lspace="0.900em" rspace="0em" id="S4.E2.m1.7.7.5.2.1b" xref="S4.E2.m1.7.7.5.2.1.cmml">​</mo><msubsup id="S4.E2.m1.7.7.5.2.5" xref="S4.E2.m1.7.7.5.2.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E2.m1.7.7.5.2.5.2.2" xref="S4.E2.m1.7.7.5.2.5.2.2.cmml">ℒ</mi><mrow id="S4.E2.m1.7.7.5.2.5.2.3" xref="S4.E2.m1.7.7.5.2.5.2.3.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.5.2.3.2" xref="S4.E2.m1.7.7.5.2.5.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.5.2.3.1" xref="S4.E2.m1.7.7.5.2.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.5.2.3.3" xref="S4.E2.m1.7.7.5.2.5.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.5.2.5.2.3.1a" xref="S4.E2.m1.7.7.5.2.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.5.2.3.4" xref="S4.E2.m1.7.7.5.2.5.2.3.4.cmml">s</mi></mrow><mi mathsize="90%" id="S4.E2.m1.7.7.5.2.5.3" xref="S4.E2.m1.7.7.5.2.5.3.cmml">c</mi></msubsup></mrow></mrow><mo mathsize="90%" id="S4.E2.m1.7.7.6" xref="S4.E2.m1.7.7.6.cmml">=</mo><mrow id="S4.E2.m1.7.7.1" xref="S4.E2.m1.7.7.1.cmml"><msub id="S4.E2.m1.7.7.1.3" xref="S4.E2.m1.7.7.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E2.m1.7.7.1.3.2" xref="S4.E2.m1.7.7.1.3.2.cmml">ℒ</mi><mrow id="S4.E2.m1.7.7.1.3.3" xref="S4.E2.m1.7.7.1.3.3.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.1.3.3.2" xref="S4.E2.m1.7.7.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.3.3.1" xref="S4.E2.m1.7.7.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E2.m1.7.7.1.3.3.3" xref="S4.E2.m1.7.7.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.2" xref="S4.E2.m1.7.7.1.2.cmml">​</mo><mrow id="S4.E2.m1.7.7.1.1.1" xref="S4.E2.m1.7.7.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E2.m1.7.7.1.1.1.2" xref="S4.E2.m1.7.7.1.1.2.cmml">(</mo><mrow id="S4.E2.m1.7.7.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E2.m1.7.7.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">z</mi><mo mathsize="90%" id="S4.E2.m1.7.7.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E2.m1.7.7.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml">w</mi><mi mathsize="90%" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E2.m1.7.7.1.1.1.1.1.1.4" xref="S4.E2.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E2.m1.7.7.1.1.1.3" xref="S4.E2.m1.7.7.1.1.2.cmml">,</mo><mi mathsize="90%" id="S4.E2.m1.6.6" xref="S4.E2.m1.6.6.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S4.E2.m1.7.7.1.1.1.4" xref="S4.E2.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b"><apply id="S4.E2.m1.7.7.cmml" xref="S4.E2.m1.7.7"><and id="S4.E2.m1.7.7a.cmml" xref="S4.E2.m1.7.7"></and><apply id="S4.E2.m1.7.7b.cmml" xref="S4.E2.m1.7.7"><eq id="S4.E2.m1.7.7.4.cmml" xref="S4.E2.m1.7.7.4"></eq><apply id="S4.E2.m1.7.7.3.cmml" xref="S4.E2.m1.7.7.3"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.3.1.cmml" xref="S4.E2.m1.7.7.3">subscript</csymbol><ci id="S4.E2.m1.7.7.3.2.cmml" xref="S4.E2.m1.7.7.3.2">ℒ</ci><apply id="S4.E2.m1.7.7.3.3.cmml" xref="S4.E2.m1.7.7.3.3"><times id="S4.E2.m1.7.7.3.3.1.cmml" xref="S4.E2.m1.7.7.3.3.1"></times><ci id="S4.E2.m1.7.7.3.3.2.cmml" xref="S4.E2.m1.7.7.3.3.2">𝑐</ci><ci id="S4.E2.m1.7.7.3.3.3.cmml" xref="S4.E2.m1.7.7.3.3.3">𝑙</ci><ci id="S4.E2.m1.7.7.3.3.4.cmml" xref="S4.E2.m1.7.7.3.3.4">𝑠</ci></apply></apply><apply id="S4.E2.m1.7.7.5.cmml" xref="S4.E2.m1.7.7.5"><apply id="S4.E2.m1.7.7.5.1.cmml" xref="S4.E2.m1.7.7.5.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.1.1.cmml" xref="S4.E2.m1.7.7.5.1">subscript</csymbol><sum id="S4.E2.m1.7.7.5.1.2.cmml" xref="S4.E2.m1.7.7.5.1.2"></sum><apply id="S4.E2.m1.7.7.5.1.3.cmml" xref="S4.E2.m1.7.7.5.1.3"><in id="S4.E2.m1.7.7.5.1.3.1.cmml" xref="S4.E2.m1.7.7.5.1.3.1"></in><ci id="S4.E2.m1.7.7.5.1.3.2.cmml" xref="S4.E2.m1.7.7.5.1.3.2">𝑐</ci><ci id="S4.E2.m1.7.7.5.1.3.3.cmml" xref="S4.E2.m1.7.7.5.1.3.3">𝐶</ci></apply></apply><apply id="S4.E2.m1.7.7.5.2.cmml" xref="S4.E2.m1.7.7.5.2"><times id="S4.E2.m1.7.7.5.2.1.cmml" xref="S4.E2.m1.7.7.5.2.1"></times><apply id="S4.E2.m1.7.7.5.2.2.cmml" xref="S4.E2.m1.7.7.5.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.2.1.cmml" xref="S4.E2.m1.7.7.5.2.2">superscript</csymbol><apply id="S4.E2.m1.7.7.5.2.2.2.cmml" xref="S4.E2.m1.7.7.5.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.2.2.1.cmml" xref="S4.E2.m1.7.7.5.2.2">subscript</csymbol><ci id="S4.E2.m1.7.7.5.2.2.2.2.cmml" xref="S4.E2.m1.7.7.5.2.2.2.2">𝛼</ci><list id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑟</ci><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑡</ci></list></apply><list id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.4"><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝑐</ci><ci id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2">𝑦</ci></list></apply><apply id="S4.E2.m1.7.7.5.2.3.cmml" xref="S4.E2.m1.7.7.5.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.3.1.cmml" xref="S4.E2.m1.7.7.5.2.3">superscript</csymbol><apply id="S4.E2.m1.7.7.5.2.3.2.cmml" xref="S4.E2.m1.7.7.5.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.3.2.1.cmml" xref="S4.E2.m1.7.7.5.2.3">subscript</csymbol><ci id="S4.E2.m1.7.7.5.2.3.2.2.cmml" xref="S4.E2.m1.7.7.5.2.3.2.2">ℒ</ci><apply id="S4.E2.m1.7.7.5.2.3.2.3.cmml" xref="S4.E2.m1.7.7.5.2.3.2.3"><times id="S4.E2.m1.7.7.5.2.3.2.3.1.cmml" xref="S4.E2.m1.7.7.5.2.3.2.3.1"></times><ci id="S4.E2.m1.7.7.5.2.3.2.3.2.cmml" xref="S4.E2.m1.7.7.5.2.3.2.3.2">𝑐</ci><ci id="S4.E2.m1.7.7.5.2.3.2.3.3.cmml" xref="S4.E2.m1.7.7.5.2.3.2.3.3">𝑙</ci><ci id="S4.E2.m1.7.7.5.2.3.2.3.4.cmml" xref="S4.E2.m1.7.7.5.2.3.2.3.4">𝑠</ci></apply></apply><ci id="S4.E2.m1.7.7.5.2.3.3.cmml" xref="S4.E2.m1.7.7.5.2.3.3">𝑐</ci></apply><ci id="S4.E2.m1.7.7.5.2.4a.cmml" xref="S4.E2.m1.7.7.5.2.4"><mtext mathsize="90%" id="S4.E2.m1.7.7.5.2.4.cmml" xref="S4.E2.m1.7.7.5.2.4">where</mtext></ci><apply id="S4.E2.m1.7.7.5.2.5.cmml" xref="S4.E2.m1.7.7.5.2.5"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.5.1.cmml" xref="S4.E2.m1.7.7.5.2.5">superscript</csymbol><apply id="S4.E2.m1.7.7.5.2.5.2.cmml" xref="S4.E2.m1.7.7.5.2.5"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.5.2.5.2.1.cmml" xref="S4.E2.m1.7.7.5.2.5">subscript</csymbol><ci id="S4.E2.m1.7.7.5.2.5.2.2.cmml" xref="S4.E2.m1.7.7.5.2.5.2.2">ℒ</ci><apply id="S4.E2.m1.7.7.5.2.5.2.3.cmml" xref="S4.E2.m1.7.7.5.2.5.2.3"><times id="S4.E2.m1.7.7.5.2.5.2.3.1.cmml" xref="S4.E2.m1.7.7.5.2.5.2.3.1"></times><ci id="S4.E2.m1.7.7.5.2.5.2.3.2.cmml" xref="S4.E2.m1.7.7.5.2.5.2.3.2">𝑐</ci><ci id="S4.E2.m1.7.7.5.2.5.2.3.3.cmml" xref="S4.E2.m1.7.7.5.2.5.2.3.3">𝑙</ci><ci id="S4.E2.m1.7.7.5.2.5.2.3.4.cmml" xref="S4.E2.m1.7.7.5.2.5.2.3.4">𝑠</ci></apply></apply><ci id="S4.E2.m1.7.7.5.2.5.3.cmml" xref="S4.E2.m1.7.7.5.2.5.3">𝑐</ci></apply></apply></apply></apply><apply id="S4.E2.m1.7.7c.cmml" xref="S4.E2.m1.7.7"><eq id="S4.E2.m1.7.7.6.cmml" xref="S4.E2.m1.7.7.6"></eq><share href="#S4.E2.m1.7.7.5.cmml" id="S4.E2.m1.7.7d.cmml" xref="S4.E2.m1.7.7"></share><apply id="S4.E2.m1.7.7.1.cmml" xref="S4.E2.m1.7.7.1"><times id="S4.E2.m1.7.7.1.2.cmml" xref="S4.E2.m1.7.7.1.2"></times><apply id="S4.E2.m1.7.7.1.3.cmml" xref="S4.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.3.1.cmml" xref="S4.E2.m1.7.7.1.3">subscript</csymbol><ci id="S4.E2.m1.7.7.1.3.2.cmml" xref="S4.E2.m1.7.7.1.3.2">ℒ</ci><apply id="S4.E2.m1.7.7.1.3.3.cmml" xref="S4.E2.m1.7.7.1.3.3"><times id="S4.E2.m1.7.7.1.3.3.1.cmml" xref="S4.E2.m1.7.7.1.3.3.1"></times><ci id="S4.E2.m1.7.7.1.3.3.2.cmml" xref="S4.E2.m1.7.7.1.3.3.2">𝐶</ci><ci id="S4.E2.m1.7.7.1.3.3.3.cmml" xref="S4.E2.m1.7.7.1.3.3.3">𝐸</ci></apply></apply><interval closure="open" id="S4.E2.m1.7.7.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.2"></times><ci id="S4.E2.m1.7.7.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.3">italic-ϕ</ci><list id="S4.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1"><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑧</ci><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.3">𝑐</ci></apply></list></apply><ci id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\small\mathcal{L}_{cls}=\sum_{c\in C}\alpha_{r,t}^{c,y}\mathcal{L}_{cls}^{c}\quad\text{where}\quad\mathcal{L}_{cls}^{c}=\mathcal{L}_{CE}(\phi(z;w_{c}),y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.13" class="ltx_p">where <math id="S4.SS3.p2.9.m1.1" class="ltx_Math" alttext="\mathcal{L}_{cls}^{c}" display="inline"><semantics id="S4.SS3.p2.9.m1.1a"><msubsup id="S4.SS3.p2.9.m1.1.1" xref="S4.SS3.p2.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.9.m1.1.1.2.2" xref="S4.SS3.p2.9.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.SS3.p2.9.m1.1.1.2.3" xref="S4.SS3.p2.9.m1.1.1.2.3.cmml"><mi id="S4.SS3.p2.9.m1.1.1.2.3.2" xref="S4.SS3.p2.9.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.9.m1.1.1.2.3.1" xref="S4.SS3.p2.9.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p2.9.m1.1.1.2.3.3" xref="S4.SS3.p2.9.m1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.9.m1.1.1.2.3.1a" xref="S4.SS3.p2.9.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p2.9.m1.1.1.2.3.4" xref="S4.SS3.p2.9.m1.1.1.2.3.4.cmml">s</mi></mrow><mi id="S4.SS3.p2.9.m1.1.1.3" xref="S4.SS3.p2.9.m1.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m1.1b"><apply id="S4.SS3.p2.9.m1.1.1.cmml" xref="S4.SS3.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m1.1.1.1.cmml" xref="S4.SS3.p2.9.m1.1.1">superscript</csymbol><apply id="S4.SS3.p2.9.m1.1.1.2.cmml" xref="S4.SS3.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m1.1.1.2.1.cmml" xref="S4.SS3.p2.9.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m1.1.1.2.2.cmml" xref="S4.SS3.p2.9.m1.1.1.2.2">ℒ</ci><apply id="S4.SS3.p2.9.m1.1.1.2.3.cmml" xref="S4.SS3.p2.9.m1.1.1.2.3"><times id="S4.SS3.p2.9.m1.1.1.2.3.1.cmml" xref="S4.SS3.p2.9.m1.1.1.2.3.1"></times><ci id="S4.SS3.p2.9.m1.1.1.2.3.2.cmml" xref="S4.SS3.p2.9.m1.1.1.2.3.2">𝑐</ci><ci id="S4.SS3.p2.9.m1.1.1.2.3.3.cmml" xref="S4.SS3.p2.9.m1.1.1.2.3.3">𝑙</ci><ci id="S4.SS3.p2.9.m1.1.1.2.3.4.cmml" xref="S4.SS3.p2.9.m1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S4.SS3.p2.9.m1.1.1.3.cmml" xref="S4.SS3.p2.9.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m1.1c">\mathcal{L}_{cls}^{c}</annotation></semantics></math> is the cross-entropy loss between the prediction of local model <em id="S4.SS3.p2.13.1" class="ltx_emph ltx_font_italic">c</em> given latent <math id="S4.SS3.p2.10.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS3.p2.10.m2.1a"><mi id="S4.SS3.p2.10.m2.1.1" xref="S4.SS3.p2.10.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m2.1b"><ci id="S4.SS3.p2.10.m2.1.1.cmml" xref="S4.SS3.p2.10.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m2.1c">z</annotation></semantics></math> and sampled class label y.
Here, <math id="S4.SS3.p2.11.m3.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS3.p2.11.m3.1a"><mi id="S4.SS3.p2.11.m3.1.1" xref="S4.SS3.p2.11.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m3.1b"><ci id="S4.SS3.p2.11.m3.1.1.cmml" xref="S4.SS3.p2.11.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m3.1c">\phi</annotation></semantics></math> denotes the classifer (last layer). Class labels are sampled from a probability sampling function <math id="S4.SS3.p2.12.m4.1" class="ltx_Math" alttext="Prob_{r}^{t}(y)" display="inline"><semantics id="S4.SS3.p2.12.m4.1a"><mrow id="S4.SS3.p2.12.m4.1.2" xref="S4.SS3.p2.12.m4.1.2.cmml"><mi id="S4.SS3.p2.12.m4.1.2.2" xref="S4.SS3.p2.12.m4.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.12.m4.1.2.1" xref="S4.SS3.p2.12.m4.1.2.1.cmml">​</mo><mi id="S4.SS3.p2.12.m4.1.2.3" xref="S4.SS3.p2.12.m4.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.12.m4.1.2.1a" xref="S4.SS3.p2.12.m4.1.2.1.cmml">​</mo><mi id="S4.SS3.p2.12.m4.1.2.4" xref="S4.SS3.p2.12.m4.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.12.m4.1.2.1b" xref="S4.SS3.p2.12.m4.1.2.1.cmml">​</mo><msubsup id="S4.SS3.p2.12.m4.1.2.5" xref="S4.SS3.p2.12.m4.1.2.5.cmml"><mi id="S4.SS3.p2.12.m4.1.2.5.2.2" xref="S4.SS3.p2.12.m4.1.2.5.2.2.cmml">b</mi><mi id="S4.SS3.p2.12.m4.1.2.5.2.3" xref="S4.SS3.p2.12.m4.1.2.5.2.3.cmml">r</mi><mi id="S4.SS3.p2.12.m4.1.2.5.3" xref="S4.SS3.p2.12.m4.1.2.5.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.12.m4.1.2.1c" xref="S4.SS3.p2.12.m4.1.2.1.cmml">​</mo><mrow id="S4.SS3.p2.12.m4.1.2.6.2" xref="S4.SS3.p2.12.m4.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.12.m4.1.2.6.2.1" xref="S4.SS3.p2.12.m4.1.2.cmml">(</mo><mi id="S4.SS3.p2.12.m4.1.1" xref="S4.SS3.p2.12.m4.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS3.p2.12.m4.1.2.6.2.2" xref="S4.SS3.p2.12.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m4.1b"><apply id="S4.SS3.p2.12.m4.1.2.cmml" xref="S4.SS3.p2.12.m4.1.2"><times id="S4.SS3.p2.12.m4.1.2.1.cmml" xref="S4.SS3.p2.12.m4.1.2.1"></times><ci id="S4.SS3.p2.12.m4.1.2.2.cmml" xref="S4.SS3.p2.12.m4.1.2.2">𝑃</ci><ci id="S4.SS3.p2.12.m4.1.2.3.cmml" xref="S4.SS3.p2.12.m4.1.2.3">𝑟</ci><ci id="S4.SS3.p2.12.m4.1.2.4.cmml" xref="S4.SS3.p2.12.m4.1.2.4">𝑜</ci><apply id="S4.SS3.p2.12.m4.1.2.5.cmml" xref="S4.SS3.p2.12.m4.1.2.5"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m4.1.2.5.1.cmml" xref="S4.SS3.p2.12.m4.1.2.5">superscript</csymbol><apply id="S4.SS3.p2.12.m4.1.2.5.2.cmml" xref="S4.SS3.p2.12.m4.1.2.5"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m4.1.2.5.2.1.cmml" xref="S4.SS3.p2.12.m4.1.2.5">subscript</csymbol><ci id="S4.SS3.p2.12.m4.1.2.5.2.2.cmml" xref="S4.SS3.p2.12.m4.1.2.5.2.2">𝑏</ci><ci id="S4.SS3.p2.12.m4.1.2.5.2.3.cmml" xref="S4.SS3.p2.12.m4.1.2.5.2.3">𝑟</ci></apply><ci id="S4.SS3.p2.12.m4.1.2.5.3.cmml" xref="S4.SS3.p2.12.m4.1.2.5.3">𝑡</ci></apply><ci id="S4.SS3.p2.12.m4.1.1.cmml" xref="S4.SS3.p2.12.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m4.1c">Prob_{r}^{t}(y)</annotation></semantics></math> which approximates the label distribution for a given round <em id="S4.SS3.p2.13.2" class="ltx_emph ltx_font_italic">r</em> in task <em id="S4.SS3.p2.13.3" class="ltx_emph ltx_font_italic">t</em> using the number of instances per class as seen by each client. The coefficients <math id="S4.SS3.p2.13.m5.4" class="ltx_Math" alttext="\alpha_{r,t}^{c,y}" display="inline"><semantics id="S4.SS3.p2.13.m5.4a"><msubsup id="S4.SS3.p2.13.m5.4.5" xref="S4.SS3.p2.13.m5.4.5.cmml"><mi id="S4.SS3.p2.13.m5.4.5.2.2" xref="S4.SS3.p2.13.m5.4.5.2.2.cmml">α</mi><mrow id="S4.SS3.p2.13.m5.2.2.2.4" xref="S4.SS3.p2.13.m5.2.2.2.3.cmml"><mi id="S4.SS3.p2.13.m5.1.1.1.1" xref="S4.SS3.p2.13.m5.1.1.1.1.cmml">r</mi><mo id="S4.SS3.p2.13.m5.2.2.2.4.1" xref="S4.SS3.p2.13.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.13.m5.2.2.2.2" xref="S4.SS3.p2.13.m5.2.2.2.2.cmml">t</mi></mrow><mrow id="S4.SS3.p2.13.m5.4.4.2.4" xref="S4.SS3.p2.13.m5.4.4.2.3.cmml"><mi id="S4.SS3.p2.13.m5.3.3.1.1" xref="S4.SS3.p2.13.m5.3.3.1.1.cmml">c</mi><mo id="S4.SS3.p2.13.m5.4.4.2.4.1" xref="S4.SS3.p2.13.m5.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p2.13.m5.4.4.2.2" xref="S4.SS3.p2.13.m5.4.4.2.2.cmml">y</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m5.4b"><apply id="S4.SS3.p2.13.m5.4.5.cmml" xref="S4.SS3.p2.13.m5.4.5"><csymbol cd="ambiguous" id="S4.SS3.p2.13.m5.4.5.1.cmml" xref="S4.SS3.p2.13.m5.4.5">superscript</csymbol><apply id="S4.SS3.p2.13.m5.4.5.2.cmml" xref="S4.SS3.p2.13.m5.4.5"><csymbol cd="ambiguous" id="S4.SS3.p2.13.m5.4.5.2.1.cmml" xref="S4.SS3.p2.13.m5.4.5">subscript</csymbol><ci id="S4.SS3.p2.13.m5.4.5.2.2.cmml" xref="S4.SS3.p2.13.m5.4.5.2.2">𝛼</ci><list id="S4.SS3.p2.13.m5.2.2.2.3.cmml" xref="S4.SS3.p2.13.m5.2.2.2.4"><ci id="S4.SS3.p2.13.m5.1.1.1.1.cmml" xref="S4.SS3.p2.13.m5.1.1.1.1">𝑟</ci><ci id="S4.SS3.p2.13.m5.2.2.2.2.cmml" xref="S4.SS3.p2.13.m5.2.2.2.2">𝑡</ci></list></apply><list id="S4.SS3.p2.13.m5.4.4.2.3.cmml" xref="S4.SS3.p2.13.m5.4.4.2.4"><ci id="S4.SS3.p2.13.m5.3.3.1.1.cmml" xref="S4.SS3.p2.13.m5.3.3.1.1">𝑐</ci><ci id="S4.SS3.p2.13.m5.4.4.2.2.cmml" xref="S4.SS3.p2.13.m5.4.4.2.2">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m5.4c">\alpha_{r,t}^{c,y}</annotation></semantics></math> are used to assign weights according to the relative label distribution for each client in a given round <em id="S4.SS3.p2.13.4" class="ltx_emph ltx_font_italic">r</em> in task <em id="S4.SS3.p2.13.5" class="ltx_emph ltx_font_italic">t</em>, as follows:</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.5" class="ltx_Math" alttext="\small Prob_{r}^{t}(y)\propto\sum_{c\in C}n_{c}^{y}\quad\text{\&amp;}\quad\alpha_{r,t}^{c,y}={n_{c}^{y}}\big{/}{\sum_{i\in C}n_{i}^{y}}" display="block"><semantics id="S4.E3.m1.5a"><mrow id="S4.E3.m1.5.6" xref="S4.E3.m1.5.6.cmml"><mrow id="S4.E3.m1.5.6.2" xref="S4.E3.m1.5.6.2.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.2.2" xref="S4.E3.m1.5.6.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.5.6.2.1" xref="S4.E3.m1.5.6.2.1.cmml">​</mo><mi mathsize="90%" id="S4.E3.m1.5.6.2.3" xref="S4.E3.m1.5.6.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.5.6.2.1a" xref="S4.E3.m1.5.6.2.1.cmml">​</mo><mi mathsize="90%" id="S4.E3.m1.5.6.2.4" xref="S4.E3.m1.5.6.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.5.6.2.1b" xref="S4.E3.m1.5.6.2.1.cmml">​</mo><msubsup id="S4.E3.m1.5.6.2.5" xref="S4.E3.m1.5.6.2.5.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.2.5.2.2" xref="S4.E3.m1.5.6.2.5.2.2.cmml">b</mi><mi mathsize="90%" id="S4.E3.m1.5.6.2.5.2.3" xref="S4.E3.m1.5.6.2.5.2.3.cmml">r</mi><mi mathsize="90%" id="S4.E3.m1.5.6.2.5.3" xref="S4.E3.m1.5.6.2.5.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m1.5.6.2.1c" xref="S4.E3.m1.5.6.2.1.cmml">​</mo><mrow id="S4.E3.m1.5.6.2.6.2" xref="S4.E3.m1.5.6.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.5.6.2.6.2.1" xref="S4.E3.m1.5.6.2.cmml">(</mo><mi mathsize="90%" id="S4.E3.m1.5.5" xref="S4.E3.m1.5.5.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S4.E3.m1.5.6.2.6.2.2" xref="S4.E3.m1.5.6.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.111em" id="S4.E3.m1.5.6.3" xref="S4.E3.m1.5.6.3.cmml">∝</mo><mrow id="S4.E3.m1.5.6.4" xref="S4.E3.m1.5.6.4.cmml"><munder id="S4.E3.m1.5.6.4.1" xref="S4.E3.m1.5.6.4.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E3.m1.5.6.4.1.2" xref="S4.E3.m1.5.6.4.1.2.cmml">∑</mo><mrow id="S4.E3.m1.5.6.4.1.3" xref="S4.E3.m1.5.6.4.1.3.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.4.1.3.2" xref="S4.E3.m1.5.6.4.1.3.2.cmml">c</mi><mo mathsize="90%" id="S4.E3.m1.5.6.4.1.3.1" xref="S4.E3.m1.5.6.4.1.3.1.cmml">∈</mo><mi mathsize="90%" id="S4.E3.m1.5.6.4.1.3.3" xref="S4.E3.m1.5.6.4.1.3.3.cmml">C</mi></mrow></munder><mrow id="S4.E3.m1.5.6.4.2" xref="S4.E3.m1.5.6.4.2.cmml"><msubsup id="S4.E3.m1.5.6.4.2.2" xref="S4.E3.m1.5.6.4.2.2.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.4.2.2.2.2" xref="S4.E3.m1.5.6.4.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="S4.E3.m1.5.6.4.2.2.2.3" xref="S4.E3.m1.5.6.4.2.2.2.3.cmml">c</mi><mi mathsize="90%" id="S4.E3.m1.5.6.4.2.2.3" xref="S4.E3.m1.5.6.4.2.2.3.cmml">y</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m1.5.6.4.2.1" xref="S4.E3.m1.5.6.4.2.1.cmml">​</mo><mtext mathsize="90%" id="S4.E3.m1.5.6.4.2.3" xref="S4.E3.m1.5.6.4.2.3a.cmml">&amp;</mtext><mo lspace="0.900em" rspace="0em" id="S4.E3.m1.5.6.4.2.1a" xref="S4.E3.m1.5.6.4.2.1.cmml">​</mo><msubsup id="S4.E3.m1.5.6.4.2.4" xref="S4.E3.m1.5.6.4.2.4.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.4.2.4.2.2" xref="S4.E3.m1.5.6.4.2.4.2.2.cmml">α</mi><mrow id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">r</mi><mo mathsize="90%" id="S4.E3.m1.2.2.2.4.1" xref="S4.E3.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">t</mi></mrow><mrow id="S4.E3.m1.4.4.2.4" xref="S4.E3.m1.4.4.2.3.cmml"><mi mathsize="90%" id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml">c</mi><mo mathsize="90%" id="S4.E3.m1.4.4.2.4.1" xref="S4.E3.m1.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E3.m1.4.4.2.2" xref="S4.E3.m1.4.4.2.2.cmml">y</mi></mrow></msubsup></mrow></mrow><mo mathsize="90%" id="S4.E3.m1.5.6.5" xref="S4.E3.m1.5.6.5.cmml">=</mo><mrow id="S4.E3.m1.5.6.6" xref="S4.E3.m1.5.6.6.cmml"><msubsup id="S4.E3.m1.5.6.6.2" xref="S4.E3.m1.5.6.6.2.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.6.2.2.2" xref="S4.E3.m1.5.6.6.2.2.2.cmml">n</mi><mi mathsize="90%" id="S4.E3.m1.5.6.6.2.2.3" xref="S4.E3.m1.5.6.6.2.2.3.cmml">c</mi><mi mathsize="90%" id="S4.E3.m1.5.6.6.2.3" xref="S4.E3.m1.5.6.6.2.3.cmml">y</mi></msubsup><mo maxsize="120%" minsize="120%" rspace="0.055em" stretchy="true" symmetric="true" id="S4.E3.m1.5.6.6.1" xref="S4.E3.m1.5.6.6.1.cmml">/</mo><mrow id="S4.E3.m1.5.6.6.3" xref="S4.E3.m1.5.6.6.3.cmml"><munder id="S4.E3.m1.5.6.6.3.1" xref="S4.E3.m1.5.6.6.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E3.m1.5.6.6.3.1.2" xref="S4.E3.m1.5.6.6.3.1.2.cmml">∑</mo><mrow id="S4.E3.m1.5.6.6.3.1.3" xref="S4.E3.m1.5.6.6.3.1.3.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.6.3.1.3.2" xref="S4.E3.m1.5.6.6.3.1.3.2.cmml">i</mi><mo mathsize="90%" id="S4.E3.m1.5.6.6.3.1.3.1" xref="S4.E3.m1.5.6.6.3.1.3.1.cmml">∈</mo><mi mathsize="90%" id="S4.E3.m1.5.6.6.3.1.3.3" xref="S4.E3.m1.5.6.6.3.1.3.3.cmml">C</mi></mrow></munder><msubsup id="S4.E3.m1.5.6.6.3.2" xref="S4.E3.m1.5.6.6.3.2.cmml"><mi mathsize="90%" id="S4.E3.m1.5.6.6.3.2.2.2" xref="S4.E3.m1.5.6.6.3.2.2.2.cmml">n</mi><mi mathsize="90%" id="S4.E3.m1.5.6.6.3.2.2.3" xref="S4.E3.m1.5.6.6.3.2.2.3.cmml">i</mi><mi mathsize="90%" id="S4.E3.m1.5.6.6.3.2.3" xref="S4.E3.m1.5.6.6.3.2.3.cmml">y</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.5b"><apply id="S4.E3.m1.5.6.cmml" xref="S4.E3.m1.5.6"><and id="S4.E3.m1.5.6a.cmml" xref="S4.E3.m1.5.6"></and><apply id="S4.E3.m1.5.6b.cmml" xref="S4.E3.m1.5.6"><csymbol cd="latexml" id="S4.E3.m1.5.6.3.cmml" xref="S4.E3.m1.5.6.3">proportional-to</csymbol><apply id="S4.E3.m1.5.6.2.cmml" xref="S4.E3.m1.5.6.2"><times id="S4.E3.m1.5.6.2.1.cmml" xref="S4.E3.m1.5.6.2.1"></times><ci id="S4.E3.m1.5.6.2.2.cmml" xref="S4.E3.m1.5.6.2.2">𝑃</ci><ci id="S4.E3.m1.5.6.2.3.cmml" xref="S4.E3.m1.5.6.2.3">𝑟</ci><ci id="S4.E3.m1.5.6.2.4.cmml" xref="S4.E3.m1.5.6.2.4">𝑜</ci><apply id="S4.E3.m1.5.6.2.5.cmml" xref="S4.E3.m1.5.6.2.5"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.2.5.1.cmml" xref="S4.E3.m1.5.6.2.5">superscript</csymbol><apply id="S4.E3.m1.5.6.2.5.2.cmml" xref="S4.E3.m1.5.6.2.5"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.2.5.2.1.cmml" xref="S4.E3.m1.5.6.2.5">subscript</csymbol><ci id="S4.E3.m1.5.6.2.5.2.2.cmml" xref="S4.E3.m1.5.6.2.5.2.2">𝑏</ci><ci id="S4.E3.m1.5.6.2.5.2.3.cmml" xref="S4.E3.m1.5.6.2.5.2.3">𝑟</ci></apply><ci id="S4.E3.m1.5.6.2.5.3.cmml" xref="S4.E3.m1.5.6.2.5.3">𝑡</ci></apply><ci id="S4.E3.m1.5.5.cmml" xref="S4.E3.m1.5.5">𝑦</ci></apply><apply id="S4.E3.m1.5.6.4.cmml" xref="S4.E3.m1.5.6.4"><apply id="S4.E3.m1.5.6.4.1.cmml" xref="S4.E3.m1.5.6.4.1"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.4.1.1.cmml" xref="S4.E3.m1.5.6.4.1">subscript</csymbol><sum id="S4.E3.m1.5.6.4.1.2.cmml" xref="S4.E3.m1.5.6.4.1.2"></sum><apply id="S4.E3.m1.5.6.4.1.3.cmml" xref="S4.E3.m1.5.6.4.1.3"><in id="S4.E3.m1.5.6.4.1.3.1.cmml" xref="S4.E3.m1.5.6.4.1.3.1"></in><ci id="S4.E3.m1.5.6.4.1.3.2.cmml" xref="S4.E3.m1.5.6.4.1.3.2">𝑐</ci><ci id="S4.E3.m1.5.6.4.1.3.3.cmml" xref="S4.E3.m1.5.6.4.1.3.3">𝐶</ci></apply></apply><apply id="S4.E3.m1.5.6.4.2.cmml" xref="S4.E3.m1.5.6.4.2"><times id="S4.E3.m1.5.6.4.2.1.cmml" xref="S4.E3.m1.5.6.4.2.1"></times><apply id="S4.E3.m1.5.6.4.2.2.cmml" xref="S4.E3.m1.5.6.4.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.4.2.2.1.cmml" xref="S4.E3.m1.5.6.4.2.2">superscript</csymbol><apply id="S4.E3.m1.5.6.4.2.2.2.cmml" xref="S4.E3.m1.5.6.4.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.4.2.2.2.1.cmml" xref="S4.E3.m1.5.6.4.2.2">subscript</csymbol><ci id="S4.E3.m1.5.6.4.2.2.2.2.cmml" xref="S4.E3.m1.5.6.4.2.2.2.2">𝑛</ci><ci id="S4.E3.m1.5.6.4.2.2.2.3.cmml" xref="S4.E3.m1.5.6.4.2.2.2.3">𝑐</ci></apply><ci id="S4.E3.m1.5.6.4.2.2.3.cmml" xref="S4.E3.m1.5.6.4.2.2.3">𝑦</ci></apply><ci id="S4.E3.m1.5.6.4.2.3a.cmml" xref="S4.E3.m1.5.6.4.2.3"><mtext mathsize="90%" id="S4.E3.m1.5.6.4.2.3.cmml" xref="S4.E3.m1.5.6.4.2.3">&amp;</mtext></ci><apply id="S4.E3.m1.5.6.4.2.4.cmml" xref="S4.E3.m1.5.6.4.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.4.2.4.1.cmml" xref="S4.E3.m1.5.6.4.2.4">superscript</csymbol><apply id="S4.E3.m1.5.6.4.2.4.2.cmml" xref="S4.E3.m1.5.6.4.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.4.2.4.2.1.cmml" xref="S4.E3.m1.5.6.4.2.4">subscript</csymbol><ci id="S4.E3.m1.5.6.4.2.4.2.2.cmml" xref="S4.E3.m1.5.6.4.2.4.2.2">𝛼</ci><list id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.4"><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑟</ci><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝑡</ci></list></apply><list id="S4.E3.m1.4.4.2.3.cmml" xref="S4.E3.m1.4.4.2.4"><ci id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1.1">𝑐</ci><ci id="S4.E3.m1.4.4.2.2.cmml" xref="S4.E3.m1.4.4.2.2">𝑦</ci></list></apply></apply></apply></apply><apply id="S4.E3.m1.5.6c.cmml" xref="S4.E3.m1.5.6"><eq id="S4.E3.m1.5.6.5.cmml" xref="S4.E3.m1.5.6.5"></eq><share href="#S4.E3.m1.5.6.4.cmml" id="S4.E3.m1.5.6d.cmml" xref="S4.E3.m1.5.6"></share><apply id="S4.E3.m1.5.6.6.cmml" xref="S4.E3.m1.5.6.6"><divide id="S4.E3.m1.5.6.6.1.cmml" xref="S4.E3.m1.5.6.6.1"></divide><apply id="S4.E3.m1.5.6.6.2.cmml" xref="S4.E3.m1.5.6.6.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.6.2.1.cmml" xref="S4.E3.m1.5.6.6.2">superscript</csymbol><apply id="S4.E3.m1.5.6.6.2.2.cmml" xref="S4.E3.m1.5.6.6.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.6.2.2.1.cmml" xref="S4.E3.m1.5.6.6.2">subscript</csymbol><ci id="S4.E3.m1.5.6.6.2.2.2.cmml" xref="S4.E3.m1.5.6.6.2.2.2">𝑛</ci><ci id="S4.E3.m1.5.6.6.2.2.3.cmml" xref="S4.E3.m1.5.6.6.2.2.3">𝑐</ci></apply><ci id="S4.E3.m1.5.6.6.2.3.cmml" xref="S4.E3.m1.5.6.6.2.3">𝑦</ci></apply><apply id="S4.E3.m1.5.6.6.3.cmml" xref="S4.E3.m1.5.6.6.3"><apply id="S4.E3.m1.5.6.6.3.1.cmml" xref="S4.E3.m1.5.6.6.3.1"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.6.3.1.1.cmml" xref="S4.E3.m1.5.6.6.3.1">subscript</csymbol><sum id="S4.E3.m1.5.6.6.3.1.2.cmml" xref="S4.E3.m1.5.6.6.3.1.2"></sum><apply id="S4.E3.m1.5.6.6.3.1.3.cmml" xref="S4.E3.m1.5.6.6.3.1.3"><in id="S4.E3.m1.5.6.6.3.1.3.1.cmml" xref="S4.E3.m1.5.6.6.3.1.3.1"></in><ci id="S4.E3.m1.5.6.6.3.1.3.2.cmml" xref="S4.E3.m1.5.6.6.3.1.3.2">𝑖</ci><ci id="S4.E3.m1.5.6.6.3.1.3.3.cmml" xref="S4.E3.m1.5.6.6.3.1.3.3">𝐶</ci></apply></apply><apply id="S4.E3.m1.5.6.6.3.2.cmml" xref="S4.E3.m1.5.6.6.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.6.3.2.1.cmml" xref="S4.E3.m1.5.6.6.3.2">superscript</csymbol><apply id="S4.E3.m1.5.6.6.3.2.2.cmml" xref="S4.E3.m1.5.6.6.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.6.3.2.2.1.cmml" xref="S4.E3.m1.5.6.6.3.2">subscript</csymbol><ci id="S4.E3.m1.5.6.6.3.2.2.2.cmml" xref="S4.E3.m1.5.6.6.3.2.2.2">𝑛</ci><ci id="S4.E3.m1.5.6.6.3.2.2.3.cmml" xref="S4.E3.m1.5.6.6.3.2.2.3">𝑖</ci></apply><ci id="S4.E3.m1.5.6.6.3.2.3.cmml" xref="S4.E3.m1.5.6.6.3.2.3">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.5c">\small Prob_{r}^{t}(y)\propto\sum_{c\in C}n_{c}^{y}\quad\text{\&amp;}\quad\alpha_{r,t}^{c,y}={n_{c}^{y}}\big{/}{\sum_{i\in C}n_{i}^{y}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.3" class="ltx_p">where <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="n_{c}^{y}" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><msubsup id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.cmml">n</mi><mi id="S4.SS3.p4.1.m1.1.1.2.3" xref="S4.SS3.p4.1.m1.1.1.2.3.cmml">c</mi><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">y</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">superscript</csymbol><apply id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2">𝑛</ci><ci id="S4.SS3.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">n_{c}^{y}</annotation></semantics></math> is the number of instance of class <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">y</annotation></semantics></math> seen by client <math id="S4.SS3.p4.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">c</annotation></semantics></math> in round <em id="S4.SS3.p4.3.1" class="ltx_emph ltx_font_italic">r</em>. Such a sampling and weighting scheme is seen to provide positive gains in heterogeneous FL settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.10" class="ltx_p">However, optimizing for just the classification loss encourages the generator to produce pseudo latents which are easy to be classified and hence less effective for distillation. Our goal is to generate latents that create a discrepancy between the intermediate server model and clients, thereby providing a learning opportunity for the server.
To promote the generation of such <span id="S4.SS3.p5.10.1" class="ltx_text ltx_font_italic">hard samples</span>,
we maximize two disagreement losses (one for prompts and one for classifier)
between server and client models. As stated earlier, latents in this space can be forwarded through both prompting and classifier mechanisms. Hence, to measure the disagreement with respect to the classifier, we compute the Kullback-Leibler (KL) divergence between the predictions of the intermediate server model and each individual client model inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. Next, to measure the disagreement with respect to the prompting mechanism, we introduce a Mean-Squared Error (MSE) loss between the final prompts generated by the server and all clients. By training the generator to maximize these losses, we increase the potency of pseudo-latents for distillation in both parts of the network.</p>
<table id="S4.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr class="ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_align_left" style="white-space:normal;" colspan="NaN">
<table id="S4.E4.1a.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.E4.1a.1.1" class="ltx_tr">
<td id="S4.E4.1a.1.1.1" class="ltx_td ltx_align_justify">
<span id="S4.E4.1a.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.E4.1" class="ltx_equation ltx_eqn_table">

<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.1.m1.7" class="ltx_math_unparsed" alttext="\small\mathcal{L}_{KL}=\sum_{c\in C}\alpha_{r,t}^{c,y}(\sigma(\phi(z;w))||\sigma(\phi(z;w_{c})))" display="block"><semantics id="S4.E4.1.m1.7a"><mrow id="S4.E4.1.m1.7b"><msub id="S4.E4.1.m1.7.8"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E4.1.m1.7.8.2">ℒ</mi><mrow id="S4.E4.1.m1.7.8.3"><mi mathsize="90%" id="S4.E4.1.m1.7.8.3.2">K</mi><mo lspace="0em" rspace="0em" id="S4.E4.1.m1.7.8.3.1">​</mo><mi mathsize="90%" id="S4.E4.1.m1.7.8.3.3">L</mi></mrow></msub><mo mathsize="90%" rspace="0.111em" id="S4.E4.1.m1.7.9">=</mo><munder id="S4.E4.1.m1.7.10"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E4.1.m1.7.10.2">∑</mo><mrow id="S4.E4.1.m1.7.10.3"><mi mathsize="90%" id="S4.E4.1.m1.7.10.3.2">c</mi><mo mathsize="90%" id="S4.E4.1.m1.7.10.3.1">∈</mo><mi mathsize="90%" id="S4.E4.1.m1.7.10.3.3">C</mi></mrow></munder><msubsup id="S4.E4.1.m1.7.11"><mi mathsize="90%" id="S4.E4.1.m1.7.11.2.2">α</mi><mrow id="S4.E4.1.m1.2.2.2.4"><mi mathsize="90%" id="S4.E4.1.m1.1.1.1.1">r</mi><mo mathsize="90%" id="S4.E4.1.m1.2.2.2.4.1">,</mo><mi mathsize="90%" id="S4.E4.1.m1.2.2.2.2">t</mi></mrow><mrow id="S4.E4.1.m1.4.4.2.4"><mi mathsize="90%" id="S4.E4.1.m1.3.3.1.1">c</mi><mo mathsize="90%" id="S4.E4.1.m1.4.4.2.4.1">,</mo><mi mathsize="90%" id="S4.E4.1.m1.4.4.2.2">y</mi></mrow></msubsup><mrow id="S4.E4.1.m1.7.12"><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.1">(</mo><mi mathsize="90%" id="S4.E4.1.m1.7.12.2">σ</mi><mrow id="S4.E4.1.m1.7.12.3"><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.3.1">(</mo><mi mathsize="90%" id="S4.E4.1.m1.7.12.3.2">ϕ</mi><mrow id="S4.E4.1.m1.7.12.3.3"><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.3.3.1">(</mo><mi mathsize="90%" id="S4.E4.1.m1.5.5">z</mi><mo mathsize="90%" id="S4.E4.1.m1.7.12.3.3.2">;</mo><mi mathsize="90%" id="S4.E4.1.m1.6.6">w</mi><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.3.3.3">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.3.4">)</mo></mrow><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S4.E4.1.m1.7.12.4">|</mo><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S4.E4.1.m1.7.12.5">|</mo><mi mathsize="90%" id="S4.E4.1.m1.7.12.6">σ</mi><mrow id="S4.E4.1.m1.7.12.7"><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.7.1">(</mo><mi mathsize="90%" id="S4.E4.1.m1.7.12.7.2">ϕ</mi><mrow id="S4.E4.1.m1.7.12.7.3"><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.7.3.1">(</mo><mi mathsize="90%" id="S4.E4.1.m1.7.7">z</mi><mo mathsize="90%" id="S4.E4.1.m1.7.12.7.3.2">;</mo><msub id="S4.E4.1.m1.7.12.7.3.3"><mi mathsize="90%" id="S4.E4.1.m1.7.12.7.3.3.2">w</mi><mi mathsize="90%" id="S4.E4.1.m1.7.12.7.3.3.3">c</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.7.3.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.7.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.1.m1.7.12.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E4.1.m1.7c">\small\mathcal{L}_{KL}=\sum_{c\in C}\alpha_{r,t}^{c,y}(\sigma(\phi(z;w))||\sigma(\phi(z;w_{c})))</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span>
<span rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4a)</span></span></span></span>
</span>
</span>
</td>
<td id="S4.E4.1a.1.1.2" class="ltx_td ltx_align_top"></td>
<td id="S4.E4.1a.1.1.3" class="ltx_td ltx_align_justify">
<span id="S4.E4.1a.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.E4.2" class="ltx_equation ltx_eqn_table">

<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.2.m1.9" class="ltx_Math" alttext="\small\mathcal{L}_{MSE}=\sum_{c\in C}\alpha_{r,t}^{c,y}(\rho(z;w),\rho(z,w_{c}))" display="block"><semantics id="S4.E4.2.m1.9a"><mrow id="S4.E4.2.m1.9.9" xref="S4.E4.2.m1.9.9.cmml"><msub id="S4.E4.2.m1.9.9.4" xref="S4.E4.2.m1.9.9.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E4.2.m1.9.9.4.2" xref="S4.E4.2.m1.9.9.4.2.cmml">ℒ</mi><mrow id="S4.E4.2.m1.9.9.4.3" xref="S4.E4.2.m1.9.9.4.3.cmml"><mi mathsize="90%" id="S4.E4.2.m1.9.9.4.3.2" xref="S4.E4.2.m1.9.9.4.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E4.2.m1.9.9.4.3.1" xref="S4.E4.2.m1.9.9.4.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E4.2.m1.9.9.4.3.3" xref="S4.E4.2.m1.9.9.4.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E4.2.m1.9.9.4.3.1a" xref="S4.E4.2.m1.9.9.4.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E4.2.m1.9.9.4.3.4" xref="S4.E4.2.m1.9.9.4.3.4.cmml">E</mi></mrow></msub><mo mathsize="90%" rspace="0.111em" id="S4.E4.2.m1.9.9.3" xref="S4.E4.2.m1.9.9.3.cmml">=</mo><mrow id="S4.E4.2.m1.9.9.2" xref="S4.E4.2.m1.9.9.2.cmml"><munder id="S4.E4.2.m1.9.9.2.3" xref="S4.E4.2.m1.9.9.2.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E4.2.m1.9.9.2.3.2" xref="S4.E4.2.m1.9.9.2.3.2.cmml">∑</mo><mrow id="S4.E4.2.m1.9.9.2.3.3" xref="S4.E4.2.m1.9.9.2.3.3.cmml"><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.3.3.2" xref="S4.E4.2.m1.9.9.2.3.3.2.cmml">c</mi><mo mathsize="90%" id="S4.E4.2.m1.9.9.2.3.3.1" xref="S4.E4.2.m1.9.9.2.3.3.1.cmml">∈</mo><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.3.3.3" xref="S4.E4.2.m1.9.9.2.3.3.3.cmml">C</mi></mrow></munder><mrow id="S4.E4.2.m1.9.9.2.2" xref="S4.E4.2.m1.9.9.2.2.cmml"><msubsup id="S4.E4.2.m1.9.9.2.2.4" xref="S4.E4.2.m1.9.9.2.2.4.cmml"><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.2.4.2.2" xref="S4.E4.2.m1.9.9.2.2.4.2.2.cmml">α</mi><mrow id="S4.E4.2.m1.2.2.2.4" xref="S4.E4.2.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E4.2.m1.1.1.1.1" xref="S4.E4.2.m1.1.1.1.1.cmml">r</mi><mo mathsize="90%" id="S4.E4.2.m1.2.2.2.4.1" xref="S4.E4.2.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E4.2.m1.2.2.2.2" xref="S4.E4.2.m1.2.2.2.2.cmml">t</mi></mrow><mrow id="S4.E4.2.m1.4.4.2.4" xref="S4.E4.2.m1.4.4.2.3.cmml"><mi mathsize="90%" id="S4.E4.2.m1.3.3.1.1" xref="S4.E4.2.m1.3.3.1.1.cmml">c</mi><mo mathsize="90%" id="S4.E4.2.m1.4.4.2.4.1" xref="S4.E4.2.m1.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E4.2.m1.4.4.2.2" xref="S4.E4.2.m1.4.4.2.2.cmml">y</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.2.m1.9.9.2.2.3" xref="S4.E4.2.m1.9.9.2.2.3.cmml">​</mo><mrow id="S4.E4.2.m1.9.9.2.2.2.2" xref="S4.E4.2.m1.9.9.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.3" xref="S4.E4.2.m1.9.9.2.2.2.3.cmml">(</mo><mrow id="S4.E4.2.m1.8.8.1.1.1.1.1" xref="S4.E4.2.m1.8.8.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E4.2.m1.8.8.1.1.1.1.1.2" xref="S4.E4.2.m1.8.8.1.1.1.1.1.2.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S4.E4.2.m1.8.8.1.1.1.1.1.1" xref="S4.E4.2.m1.8.8.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E4.2.m1.8.8.1.1.1.1.1.3.2" xref="S4.E4.2.m1.8.8.1.1.1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.8.8.1.1.1.1.1.3.2.1" xref="S4.E4.2.m1.8.8.1.1.1.1.1.3.1.cmml">(</mo><mi mathsize="90%" id="S4.E4.2.m1.5.5" xref="S4.E4.2.m1.5.5.cmml">z</mi><mo mathsize="90%" id="S4.E4.2.m1.8.8.1.1.1.1.1.3.2.2" xref="S4.E4.2.m1.8.8.1.1.1.1.1.3.1.cmml">;</mo><mi mathsize="90%" id="S4.E4.2.m1.6.6" xref="S4.E4.2.m1.6.6.cmml">w</mi><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.8.8.1.1.1.1.1.3.2.3" xref="S4.E4.2.m1.8.8.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.4" xref="S4.E4.2.m1.9.9.2.2.2.3.cmml">,</mo><mrow id="S4.E4.2.m1.9.9.2.2.2.2.2" xref="S4.E4.2.m1.9.9.2.2.2.2.2.cmml"><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.3" xref="S4.E4.2.m1.9.9.2.2.2.2.2.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S4.E4.2.m1.9.9.2.2.2.2.2.2" xref="S4.E4.2.m1.9.9.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.2" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E4.2.m1.7.7" xref="S4.E4.2.m1.7.7.cmml">z</mi><mo mathsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.3" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.2.cmml">,</mo><msub id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.cmml"><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.2" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.2.cmml">w</mi><mi mathsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.3" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.3.cmml">c</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.4" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.2.m1.9.9.2.2.2.2.5" xref="S4.E4.2.m1.9.9.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.2.m1.9b"><apply id="S4.E4.2.m1.9.9.cmml" xref="S4.E4.2.m1.9.9"><eq id="S4.E4.2.m1.9.9.3.cmml" xref="S4.E4.2.m1.9.9.3"></eq><apply id="S4.E4.2.m1.9.9.4.cmml" xref="S4.E4.2.m1.9.9.4"><csymbol cd="ambiguous" id="S4.E4.2.m1.9.9.4.1.cmml" xref="S4.E4.2.m1.9.9.4">subscript</csymbol><ci id="S4.E4.2.m1.9.9.4.2.cmml" xref="S4.E4.2.m1.9.9.4.2">ℒ</ci><apply id="S4.E4.2.m1.9.9.4.3.cmml" xref="S4.E4.2.m1.9.9.4.3"><times id="S4.E4.2.m1.9.9.4.3.1.cmml" xref="S4.E4.2.m1.9.9.4.3.1"></times><ci id="S4.E4.2.m1.9.9.4.3.2.cmml" xref="S4.E4.2.m1.9.9.4.3.2">𝑀</ci><ci id="S4.E4.2.m1.9.9.4.3.3.cmml" xref="S4.E4.2.m1.9.9.4.3.3">𝑆</ci><ci id="S4.E4.2.m1.9.9.4.3.4.cmml" xref="S4.E4.2.m1.9.9.4.3.4">𝐸</ci></apply></apply><apply id="S4.E4.2.m1.9.9.2.cmml" xref="S4.E4.2.m1.9.9.2"><apply id="S4.E4.2.m1.9.9.2.3.cmml" xref="S4.E4.2.m1.9.9.2.3"><csymbol cd="ambiguous" id="S4.E4.2.m1.9.9.2.3.1.cmml" xref="S4.E4.2.m1.9.9.2.3">subscript</csymbol><sum id="S4.E4.2.m1.9.9.2.3.2.cmml" xref="S4.E4.2.m1.9.9.2.3.2"></sum><apply id="S4.E4.2.m1.9.9.2.3.3.cmml" xref="S4.E4.2.m1.9.9.2.3.3"><in id="S4.E4.2.m1.9.9.2.3.3.1.cmml" xref="S4.E4.2.m1.9.9.2.3.3.1"></in><ci id="S4.E4.2.m1.9.9.2.3.3.2.cmml" xref="S4.E4.2.m1.9.9.2.3.3.2">𝑐</ci><ci id="S4.E4.2.m1.9.9.2.3.3.3.cmml" xref="S4.E4.2.m1.9.9.2.3.3.3">𝐶</ci></apply></apply><apply id="S4.E4.2.m1.9.9.2.2.cmml" xref="S4.E4.2.m1.9.9.2.2"><times id="S4.E4.2.m1.9.9.2.2.3.cmml" xref="S4.E4.2.m1.9.9.2.2.3"></times><apply id="S4.E4.2.m1.9.9.2.2.4.cmml" xref="S4.E4.2.m1.9.9.2.2.4"><csymbol cd="ambiguous" id="S4.E4.2.m1.9.9.2.2.4.1.cmml" xref="S4.E4.2.m1.9.9.2.2.4">superscript</csymbol><apply id="S4.E4.2.m1.9.9.2.2.4.2.cmml" xref="S4.E4.2.m1.9.9.2.2.4"><csymbol cd="ambiguous" id="S4.E4.2.m1.9.9.2.2.4.2.1.cmml" xref="S4.E4.2.m1.9.9.2.2.4">subscript</csymbol><ci id="S4.E4.2.m1.9.9.2.2.4.2.2.cmml" xref="S4.E4.2.m1.9.9.2.2.4.2.2">𝛼</ci><list id="S4.E4.2.m1.2.2.2.3.cmml" xref="S4.E4.2.m1.2.2.2.4"><ci id="S4.E4.2.m1.1.1.1.1.cmml" xref="S4.E4.2.m1.1.1.1.1">𝑟</ci><ci id="S4.E4.2.m1.2.2.2.2.cmml" xref="S4.E4.2.m1.2.2.2.2">𝑡</ci></list></apply><list id="S4.E4.2.m1.4.4.2.3.cmml" xref="S4.E4.2.m1.4.4.2.4"><ci id="S4.E4.2.m1.3.3.1.1.cmml" xref="S4.E4.2.m1.3.3.1.1">𝑐</ci><ci id="S4.E4.2.m1.4.4.2.2.cmml" xref="S4.E4.2.m1.4.4.2.2">𝑦</ci></list></apply><interval closure="open" id="S4.E4.2.m1.9.9.2.2.2.3.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2"><apply id="S4.E4.2.m1.8.8.1.1.1.1.1.cmml" xref="S4.E4.2.m1.8.8.1.1.1.1.1"><times id="S4.E4.2.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E4.2.m1.8.8.1.1.1.1.1.1"></times><ci id="S4.E4.2.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E4.2.m1.8.8.1.1.1.1.1.2">𝜌</ci><list id="S4.E4.2.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S4.E4.2.m1.8.8.1.1.1.1.1.3.2"><ci id="S4.E4.2.m1.5.5.cmml" xref="S4.E4.2.m1.5.5">𝑧</ci><ci id="S4.E4.2.m1.6.6.cmml" xref="S4.E4.2.m1.6.6">𝑤</ci></list></apply><apply id="S4.E4.2.m1.9.9.2.2.2.2.2.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2"><times id="S4.E4.2.m1.9.9.2.2.2.2.2.2.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.2"></times><ci id="S4.E4.2.m1.9.9.2.2.2.2.2.3.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.3">𝜌</ci><interval closure="open" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.2.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1"><ci id="S4.E4.2.m1.7.7.cmml" xref="S4.E4.2.m1.7.7">𝑧</ci><apply id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.2">𝑤</ci><ci id="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E4.2.m1.9.9.2.2.2.2.2.1.1.1.3">𝑐</ci></apply></interval></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.2.m1.9c">\small\mathcal{L}_{MSE}=\sum_{c\in C}\alpha_{r,t}^{c,y}(\rho(z;w),\rho(z,w_{c}))</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span>
<span rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4b)</span></span></span></span>
</span>
</span>
</td>
</tr>
</table></td></tr>
</tbody>
</table>
<p id="S4.SS3.p5.2" class="ltx_p">where <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><mi id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><ci id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\sigma</annotation></semantics></math> denotes the softmax function and <math id="S4.SS3.p5.2.m2.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS3.p5.2.m2.1a"><mi id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><ci id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">\rho</annotation></semantics></math> denotes the prompting mechanism described in <a href="#S4.SS2" title="4.2 Client Side : Decomposed Prompting ‣ 4 Method ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We train the generator by optimizing for these these losses jointly as:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.6" class="ltx_Math" alttext="\small\!\!\!\min_{\theta_{gen}}\mathbb{E}_{\epsilon\sim\mathcal{N}(\mathbf{0},\mathbf{1}),y\sim Prob_{r}^{t}(y)}\left[\mathcal{L}_{cls}\!\!-\!\lambda_{KL}\mathcal{L}_{KL}\!\!-\!\lambda_{MSE}\mathcal{L}_{MSE}\right]\\
" display="block"><semantics id="S4.E5.m1.6a"><mrow id="S4.E5.m1.6.6" xref="S4.E5.m1.6.6.cmml"><mrow id="S4.E5.m1.6.6.3" xref="S4.E5.m1.6.6.3.cmml"><munder id="S4.E5.m1.6.6.3.1" xref="S4.E5.m1.6.6.3.1.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.3.1.2" xref="S4.E5.m1.6.6.3.1.2.cmml">min</mi><msub id="S4.E5.m1.6.6.3.1.3" xref="S4.E5.m1.6.6.3.1.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.3.1.3.2" xref="S4.E5.m1.6.6.3.1.3.2.cmml">θ</mi><mrow id="S4.E5.m1.6.6.3.1.3.3" xref="S4.E5.m1.6.6.3.1.3.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.3.1.3.3.2" xref="S4.E5.m1.6.6.3.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.3.1.3.3.1" xref="S4.E5.m1.6.6.3.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.3.1.3.3.3" xref="S4.E5.m1.6.6.3.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.3.1.3.3.1a" xref="S4.E5.m1.6.6.3.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.3.1.3.3.4" xref="S4.E5.m1.6.6.3.1.3.3.4.cmml">n</mi></mrow></msub></munder><mo lspace="0.167em" id="S4.E5.m1.6.6.3a" xref="S4.E5.m1.6.6.3.cmml">⁡</mo><msub id="S4.E5.m1.6.6.3.2" xref="S4.E5.m1.6.6.3.2.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.3.2.2" xref="S4.E5.m1.6.6.3.2.2.cmml">𝔼</mi><mrow id="S4.E5.m1.5.5.5.5" xref="S4.E5.m1.5.5.5.6.cmml"><mrow id="S4.E5.m1.4.4.4.4.1" xref="S4.E5.m1.4.4.4.4.1.cmml"><mi mathsize="90%" id="S4.E5.m1.4.4.4.4.1.2" xref="S4.E5.m1.4.4.4.4.1.2.cmml">ϵ</mi><mo mathsize="90%" id="S4.E5.m1.4.4.4.4.1.1" xref="S4.E5.m1.4.4.4.4.1.1.cmml">∼</mo><mrow id="S4.E5.m1.4.4.4.4.1.3" xref="S4.E5.m1.4.4.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E5.m1.4.4.4.4.1.3.2" xref="S4.E5.m1.4.4.4.4.1.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.4.4.1.3.1" xref="S4.E5.m1.4.4.4.4.1.3.1.cmml">​</mo><mrow id="S4.E5.m1.4.4.4.4.1.3.3.2" xref="S4.E5.m1.4.4.4.4.1.3.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E5.m1.4.4.4.4.1.3.3.2.1" xref="S4.E5.m1.4.4.4.4.1.3.3.1.cmml">(</mo><mn mathsize="90%" id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">𝟎</mn><mo mathsize="90%" id="S4.E5.m1.4.4.4.4.1.3.3.2.2" xref="S4.E5.m1.4.4.4.4.1.3.3.1.cmml">,</mo><mn mathsize="90%" id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">𝟏</mn><mo maxsize="90%" minsize="90%" id="S4.E5.m1.4.4.4.4.1.3.3.2.3" xref="S4.E5.m1.4.4.4.4.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S4.E5.m1.5.5.5.5.3" xref="S4.E5.m1.5.5.5.6a.cmml">,</mo><mrow id="S4.E5.m1.5.5.5.5.2" xref="S4.E5.m1.5.5.5.5.2.cmml"><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.2" xref="S4.E5.m1.5.5.5.5.2.2.cmml">y</mi><mo mathsize="90%" id="S4.E5.m1.5.5.5.5.2.1" xref="S4.E5.m1.5.5.5.5.2.1.cmml">∼</mo><mrow id="S4.E5.m1.5.5.5.5.2.3" xref="S4.E5.m1.5.5.5.5.2.3.cmml"><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.2" xref="S4.E5.m1.5.5.5.5.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.5.2.3.1" xref="S4.E5.m1.5.5.5.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.3" xref="S4.E5.m1.5.5.5.5.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.5.2.3.1a" xref="S4.E5.m1.5.5.5.5.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.4" xref="S4.E5.m1.5.5.5.5.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.5.2.3.1b" xref="S4.E5.m1.5.5.5.5.2.3.1.cmml">​</mo><msubsup id="S4.E5.m1.5.5.5.5.2.3.5" xref="S4.E5.m1.5.5.5.5.2.3.5.cmml"><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.5.2.2" xref="S4.E5.m1.5.5.5.5.2.3.5.2.2.cmml">b</mi><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.5.2.3" xref="S4.E5.m1.5.5.5.5.2.3.5.2.3.cmml">r</mi><mi mathsize="90%" id="S4.E5.m1.5.5.5.5.2.3.5.3" xref="S4.E5.m1.5.5.5.5.2.3.5.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.5.5.2.3.1c" xref="S4.E5.m1.5.5.5.5.2.3.1.cmml">​</mo><mrow id="S4.E5.m1.5.5.5.5.2.3.6.2" xref="S4.E5.m1.5.5.5.5.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E5.m1.5.5.5.5.2.3.6.2.1" xref="S4.E5.m1.5.5.5.5.2.3.cmml">(</mo><mi mathsize="90%" id="S4.E5.m1.3.3.3.3" xref="S4.E5.m1.3.3.3.3.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S4.E5.m1.5.5.5.5.2.3.6.2.2" xref="S4.E5.m1.5.5.5.5.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.2" xref="S4.E5.m1.6.6.2.cmml">​</mo><mrow id="S4.E5.m1.6.6.1.1" xref="S4.E5.m1.6.6.1.2.cmml"><mo id="S4.E5.m1.6.6.1.1.2" xref="S4.E5.m1.6.6.1.2.1.cmml">[</mo><mrow id="S4.E5.m1.6.6.1.1.1" xref="S4.E5.m1.6.6.1.1.1.cmml"><msub id="S4.E5.m1.6.6.1.1.1.2" xref="S4.E5.m1.6.6.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E5.m1.6.6.1.1.1.2.2" xref="S4.E5.m1.6.6.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E5.m1.6.6.1.1.1.2.3" xref="S4.E5.m1.6.6.1.1.1.2.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.2.3.2" xref="S4.E5.m1.6.6.1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.2.3.1" xref="S4.E5.m1.6.6.1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.2.3.3" xref="S4.E5.m1.6.6.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.2.3.1a" xref="S4.E5.m1.6.6.1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.2.3.4" xref="S4.E5.m1.6.6.1.1.1.2.3.4.cmml">s</mi></mrow></msub><mo mathsize="90%" rspace="0.052em" id="S4.E5.m1.6.6.1.1.1.1" xref="S4.E5.m1.6.6.1.1.1.1.cmml">−</mo><mrow id="S4.E5.m1.6.6.1.1.1.3" xref="S4.E5.m1.6.6.1.1.1.3.cmml"><msub id="S4.E5.m1.6.6.1.1.1.3.2" xref="S4.E5.m1.6.6.1.1.1.3.2.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.2.2" xref="S4.E5.m1.6.6.1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.E5.m1.6.6.1.1.1.3.2.3" xref="S4.E5.m1.6.6.1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.2.3.2" xref="S4.E5.m1.6.6.1.1.1.3.2.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.3.2.3.1" xref="S4.E5.m1.6.6.1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.2.3.3" xref="S4.E5.m1.6.6.1.1.1.3.2.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.3.1" xref="S4.E5.m1.6.6.1.1.1.3.1.cmml">​</mo><msub id="S4.E5.m1.6.6.1.1.1.3.3" xref="S4.E5.m1.6.6.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.3.2" xref="S4.E5.m1.6.6.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E5.m1.6.6.1.1.1.3.3.3" xref="S4.E5.m1.6.6.1.1.1.3.3.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.3.3.2" xref="S4.E5.m1.6.6.1.1.1.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.3.3.3.1" xref="S4.E5.m1.6.6.1.1.1.3.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.3.3.3.3" xref="S4.E5.m1.6.6.1.1.1.3.3.3.3.cmml">L</mi></mrow></msub></mrow><mo mathsize="90%" rspace="0.052em" id="S4.E5.m1.6.6.1.1.1.1a" xref="S4.E5.m1.6.6.1.1.1.1.cmml">−</mo><mrow id="S4.E5.m1.6.6.1.1.1.4" xref="S4.E5.m1.6.6.1.1.1.4.cmml"><msub id="S4.E5.m1.6.6.1.1.1.4.2" xref="S4.E5.m1.6.6.1.1.1.4.2.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.2.2" xref="S4.E5.m1.6.6.1.1.1.4.2.2.cmml">λ</mi><mrow id="S4.E5.m1.6.6.1.1.1.4.2.3" xref="S4.E5.m1.6.6.1.1.1.4.2.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.2.3.2" xref="S4.E5.m1.6.6.1.1.1.4.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.4.2.3.1" xref="S4.E5.m1.6.6.1.1.1.4.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.2.3.3" xref="S4.E5.m1.6.6.1.1.1.4.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.4.2.3.1a" xref="S4.E5.m1.6.6.1.1.1.4.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.2.3.4" xref="S4.E5.m1.6.6.1.1.1.4.2.3.4.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.4.1" xref="S4.E5.m1.6.6.1.1.1.4.1.cmml">​</mo><msub id="S4.E5.m1.6.6.1.1.1.4.3" xref="S4.E5.m1.6.6.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.3.2" xref="S4.E5.m1.6.6.1.1.1.4.3.2.cmml">ℒ</mi><mrow id="S4.E5.m1.6.6.1.1.1.4.3.3" xref="S4.E5.m1.6.6.1.1.1.4.3.3.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.3.3.2" xref="S4.E5.m1.6.6.1.1.1.4.3.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.4.3.3.1" xref="S4.E5.m1.6.6.1.1.1.4.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.3.3.3" xref="S4.E5.m1.6.6.1.1.1.4.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.1.4.3.3.1a" xref="S4.E5.m1.6.6.1.1.1.4.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.6.6.1.1.1.4.3.3.4" xref="S4.E5.m1.6.6.1.1.1.4.3.3.4.cmml">E</mi></mrow></msub></mrow></mrow><mo id="S4.E5.m1.6.6.1.1.3" xref="S4.E5.m1.6.6.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.6b"><apply id="S4.E5.m1.6.6.cmml" xref="S4.E5.m1.6.6"><times id="S4.E5.m1.6.6.2.cmml" xref="S4.E5.m1.6.6.2"></times><apply id="S4.E5.m1.6.6.3.cmml" xref="S4.E5.m1.6.6.3"><apply id="S4.E5.m1.6.6.3.1.cmml" xref="S4.E5.m1.6.6.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.3.1.1.cmml" xref="S4.E5.m1.6.6.3.1">subscript</csymbol><min id="S4.E5.m1.6.6.3.1.2.cmml" xref="S4.E5.m1.6.6.3.1.2"></min><apply id="S4.E5.m1.6.6.3.1.3.cmml" xref="S4.E5.m1.6.6.3.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.3.1.3.1.cmml" xref="S4.E5.m1.6.6.3.1.3">subscript</csymbol><ci id="S4.E5.m1.6.6.3.1.3.2.cmml" xref="S4.E5.m1.6.6.3.1.3.2">𝜃</ci><apply id="S4.E5.m1.6.6.3.1.3.3.cmml" xref="S4.E5.m1.6.6.3.1.3.3"><times id="S4.E5.m1.6.6.3.1.3.3.1.cmml" xref="S4.E5.m1.6.6.3.1.3.3.1"></times><ci id="S4.E5.m1.6.6.3.1.3.3.2.cmml" xref="S4.E5.m1.6.6.3.1.3.3.2">𝑔</ci><ci id="S4.E5.m1.6.6.3.1.3.3.3.cmml" xref="S4.E5.m1.6.6.3.1.3.3.3">𝑒</ci><ci id="S4.E5.m1.6.6.3.1.3.3.4.cmml" xref="S4.E5.m1.6.6.3.1.3.3.4">𝑛</ci></apply></apply></apply><apply id="S4.E5.m1.6.6.3.2.cmml" xref="S4.E5.m1.6.6.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.3.2.1.cmml" xref="S4.E5.m1.6.6.3.2">subscript</csymbol><ci id="S4.E5.m1.6.6.3.2.2.cmml" xref="S4.E5.m1.6.6.3.2.2">𝔼</ci><apply id="S4.E5.m1.5.5.5.6.cmml" xref="S4.E5.m1.5.5.5.5"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.6a.cmml" xref="S4.E5.m1.5.5.5.5.3">formulae-sequence</csymbol><apply id="S4.E5.m1.4.4.4.4.1.cmml" xref="S4.E5.m1.4.4.4.4.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.4.4.1.1.cmml" xref="S4.E5.m1.4.4.4.4.1.1">similar-to</csymbol><ci id="S4.E5.m1.4.4.4.4.1.2.cmml" xref="S4.E5.m1.4.4.4.4.1.2">italic-ϵ</ci><apply id="S4.E5.m1.4.4.4.4.1.3.cmml" xref="S4.E5.m1.4.4.4.4.1.3"><times id="S4.E5.m1.4.4.4.4.1.3.1.cmml" xref="S4.E5.m1.4.4.4.4.1.3.1"></times><ci id="S4.E5.m1.4.4.4.4.1.3.2.cmml" xref="S4.E5.m1.4.4.4.4.1.3.2">𝒩</ci><interval closure="open" id="S4.E5.m1.4.4.4.4.1.3.3.1.cmml" xref="S4.E5.m1.4.4.4.4.1.3.3.2"><cn type="integer" id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">0</cn><cn type="integer" id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="S4.E5.m1.5.5.5.5.2.cmml" xref="S4.E5.m1.5.5.5.5.2"><csymbol cd="latexml" id="S4.E5.m1.5.5.5.5.2.1.cmml" xref="S4.E5.m1.5.5.5.5.2.1">similar-to</csymbol><ci id="S4.E5.m1.5.5.5.5.2.2.cmml" xref="S4.E5.m1.5.5.5.5.2.2">𝑦</ci><apply id="S4.E5.m1.5.5.5.5.2.3.cmml" xref="S4.E5.m1.5.5.5.5.2.3"><times id="S4.E5.m1.5.5.5.5.2.3.1.cmml" xref="S4.E5.m1.5.5.5.5.2.3.1"></times><ci id="S4.E5.m1.5.5.5.5.2.3.2.cmml" xref="S4.E5.m1.5.5.5.5.2.3.2">𝑃</ci><ci id="S4.E5.m1.5.5.5.5.2.3.3.cmml" xref="S4.E5.m1.5.5.5.5.2.3.3">𝑟</ci><ci id="S4.E5.m1.5.5.5.5.2.3.4.cmml" xref="S4.E5.m1.5.5.5.5.2.3.4">𝑜</ci><apply id="S4.E5.m1.5.5.5.5.2.3.5.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.2.3.5.1.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5">superscript</csymbol><apply id="S4.E5.m1.5.5.5.5.2.3.5.2.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.5.5.2.3.5.2.1.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5">subscript</csymbol><ci id="S4.E5.m1.5.5.5.5.2.3.5.2.2.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5.2.2">𝑏</ci><ci id="S4.E5.m1.5.5.5.5.2.3.5.2.3.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5.2.3">𝑟</ci></apply><ci id="S4.E5.m1.5.5.5.5.2.3.5.3.cmml" xref="S4.E5.m1.5.5.5.5.2.3.5.3">𝑡</ci></apply><ci id="S4.E5.m1.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3">𝑦</ci></apply></apply></apply></apply></apply><apply id="S4.E5.m1.6.6.1.2.cmml" xref="S4.E5.m1.6.6.1.1"><csymbol cd="latexml" id="S4.E5.m1.6.6.1.2.1.cmml" xref="S4.E5.m1.6.6.1.1.2">delimited-[]</csymbol><apply id="S4.E5.m1.6.6.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1"><minus id="S4.E5.m1.6.6.1.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1"></minus><apply id="S4.E5.m1.6.6.1.1.1.2.cmml" xref="S4.E5.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.2.1.cmml" xref="S4.E5.m1.6.6.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.6.6.1.1.1.2.2.cmml" xref="S4.E5.m1.6.6.1.1.1.2.2">ℒ</ci><apply id="S4.E5.m1.6.6.1.1.1.2.3.cmml" xref="S4.E5.m1.6.6.1.1.1.2.3"><times id="S4.E5.m1.6.6.1.1.1.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.2.3.1"></times><ci id="S4.E5.m1.6.6.1.1.1.2.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.2.3.2">𝑐</ci><ci id="S4.E5.m1.6.6.1.1.1.2.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.2.3.3">𝑙</ci><ci id="S4.E5.m1.6.6.1.1.1.2.3.4.cmml" xref="S4.E5.m1.6.6.1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S4.E5.m1.6.6.1.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3"><times id="S4.E5.m1.6.6.1.1.1.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.3.1"></times><apply id="S4.E5.m1.6.6.1.1.1.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.3.2.1.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2">subscript</csymbol><ci id="S4.E5.m1.6.6.1.1.1.3.2.2.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2.2">𝜆</ci><apply id="S4.E5.m1.6.6.1.1.1.3.2.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2.3"><times id="S4.E5.m1.6.6.1.1.1.3.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2.3.1"></times><ci id="S4.E5.m1.6.6.1.1.1.3.2.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2.3.2">𝐾</ci><ci id="S4.E5.m1.6.6.1.1.1.3.2.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3.2.3.3">𝐿</ci></apply></apply><apply id="S4.E5.m1.6.6.1.1.1.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3">subscript</csymbol><ci id="S4.E5.m1.6.6.1.1.1.3.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3.2">ℒ</ci><apply id="S4.E5.m1.6.6.1.1.1.3.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3.3"><times id="S4.E5.m1.6.6.1.1.1.3.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3.3.1"></times><ci id="S4.E5.m1.6.6.1.1.1.3.3.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3.3.2">𝐾</ci><ci id="S4.E5.m1.6.6.1.1.1.3.3.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.3.3.3.3">𝐿</ci></apply></apply></apply><apply id="S4.E5.m1.6.6.1.1.1.4.cmml" xref="S4.E5.m1.6.6.1.1.1.4"><times id="S4.E5.m1.6.6.1.1.1.4.1.cmml" xref="S4.E5.m1.6.6.1.1.1.4.1"></times><apply id="S4.E5.m1.6.6.1.1.1.4.2.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.4.2.1.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2">subscript</csymbol><ci id="S4.E5.m1.6.6.1.1.1.4.2.2.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.2">𝜆</ci><apply id="S4.E5.m1.6.6.1.1.1.4.2.3.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.3"><times id="S4.E5.m1.6.6.1.1.1.4.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.3.1"></times><ci id="S4.E5.m1.6.6.1.1.1.4.2.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.3.2">𝑀</ci><ci id="S4.E5.m1.6.6.1.1.1.4.2.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.3.3">𝑆</ci><ci id="S4.E5.m1.6.6.1.1.1.4.2.3.4.cmml" xref="S4.E5.m1.6.6.1.1.1.4.2.3.4">𝐸</ci></apply></apply><apply id="S4.E5.m1.6.6.1.1.1.4.3.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.4.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3">subscript</csymbol><ci id="S4.E5.m1.6.6.1.1.1.4.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.2">ℒ</ci><apply id="S4.E5.m1.6.6.1.1.1.4.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.3"><times id="S4.E5.m1.6.6.1.1.1.4.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.3.1"></times><ci id="S4.E5.m1.6.6.1.1.1.4.3.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.3.2">𝑀</ci><ci id="S4.E5.m1.6.6.1.1.1.4.3.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.3.3">𝑆</ci><ci id="S4.E5.m1.6.6.1.1.1.4.3.3.4.cmml" xref="S4.E5.m1.6.6.1.1.1.4.3.3.4">𝐸</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.6c">\small\!\!\!\min_{\theta_{gen}}\mathbb{E}_{\epsilon\sim\mathcal{N}(\mathbf{0},\mathbf{1}),y\sim Prob_{r}^{t}(y)}\left[\mathcal{L}_{cls}\!\!-\!\lambda_{KL}\mathcal{L}_{KL}\!\!-\!\lambda_{MSE}\mathcal{L}_{MSE}\right]\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p5.9" class="ltx_p">The trained generator is then used to perform data-free knowledge distillation which helps combat intra-task forgetting and achieves a high accuracy on the global data distribution of the current task. However, as the generator is trained to generate pseudo-data corresponding to the current task distribution only, a model fine-tuned with this pseudo-data suffers from inter-task forgetting as shown in our ablation experiments in <a href="#S5.SS2" title="5.2 Ablation studies and Additional Analysis ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>. To prevent this, we train a separate copy of the generator (<math id="S4.SS3.p5.3.m1.1" class="ltx_Math" alttext="\hat{\theta}_{gen}" display="inline"><semantics id="S4.SS3.p5.3.m1.1a"><msub id="S4.SS3.p5.3.m1.1.1" xref="S4.SS3.p5.3.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.3.m1.1.1.2" xref="S4.SS3.p5.3.m1.1.1.2.cmml"><mi id="S4.SS3.p5.3.m1.1.1.2.2" xref="S4.SS3.p5.3.m1.1.1.2.2.cmml">θ</mi><mo id="S4.SS3.p5.3.m1.1.1.2.1" xref="S4.SS3.p5.3.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p5.3.m1.1.1.3" xref="S4.SS3.p5.3.m1.1.1.3.cmml"><mi id="S4.SS3.p5.3.m1.1.1.3.2" xref="S4.SS3.p5.3.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m1.1.1.3.1" xref="S4.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.3.m1.1.1.3.3" xref="S4.SS3.p5.3.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m1.1.1.3.1a" xref="S4.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.3.m1.1.1.3.4" xref="S4.SS3.p5.3.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m1.1b"><apply id="S4.SS3.p5.3.m1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m1.1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1">subscript</csymbol><apply id="S4.SS3.p5.3.m1.1.1.2.cmml" xref="S4.SS3.p5.3.m1.1.1.2"><ci id="S4.SS3.p5.3.m1.1.1.2.1.cmml" xref="S4.SS3.p5.3.m1.1.1.2.1">^</ci><ci id="S4.SS3.p5.3.m1.1.1.2.2.cmml" xref="S4.SS3.p5.3.m1.1.1.2.2">𝜃</ci></apply><apply id="S4.SS3.p5.3.m1.1.1.3.cmml" xref="S4.SS3.p5.3.m1.1.1.3"><times id="S4.SS3.p5.3.m1.1.1.3.1.cmml" xref="S4.SS3.p5.3.m1.1.1.3.1"></times><ci id="S4.SS3.p5.3.m1.1.1.3.2.cmml" xref="S4.SS3.p5.3.m1.1.1.3.2">𝑔</ci><ci id="S4.SS3.p5.3.m1.1.1.3.3.cmml" xref="S4.SS3.p5.3.m1.1.1.3.3">𝑒</ci><ci id="S4.SS3.p5.3.m1.1.1.3.4.cmml" xref="S4.SS3.p5.3.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m1.1c">\hat{\theta}_{gen}</annotation></semantics></math>) to generate latents corresponding to the previously seen tasks with distribution <math id="S4.SS3.p5.4.m2.1" class="ltx_Math" alttext="Prob_{r}^{1:t-1}(y)" display="inline"><semantics id="S4.SS3.p5.4.m2.1a"><mrow id="S4.SS3.p5.4.m2.1.2" xref="S4.SS3.p5.4.m2.1.2.cmml"><mi id="S4.SS3.p5.4.m2.1.2.2" xref="S4.SS3.p5.4.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.4.m2.1.2.1" xref="S4.SS3.p5.4.m2.1.2.1.cmml">​</mo><mi id="S4.SS3.p5.4.m2.1.2.3" xref="S4.SS3.p5.4.m2.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.4.m2.1.2.1a" xref="S4.SS3.p5.4.m2.1.2.1.cmml">​</mo><mi id="S4.SS3.p5.4.m2.1.2.4" xref="S4.SS3.p5.4.m2.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.4.m2.1.2.1b" xref="S4.SS3.p5.4.m2.1.2.1.cmml">​</mo><msubsup id="S4.SS3.p5.4.m2.1.2.5" xref="S4.SS3.p5.4.m2.1.2.5.cmml"><mi id="S4.SS3.p5.4.m2.1.2.5.2.2" xref="S4.SS3.p5.4.m2.1.2.5.2.2.cmml">b</mi><mi id="S4.SS3.p5.4.m2.1.2.5.2.3" xref="S4.SS3.p5.4.m2.1.2.5.2.3.cmml">r</mi><mrow id="S4.SS3.p5.4.m2.1.2.5.3" xref="S4.SS3.p5.4.m2.1.2.5.3.cmml"><mn id="S4.SS3.p5.4.m2.1.2.5.3.2" xref="S4.SS3.p5.4.m2.1.2.5.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p5.4.m2.1.2.5.3.1" xref="S4.SS3.p5.4.m2.1.2.5.3.1.cmml">:</mo><mrow id="S4.SS3.p5.4.m2.1.2.5.3.3" xref="S4.SS3.p5.4.m2.1.2.5.3.3.cmml"><mi id="S4.SS3.p5.4.m2.1.2.5.3.3.2" xref="S4.SS3.p5.4.m2.1.2.5.3.3.2.cmml">t</mi><mo id="S4.SS3.p5.4.m2.1.2.5.3.3.1" xref="S4.SS3.p5.4.m2.1.2.5.3.3.1.cmml">−</mo><mn id="S4.SS3.p5.4.m2.1.2.5.3.3.3" xref="S4.SS3.p5.4.m2.1.2.5.3.3.3.cmml">1</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS3.p5.4.m2.1.2.1c" xref="S4.SS3.p5.4.m2.1.2.1.cmml">​</mo><mrow id="S4.SS3.p5.4.m2.1.2.6.2" xref="S4.SS3.p5.4.m2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p5.4.m2.1.2.6.2.1" xref="S4.SS3.p5.4.m2.1.2.cmml">(</mo><mi id="S4.SS3.p5.4.m2.1.1" xref="S4.SS3.p5.4.m2.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS3.p5.4.m2.1.2.6.2.2" xref="S4.SS3.p5.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m2.1b"><apply id="S4.SS3.p5.4.m2.1.2.cmml" xref="S4.SS3.p5.4.m2.1.2"><times id="S4.SS3.p5.4.m2.1.2.1.cmml" xref="S4.SS3.p5.4.m2.1.2.1"></times><ci id="S4.SS3.p5.4.m2.1.2.2.cmml" xref="S4.SS3.p5.4.m2.1.2.2">𝑃</ci><ci id="S4.SS3.p5.4.m2.1.2.3.cmml" xref="S4.SS3.p5.4.m2.1.2.3">𝑟</ci><ci id="S4.SS3.p5.4.m2.1.2.4.cmml" xref="S4.SS3.p5.4.m2.1.2.4">𝑜</ci><apply id="S4.SS3.p5.4.m2.1.2.5.cmml" xref="S4.SS3.p5.4.m2.1.2.5"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m2.1.2.5.1.cmml" xref="S4.SS3.p5.4.m2.1.2.5">superscript</csymbol><apply id="S4.SS3.p5.4.m2.1.2.5.2.cmml" xref="S4.SS3.p5.4.m2.1.2.5"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m2.1.2.5.2.1.cmml" xref="S4.SS3.p5.4.m2.1.2.5">subscript</csymbol><ci id="S4.SS3.p5.4.m2.1.2.5.2.2.cmml" xref="S4.SS3.p5.4.m2.1.2.5.2.2">𝑏</ci><ci id="S4.SS3.p5.4.m2.1.2.5.2.3.cmml" xref="S4.SS3.p5.4.m2.1.2.5.2.3">𝑟</ci></apply><apply id="S4.SS3.p5.4.m2.1.2.5.3.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3"><ci id="S4.SS3.p5.4.m2.1.2.5.3.1.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.1">:</ci><cn type="integer" id="S4.SS3.p5.4.m2.1.2.5.3.2.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.2">1</cn><apply id="S4.SS3.p5.4.m2.1.2.5.3.3.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.3"><minus id="S4.SS3.p5.4.m2.1.2.5.3.3.1.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.3.1"></minus><ci id="S4.SS3.p5.4.m2.1.2.5.3.3.2.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.3.2">𝑡</ci><cn type="integer" id="S4.SS3.p5.4.m2.1.2.5.3.3.3.cmml" xref="S4.SS3.p5.4.m2.1.2.5.3.3.3">1</cn></apply></apply></apply><ci id="S4.SS3.p5.4.m2.1.1.cmml" xref="S4.SS3.p5.4.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m2.1c">Prob_{r}^{1:t-1}(y)</annotation></semantics></math>. At the server side, we assume access to the key, prompt and classifier weights corresponding to the previous task’s global model which is the fine-tuned global model after the <math id="S4.SS3.p5.5.m3.1" class="ltx_Math" alttext="R^{th}" display="inline"><semantics id="S4.SS3.p5.5.m3.1a"><msup id="S4.SS3.p5.5.m3.1.1" xref="S4.SS3.p5.5.m3.1.1.cmml"><mi id="S4.SS3.p5.5.m3.1.1.2" xref="S4.SS3.p5.5.m3.1.1.2.cmml">R</mi><mrow id="S4.SS3.p5.5.m3.1.1.3" xref="S4.SS3.p5.5.m3.1.1.3.cmml"><mi id="S4.SS3.p5.5.m3.1.1.3.2" xref="S4.SS3.p5.5.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.5.m3.1.1.3.1" xref="S4.SS3.p5.5.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.5.m3.1.1.3.3" xref="S4.SS3.p5.5.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m3.1b"><apply id="S4.SS3.p5.5.m3.1.1.cmml" xref="S4.SS3.p5.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m3.1.1.1.cmml" xref="S4.SS3.p5.5.m3.1.1">superscript</csymbol><ci id="S4.SS3.p5.5.m3.1.1.2.cmml" xref="S4.SS3.p5.5.m3.1.1.2">𝑅</ci><apply id="S4.SS3.p5.5.m3.1.1.3.cmml" xref="S4.SS3.p5.5.m3.1.1.3"><times id="S4.SS3.p5.5.m3.1.1.3.1.cmml" xref="S4.SS3.p5.5.m3.1.1.3.1"></times><ci id="S4.SS3.p5.5.m3.1.1.3.2.cmml" xref="S4.SS3.p5.5.m3.1.1.3.2">𝑡</ci><ci id="S4.SS3.p5.5.m3.1.1.3.3.cmml" xref="S4.SS3.p5.5.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m3.1c">R^{th}</annotation></semantics></math> round of the task <math id="S4.SS3.p5.6.m4.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="S4.SS3.p5.6.m4.1a"><mrow id="S4.SS3.p5.6.m4.1.1" xref="S4.SS3.p5.6.m4.1.1.cmml"><mi id="S4.SS3.p5.6.m4.1.1.2" xref="S4.SS3.p5.6.m4.1.1.2.cmml">t</mi><mo id="S4.SS3.p5.6.m4.1.1.1" xref="S4.SS3.p5.6.m4.1.1.1.cmml">−</mo><mn id="S4.SS3.p5.6.m4.1.1.3" xref="S4.SS3.p5.6.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.6.m4.1b"><apply id="S4.SS3.p5.6.m4.1.1.cmml" xref="S4.SS3.p5.6.m4.1.1"><minus id="S4.SS3.p5.6.m4.1.1.1.cmml" xref="S4.SS3.p5.6.m4.1.1.1"></minus><ci id="S4.SS3.p5.6.m4.1.1.2.cmml" xref="S4.SS3.p5.6.m4.1.1.2">𝑡</ci><cn type="integer" id="S4.SS3.p5.6.m4.1.1.3.cmml" xref="S4.SS3.p5.6.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.6.m4.1c">t-1</annotation></semantics></math>. Similar to the above, we optimize for the classification and disagreement losses jointly. Here the classification loss <math id="S4.SS3.p5.7.m5.1" class="ltx_Math" alttext="\mathcal{L}_{cls}" display="inline"><semantics id="S4.SS3.p5.7.m5.1a"><msub id="S4.SS3.p5.7.m5.1.1" xref="S4.SS3.p5.7.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.7.m5.1.1.2" xref="S4.SS3.p5.7.m5.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p5.7.m5.1.1.3" xref="S4.SS3.p5.7.m5.1.1.3.cmml"><mi id="S4.SS3.p5.7.m5.1.1.3.2" xref="S4.SS3.p5.7.m5.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.7.m5.1.1.3.1" xref="S4.SS3.p5.7.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.7.m5.1.1.3.3" xref="S4.SS3.p5.7.m5.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.7.m5.1.1.3.1a" xref="S4.SS3.p5.7.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.7.m5.1.1.3.4" xref="S4.SS3.p5.7.m5.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.7.m5.1b"><apply id="S4.SS3.p5.7.m5.1.1.cmml" xref="S4.SS3.p5.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m5.1.1.1.cmml" xref="S4.SS3.p5.7.m5.1.1">subscript</csymbol><ci id="S4.SS3.p5.7.m5.1.1.2.cmml" xref="S4.SS3.p5.7.m5.1.1.2">ℒ</ci><apply id="S4.SS3.p5.7.m5.1.1.3.cmml" xref="S4.SS3.p5.7.m5.1.1.3"><times id="S4.SS3.p5.7.m5.1.1.3.1.cmml" xref="S4.SS3.p5.7.m5.1.1.3.1"></times><ci id="S4.SS3.p5.7.m5.1.1.3.2.cmml" xref="S4.SS3.p5.7.m5.1.1.3.2">𝑐</ci><ci id="S4.SS3.p5.7.m5.1.1.3.3.cmml" xref="S4.SS3.p5.7.m5.1.1.3.3">𝑙</ci><ci id="S4.SS3.p5.7.m5.1.1.3.4.cmml" xref="S4.SS3.p5.7.m5.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.7.m5.1c">\mathcal{L}_{cls}</annotation></semantics></math> is computed for the previous task server model and <math id="S4.SS3.p5.8.m6.1" class="ltx_Math" alttext="\mathcal{L}_{dis}" display="inline"><semantics id="S4.SS3.p5.8.m6.1a"><msub id="S4.SS3.p5.8.m6.1.1" xref="S4.SS3.p5.8.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.8.m6.1.1.2" xref="S4.SS3.p5.8.m6.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p5.8.m6.1.1.3" xref="S4.SS3.p5.8.m6.1.1.3.cmml"><mi id="S4.SS3.p5.8.m6.1.1.3.2" xref="S4.SS3.p5.8.m6.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.8.m6.1.1.3.1" xref="S4.SS3.p5.8.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.8.m6.1.1.3.3" xref="S4.SS3.p5.8.m6.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.8.m6.1.1.3.1a" xref="S4.SS3.p5.8.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.8.m6.1.1.3.4" xref="S4.SS3.p5.8.m6.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.8.m6.1b"><apply id="S4.SS3.p5.8.m6.1.1.cmml" xref="S4.SS3.p5.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.8.m6.1.1.1.cmml" xref="S4.SS3.p5.8.m6.1.1">subscript</csymbol><ci id="S4.SS3.p5.8.m6.1.1.2.cmml" xref="S4.SS3.p5.8.m6.1.1.2">ℒ</ci><apply id="S4.SS3.p5.8.m6.1.1.3.cmml" xref="S4.SS3.p5.8.m6.1.1.3"><times id="S4.SS3.p5.8.m6.1.1.3.1.cmml" xref="S4.SS3.p5.8.m6.1.1.3.1"></times><ci id="S4.SS3.p5.8.m6.1.1.3.2.cmml" xref="S4.SS3.p5.8.m6.1.1.3.2">𝑑</ci><ci id="S4.SS3.p5.8.m6.1.1.3.3.cmml" xref="S4.SS3.p5.8.m6.1.1.3.3">𝑖</ci><ci id="S4.SS3.p5.8.m6.1.1.3.4.cmml" xref="S4.SS3.p5.8.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.8.m6.1c">\mathcal{L}_{dis}</annotation></semantics></math> is computed between this and the intermediate server model.
The sampling probability <math id="S4.SS3.p5.9.m7.1" class="ltx_Math" alttext="Prob(y)" display="inline"><semantics id="S4.SS3.p5.9.m7.1a"><mrow id="S4.SS3.p5.9.m7.1.2" xref="S4.SS3.p5.9.m7.1.2.cmml"><mi id="S4.SS3.p5.9.m7.1.2.2" xref="S4.SS3.p5.9.m7.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.9.m7.1.2.1" xref="S4.SS3.p5.9.m7.1.2.1.cmml">​</mo><mi id="S4.SS3.p5.9.m7.1.2.3" xref="S4.SS3.p5.9.m7.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.9.m7.1.2.1a" xref="S4.SS3.p5.9.m7.1.2.1.cmml">​</mo><mi id="S4.SS3.p5.9.m7.1.2.4" xref="S4.SS3.p5.9.m7.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.9.m7.1.2.1b" xref="S4.SS3.p5.9.m7.1.2.1.cmml">​</mo><mi id="S4.SS3.p5.9.m7.1.2.5" xref="S4.SS3.p5.9.m7.1.2.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.9.m7.1.2.1c" xref="S4.SS3.p5.9.m7.1.2.1.cmml">​</mo><mrow id="S4.SS3.p5.9.m7.1.2.6.2" xref="S4.SS3.p5.9.m7.1.2.cmml"><mo stretchy="false" id="S4.SS3.p5.9.m7.1.2.6.2.1" xref="S4.SS3.p5.9.m7.1.2.cmml">(</mo><mi id="S4.SS3.p5.9.m7.1.1" xref="S4.SS3.p5.9.m7.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS3.p5.9.m7.1.2.6.2.2" xref="S4.SS3.p5.9.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.9.m7.1b"><apply id="S4.SS3.p5.9.m7.1.2.cmml" xref="S4.SS3.p5.9.m7.1.2"><times id="S4.SS3.p5.9.m7.1.2.1.cmml" xref="S4.SS3.p5.9.m7.1.2.1"></times><ci id="S4.SS3.p5.9.m7.1.2.2.cmml" xref="S4.SS3.p5.9.m7.1.2.2">𝑃</ci><ci id="S4.SS3.p5.9.m7.1.2.3.cmml" xref="S4.SS3.p5.9.m7.1.2.3">𝑟</ci><ci id="S4.SS3.p5.9.m7.1.2.4.cmml" xref="S4.SS3.p5.9.m7.1.2.4">𝑜</ci><ci id="S4.SS3.p5.9.m7.1.2.5.cmml" xref="S4.SS3.p5.9.m7.1.2.5">𝑏</ci><ci id="S4.SS3.p5.9.m7.1.1.cmml" xref="S4.SS3.p5.9.m7.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.9.m7.1c">Prob(y)</annotation></semantics></math> and weight coefficients are calculated using the label counts of instances seen until the previous task. We empirically show that using pseudo-data corresponding to past tasks for knowledge distillation helps mitigate inter-task forgetting.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Server Side : Latent Space Knowledge Distillation </h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Once the generator is trained to generate pseudo-latents corresponding to the current and previous tasks, we use it to efficiently fine-tune the intermediate server model <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="w_{avg}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">w</mi><mrow id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1a" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.1.m1.1.1.3.4" xref="S4.SS4.p1.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝑤</ci><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><times id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3.1"></times><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">𝑎</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3">𝑣</ci><ci id="S4.SS4.p1.1.m1.1.1.3.4.cmml" xref="S4.SS4.p1.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">w_{avg}</annotation></semantics></math>.
The output of the generator is in the input space of the classifier head as well as the prompting framework. This allows us to fine-tune the classifier head and key-prompt weights (<em id="S4.SS4.p1.1.1" class="ltx_emph ltx_font_italic">K</em> and <em id="S4.SS4.p1.1.2" class="ltx_emph ltx_font_italic">P</em>) using the generated pseudo data.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We use the key, prompt and classifier weights corresponding to the current round client models and the last-task server model to fine-tune the server model. As it operates in a low dimensional latent space, this distillation process is very cheap in terms of computation as compared to traditional distillation that trains the entire network. Also, this design does not require clients to share entire models with the server which reduces the client-server communication costs to a great extent and protects the privacy of the client model. While we introduce additional server overhead, it is important to note that, in the context of CFL, clients are typically edge devices with limited computing power, while servers have ample computational resources. We prioritize client-level efficiency while making efficient use of the server’s resources.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.2" class="ltx_p">To perform knowledge distillation, we first generate a batch of pseudo-data from the generator. We obtain pseudo-data corresponding to the current round from the generator by conditioning on class labels sampled from probability function <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="Prob_{r}^{t}(y)" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><mrow id="S4.SS4.p3.1.m1.1.2" xref="S4.SS4.p3.1.m1.1.2.cmml"><mi id="S4.SS4.p3.1.m1.1.2.2" xref="S4.SS4.p3.1.m1.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.1.2.1" xref="S4.SS4.p3.1.m1.1.2.1.cmml">​</mo><mi id="S4.SS4.p3.1.m1.1.2.3" xref="S4.SS4.p3.1.m1.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.1.2.1a" xref="S4.SS4.p3.1.m1.1.2.1.cmml">​</mo><mi id="S4.SS4.p3.1.m1.1.2.4" xref="S4.SS4.p3.1.m1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.1.2.1b" xref="S4.SS4.p3.1.m1.1.2.1.cmml">​</mo><msubsup id="S4.SS4.p3.1.m1.1.2.5" xref="S4.SS4.p3.1.m1.1.2.5.cmml"><mi id="S4.SS4.p3.1.m1.1.2.5.2.2" xref="S4.SS4.p3.1.m1.1.2.5.2.2.cmml">b</mi><mi id="S4.SS4.p3.1.m1.1.2.5.2.3" xref="S4.SS4.p3.1.m1.1.2.5.2.3.cmml">r</mi><mi id="S4.SS4.p3.1.m1.1.2.5.3" xref="S4.SS4.p3.1.m1.1.2.5.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.1.2.1c" xref="S4.SS4.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS4.p3.1.m1.1.2.6.2" xref="S4.SS4.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.1.m1.1.2.6.2.1" xref="S4.SS4.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS4.p3.1.m1.1.2.6.2.2" xref="S4.SS4.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.2"><times id="S4.SS4.p3.1.m1.1.2.1.cmml" xref="S4.SS4.p3.1.m1.1.2.1"></times><ci id="S4.SS4.p3.1.m1.1.2.2.cmml" xref="S4.SS4.p3.1.m1.1.2.2">𝑃</ci><ci id="S4.SS4.p3.1.m1.1.2.3.cmml" xref="S4.SS4.p3.1.m1.1.2.3">𝑟</ci><ci id="S4.SS4.p3.1.m1.1.2.4.cmml" xref="S4.SS4.p3.1.m1.1.2.4">𝑜</ci><apply id="S4.SS4.p3.1.m1.1.2.5.cmml" xref="S4.SS4.p3.1.m1.1.2.5"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.2.5.1.cmml" xref="S4.SS4.p3.1.m1.1.2.5">superscript</csymbol><apply id="S4.SS4.p3.1.m1.1.2.5.2.cmml" xref="S4.SS4.p3.1.m1.1.2.5"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.2.5.2.1.cmml" xref="S4.SS4.p3.1.m1.1.2.5">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.2.5.2.2.cmml" xref="S4.SS4.p3.1.m1.1.2.5.2.2">𝑏</ci><ci id="S4.SS4.p3.1.m1.1.2.5.2.3.cmml" xref="S4.SS4.p3.1.m1.1.2.5.2.3">𝑟</ci></apply><ci id="S4.SS4.p3.1.m1.1.2.5.3.cmml" xref="S4.SS4.p3.1.m1.1.2.5.3">𝑡</ci></apply><ci id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">Prob_{r}^{t}(y)</annotation></semantics></math>. Similarly, we use the respectively trained generator to get pseudo-data from previous tasks by conditioning on labels sampled from <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="Prob_{1:R}^{1:t-1}(y)" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><mrow id="S4.SS4.p3.2.m2.1.2" xref="S4.SS4.p3.2.m2.1.2.cmml"><mi id="S4.SS4.p3.2.m2.1.2.2" xref="S4.SS4.p3.2.m2.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.2.1" xref="S4.SS4.p3.2.m2.1.2.1.cmml">​</mo><mi id="S4.SS4.p3.2.m2.1.2.3" xref="S4.SS4.p3.2.m2.1.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.2.1a" xref="S4.SS4.p3.2.m2.1.2.1.cmml">​</mo><mi id="S4.SS4.p3.2.m2.1.2.4" xref="S4.SS4.p3.2.m2.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.2.1b" xref="S4.SS4.p3.2.m2.1.2.1.cmml">​</mo><msubsup id="S4.SS4.p3.2.m2.1.2.5" xref="S4.SS4.p3.2.m2.1.2.5.cmml"><mi id="S4.SS4.p3.2.m2.1.2.5.2.2" xref="S4.SS4.p3.2.m2.1.2.5.2.2.cmml">b</mi><mrow id="S4.SS4.p3.2.m2.1.2.5.2.3" xref="S4.SS4.p3.2.m2.1.2.5.2.3.cmml"><mn id="S4.SS4.p3.2.m2.1.2.5.2.3.2" xref="S4.SS4.p3.2.m2.1.2.5.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS4.p3.2.m2.1.2.5.2.3.1" xref="S4.SS4.p3.2.m2.1.2.5.2.3.1.cmml">:</mo><mi id="S4.SS4.p3.2.m2.1.2.5.2.3.3" xref="S4.SS4.p3.2.m2.1.2.5.2.3.3.cmml">R</mi></mrow><mrow id="S4.SS4.p3.2.m2.1.2.5.3" xref="S4.SS4.p3.2.m2.1.2.5.3.cmml"><mn id="S4.SS4.p3.2.m2.1.2.5.3.2" xref="S4.SS4.p3.2.m2.1.2.5.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.SS4.p3.2.m2.1.2.5.3.1" xref="S4.SS4.p3.2.m2.1.2.5.3.1.cmml">:</mo><mrow id="S4.SS4.p3.2.m2.1.2.5.3.3" xref="S4.SS4.p3.2.m2.1.2.5.3.3.cmml"><mi id="S4.SS4.p3.2.m2.1.2.5.3.3.2" xref="S4.SS4.p3.2.m2.1.2.5.3.3.2.cmml">t</mi><mo id="S4.SS4.p3.2.m2.1.2.5.3.3.1" xref="S4.SS4.p3.2.m2.1.2.5.3.3.1.cmml">−</mo><mn id="S4.SS4.p3.2.m2.1.2.5.3.3.3" xref="S4.SS4.p3.2.m2.1.2.5.3.3.3.cmml">1</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.2.1c" xref="S4.SS4.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS4.p3.2.m2.1.2.6.2" xref="S4.SS4.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.2.m2.1.2.6.2.1" xref="S4.SS4.p3.2.m2.1.2.cmml">(</mo><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS4.p3.2.m2.1.2.6.2.2" xref="S4.SS4.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.2.cmml" xref="S4.SS4.p3.2.m2.1.2"><times id="S4.SS4.p3.2.m2.1.2.1.cmml" xref="S4.SS4.p3.2.m2.1.2.1"></times><ci id="S4.SS4.p3.2.m2.1.2.2.cmml" xref="S4.SS4.p3.2.m2.1.2.2">𝑃</ci><ci id="S4.SS4.p3.2.m2.1.2.3.cmml" xref="S4.SS4.p3.2.m2.1.2.3">𝑟</ci><ci id="S4.SS4.p3.2.m2.1.2.4.cmml" xref="S4.SS4.p3.2.m2.1.2.4">𝑜</ci><apply id="S4.SS4.p3.2.m2.1.2.5.cmml" xref="S4.SS4.p3.2.m2.1.2.5"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.2.5.1.cmml" xref="S4.SS4.p3.2.m2.1.2.5">superscript</csymbol><apply id="S4.SS4.p3.2.m2.1.2.5.2.cmml" xref="S4.SS4.p3.2.m2.1.2.5"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.2.5.2.1.cmml" xref="S4.SS4.p3.2.m2.1.2.5">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.2.5.2.2.cmml" xref="S4.SS4.p3.2.m2.1.2.5.2.2">𝑏</ci><apply id="S4.SS4.p3.2.m2.1.2.5.2.3.cmml" xref="S4.SS4.p3.2.m2.1.2.5.2.3"><ci id="S4.SS4.p3.2.m2.1.2.5.2.3.1.cmml" xref="S4.SS4.p3.2.m2.1.2.5.2.3.1">:</ci><cn type="integer" id="S4.SS4.p3.2.m2.1.2.5.2.3.2.cmml" xref="S4.SS4.p3.2.m2.1.2.5.2.3.2">1</cn><ci id="S4.SS4.p3.2.m2.1.2.5.2.3.3.cmml" xref="S4.SS4.p3.2.m2.1.2.5.2.3.3">𝑅</ci></apply></apply><apply id="S4.SS4.p3.2.m2.1.2.5.3.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3"><ci id="S4.SS4.p3.2.m2.1.2.5.3.1.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.1">:</ci><cn type="integer" id="S4.SS4.p3.2.m2.1.2.5.3.2.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.2">1</cn><apply id="S4.SS4.p3.2.m2.1.2.5.3.3.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.3"><minus id="S4.SS4.p3.2.m2.1.2.5.3.3.1.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.3.1"></minus><ci id="S4.SS4.p3.2.m2.1.2.5.3.3.2.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p3.2.m2.1.2.5.3.3.3.cmml" xref="S4.SS4.p3.2.m2.1.2.5.3.3.3">1</cn></apply></apply></apply><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">Prob_{1:R}^{1:t-1}(y)</annotation></semantics></math> which models the collective label distribution until the last round of the previous task. We mix the current and previous task batches to form a single composite batch according to a hyperparameter named <span id="S4.SS4.p3.2.1" class="ltx_text ltx_font_italic">replay ratio</span> which is the size of the previous task batch to the current round batch.</p>
</div>
<div id="S4.SS4.p4" class="ltx_para">
<p id="S4.SS4.p4.1" class="ltx_p">First, to fine-tune the weights used for prompting, we pass the pseudo-data through the prompting mechanism of a model to obtain final prompts <em id="S4.SS4.p4.1.1" class="ltx_emph ltx_font_bold ltx_font_italic">p</em> which would serve as the target for distillation. We can obtain such <span id="S4.SS4.p4.1.2" class="ltx_text ltx_font_italic">final prompts</span> using the prompt and classifier components corresponding to active clients and the previous tasks. Note, we do not require full models to generate these targets. Now to fine-tune the server model, we optimize for the Mean Squared Error (MSE) loss between the final prompts generated by the intermediate server model and each individual model (clients and last-task server).</p>
</div>
<div id="S4.SS4.p5" class="ltx_para">
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="\small\mathcal{L}_{prompt}=\sum_{c\in C}\alpha_{r,t}^{c,y}\mathcal{L}_{MSE}^{c}+\zeta_{t-1}^{y}\mathcal{\textit{L}}_{MSE}^{t-1}," display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><msub id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E6.m1.5.5.1.1.2.2" xref="S4.E6.m1.5.5.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E6.m1.5.5.1.1.2.3" xref="S4.E6.m1.5.5.1.1.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.2" xref="S4.E6.m1.5.5.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.3.1" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.3" xref="S4.E6.m1.5.5.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.3.1a" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.4" xref="S4.E6.m1.5.5.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.3.1b" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.5" xref="S4.E6.m1.5.5.1.1.2.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.3.1c" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.6" xref="S4.E6.m1.5.5.1.1.2.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.3.1d" xref="S4.E6.m1.5.5.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.2.3.7" xref="S4.E6.m1.5.5.1.1.2.3.7.cmml">t</mi></mrow></msub><mo mathsize="90%" rspace="0.111em" id="S4.E6.m1.5.5.1.1.1" xref="S4.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml"><mrow id="S4.E6.m1.5.5.1.1.3.2" xref="S4.E6.m1.5.5.1.1.3.2.cmml"><munder id="S4.E6.m1.5.5.1.1.3.2.1" xref="S4.E6.m1.5.5.1.1.3.2.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E6.m1.5.5.1.1.3.2.1.2" xref="S4.E6.m1.5.5.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.1.1.3.2.1.3" xref="S4.E6.m1.5.5.1.1.3.2.1.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.1.3.2" xref="S4.E6.m1.5.5.1.1.3.2.1.3.2.cmml">c</mi><mo mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.1.3.1" xref="S4.E6.m1.5.5.1.1.3.2.1.3.1.cmml">∈</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.1.3.3" xref="S4.E6.m1.5.5.1.1.3.2.1.3.3.cmml">C</mi></mrow></munder><mrow id="S4.E6.m1.5.5.1.1.3.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.cmml"><msubsup id="S4.E6.m1.5.5.1.1.3.2.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.2.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.2.2.2.cmml">α</mi><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">r</mi><mo mathsize="90%" id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">t</mi></mrow><mrow id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">c</mi><mo mathsize="90%" id="S4.E6.m1.4.4.2.4.1" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml">y</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.2.2.1" xref="S4.E6.m1.5.5.1.1.3.2.2.1.cmml">​</mo><msubsup id="S4.E6.m1.5.5.1.1.3.2.2.3" xref="S4.E6.m1.5.5.1.1.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.2" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.2.cmml">ℒ</mi><mrow id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.2" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.3" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1a" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.4" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.4.cmml">E</mi></mrow><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.2.2.3.3" xref="S4.E6.m1.5.5.1.1.3.2.2.3.3.cmml">c</mi></msubsup></mrow></mrow><mo mathsize="90%" id="S4.E6.m1.5.5.1.1.3.1" xref="S4.E6.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S4.E6.m1.5.5.1.1.3.3" xref="S4.E6.m1.5.5.1.1.3.3.cmml"><msubsup id="S4.E6.m1.5.5.1.1.3.3.2" xref="S4.E6.m1.5.5.1.1.3.3.2.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.2.2.2" xref="S4.E6.m1.5.5.1.1.3.3.2.2.2.cmml">ζ</mi><mrow id="S4.E6.m1.5.5.1.1.3.3.2.2.3" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.2.2.3.2" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.2.2.3.1" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.1.cmml">−</mo><mn mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.2.2.3.3" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.2.3" xref="S4.E6.m1.5.5.1.1.3.3.2.3.cmml">y</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.3.1" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E6.m1.5.5.1.1.3.3.3" xref="S4.E6.m1.5.5.1.1.3.3.3.cmml"><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.2.2" xref="S4.E6.m1.5.5.1.1.3.3.3.2.2a.cmml">L</mtext><mrow id="S4.E6.m1.5.5.1.1.3.3.3.2.3" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.2.3.2" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.3.3.2.3.1" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.2.3.3" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.3.3.2.3.1a" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.2.3.4" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.4.cmml">E</mi></mrow><mrow id="S4.E6.m1.5.5.1.1.3.3.3.3" xref="S4.E6.m1.5.5.1.1.3.3.3.3.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.3.2" xref="S4.E6.m1.5.5.1.1.3.3.3.3.2.cmml">t</mi><mo mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.3.1" xref="S4.E6.m1.5.5.1.1.3.3.3.3.1.cmml">−</mo><mn mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.3.3" xref="S4.E6.m1.5.5.1.1.3.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><mo mathsize="90%" id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"></eq><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2">ℒ</ci><apply id="S4.E6.m1.5.5.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3"><times id="S4.E6.m1.5.5.1.1.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.2.3.1"></times><ci id="S4.E6.m1.5.5.1.1.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.2.3.2">𝑝</ci><ci id="S4.E6.m1.5.5.1.1.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.2.3.3">𝑟</ci><ci id="S4.E6.m1.5.5.1.1.2.3.4.cmml" xref="S4.E6.m1.5.5.1.1.2.3.4">𝑜</ci><ci id="S4.E6.m1.5.5.1.1.2.3.5.cmml" xref="S4.E6.m1.5.5.1.1.2.3.5">𝑚</ci><ci id="S4.E6.m1.5.5.1.1.2.3.6.cmml" xref="S4.E6.m1.5.5.1.1.2.3.6">𝑝</ci><ci id="S4.E6.m1.5.5.1.1.2.3.7.cmml" xref="S4.E6.m1.5.5.1.1.2.3.7">𝑡</ci></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"><plus id="S4.E6.m1.5.5.1.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1"></plus><apply id="S4.E6.m1.5.5.1.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2"><apply id="S4.E6.m1.5.5.1.1.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.1.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.3.2.1.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.2"></sum><apply id="S4.E6.m1.5.5.1.1.3.2.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.3"><in id="S4.E6.m1.5.5.1.1.3.2.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.3.1"></in><ci id="S4.E6.m1.5.5.1.1.3.2.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.3.2">𝑐</ci><ci id="S4.E6.m1.5.5.1.1.3.2.1.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1.3.3">𝐶</ci></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2"><times id="S4.E6.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.1"></times><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.2.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.2.2.2">𝛼</ci><list id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑟</ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝑡</ci></list></apply><list id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.4"><ci id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1">𝑐</ci><ci id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2">𝑦</ci></list></apply><apply id="S4.E6.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.2.2.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.3.2.2.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.2">ℒ</ci><apply id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3"><times id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.1"></times><ci id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.2">𝑀</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.3">𝑆</ci><ci id="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.4.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.2.3.4">𝐸</ci></apply></apply><ci id="S4.E6.m1.5.5.1.1.3.2.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.2.2.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3"><times id="S4.E6.m1.5.5.1.1.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.1"></times><apply id="S4.E6.m1.5.5.1.1.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.3.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.3.3.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.2.2">𝜁</ci><apply id="S4.E6.m1.5.5.1.1.3.3.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3"><minus id="S4.E6.m1.5.5.1.1.3.3.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.1"></minus><ci id="S4.E6.m1.5.5.1.1.3.3.2.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.2">𝑡</ci><cn type="integer" id="S4.E6.m1.5.5.1.1.3.3.2.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.5.5.1.1.3.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2.3">𝑦</ci></apply><apply id="S4.E6.m1.5.5.1.1.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.3.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.3.3.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.3.3.3.2.2a.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.2"><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S4.E6.m1.5.5.1.1.3.3.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.2">L</mtext></ci><apply id="S4.E6.m1.5.5.1.1.3.3.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3"><times id="S4.E6.m1.5.5.1.1.3.3.3.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.1"></times><ci id="S4.E6.m1.5.5.1.1.3.3.3.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.2">𝑀</ci><ci id="S4.E6.m1.5.5.1.1.3.3.3.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.3">𝑆</ci><ci id="S4.E6.m1.5.5.1.1.3.3.3.2.3.4.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.2.3.4">𝐸</ci></apply></apply><apply id="S4.E6.m1.5.5.1.1.3.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.3"><minus id="S4.E6.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.3.1"></minus><ci id="S4.E6.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.3.2">𝑡</ci><cn type="integer" id="S4.E6.m1.5.5.1.1.3.3.3.3.3.cmml" xref="S4.E6.m1.5.5.1.1.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\small\mathcal{L}_{prompt}=\sum_{c\in C}\alpha_{r,t}^{c,y}\mathcal{L}_{MSE}^{c}+\zeta_{t-1}^{y}\mathcal{\textit{L}}_{MSE}^{t-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS4.p6" class="ltx_para">
<p id="S4.SS4.p6.5" class="ltx_p">where <math id="S4.SS4.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{MSE}^{c}" display="inline"><semantics id="S4.SS4.p6.1.m1.1a"><msubsup id="S4.SS4.p6.1.m1.1.1" xref="S4.SS4.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p6.1.m1.1.1.2.2" xref="S4.SS4.p6.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.SS4.p6.1.m1.1.1.2.3" xref="S4.SS4.p6.1.m1.1.1.2.3.cmml"><mi id="S4.SS4.p6.1.m1.1.1.2.3.2" xref="S4.SS4.p6.1.m1.1.1.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p6.1.m1.1.1.2.3.1" xref="S4.SS4.p6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.p6.1.m1.1.1.2.3.3" xref="S4.SS4.p6.1.m1.1.1.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p6.1.m1.1.1.2.3.1a" xref="S4.SS4.p6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.p6.1.m1.1.1.2.3.4" xref="S4.SS4.p6.1.m1.1.1.2.3.4.cmml">E</mi></mrow><mi id="S4.SS4.p6.1.m1.1.1.3" xref="S4.SS4.p6.1.m1.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.1.m1.1b"><apply id="S4.SS4.p6.1.m1.1.1.cmml" xref="S4.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.1.m1.1.1.1.cmml" xref="S4.SS4.p6.1.m1.1.1">superscript</csymbol><apply id="S4.SS4.p6.1.m1.1.1.2.cmml" xref="S4.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.1.m1.1.1.2.1.cmml" xref="S4.SS4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p6.1.m1.1.1.2.2.cmml" xref="S4.SS4.p6.1.m1.1.1.2.2">ℒ</ci><apply id="S4.SS4.p6.1.m1.1.1.2.3.cmml" xref="S4.SS4.p6.1.m1.1.1.2.3"><times id="S4.SS4.p6.1.m1.1.1.2.3.1.cmml" xref="S4.SS4.p6.1.m1.1.1.2.3.1"></times><ci id="S4.SS4.p6.1.m1.1.1.2.3.2.cmml" xref="S4.SS4.p6.1.m1.1.1.2.3.2">𝑀</ci><ci id="S4.SS4.p6.1.m1.1.1.2.3.3.cmml" xref="S4.SS4.p6.1.m1.1.1.2.3.3">𝑆</ci><ci id="S4.SS4.p6.1.m1.1.1.2.3.4.cmml" xref="S4.SS4.p6.1.m1.1.1.2.3.4">𝐸</ci></apply></apply><ci id="S4.SS4.p6.1.m1.1.1.3.cmml" xref="S4.SS4.p6.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.1.m1.1c">\mathcal{L}_{MSE}^{c}</annotation></semantics></math> denotes the MSE loss between client <math id="S4.SS4.p6.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS4.p6.2.m2.1a"><mi id="S4.SS4.p6.2.m2.1.1" xref="S4.SS4.p6.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.2.m2.1b"><ci id="S4.SS4.p6.2.m2.1.1.cmml" xref="S4.SS4.p6.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.2.m2.1c">c</annotation></semantics></math> and the intermediate server model and <math id="S4.SS4.p6.3.m3.1" class="ltx_Math" alttext="\mathcal{\textit{L}}_{MSE}^{t-1}" display="inline"><semantics id="S4.SS4.p6.3.m3.1a"><msubsup id="S4.SS4.p6.3.m3.1.1" xref="S4.SS4.p6.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S4.SS4.p6.3.m3.1.1.2.2" xref="S4.SS4.p6.3.m3.1.1.2.2a.cmml">L</mtext><mrow id="S4.SS4.p6.3.m3.1.1.2.3" xref="S4.SS4.p6.3.m3.1.1.2.3.cmml"><mi id="S4.SS4.p6.3.m3.1.1.2.3.2" xref="S4.SS4.p6.3.m3.1.1.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p6.3.m3.1.1.2.3.1" xref="S4.SS4.p6.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.p6.3.m3.1.1.2.3.3" xref="S4.SS4.p6.3.m3.1.1.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p6.3.m3.1.1.2.3.1a" xref="S4.SS4.p6.3.m3.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.p6.3.m3.1.1.2.3.4" xref="S4.SS4.p6.3.m3.1.1.2.3.4.cmml">E</mi></mrow><mrow id="S4.SS4.p6.3.m3.1.1.3" xref="S4.SS4.p6.3.m3.1.1.3.cmml"><mi id="S4.SS4.p6.3.m3.1.1.3.2" xref="S4.SS4.p6.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p6.3.m3.1.1.3.1" xref="S4.SS4.p6.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS4.p6.3.m3.1.1.3.3" xref="S4.SS4.p6.3.m3.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.3.m3.1b"><apply id="S4.SS4.p6.3.m3.1.1.cmml" xref="S4.SS4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.3.m3.1.1.1.cmml" xref="S4.SS4.p6.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.p6.3.m3.1.1.2.cmml" xref="S4.SS4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.3.m3.1.1.2.1.cmml" xref="S4.SS4.p6.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p6.3.m3.1.1.2.2a.cmml" xref="S4.SS4.p6.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S4.SS4.p6.3.m3.1.1.2.2.cmml" xref="S4.SS4.p6.3.m3.1.1.2.2">L</mtext></ci><apply id="S4.SS4.p6.3.m3.1.1.2.3.cmml" xref="S4.SS4.p6.3.m3.1.1.2.3"><times id="S4.SS4.p6.3.m3.1.1.2.3.1.cmml" xref="S4.SS4.p6.3.m3.1.1.2.3.1"></times><ci id="S4.SS4.p6.3.m3.1.1.2.3.2.cmml" xref="S4.SS4.p6.3.m3.1.1.2.3.2">𝑀</ci><ci id="S4.SS4.p6.3.m3.1.1.2.3.3.cmml" xref="S4.SS4.p6.3.m3.1.1.2.3.3">𝑆</ci><ci id="S4.SS4.p6.3.m3.1.1.2.3.4.cmml" xref="S4.SS4.p6.3.m3.1.1.2.3.4">𝐸</ci></apply></apply><apply id="S4.SS4.p6.3.m3.1.1.3.cmml" xref="S4.SS4.p6.3.m3.1.1.3"><minus id="S4.SS4.p6.3.m3.1.1.3.1.cmml" xref="S4.SS4.p6.3.m3.1.1.3.1"></minus><ci id="S4.SS4.p6.3.m3.1.1.3.2.cmml" xref="S4.SS4.p6.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p6.3.m3.1.1.3.3.cmml" xref="S4.SS4.p6.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.3.m3.1c">\mathcal{\textit{L}}_{MSE}^{t-1}</annotation></semantics></math> denotes the MSE loss between the intermediate model and the previous task server model. Further, <math id="S4.SS4.p6.4.m4.1" class="ltx_Math" alttext="\zeta_{t-1}^{y}" display="inline"><semantics id="S4.SS4.p6.4.m4.1a"><msubsup id="S4.SS4.p6.4.m4.1.1" xref="S4.SS4.p6.4.m4.1.1.cmml"><mi id="S4.SS4.p6.4.m4.1.1.2.2" xref="S4.SS4.p6.4.m4.1.1.2.2.cmml">ζ</mi><mrow id="S4.SS4.p6.4.m4.1.1.2.3" xref="S4.SS4.p6.4.m4.1.1.2.3.cmml"><mi id="S4.SS4.p6.4.m4.1.1.2.3.2" xref="S4.SS4.p6.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S4.SS4.p6.4.m4.1.1.2.3.1" xref="S4.SS4.p6.4.m4.1.1.2.3.1.cmml">−</mo><mn id="S4.SS4.p6.4.m4.1.1.2.3.3" xref="S4.SS4.p6.4.m4.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p6.4.m4.1.1.3" xref="S4.SS4.p6.4.m4.1.1.3.cmml">y</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.4.m4.1b"><apply id="S4.SS4.p6.4.m4.1.1.cmml" xref="S4.SS4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.4.m4.1.1.1.cmml" xref="S4.SS4.p6.4.m4.1.1">superscript</csymbol><apply id="S4.SS4.p6.4.m4.1.1.2.cmml" xref="S4.SS4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.4.m4.1.1.2.1.cmml" xref="S4.SS4.p6.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p6.4.m4.1.1.2.2.cmml" xref="S4.SS4.p6.4.m4.1.1.2.2">𝜁</ci><apply id="S4.SS4.p6.4.m4.1.1.2.3.cmml" xref="S4.SS4.p6.4.m4.1.1.2.3"><minus id="S4.SS4.p6.4.m4.1.1.2.3.1.cmml" xref="S4.SS4.p6.4.m4.1.1.2.3.1"></minus><ci id="S4.SS4.p6.4.m4.1.1.2.3.2.cmml" xref="S4.SS4.p6.4.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p6.4.m4.1.1.2.3.3.cmml" xref="S4.SS4.p6.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS4.p6.4.m4.1.1.3.cmml" xref="S4.SS4.p6.4.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.4.m4.1c">\zeta_{t-1}^{y}</annotation></semantics></math> is an indicator variable which is set to 1 if <math id="S4.SS4.p6.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS4.p6.5.m5.1a"><mi id="S4.SS4.p6.5.m5.1.1" xref="S4.SS4.p6.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.5.m5.1b"><ci id="S4.SS4.p6.5.m5.1.1.cmml" xref="S4.SS4.p6.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.5.m5.1c">y</annotation></semantics></math> was seen in previous tasks and 0 if present in current task. 
<br class="ltx_break">Next, to fine-tune the classifier of the server model, we minimize the cross entropy loss. The cross-entropy loss is computed between the predictions of the server for a batch of pseudo latents and the class labels that the pseudo latents were conditioned on. Like in the prompt distillation, the batch contains both current round and previous task pseudo latents. Finally, we discard the client models and the generators and transfer the trained keys, prompts and classifier weights to next-round clients.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.6" class="ltx_p"><span id="S5.p1.6.1" class="ltx_text ltx_font_bold">Model Architecture.</span> We use the ViT-B/16 backbone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> pretrained on Imagenet-1K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> as the encoder for our method and all baselines. We use a prompt pool size (<math id="S5.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">M</annotation></semantics></math>) of 100 and a prompt length (<math id="S5.p1.2.m2.1" class="ltx_Math" alttext="L_{p}" display="inline"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">L</mi><mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝐿</ci><ci id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">L_{p}</annotation></semantics></math>) of 20 with dimension (<math id="S5.p1.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S5.p1.3.m3.1a"><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">D</annotation></semantics></math>) being 768 and insert prompts into 1-5 MSA layers of the ViT encoder following the standard practice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> and perform prefix-tuning as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, by prepending prompts to the keys and values of the MSA layers. The classifier (<math id="S5.p1.4.m4.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S5.p1.4.m4.1a"><mi id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.1b"><ci id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.1c">\phi</annotation></semantics></math>) is a fully-connected layer with input dimension <math id="S5.p1.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S5.p1.5.m5.1a"><mi id="S5.p1.5.m5.1.1" xref="S5.p1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S5.p1.5.m5.1b"><ci id="S5.p1.5.m5.1.1.cmml" xref="S5.p1.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.5.m5.1c">D</annotation></semantics></math> and output dimension equal to the number of classes. We implement the generator <math id="S5.p1.6.m6.1" class="ltx_Math" alttext="\theta_{gen}" display="inline"><semantics id="S5.p1.6.m6.1a"><msub id="S5.p1.6.m6.1.1" xref="S5.p1.6.m6.1.1.cmml"><mi id="S5.p1.6.m6.1.1.2" xref="S5.p1.6.m6.1.1.2.cmml">θ</mi><mrow id="S5.p1.6.m6.1.1.3" xref="S5.p1.6.m6.1.1.3.cmml"><mi id="S5.p1.6.m6.1.1.3.2" xref="S5.p1.6.m6.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.1.1.3.1" xref="S5.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S5.p1.6.m6.1.1.3.3" xref="S5.p1.6.m6.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.p1.6.m6.1.1.3.1a" xref="S5.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S5.p1.6.m6.1.1.3.4" xref="S5.p1.6.m6.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.6.m6.1b"><apply id="S5.p1.6.m6.1.1.cmml" xref="S5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.p1.6.m6.1.1.1.cmml" xref="S5.p1.6.m6.1.1">subscript</csymbol><ci id="S5.p1.6.m6.1.1.2.cmml" xref="S5.p1.6.m6.1.1.2">𝜃</ci><apply id="S5.p1.6.m6.1.1.3.cmml" xref="S5.p1.6.m6.1.1.3"><times id="S5.p1.6.m6.1.1.3.1.cmml" xref="S5.p1.6.m6.1.1.3.1"></times><ci id="S5.p1.6.m6.1.1.3.2.cmml" xref="S5.p1.6.m6.1.1.3.2">𝑔</ci><ci id="S5.p1.6.m6.1.1.3.3.cmml" xref="S5.p1.6.m6.1.1.3.3">𝑒</ci><ci id="S5.p1.6.m6.1.1.3.4.cmml" xref="S5.p1.6.m6.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.6.m6.1c">\theta_{gen}</annotation></semantics></math> using a three layer fully-connected network and train it for 100 epochs.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Datasets.</span> We conduct our experiments on three image classification datasets. First, we adapt CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> to our formulation as it is a commonly used benchmark in CFL. Additionally, we evaluate our methods on the larger-scale Imagenet-R <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> and DomainNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> which have been used in recent continual learning works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> but haven’t been explored in a continual federated learning setting. These datasets capture real-world distribution shifts that can be challenging for models pre-trained on ImageNet to generalize to. We divide these datasets into 10-task (CIFAR-100, ImageNet-R) and 5-task (DomainNet) benchmarks. The 10-task setups contain a longer task sequence with small number of classes per task whereas the 5-task setup has a shorter task sequence with more classes per task.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.40.3.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Results (%) on CIFAR-100<span id="S5.T1.4.2.2" class="ltx_text ltx_font_medium"> for a 10 task setup (10 classes per task). <math id="S5.T1.3.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T1.3.1.1.m1.1b"><msub id="S5.T1.3.1.1.m1.1.1" xref="S5.T1.3.1.1.m1.1.1.cmml"><mi id="S5.T1.3.1.1.m1.1.1.2" xref="S5.T1.3.1.1.m1.1.1.2.cmml">A</mi><mi id="S5.T1.3.1.1.m1.1.1.3" xref="S5.T1.3.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.m1.1c"><apply id="S5.T1.3.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.3.1.1.m1.1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.3.1.1.m1.1.1.2.cmml" xref="S5.T1.3.1.1.m1.1.1.2">𝐴</ci><ci id="S5.T1.3.1.1.m1.1.1.3.cmml" xref="S5.T1.3.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.m1.1d">A_{N}</annotation></semantics></math> gives the accuracy averaged over tasks and <math id="S5.T1.4.2.2.m2.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.T1.4.2.2.m2.1b"><msub id="S5.T1.4.2.2.m2.1.1" xref="S5.T1.4.2.2.m2.1.1.cmml"><mi id="S5.T1.4.2.2.m2.1.1.2" xref="S5.T1.4.2.2.m2.1.1.2.cmml">F</mi><mi id="S5.T1.4.2.2.m2.1.1.3" xref="S5.T1.4.2.2.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.2.m2.1c"><apply id="S5.T1.4.2.2.m2.1.1.cmml" xref="S5.T1.4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.T1.4.2.2.m2.1.1.1.cmml" xref="S5.T1.4.2.2.m2.1.1">subscript</csymbol><ci id="S5.T1.4.2.2.m2.1.1.2.cmml" xref="S5.T1.4.2.2.m2.1.1.2">𝐹</ci><ci id="S5.T1.4.2.2.m2.1.1.3.cmml" xref="S5.T1.4.2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.2.m2.1d">F_{N}</annotation></semantics></math> gives the average forgetting. We report the mean and standard deviation over 3 independent trials.
</span></span></figcaption>
<div id="S5.T1.37" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:155.8pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.1pt,3.6pt) scale(0.955518973331182,0.955518973331182) ;">
<table id="S5.T1.37.33" class="ltx_tabular ltx_align_middle">
<tr id="S5.T1.37.33.34" class="ltx_tr">
<td id="S5.T1.37.33.34.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Dataset</td>
<td id="S5.T1.37.33.34.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">CIFAR-100</td>
</tr>
<tr id="S5.T1.8.4.4" class="ltx_tr">
<td id="S5.T1.5.1.1.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Imbalance ratio (<math id="S5.T1.5.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.T1.5.1.1.1.m1.1a"><mi id="S5.T1.5.1.1.1.m1.1.1" xref="S5.T1.5.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T1.5.1.1.1.m1.1b"><ci id="S5.T1.5.1.1.1.m1.1.1.cmml" xref="S5.T1.5.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.1.1.1.m1.1c">\beta</annotation></semantics></math>)</td>
<td id="S5.T1.6.2.2.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="2">
<math id="S5.T1.6.2.2.2.m1.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S5.T1.6.2.2.2.m1.1a"><mrow id="S5.T1.6.2.2.2.m1.1.1" xref="S5.T1.6.2.2.2.m1.1.1.cmml"><mi id="S5.T1.6.2.2.2.m1.1.1.2" xref="S5.T1.6.2.2.2.m1.1.1.2.cmml">β</mi><mo id="S5.T1.6.2.2.2.m1.1.1.1" xref="S5.T1.6.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T1.6.2.2.2.m1.1.1.3" xref="S5.T1.6.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.6.2.2.2.m1.1b"><apply id="S5.T1.6.2.2.2.m1.1.1.cmml" xref="S5.T1.6.2.2.2.m1.1.1"><eq id="S5.T1.6.2.2.2.m1.1.1.1.cmml" xref="S5.T1.6.2.2.2.m1.1.1.1"></eq><ci id="S5.T1.6.2.2.2.m1.1.1.2.cmml" xref="S5.T1.6.2.2.2.m1.1.1.2">𝛽</ci><cn type="integer" id="S5.T1.6.2.2.2.m1.1.1.3.cmml" xref="S5.T1.6.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.2.2.2.m1.1c">\beta=1</annotation></semantics></math> (No Imbalance)</td>
<td id="S5.T1.7.3.3.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="S5.T1.7.3.3.3.m1.1" class="ltx_Math" alttext="\beta=0.05" display="inline"><semantics id="S5.T1.7.3.3.3.m1.1a"><mrow id="S5.T1.7.3.3.3.m1.1.1" xref="S5.T1.7.3.3.3.m1.1.1.cmml"><mi id="S5.T1.7.3.3.3.m1.1.1.2" xref="S5.T1.7.3.3.3.m1.1.1.2.cmml">β</mi><mo id="S5.T1.7.3.3.3.m1.1.1.1" xref="S5.T1.7.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S5.T1.7.3.3.3.m1.1.1.3" xref="S5.T1.7.3.3.3.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.7.3.3.3.m1.1b"><apply id="S5.T1.7.3.3.3.m1.1.1.cmml" xref="S5.T1.7.3.3.3.m1.1.1"><eq id="S5.T1.7.3.3.3.m1.1.1.1.cmml" xref="S5.T1.7.3.3.3.m1.1.1.1"></eq><ci id="S5.T1.7.3.3.3.m1.1.1.2.cmml" xref="S5.T1.7.3.3.3.m1.1.1.2">𝛽</ci><cn type="float" id="S5.T1.7.3.3.3.m1.1.1.3.cmml" xref="S5.T1.7.3.3.3.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.3.3.3.m1.1c">\beta=0.05</annotation></semantics></math></td>
<td id="S5.T1.8.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.8.4.4.4.m1.1" class="ltx_Math" alttext="\beta=0.01" display="inline"><semantics id="S5.T1.8.4.4.4.m1.1a"><mrow id="S5.T1.8.4.4.4.m1.1.1" xref="S5.T1.8.4.4.4.m1.1.1.cmml"><mi id="S5.T1.8.4.4.4.m1.1.1.2" xref="S5.T1.8.4.4.4.m1.1.1.2.cmml">β</mi><mo id="S5.T1.8.4.4.4.m1.1.1.1" xref="S5.T1.8.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S5.T1.8.4.4.4.m1.1.1.3" xref="S5.T1.8.4.4.4.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.8.4.4.4.m1.1b"><apply id="S5.T1.8.4.4.4.m1.1.1.cmml" xref="S5.T1.8.4.4.4.m1.1.1"><eq id="S5.T1.8.4.4.4.m1.1.1.1.cmml" xref="S5.T1.8.4.4.4.m1.1.1.1"></eq><ci id="S5.T1.8.4.4.4.m1.1.1.2.cmml" xref="S5.T1.8.4.4.4.m1.1.1.2">𝛽</ci><cn type="float" id="S5.T1.8.4.4.4.m1.1.1.3.cmml" xref="S5.T1.8.4.4.4.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.4.4.4.m1.1c">\beta=0.01</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.16.12.12" class="ltx_tr">
<td id="S5.T1.16.12.12.9" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="S5.T1.10.6.6.2" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T1.9.5.5.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T1.9.5.5.1.m1.1a"><msub id="S5.T1.9.5.5.1.m1.1.1" xref="S5.T1.9.5.5.1.m1.1.1.cmml"><mi id="S5.T1.9.5.5.1.m1.1.1.2" xref="S5.T1.9.5.5.1.m1.1.1.2.cmml">A</mi><mi id="S5.T1.9.5.5.1.m1.1.1.3" xref="S5.T1.9.5.5.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.9.5.5.1.m1.1b"><apply id="S5.T1.9.5.5.1.m1.1.1.cmml" xref="S5.T1.9.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.9.5.5.1.m1.1.1.1.cmml" xref="S5.T1.9.5.5.1.m1.1.1">subscript</csymbol><ci id="S5.T1.9.5.5.1.m1.1.1.2.cmml" xref="S5.T1.9.5.5.1.m1.1.1.2">𝐴</ci><ci id="S5.T1.9.5.5.1.m1.1.1.3.cmml" xref="S5.T1.9.5.5.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.5.5.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T1.10.6.6.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.10.6.6.2.m2.1a"><mo stretchy="false" id="S5.T1.10.6.6.2.m2.1.1" xref="S5.T1.10.6.6.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.10.6.6.2.m2.1b"><ci id="S5.T1.10.6.6.2.m2.1.1.cmml" xref="S5.T1.10.6.6.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.6.6.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S5.T1.12.8.8.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="S5.T1.11.7.7.3.m1.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.T1.11.7.7.3.m1.1a"><msub id="S5.T1.11.7.7.3.m1.1.1" xref="S5.T1.11.7.7.3.m1.1.1.cmml"><mi id="S5.T1.11.7.7.3.m1.1.1.2" xref="S5.T1.11.7.7.3.m1.1.1.2.cmml">F</mi><mi id="S5.T1.11.7.7.3.m1.1.1.3" xref="S5.T1.11.7.7.3.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.11.7.7.3.m1.1b"><apply id="S5.T1.11.7.7.3.m1.1.1.cmml" xref="S5.T1.11.7.7.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.11.7.7.3.m1.1.1.1.cmml" xref="S5.T1.11.7.7.3.m1.1.1">subscript</csymbol><ci id="S5.T1.11.7.7.3.m1.1.1.2.cmml" xref="S5.T1.11.7.7.3.m1.1.1.2">𝐹</ci><ci id="S5.T1.11.7.7.3.m1.1.1.3.cmml" xref="S5.T1.11.7.7.3.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.7.7.3.m1.1c">F_{N}</annotation></semantics></math> (<math id="S5.T1.12.8.8.4.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.12.8.8.4.m2.1a"><mo stretchy="false" id="S5.T1.12.8.8.4.m2.1.1" xref="S5.T1.12.8.8.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.12.8.8.4.m2.1b"><ci id="S5.T1.12.8.8.4.m2.1.1.cmml" xref="S5.T1.12.8.8.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.8.8.4.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="S5.T1.14.10.10.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="S5.T1.13.9.9.5.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T1.13.9.9.5.m1.1a"><msub id="S5.T1.13.9.9.5.m1.1.1" xref="S5.T1.13.9.9.5.m1.1.1.cmml"><mi id="S5.T1.13.9.9.5.m1.1.1.2" xref="S5.T1.13.9.9.5.m1.1.1.2.cmml">A</mi><mi id="S5.T1.13.9.9.5.m1.1.1.3" xref="S5.T1.13.9.9.5.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.13.9.9.5.m1.1b"><apply id="S5.T1.13.9.9.5.m1.1.1.cmml" xref="S5.T1.13.9.9.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.13.9.9.5.m1.1.1.1.cmml" xref="S5.T1.13.9.9.5.m1.1.1">subscript</csymbol><ci id="S5.T1.13.9.9.5.m1.1.1.2.cmml" xref="S5.T1.13.9.9.5.m1.1.1.2">𝐴</ci><ci id="S5.T1.13.9.9.5.m1.1.1.3.cmml" xref="S5.T1.13.9.9.5.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.9.9.5.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T1.14.10.10.6.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.14.10.10.6.m2.1a"><mo stretchy="false" id="S5.T1.14.10.10.6.m2.1.1" xref="S5.T1.14.10.10.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.10.10.6.m2.1b"><ci id="S5.T1.14.10.10.6.m2.1.1.cmml" xref="S5.T1.14.10.10.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.10.10.6.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S5.T1.16.12.12.8" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T1.15.11.11.7.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T1.15.11.11.7.m1.1a"><msub id="S5.T1.15.11.11.7.m1.1.1" xref="S5.T1.15.11.11.7.m1.1.1.cmml"><mi id="S5.T1.15.11.11.7.m1.1.1.2" xref="S5.T1.15.11.11.7.m1.1.1.2.cmml">A</mi><mi id="S5.T1.15.11.11.7.m1.1.1.3" xref="S5.T1.15.11.11.7.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.15.11.11.7.m1.1b"><apply id="S5.T1.15.11.11.7.m1.1.1.cmml" xref="S5.T1.15.11.11.7.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.15.11.11.7.m1.1.1.1.cmml" xref="S5.T1.15.11.11.7.m1.1.1">subscript</csymbol><ci id="S5.T1.15.11.11.7.m1.1.1.2.cmml" xref="S5.T1.15.11.11.7.m1.1.1.2">𝐴</ci><ci id="S5.T1.15.11.11.7.m1.1.1.3.cmml" xref="S5.T1.15.11.11.7.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.11.11.7.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T1.16.12.12.8.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.16.12.12.8.m2.1a"><mo stretchy="false" id="S5.T1.16.12.12.8.m2.1.1" xref="S5.T1.16.12.12.8.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.12.12.8.m2.1b"><ci id="S5.T1.16.12.12.8.m2.1.1.cmml" xref="S5.T1.16.12.12.8.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.12.12.8.m2.1c">\uparrow</annotation></semantics></math>)</td>
</tr>
<tr id="S5.T1.17.13.13" class="ltx_tr">
<td id="S5.T1.17.13.13.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Prompting (Centralized)</td>
<td id="S5.T1.17.13.13.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.17.13.13.1.m1.1" class="ltx_Math" alttext="85.35" display="inline"><semantics id="S5.T1.17.13.13.1.m1.1a"><mn id="S5.T1.17.13.13.1.m1.1.1" xref="S5.T1.17.13.13.1.m1.1.1.cmml">85.35</mn><annotation-xml encoding="MathML-Content" id="S5.T1.17.13.13.1.m1.1b"><cn type="float" id="S5.T1.17.13.13.1.m1.1.1.cmml" xref="S5.T1.17.13.13.1.m1.1.1">85.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.13.13.1.m1.1c">85.35</annotation></semantics></math></td>
<td id="S5.T1.17.13.13.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">-</td>
<td id="S5.T1.17.13.13.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">-</td>
<td id="S5.T1.17.13.13.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S5.T1.21.17.17" class="ltx_tr">
<td id="S5.T1.21.17.17.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">FedAvg-FT</td>
<td id="S5.T1.18.14.14.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.18.14.14.1.m1.1" class="ltx_Math" alttext="10.23\pm 1.10" display="inline"><semantics id="S5.T1.18.14.14.1.m1.1a"><mrow id="S5.T1.18.14.14.1.m1.1.1" xref="S5.T1.18.14.14.1.m1.1.1.cmml"><mn id="S5.T1.18.14.14.1.m1.1.1.2" xref="S5.T1.18.14.14.1.m1.1.1.2.cmml">10.23</mn><mo id="S5.T1.18.14.14.1.m1.1.1.1" xref="S5.T1.18.14.14.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.18.14.14.1.m1.1.1.3" xref="S5.T1.18.14.14.1.m1.1.1.3.cmml">1.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.18.14.14.1.m1.1b"><apply id="S5.T1.18.14.14.1.m1.1.1.cmml" xref="S5.T1.18.14.14.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.18.14.14.1.m1.1.1.1.cmml" xref="S5.T1.18.14.14.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.18.14.14.1.m1.1.1.2.cmml" xref="S5.T1.18.14.14.1.m1.1.1.2">10.23</cn><cn type="float" id="S5.T1.18.14.14.1.m1.1.1.3.cmml" xref="S5.T1.18.14.14.1.m1.1.1.3">1.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.14.14.1.m1.1c">10.23\pm 1.10</annotation></semantics></math></td>
<td id="S5.T1.19.15.15.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="S5.T1.19.15.15.2.m1.1" class="ltx_Math" alttext="31.74\pm 0.80" display="inline"><semantics id="S5.T1.19.15.15.2.m1.1a"><mrow id="S5.T1.19.15.15.2.m1.1.1" xref="S5.T1.19.15.15.2.m1.1.1.cmml"><mn id="S5.T1.19.15.15.2.m1.1.1.2" xref="S5.T1.19.15.15.2.m1.1.1.2.cmml">31.74</mn><mo id="S5.T1.19.15.15.2.m1.1.1.1" xref="S5.T1.19.15.15.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.19.15.15.2.m1.1.1.3" xref="S5.T1.19.15.15.2.m1.1.1.3.cmml">0.80</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.19.15.15.2.m1.1b"><apply id="S5.T1.19.15.15.2.m1.1.1.cmml" xref="S5.T1.19.15.15.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.19.15.15.2.m1.1.1.1.cmml" xref="S5.T1.19.15.15.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.19.15.15.2.m1.1.1.2.cmml" xref="S5.T1.19.15.15.2.m1.1.1.2">31.74</cn><cn type="float" id="S5.T1.19.15.15.2.m1.1.1.3.cmml" xref="S5.T1.19.15.15.2.m1.1.1.3">0.80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.15.15.2.m1.1c">31.74\pm 0.80</annotation></semantics></math></td>
<td id="S5.T1.20.16.16.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="S5.T1.20.16.16.3.m1.1" class="ltx_Math" alttext="8.81\pm 1.53" display="inline"><semantics id="S5.T1.20.16.16.3.m1.1a"><mrow id="S5.T1.20.16.16.3.m1.1.1" xref="S5.T1.20.16.16.3.m1.1.1.cmml"><mn id="S5.T1.20.16.16.3.m1.1.1.2" xref="S5.T1.20.16.16.3.m1.1.1.2.cmml">8.81</mn><mo id="S5.T1.20.16.16.3.m1.1.1.1" xref="S5.T1.20.16.16.3.m1.1.1.1.cmml">±</mo><mn id="S5.T1.20.16.16.3.m1.1.1.3" xref="S5.T1.20.16.16.3.m1.1.1.3.cmml">1.53</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.20.16.16.3.m1.1b"><apply id="S5.T1.20.16.16.3.m1.1.1.cmml" xref="S5.T1.20.16.16.3.m1.1.1"><csymbol cd="latexml" id="S5.T1.20.16.16.3.m1.1.1.1.cmml" xref="S5.T1.20.16.16.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.20.16.16.3.m1.1.1.2.cmml" xref="S5.T1.20.16.16.3.m1.1.1.2">8.81</cn><cn type="float" id="S5.T1.20.16.16.3.m1.1.1.3.cmml" xref="S5.T1.20.16.16.3.m1.1.1.3">1.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.16.16.3.m1.1c">8.81\pm 1.53</annotation></semantics></math></td>
<td id="S5.T1.21.17.17.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.21.17.17.4.m1.1" class="ltx_Math" alttext="9.18\pm 1.26" display="inline"><semantics id="S5.T1.21.17.17.4.m1.1a"><mrow id="S5.T1.21.17.17.4.m1.1.1" xref="S5.T1.21.17.17.4.m1.1.1.cmml"><mn id="S5.T1.21.17.17.4.m1.1.1.2" xref="S5.T1.21.17.17.4.m1.1.1.2.cmml">9.18</mn><mo id="S5.T1.21.17.17.4.m1.1.1.1" xref="S5.T1.21.17.17.4.m1.1.1.1.cmml">±</mo><mn id="S5.T1.21.17.17.4.m1.1.1.3" xref="S5.T1.21.17.17.4.m1.1.1.3.cmml">1.26</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.21.17.17.4.m1.1b"><apply id="S5.T1.21.17.17.4.m1.1.1.cmml" xref="S5.T1.21.17.17.4.m1.1.1"><csymbol cd="latexml" id="S5.T1.21.17.17.4.m1.1.1.1.cmml" xref="S5.T1.21.17.17.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.21.17.17.4.m1.1.1.2.cmml" xref="S5.T1.21.17.17.4.m1.1.1.2">9.18</cn><cn type="float" id="S5.T1.21.17.17.4.m1.1.1.3.cmml" xref="S5.T1.21.17.17.4.m1.1.1.3">1.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.17.17.4.m1.1c">9.18\pm 1.26</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.25.21.21" class="ltx_tr">
<td id="S5.T1.25.21.21.5" class="ltx_td ltx_align_center ltx_border_rr">FedLwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="S5.T1.22.18.18.1" class="ltx_td ltx_align_center"><math id="S5.T1.22.18.18.1.m1.1" class="ltx_Math" alttext="59.08\pm 1.06" display="inline"><semantics id="S5.T1.22.18.18.1.m1.1a"><mrow id="S5.T1.22.18.18.1.m1.1.1" xref="S5.T1.22.18.18.1.m1.1.1.cmml"><mn id="S5.T1.22.18.18.1.m1.1.1.2" xref="S5.T1.22.18.18.1.m1.1.1.2.cmml">59.08</mn><mo id="S5.T1.22.18.18.1.m1.1.1.1" xref="S5.T1.22.18.18.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.22.18.18.1.m1.1.1.3" xref="S5.T1.22.18.18.1.m1.1.1.3.cmml">1.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.22.18.18.1.m1.1b"><apply id="S5.T1.22.18.18.1.m1.1.1.cmml" xref="S5.T1.22.18.18.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.22.18.18.1.m1.1.1.1.cmml" xref="S5.T1.22.18.18.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.22.18.18.1.m1.1.1.2.cmml" xref="S5.T1.22.18.18.1.m1.1.1.2">59.08</cn><cn type="float" id="S5.T1.22.18.18.1.m1.1.1.3.cmml" xref="S5.T1.22.18.18.1.m1.1.1.3">1.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.18.18.1.m1.1c">59.08\pm 1.06</annotation></semantics></math></td>
<td id="S5.T1.23.19.19.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.23.19.19.2.m1.1" class="ltx_Math" alttext="12.39\pm 0.76" display="inline"><semantics id="S5.T1.23.19.19.2.m1.1a"><mrow id="S5.T1.23.19.19.2.m1.1.1" xref="S5.T1.23.19.19.2.m1.1.1.cmml"><mn id="S5.T1.23.19.19.2.m1.1.1.2" xref="S5.T1.23.19.19.2.m1.1.1.2.cmml">12.39</mn><mo id="S5.T1.23.19.19.2.m1.1.1.1" xref="S5.T1.23.19.19.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.23.19.19.2.m1.1.1.3" xref="S5.T1.23.19.19.2.m1.1.1.3.cmml">0.76</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.23.19.19.2.m1.1b"><apply id="S5.T1.23.19.19.2.m1.1.1.cmml" xref="S5.T1.23.19.19.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.23.19.19.2.m1.1.1.1.cmml" xref="S5.T1.23.19.19.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.23.19.19.2.m1.1.1.2.cmml" xref="S5.T1.23.19.19.2.m1.1.1.2">12.39</cn><cn type="float" id="S5.T1.23.19.19.2.m1.1.1.3.cmml" xref="S5.T1.23.19.19.2.m1.1.1.3">0.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.19.19.2.m1.1c">12.39\pm 0.76</annotation></semantics></math></td>
<td id="S5.T1.24.20.20.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.24.20.20.3.m1.1" class="ltx_Math" alttext="50.40\pm 0.88" display="inline"><semantics id="S5.T1.24.20.20.3.m1.1a"><mrow id="S5.T1.24.20.20.3.m1.1.1" xref="S5.T1.24.20.20.3.m1.1.1.cmml"><mn id="S5.T1.24.20.20.3.m1.1.1.2" xref="S5.T1.24.20.20.3.m1.1.1.2.cmml">50.40</mn><mo id="S5.T1.24.20.20.3.m1.1.1.1" xref="S5.T1.24.20.20.3.m1.1.1.1.cmml">±</mo><mn id="S5.T1.24.20.20.3.m1.1.1.3" xref="S5.T1.24.20.20.3.m1.1.1.3.cmml">0.88</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.24.20.20.3.m1.1b"><apply id="S5.T1.24.20.20.3.m1.1.1.cmml" xref="S5.T1.24.20.20.3.m1.1.1"><csymbol cd="latexml" id="S5.T1.24.20.20.3.m1.1.1.1.cmml" xref="S5.T1.24.20.20.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.24.20.20.3.m1.1.1.2.cmml" xref="S5.T1.24.20.20.3.m1.1.1.2">50.40</cn><cn type="float" id="S5.T1.24.20.20.3.m1.1.1.3.cmml" xref="S5.T1.24.20.20.3.m1.1.1.3">0.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.20.20.3.m1.1c">50.40\pm 0.88</annotation></semantics></math></td>
<td id="S5.T1.25.21.21.4" class="ltx_td ltx_align_center"><math id="S5.T1.25.21.21.4.m1.1" class="ltx_Math" alttext="40.39\pm 1.06" display="inline"><semantics id="S5.T1.25.21.21.4.m1.1a"><mrow id="S5.T1.25.21.21.4.m1.1.1" xref="S5.T1.25.21.21.4.m1.1.1.cmml"><mn id="S5.T1.25.21.21.4.m1.1.1.2" xref="S5.T1.25.21.21.4.m1.1.1.2.cmml">40.39</mn><mo id="S5.T1.25.21.21.4.m1.1.1.1" xref="S5.T1.25.21.21.4.m1.1.1.1.cmml">±</mo><mn id="S5.T1.25.21.21.4.m1.1.1.3" xref="S5.T1.25.21.21.4.m1.1.1.3.cmml">1.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.25.21.21.4.m1.1b"><apply id="S5.T1.25.21.21.4.m1.1.1.cmml" xref="S5.T1.25.21.21.4.m1.1.1"><csymbol cd="latexml" id="S5.T1.25.21.21.4.m1.1.1.1.cmml" xref="S5.T1.25.21.21.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.25.21.21.4.m1.1.1.2.cmml" xref="S5.T1.25.21.21.4.m1.1.1.2">40.39</cn><cn type="float" id="S5.T1.25.21.21.4.m1.1.1.3.cmml" xref="S5.T1.25.21.21.4.m1.1.1.3">1.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.21.21.4.m1.1c">40.39\pm 1.06</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.29.25.25" class="ltx_tr">
<td id="S5.T1.29.25.25.5" class="ltx_td ltx_align_center ltx_border_rr">FedAvg-Prompt</td>
<td id="S5.T1.26.22.22.1" class="ltx_td ltx_align_center"><math id="S5.T1.26.22.22.1.m1.1" class="ltx_Math" alttext="67.34\pm 1.42" display="inline"><semantics id="S5.T1.26.22.22.1.m1.1a"><mrow id="S5.T1.26.22.22.1.m1.1.1" xref="S5.T1.26.22.22.1.m1.1.1.cmml"><mn id="S5.T1.26.22.22.1.m1.1.1.2" xref="S5.T1.26.22.22.1.m1.1.1.2.cmml">67.34</mn><mo id="S5.T1.26.22.22.1.m1.1.1.1" xref="S5.T1.26.22.22.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.26.22.22.1.m1.1.1.3" xref="S5.T1.26.22.22.1.m1.1.1.3.cmml">1.42</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.26.22.22.1.m1.1b"><apply id="S5.T1.26.22.22.1.m1.1.1.cmml" xref="S5.T1.26.22.22.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.26.22.22.1.m1.1.1.1.cmml" xref="S5.T1.26.22.22.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.26.22.22.1.m1.1.1.2.cmml" xref="S5.T1.26.22.22.1.m1.1.1.2">67.34</cn><cn type="float" id="S5.T1.26.22.22.1.m1.1.1.3.cmml" xref="S5.T1.26.22.22.1.m1.1.1.3">1.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.22.22.1.m1.1c">67.34\pm 1.42</annotation></semantics></math></td>
<td id="S5.T1.27.23.23.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.27.23.23.2.m1.1" class="ltx_Math" alttext="8.38\pm 0.42" display="inline"><semantics id="S5.T1.27.23.23.2.m1.1a"><mrow id="S5.T1.27.23.23.2.m1.1.1" xref="S5.T1.27.23.23.2.m1.1.1.cmml"><mn id="S5.T1.27.23.23.2.m1.1.1.2" xref="S5.T1.27.23.23.2.m1.1.1.2.cmml">8.38</mn><mo id="S5.T1.27.23.23.2.m1.1.1.1" xref="S5.T1.27.23.23.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.27.23.23.2.m1.1.1.3" xref="S5.T1.27.23.23.2.m1.1.1.3.cmml">0.42</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.27.23.23.2.m1.1b"><apply id="S5.T1.27.23.23.2.m1.1.1.cmml" xref="S5.T1.27.23.23.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.27.23.23.2.m1.1.1.1.cmml" xref="S5.T1.27.23.23.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.27.23.23.2.m1.1.1.2.cmml" xref="S5.T1.27.23.23.2.m1.1.1.2">8.38</cn><cn type="float" id="S5.T1.27.23.23.2.m1.1.1.3.cmml" xref="S5.T1.27.23.23.2.m1.1.1.3">0.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.23.23.2.m1.1c">8.38\pm 0.42</annotation></semantics></math></td>
<td id="S5.T1.28.24.24.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.28.24.24.3.m1.1" class="ltx_Math" alttext="62.72\pm 1.79" display="inline"><semantics id="S5.T1.28.24.24.3.m1.1a"><mrow id="S5.T1.28.24.24.3.m1.1.1" xref="S5.T1.28.24.24.3.m1.1.1.cmml"><mn id="S5.T1.28.24.24.3.m1.1.1.2" xref="S5.T1.28.24.24.3.m1.1.1.2.cmml">62.72</mn><mo id="S5.T1.28.24.24.3.m1.1.1.1" xref="S5.T1.28.24.24.3.m1.1.1.1.cmml">±</mo><mn id="S5.T1.28.24.24.3.m1.1.1.3" xref="S5.T1.28.24.24.3.m1.1.1.3.cmml">1.79</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.28.24.24.3.m1.1b"><apply id="S5.T1.28.24.24.3.m1.1.1.cmml" xref="S5.T1.28.24.24.3.m1.1.1"><csymbol cd="latexml" id="S5.T1.28.24.24.3.m1.1.1.1.cmml" xref="S5.T1.28.24.24.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.28.24.24.3.m1.1.1.2.cmml" xref="S5.T1.28.24.24.3.m1.1.1.2">62.72</cn><cn type="float" id="S5.T1.28.24.24.3.m1.1.1.3.cmml" xref="S5.T1.28.24.24.3.m1.1.1.3">1.79</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.24.24.3.m1.1c">62.72\pm 1.79</annotation></semantics></math></td>
<td id="S5.T1.29.25.25.4" class="ltx_td ltx_align_center"><math id="S5.T1.29.25.25.4.m1.1" class="ltx_Math" alttext="54.43\pm 1.57" display="inline"><semantics id="S5.T1.29.25.25.4.m1.1a"><mrow id="S5.T1.29.25.25.4.m1.1.1" xref="S5.T1.29.25.25.4.m1.1.1.cmml"><mn id="S5.T1.29.25.25.4.m1.1.1.2" xref="S5.T1.29.25.25.4.m1.1.1.2.cmml">54.43</mn><mo id="S5.T1.29.25.25.4.m1.1.1.1" xref="S5.T1.29.25.25.4.m1.1.1.1.cmml">±</mo><mn id="S5.T1.29.25.25.4.m1.1.1.3" xref="S5.T1.29.25.25.4.m1.1.1.3.cmml">1.57</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.29.25.25.4.m1.1b"><apply id="S5.T1.29.25.25.4.m1.1.1.cmml" xref="S5.T1.29.25.25.4.m1.1.1"><csymbol cd="latexml" id="S5.T1.29.25.25.4.m1.1.1.1.cmml" xref="S5.T1.29.25.25.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.29.25.25.4.m1.1.1.2.cmml" xref="S5.T1.29.25.25.4.m1.1.1.2">54.43</cn><cn type="float" id="S5.T1.29.25.25.4.m1.1.1.3.cmml" xref="S5.T1.29.25.25.4.m1.1.1.3">1.57</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.25.25.4.m1.1c">54.43\pm 1.57</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.33.29.29" class="ltx_tr">
<td id="S5.T1.33.29.29.5" class="ltx_td ltx_align_center ltx_border_rr">FedProx-Prompt</td>
<td id="S5.T1.30.26.26.1" class="ltx_td ltx_align_center"><math id="S5.T1.30.26.26.1.m1.1" class="ltx_Math" alttext="69.38\pm 1.39" display="inline"><semantics id="S5.T1.30.26.26.1.m1.1a"><mrow id="S5.T1.30.26.26.1.m1.1.1" xref="S5.T1.30.26.26.1.m1.1.1.cmml"><mn id="S5.T1.30.26.26.1.m1.1.1.2" xref="S5.T1.30.26.26.1.m1.1.1.2.cmml">69.38</mn><mo id="S5.T1.30.26.26.1.m1.1.1.1" xref="S5.T1.30.26.26.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.30.26.26.1.m1.1.1.3" xref="S5.T1.30.26.26.1.m1.1.1.3.cmml">1.39</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.30.26.26.1.m1.1b"><apply id="S5.T1.30.26.26.1.m1.1.1.cmml" xref="S5.T1.30.26.26.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.30.26.26.1.m1.1.1.1.cmml" xref="S5.T1.30.26.26.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.30.26.26.1.m1.1.1.2.cmml" xref="S5.T1.30.26.26.1.m1.1.1.2">69.38</cn><cn type="float" id="S5.T1.30.26.26.1.m1.1.1.3.cmml" xref="S5.T1.30.26.26.1.m1.1.1.3">1.39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.26.26.1.m1.1c">69.38\pm 1.39</annotation></semantics></math></td>
<td id="S5.T1.31.27.27.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.31.27.27.2.m1.1" class="ltx_Math" alttext="7.18\pm 0.65" display="inline"><semantics id="S5.T1.31.27.27.2.m1.1a"><mrow id="S5.T1.31.27.27.2.m1.1.1" xref="S5.T1.31.27.27.2.m1.1.1.cmml"><mn id="S5.T1.31.27.27.2.m1.1.1.2" xref="S5.T1.31.27.27.2.m1.1.1.2.cmml">7.18</mn><mo id="S5.T1.31.27.27.2.m1.1.1.1" xref="S5.T1.31.27.27.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.31.27.27.2.m1.1.1.3" xref="S5.T1.31.27.27.2.m1.1.1.3.cmml">0.65</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.31.27.27.2.m1.1b"><apply id="S5.T1.31.27.27.2.m1.1.1.cmml" xref="S5.T1.31.27.27.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.31.27.27.2.m1.1.1.1.cmml" xref="S5.T1.31.27.27.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.31.27.27.2.m1.1.1.2.cmml" xref="S5.T1.31.27.27.2.m1.1.1.2">7.18</cn><cn type="float" id="S5.T1.31.27.27.2.m1.1.1.3.cmml" xref="S5.T1.31.27.27.2.m1.1.1.3">0.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.27.27.2.m1.1c">7.18\pm 0.65</annotation></semantics></math></td>
<td id="S5.T1.32.28.28.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T1.32.28.28.3.m1.1" class="ltx_Math" alttext="62.66\pm 1.94" display="inline"><semantics id="S5.T1.32.28.28.3.m1.1a"><mrow id="S5.T1.32.28.28.3.m1.1.1" xref="S5.T1.32.28.28.3.m1.1.1.cmml"><mn id="S5.T1.32.28.28.3.m1.1.1.2" xref="S5.T1.32.28.28.3.m1.1.1.2.cmml">62.66</mn><mo id="S5.T1.32.28.28.3.m1.1.1.1" xref="S5.T1.32.28.28.3.m1.1.1.1.cmml">±</mo><mn id="S5.T1.32.28.28.3.m1.1.1.3" xref="S5.T1.32.28.28.3.m1.1.1.3.cmml">1.94</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.32.28.28.3.m1.1b"><apply id="S5.T1.32.28.28.3.m1.1.1.cmml" xref="S5.T1.32.28.28.3.m1.1.1"><csymbol cd="latexml" id="S5.T1.32.28.28.3.m1.1.1.1.cmml" xref="S5.T1.32.28.28.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.32.28.28.3.m1.1.1.2.cmml" xref="S5.T1.32.28.28.3.m1.1.1.2">62.66</cn><cn type="float" id="S5.T1.32.28.28.3.m1.1.1.3.cmml" xref="S5.T1.32.28.28.3.m1.1.1.3">1.94</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.28.28.3.m1.1c">62.66\pm 1.94</annotation></semantics></math></td>
<td id="S5.T1.33.29.29.4" class="ltx_td ltx_align_center"><math id="S5.T1.33.29.29.4.m1.1" class="ltx_Math" alttext="53.72\pm 1.25" display="inline"><semantics id="S5.T1.33.29.29.4.m1.1a"><mrow id="S5.T1.33.29.29.4.m1.1.1" xref="S5.T1.33.29.29.4.m1.1.1.cmml"><mn id="S5.T1.33.29.29.4.m1.1.1.2" xref="S5.T1.33.29.29.4.m1.1.1.2.cmml">53.72</mn><mo id="S5.T1.33.29.29.4.m1.1.1.1" xref="S5.T1.33.29.29.4.m1.1.1.1.cmml">±</mo><mn id="S5.T1.33.29.29.4.m1.1.1.3" xref="S5.T1.33.29.29.4.m1.1.1.3.cmml">1.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.33.29.29.4.m1.1b"><apply id="S5.T1.33.29.29.4.m1.1.1.cmml" xref="S5.T1.33.29.29.4.m1.1.1"><csymbol cd="latexml" id="S5.T1.33.29.29.4.m1.1.1.1.cmml" xref="S5.T1.33.29.29.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.33.29.29.4.m1.1.1.2.cmml" xref="S5.T1.33.29.29.4.m1.1.1.2">53.72</cn><cn type="float" id="S5.T1.33.29.29.4.m1.1.1.3.cmml" xref="S5.T1.33.29.29.4.m1.1.1.3">1.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.29.29.4.m1.1c">53.72\pm 1.25</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.37.33.33" class="ltx_tr">
<td id="S5.T1.37.33.33.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="S5.T1.37.33.33.5.1" class="ltx_text ltx_font_bold">HePCo (Ours)</span></td>
<td id="S5.T1.34.30.30.1" class="ltx_td ltx_align_center ltx_border_b"><math id="S5.T1.34.30.30.1.m1.1" class="ltx_Math" alttext="\bm{76.54\pm 1.14}" display="inline"><semantics id="S5.T1.34.30.30.1.m1.1a"><mrow id="S5.T1.34.30.30.1.m1.1.1" xref="S5.T1.34.30.30.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.34.30.30.1.m1.1.1.2" xref="S5.T1.34.30.30.1.m1.1.1.2.cmml">76.54</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.34.30.30.1.m1.1.1.1" xref="S5.T1.34.30.30.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.34.30.30.1.m1.1.1.3" xref="S5.T1.34.30.30.1.m1.1.1.3.cmml">1.14</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.34.30.30.1.m1.1b"><apply id="S5.T1.34.30.30.1.m1.1.1.cmml" xref="S5.T1.34.30.30.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.34.30.30.1.m1.1.1.1.cmml" xref="S5.T1.34.30.30.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.34.30.30.1.m1.1.1.2.cmml" xref="S5.T1.34.30.30.1.m1.1.1.2">76.54</cn><cn type="float" id="S5.T1.34.30.30.1.m1.1.1.3.cmml" xref="S5.T1.34.30.30.1.m1.1.1.3">1.14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.30.30.1.m1.1c">\bm{76.54\pm 1.14}</annotation></semantics></math></td>
<td id="S5.T1.35.31.31.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="S5.T1.35.31.31.2.m1.1" class="ltx_Math" alttext="\bm{6.61\pm 0.73}" display="inline"><semantics id="S5.T1.35.31.31.2.m1.1a"><mrow id="S5.T1.35.31.31.2.m1.1.1" xref="S5.T1.35.31.31.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.35.31.31.2.m1.1.1.2" xref="S5.T1.35.31.31.2.m1.1.1.2.cmml">6.61</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.35.31.31.2.m1.1.1.1" xref="S5.T1.35.31.31.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.35.31.31.2.m1.1.1.3" xref="S5.T1.35.31.31.2.m1.1.1.3.cmml">0.73</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.35.31.31.2.m1.1b"><apply id="S5.T1.35.31.31.2.m1.1.1.cmml" xref="S5.T1.35.31.31.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.35.31.31.2.m1.1.1.1.cmml" xref="S5.T1.35.31.31.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.35.31.31.2.m1.1.1.2.cmml" xref="S5.T1.35.31.31.2.m1.1.1.2">6.61</cn><cn type="float" id="S5.T1.35.31.31.2.m1.1.1.3.cmml" xref="S5.T1.35.31.31.2.m1.1.1.3">0.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.31.31.2.m1.1c">\bm{6.61\pm 0.73}</annotation></semantics></math></td>
<td id="S5.T1.36.32.32.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="S5.T1.36.32.32.3.m1.1" class="ltx_Math" alttext="\bm{70.34\pm 1.08}" display="inline"><semantics id="S5.T1.36.32.32.3.m1.1a"><mrow id="S5.T1.36.32.32.3.m1.1.1" xref="S5.T1.36.32.32.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.36.32.32.3.m1.1.1.2" xref="S5.T1.36.32.32.3.m1.1.1.2.cmml">70.34</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.36.32.32.3.m1.1.1.1" xref="S5.T1.36.32.32.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.36.32.32.3.m1.1.1.3" xref="S5.T1.36.32.32.3.m1.1.1.3.cmml">1.08</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.36.32.32.3.m1.1b"><apply id="S5.T1.36.32.32.3.m1.1.1.cmml" xref="S5.T1.36.32.32.3.m1.1.1"><csymbol cd="latexml" id="S5.T1.36.32.32.3.m1.1.1.1.cmml" xref="S5.T1.36.32.32.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.36.32.32.3.m1.1.1.2.cmml" xref="S5.T1.36.32.32.3.m1.1.1.2">70.34</cn><cn type="float" id="S5.T1.36.32.32.3.m1.1.1.3.cmml" xref="S5.T1.36.32.32.3.m1.1.1.3">1.08</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.32.32.3.m1.1c">\bm{70.34\pm 1.08}</annotation></semantics></math></td>
<td id="S5.T1.37.33.33.4" class="ltx_td ltx_align_center ltx_border_b"><math id="S5.T1.37.33.33.4.m1.1" class="ltx_Math" alttext="\bm{61.70\pm 1.48}" display="inline"><semantics id="S5.T1.37.33.33.4.m1.1a"><mrow id="S5.T1.37.33.33.4.m1.1.1" xref="S5.T1.37.33.33.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.37.33.33.4.m1.1.1.2" xref="S5.T1.37.33.33.4.m1.1.1.2.cmml">61.70</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.37.33.33.4.m1.1.1.1" xref="S5.T1.37.33.33.4.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T1.37.33.33.4.m1.1.1.3" xref="S5.T1.37.33.33.4.m1.1.1.3.cmml">1.48</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.37.33.33.4.m1.1b"><apply id="S5.T1.37.33.33.4.m1.1.1.cmml" xref="S5.T1.37.33.33.4.m1.1.1"><csymbol cd="latexml" id="S5.T1.37.33.33.4.m1.1.1.1.cmml" xref="S5.T1.37.33.33.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.37.33.33.4.m1.1.1.2.cmml" xref="S5.T1.37.33.33.4.m1.1.1.2">61.70</cn><cn type="float" id="S5.T1.37.33.33.4.m1.1.1.3.cmml" xref="S5.T1.37.33.33.4.m1.1.1.3">1.48</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.33.33.4.m1.1c">\bm{61.70\pm 1.48}</annotation></semantics></math></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.35.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Results (%) on ImageNet-R and DomainNet<span id="S5.T2.2.1.1" class="ltx_text ltx_font_medium">. Imagenet-R results are for a 10 task setup (20 classes per task) and DomainNet for 5 tasks (69 classes per task). <math id="S5.T2.2.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.T2.2.1.1.m1.1b"><mi id="S5.T2.2.1.1.m1.1.1" xref="S5.T2.2.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T2.2.1.1.m1.1c"><ci id="S5.T2.2.1.1.m1.1.1.cmml" xref="S5.T2.2.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.1.1.m1.1d">\beta</annotation></semantics></math> is set to 1 for all methods. We report results over 3 independent trials. </span></span></figcaption>
<table id="S5.T2.32" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.32.31" class="ltx_tr">
<td id="S5.T2.32.31.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Dataset</td>
<td id="S5.T2.32.31.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="2">ImageNet-R</td>
<td id="S5.T2.32.31.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2">DomainNet</td>
</tr>
<tr id="S5.T2.10.8" class="ltx_tr">
<td id="S5.T2.10.8.9" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="S5.T2.4.2.2" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T2.3.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T2.3.1.1.m1.1a"><msub id="S5.T2.3.1.1.m1.1.1" xref="S5.T2.3.1.1.m1.1.1.cmml"><mi id="S5.T2.3.1.1.m1.1.1.2" xref="S5.T2.3.1.1.m1.1.1.2.cmml">A</mi><mi id="S5.T2.3.1.1.m1.1.1.3" xref="S5.T2.3.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.m1.1b"><apply id="S5.T2.3.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.3.1.1.m1.1.1.1.cmml" xref="S5.T2.3.1.1.m1.1.1">subscript</csymbol><ci id="S5.T2.3.1.1.m1.1.1.2.cmml" xref="S5.T2.3.1.1.m1.1.1.2">𝐴</ci><ci id="S5.T2.3.1.1.m1.1.1.3.cmml" xref="S5.T2.3.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T2.4.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.4.2.2.m2.1a"><mo stretchy="false" id="S5.T2.4.2.2.m2.1.1" xref="S5.T2.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.m2.1b"><ci id="S5.T2.4.2.2.m2.1.1.cmml" xref="S5.T2.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S5.T2.6.4.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="S5.T2.5.3.3.m1.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.T2.5.3.3.m1.1a"><msub id="S5.T2.5.3.3.m1.1.1" xref="S5.T2.5.3.3.m1.1.1.cmml"><mi id="S5.T2.5.3.3.m1.1.1.2" xref="S5.T2.5.3.3.m1.1.1.2.cmml">F</mi><mi id="S5.T2.5.3.3.m1.1.1.3" xref="S5.T2.5.3.3.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.m1.1b"><apply id="S5.T2.5.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.5.3.3.m1.1.1.1.cmml" xref="S5.T2.5.3.3.m1.1.1">subscript</csymbol><ci id="S5.T2.5.3.3.m1.1.1.2.cmml" xref="S5.T2.5.3.3.m1.1.1.2">𝐹</ci><ci id="S5.T2.5.3.3.m1.1.1.3.cmml" xref="S5.T2.5.3.3.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.3.3.m1.1c">F_{N}</annotation></semantics></math> (<math id="S5.T2.6.4.4.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.6.4.4.m2.1a"><mo stretchy="false" id="S5.T2.6.4.4.m2.1.1" xref="S5.T2.6.4.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.m2.1b"><ci id="S5.T2.6.4.4.m2.1.1.cmml" xref="S5.T2.6.4.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.4.4.m2.1c">\downarrow</annotation></semantics></math>)</td>
<td id="S5.T2.8.6.6" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T2.7.5.5.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T2.7.5.5.m1.1a"><msub id="S5.T2.7.5.5.m1.1.1" xref="S5.T2.7.5.5.m1.1.1.cmml"><mi id="S5.T2.7.5.5.m1.1.1.2" xref="S5.T2.7.5.5.m1.1.1.2.cmml">A</mi><mi id="S5.T2.7.5.5.m1.1.1.3" xref="S5.T2.7.5.5.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.7.5.5.m1.1b"><apply id="S5.T2.7.5.5.m1.1.1.cmml" xref="S5.T2.7.5.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.7.5.5.m1.1.1.1.cmml" xref="S5.T2.7.5.5.m1.1.1">subscript</csymbol><ci id="S5.T2.7.5.5.m1.1.1.2.cmml" xref="S5.T2.7.5.5.m1.1.1.2">𝐴</ci><ci id="S5.T2.7.5.5.m1.1.1.3.cmml" xref="S5.T2.7.5.5.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.5.5.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T2.8.6.6.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.8.6.6.m2.1a"><mo stretchy="false" id="S5.T2.8.6.6.m2.1.1" xref="S5.T2.8.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.6.6.m2.1b"><ci id="S5.T2.8.6.6.m2.1.1.cmml" xref="S5.T2.8.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.6.6.m2.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S5.T2.10.8.8" class="ltx_td ltx_align_center ltx_border_t">
<math id="S5.T2.9.7.7.m1.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.T2.9.7.7.m1.1a"><msub id="S5.T2.9.7.7.m1.1.1" xref="S5.T2.9.7.7.m1.1.1.cmml"><mi id="S5.T2.9.7.7.m1.1.1.2" xref="S5.T2.9.7.7.m1.1.1.2.cmml">F</mi><mi id="S5.T2.9.7.7.m1.1.1.3" xref="S5.T2.9.7.7.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.9.7.7.m1.1b"><apply id="S5.T2.9.7.7.m1.1.1.cmml" xref="S5.T2.9.7.7.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.9.7.7.m1.1.1.1.cmml" xref="S5.T2.9.7.7.m1.1.1">subscript</csymbol><ci id="S5.T2.9.7.7.m1.1.1.2.cmml" xref="S5.T2.9.7.7.m1.1.1.2">𝐹</ci><ci id="S5.T2.9.7.7.m1.1.1.3.cmml" xref="S5.T2.9.7.7.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.7.7.m1.1c">F_{N}</annotation></semantics></math> (<math id="S5.T2.10.8.8.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.10.8.8.m2.1a"><mo stretchy="false" id="S5.T2.10.8.8.m2.1.1" xref="S5.T2.10.8.8.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.8.8.m2.1b"><ci id="S5.T2.10.8.8.m2.1.1.cmml" xref="S5.T2.10.8.8.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.8.8.m2.1c">\downarrow</annotation></semantics></math>)</td>
</tr>
<tr id="S5.T2.12.10" class="ltx_tr">
<td id="S5.T2.12.10.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Prompting (Centralized)</td>
<td id="S5.T2.11.9.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.11.9.1.m1.1" class="ltx_Math" alttext="72.28" display="inline"><semantics id="S5.T2.11.9.1.m1.1a"><mn id="S5.T2.11.9.1.m1.1.1" xref="S5.T2.11.9.1.m1.1.1.cmml">72.28</mn><annotation-xml encoding="MathML-Content" id="S5.T2.11.9.1.m1.1b"><cn type="float" id="S5.T2.11.9.1.m1.1.1.cmml" xref="S5.T2.11.9.1.m1.1.1">72.28</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.9.1.m1.1c">72.28</annotation></semantics></math></td>
<td id="S5.T2.12.10.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">-</td>
<td id="S5.T2.12.10.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.12.10.2.m1.1" class="ltx_Math" alttext="71.33" display="inline"><semantics id="S5.T2.12.10.2.m1.1a"><mn id="S5.T2.12.10.2.m1.1.1" xref="S5.T2.12.10.2.m1.1.1.cmml">71.33</mn><annotation-xml encoding="MathML-Content" id="S5.T2.12.10.2.m1.1b"><cn type="float" id="S5.T2.12.10.2.m1.1.1.cmml" xref="S5.T2.12.10.2.m1.1.1">71.33</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.10.2.m1.1c">71.33</annotation></semantics></math></td>
<td id="S5.T2.12.10.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S5.T2.16.14" class="ltx_tr">
<td id="S5.T2.16.14.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">FedAvg-FT</td>
<td id="S5.T2.13.11.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.13.11.1.m1.1" class="ltx_Math" alttext="12.03\pm 0.75" display="inline"><semantics id="S5.T2.13.11.1.m1.1a"><mrow id="S5.T2.13.11.1.m1.1.1" xref="S5.T2.13.11.1.m1.1.1.cmml"><mn id="S5.T2.13.11.1.m1.1.1.2" xref="S5.T2.13.11.1.m1.1.1.2.cmml">12.03</mn><mo id="S5.T2.13.11.1.m1.1.1.1" xref="S5.T2.13.11.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.13.11.1.m1.1.1.3" xref="S5.T2.13.11.1.m1.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.13.11.1.m1.1b"><apply id="S5.T2.13.11.1.m1.1.1.cmml" xref="S5.T2.13.11.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.13.11.1.m1.1.1.1.cmml" xref="S5.T2.13.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.13.11.1.m1.1.1.2.cmml" xref="S5.T2.13.11.1.m1.1.1.2">12.03</cn><cn type="float" id="S5.T2.13.11.1.m1.1.1.3.cmml" xref="S5.T2.13.11.1.m1.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.11.1.m1.1c">12.03\pm 0.75</annotation></semantics></math></td>
<td id="S5.T2.14.12.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="S5.T2.14.12.2.m1.1" class="ltx_Math" alttext="29.07\pm 0.66" display="inline"><semantics id="S5.T2.14.12.2.m1.1a"><mrow id="S5.T2.14.12.2.m1.1.1" xref="S5.T2.14.12.2.m1.1.1.cmml"><mn id="S5.T2.14.12.2.m1.1.1.2" xref="S5.T2.14.12.2.m1.1.1.2.cmml">29.07</mn><mo id="S5.T2.14.12.2.m1.1.1.1" xref="S5.T2.14.12.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.14.12.2.m1.1.1.3" xref="S5.T2.14.12.2.m1.1.1.3.cmml">0.66</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.14.12.2.m1.1b"><apply id="S5.T2.14.12.2.m1.1.1.cmml" xref="S5.T2.14.12.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.14.12.2.m1.1.1.1.cmml" xref="S5.T2.14.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.14.12.2.m1.1.1.2.cmml" xref="S5.T2.14.12.2.m1.1.1.2">29.07</cn><cn type="float" id="S5.T2.14.12.2.m1.1.1.3.cmml" xref="S5.T2.14.12.2.m1.1.1.3">0.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.12.2.m1.1c">29.07\pm 0.66</annotation></semantics></math></td>
<td id="S5.T2.15.13.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.15.13.3.m1.1" class="ltx_Math" alttext="18.76\pm 0.44" display="inline"><semantics id="S5.T2.15.13.3.m1.1a"><mrow id="S5.T2.15.13.3.m1.1.1" xref="S5.T2.15.13.3.m1.1.1.cmml"><mn id="S5.T2.15.13.3.m1.1.1.2" xref="S5.T2.15.13.3.m1.1.1.2.cmml">18.76</mn><mo id="S5.T2.15.13.3.m1.1.1.1" xref="S5.T2.15.13.3.m1.1.1.1.cmml">±</mo><mn id="S5.T2.15.13.3.m1.1.1.3" xref="S5.T2.15.13.3.m1.1.1.3.cmml">0.44</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.15.13.3.m1.1b"><apply id="S5.T2.15.13.3.m1.1.1.cmml" xref="S5.T2.15.13.3.m1.1.1"><csymbol cd="latexml" id="S5.T2.15.13.3.m1.1.1.1.cmml" xref="S5.T2.15.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.15.13.3.m1.1.1.2.cmml" xref="S5.T2.15.13.3.m1.1.1.2">18.76</cn><cn type="float" id="S5.T2.15.13.3.m1.1.1.3.cmml" xref="S5.T2.15.13.3.m1.1.1.3">0.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.13.3.m1.1c">18.76\pm 0.44</annotation></semantics></math></td>
<td id="S5.T2.16.14.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.16.14.4.m1.1" class="ltx_Math" alttext="32.81\pm 1.22" display="inline"><semantics id="S5.T2.16.14.4.m1.1a"><mrow id="S5.T2.16.14.4.m1.1.1" xref="S5.T2.16.14.4.m1.1.1.cmml"><mn id="S5.T2.16.14.4.m1.1.1.2" xref="S5.T2.16.14.4.m1.1.1.2.cmml">32.81</mn><mo id="S5.T2.16.14.4.m1.1.1.1" xref="S5.T2.16.14.4.m1.1.1.1.cmml">±</mo><mn id="S5.T2.16.14.4.m1.1.1.3" xref="S5.T2.16.14.4.m1.1.1.3.cmml">1.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.16.14.4.m1.1b"><apply id="S5.T2.16.14.4.m1.1.1.cmml" xref="S5.T2.16.14.4.m1.1.1"><csymbol cd="latexml" id="S5.T2.16.14.4.m1.1.1.1.cmml" xref="S5.T2.16.14.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.16.14.4.m1.1.1.2.cmml" xref="S5.T2.16.14.4.m1.1.1.2">32.81</cn><cn type="float" id="S5.T2.16.14.4.m1.1.1.3.cmml" xref="S5.T2.16.14.4.m1.1.1.3">1.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.14.4.m1.1c">32.81\pm 1.22</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.20.18" class="ltx_tr">
<td id="S5.T2.20.18.5" class="ltx_td ltx_align_center ltx_border_rr">FedLwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="S5.T2.17.15.1" class="ltx_td ltx_align_center"><math id="S5.T2.17.15.1.m1.1" class="ltx_Math" alttext="52.87\pm 0.61" display="inline"><semantics id="S5.T2.17.15.1.m1.1a"><mrow id="S5.T2.17.15.1.m1.1.1" xref="S5.T2.17.15.1.m1.1.1.cmml"><mn id="S5.T2.17.15.1.m1.1.1.2" xref="S5.T2.17.15.1.m1.1.1.2.cmml">52.87</mn><mo id="S5.T2.17.15.1.m1.1.1.1" xref="S5.T2.17.15.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.17.15.1.m1.1.1.3" xref="S5.T2.17.15.1.m1.1.1.3.cmml">0.61</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.17.15.1.m1.1b"><apply id="S5.T2.17.15.1.m1.1.1.cmml" xref="S5.T2.17.15.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.17.15.1.m1.1.1.1.cmml" xref="S5.T2.17.15.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.17.15.1.m1.1.1.2.cmml" xref="S5.T2.17.15.1.m1.1.1.2">52.87</cn><cn type="float" id="S5.T2.17.15.1.m1.1.1.3.cmml" xref="S5.T2.17.15.1.m1.1.1.3">0.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.15.1.m1.1c">52.87\pm 0.61</annotation></semantics></math></td>
<td id="S5.T2.18.16.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T2.18.16.2.m1.1" class="ltx_Math" alttext="13.34\pm 0.38" display="inline"><semantics id="S5.T2.18.16.2.m1.1a"><mrow id="S5.T2.18.16.2.m1.1.1" xref="S5.T2.18.16.2.m1.1.1.cmml"><mn id="S5.T2.18.16.2.m1.1.1.2" xref="S5.T2.18.16.2.m1.1.1.2.cmml">13.34</mn><mo id="S5.T2.18.16.2.m1.1.1.1" xref="S5.T2.18.16.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.18.16.2.m1.1.1.3" xref="S5.T2.18.16.2.m1.1.1.3.cmml">0.38</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.18.16.2.m1.1b"><apply id="S5.T2.18.16.2.m1.1.1.cmml" xref="S5.T2.18.16.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.18.16.2.m1.1.1.1.cmml" xref="S5.T2.18.16.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.18.16.2.m1.1.1.2.cmml" xref="S5.T2.18.16.2.m1.1.1.2">13.34</cn><cn type="float" id="S5.T2.18.16.2.m1.1.1.3.cmml" xref="S5.T2.18.16.2.m1.1.1.3">0.38</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.16.2.m1.1c">13.34\pm 0.38</annotation></semantics></math></td>
<td id="S5.T2.19.17.3" class="ltx_td ltx_align_center"><math id="S5.T2.19.17.3.m1.1" class="ltx_Math" alttext="62.39\pm 1.12" display="inline"><semantics id="S5.T2.19.17.3.m1.1a"><mrow id="S5.T2.19.17.3.m1.1.1" xref="S5.T2.19.17.3.m1.1.1.cmml"><mn id="S5.T2.19.17.3.m1.1.1.2" xref="S5.T2.19.17.3.m1.1.1.2.cmml">62.39</mn><mo id="S5.T2.19.17.3.m1.1.1.1" xref="S5.T2.19.17.3.m1.1.1.1.cmml">±</mo><mn id="S5.T2.19.17.3.m1.1.1.3" xref="S5.T2.19.17.3.m1.1.1.3.cmml">1.12</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.19.17.3.m1.1b"><apply id="S5.T2.19.17.3.m1.1.1.cmml" xref="S5.T2.19.17.3.m1.1.1"><csymbol cd="latexml" id="S5.T2.19.17.3.m1.1.1.1.cmml" xref="S5.T2.19.17.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.19.17.3.m1.1.1.2.cmml" xref="S5.T2.19.17.3.m1.1.1.2">62.39</cn><cn type="float" id="S5.T2.19.17.3.m1.1.1.3.cmml" xref="S5.T2.19.17.3.m1.1.1.3">1.12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.17.3.m1.1c">62.39\pm 1.12</annotation></semantics></math></td>
<td id="S5.T2.20.18.4" class="ltx_td ltx_align_center"><math id="S5.T2.20.18.4.m1.1" class="ltx_Math" alttext="10.76\pm 0.50" display="inline"><semantics id="S5.T2.20.18.4.m1.1a"><mrow id="S5.T2.20.18.4.m1.1.1" xref="S5.T2.20.18.4.m1.1.1.cmml"><mn id="S5.T2.20.18.4.m1.1.1.2" xref="S5.T2.20.18.4.m1.1.1.2.cmml">10.76</mn><mo id="S5.T2.20.18.4.m1.1.1.1" xref="S5.T2.20.18.4.m1.1.1.1.cmml">±</mo><mn id="S5.T2.20.18.4.m1.1.1.3" xref="S5.T2.20.18.4.m1.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.20.18.4.m1.1b"><apply id="S5.T2.20.18.4.m1.1.1.cmml" xref="S5.T2.20.18.4.m1.1.1"><csymbol cd="latexml" id="S5.T2.20.18.4.m1.1.1.1.cmml" xref="S5.T2.20.18.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.20.18.4.m1.1.1.2.cmml" xref="S5.T2.20.18.4.m1.1.1.2">10.76</cn><cn type="float" id="S5.T2.20.18.4.m1.1.1.3.cmml" xref="S5.T2.20.18.4.m1.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.18.4.m1.1c">10.76\pm 0.50</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.24.22" class="ltx_tr">
<td id="S5.T2.24.22.5" class="ltx_td ltx_align_center ltx_border_rr">FedAvg-Prompt</td>
<td id="S5.T2.21.19.1" class="ltx_td ltx_align_center"><math id="S5.T2.21.19.1.m1.1" class="ltx_Math" alttext="51.15\pm 0.68" display="inline"><semantics id="S5.T2.21.19.1.m1.1a"><mrow id="S5.T2.21.19.1.m1.1.1" xref="S5.T2.21.19.1.m1.1.1.cmml"><mn id="S5.T2.21.19.1.m1.1.1.2" xref="S5.T2.21.19.1.m1.1.1.2.cmml">51.15</mn><mo id="S5.T2.21.19.1.m1.1.1.1" xref="S5.T2.21.19.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.21.19.1.m1.1.1.3" xref="S5.T2.21.19.1.m1.1.1.3.cmml">0.68</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.21.19.1.m1.1b"><apply id="S5.T2.21.19.1.m1.1.1.cmml" xref="S5.T2.21.19.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.21.19.1.m1.1.1.1.cmml" xref="S5.T2.21.19.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.21.19.1.m1.1.1.2.cmml" xref="S5.T2.21.19.1.m1.1.1.2">51.15</cn><cn type="float" id="S5.T2.21.19.1.m1.1.1.3.cmml" xref="S5.T2.21.19.1.m1.1.1.3">0.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.19.1.m1.1c">51.15\pm 0.68</annotation></semantics></math></td>
<td id="S5.T2.22.20.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T2.22.20.2.m1.1" class="ltx_Math" alttext="8.84\pm 0.52" display="inline"><semantics id="S5.T2.22.20.2.m1.1a"><mrow id="S5.T2.22.20.2.m1.1.1" xref="S5.T2.22.20.2.m1.1.1.cmml"><mn id="S5.T2.22.20.2.m1.1.1.2" xref="S5.T2.22.20.2.m1.1.1.2.cmml">8.84</mn><mo id="S5.T2.22.20.2.m1.1.1.1" xref="S5.T2.22.20.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.22.20.2.m1.1.1.3" xref="S5.T2.22.20.2.m1.1.1.3.cmml">0.52</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.22.20.2.m1.1b"><apply id="S5.T2.22.20.2.m1.1.1.cmml" xref="S5.T2.22.20.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.22.20.2.m1.1.1.1.cmml" xref="S5.T2.22.20.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.22.20.2.m1.1.1.2.cmml" xref="S5.T2.22.20.2.m1.1.1.2">8.84</cn><cn type="float" id="S5.T2.22.20.2.m1.1.1.3.cmml" xref="S5.T2.22.20.2.m1.1.1.3">0.52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.20.2.m1.1c">8.84\pm 0.52</annotation></semantics></math></td>
<td id="S5.T2.23.21.3" class="ltx_td ltx_align_center"><math id="S5.T2.23.21.3.m1.1" class="ltx_Math" alttext="51.03\pm 2.23" display="inline"><semantics id="S5.T2.23.21.3.m1.1a"><mrow id="S5.T2.23.21.3.m1.1.1" xref="S5.T2.23.21.3.m1.1.1.cmml"><mn id="S5.T2.23.21.3.m1.1.1.2" xref="S5.T2.23.21.3.m1.1.1.2.cmml">51.03</mn><mo id="S5.T2.23.21.3.m1.1.1.1" xref="S5.T2.23.21.3.m1.1.1.1.cmml">±</mo><mn id="S5.T2.23.21.3.m1.1.1.3" xref="S5.T2.23.21.3.m1.1.1.3.cmml">2.23</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.23.21.3.m1.1b"><apply id="S5.T2.23.21.3.m1.1.1.cmml" xref="S5.T2.23.21.3.m1.1.1"><csymbol cd="latexml" id="S5.T2.23.21.3.m1.1.1.1.cmml" xref="S5.T2.23.21.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.23.21.3.m1.1.1.2.cmml" xref="S5.T2.23.21.3.m1.1.1.2">51.03</cn><cn type="float" id="S5.T2.23.21.3.m1.1.1.3.cmml" xref="S5.T2.23.21.3.m1.1.1.3">2.23</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.21.3.m1.1c">51.03\pm 2.23</annotation></semantics></math></td>
<td id="S5.T2.24.22.4" class="ltx_td ltx_align_center"><math id="S5.T2.24.22.4.m1.1" class="ltx_Math" alttext="12.03\pm 0.45" display="inline"><semantics id="S5.T2.24.22.4.m1.1a"><mrow id="S5.T2.24.22.4.m1.1.1" xref="S5.T2.24.22.4.m1.1.1.cmml"><mn id="S5.T2.24.22.4.m1.1.1.2" xref="S5.T2.24.22.4.m1.1.1.2.cmml">12.03</mn><mo id="S5.T2.24.22.4.m1.1.1.1" xref="S5.T2.24.22.4.m1.1.1.1.cmml">±</mo><mn id="S5.T2.24.22.4.m1.1.1.3" xref="S5.T2.24.22.4.m1.1.1.3.cmml">0.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.24.22.4.m1.1b"><apply id="S5.T2.24.22.4.m1.1.1.cmml" xref="S5.T2.24.22.4.m1.1.1"><csymbol cd="latexml" id="S5.T2.24.22.4.m1.1.1.1.cmml" xref="S5.T2.24.22.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.24.22.4.m1.1.1.2.cmml" xref="S5.T2.24.22.4.m1.1.1.2">12.03</cn><cn type="float" id="S5.T2.24.22.4.m1.1.1.3.cmml" xref="S5.T2.24.22.4.m1.1.1.3">0.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.22.4.m1.1c">12.03\pm 0.45</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.28.26" class="ltx_tr">
<td id="S5.T2.28.26.5" class="ltx_td ltx_align_center ltx_border_rr">FedProx-Prompt</td>
<td id="S5.T2.25.23.1" class="ltx_td ltx_align_center"><math id="S5.T2.25.23.1.m1.1" class="ltx_Math" alttext="55.53\pm 0.66" display="inline"><semantics id="S5.T2.25.23.1.m1.1a"><mrow id="S5.T2.25.23.1.m1.1.1" xref="S5.T2.25.23.1.m1.1.1.cmml"><mn id="S5.T2.25.23.1.m1.1.1.2" xref="S5.T2.25.23.1.m1.1.1.2.cmml">55.53</mn><mo id="S5.T2.25.23.1.m1.1.1.1" xref="S5.T2.25.23.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.25.23.1.m1.1.1.3" xref="S5.T2.25.23.1.m1.1.1.3.cmml">0.66</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.25.23.1.m1.1b"><apply id="S5.T2.25.23.1.m1.1.1.cmml" xref="S5.T2.25.23.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.25.23.1.m1.1.1.1.cmml" xref="S5.T2.25.23.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.25.23.1.m1.1.1.2.cmml" xref="S5.T2.25.23.1.m1.1.1.2">55.53</cn><cn type="float" id="S5.T2.25.23.1.m1.1.1.3.cmml" xref="S5.T2.25.23.1.m1.1.1.3">0.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.23.1.m1.1c">55.53\pm 0.66</annotation></semantics></math></td>
<td id="S5.T2.26.24.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="S5.T2.26.24.2.m1.1" class="ltx_Math" alttext="7.21\pm 0.56" display="inline"><semantics id="S5.T2.26.24.2.m1.1a"><mrow id="S5.T2.26.24.2.m1.1.1" xref="S5.T2.26.24.2.m1.1.1.cmml"><mn id="S5.T2.26.24.2.m1.1.1.2" xref="S5.T2.26.24.2.m1.1.1.2.cmml">7.21</mn><mo id="S5.T2.26.24.2.m1.1.1.1" xref="S5.T2.26.24.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.26.24.2.m1.1.1.3" xref="S5.T2.26.24.2.m1.1.1.3.cmml">0.56</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.26.24.2.m1.1b"><apply id="S5.T2.26.24.2.m1.1.1.cmml" xref="S5.T2.26.24.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.26.24.2.m1.1.1.1.cmml" xref="S5.T2.26.24.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.26.24.2.m1.1.1.2.cmml" xref="S5.T2.26.24.2.m1.1.1.2">7.21</cn><cn type="float" id="S5.T2.26.24.2.m1.1.1.3.cmml" xref="S5.T2.26.24.2.m1.1.1.3">0.56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.26.24.2.m1.1c">7.21\pm 0.56</annotation></semantics></math></td>
<td id="S5.T2.27.25.3" class="ltx_td ltx_align_center"><math id="S5.T2.27.25.3.m1.1" class="ltx_Math" alttext="62.83\pm 0.45" display="inline"><semantics id="S5.T2.27.25.3.m1.1a"><mrow id="S5.T2.27.25.3.m1.1.1" xref="S5.T2.27.25.3.m1.1.1.cmml"><mn id="S5.T2.27.25.3.m1.1.1.2" xref="S5.T2.27.25.3.m1.1.1.2.cmml">62.83</mn><mo id="S5.T2.27.25.3.m1.1.1.1" xref="S5.T2.27.25.3.m1.1.1.1.cmml">±</mo><mn id="S5.T2.27.25.3.m1.1.1.3" xref="S5.T2.27.25.3.m1.1.1.3.cmml">0.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.27.25.3.m1.1b"><apply id="S5.T2.27.25.3.m1.1.1.cmml" xref="S5.T2.27.25.3.m1.1.1"><csymbol cd="latexml" id="S5.T2.27.25.3.m1.1.1.1.cmml" xref="S5.T2.27.25.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.27.25.3.m1.1.1.2.cmml" xref="S5.T2.27.25.3.m1.1.1.2">62.83</cn><cn type="float" id="S5.T2.27.25.3.m1.1.1.3.cmml" xref="S5.T2.27.25.3.m1.1.1.3">0.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.27.25.3.m1.1c">62.83\pm 0.45</annotation></semantics></math></td>
<td id="S5.T2.28.26.4" class="ltx_td ltx_align_center"><math id="S5.T2.28.26.4.m1.1" class="ltx_Math" alttext="7.14\pm 0.24" display="inline"><semantics id="S5.T2.28.26.4.m1.1a"><mrow id="S5.T2.28.26.4.m1.1.1" xref="S5.T2.28.26.4.m1.1.1.cmml"><mn id="S5.T2.28.26.4.m1.1.1.2" xref="S5.T2.28.26.4.m1.1.1.2.cmml">7.14</mn><mo id="S5.T2.28.26.4.m1.1.1.1" xref="S5.T2.28.26.4.m1.1.1.1.cmml">±</mo><mn id="S5.T2.28.26.4.m1.1.1.3" xref="S5.T2.28.26.4.m1.1.1.3.cmml">0.24</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.28.26.4.m1.1b"><apply id="S5.T2.28.26.4.m1.1.1.cmml" xref="S5.T2.28.26.4.m1.1.1"><csymbol cd="latexml" id="S5.T2.28.26.4.m1.1.1.1.cmml" xref="S5.T2.28.26.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.28.26.4.m1.1.1.2.cmml" xref="S5.T2.28.26.4.m1.1.1.2">7.14</cn><cn type="float" id="S5.T2.28.26.4.m1.1.1.3.cmml" xref="S5.T2.28.26.4.m1.1.1.3">0.24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.28.26.4.m1.1c">7.14\pm 0.24</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.32.30" class="ltx_tr">
<td id="S5.T2.32.30.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="S5.T2.32.30.5.1" class="ltx_text ltx_font_bold">HePCo (Ours)</span></td>
<td id="S5.T2.29.27.1" class="ltx_td ltx_align_center ltx_border_b"><math id="S5.T2.29.27.1.m1.1" class="ltx_Math" alttext="\bm{59.96\pm 0.94}" display="inline"><semantics id="S5.T2.29.27.1.m1.1a"><mrow id="S5.T2.29.27.1.m1.1.1" xref="S5.T2.29.27.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.29.27.1.m1.1.1.2" xref="S5.T2.29.27.1.m1.1.1.2.cmml">59.96</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.29.27.1.m1.1.1.1" xref="S5.T2.29.27.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.29.27.1.m1.1.1.3" xref="S5.T2.29.27.1.m1.1.1.3.cmml">0.94</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.29.27.1.m1.1b"><apply id="S5.T2.29.27.1.m1.1.1.cmml" xref="S5.T2.29.27.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.29.27.1.m1.1.1.1.cmml" xref="S5.T2.29.27.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.29.27.1.m1.1.1.2.cmml" xref="S5.T2.29.27.1.m1.1.1.2">59.96</cn><cn type="float" id="S5.T2.29.27.1.m1.1.1.3.cmml" xref="S5.T2.29.27.1.m1.1.1.3">0.94</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.27.1.m1.1c">\bm{59.96\pm 0.94}</annotation></semantics></math></td>
<td id="S5.T2.30.28.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="S5.T2.30.28.2.m1.1" class="ltx_Math" alttext="\bm{7.08\pm 0.40}" display="inline"><semantics id="S5.T2.30.28.2.m1.1a"><mrow id="S5.T2.30.28.2.m1.1.1" xref="S5.T2.30.28.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.30.28.2.m1.1.1.2" xref="S5.T2.30.28.2.m1.1.1.2.cmml">7.08</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.30.28.2.m1.1.1.1" xref="S5.T2.30.28.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.30.28.2.m1.1.1.3" xref="S5.T2.30.28.2.m1.1.1.3.cmml">0.40</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.30.28.2.m1.1b"><apply id="S5.T2.30.28.2.m1.1.1.cmml" xref="S5.T2.30.28.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.30.28.2.m1.1.1.1.cmml" xref="S5.T2.30.28.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.30.28.2.m1.1.1.2.cmml" xref="S5.T2.30.28.2.m1.1.1.2">7.08</cn><cn type="float" id="S5.T2.30.28.2.m1.1.1.3.cmml" xref="S5.T2.30.28.2.m1.1.1.3">0.40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.30.28.2.m1.1c">\bm{7.08\pm 0.40}</annotation></semantics></math></td>
<td id="S5.T2.31.29.3" class="ltx_td ltx_align_center ltx_border_b"><math id="S5.T2.31.29.3.m1.1" class="ltx_Math" alttext="\bm{64.01\pm 0.36}" display="inline"><semantics id="S5.T2.31.29.3.m1.1a"><mrow id="S5.T2.31.29.3.m1.1.1" xref="S5.T2.31.29.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.31.29.3.m1.1.1.2" xref="S5.T2.31.29.3.m1.1.1.2.cmml">64.01</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.31.29.3.m1.1.1.1" xref="S5.T2.31.29.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.31.29.3.m1.1.1.3" xref="S5.T2.31.29.3.m1.1.1.3.cmml">0.36</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.31.29.3.m1.1b"><apply id="S5.T2.31.29.3.m1.1.1.cmml" xref="S5.T2.31.29.3.m1.1.1"><csymbol cd="latexml" id="S5.T2.31.29.3.m1.1.1.1.cmml" xref="S5.T2.31.29.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.31.29.3.m1.1.1.2.cmml" xref="S5.T2.31.29.3.m1.1.1.2">64.01</cn><cn type="float" id="S5.T2.31.29.3.m1.1.1.3.cmml" xref="S5.T2.31.29.3.m1.1.1.3">0.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.29.3.m1.1c">\bm{64.01\pm 0.36}</annotation></semantics></math></td>
<td id="S5.T2.32.30.4" class="ltx_td ltx_align_center ltx_border_b"><math id="S5.T2.32.30.4.m1.1" class="ltx_Math" alttext="\bm{6.83\pm 0.31}" display="inline"><semantics id="S5.T2.32.30.4.m1.1a"><mrow id="S5.T2.32.30.4.m1.1.1" xref="S5.T2.32.30.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.32.30.4.m1.1.1.2" xref="S5.T2.32.30.4.m1.1.1.2.cmml">6.83</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.32.30.4.m1.1.1.1" xref="S5.T2.32.30.4.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.32.30.4.m1.1.1.3" xref="S5.T2.32.30.4.m1.1.1.3.cmml">0.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.32.30.4.m1.1b"><apply id="S5.T2.32.30.4.m1.1.1.cmml" xref="S5.T2.32.30.4.m1.1.1"><csymbol cd="latexml" id="S5.T2.32.30.4.m1.1.1.1.cmml" xref="S5.T2.32.30.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.32.30.4.m1.1.1.2.cmml" xref="S5.T2.32.30.4.m1.1.1.2">6.83</cn><cn type="float" id="S5.T2.32.30.4.m1.1.1.3.cmml" xref="S5.T2.32.30.4.m1.1.1.3">0.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.32.30.4.m1.1c">\bm{6.83\pm 0.31}</annotation></semantics></math></td>
</tr>
</table>
</figure>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.4" class="ltx_p"><span id="S5.p3.4.1" class="ltx_text ltx_font_bold">Configuration.</span> We learn each task through <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="R=10" display="inline"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">R</mi><mo id="S5.p3.1.m1.1.1.1" xref="S5.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><eq id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></eq><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">𝑅</ci><cn type="integer" id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">R=10</annotation></semantics></math> communication rounds by selecting <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="C=5" display="inline"><semantics id="S5.p3.2.m2.1a"><mrow id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">C</mi><mo id="S5.p3.2.m2.1.1.1" xref="S5.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><eq id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1.1"></eq><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">𝐶</ci><cn type="integer" id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">C=5</annotation></semantics></math> stateless clients per round. Thus, we have 100 total rounds for a 10-task setup and 50 for a 5-task setup. For all experiments reported in Tables <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S5.T3" title="Table 3 ‣ Figure 3 ‣ 5.2 Ablation studies and Additional Analysis ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we use a category ratio <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\kappa=0.6" display="inline"><semantics id="S5.p3.3.m3.1a"><mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">κ</mi><mo id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><eq id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1"></eq><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">𝜅</ci><cn type="float" id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\kappa=0.6</annotation></semantics></math> which means that if a task contains 10 categories, each active client is randomly assigned 6 of these categories. We analyze the affect of different category ratios in Sec. <a href="#S5.SS2" title="5.2 Ablation studies and Additional Analysis ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>. Further, we use a split ratio <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\gamma=0.1" display="inline"><semantics id="S5.p3.4.m4.1a"><mrow id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><mi id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml">γ</mi><mo id="S5.p3.4.m4.1.1.1" xref="S5.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><eq id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1.1"></eq><ci id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2">𝛾</ci><cn type="float" id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\gamma=0.1</annotation></semantics></math> which allows a client to be assigned 10% of the examples corresponding to the subset of categories. We train local models for 10 epochs per round.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.6" class="ltx_p"><span id="S5.p4.6.1" class="ltx_text ltx_font_bold">Metrics.</span> We evaluate all methods using the standard continual learning metrics of (1) final average accuracy <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.p4.1.m1.1a"><msub id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml"><mi id="S5.p4.1.m1.1.1.2" xref="S5.p4.1.m1.1.1.2.cmml">A</mi><mi id="S5.p4.1.m1.1.1.3" xref="S5.p4.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><apply id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p4.1.m1.1.1.1.cmml" xref="S5.p4.1.m1.1.1">subscript</csymbol><ci id="S5.p4.1.m1.1.1.2.cmml" xref="S5.p4.1.m1.1.1.2">𝐴</ci><ci id="S5.p4.1.m1.1.1.3.cmml" xref="S5.p4.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">A_{N}</annotation></semantics></math> which is the accuracy averaged over all <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.p4.2.m2.1a"><mi id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><ci id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">N</annotation></semantics></math> tasks after learning the <math id="S5.p4.3.m3.1" class="ltx_Math" alttext="N^{th}" display="inline"><semantics id="S5.p4.3.m3.1a"><msup id="S5.p4.3.m3.1.1" xref="S5.p4.3.m3.1.1.cmml"><mi id="S5.p4.3.m3.1.1.2" xref="S5.p4.3.m3.1.1.2.cmml">N</mi><mrow id="S5.p4.3.m3.1.1.3" xref="S5.p4.3.m3.1.1.3.cmml"><mi id="S5.p4.3.m3.1.1.3.2" xref="S5.p4.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.p4.3.m3.1.1.3.1" xref="S5.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.p4.3.m3.1.1.3.3" xref="S5.p4.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p4.3.m3.1b"><apply id="S5.p4.3.m3.1.1.cmml" xref="S5.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p4.3.m3.1.1.1.cmml" xref="S5.p4.3.m3.1.1">superscript</csymbol><ci id="S5.p4.3.m3.1.1.2.cmml" xref="S5.p4.3.m3.1.1.2">𝑁</ci><apply id="S5.p4.3.m3.1.1.3.cmml" xref="S5.p4.3.m3.1.1.3"><times id="S5.p4.3.m3.1.1.3.1.cmml" xref="S5.p4.3.m3.1.1.3.1"></times><ci id="S5.p4.3.m3.1.1.3.2.cmml" xref="S5.p4.3.m3.1.1.3.2">𝑡</ci><ci id="S5.p4.3.m3.1.1.3.3.cmml" xref="S5.p4.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.3.m3.1c">N^{th}</annotation></semantics></math> task and (2) average forgetting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> <math id="S5.p4.4.m4.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.p4.4.m4.1a"><msub id="S5.p4.4.m4.1.1" xref="S5.p4.4.m4.1.1.cmml"><mi id="S5.p4.4.m4.1.1.2" xref="S5.p4.4.m4.1.1.2.cmml">F</mi><mi id="S5.p4.4.m4.1.1.3" xref="S5.p4.4.m4.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p4.4.m4.1b"><apply id="S5.p4.4.m4.1.1.cmml" xref="S5.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p4.4.m4.1.1.1.cmml" xref="S5.p4.4.m4.1.1">subscript</csymbol><ci id="S5.p4.4.m4.1.1.2.cmml" xref="S5.p4.4.m4.1.1.2">𝐹</ci><ci id="S5.p4.4.m4.1.1.3.cmml" xref="S5.p4.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.4.m4.1c">F_{N}</annotation></semantics></math> which measures the drop in performance on previous tasks after learning a new task averaged over all <math id="S5.p4.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.p4.5.m5.1a"><mi id="S5.p4.5.m5.1.1" xref="S5.p4.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.p4.5.m5.1b"><ci id="S5.p4.5.m5.1.1.cmml" xref="S5.p4.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.5.m5.1c">N</annotation></semantics></math> tasks. As noted by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, <math id="S5.p4.6.m6.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.p4.6.m6.1a"><msub id="S5.p4.6.m6.1.1" xref="S5.p4.6.m6.1.1.cmml"><mi id="S5.p4.6.m6.1.1.2" xref="S5.p4.6.m6.1.1.2.cmml">A</mi><mi id="S5.p4.6.m6.1.1.3" xref="S5.p4.6.m6.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p4.6.m6.1b"><apply id="S5.p4.6.m6.1.1.cmml" xref="S5.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S5.p4.6.m6.1.1.1.cmml" xref="S5.p4.6.m6.1.1">subscript</csymbol><ci id="S5.p4.6.m6.1.1.2.cmml" xref="S5.p4.6.m6.1.1.2">𝐴</ci><ci id="S5.p4.6.m6.1.1.3.cmml" xref="S5.p4.6.m6.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.6.m6.1c">A_{N}</annotation></semantics></math> is the more informative metric as it encompasses both forgetting and plasticity (new task performance). Our approach provides parameter efficiency which is reflected by reduced communication and local computation costs; albeit at the expense of a small overhead at the server. We include a metric to illustrate this, specifying the number of parameters shared relative to the original model size.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p"><span id="S5.p5.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
We compare our method against existing approaches, as well as two strong baselines that we introduce. To the best of our knowledge, our work is the first to use a prompt-learning approach in CFL. For fair comparison with existing methods, we adapt their implementations to use the same ViT backbone with proper modifications. We observe that the FedLWF method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> used in prior CFL work
performs poorly owing to the complexity of our setting. We instead adapt LwF.MC with sigmoid binary cross-entropy loss as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite> which is a strong continual learning baseline to our setting. We call this method FedLwf.MC which achieves a much better performance than its vanilla counterpart. We introduce two simple yet strong prompting-based methods which we call FedAvg-Prompt and FedProx-Prompt. FedAvg-Prompt differs from our method in the model aggregation part at the server side where the clients are simply averaged to obtain the server model. FedProx-Prompt builds on top of FedAvg-Prompt by applying the FedProx loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> to learnable parameters at the client side. FedProx is a stateless federated learning (FL) algorithm designed to tackle client heterogeneity. Additionally for completeness, we report the performance of FedAvg-FT where the entire client models are sequentially finetuned on new task data (as opposed to learning only prompts and classifier)
and aggregated using FedAvg. Finally, we report the performance of our <span id="S5.p5.1.2" class="ltx_text ltx_font_italic">decomposed prompting</span> scheme in a centralized, traditional continual learning setting. This can be thought of as an upper bound performance for all prompt-based methods included here.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p"><span id="S5.p6.1.1" class="ltx_text ltx_font_italic">We include additional implementation details in Appendix <a href="#A1" title="Appendix A Experimental Details ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a></span>.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Main Results</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">The results presented in Tables <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and  <a href="#S5.T2" title="Table 2 ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrate the strong performance gains of our method in terms of average accuracy and forgetting across all datasets and settings. Our approach achieves absolute improvements of up to 7% in average accuracy compared to the best baseline. In contrast, the FedAvg-FT baseline undergoes severe forgetting, as such finetuning more significantly modifies the model and hences leads to higher forgetting. The FedLwF.MC baseline performs well on shorter task sequences but struggles with longer sequences, leading to significant forgetting. It also faces challenges in imbalanced settings with high heterogeneity. Even our simple baselines, FedAvg-Prompt and FedProx-Prompt, outperform FedLwF.MC in most settings. However, HePCo outperforms all baselines in terms of both metrics while enjoying low communication costs. It is important to note that even our best approach falls significantly short of centralized performance, highlighting the complex challenges inherent in this continual federated learning setting, leaving room for future work.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Ablation studies and Additional Analysis</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We perform ablations experiments on CIFAR-100 in the <span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_italic">No Imbalance</span> setting from Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.2" class="ltx_p"><span id="S5.SS2.p2.2.1" class="ltx_text ltx_font_bold">Ablating distillation of previous server model.</span>
By removing the previous task server model from the distillation and generation steps, we highlight its efficacy in alleviating forgetting. By ablating this component, we observe a significant drop in performance indicated by a rise in forgetting (<math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><msub id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">F</mi><mi id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝐹</ci><ci id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">F_{N}</annotation></semantics></math>) and a drop in average accuracy (<math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">A</mi><mi id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝐴</ci><ci id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">A_{N}</annotation></semantics></math>). The underlying intuition is that without the replay of past task data, the method strongly prioritizes learning of the current task leading to a loss of knowledge from previously seen tasks.</p>
</div>
<figure id="S5.F3.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<div id="S5.F3.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:411.9pt;height:303.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(36.1pt,-26.5pt) scale(1.21218261908615,1.21218261908615) ;"><img src="/html/2306.09970/assets/x1.png" id="S5.F3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="355" height="266" alt="Refer to caption">
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.1.4.2" class="ltx_text" style="font-size:90%;"> Comparison of the methods under 
<br class="ltx_break">different category ratios</span></figcaption>
<br class="ltx_break ltx_break">
<figure id="S5.T3" class="ltx_table ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<div id="S5.T3.13" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:291.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(109.6pt,-73.6pt) scale(2.02179861597422,2.02179861597422) ;">
<table id="S5.T3.13.13" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.2.2.2" class="ltx_tr">
<td id="S5.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt">
<math id="S5.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T3.1.1.1.1.m1.1a"><msub id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml"><mi id="S5.T3.1.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.1.m1.1.1.2.cmml">A</mi><mi id="S5.T3.1.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.1.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T3.1.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.2">𝐴</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="S5.T3.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.2.2.2.2.m2.1a"><mo stretchy="false" id="S5.T3.2.2.2.2.m2.1.1" xref="S5.T3.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.2.m2.1b"><ci id="S5.T3.2.2.2.2.m2.1.1.cmml" xref="S5.T3.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
</tr>
<tr id="S5.T3.3.3.3" class="ltx_tr">
<td id="S5.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">HePCo (Ours)</td>
<td id="S5.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="\bm{76.54\pm 1.14}" display="inline"><semantics id="S5.T3.3.3.3.1.m1.1a"><mrow id="S5.T3.3.3.3.1.m1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T3.3.3.3.1.m1.1.1.2" xref="S5.T3.3.3.3.1.m1.1.1.2.cmml">76.54</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T3.3.3.3.1.m1.1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T3.3.3.3.1.m1.1.1.3" xref="S5.T3.3.3.3.1.m1.1.1.3.cmml">1.14</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.m1.1b"><apply id="S5.T3.3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S5.T3.3.3.3.1.m1.1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.3.3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.3.3.1.m1.1.1.2">76.54</cn><cn type="float" id="S5.T3.3.3.3.1.m1.1.1.3.cmml" xref="S5.T3.3.3.3.1.m1.1.1.3">1.14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.m1.1c">\bm{76.54\pm 1.14}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.4.4.4" class="ltx_tr">
<td id="S5.T3.4.4.4.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Ablate previous server model</td>
<td id="S5.T3.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.4.4.4.1.m1.1" class="ltx_Math" alttext="61.15\pm 2.13" display="inline"><semantics id="S5.T3.4.4.4.1.m1.1a"><mrow id="S5.T3.4.4.4.1.m1.1.1" xref="S5.T3.4.4.4.1.m1.1.1.cmml"><mn id="S5.T3.4.4.4.1.m1.1.1.2" xref="S5.T3.4.4.4.1.m1.1.1.2.cmml">61.15</mn><mo id="S5.T3.4.4.4.1.m1.1.1.1" xref="S5.T3.4.4.4.1.m1.1.1.1.cmml">±</mo><mn id="S5.T3.4.4.4.1.m1.1.1.3" xref="S5.T3.4.4.4.1.m1.1.1.3.cmml">2.13</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.1.m1.1b"><apply id="S5.T3.4.4.4.1.m1.1.1.cmml" xref="S5.T3.4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S5.T3.4.4.4.1.m1.1.1.1.cmml" xref="S5.T3.4.4.4.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.4.4.4.1.m1.1.1.2.cmml" xref="S5.T3.4.4.4.1.m1.1.1.2">61.15</cn><cn type="float" id="S5.T3.4.4.4.1.m1.1.1.3.cmml" xref="S5.T3.4.4.4.1.m1.1.1.3">2.13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.1.m1.1c">61.15\pm 2.13</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.7.7.7" class="ltx_tr">
<td id="S5.T3.6.6.6.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Ablate <math id="S5.T3.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{KL}" display="inline"><semantics id="S5.T3.5.5.5.1.m1.1a"><msub id="S5.T3.5.5.5.1.m1.1.1" xref="S5.T3.5.5.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.5.5.5.1.m1.1.1.2" xref="S5.T3.5.5.5.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S5.T3.5.5.5.1.m1.1.1.3" xref="S5.T3.5.5.5.1.m1.1.1.3.cmml"><mi id="S5.T3.5.5.5.1.m1.1.1.3.2" xref="S5.T3.5.5.5.1.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S5.T3.5.5.5.1.m1.1.1.3.1" xref="S5.T3.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.T3.5.5.5.1.m1.1.1.3.3" xref="S5.T3.5.5.5.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.1.m1.1b"><apply id="S5.T3.5.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.5.5.5.1.m1.1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S5.T3.5.5.5.1.m1.1.1.2.cmml" xref="S5.T3.5.5.5.1.m1.1.1.2">ℒ</ci><apply id="S5.T3.5.5.5.1.m1.1.1.3.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3"><times id="S5.T3.5.5.5.1.m1.1.1.3.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3.1"></times><ci id="S5.T3.5.5.5.1.m1.1.1.3.2.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3.2">𝐾</ci><ci id="S5.T3.5.5.5.1.m1.1.1.3.3.cmml" xref="S5.T3.5.5.5.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.1.m1.1c">\mathcal{L}_{KL}</annotation></semantics></math> &amp; <math id="S5.T3.6.6.6.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{MSE}" display="inline"><semantics id="S5.T3.6.6.6.2.m2.1a"><msub id="S5.T3.6.6.6.2.m2.1.1" xref="S5.T3.6.6.6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.6.6.6.2.m2.1.1.2" xref="S5.T3.6.6.6.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S5.T3.6.6.6.2.m2.1.1.3" xref="S5.T3.6.6.6.2.m2.1.1.3.cmml"><mi id="S5.T3.6.6.6.2.m2.1.1.3.2" xref="S5.T3.6.6.6.2.m2.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.T3.6.6.6.2.m2.1.1.3.1" xref="S5.T3.6.6.6.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.T3.6.6.6.2.m2.1.1.3.3" xref="S5.T3.6.6.6.2.m2.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.T3.6.6.6.2.m2.1.1.3.1a" xref="S5.T3.6.6.6.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.T3.6.6.6.2.m2.1.1.3.4" xref="S5.T3.6.6.6.2.m2.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.2.m2.1b"><apply id="S5.T3.6.6.6.2.m2.1.1.cmml" xref="S5.T3.6.6.6.2.m2.1.1"><csymbol cd="ambiguous" id="S5.T3.6.6.6.2.m2.1.1.1.cmml" xref="S5.T3.6.6.6.2.m2.1.1">subscript</csymbol><ci id="S5.T3.6.6.6.2.m2.1.1.2.cmml" xref="S5.T3.6.6.6.2.m2.1.1.2">ℒ</ci><apply id="S5.T3.6.6.6.2.m2.1.1.3.cmml" xref="S5.T3.6.6.6.2.m2.1.1.3"><times id="S5.T3.6.6.6.2.m2.1.1.3.1.cmml" xref="S5.T3.6.6.6.2.m2.1.1.3.1"></times><ci id="S5.T3.6.6.6.2.m2.1.1.3.2.cmml" xref="S5.T3.6.6.6.2.m2.1.1.3.2">𝑀</ci><ci id="S5.T3.6.6.6.2.m2.1.1.3.3.cmml" xref="S5.T3.6.6.6.2.m2.1.1.3.3">𝑆</ci><ci id="S5.T3.6.6.6.2.m2.1.1.3.4.cmml" xref="S5.T3.6.6.6.2.m2.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.2.m2.1c">\mathcal{L}_{MSE}</annotation></semantics></math>
</td>
<td id="S5.T3.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.7.7.7.3.m1.1" class="ltx_Math" alttext="70.22\pm 1.45" display="inline"><semantics id="S5.T3.7.7.7.3.m1.1a"><mrow id="S5.T3.7.7.7.3.m1.1.1" xref="S5.T3.7.7.7.3.m1.1.1.cmml"><mn id="S5.T3.7.7.7.3.m1.1.1.2" xref="S5.T3.7.7.7.3.m1.1.1.2.cmml">70.22</mn><mo id="S5.T3.7.7.7.3.m1.1.1.1" xref="S5.T3.7.7.7.3.m1.1.1.1.cmml">±</mo><mn id="S5.T3.7.7.7.3.m1.1.1.3" xref="S5.T3.7.7.7.3.m1.1.1.3.cmml">1.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.3.m1.1b"><apply id="S5.T3.7.7.7.3.m1.1.1.cmml" xref="S5.T3.7.7.7.3.m1.1.1"><csymbol cd="latexml" id="S5.T3.7.7.7.3.m1.1.1.1.cmml" xref="S5.T3.7.7.7.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.7.7.7.3.m1.1.1.2.cmml" xref="S5.T3.7.7.7.3.m1.1.1.2">70.22</cn><cn type="float" id="S5.T3.7.7.7.3.m1.1.1.3.cmml" xref="S5.T3.7.7.7.3.m1.1.1.3">1.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.3.m1.1c">70.22\pm 1.45</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.9.9.9" class="ltx_tr">
<td id="S5.T3.8.8.8.1" class="ltx_td ltx_align_center ltx_border_rr">Ablate <math id="S5.T3.8.8.8.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{KL}" display="inline"><semantics id="S5.T3.8.8.8.1.m1.1a"><msub id="S5.T3.8.8.8.1.m1.1.1" xref="S5.T3.8.8.8.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.8.8.8.1.m1.1.1.2" xref="S5.T3.8.8.8.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S5.T3.8.8.8.1.m1.1.1.3" xref="S5.T3.8.8.8.1.m1.1.1.3.cmml"><mi id="S5.T3.8.8.8.1.m1.1.1.3.2" xref="S5.T3.8.8.8.1.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S5.T3.8.8.8.1.m1.1.1.3.1" xref="S5.T3.8.8.8.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.T3.8.8.8.1.m1.1.1.3.3" xref="S5.T3.8.8.8.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.1.m1.1b"><apply id="S5.T3.8.8.8.1.m1.1.1.cmml" xref="S5.T3.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.8.8.8.1.m1.1.1.1.cmml" xref="S5.T3.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S5.T3.8.8.8.1.m1.1.1.2.cmml" xref="S5.T3.8.8.8.1.m1.1.1.2">ℒ</ci><apply id="S5.T3.8.8.8.1.m1.1.1.3.cmml" xref="S5.T3.8.8.8.1.m1.1.1.3"><times id="S5.T3.8.8.8.1.m1.1.1.3.1.cmml" xref="S5.T3.8.8.8.1.m1.1.1.3.1"></times><ci id="S5.T3.8.8.8.1.m1.1.1.3.2.cmml" xref="S5.T3.8.8.8.1.m1.1.1.3.2">𝐾</ci><ci id="S5.T3.8.8.8.1.m1.1.1.3.3.cmml" xref="S5.T3.8.8.8.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.1.m1.1c">\mathcal{L}_{KL}</annotation></semantics></math>
</td>
<td id="S5.T3.9.9.9.2" class="ltx_td ltx_align_center"><math id="S5.T3.9.9.9.2.m1.1" class="ltx_Math" alttext="71.39\pm 1.34" display="inline"><semantics id="S5.T3.9.9.9.2.m1.1a"><mrow id="S5.T3.9.9.9.2.m1.1.1" xref="S5.T3.9.9.9.2.m1.1.1.cmml"><mn id="S5.T3.9.9.9.2.m1.1.1.2" xref="S5.T3.9.9.9.2.m1.1.1.2.cmml">71.39</mn><mo id="S5.T3.9.9.9.2.m1.1.1.1" xref="S5.T3.9.9.9.2.m1.1.1.1.cmml">±</mo><mn id="S5.T3.9.9.9.2.m1.1.1.3" xref="S5.T3.9.9.9.2.m1.1.1.3.cmml">1.34</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.9.9.9.2.m1.1b"><apply id="S5.T3.9.9.9.2.m1.1.1.cmml" xref="S5.T3.9.9.9.2.m1.1.1"><csymbol cd="latexml" id="S5.T3.9.9.9.2.m1.1.1.1.cmml" xref="S5.T3.9.9.9.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.9.9.9.2.m1.1.1.2.cmml" xref="S5.T3.9.9.9.2.m1.1.1.2">71.39</cn><cn type="float" id="S5.T3.9.9.9.2.m1.1.1.3.cmml" xref="S5.T3.9.9.9.2.m1.1.1.3">1.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.9.9.2.m1.1c">71.39\pm 1.34</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.11.11.11" class="ltx_tr">
<td id="S5.T3.10.10.10.1" class="ltx_td ltx_align_center ltx_border_rr">Ablate <math id="S5.T3.10.10.10.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{MSE}" display="inline"><semantics id="S5.T3.10.10.10.1.m1.1a"><msub id="S5.T3.10.10.10.1.m1.1.1" xref="S5.T3.10.10.10.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.10.10.10.1.m1.1.1.2" xref="S5.T3.10.10.10.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S5.T3.10.10.10.1.m1.1.1.3" xref="S5.T3.10.10.10.1.m1.1.1.3.cmml"><mi id="S5.T3.10.10.10.1.m1.1.1.3.2" xref="S5.T3.10.10.10.1.m1.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.T3.10.10.10.1.m1.1.1.3.1" xref="S5.T3.10.10.10.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.T3.10.10.10.1.m1.1.1.3.3" xref="S5.T3.10.10.10.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.T3.10.10.10.1.m1.1.1.3.1a" xref="S5.T3.10.10.10.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.T3.10.10.10.1.m1.1.1.3.4" xref="S5.T3.10.10.10.1.m1.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.10.10.10.1.m1.1b"><apply id="S5.T3.10.10.10.1.m1.1.1.cmml" xref="S5.T3.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.10.10.10.1.m1.1.1.1.cmml" xref="S5.T3.10.10.10.1.m1.1.1">subscript</csymbol><ci id="S5.T3.10.10.10.1.m1.1.1.2.cmml" xref="S5.T3.10.10.10.1.m1.1.1.2">ℒ</ci><apply id="S5.T3.10.10.10.1.m1.1.1.3.cmml" xref="S5.T3.10.10.10.1.m1.1.1.3"><times id="S5.T3.10.10.10.1.m1.1.1.3.1.cmml" xref="S5.T3.10.10.10.1.m1.1.1.3.1"></times><ci id="S5.T3.10.10.10.1.m1.1.1.3.2.cmml" xref="S5.T3.10.10.10.1.m1.1.1.3.2">𝑀</ci><ci id="S5.T3.10.10.10.1.m1.1.1.3.3.cmml" xref="S5.T3.10.10.10.1.m1.1.1.3.3">𝑆</ci><ci id="S5.T3.10.10.10.1.m1.1.1.3.4.cmml" xref="S5.T3.10.10.10.1.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.10.10.1.m1.1c">\mathcal{L}_{MSE}</annotation></semantics></math>
</td>
<td id="S5.T3.11.11.11.2" class="ltx_td ltx_align_center"><math id="S5.T3.11.11.11.2.m1.1" class="ltx_Math" alttext="74.11\pm 1.31" display="inline"><semantics id="S5.T3.11.11.11.2.m1.1a"><mrow id="S5.T3.11.11.11.2.m1.1.1" xref="S5.T3.11.11.11.2.m1.1.1.cmml"><mn id="S5.T3.11.11.11.2.m1.1.1.2" xref="S5.T3.11.11.11.2.m1.1.1.2.cmml">74.11</mn><mo id="S5.T3.11.11.11.2.m1.1.1.1" xref="S5.T3.11.11.11.2.m1.1.1.1.cmml">±</mo><mn id="S5.T3.11.11.11.2.m1.1.1.3" xref="S5.T3.11.11.11.2.m1.1.1.3.cmml">1.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.11.11.11.2.m1.1b"><apply id="S5.T3.11.11.11.2.m1.1.1.cmml" xref="S5.T3.11.11.11.2.m1.1.1"><csymbol cd="latexml" id="S5.T3.11.11.11.2.m1.1.1.1.cmml" xref="S5.T3.11.11.11.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.11.11.11.2.m1.1.1.2.cmml" xref="S5.T3.11.11.11.2.m1.1.1.2">74.11</cn><cn type="float" id="S5.T3.11.11.11.2.m1.1.1.3.cmml" xref="S5.T3.11.11.11.2.m1.1.1.3">1.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.11.11.2.m1.1c">74.11\pm 1.31</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.12.12.12" class="ltx_tr">
<td id="S5.T3.12.12.12.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Ablate prompt distillation</td>
<td id="S5.T3.12.12.12.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T3.12.12.12.1.m1.1" class="ltx_Math" alttext="74.42\pm 1.22" display="inline"><semantics id="S5.T3.12.12.12.1.m1.1a"><mrow id="S5.T3.12.12.12.1.m1.1.1" xref="S5.T3.12.12.12.1.m1.1.1.cmml"><mn id="S5.T3.12.12.12.1.m1.1.1.2" xref="S5.T3.12.12.12.1.m1.1.1.2.cmml">74.42</mn><mo id="S5.T3.12.12.12.1.m1.1.1.1" xref="S5.T3.12.12.12.1.m1.1.1.1.cmml">±</mo><mn id="S5.T3.12.12.12.1.m1.1.1.3" xref="S5.T3.12.12.12.1.m1.1.1.3.cmml">1.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.12.12.12.1.m1.1b"><apply id="S5.T3.12.12.12.1.m1.1.1.cmml" xref="S5.T3.12.12.12.1.m1.1.1"><csymbol cd="latexml" id="S5.T3.12.12.12.1.m1.1.1.1.cmml" xref="S5.T3.12.12.12.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.12.12.12.1.m1.1.1.2.cmml" xref="S5.T3.12.12.12.1.m1.1.1.2">74.42</cn><cn type="float" id="S5.T3.12.12.12.1.m1.1.1.3.cmml" xref="S5.T3.12.12.12.1.m1.1.1.3">1.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.12.12.1.m1.1c">74.42\pm 1.22</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.13.13.13" class="ltx_tr">
<td id="S5.T3.13.13.13.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr">Ablate classifier distillation</td>
<td id="S5.T3.13.13.13.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T3.13.13.13.1.m1.1" class="ltx_Math" alttext="68.46\pm 0.91" display="inline"><semantics id="S5.T3.13.13.13.1.m1.1a"><mrow id="S5.T3.13.13.13.1.m1.1.1" xref="S5.T3.13.13.13.1.m1.1.1.cmml"><mn id="S5.T3.13.13.13.1.m1.1.1.2" xref="S5.T3.13.13.13.1.m1.1.1.2.cmml">68.46</mn><mo id="S5.T3.13.13.13.1.m1.1.1.1" xref="S5.T3.13.13.13.1.m1.1.1.1.cmml">±</mo><mn id="S5.T3.13.13.13.1.m1.1.1.3" xref="S5.T3.13.13.13.1.m1.1.1.3.cmml">0.91</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.13.13.13.1.m1.1b"><apply id="S5.T3.13.13.13.1.m1.1.1.cmml" xref="S5.T3.13.13.13.1.m1.1.1"><csymbol cd="latexml" id="S5.T3.13.13.13.1.m1.1.1.1.cmml" xref="S5.T3.13.13.13.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.13.13.13.1.m1.1.1.2.cmml" xref="S5.T3.13.13.13.1.m1.1.1.2">68.46</cn><cn type="float" id="S5.T3.13.13.13.1.m1.1.1.3.cmml" xref="S5.T3.13.13.13.1.m1.1.1.3">0.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.13.13.1.m1.1c">68.46\pm 0.91</annotation></semantics></math></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.20.3.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S5.T3.17.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation Results (%) on 10-task CIFAR 100<span id="S5.T3.17.2.2" class="ltx_text ltx_font_medium">. <math id="S5.T3.16.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="S5.T3.16.1.1.m1.1b"><msub id="S5.T3.16.1.1.m1.1.1" xref="S5.T3.16.1.1.m1.1.1.cmml"><mi id="S5.T3.16.1.1.m1.1.1.2" xref="S5.T3.16.1.1.m1.1.1.2.cmml">A</mi><mi id="S5.T3.16.1.1.m1.1.1.3" xref="S5.T3.16.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T3.16.1.1.m1.1c"><apply id="S5.T3.16.1.1.m1.1.1.cmml" xref="S5.T3.16.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.16.1.1.m1.1.1.1.cmml" xref="S5.T3.16.1.1.m1.1.1">subscript</csymbol><ci id="S5.T3.16.1.1.m1.1.1.2.cmml" xref="S5.T3.16.1.1.m1.1.1.2">𝐴</ci><ci id="S5.T3.16.1.1.m1.1.1.3.cmml" xref="S5.T3.16.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.16.1.1.m1.1d">A_{N}</annotation></semantics></math> gives the accuracy averaged over tasks and <math id="S5.T3.17.2.2.m2.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="S5.T3.17.2.2.m2.1b"><msub id="S5.T3.17.2.2.m2.1.1" xref="S5.T3.17.2.2.m2.1.1.cmml"><mi id="S5.T3.17.2.2.m2.1.1.2" xref="S5.T3.17.2.2.m2.1.1.2.cmml">F</mi><mi id="S5.T3.17.2.2.m2.1.1.3" xref="S5.T3.17.2.2.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T3.17.2.2.m2.1c"><apply id="S5.T3.17.2.2.m2.1.1.cmml" xref="S5.T3.17.2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.T3.17.2.2.m2.1.1.1.cmml" xref="S5.T3.17.2.2.m2.1.1">subscript</csymbol><ci id="S5.T3.17.2.2.m2.1.1.2.cmml" xref="S5.T3.17.2.2.m2.1.1.2">𝐹</ci><ci id="S5.T3.17.2.2.m2.1.1.3.cmml" xref="S5.T3.17.2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.17.2.2.m2.1d">F_{N}</annotation></semantics></math> gives the average forgetting.</span></span></figcaption>
</figure>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.2" class="ltx_p"><span id="S5.SS2.p3.2.1" class="ltx_text ltx_font_bold">Ablating disagreement losses in generation.</span> To demonstrate the effectiveness of disagreement losses in generation, we set both the lambda coefficients to zero and observe a  6% drop.
As discussed before, the intuition here is that in absence of the disagreement losses, the generator is prone to generate easily discriminable examples that lead to low classification loss but are less effective in distillation. To further highlight the importance of the individual losses, i.e <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{MSE}" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml"><mi id="S5.SS2.p3.1.m1.1.1.3.2" xref="S5.SS2.p3.1.m1.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p3.1.m1.1.1.3.1" xref="S5.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p3.1.m1.1.1.3.3" xref="S5.SS2.p3.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p3.1.m1.1.1.3.1a" xref="S5.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p3.1.m1.1.1.3.4" xref="S5.SS2.p3.1.m1.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">ℒ</ci><apply id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3"><times id="S5.SS2.p3.1.m1.1.1.3.1.cmml" xref="S5.SS2.p3.1.m1.1.1.3.1"></times><ci id="S5.SS2.p3.1.m1.1.1.3.2.cmml" xref="S5.SS2.p3.1.m1.1.1.3.2">𝑀</ci><ci id="S5.SS2.p3.1.m1.1.1.3.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3.3">𝑆</ci><ci id="S5.SS2.p3.1.m1.1.1.3.4.cmml" xref="S5.SS2.p3.1.m1.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\mathcal{L}_{MSE}</annotation></semantics></math> and <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{KL}" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><msub id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml"><mi id="S5.SS2.p3.2.m2.1.1.3.2" xref="S5.SS2.p3.2.m2.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p3.2.m2.1.1.3.1" xref="S5.SS2.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p3.2.m2.1.1.3.3" xref="S5.SS2.p3.2.m2.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">ℒ</ci><apply id="S5.SS2.p3.2.m2.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3"><times id="S5.SS2.p3.2.m2.1.1.3.1.cmml" xref="S5.SS2.p3.2.m2.1.1.3.1"></times><ci id="S5.SS2.p3.2.m2.1.1.3.2.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2">𝐾</ci><ci id="S5.SS2.p3.2.m2.1.1.3.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\mathcal{L}_{KL}</annotation></semantics></math>, we individually ablate them and observe performance drops.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Ablating distillation targets.</span>
In this experiment, we avoid distillation for the prompt components and the classifier separately and observe a decline in performance in both cases. The drop in performance is more pronounced when we ablate distillation for the classifier. This experiment highlights our decision to fine-tune both prompt components and classifiers by operating in the latent space.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Varying the category ratio.</span> Figure <a href="#S5.F3.1" title="Figure 3 ‣ 5.2 Ablation studies and Additional Analysis ‣ 5 Experiments ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the performance of all methods for different values of <span id="S5.SS2.p5.1.2" class="ltx_text ltx_font_italic">category ratio</span>. We observe that HePCo consistently outperforms competing methods without requiring any hyperparameter or design changes. The performance gap between HePCo and the competing methods widens with the category ratio, indicating its effectiveness in high heterogeneity settings.</p>
</div>
<div id="S5.SS2.p6" class="ltx_para">
<p id="S5.SS2.p6.1" class="ltx_p"><span id="S5.SS2.p6.1.1" class="ltx_text ltx_font_bold">Analyzing communication and compute overheads</span>
Our method shares only parameters equal to 9.5% of the original model size which drastically reduces the communication cost compared to all other methods that share entire models parameters and other supplementary data. Our method does not impose any overhead on the client while introducing a small computation overhead at the server side. We provide a breakdown of the overhead costs in Appendix <a href="#A2" title="Appendix B Overhead Costs ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In conclusion, we propose HePCo (Heterogeneous Prompt Consolidation) for continual federated learning. Our method harnesses the prompt learning capabilities of pretrained models to facilitate a data-free distillation framework for consolidating heterogeneous clients. We demonstrate the superior performance of our method through a series of experiments that emulate challenging real-world scenarios. By requiring clients to share parts of their models, we significantly reduce communication costs and enhance privacy. Importantly, our approach does not impose any additional overheads on the client side, making it highly valuable for real-world deployment. We include a discussion on the limitations of our work in Appendix <a href="#A3" title="Appendix C Discussion ‣ HePCo: Data-Free Heterogeneous Prompt Consolidation for Continual Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
Blaise Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yen-Chang Hsu, Yen-Cheng Liu, Anita Ramasamy, and Zsolt Kira.

</span>
<span class="ltx_bibblock">Re-evaluating continual learning scenarios: A categorization and case
for strong baselines.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1810.12488</span>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Gido M van de Ven and Andreas S Tolias.

</span>
<span class="ltx_bibblock">Three scenarios for continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1904.07734</span>, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1806.00582, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jaehong Yoon, Wonyong Jeong, Giwoong Lee, Eunho Yang, and Sung Ju Hwang.

</span>
<span class="ltx_bibblock">Federated continual learning with weighted inter-client transfer,
2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yuhang Ma, Zhongle Xie, Jue Wang, Ke Chen, and Lidan Shou.

</span>
<span class="ltx_bibblock">Continual federated learning based on knowledge distillation.

</span>
<span class="ltx_bibblock">In Lud De Raedt, editor, <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Proceedings of the Thirty-First
International Joint Conference on Artificial Intelligence, IJCAI-22</span>, pages
2182–2188. International Joint Conferences on Artificial Intelligence
Organization, 7 2022.

</span>
<span class="ltx_bibblock">Main Track.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Daiqing Qi, Handong Zhao, and Sheng Li.

</span>
<span class="ltx_bibblock">Better generative replay for continual federated learning, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Nicholas Carlini, Jamie Hayes, Milad Nasr, Matthew Jagielski, Vikash Sehwag,
Florian Tramèr, Borja Balle, Daphne Ippolito, and Eric Wallace.

</span>
<span class="ltx_bibblock">Extracting training data from diffusion models, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Sayna Ebrahimi, Franziska Meier, Roberto Calandra, Trevor Darrell, and Marcus
Rohrbach.

</span>
<span class="ltx_bibblock">Adversarial continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.09553</span>, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Soochan Lee, Junsoo Ha, Dongsu Zhang, and Gunhee Kim.

</span>
<span class="ltx_bibblock">A neural dirichlet process mixture model for task-free continual
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.00689</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Vincenzo Lomonaco and Davide Maltoni.

</span>
<span class="ltx_bibblock">Core50: a new dataset and benchmark for continuous object
recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1705.03550</span>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Davide Maltoni and Vincenzo Lomonaco.

</span>
<span class="ltx_bibblock">Continuous learning in single-incremental-task scenarios.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Neural Networks</span>, 116:56–73, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Andrei A Rusu, Neil C Rabinowitz, Guillaume Desjardins, Hubert Soyer, James
Kirkpatrick, Koray Kavukcuoglu, Razvan Pascanu, and Raia Hadsell.

</span>
<span class="ltx_bibblock">Progressive neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.04671</span>, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Hongjoon Ahn, Jihwan Kwak, Subin Lim, Hyeonsu Bang, Hyojun Kim, and Taesup
Moon.

</span>
<span class="ltx_bibblock">Ss-il: Separated softmax for incremental learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision (ICCV)</span>, pages 844–853, October 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Rahaf Aljundi, Francesca Babiloni, Mohamed Elhoseiny, Marcus Rohrbach, and
Tinne Tuytelaars.

</span>
<span class="ltx_bibblock">Memory aware synapses: Learning what (not) to forget.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Saihui Hou, Xinyu Pan, Chen Change Loy, Zilei Wang, and Dahua Lin.

</span>
<span class="ltx_bibblock">Lifelong learning via progressive distillation and retrospection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</span>, pages 437–452, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume
Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka
Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proceedings of the national academy of sciences</span>, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Zhizhong Li and Derek Hoiem.

</span>
<span class="ltx_bibblock">Learning without forgetting.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>,
40(12):2935–2947, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Friedemann Zenke, Ben Poole, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Continual learning through synaptic intelligence.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Jihwan Bang, Heesu Kim, YoungJoon Yoo, Jung-Woo Ha, and Jonghyun Choi.

</span>
<span class="ltx_bibblock">Rainbow memory: Continual learning with a memory of diverse samples.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 8218–8227, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Arslan Chaudhry, Marcus Rohrbach, Mohamed Elhoseiny, Thalaiyasingam Ajanthan,
Puneet K Dokania, Philip HS Torr, and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Continual learning with tiny episodic memories.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1902.10486</span>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Tyler L Hayes, Nathan D Cahill, and Christopher Kanan.

</span>
<span class="ltx_bibblock">Memory efficient experience replay for streaming learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">2019 International Conference on Robotics and Automation
(ICRA)</span>, pages 9769–9776. IEEE, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Saihui Hou, Xinyu Pan, Chen Change Loy, Zilei Wang, and Dahua Lin.

</span>
<span class="ltx_bibblock">Learning a unified classifier incrementally via rebalancing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, pages 831–839, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
David Lopez-Paz and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Gradient episodic memory for continual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proceedings of the 31st International Conference on Neural
Information Processing Systems</span>, NIPS’17, pages 6470–6479, USA, 2017. Curran
Associates Inc.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Oleksiy Ostapenko, Mihai Puscas, Tassilo Klein, Patrick Jahnichen, and Moin
Nabi.

</span>
<span class="ltx_bibblock">Learning to remember: A synaptic plasticity driven framework for
continual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, pages 11321–11329, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Sylvestre-Alvise Rebuffi, Alexander Kolesnikov, Georg Sperl, and Christoph H.
Lampert.

</span>
<span class="ltx_bibblock">icarl: Incremental classifier and representation learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">2017 IEEE Conference on Computer Vision and Pattern
Recognition</span>, CVPR’17, pages 5533–5542, 2017.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Hanul Shin, Jung Kwon Lee, Jaehong Kim, and Jiwon Kim.

</span>
<span class="ltx_bibblock">Continual learning with deep generative replay.

</span>
<span class="ltx_bibblock">In I. Guyon, U. V. Luxburg, S. Bengio, H. Wallach, R. Fergus,
S. Vishwanathan, and R. Garnett, editors, <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information
Processing Systems 30</span>, pages 2990–2999. Curran Associates, Inc., 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Johannes von Oswald, Christian Henning, João Sacramento, and Benjamin F
Grewe.

</span>
<span class="ltx_bibblock">Continual learning with hypernetworks.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1906.00695</span>, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Gido M van de Ven, Hava T Siegelmann, and Andreas S Tolias.

</span>
<span class="ltx_bibblock">Brain-inspired replay for continual learning with artificial neural
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Nature communications</span>, 11(1):1–14, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Tyler L Hayes and Christopher Kanan.

</span>
<span class="ltx_bibblock">Lifelong machine learning with deep streaming linear discriminant
analysis.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.01520</span>, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Vincenzo Lomonaco, Davide Maltoni, and Lorenzo Pellegrini.

</span>
<span class="ltx_bibblock">Rehearsal-free continual learning over small non-iid batches.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">CVPR Workshops</span>, pages 989–998, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Lu Yu, Bartlomiej Twardowski, Xialei Liu, Luis Herranz, Kai Wang, Yongmei
Cheng, Shangling Jui, and Joost van de Weijer.

</span>
<span class="ltx_bibblock">Semantic drift compensation for class-incremental learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 6982–6991, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Guile Wu, Shaogang Gong, and Pan Li.

</span>
<span class="ltx_bibblock">Striking a balance between stability and plasticity for
class-incremental learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, pages 1124–1133, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Fei Zhu, Xu-Yao Zhang, Chuang Wang, Fei Yin, and Cheng-Lin Liu.

</span>
<span class="ltx_bibblock">Prototype augmentation and self-supervision for incremental learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 5871–5880, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Yoojin Choi, Mostafa El-Khamy, and Jungwon Lee.

</span>
<span class="ltx_bibblock">Dual-teacher class-incremental learning with data-free generative
replay.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 3543–3552, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Georgios Kaissis, Alexander Ziller, Jonathan Passerat-Palmbach, Théo
Ryffel, Dmitrii Usynin, Andrew Trask, Ionésio Lima, Jason Mancuso,
Friederike Jungmann, Marc-Matthias Steinborn, et al.

</span>
<span class="ltx_bibblock">End-to-end privacy preserving deep learning on multi-institutional
medical imaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Nature Machine Intelligence</span>, 3(6):473–484, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
James Smith, Yen-Chang Hsu, Jonathan Balloch, Yilin Shen, Hongxia Jin, and
Zsolt Kira.

</span>
<span class="ltx_bibblock">Always be dreaming: A new approach for data-free class-incremental
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision (ICCV)</span>, pages 9374–9384, October 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Hongxu Yin, Pavlo Molchanov, Jose M Alvarez, Zhizhong Li, Arun Mallya, Derek
Hoiem, Niraj K Jha, and Jan Kautz.

</span>
<span class="ltx_bibblock">Dreaming to distill: Data-free knowledge transfer via deepinversion.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 8715–8724, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
K J Joseph, Sujoy Paul, Gaurav Aggarwal, Soma Biswas, Piyush Rai, Kai Han, and
Vineeth N Balasubramanian.

</span>
<span class="ltx_bibblock">Novel class discovery without forgetting, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
James Seale Smith, Leonid Karlinsky, Vyshnavi Gutta, Paola Cascante-Bonilla,
Donghyun Kim, Assaf Arbelle, Rameswar Panda, Rogerio Feris, and Zsolt Kira.

</span>
<span class="ltx_bibblock">Coda-prompt: Continual decomposed attention-based prompting for
rehearsal-free continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2211.13218</span>, 2022.

</span>
<span class="ltx_bibblock">Accepted for publication at CVPR 2023.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Zifeng Wang, Zizhao Zhang, Chen-Yu Lee, Han Zhang, Ruoxi Sun, Xiaoqi Ren,
Guolong Su, Vincent Perot, Jennifer Dy, and Tomas Pfister.

</span>
<span class="ltx_bibblock">Learning to prompt for continual learning, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Zifeng Wang, Zizhao Zhang, Sayna Ebrahimi, Ruoxi Sun, Han Zhang, Chen-Yu Lee,
Xiaoqi Ren, Guolong Su, Vincent Perot, Jennifer Dy, and Tomas Pfister.

</span>
<span class="ltx_bibblock">Dualprompt: Complementary prompting for rehearsal-free continual
learning, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine learning and systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Xinwei Zhang, Mingyi Hong, Sairaj Dhople, Wotao Yin, and Yang Liu.

</span>
<span class="ltx_bibblock">Fedpd: A federated learning framework with optimal rates and
adaptivity to non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2005.11418</span>, 2020.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas Navarro, Matthew Mattina, Paul N
Whatmough, and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2111.04263</span>, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank J. Reddi,
Sebastian U. Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning,
2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Alessio Mora, Irene Tenison, Paolo Bellavista, and Irina Rish.

</span>
<span class="ltx_bibblock">Knowledge distillation for federated learning: a practical guide.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2211.04742</span>, 2022.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:2351–2363, 2020.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Felix Sattler, Tim Korjakow, Roman Rischke, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Fedaux: Leveraging unlabeled auxiliary data in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>,
2021.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Lin Zhang, Li Shen, Liang Ding, Dacheng Tao, and Ling-Yu Duan.

</span>
<span class="ltx_bibblock">Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 10174–10183, 2022.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Jiahua Dong, Lixu Wang, Zhen Fang, Gan Sun, Shichao Xu, Xiao Wang, and Qi Zhu.

</span>
<span class="ltx_bibblock">Federated class-incremental learning, 2022.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Jie Zhang, Chen Chen, Weiming Zhuang, and Lingjuan Lv.

</span>
<span class="ltx_bibblock">Addressing catastrophic forgetting in federated class-continual
learning, 2023.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Kaidi Cao, Colin Wei, Adrien Gaidon, Nikos Arechiga, and Tengyu Ma.

</span>
<span class="ltx_bibblock">Learning imbalanced datasets with label-distribution-aware margin
loss, 2019.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Gihun Lee, Minchan Jeong, Yongjin Shin, Sangmin Bae, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Preservation of the global knowledge by not-true distillation in
federated learning, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification, 2019.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.11929</span>, 2020.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Lin Zhang, Li Shen, Liang Ding, Dacheng Tao, and Ling-Yu Duan.

</span>
<span class="ltx_bibblock">Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning, 2022.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma,
Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein, et al.

</span>
<span class="ltx_bibblock">Imagenet large scale visual recognition challenge.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">International journal of computer vision</span>, 115(3):211–252,
2015.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Zifeng Wang, Zizhao Zhang, Sayna Ebrahimi, Ruoxi Sun, Han Zhang, Chen-Yu Lee,
Xiaoqi Ren, Guolong Su, Vincent Perot, Jennifer Dy, et al.

</span>
<span class="ltx_bibblock">Dualprompt: Complementary prompting for rehearsal-free continual
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2204.04799</span>, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text ltx_font_italic">Tech Report</span>, 2009.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Dan Hendrycks, Steven Basart, Norman Mu, Saurav Kadavath, Frank Wang, Evan
Dorundo, Rahul Desai, Tyler Zhu, Samyak Parajuli, Mike Guo, Dawn Song, Jacob
Steinhardt, and Justin Gilmer.

</span>
<span class="ltx_bibblock">The many faces of robustness: A critical analysis of
out-of-distribution generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2021.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Xingchao Peng, Qinxun Bai, Xide Xia, Zijun Huang, Kate Saenko, and Bo Wang.

</span>
<span class="ltx_bibblock">Moment matching for multi-source domain adaptation, 2019.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Sylvestre-Alvise Rebuffi, Hakan Bilen, and Andrea Vedaldi.

</span>
<span class="ltx_bibblock">Learning multiple visual domains with residual adapters.

</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Arslan Chaudhry, Marc’Aurelio Ranzato, Marcus Rohrbach, and Mohamed
Elhoseiny.

</span>
<span class="ltx_bibblock">Efficient lifelong learning with a-GEM.

</span>
<span class="ltx_bibblock">In <span id="bib.bib65.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2019.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Raphael Gontijo Lopes, Stefano Fenu, and Thad Starner.

</span>
<span class="ltx_bibblock">Data-free knowledge distillation for deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib66.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1710.07535</span>, 2017.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
James Seale Smith, Junjiao Tian, Shaunak Halbe, Yen-Chang Hsu, and Zsolt Kira.

</span>
<span class="ltx_bibblock">A closer look at rehearsal-free continual learning, 2023.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
Ross Wightman.

</span>
<span class="ltx_bibblock">Pytorch image models.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/rwightman/pytorch-image-models" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/rwightman/pytorch-image-models</a>, 2019.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization, 2017.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
Daniel Justus, John Brennan, Stephen Bonner, and Andrew Stephen McGough.

</span>
<span class="ltx_bibblock">Predicting the computational cost of deep learning models, 2018.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
David Patterson, Joseph Gonzalez, Quoc Le, Chen Liang, Lluis-Miquel Munguia,
Daniel Rothchild, David So, Maud Texier, and Jeff Dean.

</span>
<span class="ltx_bibblock">Carbon emissions and large neural network training, 2021.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Alexandre Lacoste, Alexandra Luccioni, Victor Schmidt, and Thomas Dandres.

</span>
<span class="ltx_bibblock">Quantifying the carbon emissions of machine learning, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>

</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p"><span id="A1.p1.1.1" class="ltx_text ltx_font_bold">Implementation Details.</span> For fair comparison, we use the ViT-B/16 backbone pretrained on Imagenet-1K as the encoder for all methods. We implement our methods in PyTorch and use the PyTorch Image Models library <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> to obtain pretrained checkpoints. In our experiments, the total number of classes for CIFAR-100, ImageNet-R and DomainNet are 100, 200 and 345 respectively. We use 2 NVIDIA A40 GPUs for all experiments.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.3" class="ltx_p"><span id="A1.p2.3.1" class="ltx_text ltx_font_bold">Training Details.</span> For all methods, we use the Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> optimizer with <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\beta_{1}=" display="inline"><semantics id="A1.p2.1.m1.1a"><mrow id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><msub id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml"><mi id="A1.p2.1.m1.1.1.2.2" xref="A1.p2.1.m1.1.1.2.2.cmml">β</mi><mn id="A1.p2.1.m1.1.1.2.3" xref="A1.p2.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">=</mo><mi id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><eq id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1"></eq><apply id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.2.1.cmml" xref="A1.p2.1.m1.1.1.2">subscript</csymbol><ci id="A1.p2.1.m1.1.1.2.2.cmml" xref="A1.p2.1.m1.1.1.2.2">𝛽</ci><cn type="integer" id="A1.p2.1.m1.1.1.2.3.cmml" xref="A1.p2.1.m1.1.1.2.3">1</cn></apply><csymbol cd="latexml" id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\beta_{1}=</annotation></semantics></math> 0.9 and <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\beta_{2}=" display="inline"><semantics id="A1.p2.2.m2.1a"><mrow id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml"><msub id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml"><mi id="A1.p2.2.m2.1.1.2.2" xref="A1.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="A1.p2.2.m2.1.1.2.3" xref="A1.p2.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="A1.p2.2.m2.1.1.1" xref="A1.p2.2.m2.1.1.1.cmml">=</mo><mi id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1"><eq id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1"></eq><apply id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.2.1.cmml" xref="A1.p2.2.m2.1.1.2">subscript</csymbol><ci id="A1.p2.2.m2.1.1.2.2.cmml" xref="A1.p2.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="A1.p2.2.m2.1.1.2.3.cmml" xref="A1.p2.2.m2.1.1.2.3">2</cn></apply><csymbol cd="latexml" id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\beta_{2}=</annotation></semantics></math> 0.999. We resize images to <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mn id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">×</mo><mn id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><times id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1"></times><cn type="integer" id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">224</cn><cn type="integer" id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">224\times 224</annotation></semantics></math> and normalize to [0,1].</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.9" class="ltx_p"><span id="A1.p3.9.1" class="ltx_text ltx_font_bold">Hyperparameter Search.</span> As done in DualPrompt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> we use 20% of the training dataset as our validation data and conduct a hyperparameter search.
We arrive at using a batch size of 64 for both local and server-side training. We use a learning rate of <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="A1.p3.1.m1.1a"><mrow id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml"><mn id="A1.p3.1.m1.1.1.2" xref="A1.p3.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.1.m1.1.1.1" xref="A1.p3.1.m1.1.1.1.cmml">​</mo><msup id="A1.p3.1.m1.1.1.3" xref="A1.p3.1.m1.1.1.3.cmml"><mi id="A1.p3.1.m1.1.1.3.2" xref="A1.p3.1.m1.1.1.3.2.cmml">e</mi><mrow id="A1.p3.1.m1.1.1.3.3" xref="A1.p3.1.m1.1.1.3.3.cmml"><mo id="A1.p3.1.m1.1.1.3.3a" xref="A1.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.p3.1.m1.1.1.3.3.2" xref="A1.p3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><apply id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1"><times id="A1.p3.1.m1.1.1.1.cmml" xref="A1.p3.1.m1.1.1.1"></times><cn type="integer" id="A1.p3.1.m1.1.1.2.cmml" xref="A1.p3.1.m1.1.1.2">1</cn><apply id="A1.p3.1.m1.1.1.3.cmml" xref="A1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.p3.1.m1.1.1.3.1.cmml" xref="A1.p3.1.m1.1.1.3">superscript</csymbol><ci id="A1.p3.1.m1.1.1.3.2.cmml" xref="A1.p3.1.m1.1.1.3.2">𝑒</ci><apply id="A1.p3.1.m1.1.1.3.3.cmml" xref="A1.p3.1.m1.1.1.3.3"><minus id="A1.p3.1.m1.1.1.3.3.1.cmml" xref="A1.p3.1.m1.1.1.3.3"></minus><cn type="integer" id="A1.p3.1.m1.1.1.3.3.2.cmml" xref="A1.p3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">1e^{-3}</annotation></semantics></math> for our method and the prompting-based baselines and a learning rate of <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="5e^{-5}" display="inline"><semantics id="A1.p3.2.m2.1a"><mrow id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml"><mn id="A1.p3.2.m2.1.1.2" xref="A1.p3.2.m2.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.2.m2.1.1.1" xref="A1.p3.2.m2.1.1.1.cmml">​</mo><msup id="A1.p3.2.m2.1.1.3" xref="A1.p3.2.m2.1.1.3.cmml"><mi id="A1.p3.2.m2.1.1.3.2" xref="A1.p3.2.m2.1.1.3.2.cmml">e</mi><mrow id="A1.p3.2.m2.1.1.3.3" xref="A1.p3.2.m2.1.1.3.3.cmml"><mo id="A1.p3.2.m2.1.1.3.3a" xref="A1.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="A1.p3.2.m2.1.1.3.3.2" xref="A1.p3.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><apply id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1"><times id="A1.p3.2.m2.1.1.1.cmml" xref="A1.p3.2.m2.1.1.1"></times><cn type="integer" id="A1.p3.2.m2.1.1.2.cmml" xref="A1.p3.2.m2.1.1.2">5</cn><apply id="A1.p3.2.m2.1.1.3.cmml" xref="A1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.p3.2.m2.1.1.3.1.cmml" xref="A1.p3.2.m2.1.1.3">superscript</csymbol><ci id="A1.p3.2.m2.1.1.3.2.cmml" xref="A1.p3.2.m2.1.1.3.2">𝑒</ci><apply id="A1.p3.2.m2.1.1.3.3.cmml" xref="A1.p3.2.m2.1.1.3.3"><minus id="A1.p3.2.m2.1.1.3.3.1.cmml" xref="A1.p3.2.m2.1.1.3.3"></minus><cn type="integer" id="A1.p3.2.m2.1.1.3.3.2.cmml" xref="A1.p3.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">5e^{-5}</annotation></semantics></math> for all baselines that tune the entire model (FedAvg, FedLwF.MC). We search for learning rates in the values of {<math id="A1.p3.3.m3.9" class="ltx_Math" alttext="1e^{-6},5e^{-5},1e^{-5},5e^{-4},1e^{-4},5e^{-3},1e^{-3},5e^{-2},1e^{-2}" display="inline"><semantics id="A1.p3.3.m3.9a"><mrow id="A1.p3.3.m3.9.9.9" xref="A1.p3.3.m3.9.9.10.cmml"><mrow id="A1.p3.3.m3.1.1.1.1" xref="A1.p3.3.m3.1.1.1.1.cmml"><mn id="A1.p3.3.m3.1.1.1.1.2" xref="A1.p3.3.m3.1.1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.1.1.1.1.1" xref="A1.p3.3.m3.1.1.1.1.1.cmml">​</mo><msup id="A1.p3.3.m3.1.1.1.1.3" xref="A1.p3.3.m3.1.1.1.1.3.cmml"><mi id="A1.p3.3.m3.1.1.1.1.3.2" xref="A1.p3.3.m3.1.1.1.1.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.1.1.1.1.3.3" xref="A1.p3.3.m3.1.1.1.1.3.3.cmml"><mo id="A1.p3.3.m3.1.1.1.1.3.3a" xref="A1.p3.3.m3.1.1.1.1.3.3.cmml">−</mo><mn id="A1.p3.3.m3.1.1.1.1.3.3.2" xref="A1.p3.3.m3.1.1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.10" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.2.2.2.2" xref="A1.p3.3.m3.2.2.2.2.cmml"><mn id="A1.p3.3.m3.2.2.2.2.2" xref="A1.p3.3.m3.2.2.2.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.2.2.2.2.1" xref="A1.p3.3.m3.2.2.2.2.1.cmml">​</mo><msup id="A1.p3.3.m3.2.2.2.2.3" xref="A1.p3.3.m3.2.2.2.2.3.cmml"><mi id="A1.p3.3.m3.2.2.2.2.3.2" xref="A1.p3.3.m3.2.2.2.2.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.2.2.2.2.3.3" xref="A1.p3.3.m3.2.2.2.2.3.3.cmml"><mo id="A1.p3.3.m3.2.2.2.2.3.3a" xref="A1.p3.3.m3.2.2.2.2.3.3.cmml">−</mo><mn id="A1.p3.3.m3.2.2.2.2.3.3.2" xref="A1.p3.3.m3.2.2.2.2.3.3.2.cmml">5</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.11" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.3.3.3.3" xref="A1.p3.3.m3.3.3.3.3.cmml"><mn id="A1.p3.3.m3.3.3.3.3.2" xref="A1.p3.3.m3.3.3.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.3.3.3.3.1" xref="A1.p3.3.m3.3.3.3.3.1.cmml">​</mo><msup id="A1.p3.3.m3.3.3.3.3.3" xref="A1.p3.3.m3.3.3.3.3.3.cmml"><mi id="A1.p3.3.m3.3.3.3.3.3.2" xref="A1.p3.3.m3.3.3.3.3.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.3.3.3.3.3.3" xref="A1.p3.3.m3.3.3.3.3.3.3.cmml"><mo id="A1.p3.3.m3.3.3.3.3.3.3a" xref="A1.p3.3.m3.3.3.3.3.3.3.cmml">−</mo><mn id="A1.p3.3.m3.3.3.3.3.3.3.2" xref="A1.p3.3.m3.3.3.3.3.3.3.2.cmml">5</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.12" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.4.4.4.4" xref="A1.p3.3.m3.4.4.4.4.cmml"><mn id="A1.p3.3.m3.4.4.4.4.2" xref="A1.p3.3.m3.4.4.4.4.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.4.4.4.4.1" xref="A1.p3.3.m3.4.4.4.4.1.cmml">​</mo><msup id="A1.p3.3.m3.4.4.4.4.3" xref="A1.p3.3.m3.4.4.4.4.3.cmml"><mi id="A1.p3.3.m3.4.4.4.4.3.2" xref="A1.p3.3.m3.4.4.4.4.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.4.4.4.4.3.3" xref="A1.p3.3.m3.4.4.4.4.3.3.cmml"><mo id="A1.p3.3.m3.4.4.4.4.3.3a" xref="A1.p3.3.m3.4.4.4.4.3.3.cmml">−</mo><mn id="A1.p3.3.m3.4.4.4.4.3.3.2" xref="A1.p3.3.m3.4.4.4.4.3.3.2.cmml">4</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.13" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.5.5.5.5" xref="A1.p3.3.m3.5.5.5.5.cmml"><mn id="A1.p3.3.m3.5.5.5.5.2" xref="A1.p3.3.m3.5.5.5.5.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.5.5.5.5.1" xref="A1.p3.3.m3.5.5.5.5.1.cmml">​</mo><msup id="A1.p3.3.m3.5.5.5.5.3" xref="A1.p3.3.m3.5.5.5.5.3.cmml"><mi id="A1.p3.3.m3.5.5.5.5.3.2" xref="A1.p3.3.m3.5.5.5.5.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.5.5.5.5.3.3" xref="A1.p3.3.m3.5.5.5.5.3.3.cmml"><mo id="A1.p3.3.m3.5.5.5.5.3.3a" xref="A1.p3.3.m3.5.5.5.5.3.3.cmml">−</mo><mn id="A1.p3.3.m3.5.5.5.5.3.3.2" xref="A1.p3.3.m3.5.5.5.5.3.3.2.cmml">4</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.14" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.6.6.6.6" xref="A1.p3.3.m3.6.6.6.6.cmml"><mn id="A1.p3.3.m3.6.6.6.6.2" xref="A1.p3.3.m3.6.6.6.6.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.6.6.6.6.1" xref="A1.p3.3.m3.6.6.6.6.1.cmml">​</mo><msup id="A1.p3.3.m3.6.6.6.6.3" xref="A1.p3.3.m3.6.6.6.6.3.cmml"><mi id="A1.p3.3.m3.6.6.6.6.3.2" xref="A1.p3.3.m3.6.6.6.6.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.6.6.6.6.3.3" xref="A1.p3.3.m3.6.6.6.6.3.3.cmml"><mo id="A1.p3.3.m3.6.6.6.6.3.3a" xref="A1.p3.3.m3.6.6.6.6.3.3.cmml">−</mo><mn id="A1.p3.3.m3.6.6.6.6.3.3.2" xref="A1.p3.3.m3.6.6.6.6.3.3.2.cmml">3</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.15" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.7.7.7.7" xref="A1.p3.3.m3.7.7.7.7.cmml"><mn id="A1.p3.3.m3.7.7.7.7.2" xref="A1.p3.3.m3.7.7.7.7.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.7.7.7.7.1" xref="A1.p3.3.m3.7.7.7.7.1.cmml">​</mo><msup id="A1.p3.3.m3.7.7.7.7.3" xref="A1.p3.3.m3.7.7.7.7.3.cmml"><mi id="A1.p3.3.m3.7.7.7.7.3.2" xref="A1.p3.3.m3.7.7.7.7.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.7.7.7.7.3.3" xref="A1.p3.3.m3.7.7.7.7.3.3.cmml"><mo id="A1.p3.3.m3.7.7.7.7.3.3a" xref="A1.p3.3.m3.7.7.7.7.3.3.cmml">−</mo><mn id="A1.p3.3.m3.7.7.7.7.3.3.2" xref="A1.p3.3.m3.7.7.7.7.3.3.2.cmml">3</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.16" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.8.8.8.8" xref="A1.p3.3.m3.8.8.8.8.cmml"><mn id="A1.p3.3.m3.8.8.8.8.2" xref="A1.p3.3.m3.8.8.8.8.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.8.8.8.8.1" xref="A1.p3.3.m3.8.8.8.8.1.cmml">​</mo><msup id="A1.p3.3.m3.8.8.8.8.3" xref="A1.p3.3.m3.8.8.8.8.3.cmml"><mi id="A1.p3.3.m3.8.8.8.8.3.2" xref="A1.p3.3.m3.8.8.8.8.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.8.8.8.8.3.3" xref="A1.p3.3.m3.8.8.8.8.3.3.cmml"><mo id="A1.p3.3.m3.8.8.8.8.3.3a" xref="A1.p3.3.m3.8.8.8.8.3.3.cmml">−</mo><mn id="A1.p3.3.m3.8.8.8.8.3.3.2" xref="A1.p3.3.m3.8.8.8.8.3.3.2.cmml">2</mn></mrow></msup></mrow><mo id="A1.p3.3.m3.9.9.9.17" xref="A1.p3.3.m3.9.9.10.cmml">,</mo><mrow id="A1.p3.3.m3.9.9.9.9" xref="A1.p3.3.m3.9.9.9.9.cmml"><mn id="A1.p3.3.m3.9.9.9.9.2" xref="A1.p3.3.m3.9.9.9.9.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.3.m3.9.9.9.9.1" xref="A1.p3.3.m3.9.9.9.9.1.cmml">​</mo><msup id="A1.p3.3.m3.9.9.9.9.3" xref="A1.p3.3.m3.9.9.9.9.3.cmml"><mi id="A1.p3.3.m3.9.9.9.9.3.2" xref="A1.p3.3.m3.9.9.9.9.3.2.cmml">e</mi><mrow id="A1.p3.3.m3.9.9.9.9.3.3" xref="A1.p3.3.m3.9.9.9.9.3.3.cmml"><mo id="A1.p3.3.m3.9.9.9.9.3.3a" xref="A1.p3.3.m3.9.9.9.9.3.3.cmml">−</mo><mn id="A1.p3.3.m3.9.9.9.9.3.3.2" xref="A1.p3.3.m3.9.9.9.9.3.3.2.cmml">2</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.9b"><list id="A1.p3.3.m3.9.9.10.cmml" xref="A1.p3.3.m3.9.9.9"><apply id="A1.p3.3.m3.1.1.1.1.cmml" xref="A1.p3.3.m3.1.1.1.1"><times id="A1.p3.3.m3.1.1.1.1.1.cmml" xref="A1.p3.3.m3.1.1.1.1.1"></times><cn type="integer" id="A1.p3.3.m3.1.1.1.1.2.cmml" xref="A1.p3.3.m3.1.1.1.1.2">1</cn><apply id="A1.p3.3.m3.1.1.1.1.3.cmml" xref="A1.p3.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.1.1.1.1.3.1.cmml" xref="A1.p3.3.m3.1.1.1.1.3">superscript</csymbol><ci id="A1.p3.3.m3.1.1.1.1.3.2.cmml" xref="A1.p3.3.m3.1.1.1.1.3.2">𝑒</ci><apply id="A1.p3.3.m3.1.1.1.1.3.3.cmml" xref="A1.p3.3.m3.1.1.1.1.3.3"><minus id="A1.p3.3.m3.1.1.1.1.3.3.1.cmml" xref="A1.p3.3.m3.1.1.1.1.3.3"></minus><cn type="integer" id="A1.p3.3.m3.1.1.1.1.3.3.2.cmml" xref="A1.p3.3.m3.1.1.1.1.3.3.2">6</cn></apply></apply></apply><apply id="A1.p3.3.m3.2.2.2.2.cmml" xref="A1.p3.3.m3.2.2.2.2"><times id="A1.p3.3.m3.2.2.2.2.1.cmml" xref="A1.p3.3.m3.2.2.2.2.1"></times><cn type="integer" id="A1.p3.3.m3.2.2.2.2.2.cmml" xref="A1.p3.3.m3.2.2.2.2.2">5</cn><apply id="A1.p3.3.m3.2.2.2.2.3.cmml" xref="A1.p3.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.2.2.2.2.3.1.cmml" xref="A1.p3.3.m3.2.2.2.2.3">superscript</csymbol><ci id="A1.p3.3.m3.2.2.2.2.3.2.cmml" xref="A1.p3.3.m3.2.2.2.2.3.2">𝑒</ci><apply id="A1.p3.3.m3.2.2.2.2.3.3.cmml" xref="A1.p3.3.m3.2.2.2.2.3.3"><minus id="A1.p3.3.m3.2.2.2.2.3.3.1.cmml" xref="A1.p3.3.m3.2.2.2.2.3.3"></minus><cn type="integer" id="A1.p3.3.m3.2.2.2.2.3.3.2.cmml" xref="A1.p3.3.m3.2.2.2.2.3.3.2">5</cn></apply></apply></apply><apply id="A1.p3.3.m3.3.3.3.3.cmml" xref="A1.p3.3.m3.3.3.3.3"><times id="A1.p3.3.m3.3.3.3.3.1.cmml" xref="A1.p3.3.m3.3.3.3.3.1"></times><cn type="integer" id="A1.p3.3.m3.3.3.3.3.2.cmml" xref="A1.p3.3.m3.3.3.3.3.2">1</cn><apply id="A1.p3.3.m3.3.3.3.3.3.cmml" xref="A1.p3.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.3.3.3.3.3.1.cmml" xref="A1.p3.3.m3.3.3.3.3.3">superscript</csymbol><ci id="A1.p3.3.m3.3.3.3.3.3.2.cmml" xref="A1.p3.3.m3.3.3.3.3.3.2">𝑒</ci><apply id="A1.p3.3.m3.3.3.3.3.3.3.cmml" xref="A1.p3.3.m3.3.3.3.3.3.3"><minus id="A1.p3.3.m3.3.3.3.3.3.3.1.cmml" xref="A1.p3.3.m3.3.3.3.3.3.3"></minus><cn type="integer" id="A1.p3.3.m3.3.3.3.3.3.3.2.cmml" xref="A1.p3.3.m3.3.3.3.3.3.3.2">5</cn></apply></apply></apply><apply id="A1.p3.3.m3.4.4.4.4.cmml" xref="A1.p3.3.m3.4.4.4.4"><times id="A1.p3.3.m3.4.4.4.4.1.cmml" xref="A1.p3.3.m3.4.4.4.4.1"></times><cn type="integer" id="A1.p3.3.m3.4.4.4.4.2.cmml" xref="A1.p3.3.m3.4.4.4.4.2">5</cn><apply id="A1.p3.3.m3.4.4.4.4.3.cmml" xref="A1.p3.3.m3.4.4.4.4.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.4.4.4.4.3.1.cmml" xref="A1.p3.3.m3.4.4.4.4.3">superscript</csymbol><ci id="A1.p3.3.m3.4.4.4.4.3.2.cmml" xref="A1.p3.3.m3.4.4.4.4.3.2">𝑒</ci><apply id="A1.p3.3.m3.4.4.4.4.3.3.cmml" xref="A1.p3.3.m3.4.4.4.4.3.3"><minus id="A1.p3.3.m3.4.4.4.4.3.3.1.cmml" xref="A1.p3.3.m3.4.4.4.4.3.3"></minus><cn type="integer" id="A1.p3.3.m3.4.4.4.4.3.3.2.cmml" xref="A1.p3.3.m3.4.4.4.4.3.3.2">4</cn></apply></apply></apply><apply id="A1.p3.3.m3.5.5.5.5.cmml" xref="A1.p3.3.m3.5.5.5.5"><times id="A1.p3.3.m3.5.5.5.5.1.cmml" xref="A1.p3.3.m3.5.5.5.5.1"></times><cn type="integer" id="A1.p3.3.m3.5.5.5.5.2.cmml" xref="A1.p3.3.m3.5.5.5.5.2">1</cn><apply id="A1.p3.3.m3.5.5.5.5.3.cmml" xref="A1.p3.3.m3.5.5.5.5.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.5.5.5.5.3.1.cmml" xref="A1.p3.3.m3.5.5.5.5.3">superscript</csymbol><ci id="A1.p3.3.m3.5.5.5.5.3.2.cmml" xref="A1.p3.3.m3.5.5.5.5.3.2">𝑒</ci><apply id="A1.p3.3.m3.5.5.5.5.3.3.cmml" xref="A1.p3.3.m3.5.5.5.5.3.3"><minus id="A1.p3.3.m3.5.5.5.5.3.3.1.cmml" xref="A1.p3.3.m3.5.5.5.5.3.3"></minus><cn type="integer" id="A1.p3.3.m3.5.5.5.5.3.3.2.cmml" xref="A1.p3.3.m3.5.5.5.5.3.3.2">4</cn></apply></apply></apply><apply id="A1.p3.3.m3.6.6.6.6.cmml" xref="A1.p3.3.m3.6.6.6.6"><times id="A1.p3.3.m3.6.6.6.6.1.cmml" xref="A1.p3.3.m3.6.6.6.6.1"></times><cn type="integer" id="A1.p3.3.m3.6.6.6.6.2.cmml" xref="A1.p3.3.m3.6.6.6.6.2">5</cn><apply id="A1.p3.3.m3.6.6.6.6.3.cmml" xref="A1.p3.3.m3.6.6.6.6.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.6.6.6.6.3.1.cmml" xref="A1.p3.3.m3.6.6.6.6.3">superscript</csymbol><ci id="A1.p3.3.m3.6.6.6.6.3.2.cmml" xref="A1.p3.3.m3.6.6.6.6.3.2">𝑒</ci><apply id="A1.p3.3.m3.6.6.6.6.3.3.cmml" xref="A1.p3.3.m3.6.6.6.6.3.3"><minus id="A1.p3.3.m3.6.6.6.6.3.3.1.cmml" xref="A1.p3.3.m3.6.6.6.6.3.3"></minus><cn type="integer" id="A1.p3.3.m3.6.6.6.6.3.3.2.cmml" xref="A1.p3.3.m3.6.6.6.6.3.3.2">3</cn></apply></apply></apply><apply id="A1.p3.3.m3.7.7.7.7.cmml" xref="A1.p3.3.m3.7.7.7.7"><times id="A1.p3.3.m3.7.7.7.7.1.cmml" xref="A1.p3.3.m3.7.7.7.7.1"></times><cn type="integer" id="A1.p3.3.m3.7.7.7.7.2.cmml" xref="A1.p3.3.m3.7.7.7.7.2">1</cn><apply id="A1.p3.3.m3.7.7.7.7.3.cmml" xref="A1.p3.3.m3.7.7.7.7.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.7.7.7.7.3.1.cmml" xref="A1.p3.3.m3.7.7.7.7.3">superscript</csymbol><ci id="A1.p3.3.m3.7.7.7.7.3.2.cmml" xref="A1.p3.3.m3.7.7.7.7.3.2">𝑒</ci><apply id="A1.p3.3.m3.7.7.7.7.3.3.cmml" xref="A1.p3.3.m3.7.7.7.7.3.3"><minus id="A1.p3.3.m3.7.7.7.7.3.3.1.cmml" xref="A1.p3.3.m3.7.7.7.7.3.3"></minus><cn type="integer" id="A1.p3.3.m3.7.7.7.7.3.3.2.cmml" xref="A1.p3.3.m3.7.7.7.7.3.3.2">3</cn></apply></apply></apply><apply id="A1.p3.3.m3.8.8.8.8.cmml" xref="A1.p3.3.m3.8.8.8.8"><times id="A1.p3.3.m3.8.8.8.8.1.cmml" xref="A1.p3.3.m3.8.8.8.8.1"></times><cn type="integer" id="A1.p3.3.m3.8.8.8.8.2.cmml" xref="A1.p3.3.m3.8.8.8.8.2">5</cn><apply id="A1.p3.3.m3.8.8.8.8.3.cmml" xref="A1.p3.3.m3.8.8.8.8.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.8.8.8.8.3.1.cmml" xref="A1.p3.3.m3.8.8.8.8.3">superscript</csymbol><ci id="A1.p3.3.m3.8.8.8.8.3.2.cmml" xref="A1.p3.3.m3.8.8.8.8.3.2">𝑒</ci><apply id="A1.p3.3.m3.8.8.8.8.3.3.cmml" xref="A1.p3.3.m3.8.8.8.8.3.3"><minus id="A1.p3.3.m3.8.8.8.8.3.3.1.cmml" xref="A1.p3.3.m3.8.8.8.8.3.3"></minus><cn type="integer" id="A1.p3.3.m3.8.8.8.8.3.3.2.cmml" xref="A1.p3.3.m3.8.8.8.8.3.3.2">2</cn></apply></apply></apply><apply id="A1.p3.3.m3.9.9.9.9.cmml" xref="A1.p3.3.m3.9.9.9.9"><times id="A1.p3.3.m3.9.9.9.9.1.cmml" xref="A1.p3.3.m3.9.9.9.9.1"></times><cn type="integer" id="A1.p3.3.m3.9.9.9.9.2.cmml" xref="A1.p3.3.m3.9.9.9.9.2">1</cn><apply id="A1.p3.3.m3.9.9.9.9.3.cmml" xref="A1.p3.3.m3.9.9.9.9.3"><csymbol cd="ambiguous" id="A1.p3.3.m3.9.9.9.9.3.1.cmml" xref="A1.p3.3.m3.9.9.9.9.3">superscript</csymbol><ci id="A1.p3.3.m3.9.9.9.9.3.2.cmml" xref="A1.p3.3.m3.9.9.9.9.3.2">𝑒</ci><apply id="A1.p3.3.m3.9.9.9.9.3.3.cmml" xref="A1.p3.3.m3.9.9.9.9.3.3"><minus id="A1.p3.3.m3.9.9.9.9.3.3.1.cmml" xref="A1.p3.3.m3.9.9.9.9.3.3"></minus><cn type="integer" id="A1.p3.3.m3.9.9.9.9.3.3.2.cmml" xref="A1.p3.3.m3.9.9.9.9.3.3.2">2</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.9c">1e^{-6},5e^{-5},1e^{-5},5e^{-4},1e^{-4},5e^{-3},1e^{-3},5e^{-2},1e^{-2}</annotation></semantics></math>}. For our method, we use a three-layer fully-connected network as our generator. We encode the class label using an embedding matrix of embedding length 64 and concatenate it with a noise vector of dimension 64. Our generator architecture can be described with having the following input sizes per layer : [128, 256, 1024] and an output size of 768 which is the dimension of the visual query. We train the generator for 100 epochs using a batch size of 64 and a learning rate of <math id="A1.p3.4.m4.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A1.p3.4.m4.1a"><mrow id="A1.p3.4.m4.1.1" xref="A1.p3.4.m4.1.1.cmml"><mn id="A1.p3.4.m4.1.1.2" xref="A1.p3.4.m4.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.4.m4.1.1.1" xref="A1.p3.4.m4.1.1.1.cmml">​</mo><msup id="A1.p3.4.m4.1.1.3" xref="A1.p3.4.m4.1.1.3.cmml"><mi id="A1.p3.4.m4.1.1.3.2" xref="A1.p3.4.m4.1.1.3.2.cmml">e</mi><mrow id="A1.p3.4.m4.1.1.3.3" xref="A1.p3.4.m4.1.1.3.3.cmml"><mo id="A1.p3.4.m4.1.1.3.3a" xref="A1.p3.4.m4.1.1.3.3.cmml">−</mo><mn id="A1.p3.4.m4.1.1.3.3.2" xref="A1.p3.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.4.m4.1b"><apply id="A1.p3.4.m4.1.1.cmml" xref="A1.p3.4.m4.1.1"><times id="A1.p3.4.m4.1.1.1.cmml" xref="A1.p3.4.m4.1.1.1"></times><cn type="integer" id="A1.p3.4.m4.1.1.2.cmml" xref="A1.p3.4.m4.1.1.2">1</cn><apply id="A1.p3.4.m4.1.1.3.cmml" xref="A1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.p3.4.m4.1.1.3.1.cmml" xref="A1.p3.4.m4.1.1.3">superscript</csymbol><ci id="A1.p3.4.m4.1.1.3.2.cmml" xref="A1.p3.4.m4.1.1.3.2">𝑒</ci><apply id="A1.p3.4.m4.1.1.3.3.cmml" xref="A1.p3.4.m4.1.1.3.3"><minus id="A1.p3.4.m4.1.1.3.3.1.cmml" xref="A1.p3.4.m4.1.1.3.3"></minus><cn type="integer" id="A1.p3.4.m4.1.1.3.3.2.cmml" xref="A1.p3.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m4.1c">1e^{-4}</annotation></semantics></math> using the Adam optimizer.
We fine-tune the server model using a learning rate of <math id="A1.p3.5.m5.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A1.p3.5.m5.1a"><mrow id="A1.p3.5.m5.1.1" xref="A1.p3.5.m5.1.1.cmml"><mn id="A1.p3.5.m5.1.1.2" xref="A1.p3.5.m5.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.5.m5.1.1.1" xref="A1.p3.5.m5.1.1.1.cmml">​</mo><msup id="A1.p3.5.m5.1.1.3" xref="A1.p3.5.m5.1.1.3.cmml"><mi id="A1.p3.5.m5.1.1.3.2" xref="A1.p3.5.m5.1.1.3.2.cmml">e</mi><mrow id="A1.p3.5.m5.1.1.3.3" xref="A1.p3.5.m5.1.1.3.3.cmml"><mo id="A1.p3.5.m5.1.1.3.3a" xref="A1.p3.5.m5.1.1.3.3.cmml">−</mo><mn id="A1.p3.5.m5.1.1.3.3.2" xref="A1.p3.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.5.m5.1b"><apply id="A1.p3.5.m5.1.1.cmml" xref="A1.p3.5.m5.1.1"><times id="A1.p3.5.m5.1.1.1.cmml" xref="A1.p3.5.m5.1.1.1"></times><cn type="integer" id="A1.p3.5.m5.1.1.2.cmml" xref="A1.p3.5.m5.1.1.2">1</cn><apply id="A1.p3.5.m5.1.1.3.cmml" xref="A1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.p3.5.m5.1.1.3.1.cmml" xref="A1.p3.5.m5.1.1.3">superscript</csymbol><ci id="A1.p3.5.m5.1.1.3.2.cmml" xref="A1.p3.5.m5.1.1.3.2">𝑒</ci><apply id="A1.p3.5.m5.1.1.3.3.cmml" xref="A1.p3.5.m5.1.1.3.3"><minus id="A1.p3.5.m5.1.1.3.3.1.cmml" xref="A1.p3.5.m5.1.1.3.3"></minus><cn type="integer" id="A1.p3.5.m5.1.1.3.3.2.cmml" xref="A1.p3.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.5.m5.1c">1e^{-4}</annotation></semantics></math> for 200 epochs. We use a <span id="A1.p3.9.2" class="ltx_text ltx_font_italic">replay ratio</span> of 0.5 for our method, which means we mix 50 pseudo-latents corresponding to previous tasks for every 100 pseudo-latents corresponding to the current task. We conduct a search over values like [0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1] and find 0.5 to result into the best average accuracy <math id="A1.p3.6.m6.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="A1.p3.6.m6.1a"><msub id="A1.p3.6.m6.1.1" xref="A1.p3.6.m6.1.1.cmml"><mi id="A1.p3.6.m6.1.1.2" xref="A1.p3.6.m6.1.1.2.cmml">A</mi><mi id="A1.p3.6.m6.1.1.3" xref="A1.p3.6.m6.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.6.m6.1b"><apply id="A1.p3.6.m6.1.1.cmml" xref="A1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="A1.p3.6.m6.1.1.1.cmml" xref="A1.p3.6.m6.1.1">subscript</csymbol><ci id="A1.p3.6.m6.1.1.2.cmml" xref="A1.p3.6.m6.1.1.2">𝐴</ci><ci id="A1.p3.6.m6.1.1.3.cmml" xref="A1.p3.6.m6.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.6.m6.1c">A_{N}</annotation></semantics></math>. We observe a <span id="A1.p3.9.3" class="ltx_text ltx_font_italic">stability-plasticity</span> trade-off controlled by this hyperparameter with larger values leading to lower forgetting (<math id="A1.p3.7.m7.1" class="ltx_Math" alttext="F_{N}" display="inline"><semantics id="A1.p3.7.m7.1a"><msub id="A1.p3.7.m7.1.1" xref="A1.p3.7.m7.1.1.cmml"><mi id="A1.p3.7.m7.1.1.2" xref="A1.p3.7.m7.1.1.2.cmml">F</mi><mi id="A1.p3.7.m7.1.1.3" xref="A1.p3.7.m7.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.7.m7.1b"><apply id="A1.p3.7.m7.1.1.cmml" xref="A1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="A1.p3.7.m7.1.1.1.cmml" xref="A1.p3.7.m7.1.1">subscript</csymbol><ci id="A1.p3.7.m7.1.1.2.cmml" xref="A1.p3.7.m7.1.1.2">𝐹</ci><ci id="A1.p3.7.m7.1.1.3.cmml" xref="A1.p3.7.m7.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.7.m7.1c">F_{N}</annotation></semantics></math>) but lower current task accuracies (<span id="A1.p3.9.4" class="ltx_text ltx_font_italic">plasticity</span>) and smaller values yielding the opposite effect. Through the hyperparameter search we choose <math id="A1.p3.8.m8.1" class="ltx_Math" alttext="\lambda_{KL}" display="inline"><semantics id="A1.p3.8.m8.1a"><msub id="A1.p3.8.m8.1.1" xref="A1.p3.8.m8.1.1.cmml"><mi id="A1.p3.8.m8.1.1.2" xref="A1.p3.8.m8.1.1.2.cmml">λ</mi><mrow id="A1.p3.8.m8.1.1.3" xref="A1.p3.8.m8.1.1.3.cmml"><mi id="A1.p3.8.m8.1.1.3.2" xref="A1.p3.8.m8.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="A1.p3.8.m8.1.1.3.1" xref="A1.p3.8.m8.1.1.3.1.cmml">​</mo><mi id="A1.p3.8.m8.1.1.3.3" xref="A1.p3.8.m8.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p3.8.m8.1b"><apply id="A1.p3.8.m8.1.1.cmml" xref="A1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="A1.p3.8.m8.1.1.1.cmml" xref="A1.p3.8.m8.1.1">subscript</csymbol><ci id="A1.p3.8.m8.1.1.2.cmml" xref="A1.p3.8.m8.1.1.2">𝜆</ci><apply id="A1.p3.8.m8.1.1.3.cmml" xref="A1.p3.8.m8.1.1.3"><times id="A1.p3.8.m8.1.1.3.1.cmml" xref="A1.p3.8.m8.1.1.3.1"></times><ci id="A1.p3.8.m8.1.1.3.2.cmml" xref="A1.p3.8.m8.1.1.3.2">𝐾</ci><ci id="A1.p3.8.m8.1.1.3.3.cmml" xref="A1.p3.8.m8.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.8.m8.1c">\lambda_{KL}</annotation></semantics></math> and <math id="A1.p3.9.m9.1" class="ltx_Math" alttext="\lambda_{MSE}" display="inline"><semantics id="A1.p3.9.m9.1a"><msub id="A1.p3.9.m9.1.1" xref="A1.p3.9.m9.1.1.cmml"><mi id="A1.p3.9.m9.1.1.2" xref="A1.p3.9.m9.1.1.2.cmml">λ</mi><mrow id="A1.p3.9.m9.1.1.3" xref="A1.p3.9.m9.1.1.3.cmml"><mi id="A1.p3.9.m9.1.1.3.2" xref="A1.p3.9.m9.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="A1.p3.9.m9.1.1.3.1" xref="A1.p3.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.p3.9.m9.1.1.3.3" xref="A1.p3.9.m9.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="A1.p3.9.m9.1.1.3.1a" xref="A1.p3.9.m9.1.1.3.1.cmml">​</mo><mi id="A1.p3.9.m9.1.1.3.4" xref="A1.p3.9.m9.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p3.9.m9.1b"><apply id="A1.p3.9.m9.1.1.cmml" xref="A1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="A1.p3.9.m9.1.1.1.cmml" xref="A1.p3.9.m9.1.1">subscript</csymbol><ci id="A1.p3.9.m9.1.1.2.cmml" xref="A1.p3.9.m9.1.1.2">𝜆</ci><apply id="A1.p3.9.m9.1.1.3.cmml" xref="A1.p3.9.m9.1.1.3"><times id="A1.p3.9.m9.1.1.3.1.cmml" xref="A1.p3.9.m9.1.1.3.1"></times><ci id="A1.p3.9.m9.1.1.3.2.cmml" xref="A1.p3.9.m9.1.1.3.2">𝑀</ci><ci id="A1.p3.9.m9.1.1.3.3.cmml" xref="A1.p3.9.m9.1.1.3.3">𝑆</ci><ci id="A1.p3.9.m9.1.1.3.4.cmml" xref="A1.p3.9.m9.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.9.m9.1c">\lambda_{MSE}</annotation></semantics></math> values to be 1 and 0.1 respectively.</p>
</div>
<div id="A1.p4" class="ltx_para">
<p id="A1.p4.1" class="ltx_p"><span id="A1.p4.1.1" class="ltx_text ltx_font_bold">Baselines.</span> While GLFC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, FedWeit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, CFed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and FedCIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> are existing methods in the CFL domain, we refrain from comparing our approach with these methods, as it would not be a fair comparison. As previously mentioned, FedWeiT aims to enhance client-level performance by utilizing indirect experience from other participating clients, which is orthogonal to our motivation of obtaining a good global model. Secondly, this work focuses on <span id="A1.p4.1.2" class="ltx_text ltx_font_italic">task-incremental learning</span> which assumes knowledge of task identity during inference making it a much simpler setting. CFed requires the availability of a surrogate dataset that depends on the training data, making it challenging to compare its performance with our data-free methods on new benchmarks. The use of an ACGAN architecture is necessary for FedCIL, which limits its applicability to our setting, as we start with a pre-trained ViT backbone. GLFC employs a memory buffer to store historical data, preventing fair comparisons in our rehearsal-free setting.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Overhead Costs</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p"><span id="A2.p1.1.1" class="ltx_text ltx_font_bold">Memory Overhead.</span> Our method introduces additional parameters forming the prompting mechanism. The additional parameters amount to ~9.4% of the original size of the ViT encoder. Our method only needs to communicate the total learnable parameters in the model which includes the classifier and prompt components amounting to ~9.5% of the original model size. Methods that finetune the entire model need to learn and communicate all parameters in the encoder and classifier. We measure the communication cost as the ratio of parameters shared in each round relative to the base model (%) and compare across all methods and datasets.</p>
</div>
<figure id="A2.T3" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A2.T3.78.1.1" class="ltx_text" style="font-size:90%;">Table A</span>: </span><span id="A2.T3.79.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Additional Results (%) on ImageNet-R<span id="A2.T3.79.2.1" class="ltx_text ltx_font_medium">.
</span></span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="A2.T3.25" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:127.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.7pt,13.0pt) scale(0.82891508798712,0.82891508798712) ;">
<table id="A2.T3.25.25" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T3.25.25.26.1" class="ltx_tr">
<td id="A2.T3.25.25.26.1.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Dataset</td>
<td id="A2.T3.25.25.26.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">ImageNet-R</td>
</tr>
<tr id="A2.T3.5.5.5" class="ltx_tr">
<td id="A2.T3.5.5.5.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="A2.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="A2.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="A2.T3.1.1.1.1.m1.1a"><msub id="A2.T3.1.1.1.1.m1.1.1" xref="A2.T3.1.1.1.1.m1.1.1.cmml"><mi id="A2.T3.1.1.1.1.m1.1.1.2" xref="A2.T3.1.1.1.1.m1.1.1.2.cmml">A</mi><mi id="A2.T3.1.1.1.1.m1.1.1.3" xref="A2.T3.1.1.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T3.1.1.1.1.m1.1b"><apply id="A2.T3.1.1.1.1.m1.1.1.cmml" xref="A2.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T3.1.1.1.1.m1.1.1.1.cmml" xref="A2.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A2.T3.1.1.1.1.m1.1.1.2.cmml" xref="A2.T3.1.1.1.1.m1.1.1.2">𝐴</ci><ci id="A2.T3.1.1.1.1.m1.1.1.3.cmml" xref="A2.T3.1.1.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.1.1.1.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="A2.T3.2.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A2.T3.2.2.2.2.m2.1a"><mo stretchy="false" id="A2.T3.2.2.2.2.m2.1.1" xref="A2.T3.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A2.T3.2.2.2.2.m2.1b"><ci id="A2.T3.2.2.2.2.m2.1.1.cmml" xref="A2.T3.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.2.2.2.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
<th id="A2.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.3.3.3.3.2" class="ltx_text"></span> <span id="A2.T3.3.3.3.3.1" class="ltx_text">
<span id="A2.T3.3.3.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.3.3.3.3.1.1.1.2" class="ltx_tr">
<span id="A2.T3.3.3.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.3.3.3.3.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Communication</span></span></span>
<span id="A2.T3.3.3.3.3.1.1.1.1" class="ltx_tr">
<span id="A2.T3.3.3.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.3.3.3.3.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Cost (</span><math id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1.1" xref="A2.T3.3.3.3.3.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1b"><ci id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.3.3.3.3.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.3.3.3.3.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.3.3.3.3.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.3.3.3.3.3" class="ltx_text"></span></th>
<th id="A2.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.4.4.4.4.2" class="ltx_text"></span> <span id="A2.T3.4.4.4.4.1" class="ltx_text">
<span id="A2.T3.4.4.4.4.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.4.4.4.4.1.1.1.2" class="ltx_tr">
<span id="A2.T3.4.4.4.4.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.4.4.4.4.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Client-side</span></span></span>
<span id="A2.T3.4.4.4.4.1.1.1.1" class="ltx_tr">
<span id="A2.T3.4.4.4.4.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.4.4.4.4.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead(</span><math id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1.1" xref="A2.T3.4.4.4.4.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1b"><ci id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.4.4.4.4.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.4.4.4.4.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.4.4.4.4.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.4.4.4.4.3" class="ltx_text"></span></th>
<th id="A2.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">
<span id="A2.T3.5.5.5.5.2" class="ltx_text"></span> <span id="A2.T3.5.5.5.5.1" class="ltx_text">
<span id="A2.T3.5.5.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.5.5.5.5.1.1.1.2" class="ltx_tr">
<span id="A2.T3.5.5.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.5.5.5.5.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Server-side</span></span></span>
<span id="A2.T3.5.5.5.5.1.1.1.1" class="ltx_tr">
<span id="A2.T3.5.5.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.5.5.5.5.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead (</span><math id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1.1" xref="A2.T3.5.5.5.5.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1b"><ci id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.5.5.5.5.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.5.5.5.5.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.5.5.5.5.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.5.5.5.5.3" class="ltx_text"></span></th>
</tr>
<tr id="A2.T3.9.9.9" class="ltx_tr">
<td id="A2.T3.9.9.9.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">FedAvg-FT</td>
<td id="A2.T3.6.6.6.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.6.6.6.1.m1.1" class="ltx_Math" alttext="12.03\pm 0.75" display="inline"><semantics id="A2.T3.6.6.6.1.m1.1a"><mrow id="A2.T3.6.6.6.1.m1.1.1" xref="A2.T3.6.6.6.1.m1.1.1.cmml"><mn id="A2.T3.6.6.6.1.m1.1.1.2" xref="A2.T3.6.6.6.1.m1.1.1.2.cmml">12.03</mn><mo id="A2.T3.6.6.6.1.m1.1.1.1" xref="A2.T3.6.6.6.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.6.6.6.1.m1.1.1.3" xref="A2.T3.6.6.6.1.m1.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.6.6.6.1.m1.1b"><apply id="A2.T3.6.6.6.1.m1.1.1.cmml" xref="A2.T3.6.6.6.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.6.6.6.1.m1.1.1.1.cmml" xref="A2.T3.6.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.6.6.6.1.m1.1.1.2.cmml" xref="A2.T3.6.6.6.1.m1.1.1.2">12.03</cn><cn type="float" id="A2.T3.6.6.6.1.m1.1.1.3.cmml" xref="A2.T3.6.6.6.1.m1.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.6.6.6.1.m1.1c">12.03\pm 0.75</annotation></semantics></math></td>
<td id="A2.T3.7.7.7.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.7.7.7.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.7.7.7.2.m1.1a"><mn id="A2.T3.7.7.7.2.m1.1.1" xref="A2.T3.7.7.7.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.7.7.7.2.m1.1b"><cn type="integer" id="A2.T3.7.7.7.2.m1.1.1.cmml" xref="A2.T3.7.7.7.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.7.7.7.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.8.8.8.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.8.8.8.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.8.8.8.3.m1.1a"><mo id="A2.T3.8.8.8.3.m1.1.1" xref="A2.T3.8.8.8.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.8.8.8.3.m1.1b"><minus id="A2.T3.8.8.8.3.m1.1.1.cmml" xref="A2.T3.8.8.8.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.8.8.8.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.9.9.9.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A2.T3.9.9.9.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.9.9.9.4.m1.1a"><mo id="A2.T3.9.9.9.4.m1.1.1" xref="A2.T3.9.9.9.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.9.9.9.4.m1.1b"><minus id="A2.T3.9.9.9.4.m1.1.1.cmml" xref="A2.T3.9.9.9.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.9.9.9.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.13.13.13" class="ltx_tr">
<td id="A2.T3.13.13.13.5" class="ltx_td ltx_align_center ltx_border_rr">FedLwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="A2.T3.10.10.10.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.10.10.10.1.m1.1" class="ltx_Math" alttext="52.87\pm 0.61" display="inline"><semantics id="A2.T3.10.10.10.1.m1.1a"><mrow id="A2.T3.10.10.10.1.m1.1.1" xref="A2.T3.10.10.10.1.m1.1.1.cmml"><mn id="A2.T3.10.10.10.1.m1.1.1.2" xref="A2.T3.10.10.10.1.m1.1.1.2.cmml">52.87</mn><mo id="A2.T3.10.10.10.1.m1.1.1.1" xref="A2.T3.10.10.10.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.10.10.10.1.m1.1.1.3" xref="A2.T3.10.10.10.1.m1.1.1.3.cmml">0.61</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.10.10.10.1.m1.1b"><apply id="A2.T3.10.10.10.1.m1.1.1.cmml" xref="A2.T3.10.10.10.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.10.10.10.1.m1.1.1.1.cmml" xref="A2.T3.10.10.10.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.10.10.10.1.m1.1.1.2.cmml" xref="A2.T3.10.10.10.1.m1.1.1.2">52.87</cn><cn type="float" id="A2.T3.10.10.10.1.m1.1.1.3.cmml" xref="A2.T3.10.10.10.1.m1.1.1.3">0.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.10.10.10.1.m1.1c">52.87\pm 0.61</annotation></semantics></math></td>
<td id="A2.T3.11.11.11.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.11.11.11.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.11.11.11.2.m1.1a"><mn id="A2.T3.11.11.11.2.m1.1.1" xref="A2.T3.11.11.11.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.11.11.11.2.m1.1b"><cn type="integer" id="A2.T3.11.11.11.2.m1.1.1.cmml" xref="A2.T3.11.11.11.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.11.11.11.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.12.12.12.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.12.12.12.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.12.12.12.3.m1.1a"><mn id="A2.T3.12.12.12.3.m1.1.1" xref="A2.T3.12.12.12.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.12.12.12.3.m1.1b"><cn type="integer" id="A2.T3.12.12.12.3.m1.1.1.cmml" xref="A2.T3.12.12.12.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.12.12.12.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.13.13.13.4" class="ltx_td ltx_align_center"><math id="A2.T3.13.13.13.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.13.13.13.4.m1.1a"><mo id="A2.T3.13.13.13.4.m1.1.1" xref="A2.T3.13.13.13.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.13.13.13.4.m1.1b"><minus id="A2.T3.13.13.13.4.m1.1.1.cmml" xref="A2.T3.13.13.13.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.13.13.13.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.17.17.17" class="ltx_tr">
<td id="A2.T3.17.17.17.5" class="ltx_td ltx_align_center ltx_border_rr">FedAvg-Prompt</td>
<td id="A2.T3.14.14.14.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.14.14.14.1.m1.1" class="ltx_Math" alttext="51.15\pm 0.68" display="inline"><semantics id="A2.T3.14.14.14.1.m1.1a"><mrow id="A2.T3.14.14.14.1.m1.1.1" xref="A2.T3.14.14.14.1.m1.1.1.cmml"><mn id="A2.T3.14.14.14.1.m1.1.1.2" xref="A2.T3.14.14.14.1.m1.1.1.2.cmml">51.15</mn><mo id="A2.T3.14.14.14.1.m1.1.1.1" xref="A2.T3.14.14.14.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.14.14.14.1.m1.1.1.3" xref="A2.T3.14.14.14.1.m1.1.1.3.cmml">0.68</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.14.14.14.1.m1.1b"><apply id="A2.T3.14.14.14.1.m1.1.1.cmml" xref="A2.T3.14.14.14.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.14.14.14.1.m1.1.1.1.cmml" xref="A2.T3.14.14.14.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.14.14.14.1.m1.1.1.2.cmml" xref="A2.T3.14.14.14.1.m1.1.1.2">51.15</cn><cn type="float" id="A2.T3.14.14.14.1.m1.1.1.3.cmml" xref="A2.T3.14.14.14.1.m1.1.1.3">0.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.14.14.14.1.m1.1c">51.15\pm 0.68</annotation></semantics></math></td>
<td id="A2.T3.15.15.15.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.15.15.15.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.15.15.15.2.m1.1a"><mn id="A2.T3.15.15.15.2.m1.1.1" xref="A2.T3.15.15.15.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.15.15.15.2.m1.1b"><cn type="float" id="A2.T3.15.15.15.2.m1.1.1.cmml" xref="A2.T3.15.15.15.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.15.15.15.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.16.16.16.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.16.16.16.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.16.16.16.3.m1.1a"><mo id="A2.T3.16.16.16.3.m1.1.1" xref="A2.T3.16.16.16.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.16.16.16.3.m1.1b"><minus id="A2.T3.16.16.16.3.m1.1.1.cmml" xref="A2.T3.16.16.16.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.16.16.16.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.17.17.17.4" class="ltx_td ltx_align_center"><math id="A2.T3.17.17.17.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.17.17.17.4.m1.1a"><mo id="A2.T3.17.17.17.4.m1.1.1" xref="A2.T3.17.17.17.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.17.17.17.4.m1.1b"><minus id="A2.T3.17.17.17.4.m1.1.1.cmml" xref="A2.T3.17.17.17.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.17.17.17.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.21.21.21" class="ltx_tr">
<td id="A2.T3.21.21.21.5" class="ltx_td ltx_align_center ltx_border_rr">FedProx-Prompt</td>
<td id="A2.T3.18.18.18.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.18.18.18.1.m1.1" class="ltx_Math" alttext="55.53\pm 0.66" display="inline"><semantics id="A2.T3.18.18.18.1.m1.1a"><mrow id="A2.T3.18.18.18.1.m1.1.1" xref="A2.T3.18.18.18.1.m1.1.1.cmml"><mn id="A2.T3.18.18.18.1.m1.1.1.2" xref="A2.T3.18.18.18.1.m1.1.1.2.cmml">55.53</mn><mo id="A2.T3.18.18.18.1.m1.1.1.1" xref="A2.T3.18.18.18.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.18.18.18.1.m1.1.1.3" xref="A2.T3.18.18.18.1.m1.1.1.3.cmml">0.66</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.18.18.18.1.m1.1b"><apply id="A2.T3.18.18.18.1.m1.1.1.cmml" xref="A2.T3.18.18.18.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.18.18.18.1.m1.1.1.1.cmml" xref="A2.T3.18.18.18.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.18.18.18.1.m1.1.1.2.cmml" xref="A2.T3.18.18.18.1.m1.1.1.2">55.53</cn><cn type="float" id="A2.T3.18.18.18.1.m1.1.1.3.cmml" xref="A2.T3.18.18.18.1.m1.1.1.3">0.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.18.18.18.1.m1.1c">55.53\pm 0.66</annotation></semantics></math></td>
<td id="A2.T3.19.19.19.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.19.19.19.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.19.19.19.2.m1.1a"><mn id="A2.T3.19.19.19.2.m1.1.1" xref="A2.T3.19.19.19.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.19.19.19.2.m1.1b"><cn type="float" id="A2.T3.19.19.19.2.m1.1.1.cmml" xref="A2.T3.19.19.19.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.19.19.19.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.20.20.20.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.20.20.20.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.20.20.20.3.m1.1a"><mn id="A2.T3.20.20.20.3.m1.1.1" xref="A2.T3.20.20.20.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.20.20.20.3.m1.1b"><cn type="integer" id="A2.T3.20.20.20.3.m1.1.1.cmml" xref="A2.T3.20.20.20.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.20.20.20.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.21.21.21.4" class="ltx_td ltx_align_center"><math id="A2.T3.21.21.21.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.21.21.21.4.m1.1a"><mo id="A2.T3.21.21.21.4.m1.1.1" xref="A2.T3.21.21.21.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.21.21.21.4.m1.1b"><minus id="A2.T3.21.21.21.4.m1.1.1.cmml" xref="A2.T3.21.21.21.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.21.21.21.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.25.25.25" class="ltx_tr">
<td id="A2.T3.25.25.25.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="A2.T3.25.25.25.5.1" class="ltx_text ltx_font_bold">HePCo (Ours)</span></td>
<td id="A2.T3.22.22.22.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.22.22.22.1.m1.1" class="ltx_Math" alttext="\bm{59.96\pm 0.94}" display="inline"><semantics id="A2.T3.22.22.22.1.m1.1a"><mrow id="A2.T3.22.22.22.1.m1.1.1" xref="A2.T3.22.22.22.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.22.22.22.1.m1.1.1.2" xref="A2.T3.22.22.22.1.m1.1.1.2.cmml">59.96</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.22.22.22.1.m1.1.1.1" xref="A2.T3.22.22.22.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.22.22.22.1.m1.1.1.3" xref="A2.T3.22.22.22.1.m1.1.1.3.cmml">0.94</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.22.22.22.1.m1.1b"><apply id="A2.T3.22.22.22.1.m1.1.1.cmml" xref="A2.T3.22.22.22.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.22.22.22.1.m1.1.1.1.cmml" xref="A2.T3.22.22.22.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.22.22.22.1.m1.1.1.2.cmml" xref="A2.T3.22.22.22.1.m1.1.1.2">59.96</cn><cn type="float" id="A2.T3.22.22.22.1.m1.1.1.3.cmml" xref="A2.T3.22.22.22.1.m1.1.1.3">0.94</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.22.22.22.1.m1.1c">\bm{59.96\pm 0.94}</annotation></semantics></math></td>
<td id="A2.T3.23.23.23.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.23.23.23.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.23.23.23.2.m1.1a"><mn id="A2.T3.23.23.23.2.m1.1.1" xref="A2.T3.23.23.23.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.23.23.23.2.m1.1b"><cn type="float" id="A2.T3.23.23.23.2.m1.1.1.cmml" xref="A2.T3.23.23.23.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.23.23.23.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.24.24.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.24.24.24.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.24.24.24.3.m1.1a"><mo id="A2.T3.24.24.24.3.m1.1.1" xref="A2.T3.24.24.24.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.24.24.24.3.m1.1b"><minus id="A2.T3.24.24.24.3.m1.1.1.cmml" xref="A2.T3.24.24.24.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.24.24.24.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.25.25.25.4" class="ltx_td ltx_align_center ltx_border_b"><math id="A2.T3.25.25.25.4.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.25.25.25.4.m1.1a"><mn id="A2.T3.25.25.25.4.m1.1.1" xref="A2.T3.25.25.25.4.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.25.25.25.4.m1.1b"><cn type="float" id="A2.T3.25.25.25.4.m1.1.1.cmml" xref="A2.T3.25.25.25.4.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.25.25.25.4.m1.1c">9.5</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A2.T3.81.1.1" class="ltx_text" style="font-size:90%;">Table B</span>: </span><span id="A2.T3.82.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Additional Results (%) on CIFAR-100<span id="A2.T3.82.2.1" class="ltx_text ltx_font_medium">.
</span></span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="A2.T3.50" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:127.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.7pt,13.0pt) scale(0.82891508798712,0.82891508798712) ;">
<table id="A2.T3.50.25" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T3.50.25.26.1" class="ltx_tr">
<td id="A2.T3.50.25.26.1.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Dataset</td>
<td id="A2.T3.50.25.26.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">CIFAR-100</td>
</tr>
<tr id="A2.T3.30.5.5" class="ltx_tr">
<td id="A2.T3.30.5.5.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="A2.T3.27.2.2.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="A2.T3.26.1.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="A2.T3.26.1.1.1.m1.1a"><msub id="A2.T3.26.1.1.1.m1.1.1" xref="A2.T3.26.1.1.1.m1.1.1.cmml"><mi id="A2.T3.26.1.1.1.m1.1.1.2" xref="A2.T3.26.1.1.1.m1.1.1.2.cmml">A</mi><mi id="A2.T3.26.1.1.1.m1.1.1.3" xref="A2.T3.26.1.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T3.26.1.1.1.m1.1b"><apply id="A2.T3.26.1.1.1.m1.1.1.cmml" xref="A2.T3.26.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T3.26.1.1.1.m1.1.1.1.cmml" xref="A2.T3.26.1.1.1.m1.1.1">subscript</csymbol><ci id="A2.T3.26.1.1.1.m1.1.1.2.cmml" xref="A2.T3.26.1.1.1.m1.1.1.2">𝐴</ci><ci id="A2.T3.26.1.1.1.m1.1.1.3.cmml" xref="A2.T3.26.1.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.26.1.1.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="A2.T3.27.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A2.T3.27.2.2.2.m2.1a"><mo stretchy="false" id="A2.T3.27.2.2.2.m2.1.1" xref="A2.T3.27.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A2.T3.27.2.2.2.m2.1b"><ci id="A2.T3.27.2.2.2.m2.1.1.cmml" xref="A2.T3.27.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.27.2.2.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
<th id="A2.T3.28.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.28.3.3.3.2" class="ltx_text"></span> <span id="A2.T3.28.3.3.3.1" class="ltx_text">
<span id="A2.T3.28.3.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.28.3.3.3.1.1.1.2" class="ltx_tr">
<span id="A2.T3.28.3.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.28.3.3.3.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Communication</span></span></span>
<span id="A2.T3.28.3.3.3.1.1.1.1" class="ltx_tr">
<span id="A2.T3.28.3.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.28.3.3.3.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Cost (</span><math id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1.1" xref="A2.T3.28.3.3.3.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1b"><ci id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.28.3.3.3.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.28.3.3.3.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.28.3.3.3.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.28.3.3.3.3" class="ltx_text"></span></th>
<th id="A2.T3.29.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.29.4.4.4.2" class="ltx_text"></span> <span id="A2.T3.29.4.4.4.1" class="ltx_text">
<span id="A2.T3.29.4.4.4.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.29.4.4.4.1.1.1.2" class="ltx_tr">
<span id="A2.T3.29.4.4.4.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.29.4.4.4.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Client-side</span></span></span>
<span id="A2.T3.29.4.4.4.1.1.1.1" class="ltx_tr">
<span id="A2.T3.29.4.4.4.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.29.4.4.4.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead(</span><math id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1.1" xref="A2.T3.29.4.4.4.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1b"><ci id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.29.4.4.4.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.29.4.4.4.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.29.4.4.4.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.29.4.4.4.3" class="ltx_text"></span></th>
<th id="A2.T3.30.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">
<span id="A2.T3.30.5.5.5.2" class="ltx_text"></span> <span id="A2.T3.30.5.5.5.1" class="ltx_text">
<span id="A2.T3.30.5.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.30.5.5.5.1.1.1.2" class="ltx_tr">
<span id="A2.T3.30.5.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.30.5.5.5.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Server-side</span></span></span>
<span id="A2.T3.30.5.5.5.1.1.1.1" class="ltx_tr">
<span id="A2.T3.30.5.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.30.5.5.5.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead (</span><math id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1.1" xref="A2.T3.30.5.5.5.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1b"><ci id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.30.5.5.5.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.30.5.5.5.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.30.5.5.5.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.30.5.5.5.3" class="ltx_text"></span></th>
</tr>
<tr id="A2.T3.34.9.9" class="ltx_tr">
<td id="A2.T3.34.9.9.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">FedAvg-FT</td>
<td id="A2.T3.31.6.6.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.31.6.6.1.m1.1" class="ltx_Math" alttext="10.23\pm 1.10" display="inline"><semantics id="A2.T3.31.6.6.1.m1.1a"><mrow id="A2.T3.31.6.6.1.m1.1.1" xref="A2.T3.31.6.6.1.m1.1.1.cmml"><mn id="A2.T3.31.6.6.1.m1.1.1.2" xref="A2.T3.31.6.6.1.m1.1.1.2.cmml">10.23</mn><mo id="A2.T3.31.6.6.1.m1.1.1.1" xref="A2.T3.31.6.6.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.31.6.6.1.m1.1.1.3" xref="A2.T3.31.6.6.1.m1.1.1.3.cmml">1.10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.31.6.6.1.m1.1b"><apply id="A2.T3.31.6.6.1.m1.1.1.cmml" xref="A2.T3.31.6.6.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.31.6.6.1.m1.1.1.1.cmml" xref="A2.T3.31.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.31.6.6.1.m1.1.1.2.cmml" xref="A2.T3.31.6.6.1.m1.1.1.2">10.23</cn><cn type="float" id="A2.T3.31.6.6.1.m1.1.1.3.cmml" xref="A2.T3.31.6.6.1.m1.1.1.3">1.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.31.6.6.1.m1.1c">10.23\pm 1.10</annotation></semantics></math></td>
<td id="A2.T3.32.7.7.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.32.7.7.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.32.7.7.2.m1.1a"><mn id="A2.T3.32.7.7.2.m1.1.1" xref="A2.T3.32.7.7.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.32.7.7.2.m1.1b"><cn type="integer" id="A2.T3.32.7.7.2.m1.1.1.cmml" xref="A2.T3.32.7.7.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.32.7.7.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.33.8.8.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.33.8.8.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.33.8.8.3.m1.1a"><mo id="A2.T3.33.8.8.3.m1.1.1" xref="A2.T3.33.8.8.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.33.8.8.3.m1.1b"><minus id="A2.T3.33.8.8.3.m1.1.1.cmml" xref="A2.T3.33.8.8.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.33.8.8.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.34.9.9.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A2.T3.34.9.9.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.34.9.9.4.m1.1a"><mo id="A2.T3.34.9.9.4.m1.1.1" xref="A2.T3.34.9.9.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.34.9.9.4.m1.1b"><minus id="A2.T3.34.9.9.4.m1.1.1.cmml" xref="A2.T3.34.9.9.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.34.9.9.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.38.13.13" class="ltx_tr">
<td id="A2.T3.38.13.13.5" class="ltx_td ltx_align_center ltx_border_rr">FedLwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="A2.T3.35.10.10.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.35.10.10.1.m1.1" class="ltx_Math" alttext="59.08\pm 1.06" display="inline"><semantics id="A2.T3.35.10.10.1.m1.1a"><mrow id="A2.T3.35.10.10.1.m1.1.1" xref="A2.T3.35.10.10.1.m1.1.1.cmml"><mn id="A2.T3.35.10.10.1.m1.1.1.2" xref="A2.T3.35.10.10.1.m1.1.1.2.cmml">59.08</mn><mo id="A2.T3.35.10.10.1.m1.1.1.1" xref="A2.T3.35.10.10.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.35.10.10.1.m1.1.1.3" xref="A2.T3.35.10.10.1.m1.1.1.3.cmml">1.06</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.35.10.10.1.m1.1b"><apply id="A2.T3.35.10.10.1.m1.1.1.cmml" xref="A2.T3.35.10.10.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.35.10.10.1.m1.1.1.1.cmml" xref="A2.T3.35.10.10.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.35.10.10.1.m1.1.1.2.cmml" xref="A2.T3.35.10.10.1.m1.1.1.2">59.08</cn><cn type="float" id="A2.T3.35.10.10.1.m1.1.1.3.cmml" xref="A2.T3.35.10.10.1.m1.1.1.3">1.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.35.10.10.1.m1.1c">59.08\pm 1.06</annotation></semantics></math></td>
<td id="A2.T3.36.11.11.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.36.11.11.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.36.11.11.2.m1.1a"><mn id="A2.T3.36.11.11.2.m1.1.1" xref="A2.T3.36.11.11.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.36.11.11.2.m1.1b"><cn type="integer" id="A2.T3.36.11.11.2.m1.1.1.cmml" xref="A2.T3.36.11.11.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.36.11.11.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.37.12.12.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.37.12.12.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.37.12.12.3.m1.1a"><mn id="A2.T3.37.12.12.3.m1.1.1" xref="A2.T3.37.12.12.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.37.12.12.3.m1.1b"><cn type="integer" id="A2.T3.37.12.12.3.m1.1.1.cmml" xref="A2.T3.37.12.12.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.37.12.12.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.38.13.13.4" class="ltx_td ltx_align_center"><math id="A2.T3.38.13.13.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.38.13.13.4.m1.1a"><mo id="A2.T3.38.13.13.4.m1.1.1" xref="A2.T3.38.13.13.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.38.13.13.4.m1.1b"><minus id="A2.T3.38.13.13.4.m1.1.1.cmml" xref="A2.T3.38.13.13.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.38.13.13.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.42.17.17" class="ltx_tr">
<td id="A2.T3.42.17.17.5" class="ltx_td ltx_align_center ltx_border_rr">FedAvg-Prompt</td>
<td id="A2.T3.39.14.14.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.39.14.14.1.m1.1" class="ltx_Math" alttext="67.34\pm 1.42" display="inline"><semantics id="A2.T3.39.14.14.1.m1.1a"><mrow id="A2.T3.39.14.14.1.m1.1.1" xref="A2.T3.39.14.14.1.m1.1.1.cmml"><mn id="A2.T3.39.14.14.1.m1.1.1.2" xref="A2.T3.39.14.14.1.m1.1.1.2.cmml">67.34</mn><mo id="A2.T3.39.14.14.1.m1.1.1.1" xref="A2.T3.39.14.14.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.39.14.14.1.m1.1.1.3" xref="A2.T3.39.14.14.1.m1.1.1.3.cmml">1.42</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.39.14.14.1.m1.1b"><apply id="A2.T3.39.14.14.1.m1.1.1.cmml" xref="A2.T3.39.14.14.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.39.14.14.1.m1.1.1.1.cmml" xref="A2.T3.39.14.14.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.39.14.14.1.m1.1.1.2.cmml" xref="A2.T3.39.14.14.1.m1.1.1.2">67.34</cn><cn type="float" id="A2.T3.39.14.14.1.m1.1.1.3.cmml" xref="A2.T3.39.14.14.1.m1.1.1.3">1.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.39.14.14.1.m1.1c">67.34\pm 1.42</annotation></semantics></math></td>
<td id="A2.T3.40.15.15.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.40.15.15.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.40.15.15.2.m1.1a"><mn id="A2.T3.40.15.15.2.m1.1.1" xref="A2.T3.40.15.15.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.40.15.15.2.m1.1b"><cn type="float" id="A2.T3.40.15.15.2.m1.1.1.cmml" xref="A2.T3.40.15.15.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.40.15.15.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.41.16.16.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.41.16.16.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.41.16.16.3.m1.1a"><mo id="A2.T3.41.16.16.3.m1.1.1" xref="A2.T3.41.16.16.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.41.16.16.3.m1.1b"><minus id="A2.T3.41.16.16.3.m1.1.1.cmml" xref="A2.T3.41.16.16.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.41.16.16.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.42.17.17.4" class="ltx_td ltx_align_center"><math id="A2.T3.42.17.17.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.42.17.17.4.m1.1a"><mo id="A2.T3.42.17.17.4.m1.1.1" xref="A2.T3.42.17.17.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.42.17.17.4.m1.1b"><minus id="A2.T3.42.17.17.4.m1.1.1.cmml" xref="A2.T3.42.17.17.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.42.17.17.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.46.21.21" class="ltx_tr">
<td id="A2.T3.46.21.21.5" class="ltx_td ltx_align_center ltx_border_rr">FedProx-Prompt</td>
<td id="A2.T3.43.18.18.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.43.18.18.1.m1.1" class="ltx_Math" alttext="69.38\pm 1.39" display="inline"><semantics id="A2.T3.43.18.18.1.m1.1a"><mrow id="A2.T3.43.18.18.1.m1.1.1" xref="A2.T3.43.18.18.1.m1.1.1.cmml"><mn id="A2.T3.43.18.18.1.m1.1.1.2" xref="A2.T3.43.18.18.1.m1.1.1.2.cmml">69.38</mn><mo id="A2.T3.43.18.18.1.m1.1.1.1" xref="A2.T3.43.18.18.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.43.18.18.1.m1.1.1.3" xref="A2.T3.43.18.18.1.m1.1.1.3.cmml">1.39</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.43.18.18.1.m1.1b"><apply id="A2.T3.43.18.18.1.m1.1.1.cmml" xref="A2.T3.43.18.18.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.43.18.18.1.m1.1.1.1.cmml" xref="A2.T3.43.18.18.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.43.18.18.1.m1.1.1.2.cmml" xref="A2.T3.43.18.18.1.m1.1.1.2">69.38</cn><cn type="float" id="A2.T3.43.18.18.1.m1.1.1.3.cmml" xref="A2.T3.43.18.18.1.m1.1.1.3">1.39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.43.18.18.1.m1.1c">69.38\pm 1.39</annotation></semantics></math></td>
<td id="A2.T3.44.19.19.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.44.19.19.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.44.19.19.2.m1.1a"><mn id="A2.T3.44.19.19.2.m1.1.1" xref="A2.T3.44.19.19.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.44.19.19.2.m1.1b"><cn type="float" id="A2.T3.44.19.19.2.m1.1.1.cmml" xref="A2.T3.44.19.19.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.44.19.19.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.45.20.20.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.45.20.20.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.45.20.20.3.m1.1a"><mn id="A2.T3.45.20.20.3.m1.1.1" xref="A2.T3.45.20.20.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.45.20.20.3.m1.1b"><cn type="integer" id="A2.T3.45.20.20.3.m1.1.1.cmml" xref="A2.T3.45.20.20.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.45.20.20.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.46.21.21.4" class="ltx_td ltx_align_center"><math id="A2.T3.46.21.21.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.46.21.21.4.m1.1a"><mo id="A2.T3.46.21.21.4.m1.1.1" xref="A2.T3.46.21.21.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.46.21.21.4.m1.1b"><minus id="A2.T3.46.21.21.4.m1.1.1.cmml" xref="A2.T3.46.21.21.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.46.21.21.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.50.25.25" class="ltx_tr">
<td id="A2.T3.50.25.25.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="A2.T3.50.25.25.5.1" class="ltx_text ltx_font_bold">HePCo (Ours)</span></td>
<td id="A2.T3.47.22.22.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.47.22.22.1.m1.1" class="ltx_Math" alttext="\bm{76.54\pm 1.14}" display="inline"><semantics id="A2.T3.47.22.22.1.m1.1a"><mrow id="A2.T3.47.22.22.1.m1.1.1" xref="A2.T3.47.22.22.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.47.22.22.1.m1.1.1.2" xref="A2.T3.47.22.22.1.m1.1.1.2.cmml">76.54</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.47.22.22.1.m1.1.1.1" xref="A2.T3.47.22.22.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.47.22.22.1.m1.1.1.3" xref="A2.T3.47.22.22.1.m1.1.1.3.cmml">1.14</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.47.22.22.1.m1.1b"><apply id="A2.T3.47.22.22.1.m1.1.1.cmml" xref="A2.T3.47.22.22.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.47.22.22.1.m1.1.1.1.cmml" xref="A2.T3.47.22.22.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.47.22.22.1.m1.1.1.2.cmml" xref="A2.T3.47.22.22.1.m1.1.1.2">76.54</cn><cn type="float" id="A2.T3.47.22.22.1.m1.1.1.3.cmml" xref="A2.T3.47.22.22.1.m1.1.1.3">1.14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.47.22.22.1.m1.1c">\bm{76.54\pm 1.14}</annotation></semantics></math></td>
<td id="A2.T3.48.23.23.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.48.23.23.2.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.48.23.23.2.m1.1a"><mn id="A2.T3.48.23.23.2.m1.1.1" xref="A2.T3.48.23.23.2.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.48.23.23.2.m1.1b"><cn type="float" id="A2.T3.48.23.23.2.m1.1.1.cmml" xref="A2.T3.48.23.23.2.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.48.23.23.2.m1.1c">9.5</annotation></semantics></math></td>
<td id="A2.T3.49.24.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.49.24.24.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.49.24.24.3.m1.1a"><mo id="A2.T3.49.24.24.3.m1.1.1" xref="A2.T3.49.24.24.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.49.24.24.3.m1.1b"><minus id="A2.T3.49.24.24.3.m1.1.1.cmml" xref="A2.T3.49.24.24.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.49.24.24.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.50.25.25.4" class="ltx_td ltx_align_center ltx_border_b"><math id="A2.T3.50.25.25.4.m1.1" class="ltx_Math" alttext="9.5" display="inline"><semantics id="A2.T3.50.25.25.4.m1.1a"><mn id="A2.T3.50.25.25.4.m1.1.1" xref="A2.T3.50.25.25.4.m1.1.1.cmml">9.5</mn><annotation-xml encoding="MathML-Content" id="A2.T3.50.25.25.4.m1.1b"><cn type="float" id="A2.T3.50.25.25.4.m1.1.1.cmml" xref="A2.T3.50.25.25.4.m1.1.1">9.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.50.25.25.4.m1.1c">9.5</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A2.T3.84.1.1" class="ltx_text" style="font-size:90%;">Table C</span>: </span><span id="A2.T3.85.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Additional Results (%) on DomainNet<span id="A2.T3.85.2.1" class="ltx_text ltx_font_medium">.
</span></span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="A2.T3.75" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:127.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.7pt,13.0pt) scale(0.82891508798712,0.82891508798712) ;">
<table id="A2.T3.75.25" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T3.75.25.26.1" class="ltx_tr">
<td id="A2.T3.75.25.26.1.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Dataset</td>
<td id="A2.T3.75.25.26.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">DomainNet</td>
</tr>
<tr id="A2.T3.55.5.5" class="ltx_tr">
<td id="A2.T3.55.5.5.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<span class="ltx_rule" style="width:0.0pt;height:10.0pt;background:black;display:inline-block;"></span> Method</td>
<td id="A2.T3.52.2.2.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">
<math id="A2.T3.51.1.1.1.m1.1" class="ltx_Math" alttext="A_{N}" display="inline"><semantics id="A2.T3.51.1.1.1.m1.1a"><msub id="A2.T3.51.1.1.1.m1.1.1" xref="A2.T3.51.1.1.1.m1.1.1.cmml"><mi id="A2.T3.51.1.1.1.m1.1.1.2" xref="A2.T3.51.1.1.1.m1.1.1.2.cmml">A</mi><mi id="A2.T3.51.1.1.1.m1.1.1.3" xref="A2.T3.51.1.1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T3.51.1.1.1.m1.1b"><apply id="A2.T3.51.1.1.1.m1.1.1.cmml" xref="A2.T3.51.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T3.51.1.1.1.m1.1.1.1.cmml" xref="A2.T3.51.1.1.1.m1.1.1">subscript</csymbol><ci id="A2.T3.51.1.1.1.m1.1.1.2.cmml" xref="A2.T3.51.1.1.1.m1.1.1.2">𝐴</ci><ci id="A2.T3.51.1.1.1.m1.1.1.3.cmml" xref="A2.T3.51.1.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.51.1.1.1.m1.1c">A_{N}</annotation></semantics></math> (<math id="A2.T3.52.2.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="A2.T3.52.2.2.2.m2.1a"><mo stretchy="false" id="A2.T3.52.2.2.2.m2.1.1" xref="A2.T3.52.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A2.T3.52.2.2.2.m2.1b"><ci id="A2.T3.52.2.2.2.m2.1.1.cmml" xref="A2.T3.52.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.52.2.2.2.m2.1c">\uparrow</annotation></semantics></math>)</td>
<th id="A2.T3.53.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.53.3.3.3.2" class="ltx_text"></span> <span id="A2.T3.53.3.3.3.1" class="ltx_text">
<span id="A2.T3.53.3.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.53.3.3.3.1.1.1.2" class="ltx_tr">
<span id="A2.T3.53.3.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.53.3.3.3.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Communication</span></span></span>
<span id="A2.T3.53.3.3.3.1.1.1.1" class="ltx_tr">
<span id="A2.T3.53.3.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.53.3.3.3.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Cost (</span><math id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1.1" xref="A2.T3.53.3.3.3.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1b"><ci id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.53.3.3.3.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.53.3.3.3.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.53.3.3.3.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.53.3.3.3.3" class="ltx_text"></span></th>
<th id="A2.T3.54.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">
<span id="A2.T3.54.4.4.4.2" class="ltx_text"></span> <span id="A2.T3.54.4.4.4.1" class="ltx_text">
<span id="A2.T3.54.4.4.4.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.54.4.4.4.1.1.1.2" class="ltx_tr">
<span id="A2.T3.54.4.4.4.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.54.4.4.4.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Client-side</span></span></span>
<span id="A2.T3.54.4.4.4.1.1.1.1" class="ltx_tr">
<span id="A2.T3.54.4.4.4.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.54.4.4.4.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead(</span><math id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1.1" xref="A2.T3.54.4.4.4.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1b"><ci id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.54.4.4.4.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.54.4.4.4.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.54.4.4.4.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.54.4.4.4.3" class="ltx_text"></span></th>
<th id="A2.T3.55.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">
<span id="A2.T3.55.5.5.5.2" class="ltx_text"></span> <span id="A2.T3.55.5.5.5.1" class="ltx_text">
<span id="A2.T3.55.5.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T3.55.5.5.5.1.1.1.2" class="ltx_tr">
<span id="A2.T3.55.5.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.55.5.5.5.1.1.1.2.1.1" class="ltx_text" style="font-size:80%;">Server-side</span></span></span>
<span id="A2.T3.55.5.5.5.1.1.1.1" class="ltx_tr">
<span id="A2.T3.55.5.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T3.55.5.5.5.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Storage Overhead (</span><math id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1a"><mo mathsize="80%" stretchy="false" id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1.1" xref="A2.T3.55.5.5.5.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1b"><ci id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1.1.cmml" xref="A2.T3.55.5.5.5.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.55.5.5.5.1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math><span id="A2.T3.55.5.5.5.1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span></span></span>
</span></span><span id="A2.T3.55.5.5.5.3" class="ltx_text"></span></th>
</tr>
<tr id="A2.T3.59.9.9" class="ltx_tr">
<td id="A2.T3.59.9.9.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">FedAvg-FT</td>
<td id="A2.T3.56.6.6.1" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.56.6.6.1.m1.1" class="ltx_Math" alttext="18.76\pm 0.44" display="inline"><semantics id="A2.T3.56.6.6.1.m1.1a"><mrow id="A2.T3.56.6.6.1.m1.1.1" xref="A2.T3.56.6.6.1.m1.1.1.cmml"><mn id="A2.T3.56.6.6.1.m1.1.1.2" xref="A2.T3.56.6.6.1.m1.1.1.2.cmml">18.76</mn><mo id="A2.T3.56.6.6.1.m1.1.1.1" xref="A2.T3.56.6.6.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.56.6.6.1.m1.1.1.3" xref="A2.T3.56.6.6.1.m1.1.1.3.cmml">0.44</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.56.6.6.1.m1.1b"><apply id="A2.T3.56.6.6.1.m1.1.1.cmml" xref="A2.T3.56.6.6.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.56.6.6.1.m1.1.1.1.cmml" xref="A2.T3.56.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.56.6.6.1.m1.1.1.2.cmml" xref="A2.T3.56.6.6.1.m1.1.1.2">18.76</cn><cn type="float" id="A2.T3.56.6.6.1.m1.1.1.3.cmml" xref="A2.T3.56.6.6.1.m1.1.1.3">0.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.56.6.6.1.m1.1c">18.76\pm 0.44</annotation></semantics></math></td>
<td id="A2.T3.57.7.7.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.57.7.7.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.57.7.7.2.m1.1a"><mn id="A2.T3.57.7.7.2.m1.1.1" xref="A2.T3.57.7.7.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.57.7.7.2.m1.1b"><cn type="integer" id="A2.T3.57.7.7.2.m1.1.1.cmml" xref="A2.T3.57.7.7.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.57.7.7.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.58.8.8.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><math id="A2.T3.58.8.8.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.58.8.8.3.m1.1a"><mo id="A2.T3.58.8.8.3.m1.1.1" xref="A2.T3.58.8.8.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.58.8.8.3.m1.1b"><minus id="A2.T3.58.8.8.3.m1.1.1.cmml" xref="A2.T3.58.8.8.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.58.8.8.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.59.9.9.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A2.T3.59.9.9.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.59.9.9.4.m1.1a"><mo id="A2.T3.59.9.9.4.m1.1.1" xref="A2.T3.59.9.9.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.59.9.9.4.m1.1b"><minus id="A2.T3.59.9.9.4.m1.1.1.cmml" xref="A2.T3.59.9.9.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.59.9.9.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.63.13.13" class="ltx_tr">
<td id="A2.T3.63.13.13.5" class="ltx_td ltx_align_center ltx_border_rr">FedLwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="A2.T3.60.10.10.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.60.10.10.1.m1.1" class="ltx_Math" alttext="62.39\pm 1.12" display="inline"><semantics id="A2.T3.60.10.10.1.m1.1a"><mrow id="A2.T3.60.10.10.1.m1.1.1" xref="A2.T3.60.10.10.1.m1.1.1.cmml"><mn id="A2.T3.60.10.10.1.m1.1.1.2" xref="A2.T3.60.10.10.1.m1.1.1.2.cmml">62.39</mn><mo id="A2.T3.60.10.10.1.m1.1.1.1" xref="A2.T3.60.10.10.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.60.10.10.1.m1.1.1.3" xref="A2.T3.60.10.10.1.m1.1.1.3.cmml">1.12</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.60.10.10.1.m1.1b"><apply id="A2.T3.60.10.10.1.m1.1.1.cmml" xref="A2.T3.60.10.10.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.60.10.10.1.m1.1.1.1.cmml" xref="A2.T3.60.10.10.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.60.10.10.1.m1.1.1.2.cmml" xref="A2.T3.60.10.10.1.m1.1.1.2">62.39</cn><cn type="float" id="A2.T3.60.10.10.1.m1.1.1.3.cmml" xref="A2.T3.60.10.10.1.m1.1.1.3">1.12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.60.10.10.1.m1.1c">62.39\pm 1.12</annotation></semantics></math></td>
<td id="A2.T3.61.11.11.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.61.11.11.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.61.11.11.2.m1.1a"><mn id="A2.T3.61.11.11.2.m1.1.1" xref="A2.T3.61.11.11.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.61.11.11.2.m1.1b"><cn type="integer" id="A2.T3.61.11.11.2.m1.1.1.cmml" xref="A2.T3.61.11.11.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.61.11.11.2.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.62.12.12.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.62.12.12.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.62.12.12.3.m1.1a"><mn id="A2.T3.62.12.12.3.m1.1.1" xref="A2.T3.62.12.12.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.62.12.12.3.m1.1b"><cn type="integer" id="A2.T3.62.12.12.3.m1.1.1.cmml" xref="A2.T3.62.12.12.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.62.12.12.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.63.13.13.4" class="ltx_td ltx_align_center"><math id="A2.T3.63.13.13.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.63.13.13.4.m1.1a"><mo id="A2.T3.63.13.13.4.m1.1.1" xref="A2.T3.63.13.13.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.63.13.13.4.m1.1b"><minus id="A2.T3.63.13.13.4.m1.1.1.cmml" xref="A2.T3.63.13.13.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.63.13.13.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.67.17.17" class="ltx_tr">
<td id="A2.T3.67.17.17.5" class="ltx_td ltx_align_center ltx_border_rr">FedAvg-Prompt</td>
<td id="A2.T3.64.14.14.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.64.14.14.1.m1.1" class="ltx_Math" alttext="51.03\pm 2.23" display="inline"><semantics id="A2.T3.64.14.14.1.m1.1a"><mrow id="A2.T3.64.14.14.1.m1.1.1" xref="A2.T3.64.14.14.1.m1.1.1.cmml"><mn id="A2.T3.64.14.14.1.m1.1.1.2" xref="A2.T3.64.14.14.1.m1.1.1.2.cmml">51.03</mn><mo id="A2.T3.64.14.14.1.m1.1.1.1" xref="A2.T3.64.14.14.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.64.14.14.1.m1.1.1.3" xref="A2.T3.64.14.14.1.m1.1.1.3.cmml">2.23</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.64.14.14.1.m1.1b"><apply id="A2.T3.64.14.14.1.m1.1.1.cmml" xref="A2.T3.64.14.14.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.64.14.14.1.m1.1.1.1.cmml" xref="A2.T3.64.14.14.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.64.14.14.1.m1.1.1.2.cmml" xref="A2.T3.64.14.14.1.m1.1.1.2">51.03</cn><cn type="float" id="A2.T3.64.14.14.1.m1.1.1.3.cmml" xref="A2.T3.64.14.14.1.m1.1.1.3">2.23</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.64.14.14.1.m1.1c">51.03\pm 2.23</annotation></semantics></math></td>
<td id="A2.T3.65.15.15.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.65.15.15.2.m1.1" class="ltx_Math" alttext="9.6" display="inline"><semantics id="A2.T3.65.15.15.2.m1.1a"><mn id="A2.T3.65.15.15.2.m1.1.1" xref="A2.T3.65.15.15.2.m1.1.1.cmml">9.6</mn><annotation-xml encoding="MathML-Content" id="A2.T3.65.15.15.2.m1.1b"><cn type="float" id="A2.T3.65.15.15.2.m1.1.1.cmml" xref="A2.T3.65.15.15.2.m1.1.1">9.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.65.15.15.2.m1.1c">9.6</annotation></semantics></math></td>
<td id="A2.T3.66.16.16.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.66.16.16.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.66.16.16.3.m1.1a"><mo id="A2.T3.66.16.16.3.m1.1.1" xref="A2.T3.66.16.16.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.66.16.16.3.m1.1b"><minus id="A2.T3.66.16.16.3.m1.1.1.cmml" xref="A2.T3.66.16.16.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.66.16.16.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.67.17.17.4" class="ltx_td ltx_align_center"><math id="A2.T3.67.17.17.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.67.17.17.4.m1.1a"><mo id="A2.T3.67.17.17.4.m1.1.1" xref="A2.T3.67.17.17.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.67.17.17.4.m1.1b"><minus id="A2.T3.67.17.17.4.m1.1.1.cmml" xref="A2.T3.67.17.17.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.67.17.17.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.71.21.21" class="ltx_tr">
<td id="A2.T3.71.21.21.5" class="ltx_td ltx_align_center ltx_border_rr">FedProx-Prompt</td>
<td id="A2.T3.68.18.18.1" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.68.18.18.1.m1.1" class="ltx_Math" alttext="62.83\pm 0.45" display="inline"><semantics id="A2.T3.68.18.18.1.m1.1a"><mrow id="A2.T3.68.18.18.1.m1.1.1" xref="A2.T3.68.18.18.1.m1.1.1.cmml"><mn id="A2.T3.68.18.18.1.m1.1.1.2" xref="A2.T3.68.18.18.1.m1.1.1.2.cmml">62.83</mn><mo id="A2.T3.68.18.18.1.m1.1.1.1" xref="A2.T3.68.18.18.1.m1.1.1.1.cmml">±</mo><mn id="A2.T3.68.18.18.1.m1.1.1.3" xref="A2.T3.68.18.18.1.m1.1.1.3.cmml">0.45</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.68.18.18.1.m1.1b"><apply id="A2.T3.68.18.18.1.m1.1.1.cmml" xref="A2.T3.68.18.18.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.68.18.18.1.m1.1.1.1.cmml" xref="A2.T3.68.18.18.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.68.18.18.1.m1.1.1.2.cmml" xref="A2.T3.68.18.18.1.m1.1.1.2">62.83</cn><cn type="float" id="A2.T3.68.18.18.1.m1.1.1.3.cmml" xref="A2.T3.68.18.18.1.m1.1.1.3">0.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.68.18.18.1.m1.1c">62.83\pm 0.45</annotation></semantics></math></td>
<td id="A2.T3.69.19.19.2" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.69.19.19.2.m1.1" class="ltx_Math" alttext="9.6" display="inline"><semantics id="A2.T3.69.19.19.2.m1.1a"><mn id="A2.T3.69.19.19.2.m1.1.1" xref="A2.T3.69.19.19.2.m1.1.1.cmml">9.6</mn><annotation-xml encoding="MathML-Content" id="A2.T3.69.19.19.2.m1.1b"><cn type="float" id="A2.T3.69.19.19.2.m1.1.1.cmml" xref="A2.T3.69.19.19.2.m1.1.1">9.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.69.19.19.2.m1.1c">9.6</annotation></semantics></math></td>
<td id="A2.T3.70.20.20.3" class="ltx_td ltx_align_center ltx_border_rr"><math id="A2.T3.70.20.20.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.70.20.20.3.m1.1a"><mn id="A2.T3.70.20.20.3.m1.1.1" xref="A2.T3.70.20.20.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.70.20.20.3.m1.1b"><cn type="integer" id="A2.T3.70.20.20.3.m1.1.1.cmml" xref="A2.T3.70.20.20.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.70.20.20.3.m1.1c">100</annotation></semantics></math></td>
<td id="A2.T3.71.21.21.4" class="ltx_td ltx_align_center"><math id="A2.T3.71.21.21.4.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.71.21.21.4.m1.1a"><mo id="A2.T3.71.21.21.4.m1.1.1" xref="A2.T3.71.21.21.4.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.71.21.21.4.m1.1b"><minus id="A2.T3.71.21.21.4.m1.1.1.cmml" xref="A2.T3.71.21.21.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.71.21.21.4.m1.1c">-</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.75.25.25" class="ltx_tr">
<td id="A2.T3.75.25.25.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="A2.T3.75.25.25.5.1" class="ltx_text ltx_font_bold">HePCo (Ours)</span></td>
<td id="A2.T3.72.22.22.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.72.22.22.1.m1.1" class="ltx_Math" alttext="\bm{64.01\pm 0.36}" display="inline"><semantics id="A2.T3.72.22.22.1.m1.1a"><mrow id="A2.T3.72.22.22.1.m1.1.1" xref="A2.T3.72.22.22.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.72.22.22.1.m1.1.1.2" xref="A2.T3.72.22.22.1.m1.1.1.2.cmml">64.01</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.72.22.22.1.m1.1.1.1" xref="A2.T3.72.22.22.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.72.22.22.1.m1.1.1.3" xref="A2.T3.72.22.22.1.m1.1.1.3.cmml">0.36</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.72.22.22.1.m1.1b"><apply id="A2.T3.72.22.22.1.m1.1.1.cmml" xref="A2.T3.72.22.22.1.m1.1.1"><csymbol cd="latexml" id="A2.T3.72.22.22.1.m1.1.1.1.cmml" xref="A2.T3.72.22.22.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.72.22.22.1.m1.1.1.2.cmml" xref="A2.T3.72.22.22.1.m1.1.1.2">64.01</cn><cn type="float" id="A2.T3.72.22.22.1.m1.1.1.3.cmml" xref="A2.T3.72.22.22.1.m1.1.1.3">0.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.72.22.22.1.m1.1c">\bm{64.01\pm 0.36}</annotation></semantics></math></td>
<td id="A2.T3.73.23.23.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.73.23.23.2.m1.1" class="ltx_Math" alttext="9.6" display="inline"><semantics id="A2.T3.73.23.23.2.m1.1a"><mn id="A2.T3.73.23.23.2.m1.1.1" xref="A2.T3.73.23.23.2.m1.1.1.cmml">9.6</mn><annotation-xml encoding="MathML-Content" id="A2.T3.73.23.23.2.m1.1b"><cn type="float" id="A2.T3.73.23.23.2.m1.1.1.cmml" xref="A2.T3.73.23.23.2.m1.1.1">9.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.73.23.23.2.m1.1c">9.6</annotation></semantics></math></td>
<td id="A2.T3.74.24.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><math id="A2.T3.74.24.24.3.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="A2.T3.74.24.24.3.m1.1a"><mo id="A2.T3.74.24.24.3.m1.1.1" xref="A2.T3.74.24.24.3.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.T3.74.24.24.3.m1.1b"><minus id="A2.T3.74.24.24.3.m1.1.1.cmml" xref="A2.T3.74.24.24.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.74.24.24.3.m1.1c">-</annotation></semantics></math></td>
<td id="A2.T3.75.25.25.4" class="ltx_td ltx_align_center ltx_border_b"><math id="A2.T3.75.25.25.4.m1.1" class="ltx_Math" alttext="9.6" display="inline"><semantics id="A2.T3.75.25.25.4.m1.1a"><mn id="A2.T3.75.25.25.4.m1.1.1" xref="A2.T3.75.25.25.4.m1.1.1.cmml">9.6</mn><annotation-xml encoding="MathML-Content" id="A2.T3.75.25.25.4.m1.1b"><cn type="float" id="A2.T3.75.25.25.4.m1.1.1.cmml" xref="A2.T3.75.25.25.4.m1.1.1">9.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.75.25.25.4.m1.1c">9.6</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
</figure>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p"><span id="A2.p2.1.1" class="ltx_text ltx_font_bold">Computation Overhead.</span> Our method does not require any extra computation at the client side but introduces an overhead at the server side. This overhead includes the time required to train the generators and perform knowledge distillation. To quantify this overhead, we conducted benchmarking using 2 NVIDIA TITAN RTX GPUs in a 5 client setup, as described in the experiments section. Our method incurs an additional 220 seconds of computation time at the server side per round, compared to the FedAvg method.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">It is important to note that existing CFL methods such as CFed, GLFC, and FedCIL also introduce overheads at the server and client sides. However, since we do not report their accuracy numbers in our study, we refrain from making direct comparisons regarding the overhead of our method with these methods.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.1" class="ltx_p"><span id="A2.p4.1.1" class="ltx_text ltx_font_bold">Storage Overhead.</span> As our method operates in a stateless FL setup, we do not require clients to maintain any state information or additional storage. Our approach requires the server model to store the classifier and prompt components corresponding to the last task model which is used in distillation resulting into a storage cost equal to ~9.5% of the base encoder model size. Baselines that use LwF.MC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> or FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> incur extra storage costs at the client side equal to the size of entire encoder and classifier i.e ~86M parameters. We report the storage overhead at the client and server side as the number of parameters stored relative to the base model (%).</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Discussion</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_bold">Limitations.</span> It is worth noting that prompting-based methods are still relatively new and not extensively studied, making the interpretation of these prompts challenging. Therefore, future work should focus on testing the robustness of these methods in diverse setups to ensure their effectiveness in different scenarios.
One potential limitation of this work is in the computation overhead introduced at the server, which may be an issue for some use-cases. Although the generation and distillation procedures are relatively lightweight, they still rely on server-side compute resources, which may not be universally accessible in all scenarios. Additionally, our approach necessitates clients to use pretrained vision transformers, leaving open the question of how this framework can be extended to accommodate other architectures. These are interesting avenues for future research.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p"><span id="A3.p2.1.1" class="ltx_text ltx_font_bold">Broader Impact.</span> The machine learning community is increasingly leaning towards the adoption of large-scale models for various applications. However, updating these models with new data poses a significant challenge. Retraining models from scratch each time new data arrives is computationally expensive and can have substantial financial <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite> and environmental <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> implications. Our approach offers a solution by enabling incremental learning on new data without the need for complete model retraining. Additionally, our use of prompting techniques allows for significant reductions in communication and local computation costs while enhancing privacy, which is especially critical for on-device edge computing applications.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2306.09969" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2306.09970" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2306.09970">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2306.09970" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2306.09971" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 23:52:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
