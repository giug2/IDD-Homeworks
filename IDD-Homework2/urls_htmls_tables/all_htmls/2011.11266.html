<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2011.11266] Federated learning with class imbalance reduction</title><meta property="og:description" content="Federated learning (FL) is a promising technique that enables a large amount of edge computing devices to collaboratively train a global learning model.
Due to privacy concerns, the raw data on devices could not be ava…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated learning with class imbalance reduction">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated learning with class imbalance reduction">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2011.11266">

<!--Generated on Sun Mar  3 21:43:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated learning with class imbalance reduction
<br class="ltx_break">
</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p"><span id="id1.id1.1" class="ltx_text" style="font-size:90%;">Federated learning (FL) is a promising technique that enables a large amount of edge computing devices to collaboratively train a global learning model.
Due to privacy concerns, the raw data on devices could not be available for centralized server.
Constrained by the spectrum limitation and computation capacity, only a subset of devices can be engaged to train and transmit the trained model to centralized server for aggregation.
Since the local data distribution varies among all devices, class imbalance problem arises along with the unfavorable client selection, resulting in a slow converge rate of the global model.
In this paper, an estimation scheme is designed to reveal the class distribution without the awareness of raw data.
Based on the scheme, a device selection algorithm towards minimal class imbalance is proposed, thus can improve the convergence performance of the global model.
Simulation results demonstrate the effectiveness of the proposed algorithm.</span></p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:90%;">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— <span id="p1.1.1.1.1" class="ltx_text ltx_font_medium">
federated learning, deep neural networks, privacy concerns, class imbalance, client scheduling, multi-armed bandit.</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span id="S1.p1.1.1" class="ltx_text" style="font-size:90%;">With the growing amount of applications,
end devices, e.g., smart phones, tablets, or vehicles, generate massive private data in daily life </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.4" class="ltx_text" style="font-size:90%;">.
The valuable personal data can be harnessed to train the machine learning model and significantly improve the quality of end-users’ experience.
However, due to privacy concerns, transmitting private data from local client devices to the cloud server is not feasible and appropriate.</span></p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text" style="font-size:90%;">To efficiently utilize the end-users’ data, federated learning (FL) has emerged as a new paradigm of distributed machine learning that executes model training with the private data in local devices </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S1.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.4" class="ltx_text" style="font-size:90%;">.
Engaging FL, locally training model can be transmitted to global server for model aggregation without any data information.
Unlike the server-based applications, FL on end devices poses several fundamental challenges, such as the limited connectivity of wireless networks, unstable availability of end devices, and the non identically and independently distributed (non-IID) distributions of client dataset.
The concerns mentioned above prohibits the model training on all participating devices from beginning to end.
To avoid such a dilemma, only a subset of devices is selected to participate in each round of model training which is a common practice in FL</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S1.p2.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.7" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text" style="font-size:90%;">In recent years, a variety of client selection schemes in FL have been advocated.
In </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S1.p3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.4" class="ltx_text" style="font-size:90%;">, the authors proposed a client scheduling approach to achieve a proper trade-off between the learning efficiency and latency per round.
The staleness of the received models and instantaneous channel qualities were jointly considered in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S1.p3.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.7" class="ltx_text" style="font-size:90%;">.
Besides, the work in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib6" title="" class="ltx_ref">6</a><span id="S1.p3.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.10" class="ltx_text" style="font-size:90%;"> investigated the problem of minimizing energy consumption of edge devices in FL without compromising learning performance.
The client data’s distribution of the above FL methods is IID , which may not be applicable in practice.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text" style="font-size:90%;">The device usage pattern of different users varies, so the data samples and labels on any individual device may follow a different distribution.
A individual data distribution cannot represent the global data distribution.
Recently, it has been pointed out that the performance of FL,
especially federated averaging (FedAvg) algorithm </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S1.p4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p4.1.4" class="ltx_text" style="font-size:90%;">, may significantly degrade in the presence of non-IID data, in terms of the model accuracy and the communication rounds required for convergence </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p4.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S1.p4.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p4.1.7" class="ltx_text" style="font-size:90%;">.
Recognizing such criticality, the authors in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p4.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S1.p4.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p4.1.10" class="ltx_text" style="font-size:90%;"> designed a scheme to mitigate the impact of the class imbalance and introduce a loss function to evaluate the class imbalance.
Moreover, the work in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p4.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S1.p4.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p4.1.13" class="ltx_text" style="font-size:90%;"> exploited learning algorithm for client selection to decrease the communication rounds with target accuracy.
However, the algorithm in </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p4.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S1.p4.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p4.1.16" class="ltx_text" style="font-size:90%;"> needs lots of offline training and the data on each device must remain unchanged during the training procedure.</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><span id="S1.p5.1.1" class="ltx_text" style="font-size:90%;">In this paper, the client selection problem concentrated on class imbalance in FL is investigated.
With the concern of the users’ privacy, we propose a scheme that can reveal the severity of class imbalance without any raw data of client devices.
Besides, utilizing reinforcement learning, we propose a client selection scheme to minimize the effect of class imbalance.
The proposed algorithm endeavors to learn the class distribution and selects the most balanced clients combination.</span></p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><span id="S1.p6.1.1" class="ltx_text" style="font-size:90%;">The remainder of this paper is organized as follows.
The system model is presented in section </span><a href="#S2" title="2 System Model ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S1.p6.1.2" class="ltx_text" style="font-size:90%;">.
In section </span><a href="#S3" title="3 Online Learning Algorithm for Client selection ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="S1.p6.1.3" class="ltx_text" style="font-size:90%;">, we introduce a scheme to evaluate the class imbalance of clients and propose a learning algorithm to find the best client set.
The performance of the proposed algorithm is numerically evaluated in section </span><a href="#S4" title="4 Numerical Results ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4</span></a><span id="S1.p6.1.4" class="ltx_text" style="font-size:90%;">.
In section </span><a href="#S5" title="5 Conclusions ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">5</span></a><span id="S1.p6.1.5" class="ltx_text" style="font-size:90%;">, we conclude this paper.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">2 </span>System Model</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text" style="font-size:90%;">Consider training a deep neural network (DNN) under FL settings with a set of clients </span><math id="S2.p1.1.m1.4" class="ltx_Math" alttext="\mathcal{K}=\{1,2,...,K\}" display="inline"><semantics id="S2.p1.1.m1.4a"><mrow id="S2.p1.1.m1.4.5" xref="S2.p1.1.m1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p1.1.m1.4.5.2" xref="S2.p1.1.m1.4.5.2.cmml">𝒦</mi><mo mathsize="90%" id="S2.p1.1.m1.4.5.1" xref="S2.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S2.p1.1.m1.4.5.3.2" xref="S2.p1.1.m1.4.5.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.p1.1.m1.4.5.3.2.1" xref="S2.p1.1.m1.4.5.3.1.cmml">{</mo><mn mathsize="90%" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">1</mn><mo mathsize="90%" id="S2.p1.1.m1.4.5.3.2.2" xref="S2.p1.1.m1.4.5.3.1.cmml">,</mo><mn mathsize="90%" id="S2.p1.1.m1.2.2" xref="S2.p1.1.m1.2.2.cmml">2</mn><mo mathsize="90%" id="S2.p1.1.m1.4.5.3.2.3" xref="S2.p1.1.m1.4.5.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.p1.1.m1.3.3" xref="S2.p1.1.m1.3.3.cmml">…</mi><mo mathsize="90%" id="S2.p1.1.m1.4.5.3.2.4" xref="S2.p1.1.m1.4.5.3.1.cmml">,</mo><mi mathsize="90%" id="S2.p1.1.m1.4.4" xref="S2.p1.1.m1.4.4.cmml">K</mi><mo maxsize="90%" minsize="90%" id="S2.p1.1.m1.4.5.3.2.5" xref="S2.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.4b"><apply id="S2.p1.1.m1.4.5.cmml" xref="S2.p1.1.m1.4.5"><eq id="S2.p1.1.m1.4.5.1.cmml" xref="S2.p1.1.m1.4.5.1"></eq><ci id="S2.p1.1.m1.4.5.2.cmml" xref="S2.p1.1.m1.4.5.2">𝒦</ci><set id="S2.p1.1.m1.4.5.3.1.cmml" xref="S2.p1.1.m1.4.5.3.2"><cn type="integer" id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">1</cn><cn type="integer" id="S2.p1.1.m1.2.2.cmml" xref="S2.p1.1.m1.2.2">2</cn><ci id="S2.p1.1.m1.3.3.cmml" xref="S2.p1.1.m1.3.3">…</ci><ci id="S2.p1.1.m1.4.4.cmml" xref="S2.p1.1.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.4c">\mathcal{K}=\{1,2,...,K\}</annotation></semantics></math><span id="S2.p1.1.2" class="ltx_text" style="font-size:90%;">, each with its own local dataset and a global server for model aggregation, as illustrated in Fig. </span><a href="#S2.F1" title="Figure 1 ‣ 2 System Model ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S2.p1.1.3" class="ltx_text" style="font-size:90%;">.
We model the channel from the device to global server as multiple access channel. With the communication limitation, only a fixed amount of spectrum is available </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p1.1.4.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib13" title="" class="ltx_ref">13</a><span id="S2.p1.1.5.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p1.1.6" class="ltx_text" style="font-size:90%;">.
Due to the scarce of the spectrum resource, the number of available channels is much smaller than that of the client devices.
</span></p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.10" class="ltx_p"><span id="S2.p2.10.1" class="ltx_text" style="font-size:90%;">We then formally introduce the DNN training for multiclass classification problem in FL.
Consider a class classification problem defined over a compact feature space </span><math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{X}</annotation></semantics></math><span id="S2.p2.10.2" class="ltx_text" style="font-size:90%;"> and a label space </span><math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{Y}=\mathcal{C}" display="inline"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">𝒴</mi><mo mathsize="90%" id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><eq id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1"></eq><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝒴</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathcal{Y}=\mathcal{C}</annotation></semantics></math><span id="S2.p2.10.3" class="ltx_text" style="font-size:90%;"> with </span><math id="S2.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.p2.3.m3.1a"><mi mathsize="90%" id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">C</annotation></semantics></math><span id="S2.p2.10.4" class="ltx_text" style="font-size:90%;"> classes, where </span><math id="S2.p2.4.m4.3" class="ltx_Math" alttext="\mathcal{C}=\{1,\cdots,C\}" display="inline"><semantics id="S2.p2.4.m4.3a"><mrow id="S2.p2.4.m4.3.4" xref="S2.p2.4.m4.3.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.4.m4.3.4.2" xref="S2.p2.4.m4.3.4.2.cmml">𝒞</mi><mo mathsize="90%" id="S2.p2.4.m4.3.4.1" xref="S2.p2.4.m4.3.4.1.cmml">=</mo><mrow id="S2.p2.4.m4.3.4.3.2" xref="S2.p2.4.m4.3.4.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.p2.4.m4.3.4.3.2.1" xref="S2.p2.4.m4.3.4.3.1.cmml">{</mo><mn mathsize="90%" id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">1</mn><mo mathsize="90%" id="S2.p2.4.m4.3.4.3.2.2" xref="S2.p2.4.m4.3.4.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.p2.4.m4.2.2" xref="S2.p2.4.m4.2.2.cmml">⋯</mi><mo mathsize="90%" id="S2.p2.4.m4.3.4.3.2.3" xref="S2.p2.4.m4.3.4.3.1.cmml">,</mo><mi mathsize="90%" id="S2.p2.4.m4.3.3" xref="S2.p2.4.m4.3.3.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S2.p2.4.m4.3.4.3.2.4" xref="S2.p2.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.3b"><apply id="S2.p2.4.m4.3.4.cmml" xref="S2.p2.4.m4.3.4"><eq id="S2.p2.4.m4.3.4.1.cmml" xref="S2.p2.4.m4.3.4.1"></eq><ci id="S2.p2.4.m4.3.4.2.cmml" xref="S2.p2.4.m4.3.4.2">𝒞</ci><set id="S2.p2.4.m4.3.4.3.1.cmml" xref="S2.p2.4.m4.3.4.3.2"><cn type="integer" id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">1</cn><ci id="S2.p2.4.m4.2.2.cmml" xref="S2.p2.4.m4.2.2">⋯</ci><ci id="S2.p2.4.m4.3.3.cmml" xref="S2.p2.4.m4.3.3">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.3c">\mathcal{C}=\{1,\cdots,C\}</annotation></semantics></math><span id="S2.p2.10.5" class="ltx_text" style="font-size:90%;">.
Let </span><math id="S2.p2.5.m5.2" class="ltx_Math" alttext="(\bm{x},y)" display="inline"><semantics id="S2.p2.5.m5.2a"><mrow id="S2.p2.5.m5.2.3.2" xref="S2.p2.5.m5.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.p2.5.m5.2.3.2.1" xref="S2.p2.5.m5.2.3.1.cmml">(</mo><mi mathsize="90%" id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">𝒙</mi><mo mathsize="90%" id="S2.p2.5.m5.2.3.2.2" xref="S2.p2.5.m5.2.3.1.cmml">,</mo><mi mathsize="90%" id="S2.p2.5.m5.2.2" xref="S2.p2.5.m5.2.2.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S2.p2.5.m5.2.3.2.3" xref="S2.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.2b"><interval closure="open" id="S2.p2.5.m5.2.3.1.cmml" xref="S2.p2.5.m5.2.3.2"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝒙</ci><ci id="S2.p2.5.m5.2.2.cmml" xref="S2.p2.5.m5.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.2c">(\bm{x},y)</annotation></semantics></math><span id="S2.p2.10.6" class="ltx_text" style="font-size:90%;"> denote a particular labeled sample.
A function </span><math id="S2.p2.6.m6.1" class="ltx_Math" alttext="f:\mathcal{X}\rightarrow\mathcal{D}" display="inline"><semantics id="S2.p2.6.m6.1a"><mrow id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi mathsize="90%" id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">f</mi><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml">:</mo><mrow id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.6.m6.1.1.3.2" xref="S2.p2.6.m6.1.1.3.2.cmml">𝒳</mi><mo mathsize="90%" stretchy="false" id="S2.p2.6.m6.1.1.3.1" xref="S2.p2.6.m6.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.6.m6.1.1.3.3" xref="S2.p2.6.m6.1.1.3.3.cmml">𝒟</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><ci id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1">:</ci><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">𝑓</ci><apply id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3"><ci id="S2.p2.6.m6.1.1.3.1.cmml" xref="S2.p2.6.m6.1.1.3.1">→</ci><ci id="S2.p2.6.m6.1.1.3.2.cmml" xref="S2.p2.6.m6.1.1.3.2">𝒳</ci><ci id="S2.p2.6.m6.1.1.3.3.cmml" xref="S2.p2.6.m6.1.1.3.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">f:\mathcal{X}\rightarrow\mathcal{D}</annotation></semantics></math><span id="S2.p2.10.7" class="ltx_text" style="font-size:90%;"> maps </span><math id="S2.p2.7.m7.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S2.p2.7.m7.1a"><mi mathsize="90%" id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><ci id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">\bm{x}</annotation></semantics></math><span id="S2.p2.10.8" class="ltx_text" style="font-size:90%;"> to the probability for the </span><math id="S2.p2.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.8.m8.1a"><mi mathsize="90%" id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">i</annotation></semantics></math><span id="S2.p2.10.9" class="ltx_text" style="font-size:90%;">th class, where </span><math id="S2.p2.9.m9.2" class="ltx_Math" alttext="\mathcal{D}=\{\bm{z}|\sum_{i=1}^{C}z_{i}=1,z_{i}\geq 0,\forall i\in\mathcal{C}\}" display="inline"><semantics id="S2.p2.9.m9.2a"><mrow id="S2.p2.9.m9.2.2" xref="S2.p2.9.m9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.9.m9.2.2.3" xref="S2.p2.9.m9.2.2.3.cmml">𝒟</mi><mo mathsize="90%" id="S2.p2.9.m9.2.2.2" xref="S2.p2.9.m9.2.2.2.cmml">=</mo><mrow id="S2.p2.9.m9.2.2.1.1" xref="S2.p2.9.m9.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.p2.9.m9.2.2.1.1.2" xref="S2.p2.9.m9.2.2.1.2.1.cmml">{</mo><mi mathsize="90%" id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml">𝒛</mi><mo lspace="0em" mathsize="90%" rspace="0em" id="S2.p2.9.m9.2.2.1.1.3" xref="S2.p2.9.m9.2.2.1.2.1.cmml">|</mo><mrow id="S2.p2.9.m9.2.2.1.1.1.2" xref="S2.p2.9.m9.2.2.1.1.1.3.cmml"><mrow id="S2.p2.9.m9.2.2.1.1.1.1.1" xref="S2.p2.9.m9.2.2.1.1.1.1.1.cmml"><mrow id="S2.p2.9.m9.2.2.1.1.1.1.1.2" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.cmml"><msubsup id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.2" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.cmml"><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.2" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.1" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.3" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.3" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.3.cmml">C</mi></msubsup><msub id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.2" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.2.cmml">z</mi><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.3" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.1" xref="S2.p2.9.m9.2.2.1.1.1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.1.1.3" xref="S2.p2.9.m9.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.3" xref="S2.p2.9.m9.2.2.1.1.1.3a.cmml">,</mo><mrow id="S2.p2.9.m9.2.2.1.1.1.2.2.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.3.cmml"><mrow id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.cmml"><msub id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.cmml"><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.2.cmml">z</mi><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.3" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.1" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.1.cmml">≥</mo><mn mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.3" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.3.cmml">0</mn></mrow><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.3" xref="S2.p2.9.m9.2.2.1.1.1.2.2.3a.cmml">,</mo><mrow id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.cmml"><mrow id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.cmml"><mo mathsize="90%" rspace="0.167em" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.1" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.1.cmml">∀</mo><mi mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.2" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.2.cmml">i</mi></mrow><mo mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.1" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.3" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.3.cmml">𝒞</mi></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.p2.9.m9.2.2.1.1.4" xref="S2.p2.9.m9.2.2.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.2b"><apply id="S2.p2.9.m9.2.2.cmml" xref="S2.p2.9.m9.2.2"><eq id="S2.p2.9.m9.2.2.2.cmml" xref="S2.p2.9.m9.2.2.2"></eq><ci id="S2.p2.9.m9.2.2.3.cmml" xref="S2.p2.9.m9.2.2.3">𝒟</ci><apply id="S2.p2.9.m9.2.2.1.2.cmml" xref="S2.p2.9.m9.2.2.1.1"><csymbol cd="latexml" id="S2.p2.9.m9.2.2.1.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.2">conditional-set</csymbol><ci id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1">𝒛</ci><apply id="S2.p2.9.m9.2.2.1.1.1.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.3a.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1"><eq id="S2.p2.9.m9.2.2.1.1.1.1.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.1"></eq><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2"><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1">superscript</csymbol><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1">subscript</csymbol><sum id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.2"></sum><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3"><eq id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.1"></eq><ci id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.1.3">𝐶</ci></apply><apply id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.2">𝑧</ci><ci id="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><cn type="integer" id="S2.p2.9.m9.2.2.1.1.1.1.1.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S2.p2.9.m9.2.2.1.1.1.2.2.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.2.2.3a.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1"><geq id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.1"></geq><apply id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.2">𝑧</ci><ci id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.1.1.3">0</cn></apply><apply id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2"><in id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.1"></in><apply id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2"><csymbol cd="latexml" id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.1">for-all</csymbol><ci id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.2.2">𝑖</ci></apply><ci id="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2.2.2.2.3">𝒞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.2c">\mathcal{D}=\{\bm{z}|\sum_{i=1}^{C}z_{i}=1,z_{i}\geq 0,\forall i\in\mathcal{C}\}</annotation></semantics></math><span id="S2.p2.10.10" class="ltx_text" style="font-size:90%;">. Let </span><math id="S2.p2.10.m10.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S2.p2.10.m10.1a"><mi mathsize="90%" id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">\bm{W}</annotation></semantics></math><span id="S2.p2.10.11" class="ltx_text" style="font-size:90%;"> denote the weight of DNN.
The cross entropy loss can be harnessed to evaluate the training performance in classification, which is defined as</span></p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle L(\bm{w})" display="inline"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.2" xref="S2.Ex1.m1.1.2.cmml"><mi mathsize="90%" id="S2.Ex1.m1.1.2.2" xref="S2.Ex1.m1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.1.2.1" xref="S2.Ex1.m1.1.2.1.cmml">​</mo><mrow id="S2.Ex1.m1.1.2.3.2" xref="S2.Ex1.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.Ex1.m1.1.2.3.2.1" xref="S2.Ex1.m1.1.2.cmml">(</mo><mi mathsize="90%" id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">𝒘</mi><mo maxsize="90%" minsize="90%" id="S2.Ex1.m1.1.2.3.2.2" xref="S2.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.2.cmml" xref="S2.Ex1.m1.1.2"><times id="S2.Ex1.m1.1.2.1.cmml" xref="S2.Ex1.m1.1.2.1"></times><ci id="S2.Ex1.m1.1.2.2.cmml" xref="S2.Ex1.m1.1.2.2">𝐿</ci><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle L(\bm{w})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.5" class="ltx_Math" alttext="\displaystyle=E_{\bm{x},y\sim p}\Big{[}\sum_{i=1}^{C}\mathbb{1}_{y=i}\log f_{i}(\bm{x},\bm{W})\Big{]}" display="inline"><semantics id="S2.Ex1.m2.5a"><mrow id="S2.Ex1.m2.5.5" xref="S2.Ex1.m2.5.5.cmml"><mi id="S2.Ex1.m2.5.5.3" xref="S2.Ex1.m2.5.5.3.cmml"></mi><mo mathsize="90%" id="S2.Ex1.m2.5.5.2" xref="S2.Ex1.m2.5.5.2.cmml">=</mo><mrow id="S2.Ex1.m2.5.5.1" xref="S2.Ex1.m2.5.5.1.cmml"><msub id="S2.Ex1.m2.5.5.1.3" xref="S2.Ex1.m2.5.5.1.3.cmml"><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.3.2" xref="S2.Ex1.m2.5.5.1.3.2.cmml">E</mi><mrow id="S2.Ex1.m2.2.2.2" xref="S2.Ex1.m2.2.2.2.cmml"><mrow id="S2.Ex1.m2.2.2.2.4.2" xref="S2.Ex1.m2.2.2.2.4.1.cmml"><mi mathsize="90%" id="S2.Ex1.m2.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.cmml">𝒙</mi><mo mathsize="90%" id="S2.Ex1.m2.2.2.2.4.2.1" xref="S2.Ex1.m2.2.2.2.4.1.cmml">,</mo><mi mathsize="90%" id="S2.Ex1.m2.2.2.2.2" xref="S2.Ex1.m2.2.2.2.2.cmml">y</mi></mrow><mo mathsize="90%" id="S2.Ex1.m2.2.2.2.3" xref="S2.Ex1.m2.2.2.2.3.cmml">∼</mo><mi mathsize="90%" id="S2.Ex1.m2.2.2.2.5" xref="S2.Ex1.m2.2.2.2.5.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.5.5.1.2" xref="S2.Ex1.m2.5.5.1.2.cmml">​</mo><mrow id="S2.Ex1.m2.5.5.1.1.1" xref="S2.Ex1.m2.5.5.1.1.2.cmml"><mo maxsize="160%" minsize="160%" id="S2.Ex1.m2.5.5.1.1.1.2" xref="S2.Ex1.m2.5.5.1.1.2.1.cmml">[</mo><mrow id="S2.Ex1.m2.5.5.1.1.1.1" xref="S2.Ex1.m2.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex1.m2.5.5.1.1.1.1.1" xref="S2.Ex1.m2.5.5.1.1.1.1.1.cmml"><munderover id="S2.Ex1.m2.5.5.1.1.1.1.1a" xref="S2.Ex1.m2.5.5.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.2" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.2" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.1" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.3" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.1.3" xref="S2.Ex1.m2.5.5.1.1.1.1.1.3.cmml">C</mi></munderover></mstyle><mrow id="S2.Ex1.m2.5.5.1.1.1.1.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.cmml"><msub id="S2.Ex1.m2.5.5.1.1.1.1.2.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_double-struck" mathsize="90%" mathvariant="double-struck" id="S2.Ex1.m2.5.5.1.1.1.1.2.2.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.2.cmml">𝟙</mi><mrow id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.2.cmml">y</mi><mo mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.1" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.3" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S2.Ex1.m2.5.5.1.1.1.1.2.1" xref="S2.Ex1.m2.5.5.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.Ex1.m2.5.5.1.1.1.1.2.3" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.3.1" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex1.m2.5.5.1.1.1.1.2.3a" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.cmml">⁡</mo><msub id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.cmml"><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.2.cmml">f</mi><mi mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.3" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.5.5.1.1.1.1.2.1a" xref="S2.Ex1.m2.5.5.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.Ex1.m2.5.5.1.1.1.1.2.4.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.4.2.1" xref="S2.Ex1.m2.5.5.1.1.1.1.2.4.1.cmml">(</mo><mi mathsize="90%" id="S2.Ex1.m2.3.3" xref="S2.Ex1.m2.3.3.cmml">𝒙</mi><mo mathsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.4.2.2" xref="S2.Ex1.m2.5.5.1.1.1.1.2.4.1.cmml">,</mo><mi mathsize="90%" id="S2.Ex1.m2.4.4" xref="S2.Ex1.m2.4.4.cmml">𝑾</mi><mo maxsize="90%" minsize="90%" id="S2.Ex1.m2.5.5.1.1.1.1.2.4.2.3" xref="S2.Ex1.m2.5.5.1.1.1.1.2.4.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="160%" minsize="160%" id="S2.Ex1.m2.5.5.1.1.1.3" xref="S2.Ex1.m2.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m2.5b"><apply id="S2.Ex1.m2.5.5.cmml" xref="S2.Ex1.m2.5.5"><eq id="S2.Ex1.m2.5.5.2.cmml" xref="S2.Ex1.m2.5.5.2"></eq><csymbol cd="latexml" id="S2.Ex1.m2.5.5.3.cmml" xref="S2.Ex1.m2.5.5.3">absent</csymbol><apply id="S2.Ex1.m2.5.5.1.cmml" xref="S2.Ex1.m2.5.5.1"><times id="S2.Ex1.m2.5.5.1.2.cmml" xref="S2.Ex1.m2.5.5.1.2"></times><apply id="S2.Ex1.m2.5.5.1.3.cmml" xref="S2.Ex1.m2.5.5.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.5.5.1.3.1.cmml" xref="S2.Ex1.m2.5.5.1.3">subscript</csymbol><ci id="S2.Ex1.m2.5.5.1.3.2.cmml" xref="S2.Ex1.m2.5.5.1.3.2">𝐸</ci><apply id="S2.Ex1.m2.2.2.2.cmml" xref="S2.Ex1.m2.2.2.2"><csymbol cd="latexml" id="S2.Ex1.m2.2.2.2.3.cmml" xref="S2.Ex1.m2.2.2.2.3">similar-to</csymbol><list id="S2.Ex1.m2.2.2.2.4.1.cmml" xref="S2.Ex1.m2.2.2.2.4.2"><ci id="S2.Ex1.m2.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1">𝒙</ci><ci id="S2.Ex1.m2.2.2.2.2.cmml" xref="S2.Ex1.m2.2.2.2.2">𝑦</ci></list><ci id="S2.Ex1.m2.2.2.2.5.cmml" xref="S2.Ex1.m2.2.2.2.5">𝑝</ci></apply></apply><apply id="S2.Ex1.m2.5.5.1.1.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m2.5.5.1.1.2.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex1.m2.5.5.1.1.1.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1"><apply id="S2.Ex1.m2.5.5.1.1.1.1.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m2.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex1.m2.5.5.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1">subscript</csymbol><sum id="S2.Ex1.m2.5.5.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.2"></sum><apply id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3"><eq id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.1"></eq><ci id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m2.5.5.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.1.3">𝐶</ci></apply><apply id="S2.Ex1.m2.5.5.1.1.1.1.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2"><times id="S2.Ex1.m2.5.5.1.1.1.1.2.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.1"></times><apply id="S2.Ex1.m2.5.5.1.1.1.1.2.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m2.5.5.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex1.m2.5.5.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.2">double-struck-𝟙</ci><apply id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3"><eq id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.2">𝑦</ci><ci id="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S2.Ex1.m2.5.5.1.1.1.1.2.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3"><log id="S2.Ex1.m2.5.5.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.1"></log><apply id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2">subscript</csymbol><ci id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.2.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.2">𝑓</ci><ci id="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.3.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.3.2.3">𝑖</ci></apply></apply><interval closure="open" id="S2.Ex1.m2.5.5.1.1.1.1.2.4.1.cmml" xref="S2.Ex1.m2.5.5.1.1.1.1.2.4.2"><ci id="S2.Ex1.m2.3.3.cmml" xref="S2.Ex1.m2.3.3">𝒙</ci><ci id="S2.Ex1.m2.4.4.cmml" xref="S2.Ex1.m2.4.4">𝑾</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m2.5c">\displaystyle=E_{\bm{x},y\sim p}\Big{[}\sum_{i=1}^{C}\mathbb{1}_{y=i}\log f_{i}(\bm{x},\bm{W})\Big{]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{C}p(y=i)E_{\bm{x}|y=i}[\log f_{i}(\bm{x},\bm{W})]." display="inline"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml"></mi><mo mathsize="90%" id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><munderover id="S2.E1.m1.3.3.1.1.2.3a" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E1.m1.3.3.1.1.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.2.3" xref="S2.E1.m1.3.3.1.1.2.3.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.3.2.3.2" xref="S2.E1.m1.3.3.1.1.2.3.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E1.m1.3.3.1.1.2.3.2.3.1" xref="S2.E1.m1.3.3.1.1.2.3.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E1.m1.3.3.1.1.2.3.2.3.3" xref="S2.E1.m1.3.3.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.cmml">C</mi></munderover></mstyle><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">y</mi><mo mathsize="90%" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">=</mo><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></mrow><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3a" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><msub id="S2.E1.m1.3.3.1.1.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.5.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.2" xref="S2.E1.m1.3.3.1.1.2.2.5.2.cmml">E</mi><mrow id="S2.E1.m1.3.3.1.1.2.2.5.3" xref="S2.E1.m1.3.3.1.1.2.2.5.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.2.5.3.2" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.2.cmml">𝒙</mi><mo fence="false" mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.3.2.1" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.1.cmml">|</mo><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.3.2.3" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.3.cmml">y</mi></mrow><mo mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.3.1" xref="S2.E1.m1.3.3.1.1.2.2.5.3.1.cmml">=</mo><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.5.3.3" xref="S2.E1.m1.3.3.1.1.2.2.5.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3b" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.cmml">[</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.1.1" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.1" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2a" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.cmml">⁡</mo><msub id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.2.cmml">f</mi><mi mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.1" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.1.cmml">(</mo><mi mathsize="90%" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝒙</mi><mo mathsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.1.cmml">,</mo><mi mathsize="90%" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝑾</mi><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.1.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E1.m1.3.3.1.1.2.2.2.1.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4">absent</csymbol><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><apply id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.2.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2.3"><eq id="S2.E1.m1.3.3.1.1.2.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.2.3.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.2.3.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3">𝐶</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><times id="S2.E1.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3"></times><ci id="S2.E1.m1.3.3.1.1.2.2.4.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4">𝑝</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><eq id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1"></eq><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.5.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.5.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.5.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.2">𝐸</ci><apply id="S2.E1.m1.3.3.1.1.2.2.5.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3"><eq id="S2.E1.m1.3.3.1.1.2.2.5.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.1"></eq><apply id="S2.E1.m1.3.3.1.1.2.2.5.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.2.2.5.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.1">conditional</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.5.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.2">𝒙</ci><ci id="S2.E1.m1.3.3.1.1.2.2.5.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.2.3">𝑦</ci></apply><ci id="S2.E1.m1.3.3.1.1.2.2.5.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3.3">𝑖</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.3.3.1.1.2.2.2.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1"><times id="S2.E1.m1.3.3.1.1.2.2.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.1"></times><apply id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2"><log id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.1"></log><apply id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.2">𝑓</ci><ci id="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.2.2.3">𝑖</ci></apply></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.1.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝒙</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑾</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle=\sum_{i=1}^{C}p(y=i)E_{\bm{x}|y=i}[\log f_{i}(\bm{x},\bm{W})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.12" class="ltx_p"><span id="S2.p2.12.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.p2.11.m1.1" class="ltx_Math" alttext="E(\cdot)" display="inline"><semantics id="S2.p2.11.m1.1a"><mrow id="S2.p2.11.m1.1.2" xref="S2.p2.11.m1.1.2.cmml"><mi mathsize="90%" id="S2.p2.11.m1.1.2.2" xref="S2.p2.11.m1.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.p2.11.m1.1.2.1" xref="S2.p2.11.m1.1.2.1.cmml">​</mo><mrow id="S2.p2.11.m1.1.2.3.2" xref="S2.p2.11.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.p2.11.m1.1.2.3.2.1" xref="S2.p2.11.m1.1.2.cmml">(</mo><mo lspace="0em" mathsize="90%" rspace="0em" id="S2.p2.11.m1.1.1" xref="S2.p2.11.m1.1.1.cmml">⋅</mo><mo maxsize="90%" minsize="90%" id="S2.p2.11.m1.1.2.3.2.2" xref="S2.p2.11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m1.1b"><apply id="S2.p2.11.m1.1.2.cmml" xref="S2.p2.11.m1.1.2"><times id="S2.p2.11.m1.1.2.1.cmml" xref="S2.p2.11.m1.1.2.1"></times><ci id="S2.p2.11.m1.1.2.2.cmml" xref="S2.p2.11.m1.1.2.2">𝐸</ci><ci id="S2.p2.11.m1.1.1.cmml" xref="S2.p2.11.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m1.1c">E(\cdot)</annotation></semantics></math><span id="S2.p2.12.2" class="ltx_text" style="font-size:90%;"> denotes the expectation operation and </span><math id="S2.p2.12.m2.1" class="ltx_Math" alttext="\mathbb{1}" display="inline"><semantics id="S2.p2.12.m2.1a"><mi class="ltx_mathvariant_double-struck" mathsize="90%" mathvariant="double-struck" id="S2.p2.12.m2.1.1" xref="S2.p2.12.m2.1.1.cmml">𝟙</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m2.1b"><ci id="S2.p2.12.m2.1.1.cmml" xref="S2.p2.12.m2.1.1">double-struck-𝟙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m2.1c">\mathbb{1}</annotation></semantics></math><span id="S2.p2.12.3" class="ltx_text" style="font-size:90%;"> denotes the indicator matrix.</span></p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.8" class="ltx_p"><span id="S2.p3.8.1" class="ltx_text" style="font-size:90%;">In FL, the training procedure is an iterative process consisting of a number of communication rounds.
Let </span><math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\bm{W}^{k}_{t}" display="inline"><semantics id="S2.p3.1.m1.1a"><msubsup id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.p3.1.m1.1.1.2.2" xref="S2.p3.1.m1.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">t</mi><mi mathsize="90%" id="S2.p3.1.m1.1.1.2.3" xref="S2.p3.1.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><apply id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.2.1.cmml" xref="S2.p3.1.m1.1.1">superscript</csymbol><ci id="S2.p3.1.m1.1.1.2.2.cmml" xref="S2.p3.1.m1.1.1.2.2">𝑾</ci><ci id="S2.p3.1.m1.1.1.2.3.cmml" xref="S2.p3.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\bm{W}^{k}_{t}</annotation></semantics></math><span id="S2.p3.8.2" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\bm{W}^{g}_{t}" display="inline"><semantics id="S2.p3.2.m2.1a"><msubsup id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.p3.2.m2.1.1.2.2" xref="S2.p3.2.m2.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">t</mi><mi mathsize="90%" id="S2.p3.2.m2.1.1.2.3" xref="S2.p3.2.m2.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">subscript</csymbol><apply id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.2.1.cmml" xref="S2.p3.2.m2.1.1">superscript</csymbol><ci id="S2.p3.2.m2.1.1.2.2.cmml" xref="S2.p3.2.m2.1.1.2.2">𝑾</ci><ci id="S2.p3.2.m2.1.1.2.3.cmml" xref="S2.p3.2.m2.1.1.2.3">𝑔</ci></apply><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\bm{W}^{g}_{t}</annotation></semantics></math><span id="S2.p3.8.3" class="ltx_text" style="font-size:90%;"> denote the weights of </span><math id="S2.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p3.3.m3.1a"><mi mathsize="90%" id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">k</annotation></semantics></math><span id="S2.p3.8.4" class="ltx_text" style="font-size:90%;">th device’s DNN model and global DNN model in round </span><math id="S2.p3.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p3.4.m4.1a"><mi mathsize="90%" id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">t</annotation></semantics></math><span id="S2.p3.8.5" class="ltx_text" style="font-size:90%;">, respectively.
In round </span><math id="S2.p3.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p3.5.m5.1a"><mi mathsize="90%" id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">t</annotation></semantics></math><span id="S2.p3.8.6" class="ltx_text" style="font-size:90%;">, the server chooses a subset </span><math id="S2.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{S}_{t}\subseteq\mathcal{K}" display="inline"><semantics id="S2.p3.6.m6.1a"><mrow id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml"><msub id="S2.p3.6.m6.1.1.2" xref="S2.p3.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p3.6.m6.1.1.2.2" xref="S2.p3.6.m6.1.1.2.2.cmml">𝒮</mi><mi mathsize="90%" id="S2.p3.6.m6.1.1.2.3" xref="S2.p3.6.m6.1.1.2.3.cmml">t</mi></msub><mo mathsize="90%" id="S2.p3.6.m6.1.1.1" xref="S2.p3.6.m6.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.p3.6.m6.1.1.3" xref="S2.p3.6.m6.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><apply id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1"><subset id="S2.p3.6.m6.1.1.1.cmml" xref="S2.p3.6.m6.1.1.1"></subset><apply id="S2.p3.6.m6.1.1.2.cmml" xref="S2.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p3.6.m6.1.1.2.1.cmml" xref="S2.p3.6.m6.1.1.2">subscript</csymbol><ci id="S2.p3.6.m6.1.1.2.2.cmml" xref="S2.p3.6.m6.1.1.2.2">𝒮</ci><ci id="S2.p3.6.m6.1.1.2.3.cmml" xref="S2.p3.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S2.p3.6.m6.1.1.3.cmml" xref="S2.p3.6.m6.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">\mathcal{S}_{t}\subseteq\mathcal{K}</annotation></semantics></math><span id="S2.p3.8.7" class="ltx_text" style="font-size:90%;"> of the clients and then distributes the weights </span><math id="S2.p3.7.m7.1" class="ltx_Math" alttext="\bm{W}_{t-1}^{g}" display="inline"><semantics id="S2.p3.7.m7.1a"><msubsup id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml"><mi mathsize="90%" id="S2.p3.7.m7.1.1.2.2" xref="S2.p3.7.m7.1.1.2.2.cmml">𝑾</mi><mrow id="S2.p3.7.m7.1.1.2.3" xref="S2.p3.7.m7.1.1.2.3.cmml"><mi mathsize="90%" id="S2.p3.7.m7.1.1.2.3.2" xref="S2.p3.7.m7.1.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.p3.7.m7.1.1.2.3.1" xref="S2.p3.7.m7.1.1.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.p3.7.m7.1.1.2.3.3" xref="S2.p3.7.m7.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.p3.7.m7.1.1.3" xref="S2.p3.7.m7.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.1.cmml" xref="S2.p3.7.m7.1.1">superscript</csymbol><apply id="S2.p3.7.m7.1.1.2.cmml" xref="S2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.2.1.cmml" xref="S2.p3.7.m7.1.1">subscript</csymbol><ci id="S2.p3.7.m7.1.1.2.2.cmml" xref="S2.p3.7.m7.1.1.2.2">𝑾</ci><apply id="S2.p3.7.m7.1.1.2.3.cmml" xref="S2.p3.7.m7.1.1.2.3"><minus id="S2.p3.7.m7.1.1.2.3.1.cmml" xref="S2.p3.7.m7.1.1.2.3.1"></minus><ci id="S2.p3.7.m7.1.1.2.3.2.cmml" xref="S2.p3.7.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.p3.7.m7.1.1.2.3.3.cmml" xref="S2.p3.7.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S2.p3.7.m7.1.1.3.cmml" xref="S2.p3.7.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">\bm{W}_{t-1}^{g}</annotation></semantics></math><span id="S2.p3.8.8" class="ltx_text" style="font-size:90%;"> of the global model to the selected clients.
Then the selected clients synchronize their local models such that </span><math id="S2.p3.8.m8.1" class="ltx_Math" alttext="\bm{W}_{t-1}^{k}=\bm{W}_{t-1}^{g}" display="inline"><semantics id="S2.p3.8.m8.1a"><mrow id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><msubsup id="S2.p3.8.m8.1.1.2" xref="S2.p3.8.m8.1.1.2.cmml"><mi mathsize="90%" id="S2.p3.8.m8.1.1.2.2.2" xref="S2.p3.8.m8.1.1.2.2.2.cmml">𝑾</mi><mrow id="S2.p3.8.m8.1.1.2.2.3" xref="S2.p3.8.m8.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.p3.8.m8.1.1.2.2.3.2" xref="S2.p3.8.m8.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.p3.8.m8.1.1.2.2.3.1" xref="S2.p3.8.m8.1.1.2.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.p3.8.m8.1.1.2.2.3.3" xref="S2.p3.8.m8.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.p3.8.m8.1.1.2.3" xref="S2.p3.8.m8.1.1.2.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.p3.8.m8.1.1.1" xref="S2.p3.8.m8.1.1.1.cmml">=</mo><msubsup id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml"><mi mathsize="90%" id="S2.p3.8.m8.1.1.3.2.2" xref="S2.p3.8.m8.1.1.3.2.2.cmml">𝑾</mi><mrow id="S2.p3.8.m8.1.1.3.2.3" xref="S2.p3.8.m8.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.p3.8.m8.1.1.3.2.3.2" xref="S2.p3.8.m8.1.1.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.p3.8.m8.1.1.3.2.3.1" xref="S2.p3.8.m8.1.1.3.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.p3.8.m8.1.1.3.2.3.3" xref="S2.p3.8.m8.1.1.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.p3.8.m8.1.1.3.3" xref="S2.p3.8.m8.1.1.3.3.cmml">g</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><eq id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1.1"></eq><apply id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.2.1.cmml" xref="S2.p3.8.m8.1.1.2">superscript</csymbol><apply id="S2.p3.8.m8.1.1.2.2.cmml" xref="S2.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.2.2.1.cmml" xref="S2.p3.8.m8.1.1.2">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.2.2.cmml" xref="S2.p3.8.m8.1.1.2.2.2">𝑾</ci><apply id="S2.p3.8.m8.1.1.2.2.3.cmml" xref="S2.p3.8.m8.1.1.2.2.3"><minus id="S2.p3.8.m8.1.1.2.2.3.1.cmml" xref="S2.p3.8.m8.1.1.2.2.3.1"></minus><ci id="S2.p3.8.m8.1.1.2.2.3.2.cmml" xref="S2.p3.8.m8.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.p3.8.m8.1.1.2.2.3.3.cmml" xref="S2.p3.8.m8.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.p3.8.m8.1.1.2.3.cmml" xref="S2.p3.8.m8.1.1.2.3">𝑘</ci></apply><apply id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.3.1.cmml" xref="S2.p3.8.m8.1.1.3">superscript</csymbol><apply id="S2.p3.8.m8.1.1.3.2.cmml" xref="S2.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.3.2.1.cmml" xref="S2.p3.8.m8.1.1.3">subscript</csymbol><ci id="S2.p3.8.m8.1.1.3.2.2.cmml" xref="S2.p3.8.m8.1.1.3.2.2">𝑾</ci><apply id="S2.p3.8.m8.1.1.3.2.3.cmml" xref="S2.p3.8.m8.1.1.3.2.3"><minus id="S2.p3.8.m8.1.1.3.2.3.1.cmml" xref="S2.p3.8.m8.1.1.3.2.3.1"></minus><ci id="S2.p3.8.m8.1.1.3.2.3.2.cmml" xref="S2.p3.8.m8.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S2.p3.8.m8.1.1.3.2.3.3.cmml" xref="S2.p3.8.m8.1.1.3.2.3.3">1</cn></apply></apply><ci id="S2.p3.8.m8.1.1.3.3.cmml" xref="S2.p3.8.m8.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">\bm{W}_{t-1}^{k}=\bm{W}_{t-1}^{g}</annotation></semantics></math><span id="S2.p3.8.9" class="ltx_text" style="font-size:90%;">, and perform the following stochastic gradient descent (SGD) training as</span></p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\bm{W}_{t}^{k}=\bm{W}_{t-1}^{k}-\eta_{t}^{k}\nabla_{\bm{W}}L(\bm{W}_{t-1}^{k};\xi^{k})," display="inline"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.4.2.2" xref="S2.E2.m1.1.1.1.1.4.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.4.2.3" xref="S2.E2.m1.1.1.1.1.4.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.4.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><msubsup id="S2.E2.m1.1.1.1.1.2.4" xref="S2.E2.m1.1.1.1.1.2.4.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.4.2.2" xref="S2.E2.m1.1.1.1.1.2.4.2.2.cmml">𝑾</mi><mrow id="S2.E2.m1.1.1.1.1.2.4.2.3" xref="S2.E2.m1.1.1.1.1.2.4.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.4.2.3.2" xref="S2.E2.m1.1.1.1.1.2.4.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.2.4.2.3.1" xref="S2.E2.m1.1.1.1.1.2.4.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.E2.m1.1.1.1.1.2.4.2.3.3" xref="S2.E2.m1.1.1.1.1.2.4.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.4.3" xref="S2.E2.m1.1.1.1.1.2.4.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml"><msubsup id="S2.E2.m1.1.1.1.1.2.2.4" xref="S2.E2.m1.1.1.1.1.2.2.4.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.4.2.2" xref="S2.E2.m1.1.1.1.1.2.2.4.2.2.cmml">η</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.4.2.3" xref="S2.E2.m1.1.1.1.1.2.2.4.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.4.3" xref="S2.E2.m1.1.1.1.1.2.2.4.3.cmml">k</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S2.E2.m1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.5" xref="S2.E2.m1.1.1.1.1.2.2.5.cmml"><msub id="S2.E2.m1.1.1.1.1.2.2.5.1" xref="S2.E2.m1.1.1.1.1.2.2.5.1.cmml"><mo mathsize="90%" rspace="0.167em" id="S2.E2.m1.1.1.1.1.2.2.5.1.2" xref="S2.E2.m1.1.1.1.1.2.2.5.1.2.cmml">∇</mo><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.5.1.3" xref="S2.E2.m1.1.1.1.1.2.2.5.1.3.cmml">𝑾</mi></msub><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.5.2" xref="S2.E2.m1.1.1.1.1.2.2.5.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.2.2.3a" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2.m1.1.1.1.1.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.2.2.4" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml">;</mo><msup id="S2.E2.m1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml">ξ</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.3.cmml">k</mi></msup><mo maxsize="90%" minsize="90%" id="S2.E2.m1.1.1.1.1.2.2.2.2.5" xref="S2.E2.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"></eq><apply id="S2.E2.m1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.4">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.2.2">𝑾</ci><ci id="S2.E2.m1.1.1.1.1.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><minus id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3"></minus><apply id="S2.E2.m1.1.1.1.1.2.4.cmml" xref="S2.E2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.1.1.1.1.2.4">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2.2">𝑾</ci><apply id="S2.E2.m1.1.1.1.1.2.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2.3"><minus id="S2.E2.m1.1.1.1.1.2.4.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.2.4.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.2.4.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.4.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.2.4.3.cmml" xref="S2.E2.m1.1.1.1.1.2.4.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2"><times id="S2.E2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3"></times><apply id="S2.E2.m1.1.1.1.1.2.2.4.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.2.4.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4.2.2">𝜂</ci><ci id="S2.E2.m1.1.1.1.1.2.2.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.4.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.2.5.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5"><apply id="S2.E2.m1.1.1.1.1.2.2.5.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.5.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.5.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5.1.2">∇</ci><ci id="S2.E2.m1.1.1.1.1.2.2.5.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5.1.3">𝑾</ci></apply><ci id="S2.E2.m1.1.1.1.1.2.2.5.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.5.2">𝐿</ci></apply><list id="S2.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2">𝑾</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3"><minus id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.2">𝜉</ci><ci id="S2.E2.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\bm{W}_{t}^{k}=\bm{W}_{t-1}^{k}-\eta_{t}^{k}\nabla_{\bm{W}}L(\bm{W}_{t-1}^{k};\xi^{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p3.13" class="ltx_p"><span id="S2.p3.13.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.p3.9.m1.1" class="ltx_Math" alttext="\eta_{t}^{k}" display="inline"><semantics id="S2.p3.9.m1.1a"><msubsup id="S2.p3.9.m1.1.1" xref="S2.p3.9.m1.1.1.cmml"><mi mathsize="90%" id="S2.p3.9.m1.1.1.2.2" xref="S2.p3.9.m1.1.1.2.2.cmml">η</mi><mi mathsize="90%" id="S2.p3.9.m1.1.1.2.3" xref="S2.p3.9.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.p3.9.m1.1.1.3" xref="S2.p3.9.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.9.m1.1b"><apply id="S2.p3.9.m1.1.1.cmml" xref="S2.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m1.1.1.1.cmml" xref="S2.p3.9.m1.1.1">superscript</csymbol><apply id="S2.p3.9.m1.1.1.2.cmml" xref="S2.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m1.1.1.2.1.cmml" xref="S2.p3.9.m1.1.1">subscript</csymbol><ci id="S2.p3.9.m1.1.1.2.2.cmml" xref="S2.p3.9.m1.1.1.2.2">𝜂</ci><ci id="S2.p3.9.m1.1.1.2.3.cmml" xref="S2.p3.9.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.p3.9.m1.1.1.3.cmml" xref="S2.p3.9.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m1.1c">\eta_{t}^{k}</annotation></semantics></math><span id="S2.p3.13.2" class="ltx_text" style="font-size:90%;"> is the learning rate setting for device </span><math id="S2.p3.10.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p3.10.m2.1a"><mi mathsize="90%" id="S2.p3.10.m2.1.1" xref="S2.p3.10.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p3.10.m2.1b"><ci id="S2.p3.10.m2.1.1.cmml" xref="S2.p3.10.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m2.1c">k</annotation></semantics></math><span id="S2.p3.13.3" class="ltx_text" style="font-size:90%;"> in round </span><math id="S2.p3.11.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p3.11.m3.1a"><mi mathsize="90%" id="S2.p3.11.m3.1.1" xref="S2.p3.11.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p3.11.m3.1b"><ci id="S2.p3.11.m3.1.1.cmml" xref="S2.p3.11.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m3.1c">t</annotation></semantics></math><span id="S2.p3.13.4" class="ltx_text" style="font-size:90%;">, </span><math id="S2.p3.12.m4.1" class="ltx_Math" alttext="\xi^{k}" display="inline"><semantics id="S2.p3.12.m4.1a"><msup id="S2.p3.12.m4.1.1" xref="S2.p3.12.m4.1.1.cmml"><mi mathsize="90%" id="S2.p3.12.m4.1.1.2" xref="S2.p3.12.m4.1.1.2.cmml">ξ</mi><mi mathsize="90%" id="S2.p3.12.m4.1.1.3" xref="S2.p3.12.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p3.12.m4.1b"><apply id="S2.p3.12.m4.1.1.cmml" xref="S2.p3.12.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.12.m4.1.1.1.cmml" xref="S2.p3.12.m4.1.1">superscript</csymbol><ci id="S2.p3.12.m4.1.1.2.cmml" xref="S2.p3.12.m4.1.1.2">𝜉</ci><ci id="S2.p3.12.m4.1.1.3.cmml" xref="S2.p3.12.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.12.m4.1c">\xi^{k}</annotation></semantics></math><span id="S2.p3.13.5" class="ltx_text" style="font-size:90%;"> is an example sampled from local dataset in device </span><math id="S2.p3.13.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p3.13.m5.1a"><mi mathsize="90%" id="S2.p3.13.m5.1.1" xref="S2.p3.13.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p3.13.m5.1b"><ci id="S2.p3.13.m5.1.1.cmml" xref="S2.p3.13.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.13.m5.1c">k</annotation></semantics></math><span id="S2.p3.13.6" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.3" class="ltx_p"><span id="S2.p4.3.1" class="ltx_text" style="font-size:90%;">Once </span><math id="S2.p4.1.m1.1" class="ltx_Math" alttext="\bm{W}_{t}^{k}" display="inline"><semantics id="S2.p4.1.m1.1a"><msubsup id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.p4.1.m1.1.1.2.2" xref="S2.p4.1.m1.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.p4.1.m1.1.1.2.3" xref="S2.p4.1.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">superscript</csymbol><apply id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.2.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.2.cmml" xref="S2.p4.1.m1.1.1.2.2">𝑾</ci><ci id="S2.p4.1.m1.1.1.2.3.cmml" xref="S2.p4.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\bm{W}_{t}^{k}</annotation></semantics></math><span id="S2.p4.3.2" class="ltx_text" style="font-size:90%;"> is obtained, each participating device </span><math id="S2.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p4.2.m2.1a"><mi mathsize="90%" id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">k</annotation></semantics></math><span id="S2.p4.3.3" class="ltx_text" style="font-size:90%;"> updates its own model weight difference </span><math id="S2.p4.3.m3.1" class="ltx_Math" alttext="\Delta_{t}^{k}" display="inline"><semantics id="S2.p4.3.m3.1a"><msubsup id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="S2.p4.3.m3.1.1.2.2" xref="S2.p4.3.m3.1.1.2.2.cmml">Δ</mi><mi mathsize="90%" id="S2.p4.3.m3.1.1.2.3" xref="S2.p4.3.m3.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1">superscript</csymbol><apply id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.2.1.cmml" xref="S2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.p4.3.m3.1.1.2.2.cmml" xref="S2.p4.3.m3.1.1.2.2">Δ</ci><ci id="S2.p4.3.m3.1.1.2.3.cmml" xref="S2.p4.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">\Delta_{t}^{k}</annotation></semantics></math><span id="S2.p4.3.4" class="ltx_text" style="font-size:90%;"> to the global server, which is defined as</span></p>
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\Delta_{t}^{k}=\bm{W}_{t}^{k}-\bm{W}_{t-1}^{k}." display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msubsup id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml"><mi mathsize="90%" mathvariant="normal" id="S2.E3.m1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.cmml">Δ</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><msubsup id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.2.2.2" xref="S2.E3.m1.1.1.1.1.3.2.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.2.2.3" xref="S2.E3.m1.1.1.1.1.3.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.1.3.2.3.cmml">k</mi></msubsup><mo mathsize="90%" id="S2.E3.m1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.3.1.cmml">−</mo><msubsup id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.3.2.2" xref="S2.E3.m1.1.1.1.1.3.3.2.2.cmml">𝑾</mi><mrow id="S2.E3.m1.1.1.1.1.3.3.2.3" xref="S2.E3.m1.1.1.1.1.3.3.2.3.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.3.2.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E3.m1.1.1.1.1.3.3.2.3.1" xref="S2.E3.m1.1.1.1.1.3.3.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.E3.m1.1.1.1.1.3.3.2.3.3" xref="S2.E3.m1.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"></eq><apply id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2">Δ</ci><ci id="S2.E3.m1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><minus id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1"></minus><apply id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2.2.2">𝑾</ci><ci id="S2.E3.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2.2">𝑾</ci><apply id="S2.E3.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2.3"><minus id="S2.E3.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2.3.1"></minus><ci id="S2.E3.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\Delta_{t}^{k}=\bm{W}_{t}^{k}-\bm{W}_{t-1}^{k}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.p4.4" class="ltx_p"><span id="S2.p4.4.1" class="ltx_text" style="font-size:90%;">When the global server collects all the updates from client devices, it performs the FedAvg algorithm to update the global model as follows </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p4.4.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S2.p4.4.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p4.4.4" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\Delta_{t}^{g}" display="inline"><semantics id="S2.E4.m1.1a"><msubsup id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="S2.E4.m1.1.1.2.2" xref="S2.E4.m1.1.1.2.2.cmml">Δ</mi><mi mathsize="90%" id="S2.E4.m1.1.1.2.3" xref="S2.E4.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">superscript</csymbol><apply id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.2.2">Δ</ci><ci id="S2.E4.m1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\Delta_{t}^{g}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{k\in\mathcal{S}_{t}}\frac{n_{k}}{\sum_{k^{\prime}=1}^{K}n_{k^{\prime}}}\Delta_{t}^{k}," display="inline"><semantics id="S2.E4.m2.1a"><mrow id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.2.cmml"></mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E4.m2.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E4.m2.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.3.1.cmml"><munder id="S2.E4.m2.1.1.1.1.3.1a" xref="S2.E4.m2.1.1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E4.m2.1.1.1.1.3.1.2" xref="S2.E4.m2.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S2.E4.m2.1.1.1.1.3.1.3" xref="S2.E4.m2.1.1.1.1.3.1.3.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.1.3.2" xref="S2.E4.m2.1.1.1.1.3.1.3.2.cmml">k</mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.3.1.3.1" xref="S2.E4.m2.1.1.1.1.3.1.3.1.cmml">∈</mo><msub id="S2.E4.m2.1.1.1.1.3.1.3.3" xref="S2.E4.m2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E4.m2.1.1.1.1.3.1.3.3.2" xref="S2.E4.m2.1.1.1.1.3.1.3.3.2.cmml">𝒮</mi><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.1.3.3.3" xref="S2.E4.m2.1.1.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></munder></mstyle><mrow id="S2.E4.m2.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.E4.m2.1.1.1.1.3.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.cmml"><mfrac id="S2.E4.m2.1.1.1.1.3.2.2a" xref="S2.E4.m2.1.1.1.1.3.2.2.cmml"><msub id="S2.E4.m2.1.1.1.1.3.2.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.2.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.2.3" xref="S2.E4.m2.1.1.1.1.3.2.2.2.3.cmml">k</mi></msub><mrow id="S2.E4.m2.1.1.1.1.3.2.2.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.cmml"><msubsup id="S2.E4.m2.1.1.1.1.3.2.2.3.1" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.cmml"><msup id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.2.cmml">k</mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.3.cmml">′</mo></msup><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.1" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.3.cmml">K</mi></msubsup><msub id="S2.E4.m2.1.1.1.1.3.2.2.3.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.2.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.2.cmml">n</mi><msup id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.2" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.2.cmml">k</mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.3" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.3.cmml">′</mo></msup></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.3.2.1" xref="S2.E4.m2.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E4.m2.1.1.1.1.3.2.3" xref="S2.E4.m2.1.1.1.1.3.2.3.cmml"><mi mathsize="90%" mathvariant="normal" id="S2.E4.m2.1.1.1.1.3.2.3.2.2" xref="S2.E4.m2.1.1.1.1.3.2.3.2.2.cmml">Δ</mi><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.3.2.3" xref="S2.E4.m2.1.1.1.1.3.2.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.3.2.3.3" xref="S2.E4.m2.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo mathsize="90%" id="S2.E4.m2.1.1.1.2" xref="S2.E4.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.1b"><apply id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1"><eq id="S2.E4.m2.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E4.m2.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3"><apply id="S2.E4.m2.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.1.1.cmml" xref="S2.E4.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E4.m2.1.1.1.1.3.1.2.cmml" xref="S2.E4.m2.1.1.1.1.3.1.2"></sum><apply id="S2.E4.m2.1.1.1.1.3.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3"><in id="S2.E4.m2.1.1.1.1.3.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.1"></in><ci id="S2.E4.m2.1.1.1.1.3.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S2.E4.m2.1.1.1.1.3.1.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.1.3.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.1.3.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.3.2">𝒮</ci><ci id="S2.E4.m2.1.1.1.1.3.1.3.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E4.m2.1.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2"><times id="S2.E4.m2.1.1.1.1.3.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.1"></times><apply id="S2.E4.m2.1.1.1.1.3.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2"><divide id="S2.E4.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2"></divide><apply id="S2.E4.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S2.E4.m2.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3"><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1">superscript</csymbol><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1">subscript</csymbol><sum id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.2"></sum><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3"><eq id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.1"></eq><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2">superscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.2">𝑘</ci><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.2.3">′</ci></apply><cn type="integer" id="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.1.3">𝐾</ci></apply><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.3.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.2">𝑛</ci><apply id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3">superscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.2">𝑘</ci><ci id="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.2.3.2.3.3">′</ci></apply></apply></apply></apply><apply id="S2.E4.m2.1.1.1.1.3.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3">superscript</csymbol><apply id="S2.E4.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.2.3.2.1.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.2.3.2.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3.2.2">Δ</ci><ci id="S2.E4.m2.1.1.1.1.3.2.3.2.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3.2.3">𝑡</ci></apply><ci id="S2.E4.m2.1.1.1.1.3.2.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.1c">\displaystyle=\sum_{k\in\mathcal{S}_{t}}\frac{n_{k}}{\sum_{k^{\prime}=1}^{K}n_{k^{\prime}}}\Delta_{t}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\displaystyle\bm{W}_{t}^{g}" display="inline"><semantics id="S2.E5.m1.1a"><msubsup id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mi mathsize="90%" id="S2.E5.m1.1.1.2.2" xref="S2.E5.m1.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E5.m1.1.1.2.3" xref="S2.E5.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1">superscript</csymbol><apply id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.2.1.cmml" xref="S2.E5.m1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.2.2">𝑾</ci><ci id="S2.E5.m1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\bm{W}_{t}^{g}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.1" class="ltx_Math" alttext="\displaystyle\leftarrow\bm{W}_{t-1}^{g}+\Delta_{t}^{g}." display="inline"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml"></mi><mo mathsize="90%" stretchy="false" id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml">←</mo><mrow id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml"><msubsup id="S2.E5.m2.1.1.1.1.3.2" xref="S2.E5.m2.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.3.2.2.2" xref="S2.E5.m2.1.1.1.1.3.2.2.2.cmml">𝑾</mi><mrow id="S2.E5.m2.1.1.1.1.3.2.2.3" xref="S2.E5.m2.1.1.1.1.3.2.2.3.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.3.2.2.3.2" xref="S2.E5.m2.1.1.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.3.2.2.3.1" xref="S2.E5.m2.1.1.1.1.3.2.2.3.1.cmml">−</mo><mn mathsize="90%" id="S2.E5.m2.1.1.1.1.3.2.2.3.3" xref="S2.E5.m2.1.1.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.3.2.3" xref="S2.E5.m2.1.1.1.1.3.2.3.cmml">g</mi></msubsup><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.3.1" xref="S2.E5.m2.1.1.1.1.3.1.cmml">+</mo><msubsup id="S2.E5.m2.1.1.1.1.3.3" xref="S2.E5.m2.1.1.1.1.3.3.cmml"><mi mathsize="90%" mathvariant="normal" id="S2.E5.m2.1.1.1.1.3.3.2.2" xref="S2.E5.m2.1.1.1.1.3.3.2.2.cmml">Δ</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.3.3.2.3" xref="S2.E5.m2.1.1.1.1.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.3.3.3" xref="S2.E5.m2.1.1.1.1.3.3.3.cmml">g</mi></msubsup></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><ci id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1">←</ci><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"><plus id="S2.E5.m2.1.1.1.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.1"></plus><apply id="S2.E5.m2.1.1.1.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2.2">𝑾</ci><apply id="S2.E5.m2.1.1.1.1.3.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2.3"><minus id="S2.E5.m2.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2.3.1"></minus><ci id="S2.E5.m2.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E5.m2.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S2.E5.m2.1.1.1.1.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.3.2.3">𝑔</ci></apply><apply id="S2.E5.m2.1.1.1.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.3.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.3.3.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.3.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.3.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.3.3.2.2">Δ</ci><ci id="S2.E5.m2.1.1.1.1.3.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S2.E5.m2.1.1.1.1.3.3.3.cmml" xref="S2.E5.m2.1.1.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle\leftarrow\bm{W}_{t-1}^{g}+\Delta_{t}^{g}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text" style="font-size:90%;">When the data and label distribution on different devices are IID, FedAvg has been shown to perform well approximating the model trained on centrally data </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S2.p5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p5.1.4" class="ltx_text" style="font-size:90%;">.
However, in practice, data owned by each device are typically non-IID, i.e., the data distributions of clients vary from different devices due to different user preferences and usage patterns.
When data distributions are non-IID, FedAvg algorithm is unstable and may even diverge </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p5.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a><span id="S2.p5.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p5.1.7" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text" style="font-size:90%;">The problem arises by the inconsistency between the locally performed SGD algorithm, which aims to minimize the loss value on local samples on each device and the global objective of minimizing the overall loss on server data samples.
Since the training model is fitted on different devices to heterogeneous local data, the divergence among the weights </span><math id="S2.p6.1.m1.1" class="ltx_Math" alttext="\bm{W}^{k}" display="inline"><semantics id="S2.p6.1.m1.1a"><msup id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">superscript</csymbol><ci id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2">𝑾</ci><ci id="S2.p6.1.m1.1.1.3.cmml" xref="S2.p6.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\bm{W}^{k}</annotation></semantics></math><span id="S2.p6.1.2" class="ltx_text" style="font-size:90%;"> of these local models will be accumulated and eventually degrades the performance of the learning process </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.p6.1.3.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S2.p6.1.4.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.p6.1.5" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2011.11266/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_img_landscape" width="147" height="82" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.4.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>An illustration of FL procedure.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">3 </span>Online Learning Algorithm for Client selection</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p"><span id="S3.p1.1.1" class="ltx_text" style="font-size:90%;">In this section, we first discuss the approach to estimate the class imbalance of each training client.
Then we propose an online learning algorithm to find the most balanced clients set.</span></p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Class Estimation Scheme</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text" style="font-size:90%;">In FL settings, the raw data of clients could not be obtained due to privacy concerns.
However, with the help of the following scheme, we can reveal the class distribution of client services according to their updated gradients.</span></p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.2" class="ltx_p"><span id="S3.SS1.p2.2.1" class="ltx_text" style="font-size:90%;">Consider a DNN contains an input layer, a hidden layer and an output layer.
Note that in DNN for the classification problem, the scale of the output layer is equal to the size of class label.
That is, each neuron of the output layer corresponding to a class label.
Let </span><math id="S3.SS1.p2.1.m1.4" class="ltx_Math" alttext="\bm{\mathcal{W}}=[\bm{w}_{1},\bm{w}_{2},...,\bm{w}_{C}]" display="inline"><semantics id="S3.SS1.p2.1.m1.4a"><mrow id="S3.SS1.p2.1.m1.4.4" xref="S3.SS1.p2.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS1.p2.1.m1.4.4.5" xref="S3.SS1.p2.1.m1.4.4.5.cmml">𝓦</mi><mo mathsize="90%" id="S3.SS1.p2.1.m1.4.4.4" xref="S3.SS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.4.4.3.3" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml"><mo maxsize="90%" minsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.4" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p2.1.m1.2.2.1.1.1" xref="S3.SS1.p2.1.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p2.1.m1.2.2.1.1.1.2" xref="S3.SS1.p2.1.m1.2.2.1.1.1.2.cmml">𝒘</mi><mn mathsize="90%" id="S3.SS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.5" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.1.m1.3.3.2.2.2" xref="S3.SS1.p2.1.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="S3.SS1.p2.1.m1.3.3.2.2.2.2" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2.cmml">𝒘</mi><mn mathsize="90%" id="S3.SS1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo mathsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.6" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">…</mi><mo mathsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.7" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.1.m1.4.4.3.3.3" xref="S3.SS1.p2.1.m1.4.4.3.3.3.cmml"><mi mathsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.3.2" xref="S3.SS1.p2.1.m1.4.4.3.3.3.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3.cmml">C</mi></msub><mo maxsize="90%" minsize="90%" id="S3.SS1.p2.1.m1.4.4.3.3.8" xref="S3.SS1.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.4b"><apply id="S3.SS1.p2.1.m1.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4"><eq id="S3.SS1.p2.1.m1.4.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4.4"></eq><ci id="S3.SS1.p2.1.m1.4.4.5.cmml" xref="S3.SS1.p2.1.m1.4.4.5">𝓦</ci><list id="S3.SS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3"><apply id="S3.SS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.2">𝒘</ci><cn type="integer" id="S3.SS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="S3.SS1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">…</ci><apply id="S3.SS1.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.2">𝒘</ci><ci id="S3.SS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.4.4.3.3.3.3">𝐶</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.4c">\bm{\mathcal{W}}=[\bm{w}_{1},\bm{w}_{2},...,\bm{w}_{C}]</annotation></semantics></math><span id="S3.SS1.p2.2.2" class="ltx_text" style="font-size:90%;"> denotes the weights between hidden layer and output layer. Every element of </span><math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\bm{\mathcal{W}}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">𝓦</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝓦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\bm{\mathcal{W}}</annotation></semantics></math><span id="S3.SS1.p2.2.3" class="ltx_text" style="font-size:90%;"> denote the weights connect hidden layer to the specific neuron of output layer.</span></p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text" style="font-size:90%;">Without loss of generality, we assume there exists a balanced auxiliary dataset with </span><math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi mathsize="90%" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">C</annotation></semantics></math><span id="S3.SS1.p3.1.2" class="ltx_text" style="font-size:90%;"> classes in global server.
Such auxiliary dataset only consists of a few data samples and can be extracted from the test dataset.
When the auxiliary data examples are fed to the updated model, we can obtain the gradients vector brought by auxiliary data with respect to the corresponding classes. The gradients vector brought by auxiliary data can be expressed as
</span></p>
<table id="S5.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.2" class="ltx_Math" alttext="\displaystyle\Big{\{}\nabla L^{\textit{aux}}(\bm{w}_{1}),\nabla L^{\textit{aux}}(\bm{w}_{2}),...,\nabla L^{\textit{aux}}(\bm{w}_{C})\Big{\}}," display="inline"><semantics id="S3.Ex2.m1.2a"><mrow id="S3.Ex2.m1.2.2.1"><mrow id="S3.Ex2.m1.2.2.1.1.3" xref="S3.Ex2.m1.2.2.1.1.4.cmml"><mo maxsize="160%" minsize="160%" id="S3.Ex2.m1.2.2.1.1.3.4" xref="S3.Ex2.m1.2.2.1.1.4.cmml">{</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.2.2.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.Ex2.m1.2.2.1.1.1.1.3.1" xref="S3.Ex2.m1.2.2.1.1.1.1.3.1.cmml">∇</mo><msup id="S3.Ex2.m1.2.2.1.1.1.1.3.2" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.3.2.2" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.3.2.3" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mn mathsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.5" xref="S3.Ex2.m1.2.2.1.1.4.cmml">,</mo><mrow id="S3.Ex2.m1.2.2.1.1.2.2" xref="S3.Ex2.m1.2.2.1.1.2.2.cmml"><mrow id="S3.Ex2.m1.2.2.1.1.2.2.3" xref="S3.Ex2.m1.2.2.1.1.2.2.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.Ex2.m1.2.2.1.1.2.2.3.1" xref="S3.Ex2.m1.2.2.1.1.2.2.3.1.cmml">∇</mo><msup id="S3.Ex2.m1.2.2.1.1.2.2.3.2" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.3.2.2" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.3.2.3" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.2.2.2" xref="S3.Ex2.m1.2.2.1.1.2.2.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.1.1.2.2.1.1" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.2" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.cmml">(</mo><msub id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.2.cmml">𝒘</mi><mn mathsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.3" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.6" xref="S3.Ex2.m1.2.2.1.1.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">…</mi><mo mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.7" xref="S3.Ex2.m1.2.2.1.1.4.cmml">,</mo><mrow id="S3.Ex2.m1.2.2.1.1.3.3" xref="S3.Ex2.m1.2.2.1.1.3.3.cmml"><mrow id="S3.Ex2.m1.2.2.1.1.3.3.3" xref="S3.Ex2.m1.2.2.1.1.3.3.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.Ex2.m1.2.2.1.1.3.3.3.1" xref="S3.Ex2.m1.2.2.1.1.3.3.3.1.cmml">∇</mo><msup id="S3.Ex2.m1.2.2.1.1.3.3.3.2" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.3.2.2" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.3.2.3" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.3.3.2" xref="S3.Ex2.m1.2.2.1.1.3.3.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.1.1.3.3.1.1" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.1.1.2" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.cmml">(</mo><msub id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.cmml"><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.3.cmml">C</mi></msub><mo maxsize="90%" minsize="90%" id="S3.Ex2.m1.2.2.1.1.3.3.1.1.3" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="160%" minsize="160%" id="S3.Ex2.m1.2.2.1.1.3.8" xref="S3.Ex2.m1.2.2.1.1.4.cmml">}</mo></mrow><mo mathsize="90%" id="S3.Ex2.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.2b"><set id="S3.Ex2.m1.2.2.1.1.4.cmml" xref="S3.Ex2.m1.2.2.1.1.3"><apply id="S3.Ex2.m1.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1"><times id="S3.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.2"></times><apply id="S3.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3"><ci id="S3.Ex2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.1">∇</ci><apply id="S3.Ex2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.Ex2.m1.2.2.1.1.1.1.3.2.3a.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="63%" id="S3.Ex2.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2">𝒘</ci><cn type="integer" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2"><times id="S3.Ex2.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.2"></times><apply id="S3.Ex2.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3"><ci id="S3.Ex2.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.1">∇</ci><apply id="S3.Ex2.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.2">𝐿</ci><ci id="S3.Ex2.m1.2.2.1.1.2.2.3.2.3a.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="63%" id="S3.Ex2.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.2">𝒘</ci><cn type="integer" id="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.2.2.1.1.1.3">2</cn></apply></apply><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">…</ci><apply id="S3.Ex2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3"><times id="S3.Ex2.m1.2.2.1.1.3.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.2"></times><apply id="S3.Ex2.m1.2.2.1.1.3.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3"><ci id="S3.Ex2.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.1">∇</ci><apply id="S3.Ex2.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.3.3.3.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.3.3.3.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.2">𝐿</ci><ci id="S3.Ex2.m1.2.2.1.1.3.3.3.2.3a.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="63%" id="S3.Ex2.m1.2.2.1.1.3.3.3.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.2">𝒘</ci><ci id="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3.1.1.1.3">𝐶</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.2c">\displaystyle\Big{\{}\nabla L^{\textit{aux}}(\bm{w}_{1}),\nabla L^{\textit{aux}}(\bm{w}_{2}),...,\nabla L^{\textit{aux}}(\bm{w}_{C})\Big{\}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.4" class="ltx_p"><span id="S3.SS1.p3.4.1" class="ltx_text" style="font-size:90%;">where each </span><math id="S3.SS1.p3.2.m1.1" class="ltx_Math" alttext="\nabla L^{\textit{aux}}(\bm{w}_{i})" display="inline"><semantics id="S3.SS1.p3.2.m1.1a"><mrow id="S3.SS1.p3.2.m1.1.1" xref="S3.SS1.p3.2.m1.1.1.cmml"><mrow id="S3.SS1.p3.2.m1.1.1.3" xref="S3.SS1.p3.2.m1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.SS1.p3.2.m1.1.1.3.1" xref="S3.SS1.p3.2.m1.1.1.3.1.cmml">∇</mo><msup id="S3.SS1.p3.2.m1.1.1.3.2" xref="S3.SS1.p3.2.m1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.SS1.p3.2.m1.1.1.3.2.2" xref="S3.SS1.p3.2.m1.1.1.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.SS1.p3.2.m1.1.1.3.2.3" xref="S3.SS1.p3.2.m1.1.1.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m1.1.1.2" xref="S3.SS1.p3.2.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p3.2.m1.1.1.1.1" xref="S3.SS1.p3.2.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.SS1.p3.2.m1.1.1.1.1.2" xref="S3.SS1.p3.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.2.m1.1.1.1.1.1" xref="S3.SS1.p3.2.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p3.2.m1.1.1.1.1.1.2" xref="S3.SS1.p3.2.m1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.SS1.p3.2.m1.1.1.1.1.1.3" xref="S3.SS1.p3.2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.SS1.p3.2.m1.1.1.1.1.3" xref="S3.SS1.p3.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m1.1b"><apply id="S3.SS1.p3.2.m1.1.1.cmml" xref="S3.SS1.p3.2.m1.1.1"><times id="S3.SS1.p3.2.m1.1.1.2.cmml" xref="S3.SS1.p3.2.m1.1.1.2"></times><apply id="S3.SS1.p3.2.m1.1.1.3.cmml" xref="S3.SS1.p3.2.m1.1.1.3"><ci id="S3.SS1.p3.2.m1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m1.1.1.3.1">∇</ci><apply id="S3.SS1.p3.2.m1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m1.1.1.3.2.1.cmml" xref="S3.SS1.p3.2.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p3.2.m1.1.1.3.2.2.cmml" xref="S3.SS1.p3.2.m1.1.1.3.2.2">𝐿</ci><ci id="S3.SS1.p3.2.m1.1.1.3.2.3a.cmml" xref="S3.SS1.p3.2.m1.1.1.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="63%" id="S3.SS1.p3.2.m1.1.1.3.2.3.cmml" xref="S3.SS1.p3.2.m1.1.1.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.SS1.p3.2.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m1.1.1.1.1.1.2">𝒘</ci><ci id="S3.SS1.p3.2.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m1.1c">\nabla L^{\textit{aux}}(\bm{w}_{i})</annotation></semantics></math><span id="S3.SS1.p3.4.2" class="ltx_text" style="font-size:90%;"> is related to the </span><math id="S3.SS1.p3.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p3.3.m2.1a"><mi mathsize="90%" id="S3.SS1.p3.3.m2.1.1" xref="S3.SS1.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m2.1b"><ci id="S3.SS1.p3.3.m2.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m2.1c">i</annotation></semantics></math><span id="S3.SS1.p3.4.3" class="ltx_text" style="font-size:90%;">th neuron and class </span><math id="S3.SS1.p3.4.m3.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS1.p3.4.m3.1a"><msub id="S3.SS1.p3.4.m3.1.1" xref="S3.SS1.p3.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS1.p3.4.m3.1.1.2" xref="S3.SS1.p3.4.m3.1.1.2.cmml">𝒞</mi><mi mathsize="90%" id="S3.SS1.p3.4.m3.1.1.3" xref="S3.SS1.p3.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m3.1b"><apply id="S3.SS1.p3.4.m3.1.1.cmml" xref="S3.SS1.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m3.1.1.1.cmml" xref="S3.SS1.p3.4.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m3.1.1.2.cmml" xref="S3.SS1.p3.4.m3.1.1.2">𝒞</ci><ci id="S3.SS1.p3.4.m3.1.1.3.cmml" xref="S3.SS1.p3.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m3.1c">\mathcal{C}_{i}</annotation></semantics></math><span id="S3.SS1.p3.4.4" class="ltx_text" style="font-size:90%;">.
The following theorem can help to obtain the class distribution from the above gradients vector.</span></p>
</div>
<div id="Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem" style="font-size:90%;">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem 1</span></span><span id="Thmtheorem1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem1.p1" class="ltx_para">
<p id="Thmtheorem1.p1.8" class="ltx_p"><span id="Thmtheorem1.p1.8.1" class="ltx_text ltx_font_italic" style="font-size:90%;">When training DNN in classification problem, the expectations of gradient square for different classes have the following approximate relation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>:</span></p>
<table id="S5.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\displaystyle\frac{E||\nabla L(\bm{w}_{i})||^{2}}{E||\nabla L(\bm{w}j)||^{2}}\approx\frac{n_{i}^{2}}{n_{j}^{2}}," display="inline"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mfrac id="S3.E6.m1.2.2a" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">​</mo><msup id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E6.m1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.cmml">∇</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">2</mn></msup></mrow><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mi mathsize="90%" id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">​</mo><msup id="S3.E6.m1.2.2.2.1" xref="S3.E6.m1.2.2.2.1.cmml"><mrow id="S3.E6.m1.2.2.2.1.1.1" xref="S3.E6.m1.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E6.m1.2.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E6.m1.2.2.2.1.1.1.1.3.1" xref="S3.E6.m1.2.2.2.1.1.1.1.3.1.cmml">∇</mo><mi mathsize="90%" id="S3.E6.m1.2.2.2.1.1.1.1.3.2" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></mrow><mo maxsize="90%" minsize="90%" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.2.2.2.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S3.E6.m1.2.2.2.1.3" xref="S3.E6.m1.2.2.2.1.3.cmml">2</mn></msup></mrow></mfrac></mstyle><mo mathsize="90%" id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml">≈</mo><mstyle displaystyle="true" id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mfrac id="S3.E6.m1.3.3.1.1.2a" xref="S3.E6.m1.3.3.1.1.2.cmml"><msubsup id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.cmml"><mi mathsize="90%" id="S3.E6.m1.3.3.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="S3.E6.m1.3.3.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.3.cmml">i</mi><mn mathsize="90%" id="S3.E6.m1.3.3.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">2</mn></msubsup><msubsup id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E6.m1.3.3.1.1.2.3.2.2" xref="S3.E6.m1.3.3.1.1.2.3.2.2.cmml">n</mi><mi mathsize="90%" id="S3.E6.m1.3.3.1.1.2.3.2.3" xref="S3.E6.m1.3.3.1.1.2.3.2.3.cmml">j</mi><mn mathsize="90%" id="S3.E6.m1.3.3.1.1.2.3.3" xref="S3.E6.m1.3.3.1.1.2.3.3.cmml">2</mn></msubsup></mfrac></mstyle></mrow><mo mathsize="90%" id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><approx id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"></approx><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2"></divide><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">𝐸</ci><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3"><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1">∇</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2">𝐿</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2"></times><ci id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3">𝐸</ci><apply id="S3.E6.m1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.2.cmml" xref="S3.E6.m1.2.2.2.1">superscript</csymbol><apply id="S3.E6.m1.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1"><times id="S3.E6.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2"></times><apply id="S3.E6.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3"><ci id="S3.E6.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.1">∇</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2">𝐿</ci></apply><apply id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1"><times id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.1"></times><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S3.E6.m1.2.2.2.1.3.cmml" xref="S3.E6.m1.2.2.2.1.3">2</cn></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><divide id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2"></divide><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2">𝑛</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3">2</cn></apply><apply id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.3">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.3.2.2">𝑛</ci><ci id="S3.E6.m1.3.3.1.1.2.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3.2.3">𝑗</ci></apply><cn type="integer" id="S3.E6.m1.3.3.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\displaystyle\frac{E||\nabla L(\bm{w}_{i})||^{2}}{E||\nabla L(\bm{w}j)||^{2}}\approx\frac{n_{i}^{2}}{n_{j}^{2}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Thmtheorem1.p1.7" class="ltx_p"><span id="Thmtheorem1.p1.7.7" class="ltx_text ltx_font_italic" style="font-size:90%;">where <math id="Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mi id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><ci id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">L</annotation></semantics></math> denotes the cost function of the neural network, <math id="Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><msub id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.2.cmml">n</mi><mi id="Thmtheorem1.p1.2.2.m2.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2">𝑛</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">n_{i}</annotation></semantics></math> and <math id="Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="n_{j}" display="inline"><semantics id="Thmtheorem1.p1.3.3.m3.1a"><msub id="Thmtheorem1.p1.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.2" xref="Thmtheorem1.p1.3.3.m3.1.1.2.cmml">n</mi><mi id="Thmtheorem1.p1.3.3.m3.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.m3.1b"><apply id="Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.2">𝑛</ci><ci id="Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.m3.1c">n_{j}</annotation></semantics></math> are the number of samples for class <math id="Thmtheorem1.p1.4.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Thmtheorem1.p1.4.4.m4.1a"><mi id="Thmtheorem1.p1.4.4.m4.1.1" xref="Thmtheorem1.p1.4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.4.4.m4.1b"><ci id="Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.4.4.m4.1c">i</annotation></semantics></math> and class <math id="Thmtheorem1.p1.5.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Thmtheorem1.p1.5.5.m5.1a"><mi id="Thmtheorem1.p1.5.5.m5.1.1" xref="Thmtheorem1.p1.5.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.5.5.m5.1b"><ci id="Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.5.5.m5.1c">j</annotation></semantics></math> , respectively, where <math id="Thmtheorem1.p1.6.6.m6.1" class="ltx_Math" alttext="i\neq j" display="inline"><semantics id="Thmtheorem1.p1.6.6.m6.1a"><mrow id="Thmtheorem1.p1.6.6.m6.1.1" xref="Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="Thmtheorem1.p1.6.6.m6.1.1.2" xref="Thmtheorem1.p1.6.6.m6.1.1.2.cmml">i</mi><mo id="Thmtheorem1.p1.6.6.m6.1.1.1" xref="Thmtheorem1.p1.6.6.m6.1.1.1.cmml">≠</mo><mi id="Thmtheorem1.p1.6.6.m6.1.1.3" xref="Thmtheorem1.p1.6.6.m6.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.6.6.m6.1b"><apply id="Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="Thmtheorem1.p1.6.6.m6.1.1"><neq id="Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="Thmtheorem1.p1.6.6.m6.1.1.1"></neq><ci id="Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="Thmtheorem1.p1.6.6.m6.1.1.2">𝑖</ci><ci id="Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="Thmtheorem1.p1.6.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.6.6.m6.1c">i\neq j</annotation></semantics></math> and <math id="Thmtheorem1.p1.7.7.m7.2" class="ltx_Math" alttext="i,j\in\mathcal{C}" display="inline"><semantics id="Thmtheorem1.p1.7.7.m7.2a"><mrow id="Thmtheorem1.p1.7.7.m7.2.3" xref="Thmtheorem1.p1.7.7.m7.2.3.cmml"><mrow id="Thmtheorem1.p1.7.7.m7.2.3.2.2" xref="Thmtheorem1.p1.7.7.m7.2.3.2.1.cmml"><mi id="Thmtheorem1.p1.7.7.m7.1.1" xref="Thmtheorem1.p1.7.7.m7.1.1.cmml">i</mi><mo id="Thmtheorem1.p1.7.7.m7.2.3.2.2.1" xref="Thmtheorem1.p1.7.7.m7.2.3.2.1.cmml">,</mo><mi id="Thmtheorem1.p1.7.7.m7.2.2" xref="Thmtheorem1.p1.7.7.m7.2.2.cmml">j</mi></mrow><mo id="Thmtheorem1.p1.7.7.m7.2.3.1" xref="Thmtheorem1.p1.7.7.m7.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Thmtheorem1.p1.7.7.m7.2.3.3" xref="Thmtheorem1.p1.7.7.m7.2.3.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.7.7.m7.2b"><apply id="Thmtheorem1.p1.7.7.m7.2.3.cmml" xref="Thmtheorem1.p1.7.7.m7.2.3"><in id="Thmtheorem1.p1.7.7.m7.2.3.1.cmml" xref="Thmtheorem1.p1.7.7.m7.2.3.1"></in><list id="Thmtheorem1.p1.7.7.m7.2.3.2.1.cmml" xref="Thmtheorem1.p1.7.7.m7.2.3.2.2"><ci id="Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="Thmtheorem1.p1.7.7.m7.1.1">𝑖</ci><ci id="Thmtheorem1.p1.7.7.m7.2.2.cmml" xref="Thmtheorem1.p1.7.7.m7.2.2">𝑗</ci></list><ci id="Thmtheorem1.p1.7.7.m7.2.3.3.cmml" xref="Thmtheorem1.p1.7.7.m7.2.3.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.7.7.m7.2c">i,j\in\mathcal{C}</annotation></semantics></math>.</span></p>
</div>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.2" class="ltx_p"><span id="S3.SS1.p4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Theorem 1</span><span id="S3.SS1.p4.2.2" class="ltx_text" style="font-size:90%;"> reveals the correlation between the gradients and class distribution.
Then for class </span><math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">𝒞</mi><mi mathsize="90%" id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝒞</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathcal{C}_{i}</annotation></semantics></math><span id="S3.SS1.p4.2.3" class="ltx_text" style="font-size:90%;">, the estimation of class ratio </span><math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\frac{n_{i}^{2}}{\sum_{j}n_{j}^{2}}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mfrac id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><msubsup id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi mathsize="90%" id="S3.SS1.p4.2.m2.1.1.2.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.2.cmml">n</mi><mi mathsize="90%" id="S3.SS1.p4.2.m2.1.1.2.2.3" xref="S3.SS1.p4.2.m2.1.1.2.2.3.cmml">i</mi><mn mathsize="90%" id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">2</mn></msubsup><mrow id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mstyle displaystyle="false" id="S3.SS1.p4.2.m2.1.1.3.1" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml"><msub id="S3.SS1.p4.2.m2.1.1.3.1a" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml"><mo maxsize="63%" minsize="63%" stretchy="true" id="S3.SS1.p4.2.m2.1.1.3.1.2" xref="S3.SS1.p4.2.m2.1.1.3.1.2.cmml">∑</mo><mi mathsize="90%" id="S3.SS1.p4.2.m2.1.1.3.1.3" xref="S3.SS1.p4.2.m2.1.1.3.1.3.cmml">j</mi></msub></mstyle><msubsup id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml"><mi mathsize="90%" id="S3.SS1.p4.2.m2.1.1.3.2.2.2" xref="S3.SS1.p4.2.m2.1.1.3.2.2.2.cmml">n</mi><mi mathsize="90%" id="S3.SS1.p4.2.m2.1.1.3.2.2.3" xref="S3.SS1.p4.2.m2.1.1.3.2.2.3.cmml">j</mi><mn mathsize="90%" id="S3.SS1.p4.2.m2.1.1.3.2.3" xref="S3.SS1.p4.2.m2.1.1.3.2.3.cmml">2</mn></msubsup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><divide id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"></divide><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2.2">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.2.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">2</cn></apply><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><apply id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p4.2.m2.1.1.3.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1.2"></sum><ci id="S3.SS1.p4.2.m2.1.1.3.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1.3">𝑗</ci></apply><apply id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">superscript</csymbol><apply id="S3.SS1.p4.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.2.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.2.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2.2.2">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.3.2.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS1.p4.2.m2.1.1.3.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\frac{n_{i}^{2}}{\sum_{j}n_{j}^{2}}</annotation></semantics></math><span id="S3.SS1.p4.2.4" class="ltx_text" style="font-size:90%;"> can be defined</span></p>
<table id="S5.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.3" class="ltx_Math" alttext="\displaystyle R_{i}=\frac{e^{\frac{\beta}{||\nabla L^{\textit{aux}}(\bm{w}_{i})||^{2}}}}{\sum_{j}e^{\frac{\beta}{||\nabla L^{\textit{aux}}(\bm{w}_{j})||^{2}}}}," display="inline"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mi mathsize="90%" id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml">R</mi><mi mathsize="90%" id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mfrac id="S3.E7.m1.2.2a" xref="S3.E7.m1.2.2.cmml"><msup id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml">e</mi><mfrac id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">β</mi><msup id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="200%" minsize="200%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">∇</mo><msup id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="200%" minsize="200%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mfrac></msup><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><msub id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml">∑</mo><mi mathsize="90%" id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.3.cmml">j</mi></msub><msup id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.3.2" xref="S3.E7.m1.2.2.2.3.2.cmml">e</mi><mfrac id="S3.E7.m1.2.2.2.1.1" xref="S3.E7.m1.2.2.2.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.1.1.3.cmml">β</mi><msup id="S3.E7.m1.2.2.2.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.2.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.1.2.cmml"><mo maxsize="200%" minsize="200%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.1.cmml">∇</mo><msup id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mtext class="ltx_mathvariant_italic" mathsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3a.cmml">aux</mtext></msup></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="200%" minsize="200%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S3.E7.m1.2.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.3.cmml">2</mn></msup></mfrac></msup></mrow></mfrac></mstyle></mrow><mo mathsize="90%" id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1"></eq><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2">𝑅</ci><ci id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2"></divide><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3">𝑒</ci><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><divide id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1"></divide><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝛽</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1">∇</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="45%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><apply id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2">subscript</csymbol><sum id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"></sum><ci id="S3.E7.m1.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3">𝑗</ci></apply><apply id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.3">superscript</csymbol><ci id="S3.E7.m1.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.3.2">𝑒</ci><apply id="S3.E7.m1.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1"><divide id="S3.E7.m1.2.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1"></divide><ci id="S3.E7.m1.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.2.1.1.3">𝛽</ci><apply id="S3.E7.m1.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1"><times id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3"><ci id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.1">∇</ci><apply id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="45%" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.3.2.3">aux</mtext></ci></apply></apply><apply id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S3.E7.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\displaystyle R_{i}=\frac{e^{\frac{\beta}{||\nabla L^{\textit{aux}}(\bm{w}_{i})||^{2}}}}{\sum_{j}e^{\frac{\beta}{||\nabla L^{\textit{aux}}(\bm{w}_{j})||^{2}}}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.4" class="ltx_p"><span id="S3.SS1.p4.4.1" class="ltx_text" style="font-size:90%;">where </span><math id="S3.SS1.p4.3.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS1.p4.3.m1.1a"><mi mathsize="90%" id="S3.SS1.p4.3.m1.1.1" xref="S3.SS1.p4.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m1.1b"><ci id="S3.SS1.p4.3.m1.1.1.cmml" xref="S3.SS1.p4.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m1.1c">\beta</annotation></semantics></math><span id="S3.SS1.p4.4.2" class="ltx_text" style="font-size:90%;"> is a hyperparameter that can be tuned to control the normalization between classes.
Then we can obtain the composition vector </span><math id="S3.SS1.p4.4.m2.3" class="ltx_Math" alttext="\bm{R}=[R_{1},...,R_{C}]" display="inline"><semantics id="S3.SS1.p4.4.m2.3a"><mrow id="S3.SS1.p4.4.m2.3.3" xref="S3.SS1.p4.4.m2.3.3.cmml"><mi mathsize="90%" id="S3.SS1.p4.4.m2.3.3.4" xref="S3.SS1.p4.4.m2.3.3.4.cmml">𝑹</mi><mo mathsize="90%" id="S3.SS1.p4.4.m2.3.3.3" xref="S3.SS1.p4.4.m2.3.3.3.cmml">=</mo><mrow id="S3.SS1.p4.4.m2.3.3.2.2" xref="S3.SS1.p4.4.m2.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.3" xref="S3.SS1.p4.4.m2.3.3.2.3.cmml">[</mo><msub id="S3.SS1.p4.4.m2.2.2.1.1.1" xref="S3.SS1.p4.4.m2.2.2.1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p4.4.m2.2.2.1.1.1.2" xref="S3.SS1.p4.4.m2.2.2.1.1.1.2.cmml">R</mi><mn mathsize="90%" id="S3.SS1.p4.4.m2.2.2.1.1.1.3" xref="S3.SS1.p4.4.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.4" xref="S3.SS1.p4.4.m2.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S3.SS1.p4.4.m2.1.1" xref="S3.SS1.p4.4.m2.1.1.cmml">…</mi><mo mathsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.5" xref="S3.SS1.p4.4.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p4.4.m2.3.3.2.2.2" xref="S3.SS1.p4.4.m2.3.3.2.2.2.cmml"><mi mathsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.2.2" xref="S3.SS1.p4.4.m2.3.3.2.2.2.2.cmml">R</mi><mi mathsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.2.3" xref="S3.SS1.p4.4.m2.3.3.2.2.2.3.cmml">C</mi></msub><mo maxsize="90%" minsize="90%" id="S3.SS1.p4.4.m2.3.3.2.2.6" xref="S3.SS1.p4.4.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m2.3b"><apply id="S3.SS1.p4.4.m2.3.3.cmml" xref="S3.SS1.p4.4.m2.3.3"><eq id="S3.SS1.p4.4.m2.3.3.3.cmml" xref="S3.SS1.p4.4.m2.3.3.3"></eq><ci id="S3.SS1.p4.4.m2.3.3.4.cmml" xref="S3.SS1.p4.4.m2.3.3.4">𝑹</ci><list id="S3.SS1.p4.4.m2.3.3.2.3.cmml" xref="S3.SS1.p4.4.m2.3.3.2.2"><apply id="S3.SS1.p4.4.m2.2.2.1.1.1.cmml" xref="S3.SS1.p4.4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.4.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p4.4.m2.2.2.1.1.1.2">𝑅</ci><cn type="integer" id="S3.SS1.p4.4.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p4.4.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p4.4.m2.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1">…</ci><apply id="S3.SS1.p4.4.m2.3.3.2.2.2.cmml" xref="S3.SS1.p4.4.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p4.4.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.4.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p4.4.m2.3.3.2.2.2.2">𝑅</ci><ci id="S3.SS1.p4.4.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.p4.4.m2.3.3.2.2.2.3">𝐶</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m2.3c">\bm{R}=[R_{1},...,R_{C}]</annotation></semantics></math><span id="S3.SS1.p4.4.3" class="ltx_text" style="font-size:90%;"> that indicates the distribution of raw data.
Moreover, the Kullback-Leibler (KL) divergence can be harnessed to evaluate the class imbalance of each client, which is defined as
</span></p>
<table id="S5.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_math_unparsed" alttext="\displaystyle D_{KL}(\bm{R}||\bm{U})=\sum_{i\in\mathcal{C}}R_{i}\log\frac{R_{i}}{U_{i}}," display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1b"><msub id="S3.E8.m1.1.1"><mi mathsize="90%" id="S3.E8.m1.1.1.2">D</mi><mrow id="S3.E8.m1.1.1.3"><mi mathsize="90%" id="S3.E8.m1.1.1.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.1">​</mo><mi mathsize="90%" id="S3.E8.m1.1.1.3.3">L</mi></mrow></msub><mrow id="S3.E8.m1.1.2"><mo maxsize="90%" minsize="90%" id="S3.E8.m1.1.2.1">(</mo><mi mathsize="90%" id="S3.E8.m1.1.2.2">𝑹</mi><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S3.E8.m1.1.2.3">|</mo><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S3.E8.m1.1.2.4">|</mo><mi mathsize="90%" id="S3.E8.m1.1.2.5">𝑼</mi><mo maxsize="90%" minsize="90%" id="S3.E8.m1.1.2.6">)</mo></mrow><mo mathsize="90%" id="S3.E8.m1.1.3">=</mo><mstyle displaystyle="true" id="S3.E8.m1.1.4"><munder id="S3.E8.m1.1.4a"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E8.m1.1.4.2">∑</mo><mrow id="S3.E8.m1.1.4.3"><mi mathsize="90%" id="S3.E8.m1.1.4.3.2">i</mi><mo mathsize="90%" id="S3.E8.m1.1.4.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E8.m1.1.4.3.3">𝒞</mi></mrow></munder></mstyle><msub id="S3.E8.m1.1.5"><mi mathsize="90%" id="S3.E8.m1.1.5.2">R</mi><mi mathsize="90%" id="S3.E8.m1.1.5.3">i</mi></msub><mi mathsize="90%" id="S3.E8.m1.1.6">log</mi><mstyle displaystyle="true" id="S3.E8.m1.1.7"><mfrac id="S3.E8.m1.1.7a"><msub id="S3.E8.m1.1.7.2"><mi mathsize="90%" id="S3.E8.m1.1.7.2.2">R</mi><mi mathsize="90%" id="S3.E8.m1.1.7.2.3">i</mi></msub><msub id="S3.E8.m1.1.7.3"><mi mathsize="90%" id="S3.E8.m1.1.7.3.2">U</mi><mi mathsize="90%" id="S3.E8.m1.1.7.3.3">i</mi></msub></mfrac></mstyle><mo mathsize="90%" id="S3.E8.m1.1.8">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle D_{KL}(\bm{R}||\bm{U})=\sum_{i\in\mathcal{C}}R_{i}\log\frac{R_{i}}{U_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.6" class="ltx_p"><span id="S3.SS1.p4.6.1" class="ltx_text" style="font-size:90%;">where </span><math id="S3.SS1.p4.5.m1.1" class="ltx_Math" alttext="\bm{U}" display="inline"><semantics id="S3.SS1.p4.5.m1.1a"><mi mathsize="90%" id="S3.SS1.p4.5.m1.1.1" xref="S3.SS1.p4.5.m1.1.1.cmml">𝑼</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m1.1b"><ci id="S3.SS1.p4.5.m1.1.1.cmml" xref="S3.SS1.p4.5.m1.1.1">𝑼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m1.1c">\bm{U}</annotation></semantics></math><span id="S3.SS1.p4.6.2" class="ltx_text" style="font-size:90%;"> is a vector of ones with magnitude </span><math id="S3.SS1.p4.6.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p4.6.m2.1a"><mi mathsize="90%" id="S3.SS1.p4.6.m2.1.1" xref="S3.SS1.p4.6.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m2.1b"><ci id="S3.SS1.p4.6.m2.1.1.cmml" xref="S3.SS1.p4.6.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m2.1c">C</annotation></semantics></math><span id="S3.SS1.p4.6.3" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Online Learning Framework for Client Selection</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p"><span id="S3.SS2.p1.3.1" class="ltx_text" style="font-size:90%;">Multi-arm bandit problems are motivated by a variety of real-world problems, such as online advertising, dynamic pricing and stock investment.
To find the optimal balance client subset, the difficulty lies in how to learn the statistics of class distribution via iterative updated gradient.
Combinatorial multi-Armed bandit (CMAB) can be harnessed to solve this problem </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS2.p1.3.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S3.SS2.p1.3.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS2.p1.3.4" class="ltx_text" style="font-size:90%;">.
In CMAB model, an agent gambles on a bandit machine with a finite set of arms, where each arm has unknown distribution.
At round </span><math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi mathsize="90%" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">t</annotation></semantics></math><span id="S3.SS2.p1.3.5" class="ltx_text" style="font-size:90%;">, several arms defined as a super arm </span><math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝒮</mi><mi mathsize="90%" id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝒮</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{S}_{t}</annotation></semantics></math><span id="S3.SS2.p1.3.6" class="ltx_text" style="font-size:90%;"> (</span><math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{S}_{t}\subseteq\mathcal{K}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msub id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">𝒮</mi><mi mathsize="90%" id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo mathsize="90%" id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><subset id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></subset><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝒮</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{S}_{t}\subseteq\mathcal{K}</annotation></semantics></math><span id="S3.SS2.p1.3.7" class="ltx_text" style="font-size:90%;">) can be pulled.
The reward of the super arm depends on the outcomes of all pulled arms.</span></p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p"><span id="S3.SS2.p2.3.1" class="ltx_text" style="font-size:90%;">In this work, we consider the client selection as a CMAB problem, where each client represents the arm and the client set represents the super arm. In FL training, once the model is updated, the server could obtain the local model of each client device.
Utilizing the class estimation scheme, we can reveal the composition vector </span><math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\bm{R}^{k}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝑹</mi><mi mathsize="90%" id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑹</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bm{R}^{k}</annotation></semantics></math><span id="S3.SS2.p2.3.2" class="ltx_text" style="font-size:90%;"> of selected client </span><math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi mathsize="90%" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">k</annotation></semantics></math><span id="S3.SS2.p2.3.3" class="ltx_text" style="font-size:90%;">.
Define the reward of client </span><math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi mathsize="90%" id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">k</annotation></semantics></math><span id="S3.SS2.p2.3.4" class="ltx_text" style="font-size:90%;"> as</span></p>
<table id="S5.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_math_unparsed" alttext="\displaystyle r^{k}=\frac{1}{D_{KL}(\bm{R}^{k}||\bm{U})}." display="inline"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1"><mrow id="S3.E9.m1.1.1.1.1"><msup id="S3.E9.m1.1.1.1.1.2"><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.2.2">r</mi><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.2.3">k</mi></msup><mo mathsize="90%" id="S3.E9.m1.1.1.1.1.1">=</mo><mstyle displaystyle="true" id="S3.E9.m1.1.1.1.1.3"><mfrac id="S3.E9.m1.1.1.1.1.3a"><mn mathsize="90%" id="S3.E9.m1.1.1.1.1.3.2">1</mn><mrow id="S3.E9.m1.1.1.1.1.3.3"><msub id="S3.E9.m1.1.1.1.1.3.3.1"><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.1.2">D</mi><mrow id="S3.E9.m1.1.1.1.1.3.3.1.3"><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.1.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.3.3.1.3.1">​</mo><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.1.3.3">L</mi></mrow></msub><mrow id="S3.E9.m1.1.1.1.1.3.3.2"><mo maxsize="90%" minsize="90%" id="S3.E9.m1.1.1.1.1.3.3.2.1">(</mo><msup id="S3.E9.m1.1.1.1.1.3.3.2.2"><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.2.2.2">𝑹</mi><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.2.2.3">k</mi></msup><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S3.E9.m1.1.1.1.1.3.3.2.3">|</mo><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="S3.E9.m1.1.1.1.1.3.3.2.4">|</mo><mi mathsize="90%" id="S3.E9.m1.1.1.1.1.3.3.2.5">𝑼</mi><mo maxsize="90%" minsize="90%" id="S3.E9.m1.1.1.1.1.3.3.2.6">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo lspace="0em" mathsize="90%" id="S3.E9.m1.1.1.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.1b">\displaystyle r^{k}=\frac{1}{D_{KL}(\bm{R}^{k}||\bm{U})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.4" class="ltx_p"><span id="S3.SS2.p2.4.1" class="ltx_text" style="font-size:90%;">Then the global server executes FedAvg algorithm for model aggregation and the reward </span><math id="S3.SS2.p2.4.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.p2.4.m1.1a"><mi mathsize="90%" id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><ci id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">r</annotation></semantics></math><span id="S3.SS2.p2.4.2" class="ltx_text" style="font-size:90%;"> of the whole client set can be obtained the same as (</span><a href="#S3.E9" title="In 3.2 Online Learning Framework for Client Selection ‣ 3 Online Learning Algorithm for Client selection ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">9</span></a><span id="S3.SS2.p2.4.3" class="ltx_text" style="font-size:90%;">).
Note that the super arm’s reward is a nonlinear combination of the selected single arms’ reward.
An algorithm that has good theoretical results with nonlinear reward is the combinatorial upper confidence bounds (CUCB) algorithm </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS2.p2.4.4.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S3.SS2.p2.4.5.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS2.p2.4.6" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.5" class="ltx_p"><span id="S3.SS2.p3.5.1" class="ltx_text" style="font-size:90%;">Let </span><math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="T^{k}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">T</mi><mi mathsize="90%" id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑇</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">T^{k}</annotation></semantics></math><span id="S3.SS2.p3.5.2" class="ltx_text" style="font-size:90%;"> denote the number of times that the client </span><math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi mathsize="90%" id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">k</annotation></semantics></math><span id="S3.SS2.p3.5.3" class="ltx_text" style="font-size:90%;"> has been selected.
Once client </span><math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi mathsize="90%" id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">k</annotation></semantics></math><span id="S3.SS2.p3.5.4" class="ltx_text" style="font-size:90%;"> has been selected in a time slot, </span><math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="T^{k}\rightarrow T^{k}+1" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><msup id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">T</mi><mi mathsize="90%" id="S3.SS2.p3.4.m4.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.2.3.cmml">k</mi></msup><mo mathsize="90%" stretchy="false" id="S3.SS2.p3.4.m4.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.cmml">→</mo><mrow id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><msup id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml"><mi mathsize="90%" id="S3.SS2.p3.4.m4.1.1.3.2.2" xref="S3.SS2.p3.4.m4.1.1.3.2.2.cmml">T</mi><mi mathsize="90%" id="S3.SS2.p3.4.m4.1.1.3.2.3" xref="S3.SS2.p3.4.m4.1.1.3.2.3.cmml">k</mi></msup><mo mathsize="90%" id="S3.SS2.p3.4.m4.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><ci id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1">→</ci><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝑇</ci><ci id="S3.SS2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><plus id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.1"></plus><apply id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.2">𝑇</ci><ci id="S3.SS2.p3.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">T^{k}\rightarrow T^{k}+1</annotation></semantics></math><span id="S3.SS2.p3.5.5" class="ltx_text" style="font-size:90%;">, otherwise, </span><math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="T^{k}\rightarrow T^{k}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><msup id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p3.5.m5.1.1.2.2" xref="S3.SS2.p3.5.m5.1.1.2.2.cmml">T</mi><mi mathsize="90%" id="S3.SS2.p3.5.m5.1.1.2.3" xref="S3.SS2.p3.5.m5.1.1.2.3.cmml">k</mi></msup><mo mathsize="90%" stretchy="false" id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">→</mo><msup id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi mathsize="90%" id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">T</mi><mi mathsize="90%" id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><ci id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1">→</ci><apply id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2.2">𝑇</ci><ci id="S3.SS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑇</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">T^{k}\rightarrow T^{k}</annotation></semantics></math><span id="S3.SS2.p3.5.6" class="ltx_text" style="font-size:90%;">.
The proposed client selection algorithm based CUCB is shown in </span><span id="S3.SS2.p3.5.7" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 1</span><span id="S3.SS2.p3.5.8" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> CUCB for Client Selection</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">For each client </span><math id="alg1.l1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l1.m1.1a"><mi mathsize="90%" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">k</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:90%;">, choose an arbitrary set </span><math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathcal{S}\in\mathcal{K}" display="inline"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝒮</mi><mo mathsize="90%" id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><in id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></in><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝒮</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{S}\in\mathcal{K}</annotation></semantics></math><span id="alg1.l1.4" class="ltx_text" style="font-size:90%;"> such that </span><math id="alg1.l1.m3.1" class="ltx_Math" alttext="k\in\mathcal{S}" display="inline"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">k</mi><mo mathsize="90%" id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑘</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">k\in\mathcal{S}</annotation></semantics></math><span id="alg1.l1.5" class="ltx_text" style="font-size:90%;"> and update variables </span><math id="alg1.l1.m4.1" class="ltx_Math" alttext="T^{k}" display="inline"><semantics id="alg1.l1.m4.1a"><msup id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">T</mi><mi mathsize="90%" id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">superscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑇</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">T^{k}</annotation></semantics></math><span id="alg1.l1.6" class="ltx_text" style="font-size:90%;"> and </span><math id="alg1.l1.m5.1" class="ltx_Math" alttext="\hat{r}^{k}" display="inline"><semantics id="alg1.l1.m5.1a"><msup id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mover accent="true" id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml"><mi mathsize="90%" id="alg1.l1.m5.1.1.2.2" xref="alg1.l1.m5.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="alg1.l1.m5.1.1.2.1" xref="alg1.l1.m5.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">superscript</csymbol><apply id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2"><ci id="alg1.l1.m5.1.1.2.1.cmml" xref="alg1.l1.m5.1.1.2.1">^</ci><ci id="alg1.l1.m5.1.1.2.2.cmml" xref="alg1.l1.m5.1.1.2.2">𝑟</ci></apply><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\hat{r}^{k}</annotation></semantics></math><span id="alg1.l1.7" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="t\leftarrow N" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi mathsize="90%" id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑡</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t\leftarrow N</annotation></semantics></math><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span><span id="alg1.l3.3" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l3.4" class="ltx_text ltx_font_bold" style="font-size:90%;">true</span><span id="alg1.l3.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l3.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l3.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;">    </span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="t\leftarrow t+1" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑡</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><plus id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></plus><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">t\leftarrow t+1</annotation></semantics></math><span id="alg1.l4.3" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text" style="font-size:90%;">    For each client </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l5.m1.1a"><mi mathsize="90%" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">i</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;">, set </span><math id="alg1.l5.m2.1" class="ltx_Math" alttext="\hat{r}^{k}=\bar{r}^{k}+\alpha\sqrt{\frac{3\ln t}{2T^{k}}}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msup id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mover accent="true" id="alg1.l5.m2.1.1.2.2" xref="alg1.l5.m2.1.1.2.2.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.2.2.2" xref="alg1.l5.m2.1.1.2.2.2.cmml">r</mi><mo mathsize="90%" id="alg1.l5.m2.1.1.2.2.1" xref="alg1.l5.m2.1.1.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3.cmml">k</mi></msup><mo mathsize="90%" id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">=</mo><mrow id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><msup id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.3.2.cmml"><mover accent="true" id="alg1.l5.m2.1.1.3.2.2" xref="alg1.l5.m2.1.1.3.2.2.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.3.2.2.2" xref="alg1.l5.m2.1.1.3.2.2.2.cmml">r</mi><mo mathsize="90%" id="alg1.l5.m2.1.1.3.2.2.1" xref="alg1.l5.m2.1.1.3.2.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="alg1.l5.m2.1.1.3.2.3" xref="alg1.l5.m2.1.1.3.2.3.cmml">k</mi></msup><mo mathsize="90%" id="alg1.l5.m2.1.1.3.1" xref="alg1.l5.m2.1.1.3.1.cmml">+</mo><mrow id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.3.3.2" xref="alg1.l5.m2.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.3.3.1" xref="alg1.l5.m2.1.1.3.3.1.cmml">​</mo><msqrt id="alg1.l5.m2.1.1.3.3.3" xref="alg1.l5.m2.1.1.3.3.3.cmml"><mfrac id="alg1.l5.m2.1.1.3.3.3.2" xref="alg1.l5.m2.1.1.3.3.3.2.cmml"><mrow id="alg1.l5.m2.1.1.3.3.3.2.2" xref="alg1.l5.m2.1.1.3.3.3.2.2.cmml"><mn mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.2.2" xref="alg1.l5.m2.1.1.3.3.3.2.2.2.cmml">3</mn><mo lspace="0.167em" rspace="0em" id="alg1.l5.m2.1.1.3.3.3.2.2.1" xref="alg1.l5.m2.1.1.3.3.3.2.2.1.cmml">​</mo><mrow id="alg1.l5.m2.1.1.3.3.3.2.2.3" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.2.3.1" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.1.cmml">ln</mi><mo lspace="0.167em" id="alg1.l5.m2.1.1.3.3.3.2.2.3a" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.cmml">⁡</mo><mi mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.2.3.2" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.2.cmml">t</mi></mrow></mrow><mrow id="alg1.l5.m2.1.1.3.3.3.2.3" xref="alg1.l5.m2.1.1.3.3.3.2.3.cmml"><mn mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.3.2" xref="alg1.l5.m2.1.1.3.3.3.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.3.3.3.2.3.1" xref="alg1.l5.m2.1.1.3.3.3.2.3.1.cmml">​</mo><msup id="alg1.l5.m2.1.1.3.3.3.2.3.3" xref="alg1.l5.m2.1.1.3.3.3.2.3.3.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.3.3.2" xref="alg1.l5.m2.1.1.3.3.3.2.3.3.2.cmml">T</mi><mi mathsize="90%" id="alg1.l5.m2.1.1.3.3.3.2.3.3.3" xref="alg1.l5.m2.1.1.3.3.3.2.3.3.3.cmml">k</mi></msup></mrow></mfrac></msqrt></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><eq id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1"></eq><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">superscript</csymbol><apply id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2.2"><ci id="alg1.l5.m2.1.1.2.2.1.cmml" xref="alg1.l5.m2.1.1.2.2.1">^</ci><ci id="alg1.l5.m2.1.1.2.2.2.cmml" xref="alg1.l5.m2.1.1.2.2.2">𝑟</ci></apply><ci id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3">𝑘</ci></apply><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><plus id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3.1"></plus><apply id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.2.1.cmml" xref="alg1.l5.m2.1.1.3.2">superscript</csymbol><apply id="alg1.l5.m2.1.1.3.2.2.cmml" xref="alg1.l5.m2.1.1.3.2.2"><ci id="alg1.l5.m2.1.1.3.2.2.1.cmml" xref="alg1.l5.m2.1.1.3.2.2.1">¯</ci><ci id="alg1.l5.m2.1.1.3.2.2.2.cmml" xref="alg1.l5.m2.1.1.3.2.2.2">𝑟</ci></apply><ci id="alg1.l5.m2.1.1.3.2.3.cmml" xref="alg1.l5.m2.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3"><times id="alg1.l5.m2.1.1.3.3.1.cmml" xref="alg1.l5.m2.1.1.3.3.1"></times><ci id="alg1.l5.m2.1.1.3.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.2">𝛼</ci><apply id="alg1.l5.m2.1.1.3.3.3.cmml" xref="alg1.l5.m2.1.1.3.3.3"><root id="alg1.l5.m2.1.1.3.3.3a.cmml" xref="alg1.l5.m2.1.1.3.3.3"></root><apply id="alg1.l5.m2.1.1.3.3.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2"><divide id="alg1.l5.m2.1.1.3.3.3.2.1.cmml" xref="alg1.l5.m2.1.1.3.3.3.2"></divide><apply id="alg1.l5.m2.1.1.3.3.3.2.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2"><times id="alg1.l5.m2.1.1.3.3.3.2.2.1.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2.1"></times><cn type="integer" id="alg1.l5.m2.1.1.3.3.3.2.2.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2.2">3</cn><apply id="alg1.l5.m2.1.1.3.3.3.2.2.3.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2.3"><ln id="alg1.l5.m2.1.1.3.3.3.2.2.3.1.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.1"></ln><ci id="alg1.l5.m2.1.1.3.3.3.2.2.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.2.3.2">𝑡</ci></apply></apply><apply id="alg1.l5.m2.1.1.3.3.3.2.3.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3"><times id="alg1.l5.m2.1.1.3.3.3.2.3.1.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.1"></times><cn type="integer" id="alg1.l5.m2.1.1.3.3.3.2.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.2">2</cn><apply id="alg1.l5.m2.1.1.3.3.3.2.3.3.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.3.3.2.3.3.1.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.3">superscript</csymbol><ci id="alg1.l5.m2.1.1.3.3.3.2.3.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.3.2">𝑇</ci><ci id="alg1.l5.m2.1.1.3.3.3.2.3.3.3.cmml" xref="alg1.l5.m2.1.1.3.3.3.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\hat{r}^{k}=\bar{r}^{k}+\alpha\sqrt{\frac{3\ln t}{2T^{k}}}</annotation></semantics></math><span id="alg1.l5.4" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="font-size:90%;">    Obtain </span><math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">𝒮</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝒮</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathcal{S}_{t}</annotation></semantics></math><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;"> using </span><span id="alg1.l6.4" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 2</span><span id="alg1.l6.5" class="ltx_text" style="font-size:90%;"> with </span><math id="alg1.l6.m2.1" class="ltx_Math" alttext="\hat{r}" display="inline"><semantics id="alg1.l6.m2.1a"><mover accent="true" id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">r</mi><mo mathsize="90%" id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><ci id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1">^</ci><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\hat{r}</annotation></semantics></math><span id="alg1.l6.6" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;">    Play </span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">𝒮</mi><mi mathsize="90%" id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝒮</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathcal{S}_{t}</annotation></semantics></math><span id="alg1.l7.3" class="ltx_text" style="font-size:90%;"> and update </span><math id="alg1.l7.m2.1" class="ltx_Math" alttext="T^{k}" display="inline"><semantics id="alg1.l7.m2.1a"><msup id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml">T</mi><mi mathsize="90%" id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">superscript</csymbol><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑇</ci><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">T^{k}</annotation></semantics></math><span id="alg1.l7.4" class="ltx_text" style="font-size:90%;"> and </span><math id="alg1.l7.m3.1" class="ltx_Math" alttext="\hat{r}^{k}" display="inline"><semantics id="alg1.l7.m3.1a"><msup id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml"><mover accent="true" id="alg1.l7.m3.1.1.2" xref="alg1.l7.m3.1.1.2.cmml"><mi mathsize="90%" id="alg1.l7.m3.1.1.2.2" xref="alg1.l7.m3.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="alg1.l7.m3.1.1.2.1" xref="alg1.l7.m3.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l7.m3.1.1.3" xref="alg1.l7.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.1.cmml" xref="alg1.l7.m3.1.1">superscript</csymbol><apply id="alg1.l7.m3.1.1.2.cmml" xref="alg1.l7.m3.1.1.2"><ci id="alg1.l7.m3.1.1.2.1.cmml" xref="alg1.l7.m3.1.1.2.1">^</ci><ci id="alg1.l7.m3.1.1.2.2.cmml" xref="alg1.l7.m3.1.1.2.2">𝑟</ci></apply><ci id="alg1.l7.m3.1.1.3.cmml" xref="alg1.l7.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">\hat{r}^{k}</annotation></semantics></math><span id="alg1.l7.5" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.2" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l8.3" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l8.4" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span>
</div>
</div>
</figure>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.10" class="ltx_p"><span id="S3.SS2.p4.10.1" class="ltx_text" style="font-size:90%;">Here </span><math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi mathsize="90%" id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\alpha</annotation></semantics></math><span id="S3.SS2.p4.10.2" class="ltx_text" style="font-size:90%;"> is the exploration factor to balance the trade-off between exploitation and exploration.
Step </span><math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mn mathsize="90%" id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><cn type="integer" id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">1</annotation></semantics></math><span id="S3.SS2.p4.10.3" class="ltx_text" style="font-size:90%;"> of </span><span id="S3.SS2.p4.10.4" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 1</span><span id="S3.SS2.p4.10.5" class="ltx_text" style="font-size:90%;"> guarantees that each client has been selected once at least in the first </span><math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi mathsize="90%" id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">N</annotation></semantics></math><span id="S3.SS2.p4.10.6" class="ltx_text" style="font-size:90%;"> round.
Notation </span><math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="\bar{r}^{k}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msup id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p4.4.m4.1.1.2.2" xref="S3.SS2.p4.4.m4.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="S3.SS2.p4.4.m4.1.1.2.1" xref="S3.SS2.p4.4.m4.1.1.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2"><ci id="S3.SS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.2.1">¯</ci><ci id="S3.SS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.2">𝑟</ci></apply><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\bar{r}^{k}</annotation></semantics></math><span id="S3.SS2.p4.10.7" class="ltx_text" style="font-size:90%;"> denotes the individual reward sample mean of client </span><math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mi mathsize="90%" id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">k</annotation></semantics></math><span id="S3.SS2.p4.10.8" class="ltx_text" style="font-size:90%;">, and </span><math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="\hat{r}^{k}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msup id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p4.6.m6.1.1.2.2" xref="S3.SS2.p4.6.m6.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="S3.SS2.p4.6.m6.1.1.2.1" xref="S3.SS2.p4.6.m6.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2"><ci id="S3.SS2.p4.6.m6.1.1.2.1.cmml" xref="S3.SS2.p4.6.m6.1.1.2.1">^</ci><ci id="S3.SS2.p4.6.m6.1.1.2.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2.2">𝑟</ci></apply><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\hat{r}^{k}</annotation></semantics></math><span id="S3.SS2.p4.10.9" class="ltx_text" style="font-size:90%;"> denotes the perturbed version of </span><math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="\bar{r}^{k}" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><msup id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><mover accent="true" id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p4.7.m7.1.1.2.2" xref="S3.SS2.p4.7.m7.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="S3.SS2.p4.7.m7.1.1.2.1" xref="S3.SS2.p4.7.m7.1.1.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2"><ci id="S3.SS2.p4.7.m7.1.1.2.1.cmml" xref="S3.SS2.p4.7.m7.1.1.2.1">¯</ci><ci id="S3.SS2.p4.7.m7.1.1.2.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2.2">𝑟</ci></apply><ci id="S3.SS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">\bar{r}^{k}</annotation></semantics></math><span id="S3.SS2.p4.10.10" class="ltx_text" style="font-size:90%;">.
In step </span><math id="S3.SS2.p4.8.m8.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S3.SS2.p4.8.m8.1a"><mn mathsize="90%" id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><cn type="integer" id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">6</annotation></semantics></math><span id="S3.SS2.p4.10.11" class="ltx_text" style="font-size:90%;">, the proposed algorithm utilizes the perturbed </span><math id="S3.SS2.p4.9.m9.1" class="ltx_Math" alttext="\hat{r}^{k}" display="inline"><semantics id="S3.SS2.p4.9.m9.1a"><msup id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml"><mover accent="true" id="S3.SS2.p4.9.m9.1.1.2" xref="S3.SS2.p4.9.m9.1.1.2.cmml"><mi mathsize="90%" id="S3.SS2.p4.9.m9.1.1.2.2" xref="S3.SS2.p4.9.m9.1.1.2.2.cmml">r</mi><mo mathsize="90%" id="S3.SS2.p4.9.m9.1.1.2.1" xref="S3.SS2.p4.9.m9.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S3.SS2.p4.9.m9.1.1.3" xref="S3.SS2.p4.9.m9.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><apply id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m9.1.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">superscript</csymbol><apply id="S3.SS2.p4.9.m9.1.1.2.cmml" xref="S3.SS2.p4.9.m9.1.1.2"><ci id="S3.SS2.p4.9.m9.1.1.2.1.cmml" xref="S3.SS2.p4.9.m9.1.1.2.1">^</ci><ci id="S3.SS2.p4.9.m9.1.1.2.2.cmml" xref="S3.SS2.p4.9.m9.1.1.2.2">𝑟</ci></apply><ci id="S3.SS2.p4.9.m9.1.1.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">\hat{r}^{k}</annotation></semantics></math><span id="S3.SS2.p4.10.12" class="ltx_text" style="font-size:90%;"> to solve the client selection problem.
The perturbation in step </span><math id="S3.SS2.p4.10.m10.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S3.SS2.p4.10.m10.1a"><mn mathsize="90%" id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><cn type="integer" id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">5</annotation></semantics></math><span id="S3.SS2.p4.10.13" class="ltx_text" style="font-size:90%;"> promotes the selection of clients that are not selected frequently, by artificially increasing their expected reward estimates.</span></p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.3" class="ltx_p"><span id="S3.SS2.p5.3.1" class="ltx_text" style="font-size:90%;">In our client selection problem, the class distribution of each client is uncertain.
Fortunately, we can reveal the class distribution according to the composition vector.
Let </span><math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\bm{R}^{k}(t)" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.2" xref="S3.SS2.p5.1.m1.1.2.cmml"><msup id="S3.SS2.p5.1.m1.1.2.2" xref="S3.SS2.p5.1.m1.1.2.2.cmml"><mi mathsize="90%" id="S3.SS2.p5.1.m1.1.2.2.2" xref="S3.SS2.p5.1.m1.1.2.2.2.cmml">𝑹</mi><mi mathsize="90%" id="S3.SS2.p5.1.m1.1.2.2.3" xref="S3.SS2.p5.1.m1.1.2.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.2.1" xref="S3.SS2.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p5.1.m1.1.2.3.2" xref="S3.SS2.p5.1.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.SS2.p5.1.m1.1.2.3.2.1" xref="S3.SS2.p5.1.m1.1.2.cmml">(</mo><mi mathsize="90%" id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="S3.SS2.p5.1.m1.1.2.3.2.2" xref="S3.SS2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.2"><times id="S3.SS2.p5.1.m1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.2.1"></times><apply id="S3.SS2.p5.1.m1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.2.2.1.cmml" xref="S3.SS2.p5.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS2.p5.1.m1.1.2.2.2.cmml" xref="S3.SS2.p5.1.m1.1.2.2.2">𝑹</ci><ci id="S3.SS2.p5.1.m1.1.2.2.3.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\bm{R}^{k}(t)</annotation></semantics></math><span id="S3.SS2.p5.3.2" class="ltx_text" style="font-size:90%;"> represent the composition vector of client </span><math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi mathsize="90%" id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">k</annotation></semantics></math><span id="S3.SS2.p5.3.3" class="ltx_text" style="font-size:90%;"> at time slot </span><math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mi mathsize="90%" id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">t</annotation></semantics></math><span id="S3.SS2.p5.3.4" class="ltx_text" style="font-size:90%;">.
Thus, the class ratio can be estimated by the sample mean of composition vector, which can be expressed as</span></p>
<table id="S5.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\displaystyle\bar{\bm{R}^{k}}=\frac{\sum_{t=1}^{T^{k}}\rho^{T^{k}-t}\bm{R}^{k}(t)}{\sum_{t=1}^{T^{k}}\rho^{T^{k}-t}}," display="inline"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml"><msup id="S3.E10.m1.2.2.1.1.2.2" xref="S3.E10.m1.2.2.1.1.2.2.cmml"><mi mathsize="90%" id="S3.E10.m1.2.2.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.cmml">𝑹</mi><mi mathsize="90%" id="S3.E10.m1.2.2.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">k</mi></msup><mo mathsize="90%" id="S3.E10.m1.2.2.1.1.2.1" xref="S3.E10.m1.2.2.1.1.2.1.cmml">¯</mo></mover><mo mathsize="90%" id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mfrac id="S3.E10.m1.1.1a" xref="S3.E10.m1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S3.E10.m1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.1.1.1.2.2.3" xref="S3.E10.m1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.1.2.2.3.2" xref="S3.E10.m1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E10.m1.1.1.1.2.2.3.1" xref="S3.E10.m1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E10.m1.1.1.1.2.2.3.3" xref="S3.E10.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msup id="S3.E10.m1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.1.2.3.2" xref="S3.E10.m1.1.1.1.2.3.2.cmml">T</mi><mi mathsize="90%" id="S3.E10.m1.1.1.1.2.3.3" xref="S3.E10.m1.1.1.1.2.3.3.cmml">k</mi></msup></msubsup><mrow id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml"><msup id="S3.E10.m1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.2.2" xref="S3.E10.m1.1.1.1.3.2.2.cmml">ρ</mi><mrow id="S3.E10.m1.1.1.1.3.2.3" xref="S3.E10.m1.1.1.1.3.2.3.cmml"><msup id="S3.E10.m1.1.1.1.3.2.3.2" xref="S3.E10.m1.1.1.1.3.2.3.2.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.2.3.2.2" xref="S3.E10.m1.1.1.1.3.2.3.2.2.cmml">T</mi><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.2.3.2.3" xref="S3.E10.m1.1.1.1.3.2.3.2.3.cmml">k</mi></msup><mo mathsize="90%" id="S3.E10.m1.1.1.1.3.2.3.1" xref="S3.E10.m1.1.1.1.3.2.3.1.cmml">−</mo><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.2.3.3" xref="S3.E10.m1.1.1.1.3.2.3.3.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.3.1.cmml">​</mo><msup id="S3.E10.m1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.3.2" xref="S3.E10.m1.1.1.1.3.3.2.cmml">𝑹</mi><mi mathsize="90%" id="S3.E10.m1.1.1.1.3.3.3" xref="S3.E10.m1.1.1.1.3.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.3.1a" xref="S3.E10.m1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.3.4.2" xref="S3.E10.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E10.m1.1.1.1.3.4.2.1" xref="S3.E10.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="S3.E10.m1.1.1.1.3.4.2.2" xref="S3.E10.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><msubsup id="S3.E10.m1.1.1.3.1" xref="S3.E10.m1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S3.E10.m1.1.1.3.1.2.2" xref="S3.E10.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E10.m1.1.1.3.1.2.3" xref="S3.E10.m1.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.3.1.2.3.2" xref="S3.E10.m1.1.1.3.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E10.m1.1.1.3.1.2.3.1" xref="S3.E10.m1.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E10.m1.1.1.3.1.2.3.3" xref="S3.E10.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msup id="S3.E10.m1.1.1.3.1.3" xref="S3.E10.m1.1.1.3.1.3.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.3.1.3.2" xref="S3.E10.m1.1.1.3.1.3.2.cmml">T</mi><mi mathsize="90%" id="S3.E10.m1.1.1.3.1.3.3" xref="S3.E10.m1.1.1.3.1.3.3.cmml">k</mi></msup></msubsup><msup id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml">ρ</mi><mrow id="S3.E10.m1.1.1.3.2.3" xref="S3.E10.m1.1.1.3.2.3.cmml"><msup id="S3.E10.m1.1.1.3.2.3.2" xref="S3.E10.m1.1.1.3.2.3.2.cmml"><mi mathsize="90%" id="S3.E10.m1.1.1.3.2.3.2.2" xref="S3.E10.m1.1.1.3.2.3.2.2.cmml">T</mi><mi mathsize="90%" id="S3.E10.m1.1.1.3.2.3.2.3" xref="S3.E10.m1.1.1.3.2.3.2.3.cmml">k</mi></msup><mo mathsize="90%" id="S3.E10.m1.1.1.3.2.3.1" xref="S3.E10.m1.1.1.3.2.3.1.cmml">−</mo><mi mathsize="90%" id="S3.E10.m1.1.1.3.2.3.3" xref="S3.E10.m1.1.1.3.2.3.3.cmml">t</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo mathsize="90%" id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"></eq><apply id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2"><ci id="S3.E10.m1.2.2.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1">¯</ci><apply id="S3.E10.m1.2.2.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2">superscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2">𝑹</ci><ci id="S3.E10.m1.2.2.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.3">𝑘</ci></apply></apply><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><divide id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1"></divide><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><apply id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.2">subscript</csymbol><sum id="S3.E10.m1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.2.2.2"></sum><apply id="S3.E10.m1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.1.1.1.2.2.3"><eq id="S3.E10.m1.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.1.1.1.2.2.3.1"></eq><ci id="S3.E10.m1.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.1.1.1.2.2.3.3.cmml" xref="S3.E10.m1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.2.3.1.cmml" xref="S3.E10.m1.1.1.1.2.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.2.3.2.cmml" xref="S3.E10.m1.1.1.1.2.3.2">𝑇</ci><ci id="S3.E10.m1.1.1.1.2.3.3.cmml" xref="S3.E10.m1.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3"><times id="S3.E10.m1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.3.1"></times><apply id="S3.E10.m1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.1.3.2">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.1.3.2.2">𝜌</ci><apply id="S3.E10.m1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.1.3.2.3"><minus id="S3.E10.m1.1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.1.1.1.3.2.3.1"></minus><apply id="S3.E10.m1.1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.2.3.2.1.cmml" xref="S3.E10.m1.1.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.2.3.2.2.cmml" xref="S3.E10.m1.1.1.1.3.2.3.2.2">𝑇</ci><ci id="S3.E10.m1.1.1.1.3.2.3.2.3.cmml" xref="S3.E10.m1.1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="S3.E10.m1.1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E10.m1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.1.3.3.2">𝑹</ci><ci id="S3.E10.m1.1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.1.3.3.3">𝑘</ci></apply><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑡</ci></apply></apply><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><apply id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.1.cmml" xref="S3.E10.m1.1.1.3.1">superscript</csymbol><apply id="S3.E10.m1.1.1.3.1.2.cmml" xref="S3.E10.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.2.1.cmml" xref="S3.E10.m1.1.1.3.1">subscript</csymbol><sum id="S3.E10.m1.1.1.3.1.2.2.cmml" xref="S3.E10.m1.1.1.3.1.2.2"></sum><apply id="S3.E10.m1.1.1.3.1.2.3.cmml" xref="S3.E10.m1.1.1.3.1.2.3"><eq id="S3.E10.m1.1.1.3.1.2.3.1.cmml" xref="S3.E10.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E10.m1.1.1.3.1.2.3.2.cmml" xref="S3.E10.m1.1.1.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.1.1.3.1.2.3.3.cmml" xref="S3.E10.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.1.1.3.1.3.cmml" xref="S3.E10.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.3.1.cmml" xref="S3.E10.m1.1.1.3.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.3.1.3.2.cmml" xref="S3.E10.m1.1.1.3.1.3.2">𝑇</ci><ci id="S3.E10.m1.1.1.3.1.3.3.cmml" xref="S3.E10.m1.1.1.3.1.3.3">𝑘</ci></apply></apply><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2">superscript</csymbol><ci id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2">𝜌</ci><apply id="S3.E10.m1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.3.2.3"><minus id="S3.E10.m1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.1.1.3.2.3.1"></minus><apply id="S3.E10.m1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E10.m1.1.1.3.2.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.3.2.2">𝑇</ci><ci id="S3.E10.m1.1.1.3.2.3.2.3.cmml" xref="S3.E10.m1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="S3.E10.m1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle\bar{\bm{R}^{k}}=\frac{\sum_{t=1}^{T^{k}}\rho^{T^{k}-t}\bm{R}^{k}(t)}{\sum_{t=1}^{T^{k}}\rho^{T^{k}-t}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.4" class="ltx_p"><span id="S3.SS2.p5.4.1" class="ltx_text" style="font-size:90%;">where </span><math id="S3.SS2.p5.4.m1.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS2.p5.4.m1.1a"><mi mathsize="90%" id="S3.SS2.p5.4.m1.1.1" xref="S3.SS2.p5.4.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m1.1b"><ci id="S3.SS2.p5.4.m1.1.1.cmml" xref="S3.SS2.p5.4.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m1.1c">\rho</annotation></semantics></math><span id="S3.SS2.p5.4.2" class="ltx_text" style="font-size:90%;"> is the forgetting factor since the characteristic of client class distribution may vary at each time slot.</span></p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.2" class="ltx_p"><span id="S3.SS2.p6.2.1" class="ltx_text" style="font-size:90%;">With the estimated composition vector </span><math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\bar{\bm{R}}" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mover accent="true" id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">𝑹</mi><mo mathsize="90%" id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><ci id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1">¯</ci><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝑹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\bar{\bm{R}}</annotation></semantics></math><span id="S3.SS2.p6.2.2" class="ltx_text" style="font-size:90%;"> and reward </span><math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mi mathsize="90%" id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">r</annotation></semantics></math><span id="S3.SS2.p6.2.3" class="ltx_text" style="font-size:90%;"> of each client, we can design the client selection scheme with minimal class imbalance according to </span><span id="S3.SS2.p6.2.4" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 2</span><span id="S3.SS2.p6.2.5" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.4.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Class Balancing Algorithm</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Initialize:</span><span id="alg2.l1.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.3.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg2.l2.4" class="ltx_text" style="font-size:90%;">     </span>
<span id="alg2.l2.2" class="ltx_inline-block ltx_parbox ltx_align_top" style="width:346.9pt;">
<span id="alg2.l2.2.2" class="ltx_p"><span id="alg2.l2.2.2.1" class="ltx_text" style="font-size:90%;">Set </span><math id="alg2.l2.1.1.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}=\emptyset" display="inline"><semantics id="alg2.l2.1.1.m1.1a"><mrow id="alg2.l2.1.1.m1.1.1" xref="alg2.l2.1.1.m1.1.1.cmml"><msub id="alg2.l2.1.1.m1.1.1.2" xref="alg2.l2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l2.1.1.m1.1.1.2.2" xref="alg2.l2.1.1.m1.1.1.2.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l2.1.1.m1.1.1.2.3" xref="alg2.l2.1.1.m1.1.1.2.3.cmml">t</mi></msub><mo mathsize="90%" id="alg2.l2.1.1.m1.1.1.1" xref="alg2.l2.1.1.m1.1.1.1.cmml">=</mo><mi mathsize="90%" mathvariant="normal" id="alg2.l2.1.1.m1.1.1.3" xref="alg2.l2.1.1.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.1.1.m1.1b"><apply id="alg2.l2.1.1.m1.1.1.cmml" xref="alg2.l2.1.1.m1.1.1"><eq id="alg2.l2.1.1.m1.1.1.1.cmml" xref="alg2.l2.1.1.m1.1.1.1"></eq><apply id="alg2.l2.1.1.m1.1.1.2.cmml" xref="alg2.l2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.1.1.m1.1.1.2.1.cmml" xref="alg2.l2.1.1.m1.1.1.2">subscript</csymbol><ci id="alg2.l2.1.1.m1.1.1.2.2.cmml" xref="alg2.l2.1.1.m1.1.1.2.2">𝒮</ci><ci id="alg2.l2.1.1.m1.1.1.2.3.cmml" xref="alg2.l2.1.1.m1.1.1.2.3">𝑡</ci></apply><emptyset id="alg2.l2.1.1.m1.1.1.3.cmml" xref="alg2.l2.1.1.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.1.1.m1.1c">\mathcal{S}_{t}=\emptyset</annotation></semantics></math><span id="alg2.l2.2.2.2" class="ltx_text" style="font-size:90%;"> and </span><math id="alg2.l2.2.2.m2.1" class="ltx_Math" alttext="\bm{R}_{total}=\emptyset" display="inline"><semantics id="alg2.l2.2.2.m2.1a"><mrow id="alg2.l2.2.2.m2.1.1" xref="alg2.l2.2.2.m2.1.1.cmml"><msub id="alg2.l2.2.2.m2.1.1.2" xref="alg2.l2.2.2.m2.1.1.2.cmml"><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.2" xref="alg2.l2.2.2.m2.1.1.2.2.cmml">𝑹</mi><mrow id="alg2.l2.2.2.m2.1.1.2.3" xref="alg2.l2.2.2.m2.1.1.2.3.cmml"><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.3.2" xref="alg2.l2.2.2.m2.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l2.2.2.m2.1.1.2.3.1" xref="alg2.l2.2.2.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.3.3" xref="alg2.l2.2.2.m2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l2.2.2.m2.1.1.2.3.1a" xref="alg2.l2.2.2.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.3.4" xref="alg2.l2.2.2.m2.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l2.2.2.m2.1.1.2.3.1b" xref="alg2.l2.2.2.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.3.5" xref="alg2.l2.2.2.m2.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l2.2.2.m2.1.1.2.3.1c" xref="alg2.l2.2.2.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l2.2.2.m2.1.1.2.3.6" xref="alg2.l2.2.2.m2.1.1.2.3.6.cmml">l</mi></mrow></msub><mo mathsize="90%" id="alg2.l2.2.2.m2.1.1.1" xref="alg2.l2.2.2.m2.1.1.1.cmml">=</mo><mi mathsize="90%" mathvariant="normal" id="alg2.l2.2.2.m2.1.1.3" xref="alg2.l2.2.2.m2.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.2.2.m2.1b"><apply id="alg2.l2.2.2.m2.1.1.cmml" xref="alg2.l2.2.2.m2.1.1"><eq id="alg2.l2.2.2.m2.1.1.1.cmml" xref="alg2.l2.2.2.m2.1.1.1"></eq><apply id="alg2.l2.2.2.m2.1.1.2.cmml" xref="alg2.l2.2.2.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.2.2.m2.1.1.2.1.cmml" xref="alg2.l2.2.2.m2.1.1.2">subscript</csymbol><ci id="alg2.l2.2.2.m2.1.1.2.2.cmml" xref="alg2.l2.2.2.m2.1.1.2.2">𝑹</ci><apply id="alg2.l2.2.2.m2.1.1.2.3.cmml" xref="alg2.l2.2.2.m2.1.1.2.3"><times id="alg2.l2.2.2.m2.1.1.2.3.1.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.1"></times><ci id="alg2.l2.2.2.m2.1.1.2.3.2.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.2">𝑡</ci><ci id="alg2.l2.2.2.m2.1.1.2.3.3.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.3">𝑜</ci><ci id="alg2.l2.2.2.m2.1.1.2.3.4.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.4">𝑡</ci><ci id="alg2.l2.2.2.m2.1.1.2.3.5.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.5">𝑎</ci><ci id="alg2.l2.2.2.m2.1.1.2.3.6.cmml" xref="alg2.l2.2.2.m2.1.1.2.3.6">𝑙</ci></apply></apply><emptyset id="alg2.l2.2.2.m2.1.1.3.cmml" xref="alg2.l2.2.2.m2.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.2.2.m2.1c">\bm{R}_{total}=\emptyset</annotation></semantics></math><span id="alg2.l2.2.2.3" class="ltx_text" style="font-size:90%;">.</span></span>
</span><span id="alg2.l2.5" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg2.l3.m1.1" class="ltx_Math" alttext="k_{0}=\arg\max_{k}\hat{r}^{k}" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msub id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">k</mi><mn mathsize="90%" id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">0</mn></msub><mo mathsize="90%" id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mrow id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.1" xref="alg2.l3.m1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="alg2.l3.m1.1.1.3a" xref="alg2.l3.m1.1.1.3.cmml">⁡</mo><mrow id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml"><msub id="alg2.l3.m1.1.1.3.2.1" xref="alg2.l3.m1.1.1.3.2.1.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.2.1.2" xref="alg2.l3.m1.1.1.3.2.1.2.cmml">max</mi><mi mathsize="90%" id="alg2.l3.m1.1.1.3.2.1.3" xref="alg2.l3.m1.1.1.3.2.1.3.cmml">k</mi></msub><mo lspace="0.167em" id="alg2.l3.m1.1.1.3.2a" xref="alg2.l3.m1.1.1.3.2.cmml">⁡</mo><msup id="alg2.l3.m1.1.1.3.2.2" xref="alg2.l3.m1.1.1.3.2.2.cmml"><mover accent="true" id="alg2.l3.m1.1.1.3.2.2.2" xref="alg2.l3.m1.1.1.3.2.2.2.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.2.2.2.2" xref="alg2.l3.m1.1.1.3.2.2.2.2.cmml">r</mi><mo mathsize="90%" id="alg2.l3.m1.1.1.3.2.2.2.1" xref="alg2.l3.m1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg2.l3.m1.1.1.3.2.2.3" xref="alg2.l3.m1.1.1.3.2.2.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑘</ci><cn type="integer" id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">0</cn></apply><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><arg id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3.1"></arg><apply id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2"><apply id="alg2.l3.m1.1.1.3.2.1.cmml" xref="alg2.l3.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.2.1.1.cmml" xref="alg2.l3.m1.1.1.3.2.1">subscript</csymbol><max id="alg2.l3.m1.1.1.3.2.1.2.cmml" xref="alg2.l3.m1.1.1.3.2.1.2"></max><ci id="alg2.l3.m1.1.1.3.2.1.3.cmml" xref="alg2.l3.m1.1.1.3.2.1.3">𝑘</ci></apply><apply id="alg2.l3.m1.1.1.3.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.2.2.1.cmml" xref="alg2.l3.m1.1.1.3.2.2">superscript</csymbol><apply id="alg2.l3.m1.1.1.3.2.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2.2"><ci id="alg2.l3.m1.1.1.3.2.2.2.1.cmml" xref="alg2.l3.m1.1.1.3.2.2.2.1">^</ci><ci id="alg2.l3.m1.1.1.3.2.2.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2.2.2">𝑟</ci></apply><ci id="alg2.l3.m1.1.1.3.2.2.3.cmml" xref="alg2.l3.m1.1.1.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">k_{0}=\arg\max_{k}\hat{r}^{k}</annotation></semantics></math><span id="alg2.l3.2" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}\leftarrow\mathcal{S}_{t}\cup\{k_{0}\}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msub id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">t</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">←</mo><mrow id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml"><msub id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.1.1.1.3.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l4.m1.1.1.1.3.3" xref="alg2.l4.m1.1.1.1.3.3.cmml">t</mi></msub><mo mathsize="90%" id="alg2.l4.m1.1.1.1.2" xref="alg2.l4.m1.1.1.1.2.cmml">∪</mo><mrow id="alg2.l4.m1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l4.m1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l4.m1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.cmml">k</mi><mn mathsize="90%" id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo maxsize="90%" minsize="90%" id="alg2.l4.m1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">←</ci><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝒮</ci><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"><union id="alg2.l4.m1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.2"></union><apply id="alg2.l4.m1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.1.3.2">𝒮</ci><ci id="alg2.l4.m1.1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.1.3.3">𝑡</ci></apply><set id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1"><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">0</cn></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{S}_{t}\leftarrow\mathcal{S}_{t}\cup\{k_{0}\}</annotation></semantics></math><span id="alg2.l4.2" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg2.l5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span><span id="alg2.l5.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l5.m1.1" class="ltx_Math" alttext="|\mathcal{S}_{t}|&lt;K" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.1.cmml">|</mo><msub id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.2.1.cmml">|</mo></mrow><mo mathsize="90%" id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">&lt;</mo><mi mathsize="90%" id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><lt id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"></lt><apply id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1"><abs id="alg2.l5.m1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2"></abs><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2">𝒮</ci><ci id="alg2.l5.m1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">|\mathcal{S}_{t}|&lt;K</annotation></semantics></math><span id="alg2.l5.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l5.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l5.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg2.l6.2" class="ltx_text" style="font-size:90%;">    Select </span><math id="alg2.l6.m1.1" class="ltx_math_unparsed" alttext="k_{min}=\arg\min_{k}D_{KL}\Big{(}(\bm{R}_{total}+\bar{\bm{R}}^{k})||\bm{U}\Big{)}" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1b"><msub id="alg2.l6.m1.1.1"><mi mathsize="90%" id="alg2.l6.m1.1.1.2">k</mi><mrow id="alg2.l6.m1.1.1.3"><mi mathsize="90%" id="alg2.l6.m1.1.1.3.2">m</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.3.1">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.1.3.3">i</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.3.1a">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.1.3.4">n</mi></mrow></msub><mo mathsize="90%" id="alg2.l6.m1.1.2">=</mo><mi mathsize="90%" id="alg2.l6.m1.1.3">arg</mi><msub id="alg2.l6.m1.1.4"><mi mathsize="90%" id="alg2.l6.m1.1.4.2">min</mi><mi mathsize="90%" id="alg2.l6.m1.1.4.3">k</mi></msub><msub id="alg2.l6.m1.1.5"><mi mathsize="90%" id="alg2.l6.m1.1.5.2">D</mi><mrow id="alg2.l6.m1.1.5.3"><mi mathsize="90%" id="alg2.l6.m1.1.5.3.2">K</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.5.3.1">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.5.3.3">L</mi></mrow></msub><mrow id="alg2.l6.m1.1.6"><mo maxsize="160%" minsize="160%" id="alg2.l6.m1.1.6.1">(</mo><mrow id="alg2.l6.m1.1.6.2"><mo maxsize="90%" minsize="90%" id="alg2.l6.m1.1.6.2.1">(</mo><msub id="alg2.l6.m1.1.6.2.2"><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.2">𝑹</mi><mrow id="alg2.l6.m1.1.6.2.2.3"><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.3.2">t</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.6.2.2.3.1">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.6.2.2.3.1a">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.3.4">t</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.6.2.2.3.1b">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.3.5">a</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.6.2.2.3.1c">​</mo><mi mathsize="90%" id="alg2.l6.m1.1.6.2.2.3.6">l</mi></mrow></msub><mo mathsize="90%" id="alg2.l6.m1.1.6.2.3">+</mo><msup id="alg2.l6.m1.1.6.2.4"><mover accent="true" id="alg2.l6.m1.1.6.2.4.2"><mi mathsize="90%" id="alg2.l6.m1.1.6.2.4.2.2">𝑹</mi><mo mathsize="90%" id="alg2.l6.m1.1.6.2.4.2.1">¯</mo></mover><mi mathsize="90%" id="alg2.l6.m1.1.6.2.4.3">k</mi></msup><mo maxsize="90%" minsize="90%" id="alg2.l6.m1.1.6.2.5">)</mo></mrow><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="alg2.l6.m1.1.6.3">|</mo><mo fence="false" maxsize="90%" minsize="90%" rspace="0.167em" id="alg2.l6.m1.1.6.4">|</mo><mi mathsize="90%" id="alg2.l6.m1.1.6.5">𝑼</mi><mo maxsize="160%" minsize="160%" id="alg2.l6.m1.1.6.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">k_{min}=\arg\min_{k}D_{KL}\Big{(}(\bm{R}_{total}+\bar{\bm{R}}^{k})||\bm{U}\Big{)}</annotation></semantics></math><span id="alg2.l6.3" class="ltx_text" style="font-size:90%;"> for </span><math id="alg2.l6.m2.1" class="ltx_Math" alttext="k\in\mathcal{K}\setminus\mathcal{S}_{t}" display="inline"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi mathsize="90%" id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">k</mi><mo mathsize="90%" id="alg2.l6.m2.1.1.1" xref="alg2.l6.m2.1.1.1.cmml">∈</mo><mrow id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l6.m2.1.1.3.2" xref="alg2.l6.m2.1.1.3.2.cmml">𝒦</mi><mo mathsize="90%" id="alg2.l6.m2.1.1.3.1" xref="alg2.l6.m2.1.1.3.1.cmml">∖</mo><msub id="alg2.l6.m2.1.1.3.3" xref="alg2.l6.m2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l6.m2.1.1.3.3.2" xref="alg2.l6.m2.1.1.3.3.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l6.m2.1.1.3.3.3" xref="alg2.l6.m2.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><in id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1"></in><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">𝑘</ci><apply id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3"><setdiff id="alg2.l6.m2.1.1.3.1.cmml" xref="alg2.l6.m2.1.1.3.1"></setdiff><ci id="alg2.l6.m2.1.1.3.2.cmml" xref="alg2.l6.m2.1.1.3.2">𝒦</ci><apply id="alg2.l6.m2.1.1.3.3.cmml" xref="alg2.l6.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.3.3.1.cmml" xref="alg2.l6.m2.1.1.3.3">subscript</csymbol><ci id="alg2.l6.m2.1.1.3.3.2.cmml" xref="alg2.l6.m2.1.1.3.3.2">𝒮</ci><ci id="alg2.l6.m2.1.1.3.3.3.cmml" xref="alg2.l6.m2.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">k\in\mathcal{K}\setminus\mathcal{S}_{t}</annotation></semantics></math><span id="alg2.l6.4" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg2.l7.2" class="ltx_text" style="font-size:90%;">    Set </span><math id="alg2.l7.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}\leftarrow\mathcal{S}_{t}\cup\{k_{min}\}" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">t</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">←</mo><mrow id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml"><msub id="alg2.l7.m1.1.1.1.3" xref="alg2.l7.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l7.m1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.3.2.cmml">𝒮</mi><mi mathsize="90%" id="alg2.l7.m1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.3.3.cmml">t</mi></msub><mo mathsize="90%" id="alg2.l7.m1.1.1.1.2" xref="alg2.l7.m1.1.1.1.2.cmml">∪</mo><mrow id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l7.m1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">k</mi><mrow id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.1.1.3.1" xref="alg2.l7.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.1.1.3.1a" xref="alg2.l7.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.1.3.4" xref="alg2.l7.m1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">←</ci><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝒮</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"><union id="alg2.l7.m1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.2"></union><apply id="alg2.l7.m1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.3.2">𝒮</ci><ci id="alg2.l7.m1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.3.3">𝑡</ci></apply><set id="alg2.l7.m1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1"><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2">𝑘</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3"><times id="alg2.l7.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.1"></times><ci id="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.2">𝑚</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.4.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\mathcal{S}_{t}\leftarrow\mathcal{S}_{t}\cup\{k_{min}\}</annotation></semantics></math><span id="alg2.l7.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l7.m2.1" class="ltx_Math" alttext="\bm{R}_{total}\leftarrow\bm{R}_{total}+\bar{\bm{R}}^{k}_{min}" display="inline"><semantics id="alg2.l7.m2.1a"><mrow id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><msub id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.2.2" xref="alg2.l7.m2.1.1.2.2.cmml">𝑹</mi><mrow id="alg2.l7.m2.1.1.2.3" xref="alg2.l7.m2.1.1.2.3.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.2.3.2" xref="alg2.l7.m2.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.2.3.1" xref="alg2.l7.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.2.3.3" xref="alg2.l7.m2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.2.3.1a" xref="alg2.l7.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.2.3.4" xref="alg2.l7.m2.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.2.3.1b" xref="alg2.l7.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.2.3.5" xref="alg2.l7.m2.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.2.3.1c" xref="alg2.l7.m2.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.2.3.6" xref="alg2.l7.m2.1.1.2.3.6.cmml">l</mi></mrow></msub><mo mathsize="90%" stretchy="false" id="alg2.l7.m2.1.1.1" xref="alg2.l7.m2.1.1.1.cmml">←</mo><mrow id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml"><msub id="alg2.l7.m2.1.1.3.2" xref="alg2.l7.m2.1.1.3.2.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.2" xref="alg2.l7.m2.1.1.3.2.2.cmml">𝑹</mi><mrow id="alg2.l7.m2.1.1.3.2.3" xref="alg2.l7.m2.1.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.3.2" xref="alg2.l7.m2.1.1.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.2.3.1" xref="alg2.l7.m2.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.3.3" xref="alg2.l7.m2.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.2.3.1a" xref="alg2.l7.m2.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.3.4" xref="alg2.l7.m2.1.1.3.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.2.3.1b" xref="alg2.l7.m2.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.3.5" xref="alg2.l7.m2.1.1.3.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.2.3.1c" xref="alg2.l7.m2.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.2.3.6" xref="alg2.l7.m2.1.1.3.2.3.6.cmml">l</mi></mrow></msub><mo mathsize="90%" id="alg2.l7.m2.1.1.3.1" xref="alg2.l7.m2.1.1.3.1.cmml">+</mo><msubsup id="alg2.l7.m2.1.1.3.3" xref="alg2.l7.m2.1.1.3.3.cmml"><mover accent="true" id="alg2.l7.m2.1.1.3.3.2.2" xref="alg2.l7.m2.1.1.3.3.2.2.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.3.3.2.2.2" xref="alg2.l7.m2.1.1.3.3.2.2.2.cmml">𝑹</mi><mo mathsize="90%" id="alg2.l7.m2.1.1.3.3.2.2.1" xref="alg2.l7.m2.1.1.3.3.2.2.1.cmml">¯</mo></mover><mrow id="alg2.l7.m2.1.1.3.3.3" xref="alg2.l7.m2.1.1.3.3.3.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.3.3.3.2" xref="alg2.l7.m2.1.1.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.3.3.1" xref="alg2.l7.m2.1.1.3.3.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.3.3.3" xref="alg2.l7.m2.1.1.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.1.1.3.3.3.1a" xref="alg2.l7.m2.1.1.3.3.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.1.1.3.3.3.4" xref="alg2.l7.m2.1.1.3.3.3.4.cmml">n</mi></mrow><mi mathsize="90%" id="alg2.l7.m2.1.1.3.3.2.3" xref="alg2.l7.m2.1.1.3.3.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><ci id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1.1">←</ci><apply id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.2.1.cmml" xref="alg2.l7.m2.1.1.2">subscript</csymbol><ci id="alg2.l7.m2.1.1.2.2.cmml" xref="alg2.l7.m2.1.1.2.2">𝑹</ci><apply id="alg2.l7.m2.1.1.2.3.cmml" xref="alg2.l7.m2.1.1.2.3"><times id="alg2.l7.m2.1.1.2.3.1.cmml" xref="alg2.l7.m2.1.1.2.3.1"></times><ci id="alg2.l7.m2.1.1.2.3.2.cmml" xref="alg2.l7.m2.1.1.2.3.2">𝑡</ci><ci id="alg2.l7.m2.1.1.2.3.3.cmml" xref="alg2.l7.m2.1.1.2.3.3">𝑜</ci><ci id="alg2.l7.m2.1.1.2.3.4.cmml" xref="alg2.l7.m2.1.1.2.3.4">𝑡</ci><ci id="alg2.l7.m2.1.1.2.3.5.cmml" xref="alg2.l7.m2.1.1.2.3.5">𝑎</ci><ci id="alg2.l7.m2.1.1.2.3.6.cmml" xref="alg2.l7.m2.1.1.2.3.6">𝑙</ci></apply></apply><apply id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3"><plus id="alg2.l7.m2.1.1.3.1.cmml" xref="alg2.l7.m2.1.1.3.1"></plus><apply id="alg2.l7.m2.1.1.3.2.cmml" xref="alg2.l7.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.3.2.1.cmml" xref="alg2.l7.m2.1.1.3.2">subscript</csymbol><ci id="alg2.l7.m2.1.1.3.2.2.cmml" xref="alg2.l7.m2.1.1.3.2.2">𝑹</ci><apply id="alg2.l7.m2.1.1.3.2.3.cmml" xref="alg2.l7.m2.1.1.3.2.3"><times id="alg2.l7.m2.1.1.3.2.3.1.cmml" xref="alg2.l7.m2.1.1.3.2.3.1"></times><ci id="alg2.l7.m2.1.1.3.2.3.2.cmml" xref="alg2.l7.m2.1.1.3.2.3.2">𝑡</ci><ci id="alg2.l7.m2.1.1.3.2.3.3.cmml" xref="alg2.l7.m2.1.1.3.2.3.3">𝑜</ci><ci id="alg2.l7.m2.1.1.3.2.3.4.cmml" xref="alg2.l7.m2.1.1.3.2.3.4">𝑡</ci><ci id="alg2.l7.m2.1.1.3.2.3.5.cmml" xref="alg2.l7.m2.1.1.3.2.3.5">𝑎</ci><ci id="alg2.l7.m2.1.1.3.2.3.6.cmml" xref="alg2.l7.m2.1.1.3.2.3.6">𝑙</ci></apply></apply><apply id="alg2.l7.m2.1.1.3.3.cmml" xref="alg2.l7.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.3.3.1.cmml" xref="alg2.l7.m2.1.1.3.3">subscript</csymbol><apply id="alg2.l7.m2.1.1.3.3.2.cmml" xref="alg2.l7.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.3.3.2.1.cmml" xref="alg2.l7.m2.1.1.3.3">superscript</csymbol><apply id="alg2.l7.m2.1.1.3.3.2.2.cmml" xref="alg2.l7.m2.1.1.3.3.2.2"><ci id="alg2.l7.m2.1.1.3.3.2.2.1.cmml" xref="alg2.l7.m2.1.1.3.3.2.2.1">¯</ci><ci id="alg2.l7.m2.1.1.3.3.2.2.2.cmml" xref="alg2.l7.m2.1.1.3.3.2.2.2">𝑹</ci></apply><ci id="alg2.l7.m2.1.1.3.3.2.3.cmml" xref="alg2.l7.m2.1.1.3.3.2.3">𝑘</ci></apply><apply id="alg2.l7.m2.1.1.3.3.3.cmml" xref="alg2.l7.m2.1.1.3.3.3"><times id="alg2.l7.m2.1.1.3.3.3.1.cmml" xref="alg2.l7.m2.1.1.3.3.3.1"></times><ci id="alg2.l7.m2.1.1.3.3.3.2.cmml" xref="alg2.l7.m2.1.1.3.3.3.2">𝑚</ci><ci id="alg2.l7.m2.1.1.3.3.3.3.cmml" xref="alg2.l7.m2.1.1.3.3.3.3">𝑖</ci><ci id="alg2.l7.m2.1.1.3.3.3.4.cmml" xref="alg2.l7.m2.1.1.3.3.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">\bm{R}_{total}\leftarrow\bm{R}_{total}+\bar{\bm{R}}^{k}_{min}</annotation></semantics></math><span id="alg2.l7.4" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg2.l8.2" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg2.l8.3" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l8.4" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.2.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg2.l9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Outputs: <math id="alg2.l9.1.m1.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="alg2.l9.1.m1.1a"><msub id="alg2.l9.1.m1.1.1" xref="alg2.l9.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.1.m1.1.1.2" xref="alg2.l9.1.m1.1.1.2.cmml">𝒮</mi><mi id="alg2.l9.1.m1.1.1.3" xref="alg2.l9.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.1.m1.1b"><apply id="alg2.l9.1.m1.1.1.cmml" xref="alg2.l9.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.1.m1.1.1.1.cmml" xref="alg2.l9.1.m1.1.1">subscript</csymbol><ci id="alg2.l9.1.m1.1.1.2.cmml" xref="alg2.l9.1.m1.1.1.2">𝒮</ci><ci id="alg2.l9.1.m1.1.1.3.cmml" xref="alg2.l9.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.1.m1.1c">\mathcal{S}_{t}</annotation></semantics></math></span><span id="alg2.l9.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</figure>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.1" class="ltx_p"><span id="S3.SS2.p7.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 2</span><span id="S3.SS2.p7.1.2" class="ltx_text" style="font-size:90%;"> determines the participants of FL updating.
Combine </span><span id="S3.SS2.p7.1.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 1</span><span id="S3.SS2.p7.1.4" class="ltx_text" style="font-size:90%;"> and </span><span id="S3.SS2.p7.1.5" class="ltx_text ltx_font_bold" style="font-size:90%;">Algorithm 2</span><span id="S3.SS2.p7.1.6" class="ltx_text" style="font-size:90%;">, we can find the most suitable client set with class balance.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">4 </span>Numerical Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text" style="font-size:90%;">In this section, we present numerical results to validate the effectiveness of the proposed algorithms </span><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The source code of our work can be found in https://github.com/ym1231/fl-cir.</span></span></span><span id="S4.p1.1.2" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.5" class="ltx_p"><span id="S4.p2.5.1" class="ltx_text" style="font-size:90%;">We test our scheme on one of the main benchmarks: CIFAR10 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.p2.5.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S4.p2.5.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S4.p2.5.4" class="ltx_text" style="font-size:90%;">.
CIFAR10 dataset consists of </span><math id="S4.p2.1.m1.1" class="ltx_Math" alttext="50000" display="inline"><semantics id="S4.p2.1.m1.1a"><mn mathsize="90%" id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">50000</mn><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><cn type="integer" id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">50000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">50000</annotation></semantics></math><span id="S4.p2.5.5" class="ltx_text" style="font-size:90%;"> training examples and </span><math id="S4.p2.2.m2.1" class="ltx_Math" alttext="10000" display="inline"><semantics id="S4.p2.2.m2.1a"><mn mathsize="90%" id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">10000</mn><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><cn type="integer" id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">10000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">10000</annotation></semantics></math><span id="S4.p2.5.6" class="ltx_text" style="font-size:90%;"> testing examples of </span><math id="S4.p2.3.m3.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mn mathsize="90%" id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">32</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.p2.3.m3.1.1.1" xref="S4.p2.3.m3.1.1.1.cmml">×</mo><mn mathsize="90%" id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><times id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1"></times><cn type="integer" id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">32</cn><cn type="integer" id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">32\times 32</annotation></semantics></math><span id="S4.p2.5.7" class="ltx_text" style="font-size:90%;"> RGB images, categorized by total </span><math id="S4.p2.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.p2.4.m4.1a"><mn mathsize="90%" id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><cn type="integer" id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">10</annotation></semantics></math><span id="S4.p2.5.8" class="ltx_text" style="font-size:90%;"> classes.
The number of clients in FL training is set as </span><math id="S4.p2.5.m5.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.p2.5.m5.1a"><mn mathsize="90%" id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><cn type="integer" id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">100</annotation></semantics></math><span id="S4.p2.5.9" class="ltx_text" style="font-size:90%;">.
To model the imbalanced class distribution, we split the whole CIFAR10 dataset to each client with random amount of classes and random amount of data samples.</span></p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.8" class="ltx_p"><span id="S4.p3.8.1" class="ltx_text" style="font-size:90%;">The architecture of our deep model is a standard convolutional neural network (CNN), which comprises </span><math id="S4.p3.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.p3.1.m1.1a"><mn mathsize="90%" id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><cn type="integer" id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">3</annotation></semantics></math><span id="S4.p3.8.2" class="ltx_text" style="font-size:90%;"> convolutional layers followed by rectified linear units (ReLU) nonlinear activations and max-pooling layer and </span><math id="S4.p3.2.m2.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.p3.2.m2.1a"><mn mathsize="90%" id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><cn type="integer" id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">2</annotation></semantics></math><span id="S4.p3.8.3" class="ltx_text" style="font-size:90%;"> fully connected layers, with totally </span><math id="S4.p3.3.m3.1" class="ltx_Math" alttext="122570" display="inline"><semantics id="S4.p3.3.m3.1a"><mn mathsize="90%" id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml">122570</mn><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><cn type="integer" id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1">122570</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">122570</annotation></semantics></math><span id="S4.p3.8.4" class="ltx_text" style="font-size:90%;"> parameters.
Such standard model can meet our needs to validate the effectiveness of our scheme.
The training data is preprocessed by standard techniques for data augmentation, such as cropping, flipping, changing the color, etc.
We use standard SGD as our optimizer.
The learning rate and the learning rate decay of SGD are set as </span><math id="S4.p3.4.m4.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.p3.4.m4.1a"><mn mathsize="90%" id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><cn type="float" id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">0.1</annotation></semantics></math><span id="S4.p3.8.5" class="ltx_text" style="font-size:90%;"> and </span><math id="S4.p3.5.m5.1" class="ltx_Math" alttext="0.996" display="inline"><semantics id="S4.p3.5.m5.1a"><mn mathsize="90%" id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml">0.996</mn><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><cn type="float" id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1">0.996</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">0.996</annotation></semantics></math><span id="S4.p3.8.6" class="ltx_text" style="font-size:90%;">, respectively.
In each training round, the selected clients train their local models for </span><math id="S4.p3.6.m6.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.p3.6.m6.1a"><mn mathsize="90%" id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><cn type="integer" id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">5</annotation></semantics></math><span id="S4.p3.8.7" class="ltx_text" style="font-size:90%;"> epochs.
The client selects </span><math id="S4.p3.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.p3.7.m7.1a"><mn mathsize="90%" id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><cn type="integer" id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">10</annotation></semantics></math><span id="S4.p3.8.8" class="ltx_text" style="font-size:90%;"> batches with batch size </span><math id="S4.p3.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.p3.8.m8.1a"><mn mathsize="90%" id="S4.p3.8.m8.1.1" xref="S4.p3.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.1b"><cn type="integer" id="S4.p3.8.m8.1.1.cmml" xref="S4.p3.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.1c">10</annotation></semantics></math><span id="S4.p3.8.9" class="ltx_text" style="font-size:90%;"> at each training epoch.</span></p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.6" class="ltx_p"><span id="S4.p4.6.1" class="ltx_text" style="font-size:90%;">In our simulation, we set exploration factor </span><math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p4.1.m1.1a"><mi mathsize="90%" id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\alpha</annotation></semantics></math><span id="S4.p4.6.2" class="ltx_text" style="font-size:90%;"> as </span><math id="S4.p4.2.m2.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S4.p4.2.m2.1a"><mn mathsize="90%" id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><cn type="float" id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">0.2</annotation></semantics></math><span id="S4.p4.6.3" class="ltx_text" style="font-size:90%;"> and forgetting factor </span><math id="S4.p4.3.m3.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.p4.3.m3.1a"><mi mathsize="90%" id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><ci id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">\rho</annotation></semantics></math><span id="S4.p4.6.4" class="ltx_text" style="font-size:90%;"> as </span><math id="S4.p4.4.m4.1" class="ltx_Math" alttext="0.99" display="inline"><semantics id="S4.p4.4.m4.1a"><mn mathsize="90%" id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">0.99</mn><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><cn type="float" id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">0.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">0.99</annotation></semantics></math><span id="S4.p4.6.5" class="ltx_text" style="font-size:90%;">.
We fix the normalization hyperparameter </span><math id="S4.p4.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.p4.5.m5.1a"><mi mathsize="90%" id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><ci id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">\beta</annotation></semantics></math><span id="S4.p4.6.6" class="ltx_text" style="font-size:90%;"> as </span><math id="S4.p4.6.m6.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.p4.6.m6.1a"><mn mathsize="90%" id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><cn type="integer" id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">1</annotation></semantics></math><span id="S4.p4.6.7" class="ltx_text" style="font-size:90%;">.
To evaluate the performance of the proposed algorithm, we compare the performance of the proposed algorithm to the following schemes.
(i) Greedy scheme: global server selects the client set with the sample mean information according to the class estimation method;
(ii) Random scheme: global server randomly selects the client set.
In addition, we compare the proposed algorithm in IID setting to show the performance gap.
Note that in IID setting, the class distribution and the number of data samples in each client are set as the same.
Thus the above selection schemes are the same in practice.</span></p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2011.11266/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_img_square" width="217" height="182" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.4.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>The global test accuracy with different selection schemes.</figcaption>
</figure>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text" style="font-size:90%;">In the first experiment, we examine the convergence performance of global model with the proposed algorithm.
At each round, the global server selects </span><math id="S4.p5.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.p5.1.m1.1a"><mn mathsize="90%" id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><cn type="integer" id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">20</annotation></semantics></math><span id="S4.p5.1.2" class="ltx_text" style="font-size:90%;"> clients for model aggregation.
Fig. </span><a href="#S4.F2" title="Figure 2 ‣ 4 Numerical Results ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S4.p5.1.3" class="ltx_text" style="font-size:90%;"> depicts the test accuracy of global model with different schemes.
The test accuracy performance represents the learning process of global model.
From Fig. </span><a href="#S4.F2" title="Figure 2 ‣ 4 Numerical Results ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S4.p5.1.4" class="ltx_text" style="font-size:90%;">, we observe that the proposed algorithm achieves faster convergence speed and higher test accuracy compared with the greedy and uniform schemes.
The discrepancy of performance between the proposed and random scheme comes from the effect of class imbalance.
The proposed algorithm can reduce the class imbalance by carefully selecting the proper client set.
Compared with the greedy scheme, the proposed algorithm can balance the trade-off between exploration and exploitation, thus resulting in the exploration of more suitable clients set with balanced class combination.</span></p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.1" class="ltx_p"><span id="S4.p6.1.1" class="ltx_text" style="font-size:90%;">In the second experiment, we would like to verify the performance of the proposed algorithm with different amounts of selected clients.
Fig. </span><a href="#S4.F3" title="Figure 3 ‣ 4 Numerical Results ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="S4.p6.1.2" class="ltx_text" style="font-size:90%;"> plot the FL training performance with respect to the amounts of clients.
With the increasing amounts of selected clients, the FL training process can achieve better performance.
However, the performance improvement is slighter when the amount of clients become larger.
This result indicates that too large amount of clients is not essential to find the best client set when suffering the burden of communication consumption.</span></p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2011.11266/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_img_square" width="217" height="182" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.4.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>The global test accuracy of the proposed algorithm with different amounts of clients selection.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2011.11266/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_img_square" width="217" height="182" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.4.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>The global test accuracy with different exploration factors.</figcaption>
</figure>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.5" class="ltx_p"><span id="S4.p7.5.1" class="ltx_text" style="font-size:90%;">We investigate the accuracy performance of the proposed algorithm with different parameters </span><math id="S4.p7.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p7.1.m1.1a"><mi mathsize="90%" id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><ci id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">\alpha</annotation></semantics></math><span id="S4.p7.5.2" class="ltx_text" style="font-size:90%;"> in Fig. </span><a href="#S4.F4" title="Figure 4 ‣ 4 Numerical Results ‣ Federated learning with class imbalance reduction" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4</span></a><span id="S4.p7.5.3" class="ltx_text" style="font-size:90%;">.
The parameters </span><math id="S4.p7.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p7.2.m2.1a"><mi mathsize="90%" id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><ci id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">\alpha</annotation></semantics></math><span id="S4.p7.5.4" class="ltx_text" style="font-size:90%;"> can decide the trade-off between exploitation and exploration.
When the exploration parameter </span><math id="S4.p7.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p7.3.m3.1a"><mi mathsize="90%" id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><ci id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">\alpha</annotation></semantics></math><span id="S4.p7.5.5" class="ltx_text" style="font-size:90%;"> is small, the global server would like to exploit the history sampling information and thus could not explore sufficiently to find the best client set.
As the exploration parameter </span><math id="S4.p7.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p7.4.m4.1a"><mi mathsize="90%" id="S4.p7.4.m4.1.1" xref="S4.p7.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p7.4.m4.1b"><ci id="S4.p7.4.m4.1.1.cmml" xref="S4.p7.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.4.m4.1c">\alpha</annotation></semantics></math><span id="S4.p7.5.6" class="ltx_text" style="font-size:90%;"> increases, the global server prefers to explore the clients with fewer selections.
Spending many rounds for exploration could result in the performance deterioration since the clients selected for exploration may be not always proper.
A suitable </span><math id="S4.p7.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p7.5.m5.1a"><mi mathsize="90%" id="S4.p7.5.m5.1.1" xref="S4.p7.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p7.5.m5.1b"><ci id="S4.p7.5.m5.1.1.cmml" xref="S4.p7.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.5.m5.1c">\alpha</annotation></semantics></math><span id="S4.p7.5.7" class="ltx_text" style="font-size:90%;"> is essential to improve the convergence performance.</span></p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text" style="font-size:90%;">In this paper, we studied the client selection problem with class imbalance in FL.
Without the requirement of clients’ data information, we designed a scheme to explicitly reveal the class distribution according to the updated gradients.
Besides, a client selection algorithm based on the CMAB framework was proposed to reduce the class imbalance effect.
Numerical results confirmed that the proposed algorithm could pick the properly balanced client set and improve the convergence performance of the global model.</span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
M. Chiang and T. Zhang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">“Fog and IoT: An overview of research opportunities,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Internet of Things Journal</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, vol. 3, no. 6, pp. 854–864,
Dec. 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">“Federated learning: Strategies for improving communication
efficiency,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:1610.05492</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Yujun Lin, Song Han, Huizi Mao, Yu Wang, and William J Dally,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">“Deep gradient compression: Reducing the communication bandwidth for
distributed training,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:1712.01887</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Wenqi Shi, Sheng Zhou, and Zhisheng Niu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">“Device scheduling with fast convergence for wireless federated
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Communications (ICC)</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, May
2020.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Howard H Yang, Ahmed Arafa, Tony QS Quek, and H Vincent Poor,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">“Age-based scheduling policy for federated learning in mobile edge
networks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Acoustics, Speech and Signal
Processing (ICASSP)</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, May 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Qunsong Zeng, Yuqing Du, Kaibin Huang, and Kin K Leung,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">“Energy-efficient radio resource allocation for federated edge
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE International Conference on Communications Workshops
(ICC Workshops)</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, May 2020.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">“Communication-efficient learning of deep networks from
decentralized data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial Intelligence and Statistics (AISTATS)</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, Aug. 2017.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">“Federated learning with non-iid data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:1806.00582</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
F. Sattler, S. Wiedemann, K. R. Müller, and W. Samek,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">“Robust and communication-efficient federated learning from
non-i.i.d. data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, vol.
31, no. 9, pp. 3400–3413, 2020.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">“On the convergence of fedavg on non-iid data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:1907.02189</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Lixu Wang, Shichao Xu, Xiao Wang, and Qi Zhu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">“Towards class imbalance in federated learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:2008.06217</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Hao Wang, Zakhary Kaplan, Di Niu, and Baochun Li,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">“Optimizing federated learning on non-iid data with reinforcement
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Conference on Computer Communications (INFOCOM)</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, Jul.
2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Wenchao Xia, Tony QS Quek, Kun Guo, Wanli Wen, Howard H Yang, and Hongbo Zhu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">“Multi-armed bandit based client scheduling for federated
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Wireless Communications</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Mehryar Mohri, Gary Sivek, and Ananda Theertha Suresh,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">“Agnostic federated learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Availabel as ArXiv:1902.00146</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Rangachari Anand, Kishan G Mehrotra, Chilukuri K Mohan, and Sanjay Ranka,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">“An improved algorithm for neural network classification of
imbalanced training sets,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, vol. 4, no. 6, pp.
962–969, 1993.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Wei Chen, Yajun Wang, and Yang Yuan,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">“Combinatorial multi-armed bandit: General framework and
applications,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning (ICML)</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, Jun.
2013.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
A. Krizhevsky and G.E. Hinton,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">“Learning multiple layers of features from tiny images,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Technical report</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2011.11265" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2011.11266" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2011.11266">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2011.11266" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2011.11268" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 21:43:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
